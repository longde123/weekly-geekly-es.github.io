<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§≠ üçÆ üîó Kaggle: Amazon from Space: trucos y trucos para entrenar redes neuronales ü§ù üñãÔ∏è üìñ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El verano pasado, termin√≥ la competencia en el sitio de kaggle, que se dedic√≥ a la clasificaci√≥n de im√°genes satelitales de los bosques amaz√≥nicos. Nu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kaggle: Amazon from Space: trucos y trucos para entrenar redes neuronales</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ods/blog/413667/"><img src="https://habrastorage.org/webt/os/ad/nr/osadnrglchljzop2xeerf65s0n0.png"><br><br>  El verano pasado, termin√≥ la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">competencia</a> en el sitio de kaggle, que se dedic√≥ a la clasificaci√≥n de im√°genes satelitales de los bosques amaz√≥nicos.  Nuestro equipo ocup√≥ el s√©ptimo lugar de m√°s de 900 participantes.  A pesar de que la competencia termin√≥ hace mucho tiempo, casi todos los m√©todos de nuestra soluci√≥n siguen siendo aplicables, y no solo para competencias, sino tambi√©n para la formaci√≥n de redes neuronales en venta.  Para detalles bajo cat. <br><a name="habracut"></a><br>  <b>tldr.py</b> <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> kaggle <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ods <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> albu, alno, kostia, n01z3, nizhib, romul, ternaus <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> dataset <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> x_train, y_train, x_test oof_train, oof_test = [], [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> member <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [albu, alno, kostia, n01z3, nizhib, romul, ternaus]: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> model <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> member.models: model.fit_10folds(x_train, y_train, config=member.fit_config) oof_train.append(model.predict_oof_tta(x_train, config=member.tta_config)) oof_test.append(model.predict_oof_tta(x_test, config=member.tta_config)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> model <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> albu.second_level: model.fit(oof_train) y_test = model.predict_proba(oof_test) y_test = kostia.bayes_f2_opt(y_test) kaggle.submit(y_test)</code> </pre> <br>  Descripci√≥n de la tarea <br><br>  Planet prepar√≥ un conjunto de im√°genes satelitales en dos formatos: <br><br><ol><li>  TIF - 16 bits RGB + N, donde N - Cerca del infrarrojo </li><li>  JPG - RGB de 8 bits, que se derivan de TIF y que se proporcionaron para reducir el umbral para ingresar a la tarea, as√≠ como para simplificar la visualizaci√≥n.  En la competencia anterior en Kaggle, era necesario trabajar con im√°genes multiespectrales.  no visuales, es decir, infrarrojos, as√≠ como canales con una longitud de onda m√°s larga, mejoraron en gran medida la calidad de la predicci√≥n, tanto de red como de m√©todos no supervisados. </li></ol><br>  Geogr√°ficamente, los datos se tomaron del territorio de la cuenca del Amazonas y de los territorios de los pa√≠ses de Brasil, Per√∫, Uruguay, Colombia, Venezuela, Guyana, Bolivia y Ecuador, en los que se seleccionaron √°reas de superficie interesantes, cuyas fotograf√≠as se ofrecieron a los participantes. <br><br>  Despu√©s de crear jpg desde tif, todas las escenas se cortaron en peque√±as piezas de 256x256.  Y de acuerdo con el jpg recibido por los empleados de Planet de las oficinas de Berl√≠n y San Francisco, as√≠ como a trav√©s de la plataforma Crowd Flower, se realiz√≥ el marcado. <br><br>  Los participantes ten√≠an la tarea de predecir para cada mosaico de 256x256 una de las marcas clim√°ticas mutuamente excluyentes: <br><br>  Nublado, parcialmente nublado, neblina, claro <br><br>  Y tambi√©n 0 o m√°s mal tiempo: agricultura, primaria, tala selectiva, habitaci√≥n, agua, caminos, cultivo itinerante, floraci√≥n, miner√≠a convencional <br><br>  Un total de 4 condiciones clim√°ticas y 13 no clim√°ticas, clima mutuamente excluyente, pero sin clima, pero si la imagen est√° nublada, entonces no deber√≠a haber otras etiquetas. <br><br><img src="https://habrastorage.org/webt/me/ng/-t/meng-tzona5dhecl1r56eggbt1u.jpeg"><br><br>  La precisi√≥n del modelo se estim√≥ mediante la m√©trica F2: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>u</mi><mi>a</mi><mi>c</mi><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xF3;</mo></mrow><mi>n</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>+</mo><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msup><mi>a</mi><mn>2</mn></msup><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>r</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msup><mi>a</mi><mn>2</mn></msup><mi>p</mi><mo>+</mo><mi>r</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="46.748ex" height="3.021ex" viewBox="0 -987.6 20127.8 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-75" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-6E" x="1324" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-74" x="1924" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-75" x="2286" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-61" x="2858" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-63" x="3388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-69" x="3821" y="0"></use><g transform="translate(4167,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">√≥</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-6E" x="4581" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-3D" x="5460" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-28" x="6516" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-31" x="6906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-2B" x="7628" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-62" x="8879" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-65" x="9308" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-74" x="9775" y="0"></use><g transform="translate(10136,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-32" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-29" x="11120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-66" x="11759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-72" x="12310" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-61" x="12761" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-63" x="13291" y="0"></use><g transform="translate(13724,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-72" x="503" y="0"></use></g><g transform="translate(14679,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-62" x="639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-65" x="1069" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-74" x="1535" y="0"></use><g transform="translate(1897,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-32" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-70" x="2880" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-2B" x="3606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-72" x="4606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-29" x="5058" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>u</mi><mi>a</mi><mi>c</mi><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo>√≥</mo></mrow><mi>n</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msup><mi>a</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msup><mi>a</mi><mn>2</mn></msup><mi>p</mi><mo>+</mo><mi>r</mi><mo stretchy="false">)</mo></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> Puntuaci√≥n = (1+ \ beta ^ 2) \ frac {pr} {(\ beta ^ 2p + r)} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>p</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>p</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>p</mi><mo>+</mo><mi>f</mi><mi>p</mi></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.808ex" height="2.419ex" viewBox="-38.5 -780.1 8098 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-3D" x="781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-66" x="2087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-72" x="2638" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-61" x="3089" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-63" x="3619" y="0"></use><g transform="translate(4052,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-70" x="361" y="0"></use></g><g transform="translate(4917,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-70" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-2B" x="1087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-66" x="2087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-70" x="2638" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>p</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>p</mi><mo>+</mo><mi>f</mi><mi>p</mi></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> p = \ frac {tp} {tp + fp} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>r</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>p</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>p</mi><mo>+</mo><mi>f</mi><mi>n</mi></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.823ex" height="2.419ex" viewBox="0 -780.1 8104.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-72" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-3D" x="729" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-66" x="2035" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-72" x="2586" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-61" x="3037" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-63" x="3567" y="0"></use><g transform="translate(4000,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-70" x="361" y="0"></use></g><g transform="translate(4865,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-70" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-2B" x="1087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-66" x="2087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-6E" x="2638" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>r</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>p</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>p</mi><mo>+</mo><mi>f</mi><mi>n</mi></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> r = \ frac {tp} {tp + fn} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>=</mo><mn>2</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.992ex" height="2.057ex" viewBox="0 -780.1 3871.6 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-74" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMATHI-61" x="1507" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-3D" x="2314" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhgYSgoSLWQqjivoMt08PNlE7XecIg#MJMAIN-32" x="3371" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>=</mo><mn>2</mn></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> \ beta = 2 </script></p><br>  Adem√°s, todas las etiquetas ten√≠an el mismo peso y primero se calcul√≥ F2 para cada imagen, y luego hubo un promedio general.  Por lo general, lo hacen de manera un poco diferente, es decir, se calcula una determinada m√©trica para cada clase y luego se promedia.  La l√≥gica es que la √∫ltima opci√≥n es m√°s interpretable, ya que le permite responder a la pregunta de c√≥mo se comporta el modelo en cada clase en particular.  En este caso, los organizadores fueron de acuerdo con la primera opci√≥n, que, aparentemente, est√° relacionada con los detalles de su negocio. <br><br>  Hay 40k muestras en el tren.  En la prueba 40k.  Debido al peque√±o tama√±o del conjunto de datos, pero al gran tama√±o de las im√°genes, podemos decir que esto es "MNIST con esteroides" <br><br>  <b>Digresi√≥n l√≠rica</b> <br><br>  Como puede ver en la descripci√≥n, la tarea es bastante comprensible y la soluci√≥n no tiene sentido: solo necesita archivar la cuadr√≠cula.  Y teniendo en cuenta los detalles de la abrazadera, tambi√©n puede apilar un mont√≥n de modelos en la parte superior.  Sin embargo, para obtener una medalla de oro, no solo debes entrenar de alguna manera a un mont√≥n de modelos.  Es imperativo tener muchos modelos diversos b√°sicos, cada uno de los cuales en s√≠ mismo muestra un resultado sobresaliente.  Y ya encima de estos modelos puedes terminar apilando y otros hacks. <br><table><tbody><tr><th>  miembro </th><th>  neto </th><th>  1 cultivo </th><th>  Tta </th><th>  diff,% </th></tr><tr><td>  alno </td><td>  densenet121 </td><td>  0.9278 </td><td>  0.9294 </td><td>  0.1736 </td></tr><tr><td>  nizhib </td><td>  densenet169 </td><td>  0.9243 </td><td>  0.9277 </td><td>  0.3733 </td></tr><tr><td>  romul </td><td>  vgg16 </td><td>  0,9266 </td><td>  0.9267 </td><td>  0,0186 </td></tr><tr><td>  ternaus </td><td>  densenet121 </td><td>  0,9232 </td><td>  0.9241 </td><td>  0,0921 </td></tr><tr><td>  albu </td><td>  densenet121 </td><td>  0.9294 </td><td>  0,9312 </td><td>  0,1933 </td></tr><tr><td>  kostia </td><td>  resnet50 </td><td>  0.9262 </td><td>  0.9271 </td><td>  0,0907 </td></tr><tr><td>  n01z3 </td><td>  resnext50 </td><td>  0.9281 </td><td>  0.9298 </td><td>  0.1896 </td></tr></tbody></table><br>  La tabla muestra los modelos de puntaje F2 de todos los participantes para un solo cultivo y TTA.  Como puede ver, la diferencia es peque√±a para el uso real, pero es importante para el modo de competencia. <br><br>  <b>Interacci√≥n del equipo</b> <br><br>  Alexander Buslaev <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">albu</a></i> <br>  En el momento de la participaci√≥n en la competencia, dirigi√≥ toda la direcci√≥n ml en Geoscan.  Pero desde entonces arrastr√≥ un mont√≥n de competiciones, se convirti√≥ en el padre de todas las SAO en la segmentaci√≥n sem√°ntica y se fue a Minsk, remando en Mapbox, sobre el cual se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">public√≥</a> el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo.</a> <br><br>  Alexey Noskov <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">alno</a></i> <br>  Combatiente universal ml.  Trabaj√≥ en Evil Martians.  Ahora rod√≥ hacia Yandex. <br><br>  Konstantin Lopukhin <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">kostialopuhin</a></i> <br>  Trabaj√≥ y contin√∫a trabajando en Scrapinghub.  Desde entonces, Kostya logr√≥ obtener algunas medallas m√°s y sin 5 minutos Kaggle Grandmaster <br><br>  Arthur Cousin <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">n01z3</a></i> <br>  Al momento de participar en esta competencia, trabajaba en Avito.  Pero alrededor del a√±o nuevo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el</a> cient√≠fico principal de datos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dbrain se traslad√≥</a> a la cadena de bloques.  Espero que pronto deleitemos a la comunidad con nuestras competencias con estibadores y marcas de l√°mparas. <br><br>  Evgeny Nizhibitsky <i>@nizhib</i> <br>  Cient√≠fico principal de datos en Rambler &amp; Co.  A partir de esta competencia, Eugene descubri√≥ la habilidad secreta de encontrar caras en las competiciones de im√°genes.  Lo que lo ayud√≥ a arrastrar un par de competiciones en la plataforma Topcoder.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Habl√©</a> sobre uno de ellos. <br><br>  Ruslan <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">Baykulov romul</a></i> <br>  Comprometido en el seguimiento de eventos deportivos en Constanta. <br><br>  Vladimir Iglovikov <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">ternaus</a></i> <br>  Podr√≠a ser recordado por un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> lleno de acci√≥n sobre el acoso por parte de la inteligencia brit√°nica.  Trabaj√≥ en TrueAccord, pero luego se convirti√≥ en el joven y moderno Lyft.  ¬øD√≥nde funciona Computer Vision para el auto sin conductor?  Contin√∫a arrastrando competencias y recientemente recibi√≥ el Gran Maestro Kaggle. <br><br>  Nuestra asociaci√≥n y formato de participaci√≥n pueden llamarse t√≠picos.  La decisi√≥n de unirnos se debi√≥ al hecho de que todos tuvimos resultados cercanos en la clasificaci√≥n.  Y cada uno de nosotros vio nuestra propia tuber√≠a independiente, que era una soluci√≥n completamente aut√≥noma de principio a fin.  Adem√°s, despu√©s de la fusi√≥n, varios participantes se dedicaron al apilamiento. <br><br>  Lo primero que hicimos fue compartir pliegues.  Nos aseguramos de que la distribuci√≥n de clases en cada pliegue fuera la misma que en todo el conjunto de datos.  Para esto, primero se seleccion√≥ la clase m√°s rara, estratificada por ella, porque las im√°genes restantes fueron estratificadas por la segunda clase m√°s popular, y as√≠ sucesivamente hasta que no quedaron im√°genes. <br><br>  Histograma de clases de pliegue: <br><br><img src="https://habrastorage.org/webt/bh/wb/so/bhwbsoqk5acztwrsigxg0iwqpau.png"><br><br>  Tambi√©n ten√≠amos un repositorio com√∫n, donde cada miembro del equipo ten√≠a su propia carpeta, dentro de la cual organizaba el c√≥digo como quer√≠a. <br><br>  Y tambi√©n acordamos el formato de predicciones, porque este era el √∫nico punto de interacci√≥n para combinar nuestros modelos. <br><br>  <b>Entrenamiento de redes neuronales</b> <br><br>  Como cada uno de nosotros ten√≠a una tuber√≠a independiente, √©ramos una muestra de la red del proceso de aprendizaje √≥ptimo paralelo a la gente. <br><br>  <b>Enfoque general</b> <br><br><img src="https://habrastorage.org/webt/fw/jo/bf/fwjobff3h_7__qvkhjmzi3fqhke.png"><br>  Imagen de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">github.com/tornadomeet/ResNet</a> <br><br>  Se presenta un proceso de aprendizaje t√≠pico en el programa de capacitaci√≥n de las redes neuronales Resnet en imagenet.  Comienzan a partir de pesos inicializados aleatoriamente con SGD (lr 0.1 Nesterov Momentum 0.0001 WD 0.9) y luego, despu√©s de 30 borrados, reducen la tasa de aprendizaje en 10 veces. <br><br>  Conceptualmente, cada uno de nosotros us√≥ el mismo enfoque, sin embargo, para no envejecer mientras se entrena cada red, se produjo una disminuci√≥n en LR si la validaci√≥n no redujo la p√©rdida durante 3-5 eras seguidas.  O, algunos participantes simplemente redujeron el n√∫mero de eras en cada da√±o LR y lo redujeron de acuerdo con el cronograma. <br><br>  <b>Aumento</b> <br><br>  Elegir los aumentos correctos es muy importante al entrenar redes neuronales.  Los aumentos deben reflejar la variabilidad de la naturaleza de los datos.  Convencionalmente, los aumentos se pueden dividir en dos tipos: los que introducen sesgos en los datos y los que no.  Por sesgo, uno puede entender varias estad√≠sticas de bajo nivel, como histogramas de color o tama√±o caracter√≠stico.  A este respecto, digamos, los aumentos y escalas de HSV introducen un desplazamiento, pero un recorte aleatorio no. <br><br>  En las primeras etapas de entrenamiento de la red, puede ir demasiado lejos con los aumentos y usar un conjunto muy dif√≠cil.  Sin embargo, hacia el final del entrenamiento, debes desactivar los aumentos o dejar solo aquellos que no introducen sesgos.  Esto permite que la red neuronal se sobreajuste un poco debajo del tren y muestre un resultado ligeramente mejor en la validaci√≥n. <br><br>  <b>Capa de congelaci√≥n</b> <br><br>  En la gran mayor√≠a de las tareas, no tiene sentido entrenar una red neuronal desde cero, es mucho m√°s eficiente jugar con redes pre-entrenadas, digamos con Imagenet.  Sin embargo, puede ir m√°s all√° y no solo cambiar la capa completamente conectada debajo de la capa con el n√∫mero deseado de clases, sino primero entrenarla con la congelaci√≥n de todas las circunvoluciones.  Si no congela las circunvoluciones e inmediatamente entrena a toda la red con pesos inicializados aleatoriamente de una capa totalmente conectada, entonces los pesos de las circunvoluciones se corromper√°n y el rendimiento final de la red neuronal ser√° menor.  En esta tarea, esto fue especialmente notable debido al peque√±o tama√±o de la muestra de entrenamiento.  En otras competiciones con una gran cantidad de datos, como cdiscount, era posible no congelar toda la red neuronal, sino grupos de convoluciones desde el final.  De esta manera, el entrenamiento podr√≠a acelerarse enormemente, ya que no se consideraron los gradientes para las capas congeladas. <br><br>  <b>Recocido c√≠clico</b> <br><br>  Este proceso se ve as√≠.  Despu√©s de completar el proceso de entrenamiento b√°sico de la red neuronal, se toman los mejores pesos y se repite el proceso de entrenamiento.  Pero comienza con una tasa de aprendizaje m√°s baja y ocurre en poco tiempo, digamos 3-5 eras.  Esto permite que la red neuronal baje a un m√≠nimo local m√°s bajo y muestre un mejor rendimiento.  Esta campa√±a estable mejora el resultado en un n√∫mero bastante amplio de concursos. <br><br>  En m√°s detalle sobre dos recepciones <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> <br><br>  <b>Aumentos de tiempo de prueba</b> <br><br>  Como se trata de una competencia y no tenemos una restricci√≥n formal sobre el tiempo de inferencia, puede usar aumentos durante la prueba.  Parece que la imagen est√° distorsionada de la misma manera que sucedi√≥ durante el entrenamiento.  Digamos, se refleja verticalmente, horizontalmente, girado por un √°ngulo, etc.  Cada aumento da una nueva imagen de la que obtenemos predicciones.  Luego se promedian las predicciones de tales distorsiones de una imagen (como regla por medios geom√©tricos).  Tambi√©n da una ganancia.  En otras competiciones, tambi√©n experiment√© con aumentos aleatorios.  Digamos que puede aplicar no uno a la vez, sino simplemente reducir la amplitud para giros aleatorios, contrastes y aumentos de color a la mitad, arreglar la semilla y hacer varias im√°genes distorsionadas al azar.  Esto tambi√©n dio un aumento. <br><br>  <b>Conjunto de instant√°neas (TTA de puntos m√∫ltiples)</b> <br><br>  La idea del recocido se puede desarrollar m√°s.  En cada etapa del recocido, la red neuronal vuela a m√≠nimos locales ligeramente diferentes.  Y esto significa que estos son modelos esencialmente ligeramente diferentes que se pueden promediar.  Por lo tanto, durante las predicciones de la prueba, puede tomar los tres mejores puntos de control y promediar sus predicciones.  Tambi√©n trat√© de tomar no los tres mejores, sino los tres m√°s diversos de los 10 puntos de control principales: fue peor.  Bueno, para la producci√≥n, tal truco no es aplicable e intent√© promediar el peso de los modelos.  Esto dio un aumento muy insignificante pero constante. <br><br><img src="https://habrastorage.org/webt/ad/_l/po/ad_lposcfqtrpo67wc3abmzvxq0.png"><br><br>  <b>Enfoques de cada miembro del equipo</b> <br><br>  En consecuencia, en un grado u otro, cada miembro de nuestro equipo utiliz√≥ una combinaci√≥n diferente de las t√©cnicas anteriores. <br><table><tbody><tr><th>  <nobr>nick</nobr> </th><th>  <nobr>Conv congelar,</nobr> <br>  √©poca </th><th>  <nobr>Optimizador</nobr> </th><th>  <nobr>Estrategia</nobr> </th><th>  <nobr>Ago</nobr> </th><th>  <nobr>Tta</nobr> </th></tr><tr><th>  albu </th><td>  3 </td><td>  SGD </td><td>  15 decadencia LR de √©poca, <br>  C√≠rculo 13 √©pocas </td><td>  D4 <br>  Escala <br>  Offset <br>  Distorsi√≥n <br>  Contraste <br>  Desenfoque </td><td>  D4 </td></tr><tr><th>  alno </th><td>  3 </td><td>  SGD </td><td>  Lr decaimiento </td><td>  D4 <br>  Escala <br>  Offset <br>  Distorsi√≥n <br>  Contraste <br>  Desenfoque <br>  Corte <br>  Multiplicador de canales </td><td>  D4 </td></tr><tr><th>  n01z3 </th><td>  2 </td><td>  SGD </td><td>  Drop LR, paciente 10 </td><td>  D4 <br>  Escala <br>  Distorsi√≥n <br>  Contraste <br>  Desenfoque </td><td>  D4, 3 puntos de control </td></tr><tr><th>  <nobr>ternaus</nobr> </th><td>  - </td><td>  Adam </td><td>  LR c√≠clico (1e-3: 1e-6) </td><td>  D4 <br>  Escala <br>  Agregar canal <br>  Contraste </td><td>  D4 <br>  cultivo aleatorio </td></tr><tr><th>  nizhib </th><td>  - </td><td>  Adam </td><td>  StepLR, 60 √©pocas, 20 por descomposici√≥n </td><td>  D4 <br>  RandomSizedCrop </td><td>  D4 <br>  4 esquinas <br>  centro <br>  escala </td></tr><tr><th>  kostia </th><td>  1 </td><td>  Adam </td><td></td><td>  D4 <br>  Escala <br>  Distorsi√≥n <br>  Contraste <br>  Desenfoque </td><td>  D4 </td></tr><tr><th>  romul </th><td>  - </td><td>  SGD </td><td>  base_lr: 0.01 - 0.02 <br>  lr = base_lr * (0.33 ** (√©poca / 30)) <br>  √âpoca: 50 </td><td>  D4, escala </td><td>  D4, cultivo central, <br>  Cultivos de esquina </td></tr></tbody></table><br>  <b>Apilamiento y hacks</b> <br><br>  Entrenamos cada modelo con cada conjunto de par√°metros en 10 pliegues.  Y luego, en las predicciones fuera de pliegue (OOF), ense√±amos modelos de segundo nivel: √Årboles adicionales, Regresi√≥n lineal, Red neuronal y simplemente modelos de promedios. <br><br>  Y ya en OOF, las predicciones de los modelos de segundo nivel recogieron pesos para mezclar.  Puedes leer m√°s sobre apilar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br>  En la producci√≥n real, por extra√±o que parezca, este enfoque tambi√©n tiene lugar.  Por ejemplo, cuando hay datos multimodales (im√°genes, texto, categor√≠as, etc.) y desea combinar las predicciones de los modelos.  Simplemente puede promediar las probabilidades, pero el entrenamiento de un modelo de segundo nivel da el mejor resultado. <br><br>  <b>Baes Optimization F2</b> <br><br>  Adem√°s, las predicciones finales se ajustaron un poco usando la optimizaci√≥n bayesiana.  Supongamos que tenemos probabilidades ideales, entonces F2 con el mejor tapete de expectativa (es decir, de tipo √≥ptimo) se obtiene mediante la siguiente f√≥rmula: <br><br><img src="https://habrastorage.org/webt/gx/dh/ff/gxdhff8q1dgrym6n2t7nzna144e.png"><br><br>  ¬øQu√© significa esto?  Necesitamos clasificar todas las combinaciones (es decir, para cada etiqueta 0 y 1), calcular la probabilidad de cada combinaci√≥n y multiplicar por F2; obtenemos el F2 esperado.  Para qu√© combinaci√≥n es mejor, y dar√° el F2 √≥ptimo.  Las probabilidades se consideraron simplemente una multiplicaci√≥n de las probabilidades de las etiquetas individuales (si la etiqueta es 0, tomamos 1 - p), y para no clasificar de 2 a 17 opciones, solo se escalonaron las etiquetas con una probabilidad de 0.05 a 0.5; hab√≠a 3-7 de ellas en una fila, por lo que las opciones un poco (la presentaci√≥n se realiz√≥ en un par de minutos).  En teor√≠a, ser√≠a genial obtener la probabilidad de una combinaci√≥n de etiquetas, no solo multiplicando las probabilidades individuales (porque las etiquetas no son independientes), sino que no funcion√≥. <br><br>  que dio  Cuando los modelos se volvieron buenos, la selecci√≥n de umbrales despu√©s de que el conjunto dej√≥ de funcionar, y esto dio un aumento peque√±o pero estable tanto en la validaci√≥n como en lo p√∫blico / privado. <br><br>  <b>Ep√≠logo</b> <br><br>  Como resultado, entrenamos 48 modelos diferentes, cada uno con 10 pliegues, es decir  480 modelos del primer nivel.  Dicha red de redes humanas me permiti√≥ probar diferentes t√©cnicas al entrenar redes neuronales convolucionales profundas, que todav√≠a uso en el trabajo y las competiciones. <br><br>  ¬øFue posible entrenar menos modelos y obtener el mismo o mejor resultado?  Si bastante.  Nuestros compatriotas del tercer lugar, Stanislav <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">stasg7</a> Semenov y Roman <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ZFTurbo</a> Soloviev, cuestan un n√∫mero menor de modelos de primer nivel y compensan m√°s de 250 modelos de segundo nivel.  Sobre la soluci√≥n, puede <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ver el</a> an√°lisis y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">leer la</a> publicaci√≥n. <br><br>  El primer lugar fue para el misterioso bestfitting.  En general, este tipo es muy bueno, y ahora se ha convertido en el mejor de Keggle, despu√©s de haber realizado muchas competiciones de im√°genes.  Permaneci√≥ en el anonimato durante mucho tiempo, hasta que Nvidia rompi√≥ la tapa al <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">entrevistarlo</a> .  En el cual admiti√≥ que 200 subordinados le reportar√≠an ... Tambi√©n hay una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">publicaci√≥n</a> sobre la decisi√≥n. <br><br>  Otro de los interesantes: ampliamente conocido en c√≠rculos estrechos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Jeremy Howard</a> , padre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">fastai</a> termin√≥ 22m.  Y si pensabas que acababa de enviar un par de presentaciones para su fan, entonces no lo adivinaste.  Particip√≥ en el equipo y envi√≥ 111 paquetes. <br><br>  Adem√°s, los estudiantes graduados de Stanford que estaban tomando el legendario curso CS231n en ese momento y a quienes se les permiti√≥ usar esta tarea como un proyecto del curso, terminaron todo el equipo en el medio de la tabla de clasificaci√≥n. <br><br>  Como beneficio adicional, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">habl√©</a> en Mail.ru con el material de esta publicaci√≥n y aqu√≠ hay otra <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">presentaci√≥n de</a> Vladimir Iglovikov de una reuni√≥n en el Valle. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es413667/">https://habr.com/ru/post/es413667/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es413655/index.html">¬øQu√© textos para las p√°ginas de destino realmente venden?</a></li>
<li><a href="../es413657/index.html">La red neuronal de Uber reconoce a los usuarios en un estado "inusual"</a></li>
<li><a href="../es413661/index.html">Saga de servicios electr√≥nicos y sus ubicaciones. Parte 1. Servicio electr√≥nico</a></li>
<li><a href="../es413663/index.html">Meetup de historias de backend</a></li>
<li><a href="../es413665/index.html">¬øC√≥mo determinar el volumen de sus registros?</a></li>
<li><a href="../es413669/index.html">Samsung IT School: ense√±ando a los estudiantes c√≥mo desarrollar aplicaciones m√≥viles</a></li>
<li><a href="../es413673/index.html">Sobre el tema del rendimiento de versiones antiguas y nuevas de un nodo</a></li>
<li><a href="../es413675/index.html">Joker 2018: Club de desarrolladores Java an√≥nimos</a></li>
<li><a href="../es413677/index.html">Lanzamiento de ROS en el robot de autoequilibrio EduMIP</a></li>
<li><a href="../es413679/index.html">Angular 6. PWA M√≥dulos de carga lenta. Despliegue autom√°tico en Firebase</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>