<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯРз ЁЯУГ ЁЯСитАНтЭдя╕ПтАНЁЯСи рдХреИрд╕реЗ рдЬрд╛рд╡рд╛ 8 Android рдкрд░ рд╕рдорд░реНрдерд┐рдд рд╣реИ ЁЯджЁЯП╗ ЁЯН╖ тЪЬя╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдирдорд╕реНрдХрд╛рд░, рд╣реЗрдмреНрд░! рдореИрдВ рдЖрдкрдХреЗ рдзреНрдпрд╛рди рдореЗрдВ рдХреБрдЦреНрдпрд╛рдд рдЬреЗрдХ рд╡реЛрд░реНрдЯрди рджреНрд╡рд╛рд░рд╛ рд▓реЗрдЦреЛрдВ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рд╕реЗ рдПрдХ рдЕрджреНрднреБрдд рд▓реЗрдЦ рдХрд╛ рдЕрдиреБрд╡рд╛рдж рд▓рд╛рддрд╛ рд╣реВрдВ рдХрд┐ рдХреИрд╕реЗ рдЬрд╛рд╡рд╛ рд╕реЗ рдПрдВрдбреНрд░реЙрдЗрдб 8 рдХрд╛ рд╕рдо...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдХреИрд╕реЗ рдЬрд╛рд╡рд╛ 8 Android рдкрд░ рд╕рдорд░реНрдерд┐рдд рд╣реИ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tinkoff/blog/478692/">  рдирдорд╕реНрдХрд╛рд░, рд╣реЗрдмреНрд░!  рдореИрдВ рдЖрдкрдХреЗ рдзреНрдпрд╛рди рдореЗрдВ <a href="https://twitter.com/JakeWharton%3Flang%3Den">рдХреБрдЦреНрдпрд╛рдд рдЬреЗрдХ рд╡реЛрд░реНрдЯрди</a> рджреНрд╡рд╛рд░рд╛ рд▓реЗрдЦреЛрдВ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рд╕реЗ рдПрдХ рдЕрджреНрднреБрдд рд▓реЗрдЦ рдХрд╛ рдЕрдиреБрд╡рд╛рдж рд▓рд╛рддрд╛ рд╣реВрдВ рдХрд┐ рдХреИрд╕реЗ рдЬрд╛рд╡рд╛ рд╕реЗ рдПрдВрдбреНрд░реЙрдЗрдб 8 рдХрд╛ рд╕рдорд░реНрдерди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/ho/ap/qe/hoapqe-nhkwts3ekeettjbuiao8.png"><br><br>  <font color="#0000ff"><a href="https://jakewharton.com/androids-java-8-support/">рдореВрд▓ рд▓реЗрдЦ рдпрд╣рд╛рдБ рд╣реИ</a></font> <br><a name="habracut"></a><br>  рдореИрдВрдиреЗ рдХрдИ рд╡рд░реНрд╖реЛрдВ рддрдХ рдШрд░ рд╕реЗ рдХрд╛рдо рдХрд┐рдпрд╛, рдФрд░ рдореИрдВрдиреЗ рдЕрдХреНрд╕рд░ рдЕрдкрдиреЗ рд╕рд╣рдпреЛрдЧрд┐рдпреЛрдВ рдХреЛ рдЬрд╛рд╡рд╛ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдПрдВрдбреНрд░реЙрдЗрдб рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╢рд┐рдХрд╛рдпрдд рдХрд░рддреЗ рд╕реБрдирд╛ред <br><br>  рдпрд╣ рдПрдХ рдЬрдЯрд┐рд▓ рд╡рд┐рд╖рдп рд╣реИред  рдкрд╣рд▓реЗ рдЖрдкрдХреЛ рдпрд╣ рддрдп рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ "рдПрдВрдбреНрд░реЙрдЗрдб рдореЗрдВ рдЬрд╛рд╡рд╛ рд╕рдкреЛрд░реНрдЯ" рд╕реЗ рд╣рдорд╛рд░рд╛ рдХреНрдпрд╛ рдорддрд▓рдм рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рднрд╛рд╖рд╛ рдХреЗ рдПрдХ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдмрд╣реБрдд рд╕рд╛рд░реА рдЪреАрдЬреЗрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ: рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд▓реИрдореНрдмреНрдбрд╛), рдмрд╛рдЗрдЯрдХреЛрдб, рдЯреВрд▓реНрд╕, рдПрдкреАрдЖрдИ, рдЬреЗрд╡реАрдПрдо рдФрд░ рдЗрд╕реА рддрд░рд╣ред <br><br>  рдЬрдм рд▓реЛрдЧ рдПрдВрдбреНрд░реЙрдЗрдб рдореЗрдВ рдЬрд╛рд╡рд╛ 8 рд╕рдорд░реНрдерди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЙрдирдХрд╛ рдорддрд▓рдм рдЖрдорддреМрд░ рдкрд░ рднрд╛рд╖рд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рд╣реЛрддрд╛ рд╣реИред  рддреЛ, рдЪрд▓реЛ рдЙрдирдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред <br><br><h2>  рд▓реИрдореНрдмреНрдбрд╛ </h2><br>  рдЬрд╛рд╡рд╛ 8 рдХреЗ рдореБрдЦреНрдп рдирд╡рд╛рдЪрд╛рд░реЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд▓рдВрдмреЛрджрд░ рдерд╛ред <br>  рдХреЛрдб рдЕрдзрд┐рдХ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдФрд░ рд╕рд░рд▓ рд╣реЛ рдЧрдпрд╛ рд╣реИ, рд▓реИрдореНрдмреНрдбрд╛ рдиреЗ рд╣рдореЗрдВ рдПрдХ рдПрдХрд▓ рд╡рд┐рдзрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмреЛрдЭрд┐рд▓ рдЕрдирд╛рдо рдХрдХреНрд╖рд╛рдПрдВ рд▓рд┐рдЦрдиреЗ рд╕реЗ рдмрдЪрд╛рдпрд╛ рд╣реИред <br><br><pre><code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Java8</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Logger</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">log</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String... args)</span></span></span><span class="hljs-function"> </span></span>{ sayHi(s -&gt; System.out.println(s)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sayHi</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Logger logger)</span></span></span><span class="hljs-function"> </span></span>{ logger.log(<span class="hljs-string"><span class="hljs-string">"Hello!"</span></span>); } }</code> </pre> <br>  Javac рдФрд░ legacy <code>dx tool</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рд╕рдВрдХрд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддреНрд░реБрдЯрд┐ рдорд┐рд▓рддреА рд╣реИ: <br><br><pre> <code class="plaintext hljs">$ javac *.java $ ls Java8.java Java8.class Java8$Logger.class $ $ANDROID_HOME/build-tools/28.0.2/dx --dex --output . *.class Uncaught translation error: com.android.dx.cf.code.SimException: ERROR in Java8.main:([Ljava/lang/String;)V: invalid opcode ba - invokedynamic requires --min-sdk-version &gt;= 26 (currently 13) 1 error; aborting</code> </pre> <br>  рдпрд╣ рддреНрд░реБрдЯрд┐ рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рд╣реЛрддреА рд╣реИ рдХрд┐ <code>invokedynamic</code> рдореЗрдВ рдПрдХ рдирдП рдирд┐рд░реНрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ - <code>invokedynamic</code> , рдЬрд┐рд╕реЗ рдЬрд╛рд╡рд╛ 7 рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рдерд╛ред рддреНрд░реБрдЯрд┐ рдкрд╛рда рд╕реЗ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрдВрдбреНрд░реЙрдЗрдб рдХреЗрд╡рд▓ 26 рдПрдкреАрдЖрдИ (рдПрдВрдбреНрд░реЙрдЗрдб 8) рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрдиреЗ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред <br><br>  рдпрд╣ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рдирд╣реАрдВ рд▓рдЧрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╢рд╛рдпрдж рд╣реА рдХреЛрдИ 26 minApi рдХреЗ рд╕рд╛рде рдХреЛрдИ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЬрд╛рд░реА рдХрд░реЗрдЧрд╛ред  рдЗрд╕рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рддрдерд╛рдХрдерд┐рдд <i>рдбрд┐рд╕реБрдЧрд░рд┐рдВрдЧ</i> рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ <i>рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ</i> , рдЬреЛ рдПрдкреАрдЖрдИ рдХреЗ рд╕рднреА рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдкрд░ рд▓реИрдореНрдмреНрдбрд╛ рд╕рдорд░реНрдерди рдХреЛ рд╕рдВрднрд╡ рдмрдирд╛рддрд╛ рд╣реИред <br><br><h2>  Desaccharization рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕ </h2><br>  рд╡рд╣ Android рджреБрдирд┐рдпрд╛ рдореЗрдВ рдмрд╣реБрдд рд░рдВрдЧреАрди рд╣реИред  Desaccharization рдХрд╛ рд▓рдХреНрд╖реНрдп рд╣рдореЗрд╢рд╛ рдПрдХ рд╣реА рд╣реИ - рд╕рднреА рдЙрдкрдХрд░рдгреЛрдВ рдкрд░ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирдИ рднрд╛рд╖рд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ред <br><br>  рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдВрдбреНрд░реЙрдЗрдб рдореЗрдВ рд▓реИрдореНрдмреНрдбрд╛ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдбреЗрд╡рд▓рдкрд░реНрд╕ рдиреЗ <a href="https://github.com/evant/gradle-retrolambda">рд░реЗрдЯреНрд░реЛрд▓рдВрдмрд╛</a> рдкреНрд▓рдЧрдЗрди рдХреЛ рдХрдиреЗрдХреНрдЯ рдХрд┐рдпрд╛ред  рдЙрдиреНрд╣реЛрдВрдиреЗ рдЬреЗрд╡реАрдПрдо рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╣реА рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рддрдВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛, рд▓реИрдореНрдмрджрд╛рд╕ рдХреЛ рдХрдХреНрд╖рд╛рдУрдВ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд┐рдпрд╛, рд▓реЗрдХрд┐рди рдЙрдиреНрд╣реЛрдВрдиреЗ рдЗрд╕реЗ рд░рдирдЯрд╛рдЗрдо рдореЗрдВ рдХрд┐рдпрд╛, рдФрд░ рд╕рдВрдХрд▓рди рд╕рдордп рдкрд░ рдирд╣реАрдВред  рддрд░реАрдХреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЙрддреНрдкрдиреНрди рдХрдХреНрд╖рд╛рдПрдВ рдмрд╣реБрдд рдорд╣рдВрдЧреА рдереАрдВ, рд▓реЗрдХрд┐рди рд╕рдордп рдХреЗ рд╕рд╛рде, рд╕реБрдзрд╛рд░реЛрдВ рдФрд░ рд╕реБрдзрд╛рд░реЛрдВ рдХреЗ рдмрд╛рдж, рдпрд╣ рд╕рдВрдХреЗрддрдХ рдХрдо рдпрд╛ рдЬреНрдпрд╛рджрд╛ рдЙрдЪрд┐рдд рдХреБрдЫ рдХрдо рд╣реЛ рдЧрдпрд╛ред <br><br>  рдлрд┐рд░, рдПрдВрдбреНрд░реЙрдЗрдб рдЯреАрдо <a href="https://android-developers.googleblog.com/2014/12/hello-world-meet-our-new-experimental.html">рдиреЗ рдПрдХ рдирдП рд╕рдВрдХрд▓рдХ рдХреА рдШреЛрд╖рдгрд╛ рдХреА рдЬреЛ</a> рд╕рднреА рдЬрд╛рд╡рд╛ 8 рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЕрдзрд┐рдХ рдЙрддреНрдкрд╛рджрдХ рдерд╛ред  рдЗрд╕реЗ рдПрдХреНрд▓рд┐рдкреНрд╕ рдЬрд╛рд╡рд╛ рдХрдВрдкрд╛рдЗрд▓рд░ рдХреЗ рдКрдкрд░ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдЬрд╛рд╡рд╛ рдмрд╛рдЗрдЯрдХреЛрдб рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рдЗрд╕рдиреЗ рдПрдХ Dalvik рдмрд╛рдпрдЯреЗрдХреЛрдб рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЗрд╕рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдЕрднреА рднреА рд╡рд╛рдВрдЫрд┐рдд рд╣реЛрдирд╛ рдмрд╛рдХреА рд╣реИред <br><br>  рдЬрдм рдирдпрд╛ рд╕рдВрдХрд▓рдХ (рд╕реМрднрд╛рдЧреНрдп рд╕реЗ) рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рддреЛ рдЬрд╛рд╡рд╛ рдмрд╛рдЗрдЯрдХреЛрдб рдореЗрдВ рдЬрд╛рд╡рд╛ рдмрд╛рдЗрдЯрдХреЛрдб рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдорд░, рдЬреЛ рдмрд╛рдЬреАрдЧрд░реА рдХрд░рддрд╛ <a href="https://android-developers.googleblog.com/2017/04/java-8-language-features-support-update.html">рдерд╛</a> , Google рдХреЗ рдмрд┐рд▓реНрдб рд╕рд┐рд╕реНрдЯрдо, <a href="https://android-developers.googleblog.com/2017/04/java-8-language-features-support-update.html">рдмрдЬрд╝реЗрд▓</a> рд╕реЗ <a href="https://android-developers.googleblog.com/2017/04/java-8-language-features-support-update.html">рдПрдВрдбреНрд░реЙрдЗрдб рдЧреНрд░реИрдЧрд▓ рдкреНрд▓рдЧрд┐рди рдореЗрдВ рдПрдХреАрдХреГрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛</a> ред  рдФрд░ рдЗрд╕рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдЕрднреА рднреА рдХрдо рдерд╛, рдЗрд╕рд▓рд┐рдП рдПрдХ рдмреЗрд╣рддрд░ рд╕рдорд╛рдзрд╛рди рдХреА рдЦреЛрдЬ рд╕рдорд╛рдирд╛рдВрддрд░ рдореЗрдВ рдЬрд╛рд░реА рд░рд╣реАред <br><br>  рдФрд░ рдЕрдм рд╣рдореЗрдВ <a href="https://android-developers.googleblog.com/2017/08/next-generation-dex-compiler-now-in.html"><code>  dexer</code></a> - <i>рдбреА 8 рдХреЗ</i> <a href="https://android-developers.googleblog.com/2017/08/next-generation-dex-compiler-now-in.html"><code>  dexer</code></a> рдЧрдпрд╛ рдерд╛, рдЬрд┐рд╕реЗ <code>dx tool</code> рдХреЛ рдмрджрд▓рдирд╛ рдерд╛ред  Desaccharization рдЕрдм рд╕рдВрдХрд▓рд┐рдд JAR рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ <code>.dex</code> (рдбреЗрдХреНрд╕рд┐рдВрдЧ) рдХреЗ рд░реВрдкрд╛рдВрддрд░рдг рдХреЗ рджреМрд░рд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред  D8, <code>dx</code> рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдкреНрд░рджрд░реНрд╢рди рдореЗрдВ рдмрд╣реБрдд рдмреЗрд╣рддрд░ рд╣реИ, рдФрд░ рдПрдВрдбреНрд░реЙрдЗрдб рдЧреНрд░реИрдбрд▓ рдкреНрд▓рдЧрд┐рди 3.1 рдХреЗ рдмрд╛рдж рд╕реЗ рдпрд╣ рдбрд┐рдлреЙрд▓реНрдЯ рдбрд┐рдХреНрд╕рд░ рдмрди рдЧрдпрд╛ рд╣реИред <br><br><h2>  D8 </h2><br>  рдЕрдм, D8 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рдКрдкрд░ рджрд┐рдП рдЧрдП рдХреЛрдб рдХреЛ рд╕рдВрдХрд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="plaintext hljs">$ java -jar d8.jar \ --lib $ANDROID_HOME/platforms/android-28/android.jar \ --release \ --output . \ *.class $ ls Java8.java Java8.class Java8$Logger.class classes.dex</code> </pre> <br>  рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдбреА 8 рдиреЗ рд▓реИрдореНрдмреНрдбрд╛ рдХреЛ рдХреИрд╕реЗ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд┐рдпрд╛, рдЖрдк <code>dexdump tool</code> рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рдПрдВрдбреНрд░реЙрдЗрдб рдПрд╕рдбреАрдХреЗ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИред  рдпрд╣ рдХрд╛рдлреА рдХреБрдЫ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдЧрд╛, рд▓реЗрдХрд┐рди рд╣рдо рдХреЗрд╡рд▓ рдЗрд╕ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░реЗрдВрдЧреЗ: <br><br><pre> <code class="plaintext hljs">$ $ANDROID_HOME/build-tools/28.0.2/dexdump -d classes.dex [0002d8] Java8.main:([Ljava/lang/String;)V 0000: sget-object v0, LJava8$1;.INSTANCE:LJava8$1; 0002: invoke-static {v0}, LJava8;.sayHi:(LJava8$Logger;)V 0005: return-void [0002a8] Java8.sayHi:(LJava8$Logger;)V 0000: const-string v0, "Hello" 0002: invoke-interface {v1, v0}, LJava8$Logger;.log:(Ljava/lang/String;)V 0005: return-void тАж</code> </pre> <br>  рдпрджрд┐ рдЖрдк рдЕрднреА рддрдХ рдмрд╛рдИрдЯрдХреЛрдб рдирд╣реАрдВ рдкрдврд╝рддреЗ рд╣реИрдВ, рддреЛ рдЪрд┐рдВрддрд╛ рди рдХрд░реЗрдВ: рдпрд╣рд╛рдБ рдЬреЛ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ, рдЙрд╕рдореЗрдВ рд╕реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рдХреЛ рд╕рд╣рдЬ рд░реВрдк рд╕реЗ рд╕рдордЭрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br>  рдкрд╣рд▓реЗ рдмреНрд▓реЙрдХ рдореЗрдВ, рдЗрдВрдбреЗрдХреНрд╕ <code>0000</code> рд╕рд╛рде рд╣рдорд╛рд░реА <code>main</code> рд╡рд┐рдзрд┐ рдХреЛ <code>INSTANCE</code> рдлрд╝реАрд▓реНрдб рд╕реЗ <code>INSTANCE</code> рдХреНрд▓рд╛рд╕ <code>Java8$1</code> рд╕рдВрджрд░реНрдн рдорд┐рд▓рддрд╛ рд╣реИред  рдпрд╣ рд╡рд░реНрдЧ <code></code> рджреМрд░рд╛рди рдЙрддреНрдкрдиреНрди рд╣реБрдЖ рдерд╛ред  рдореБрдЦреНрдп рд╡рд┐рдзрд┐ рдмрд╛рдЗрдЯрдХреЛрдб рдореЗрдВ рд╣рдорд╛рд░реЗ рд▓реИрдореНрдмреНрдбрд╛ рдХреЗ рд╢рд░реАрд░ рдХрд╛ рдХреЛрдИ рдЙрд▓реНрд▓реЗрдЦ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП, рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ, рдпрд╣ <code>Java8$1</code> рд╡рд░реНрдЧ рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рд╣реИред  рдЗрдВрдбреЗрдХреНрд╕ <code>0002</code> рддрдм <code>sayHi</code> рдХреЗ рд▓рд┐рдВрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ <code>sayHi</code> рд╕реНрдЯреЗрдЯрд┐рдХ рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред  <code>sayHi</code> рд▓рд┐рдП <code>Java8$Logger</code> рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ <code>Java8$1</code> рдЗрд╕ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред  рд╣рдо рдЗрд╕реЗ рдпрд╣рд╛рдВ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><pre> <code class="plaintext hljs">Class #2 - Class descriptor : 'LJava8$1;' Access flags : 0x1011 (PUBLIC FINAL SYNTHETIC) Superclass : 'Ljava/lang/Object;' Interfaces - #0 : 'LJava8$Logger;'</code> </pre> <br>  <code>SYNTHETIC</code> рдзреНрд╡рдЬ рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ <code>Java8$1</code> рд╡рд░реНрдЧ рдЙрддреНрдкрдиреНрди <code>Java8$1</code> рдЧрдпрд╛ рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреА рд╕реВрдЪреА рдореЗрдВ <code>Java8$Logger</code> ред <br>  рдпрд╣ рд╡рд░реНрдЧ рд╣рдорд╛рд░реЗ рд▓рдВрдмреЛрджрд░ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИред  рдпрджрд┐ рдЖрдк <code>log</code> рд╡рд┐рдзрд┐ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд▓реИрдореНрдмрдбрд╛ рдХреЗ рд╢рд░реАрд░ рдХреЛ рдирд╣реАрдВ рджреЗрдЦреЗрдВрдЧреЗред <br><br><pre> <code class="plaintext hljs">тАж [00026c] Java8$1.log:(Ljava/lang/String;)V 0000: invoke-static {v1}, LJava8;.lambda$main$0:(Ljava/lang/String;)V 0003: return-void тАж</code> </pre> <br>  рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, <code>Java8</code> рд╡рд░реНрдЧ рдХреА <code>static</code> рд╡рд┐рдзрд┐ рдХреЛ <code>Java8</code> - <code>Java8</code> <code>lambda$main$0</code> ред  рдореИрдВ рджреЛрд╣рд░рд╛рддрд╛ рд╣реВрдВ, рдпрд╣ рд╡рд┐рдзрд┐ рдХреЗрд╡рд▓ рдмрд╛рдЗрдЯрдХреЛрдб рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХреА рдЬрд╛рддреА рд╣реИред <br><br><pre> <code class="plaintext hljs">тАж #1 : (in LJava8;) name : 'lambda$main$0' type : '(Ljava/lang/String;)V' access : 0x1008 (STATIC SYNTHETIC) [0002a0] Java8.lambda$main$0:(Ljava/lang/String;)V 0000: sget-object v0, Ljava/lang/System;.out:Ljava/io/PrintStream; 0002: invoke-virtual {v0, v1}, Ljava/io/PrintStream;.println:(Ljava/lang/String;)V 0005: return-void</code> </pre> <br>  <code>SYNTHETIC</code> рдзреНрд╡рдЬ рдлрд┐рд░ рд╕реЗ рд╣рдореЗрдВ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рд╡рд┐рдзрд┐ рдЙрддреНрдкрдиреНрди рдХреА рдЧрдИ рдереА, рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рдЗрдЯрдХреЛрдб рдореЗрдВ рдХреЗрд╡рд▓ рд▓реИрдореНрдмрдбрд╛ рдмреЙрдбреА рд╢рд╛рдорд┐рд▓ рд╣реИ: <code>System.out.println</code> рд▓рд┐рдП рдПрдХ рдХреЙрд▓ред  рд▓реИрдореНрдмреНрдбрд╛ рдмреЙрдбреА <i>Java8.class рдХреЗ</i> рдЕрдВрджрд░ рд╣реЛрдиреЗ рдХрд╛ рдХрд╛рд░рдг рд╕рд░рд▓ рд╣реИ - рдЗрд╕рдХреЗ рд▓рд┐рдП рдХрдХреНрд╖рд╛ рдХреЗ <code>private</code> рд╕рджрд╕реНрдпреЛрдВ рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬрд┐рд╕реЗ рдЙрддреНрдкрдиреНрди рд╡рд░реНрдЧ рддрдХ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╣реЛрдЧреАред <br><br>  рд╕рдм рдХреБрдЫ рдЖрдкрдХреЛ рдпрд╣ рд╕рдордЭрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдХреИрд╕реЗ <i>desaccharization</i> рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рд╣реИред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕реЗ Dalvik bytecode рдореЗрдВ рджреЗрдЦрддреЗ рд╣реБрдП, рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╕рдм рдХреБрдЫ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рдФрд░ рднрдпрд╛рд╡рд╣ рд╣реИред <br><br><h2>  рд╕реНрд░реЛрдд рдкрд░рд┐рд╡рд░реНрддрди </h2><br>  рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ <i>desaccharization</i> рдХреИрд╕реЗ рд╣реЛрддрд╛ рд╣реИ, рдЖрдЗрдП рд╣рдорд╛рд░реА рдХрдХреНрд╖рд╛ рдХреЛ рдХреБрдЫ рдРрд╕реА рдЪреАрдЬреЛрдВ рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрджрдо рд╕реЗ рдХрджрдо рдорд┐рд▓рд╛рдХрд░ рджреЗрдЦреЗрдВ рдЬреЛ рдПрдкреАрдЖрдИ рдХреЗ рд╕рднреА рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдкрд░ рдХрд╛рдо рдХрд░реЗрдВрдЧреАред <br><br>  рдЪрд▓реЛ рдПрдХ рдЖрдзрд╛рд░ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реИрдореНрдмреНрдбрд╛ рдХреЗ рд╕рд╛рде рдПрдХ рд╣реА рд╡рд░реНрдЧ рд▓реЗрддреЗ рд╣реИрдВ: <br><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Java8</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Logger</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">log</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String... args)</span></span></span><span class="hljs-function"> </span></span>{ sayHi(s -&gt; System.out.println(s)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sayHi</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Logger logger)</span></span></span><span class="hljs-function"> </span></span>{ logger.log(<span class="hljs-string"><span class="hljs-string">"Hello!"</span></span>); } }</code> </pre> <br>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд▓реИрдореНрдмреНрдбрд╛ рдмреЙрдбреА рдХреЛ <code>package private</code> рдореЗрдердб рдореЗрдВ рд▓реЗ рдЬрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br><pre> <code class="diff hljs"> public static void main(String... args) { - sayHi(s -&gt; System.out.println(s)); + sayHi(s -&gt; lambda$main$0(s)); } + + static void lambda$main$0(String s) { + System.out.println(s); + }</code> </pre> <br>  рдлрд┐рд░ рдПрдХ рд╡рд░реНрдЧ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ <code>Logger</code> рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдЕрдВрджрд░ рд▓реИрдореНрдмреНрдбрд╛ рдмреЙрдбреА рд╕реЗ рдХреЛрдб рдХрд╛ рдПрдХ рдмреНрд▓реЙрдХ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИред <br><br><pre> <code class="diff hljs"> public static void main(String... args) { - sayHi(s -&gt; lambda$main$0(s)); + sayHi(new Java8$1()); } @@ } + +class Java8$1 implements Java8.Logger { + @Override public void log(String s) { + Java8.lambda$main$0(s); + } +}</code> </pre> <br>  рдЗрд╕рдХреЗ рдмрд╛рдж, <code>Java8$1</code> рдПрдХ рд╕рд┐рдВрдЧрд▓рдЯрди рдЗрдВрд╕реНрдЯреЗрдВрд╕ <code>Java8$1</code> , рдЬрд┐рд╕реЗ <code>static</code> рд╡реЗрд░рд┐рдПрдмрд▓ <code>INSTANCE</code> рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br><pre> <code class="diff hljs"> public static void main(String... args) { - sayHi(new Java8$1()); + sayHi(Java8$1.INSTANCE); } @@ class Java8$1 implements Java8.Logger { + static final Java8$1 INSTANCE = new Java8$1(); + @Override public void log(String s) {</code> </pre> <br>  рдпрд╣рд╛рдВ рдЕрдВрддрд┐рдо <i>рдбрдм рдХреА рдЧрдИ</i> рдХрдХреНрд╖рд╛ рд╣реИ <i>рдЬрд┐рд╕реЗ</i> рдПрдкреАрдЖрдИ рдХреЗ рд╕рднреА рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдкрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: <br><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Java8</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Logger</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">log</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String... args)</span></span></span><span class="hljs-function"> </span></span>{ sayHi(Java8$<span class="hljs-number"><span class="hljs-number">1</span></span>.INSTANCE); } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> lambda$main$<span class="hljs-number"><span class="hljs-number">0</span></span>(String s) { System.out.println(s); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sayHi</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Logger logger)</span></span></span><span class="hljs-function"> </span></span>{ logger.log(<span class="hljs-string"><span class="hljs-string">"Hello!"</span></span>); } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Java8</span></span></span><span class="hljs-class">$1 </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Java8</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Logger</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Java8$<span class="hljs-number"><span class="hljs-number">1</span></span> INSTANCE = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Java8$<span class="hljs-number"><span class="hljs-number">1</span></span>(); <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">log</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span><span class="hljs-function"> </span></span>{ Java8.lambda$main$<span class="hljs-number"><span class="hljs-number">0</span></span>(s); } }</code> </pre> <br>  рдпрджрд┐ рдЖрдк Dalvik bytecode рдореЗрдВ рдЙрддреНрдкрдиреНрди рд╡рд░реНрдЧ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ Java8 $ 1 рдЬреИрд╕реЗ рдирд╛рдо рдирд╣реАрдВ рдорд┐рд▓реЗрдВрдЧреЗ - рдХреБрдЫ рдРрд╕рд╛ рд╣реЛрдЧрд╛ <code>-$$Lambda$Java8$QkyWJ8jlAksLjYziID4cZLvHwoY</code> ред  рдХрдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рдЗрд╕ рддрд░рд╣ рдХреЗ рдирд╛рдордХрд░рдг рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИ, рдФрд░ рдЗрд╕рдХреЗ рдлрд╛рдпрджреЗ рдХреНрдпрд╛ рд╣реИрдВ, рдПрдХ рдЕрд▓рдЧ рд▓реЗрдЦ рдореЗрдВ рдЖрддрд╛ рд╣реИред <br><br><h2>  рдореВрд▓ рдирд┐рд╡рд╛рд╕реА рдореЗрдордиреЗ рдХрд╛ рд╕рдорд░реНрдерди </h2><br>  рдЬрдм рд╣рдордиреЗ <code>dx tool</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рд▓реИрдореНрдмрджрд╛рд╕ рд╕реЗ рдпреБрдХреНрдд рдХреНрд▓рд╛рд╕ рдХреЛ рд╕рдВрдХрд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛, рддреЛ рдПрдХ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдиреЗ рдХрд╣рд╛ рдХрд┐ рдпрд╣ рдХреЗрд╡рд▓ 26 APIs рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░реЗрдЧрд╛ред <br><br><pre> <code class="plaintext hljs">$ $ANDROID_HOME/build-tools/28.0.2/dx --dex --output . *.class Uncaught translation error: com.android.dx.cf.code.SimException: ERROR in Java8.main:([Ljava/lang/String;)V: invalid opcode ba - invokedynamic requires --min-sdk-version &gt;= 26 (currently 13) 1 error; aborting</code> </pre> <br>  рдЗрд╕рд▓рд┐рдП, рдпрд╣ рддрд░реНрдХрд╕рдВрдЧрдд рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЕрдЧрд░ рд╣рдо рдЗрд╕реЗ <code>тАФmin-api 26</code> рдзреНрд╡рдЬ рдХреЗ рд╕рд╛рде рд╕рдВрдХрд▓рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ desaccharization рдирд╣реАрдВ рд╣реЛрдЧрд╛ред <br><br><pre> <code class="bash hljs">$ java -jar d8.jar \ --lib <span class="hljs-variable"><span class="hljs-variable">$ANDROID_HOME</span></span>/platforms/android-28/android.jar \ --release \ --min-api 26 \ --output . \ *.class</code> </pre> <br>  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдЧрд░ рд╣рдо <code>.dex</code> рдлрд╝рд╛рдЗрд▓ рдХреЛ рдбрдВрдк рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдЕрднреА рднреА рдЗрд╕рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ <code>-$$Lambda$Java8$QkyWJ8jlAksLjYziID4cZLvHwoY</code> ред  рдРрд╕рд╛ рдХреНрдпреЛрдВ?  рдпрд╣ рдПрдХ рдбреА 8 рдмрдЧ рд╣реИ? <br><br>  рдЗрд╕ рдкреНрд░рд╢реНрди рдХрд╛ рдЙрддреНрддрд░ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП, рдФрд░ рдпрд╣ рднреА рдХрд┐ рдбрд┐рд╕реНрдЪрд╛рд░реНрдЬрд╛рдЗрдЬреЗрд╢рди <i>рд╣рдореЗрд╢рд╛</i> рдХреНрдпреЛрдВ <i>рд╣реЛрддрд╛ рд╣реИ</i> , рд╣рдореЗрдВ рдЬрд╛рд╡рд╛ <code>Java8</code> рд╡рд░реНрдЧ рдХреЗ рдЬрд╛рд╡рд╛ рдмрд╛рдЗрдЯрдХреЛрдб рдХреЗ рдЕрдВрджрд░ рджреЗрдЦрдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред <br><br><pre> <code class="bash hljs">$ javap -v Java8.class class Java8 { public static void main(java.lang.String...); Code: 0: invokedynamic <span class="hljs-comment"><span class="hljs-comment">#2, 0 // InvokeDynamic #0:log:()LJava8$Logger; 5: invokestatic #3 // Method sayHi:(LJava8$Logger;)V 8: return } тАж</span></span></code> </pre> <br>  <code>main</code> рд╡рд┐рдзрд┐ рдХреЗ рдЕрдВрджрд░, рд╣рдо рдлрд┐рд░ рд╕реЗ <code>0</code> рдЗрдВрдбреЗрдХреНрд╕ рдкрд░ <i>рдЗрдиреНрд╡реЛрдХреЗрдиреНрдбреЗрдорд┐рдХ</i> рджреЗрдЦрддреЗ рд╣реИрдВред  рдХреЙрд▓ рдореЗрдВ рджреВрд╕рд░рд╛ рддрд░реНрдХ <code>0</code> - рдЗрд╕рд╕реЗ рдЬреБрдбрд╝реЗ <a href="https://stackoverflow.com/questions/30733557/what-is-a-bootstrap-method">рдмреВрдЯрд╕реНрдЯреНрд░реИрдк</a> рд╡рд┐рдзрд┐ рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХред <br><br>  рдпрд╣рд╛рдВ <i>рдмреВрдЯрд╕реНрдЯреНрд░реИрдк</i> рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рджреА рдЧрдИ рд╣реИ: <br><br><pre> <code class="plaintext hljs">тАж BootstrapMethods: 0: #27 invokestatic java/lang/invoke/LambdaMetafactory.metafactory:( Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String; Ljava/lang/invoke/MethodType;Ljava/lang/invoke/MethodType; Ljava/lang/invoke/MethodHandle;Ljava/lang/invoke/MethodType;) Ljava/lang/invoke/CallSite; Method arguments: #28 (Ljava/lang/String;)V #29 invokestatic Java8.lambda$main$0:(Ljava/lang/String;)V #28 (Ljava/lang/String;)V</code> </pre> <br>  рдпрд╣рд╛рдБ <i>рдмреВрдЯрд╕реНрдЯреНрд░реИрдк</i> рд╡рд┐рдзрд┐ рдХреЛ <code>java.lang.invoke.LambdaMetafactory</code> рд╡рд░реНрдЧ рдореЗрдВ <code>metafactory</code> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╡рд╣ <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/invoke/LambdaMetafactory.html">рдЬреЗрдбреАрдХреЗ рдореЗрдВ рд░рд╣рддрд╛ рд╣реИ</a> рдФрд░ рд▓рдВрдмреЛрджрд░ рдХреЗ рд▓рд┐рдП рд░рди-рдЯрд╛рдЗрдо рдореЗрдВ рдЧреБрдордирд╛рдо рдСрди-рдж-рдХреНрд▓рд╛рд╕ рдХрдХреНрд╖рд╛рдПрдВ рдмрдирд╛рддрд╛ рд╣реИ, рдЙрд╕реА рддрд░рд╣ рдЬреИрд╕реЗ рдбреА 8 рдЙрдиреНрд╣реЗрдВ рдЧрдгрдирд╛ рд╕рдордп рдореЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИред <br><br>  рдпрджрд┐ рдЖрдк <a href="https://developer.android.com/reference/java/lang/invoke/package-summary"><code> Android  java.lang.invoke</code></a> <br>  рдпрд╛ <a href="https://android.googlesource.com/platform/libcore/%2B/master/ojluni/src/main/java/java/lang/invoke/"><code> AOSP  java.lang.invoke</code></a> рдХреЗ <a href="https://android.googlesource.com/platform/libcore/%2B/master/ojluni/src/main/java/java/lang/invoke/"><code> AOSP  java.lang.invoke</code></a> , рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рд╡рд░реНрдЧ рд░рдирдЯрд╛рдЗрдо рдореЗрдВ рдирд╣реАрдВ рд╣реИред  рдпрд╣реА рдХрд╛рд░рдг рд╣реИ рдХрд┐ рдбреА-рдЬреБрдЧрд▓рд┐рдВрдЧ рд╣рдореЗрд╢рд╛ рд╕рдВрдХрд▓рди рдХреЗ рд╕рдордп рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд╕реЗ рдХреЛрдИ рдлрд░реНрдХ рдирд╣реАрдВ рдкрдбрд╝рддрд╛ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреНрдпрд╛ рд╣реИред  VM <code>invokedynamic</code> рд╕рдорд╛рди <code>invokedynamic</code> рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди <code>invokedynamic</code> рдмрд┐рд▓реНрдЯ-рдЗрди JDK рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИред <br><br><h2>  рд╡рд┐рдзрд┐ рд╕рдВрджрд░реНрдн </h2><br>  рд▓реИрдореНрдмреНрдбрд╛ рдХреЗ рд╕рд╛рде, рдЬрд╛рд╡рд╛ 8 рдиреЗ рд╡рд┐рдзрд┐ рд╕рдВрджрд░реНрдн рдЬреЛрдбрд╝рд╛ - рдпрд╣ рдПрдХ рд▓рдВрдмреЛрджрд╛ рдмрдирд╛рдиреЗ рдХрд╛ рдПрдХ рдкреНрд░рднрд╛рд╡реА рддрд░реАрдХрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рд╢рд░реАрд░ рдПрдХ рдореМрдЬреВрджрд╛ рдкрджреНрдзрддрд┐ рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрддрд╛ рд╣реИред <br><br>  рд╣рдорд╛рд░рд╛ <code>Logger</code> рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдРрд╕рд╛ рд╣реА рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИред  рдореЗрдордиреЗ рдХреЗ рд╢рд░реАрд░ рдХреЛ <code>System.out.println</code> рд▓рд┐рдП рд╕рдВрджрд░реНрднрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЖрдЗрдП рд▓реИрдореНрдмрдбрд╛ рдХреЛ рд╕рдВрджрд░реНрдн рд╡рд┐рдзрд┐ рдореЗрдВ рдмрджрд▓рддреЗ рд╣реИрдВ: <br><br><pre> <code class="diff hljs"> public static void main(String... args) { - sayHi(s -&gt; System.out.println(s)); + sayHi(System.out::println); }</code> </pre> <br>  рдЬрдм рд╣рдо рдЗрд╕реЗ рд╕рдВрдХрд▓рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдмрд╛рдпрдЯреЗрдХреЛрдб рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдкрд┐рдЫрд▓реЗ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд╕рд╛рде рдПрдХ рдЕрдВрддрд░ рджреЗрдЦреЗрдВрдЧреЗ: <br><br><pre> <code class="plaintext hljs">[000268] -$$Lambda$1Osqr2Z9OSwjseX_0FMQJcCG_uM.log:(Ljava/lang/String;)V 0000: iget-object v0, v1, L-$$Lambda$1Osqr2Z9OSwjseX_0FMQJcCG_uM;.f$0:Ljava/io/PrintStream; 0002: invoke-virtual {v0, v2}, Ljava/io/PrintStream;.println:(Ljava/lang/String;)V 0005: return-void</code> </pre> <br>  рдЙрддреНрдкрдиреНрди <code>Java8.lambda$main$0</code> рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рдЬрд┐рд╕рдореЗрдВ <code>System.out.println</code> рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЕрдм <code>System.out.println</code> рдХреЛ рд╕реАрдзреЗ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рд▓реИрдореНрдмреНрдбрд╛ рдХреЗ рд╕рд╛рде рдПрдХ рд╡рд░реНрдЧ рдЕрдм рдПрдХ <code>static</code> рдПрдХрд▓ рдирд╣реАрдВ рд░рд╣ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрдВрдбреЗрдХреНрд╕ <code>0000</code> рджреНрд╡рд╛рд░рд╛ рдмрд╛рдЗрдЯрдХреЛрдб рдореЗрдВ, рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рд╣рдореЗрдВ <code>PrintStream</code> - <code>System.out</code> рд▓рд┐рдВрдХ рдорд┐рд▓рддрд╛ рд╣реИ, рдЬреЛ рддрдм рдЙрд╕ рдкрд░ <code>PrintStream</code> рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдорд╛рд░реА рдХрдХреНрд╖рд╛ рдЗрд╕ рдореЗрдВ рдмрджрд▓ рдЧрдИ: <br><br><pre> <code class="diff hljs"> public static void main(String... args) { - sayHi(System.out::println); + sayHi(new -$$Lambda$1Osqr2Z9OSwjseX_0FMQJcCG_uM(System.out)); } @@ } + +class -$$Lambda$1Osqr2Z9OSwjseX_0FMQJcCG_uM implements Java8.Logger { + private final PrintStream ps; + + -$$Lambda$1Osqr2Z9OSwjseX_0FMQJcCG_uM(PrintStream ps) { + this.ps = ps; + } + + @Override public void log(String s) { + ps.println(s); + } +}</code> </pre> <br><h2>  рдЗрдВрдЯрд░рдлреЗрд╕ рдореЗрдВ <code>Default</code> рдФрд░ <code>static</code> рддрд░реАрдХреЗ </h2><br>  рдПрдХ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдФрд░ рдкреНрд░рдореБрдЦ рдмрджрд▓рд╛рд╡ рдЬреЛ рдЬрд╛рд╡рд╛ 8 рд▓рд╛рдпрд╛ рдЧрдпрд╛ рдерд╛, рд╡рд╣ рдЗрдВрдЯрд░рдлреЗрд╕ рдореЗрдВ <code>default</code> рдФрд░ <code>static</code> рддрд░реАрдХреЛрдВ рдХреА рдШреЛрд╖рдгрд╛ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдерд╛ред <br><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Logger</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">log</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">default</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">log</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String tag, String s)</span></span></span><span class="hljs-function"> </span></span>{ log(tag + <span class="hljs-string"><span class="hljs-string">": "</span></span> + s); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Logger </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">systemOut</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> System.out::println; } }</code> </pre> <br>  рдпрд╣ рд╕рдм D8 рджреНрд╡рд╛рд░рд╛ рднреА рд╕рдорд░реНрдерд┐рдд рд╣реИред  рдкрд╣рд▓реЗ рдХреЗ рд╕рдорд╛рди рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛, <code>default</code> рдФрд░ <code>static</code> рддрд░реАрдХреЛрдВ рд╕реЗ рд▓реЙрдЧрд░ рдХреЗ рд▓реЙрдЧ-рдЗрди рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рджреЗрдЦрдирд╛ рдЖрд╕рд╛рди рд╣реИред  рд▓реИрдореНрдмреНрдбрд╛ рдФрд░ <code>method references</code> рдореЗрдВ рд╕реЗ рдПрдХ рдЕрдВрддрд░ рдпрд╣ рд╣реИ рдХрд┐ рдПрдВрдбреНрд░реЙрдЗрдб рд╡реАрдПрдо рдореЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдФрд░ рд╕реНрдерд┐рд░ рддрд░реАрдХреЗ рд▓рд╛рдЧреВ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░, 24 рдПрдкреАрдЖрдИ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ, рдбреА 8 рдЙрдиреНрд╣реЗрдВ <i>рдХрдо</i> рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред <br><br><h2>  рд╢рд╛рдпрдж рдХреЛрдЯрд▓рд┐рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ? </h2><br>  рд▓реЗрдЦ рдкрдврд╝рддреЗ рд╣реБрдП, рдЖрдк рдореЗрдВ рд╕реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рдиреЗ рд╢рд╛рдпрдж рдХреЛрдЯрд▓рд┐рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реЛрдЪрд╛ рдерд╛ред  рд╣рд╛рдВ, рдпрд╣ рд╕рднреА рдЬрд╛рд╡рд╛ 8 рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрдиреНрд╣реЗрдВ рдХреБрдЫ рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЗ рдЕрдкрд╡рд╛рдж рдХреЗ рд╕рд╛рде рдбреА 8 рдХреЗ рд░реВрдк рдореЗрдВ <code>kotlinc</code> рджреНрд╡рд╛рд░рд╛ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ <code>kotlinc</code> рд╣реИред <br><br>  рдЗрд╕рд▓рд┐рдП, рдЬрд╛рд╡рд╛ рдХреЗ рдирдП рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдВрдбреНрд░реЙрдЗрдб рд╕рдорд░реНрдерди рдЕрднреА рднреА рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рднрд▓реЗ рд╣реА рдЖрдкрдХрд╛ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЛрдЯрд▓рд┐рди рдореЗрдВ 100% рд▓рд┐рдЦрд╛ рд╣реЛред <br><br>  рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдХреЛрдЯрд▓реАрди рдЬрд╛рд╡рд╛ 6 рдФрд░ рдЬрд╛рд╡рд╛ 7 рдмрд╛рдпреЛрдЯреЗрдХ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рджреЗрдЧрд╛ред <a href="https://blog.jetbrains.com/idea/2015/12/intellij-idea-16-eap-144-2608-is-out/">рдЗрдВрдЯреЗрд▓реАрдЬреЗ рдЖрдИрдбреАрдИрдП</a> , рдЧреНрд░реИрдбрд▓ 5.0 рдЬрд╛рд╡рд╛ рдкрд░ рд╕реНрд╡рд┐рдЪ рд╣реЛ рдЧрдпрд╛ред рдкреБрд░рд╛рдиреЗ рдЬреЗрд╡реАрдПрдо рдкрд░ рдЪрд▓рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдореЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХрдо рд╣реЛ рд░рд╣реА рд╣реИред <br><br><h2>  API рдХрд╛ рд╡рд░реНрдгрди рдХрд░рдирд╛ </h2><br>  рдЗрд╕ рдмрд╛рд░ рдореИрдВрдиреЗ рдЬрд╛рд╡рд╛ 8 рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХреА, рд▓реЗрдХрд┐рди рдирдП рдПрдкреАрдЖрдИ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рднреА рдирд╣реАрдВ рдХрд╣рд╛ - рдзрд╛рд░рд╛рдПрдВ, <code>CompletableFuture</code> , рджрд┐рдирд╛рдВрдХ / рд╕рдордп рдФрд░ рдЗрд╕реА рддрд░рд╣ред <br><br>  рд▓рдХрдбрд╝рд╣рд╛рд░рд╛ рдЙрджрд╛рд╣рд░рдг рдкрд░ рд▓реМрдЯрддреЗ рд╣реБрдП, рд╣рдо рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдирдИ рддрд┐рдерд┐ / рд╕рдордп рдПрдкреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.time.*; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Java8</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Logger</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">log</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(LocalDateTime time, String s)</span></span></span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String... args)</span></span></span><span class="hljs-function"> </span></span>{ sayHi((time, s) -&gt; System.out.println(time + <span class="hljs-string"><span class="hljs-string">" "</span></span> + s)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sayHi</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Logger logger)</span></span></span><span class="hljs-function"> </span></span>{ logger.log(LocalDateTime.now(), <span class="hljs-string"><span class="hljs-string">"Hello!"</span></span>); } }</code> </pre> <br>  рдЗрд╕реЗ <code>javac</code> рд╕рд╛рде рдлрд┐рд░ рд╕реЗ <i>рд╕рдВрдХрд▓рд┐рдд рдХрд░реЗрдВ</i> рдФрд░ D8 рдХреЗ рд╕рд╛рде Dalvik bytecode рдореЗрдВ рдХрдирд╡рд░реНрдЯ рдХрд░реЗрдВ, рдЬреЛ API рдХреЗ рд╕рднреА рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдкрд░ рд╕рдорд░реНрдерди рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ <i>рдбрд┐рдХреЙрдЙрдВрдЯ</i> рдХрд░рддрд╛ рд╣реИред <br><br><pre> <code class="plaintext hljs">$ javac *.java $ java -jar d8.jar \ --lib $ANDROID_HOME/platforms/android-28/android.jar \ --release \ --output . \ *.class</code> </pre> <br>  рдЖрдк рдЗрд╕реЗ рдЕрдкрдиреЗ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рднреА рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╣реЛ рд╕рдХреЗ рдХрд┐ рдпрд╣ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред <br><br><pre> <code class="plaintext hljs">$ adb push classes.dex /sdcard classes.dex: 1 file pushed. 0.5 MB/s (1620 bytes in 0.003s) $ adb shell dalvikvm -cp /sdcard/classes.dex Java8 2018-11-19T21:38:23.761 Hello</code> </pre> <br>  рдпрджрд┐ API 26 рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рдж рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдЗрд╕ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рд╣реИ, рддреЛ рд╣реИрд▓реЛ рд╕рдВрджреЗрд╢ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ред  рдпрджрд┐ рдирд╣реАрдВ, рддреЛ рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рджреЗрдЦреЗрдВрдЧреЗ: <br><br><pre> <code class="plaintext hljs">java.lang.NoClassDefFoundError: Failed resolution of: Ljava/time/LocalDateTime; at Java8.sayHi(Java8.java:13) at Java8.main(Java8.java:9)</code> </pre> <br>  D8 рдиреЗ рд▓реИрдореНрдмреНрдбрд╛, рдПрдХ рд░реЗрдлрд░реЗрдВрд╕ рдореЗрдердб рд╕реЗ рдирд┐рдкрдЯрд╛, рд▓реЗрдХрд┐рди <code>LocalDateTime</code> рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдФрд░ рдпрд╣ рдмрд╣реБрдд рджреБрдЦрдж рд╣реИред <br><br>  рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЛ рддрд╛рд░реАрдЦ / рд╕рдордп <code>ThreeTenBP</code> рдкрд░ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдпрд╛ рд░реИрдкрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ <code>ThreeTenBP</code> , рдпрд╛ рд╕рдордп рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>ThreeTenBP</code> рдЬреИрд╕реЗ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ <code>ThreeTenBP</code> рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдк рдЕрдкрдиреЗ рд╣рд╛рдереЛрдВ рд╕реЗ рдбреА 8 рдХреНрдпреЛрдВ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ? <br><br><h2>  рдЙрдкрд╕рдВрд╣рд╛рд░ </h2><br>  рд╕рднреА рдирдП рдЬрд╛рд╡рд╛ 8 рдПрдкреАрдЖрдИ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдХреА рдХрдореА Android рдкрд╛рд░рд┐рд╕реНрдерд┐рддрд┐рдХреА рддрдВрддреНрд░ рдореЗрдВ рдПрдХ рдмрдбрд╝реА рд╕рдорд╕реНрдпрд╛ рдмрдиреА рд╣реБрдИ рд╣реИред  рдЖрдЦрд┐рд░рдХрд╛рд░, рдпрд╣ рд╕рдВрднрд╛рд╡рдирд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рд╣рдо рдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рд╣рдореЗрдВ рдЕрдкрдиреА рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ 26 рдорд┐рдирдЯ рдПрдкреАрдЖрдИ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИред  рдПрдВрдбреНрд░реЙрдЗрдб рдФрд░ JVM рджреЛрдиреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкреБрд╕реНрддрдХрд╛рд▓рдп 5 рд╕рд╛рд▓ рдкрд╣рд▓реЗ рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рдкреЗрд╢ рдХрд┐рдП рдЧрдП рдПрдкреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ! <br><br>  рдФрд░ рднрд▓реЗ рд╣реА Java 8 рд╕рдкреЛрд░реНрдЯ рдЕрдм D8 рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ, рдлрд┐рд░ рднреА рд╣рд░ рдбреЗрд╡рд▓рдкрд░ рдХреЛ рдЬрд╛рд╡рд╛ рдореЗрдВ рд╕реНрд░реЛрдд рдФрд░ рд▓рдХреНрд╖реНрдп рд╕рдВрдЧрддрддрд╛ рдХреЛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рдЬрд╛рд╡рд╛ 8 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рдмрд┐рдЫрд╛рдХрд░ рдЗрд╕ рдкреНрд░рд╡реГрддреНрддрд┐ рдХреЛ рд╕реБрджреГрдврд╝ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред (рднрд▓реЗ рд╣реА рдЖрдк рдирдИ рднрд╛рд╖рд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд░рд╣реЗ рд╣реЛрдВ)ред <br><br>  рдбреА 8 рдкрд░ рдмрд╣реБрдд рдХрд╛рдо рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рднрд╛рд╖рд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рд╕рдорд░реНрдерди рд╕реЗ рд╕рдм рдХреБрдЫ рдареАрдХ рд╣реЛрдЧрд╛  рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЕрдЧрд░ рдЖрдк рдХреЗрд╡рд▓ рдХреЛрдЯрд▓рд┐рди рдкрд░ рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рддреЛ рдПрдВрдбреНрд░реЙрдЗрдб рдбреЗрд╡рд▓рдкрдореЗрдВрдЯ рдЯреАрдо рдХреЛ рдЬрд╛рд╡рд╛ рдХреЗ рд╕рднреА рдирдП рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╛рдзреНрдп рдХрд░рдирд╛, рдмрд╛рдИрдЯреЗрдХреЛрдб рдФрд░ рдирдП рдПрдкреАрдЖрдИ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рдирд╛ рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред <br><br>  рдпрд╣ рдкреЛрд╕реНрдЯ <a href="https://jakewharton.com/digging-into-d8-and-r8/">D8 рдФрд░ R8 рдореЗрдВ</a> рдореЗрд░реА рдмрд╛рдд <a href="https://jakewharton.com/digging-into-d8-and-r8/">рдЦреЛрджрдиреЗ</a> рдХрд╛ рдПрдХ рд▓рд┐рдЦрд┐рдд рд╕рдВрд╕реНрдХрд░рдг рд╣реИред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi478692/">https://habr.com/ru/post/hi478692/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi478660/index.html">CERN рдореЗрдВ рдЗрдВрдЬреАрдирд┐рдпрд░ рдХрдг рдЬрд╛рд▓ рдХрд╛ рдЕрдиреБрдХреВрд▓рди рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi478670/index.html">рд╣рдорд▓рд╛рд╡рд░ рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рдореЗрдВ рдЖрдкрдХреЗ рдкрддреНрд░рд╛рдЪрд╛рд░ рдХреЛ рдХреИрд╕реЗ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред рдФрд░ рд╡реЗ рдЗрд╕реЗ рдХреИрд╕реЗ рд░реЛрдХ рд╕рдХрддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi478672/index.html">рдПрдЖрдИ рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдПрдВрдб рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк: рдПрдбрдо рдХрд╛рд░реНрдорд┐ (рдЕрдкреНрд▓рд╛рдЗрдЯреНрд╕) рдХреЗ рд╕рд╛рде рд╕рд╛рдХреНрд╖рд╛рддреНрдХрд╛рд░</a></li>
<li><a href="../hi478680/index.html">рдХреНрдпреЛрдВ, рдФрд░ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд╛рдд, рд▓реЛрдЧ рдЖрдИрдЯреА рд╕реЗ рдХрд╣рд╛рдВ рдЬрд╛рддреЗ рд╣реИрдВ?</a></li>
<li><a href="../hi478684/index.html">SSD рдХрд╛ рдкрд░рд┐рдЪрдпред рднрд╛рдЧ 2. рдЗрдВрдЯрд░рдлрд╝реЗрд╕</a></li>
<li><a href="../hi478694/index.html">рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо ivi рдСрдирд▓рд╛рдЗрди рд╕рд┐рдиреЗрдорд╛ рдореЗрдВ рдирд╡реАрдирддрдо рдХреИрдЯрд▓реЙрдЧ рдХреА рдЕрдиреБрд╢рдВрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВ (+ рдкрд╛рдпрдерди рдХреЛрдб)</a></li>
<li><a href="../hi478696/index.html">рдореИрдВрдиреЗ рдЕрд░реНрдмрди рдЯреЗрдХ 2019 рдХреИрд╕реЗ рджреЗрдЦрд╛ред рдЗрд╡реЗрдВрдЯ рд░рд┐рдкреЛрд░реНрдЯ</a></li>
<li><a href="../hi478698/index.html">рд╣рдо 15 рдорд┐рдирдЯ рдореЗрдВ рдПрдХ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдЗрд▓рд╛рдХреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi478702/index.html">рдХрдкреИрд╕рд┐рдЯрд░ рдореЗрдВ рдореЗрдЯреНрд░рд┐рдХ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕</a></li>
<li><a href="../hi478704/index.html">рдпрджрд┐ рдореЗрд▓рд┐рдВрдЧ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕реНрдкреИрдо: 5 рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдЪрд░рдгреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдЧрдИ рд╣реИ рддреЛ рдХреНрдпрд╛ рдХрд░реЗрдВ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>