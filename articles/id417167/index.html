<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🤝‍👨🏾 ✈️ 🐅 Luncurkan LDA di dunia nyata. Panduan lengkap 🧤 🎭 🌫️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kata Pengantar 


 Ada banyak tutorial di Internet yang menjelaskan cara kerja LDA (Alokasi Dirichlet Laten) dan cara menerapkannya. Contoh-contoh pel...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Luncurkan LDA di dunia nyata. Panduan lengkap</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417167/"><h2 id="predislovie">  Kata Pengantar </h2><br><p> Ada banyak tutorial di Internet yang menjelaskan cara kerja LDA (Alokasi Dirichlet Laten) dan cara menerapkannya.  Contoh-contoh pelatihan LDA sering ditunjukkan pada set data "contoh", seperti "20 newsgroup dataset," yang tersedia di sklearn. </p><br><p>  Fitur pelatihan tentang contoh dataset "contoh" adalah bahwa data selalu ada dalam urutan dan mudah ditumpuk di satu tempat.  Saat melatih model produksi, data yang diperoleh langsung dari sumber nyata biasanya sebaliknya: </p><br><ul><li>  Banyak emisi. </li><li>  Markup salah (jika ada). </li><li>  Ketidakseimbangan kelas yang sangat kuat dan distribusi jelek dari setiap parameter dataset. </li><li>  Untuk teks, ini adalah: kesalahan tata bahasa, sejumlah besar kata langka dan unik, multibahasa. </li><li>  Cara penyimpanan data yang tidak nyaman (format berbeda atau jarang, perlunya penguraian) </li></ul><br><p>  Secara historis, saya mencoba belajar dari contoh-contoh yang sedekat mungkin dengan realitas-realitas produksi karena dengan cara inilah orang dapat sepenuhnya merasakan area masalah dari jenis tugas tertentu.  Begitu juga dengan LDA, dan dalam artikel ini saya ingin berbagi pengalaman saya - bagaimana menjalankan LDA dari awal, pada data yang sepenuhnya mentah.  Beberapa bagian dari artikel akan dikhususkan untuk memperoleh data ini, sehingga contohnya menjadi 'kasus rekayasa' lengkap. </p><a name="habracut"></a><br><h2 id="topic-modeling-i-lda">  Pemodelan topik dan LDA. </h2><br><p>  Untuk memulai, pertimbangkan apa yang LDA lakukan secara umum dan tugas apa yang digunakannya. <br>  Paling sering, LDA digunakan untuk tugas Pemodelan Topik.  Tugas semacam itu berarti tugas pengelompokan atau pengelompokan teks - sedemikian rupa sehingga setiap kelas atau kelompok berisi teks dengan topik yang sama. </p><br><p>  Untuk menerapkan LDA ke dataset teks (selanjutnya disebut sebagai badan teks), perlu untuk mengubah tubuh menjadi matriks dokumen-istilah. </p><br><p>  Matriks dokumen istilah adalah matriks yang memiliki ukuran <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mtext>&amp;#xA0;</mtext><mi>k</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>W</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.016ex" height="2.057ex" viewBox="0 -780.1 3882 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-4E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-6B" x="1138" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-61" x="1660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-6C" x="2189" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-69" x="2488" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-57" x="2833" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mtext>&nbsp;</mtext><mi>k</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> N \ kali W </script>  dimana <br>  N adalah jumlah dokumen dalam case, dan W adalah ukuran dari kamus case i.e.  jumlah kata (unik) yang ditemukan di korpus kami.  Di baris ke-i, kolom ke-j dari matriks adalah angka - berapa kali dalam teks ke-i, kata ke-j ditemukan. </p><br><p>  LDA membangun, untuk matriks dokumen Term yang diberikan dan T dari sejumlah topik yang telah ditentukan, dua distribusi: </p><br><ol><li>  Distribusi topik dalam teks. (Dalam praktiknya, diberikan oleh ukuran matriks <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mtext>&amp;#xA0;</mtext><mi>k</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>T</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.217ex" height="2.057ex" viewBox="0 -780.1 3538 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-4E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-6B" x="1138" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-61" x="1660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-6C" x="2189" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-69" x="2488" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-54" x="2833" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mtext>&nbsp;</mtext><mi>k</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> N \ kali T </script>  ) </li><li>  Distribusi kata berdasarkan topik (Ukuran matriks <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi><mtext>&amp;#xA0;</mtext><mi>k</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>W</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.589ex" height="2.057ex" viewBox="0 -780.1 3698 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-6B" x="954" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-61" x="1476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-6C" x="2005" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-69" x="2304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-57" x="2649" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mtext>&nbsp;</mtext><mi>k</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> T \ kali W </script>  ) </li></ol><br><p>  Nilai-nilai sel-sel matriks ini, masing-masing, adalah probabilitas bahwa topik ini terkandung dalam dokumen ini (atau proporsi topik dalam dokumen, jika kita menganggap dokumen sebagai campuran dari berbagai topik) untuk matriks 'Distribusi topik dalam teks'. </p><br><p>  Untuk matriks 'Distribusi kata berdasarkan tema', nilainya adalah probabilitas bertemu kata j dalam teks dengan topik i, secara kualitatif, kita dapat menganggap angka-angka ini sebagai koefisien yang mengkarakterisasi bagaimana kata ini khas untuk topik ini. </p><br><p>  Harus dikatakan bahwa kata topik bukanlah definisi "sehari-hari" dari kata ini.  LDA mengalokasikan T untuk itu, tetapi topik macam apa ini dan apakah mereka sesuai dengan topik teks yang terkenal, seperti: 'Olahraga', 'Sains', 'Politik' tidak diketahui.  Dalam hal ini, lebih tepat untuk membicarakan topik sebagai semacam entitas abstrak, yang didefinisikan oleh garis dalam matriks distribusi kata berdasarkan topik dan dengan beberapa probabilitas yang sesuai dengan teks ini, jika Anda dapat membayangkannya sebagai kumpulan kumpulan kata karakteristik yang bertemu bersama dengan probabilitas yang sesuai. (dari tabel) dalam satu set teks tertentu. </p><br><p>  Jika Anda tertarik untuk mempelajari lebih detail dan 'dalam formula' bagaimana LDA dilatih dan bekerja, berikut adalah beberapa bahan (yang digunakan oleh penulis): </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel asli</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dalam bahasa Inggris, dengan contoh ilustrasi</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Detail dalam bahasa Rusia</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tentang Implementasi Python</a> </li></ul><br><h2 id="dobyvaem-dikie-dannye">  Kami mendapatkan data liar </h2><br><p>  Untuk 'pekerjaan laboratorium' kami, kami membutuhkan set data khusus dengan kekurangan dan fiturnya sendiri.  Anda bisa mendapatkannya di tempat yang berbeda: unduh ulasan dari Kinopoisk, artikel Wikipedia, berita dari beberapa portal berita, kami akan mengambil opsi yang sedikit lebih ekstrem - posting dari komunitas VKontakte. </p><br><p>  Kami akan melakukan ini seperti ini: </p><br><ol><li>  Kami memilih beberapa pengguna VK. </li><li>  Kami mendapatkan daftar semua teman-temannya. </li><li>  Untuk setiap teman, kami mengambil semua komunitasnya. </li><li>  Untuk setiap komunitas dari setiap teman, kami memompa keluar posting komunitas pertama n (n = 100) dan menggabungkannya menjadi satu konten teks komunitas. </li></ol><br><h4 id="instrumenty-i-stati">  Alat dan artikel </h4><br><p>  Untuk mengunduh posting kita akan menggunakan modul vk untuk bekerja dengan VKontakte API, untuk Python.  Salah satu momen paling rumit ketika menulis aplikasi menggunakan VKontakte API adalah otorisasi, untungnya, kode yang melakukan pekerjaan ini sudah ditulis dan berada dalam domain publik, kecuali untuk vk, saya menggunakan modul otorisasi kecil - vkauth. </p><br><p>  Tautan ke modul dan artikel yang digunakan untuk mempelajari VKontakte API: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">vkauth</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tutorial vkauth</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">vk tutorial</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">vk tutorial nomor 2</a> </li><li>  Dokumentasi resmi Vkontakte API </li></ul><br><h4 id="pishem-kod">  Menulis kode </h4><br><p>  Jadi, menggunakan vkauth, masuk: </p><br><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#authorization of app using modules imported. app_id = '6203169' perms = ['photos','friends','groups'] API_ver = '5.68' Auth = VKAuth(perms, app_id, API_ver) Auth.auth() token = Auth.get_token() user_id = Auth.get_user_id() #starting session session = vk.Session(access_token=token) api = vk.API(session)</span></span></code> </pre> <br><p>  Dalam prosesnya, modul kecil ditulis berisi semua fungsi yang diperlukan untuk mengunduh konten dalam format yang sesuai, yang tercantum di bawah ini, mari kita bahas: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_friends_ids</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(api, user_id)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">''' For a given API object and user_id returns a list of all his friends ids. '''</span></span> friends = api.friends.get(user_id=user_id, v = <span class="hljs-string"><span class="hljs-string">'5.68'</span></span>) friends_ids = friends[<span class="hljs-string"><span class="hljs-string">'items'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> friends_ids <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_user_groups</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(api, user_id, moder=True, only_open=True)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">''' For a given API user_id returns list of all groups he subscribed to. Flag model to get only those groups where user is a moderator or an admin) Flag only_open to get only public(open) groups. '''</span></span> kwargs = {<span class="hljs-string"><span class="hljs-string">'user_id'</span></span> : user_id, <span class="hljs-string"><span class="hljs-string">'v'</span></span> : <span class="hljs-string"><span class="hljs-string">'5.68'</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> moder == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: kwargs[<span class="hljs-string"><span class="hljs-string">'filter'</span></span>] = <span class="hljs-string"><span class="hljs-string">'moder'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> only_open == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: kwargs[<span class="hljs-string"><span class="hljs-string">'extended'</span></span>] = <span class="hljs-number"><span class="hljs-number">1</span></span> kwargs[<span class="hljs-string"><span class="hljs-string">'fields'</span></span>] = [<span class="hljs-string"><span class="hljs-string">'is_closed'</span></span>] groups = api.groups.get(**kwargs) groups_refined = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> group <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> groups[<span class="hljs-string"><span class="hljs-string">'items'</span></span>]: cond_check = (only_open <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> group[<span class="hljs-string"><span class="hljs-string">'is_closed'</span></span>] == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> only_open <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cond_check: refined = {} refined[<span class="hljs-string"><span class="hljs-string">'id'</span></span>] = group[<span class="hljs-string"><span class="hljs-string">'id'</span></span>] * (<span class="hljs-number"><span class="hljs-number">-1</span></span>) refined[<span class="hljs-string"><span class="hljs-string">'name'</span></span>] = group[<span class="hljs-string"><span class="hljs-string">'name'</span></span>] groups_refined.append(refined) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> groups_refined <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_n_posts_text</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(api, group_id, n_posts=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">50</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">''' For a given api and group_id returns first n_posts concatenated as one text. '''</span></span> wall_contents = api.wall.get(owner_id = group_id, count=n_posts, v = <span class="hljs-string"><span class="hljs-string">'5.68'</span></span>) wall_contents = wall_contents[<span class="hljs-string"><span class="hljs-string">'items'</span></span>] text = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> post <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> wall_contents: text += post[<span class="hljs-string"><span class="hljs-string">'text'</span></span>] + <span class="hljs-string"><span class="hljs-string">' '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> text</code> </pre> <br><p>  Pipa terakhir adalah sebagai berikut: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#id of user whose friends you gonna get, like: https://vk.com/id111111111 user_id = 111111111 friends_ids = vt.get_friends_ids(api, user_id) #collecting all groups groups = [] for i,friend in tqdm(enumerate(friends_ids)): if i % 3 == 0: sleep(1) friend_groups = vt.get_user_groups(api, friend, moder=False) groups += friend_groups #converting groups to dataFrame groups_df = pd.DataFrame(groups) groups_df.drop_duplicates(inplace=True) #reading content(content == first 100 posts) for i,group in tqdm(groups_df.iterrows()): name = group['name'] group_id = group['id'] #Different kinds of fails occures during scrapping #For examples there are names of groups with slashes #Like: 'The Kaaats / Indie-rock' try: content = vt.get_n_posts_text(api, group_id, n_posts=100) dst_path = join(data_path, name + '.txt') with open(dst_path, 'w+t') as f: f.write(content) except Exception as e: print('Error occured on group:', name) print(e) continue #need it because of requests limitaion in VK API. if i % 3 == 0: sleep(1)</span></span></code> </pre> <br><h4 id="fails">  Gagal </h4><br><p>  Secara umum, proses pengunduhan data tidak sulit dengan sendirinya, Anda harus memperhatikan hanya dua hal: </p><br><ol><li>  Terkadang, karena privasi beberapa komunitas, Anda akan menerima kesalahan akses, kadang-kadang kesalahan lain akan diselesaikan dengan menginstal coba, kecuali di tempat yang tepat. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">VK memiliki batasan</a> jumlah permintaan per detik. </li></ol><br><p>  Saat membuat sejumlah besar permintaan, misalnya dalam satu lingkaran, kami juga akan menemukan kesalahan.  Masalah ini dapat diselesaikan dengan beberapa cara: </p><br><ol><li>  Bodoh dan blak-blakan: Tetaplah tidur (beberapa) setiap 3 permintaan.  Ini dilakukan dalam satu baris dan sangat memperlambat pembongkaran, dalam situasi di mana volume data tidak besar, dan tidak ada waktu untuk metode yang lebih canggih - ini cukup dapat diterima. (Diterapkan dalam artikel ini) </li><li>  Memahami pekerjaan permintaan Polling Panjang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://vk.com/dev/using_longpoll</a> </li></ol><br><p>  Dalam tulisan ini, metode yang sederhana dan lambat dipilih, di masa depan, saya mungkin akan menulis artikel mikro tentang cara untuk memotong atau mengurangi pembatasan jumlah permintaan per detik. </p><br><h4 id="itog">  Ringkasan </h4><br><p>  Dengan "beberapa" pengguna memiliki ~ 150 teman, mereka berhasil mendapatkan 4.679 teks - masing-masing mencirikan komunitas VK tertentu.  Ukuran teks sangat bervariasi dan ditulis dalam banyak bahasa - beberapa di antaranya tidak cocok untuk tujuan kita, tetapi kita akan membicarakannya sedikit lebih jauh. </p><br><h3 id="osnovnaya-chast">  Tubuh utama </h3><br><p><img src="https://habrastorage.org/webt/bj/to/hm/bjtohmsrvsxlcbs78u0thlawxky.png" alt="gambar"></p><br><p>  Mari kita pergi melalui semua blok pipa kita - pertama, pada mandatory (Ideal), kemudian pada sisanya - mereka hanya dari kepentingan terbesar. </p><br><h4 id="countvectorizer">  Countvectorizer </h4><br><p>  Sebelum mengajar LDA, kita perlu mempresentasikan dokumen kita dalam bentuk matriks dokumen Jangka.  Ini biasanya termasuk operasi seperti: </p><br><ul><li>  Menghapus puttuctions / angka / token yang tidak perlu. </li><li>  Tokenisasi (presentasi sebagai daftar kata) </li><li>  Menghitung kata-kata, menyusun matriks dokumen termal. </li></ul><br><p>  Semua tindakan ini di sklearn diimplementasikan dengan mudah dalam kerangka satu entitas program - sklearn.feature_extraction.text.CountVectorizer. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tautan Dokumentasi</a> </p><br><p>  Yang perlu Anda lakukan adalah: </p><br><pre> <code class="python hljs">count_vect = CountVectorizer(input=<span class="hljs-string"><span class="hljs-string">'filename'</span></span>, stop_words=stopwords, vocabulary=voc) dataset = count_vect.fit_transform(train_names)</code> </pre> <br><h4 id="lda">  Lda </h4><br><p>  Demikian pula dengan CountVectorizer, LDA diimplementasikan dengan sempurna di Sklearn dan kerangka kerja lainnya, oleh karena itu, tidak ada gunanya mencurahkan banyak ruang secara langsung untuk implementasinya, dalam artikel kami yang sepenuhnya praktis. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tautan Dokumentasi</a> </p><br><p>  Yang Anda butuhkan untuk memulai LDA adalah: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#training LDA lda = LDA(n_components = 60, max_iter=30, n_jobs=6, learning_method='batch', verbose=1) lda.fit(dataset)</span></span></code> </pre> <br><h4 id="preprocessing">  Preprocessing </h4><br><p>  Jika kami hanya mengambil teks kami segera setelah mengunduhnya dan mengubahnya menjadi matriks dokumen-Term menggunakan CountVectorizer, dengan tokenizer bawaan bawaan, kami akan mendapatkan matriks ukuran 4679x769801 (pada data yang saya gunakan). </p><br><p>  Ukuran kamus kami adalah 769801. Bahkan jika kami berasumsi bahwa sebagian besar kata-kata informatif, kami masih tidak mungkin untuk mendapatkan LDA yang baik, sesuatu seperti "Kutukan Dimensi" menunggu kami, belum lagi bahwa untuk hampir semua komputer, kami hanya akan menyumbat semua RAM.  Sebenarnya, sebagian besar kata-kata ini sama sekali tidak informatif.  Sebagian besar dari mereka adalah: </p><br><ul><li>  Emoticon, karakter, angka. </li><li>  Kata-kata unik atau sangat langka (misalnya, kata-kata Polandia dari grup dengan meme Polandia, kata-kata dieja salah atau dalam 'Albania'). </li><li>  Bagian bicara yang sangat sering (mis. Preposisi dan kata ganti). </li></ul><br><p>  Selain itu, banyak grup di VK yang berspesialisasi secara khusus dalam gambar - hampir tidak ada tulisan di sana - teks yang terkait dengannya merosot, dalam matriks dokumen Thermal, mereka akan memberi kita hampir nol garis. </p><br><p>  Jadi, mari kita selesaikan semuanya! <br>  Kami tokenize semua teks, hapus tanda baca dan angka dari mereka, lihat histogram distribusi teks dengan jumlah kata: <br><img src="https://habrastorage.org/webt/v4/qh/w0/v4qhw0mrgpizranmnptbz5lnivk.png" alt="gambar"></p><br><p>  Kami menghapus semua teks yang lebih kecil dari 100 kata (ada 525 di antaranya) </p><br><p>  Sekarang kamus: <br>  Menghapus semua token (kata) yang bukan huruf, dalam kerangka tugas kita - ini cukup dapat diterima.  CountVectorizer melakukan ini sendiri, bahkan jika tidak, maka saya pikir tidak perlu memberikan contoh di sini (mereka berada dalam versi lengkap dari kode untuk artikel). </p><br><p>  Salah satu prosedur paling umum untuk mengurangi ukuran kamus adalah dengan menghapus apa yang disebut stopwords (stopwords) - kata-kata yang tidak membawa muatan semantik dan / atau tidak memiliki pewarnaan tematik (dalam kasus kami, Pemodelan Topik).  Kata-kata seperti itu dalam kasus kami adalah, misalnya: </p><br><ul><li>  Ucapan dan preposisi. </li><li>  Artikel -,, a. </li><li>  Kata-kata umum: 'menjadi', 'baik', 'mungkin', dll. </li></ul><br><p>  Modul nltk telah membentuk daftar stopword dalam bahasa Rusia dan Inggris, tetapi mereka agak lemah.  Di Internet, Anda juga dapat menemukan daftar stopword untuk bahasa apa pun dan menambahkannya ke yang ada di nltk.  Jadi kita akan lakukan.  Ambil stopwords tambahan dari sini: </p><br><ul><li>  <a href="">https://github.com/stopwords-iso/stopwords-ru/blob/master/stopwords-ru.json</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://gist.github.com/menzenski/7047705</a> </li></ul><br><p>  Dalam praktiknya, ketika memecahkan masalah tertentu, daftar kata kunci secara bertahap disesuaikan dan ditambah sebagai model dilatih, karena untuk setiap dataset tertentu dan masalah ada kata-kata "tidak konsisten" spesifik.  Kami juga akan mengambil kata kunci khusus setelah melatih LDA generasi pertama kami. </p><br><p>  Dengan sendirinya, prosedur untuk menghapus stopword dibangun ke dalam CountVectorizer - kita hanya perlu daftar mereka. </p><br><p>  Apakah yang sudah kita lakukan cukup? </p><br><p><img src="https://habrastorage.org/webt/ja/xd/6l/jaxd6lnbbnd_dmmmk6nog9a2ntm.png" alt="gambar"></p><br><p>  Sebagian besar kata-kata yang ada di kamus kami masih tidak terlalu informatif untuk mempelajari LDA pada mereka dan tidak ada dalam daftar kata kunci.  Oleh karena itu, kami menerapkan metode penyaringan lain ke data kami. </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>i</mi><mi>d</mi><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>o</mi><mi>g</mi><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mspace linebreak=&quot;newline&quot; /><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mtext>&amp;#xA0;</mtext><mi>d</mi><mi>a</mi><mi>l</mi><mi>a</mi><mi>m</mi><mi>D</mi><mo>:</mo><mi>t</mi><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><mi>d</mi><mspace linebreak=&quot;newline&quot; /></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="41.43ex" height="8.202ex" viewBox="0 -832 17837.8 3531.4" role="img" focusable="false" style="vertical-align: -6.27ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-69" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-64" x="345" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-66" x="869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMAIN-28" x="1419" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-74" x="1809" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMAIN-2C" x="2170" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-44" x="2615" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMAIN-29" x="3444" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMAIN-3D" x="4111" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-6C" x="5417" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-6F" x="5716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-67" x="6201" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-66" x="6932" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-72" x="7482" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-61" x="7934" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-63" x="8463" y="0"></use><g transform="translate(8897,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMAIN-7C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-44" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMAIN-7C" x="1107" y="0"></use></g><g transform="translate(10282,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMAIN-7C" x="0" y="0"></use><g transform="translate(0,-1432)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-64" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-61" x="1297" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-6C" x="1826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-61" x="2125" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-6D" x="2654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-44" x="3533" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMAIN-3A" x="4639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-74" x="5195" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-69" x="5807" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-6E" x="6152" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMATHI-64" x="6753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/417167/&amp;usg=ALkJrhgf9X_ENKDM1ekZ1WLs9BEW9an63Q#MJMAIN-7C" x="7276" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>i</mi><mi>d</mi><mi>f</mi><mo stretchy="false">(</mo><mi>t</mi><mo>,</mo><mi>D</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>&nbsp;</mtext><mi>l</mi><mi>o</mi><mi>g</mi><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace linebreak="newline"></mspace><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mtext>&nbsp;</mtext><mi>d</mi><mi>a</mi><mi>l</mi><mi>a</mi><mi>m</mi><mi>D</mi><mo>:</mo><mi>t</mi><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><mi>d</mi><mspace linebreak="newline"></mspace></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> idf (t, D) = \ log \ frac {| D |} {| \\ {d \ dalam D: t \ in d \\} |} </script></p><br><p>  dimana <br>  t adalah kata dari kamus. <br>  Kasing D (banyak teks) <br>  d adalah salah satu teks tubuh. <br>  Kami menghitung IDF dari semua kata kami, dan memotong kata-kata dengan idf terbesar (sangat jarang) dan dengan yang terkecil (kata-kata luas). </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#'training' (tf-)idf vectorizer. tf_idf = TfidfVectorizer(input='filename', stop_words=stopwords, smooth_idf=False ) tf_idf.fit(train_names) #getting idfs idfs = tf_idf.idf_ #sorting out too rare and too common words lower_thresh = 3. upper_thresh = 6. not_often = idfs &gt; lower_thresh not_rare = idfs &lt; upper_thresh mask = not_often * not_rare good_words = np.array(tf_idf.get_feature_names())[mask] #deleting punctuation as well. cleaned = [] for word in good_words: word = re.sub("^(\d+\w*$|_+)", "", word) if len(word) == 0: continue cleaned.append(word)</span></span></code> </pre> <br><p>  Diperoleh setelah prosedur di atas sudah cukup cocok untuk pelatihan LDA, tetapi kami akan melakukan lebih banyak stemming - kata-kata yang sama sering ditemukan dalam dataset kami, tetapi dalam kasus yang berbeda.  Untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">membendung, pymystem3 digunakan</a> . </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#Stemming m = Mystem() stemmed = set() voc_len = len(cleaned) for i in tqdm(range(voc_len)): word = cleaned.pop() stemmed_word = m.lemmatize(word)[0] stemmed.add(stemmed_word) stemmed = list(stemmed) print('After stemming: %d'%(len(stemmed)))</span></span></code> </pre> <br><p>  Setelah menerapkan pemfilteran di atas, ukuran kamus menurun dari 769801 ke <br>  13611 dan sudah dengan data seperti itu, Anda bisa mendapatkan model LDA dengan kualitas yang dapat diterima. </p><br><h3 id="testirovanie-primenenie-i-tyuning-lda">  Menguji, menerapkan, dan menyetel LDA </h3><br><p>  Sekarang kita memiliki dataset, preprocessing dan model yang kita latih pada dataset yang diproses, akan lebih baik untuk memeriksa kecukupan model kita, serta membangun beberapa aplikasi untuk mereka. </p><br><p>  Sebagai aplikasi, sebagai permulaan, pertimbangkan tugas menghasilkan kata kunci untuk teks yang diberikan.  Anda dapat melakukan ini dengan cara yang cukup sederhana sebagai berikut: </p><br><ol><li>  Kami mendapatkan dari LDA distribusi topik untuk teks ini. </li><li>  Pilih n (misalnya, n = 2) dari topik yang paling jelas. </li><li>  Untuk setiap topik, pilih m (misalnya m = 3) kata yang paling khas. </li><li>  Kami memiliki serangkaian kata-kata n * m yang mengkarakterisasi teks yang diberikan. </li></ol><br><p>  Kami akan menulis kelas antarmuka sederhana yang akan menerapkan metode menghasilkan kata kunci ini: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#Let\`s do simple interface class class TopicModeler(object): ''' Inteface object for CountVectorizer + LDA simple usage. ''' def __init__(self, count_vect, lda): ''' Args: count_vect - CountVectorizer object from sklearn. lda - LDA object from sklearn. ''' self.lda = lda self.count_vect = count_vect self.count_vect.input = 'content' def __call__(self, text): ''' Gives topics distribution for a given text Args: text - raw text via python string. returns: numpy array - topics distribution for a given text. ''' vectorized = self.count_vect.transform([text]) lda_topics = self.lda.transform(vectorized) return lda_topics def get_keywords(self, text, n_topics=3, n_keywords=5): ''' For a given text gives n top keywords for each of m top texts topics. Args: text - raw text via python string. n_topics - int how many top topics to use. n_keywords - how many top words of each topic to return. returns: list - of m*n keywords for a given text. ''' lda_topics = self(text) lda_topics = np.squeeze(lda_topics, axis=0) n_topics_indices = lda_topics.argsort()[-n_topics:][::-1] top_topics_words_dists = [] for i in n_topics_indices: top_topics_words_dists.append(self.lda.components_[i]) shape=(n_keywords*n_topics, self.lda.components_.shape[1]) keywords = np.zeros(shape=shape) for i,topic in enumerate(top_topics_words_dists): n_keywords_indices = topic.argsort()[-n_keywords:][::-1] for k,j in enumerate(n_keywords_indices): keywords[i * n_keywords + k, j] = 1 keywords = self.count_vect.inverse_transform(keywords) keywords = [keyword[0] for keyword in keywords] return keywords</span></span></code> </pre> <br><p>  Kami menerapkan metode kami pada beberapa teks dan melihat apa yang terjadi: <br>  Komunitas <strong>:</strong> Agen Perjalanan "Warna Dunia" <br>  <strong>Kata kunci:</strong> ['foto', 'sosial', 'perjalanan', 'komunitas', 'perjalanan', 'euro', 'akomodasi', 'harga', 'Polandia', 'keberangkatan'] <br>  <strong>Komunitas:</strong> Gif Makanan <br>  <strong>Kata kunci:</strong> ['mentega', 'st', 'garam', 'pc', 'adonan', 'memasak', 'bawang', 'lada', 'gula', 'gr'] </p><br><p>  Hasil di atas bukan 'cherry pick' dan terlihat cukup memadai.  Bahkan, ini adalah hasil dari model yang sudah dikonfigurasi.  LDA pertama yang dilatih sebagai bagian dari artikel ini menghasilkan hasil yang jauh lebih buruk, di antara kata kunci yang sering Anda lihat, misalnya: </p><br><ol><li>  Komponen komposit alamat web: www, http, ru, com ... </li><li>  Kata-kata umum </li><li>  unit: cm, meter, km ... </li></ol><br><p>  Penyetelan (tuning) model dilakukan sebagai berikut: </p><br><ol><li>  Untuk setiap topik, pilih n (n = 5) kata paling khas. </li><li>  Kami menganggap mereka idf, sesuai dengan kasus pelatihan. </li><li>  Kami mendatangkan kata kunci 5-10% yang paling luas. </li></ol><br><p>  "Pembersihan" seperti itu harus dilakukan dengan hati-hati, sebelum melihat 10% dari kata-kata itu.  Sebaliknya, kandidat untuk dihapus harus dipilih dengan cara ini, dan kemudian kata-kata yang harus dihapus dari mereka harus dipilih secara manual. </p><br><p>  Di suatu tempat dalam generasi 2-3 model, dengan cara yang sama memilih stopwords, untuk 5% teratas dari distribusi kata-top yang tersebar luas, kita mendapatkan: <br>  ['any', 'sepenuhnya', 'benar', 'mudah', 'berikutnya', 'internet', 'kecil', 'cara', 'sulit', 'suasana hati', 'sangat banyak', 'set', ' opsi ',' nama ',' pidato ',' program ',' kompetisi ',' musik ',' target ',' film ',' harga ',' permainan ',' sistem ',' permainan ',' permainan ',' perusahaan ' , 'bagus'] </p><br><h3 id="esche-prilozheniya">  Lebih banyak aplikasi </h3><br><p>  Hal pertama yang muncul di benak saya secara khusus adalah menggunakan distribusi topik dalam teks sebagai 'embeddings' teks, dalam interpretasi ini Anda dapat menerapkan algoritma visualisasi atau pengelompokan untuk mereka, dan mencari cluster tematik 'efektif' terakhir dengan cara ini. </p><br><p>  Mari kita lakukan ini: </p><br><pre> <code class="python hljs">term_doc_matrix = count_vect.transform(names) embeddings = lda.transform(term_doc_matrix) kmeans = KMeans(n_clusters=<span class="hljs-number"><span class="hljs-number">30</span></span>) clust_labels = kmeans.fit_predict(embeddings) clust_centers = kmeans.cluster_centers_ embeddings_to_tsne = np.concatenate((embeddings,clust_centers), axis=<span class="hljs-number"><span class="hljs-number">0</span></span>) tSNE = TSNE(n_components=<span class="hljs-number"><span class="hljs-number">2</span></span>, perplexity=<span class="hljs-number"><span class="hljs-number">15</span></span>) tsne_embeddings = tSNE.fit_transform(embeddings_to_tsne) tsne_embeddings, centroids_embeddings = np.split(tsne_embeddings, [len(clust_labels)], axis=<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br><p>  Pada output, kita mendapatkan gambar berikut: <br><img src="https://habrastorage.org/webt/7j/2r/qv/7j2rqvpp2-blr9vfq44qjs75upc.png" alt="gambar"></p><br><p>  Persilangan adalah pusat gravitasi (cenroid) dari kelompok. </p><br><p>  Pada gambar tSNE dari embeddings, dapat dilihat bahwa cluster yang dipilih menggunakan KMeans cukup terhubung dan paling sering set terpisah secara spasial. </p><br><p>  Yang lainnya, terserah Anda. </p><br><p>  Tautan ke semua kode: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://gitlab.com/Mozes/VK_LDA</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id417167/">https://habr.com/ru/post/id417167/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id417155/index.html">Kernel Linux 4.18: apa yang sedang dipersiapkan untuk rilis mendatang</a></li>
<li><a href="../id417157/index.html">Singularitas semakin dekat: AI mulai mengendalikan robot</a></li>
<li><a href="../id417161/index.html">Burger King: pengawasan rahasia, kebohongan, pencurian kartu bank. Lanjutan</a></li>
<li><a href="../id417163/index.html">Komitmen baik</a></li>
<li><a href="../id417165/index.html">Yang mengancam Burger King</a></li>
<li><a href="../id417171/index.html">Studi: Hedge fund yang dijalankan oleh perempuan menunjukkan hasil yang lebih baik</a></li>
<li><a href="../id417173/index.html">"Old New Vinyl": 20 materi tentang sejarah dan produksi turntable dan catatan</a></li>
<li><a href="../id417175/index.html">Acme road semaphore restorasi pada paruh pertama abad XX</a></li>
<li><a href="../id417177/index.html">Server web lokal di Linux, dengan peningkatan host otomatis dan perpindahan versi PHP</a></li>
<li><a href="../id417179/index.html">Menyiapkan lingkungan pengembangan rumah (buruh pelabuhan + gitlab + DNS)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>