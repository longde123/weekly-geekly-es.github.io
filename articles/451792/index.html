<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñ≤Ô∏è ‚è´ ü§öüèæ Cuatro detectores de JavaScript que lo atrapan en las tiendas en l√≠nea üíÖüèø üå∫ üëÉ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Casi todos utilizamos los servicios de tiendas en l√≠nea, lo que significa que tarde o temprano se arriesga a ser v√≠ctima de rastreadores de JavaScript...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cuatro detectores de JavaScript que lo atrapan en las tiendas en l√≠nea</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/451792/"><img src="https://habrastorage.org/webt/m2/18/ri/m218ribvsirj8bn0787eizy9oei.jpeg"><br><br>  Casi todos utilizamos los servicios de tiendas en l√≠nea, lo que significa que tarde o temprano se arriesga a ser v√≠ctima de rastreadores de JavaScript, un c√≥digo especial que los ciberdelincuentes inyectan en el sitio para robar informaci√≥n de tarjetas bancarias, direcciones, inicios de sesi√≥n y contrase√±as de usuario. <br><br>  Casi 400,000 usuarios del sitio web y la aplicaci√≥n m√≥vil de la aerol√≠nea British Airways, as√≠ como los visitantes del sitio web brit√°nico del gigante deportivo FILA y el distribuidor estadounidense de boletos Ticketmaster, ya han sido afectados por los rastreadores. <br><br>  El analista de Threat Intelligence Group-IB, Viktor Okorokov, habla sobre c√≥mo los rastreadores est√°n integrados en el c√≥digo del sitio y roban informaci√≥n de facturaci√≥n, as√≠ como a qu√© CRM atacan. <a name="habracut"></a><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l_/b0/sa/l_b0sa5cjkma2zr779uhbfi5h8m.jpeg"></div><br><br><h2>  La amenaza fantasma </h2><br>  Result√≥ que durante mucho tiempo los detectores de JS permanecieron fuera de la vista de los analistas de antivirus, y los bancos y los sistemas de pago no vieron una amenaza grave en ellos.  Y completamente en vano.  Los expertos del Grupo IB <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">analizaron</a> 2.440 tiendas en l√≠nea infectadas cuyos visitantes, alrededor de 1,5 millones de personas al d√≠a, corr√≠an el riesgo de comprometerse.  Entre las v√≠ctimas se encuentran no solo usuarios, sino tambi√©n tiendas en l√≠nea, sistemas de pago y bancos que emitieron tarjetas comprometidas. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El informe del</a> Grupo IB fue el primer estudio del mercado de redes oscuras para los rastreadores, su infraestructura y las formas de monetizar, lo que les vali√≥ a sus creadores millones de d√≥lares.  Identificamos 38 familias de rastreadores, de los cuales solo 12 eran previamente conocidos por los investigadores. <br><br>  Deteng√°monos en detalle en las cuatro familias de rastreadores estudiados durante el estudio. <br><br><h2>  ReactGet Family </h2><br>  Los rastreadores familiares ReactGet se utilizan para robar datos de tarjetas bancarias en sitios de tiendas en l√≠nea.  Un sniffer puede funcionar con una gran cantidad de sistemas de pago diferentes utilizados en el sitio: un valor de par√°metro corresponde a un sistema de pago, y las versiones individuales de sniffer detectadas pueden usarse para robar credenciales, as√≠ como para robar datos de tarjetas bancarias de formas de pago de varios sistemas de pago a la vez, como el llamado sniffer universal.  Se descubri√≥ que, en algunos casos, los atacantes realizan ataques de phishing a los administradores de tiendas en l√≠nea para obtener acceso al panel administrativo del sitio. <br><br>  La campa√±a con esta familia de rastreadores comenz√≥ en mayo de 2017, los sitios bajo el control de CMS y las plataformas Magento, Bigcommerce y Shopify fueron atacados. <br><br><h3>  C√≥mo se integra ReactGet en el c√≥digo de la tienda en l√≠nea </h3><br>  Adem√°s de la implementaci√≥n ‚Äúcl√°sica‚Äù de un script por referencia, la familia de sniffers ReactGet utiliza una t√©cnica especial: mediante el c√≥digo JavaScript, verifica si la direcci√≥n actual donde se encuentra el usuario cumple con ciertos criterios.  El c√≥digo malicioso solo se iniciar√° si la URL actual contiene el <b>pago</b> y <b>env√≠o de</b> subcadenas o <b>oneestepcheckout</b> , <b>onepage /</b> , <b>out / onepag</b> , <b>checkout / one</b> , <b>ckout / one</b> .  Por lo tanto, el c√≥digo sniffer se ejecutar√° exactamente en el momento en que el usuario proceda a pagar las compras e ingrese la informaci√≥n de pago en el formulario del sitio. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kz/fz/lr/kzfzlrityshdouqlvh5ns14vlhm.png"></div><br>  Este sniffer utiliza una t√©cnica no est√°ndar.  El pago y los datos personales de la v√≠ctima se recopilan juntos, se codifican con <b>base64</b> , y luego la cadena resultante se usa como par√°metro para enviar una solicitud al sitio de los atacantes.  Muy a menudo, la ruta a la puerta simula un archivo JavaScript, por ejemplo, <b>resp.js</b> , <b>data.js</b> , etc., pero tambi√©n <b>se</b> utilizan enlaces a archivos de imagen, <b>GIF</b> y <b>JPG</b> .  La peculiaridad es que el sniffer crea un objeto de imagen con un tama√±o de 1 por 1 p√≠xel y utiliza el enlace obtenido previamente como par√°metro <b>src</b> de la imagen.  Es decir, para el usuario, dicha solicitud en el tr√°fico se ver√° como una solicitud de una imagen normal.  Una t√©cnica similar se utiliz√≥ en los rastreadores de la familia ImageID.  Adem√°s, la t√©cnica de usar una imagen de 1 por 1 p√≠xel se usa en muchos scripts de an√°lisis en l√≠nea leg√≠timos, que tambi√©n pueden confundir al usuario. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jo/bf/xm/jobfxmbqsrjqolrvo84fkstgrhi.png"></div><br><h3>  An√°lisis de versiones </h3><br>  Un an√°lisis de los dominios activos utilizados por los operadores sniffer ReactGet revel√≥ muchas versiones diferentes de la familia sniffer.  Las versiones difieren en la presencia o ausencia de ofuscaci√≥n, y adem√°s, cada sniffer est√° dise√±ado para un sistema de pago espec√≠fico que procesa los pagos con tarjeta bancaria para las tiendas en l√≠nea.  Despu√©s de ordenar el valor del par√°metro correspondiente al n√∫mero de versi√≥n, los especialistas del Grupo IB obtuvieron una lista completa de variaciones de sniffer disponibles, y por los nombres de los campos de formulario que cada sniffer busca en el c√≥digo de p√°gina, determinaron los sistemas de pago a los que aspira el sniffer. <br><br><div class="spoiler">  <b class="spoiler_title">Lista de rastreadores y sus correspondientes sistemas de pago.</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  Sniffer url <br></th><th width="200">  Sistema de pago <br></th></tr><tr><td align="center">  <a href="">reactjsapi.com/react.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.1</a> </td><td align="center">  Cardsards <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.4</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.5</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.6</a> </td><td align="center">  Adyen </td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.7</a> </td><td align="center">  USAePay </td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.9</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.1</a> </td><td align="center">  USAePay </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.3</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.5</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.6</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.7</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.8</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.9</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.3.0</a> </td><td align="center">  Raya <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.2</a> </td><td align="center">  Realex </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.3</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.4</a> </td><td align="center">  Punto de enlace </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.5</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.7</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.8</a> </td><td align="center">  Datacash <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.9</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">asianfoodgracer.com/footer.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.5</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.7</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.8</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=2.0</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/react.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=1.3</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.4</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.6</a> <br></td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.7</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.8</a> </td><td align="center">  Chase Paymentech <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.9</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.91</a> </td><td align="center">  Adyen <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.92</a> </td><td align="center">  Psigate <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.93</a> </td><td align="center">  Fuente cibern√©tica </td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.95</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.97</a> </td><td align="center">  Realex </td></tr><tr><td align="center">  <a href="">geisseie.com/gs.js</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/age.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.3</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.5</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.6</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.7</a> </td><td align="center">  Realex <br></td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.0</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.1</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.2</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.4</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livecheckpay.com/react.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.2</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.3</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.5</a> </td><td align="center">  Fuente cibern√©tica <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.8</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.9</a> </td><td align="center">  Realex </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.0</a> </td><td align="center">  Fuente cibern√©tica </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.1</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.3</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.4</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.5</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.7</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.8</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.9</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.2</a> </td><td align="center">  Primer portal global de datos <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.5</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.8</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.4.0</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">maxstatics.com/site.js</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">mediapack.info/track.js?d=funlove.com</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">mediapack.info/track.js?d=qbedding.com</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mediapack.info/track.js?d=vseyewear.com</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.4</a> </td><td align="center">  Raya </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.7</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.8</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.1</a> </td><td align="center">  Braintree </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.10</a> </td><td align="center">  Braintree <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.3</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.31</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.32</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.33</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.34</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.35</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.4</a> </td><td align="center">  Raya </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.7</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.8</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.1</a> </td><td align="center">  Braintree </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.2</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.3</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.31</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.32</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.33</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.34</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.35</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">mxcounter.com/cnt.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/j.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=1.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=1.8</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=4.5</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=4.6</a> </td><td align="center">  Payway Westpac <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.0</a> </td><td align="center">  Payfort <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.1</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.3</a> </td><td align="center">  Raya <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.4</a> </td><td align="center">  Primer portal global de datos <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.5</a> </td><td align="center">  Psigate </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.8</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.9</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.1</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.2</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.3</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.5</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.6</a> </td><td align="center">  Punto de enlace <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.7</a> </td><td align="center">  Payway Westpac <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.8</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.2</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.3</a> </td><td align="center">  Adyen </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.4</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.5</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.6</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.7</a> </td><td align="center">  EBizCharge <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.8</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.9</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.1.2</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.11</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.12</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.13</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.14</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.15</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.16</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.17</a> </td><td align="center">  Payway Westpac <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.18</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.19</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.21</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.22</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.23</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.24</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.25</a> </td><td align="center">  Payfort <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.29</a> </td><td align="center">  Fuente cibern√©tica <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.4</a> </td><td align="center">  PayPal Payflow Pro <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.8</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.9</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.3</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.5</a> </td><td align="center">  Raya <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.8</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.9</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.2</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=0.1.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=0.1.1</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.2</a> </td><td align="center">  Pedernal </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.4</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.5</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.51</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.8</a> </td><td align="center">  Raya </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.9</a> </td><td align="center">  Cebra gorda <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.0</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.2</a> </td><td align="center">  Primer portal global de datos <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.4</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.5</a> </td><td align="center">  Adyen <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.7</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.8</a> </td><td align="center">  Servicios de comerciantes de QuickBooks <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.9</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.91</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.92</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.94</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.3.97</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.5</a> </td><td align="center">  Pago sabio </td></tr><tr><td align="center">  <a href="">reactjsapi.com/react.js</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">sydneysalonsupplies.com/gtm.js</a> </td><td align="center">  eWAY Rapid </td></tr><tr><td align="center">  <a href="">tagsmediaget.com/react.js</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.2</a> </td><td align="center">  ANZ eGate </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.3</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.5</a> </td><td align="center">  Fuente cibern√©tica </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.7</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.8</a> </td><td align="center">  Pago sabio </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.9</a> </td><td align="center">  Realex <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.0</a> </td><td align="center">  Fuente cibern√©tica </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.1</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.3</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.4</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.5</a> </td><td align="center">  eWAY Rapid </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.7</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.8</a> </td><td align="center">  Pago sabio <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.9</a> <br></td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.0</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.2</a> </td><td align="center">  Primer portal global de datos <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.5</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.8</a> </td><td align="center">  Paypal <br></td></tr></tbody></table></div><br></div></div><br><h3>  Sniffer de contrase√±a <br></h3><br>  Una de las ventajas de los rastreadores de JavaScript que funcionan en el lado del cliente del sitio es su versatilidad: el c√≥digo malicioso incrustado en el sitio puede robar cualquier tipo de datos, ya sean datos de pago o el nombre de usuario y la contrase√±a de una cuenta de usuario.  Los especialistas del Grupo IB descubrieron una muestra de un sniffer perteneciente a la familia ReactGet, dise√±ado para robar direcciones de correo electr√≥nico y contrase√±as de los usuarios del sitio. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7x/9c/x1/7x9cx1en90ze5etozgc6jmg5eh8.png"></div><br><h3>  Intersecci√≥n con ImageID Sniffer <br></h3><br>  Un an√°lisis de una de las tiendas infectadas revel√≥ que su sitio estaba infectado dos veces: adem√°s del c√≥digo malicioso de la familia sniffer ReactGet, se detect√≥ un c√≥digo sniffer de la familia ImageID.  Esta intersecci√≥n puede indicar que los operadores detr√°s del uso de ambos rastreadores utilizan t√©cnicas similares para inyectar c√≥digo malicioso. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8s/m0/ed/8sm0edvplxoguwsczm9ja3-g_ng.png"></div><br><h3>  Sniffer universal <br></h3><br>  Un an√°lisis de uno de los nombres de dominio relacionados con la infraestructura sniffer ReactGet revel√≥ que el mismo usuario hab√≠a registrado otros tres nombres de dominio.  Estos tres dominios simulaban dominios de sitios de la vida real y anteriormente se usaban para alojar rastreadores.  Al analizar el c√≥digo de tres sitios leg√≠timos, se descubri√≥ un sniffer desconocido, y un an√°lisis posterior mostr√≥ que esta es una versi√≥n mejorada del sniffer ReactGet.  Todas las versiones de rastreadores de esta familia con seguimiento previo ten√≠an como objetivo un √∫nico sistema de pago, es decir, para cada sistema de pago se requer√≠a una versi√≥n especial del rastreador.  Sin embargo, en este caso, se descubri√≥ una versi√≥n universal del sniffer, capaz de robar informaci√≥n de formularios relacionados con 15 sistemas de pago diferentes y m√≥dulos de sitios de comercio electr√≥nico para pagos en l√≠nea. <br><br>  Entonces, al comienzo del trabajo, el rastreador busc√≥ los campos base del formulario que conten√≠a la informaci√≥n personal de la v√≠ctima: nombre completo, direcci√≥n f√≠sica, n√∫mero de tel√©fono. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g_/py/vs/g_pyvsjovjp7p6x2vlqzaqho5ey.png"></div><br>  Luego, el sniffer busc√≥ m√°s de 15 prefijos diferentes correspondientes a diferentes sistemas de pago y m√≥dulos para pagos en l√≠nea. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dd/ty/as/ddtyasulurz4un7owfvlv-3xepu.png"></div><br>  Adem√°s, los datos personales y la informaci√≥n de pago de la v√≠ctima se recopilaron y se enviaron al sitio controlado por el atacante: en este caso particular, se descubrieron dos versiones del succionador universal ReactGet ubicado en dos sitios pirateados diferentes.  Sin embargo, ambas versiones enviaron los datos robados al mismo sitio pirateado <b>zoobashop.com</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ee/mt/tb/eemttbv-vdn0ff9ncd3siqfzokq.png"></div><br>  Un an√°lisis de los prefijos utilizados por el rastreador para buscar los campos que contienen la informaci√≥n de pago de la v√≠ctima nos permiti√≥ determinar que este patr√≥n rastreador estaba dirigido a los siguientes sistemas de pago: <br><br><ul><li>  <b>Authorize.Net</b> </li><li>  <b>Verisign</b> </li><li>  <b>Primeros datos</b> </li><li>  <b>USAePay</b> </li><li>  <b>Raya</b> </li><li>  <b>Paypal</b> </li><li>  <b>ANZ eGate</b> </li><li>  <b>Braintree</b> </li><li>  <b>DataCash (MasterCard)</b> </li><li>  <b>Pagos Realex</b> </li><li>  <b>Psigate</b> </li><li>  <b>Sistemas de pago Heartland</b> </li></ul><br><h3>  ¬øQu√© herramientas se utilizan para robar informaci√≥n de facturaci√≥n? <br></h3><br>  La primera herramienta descubierta durante el an√°lisis de la infraestructura del atacante se utiliza para ofuscar scripts maliciosos responsables de robar tarjetas bancarias.  Se descubri√≥ un script bash en uno de los hosts atacantes utilizando la CLI <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">javascript-ofuscador</a></b> para automatizar la ofuscaci√≥n del c√≥digo sniffer. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5m/aw/lu/5mawlut23obt6lpoa3ed2luu8ss.png"></div><br>  La segunda herramienta detectada est√° dise√±ada para generar c√≥digo responsable de cargar el sniffer principal.  Esta herramienta genera un c√≥digo JavaScript que verifica si el usuario est√° en la p√°gina de pago buscando en la direcci√≥n actual del usuario las l√≠neas de <b>pago</b> , <b>carrito,</b> etc., y si el resultado es positivo, el c√≥digo carga el sniffer principal del servidor del atacante.  Para ocultar la actividad maliciosa, todas las l√≠neas, incluidas las l√≠neas de prueba para determinar la p√°gina de pago, as√≠ como un enlace al sniffer, se codifican con <b>base64</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vn/ew/ym/vnewymbt1r6nc8n98roze5drnnk.png"></div><br><h3>  Ataques de phishing <br></h3><br>  Al analizar la infraestructura de red de los atacantes, se descubri√≥ que a menudo un grupo criminal usa el phishing para obtener acceso al panel administrativo de la tienda en l√≠nea de destino.  Los atacantes registran un dominio que se ve visualmente similar al dominio de una tienda y luego implementan un formulario de inicio de sesi√≥n falso del panel de administraci√≥n de Magento en √©l.  Si tiene √©xito, los atacantes obtendr√°n acceso al panel de administraci√≥n de CMS Magento, que les permite editar los componentes del sitio e implementar un sniffer para robar informaci√≥n de la tarjeta de cr√©dito. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yf/-a/lz/yf-alzxabbg_kij0vkaq5qcr9vs.png"></div><br><div class="spoiler">  <b class="spoiler_title">La infraestructura</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  Dominio <br></th><th width="200">  Descubrimiento / Fecha de aparici√≥n <br></th></tr><tr><td align="center">  mediapack.info </td><td align="center">  05/04/2017 <br></td></tr><tr><td align="center">  adsgetapi.com </td><td align="center">  15/06/2017 <br></td></tr><tr><td align="center">  simcounter.com </td><td align="center">  14/08/2017 </td></tr><tr><td align="center">  mageanalytics.com </td><td align="center">  22/12/2017 </td></tr><tr><td align="center">  maxstatics.com </td><td align="center">  16/01/2018 <br></td></tr><tr><td align="center">  reactjsapi.com </td><td align="center">  19/01/2018 </td></tr><tr><td align="center">  mxcounter.com </td><td align="center">  02/02/2018 </td></tr><tr><td align="center">  apitstatus.com </td><td align="center">  01/03/2018 <br></td></tr><tr><td align="center">  orderracker.com </td><td align="center">  20/04/2018 <br></td></tr><tr><td align="center">  tagstracking.com </td><td align="center">  25/06/2018 <br></td></tr><tr><td align="center">  adsapigate.com </td><td align="center">  07/12/2018 <br></td></tr><tr><td align="center">  trust-tracker.com </td><td align="center">  15/07/2018 <br></td></tr><tr><td align="center">  fbstatspartner.com </td><td align="center">  10/02/2018 <br></td></tr><tr><td align="center">  billgetstatus.com </td><td align="center">  10/12/2018 </td></tr><tr><td align="center">  aldenmlilhouse.com </td><td align="center">  20/10/2018 <br></td></tr><tr><td align="center">  balletbeautlful.com </td><td align="center">  20/10/2018 <br></td></tr><tr><td align="center">  bargalnjunkie.com </td><td align="center">  20/10/2018 <br></td></tr><tr><td align="center">  payselector.com </td><td align="center">  21.10.2018 <br></td></tr><tr><td align="center">  tagsmediaget.com </td><td align="center">  11/02/2018 <br></td></tr><tr><td align="center">  hs-payments.com </td><td align="center">  16/11/2018 <br></td></tr><tr><td align="center">  ordercheckpays.com </td><td align="center">  19/11/2018 <br></td></tr><tr><td align="center">  geisseie.com </td><td align="center">  24/11/2018 <br></td></tr><tr><td align="center">  gtmproc.com </td><td align="center">  29/11/2018 <br></td></tr><tr><td align="center">  livegetpay.com </td><td align="center">  18/12/2018 <br></td></tr><tr><td align="center">  sydneysalonsupplies.com </td><td align="center">  18/12/2018 <br></td></tr><tr><td align="center">  newrelicnet.com <br></td><td align="center">  19/12/2018 <br></td></tr><tr><td align="center">  nr-public.com </td><td align="center">  01/03/2019 </td></tr><tr><td align="center">  cloudodesc.com </td><td align="center">  01/04/2019 <br></td></tr><tr><td align="center">  ajaxstatic.com </td><td align="center">  01/11/2019 <br></td></tr><tr><td align="center">  livecheckpay.com </td><td align="center">  21/01/2019 <br></td></tr><tr><td align="center">  asianfoodgracer.com </td><td align="center">  25/01/2019 <br></td></tr></tbody></table></div><br></div></div><br><h2>  Familia G-analytics <br></h2><br>  Esta familia de rastreadores se utiliza para robar tarjetas de clientes de tiendas en l√≠nea.  El primer nombre de dominio utilizado por el grupo se registr√≥ en abril de 2016, lo que puede indicar el comienzo de la actividad del grupo a mediados de 2016. <br><br>  En la campa√±a actual, el grupo usa nombres de dominio que imitan servicios de la vida real como Google Analytics y jQuery, enmascarando la actividad sniffer con scripts leg√≠timos y similares a nombres de dominio leg√≠timos.  El ataque se ejecut√≥ en sitios que ejecutan CMS Magento. <br><br><h3>  C√≥mo se integra G-Analytics en el c√≥digo de la tienda en l√≠nea <br></h3><br>  Una caracter√≠stica distintiva de esta familia es el uso de varios m√©todos de robo de informaci√≥n de pago del usuario.  Adem√°s de la implementaci√≥n cl√°sica del c√≥digo JavaScript en la parte del cliente del sitio, el grupo criminal tambi√©n utiliz√≥ la t√©cnica de incrustar c√≥digo en la parte del servidor del sitio, es decir, scripts PHP que procesan los datos ingresados ‚Äã‚Äãpor el usuario.  Esta t√©cnica es peligrosa porque dificulta a los investigadores externos detectar c√≥digos maliciosos.  Los especialistas de Group-IB descubrieron una versi√≥n de un sniffer incrustado en el c√≥digo PHP del sitio, utilizando el dominio <b>dittm.org</b> como puerta de entrada. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ud/m_/dk/udm_dkzu4pw_4pbxhrstk0e9oo8.png"></div><br>  Tambi√©n se descubri√≥ una versi√≥n anterior del sniffer, que utiliza el mismo dominio <b>dittm.org</b> para recopilar datos robados, pero esta versi√≥n ya est√° destinada a la instalaci√≥n en el lado del cliente de la tienda en l√≠nea. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kr/0m/nh/kr0mnhgtjfxqs5lftvx53ofrm54.png"></div><br>  M√°s tarde, el grupo cambi√≥ sus t√°cticas y comenz√≥ a prestar m√°s atenci√≥n al ocultamiento de la actividad maliciosa y al disfraz. <br><br>  A principios de 2017, el grupo comenz√≥ a usar el dominio <b>jquery-js.com</b> , disfrazado como CDN para jQuery: cuando redirige a un sitio de usuarios maliciosos, redirige al sitio leg√≠timo <b>jquery.com</b> . <br><br>  Y a mediados de 2018, el grupo adopt√≥ el nombre de dominio <b>g-analytics.com</b> y comenz√≥ a enmascarar las actividades del sniffer bajo el servicio leg√≠timo de Google Analytics. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rd/fj/mj/rdfjmj8foi7qtcv_fi_lix69a4u.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/y3/xp/24/y3xp24ypsp9vloflbz5lbnrrfnk.png"></div><br><h3>  An√°lisis de versiones <br></h3><br>  Durante el an√°lisis de los dominios utilizados para almacenar el c√≥digo sniffer, se encontr√≥ que el sitio tiene una gran cantidad de versiones que difieren seg√∫n la presencia de ofuscaci√≥n, as√≠ como la presencia o ausencia de c√≥digo inalcanzable agregado al archivo para distraer la atenci√≥n y ocultar el c√≥digo malicioso. <br><br>  En total, se identificaron seis versiones de sniffers en <b>jquery-js.com</b> .  Estos rastreadores env√≠an los datos robados a la direcci√≥n ubicada en el mismo sitio que el rastreador: <b>hxxps: // jquery-js [.] Com / latest / jquery.min.js</b> : <br><br><ul><li>  <b>hxxps: // jquery-js [.] com / jquery.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.2.2.4.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.8.3.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.6.4.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.4.4.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.12.4.min.js</b> </li></ul><br>  El dominio posterior <b>g-analytics.com</b> , utilizado por el grupo en ataques desde mediados de 2018, sirve como dep√≥sito para un mayor n√∫mero de rastreadores.  Se descubrieron un total de 16 versiones de sniffer diferentes.  En este caso, la puerta para enviar los datos robados se disfraz√≥ como un enlace a una imagen <b>GIF</b> : <b>hxxp: // g-analytics [.] Com / __ utm.gif? V = 1 &amp; _v = j68 &amp; a = 98811130 &amp; t = pageview &amp; _s = 1 &amp; sd = 24-bit &amp; sr = 2560x1440 &amp; vp = 2145x371 &amp; je = 0 &amp; _u = AACAAEAB ~ &amp; jid = 1841704724 &amp; gjid = 877686936 &amp; cid</b> <b><br></b>  <b>= 1283183910.1527732071</b> : <br><br><ul><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.1 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.10 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.11 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.12 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.13 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.14 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.15 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.16 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.3 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.4 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.5 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.6 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.7 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.8 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / 1.0.9 / analytics.js</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hxxps: // g-analytics [.] com / libs / analytics.js</font></font></b> </li></ul><br><h3>    <br></h3><br>     ,       ,   .  ,  ,  ,  <b>google-analytics.cm</b>     ,    <b>cardz.vc</b> .  <b>cardz.vc</b>         Cardsurfs (Flysurfs),           AlphaBay      ,    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/k6/l6/-w/k6l6-wxdifwkyfd-kq-3xicgsdq.png"></div><br>   <b>analytic.is</b> ,     ,   ,      ,  Group-IB  ,   Cookie-, , ,    .        <b>iozoz.com</b> ,        ,   2016 . ,            .      email- <b>kts241@gmail.com</b> ,        <b>cardz.su</b>  <b>cardz.vc</b> ,     Cardsurfs. <br><br>    ,   ,    G-Analytics        Cardsurfs      ,       ,    . <br><br><div class="spoiler">  <b class="spoiler_title">La infraestructura</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dominio </font></font><br></th><th width="200"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Descubrimiento / Fecha de aparici√≥n </font></font><br></th></tr><tr><td align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> iozoz.com </font></font></td><td align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 08/04/2016 </font></font></td></tr><tr><td align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dittm.org </font></font></td><td align="center"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10/09/2016 </font></font><br></td></tr><tr><td align="center"> jquery-js.com </td><td align="center"> 02.01.2017 </td></tr><tr><td align="center"> g-analytics.com </td><td align="center"> 31.05.2018 <br></td></tr><tr><td align="center"> google-analytics.is </td><td align="center"> 21.11.2018 <br></td></tr><tr><td align="center"> analytic.to </td><td align="center"> 04.12.2018 </td></tr><tr><td align="center"> google-analytics.to </td><td align="center"> 06.12.2018 <br></td></tr><tr><td align="center"> google-analytics.cm </td><td align="center"> 28.12.2018 <br></td></tr><tr><td align="center"> analytic.is </td><td align="center"> 28.12.2018 <br></td></tr><tr><td align="center"> googlc-analytics.cm </td><td align="center"> 17.01.2019 <br></td></tr></tbody></table></div><br></div></div><br><h2>  Illum </h2><br> Illum ‚Äî  ,     -,    CMS Magento.    ,          ,       . <br><br>    ,     ,      , ,   ,        .        ,  ,  ,       2016 . <br><br><h3>  Illum    - </h3><br>          .      <b>cdn.illum[.]pw/records.php</b> ,       <b>base64</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/m0/ek/gs/m0ekgsjvued_xicxubpz6dprhag.png"></div><br>      ,    ‚Äî <b>records.nstatistics[.]com/records.php</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yy/zq/3d/yyzq3dtgunc6ansnwrk2eun4mjy.png"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> Willem de Groot,      ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a> ,     CSU. <br><br><h3>    <br></h3><br>  Group-IB    ,           . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dm/ze/i3/dmzei3jrukearwtcs-9ch_b2nue.png"></div><br>  ,    ,           Linux:  , Linux Privilege Escalation Check Script,    (Mike Czumak),     CVE-2009-1185. <br><br>     -    : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>      <b>core_config_data</b>    CVE-2016-4010, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>    RCE    CMS Magento,       -. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/j7/st/5r/j7st5ryg0ixjehutzjvneckqaw8.jpeg"></div><br>              ,         .      ,        ,       CMS      .  ,  <b>segapay_standart.js</b>  <b>segapay_onpage.js</b>     ,    Sage Pay. <br><br><div class="spoiler"> <b class="spoiler_title">     </b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  </th><th width="200">   </th></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs_special/visiondirect.co.uk.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs_special/topdierenshop.nl.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs_special/tiendalenovo.es.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs_special/pro-bolt.com.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs_special/plae.co.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs_special/ottolenghi.co.uk.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs_special/oldtimecandy.com.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs_special/mylook.ee.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs_special/luluandsky.com.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs_special/julep.com.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs_special/gymcompany.es.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs_special/grotekadoshop.nl.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs_special/fushi.co.uk.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs_special/fareastflora.com.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs_special/compuindia.com.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs/segapay_standart.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs/segapay_onpage.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs/replace_standart.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs/all_inputs.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/mjs/add_inputs_standart.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/magento/payment_standart.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/magento/payment_redirect.js </td><td align="center"> //payrightnow[.]cf/?payment= <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/magento/payment_redcrypt.js </td><td align="center"> //payrightnow[.]cf/?payment= <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sr.illum</a> [.]pw/magento/payment_forminsite.js </td><td align="center"> //paymentnow[.]tk/?payment= <br></td></tr></tbody></table></div><br></div></div><br>  <b>paymentnow[.]tk</b> ,      <b>payment_forminsite.js</b> ,    <b>subjectAltName</b>   ,    CloudFlare.  ,     <b>evil.js</b> .    ,        CVE-2016-4010,        footer    CMS Magento.        <b>request.requestnet[.]tk</b> ,    ,    <b>paymentnow[.]tk</b> . <br><br><h3>    <br></h3><br>          .        -    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vd/vz/9b/vdvz9bvo34cv-5sp86ost9kadvg.png"></div><br>    ‚Äî     PayPal,           . <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6o/rk/92/6ork92ddgqisrzpksczgd-gcwyu.png"></div><br><div class="spoiler">  <b class="spoiler_title">La infraestructura</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  <br></th><th width="200">  / </th></tr><tr><td align="center"> cdn.illum.pw </td><td align="center"> 27/11/2016 <br></td></tr><tr><td align="center"> records.nstatistics.com </td><td align="center"> 06/09/2018 <br></td></tr><tr><td align="center"> request.payrightnow.cf </td><td align="center"> 25/05/2018 <br></td></tr><tr><td align="center"> paymentnow.tk </td><td align="center"> 16/07/2017 <br></td></tr><tr><td align="center"> payment-line.tk </td><td align="center"> 01/03/2018 <br></td></tr><tr><td align="center"> paymentpal.cf </td><td align="center"> 04/09/2017 <br></td></tr><tr><td align="center"> requestnet.tk </td><td align="center"> 28/06/2017 <br></td></tr></tbody></table></div><br></div></div><br><h2>  CoffeMokko </h2><br>   CoffeMokko,       -,      2017 . ,        Group 1,   RiskIQ  2016 .       CMS,  Magento, OpenCart, WordPress, osCommerce, Shopify. <br><br><h3>  CoffeMokko    - </h3><br>         :      <b>src</b>  <b>js</b>   .          . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wn/pz/s8/wnpzs8nq8gwew8hgxkmhocu8nv0.png"></div><br>        ,     .   ,      ,        . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fh/pj/am/fhpjamaj2zikswysse44wophdxq.png"></div><br>          ,      :           ,    ,      . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ia/wz/qw/iawzqwyetk6kadgy3hjgcbhalgi.png"></div><br>           <b>/savePayment/index.php  /tr/index.php</b> . ,           ,     .            <b>base64</b> ,      : <br><br><ul><li>  ¬´e¬ª   ¬´:¬ª </li><li>  ¬´w¬ª   ¬´+¬ª </li><li>  ¬´o¬ª   ¬´%¬ª </li><li>  ¬´d¬ª   ¬´#¬ª </li><li>  ¬´a¬ª   ¬´-¬ª </li><li>  ¬´7¬ª   ¬´^¬ª </li><li>  ¬´h¬ª   ¬´_¬ª </li><li>  ¬´T¬ª   ¬´@¬ª </li><li>  ¬´0¬ª   ¬´/¬ª </li><li>  ¬´Y¬ª   ¬´*¬ª </li></ul><br>        <b>base64</b>   ,    . <br><br>     ,   : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/iv/rw/jv/ivrwjvwtjyflx73jxnzyedtgqxw.png"></div><br><h3>   <br></h3><br>       ,      -.           TLD.       ,       . <br><br>      ,      jQuery ( <b>slickjs[.]org</b>  ,   <b>slick.js</b> ),   ( <b>sagecdn[.]org</b>  ,    Sage Pay). <br><br>     ,          ,    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nc/8p/mc/nc8pmckp6ig-wh6zqiflqsvvuv8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cada dominio correspond√≠a al sitio en el que se cre√≥ el directorio </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ js</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ src</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Los scripts de sniffer se almacenaron en este directorio: un sniffer por cada nueva infecci√≥n. </font><font style="vertical-align: inherit;">El sniffer se inyect√≥ en el c√≥digo del sitio a trav√©s de un enlace directo, pero en casos raros, los atacantes modificaron uno de los archivos del sitio y le agregaron c√≥digo malicioso.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> An√°lisis de c√≥digo </font></font><br></h3><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El primer algoritmo de ofuscaci√≥n </font></font><br></h4><br>  En algunas muestras de sniffer detectadas de esta familia, el c√≥digo se ofusc√≥ y conten√≠a los datos cifrados necesarios para que el sniffer funcione: en particular, la direcci√≥n de la puerta del sniffer, una lista de campos de formulario de pago y, en algunos casos, un c√≥digo de formulario de pago falso.  En el c√≥digo dentro de la funci√≥n, los recursos se cifraron usando <b>XOR</b> usando la clave, que fue pasada por el argumento de la misma funci√≥n. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uu/io/h2/uuioh2egdec0k1wpsa4wxti_1qc.png"></div><br>  Despu√©s de descifrar la cadena con la clave correspondiente, √∫nica para cada muestra, puede obtener una cadena que contenga todas las l√≠neas desde el c√≥digo sniffer a trav√©s del car√°cter delimitador. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yi/ma/ch/yimachmb5zfakdeqn-u4v-dwesc.png"></div><br><h4>  Segundo algoritmo de ofuscaci√≥n <br></h4><br>  En muestras posteriores de rastreadores de esta familia, se utiliz√≥ un mecanismo de ofuscaci√≥n diferente: en este caso, los datos se cifraron mediante un algoritmo autoescrito.  Una cadena que contiene los datos cifrados necesarios para que el sniffer funcione se pas√≥ como argumento a la funci√≥n de descifrado. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/co/hs/bi/cohsbisd1wm4g_46sclbiq-wngc.png"></div><br>  Con la consola del navegador, puede descifrar los datos cifrados y obtener una matriz que contiene recursos sniffer. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/a8/zw/eh/a8zweh8fi_s1p6x-pgl6l7ugfei.png"></div><br><h3>  Enlace a los primeros ataques de MageCart <br></h3><br>  Un an√°lisis de uno de los dominios utilizados por el grupo como puerta para recopilar datos robados revel√≥ que el dominio tiene una infraestructura de robo de tarjeta de cr√©dito id√©ntica a la utilizada por el Grupo 1, uno de los primeros grupos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">descubiertos</a> por especialistas de RiskIQ. <br><br>  Se encontraron dos archivos en el host de la familia sniffer CoffeMokko: <br><br><ul><li>  <b>mage.js</b> : archivo que contiene el c√≥digo sniffer del Grupo 1 con la direcci√≥n de puerta <b>js-cdn.link</b> </li><li>  <b>mag.php</b> : secuencia de comandos PHP responsable de recopilar datos robados por sniffer </li></ul><br><div class="spoiler">  <b class="spoiler_title">Contenido del archivo Mage.js</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/84/mx/99/84mx99wtkbnzni7faierof1lxbs.png"></div></div></div><br>  Tambi√©n se descubri√≥ que los primeros dominios utilizados por el grupo detr√°s de la familia sniffer CoffeMokko se registraron el 17 de mayo de 2017: <br><br><ul><li>  <b>enlace-js [.] enlace</b> </li><li>  <b>enlace info-js [.]</b> </li><li>  <b>enlace track-js [.]</b> </li><li>  <b>enlace map-js [.]</b> </li><li>  <b>enlace smart-js [.]</b> </li></ul><br>  El formato de estos nombres de dominio es el mismo que el de los nombres de dominio del Grupo 1 utilizados en los ataques de 2016. <br><br>  En base a los hechos descubiertos, se puede suponer que existe una conexi√≥n entre los operadores de sniffer CoffeMokko y el grupo criminal del Grupo 1.  Presumiblemente, los operadores de CoffeMokko podr√≠an tomar prestado herramientas y software de robo de tarjetas de sus predecesores.  Sin embargo, es m√°s probable que el grupo criminal detr√°s del uso de la familia de sniffers CoffeMokko sean las mismas personas que llevaron a cabo los ataques como parte de las actividades del Grupo 1. Despu√©s de la publicaci√≥n del primer informe sobre las actividades del grupo criminal, todos sus nombres de dominio fueron bloqueados, y las herramientas se estudiaron en detalle y son descritos  El grupo se vio obligado a tomar un descanso, refinar sus herramientas internas y reescribir el c√≥digo sniffer para continuar con sus ataques y pasar desapercibido. <br><br><div class="spoiler">  <b class="spoiler_title">La infraestructura</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  Dominio </th><th width="200">  Descubrimiento / Fecha de aparici√≥n </th></tr><tr><td align="center">  link-js.link </td><td align="center">  17/05/2017 </td></tr><tr><td align="center">  info-js.link </td><td align="center">  17/05/2017 </td></tr><tr><td align="center">  track-js.link </td><td align="center">  17/05/2017 </td></tr><tr><td align="center">  map-js.link </td><td align="center">  17/05/2017 </td></tr><tr><td align="center">  smart-js.link </td><td align="center">  17/05/2017 </td></tr><tr><td align="center">  adorebeauty.org </td><td align="center">  09/03/2017 </td></tr><tr><td align="center">  security-payment.su </td><td align="center">  09/03/2017 </td></tr><tr><td align="center">  braincdn.org </td><td align="center">  09/04/2017 </td></tr><tr><td align="center">  sagecdn.org </td><td align="center">  09/04/2017 </td></tr><tr><td align="center">  slickjs.org </td><td align="center">  09/04/2017 </td></tr><tr><td align="center">  oakandfort.org </td><td align="center">  10/09/2017 </td></tr><tr><td align="center">  citywlnery.org </td><td align="center">  15/09/2017 </td></tr><tr><td align="center">  dobell.su </td><td align="center">  10/04/2017 </td></tr><tr><td align="center">  childsplayclothing.org </td><td align="center">  31/10/2017 </td></tr><tr><td align="center">  jewsondirect.com </td><td align="center">  11/05/2017 </td></tr><tr><td align="center">  shop-rnib.org </td><td align="center">  15/11/2017 </td></tr><tr><td align="center">  closetlondon.org </td><td align="center">  16/11/2017 </td></tr><tr><td align="center">  misshaus.org </td><td align="center">  28/11/2017 </td></tr><tr><td align="center">  battery-force.org </td><td align="center">  12/01/2017 </td></tr><tr><td align="center">  kik-vape.org </td><td align="center">  12/01/2017 </td></tr><tr><td align="center">  greatfurnituretradingco.org </td><td align="center">  12/02/2017 </td></tr><tr><td align="center">  etradesupply.org </td><td align="center">  12/04/2017 </td></tr><tr><td align="center">  replacemyremote.org </td><td align="center">  12/04/2017 </td></tr><tr><td align="center">  all-about-sneakers.org </td><td align="center">  12/05/2017 </td></tr><tr><td align="center">  mage-checkout.org </td><td align="center">  12/05/2017 </td></tr><tr><td align="center">  nililotan.org </td><td align="center">  12/07/2017 </td></tr><tr><td align="center">  lamoodbighats.net </td><td align="center">  12/08/2017 </td></tr><tr><td align="center">  walletgear.org </td><td align="center">  12/10/2017 </td></tr><tr><td align="center">  dahlie.org </td><td align="center">  12/12/2017 </td></tr><tr><td align="center">  davidsfootwear.org </td><td align="center">  20/12/2017 </td></tr><tr><td align="center">  blackriverimaging.org </td><td align="center">  23/12/2017 </td></tr><tr><td align="center">  exrpesso.org </td><td align="center">  01/02/2018 </td></tr><tr><td align="center">  parks.su </td><td align="center">  01/09/2018 </td></tr><tr><td align="center">  pmtonline.su </td><td align="center">  01/12/2018 </td></tr><tr><td align="center">  ottocap.org </td><td align="center">  15/01/2018 </td></tr><tr><td align="center">  christohperward.org </td><td align="center">  27/01/2018 </td></tr><tr><td align="center">  coffetea.org </td><td align="center">  31/01/2018 </td></tr><tr><td align="center">  energycoffe.org </td><td align="center">  31/01/2018 </td></tr><tr><td align="center">  energytea.org </td><td align="center">  31/01/2018 </td></tr><tr><td align="center">  teacoffe.net </td><td align="center">  31/01/2018 </td></tr><tr><td align="center">  adaptivecss.org </td><td align="center">  01/03/2018 </td></tr><tr><td align="center">  coffemokko.com </td><td align="center">  01/03/2018 </td></tr><tr><td align="center">  londontea.net </td><td align="center">  01/03/2018 </td></tr><tr><td align="center">  ukcoffe.com </td><td align="center">  01/03/2018 </td></tr><tr><td align="center">  labbe.biz </td><td align="center">  20/03/2018 </td></tr><tr><td align="center">  batterynart.com </td><td align="center">  03/04/2018 </td></tr><tr><td align="center">  btosports.net </td><td align="center">  09/04/2018 </td></tr><tr><td align="center">  chicksaddlery.net </td><td align="center">  16/04/2018 </td></tr><tr><td align="center">  paypaypay.org </td><td align="center">  05/11/2018 </td></tr><tr><td align="center">  ar500arnor.com </td><td align="center">  26/05/2018 </td></tr><tr><td align="center">  authorizecdn.com </td><td align="center">  28/05/2018 </td></tr><tr><td align="center">  slickmin.com </td><td align="center">  28/05/2018 </td></tr><tr><td align="center">  bannerbuzz.info </td><td align="center">  06/03/2018 </td></tr><tr><td align="center">  kandypens.net </td><td align="center">  06/08/2018 </td></tr><tr><td align="center">  mylrendyphone.com </td><td align="center">  15/06/2018 </td></tr><tr><td align="center">  freshchat.info </td><td align="center">  01/07/2018 </td></tr><tr><td align="center">  3lift.org </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  abtasty.net </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  mechat.info </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  zoplm.com </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  zapaljs.com </td><td align="center">  02/09/2018 </td></tr><tr><td align="center">  foodandcot.com </td><td align="center">  15/09/2018 </td></tr><tr><td align="center">  freshdepor.com </td><td align="center">  15/09/2018 </td></tr><tr><td align="center">  swappastore.com </td><td align="center">  15/09/2018 </td></tr><tr><td align="center">  verywellfitnesse.com </td><td align="center">  15/09/2018 </td></tr><tr><td align="center">  elegrina.com </td><td align="center">  18/11/2018 </td></tr><tr><td align="center">  majsurplus.com </td><td align="center">  19/11/2018 </td></tr><tr><td align="center">  top5value.com </td><td align="center">  19/11/2018 </td></tr></tbody></table></div><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/451792/">https://habr.com/ru/post/451792/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../451780/index.html">Auditor√≠a en 60 minutos: compruebe la resistencia de los empleados a los ataques de phishing a trav√©s de Sophos Phish Threat de forma gratuita</a></li>
<li><a href="../451782/index.html">Subsistema de Windows para Linux (WSL) versi√≥n 2: ¬øc√≥mo ser√°? (Preguntas frecuentes)</a></li>
<li><a href="../451784/index.html">Unidades h√≠bridas para almacenamiento empresarial. Experiencia con Seagate EXOS</a></li>
<li><a href="../451786/index.html">Ejecute pruebas instrumentales en el laboratorio de pruebas de Firebase. Parte 1: proyecto iOS</a></li>
<li><a href="../451790/index.html">Los peligros de la recopilaci√≥n de datos en el juego</a></li>
<li><a href="../451794/index.html">P√≠xeles de sangr√≠a de textura</a></li>
<li><a href="../451796/index.html">Escribir una extensi√≥n de navegador segura</a></li>
<li><a href="../451798/index.html">Migraci√≥n de datos con mongoDB y Spring Boot</a></li>
<li><a href="../451800/index.html">Hacer un m√≥dem sonar simple</a></li>
<li><a href="../451802/index.html">.Net Community of Raiffeisenbank invita a UPD mitap Broadcast</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>