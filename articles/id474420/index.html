<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎫 🏂🏽 🔂 Pembentukan termostat: bagaimana hal itu terjadi 🐛 💆🏽 🙈</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Setelah beberapa tahun berhasil, diputuskan untuk membawa ke publik produk pertama kami untuk kontrol iklim di rumah pintar - termostat pintar untuk m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pembentukan termostat: bagaimana hal itu terjadi</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474420/"><img src="https://habrastorage.org/webt/hq/ic/rj/hqicrj2h1bv5ytdxhdsxlst1uv0.png"><br><br>  Setelah beberapa tahun berhasil, diputuskan untuk membawa ke publik produk pertama kami untuk kontrol iklim di rumah pintar - termostat pintar untuk mengendalikan lantai yang hangat. <br><a name="habracut"></a><br><h3>  Apa perangkat ini? </h3><br>  Ini adalah termostat pintar untuk pemanas listrik di bawah lantai hingga 3kW.  Itu dikendalikan melalui aplikasi, halaman web, HTTP, MQTT, sehingga mudah diintegrasikan ke dalam semua sistem rumah pintar.  Untuk yang paling populer, kami akan mengembangkan plugin. <br><br>  Anda dapat mengontrol tidak hanya pemanas di bawah lantai listrik, tetapi juga kepala termal di lantai yang dipanaskan dengan air, ketel, atau sauna listrik.  Selain itu, menggunakan nrf, termostat akan dapat berkomunikasi dengan berbagai sensor.  Hampir semua sensor terkait iklim saat ini sedang dalam pengembangan.  Karena perangkat ini didasarkan pada ESP, kami memutuskan bahwa tidak tepat untuk memilih opsi penyesuaian dari pengguna.  Oleh karena itu, kami akan membuatnya agar pengguna dapat mentransfer perangkat ke mode pengembang dan menginstal firmware lain, misalnya, dengan dukungan untuk HomeKit atau proyek pihak ketiga. <br><br>  * Setelah menginstal firmware pihak ketiga dengan dukungan untuk HomeKit atau proyek populer lainnya, kembali ke aslinya tidak mungkin melalui OTA (Over-the-Air). <br><cut></cut><br><h3>  Kesulitan yang kami temui </h3><br>  Mengatakan bahwa mereka tidak ada akan menjadi bodoh.  Saya akan mencoba menggambarkan masalah paling sulit yang muncul dan bagaimana kami menyelesaikannya. <br><br>  Penutup untuk perangkat adalah tantangan.  Dan biaya sumber daya, dan biaya waktu (dikembangkan sekitar satu tahun). <br><br>  Ada banyak opsi di pasar.  Dan yang paling populer adalah pencetakan 3D.  Mari kita perkirakan: <br>  Pencetakan 3D klasik.  Kualitas buruk, kecepatan produksi juga.  Kami menggunakan pencetakan 3D untuk prototipe, tetapi tidak cocok untuk produksi. <br><br>  Printer Photopolymer 3D.  Di sini kualitasnya berkali-kali lebih baik, tetapi efek harga masuk.  Prototipe yang dicetak pada printer yang sama, berdiri sekitar 4000 rubel, dan ini adalah salah satu bagian dari tubuh dua.  Anda dapat membeli printer Anda, yang akan mengurangi harga, tetapi harga tetap akan menjadi ruang, dan kecepatannya tidak memuaskan. <br><br>  Pengecoran silikon.  Kami menganggap ini pilihan terbaik.  Kualitasnya ada di level, harga tinggi, tetapi tidak kritis.  Bahkan batch pertama dipesan dalam 20 kasus untuk uji coba lapangan. <br><br>  Tapi semuanya mengubah kopernya.  Suatu malam, saya tidak sengaja menerbitkan obrolan internal untuk para pengembang yang dengan case jamb, harganya tinggi.  Dan hari berikutnya, seorang rekan menulis dalam pesan pribadi bahwa teman temannya memiliki TPA (mesin termoplast).  Dan pada tahap pertama, Anda bisa membuat cetakan untuknya.  Pesan ini telah mengubah segalanya! <br><br>  Saya sudah mempertimbangkan penggunaan TPA, tetapi saya bahkan tidak berhenti oleh kebutuhan untuk memesan batch 5000 pcs minimum (meskipun jika Anda dapat mencobanya, Anda dapat menemukan lebih sedikit melalui Cina).  Saya dihentikan oleh harga cetakan.  Sekitar $ 5000.  Saya belum siap untuk mengeluarkan jumlah ini sekaligus.  Jumlah cetakan melalui kolega kami yang baru dicetak bukan kosmik, bervariasi antara $ 2000 - $ 2500.  Selain itu, dia pergi menemui kami dan kami sepakat bahwa pembayaran akan dilakukan dengan mencicil.  Jadi masalah dengan kasus diselesaikan. <br><br>  Kesulitan kedua dan sama pentingnya yang kami temui adalah besi. <br><br>  Jangan hitung jumlah revisi besi.  Menurut perkiraan konservatif, opsi yang disajikan adalah yang ketujuh, tidak termasuk yang menengah.  Di dalamnya, kami mencoba untuk menyelesaikan semua kekurangan yang diidentifikasi dalam proses pengujian. <br><br>  Jadi, sebelumnya saya berpikir bahwa tidak perlu pengawas perangkat keras.  Sekarang, tanpa itu, perangkat tidak akan masuk ke seri: karena ketidakteraturan platform yang kami pilih. <br>  Input analog lain untuk ESP.  Sebelumnya, saya berpikir bahwa setiap pin ESP bersifat universal.  Tetapi ESP hanya memiliki satu pin analog.  Pelajari ini terjadi dalam praktik, yang menyebabkan perubahan dan pemesanan ulang papan sirkuit cetak. <br><br>  <i>Versi pertama papan sirkuit tercetak</i> <br><br><img src="https://habrastorage.org/webt/t-/hf/9n/t-hf9nry-pzvsm4shzy4fyta_kc.jpeg"><br><br><img src="https://habrastorage.org/webt/ok/d8/w7/okd8w7vazoijv851jztumvoj0w8.png"><br><br>  <i>Versi kedua papan sirkuit tercetak</i> <br><br><img src="https://habrastorage.org/webt/yf/c5/9c/yfc59crkqt9oclmawidome-mwm8.jpeg"><br><br><img src="https://habrastorage.org/webt/1o/wl/j0/1owlj0hbceqg4dbxcqsq94g43su.png"><br><br>  <i>Versi kedua dari papan sirkuit tercetak, di mana saya harus segera menyelesaikan masalah dengan pin analog</i> <br><br><img src="https://habrastorage.org/webt/hs/ka/q5/hskaq5caccyx6b9ws6fo8lwysh0.jpeg"><br><br><img src="https://habrastorage.org/webt/px/ek/hp/pxekhp2fjamqqcd3nk3oajbjc-8.jpeg"><br><br>  Adapun perangkat lunak, ada juga banyak jebakan. <br><br>  Misalnya, peluncuran ESP secara berkala.  Terlepas dari kenyataan bahwa ping menuju ke sana, halaman tidak terbuka.  Hanya ada satu solusi - menulis ulang perpustakaan.  Mungkin ada yang lain, tetapi kita semua berusaha tidak membuahkan hasil. <br><br>  Masalah signifikan kedua, cukup aneh, adalah jumlah permintaan untuk ESP saat membuka halaman.  Menggunakan GET atau ajax, kami dihadapkan dengan fakta bahwa jumlah permintaan menjadi tidak senonoh besar.  Karena itu, ESP berperilaku tidak terduga, ia hanya bisa reboot atau memproses permintaan selama beberapa detik.  Solusinya adalah beralih ke soket web.  Setelah itu, jumlah permintaan menurun secara signifikan. <br><br>  Masalah ketiga adalah antarmuka web.  Informasi lebih lanjut tentang dia akan di artikel terpisah, yang akan dipublikasikan nanti. <br><br>  Untuk saat ini, saya hanya akan mengatakan bahwa opsi terbaik saat ini adalah menggunakan VUE.JS. <br><br>  Kerangka kerja ini adalah yang paling cocok dari semua yang telah kami uji. <br><br>  Opsi antarmuka dapat dilihat di tautan di bawah ini. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">adaptive.lytko.com</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mobile.lytko.com</a> <br><br><h3>  Pembentukan termostat </h3><br>  Setelah mengatasi semua kesulitan, kami sampai pada hasil berikut: <br><br><img src="https://habrastorage.org/webt/1r/q5/ai/1rq5aidxmw2b4zsct8rl9y8lhim.png"><br><br><img src="https://habrastorage.org/webt/fj/t8/zd/fjt8zdyi7j829j1yr8w3hps1sna.png"><br><br>  <b>Konstruksi</b> <br><br>  Thermostat terdiri dari tiga papan (modul): <br><br><ol><li>  Manajer; </li><li>  Dikelola </li><li>  Papan display </li></ol><br>  Papan <b>kontrol</b> adalah papan tempat ESP12, pengawas Perangkat Keras, dan nRF24 berada untuk bekerja dengan sensor di masa depan.  Saat memulai, perangkat ini mendukung sensor digital DS18B20.  Tapi kami menyediakan kemampuan untuk menghubungkan sensor analog dari produsen pihak ketiga.  Dan di salah satu pembaruan perangkat lunak perangkat di masa mendatang, kami akan menambahkan kemampuan untuk menggunakan sensor yang datang dengan termostat pihak ketiga. <br><br><img src="https://habrastorage.org/webt/nr/gf/vm/nrgfvmey1i1qjmiz5zuqbywn4i8.jpeg"><br><br>  <b>Dikelola</b> - papan manajemen daya dan beban.  Mereka menempatkan PSU 750mA, terminal untuk menghubungkan sensor suhu dan relay 16A untuk mengontrol beban. <br><br><img src="https://habrastorage.org/webt/s4/ka/o-/s4kao-dmzluqeabuwu1g35kggsg.jpeg"><br><br>  <b>Tampilan</b> - pada tahap pengembangan, kami memilih <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tampilan</a> 2,4 inci <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Nextion</a> . <br><br>  Tentang dia, Anda dapat dengan mudah menemukan informasi di Internet.  Saya akan menambahkan sendiri bahwa ini nyaman untuk hampir semua orang kecuali harganya.  Layar 2,4 inci berharga sekitar 1.200 rubel, yang tidak memengaruhi harga akhir dengan cara terbaik. <br><br>  Jadi diputuskan untuk membuat analog dengan kebutuhan kita, tetapi dengan harga yang lebih rendah.  Benar, itu harus diprogram dengan cara klasik, dan bukan dari lingkungan Editor Nextion.  Ini lebih sulit, tetapi kami siap untuk itu. <br><br>  Analog akan menjadi matriks 2,4 inci dengan layar sentuh dan papan dengan STM32 di papan untuk mengontrolnya dan mengurangi beban pada ESP12.  Semua kontrol akan mirip dengan Nextion oleh UART, serta memori 32MB dan kartu flash penuh untuk merekam log. <br><br>  Desain modular membuatnya mudah untuk mengubah salah satu modul dan outputnya adalah perangkat yang sama sekali berbeda. <br><br>  Misalnya, sudah ada opsi untuk "papan 2" dalam beberapa versi: <br><br><ul><li>  <b>Opsi 1</b> - untuk pemanasan di bawah lantai.  Catu daya dari 220v.  Relai mengontrol setiap beban setelahnya. </li><li>  <b>Opsi 2</b> - untuk pemanas lantai air atau katup baterai.  Didukung oleh 24V AC.  Kontrol katup 24v. </li><li>  <b>Opsi 3</b> - didukung oleh 220v.  Mengontrol saluran terpisah, seperti boiler atau sauna listrik. </li></ul><br><h3>  Kata penutup </h3><br>  Saya bukan pengembang profesional.  Saya berhasil menyatukan orang dengan satu tujuan.  Sebagian besar, semua orang bekerja untuk ide itu;  untuk membuat sesuatu yang benar-benar berharga;  apa yang akan bermanfaat bagi pengguna akhir. <br><br>  Saya yakin seseorang tidak akan menyukai desain kasingnya;  seseorang - tampilan halaman.  Ini hakmu!  Tapi kami pergi sendiri sejauh ini, melalui kritik terus-menerus tentang apa yang kami lakukan, dan yang paling penting - mengapa.  Jika tidak ada pertanyaan seperti di atas, kami akan senang untuk berbicara di komentar. <br><br>  <b>Kritik konstruktif itu baik, dan kami berterima kasih karenanya.</b> <br><br>  Kisah ide di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> .  Bagi yang berminat: <br><br><ol><li>  Untuk semua pertanyaan: grup di Telegram <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">LytkoG</a> </li><li>  Ikuti berita: Saluran berita Telegram <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Lytko News</a> </li></ol><br>  Dan ya, kita mendapatkan tinggi pada apa yang kita lakukan. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id474420/">https://habr.com/ru/post/id474420/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id474404/index.html">Analisis masalah yang dipecahkan dari kejuaraan pemrograman dari Yandex (pengembangan front-end) 2019</a></li>
<li><a href="../id474406/index.html">Penampilan pertama BlueKeep di alam direkam</a></li>
<li><a href="../id474408/index.html">Revolusi atau evolusi Model Obyek Halaman?</a></li>
<li><a href="../id474414/index.html">Kami menulis mesin voxel kami sendiri</a></li>
<li><a href="../id474418/index.html">Konferensi DEFCON 27. Manfaat dari produk-produk peretas untuk macOS. Bagian 1</a></li>
<li><a href="../id474422/index.html">Memuji Platform Sumber Terbuka untuk Mengembangkan Aplikasi Seluler</a></li>
<li><a href="../id474424/index.html">Pelatihan campuran - apa itu dan bagaimana cara kerjanya</a></li>
<li><a href="../id474426/index.html">Serial animasi "Lingkaran Matematika"</a></li>
<li><a href="../id474430/index.html">DevOpsDays Moscow - sebuah konferensi yang dibuat komunitas untuk komunitas tersebut</a></li>
<li><a href="../id474434/index.html">Bot Telegram sendiri untuk melacak uptime servernya dengan python dan docker</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>