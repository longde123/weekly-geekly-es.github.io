<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçû üèÇüèª üêä API REST sem servidor "no joelho em 5 minutos" üë®üèΩ‚Äçüíª ‚¨ÜÔ∏è ‚ôâÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° Habr! Hoje, continuamos a discuss√£o sobre as oportunidades que o Amazon Web Services nos fornece e como us√°-las na solu√ß√£o de problemas de aplicat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>API REST sem servidor "no joelho em 5 minutos"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435180/">  Ol√° Habr!  Hoje, continuamos a discuss√£o sobre as oportunidades que o Amazon Web Services nos fornece e como us√°-las na solu√ß√£o de problemas de aplicativos. <br><br>  Usando um exemplo simples, considere criar em apenas alguns minutos nossa pr√≥pria API REST auto-escal√°vel sem servidor com an√°lise de caso - obtendo uma lista para um recurso. <br><br>  Interessante?  Ent√£o v√° para o corte! <br><br><img src="https://habrastorage.org/webt/o1/lo/od/o1loodoauwe328yyywvsjwxbhpu.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">(Fonte)</a> <br><a name="habracut"></a><br><h2>  Em vez de se juntar </h2><br>  N√£o usaremos nenhum banco de dados para analisar o exemplo; em vez disso, nossa fonte de informa√ß√µes ser√° um arquivo de texto sem formata√ß√£o no AWS S3. <br><br><ul><li>  Portanto, suponha que no AWS S3 tenhamos um arquivo de texto com cabe√ßalhos e algum processo grave informa√ß√µes nele. </li><li>  Criaremos uma API de nuvem que retornar√° uma resposta JSON como uma solicita√ß√£o GET com o par√¢metro passado. </li><li>  Ao mesmo tempo, dependendo da complexidade das tarefas e, como conseq√º√™ncia, do aumento dos requisitos para o poder de processamento dos recursos, voc√™ n√£o precisa se preocupar com isso, porque  o servi√ßo √© totalmente escal√°vel automaticamente.  E isso significa que voc√™ n√£o precisa de administra√ß√£o, aloca√ß√£o e gerenciamento de servidores, basta fazer upload do seu c√≥digo e execut√°-lo. </li></ul><br><h2>  Arquitetura do sistema em desenvolvimento </h2><br><img src="https://habrastorage.org/webt/jm/7r/yb/jm7ryb1z30xucimouckrlyitm6a.png"><br><br>  Componentes do Amazon Web Services usados: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b>Amazon S3</b></a> - armazenamento de objetos, que permite armazenar quantidades quase ilimitadas de informa√ß√µes; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b>Gerenciamento de acesso e identidade da AWS (IAM)</b></a> - Um servi√ßo que fornece a capacidade de controlar com seguran√ßa o acesso aos servi√ßos e recursos da AWS.  Usando o IAM, voc√™ pode criar, gerenciar, gerenciar usu√°rios e grupos da AWS e usar permiss√µes para conceder ou negar acesso aos recursos da AWS; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b>O AWS Lambda</b></a> √© um servi√ßo que permite executar c√≥digo sem fazer backup e configurar servidores.  Todo o poder de computa√ß√£o √© dimensionado automaticamente para cada chamada.  A taxa √© cobrada com base no n√∫mero de solicita√ß√µes de recursos e sua dura√ß√£o, ou seja,  tempo durante o qual o c√≥digo √© executado. <br><blockquote>  O n√≠vel de acesso gratuito (n√≠vel gratuito) implica 1 milh√£o de solicita√ß√µes por m√™s de gra√ßa e 400K Gb-s.  Idiomas suportados: Node.js, Java, C #, Go, Python, Ruby, PowerShell </blockquote>  .  Vamos usar o Python: <br><br><ul><li>  A biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b>boto3</b></a> √© um AWS SDK para Python que permite interagir com v√°rios servi√ßos da Amazon; </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b>O Amazon API Gateway</b></a> √© um servi√ßo de desenvolvedor totalmente gerenciado, projetado para criar, publicar, manter, monitorar e proteger APIs em qualquer escala.  Al√©m da capacidade de usar v√°rias vers√µes da mesma API (etapas) para depura√ß√£o, refinamento e teste, o servi√ßo permite criar APIs REST sem servidor usando o AWS Lambda.  O Lambda executa c√≥digo em uma infraestrutura de computa√ß√£o altamente acess√≠vel, eliminando a necessidade de distribui√ß√£o, dimensionamento e gerenciamento de servidores. <br><blockquote>  A camada gratuita da API HTTP / REST inclui um milh√£o de chamadas de API por m√™s durante 12 meses </blockquote></li></ul><br><h2>  Prepara√ß√£o de dados </h2><br>  Um arquivo de texto com uma guia ser√° usado como um delimitador de campo como fonte de informa√ß√µes para gerar respostas a uma solicita√ß√£o GET REST.  As informa√ß√µes agora realmente n√£o importam para este exemplo, mas para uso posterior da API, baixei do terminal de negocia√ß√£o Quik uma tabela de negocia√ß√µes atuais de t√≠tulos denominados em rublos russos, salvei-os em bonds.txt e coloquei esse arquivo em um bucket do AWS S3 especialmente criado. <br><br>  Um exemplo das informa√ß√µes recebidas √© mostrado na figura abaixo: <br><br> <a href=""><img src="https://habrastorage.org/webt/ua/yl/na/uaylnacmex2xuts2gnqstudoxii.jpeg"></a> <br><br>  Em seguida, voc√™ precisa escrever uma fun√ß√£o que leia as informa√ß√µes do arquivo bonds.txt, analise-as e emita-as mediante solicita√ß√£o.  O AWS Lambda se sair√° bem com isso.  Mas primeiro, voc√™ precisar√° criar uma nova fun√ß√£o que permita que a fun√ß√£o Lambda criada leia as informa√ß√µes do bucket localizado no AWS S3. <br><br><h2>  Criar fun√ß√µes para o AWS Lambda </h2><br><ol><li>  No console de gerenciamento da AWS, acesse o servi√ßo AWS IAM e, em seguida, na guia "Fun√ß√µes", clique no bot√£o "Criar fun√ß√£o"; <br><br><div class="spoiler">  <b class="spoiler_title">Adicionando uma nova fun√ß√£o</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/bz/wl/n9/bzwln9pjpdlusmo8cgwv7csvey8.jpeg"><br></div></div></li><li>  A fun√ß√£o que estamos criando agora ser√° usada pelo AWS Lambda para ler as informa√ß√µes do AWS S3.  Portanto, na pr√≥xima etapa, selecione "Selecionar tipo de confi√°vel" -&gt; "Servi√ßo Aws" e "Escolha o servi√ßo que usar√° essa fun√ß√£o" -&gt; "Lambda" e clique no bot√£o "Avan√ßar: Permiss√µes" <br><br><div class="spoiler">  <b class="spoiler_title">Fun√ß√£o de servi√ßo Lambda</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/mq/bh/ik/mqbhikgn46p9m4ul1ulytb1etpk.jpeg"><br></div></div></li><li>  Agora voc√™ precisa definir as pol√≠ticas de acesso para os recursos da AWS que ser√£o usados ‚Äã‚Äãna fun√ß√£o rec√©m-criada.  Porque  a lista de pol√≠ticas √© bastante impressionante. Usando o filtro de pol√≠ticas, indicamos "S3".  Como resultado, obtemos uma lista filtrada para o servi√ßo S3.  Observe a caixa de sele√ß√£o ao lado da pol√≠tica "AmazonS3ReadOnlyAccess" e clique no bot√£o "Pr√≥ximo: Tags". <br><br><div class="spoiler">  <b class="spoiler_title">Pol√≠ticas para fun√ß√µes</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ix/nz/jk/ixnzjk8y4wkt3xo6sntt_ss_q04.jpeg"><br></div></div></li><li>  A etapa (Adicionar tags (opcional)) √© opcional, mas voc√™ pode especificar tags para Fun√ß√µes, se desejar.  N√£o faremos isso e passaremos para o pr√≥ximo passo - Visualizar.  Aqui voc√™ precisa definir o nome da fun√ß√£o - "ForLambdaS3-ReadOnly", adicionar uma descri√ß√£o e clicar no bot√£o "Criar fun√ß√£o". <br><br><div class="spoiler">  <b class="spoiler_title">Fun√ß√µes do t√≠tulo</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/pf/lc/cj/pflccjxy1lmfker-x-_jmb00m7e.jpeg"><br></div></div></li></ol><br>  Tudo, o papel foi criado e podemos us√°-lo em outros trabalhos. <br><br><h2>  Crie um novo recurso no AWS Lambda </h2><br><ol><li>  Acesse o servi√ßo AWS Lambda e clique no bot√£o "Criar fun√ß√£o": <br><br><div class="spoiler">  <b class="spoiler_title">Cria√ß√£o de Fun√ß√£o</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/lb/9g/mq/lb9gmqf_f2wkakv3y3ta-xgpr_u.jpeg"><br></div></div><br>  Preencha todos os campos, conforme mostrado na captura de tela abaixo: <br><br><ul><li>  Nome - "getAllBondsList"; </li><li>  Tempo de execu√ß√£o - "Python 3.6" </li><li>  Fun√ß√£o - "Escolha uma fun√ß√£o existente" </li><li>  Fun√ß√£o existente - aqui selecionamos a fun√ß√£o que criamos acima - ForLambdaS3-ReadOnly </li></ul><br><div class="spoiler">  <b class="spoiler_title">Nome e escolha da fun√ß√£o</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/g7/7y/od/g77yodilqokdh3rmtmwk1arsh80.jpeg"><br></div></div></li><li>  Resta apenas escrever o c√≥digo da fun√ß√£o e verificar seu desempenho em v√°rias execu√ß√µes de teste.  Deve-se notar que o principal componente de qualquer fun√ß√£o Lambda (se voc√™ usa Python) √© a biblioteca boto3: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> boto3 s3 = boto3.resource(<span class="hljs-string"><span class="hljs-string">'s3'</span></span>) bucket = s3.Bucket(<span class="hljs-string"><span class="hljs-string">'your-s3-bucket'</span></span>) obj = bucket.Object(key = <span class="hljs-string"><span class="hljs-string">'bonds.txt'</span></span>) response = obj.get()</code> </pre> <br>  A id√©ia b√°sica da nossa fun√ß√£o Python √© a seguinte: <br><br><ul><li>  Abra o arquivo bonds.txt; </li><li>  Leia os cabe√ßalhos das colunas; </li><li>  Quebrar recordes por p√°gina (10 cole√ß√µes no nosso caso); </li><li>  Selecione a p√°gina desejada; </li><li>  Mapeie o nome das colunas e registros; </li><li>  D√™ o resultado na forma de cole√ß√µes. </li></ul><br>  N√£o dedicaremos muito tempo ao c√≥digo de fun√ß√£o e √† implementa√ß√£o t√©cnica, tudo √© bem simples aqui e o c√≥digo completo est√° dispon√≠vel no meu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GitHub</a> . <br><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, len(lines_proc)): d = dict((<span class="hljs-string"><span class="hljs-string">u''</span></span>.join(key), <span class="hljs-string"><span class="hljs-string">u''</span></span>.join(value)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (key, value) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(headers, lines_proc[i].split(<span class="hljs-string"><span class="hljs-string">"\t"</span></span>))) response_body.append(d) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-string"><span class="hljs-string">'statusCode'</span></span>: <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-string"><span class="hljs-string">'page'</span></span> : num_page, <span class="hljs-string"><span class="hljs-string">'body'</span></span>: response_body }</code> </pre><br>  Insira o c√≥digo (ou escreva o seu pr√≥prio :)) no bloco "C√≥digo da fun√ß√£o" e clique no bot√£o "Salvar" no canto superior direito da tela. <br><br><div class="spoiler">  <b class="spoiler_title">Inser√ß√£o de c√≥digo</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/py/v7/bz/pyv7bzmaokoa7dxmgc-auhuji7q.jpeg"><br></div></div></li><li>  Crie eventos de teste.  Ap√≥s inserir o c√≥digo, a fun√ß√£o estar√° dispon√≠vel para inicializa√ß√£o e teste.  Clique no bot√£o "Teste" e crie alguns eventos de teste: iniciando a fun√ß√£o lambda_handler com par√¢metros diferentes.  Ou seja: <br><br><ul><li>  Iniciando uma fun√ß√£o com o par√¢metro 'page': '100'; </li><li>  Ativando uma fun√ß√£o com o par√¢metro 'page': '1000000'; </li><li>  Iniciando uma fun√ß√£o com o par√¢metro 'page': 'bla-bla-bla'; </li><li>  Executando uma fun√ß√£o sem o par√¢metro 'page'. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Evento de teste P√°gina100</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/f4/lc/s8/f4lcs8v_qj_nmzetyijk0ybngp4.jpeg"><br></div></div><br>  Iniciando a fun√ß√£o criada com o envio da p√°gina de evento de teste == 100. Como pode ser visto na captura de tela abaixo, a fun√ß√£o funcionou com √™xito, retornou o status 200 (OK), bem como uma cole√ß√£o de cole√ß√µes que correspondem √† cent√©sima p√°gina de dados divididos usando pagina√ß√£o. <br><br><div class="spoiler">  <b class="spoiler_title">Evento de teste de disparo P√°gina100</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/of/7e/1b/of7e1bgnqpk63gugwnletylpxzk.jpeg"><br></div></div><br>  Para a pureza do experimento, lan√ßaremos outro evento de teste - ‚ÄúPageBlaBlaBla‚Äù.  Nesse caso, a fun√ß√£o retorna o resultado com o c√≥digo 415 e um coment√°rio de que √© necess√°rio verificar a corre√ß√£o dos par√¢metros passados: <br><br><div class="spoiler">  <b class="spoiler_title">Evento de teste PageBlaBlaBla</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/sp/qt/op/spqtopae3qqqroxxpwmhcdmdmu8.jpeg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Disparo de evento PageBlaBlaBla</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/v3/ms/3x/v3ms3x0jd9pyucqqmnb4qqnful4.jpeg"><br></div></div><br></li></ol><br><h2>  Cria√ß√£o de API </h2><br>  Depois que todos os outros casos s√£o testados e h√° um entendimento de que a fun√ß√£o Lambda funciona conforme o esperado, continuamos a criar a API.  Vamos criar um ponto de acesso para a fun√ß√£o Lambda criada acima e configurar adicionalmente a prote√ß√£o contra arranques indesejados usando a Chave da API. <br><br><ul><li>  Acesse o servi√ßo AWS API Gateway.  Clique no bot√£o Criar API, defina o nome da API - getAllBondsList <br><br><div class="spoiler">  <b class="spoiler_title">Crie uma nova API</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/yc/1q/7z/yc1q7zqud7q7m_fu7gibtsql9-w.jpeg"><br></div></div></li><li>  Adicione o m√©todo GET √† API rec√©m-criada.  Para fazer isso, selecione A√ß√µes -&gt; Criar m√©todo, selecione o m√©todo GET na lista suspensa e clique na marca de sele√ß√£o <br><br><div class="spoiler">  <b class="spoiler_title">Novo m√©todo GET</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/7j/6j/df/7j6jdfyvpyvhzhfv3yjxewkc0lk.jpeg"><br></div></div><br>  Em seguida, indicamos que o m√©todo GET usar√° nossa fun√ß√£o lambda getAllBondsList.  Selecione-o e clique no bot√£o Salvar. <br><br><div class="spoiler">  <b class="spoiler_title">Vincula√ß√£o de Fun√ß√£o Lambda</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/zi/8e/5l/zi8e5ly5xby143omz8p_-oxk4x0.jpeg"><br></div></div></li><li>  Vamos implantar nossa API, obtendo assim o URL para chamar a API. <br>  Clique em A√ß√µes -&gt; Implementar API e, em seguida, Est√°gio de Implanta√ß√£o -&gt; Novo Est√°gio <br><blockquote>  √â poss√≠vel implantar a API em diferentes est√°gios e voc√™ pode cham√°-los como desejar (por exemplo, DEV / QA / PROD).  Vamos implantar imediatamente no PROD. </blockquote><div class="spoiler">  <b class="spoiler_title">Implementar API</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ok/vb/gm/okvbgmwxrrzzcilnvzwisbeoqw4.jpeg"><br></div></div><br>  Ap√≥s a implanta√ß√£o, um link para iniciar a API rec√©m-criada estar√° dispon√≠vel.  Iremos a este URL na barra de endere√ßos do navegador (ou executaremos o comando curl no terminal) - receberemos uma chamada de API e, como resultado, iniciaremos a fun√ß√£o Lambda: <br><br><div class="spoiler">  <b class="spoiler_title">URL da API</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/y3/ok/1e/y3ok1esjw61-xjp7uzql21cxdxa.jpeg"><br></div></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Usarei o</a> aplicativo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Postman</a> para demonstrar o AWS API Gateway.  Nele, voc√™ pode depurar e testar com bastante facilidade o funcionamento da API. <br><br><div class="spoiler">  <b class="spoiler_title">Primeiro teste de API</b> <div class="spoiler_text">  Copie o URL do est√°gio PROD para o Postman e envie uma solicita√ß√£o GET para nossa API: <br><br> <a href=""><img src="https://habrastorage.org/webt/bo/ku/3x/boku3xlj9kkoknm0wfnax1ninqg.jpeg"></a> <br><br>  Parece que algo deu errado ... a solicita√ß√£o GET retornou uma resposta JSON com o c√≥digo 400 e uma dica de que o par√¢metro Page n√£o foi definido na solicita√ß√£o de chamada da API.  Adicione suporte para par√¢metros de solicita√ß√£o √† API. <br></div></div></li><li>  Suporte para par√¢metros passados ‚Äã‚Äãna solicita√ß√£o. <br>  Retornamos √†s configura√ß√µes da solicita√ß√£o GET e vamos para a etapa Solicita√ß√£o de m√©todo. <br><br><div class="spoiler">  <b class="spoiler_title">Solicita√ß√£o de m√©todo</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/di/yi/oo/diyioox34z86tv41lrp0oqw8tu4.jpeg"><br></div></div><br>  Nas configura√ß√µes detalhadas da Solicita√ß√£o de m√©todo, voc√™ precisa expandir o bloco Par√¢metros da string de consulta da URL e adicionar um novo par√¢metro "p√°gina" e torn√°-lo obrigat√≥rio: <br><br><div class="spoiler">  <b class="spoiler_title">Adicionando um par√¢metro</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/j2/rj/gc/j2rjgcaffqvrmq6a6rrh7znhimy.jpeg"><br></div></div><br>  Retornamos √† p√°gina Method Execution e vamos para a Solicita√ß√£o de Integra√ß√£o.  Descemos para o final da p√°gina e abrimos o bloco "Modelos de mapeamento".  Selecione "Quando n√£o houver modelos definidos (recomendado)", no campo Tipo de conte√∫do, especifique <b>application / json</b> e clique na marca de sele√ß√£o.  Percorremos a p√°gina abaixo e inserimos o c√≥digo na caixa de texto, conforme indicado na figura abaixo.  Depois disso, clique no bot√£o Salvar. <br><br><div class="spoiler">  <b class="spoiler_title">Solicita√ß√£o de m√©todo</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ue/s3/y5/ues3y5vyonxozczm7onfg2-351s.jpeg"><br></div></div><br>  Ap√≥s a implanta√ß√£o da API, verificamos novamente, mas com o par√¢metro "page" passado: <br><br> <a href=""><img src="https://habrastorage.org/webt/s5/-3/v_/s5-3v_kqnx5k3drotwwhw4mltf4.jpeg"></a> <br><br>  √â um sucesso!  Agora a solicita√ß√£o deu certo e retornou para n√≥s as cole√ß√µes contidas na d√©cima p√°gina!  Viva! </li><li>  Resta apenas proteger nossa API contra ataques indesejados externos. <br><br>  Para fazer isso, voc√™ precisa configurar a API de maneira que, ao acessar, exija uma chave secreta, que √© passada para o cabe√ßalho. <br><br>  V√° para as Chaves da API e crie um novo grupo de chaves da API - KeyForBondsList. <br><br><div class="spoiler">  <b class="spoiler_title">Chaves de API</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/su/na/ba/sunaba6acca0mmout5n1yu4xyd8.jpeg"><br></div></div><br>  Ap√≥s a cria√ß√£o da chave da API com sucesso, voc√™ deve especificar que a API getAllBondsList deve exigir que a chave da API seja passada no cabe√ßalho da solicita√ß√£o.  E vincule um KeyForBondsList espec√≠fico √† API getAllBondsList. <br><br>  Vamos voltar para as configura√ß√µes da solicita√ß√£o GET em Solicita√ß√£o de m√©todo e alterar o par√¢metro API Key Required de false para true.  Agora a API exigir√° a transfer√™ncia da chave da API. <br><br><div class="spoiler">  <b class="spoiler_title">Chave de API necess√°ria</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/dn/gu/sy/dngusygxk5h50j4qnbcxt3umkbs.jpeg"><br></div></div><br>  Acesse Plano de uso e crie um novo plano para usar a API. <br><br>  Em primeiro lugar, fornecemos um nome e uma descri√ß√£o e, em segundo lugar, aqui voc√™ pode definir limites para iniciar a API, por exemplo, n√£o mais que um lan√ßamento por segundo, etc. <br><br><div class="spoiler">  <b class="spoiler_title">Criando plano de uso</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/zl/-3/y9/zl-3y9ruwexssvl3jzpzlocfqpe.jpeg"><br></div></div><br>  Clique em Avan√ßar e v√° para a pr√≥xima p√°gina em que voc√™ precisa conectar os est√°gios da API ao plano de uso: <br><br><div class="spoiler">  <b class="spoiler_title">Vinculando um est√°gio a um plano de uso</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/lh/q8/m0/lhq8m0te7ejfwkjz1sftxwznz24.jpeg"><br></div></div><br>  Na pr√≥xima p√°gina, vinculamos as chaves da API ao plano de uso da API.  Clique no bot√£o Adicionar chaves de API ao plano de uso e encontre as chaves de API criadas nas etapas anteriores por nome: <br><br><div class="spoiler">  <b class="spoiler_title">Vinculando chaves da API ao plano de uso</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/y2/p0/8c/y2p08c59ly3trqt6kjhlbud2tmg.jpeg"><br></div></div><br>  Depois de executar a implanta√ß√£o e executar a chamada GET da nossa API novamente, obtemos a resposta: "Proibido", porque  falta ao cabe√ßalho da solicita√ß√£o a chave da API: <br><br> <a href=""><img src="https://habrastorage.org/webt/oy/z9/39/oyz939fbfo9e6g-xpbujygkhj3o.jpeg"></a> <br><br>  Vamos tentar adicion√°-lo, copiando da API Keys -&gt; KeyForBondsList -&gt; API key -&gt; Mostrar e col√°-lo na se√ß√£o correspondente da solicita√ß√£o com a chave "x-api-key": <br><br> <a href=""><img src="https://habrastorage.org/webt/vc/ml/l5/vcmll5c2bbyazujggy7orazylbm.jpeg"></a> <br><br>  Tudo deu certo!  Dessa vez, a solicita√ß√£o retorna dados sem problemas, a chamada da API √© segura e protegida contra invasores pela chave secreta da API. </li></ul><br><h2>  Conclus√µes e Resumo </h2><br>  Neste artigo, analisamos a cria√ß√£o de uma API REST auto-escal√°vel sem servidor usando os servi√ßos de nuvem da Amazon.  O artigo n√£o era o menor em volume, mas tentei explicar o m√°ximo poss√≠vel todo o processo de cria√ß√£o da API e compor toda a sequ√™ncia de a√ß√µes. <br><br>  Estou certo de que, ap√≥s uma ou duas repeti√ß√µes das etapas descritas no artigo, voc√™ pode aumentar as APIs da nuvem em 5 minutos ou at√© mais r√°pido. <br><br>  Devido √† sua relativa simplicidade, baixo custo e energia, o servi√ßo AWS API Gateway abre grandes oportunidades para os desenvolvedores usarem no trabalho e em projetos comerciais.  Para consolidar o material te√≥rico deste artigo, tente fazer uma assinatura anual gratuita do Amazon Web Services e execute as etapas acima para criar uma API REST. <br><br>  Para qualquer d√∫vida e sugest√£o, estou pronto para conversar com prazer.  Aguardo seus coment√°rios sobre o artigo e desejo-lhe sucesso! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt435180/">https://habr.com/ru/post/pt435180/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt435170/index.html">Uma olhada no Apple Watch ECG para algu√©m que se importa</a></li>
<li><a href="../pt435172/index.html">Oculus GoBlack - como melhorar o Oculus Go</a></li>
<li><a href="../pt435174/index.html">Unreal Engine 4 - sombreador em chamas</a></li>
<li><a href="../pt435176/index.html">DEFCON 21. As senhas por si s√≥ n√£o s√£o suficientes, ou por que a criptografia de disco ‚Äúquebra‚Äù e como isso pode ser corrigido. Parte 1</a></li>
<li><a href="../pt435178/index.html">DEFCON 21. As senhas por si s√≥ n√£o s√£o suficientes, ou por que a criptografia de disco ‚Äúquebra‚Äù e como isso pode ser corrigido. Parte 2</a></li>
<li><a href="../pt435182/index.html">Estudo: mercado de HDD encolher√° um ter√ßo at√© 2021</a></li>
<li><a href="../pt435184/index.html">Intelig√™ncia artificial aprendida a encontrar a doen√ßa de Alzheimer no c√©rebro 6 anos antes do diagn√≥stico</a></li>
<li><a href="../pt435186/index.html">Rolls-Royce desenvolve o avi√£o el√©trico mais r√°pido do mundo</a></li>
<li><a href="../pt435190/index.html">O Google conseguiu retirar a tributa√ß√£o de US $ 22,7 bilh√µes atrav√©s da Irlanda e Bermuda</a></li>
<li><a href="../pt435194/index.html">Simplifique a escrita do curr√≠culo de um desenvolvedor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>