<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèæ üôáüèº ü¶á Dispositivo EDC Sysadmin: Linux en tu bolsillo üíÉüèæ üåï üë¶üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cada administrador, tal vez, tuvo un caso cuando algo repentinamente se descompone, y usted est√° en alg√∫n lugar del camino: va en autom√≥vil, toma un t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dispositivo EDC Sysadmin: Linux en tu bolsillo</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/409945/"> Cada administrador, tal vez, tuvo un caso cuando algo repentinamente se descompone, y usted est√° en alg√∫n lugar del camino: va en autom√≥vil, toma un tren o, banalmente, se sienta en alg√∫n lugar en el banco de un parque y se suelta y sale corriendo a alg√∫n lado el deseo no es lo m√°s m√≠nimo.  Y necesitas arreglarlo.  O, como m√≠nimo, eval√∫e la escala del animal blanco con pelaje que ha llegado. <br><br>  Est√° claro que puede hacerlo con un tel√©fono inteligente o una tableta, especialmente si solo necesita usar ssh.  Pero usar una pantalla t√°ctil en tales casos, como para m√≠, es dolor y sufrimiento. <br><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hd/-j/nd/hd-jndx6jjchvd9ggnpyj-ynvhw.jpeg"></div><br>  Puede comprar un teclado externo, soporte o soporte para la tableta, pero creo que es m√°s f√°cil llevar una computadora port√°til completa con usted.  Los lugares tomar√°n casi lo mismo. <br><a name="habracut"></a><br><h2>  Algunos recuerdos y razonamientos </h2><br>  Demasiado perezoso para leer, puede pasar inmediatamente a la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">parte pr√°ctica.</a> <br><br>  En un momento, cuando los androides y los iPhones a√∫n no exist√≠an, para tales cosas us√© la "tableta de Internet" Nokia N810.  El tel√©fono tiene dimensiones con un tel√©fono inteligente moderno, mientras que tiene un teclado qwerty e incluso con Linux completo a bordo.  Ssh, vnc, rdesktop: ¬°s√≠, no hay duda!  Adem√°s, utilic√© activamente CAS Maxima cuando necesitaba calcular algo r√°pidamente y mostrar el resultado. <br><br><br> <a href=""><img src="https://habrastorage.org/webt/bd/e7/kx/bde7kxemqv5fuchk9o5aujaokte.jpeg"></a> <br> <a href=""><img src="https://habrastorage.org/webt/so/ya/xr/soyaxrvavdiymhza5xjuv0mhy7q.png"></a> <br><br>  Pero pas√≥ el tiempo, comenzaron a aparecer los tel√©fonos inteligentes Android.  Aqu√≠ est√°, pens√©: Linux casi completo, al mismo tiempo, no hay necesidad de llevar otro dispositivo con usted para distribuir Internet.  Comenc√© a mirar el dispositivo con qwerty, que me reemplazar√≠a con el viejo y bueno n810, que en ese momento estaba bastante cansado (cable de pantalla, bater√≠a reemplazada dos veces, teclado, carcasa rota).  La elecci√≥n recay√≥ en Motorola Milestone. <br><br>  Aqu√≠ est√°, en parte, junto a mi viejo Palm V y N810: <br><br> <a href=""><img src="https://habrastorage.org/webt/hh/vf/bm/hhvfbmnvsxhy_2srw11rhwt8r5g.jpeg"></a> <br><br>  Debo decir que el producto no justifica la confianza.  El teclado fue una completa decepci√≥n.  Ni siquiera por el dise√±o, sino por la mano de obra extremadamente pobre: ‚Äã‚Äãdespu√©s de seis meses de uso, comenz√≥ a exfoliarse y pasar el rato. <br><br>  El gestor de arranque cifrado agreg√≥ sus u√±as al ata√∫d: la incapacidad de usar el n√∫cleo personalizado con todas las consecuencias, el debian chroot se comi√≥ la bater√≠a como si en s√≠ mismo, debido a las peculiaridades de la fuente de alimentaci√≥n, pero de todos modos, el producto de alguna manera resolvi√≥ las tareas que se le asignaron. <br><br>  Por lo menos, continu√≥ us√°ndose despu√©s de la expiraci√≥n del per√≠odo de obsolescencia planificado determinado por el fabricante, cuando se lanzaron varios modelos m√°s recientes (que difieren, tal vez con un dise√±o ligeramente cambiado y mucha RAM), y era muy defectuoso y lento. <br><br>  De acuerdo, ya que la terminal ssh se apagar√° y el tel√©fono inteligente (por supuesto, engullir√° una cierta cantidad de c√©lulas nerviosas).  Pero hay casos en los que necesita aferrarse a una pieza de hierro con un cable de consola, o eliminar tcpdump con un dispositivo IP que no responde para que pueda hacer algo con √©l. <br><br>  Es simplemente encantador cuando, debido a la presencia de un puerto COM en la estaci√≥n de acoplamiento, una persona arrastra a un pesado tonto HP de 17 "con un muelle y una fuente de alimentaci√≥n de 1.5 kilogramos, y luego cuelga con todo esto en la escalera de mano frente al mostrador. <br><br>  Recientemente, utilic√© el ThinkPad x220 de 12 "con el adaptador usb2com. Pero cada vez m√°s comenc√© a dejar el port√°til en casa, hasta que un d√≠a (una vez m√°s)" $ nombre de usuario, ¬°todo se rompi√≥! ", Y solo ten√≠a un tel√©fono inteligente Android conmigo. <br><br><h2>  Aqu√≠ est√°, el pez de mis sue√±os (de hecho, no) </h2><br>  Y una vez me encontr√© con un producto llamado GPD Pocket.  Una computadora port√°til completa con el formato de un re-tel√©fono inteligente o una tableta de menor tama√±o.  7 ", qwerty-keyboard, un margen de autonom√≠a decente - eh, necesitas tomarlo. Orden√©, recib√≠, desempaqu√©. <br><br>  Para comparar con x220 y n810: <br><br> <a href=""><img src="https://habrastorage.org/webt/jg/kj/hq/jgkjhqw3ulrb3i956decqaladlk.jpeg"></a> <br><br>  No describir√© las caracter√≠sticas de aquellos que lo necesitan: lo encontrar√°n en Internet, especialmente desde que recientemente hubo una cr√≠tica empalagosa de girbest aqu√≠.  Solo da el escape lshw y lspci: <br><br>  lshw: <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><pre><code class="plaintext hljs">:   : Default string (Default string) : Default string : Default string  ‚Ññ: Default string : 64 bits : smbios-3.0 dmi-3.0 vsyscall32 : boot=normal chassis=desktop family=Default string sku=Default string uuid=00020003-0004-0005-0006-000700080009 *-core :   : Default string : AMI Corporation  ID: 0 : Default string  ‚Ññ: Default string : Default string *-firmware : BIOS : American Megatrends Inc.  ID: 0 : 5.11 date: 08/07/2017 : 64KiB capacity: 4032KiB : pci upgrade shadowing cdboot bootselect socketedrom edd int13floppy1200 int13floppy720 int13floppy2880 int5printscreen int14serial int17printer acpi usb biosbootspecification uefi *-memory :    ID: 28 :      : 8GiB *-bank:0 : DIMM DDR3 1066 MHz (0,9 ns) : 00000000 : Hynix Semiconductor  ID: 0  ‚Ññ: 00000000 : A1_DIMM0 : 4GiB : 8 bits : 1066MHz (0.9ns) *-bank:1 : DIMM DDR3 1066 MHz (0,9 ns) : 00000000 : Hynix Semiconductor  ID: 1  ‚Ññ: 00000000 : A1_DIMM1 : 4GiB : 8 bits : 1066MHz (0.9ns) *-cache:0 : L1   ID: 32 : CPU Internal L1 : 224KiB capacity: 224KiB : internal write-back : level=1 *-cache:1 : L2   ID: 33 : CPU Internal L2 : 2MiB capacity: 2MiB : internal write-back unified : level=2 *-cpu :  : Intel(R) Atom(TM) x7-Z8750 CPU @ 1.60GHz : Intel Corp.  ID: 34   : cpu@0 : Intel(R) Atom(TM) x7-Z8750 CPU @ 1.60GHz : SOCKET 0 : 889MHz capacity: 2560MHz : 64 bits : 80MHz : x86-64 fpu fpu_exception wp vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp constant_tsc arch_perfmon pebs bts rep_good nopl xtopology tsc_reliable nonstop_tsc cpuid aperfmperf tsc_known_freq pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm sse4_1 sse4_2 movbe popcnt tsc_deadline_timer aes rdrand lahf_lm 3dnowprefetch epb pti tpr_shadow vnmi flexpriority ept vpid tsc_adjust smep erms dtherm ida arat cpufreq : cores=4 enabledcores=4 threads=4 *-pci : Host bridge : Intel Corporation : Intel Corporation  ID: 100   : pci@0000:00:00.0 : 34 : 32 bits : 33MHz : driver=iosf_mbi_pci : IRQ:0 *-display : VGA compatible controller : Intel Corporation : Intel Corporation  ID: 2   : pci@0000:00:02.0 : 34 : 64 bits : 33MHz : pm msi vga_controller bus_master cap_list rom : driver=i915 latency=0 : IRQ:123 :a0000000-a0ffffff :80000000-9fffffff ioport:f000(=64) :c0000-dffff *-generic:0 : Signal processing controller : Intel Corporation : Intel Corporation  ID: b   : pci@0000:00:0b.0 : 34 : 64 bits : 33MHz : msi pm cap_list : driver=proc_thermal latency=0 : IRQ:129 :a1a3b000-a1a3bfff *-usb : USB controller : Intel Corporation : Intel Corporation  ID: 14   : pci@0000:00:14.0 : 34 : 64 bits : 33MHz : pm msi xhci bus_master cap_list : driver=xhci_hcd latency=0 : IRQ:121 :a1a00000-a1a0ffff *-usbhost:0 : xHCI Host Controller : Linux 4.15.0-rc7-stockmind-gpdpocket xhci-hcd  ID: 0   : usb@1  : usb1 : 4.15 : usb-2.00 : driver=hub slots=7 speed=480Mbit/s *-usb:0 :  : Gaming Keyboard : SINO WEALTH  ID: 2   : usb@1:2 : 1.00 : usb-1.10 : driver=usbhid maxpower=100mA speed=1Mbit/s *-usb:1 :  USB- : BCM2045A0 : Broadcom Corp  ID: 3   : usb@1:3 : 1.12  ‚Ññ: B0F1ECED56A9 : usb-2.00 : driver=btusb maxpower=100mA speed=12Mbit/s *-usbhost:1 : xHCI Host Controller : Linux 4.15.0-rc7-stockmind-gpdpocket xhci-hcd  ID: 1   : usb@2  : usb2 : 4.15 : usb-3.00 : driver=hub slots=6 speed=5000Mbit/s *-generic:1 : Encryption controller : Intel Corporation : Intel Corporation  ID: 1a   : pci@0000:00:1a.0 : 34 : 32 bits : 33MHz : pm msi bus_master cap_list : driver=mei_txe latency=0 : IRQ:130 :a1900000-a19fffff :a1800000-a18fffff *-pci : PCI bridge : Intel Corporation : Intel Corporation  ID: 1c   : pci@0000:00:1c.0 : 34 : 32 bits : 33MHz : pci pciexpress msi pm normal_decode bus_master cap_list : driver=pcieport : IRQ:117 :a1000000-a14fffff *-network :   : BCM4356 802.11ac Wireless Network Adapter : Broadcom Corporation  ID: 0   : pci@0000:01:00.0  : wlp1s0 : 02  ‚Ññ: b0:f1:ec:ed:56:a8 : 64 bits : 33MHz : pm msi pciexpress bus_master cap_list ethernet physical wireless : broadcast=yes driver=brcmfmac driverversion=7.35.180.119 firmware=01-1a5c4016 ip=192.168.1.142 latency=0 multicast=yes wireless=IEEE 802.11 : IRQ:125 :a1400000-a1407fff :a1000000-a13fffff *-isa : ISA bridge : Intel Corporation : Intel Corporation  ID: 1f   : pci@0000:00:1f.0 : 34 : 32 bits : 33MHz : isa bus_master cap_list : driver=lpc_ich latency=0 : IRQ:0</code> </pre> </div></div><br>  lspci: <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">00:00.0 Host bridge: Intel Corporation Device 2280 (rev 34) 00:02.0 VGA compatible controller: Intel Corporation Device 22b0 (rev 34) 00:0b.0 Signal processing controller: Intel Corporation Device 22dc (rev 34) 00:14.0 USB controller: Intel Corporation Device 22b5 (rev 34) 00:1a.0 Encryption controller: Intel Corporation Device 2298 (rev 34) 00:1c.0 PCI bridge: Intel Corporation Device 22c8 (rev 34) 00:1f.0 ISA bridge: Intel Corporation Device 229c (rev 34) 01:00.0 Network controller: Broadcom Corporation BCM4356 802.11ac Wireless Network Adapter (rev 02)</code> </pre></div></div><br>  La calidad de construcci√≥n es buena, no reproduce nada, no cruje, no se dobla.  La carcasa es de aluminio y, en general, el dispositivo da la impresi√≥n de una especie de bloque monol√≠tico.  Esta es una ventaja. <br><br>  Pero tambi√©n hay suficientes inconvenientes.  Pantalla brillante  No, no es solo brillante, es literalmente un espejo.  Es decir, observar√° su reflejo en condiciones de iluminaci√≥n distinta de cero.  Hab√≠a una pel√≠cula protectora en el kit, pero no resolvi√≥ el problema. <br><br>  El segundo es el teclado.  El hecho de que ella es maravillosa. <br><br> <a href=""><img src="https://habrastorage.org/webt/zx/ac/cf/zxaccfpxwmrrsoxazzhah3yffk0.jpeg"></a> <br><br>  Pero c√≥mo se implementa es verg√ºenza y horror.  Intentando hackear debajo del macbook, con estos espacios vac√≠os entre los botones, bueno, ¬øpor qu√©?  Despu√©s de todo, el p√∫blico objetivo, al parecer, no son gatitos glamorosos, solo toman el pr√≥ximo ipad o macbook.  No tenga estos huecos infelices, el tama√±o de las teclas podr√≠a hacerse m√°s grande. <br><br>  El bot√≥n Fn tiene una capa muy escasa: estos son 2 botones para ajustar el brillo, F1-F12 e Insertar.  ¬øPor qu√© necesitamos la fila superior?  Podr√≠a implementarse como una capa separada. <br><br>  Los usuarios de Vim son particularmente dolorosos y sufren con un colon colocado en la fila inferior al lado de Ctrl. <br><br>  Bien, todo est√° mal, lo trataremos, ya que hay algunas formas (m√°s sobre esto a continuaci√≥n). <br><br>  Oh s√≠, hay un trackpoint aqu√≠.  Lo que para m√≠, como usuario experimentado de ThinkPad, calienta mi alma.  Solo una cosa: el trackpoint est√° ubicado en el lugar equivocado y para usarlo, debes doblar el pulgar.  Esto, desafortunadamente, es incurable.  Pero por un par de gorras rojas adicionales en el kit, por supuesto, gracias. <br><br>  Punto de referencia de persona sana: <br><img src="https://habrastorage.org/webt/hl/qp/9_/hlqp9_0jr_ergvl5hklnu3js1l4.jpeg"><br><br>  Punto de seguimiento del fumador: <br><img src="https://habrastorage.org/webt/vm/be/dm/vmbedms-h1ze_4cnu9_vpecgtri.jpeg"><br><br><h2>  Instalar y configurar Linux en GPD Pocket </h2><br>  Est√° claro que las "ventanas", y las "ventanas 10" especialmente, no son lo que necesito en este dispositivo, sino que simplemente est√°n contraindicadas. <br><br>  Debido a las caracter√≠sticas del dispositivo, como la orientaci√≥n de la pantalla (se gira hacia un lado), es imposible simplemente tomar e instalar su Debian favorito sin bailar con una pandereta. <br><br> <a href=""><img src="https://habrastorage.org/webt/j_/xy/ai/j_xyai5nsa-njzt67cjgkq4joq4.jpeg"></a> <br><br>  En principio, el sitio web oficial tiene la imagen oficial de Ubuntu LTS 16.04 (que me parece una buena alternativa a Debian estable), pero despu√©s de leer las discusiones en Internet, se decidi√≥ utilizar el proyecto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GPD Pocket Ubuntu Respin</a> <br><br>  Enfatizo, en general, lo obvio de que solo una imagen construida en Ubuntu es adecuada para usar y alimentar un script, por ejemplo, Debian, no funcionar√°: <br><br><pre> <code class="plaintext hljs">$./build.sh debian-9.3.0-amd64-netinst.iso Display setting: Xorg-Standard Looking for kernel image... Extracting kernel files... Archive: gpdpocket-20180115-kernel-files.zip inflating: linux-headers-4.15.0-rc7-stockmind-gpdpocket_4.15.0-rc7-stockmind-gpdpocket-1_amd64.deb inflating: linux-image-4.15.0-rc7-stockmind-gpdpocket_4.15.0-rc7-stockmind-gpdpocket-1_amd64.deb inflating: linux-libc-dev_4.15.0-rc7-stockmind-gpdpocket-1_amd64.deb ./isorespin.sh: 'debian-9.3.0-amd64-netinst.iso' must be an Ubuntu (or Ubuntu flavour), Linux Mint, neon, elementary, BackBox or Peppermint desktop ISO.</code> </pre><br>  En la salida, obtenemos el archivo linuxium-xubuntu-16.04-desktop-amd64.iso, que escribimos en la unidad flash USB: <br><br><pre> <code class="plaintext hljs">#dd if=linuxium-xubuntu-16.04-desktop-amd64.iso of=/dev/sdX</code> </pre> <br>  Arrancamos desde √©l configurando el dispositivo de arranque, yendo a la configuraci√≥n de UEFI con el bot√≥n Eliminar en el arranque. <br><br>  El procedimiento de instalaci√≥n es trivial, no veo ning√∫n sentido en la dispersi√≥n.  Solo noto que es mejor producirlo desde el modo Live, por lo que la pantalla no se girar√° hacia un lado. <br><br>  Utilizo cifrado de disco completo, en caso de que el dispositivo se pierda o sea robado de repente.  Entonces, al menos, todas sus claves ssh (s√≠, s√© sobre protecci√≥n con contrase√±a y ssh-agent) y los inicios de sesi√≥n en los recursos de Internet permanecer√°n intactos.  Por lo tanto, puse LVM sobre LUKS, que tambi√©n te deseo. <br><br><h2>  Corregir las curvulinas. </h2><br><h3>  Sue√±o e hibernaci√≥n </h3><br>  Ser√≠a bueno poder tirar una computadora port√°til en una bolsa y olvidarse de ella hasta que sea necesaria.  Afortunadamente, el tama√±o y el peso lo permiten.  Ser√≠a bueno no iniciar, cada vez, las aplicaciones necesarias manualmente, sino simplemente continuar trabajando desde el lugar donde lo dej√≥. <br><br>  El modo de suspensi√≥n, al parecer, funciona fuera de la caja.  Se implementa por medios regulares, es decir, a trav√©s de systemctl suspend.  Sin embargo, emp√≠ricamente, se encontr√≥ que el consumo de energ√≠a en este modo no es muy inferior al consumo inactivo.  Aparentemente, el dispositivo simplemente apaga la pantalla, las interfaces de red y apaga el refrigerador.  Como resultado, la bater√≠a aterrizar√° en cero d√≠as durante dos. <br><br>  Necesita hibernaci√≥n.  El sistema normal hibernate result√≥ inoperativo: el estado se volc√≥ en un intercambio, pero no se puede recuperar en el arranque. <br><br>  Record√© que existe un proyecto de este tipo: la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">suspensi√≥n del software del espacio de usuario</a> y sus paquetes est√°n en el repositorio. <br><br><pre> <code class="plaintext hljs">#apt install hibernate</code> </pre> <br>  Comprobamos: <br><br><pre> <code class="plaintext hljs">#hibernate-disk</code> </pre> <br>  ¬°Voila, funciona!  El sistema volcado y apagado.  Despu√©s de ingresar la contrase√±a LUKS, recuperada.  Pero el sonido y el wifi estaban cubiertos, el brillo de la luz de fondo de la pantalla se restableci√≥ al m√°ximo.  Lo terminaremos <br><br><h3>  Instala lo necesario </h3><br>  Antes de continuar con la configuraci√≥n de ACPI, deber√° instalar varias utilidades. <br><br>  Entonces, para ajustar el brillo de la pantalla es responsable xbacklight. <br><br><pre> <code class="plaintext hljs">#apt install xbacklight</code> </pre> <br>  La computadora port√°til no es un disco duro, sino una unidad flash, por lo que no quiero matarlo con un intercambio.  Hay tal cosa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ZRam</a> , aqu√≠ la usaremos.  Ahora todo es simple con esto, no necesita prescribir hojas en rc.local, y solo necesita hacer lo siguiente: <br><br><pre> <code class="plaintext hljs">#apt install zram-config #sudo systemctl enable zram-config.service</code> </pre><br>  El script en s√≠ calcular√° la cantidad de memoria requerida y crear√° un swapon. <br><br>  Como se se√±al√≥ correctamente en los comentarios, el recurso flash no solo consume el intercambio, sino tambi√©n el registro.  Por lo tanto, / tmp y / var / log se pondr√°n en ram en tmpfs.  Para hacer esto, agregue dos l√≠neas a / etc / fstab: <br><br><pre> <code class="plaintext hljs">tmpfs /tmp tmpfs nodev,nosuid,size=256M 0 0 tmpfs /var/log tmpfs nodev,nosuid,size=512M 0 0</code> </pre><br><br><h3>  Terminamos acpi </h3><br>  En primer lugar, deshabilite los controladores systemg'shnyh.  Ya que hace todo por sus propios medios, pero no funcionan.  Lema: hacemos todo, pero lo hacemos mal.  Por ejemplo, no ha aprendido c√≥mo manejar la conexi√≥n de un adaptador de corriente o auriculares, pulsaciones de teclas o similares. <br><br><div class="spoiler">  <b class="spoiler_title">¬°Comi√≥ √°cido y todav√≠a tiene hambre!</b>  <b class="spoiler_title">(4Mb)</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/3g/yu/fa/3gyufa5pfygiidcnl4zw2xxmcxi.gif"></div></div><br>  /etc/systemd/logind.conf <br><br><pre> <code class="plaintext hljs">HandlePowerKey=ignore HandleLidSwitch=ignore</code> </pre><br><pre> <code class="plaintext hljs">#systemctl restart systemd-logind.service</code> </pre> <br>  El demonio acpid es responsable de procesar los eventos acpi, cuyos archivos de configuraci√≥n se almacenan de repente en / etc / acpi. <br><br>  Enviaremos la computadora port√°til a la hibernaci√≥n presionando el bot√≥n de encendido.  Para hacer esto, edite los siguientes archivos (si no lo est√°n, debe crear): <br><br>  / etc / acpi / events / powerbtn <br><br><pre> <code class="plaintext hljs">event=button[ /]power action=/etc/acpi/hibernate.sh</code> </pre><br>  /etc/acpi/hibernate.sh (con comentarios) <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#!/bin/bash #    ,        LUKS mv /home/user/bin/lock /home/user/bin/nolock # - killall -9 pulseaudio # zram   swap systemctl stop zram-config.service swapon /dev/xubuntu-vg/swap_1 #    DISPLAY=:0.0 su user -c "xbacklight &gt;/tmp/xbl" #    umount -alt nfs4 umount -alt cifs # wpa_supplicant /sbin/wpa_cli suspend hibernate-disk sleep 2 #   DISPLAY=:0.0 su user -c "xbacklight -set `cat /tmp/xbl`" # wpa_supplicant /sbin/wpa_cli resume #  alsa,    . -     /sbin/alsa force-reload #     .  ,      DAC1,            amixer -c 1 set 'DAC1' 90% #    ,        killall i3lock #    mv /home/user/bin/nolock /home/user/bin/lock # zram systemctl start zram-config.service #    swapoff /dev/xubuntu-vg/swap_1</code> </pre></div></div><br>  La hibernaci√≥n autom√°tica a baja carga no es f√°cil de implementar, pero es muy simple: <br><br><pre> <code class="plaintext hljs">#apt install acpi</code> </pre> <br>  /etc/acpi/ifbatlowgotosleep.sh <br><br><pre> <code class="plaintext hljs">#!/bin/bash level=`/usr/bin/acpi -b|sed '/unava/d'|awk -F\ '{ print $4 }'|sed -e 's/,//' -e's/%//'` if [ "$level" -lt "10" ] then /etc/acpi/hibernate.sh fi</code> </pre><br>  El script verifica el estado de carga.  Si es inferior al 10%, ejecuta el script de hibernaci√≥n anterior. <br><br>  La ejecuci√≥n peri√≥dica se establece a trav√©s de crontab: <br><br><pre> <code class="plaintext hljs">$sudo crontab -e */3 * * * * /etc/acpi/ifbatlowgotosleep.sh 2&gt;/dev/null</code> </pre><br>  En mi caso, la bater√≠a se sondea cada 3 minutos. <br><br>  El modo de suspensi√≥n (systemctl suspend), como se mencion√≥ anteriormente, es bastante in√∫til.  Por lo tanto, no veo ninguna raz√≥n para activarlo al cerrar la tapa.  Adem√°s, puede haber un deseo, por ejemplo, de escuchar m√∫sica de una computadora port√°til cerrada en su bolsillo (no es por nada que sea "bolsillo"). <br><br>  Por lo tanto, simplemente apagamos la pantalla al cerrar y la encendemos al abrir. <br><br>  Eliminar / etc / acpi / lidbtn. <br><br>  Creamos y editamos: <br><br>  / etc / acpi / events / lidclose: <br><br><pre> <code class="plaintext hljs">event=button/lid LID close action=/etc/acpi/lidclose.sh</code> </pre><br>  / etc / acpi / events / lidopen: <br><br><pre> <code class="plaintext hljs">event=button/lid LID open action=/etc/acpi/lidopen.sh</code> </pre><br>  /etc/acpi/lidopen.sh <br><br><pre> <code class="plaintext hljs">DISPLAY=:0.0 su user -c "xrandr --output DSI1 --off"</code> </pre> <br>  /etc/acpi/lidclose.sh <br><br><pre> <code class="plaintext hljs">DISPLAY=:0.0 su user -c "xrandr --output DSI1 --auto --rotate right --dpi 200"</code> </pre> <br>  Establezca el valor de DPI a su gusto, y el usuario es el nombre sin complicaciones de mi cuenta (c√°mbielo por el suyo). <br><br><h3>  Configurar las teclas de control de sonido y brillo </h3><br>  Hacemos esto a trav√©s de los mismos eventos acpi. <br><br>  / etc / acpi / events / voldown <br><br><pre> <code class="plaintext hljs">event=button[ /]volumedown action=/etc/acpi/volume-down.sh</code> </pre><br>  / etc / acpi / events / volup <br><br><pre> <code class="plaintext hljs">event=button[ /]volumeup action=/etc/acpi/volume-up.sh</code> </pre><br>  / etc / acpi / events / mute <br><br><pre> <code class="plaintext hljs">event=button[ /]mute action=/etc/acpi/volume-toggle.sh</code> </pre><br>  Guiones <br><br>  /etc/acpi/volume-toggle.sh <br><br><pre> <code class="plaintext hljs">amixer -c 1 set 'Speaker Channel' toggle amixer -c 1 set 'Headphone Channel' toggle</code> </pre><br>  /etc/acpi/volume-up.sh <br><br><pre> <code class="plaintext hljs">amixer -c 1 set 'Headphone' 5%+ amixer -c 1 set 'Speaker' 5%+</code> </pre><br>  /etc/acpi/volume-down.sh <br><br><pre> <code class="plaintext hljs">amixer -c 1 set 'Headphone' 5%- amixer -c 1 set 'Speaker' 5%-</code> </pre><br>  Del mismo modo para el brillo: <br>  / etc / acpi / events / bdown <br><br><pre> <code class="plaintext hljs">event=button[ /]brightnessdown action=/etc/acpi/bdown.sh</code> </pre><br>  / etc / acpi / events / bup <br><br><pre> <code class="plaintext hljs">event=button[ /]brightnessup action=/etc/acpi/bup.sh</code> </pre><br>  /etc/acpi/bup.sh <br><br><pre> <code class="plaintext hljs">DISPLAY=:0.0 su user -c "xbacklight -inc 5%"</code> </pre><br>  /etc/acpi/bdown.sh <br><br><pre> <code class="plaintext hljs">DISPLAY=:0.0 su user -c "xbacklight -dec 5%"</code> </pre><br>  Perm√≠tame recordarle, usuario es el nombre de mi cuenta.  Entra el tuyo. <br><br><h3>  Auriculares </h3><br>  Mierda ^ W Un peculiar chip Realtek ALC5645 no puede apagar los altavoces de forma independiente cuando los auriculares est√°n conectados.  Tienes que ense√±arle al sistema c√≥mo hacerlo t√∫ mismo. <br><br>  Hay un gui√≥n en respin: <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#!/bin/bash set -e -u if [ "$1" = "jack/headphone" -a "$2" = "HEADPHONE" ]; then case "$3" in plug) sink="[Out] Headphones" ;; *) sink="[Out] Speaker" ;; esac for userdir in /run/user/*; do uid="$(basename $userdir)" user="$(id -un $uid)" if [ -f "$userdir/pulse/pid" ]; then su "$user" -c "pacmd set-sink-port alsa_output.platform-cht-bsw-rt5645.HiFi__hw_chtrt5645__sink $sink" fi done fi</code> </pre></div></div><br>  Pero no funciona.  Intenta hacer un cambio a trav√©s del control de sincronizaci√≥n del audio, pero falla.  Porque: <br><br><pre> <code class="plaintext hljs">$sudo su #su user -c "pacmd set-sink-port alsa_output.platform-cht-bsw-rt5645.HiFi__hw_chtrt5645__sink '[Out] Speaker'"    PulseAudio,        .</code> </pre><br>  La soluci√≥n es simple: cuando el proceso de audio a√∫n no ha sido llamado por el cliente, no hay nada con lo que contactar a pacmd.  Por supuesto, puede agregar la l√≠nea de lanzamiento de esta a rc.local, xinitrc o incluso escribir una unidad de sistema separada, pero pens√© que era mejor planificar mi propia muleta que reparar otras.  Y escrib√≠ mi propio gui√≥n, creo que mucho menos monstruoso y sofisticado. <br><br>  /etc/acpi/headphone-jack.sh <br><br><pre> <code class="plaintext hljs">#!/bin/bash set -e -u if [ "$3" = "plug" ]; then amixer -c 1 set 'Speaker Channel' mute &gt;/dev/null amixer -c 1 set 'Headphone Channel' unmute &gt;/dev/null else amixer -c 1 set 'Speaker Channel' unmute &gt;/dev/null amixer -c 1 set 'Headphone Channel' mute &gt;/dev/null fi</code> </pre><br><h3>  Tratamos el dise√±o y otras peque√±as cosas. </h3><br>  Como ya se mencion√≥, el dise√±o me enfurece.  El bot√≥n Eliminar es donde deber√≠an estar la barra invertida y la barra, los dos puntos en la fila inferior, no est√° claro por qu√© el men√∫ de teclas, la pesta√±a es donde est√° el escape en los teclados normales ... <br><br>  No pintar√© en detalle, con an√°lisis, solo traer√© mi ~ / .xmodmaprc y describir√© c√≥mo se hace. <br><br>  Para comenzar, necesitamos atrapar el c√≥digo clave.  Esto se hace usando el programa xev (#apt install xev, yes).  Ejecute, presione la tecla deseada y obtenga una salida como: <br><br><pre> <code class="plaintext hljs">KeyPress event, serial 33, synthetic NO, window 0x3200001, root 0x2c0, subw 0x0, time 187713326, (979,493), root:(982,1078), state 0x0, keycode 119 (keysym 0xffff, Delete), same_screen YES, XLookupString gives 1 bytes: (7f) "" XmbLookupString gives 1 bytes: (7f) "" XFilterEvent returns: False</code> </pre><br>  Necesitamos el valor "keycode 119". <br><br>  A continuaci√≥n, abra ~ / .xmodmaprc y escriba all√≠ <br><br><pre> <code class="plaintext hljs">keycode 119 = backslash bar backslash bar</code> </pre> <br>  Y presentamos la ejecuci√≥n de "xmodmap ~ / .xmodmaprc" en su xinitrc o como se llame cuando inicia su DE o WM favorito. <br><br>  Mi ~ / .xmodmaprc: <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">pointer = 1 2 3 4 5 remove Lock = Caps_Lock remove Control = Control_L keycode 0x42 = Control_L keycode 135 = Alt_R keycode 0x25 = Super_R keycode 133 = Super_R add Control = Control_L keycode 113 = Left keycode 111 = Up keycode 114 = Right keycode 116 = Down keycode 110 = Home keycode 115 = End keycode 108 = ISO_Next_Group keycode 136 = ISO_First_Group keycode 49 = asciitilde grave asciitilde grave keycode 119 = backslash bar backslash bar keycode 51 = Delete keycode 48 = colon semicolon Cyrillic_zhe Cyrillic_ZHE keycode 47 = apostrophe quotedbl Cyrillic_e Cyrillic_E keycode 130 = XF86Explorer keycode 121 = XF86AudioMute keycode 198 = XF86AudioMicMute keycode 122 = XF86AudioLowerVolume keycode 123 = XF86AudioRaiseVolume keycode 37 = Tab clear mod5 add mod5 = XF86Explorer keycode 166 = Prior keycode 167 = Next</code> </pre></div></div><br>  Utiliza cosas tan dudosas para la mayor√≠a de los usuarios como transferir ctrl a may√∫sculas, tabular a ctrl_l, alt_gr al men√∫ y cambiar el dise√±o a la antigua posici√≥n altgr. <br><br>  Tambi√©n uso xcape para emular presionar escape con un solo clic en ctrl_l.  Llamado as√≠: <br><br><pre> <code class="plaintext hljs"> xcape -t 1000 -e "Control_L=Escape"</code> </pre> <br>  Como prefiero los temas oscuros que son m√°s c√≥modos (tengo una opini√≥n, argumentar√≠a el r√°bano picante) en condiciones de poca luz, pero a menudo tienen que trabajar a plena luz del d√≠a, hay un peque√±o truco: los colores de la imagen pueden invertirse.  Para hacer esto, necesita el programa xcalib: <br><br><pre> <code class="plaintext hljs">#apt install xcalib</code> </pre> <br>  Invertir: <br><br><pre> <code class="plaintext hljs">$xcalib -i -a</code> </pre> <br>  Puede vincularse a cualquier tecla de acceso r√°pido conveniente utilizando el administrador de ventanas.  Estoy colgando en Super_L + Retroceso. <br><br><h2>  Resumen </h2><br>  Las impresiones del dispositivo son m√°s positivas que negativas.  No me arrepiento del dinero gastado.  El dispositivo no ocupa mucho espacio en la bolsa, cabe en el bolsillo de los pantalones cargo y una chaqueta de humo. <br><br> <a href=""><img src="https://habrastorage.org/webt/xz/u5/a2/xzu5a2lnxboqgbrkw8chzh3zlzu.jpeg"></a> <br><br>  Funciona durante mucho tiempo con la bater√≠a, para la prueba me desplac√© pel√≠culas de tres horas y media con wifi encendido, descargado en alg√∫n lugar a la mitad.  Se carga desde una pavimentadora con usb-a a trav√©s de un adaptador de CA. <br><br>  Todos los curvulins suaves encontrados fueron tratados con √©xito. <br><br>  Es desafortunado que no haya un puerto rj45, pero espero que sea resuelto por el adaptador ordenado con usb.  La falta de comunicaciones m√≥viles y c√°maras, ahora, en condiciones de vigilancia total, creo que es una ventaja. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es409945/">https://habr.com/ru/post/es409945/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es409933/index.html">Revisi√≥n de SoC Android HiSilicon Kirin 970 - Rendimiento y eficiencia</a></li>
<li><a href="../es409935/index.html">La historia "La vida es alta"</a></li>
<li><a href="../es409937/index.html">Triunfo y vida cotidiana. C√≥mo instalar una aguja en un rascacielos Lakhta Center. Parte 1</a></li>
<li><a href="../es409939/index.html">C√≥mo Bezos resolvi√≥ un problema inesperado al anunciar su columna inteligente</a></li>
<li><a href="../es409943/index.html">¬øPor qu√© es importante que las escuelas dediquen m√°s tiempo al estudio de las matem√°ticas discretas?</a></li>
<li><a href="../es409947/index.html">Universo superfluido: materia oscura como condensado de Bose-Einstein</a></li>
<li><a href="../es409949/index.html">Big Bang caliente e inflaci√≥n</a></li>
<li><a href="../es409951/index.html">Panel LED con WIFI Sonoff BN-SZ01</a></li>
<li><a href="../es409953/index.html">Ataque card√≠aco y sepsis en 10 minutos.</a></li>
<li><a href="../es409955/index.html">Tesla une a 50,000 hogares pobres en el sur de Australia con una central el√©ctrica virtual de 250MW</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>