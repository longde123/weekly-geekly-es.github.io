<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💜 👨🏼‍🔧 😮 在XHProf Admin中比较分析会话 🐁 👩🏻‍🚀 ♍️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="本文讨论了一种比较工具，用于比较用于分析PHP代码的会话，该工具使在Bitrix CMS上的项目中快速发现瓶颈成为可能。 
 从远处 


 7月，Bitrix当时已更新为最新版本。页面加载速度下降了：某处增加了20％，某处增加了300 +％。 特别是在客户订购阶段。 


 数字令人印象深刻，令人...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>在XHProf Admin中比较分析会话</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/478858/"><p> 本文讨论了一种比较工具，用于比较用于分析PHP代码的会话，该工具使在Bitrix CMS上的项目中快速发现瓶颈成为可能。 </p><a name="habracut"></a><br><h2 id="iz-daleka"> 从远处 </h2><br><p>  7月，Bitrix当时已更新为最新版本。页面加载速度下降了：某处增加了20％，某处增加了300 +％。 特别是在客户订购阶段。 </p><br><p> 数字令人印象深刻，令人难过。 为什么要更新？ </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b06/a95/419/b06a95419ddf005efa67abf943d51c28.png" alt="N |固体"></p><br><p> 即 如果不进行更新，则可能会立即解决两个问题：实际更新Bitrix并将代码库更新为PHP&gt; 7.1。 </p><br><h2 id="prichina-tormozov"> 刹车的原因 </h2><br><p> 事实证明，最大的原因是使用交付配置文件的新代码逻辑。 根据代码，他们可以更正确地做到这一点，或者做些什么：货件显示为单独的实体。 现在，可以分几批发送订单（在成本，交付方式和商品组成方面具有其自身的特征）。 </p><br><p> 但是，现在交货概要文件是数据库中的一个单独条目，受Bitrix内核的限制，每次您需要检查下订单时显示此概要文件的可能性时，都会弹出该概要文件。 </p><br><p> 总的来说，本文将不会重点讨论为应对刹车所做的确切重做，而是针对一种工具，该工具可以快速找到代码中的瓶颈并进行修复。 </p><br><h2 id="xhprof-admin">  XHProf管理员 </h2><br><p> 我们可以使用来自Facebook的流行探查器-XHProf。 禁止使用该工具的缺点涉及其GUI： </p><br><ul><li> 分析会话之间缺乏清晰的导航 </li><li> 无法在同一名称空间之外同时比较两个以上的会话。 </li><li> 您无法在会话列表中对其发表评论。 在第十届会议之后，您已经忘记了以前的概要分析结果所涉及的更改。 </li></ul><br><p> 结果，查看了本机XHProf GUI的SOURCES，并有些惊恐地为他编写了一个新的GUI，涵盖了列出的缺点。 </p><br><h2 id="ustanovka"> 安装方式 </h2><br><p>  → <a href="https://github.com/SergeyRock/xhprof-admin" rel="nofollow">链接到项目</a> </p><br><p> 我不会描述如何安装XHProf和配置文件，至少在Habré上有一些不错的教程。 </p><br><p> 要安装XHProf Admin，请将xhprof_admin文件夹放入本机XHProf的xhprof_html文件夹中。 或克隆整个项目（它已经包含XHProf和新的GUI）。 </p><br><p> 然后打开页面&lt;xhprof的路径&gt; / xhprof_html / xhprof_admin / <br> 如果已启用映射（如文档中所建议），则需要打开&lt;xhprof的路径&gt; / xhprof_admin / </p><br><h2 id="glavnaya--stranica"> 主页 </h2><br><p><img src="https://habrastorage.org/getpro/habr/post_images/2ad/de6/6e6/2adde66e6ba9b0ca7b8b2f3e74038c3c.png" alt="ñ"></p><br><p> 包含： </p><br><ul><li> 列出所有按日期排序的性能分析会话 </li><li> 会话评论字段 </li><li> 寒鸦，您可以选择要删除，比较，汇总的会话 </li><li> 链接到新报告 </li><li> 链接到本机报告和通话图 </li><li> 区分和汇总的会话权重字段 </li><li> 一个字段，指定在比较模式和差异模式下显示会话的顺序 </li><li> 按键： <br><ul><li> 比较-比较选定的会话（新报告） </li><li>  Diff-用于比较一个名称空间中的会话的标准报告 </li><li> 聚合-在一个名称空间中具有会话聚合的标准报告 </li><li> 保存自定义评论-将会话的评论保存（在单独的文件中） </li><li> 删除选定的运行-删除会话文件和注释文件 </li><li> 链接到本机会话列表页面 </li></ul></li></ul><br><p> 查看原始报告，Diff运行，聚合运行，查看调用图-XHProf GUI的本机功能-我将不对其进行描述。 我只能说XHProf Admin允许您方便地导航到它们，而不是手动编译链接。 </p><br><h2 id="compare-runs"> 比较运行 </h2><br><p><img src="https://habrastorage.org/getpro/habr/post_images/70e/4d2/1ca/70e4d21caaf3a804af695716c673a179.png" alt="N |固体"></p><br><p> 一个新的报告，使您可以快速评估生产率的增长或下降。 <br> 要使用它，请在主页上： </p><br><ul><li> 选择我们要比较的会话。 </li><li> 我们将排序字段设置为“排序”，以确定会话的显示顺序：该字段的值越小，会话显示越早。 第一个会话将作为基础会话-所有后续会话都将与之进行比较。 </li><li> 如果我们要显示指标的平均值，则标记为“显示平均值”。 </li><li> 点击“比较”。 <br><img src="https://habrastorage.org/getpro/habr/post_images/28d/452/9f2/28d4529f2011bd7df9a57b2ac1f90641.png" alt="N |固体"></li></ul><br><p> 该报告未显示每个指标“占用”该功能的百分比，以免使页面混乱，但显示绝对值。 如果在基础会话与后续会话之间，所配置函数的度量标准之间的差异超过1％，则将清楚显示：绿色表示改进，红色表示回归。 </p><br><p> 默认情况下： </p><br><ul><li> 该报告显示前100个功能。 如果您需要更多，请单击“全部显示”。 </li><li> 数据按“包含”排序。  Wall Time（微秒）”，但您可以单击任意指标并按其排序。 </li></ul><br><p> 要从报告中排除会话，请单击“排除”。 </p><br><p> 可以按每个指标进行排序-只需单击列标题即可。 </p><br><p> 要显示所有选定会话的平均值，请单击“显示平均值”。 </p><br><p> 要深入了解某个功能，可以单击该功能与指标与显示的会话相交处的单元格。 </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/1cf/114/e12/1cf114e12049d9514d052240e6e0dc27.png" alt="N |固体"></p><br><h1 id="primer-ispolzovaniya"> 使用范例 </h1><br><ol><li> 我们在源代码上启动了探查器。 我们打开了会话列表，并添加了评论。 </li><li> 我们在改进的代码上启动了探查器。 还添加了评论。 </li><li> 对项目2进行了几次。 </li><li> 然后，我们打开分析会话列表，依次选择所有会话，然后单击“比较”。 </li><li> 我们查看了这些变化。 </li><li> 他们决定进一步加快速度。 </li></ol><br><p>  <a href="https://github.com/SergeyRock/xhprof-admin" rel="nofollow">XHProf Admin</a>方便地用于标识单个用户执行的常用繁重功能。 例如，在Bitrix中，每次从一个阶段转移到另一个阶段（交货，付款，联系方式等）下订单时，都会调用许多功能来控制购物篮的完整性等。这些阶段分别进行概要分析，然后一起显示在报告中比较一下。 这些功能的结果可以被缓存，从而大大加快了各个阶段之间的过渡时间。 </p><br><h1 id="itog"> 总结 </h1><br><p> 结果，我们在更新Bitrix时下订单的阶段就消除了速度下降，同时分析了站点的其他部分并加快了速度。 <br> 我们有时会在项目上使用XHProf Admin作为更直观的GUI。 <br> 指向XHProf管理员的文档链接： </p><br><p> 谁对代码优化主题和对此感兴趣的工具感兴趣，请在注释中编写。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN478858/">https://habr.com/ru/post/zh-CN478858/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN478844/index.html">对IT的恐惧与厌恶</a></li>
<li><a href="../zh-CN478846/index.html">系统化的交互式脚本和计时器</a></li>
<li><a href="../zh-CN478848/index.html">数码摄影的演变</a></li>
<li><a href="../zh-CN478854/index.html">Web服务器之战。 第1部分-HTTP与现实脱节：</a></li>
<li><a href="../zh-CN478856/index.html">SD-WAN-2020年的最新趋势和预测</a></li>
<li><a href="../zh-CN478862/index.html">Yandex.Market中如何安排前端测试，以及为什么我们拒绝每周发布</a></li>
<li><a href="../zh-CN478866/index.html">满足空间-JetBrains的新产品</a></li>
<li><a href="../zh-CN478874/index.html">东芝宣布了两条新的容量高达6 TB的HDD系列产品，并宣布自2020年以来专注于企业领域</a></li>
<li><a href="../zh-CN478878/index.html">StackOverflow历史上最受欢迎的代码有一个错误！</a></li>
<li><a href="../zh-CN478880/index.html">雇主在2019年下半年向IT专家提供了哪些薪水</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>