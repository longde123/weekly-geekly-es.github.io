<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎆 💃🏿 🔔 Pemetaan kebisingan dengan KSQL, Raspberry Pi dan radio 👩‍💻 🍢 👼🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sekilas, cerita ini memiliki segalanya untuk mendapatkan status pos romantis pada malam 8 Maret: pesawat terbang, cinta, mata-mata kecil dan, akhirnya...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pemetaan kebisingan dengan KSQL, Raspberry Pi dan radio</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/itsumma/blog/442876/"><img src="https://habrastorage.org/webt/8h/e_/jp/8he_jpuc-mgf_sarxdvkm3n6xsg.png"><br><br>  Sekilas, cerita ini memiliki segalanya untuk mendapatkan status pos romantis pada malam 8 Maret: pesawat terbang, cinta, mata-mata kecil dan, akhirnya, kucing (lebih tepatnya, kucing).  Sulit membayangkan bahwa semua ini berhubungan langsung dengan Kafka, KSQL dan percobaan "bagaimana menemukan pesawat paling berisik menggunakan teknologi informasi rumah".  Itu sulit, tapi itu perlu: itu adalah eksperimen yang dilakukan Simon Obury, dan kami menerjemahkan artikel kepenulisannya yang menjelaskan semua detail proses. <br><a name="habracut"></a><br>  Kucing baru kami yang bernama Snowflake bangun lebih awal.  Suara pesawat terbang di atas rumah kami membangunkannya.  Tetapi bagaimana jika, menggunakan Apache Kafka, KSQL dan Raspberry Pi, saya dapat menentukan pesawat mana yang membuat kucing saya tetap terjaga?  Akan menyenangkan untuk membuat panel pelacakan yang menghibur, tempat kucing dapat mengalihkan perhatiannya - dan memberi saya lebih banyak tidur. <br><br><h3>  Secara umum </h3> <br><img src="https://habrastorage.org/webt/f8/df/kg/f8dfkgmmkghrnfhtjecrthwx8j8.png"><br>  <i>Kami mentransfer pesawat dari langit ke grafik menggunakan Kafka dan KSQL</i> <br><br>  Pesawat menentukan lokasi mereka menggunakan penerima GPS.  Pemancar on-board secara berkala melaporkan lokasi, nomor identifikasi, ketinggian dan kecepatan kapal menggunakan transmisi radio pendek.  Siaran-siaran ini dari pengawasan bergantung otomatis siaran ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">AZN-V</a> ) pada dasarnya adalah paket data yang terbuka untuk diakses dari stasiun-stasiun darat. <br><br>  Satu mikrokomputer, seperti Raspberry Pi, dan beberapa komponen tambahan yang diperlukan untuk menerima pesan dari pemancar on-board pesawat yang berlarian di rumah saya. <br><br>  Sinyal udara dari pesawat terlihat seperti bola pesan yang kusut dan membutuhkan sistematisasi.  Mengenali aliran data yang kacau ini seperti mendengarkan percakapan di pesta yang bising.  Karena itu, untuk menemukan pesawat yang mengkhawatirkan kucing saya, saya memutuskan untuk menggunakan kombinasi Kafka dan KSQL. <br><br><img src="https://habrastorage.org/webt/om/2c/o0/om2co03tws9dxaml4hsmwrgqzsg.png"><br>  <i>Kucing yang Terbangun dan Raspberry Pi</i> <br><br><h3>  Koleksi bacaan AZN-B dengan Raspberry Pi </h3><br>  Untuk mengumpulkan transmisi on-board, saya menggunakan Raspberry Pi dan RTL2832U, modem USB yang awalnya dijual sebagai perangkat untuk menonton TV digital di komputer.  Pada Raspberry Pi saya menginstal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dump1090</a> - program yang menerima data dari AZN-V hingga RTL2832U menggunakan antena kecil. <br><br><img src="https://habrastorage.org/webt/_u/dx/rd/_udxrdhg_e8cvqomnkbfkiuvvgm.png"><br>  <i>Radio perangkat lunak saya dari Raspberry Pi dan RTL2832U</i> <br><br><h3>  Ubah sinyal AZN-B ke tema Kafka </h3><br>  Sekarang saya telah menerima aliran sinyal AZN-B mentah, kita harus memperhatikan lalu lintas.  Raspberry Pi tidak memiliki daya yang cukup untuk komputasi serius, jadi saya harus mentransfer pemrosesan data ke cluster lokal saya di Kafka. <br><br><img src="https://habrastorage.org/webt/ar/27/xb/ar27xbolmidgiscrmspvto0vgnk.png"><br><br>  Pesan yang diterima dibagi menjadi <i>pesan</i> <i>lokasi</i> atau <i>pesan tentang identifikasi board</i> .  Lokasinya terlihat seperti pesan dalam bentuk: <i>"papan 7c6db8 terbang di ketinggian 6.250 kaki di koordinat -33.8.151.0</i> . <i>"</i>  Informasi tentang identifikasi papan akan terlihat seperti: <i>"papan 7c451c terbang di sepanjang rute QJE1726</i> . <i>"</i> <br><br>  Sebuah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">skrip Python</a> kecil untuk Raspberry Pi saya membagikan semua pesan AZN-B yang masuk.  Saya menggunakan proksi Confluent Rest Proxy untuk mendistribusikan data dari Raspberry Pi ke <b>lokasi-topik</b> dan tema <b>ident-topik</b> di Kafka.  Server proxy menyediakan antarmuka RESTful untuk cluster Kafka, yang membuatnya mudah untuk membuat pesan menggunakan panggilan REST sederhana di Pi. <br><br><img src="https://habrastorage.org/webt/6d/ox/35/6dox35w1d-qrzyaiowi80kxtglk.png"><br><br>  Saya ingin memahami pesawat mana yang terbang di atas atap saya dan rute mana.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Basis</a> data <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">OpenFlight</a> memungkinkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Anda</a> untuk membandingkan kode bandara, misalnya 7C6DB8 yang ditugaskan oleh Organisasi Penerbangan Sipil Internasional (ICAO), dengan jenis pesawat - dalam kasus kami, Boeing 737.  Saya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mengunggah data</a> pemetaan saya ke tema <b>icao-to-aircraft</b> . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">KSQL</a> menyediakan "mesin SQL" yang memungkinkan Anda untuk memproses data secara real time pada topik Apache Kafka.  Misalnya, untuk menemukan kode on-board 7C6DB8, kita dapat menulis kueri berikut: <br><br><pre><code class="plaintext hljs">CREATE TABLE icao_to_aircraft WITH (KAFKA_TOPIC='ICAO_TO_AIRCRAFT_REKEY', VALUE_FORMAT='AVRO', KEY='ICAO'); ksql&gt; SELECT manufacturer, aircraft, registration \ FROM icao_to_aircraft \ WHERE icao = '7C6DB8'; Boeing | B738 | VH-VYI</code> </pre> <br>  Demikian pula, dalam topik <b>rincian</b> tanda <b>panggilan</b> , saya mengunggah tanda panggilan (yaitu QFA563, ini adalah penerbangan Qantas dari Brisbane ke Sydney). <br><br><pre> <code class="plaintext hljs">CREATE TABLE callsign_details WITH (KAFKA_TOPIC='CALLSIGN_DETAILS_REKEY', VALUE_FORMAT='AVRO', KEY='CALLSIGN'); ksql&gt; SELECT operatorname, fromairport, toairport \ FROM callsign_details \ WHERE callsign = 'QFA563'; Qantas | Brisbane | Sydney</code> </pre> <br>  Sekarang mari kita lihat aliran data <b>topik-lokasi</b> .  Di sini kita dapat mengamati aliran konstan pesan yang masuk tentang lokasi pesawat terbang. <br><br><pre> <code class="plaintext hljs">kafka-avro-console-consumer --bootstrap-server localhost:9092 --property --topic location-topic {"ico":"7C6DB8","height":"6250","location":"-33.807724,151.091495"}</code> </pre> <br>  Kueri KSQL akan terlihat seperti ini: <br><pre> <code class="plaintext hljs">ksql&gt; SELECT TIMESTAMPTOSTRING(rowtime, 'yyyy-MM-dd HH:mm:ss'), \ ico, height, location \ FROM location_stream \ WHERE ico = '7C6DB8'; 2018-09-19 07:13:33 | 7C6DB8 | 6250.0 | -33.807724,151.091495</code> </pre> <br><h3>  KSQL: streaming harmonisasi ... </h3><br>  Nilai sebenarnya KSQL terletak pada kemampuan untuk menggabungkan aliran data lokasi yang masuk dengan data sumber topik (lihat <a href="">03_ksql.sql</a> ) <a href="">—yaitu</a> , menambahkan informasi yang berguna ke aliran data mentah.  Ini sangat mirip dengan "join kiri" dalam database tradisional.  Hasilnya adalah tema Kafka lain yang dibuat tanpa satu baris kode Java! <br><br>  source&gt; CREATE STREAM location_and_details_stream AS \ <br>  PILIH l.ico, l.tinggi, l.lokasi, t.aircraft \ <br>  DARI location_stream l \ <br>  KIRI BERGABUNG icao_to_aircraft t ON l.ico = t.icao; <br>  Selain itu, Anda menerima permintaan KSQL.  Aliran data akan terlihat seperti ini: <br><br><pre> <code class="plaintext hljs">ksql&gt; SELECT TIMESTAMPTOSTRING(rowtime, 'yy-MM-dd HH:mm:ss') \ , manufacturer \ , aircraft \ , registration \ , height \ , location \ FROM location_and_details_stream; 18-09-27 09:53:28 | Boeing | B738 | VH-YIA | 7225 | -33.821,151.052 18-09-27 09:53:31 | Boeing | B738 | VH-YIA | 7375 | -33.819,151.049 18-09-27 09:53:32 | Boeing | B738 | VH-YIA | 7425 | -33.818,151.048</code> </pre> <br>  Selain itu, kita dapat menggabungkan aliran input <b>callsign</b> dengan tema <b>callsignigndetail</b> tetap: <br><br><pre> <code class="plaintext hljs">CREATE STREAM ident_callsign_stream AS \ SELECT i.ico \ , c.operatorname \ , c.callsign \ , c.fromairport \ , c.toairport \ FROM ident_stream i \ LEFT JOIN callsign_details c ON i.indentification = c.callsign; ksql&gt; SELECT TIMESTAMPTOSTRING(rowtime, 'yy-MM-dd HH:mm:ss') \ , operatorname \ , callsign \ , fromairport \ , toairport \ FROM ident_callsign_stream ; 18-09-27 13:33:19 | Qantas | QFA926 | Sydney | Cairns 18-09-27 13:44:11 | China Eastern | CES777 | Kunming | Sydney 18-09-27 14:00:54 | Air New Zealand | ANZ110 | Sydney | Auckland</code> </pre> <br>  Sekarang kami memiliki dua topik informatif: <br><br><ol><li>  <b>location_and_details_stream</b> , yang menyediakan aliran informasi terbaru tentang lokasi dan kecepatan pesawat; </li><li>  <b>ident_callsign_stream</b> , yang menjelaskan detail penerbangan, termasuk maskapai dan tujuan. </li></ol><br>  Dengan tema yang terus diperbarui ini, kami dapat membuat beberapa panel ikhtisar yang luar biasa.  Saya menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kafka Connect</a> untuk mengunggah tema Kafka yang diisi oleh KSQL ke Elasticsearch (skrip lengkap di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> ). <br><br><h3>  Kibana Dashboard </h3><br>  Berikut ini adalah contoh dari panel ikhtisar yang menunjukkan lokasi pesawat terbang di peta.  Selain itu, Anda dapat melihat bagan menurut maskapai, grafik ketinggian penerbangan, dan kata cloud berdasarkan tujuan utama.  Peta panas menunjukkan area di mana pesawat terkonsentrasi, yaitu, area dengan tingkat kebisingan tertinggi. <br><br><img src="https://habrastorage.org/webt/mh/fz/sy/mhfzsyskws6uoe5s1-b6m9sudzc.gif"><br><br><h3>  Kembali ke kucing </h3><br>  Hari ini kucing membangunkan saya sekitar pukul 6 pagi.  Bisakah KSQL membantu saya menemukan pesawat yang saat ini terbang di atas rumah saya di ketinggian kurang dari 3.500 kaki? <br><br><pre> <code class="plaintext hljs">select timestamptostring(rowtime, 'yyyy-MM-dd HH:mm:ss') , manufacturer , aircraft , registration , height from location_and_details_stream where height &lt; 3500 and rowtime &gt; stringtotimestamp('18-09-27 06:10', 'yy-MM-dd HH:mm') and rowtime &lt; stringtotimestamp('18-09-27 06:20', 'yy-MM-dd HH:mm'); 2018-09-27 06:15:39 | Airbus | A388 | A6-EOD | 2100.0 2018-09-27 06:15:58 | Airbus | A388 | A6-EOD | 3050.0</code> </pre> <br>  Luar biasa!  Saya bisa melihat sebuah pesawat di atas atap saya pada pukul 6:15 pagi.  Ternyata Snowflake dibangunkan oleh Airbus A380 (kapal besar, omong-omong), yang terbang ke Dubai. <br><br>  Hanya beberapa hari libur, dan Anda memiliki sistem pemrosesan streaming dengan KSQL.  Selain itu, yang memungkinkan Anda menemukan peristiwa data menarik dengan cepat.  Meskipun Snowflake mungkin skeptis tentang mereka. <br><br><img src="https://habrastorage.org/webt/vs/vf/yp/vsvfypatv-grib-_dstwrco_r2y.png"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id442876/">https://habr.com/ru/post/id442876/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id442864/index.html">Berapa umur tuanmu?</a></li>
<li><a href="../id442866/index.html">AI yang terlatih dari beberapa dekade percobaan kuliner menciptakan hidangan baru</a></li>
<li><a href="../id442868/index.html">Tamasya singkat ke sistem pendingin pusat data. Pro dan kontra</a></li>
<li><a href="../id442870/index.html">Yang terbaik di dunia Angular untuk minggu ini - Intisari No. 2 (26 Januari - 7 Maret)</a></li>
<li><a href="../id442872/index.html">Bagaimana saya menemukan telur paskah di perlindungan Android dan tidak mendapatkan pekerjaan di Google</a></li>
<li><a href="../id442880/index.html">Poin Pemeriksaan Virtual: daftar periksa pengaturan</a></li>
<li><a href="../id442882/index.html">[Video] "Piems tidak diperlukan" dan tiga ide manajemen proyek lainnya</a></li>
<li><a href="../id442884/index.html">Teknologi sudah memungkinkan Anda untuk berbicara dengan mobil sebagai pribadi</a></li>
<li><a href="../id442886/index.html">Sketch + Node.js: menghasilkan ikon untuk banyak platform dan merek. Bagian 2</a></li>
<li><a href="../id442888/index.html">Kustomisasi pilih pada css murni</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>