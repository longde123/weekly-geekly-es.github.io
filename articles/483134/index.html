<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÜí ü•ù üìä Prueba de autenticaci√≥n de dos factores y posibles soluciones üñåÔ∏è ü§±üèº üè¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Incluso antes de comenzar a comprender la compleja ciencia de la seguridad de la informaci√≥n, me pareci√≥ que la autenticaci√≥n 2FA es una forma garanti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Prueba de autenticaci√≥n de dos factores y posibles soluciones</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483134/"><img src="https://habrastorage.org/webt/g8/rq/pf/g8rqpf1rdulkehqbd2aromukw5q.png"><br><br>  Incluso antes de comenzar a comprender la compleja ciencia de la seguridad de la informaci√≥n, me pareci√≥ que la autenticaci√≥n 2FA es una forma garantizada de proteger su cuenta y que "estos sus hackers" no pueden, por ejemplo, retirar mi moneda interna para comprar ropa para los personajes de una cuenta de juego.  Pero con el tiempo, se ha demostrado experimentalmente que un sistema de autenticaci√≥n de dos factores puede tener una gran cantidad de vulnerabilidades. <br><a name="habracut"></a><br>  En palabras simples, la autenticaci√≥n de dos factores es una confirmaci√≥n de la acci√≥n al ingresar el c√≥digo generado para aumentar la seguridad y lanzar palos en las ruedas de los hackers condicionales durante el movimiento o antes de que comience. <br><br>  El sistema de confirmaci√≥n de c√≥digo est√° muy extendido, se usa en todas partes en varios sitios y se puede conectar para inicios de sesi√≥n primarios y secundarios.  Pero la aplicaci√≥n no se limita a esto: los desarrolladores adjuntan una confirmaci√≥n sobre la funcionalidad de recuperaci√≥n de contrase√±a, confirmaci√≥n de registro / suscripci√≥n, confirmaci√≥n adicional de transacciones financieras, cambio de contrase√±a, cambio de datos personales.  Adem√°s, de vez en cuando, 2FA se usa como un muro despu√©s del cierre de sesi√≥n para el tiempo, y no una contrase√±a u otra forma de confirmaci√≥n. <br><br>  En este art√≠culo, he recopilado formas de probar 2FA en busca de vulnerabilidades, su explotaci√≥n, as√≠ como las posibles opciones para eludir la protecci√≥n existente contra ciertos tipos de ataques.  Veamos la lista de comprobaciones de vulnerabilidad que se aplican a 2FA: <br><br><h2>  1. Falta de l√≠mite de velocidad </h2><br>  El algoritmo de l√≠mite de velocidad se usa para probar si una sesi√≥n de usuario (o direcci√≥n IP) puede limitarse en intentos o velocidad, y bajo qu√© circunstancias esto sucede.  Si el usuario ha completado demasiadas solicitudes dentro de un cierto per√≠odo de tiempo, la aplicaci√≥n web puede responder con un c√≥digo 429 (muchas solicitudes) o aplicar un l√≠mite de velocidad sin mostrar errores.  La ausencia de un l√≠mite de velocidad implica que durante la enumeraci√≥n normal no hay restricciones en el n√∫mero de intentos y / o velocidad: se permite iterar sobre los c√≥digos cualquier cantidad de veces (a cualquier velocidad) dentro del per√≠odo de validez de la sesi√≥n / token. <br><br>  Muy a menudo tiene que lidiar con un l√≠mite de velocidad "silencioso", si ve que no hay errores y el cuerpo / c√≥digo HTTP no cambia en las solicitudes posteriores, debe estar contento demasiado pronto, y primero debe verificar el resultado final del ataque utilizando un c√≥digo v√°lido. <br><br><h2>  2. Existe un l√≠mite de velocidad, pero se puede eludir </h2><br>  Casos que tuve que conocer antes: <br><br><h4>  1) Limitar la velocidad de los flujos sin bloqueo despu√©s de alcanzar cierta velocidad </h4><br>  A menudo, los investigadores de seguridad intentan recoger el c√≥digo usando 5 o m√°s hilos para hacer un ataque m√°s r√°pido (en Burp Intruder, el n√∫mero predeterminado de hilos es 5 sin demora).  Pero a veces, un sistema de seguridad que se rompe o un equilibrador de carga normal solo puede responder a este factor √∫nico.  Si est√° tratando de forzar la fuerza bruta con 5 hilos, debe reducir el n√∫mero a 1 y luego a 1 con un retraso de un segundo.  Anteriormente, tuve la suerte de observar ese comportamiento y fue con la ayuda de tales manipulaciones que se produjo la selecci√≥n exitosa del c√≥digo, lo que condujo a la Toma de Cuenta.  Si el c√≥digo 2FA no tiene una fecha de vencimiento espec√≠fica, entonces tenemos mucho tiempo para clasificar.  Si el per√≠odo de validez est√° presente, el √©xito del ataque se reduce, pero el peligro potencial de vulnerabilidad a√∫n est√° presente, ya que a√∫n existe la posibilidad de ingresar al c√≥digo deseado. <br><br><h4>  2) El c√≥digo OTP generado no cambia </h4><br>  Esto no se aplica a los c√≥digos que cambian constantemente, como en Google Authenticator, sino solo a los c√≥digos est√°ticos que vienen en SMS, correo electr√≥nico o en persona a trav√©s de messenger. <br><br>  La esencia de esta omisi√≥n es que el mismo c√≥digo OTP se env√≠a constantemente o durante alg√∫n tiempo, por ejemplo, 5 minutos, lo cual es v√°lido durante todo este tiempo.  Tambi√©n vale la pena asegurarse de que no se produzca un l√≠mite de velocidad silencioso. <br><br>  Ejemplo de informe: <a href="https://hackerone.com/reports/420163">hackerone.com/reports/420163</a> <br><br>  Supongamos que la aplicaci√≥n genera un c√≥digo aleatorio del 001 al 999 y lo env√≠a al tel√©fono, en 10 minutos cuando la funci√≥n "enviar de nuevo" est√° habilitada, obtenemos el mismo c√≥digo.  Pero el l√≠mite de velocidad est√° vinculado a la solicitud, que limita el n√∫mero de intentos por token de solicitud.  Podemos solicitar constantemente un nuevo c√≥digo, generar un nuevo token de solicitud, aplicarlo a una solicitud posterior (usando grep-match en un conjunto de eructos o usando nuestro propio script) y realizar la fuerza bruta de un rango de n√∫meros del 001 al 999. Por lo tanto, usar constantemente un nuevo token de solicitud seleccionaremos con √©xito el c√≥digo correcto, ya que no cambia y es est√°tico durante un cierto per√≠odo de tiempo.  Las limitaciones de este ataque son un n√∫mero largo o mezclar letras con n√∫meros como c√≥digo de confirmaci√≥n. <br><br>  Esta situaci√≥n no debe fomentarse, debe intentar ordenar al menos parte de nuestra lista, ya que existe la posibilidad de que el c√≥digo generado est√© en esta parte de la lista, ya que se genera aleatoriamente.  Al intentarlo, debe confiar en el azar, pero a√∫n existe la posibilidad de obtener la combinaci√≥n correcta, lo que demuestra una vulnerabilidad que definitivamente debe corregirse. <br><br><h4>  3) Restablezca el l√≠mite de velocidad-a cuando actualice el c√≥digo. </h4><br>  En la solicitud de verificaci√≥n del c√≥digo, el l√≠mite de velocidad est√° presente, pero despu√©s de activar la funci√≥n de reenv√≠o del c√≥digo, se restablece y le permite continuar con el c√≥digo de fuerza bruta. <br>  Ejemplos de informes: <br><br>  <a href="https://hackerone.com/reports/149598">https://hackerone.com/reports/149598</a> , - teor√≠a; <br>  <a href="https://hackerone.com/reports/205000">hackerone.com/reports/205000</a> , un exploit pr√°ctico basado en un informe anterior. <br><br><h4>  4) Saltando el l√≠mite de velocidad cambiando la direcci√≥n IP </h4><br>  Muchos bloqueos se basan en la restricci√≥n de recibir solicitudes de IP, que ha alcanzado el umbral de un cierto n√∫mero de intentos al ejecutar una solicitud.  Si se cambia la direcci√≥n IP, existe la oportunidad de eludir esta restricci√≥n.  Para verificar este m√©todo, simplemente cambie su IP usando el servidor Proxy / VPN y vea si el bloqueo depende de la IP. <br><br>  Formas de cambiar la IP: <br><br><ul><li>  Los proxies se pueden usar en un ataque usando el complemento IP Rotator para Burp Suite <a href="https://github.com/RhinoSecurityLabs/IPRotate_Burp_Extension">github.com/RhinoSecurityLabs/IPRotate_Burp_Extension</a> .  En mi opini√≥n, esta es la mejor opci√≥n, ya que nos brinda ~ intentos ilimitados de fuerza bruta y direcciones IP que le permiten realizar un ataque de fuerza bruta sin errores e interrupciones 42x. </li><li>  Una buena opci√≥n podr√≠a ser un script de Python con un m√≥dulo de solicitudes de proxy, pero primero necesita obtener una gran cantidad de proxies v√°lidos en alg√∫n lugar. </li></ul><br>  Dado que la herramienta de rotaci√≥n de IP env√≠a solicitudes utilizando direcciones IP de AWS, todas las solicitudes se bloquear√°n si la aplicaci√≥n web est√° detr√°s del firewall de CloudFlare. <br><br><img src="https://habrastorage.org/webt/5b/ep/c4/5bepc4djncwcbel-6gxkjfzh1ro.png"><br><br>  En este caso, debe descubrir adicionalmente la IP del servidor web original o encontrar un m√©todo que no afecte a las direcciones IP de AWS. <br><br><h4>  5) El sitio incluye soporte para X-Fordered-For </h4><br>  El encabezado X-Fordered-For incorporado se puede usar para cambiar la IP.  Si la aplicaci√≥n tiene un procesamiento incorporado para este encabezado, simplemente env√≠e X-Forward-For: deseado_IP para reemplazar la IP para evitar la restricci√≥n sin el uso de proxies adicionales.  Cada vez que se env√≠a una solicitud desde X-Fordered-For, el servidor web pensar√° que nuestra direcci√≥n IP coincide con el valor transmitido a trav√©s del encabezado. <br>  Materiales sobre este tema: <br>  <a href="https://hackerone.com/reports/225897">hackerone.com/reports/225897</a> <br>  <a href="https://medium.com/%40arbazhussain/bypassing-rate-limit-protection-by-spoofing-originating-ip-ff06adf34157">medium.com/@arbazhussain/bypassing-rate-limit-protection-by-spoofing-originating-ip-ff06adf34157</a> <br><br><h2>  3. Omita 2fa sustituyendo parte de la solicitud de una sesi√≥n de otra cuenta </h2><br>  Si se env√≠a un par√°metro con un valor espec√≠fico para verificar el c√≥digo en la solicitud, intente enviar el valor de la solicitud a otra cuenta. <br><br>  Por ejemplo, al enviar un c√≥digo OTP, se verifica la identificaci√≥n del formulario, la identificaci√≥n del usuario o la cookie asociada con el env√≠o del c√≥digo.  Si aplicamos los datos de los par√°metros de la cuenta en la que desea omitir la verificaci√≥n del c√≥digo (Cuenta 1) a una sesi√≥n de una cuenta completamente diferente (Cuenta 2), obtendremos el c√≥digo y lo ingresaremos en la segunda cuenta, entonces podremos omitir la protecci√≥n en la primera cuenta.  Despu√©s de volver a cargar la p√°gina 2FA deber√≠a desaparecer. <br><br><h2>  4. Omita 2FA utilizando la "funcionalidad de memorizaci√≥n" </h2><br>  Muchos sitios que admiten la autorizaci√≥n 2FA tienen la funcionalidad "recordarme".  Es √∫til cuando el usuario no desea ingresar un c√≥digo 2FA en inicios de sesi√≥n posteriores.  Es importante identificar la forma en que 2FA es "recordado".  Esto puede ser una cookie, un valor en sesi√≥n / almacenamiento local, o simplemente adjuntar 2FA a una direcci√≥n IP. <br><br><h4>  1) Si se adjunta 2FA usando una cookie, el valor de la cookie debe ser indiscutible </h4><br>  Es decir, si una cookie consiste en un conjunto de n√∫meros que aumentan para cada cuenta, entonces es muy posible aplicar un ataque de fuerza bruta al valor de la cookie y evitar 2FA.  Los desarrolladores deben proporcionar la cookie (junto con la cookie de sesi√≥n clave y el token CSRF) con el atributo HttpOnly para que no pueda ser robada usando XSS y utilizada para evitar 2FA. <br><br><h4>  2) Si 2FA est√° conectado a la direcci√≥n IP, puede intentar reemplazarlo </h4><br>  Para identificar este m√©todo, inicie sesi√≥n en su cuenta utilizando la funci√≥n de almacenamiento 2FA, luego cambie a otro navegador o modo de inc√≥gnito del navegador actual e intente iniciar sesi√≥n nuevamente.  Si no se solicita 2FA, se ha adjuntado 2FA a la direcci√≥n IP. <br>  Para reemplazar la direcci√≥n IP, puede usar el encabezado X-Fordered-For en la etapa de ingresar el nombre de usuario y la contrase√±a, si la aplicaci√≥n web lo admite. <br><br>  Con este encabezado, tambi√©n puede omitir la funci√≥n de lista blanca de la direcci√≥n IP, si hay una presente en la configuraci√≥n de la cuenta.  Se puede usar junto con 2FA como protecci√≥n adicional de la cuenta o incluso no se puede solicitar 2FA si la direcci√≥n IP coincide con la lista blanca (con el consentimiento del usuario).  Por lo tanto, incluso sin conectar el 2FA a la direcci√≥n IP, en algunos casos se puede eludir el 2FA eludiendo los m√©todos de protecci√≥n asociados. <br>  En general, adjuntar 2FA a una direcci√≥n IP no es una forma completamente segura de protecci√≥n, porque cuando est√° presente en la misma red, cuando est√° conectado al mismo proveedor de servicios VPN / Internet con una direcci√≥n IP est√°tica, se puede omitir 2FA. <br><br>  La forma m√°s segura de protegerse es no recordar 2FA en absoluto en detrimento de la usabilidad. <br><br><h2>  5. Error de control de acceso incorrecto en la p√°gina de entrada 2FA </h2><br>  A veces, una p√°gina de di√°logo para ingresar 2FA se presenta como una URL con par√°metros.  El acceso a dicha p√°gina con par√°metros en la URL con cookies que no coinciden con los utilizados para generar la p√°gina o sin cookies no es seguro.  Pero si los desarrolladores decidieron aceptar los riesgos, entonces debe pasar por varios puntos importantes: <br><br><ol><li>  ¬øEl enlace caduca para la entrada 2FA? </li><li>  si el enlace est√° indexado en los motores de b√∫squeda. </li></ol><br>  Si el enlace tiene una larga vida y / o los motores de b√∫squeda contienen enlaces de trabajo para la entrada 2FA / los enlaces pueden indexarse ‚Äã‚Äã(no hay reglas en robots.txt / metaetiquetas), entonces existe la posibilidad de utilizar un mecanismo de derivaci√≥n 2FA en la p√°gina de entrada 2FA, en la que omita completamente el nombre de usuario y la contrase√±a, y obtenga acceso a la cuenta de otra persona. <br><br><h2>  6. Censura inadecuada de los datos personales en la p√°gina 2FA </h2><br>  Al enviar un c√≥digo OTP en una p√°gina, la censura se utiliza para proteger datos personales como correo electr√≥nico, n√∫mero de tel√©fono, apodo, etc.  Pero estos datos pueden divulgarse completamente en los puntos finales de la API y otras solicitudes para las cuales tenemos suficientes derechos en la etapa 2FA.  Si inicialmente no se conoc√≠an estos datos, por ejemplo, ingresamos solo un inicio de sesi√≥n sin conocer el n√∫mero de tel√©fono, entonces esto se considera la vulnerabilidad de divulgaci√≥n de informaci√≥n.  Saber el n√∫mero de tel√©fono / correo electr√≥nico se puede utilizar para posteriores ataques de phishing y fuerza bruta. <br><br>  Un ejemplo de explotaci√≥n de una vulnerabilidad usando Credentials Stuffing.  Digamos que hay una base de datos en el dominio p√∫blico con inicios de sesi√≥n y contrase√±as para el sitio A. Los atacantes pueden usar los datos de esta base de datos en el sitio B: <br><br><ul><li>  Primero, verifican si el usuario existe en la base de datos del sitio B utilizando el error "Enumeraci√≥n de cuentas" al registrar / recuperar la contrase√±a.  Por lo general, muchos sitios no consideran esto una vulnerabilidad y toman riesgos.  La "vulnerabilidad" radica en la presencia de un error sobre el hecho de registro de usuario en el sitio.  Idealmente, un mensaje seguro en la p√°gina de recuperaci√≥n de contrase√±a es el siguiente: <br><br><img src="https://habrastorage.org/webt/mh/qe/mh/mhqemhmykfiy5pcl-35konzb0dm.png"><br><br><img src="https://habrastorage.org/webt/ha/uu/ze/hauuzewqlj9escx9nc8fslz4a0o.png"></li><li>  Despu√©s de obtener la base de datos de usuarios existentes, los atacantes aplican contrase√±as a estas cuentas. </li><li>  Si se encuentran con 2FA, entonces se atascan.  Pero en caso de censura insuficiente de los datos del usuario, pueden complementar su base de datos con sus datos personales (si no estaban en la base de datos original). </li></ul><br><h2>  7. Ignorando 2FA en ciertas circunstancias </h2><br>  Al realizar algunas acciones que conducen al inicio de sesi√≥n autom√°tico en su cuenta, es posible que no se solicite 2FA. <br><br><h4>  1) Ignora 2FA al recuperar una contrase√±a </h4><br>  Muchos servicios inician sesi√≥n autom√°ticamente en su cuenta despu√©s de completar el procedimiento de recuperaci√≥n de contrase√±a.  Dado que el acceso a la cuenta se proporciona instant√°neamente, cuando inicia sesi√≥n en su cuenta 2FA, puede ignorarse e ignorarse por completo. <br><br>  Impacto de un informe de hackerone similar que envi√© recientemente: <br><blockquote>  Si un atacante obtiene acceso al correo electr√≥nico de la v√≠ctima (puede piratear la cuenta mediante phishing, ataques de fuerza bruta, relleno de credenciales, etc.), puede omitir 2FA, aunque en este caso 2FA deber√≠a proteger la cuenta.  Por el momento, para 2FA hay una verificaci√≥n del c√≥digo de Google Authenticator o del c√≥digo de respaldo, pero no del c√≥digo del correo electr√≥nico, por lo que este Bypass tiene sentido. </blockquote><h4>  2) Ignorar 2FA al iniciar sesi√≥n a trav√©s de una red social </h4><br>  Puede adjuntar una red social a su cuenta de usuario para iniciar sesi√≥n r√°pidamente en su cuenta y al mismo tiempo configurar 2FA.  Cuando inicia sesi√≥n en su cuenta a trav√©s de las redes sociales, se puede ignorar 2FA.  Si se piratea el correo electr√≥nico de la v√≠ctima, ser√° posible recuperar la contrase√±a de la cuenta de la red social (si lo permite) e ingresar al servicio sin ingresar 2FA. <br><br>  Impacto de uno de los informes: <br><blockquote><ol><li>  Un mont√≥n de otras vulnerabilidades, como la configuraci√≥n incorrecta de OAuth enviada anteriormente # 577468, para capturar completamente la cuenta, rompiendo 2FA. </li><li>  Si un atacante hacke√≥ el correo electr√≥nico del usuario, podr√≠a intentar recuperar el acceso a la cuenta de la red social e iniciar sesi√≥n en la cuenta sin verificaci√≥n adicional. </li><li>  Si un atacante una vez pirate√≥ la cuenta de una v√≠ctima, podr√≠a asociar una red social con la cuenta e iniciar sesi√≥n en la cuenta en el futuro, ignorando completamente 2FA e ingresando el nombre de usuario / contrase√±a. </li></ol></blockquote><h4>  3) Ignorar 2FA en una versi√≥n anterior de la aplicaci√≥n </h4><br>  Los desarrolladores a menudo agregan versiones provisionales de una aplicaci√≥n web a dominios / subdominios para probar ciertas funciones.  Curiosamente, si inicia sesi√≥n con su nombre de usuario y contrase√±a, no se solicitar√° 2FA.  Quiz√°s los desarrolladores est√°n utilizando una versi√≥n anterior de la aplicaci√≥n, en la que no hay protecci√≥n para 2FA, 2FA en s√≠ est√° deshabilitado o fue deshabilitado intencionalmente para las pruebas. <br><br>  Adem√°s, puede verificar otras vulnerabilidades al mismo tiempo, - registrar un nuevo usuario en un servidor provisional cuyo correo electr√≥nico existe en la base de datos de la versi√≥n de producci√≥n puede proporcionarnos datos personales de la producci√≥n;  la ausencia de un l√≠mite de velocidad en funcionalidades importantes, por ejemplo, recuperaci√≥n de contrase√±a.  Un ejemplo de la √∫ltima vulnerabilidad es un error de Facebook de $ 15,000, que permiti√≥ hackear una cuenta usando el c√≥digo de recuperaci√≥n de contrase√±a de bruteforce en beta.facebook.com <a href="https://www.freecodecamp.org/news/responsible-disclosure-how-i-could-have-hacked-all-facebook-accounts-f47c0252ae4d/">www.freecodecamp.org/news/responsible-disclosure-how-i-could-have-hacked-all- facebook-accounts-f47c0252ae4d</a> . <br><br><h4>  4) Ignorar 2FA en caso de plataforma cruzada </h4><br>  Las implementaciones de 2FA en la versi√≥n m√≥vil o de escritorio pueden diferir de la versi√≥n web de la aplicaci√≥n.  2FA puede ser m√°s d√©bil que en la versi√≥n web o completamente ausente. <br><br>  7. Al deshabilitar 2FA, no se solicita el c√≥digo actual. <br><br>  Si, al deshabilitar 2FA, no se solicita confirmaci√≥n adicional, como el c√≥digo actual de la aplicaci√≥n de autenticaci√≥n de google, el c√≥digo del correo electr√≥nico / tel√©fono, entonces en este caso existen ciertos riesgos.  Con una solicitud limpia, existe la posibilidad de un ataque CSRF.  Si se encuentra un vector de derivaci√≥n de protecci√≥n CSRF (si existe), entonces 2FA se puede deshabilitar.  Tambi√©n se puede utilizar una vulnerabilidad de clickjacking: despu√©s de un par de clics de un usuario desprevenido, 2FA se desconectar√°.  La validaci√≥n del c√≥digo anterior agregar√° protecci√≥n adicional 2FA, dados los posibles ataques CSRF / XSS / Clickjacking, as√≠ como las configuraciones incorrectas de CORS. <br><br>  Le dar√© un ejemplo de hackerone.com: cuando apaga 2FA de una forma, debe ingresar dos variables al mismo tiempo, el c√≥digo actual con la aplicaci√≥n de autenticaci√≥n de Google y la contrase√±a.  Esta es la mejor y recomendada protecci√≥n. <br><br><img src="https://habrastorage.org/webt/wg/hh/jz/wghhjzf5sdotqin6knlde5i4g5q.png"><br><br><h2>  8. Las sesiones creadas previamente siguen siendo v√°lidas despu√©s de la activaci√≥n de 2FA </h2><br>  Cuando 2FA est√° habilitado, es deseable que finalicen las sesiones paralelas en la misma cuenta y se muestre el cuadro de di√°logo de entrada de 2FA, lo mismo con un cambio de contrase√±a.  Si la cuenta se vio comprometida y la primera reacci√≥n de la v√≠ctima es la inclusi√≥n de 2FA, la sesi√≥n del atacante se deshabilitar√° y el pr√≥ximo inicio de sesi√≥n y contrase√±a requerir√°n 2FA.  Con todo, esta es la mejor pr√°ctica a seguir.  A menudo noto c√≥mo los intercambios de criptomonedas agregan una protecci√≥n similar.  Ejemplo de informe de HackerOne, - <br>  https://hackerone.com/reports/534450. <br><br><h4>  9. La ausencia de un l√≠mite de tasa en su cuenta </h4><br>  2FA se puede implementar en varias funciones de la cuenta personal del usuario para mayor seguridad.  Esto puede ser un cambio de direcci√≥n de correo electr√≥nico, contrase√±a, confirmaci√≥n de un cambio de c√≥digo para transacciones financieras, etc.  La presencia de rate-limit-a en su cuenta puede diferir de la presencia de rate-limit-a en 2FA al ingresar a su cuenta.  A menudo me he encontrado con casos similares cuando era posible seleccionar libremente un c√≥digo 2FA en mi cuenta, mientras que en la entrada se estableci√≥ un l√≠mite de velocidad "estricto". <br><br>  Si los desarrolladores inicialmente agregaron protecci√≥n contra cambios de datos no autorizados, entonces esta protecci√≥n debe ser respaldada y corregida por todos los bypass-s posibles.  Si se encuentra la omisi√≥n, se considera una vulnerabilidad de omisi√≥n de la caracter√≠stica de seguridad implementada por los desarrolladores. <br><br><h4>  10. versiones de API </h4><br>  Si ve algo como / v * / en la solicitud de la aplicaci√≥n web, donde * es un n√∫mero, entonces es probable que pueda cambiar a una versi√≥n anterior de la API.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En la versi√≥n anterior de la API, puede haber una protecci√≥n d√©bil o no tener ninguna. Esta es una ocurrencia bastante rara y ocurre si los desarrolladores olvidaron eliminar la versi√≥n anterior de la API en el entorno de producci√≥n / preparaci√≥n. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por ejemplo, / endpoint / api / v4 / login realiza una solicitud de inicio de sesi√≥n, verificando el nombre de usuario y la contrase√±a. Si 2FA est√° presente en la cuenta, esta solicitud debe ser seguida por / endpoint / api / v4 / 2fa_check, nada m√°s. Si reemplazamos la versi√≥n de API antes de 2FA, entonces, en algunos casos, podemos evitarlo. / endpoint / api / v3 / login puede conducir a / endpoint / v3 / login_successful? code = RANDOM, ignorando 2fa_check porque en esta versi√≥n de la API, 2FA simplemente no se implement√≥.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Otro ejemplo: en request / endpoint / api / v4 / 2fa_check hay un l√≠mite de velocidad, mientras que / endpoint / api / v3 / 2fa_check le permite iterar sobre los c√≥digos sin ninguna restricci√≥n. </font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 11. Control de acceso incorrecto al solicitar c√≥digos de respaldo </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los c√≥digos de respaldo se generan inmediatamente despu√©s de que se habilite 2FA y est√°n disponibles en una sola solicitud. </font><font style="vertical-align: inherit;">Despu√©s de cada llamada posterior a la solicitud, los c√≥digos pueden ser generados por uno nuevo o permanecer sin cambios (c√≥digos est√°ticos). </font><font style="vertical-align: inherit;">Si hay vulnerabilidades de configuraci√≥n incorrecta de CORS / XSS y otros errores que permiten "extraer" c√≥digos de respaldo de la solicitud de respuesta para el punto final de visualizaci√≥n del c√≥digo de respaldo, entonces un atacante podr√≠a robar c√≥digos y omitir 2FA si se conoce el nombre de usuario y la contrase√±a.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En general, 2fa es una de las formas m√°s confiables para proteger su cuenta, a menos que, por supuesto, los desarrolladores almacenen los c√≥digos 2FA actuales de todos los usuarios de la aplicaci√≥n web en el panel de administraci√≥n, y esto ha sucedido en mi pr√°ctica. Tambi√©n me gustar√≠a se√±alar que los desarrolladores de algunas empresas crean aplicaciones para generar sus propios c√≥digos 2FA (por ejemplo, Salesforce, Valve) y, debido a la falta de seguridad, este √©nfasis en la independencia del uso de otras aplicaciones de autenticaci√≥n brinda a los atacantes un punto de entrada adicional para evitar 2FA. El rango de aplicaci√≥n de esta protecci√≥n es bastante amplio y brinda a quienes desean evitar la protecci√≥n 2FA m√°s oportunidades, espacio para la creatividad y aumenta el n√∫mero de variaciones de los bypass-2FA.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espero que esta informaci√≥n sea √∫til para los investigadores de seguridad de la informaci√≥n, los cazadores de recompensas de errores, as√≠ como para que los desarrolladores minimicen la cantidad de vulnerabilidades en el servicio que se est√° desarrollando. </font><font style="vertical-align: inherit;">¬°Mantente a salvo!</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/483134/">https://habr.com/ru/post/483134/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../483124/index.html">El gadget m√°s masivo en el futuro cercano (no un tel√©fono inteligente)</a></li>
<li><a href="../483126/index.html">Los efectos criog√©nicos pueden garantizar el transporte seguro de las bater√≠as da√±adas de los veh√≠culos el√©ctricos.</a></li>
<li><a href="../483128/index.html">Presentaci√≥n de PHP 7.4: rendimiento, caracter√≠sticas, desaprobaciones</a></li>
<li><a href="../483130/index.html">¬øQu√© hacer si se olvida el c√≥digo para el candado de la maleta?</a></li>
<li><a href="../483132/index.html">Dise√±o y fabricaci√≥n de un telescopio.</a></li>
<li><a href="../483136/index.html">Verificaci√≥n del MacBook usado antes de la compra - lista de verificaci√≥n</a></li>
<li><a href="../483140/index.html">Pol√≠gonos Otro Mundo: Amiga 500</a></li>
<li><a href="../483142/index.html">Portar Quake 3 a Rust</a></li>
<li><a href="../483144/index.html">El cient√≠fico He Jiankui es un h√©roe, no un criminal.</a></li>
<li><a href="../483146/index.html">Conferencia DEFCON 27. Herramienta de pirater√≠a WiFi inal√°mbrica Kraken</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>