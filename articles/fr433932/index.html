<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÜî üëÇüèæ ü§òüèæ Nous tirons dans le pied, traitant les donn√©es d'entr√©e ü§ê üïâÔ∏è üë©üèæ‚ÄçüöÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le lien dans l'article d'aujourd'hui est diff√©rent de l'habituel. Ce n'est pas un projet pour lequel le code source a √©t√© analys√©, mais une s√©rie de r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous tirons dans le pied, traitant les donn√©es d'entr√©e</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/433932/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/jh/iw/l-/jhiwl-y02cm4bhppsrj9flbpqsi.png"></div><br>  Le lien dans l'article d'aujourd'hui est diff√©rent de l'habituel.  Ce n'est pas un projet pour lequel le code source a √©t√© analys√©, mais une s√©rie de r√©ponses de la m√™me r√®gle de diagnostic dans plusieurs projets diff√©rents.  Quel est l'int√©r√™t ici?  Le fait que certains des fragments de code consid√©r√©s contiennent des erreurs reproductibles lorsque vous travaillez avec l'application, tandis que d'autres contiennent des vuln√©rabilit√©s (CVE).  De plus, √† la fin de l'article, nous discuterons un peu du sujet des d√©fauts de s√©curit√©. <br><a name="habracut"></a><br><h2>  Br√®ve pr√©face </h2><br>  Toutes les erreurs qui seront examin√©es aujourd'hui dans l'article ont un sch√©ma similaire: <br><br><ul><li>  le programme re√ßoit des donn√©es du flux <i>stdin</i> ; </li><li>  une v√©rification est effectu√©e pour la r√©ussite de la lecture des donn√©es; </li><li>  si les donn√©es ont √©t√© lues avec succ√®s, le caract√®re de report est supprim√© de la ligne. </li></ul><br>  Cependant, tous les fragments qui seront consid√©r√©s contiennent des erreurs et sont vuln√©rables aux entr√©es truqu√©es.  √âtant donn√© que les donn√©es sont re√ßues d'un utilisateur qui peut violer la logique d'ex√©cution de l'application, il y avait une grande tentation d'essayer de casser quelque chose.  Ce que j'ai fait. <br><br>  Tous les probl√®mes ci-dessous ont √©t√© d√©couverts par l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">analyseur statique PVS-Studio</a> , qui recherche des erreurs dans le code non seulement pour C, C ++, mais aussi pour C #, Java. <br><br>  Bien s√ªr, trouver un probl√®me avec un analyseur statique est bien, mais trouver et reproduire est un niveau de plaisir compl√®tement diff√©rent.  :) <br><br><h2>  Freeswitch </h2><br>  Le premier fragment de code suspect a √©t√© trouv√© dans le code du module <i>fs_cli.exe</i> , qui fait partie du kit de distribution FreeSWITCH: <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">basic_gets</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *cnt)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c = getchar(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fgets(command_buf, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(command_buf) - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>) != command_buf) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } command_buf[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(command_buf)<span class="hljs-number"><span class="hljs-number">-1</span></span>] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* remove endline */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } .... }</code> </pre> <br>  <b>Avertissement PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V1010</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CWE-20 Les</a> donn√©es contamin√©es non <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">contr√¥l√©es</a> sont utilis√©es dans l'index: 'strlen (command_buf)'. <br><br>  L'analyseur avertit d'un appel suspect par index au tableau <i>command_buf</i> .  Il est consid√©r√© comme suspect car des donn√©es externes non v√©rifi√©es sont utilis√©es comme index.  Externe - car ils sont obtenus via la fonction <i>fgets</i> du flux <i>stdin</i> .  Non v√©rifi√© - car aucune v√©rification n'a √©t√© effectu√©e avant utilisation.  L'expression <i>fgets (command_buf, ....)! = Command_buf</i> ne compte pas, car de cette fa√ßon, nous v√©rifions uniquement le fait de recevoir les donn√©es, mais pas leur contenu. <br><br>  Le probl√®me avec ce code est que, dans certaines conditions, ¬´\ 0¬ª sera √©crit en dehors du tableau, ce qui entra√Ænera un comportement non d√©fini.  Pour ce faire, il suffit d'entrer une cha√Æne de longueur nulle (une cha√Æne de longueur nulle du point de vue du langage C, c'est-√†-dire une cha√Æne dans laquelle le premier caract√®re sera '\ 0'). <br><br>  Estimons ce qui se passe si vous passez une cha√Æne de longueur nulle √† l'entr√©e: <br><br><ul><li>  <i>fgets (command_buf, ....)</i> -&gt; <i>command_buf</i> ; </li><li>  <i>fgets (....)! = command_buf</i> -&gt; <i>false</i> ( <i>alors la</i> branche de l' <i>instruction if est</i> ignor√©e); </li><li>  <i>strlen (command_buf)</i> -&gt; <i>0</i> ; </li><li>  <i>command_buf [strlen (command_buf) - 1]</i> -&gt; <i>command_buf [-1]</i> . </li></ul><br>  Oups! <br><br>  Ce qui est int√©ressant ici, c'est que cet avertissement de l'analyseur peut √™tre ¬´ressenti avec vos mains¬ª.  Pour r√©p√©ter le probl√®me, vous avez besoin de: <br><br><ul><li>  amener le programme √† cette fonction; </li><li>  affinez l'entr√©e afin que l'appel <i>getchar ()</i> renvoie une valeur n√©gative; </li><li>  passez pour la fonction <i>fgets</i> une ligne avec un terminal z√©ro au d√©but, qu'elle doit lire avec succ√®s. </li></ul><br>  En fouillant un peu dans la source, j'ai compos√© une s√©quence sp√©cifique pour reproduire le probl√®me: <br><br><ul><li>  Ex√©cutez <i>fs_cli.exe</i> en mode batch ( <i>fs_cli.exe -b</i> ).  Je note que pour effectuer d'autres √©tapes, la connexion <i>fs_cli.exe</i> au serveur doit r√©ussir.  Pour ce faire, il suffit, par exemple, d'ex√©cuter <i>FreeSwitchConsole.exe localement en</i> tant qu'administrateur. </li><li>  Nous effectuons l'entr√©e de sorte que l'appel <i>getchar ()</i> renvoie une valeur n√©gative. </li><li>  Entrez une ligne avec un terminal z√©ro au d√©but (par exemple, '\ 0Oops'). </li><li>  .... </li><li>  PROFIT! </li></ul><br>  Voici une lecture vid√©o du probl√®me: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/jSYJirPIK8E" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  Ncftp </h2><br>  Un probl√®me similaire a √©t√© d√©couvert dans le projet NcFTP, mais il s'est d√©j√† rencontr√© √† deux endroits.  √âtant donn√© que le code semble similaire, ne consid√©rez qu'un seul endroit probl√©matique: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NcFTPConfirmResumeDownloadProc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fgets(newname, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(newname) - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>) == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) newname[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; newname[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(newname) - <span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; .... }</code> </pre> <br>  <b>Avertissement PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V1010</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CWE-20 Les</a> donn√©es corrompues non <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">contr√¥l√©es</a> sont utilis√©es dans l'index: 'strlen (nouveau nom)'. <br><br>  Ici, contrairement √† l'exemple de FreeSWITCH, le code est √©crit pire et plus sujet aux probl√®mes.  Par exemple, l'√©criture de ¬´\ 0¬ª se produit ind√©pendamment du fait que la lecture a r√©ussi √† l'aide de <i>fgets</i> ou non.  Autrement dit, il existe encore plus de possibilit√©s pour briser la logique normale d'ex√©cution.  Allons d'une mani√®re √©prouv√©e - √† travers des lignes de longueur nulle. <br><br>  Le probl√®me reproduit est un peu plus compliqu√© qu'avec FreeSWITCH.  La s√©quence des √©tapes est d√©crite ci-dessous: <br><br><ul><li>  d√©marrage et connexion au serveur √† partir duquel vous pouvez t√©l√©charger le fichier.  Par exemple, j'ai utilis√© <i>speedtest.tele2.net</i> (√† la fin, la commande de lancement d'application ressemble √† ceci: <i>ncftp.exe <a href="">speedtest.tele2.net</a></i> ); </li><li>  t√©l√©charger un fichier depuis le serveur.  Localement, un fichier du m√™me nom mais avec des propri√©t√©s diff√©rentes devrait d√©j√† exister.  Vous pouvez, par exemple, t√©l√©charger un fichier √† partir du serveur, le modifier et r√©essayer d'ex√©cuter la commande de t√©l√©chargement (par exemple, <i>obtenez 512 Ko.zip</i> ); </li><li>  r√©pondez √† la question sur le choix d'une action avec une ligne commen√ßant par le caract√®re ¬´N¬ª (par exemple, <i>maintenant amusons-nous</i> ); </li><li>  entrez '\ 0' (ou quelque chose de plus int√©ressant); </li><li>  .... </li><li>  PROFIT! </li></ul><br>  La reproduction du probl√®me est √©galement enregistr√©e sur vid√©o: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/8DBQjvPQ7tk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  Openldap </h2><br>  Dans le projet OpenLDAP (plus pr√©cis√©ment, dans l'un des utilitaires associ√©s), ils ont march√© sur le m√™me r√¢teau que dans FreeSWITCH.  Une tentative de suppression d'un caract√®re de saut de ligne se produit uniquement si la ligne a √©t√© lue avec succ√®s, mais il n'y a pas non plus de protection contre les lignes de longueur nulle. <br><br>  Extrait de code: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> **argv )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf[ <span class="hljs-number"><span class="hljs-number">4096</span></span> ]; FILE *fp = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { fp = <span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>; } .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( fp == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ((rc == <span class="hljs-number"><span class="hljs-number">0</span></span> || contoper) &amp;&amp; fgets(buf, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(buf), fp) != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { buf[ <span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>( buf ) - <span class="hljs-number"><span class="hljs-number">1</span></span> ] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* remove trailing newline */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( *buf != <span class="hljs-string"><span class="hljs-string">'\0'</span></span> ) { rc = dodelete( ld, buf ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( rc != <span class="hljs-number"><span class="hljs-number">0</span></span> ) retval = rc; } } } .... }</code> </pre> <br>  <b>Avertissement PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V1010</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CWE-20 Les</a> donn√©es contamin√©es non <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">contr√¥l√©es</a> sont utilis√©es dans l'index: 'strlen (buf)'. <br><br>  Nous jetons l'exc√©dent pour que l'essence du probl√®me devienne plus √©vidente: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (.... &amp;&amp; fgets(buf, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(buf), fp) != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { buf[ <span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>( buf ) - <span class="hljs-number"><span class="hljs-number">1</span></span> ] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; .... }</code> </pre> <br>  Ce code est meilleur que NcFTP, mais reste vuln√©rable.  Si √† la demande <i>fgets</i> pour passer une cha√Æne de longueur nulle √† l'entr√©e: <br><br><ul><li>  <i>fgets (buf, ....)</i> -&gt; <i>buf</i> ; </li><li>  <i>fgets (....)! = NULL</i> -&gt; <i>true</i> (le corps de la <i>boucle while</i> commence √† s'ex√©cuter); </li><li>  <i>strlen (buf) - 1</i> -&gt; <i>0 - 1</i> -&gt; <i>-1</i> ; </li><li>  <i>buf [-1] = '\ 0'</i> . </li></ul><br><h2>  libidn </h2><br>  Malgr√© le fait que les erreurs discut√©es ci-dessus sont assez int√©ressantes (elles sont reproduites de mani√®re stable et elles peuvent √™tre ¬´touch√©es¬ª (√† moins que je ne puisse pas toucher le probl√®me OpenLDAP)), elles ne peuvent pas √™tre appel√©es vuln√©rabilit√©s, ne serait-ce que pour la raison que les identifiants CVE ne sont pas attribu√©s aux probl√®mes. <br><br>  Cependant, certaines vuln√©rabilit√©s r√©elles ont le m√™me sch√©ma de probl√®me.  Les deux extraits de code ci-dessous s'appliquent au projet libidn. <br><br>  Extrait de code: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *argv[])</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fgets (readbuf, BUFSIZ, <span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>) == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (feof (<span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; error (EXIT_FAILURE, errno, _(<span class="hljs-string"><span class="hljs-string">"input error"</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (readbuf[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (readbuf) - <span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) readbuf[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (readbuf) - <span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; .... }</code> </pre> <br>  <b>Avertissement PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V1010</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CWE-20 Les</a> donn√©es contamin√©es non <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">contr√¥l√©es</a> sont utilis√©es dans l'index: 'strlen (readbuf)'. <br><br>  La situation est similaire, sauf que, contrairement aux exemples pr√©c√©dents, o√π l'enregistrement a √©t√© effectu√© √† l'indice <i>-1</i> , la lecture a lieu ici.  Cependant, ce comportement n'est toujours pas d√©fini.  Cette erreur a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">re√ßu</a> son propre identifiant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CVE</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CVE-2015-8948</a> ). <br><br>  Apr√®s avoir d√©tect√© un probl√®me, ce code a √©t√© modifi√© comme suit: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *argv[])</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (getline (&amp;line, &amp;linelen, <span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (feof (<span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; error (EXIT_FAILURE, errno, _(<span class="hljs-string"><span class="hljs-string">"input error"</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (line[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (line) - <span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) line[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (line) - <span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; .... }</code> </pre> <br>  Un peu surpris?  √áa arrive.  Nouvelle vuln√©rabilit√©, identifiant CVE correspondant: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CVE-2016-6262</a> . <br><br>  <b>Avertissement PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V1010</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CWE-20 Les</a> donn√©es contamin√©es non <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">contr√¥l√©es</a> sont utilis√©es dans l'index: 'strlen (ligne)'. <br><br>  Lors d'une autre tentative, le probl√®me a √©t√© r√©solu en ajoutant une v√©rification de la longueur de la cha√Æne d'entr√©e: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (line) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (line[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (line) - <span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) line[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (line) - <span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>;</code> </pre> <br>  Jetons un coup d'≈ìil aux dates.  L'engagement de ¬´cl√¥ture¬ª CVE-2015-8948 - 08/10/2015.  Valider la cl√¥ture CVE-2016-62-62 - 14/01/2016.  Autrement dit, la diff√©rence entre les corrections ci-dessus est de <i>5 mois</i> !  Ici, vous vous souvenez d'un tel avantage de l'analyse statique que la d√©tection d'erreurs dans les premi√®res √©tapes de l'√©criture de code ... <br><br><h2>  Analyse statique et s√©curit√© </h2><br>  Il n'y aura pas d'autres exemples de code, mais plut√¥t des statistiques et un raisonnement.  Dans cette section, l'opinion de l'auteur peut ne pas co√Øncider avec l'opinion du lecteur beaucoup plus qu'auparavant dans cet article. <br><br>  <b>Remarque</b>  Je vous recommande de lire un autre article sur un sujet similaire - " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment PVS-Studio peut-il aider √† trouver des vuln√©rabilit√©s?</a> ".  Il existe des exemples int√©ressants de vuln√©rabilit√©s qui ressemblent √† de simples erreurs.  De plus, dans cet article, j'ai parl√© un peu de la terminologie et de la raison pour laquelle l'analyse statique est indispensable si vous √™tes pr√©occup√© par le sujet de la s√©curit√©. <br><br>  Regardons les statistiques sur le nombre de vuln√©rabilit√©s d√©couvertes au cours des 10 derni√®res ann√©es pour √©valuer la situation.  J'ai pris les donn√©es du site Web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CVE Details</a> . <br><br><p><img src="https://habrastorage.org/webt/lu/au/2i/luau2ik1aoqytidzblkeqjy8vhs.png" alt="Image 2"></p><br><br>  Une situation int√©ressante se profile.  Jusqu'en 2014, le nombre de CVE enregistr√©s n'a pas d√©pass√© la barre des 6000 unit√©s, et √† partir de - il n'est pas descendu en dessous.  Mais le plus int√©ressant ici, bien s√ªr, ce sont les statistiques pour 2017 - le leader absolu (14714 unit√©s).  Quant √† l'ann√©e en cours - 2018 -, elle n'est pas encore termin√©e, mais bat d√©j√† des records - 15 310 unit√©s. <br><br>  Est-ce √† dire que tous les nouveaux logiciels sont remplis de trous comme un tamis?  Je ne pense pas, et voici pourquoi: <br><br><ul><li>  Int√©r√™t accru pour le sujet des vuln√©rabilit√©s.  Certes, m√™me si vous n'√™tes pas tr√®s proche du sujet de la s√©curit√©, vous avez rencontr√© √† plusieurs reprises des articles, des notes, des rapports et des vid√©os sur le sujet de la s√©curit√©.  En d'autres termes, une sorte de ¬´battage m√©diatique¬ª a √©t√© cr√©√©.  C'est mauvais?  Probablement pas.  En fin de compte, tout se r√©sume au fait que les d√©veloppeurs sont plus pr√©occup√©s par la s√©curit√© des applications, ce qui est bien. </li><li>  Une augmentation du nombre d'applications d√©velopp√©es.  Plus de code - plus susceptible de se produire toute vuln√©rabilit√© qui reconstituera les statistiques. </li><li>  Outils de recherche de vuln√©rabilit√© am√©lior√©s et assurance qualit√© du code.  Plus de demande -&gt; plus d'offre.  Les analyseurs, fuzzers et autres outils sont de plus en plus avanc√©s, ce qui joue entre les mains de ceux qui veulent rechercher des vuln√©rabilit√©s (quel que soit le c√¥t√© des barricades sur lequel ils se trouvent). </li></ul><br>  Ainsi, la tendance √©mergente ne peut pas √™tre qualifi√©e de exclusivement n√©gative - les √©diteurs sont plus pr√©occup√©s par la s√©curit√© de l'information, les outils pour d√©tecter les probl√®mes sont am√©lior√©s, et tout cela est sans aucun doute positif. <br><br>  Est-ce √† dire que vous pouvez vous d√©tendre et ne pas vous ¬´baigner¬ª?  Je pense que non.  Si vous √™tes pr√©occup√© par le sujet de la s√©curit√© de vos applications, vous devez prendre autant de mesures de s√©curit√© que possible.  Cela est particuli√®rement vrai si le code source est dans le domaine public, car il: <br><br><ul><li>  plus susceptibles d'int√©grer des vuln√©rabilit√©s externes; </li><li>  plus enclins √† "sonder" par ces "messieurs" qui sont int√©ress√©s par des trous dans votre application dans le but de les exploiter.  Bien que les sympathisants dans ce cas pourront vous aider davantage. </li></ul><br>  Je ne veux pas dire que vous n'avez pas besoin de traduire vos projets sous open source.  Gardez simplement √† l'esprit les contr√¥les de qualit√© / s√©curit√© appropri√©s. <br><br>  L'analyse statique est-elle une mesure suppl√©mentaire?  Oui  L'analyse statique fait un bon travail pour d√©tecter les vuln√©rabilit√©s potentielles qui pourraient devenir r√©elles √† l'avenir. <br><br>  Il me semble (j'avoue que je me trompe) que beaucoup consid√®rent les vuln√©rabilit√©s comme un ph√©nom√®ne de haut niveau.  Oui et non.  Les probl√®mes de code qui semblent √™tre de simples erreurs de programmation peuvent √©galement √™tre de graves vuln√©rabilit√©s.  Encore une fois, quelques exemples de telles vuln√©rabilit√©s sont fournis dans l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article mentionn√© pr√©c√©demment</a> .  Ne sous-estimez pas les erreurs ¬´simples¬ª. <br><br><h2>  Conclusion </h2><br>  N'oubliez pas que les donn√©es d'entr√©e peuvent √™tre de longueur nulle, et cela doit √©galement √™tre pris en compte. <br><br>  Conclusions pour savoir si tout le battage publicitaire avec des vuln√©rabilit√©s est juste du battage m√©diatique, ou si le probl√®me existe, faites-le vous-m√™me. <br><br>  Pour ma part, √† moins que je ne propose d'essayer votre projet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PVS-Studio</a> , si vous ne l'avez pas d√©j√† fait. <br><br>  Meilleurs v≈ìux! <br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/ts/z9/km/tsz9kmyjtteajhd4x1au60rsrvq.png" align="left"></a> </p><br><br>  Si vous souhaitez partager cet article avec un public anglophone, veuillez utiliser le lien vers la traduction: Sergey Vasiliev.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Tirez-vous dans le pied lors de la manipulation des donn√©es d'entr√©e</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr433932/">https://habr.com/ru/post/fr433932/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr433918/index.html">Pourquoi le Web est-il si compliqu√©?</a></li>
<li><a href="../fr433920/index.html">Le g√©ant chinois du silicium polycristallin augmente sa capacit√©</a></li>
<li><a href="../fr433922/index.html">Kubernetes Intensive: Support Jobs</a></li>
<li><a href="../fr433926/index.html">Framework Javascript: tendances 2019</a></li>
<li><a href="../fr433930/index.html">Profils distincts pour les ind√©pendants et les clients</a></li>
<li><a href="../fr433934/index.html">SAFe ou Scaled Agile Framework</a></li>
<li><a href="../fr433936/index.html">Vous cherchez un cadeau high-tech pour un enfant? Pensez √† un terrain de jeu, pas √† un parc</a></li>
<li><a href="../fr433938/index.html">Comment Yandex et Google r√©sument l'ann√©e</a></li>
<li><a href="../fr433940/index.html">Combien co√ªte Review dans l'AppStore</a></li>
<li><a href="../fr433944/index.html">Des exceptions d√©vastatrices</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>