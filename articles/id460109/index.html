<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐡 🐬 💨 Sudut: ketika Anda perlu melihat aplikasi, tetapi backend belum siap 🤜🏿 👩‍🏫 👋🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jika Anda terlibat dalam pengembangan frontend, maka Anda mungkin tahu mise-en-scene berikut: persyaratan proyek menyusut dengan cepat, manajemen Anda...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sudut: ketika Anda perlu melihat aplikasi, tetapi backend belum siap</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460109/">  Jika Anda terlibat dalam pengembangan frontend, maka Anda mungkin tahu mise-en-scene berikut: persyaratan proyek menyusut dengan cepat, manajemen Anda, atau pelanggan, atau keduanya, bersama-sama ingin melihat dengan mata mereka aplikasi yang berfungsi sekarang, bahkan dengan data palsu.  Pada saat yang sama, mungkin ada kembali, tetapi itu adalah lapisan api interaksi dengan bagian depan yang hilang dari kata sama sekali. <br><br>  Jadi, baru-baru ini saya menghadapi situasi seperti itu, dan saya mengembangkan ujung depan untuk sudut (orang-orang yang duduk di kursi menepuk dengan lambat, seseorang mengangguk penuh pengertian). <br><br>  Sekarang saya akan mencobanya dengan serius.  Di satu sisi, situasinya tidak biasa, dan banyak solusi dapat dipilih. <br><br>  Beberapa solusi muncul di benak: <br><br><ol><li>  Data tingkat komponen hardcode </li><li>  Data hardcode di tingkat layanan resolver, sematkan pada rute yang diperlukan </li><li>  Data hardcode di tingkat penyedia layanan data </li><li>  Siram api, dan, sesuai dengan kontrak yang disepakati, kembalikan data yang dikodekan dengan keras </li></ol><a name="habracut"></a><br>  Tetapi salah satu dari opsi-opsi ini tampaknya merupakan tongkat penyangga yang tidak ada habisnya, yang masing-masing memiliki kekurangan yang signifikan. <br><br><ol><li>  Opsi pertama menghilang segera - solusi yang sama sekali tidak nyaman, saat proyek berkembang, semuanya harus ditulis ulang. </li><li>  Solusi ini dapat terjadi, tetapi sekali lagi, struktur proyek dan logika komponen akan ditulis ulang. </li><li>  Opsi yang memungkinkan, Anda bahkan dapat mengembalikan data rintisan secara tidak sinkron, mensimulasikan panggilan server, namun, seperti pada solusi sebelumnya untuk masalah ini, pencegat kami (jika ada, tetapi ada) akan tidak berfungsi, dan ternyata tiruan pekerjaan dengan dukungan menjadi tidak lengkap. </li><li>  Opsi terakhir tampaknya cukup dapat diterima, tanpa masalah yang dimiliki opsi sebelumnya, tetapi saya tidak ingin menulis hardcode di proyek backend hanya karena alasan higienis. </li></ol><br>  Akibatnya, opsi lain dipilih: untuk meningkatkan server web yang terpisah, yang akan mengembalikan data sesuai dengan rute dan kontrak, dan mengonfigurasi konfigurasi terpisah dari perakitan dan pelaksanaan sudut.  Ternyata mudah untuk melakukan keduanya. <br><br>  Untuk mengimplementasikan server tiruan, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">express</a> dipilih. <br><br>  Mari kita mulai dengan itu. <br><br>  Kami memilih tempat di mana kami ingin menulis kode untuk server msk, misalnya, di direktori server mock di sebelah proyek ng. <br><br>  Selanjutnya, Anda perlu menginisialisasi proyek dan menambahkan paket dengan express. <br><br><pre><code class="bash hljs">npm init</code> </pre> <br><pre> <code class="bash hljs">npm install --save express</code> </pre> <br>  Selanjutnya, tambahkan kode yang akan mengembalikan data kepada kami.  Kami membuat file index.js, kami mengambil kode dari tutorial pertama. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"express"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> app = express(); app.get(<span class="hljs-string"><span class="hljs-string">"/url"</span></span>, (req, res, next) =&gt; { res.json([<span class="hljs-string"><span class="hljs-string">"Tony"</span></span>, <span class="hljs-string"><span class="hljs-string">"Lisa"</span></span>, <span class="hljs-string"><span class="hljs-string">"Michael"</span></span>, <span class="hljs-string"><span class="hljs-string">"Ginger"</span></span>, <span class="hljs-string"><span class="hljs-string">"Food"</span></span>]); }); app.listen(<span class="hljs-number"><span class="hljs-number">3000</span></span>, () =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"Server running on port 3000"</span></span>); });</code> </pre><br>  Mulai server <br><br><pre> <code class="bash hljs">node index.js</code> </pre> <br>  Periksa dengan tukang pos: <br><br><img src="https://habrastorage.org/webt/7_/bz/zs/7_bzzswc55urzohnwtqwbgxdvss.png"><br><br>  Semuanya super, server berfungsi.  Sekarang mari kita mengkonfigurasi salah satu rute, seolah-olah kita meminta data dari api nyata.  Katakanlah kita membutuhkan daftar semua buku, isi file books.json dengan buku <br><br><pre> <code class="json hljs">[ { <span class="hljs-attr"><span class="hljs-attr">"rn"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Jungle"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"wells"</span></span>: <span class="hljs-number"><span class="hljs-number">10042</span></span>, <span class="hljs-attr"><span class="hljs-attr">"default"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hidden"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"Admin"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"rn"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Main"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"wells"</span></span>: <span class="hljs-number"><span class="hljs-number">156</span></span>, <span class="hljs-attr"><span class="hljs-attr">"default"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hidden"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"User"</span></span> } ]</code> </pre> <br>  Dan perbarui file aplikasi: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"express"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> app = express(); app.get(<span class="hljs-string"><span class="hljs-string">"/api/book/"</span></span>, (req, res, next) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> books = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./books'</span></span>); res.json(books); }); app.listen(<span class="hljs-number"><span class="hljs-number">3000</span></span>, () =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"Server running on port 3000"</span></span>); });</code> </pre><br>  Dan periksa: <br><br><img src="https://habrastorage.org/webt/cm/xg/k7/cmxgk7jrdcm0gy1i7sellvpkk54.png"><br><br>  Bagus <br>  Sekarang mari kita mulai dengan aplikasi bersudut. <br>  Tambahkan konfigurasi yang menyimpan alamat ke belakang ke file environment / environment * .ts. <br>  lingkungan.ts: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> environment = { <span class="hljs-attr"><span class="hljs-attr">production</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">backend</span></span>: <span class="hljs-string"><span class="hljs-string">'http://localhost:5000/'</span></span> }</code> </pre><br>  environment.prod.ts <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> environment = { <span class="hljs-attr"><span class="hljs-attr">production</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">backend</span></span>: <span class="hljs-string"><span class="hljs-string">'http://localhost:5000/'</span></span> }</code> </pre><br>  Dalam mode normal, dan dalam mode prod dan mode pengembangan, kami akan mencari .net core api pada port 5000, seperti dijelaskan di atas.  Selanjutnya, kami menjelaskan konfigurasi untuk kembali sementara <br>  environment.mock.ts <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> environment = { <span class="hljs-attr"><span class="hljs-attr">production</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">backend</span></span>: <span class="hljs-string"><span class="hljs-string">'http://localhost:3000/'</span></span> }</code> </pre><br>  Di sini, seperti yang Anda lihat, kami mencari api di port 3000, di mana kami akan menjalankan express. <br><br>  Sekarang kita membutuhkan pencegat yang akan mengarahkan panggilan ke belakang ke server yang benar, tergantung pada konfigurasi. <br><br><pre> <code class="javascript hljs">@Injectable() <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RequestInterceptor</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HttpInterceptor</span></span></span><span class="hljs-class"> </span></span>{ baseUrl: string; <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseUrl = environment.backend; } intercept(req: HttpRequest&lt;any&gt;, <span class="hljs-attr"><span class="hljs-attr">next</span></span>: HttpHandler): Observable&lt;HttpEvent&lt;any&gt;&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> next.handle(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.modifyRequest(req)); } private modifyRequest = (req: HttpRequest&lt;any&gt;): HttpRequest&lt;any&gt; =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (req.url.startsWith(<span class="hljs-string"><span class="hljs-string">'api/'</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> url = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseUrl; req = req.clone({ <span class="hljs-attr"><span class="hljs-attr">url</span></span>: url + req.url }); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> req; } }</code> </pre><br>  Masih mengkonfigurasi konfigurasi baru untuk merakit dan meluncurkan aplikasi untuk bekerja dengan server tiruan. <br><br>  Untuk melakukan ini, kita perlu sedikit men-tweak angular.json. <br><br>  Di bagian proyek Anda, arsitek / build / konfigurasi, tambahkan konfigurasi tiruan build baru, dan jelaskan penggantian file lingkungan untuk konfigurasi ini.  Juga untuk mode servis, buat konfigurasi tiruan dan tentukan opsi build yang diinginkan <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"$schema"</span></span>: <span class="hljs-string"><span class="hljs-string">"./node_modules/@angular/cli/lib/config/schema.json"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"newProjectRoot"</span></span>: <span class="hljs-string"><span class="hljs-string">"projects"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"projects"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"your-project"</span></span>: { /*****/ <span class="hljs-attr"><span class="hljs-attr">"architect"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"build"</span></span>: { /*****/ <span class="hljs-attr"><span class="hljs-attr">"configurations"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"production"</span></span>: { /*****/ }, <span class="hljs-attr"><span class="hljs-attr">"mock"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"fileReplacements"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"replace"</span></span>: <span class="hljs-string"><span class="hljs-string">"src/environments/environment.ts"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"with"</span></span>: <span class="hljs-string"><span class="hljs-string">"src/environments/environment.mock.ts"</span></span> } ] } } }, <span class="hljs-attr"><span class="hljs-attr">"serve"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"builder"</span></span>: <span class="hljs-string"><span class="hljs-string">"@angular-devkit/build-angular:dev-server"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"options"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"browserTarget"</span></span>: <span class="hljs-string"><span class="hljs-string">"your-project:build"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"configurations"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"production"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"browserTarget"</span></span>: <span class="hljs-string"><span class="hljs-string">"your-project:build:production"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"mock"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"browserTarget"</span></span>: <span class="hljs-string"><span class="hljs-string">"your-project:build:mock"</span></span> } } } }, /*****/ } } }</code> </pre><br>  Itu saja, sekarang tetap menjalankan proyek dalam konfigurasi yang diinginkan <br><br><pre> <code class="bash hljs">ng serve --configuration=mock</code> </pre><br>  dan periksa di mana panggilan ke belakang terbang: <br><br><img src="https://habrastorage.org/webt/pv/0g/6c/pv0g6cvlskaypcfjswzgfoh3c2u.png"><br><br>  Semuanya bagus. <br><br>  Bahkan, desain ini masih akan banyak membantu kita ketika kita memperketat integrasi dan pengujian e2e ke proyek.  Saya akan mencoba menulis tentang ini dalam waktu dekat. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id460109/">https://habr.com/ru/post/id460109/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id460095/index.html">Tertangkap larangan fork deepNude di gitlab.com</a></li>
<li><a href="../id460097/index.html">Matriks memiliki Anda: ikhtisar proyek menggunakan MITER ATT & CK</a></li>
<li><a href="../id460099/index.html">Penerapan pembelajaran mesin otomatis ke jaringan saraf dengan arsitektur transformator</a></li>
<li><a href="../id460101/index.html">Operasi XSS berbasis cookie | $ 2300 cerita Bug Bounty</a></li>
<li><a href="../id460107/index.html">Sistem ISP, maafkan dan selamat tinggal! Mengapa dan bagaimana kami menulis panel kontrol server kami</a></li>
<li><a href="../id460111/index.html">Versi terbaru SAP Business One 9.3: apa yang telah berubah</a></li>
<li><a href="../id460113/index.html">Beberapa cerita dari kehidupan JSOC CERT, atau forensik Unbanal</a></li>
<li><a href="../id460115/index.html">Sepuluh tahun pemrograman di Erlang</a></li>
<li><a href="../id460117/index.html">Apakah pelanggan terbesar di Rusia jackpot besar atau sakit kepala? Pengalaman AGIMA</a></li>
<li><a href="../id460119/index.html">Kesalahan yang tidak ditemukan oleh analisis kode statis karena tidak digunakan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>