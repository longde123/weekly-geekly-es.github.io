<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßîüèø üéª üë®‚Äçüé§ Une petite contribution √† la lutte contre les plateformes de zoo Avalonia UI üëäüèæ üöï ü§∞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article est le r√©sultat de la v√©rification du projet d'interface utilisateur Avalonia √† l'aide de l'analyseur statique PVS-Studio. Avalonia UI est...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Une petite contribution √† la lutte contre les plateformes de zoo Avalonia UI</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/481598/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e34/9b1/06a/e349b106a7c1d3ea775353520b20cd91.png" alt="Figure 2"></div><br>  Cet article est le r√©sultat de la v√©rification du projet d'interface utilisateur Avalonia √† l'aide de l'analyseur statique PVS-Studio.  Avalonia UI est une plate-forme d'interface utilisateur open-source multiplateforme bas√©e sur XAML.  Il s'agit de l'un des projets les plus importants sur le plan technologique dans l'histoire de .NET, car il vous permet de cr√©er des interfaces multiplateformes bas√©es sur le syst√®me WPF.  J'esp√®re que cet article aidera les auteurs √† corriger certaines erreurs et √† les convaincre d'utiliser des analyseurs statiques √† l'avenir. <br><a name="habracut"></a><br><h2>  √Ä propos d'Avalonia UI </h2><br>  Le projet d'interface utilisateur Avalonia (anciennement appel√© Perspex) offre la possibilit√© de cr√©er des interfaces utilisateur qui s'ex√©cutent sur Windows, Linux et MacOS.  Il existe √©galement un support exp√©rimental pour Android et iOS pour le moment.  L'interface utilisateur d'Avalonia n'est pas un wrapper sur des wrappers, mais fait r√©f√©rence √† l'API native.  Contrairement √† Xamarin Forms, qui encapsule les wrappers Xamarin.  Dans l'une des vid√©os de d√©monstration, j'ai √©t√© frapp√© par la possibilit√© d'apporter le contr√¥le √† la console Debian.  De plus, le projet offre plus de fonctionnalit√©s pour la mise en page et la conception que les concepteurs d'interface conventionnels, gr√¢ce √† l'utilisation du balisage XAML. <br><br>  Les projets qui utilisent d√©j√† Avalonia UI incluent <a href="https://github.com/VitalElement/AvalonStudio">AvalonStudio</a> (un IDE multiplateforme pour le d√©veloppement en C # et C / C ++) et <a href="https://github.com/wieslawsoltes/Core2D">Core2D</a> (√©diteur de diagrammes et diagrammes 2D).  En tant que projet commercial, vous pouvez apporter un <a href="https://wasabiwallet.io/">portefeuille Wasabi</a> (portefeuille Bitcoin). <br><br>  La lutte contre la n√©cessit√© d'avoir plusieurs biblioth√®ques diff√©rentes lors de la cr√©ation d'une application multiplateforme est d'une grande importance.  Nous voulions aider le projet, et j'ai t√©l√©charg√© le projet et l'ai v√©rifi√© avec notre analyseur.  J'esp√®re que les auteurs pr√™teront attention √† cet article et apporteront les modifications n√©cessaires au code, ou introduiront peut-√™tre une analyse statique r√©guli√®re dans le processus de d√©veloppement.  Pour ce faire, ils peuvent profiter de l'option de licence gratuite de PVS-Studio pour les projets open source.  L'utilisation r√©guli√®re d'un analyseur statique permet d'√©viter de nombreux probl√®mes et r√©duit le co√ªt de d√©tection et de correction de nombreuses erreurs. <br><br><h2>  R√©sultats de validation </h2><br>  <b>PVS-Studio Warning:</b> <a href="https://www.viva64.com/ru/w/v3001/">V3001</a> Il existe des sous-expressions identiques 'contr√¥l√©eFlags' √† gauche et √† droite de l'op√©rateur '^'.  WindowImpl.cs 975TwitterClientMessageHandler.cs 52 <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateWMStyles</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Action change</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> style = (WindowStyles)GetWindowLong(....); .... style = style | controlledFlags ^ controlledFlags; .... }</code> </pre> <br>  Je vais commencer symboliquement par nos premiers diagnostics C #.  L'analyseur a d√©tect√© une utilisation √©trange de l'op√©rateur OR au niveau du bit.  Permettez-moi d'expliquer sur les chiffres ce qui se passe ici: <br><br>  expression <br><br><pre> <code class="cs hljs"><span class="hljs-number"><span class="hljs-number">1100</span></span> <span class="hljs-number"><span class="hljs-number">0011</span></span> | <span class="hljs-number"><span class="hljs-number">1111</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> ^ <span class="hljs-number"><span class="hljs-number">1111</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span></code> </pre> <br>  similaire √† ceci: <br><br><pre> <code class="cs hljs"><span class="hljs-number"><span class="hljs-number">1100</span></span> <span class="hljs-number"><span class="hljs-number">0011</span></span> | <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span></code> </pre> <br>  Un OU exclusif ("^") a une priorit√© plus √©lev√©e qu'un OU au niveau du bit ("|").  Tr√®s probablement, un ordre d'op√©rations diff√©rent √©tait impliqu√© ici.  Dans ce cas, vous devez prendre la premi√®re expression entre parenth√®ses: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateWMStyles</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Action change</span></span></span><span class="hljs-function">)</span></span> { .... style = (style | controlledFlags) ^ controlledFlags; .... }</code> </pre> <br>  Avant les deux prochains avertissements, je dois admettre: les faux positifs.  Cela est d√ª √† l'utilisation de l'API publique, la m√©thode <i>TransformToVisual</i> .  Dans notre cas, <i>VisualRoot est</i> toujours le parent de <i>visual</i> .  Je n'ai pas compris cela lors de l'analyse de la r√©ponse, m'a dit l'auteur du projet apr√®s avoir √©crit l'article.  Ainsi, les modifications propos√©es dans l'article ne visent pas √† se prot√©ger contre une chute r√©elle, mais contre une r√©vision potentielle qui briserait cette logique. <br><br>  <b>PVS-Studio Warning:</b> <a href="https://www.viva64.com/ru/w/v3080/">V3080 D√©r√©f√©rence</a> nulle possible de la valeur de retour de la m√©thode.  Pensez √† inspecter: TranslatePoint (...).  VisualExtensions.cs 23 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Point </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PointToClient</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> IVisual visual, PixelPoint point</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rootPoint = visual.VisualRoot.PointToClient(point); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> visual.VisualRoot.TranslatePoint(rootPoint, visual).Value; }</code> </pre> <br>  Une petite m√©thode.  L'analyseur consid√®re que le d√©r√©f√©rencement du r√©sultat d'un appel √† TranslatePoint n'est pas s√ªr.  Jetez un ≈ìil √† cette m√©thode: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Point? TranslatePoint(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> IVisual visual, Point point, IVisual relativeTo) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> transform = visual.TransformToVisual(relativeTo); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (transform.HasValue) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> point.Transform(transform.Value); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br>  En effet, il y a un retour <i>nul</i> . <br><br>  Cette m√©thode a 6 appels.  Dans trois cas, la valeur est v√©rifi√©e et, dans le reste, PVS-Studio d√©tecte un d√©r√©f√©rencement potentiel et √©met des avertissements.  J'ai cit√© le premier ci-dessus, et les deux autres avertissements sont ici: <br><br><ul><li>  <a href="https://www.viva64.com/ru/w/v3080/">V3080 D√©r√©f√©rence</a> nulle possible.  Pensez √† inspecter ¬´p¬ª.  VisualExtensions.cs 35 </li><li>  <a href="https://www.viva64.com/ru/w/v3080/">V3080 D√©r√©f√©rence</a> nulle possible.  Pensez √† inspecter ¬´controlPoint¬ª.  Scene.cs 176 </li></ul><br>  Je propose de le <i>corriger</i> par analogie en ajoutant la <i>v√©rification Nullable &lt;Struct&gt; .HasValue</i> √† l'int√©rieur de la m√©thode <i>PointToClient</i> <i>:</i> <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Point </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PointToClient</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> IVisual visual, PixelPoint point</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rootPoint = visual.VisualRoot.PointToClient(point); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rootPoint.HasValue) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> visual.VisualRoot.TranslatePoint(rootPoint, visual).Value; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> ....; }</code> </pre> <br>  <b>PVS-Studio Warning:</b> <a href="https://www.viva64.com/ru/w/v3080/">V3080 D√©r√©f√©rence</a> nulle possible de la valeur de retour de la m√©thode.  Pensez √† inspecter: TransformToVisual (...).  ViewportManager.cs 381 <br><br>  Un cas tr√®s similaire √† l'exemple pr√©c√©dent: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEffectiveViewportChanged</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TransformedBounds? bounds</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> transform = _owner.GetVisualRoot().TransformToVisual(_owner).Value; .... }</code> </pre> <br>  La m√©thode <i>TransformToVisual</i> ressemble √† ceci: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Matrix? TransformToVisual(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> IVisual <span class="hljs-keyword"><span class="hljs-keyword">from</span></span>, IVisual to) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> common = <span class="hljs-keyword"><span class="hljs-keyword">from</span></span>.FindCommonVisualAncestor(to); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (common != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { .... } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br>  Par ailleurs, la m√©thode <i>FindCommonVisualAncestor peut en</i> effet retourner <i>null</i> comme valeur par d√©faut pour les types de r√©f√©rence: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> IVisual </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindCommonVisualAncestor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> IVisual visual, IVisual target</span></span></span><span class="hljs-function">)</span></span> { Contract.Requires&lt;ArgumentNullException&gt;(visual != <span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ....FirstOrDefault(); }</code> </pre> <br>  La m√©thode <i>TransformToVisual</i> est utilis√©e √† neuf endroits; il y a des contr√¥les √† sept.  Le premier avertissement √† utiliser sans v√©rification est plus √©lev√©, et le dernier est ici: <br><br>  <a href="https://www.viva64.com/ru/w/v3080/">V3080 D√©r√©f√©rence</a> nulle possible.  Pensez √† inspecter ¬´transformer¬ª.  MouseDevice.cs 80 <br><br>  <b>Avertissement PVS-Studio: l'</b> expression <a href="https://www.viva64.com/ru/w/v3022/">V3022</a> est toujours vraie.  L'op√©rateur '&amp;&amp;' devrait probablement √™tre utilis√© ici.  NavigationDirection.cs 89 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsDirectional</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> NavigationDirection direction</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> direction &gt; NavigationDirection.Previous || direction &lt;= NavigationDirection.PageDown; }</code> </pre> <br>  √âtrange v√©rification.  Dans l'√©num√©ration <i>NavigationDirection</i> , il existe 9 types et <i>PageDown</i> est le dernier d'entre eux.  Ce n'√©tait peut-√™tre pas toujours le cas, ou s'agit-il d'une assurance contre l'apparition soudaine de nouvelles options de r√©f√©rence.  Il me semble que le premier ch√®que suffit ici.  Je laisserai la d√©cision aux auteurs du projet. <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://www.viva64.com/ru/w/v3066/">V3066</a> Ordre incorrect possible des arguments pass√©s au constructeur 'SelectionChangedEventArgs': 'removeSelectedItems' et 'addedSelectedItems'.  DataGridSelectedItemsCollection.cs 338 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> SelectionChangedEventArgs </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetSelectionChangedEventArgs</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SelectionChangedEventArgs (DataGrid.SelectionChangedEvent, removedSelectedItems, addedSelectedItems) { Source = OwningGrid }; }</code> </pre> <br>  Dans ce cas, l'analyseur a sugg√©r√© que les deuxi√®me et troisi√®me arguments du constructeur sont confus.  Regardons le constructeur appel√©: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SelectionChangedEventArgs</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">RoutedEvent routedEvent, IList addedItems, IList removedItems</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">routedEvent</span></span></span><span class="hljs-function">)</span></span> { AddedItems = addedItems; RemovedItems = removedItems; }</code> </pre> <br>  Deux conteneurs de type <i>IList sont</i> accept√©s, faciles √† m√©langer.  A en juger par le commentaire du d√©but du cours, il s'agit d'une erreur dans le code de contr√¥le copi√© depuis Microsoft et modifi√© sous Avalonia.  Mais il me semble qu'il vaut la peine de corriger l'ordre des arguments de la m√©thode, du moins de ne pas chercher une √©ventuelle erreur en soi lors de l'arriv√©e d'un rapport de bug. <br><br>  L'analyseur a trouv√© trois autres erreurs similaires: <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://www.viva64.com/ru/w/v3066/">V3066</a> Ordre incorrect possible des arguments pass√©s au constructeur 'SelectionChangedEventArgs': 'supprim√©' et 'ajout√©'.  AutoCompleteBox.cs 707 <br><br><pre> <code class="cs hljs">OnSelectionChanged(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SelectionChangedEventArgs(SelectionChangedEvent, removed, added));</code> </pre> <br>  M√™me constructeur <i>SelectionChangedEventArgs.</i> <br><br>  <a href="https://www.viva64.com/ru/w/v3066/">Avertissements du</a> <b>PVS-Studio</b> <a href="https://www.viva64.com/ru/w/v3066/">V3066</a> : <br><br><ul><li>  Ordre incorrect possible des arguments pass√©s au constructeur ¬´ItemsRepeaterElementIndexChangedEventArgs¬ª: ¬´oldIndex¬ª et ¬´newIndex¬ª.  ItemsRepeater.cs 532 </li><li>  Ordre incorrect possible des arguments pass√©s √† la m√©thode ¬´Update¬ª: ¬´oldIndex¬ª et ¬´newIndex¬ª.  ItemsRepeater.cs 536 </li></ul><br>  Deux op√©rations dans une m√©thode d'appel d'√©v√©nement. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnElementIndexChanged</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IControl element, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> oldIndex, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> newIndex</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ElementIndexChanged != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_elementIndexChangedArgs == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _elementIndexChangedArgs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ItemsRepeaterElementIndexChangedEventArgs(element, oldIndex, newIndex); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { _elementIndexChangedArgs.Update(element, oldIndex, newIndex); } ..... } }</code> </pre> <br>  L'analyseur a vu que dans les <i>deux ItemsRepeaterElementIndexChangedEventArgs</i> et dans la m√©thode <i>Update</i> , les arguments <i>oldIndex</i> et <i>newIndex</i> ont un ordre diff√©rent: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ItemsRepeaterElementIndexChangedEventArgs</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> IControl element, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> newIndex, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> oldIndex</span></span></span><span class="hljs-function">)</span></span> { Element = element; NewIndex = newIndex; OldIndex = oldIndex; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IControl element, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> newIndex, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> oldIndex</span></span></span><span class="hljs-function">)</span></span> { Element = element; NewIndex = newIndex; OldIndex = oldIndex; }</code> </pre> <br>  Peut-√™tre que le code a √©t√© √©crit par diff√©rents programmeurs, et pour l'un, il est plus important de savoir ce qui s'est pass√©, et pour l'autre - ce qui va arriver :) <br><br>  Comme dans le cas pr√©c√©dent, vous ne devez pas le modifier tout de suite, vous devez v√©rifier s'il y a vraiment une erreur. <br><br>  <b>PVS-Studio Warning:</b> <a href="https://www.viva64.com/ru/w/v3004/">V3004</a> L' <a href="https://www.viva64.com/ru/w/v3004/">instruction</a> 'then' est √©quivalente √† l'instruction 'else'.  DataGridSortDescription.cs 235 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> IOrderedEnumerable&lt;</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ThenBy</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IOrderedEnumerable&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; seq</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_descending) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> seq.ThenByDescending(o =&gt; GetValue(o), InternalComparer); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> seq.ThenByDescending(o =&gt; GetValue(o), InternalComparer); } }</code> </pre> <br>  Une impl√©mentation extr√™mement int√©ressante de la m√©thode <i>ThenBy</i> .  L'interface <i>IEnumerable</i> , dont l'h√©ritage <i>seq</i> est h√©rit√© <i>,</i> a une m√©thode <i>ThenBy</i> ;  Je suppose que son utilisation √©tait implicite.  Comme √ßa: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> IOrderedEnumerable&lt;</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ThenBy</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IOrderedEnumerable&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; seq</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_descending) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> seq.ThenByDescending(o =&gt; GetValue(o), InternalComparer); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> seq.ThenBy(o =&gt; GetValue(o), InternalComparer); } }</code> </pre> <br>  <b>Avertissement PVS-Studio:</b> <a href="https://www.viva64.com/ru/w/v3106/">V3106</a> Valeur d'index n√©gative possible.  La valeur de l'indice ¬´index¬ª pourrait atteindre -1.  Animator.cs 68 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> T </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InterpolationHandler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> animationTime, T neutralValue</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (kvCount &gt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (animationTime &lt;= <span class="hljs-number"><span class="hljs-number">0.0</span></span>) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (animationTime &gt;= <span class="hljs-number"><span class="hljs-number">1.0</span></span>) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index = FindClosestBeforeKeyFrame(animationTime); firstKeyframe = _convertedKeyframes[index]; } .... } .... }</code> </pre> <br>  L'analyseur estime que l' <i>indice</i> peut avoir une valeur de -1.  La variable est obtenue √† partir de la m√©thode <i>FindClosestBeforeKeyFrame</i> , regardez-la: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindClosestBeforeKeyFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> time</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; _convertedKeyframes.Count; i++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_convertedKeyframes[i].Cue.CueValue &gt; time) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> i - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Exception(<span class="hljs-string"><span class="hljs-string">"Index time is out of keyframe time range."</span></span>); }</code> </pre> <br>  Comme nous pouvons le voir, la condition est v√©rifi√©e dans la boucle et la valeur pr√©c√©dente de l'it√©rateur est retourn√©e.  La condition est assez difficile √† v√©rifier, et je ne peux pas dire exactement ce qu'est <i>CueValue</i> , mais selon la description, elle prend une valeur de 0,0 √† 1,0.  Nous pouvons dire quelque chose sur le <i>temps</i> , c'est <i>animationTime</i> de la m√©thode appelante, c'est certainement plus de z√©ro et moins d'un.  Sinon, l'ex√©cution du programme irait sur une branche diff√©rente.  S'il s'agit des m√©thodes appel√©es pour rendre l'animation, la situation ressemble √† un bon bug flottant.  J'ajouterais une v√©rification pour le r√©sultat de <i>FindClosestBeforeKeyFrame</i> si une manipulation sp√©ciale est n√©cessaire dans ce cas.  Ou - si le premier √©l√©ment ne remplit pas d'autres conditions - supprimez-le de la boucle.  Ne sachant pas comment tout cela devrait fonctionner, je choisirai la deuxi√®me option comme exemple de correction: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindClosestBeforeKeyFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> time</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; _convertedKeyframes.Count; i++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_convertedKeyframes[i].Cue.CueValue &gt; time) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> i - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Exception(<span class="hljs-string"><span class="hljs-string">"Index time is out of keyframe time range."</span></span>); }</code> </pre> <br>  <b>Avertissement PVS-Studio: le</b> param√®tre constructeur "t√©l√©phones" <a href="https://www.viva64.com/ru/w/v3117/">V3117</a> n'est pas utilis√©.  Country.cs 25 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Country</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> region, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> population, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> area, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> density, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> coast, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">? migration, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">? infantMorality, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> gdp, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">? literacy, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">? phones, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">? birth, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">? death</span></span></span><span class="hljs-function">)</span></span> { Name = name; Region = region; Population = population; Area = area; PopulationDensity = density; CoastLine = coast; NetMigration = migration; InfantMortality = infantMorality; GDP = gdp; LiteracyPercent = literacy; BirthRate = birth; DeathRate = death; }</code> </pre> <br>  Un bon exemple de la diff√©rence entre le fonctionnement de l'analyseur et la r√©vision manuelle du code.  Treize arguments constructeurs, un non utilis√©.  En fait, Visual Studio note √©galement un argument inutilis√©, mais au troisi√®me niveau d'avertissements (ils sont souvent d√©sactiv√©s).  Dans ce cas, il s'agit d'une erreur √©vidente, car la classe poss√®de √©galement treize propri√©t√©s pour chaque argument, et aucune valeur n'est affect√©e nulle part dans les <i>t√©l√©phones</i> .  Le montage est √©vident, je ne l'apporterai pas. <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://www.viva64.com/ru/w/v3080/">V3080 D√©r√©f√©rence</a> nulle possible.  Pensez √† inspecter ¬´tabItem¬ª.  TabItemContainerGenerator.cs 22 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> IControl </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateContainer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> item</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tabItem = (TabItem)<span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.CreateContainer(item); tabItem.ParentTabControl = Owner; .... }</code> </pre> <br>  L'analyseur consid√©rait qu'il √©tait dangereux de d√©r√©f√©rencer le r√©sultat de l'appel de <i>CreateContainer</i> . <br><br>  Jetez un ≈ìil √† cette m√©thode: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> IControl </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateContainer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> item</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> container = item <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> T; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (container != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> container; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } }</code> </pre> <br>  L'analyseur peut voir l'affectation de <i>null</i> √† une variable m√™me lors du passage d'une valeur √† travers une cha√Æne de cinquante m√©thodes.  Mais il ne peut pas dire si l'ex√©cution se fera sur ce fil au moins une fois.  Oui, et je ne pouvais pas non plus, en g√©n√©ral ... Les appels de m√©thode sont perdus parmi les m√©thodes surcharg√©es et virtuelles.  Je sugg√®re donc juste d'√™tre en s√©curit√© avec une v√©rification suppl√©mentaire: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> IControl </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateContainer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> item</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tabItem = (TabItem)<span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.CreateContainer(item); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(tabItem == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; tabItem.ParentTabControl = Owner; .... }</code> </pre> <br>  <b>Avertissement PVS-Studio:</b> V3142 Code inaccessible d√©tect√©.  Il est possible qu'une erreur soit pr√©sente.  DevTools.xaml.cs 91 <br><br>  Je n'√©crirai pas beaucoup de code ici pour cr√©er une intrigue, je dirai tout de suite: l'avertissement est faux.  L'analyseur a vu un appel √† une m√©thode qui l√®ve une exception inconditionnelle.  Le voici: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Load</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> obj</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XamlLoadException(<span class="hljs-string"><span class="hljs-string">$"No precompiled XAML found for </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{obj.GetType()}</span></span></span><span class="hljs-string">, make sure to specify x:Class and include your XAML file as AvaloniaResource"</span></span>); }</code> </pre> <br>  Il √©tait impossible de ne pas faire attention √† trente-cinq avertissements (!) √Ä propos du code inaccessible situ√© apr√®s les appels √† cette m√©thode.  J'ai demand√© √† l'un des d√©veloppeurs du projet: comment √ßa marche?  Et ils m'ont parl√© d'un moyen de remplacer les appels d'une m√©thode par des appels d'autres en utilisant la biblioth√®que <a href="https://www.mono-project.com/docs/">Mono.Cecil</a> .  Il vous permet de remplacer les appels directement dans le code IL. <br><br>  L'analyseur ne prend pas en charge cette biblioth√®que, par cons√©quent, nous avons de nombreux faux positifs, il est donc pr√©f√©rable de d√©sactiver ces diagnostics sur ce projet.  C'est un peu g√™nant d'admettre, c'est moi qui ai fait ce diagnostic ... mais, comme tout outil, l'analyse statique doit √™tre configur√©e. <br><br>  Par exemple, nous d√©veloppons actuellement des diagnostics sur la conversion de type non s√©curis√©e.  Et cela donne un peu moins d'un millier d'op√©rations sur le projet de jeu, dans lequel le contr√¥le de frappe est effectu√© c√¥t√© moteur. <br><br>  <b>Avertissement PVS-Studio:</b> <a href="https://www.viva64.com/ru/w/v3009/">V3009</a> Il est √©trange que cette m√©thode renvoie toujours une seule et m√™me valeur de ¬´vrai¬ª.  DataGridRows.cs 412 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ScrollSlotIntoView</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> slot, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> scrolledHorizontally</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (.....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DisplayData.FirstScrollingSlot &lt; slot &amp;&amp; DisplayData.LastScrollingSlot &gt; slot) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DisplayData.FirstScrollingSlot == slot &amp;&amp; slot != <span class="hljs-number"><span class="hljs-number">-1</span></span>) { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } .... } .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br>  La m√©thode renvoie toujours <i>true</i> .  Peut-√™tre que le but de la m√©thode a chang√© depuis que la signature a √©t√© √©crite, mais c'est probablement une erreur.  Il s'agit √©galement de la classe de contr√¥le copi√©e √† partir de Microsoft, √† en juger par le commentaire au d√©but de la classe.  √Ä mon avis, <i>DataGrid</i> est g√©n√©ralement l'un des contr√¥les les plus instables, et il me semble que cela vaut la peine d'√™tre consid√©r√©, est-il n√©cessaire de confirmer le d√©filement s'il ne remplit pas les conditions? <br><br><h2>  Conclusion </h2><br>  Certaines de ces erreurs ont √©t√© introduites dans le projet non pas par les d√©veloppeurs de l'interface utilisateur d'Avalonia eux-m√™mes, mais par du code copi√© √† partir des contr√¥les WPF.  Cependant, pour l'utilisateur de l'interface, la source de l'erreur ne joue g√©n√©ralement pas de r√¥le.  Une interface plant√©e ou d√©fectueuse g√¢che l'opinion de l'ensemble du programme. <br><br>  Dans l'article, j'ai mentionn√© la n√©cessit√© de configurer l'analyseur, il y a des faux positifs qui sont in√©vitables en raison des principes de fonctionnement des algorithmes d'analyse statique.  Quiconque conna√Æt le <a href="https://en.wikipedia.org/wiki/Halting_problem">probl√®me de l'arr√™t est</a> conscient des limites math√©matiques lors de l'utilisation d'un autre code.  Mais dans ce cas, nous parlons de d√©sactiver un diagnostic sur presque cent cinquante.  Nous ne parlons donc pas de la perte de sens dans l'analyse statique (ou la question n'en vaut pas la peine).  De plus, ce diagnostic aurait pu avoir de bonnes r√©ponses, il est juste plus difficile √† trouver parmi la masse des faux positifs. <br><br>  N'oubliez pas de noter la haute qualit√© du code du projet!  J'esp√®re que les d√©veloppeurs maintiendront le rythme et le niveau de qualit√© du code.  Malheureusement, plus le projet est volumineux, plus il contient de bogues.  Une des fa√ßons possibles de r√©duire les bogues est de configurer correctement CI \ CD, avec la connexion d'analyses statiques et dynamiques.  Et si vous souhaitez simplifier le travail avec de grands projets et r√©duire le temps n√©cessaire au d√©bogage, <a href="https://www.viva64.com/ru/pvs-studio-download/">t√©l√©chargez et essayez</a> PVS-Studio! <br><br><p> <a href="https://www.viva64.com/en/b/0701/"><img src="https://habrastorage.org/getpro/habr/post_images/c78/30f/70c/c7830f70c5577c3d6704f254d7cad6a3.png" align="left"></a> </p><br><br>  Si vous souhaitez partager cet article avec un public anglophone, veuillez utiliser le lien vers la traduction: Alexander Senichkin.  <a href="https://www.viva64.com/en/b/0701/">Notre petite contribution √† la lutte d'Avalonia UI pour moins de plateformes</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr481598/">https://habr.com/ru/post/fr481598/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr481586/index.html">Tendances Tech Ecommerce 2020: l'√®re des technologies immersives</a></li>
<li><a href="../fr481588/index.html">Les exercices pour isoler Runet ont commenc√©. Allons-nous surveiller?</a></li>
<li><a href="../fr481592/index.html">Six options de cadeaux du Nouvel An pour un automobiliste avec une bonne remise</a></li>
<li><a href="../fr481594/index.html">D√©veloppement d'un ¬´g√©n√©rateur de tension simple¬ª selon GOST R IEC 61508 (IEC 61508)</a></li>
<li><a href="../fr481596/index.html">Analyse des param√®tres ELK 7.5 pour l'analyse des journaux Mikrotik</a></li>
<li><a href="../fr481600/index.html">Moteur Wiki Bonsai Family: R√©sultats 2019</a></li>
<li><a href="../fr481604/index.html">Comment les d√©veloppeurs de Chelyabinsk durs cr√©ent des jeux pour Google Play et les r√©seaux sociaux</a></li>
<li><a href="../fr481606/index.html">Abonnement statique √† l'aide du mod√®le Observer √† l'aide de C ++ et du microcontr√¥leur Cortex M4</a></li>
<li><a href="../fr481610/index.html">PostgreSQL Antipatterns: mise √† jour d'une grande table en charge</a></li>
<li><a href="../fr481612/index.html">Notre petite contribution √† la lutte d'Avalonia UI pour moins de plateformes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>