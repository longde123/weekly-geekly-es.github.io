<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóëÔ∏è üòÉ ‚õ∫Ô∏è Arbeiten Sie mit Custom-Reifen Komplex Redd üëè üëÉüèø ‚≠êÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Im letzten Artikel haben wir uns damit vertraut gemacht, wie man mit bekannten Standardreifen im Redd-Komplex arbeiten kann. Danach habe ich versproch...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Arbeiten Sie mit Custom-Reifen Komplex Redd</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483724/"> Im <a href="https://habr.com/ru/post/477662/">letzten Artikel haben</a> wir uns damit vertraut gemacht, wie man mit bekannten Standardreifen im Redd-Komplex arbeiten kann. Danach habe ich versprochen, weiterzumachen, wie man Zugang zu exotischeren Reifen erh√§lt.  Aber nachdem ich mit ein paar Bekannten gesprochen hatte, wurde mir pl√∂tzlich klar, dass nicht jeder den Artikel las, der au√üerhalb dieses Zyklus √ºber den Redd-Komplex geschrieben wurde.  Und dementsprechend wei√ü nicht jeder, warum diese Reifen √ºberhaupt in den Komplex aufgenommen wurden.  Sie k√∂nnen sich nat√ºrlich nur auf <a href="https://habr.com/ru/post/440156/">diesen Artikel</a> beziehen, aber es scheint mir richtiger zu sein, den entsprechenden Teil mit Bezug auf das Thema dieses bestimmten Zyklus zu wiederholen.  Daher werden wir uns heute nicht nur mit praktischen, sondern auch mit theoretischen Fragen zu den vom Redd-Komplex verkauften Reifen befassen. <br><br><img src="https://habrastorage.org/webt/af/-c/vx/af-cvxucoo4l55__goxrdffbbtc.png"><br><a name="habracut"></a><br><h2>  Langweiliger theoretischer Teil </h2><br><h3>  Was werden wir ber√ºcksichtigen </h3><br>  Lassen Sie uns kurz (so weit wie m√∂glich) einige theoretische Fragen durchgehen, um klar zu verstehen, warum alles auf die eine oder andere Weise im Redd-Komplex abl√§uft.  Zun√§chst die Hauptaufgabe des Komplexes ... Seltsamerweise habe ich im Rahmen dieser Artikelserie noch nie dar√ºber geschrieben.  Ja, und ich habe nicht vor zu schreiben.  Tatsache ist, dass die Hauptaufgabe ein gemeinsamer Fernzugriff auf das Debuggen bestimmter Hardware ist (von Mikrocontrollern bis zu riesigen Mehrkernprozessorsystemen).  Reservierung der Arbeitszeit, Bereitstellung des physischen Zugangs √ºber Kan√§le von durchschnittlicher M√ºdigkeit (und nicht nur ideal) und andere Freuden.  Das Debuggen kann √ºber JTAG oder √ºber andere Tools erfolgen, die von Entwicklungsumgebungen bereitgestellt werden.  Ein gro√ües Team arbeitet daran, alles ist dort sehr interessant, aber ich mag keine B√ºrokratie, deshalb m√∂chte ich nicht √ºber diese Themen schreiben.  Vielleicht f√ºllt in Zukunft jemand anderes diese L√ºcke ... In der Zwischenzeit schreibe ich √ºber die <b>Hilfswerkzeuge</b> des Komplexes. <br><br>  Ja, ja, alles, was ich seit mehr als sechs Monaten beschreibe, ist nur etwas, das Entwicklern <b>helfen soll</b> . <br><br><div class="spoiler">  <b class="spoiler_title">Vorherige Zyklusartikel</b> <div class="spoiler_text"><ol><li>  <a href="https://habr.com/ru/post/452656/">Entwicklung der einfachsten ‚ÄûFirmware‚Äú f√ºr in Redd installierte FPGAs und Debugging am Beispiel des Speichertests.</a> </li><li>  <a href="https://habr.com/ru/post/453682/">Entwicklung der einfachsten "Firmware" f√ºr in Redd installierte FPGAs.</a>  <a href="https://habr.com/ru/post/453682/">Teil 2. Programmcode.</a> </li><li>  <a href="https://habr.com/ru/post/454938/">Entwicklung eines eigenen Kerns zur Einbettung in ein FPGA-basiertes Prozessorsystem.</a> </li><li>  <a href="https://habr.com/ru/post/456008/">Entwicklung von Programmen f√ºr den Zentralprozessor Redd am Beispiel des Zugangs zum FPGA.</a> </li><li>  <a href="https://habr.com/ru/post/462253/">Die ersten Versuche mit dem Streaming-Protokoll am Beispiel der Verbindung von CPU und Prozessor im FPGA des Redd-Komplexes.</a> </li><li>  <a href="https://habr.com/ru/post/464795/">Frohe Quartusel, oder wie der Prozessor zu einem solchen Leben gekommen ist.</a> </li><li>  <a href="https://habr.com/ru/post/467353/">Code-Optimierungsmethoden f√ºr Redd.</a>  <a href="https://habr.com/ru/post/467353/">Teil 1: Cache-Effekt.</a> </li><li>  <a href="https://habr.com/ru/post/468027/">Code-Optimierungsmethoden f√ºr Redd.</a>  <a href="https://habr.com/ru/post/468027/">Teil 2: Nicht zwischengespeicherter Speicher und Parallelbusbetrieb.</a> </li><li>  <a href="https://habr.com/ru/post/469985/">Umfassende Codeoptimierung: Austausch eines Taktgenerators zur Verbesserung der Systemleistung.</a> </li><li>  <a href="https://habr.com/ru/post/477662/">Zugriff auf auf FTDI-Controllern implementierte Redd-Busse</a> </li></ol><br></div></div><br><h3>  Warum im Redd-Komplex Standardreifen zum Einsatz kommen </h3><br>  Sehr oft muss man Ger√§te entwickeln, ohne selbst darauf zugreifen zu k√∂nnen.  Schauen wir uns ein konkretes Beispiel f√ºr ein Projekt an, das nette Links hat.  Hier sind zum Beispiel meine Lieblingshubschrauber.  Wir sind hier und Hubschrauber sind in Schweden.  Dar√ºber hinaus haben wir die Entwicklung im Winter angeordnet, als Hubschrauber die von uns f√ºr sie implementierten Funktionen (D√ºngung des Bodens in den W√§ldern: der Boden befand sich zu dieser Zeit unter Schneeverwehungen) physisch nicht ausf√ºhren konnten.  Es stellt sich heraus, dass die im Hubschrauber installierten Ger√§te beim Debuggen und Fliegen emuliert werden m√ºssen - virtuell. <br><br>  Aber das ist Debuggen.  Beim Testen eines Projekts ist die Emulation die einzige Option.  Der Tester sollte alles in der maximalen Anzahl von Modi pr√ºfen und verschiedene Kombinationen sortieren.  Au√üerdem muss er Situationen mit kritischen und Notfallsituationen schaffen (so eine zerst√∂rerische Arbeit f√ºr Tester).  Wie mache ich das mit realer Ausr√ºstung?  Nur auf Emulatoren. <br><br>  Wie l√§uft die Kommunikation mit modernen Ger√§ten?  Normalerweise - √ºber Standardbusse, weil Ger√§teentwickler dazu neigen, √ºber etwas zu verbinden, das den Verbrauchern bereits bekannt ist.  Das ist nur Redd und wird als Emulator f√ºr viele Ger√§te fungieren.  Seine Busse sind mit dem ausgebauten Block verbunden.  Und die Einheit wird sicher sein, dass sie mit realer Ausr√ºstung funktioniert, ohne zu wissen, dass sich am anderen Ende der Reifen nicht ein Haufen Eisen befindet, sondern der Redd-Komplex, auf dem sich eine Reihe von Emulatoren drehen. <br><br>  Bei der Arbeit mit realer Ausr√ºstung k√∂nnen Reifen als Analysatoren fungieren und die Arbeit mit realer Hardware protokollieren, um Fl√ºge im Falle von Problemen zu analysieren. <br><br>  Im Allgemeinen sollte es so viele Reifen wie m√∂glich geben und deren Satz sollte so unterschiedlich wie m√∂glich sein.  Allerdings muss man in allem das Ma√ü kennen.  Wenn auch nur, weil jeder Bus etwas Geld kostet und Platz in der Tasche und auch am Stecker einnimmt.  √úberlegen wir uns nun, mit welchen Strategien diese Busse am besten programmgesteuert gesteuert werden. <br><br><h3>  Wer wird die Entwicklung von Code f√ºr Redd f√ºhren </h3><br>  In modernen Unternehmen steht His Majesty Man-Hour im Vordergrund.  Tatsache ist, dass dies in vielerlei Hinsicht eine sehr teure Ressource ist (Geld, Entwicklungszeit, Verf√ºgbarkeit eines Spezialisten zu diesem bestimmten Zeitpunkt f√ºr diese und andere Aufgaben des Unternehmens usw.). Wenn das Management also Stunden einsparen kann, wird es dies tun.  Wenn Entwickler nicht zum Team hinzugef√ºgt werden k√∂nnen, werden sie nicht hinzugef√ºgt.  Wenn es m√∂glich ist, alles in k√ºrzerer Zeit zu erledigen, werden die Entwickler ausgeschaltet, damit sie es in k√ºrzerer Zeit erledigen k√∂nnen. <br><br>  Daraus folgt, dass es unwahrscheinlich ist, dass einzelne Spezialisten Emulatoren schreiben.  In diesem Fall handelt es sich um normale Programmierer, die in derselben Firma arbeiten. <br><br>  Warum schreibe ich das?  In einigen Artikeln wird es als schick angesehen, wenn f√ºr die Wartung von Nicht-Standard-Reifen einige Spezialsprachen verwendet werden.  Ich hatte die Chance, mit so etwas zu arbeiten.  Lassen Sie mich meine Eindr√ºcke am Beispiel von Dingen beschreiben, die jemals ver√∂ffentlicht wurden.  Hier zum Beispiel <a href="https://www.astrosoft.ru/about/clients/bvg-group/case-959/" rel="nofollow">https://www.astrosoft.ru/about/clients/bvg-group/case-959/</a> .  Dar√ºber hinaus ist die GOST-Sprache k√ºrzlich sogar als GOST herausgekommen.  Meine Meinung ist: Was in den sp√§ten 70ern - fr√ºhen 80ern notwendig war, wurde am Ende des ersten Viertels des 21. Jahrhunderts absolut nicht ben√∂tigt.  Hier ist ein wunderbarer Artikel von Konstantin Chizhov, in dem das Wichtigste dieser Sprache (Kontaktgruppen) perfekt und fast kostenlos durch Metaprogrammierung in C ++ implementiert ist. <a href="http://easyelectronics.ru/rabota-s-portami-vvoda-vyvoda-mikrokontrollerov-na-si.html" rel="nofollow">Http://easyelectronics.ru/rabota-s-portami-vvoda-vyvoda-mikrokontrollerov-na- si.html</a> .  Dieser Artikel √ºberpr√ºft alles f√ºr AVR.  Ich habe die Bibliotheksoption f√ºr Cortex M genauestens √ºberpr√ºft. Die Ergebnisse sind auch erstaunlich.  Optimierer packen alles so, dass eine direkte Entwicklung in Assembler keinen Gewinn bringt.  Und das gilt nicht nur f√ºr Kontaktgruppen, sondern generell f√ºr alle Fahrer von mcucpp.  Es ist nur schade, dass die Beh√∂rden diese Ideologie nicht in das MAX RTOS aufgenommen haben, so dass die Forschungsergebnisse nicht in die Ver√∂ffentlichung eingingen.  Aber zu Hause benutze ich nur diese Bibliothek. <br><br>  Alle anderen Dinge, die in YASTEK implementiert sind, sind ebenfalls perfekt in das C ++ - Konstrukt gepackt.  Interaktivit√§t f√ºr den Betreiber an der Kreuzung der siebziger und achtziger Jahre war dies jedoch nicht.  Es stimmt, es war nicht in den damaligen Compilern von Pascal, C und anderen Sprachen.  Meistens waren die Compiler Batch-Compiler und generierten einfach Assemblertext ohne Debugging-Tools.  Bei dem YASTEC-Remake haben wir Operatoren f√ºr die Ausgabe von Daten auf dem Bildschirm und sogar einen interaktiven Debugger hinzugef√ºgt. Dies sind jedoch nur die halben Sachen vor dem Hintergrund dessen, was in vorgefertigten Entwicklungsumgebungen f√ºr gew√∂hnliche Programmiersprachen geschieht.  Kurz gesagt, die Zeiten, in denen es technische Gr√ºnde gab, die spezielle Sprache von YASTEK zu verbessern, waren lange vorbei.  Heute kann man in einer gemeinsamen Programmiersprache dasselbe und noch viel mehr erreichen. <br><br>  Jemand k√∂nnte sagen, dass es nicht C ++ - Experten waren, die den Code dort geschrieben haben, sondern gew√∂hnliche Customizer ... So ist das, aber ich habe bereits bemerkt, dass gew√∂hnliche Programmierer den Code f√ºr Redd schreiben werden.  Es macht keinen Sinn, dass die Gesch√§ftsf√ºhrung einen engen Spezialisten f√ºr die gelegentlichen Aufgaben h√§lt.  Und es macht f√ºr einen normalen Fachmann keinen Sinn, eine andere Sprache zu lernen. <br><br>  Und welche weiteren Ausdrucksmerkmale wird dies haben?  Wenn Sie Emulatoren entwickeln, ben√∂tigen Sie m√∂glicherweise ganz exotische Dinge.  F√ºr den GPS-Emulator im interaktiven Modus steuern wir beispielsweise mit dem Joystick.  Welche problemorientierte Sprache unterst√ºtzt sie?  Und die Flexibilit√§t dieser Sprachen ist immer noch.  Schlie√ülich ist die Wiederverwendung des Codes im besprochenen YESTEK nicht gleichzusetzen, sondern die Suche nach vorgefertigten L√∂sungen im Netzwerk ... Selbst in g√§ngigen Sprachen ist es nicht nur ein <b>gutes</b> Beispiel, sondern auch exotisch. <br><br>  Gleiches gilt f√ºr einen <a href="https://www.astrosoft.ru/about/clients/cassel-aero/case-786/" rel="nofollow">solchen Fall</a> , der sich reibungslos in einen <a href="https://www.astrosoft.ru/about/clients/cassel-aero/case-787/" rel="nofollow">solchen</a> <a href="https://www.astrosoft.ru/about/clients/cassel-aero/case-786/" rel="nofollow">Fall</a> verwandelt hat.  Im Rahmen der Unternehmensautomatisierung ist SIMATIC mit seinem fortschrittlichen Konfigurations- und Programmiersystem gut, aber f√ºr ein kleines Projekt verursachte es mehr Probleme als es l√∂ste, daher wurde es durch eine universellere L√∂sung ersetzt. <br><br><blockquote>  Insgesamt kommen wir zu dem Schluss, dass die Arbeit gew√∂hnlicher Programmierer in ihren √ºblichen Sprachen f√ºr Redd normal ist.  F√ºr andere Aufgaben - es wird diskutiert, und speziell f√ºr Hilfsaufgaben, die vom Redd-Komplex gel√∂st werden, ist es normal. </blockquote><br><br><h3>  So setzen Sie Reifen ein </h3><br>  Wenn wir jedoch sagen, dass normale Programmierer die Reifen in ihren √ºblichen Sprachen verwenden, sollten die Bibliotheken f√ºr die Arbeit mit diesen Bussen so typisch wie m√∂glich sein.  Insbesondere wurde der Satz sofort notiert: "Und lassen Sie uns Mikrocontroller in den Komplex einbauen, und Programmierer werden alles darauf schreiben."  Diese Option erfordert wiederum Spezialisten f√ºr diese Steuerungen.  Au√üerdem ist eine ernsthafte Synchronisation zwischen den Subsystemen erforderlich.  Es wurde beschlossen, dass der Programmierer nach M√∂glichkeit auf dem vertrauten PC-Zentralprozessor arbeiten sollte.  "Aber was ist mit FPGAs?" Sie fragen.  Hoppla, wahrscheinlich ist allen aufgefallen, dass ich f√ºr FPGAs die Ideologie "minimale Entwicklung auf Verilog, maximale Vertrautheit mit Programmierern" gew√§hlt habe.  Dort k√∂nnen Sie es nicht bequemer machen.  Aber wir arbeiten hart. <br><br>  Also typische Reifenimplementierungen.  Mit UART ist alles klar.  Bei SPI / I <sup>2</sup> C wurden verschiedene Optionen in Betracht gezogen, da es f√ºr PCs de facto keinen etablierten Standard gibt.  Es bestand jedoch der Wunsch, auf die M√∂glichkeit zu verzichten, ein vollst√§ndiges Set zu schreiben: "Firmware" des Controllers, des Treibers und der Bibliotheken.  Ich wollte etwas fertig machen.  Dennoch haben wir uns bis zuletzt die Option mit Mikrocontrollern √ºberlegt, die auf USB-Ebene einen a la Debugger von Cypress implementieren.  Der Grund daf√ºr waren die im <a href="https://habr.com/ru/post/437112/">Artikel √ºber DMA</a> beschriebenen Funde.  Es ist unm√∂glich, die im TOR angeforderte Bandbreite zu garantieren, wenn alle Busse mit zuvor unbekannten Datenstr√∂men gleichzeitig arbeiten.  Und auf mehrere Controller verteilt - wir setzen auf die Bandbreite von USB 2.0 FS.  Daher nur FTDI-Br√ºcken.  Eine Bridge ist eine Funktion, und USB 2.0 HS bietet Bandbreite. <br><br>  √úbrigens habe ich mich im letzten Abschnitt immer auf die g√§ngige C ++ - Sprache bezogen.  Tatsache ist, dass dies zu diesem Zeitpunkt meines Lebens meine wichtigste Programmiersprache ist (obwohl dies nicht immer der Fall war).  Aber Standardl√∂sungen, sie sind Standardl√∂sungen, um perfekt in anderen heute gebr√§uchlichen Sprachen zu funktionieren, sei es Python, Java oder etwas anderes.  Wenn also ein Spezialist f√ºr diese Sprachen in die Schlacht geworfen wird, wird er mit diesen Sprachen alles nicht weniger leicht machen.  Das ist das Sch√∂ne an universellen L√∂sungen. <br><br>  Aber es gibt ein paar Reifen, die dumm sind, teure FTDI-Chips draufzulegen.  Wir werden dar√ºber sprechen, wie sie im Komplex implementiert werden. <br><br><h2>  Tausend kleine Dinge </h2><br><h3>  Warum hat der Redd-Komplex eine geschaltete SD-Karte? </h3><br>  Einige in der Entwicklung befindliche Ger√§te aktualisieren ihre ‚ÄûFirmware‚Äú mithilfe einer SD-Karte.  In den meisten F√§llen wird die ‚ÄûFirmware‚Äú in Form einer Datei auf die Karte geschrieben. Danach schaltet sich das Ger√§t aus und erkennt beim Einschalten die Aktualisierungsdatei und wendet sie an.  Ich habe k√ºrzlich eine neue Platine f√ºr einen meiner 3D-Drucker verwendet.  Dort √∂ffnete die "Firmware" von Marlin 2.0 nach einigen M-Befehlen (ich erinnere mich nicht an den genauen Code) den Inhalt der SD √ºber den USB-Bus, sodass ich Updates ohne Tricks einspielen konnte.  Ich verband mich √ºber USB, nachdem ich wusste, dass ich den Strom aus / einschaltete (wie man es mit Hilfe des Redd-Komplexes macht, den wir im <a href="https://habr.com/ru/post/477662/">vorherigen Artikel untersucht haben</a> ), gab den Befehl, die SD-Karte an USB anzuschlie√üen, wartete auf das Erscheinen der Festplatte, f√ºllte die ‚ÄûFirmware‚Äú aus, schaltete den Strom aus / ein und wartete .  Die Firmware wurde aktualisiert.  Aber nicht alles ist so sch√∂n.  Manchmal muss eine SD-Karte im Voraus vorbereitet werden.  √úbrigens, wenn Sie die "Firmware" -Kurve zum 3D-Drucker hinzuf√ºgen, funktioniert die oben beschriebene ideale Option ebenfalls nicht und Sie m√ºssen die Karte auch im Voraus vorbereiten.  Und machen Sie bei der Entwicklung eine nicht funktionierende ‚ÄûFirmware‚Äú - ein paar Kleinigkeiten. <br><br>  F√ºr diesen Fall verf√ºgt der Redd-Komplex √ºber eine geschaltete SD-Karte.  Auf dem elektrischen Schaltplan ist es wie folgt enthalten: <br><br><img src="https://habrastorage.org/webt/9e/su/xj/9esuxjssl9kznrnz4dodepejj9k.png"><br><br>  Zuerst haben wir versucht, eine typische L√∂sung zu finden, mit der der SDIO-Bus (nicht SPI, dh SDIO-Ger√§te k√∂nnen auch √ºber diese Schnittstelle arbeiten) √ºber FPGA umgeschaltet werden kann.  Es stellte sich heraus, dass es keine sch√∂ne L√∂sung gibt.  Selbst L√∂sungen von FPGA-Herstellern sind komplex und wenig glaubw√ºrdig.  Daher wurden analoge Schl√ºssel mitgeliefert, mit denen die Karte entweder an einen externen Anschluss oder als Teil von Redd an ein Leseger√§t angeschlossen werden kann.  Daher lautet der Betriebsalgorithmus wie folgt: Mit einem Leseger√§t verbunden, Dateien unter Linux vorbereitet, Mit dem Zielger√§t verbunden.  Wir nutzen dort. <br><br>  Da die Arbeit mit dem Dateisystem nicht zu den kritischen Dingen geh√∂rt (wir bereiten nur die Daten vor, sodass keine besondere Geschwindigkeit erforderlich ist), wurde beschlossen, ein Leseger√§t auf Basis des Mikrocontrollers STM32F103 zu entwickeln.  Unterst√ºtzung f√ºr Full SDIO gibt es nur in der Maximalversion dieses Chips.  Und da dieser Controller viele freie Kontakte hat, wurde beschlossen, andere langsame Funktionen auf ihnen auszuf√ºhren.  Betrachten Sie ein Fragment eines elektrischen Schaltplans, aus dem die Liste hervorgeht. <br><br><img src="https://habrastorage.org/webt/q_/lt/lq/q_ltlqt32trstidfnkm7aeffhtw.png"><br><br>  Tats√§chlich werden Signale, die sich auf das Umschalten zwischen SDIO und SD-Karte beziehen, rot hervorgehoben.  Wir betrachten nun die verbleibenden Hintergrundfarben. <br><br><h3>  SPI-Flash-Laufwerk </h3><br>  Die zweite g√§ngige Technik zum Aktualisieren der ‚ÄûFirmware‚Äú von Zielger√§ten ist ein SPI-Flash-Laufwerk.  Heutzutage ist dies zunehmend nicht SPI, sondern Quad-SPI.  Das Prinzip ist dasselbe.  F√ºllte die Daten, schloss das Flash-Laufwerk an das Ger√§t an und schaltete es ein.  Der Bootstrap-Mechanismus "saugt" die Firmware beim Start in den Arbeitsspeicher. <br><br>  Das gleiche Schema wird hier angewendet - mit analogen Schaltern: <br><br><img src="https://habrastorage.org/webt/l8/zn/v_/l8znv_7bcjtawlsxmrfbypheab0.png"><br><br>  Nun, die Zeilen, die sich auf die Arbeit mit einem Flash-Laufwerk beziehen, wurden gr√ºn hervorgehoben. <br><br><h3>  Niedrige Halbleiterrelais </h3><br>  In regelm√§√üigen Abst√§nden entsteht die Aufgabe, das Dr√ºcken von Tasten am Ger√§t zu simulieren.  Eine typische Situation: Tester m√ºssen die Funktion des Men√ºs des Zielger√§ts √ºberpr√ºfen.  Nein, wenn Sie alle Punkte durchgehen k√∂nnen, aber wenn die Entwickler √Ñnderungen vornehmen?  Um den Vorgang zu automatisieren, ist es besser, wenn die Schaltfl√§chen zum Navigieren im Men√º automatisch erstellt werden (Screenshots k√∂nnen entweder vom Betriebssystem auf dem Zielger√§t oder durch Scannen des zum Display f√ºhrenden Busses mit dem Sniffer zum FPGA erstellt werden).  Nun, es gibt viele andere Aufgaben, bei denen Sie einen Tastendruck programmgesteuert simulieren m√ºssen.  Hierzu werden der Schaltung Halbleiterrelais hinzugef√ºgt: <br><br><img src="https://habrastorage.org/webt/uf/4g/yo/uf4gyofip5mjrwxmejjm96l0i5w.png"><br><br>  ... und ihre Kontrolllinien wurden blau hervorgehoben. <br><br><h3>  Konfigurieren von USB-SPI / I <sup>2</sup> C-Bridges </h3><br>  In einem fr√ºheren Artikel habe ich festgestellt, dass FTDI-Br√ºcken, auf denen SPI- und I <sup>2</sup> C-Busse implementiert sind, Steuerbereiche CFG0 und CFG1 haben.  Im Allgemeinen muss h√∂chstwahrscheinlich niemand seine Standardwerte √§ndern (alle Nullen). Falls erforderlich, verlassen die Leitungen, die diese Signale steuern, auch den betreffenden STM32-Controller und wurden violett hervorgehoben. <br><br><h3>  USB-Ger√§t zur√ºckgesetzt </h3><br>  W√§hrend der Entwicklung des Systems wurde entschieden, dass die Ger√§te rein theoretisch ‚Äûeinfrieren‚Äú k√∂nnten.  Zum Beispiel hatten FTDI-Br√ºcken der ersten Serie die Eigenschaft, mit instabilem ‚ÄûBoden‚Äú ‚Äûeinzufrieren‚Äú.  Ja, das war vor √ºber zehn Jahren.  Ja, innerhalb des Komplexes ist die Erde extrem stabil, da sich die Br√ºcke im selben Geb√§ude befindet wie der Computer.  Aber pl√∂tzlich.  Generell wurde im ToR die M√∂glichkeit festgelegt, eines der Ger√§te zur√ºckzusetzen.  Entsprechende Anforderungen werden von demselben STM32-Controller generiert und gelb hervorgehoben. <br><br><h2>  Programmatischer Zugriff auf die STM32-Steuerung </h2><br>  Wie Sie sehen, sind die meisten der oben beschriebenen Ger√§te nicht Standard.  Genauer gesagt, die meisten von ihnen k√∂nnen als GPIO klassifiziert werden, aber es gibt de facto keinen Standard daf√ºr.  Der schwierigste Teil der Ger√§te ist der SD-Kartenleser.  Aus diesem Grund wurde beschlossen, die SD Reader-Funktionalit√§t auf dem STM32-Controller zu implementieren (zum Gl√ºck k√∂nnen Sie in der STM Cube MX-Umgebung nur einige Zeilen Ihres eigenen Codes schreiben) und den Rest der Funktionen als Vendor-Anforderungen an das dem Reader zugrunde liegende Massenspeicherger√§t zu implementieren.  Aber wie vor einigen Artikeln entschieden wurde, sind die gro√üen Erz√§hlungen zum Lesen ungeeignet.  Daher werden beim n√§chsten Mal die Prinzipien des Sendens von Befehlen an das Massenspeicherger√§t von Linux und Beispiele f√ºr den programmgesteuerten Zugriff auf das resultierende Ger√§t untersucht. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de483724/">https://habr.com/ru/post/de483724/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de483714/index.html">Preise und Wettbewerbe f√ºr innovative Projekte. Erfahrung der Weltverk√§ufer</a></li>
<li><a href="../de483716/index.html">Verwenden des Vulnerability Scanners in in GitlabCI verwendeten Abh√§ngigkeitspr√ºfungsbibliotheken</a></li>
<li><a href="../de483718/index.html">Wie VDI die B√ºroumgebung ver√§ndert</a></li>
<li><a href="../de483720/index.html">Was brachte uns Pandas 1.0</a></li>
<li><a href="../de483722/index.html">Geoanalytik f√ºr den Einzelhandel, Teil 1: Wir automatisieren den Prozess der Standortwahl f√ºr ein Unternehmen. 2GIS + MS Azure + ML</a></li>
<li><a href="../de483726/index.html">Vanille JavaScript und HTML. Keine Frameworks. Keine Bibliotheken. Kein Problem</a></li>
<li><a href="../de483730/index.html">Programmers Union 2: Slippers h√∂rte auf zu lachen und wurde nachdenklich</a></li>
<li><a href="../de483732/index.html">Lesen Sie die sichere Firmware vom STM32F1xx-Flash mit ChipWhisperer</a></li>
<li><a href="../de483734/index.html">Welchen Preis zahlen wir f√ºr die Verwendung von async / await in JS / C # / Rust?</a></li>
<li><a href="../de483736/index.html">Reverse Image Search: Ein Leitfaden von Bellingcat Detective Agency</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>