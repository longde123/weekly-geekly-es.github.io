<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤞🏽 🎬 🕙 24小时Rust游戏：个人发展经验 🧔 👩🏻‍🚀 🥄</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在本文中，我将谈谈我在Rust中开发小型游戏的个人经历。 创建工作版本大约需要24小时（我主要在晚上或周末工作）。 游戏还远远没有结束，但我认为这种体验会很有用。 我将告诉您我从中学到的知识以及从头开始制作游戏时的一些观察。 

 Skillbox建议：两年实践课程“我是PRO Web开发人员” 。...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>24小时Rust游戏：个人发展经验</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skillbox/blog/444364/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/019/753/9bf/0197539bf7364b198561856cd6dfd961.png" alt="图片"></div><br> 在本文中，我将谈谈我在Rust中开发小型游戏的个人经历。 创建工作版本大约需要24小时（我主要在晚上或周末工作）。 游戏还远远没有结束，但我认为这种体验会很有用。 我将告诉您我从中学到的知识以及从头开始制作游戏时的一些观察。 <br><a name="habracut"></a><br><blockquote>  <b>Skillbox建议：</b>两年实践课程<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“我是PRO Web开发人员”</a> 。 <br><br>  <b>我们提醒您：</b> <i>对于所有“ Habr”读者来说，使用“ Habr”促销代码注册任何Skillbox课程时均可享受10,000卢布的折扣。</i> </blockquote><br><h3> 为什么生锈？ </h3><br> 我选择这种语言是因为我听到了很多关于它的好东西，并且看到它在游戏开发领域越来越流行。 在编写游戏之前，我几乎没有在Rust中开发简单应用程序的经验。 这足以在编写游戏时感到一定的自由。 <br><br><h3> 为什么是游戏，又是什么样的游戏？ </h3><br> 制作游戏很有趣！ 由于更多原因，我希望这样做，但是对于“家庭”项目，我选择的主题与我的日常工作不太相关。 什么样的游戏？ 我想做一些类似网球模拟器的事情，将城市天际线，动物园大亨，监狱建筑师和网球本身结合在一起。 总的来说，结果是一场有关网球学院的比赛，人们来此比赛。 <br><br><h3> 技术培训 </h3><br> 我想使用Rust，但是我不完全知道我需要如何“从头开始”。 我不想编写像素着色器并使用拖放功能，所以我一直在寻找最灵活的解决方案。 <br><br> 找到了我与您分享的有用资源： <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">我们还</a>玩游戏吗？游戏开发所需的Rust元素列表； </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Rust游戏开发者subreddit;</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">免费像素艺术。</a> </li></ul><br> 我探索了几个Rust游戏引擎，最终选择了Piston和ggez。 在上一个项目中工作时，我遇到了他们。 最后，我选择了ggez，因为它似乎更适合实现小型2D游戏。 对于新手开发人员（或第一次与Rust合作的人），Piston的模块化结构过于复杂。 <br><br><h3> 游戏结构 </h3><br> 我花了一些时间思考这个项目的架构。 第一步是建造“土地”，人民和网球场。 人们必须在法院四处走动并等待。 玩家必须具备随着时间而提高的技能。 另外，应该有一个允许您添加新朋友和法院的编辑器，但这不再是免费的。 <br><br> 考虑一切，我开始工作。 <br><br><h3> 游戏创作 </h3><br>  <b>开始于：圆圈和抽象</b> <br><br> 我以ggez为例，在屏幕上画了一个圆圈。 好厉害 现在是一些抽象。 在我看来，忽略游戏对象的想法真是太好了。 必须按照此处指示的方式渲染和更新每个对象： <br><br><pre><code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// the game object trait trait GameObject { fn update(&amp;mut self, _ctx: &amp;mut Context) -&gt; GameResult&lt;()&gt;; fn draw(&amp;mut self, ctx: &amp;mut Context) -&gt; GameResult&lt;()&gt;; } // a specific game object - Circle struct Circle { position: Point2, } impl Circle { fn new(position: Point2) -&gt; Circle { Circle { position } } } impl GameObject for Circle { fn update(&amp;mut self, _ctx: &amp;mut Context) -&gt; GameResult&lt;()&gt; { Ok(()) } fn draw(&amp;mut self, ctx: &amp;mut Context) -&gt; GameResult&lt;()&gt; { let circle = graphics::Mesh::new_circle(ctx, graphics::DrawMode::Fill, self.position, 100.0, 2.0)?; graphics::draw(ctx, &amp;circle, na::Point2::new(0.0, 0.0), 0.0)?; Ok(()) } }</span></span></code> </pre> <br> 这段代码使我获得了一个极好的对象列表，可以在同样出色的循环中更新和渲染这些对象。 <br><br><pre> <code class="rust hljs">mpl event::EventHandler <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> MainState { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, context: &amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> Context) -&gt; GameResult&lt;()&gt; { <span class="hljs-comment"><span class="hljs-comment">// Update all objects for object in self.objects.iter_mut() { object.update(context)?; } Ok(()) } fn draw(&amp;mut self, context: &amp;mut Context) -&gt; GameResult&lt;()&gt; { graphics::clear(context); // Draw all objects for object in self.objects.iter_mut() { object.draw(context)?; } graphics::present(context); Ok(()) } }</span></span></code> </pre> <br>  main.rs是必需的，因为它包含所有代码行。 我花了一些时间来分离文件并优化目录结构。 这是所有事情的开始： <br><br>  <i>资源-&gt;这是所有资产所在的位置（图片）</i> <i><br></i>  <i>src</i> <i><br></i>  <i>-实体</i> <i><br></i>  <i>-game_object.rs</i> <i><br></i>  <i>-circle.rs</i> <i><br></i>  <i>-main.rs-&gt;主循环</i> <br><br>  <b>人，楼层和图像</b> <br><br> 下一步是创建一个Person游戏对象并加载图像。 一切都应基于大小为32 * 32的图块。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/642/4c6/65c/6424c665cb9442c5471a49d987954880.png"><br><br>  <b>网球场</b> <br><br> 研究了网球场的外观后，我决定用4 * 2的瓷砖制作它们。 最初，可以制作此大小的图像，或者一起制作8个单独的图块。 但是后来我意识到只需要两个唯一的磁贴，这就是为什么。 <br><br> 总共，我们有两个这样的图块：1和2。 <br><br> 球场的每个部分都由图块1或图块2组成。它们可以照常布置，也可以上下颠倒180度。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/26d/de1/e6f/26dde1e6f7ec2459c89752754a048c04.png"><br><br>  <b>主要施工方式（组装）</b> <br><br> 在设法完成网站，人物和地图的渲染之后，我意识到还需要一种基本的构建模式。 它的实现是这样的：按下按钮时，将选择对象，然后单击将其放置在正确的位置。 因此，按钮1允许您选择一个球场，按钮2允许您选择一个球员。 <br><br> 但是您仍然需要记住1和2的含义，因此我添加了线框，以便清楚地选择了哪个对象。 这是它的外观。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e96/63d/e17/e9663de17e6b402f43cab61e3905c874.gif"></div><br>  <b>有关架构和重构的问题</b> <br><br> 现在我有几个游戏对象：人，法院和地板。 但是，为了使线框起作用，您需要告诉对象的每个实体，对象本身是否处于演示模式，或者是否简单绘制了框架。 这不是很方便。 <br><br> 在我看来，我需要重新考虑体系结构，以便发现一些限制： <br><br><ul><li> 显示和更新自身的实体的存在是一个问题，因为该实体将无法“知道”其应呈现的内容-图像和线框； </li><li> 缺少用于在各个实体之间交换属性和行为的工具（例如is_build_mode属性或呈现行为）。 可以使用继承，尽管在Rust中没有正常的实现方法。 我真正需要的是布局。 </li><li> 需要一种实体之间相互作用的工具来将人员分配到法院； </li><li> 实体本身是数据和逻辑的混合，很快就失去了控制。 </li></ul><br><blockquote>  <i>我进行了进一步的研究，发现了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ECS</a>架构<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-实体组件系统</a> ，该<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">系统</a>在游戏中普遍使用。</i>  <i>以下是ECS的优势：</i> <i><br><br></i> <ul><li> 数据与逻辑分离； </li><li> 布局而不是继承； </li><li> 面向数据的体系结构。 </li></ul></blockquote><br>  ECS具有三个基本概念： <br><br><ul><li> 实体-标识符所指的对象类型（可以是玩家，球或其他东西）； </li><li> 组件-实体由它们组成。 一个示例是渲染组件，布局等。 它是一个数据仓库； </li><li> 系统-它们同时使用对象和组件，还包含基于此数据的行为和逻辑。 一个示例是一个渲染系统，该系统使用要渲染的组件在所有实体上进行迭代并参与渲染。 </li></ul><br> 经过研究，很明显，ECS解决了以下问题： <br><br><ul><li> 对实体的系统组织使用布局而不是继承； </li><li> 消除由于控制系统导致的代码哈希； </li><li> 使用is_build_mode之类的方法将线框的逻辑存储在渲染系统中的同一位置。 </li></ul><br> 这是实施ECS之后发生的事情。 <br><br>  <i>资源-&gt;这是所有资产所在的位置（图片）</i> <i><br></i>  <i>src</i> <i><br></i>  <i>-组件</i> <i><br></i>  <i>-position.rs</i> <i><br></i>  <i>-人</i> <i><br></i>  <i>-Tennis_court.rs</i> <i><br></i>  <i>-floor.rs</i> <i><br></i>  <i>-wireframe.rs</i> <i><br></i>  <i>-mouse_tracked.rs</i> <i><br></i>  <i>-资源</i> <i><br></i>  <i>-mouse.rs</i> <i><br></i>  <i>-系统</i> <i><br></i>  <i>-rendering.rs</i> <i><br></i>  <i>-constants.rs</i> <i><br></i>  <i>-utils.rs</i> <i><br></i>  <i>-world_factory.rs-&gt;世界工厂函数</i> <i><br></i>  <i>-main.rs-&gt;主循环</i> <br><br><h3> 分配人到法院 </h3><br>  ECS使生活更轻松。 现在，我有了一种系统的方法，将数据添加到实体并基于该数据添加逻辑。 反过来，这使得有可能通过法院组织人员的分配。 <br><br> 我做了什么： <br><br><ul><li> 向Person添加有关分配法院的数据； </li><li> 向TennisCourt添加了有关分布式人员的数据； </li><li> 添加了CourtChoosingSystem，该系统使您可以分析人员和站点，找到可用的法院并向其分发玩家； </li><li> 添加了PersonMovementSystem系统，该系统搜索分配给法院的人员，如果不在现场，则在必要时将其发送给人员。 </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7b0/c8e/c95/7b0c8ec951007ad4d5895716c3ca7618.gif"></div><br><h3> 总结一下 </h3><br> 我非常喜欢这款简单的游戏。 而且，我很高兴用Rust编写它，因为： <br><br><ul><li>  Rust提供了您所需的东西； </li><li> 他有出色的文档，Rust非常优雅。 </li><li> 恒久性很酷； </li><li> 您不必求助于克隆，复制或其他类似操作，而我在C ++中经常这样做； </li><li> 选件非常方便工作，还可以完美地处理错误。 </li><li> 如果可以编译该项目，则99％的项目可以正常运行，并且完全可以完成。 在我看来，编译器错误消息是我所看到的最好的消息。 </li></ul><br>  Rust上的游戏开发才刚刚开始。 但是已经有一个稳定而庞大的社区致力于向所有人开放Rust。 因此，我乐观地看待语言的未来，期待我们共同工作的结果。 <br><br><blockquote>  <b>Skillbox建议：</b> <br><br><ul><li> 在线课程<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“专业前端开发人员”</a> 。 </li><li> 实用课程<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ Mobile Developer PRO”</a> 。 </li><li> 年度实践课程<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ PHP开发人员从0到PRO”</a> 。 </li></ul><br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN444364/">https://habr.com/ru/post/zh-CN444364/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN444352/index.html">Kontur.Kampus：我们邀请您参观圣彼得堡附近的工业发展免费学生营</a></li>
<li><a href="../zh-CN444356/index.html">React教程第24部分：第二形式课</a></li>
<li><a href="../zh-CN444358/index.html">可枚举：如何产生业务价值</a></li>
<li><a href="../zh-CN444360/index.html">不公正的Google Play是美好的生活体验</a></li>
<li><a href="../zh-CN444362/index.html">Unity和Havok开发新的物理引擎</a></li>
<li><a href="../zh-CN444366/index.html">研讨会“信息安全要求：企业如何与之共存”</a></li>
<li><a href="../zh-CN444368/index.html">我们只是在实验室的3D打印机上打印了麦克风-然后会有完整的科幻小说</a></li>
<li><a href="../zh-CN444370/index.html">Mini PCI-e格式有什么功能？</a></li>
<li><a href="../zh-CN444372/index.html">使用强化学习进行远程机器定向</a></li>
<li><a href="../zh-CN444374/index.html">赶时髦的人的影响：为什么不合格者经常看起来一样</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>