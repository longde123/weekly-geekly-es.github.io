<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏫 🥟 🌆 Comment battre le clic dans Y. Direct et AdWords pour 600 mille roubles par mois 🤴🏾 🧦 ⏮️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Au cours des six derniers mois, nous avons réussi à vaincre le «clic» de notre publicité contextuelle avec un budget de 1 million de roubles par mois....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment battre le clic dans Y. Direct et AdWords pour 600 mille roubles par mois</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423335/">  Au cours des six derniers mois, nous avons réussi à vaincre le «clic» de notre publicité contextuelle avec un budget de 1 million de roubles par mois. <br><br>  La clé pour vaincre la fraude était la surveillance par minute du trafic avec des notifications de changements anormaux et la désactivation des annonces problématiques par API, et un certain nombre de rapports qui reflètent la situation en temps réel. <br><br><img src="https://habrastorage.org/webt/ss/cg/tk/sscgtkndx4m1wahkipwk1ozgxwk.png"><br>  <font color="#7c8792">Figure 1. Graphique du nombre de visiteurs par mots-clés par décamines</font> <br><br><h2>  <font color="#3e6c9a">Comment savez-vous que vous êtes attaqué?</font> </h2><br>  <b>L'un des premiers signes d'un "clic" de la publicité sera une augmentation du pourcentage de remboursements pour fraude dans Yandex.Direct et AdWords.</b> <br><blockquote>  «Dans Yandex Direct, les frais de fraude sont automatiquement reversés au solde de la campagne publicitaire.  Le nombre de clics éliminés par le système anti-fraude est affiché dans les rapports "statistiques quotidiennes" "statistiques générales" sur la ligne "clics invalides pour toute la période sélectionnée". </blockquote>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Aidez J. à diriger les "clics invalides"</a> . <br><br>  Dans AdWords, l'affichage du niveau des "clics incorrects" peut être activé dans l'onglet "Colonnes": <br><br><img src="https://habrastorage.org/webt/kf/0y/sp/kf0ysp3nbfkov-ypcrfcc1sbmgw.png"><br>  <font color="#7c8792">Figure 2. Colonnes personnalisées avec un niveau de "clic non valide" dans AdWords</font> <br><br>  Dans notre cas, avec un niveau moyen de « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">clics invalides</a> » dans Yandex.Direct ≈ 10%, Yandex a soudainement commencé à reverser 40% du budget publicitaire, et après un mois, 54% du tout. <br><a name="habracut"></a><br>  <b>Le prochain signe de fraude est une augmentation déraisonnable du nombre de transitions et de forts changements dans les indicateurs de comportement pour un certain nombre de groupes d'annonces.</b> <br><br>  Nous avons remarqué que pour un certain nombre de mots clés qui n'ont jamais eu plus de 200 visiteurs par jour, des pointes pouvant atteindre 3 000 visiteurs sont soudainement apparues.  En fait, le budget, à l'époque de ces activités, pouvait aller à une seule campagne de publicité s'il n'était pas arrêté à temps. <br><br><img src="https://habrastorage.org/webt/dy/dj/37/dydj375imemm0ytnqa6ttkesya8.png"><br>  <font color="#7c8792">Figure 3. Croissance déraisonnable du trafic pour un groupe d'annonces particulier dans Direct</font> <br><br><h2>  <font color="#3e6c9a">Yandex et Google ne protègent pas contre la fraude</font> </h2><br>  Il suffit de lire la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">discussion sur le niveau de fraude dans la publicité contextuelle</a> dans le Direct Club officiel pour s'assurer que de nombreux annonceurs perdent de l'argent à cause de la fraude. <br><br>  Google reconnaît officiellement les erreurs de son système de sécurité et fournit aux annonceurs des «Demandes de remboursement» (retour sur budget).  Selon les statistiques du service ClickSease, Google Ads retourne en moyenne 12% du budget publicitaire. <br><br><div class="spoiler">  <b class="spoiler_title">Comment rembourser une partie de l'argent pour un clic via AdWords</b> <div class="spoiler_text">  Vous devez envoyer une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">réclamation concernant les "clics incorrects"</a> à Adwords, après quoi vous serez remboursé de ≈ 12% de l'argent dépensé.  De plus, le service ClickSease envoie automatiquement des demandes de remboursement similaires tous les 2 mois à Google. <br><br>  Dans notre cas, Google AdWords a d'abord reconnu 18% de notre trafic comme " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">non valide</a> " et a renvoyé l'argent pour eux, et lorsque nous avons envoyé la réclamation "demandes de remboursement", Google a remboursé 13% supplémentaires du budget. <br></div></div><br>  Yandex ne reconnaît pas la vulnérabilité de ses propres filtres de protection et les plaintes concernant les cas de fraude évidents, envoie un modèle de réponse indiquant que le problème réside avec l'annonceur et son site. <br><br>  Dans notre cas, le pourcentage de «clics incorrects» dans le rapport de Y. Direct n'a jamais dépassé les 50% convoités pour aucune des campagnes publicitaires, même au moment des explosions les plus violentes, lorsque 80% du budget «a fusionné» dans le groupe d'annonces généralement peu populaire sans appels. et applications. <br><br><img src="https://habrastorage.org/webt/6h/4u/ef/6h4uefov0nkyjh0n3wpuii9qb0q.png"><br>  <font color="#7c8792">Figure 4. Niveau de "clics incorrects" dans l'une des campagnes de Direct</font> <br><br><h2>  <font color="#3e6c9a">Quel niveau d'attaque avons-nous rencontré?</font> </h2><br>  Le trafic de fraude a été dirigé vers quatre secteurs d'activité dans deux villes.  Lors de la connexion de nouvelles campagnes publicitaires ou du lancement de campagnes interrompues depuis longtemps, le «clic» leur a également été redistribué en quelques heures. <br><br>  La fraude aux clics n'était pas liée au temps, et la redistribution du budget, par exemple la nuit, n'a eu aucun effet: nous avons toujours notre volume de trafic restant.  Le "clic" était également actif dans le YAN, sur la recherche Yandex et sur le Réseau Display de Google. <br><br>  Sur le site, les robots simulaient le comportement des utilisateurs, parcouraient les sections du site, sélectionnaient le texte, faisaient défiler et déplaçaient naturellement le curseur. <br><br><h2>  <font color="#3e6c9a">Existe-t-il des remèdes prêts à l'emploi?</font> </h2><br>  Tous les services de protection contre la fraude aux clics ne disposent que d'un seul outil de lutte directe - cela bloque les adresses IP ou les sites de placement suspects dans les campagnes Ya.Direct et AdWords. <br><br>  Dans le cas où des IP dynamiques sont utilisées contre vous, tout service de contrôle de la fraude aux clics sera toujours un pas derrière les escrocs pour les bloquer par IP: le bot fera déjà plusieurs clics sur votre annonce au moment où le service met cette IP sur liste noire. et arrêter de diffuser des annonces dessus.  De plus, une fois qu'un logiciel frauduleux ne pourra pas voir vos annonces, il modifiera simplement l'adresse IP, le Hardware-ID et poursuivra ses actions. <br><br>  Lorsque vous attaquez des annonces sur le GDN ou le YAN, divers emplacements sont généralement utilisés et les systèmes de protection automatique ne peuvent pas détecter les sites suspects à bloquer. <br><br>  Revenons au blocage IP - nous arrivons à la partie la plus intéressante: si AdWords vous permet de bloquer jusqu'à 500 adresses IP, <u>Yandex Direct ne peut bloquer que 25 adresses IP uniques</u> par campagne publicitaire!  Une telle petite liste noire d'adresses IP n'est plus pertinente, car vous pouvez désormais acheter en toute sécurité 500 adresses IPv4 pour 10 000 roubles et contourner cette limitation. <br><br>  Il existe deux façons de vous protéger contre les «clics» de haut niveau: <br><br><ol><li>  apprendre à ne pas montrer de publicités à des utilisateurs ou des robots frauduleux, pour lesquels vous devez trouver certains «modèles» dans leur comportement et leurs caractéristiques; <br></li><li>  arrêter temporairement des groupes d'annonces et des mots clés spécifiques ciblés. <br></li></ol><br><h2>  <font color="#3e6c9a">Coupez une partie de l'auditoire pour en sauver la plupart</font> </h2><br>  Si vous apprenez à ne pas montrer de publicité par clic aux robots ou aux utilisateurs frauduleux, ils ne pourront pas nuire. <br><br>  Vous pouvez toujours suivre des modèles de comportement et des modèles similaires, par exemple, que la fraude s'exécute généralement sur Windows 7 de 5h00 à 9h00 à Moscou, et définir l'ajustement des enchères sur -100% pour un public similaire dans toutes les campagnes publicitaires attaquées.  La fonctionnalité des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ajustements</a> des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">enchères dans AdWords est</a> assez étendue, ce qui ne peut pas être dit des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ajustements dans Yandex Direct</a> . <br><br><h3>  Nous recherchons des modèles de fraude par le biais des services de sécurité </h3><br>  Afin d'avoir une idée de la façon exacte dont ils nous attaquent et de suivre manuellement les tendances du trafic frauduleux, nous avons connecté le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">service</a> anti-fraude russe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ClickFrog</a> .  Le produit est connu de tous depuis longtemps, populaire dans l'environnement CPA et ainsi de suite. <br><br>  ClickFrog a rapidement prouvé un handicap complet: <br><br><ol><li>  par jour, pas plus de 40 adresses IP suspectes allouées, avec un trafic provenant de Direct à 3 000 000 clics par jour et, même reconnu par Yandex, 1 300 clics «à gauche» par jour; <br></li><li>  le principal outil pour protéger le service est le blocage par adresse IP, dont la commande est envoyée via l'API à J. Direct, cependant, dès que la liste noire de 25 adresses IP est remplie, vous devez supprimer manuellement les dernières IP de chaque campagne publicitaire et attendre que la prochaine liste soit remplie, et donc en cercle. <br></li></ol><br>  Ensuite, nous avons installé le code de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ClickSease</a> , un service américain destiné à AdWords et ne fonctionnant pas encore avec Yandex.Direct.  Le service a d'ailleurs, contrairement à ClickFrog, une période d'essai gratuite de 2 semaines. <br><br>  ClickSease s'est avéré plus utile: il a commencé à capturer 300 à 400 adresses IP frauduleuses uniques par jour.  Pour chaque service IP bloqué donne des statistiques: <br><br><ul><li>  Fournisseur d'accès Internet </li><li>  la plate-forme à partir de laquelle la transition s'est produite; </li><li>  système d'exploitation </li><li>  ID d'appareil unique </li><li>  heure de la première et de la dernière transition; </li><li>  région. </li></ul><br>  À partir du rapport ClickSease, nous avons pu identifier les modèles de fraude: <br><ul><li>  dans 81% des cas, l'appareil simule un OS mobile: Android ou iOS; </li><li>  dans 59% des cas, la géolocalisation de l'adresse IP ne s'applique pas à Moscou, avec une fraude dirigée vers Moscou. </li></ul><br><h3>  Recherche manuelle des modèles de fraude </h3><br>  Cependant, même de tels modèles évidents n'étaient pas suffisants pour réduire les dommages causés par la fraude, et je ne voulais pas désactiver les annonces mobiles.  Les services ne peuvent généralement donner que des idées pour identifier des schémas similaires de fraude, puis vous devez détecter la fraude dans Metric (en cas d'attaque sur Direct) et la sélectionner dans un segment d'audience Yandex distinct pour une analyse et un blocage supplémentaires. <br><br><img src="https://habrastorage.org/webt/p3/op/ya/p3opya9dpzuhirhhz0_wfdeywf8.png"><br>  <font color="#7c8792">Figure 5. Exemple d'analyse du trafic par groupes d'âge dans la métrique pour rechercher des modèles de fraude</font> <br><br>  Tranches de trafic pour aider à identifier les modèles de fraude: <br><ul><li>  dynamique du public par groupes d'âge; </li><li>  dynamique des intérêts à long terme des utilisateurs; </li><li>  dynamique de l'appareil et du système d'exploitation. </li></ul><br>  <b>Dans le cas d'AdWords, la contre-mesure est claire:</b> <br><br><ol><li>  nous définissons un segment d'audience «infecté» par la fraude; </li><li>  Nous avons fixé des ajustements d'enchères de -100% pour le segment sélectionné; </li><li>  Nous suivons l'évolution des indicateurs: conversion, temps passé sur le site, profondeur de visionnage, taux de rebond. </li></ol><br>  <b>Dans Yandex Direct, les mécanismes de lutte sont plus complexes et sont divisés en deux options:</b> <br><br>  a) vous avez réussi à trouver un schéma de fraude évident lié au sexe, à l'âge ou à la mobilité: <br><br><ol><li>  nous avons défini un ajustement des enchères de -50% ou -100% pour le segment sélectionné; </li><li>  Nous suivons l'évolution des indicateurs clés. </li></ol><br>  b) aucun motif évident n'a été trouvé: <br><br><ol><li>  nous sélectionnons le trafic de fraude dans un segment <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Yandex.Audience</a> distinct (par exemple, vous saviez que du 1er au 20 octobre, il ne pouvait pas y avoir 5000 clics sur un groupe d'annonces, qui ne comptait toujours pas plus de 30 visites par jour) </li><li>  à travers le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sosie de Yandex, nous</a> créons un segment d'utilisateurs similaire à notre fraude; </li><li>  définir un ajustement des enchères de -100% pour un segment d'audience créé manuellement; </li><li>  Nous testons soigneusement la réduction des tarifs publicitaires pour les segments créés par Yandex. </li></ol><br><h2>  <font color="#3e6c9a">Créez des graphiques qui montrent la fraude</font> </h2><br>  <b>La fraude génère toujours des foyers et des pics évidents</b> , qu'il s'agisse d'un logiciel abusif imitant le comportement d'un utilisateur réel ou d'un groupe d'indépendants effectuant la tâche technique. <br><br><img src="https://habrastorage.org/webt/go/o2/al/goo2alj10gtzlycltq5rje0hoji.png"><br>  <font color="#7c8792">Figure 6. Graphique du nombre de visiteurs par mots-clés par décamines</font> <br><br>  La fraude se produit de manière inégale pour plusieurs raisons: <br><ul><li>  Pour que l'attaque soit "lissée", vous devez disposer d'informations confidentielles et savoir qui, quand et combien de clics vos annonces font; </li><li>  le logiciel agit par à-coups, et à la minute, à la minute 10 et parfois sur le graphique horaire, ses actions seront frappantes; </li><li>  même si les «écoliers» travaillent contre vous à partir des tableaux d'affichage, ils agissent sur une tâche spécifique avec un algorithme, et les anomalies générées par eux seront faciles à suivre. </li></ul><br>  Si vous apprenez à trouver et à éliminer rapidement les foyers, vous pouvez réduire considérablement les dommages causés par la fraude.  Dans notre cas, un signe évident était une augmentation anormale du nombre de clics sur la publicité contextuelle en 10 minutes ou une minute spécifiques pour certains mots clés. <br><br>  Pour la visualisation, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Google Data Studio est le</a> mieux adapté, car seul Analytics est capable de collecter correctement les données ventilées dans le temps par 1 et 10 minutes, et Metrika, lors de la création de rapports sur les décomptes, donne des indicateurs incorrects. <br><br><div class="spoiler">  <b class="spoiler_title">Comment créer des graphiques en 10 minutes, pas toutes les heures, dans Google Data Studio</b> <div class="spoiler_text">  Par défaut, dans Analytics ou Data Studio, vous ne pouvez pas créer de graphiques par minute ou pendant 10 minutes, mais cela peut être fait comme suit dans Date Studio: <br><br>  Étape 1. Ouvrir le champ d'édition <br><br><img src="https://habrastorage.org/webt/sy/y2/1v/syy21vr-evstitegmwu-ivqreh8.png"><br><br>  Étape 2. Créez des copies des champs suivants: année, mois de l'année, jour du mois, heure, minute et nommez-les, par exemple, année (jour), mois de l'année (jour), etc.  Toujours dans les champs copiés, vous devez changer le type du format d'heure et de date en «nombre» comme indiqué sur la figure. <br><br><img src="https://habrastorage.org/webt/zj/3a/a6/zj3aa66qqh0eq42cyc-ajbujxzm.png"><br>  <font color="#7c8792">Étape 2. Modifiez le type du champ copié de "date" à "numéro"</font> <br><br>  Étape 3. Créez un nouveau champ dans lequel nous écrivons la formule suivante: Année (jour) * 10000000 + Mois de l'année (jour) * 100000 + Jour du mois (jour) * 1000 + Heure (jour) * 10 + PLANCHER (Minute (jour) / 10) <br><br><img src="https://habrastorage.org/webt/ud/mm/8o/udmm8oej5cb9ysefk3zpmka2rvs.png"><br>  <font color="#7c8792">Étape 3. Créez un champ calculé «Temps pendant 10 minutes»</font> <br><br>  Étape 4. Nous enregistrons le champ créé, puis retournons à la liste de tous les champs et trouvons notre nouveau champ «Temps pendant 10 minutes (décamenut)».  Il est nécessaire de changer son type de "Numéro" en "Date et heure" comme indiqué sur la figure, puis de réattribuer le type "Numéro" à ce champ. <br><br><img src="https://habrastorage.org/webt/7f/bi/hh/7fbihh4hc4yss02cqsfra1ljfta.png"><br>  <font color="#7c8792">Étape 4. Créez un champ calculé «Temps pendant 10 minutes»</font> <br><br>  Étape 5. Créez un «graphique combiné» et définissez notre nouveau champ «Temps pendant 10 minutes» comme paramètre, comme indiqué sur la figure.  C'est fait. <br><br><img src="https://habrastorage.org/webt/rq/o5/hy/rqo5hybxbnptkakzlyrs4rclzqu.png"><br>  <font color="#7c8792">Étape 5. Créez un «graphique combiné»</font> <br></div></div><br><br><h2>  <font color="#3e6c9a">Configurer les notifications sur les épidémies de fraude</font> </h2><br>  Afin de ne pas suivre manuellement tous les cas de fraude, j'ai fait un rapport dans Google Sheets, qui met à jour les données toutes les minutes et notifie le début de la fraude. <br><br>  Google Sheets prend en charge l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">API Core Reporting</a> , accessible via l'éditeur de script dans Sheets. <br><br>  Étape 1. Accédez à l'éditeur de script pour accéder à Analytics <br><br><img src="https://habrastorage.org/webt/fe/6t/r-/fe6tr-kjvklwxovqwutpmuvbvcc.png"><br>  <font color="#7c8792">Figure 7. Éditeur de script pour accéder à l'API Analytics Core Reporting via Google Tables</font> <br><br>  Étape 2. Nous écrivons une demande d'API à Analytics pour recevoir des données sur les indicateurs nécessaires (par exemple, le nombre d'utilisateurs qui ont cliqué sur la publicité payante à chaque minute de la journée, comme dans notre cas). <br><br><div class="spoiler">  <b class="spoiler_title">Code Google Script pour demander toutes les données d'Analytics dans Google Sheets</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">runDemo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstProfile = getFirstProfile(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> results = getReportDataForProfile(firstProfile); outputToSpreadsheet(results); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(error) { Browser.msgBox(error.message); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFirstProfile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> accounts = Analytics.Management.Accounts.list(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (accounts.getItems()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstAccountId = accounts.getItems()[<span class="hljs-number"><span class="hljs-number">0</span></span>].getId(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> webProperties = Analytics.Management.Webproperties.list(firstAccountId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (webProperties.getItems()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstWebPropertyId = webProperties.getItems()[<span class="hljs-number"><span class="hljs-number">0</span></span>].getId(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> profiles = Analytics.Management.Profiles.list(firstAccountId, firstWebPropertyId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (profiles.getItems()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstProfile = profiles.getItems()[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> firstProfile; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'No views (profiles) found.'</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'No webproperties found.'</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'No accounts found.'</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReportDataForProfile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">firstProfile</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> profileId = firstProfile.getId(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tableId = <span class="hljs-string"><span class="hljs-string">'ga:'</span></span> + profileId; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> startDate = <span class="hljs-string"><span class="hljs-string">"today"</span></span>; <span class="hljs-comment"><span class="hljs-comment">// getLastNdays(14)  2 weeks (a fortnight) ago. var endDate = "today"; //getLastNdays(0)  Today. var optArgs = { 'dimensions': 'ga:date,ga:hour,ga:minute,ga:sourceMedium', // Comma separated list of dimensions. 'sort': 'ga:date,ga:hour,ga:minute', // Sort by sessions descending, then keyword. //'segment': 'dynamic::ga:isMobile==Yes', // Process only mobile traffic. 'filters': 'ga:sourceMedium==yandex / cpc', 'start-index': '1', 'max-results': '10000' // Display the first 250 results. }; // Make a request to the API. var results = Analytics.Data.Ga.get( tableId, // Table id (format ga:xxxxxx). startDate, // Start-date (format yyyy-MM-dd). endDate, // End-date (format yyyy-MM-dd). 'ga:users', // Comma seperated list of metrics. optArgs); if (results.getRows()) { return results; } else { throw new Error('No views (profiles) found'); } } function getLastNdays(nDaysAgo) { var today = new Date(); var before = new Date(); before.setDate(today.getDate() - nDaysAgo); return Utilities.formatDate(before, 'GMT', 'yyyy-MM-dd'); } function outputToSpreadsheet(results) { var sheets = SpreadsheetApp.getActiveSpreadsheet(); var sheet = sheets.getSheetByName("coeff1"); var range = sheet.getRange('A:E'); range.clear(); // Print the headers. var headerNames = []; for (var i = 0, header; header = results.getColumnHeaders()[i]; ++i) { headerNames.push(header.getName()); } sheet.getRange(1, 1, 1, headerNames.length) .setValues([headerNames]); // Print the rows of data. sheet.getRange(2, 1, results.getRows().length, headerNames.length) .setValues(results.getRows()); }</span></span></code> </pre> <br></div></div><br><br>  Étape 3. Nous définissons le déclencheur pour mettre à jour les données toutes les minutes: <br><br><img src="https://habrastorage.org/webt/bu/-f/lq/bu-flq0ftubu0wa1lcqxw1uilz0.png"><br>  <font color="#7c8792">Figure 8. Nous demandons de nouvelles données chaque minute pour une réponse rapide à la fraude</font> <br><br>  Étape 4. Nous créons un tableau croisé dynamique à partir de la feuille mise à jour avec les données nécessaires une fois par minute, et analysons ces indicateurs pour configurer les déclencheurs des notifications par e-mail ou désactiver les groupes d'annonces à l'aide de l'API Yandex.Direct ou AdWords. <br><br><img src="https://habrastorage.org/webt/ha/ba/-g/haba-goptrqk9xjgxrge_wjqqjs.png" alt="image">  <font color="#7c8792">Figure 9. Exemple de définition de formules pour les notifications d'anomalies</font> <br><br><div class="spoiler">  <b class="spoiler_title">Un exemple de mon code Google Script pour l'envoi de notifications par e-mail</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myFunction</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ss = SpreadsheetApp.getActiveSpreadsheet(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sheet = ss.getSheetByName(<span class="hljs-string"><span class="hljs-string">"notification"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> range = sheet.getRange(<span class="hljs-string"><span class="hljs-string">"D2:E4"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// The row and column here are relative to the range // getCell(1,1) in this code returns the cell at B2, B2 var cell = range.getCell(1, 2); Logger.log(cell.getValue()); if (cell.getValue() !== "no") { MailApp.sendEmail("your_email@yandex.ru", "Fraud notification "+cell.getValue(), "Check me "+range.getCell(1, 1).getValue()); } else { } var cell2 = range.getCell(2, 2); Logger.log(cell2.getValue()); if (cell2.getValue() !== "no") { MailApp.sendEmail("your_email@yandex.ru", "Fraud notification "+cell2.getValue(), "Check me "+range.getCell(2, 1).getValue()); } else { } var cell3 = range.getCell(3, 2); Logger.log(cell3.getValue()); if (cell3.getValue() !== "no") { MailApp.sendEmail("your_email@yandex.ru", "Fraud notification "+cell3.getValue(), "Check me "+range.getCell(3, 1).getValue()); } else { } }</span></span></code> </pre> <br></div></div><br><h2>  <font color="#3e6c9a">Conclusion: comment battre le clic</font> </h2><br>  La lutte contre la fraude aux clics peut être divisée en trois groupes: <br><br>  a) Actions proactives: <br><ul><li>  fermeture des "sites pollués"; </li><li>  Désactiver la publicité pour un public avec des signes de fraude pour vous, par exemple, pour les personnes sur les tablettes de Saint-Pétersbourg (des paramètres plus complexes de blocage peuvent être utilisés via les listes AdWords et les segments métriques); </li><li>  ajustement des enchères pour des segments d'audience similaires aux segments de fraude (des segments de «sosie» sont créés dans les listes Y. Audiences et Google); </li><li>  bloquer la fraude par les masques de réseau IP (disponible uniquement dans AdWords). </li></ul><br>  b) Actions préventives: <br><ul><li>  Signaler des remboursements budgétaires à AdWords et Direct </li><li>  l'enquête sur «qui vous a ordonné l'attaque»; </li><li>  regroupement de groupes d'annonces suspects et fréquemment attaqués en une seule campagne publicitaire; </li><li>  "Pièges" pour les bots les plus simples, à savoir les boutons cachés sur le site qui ne sont visibles que par le bot et lorsque vous cliquez dessus, il entre dans la liste. </li></ul><br>  c) Actions «post factum»: <br><ul><li>  blocage par adresses IP; </li><li>  déconnexion rapide des centres de clics: mots clés, groupes d'annonces, campagnes publicitaires, segments d'audience. </li></ul><br><img src="https://habrastorage.org/webt/lh/kt/qu/lhktquoljkgpshxr78ig6mspa4q.png" alt="image"><br>  <font color="#7c8792">Figure 10. Protection contre la fraude aux clics</font> <br><br>  <b>Liens utiles:</b> <b><br></b> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Bibliothèque d'</a> API Core Reporting </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Explorateur de requêtes</a> pour des commandes API de test pratiques; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Nous écrivons des scripts pour automatiser le travail avec les applications Google</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Automatisez Google Sheets</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Analytics Intelligence</a> , pour demander au robot Analytics: - "Mais y a-t-il eu des anomalies dans le trafic payant au cours de la dernière année?"  - et obtenez une réponse claire. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Comment savoir qui a ordonné l'attaque de votre annonce</b> <div class="spoiler_text">  Tout concurrent adéquat minimisera ses dégâts en attaquant les autres: <br><br><ol><li>  premièrement, l'attaquant essaiera de ne pas montrer son annonce dans le sens où l'attaque est en cours pour ne pas fusionner son CTR et augmenter son CPC; <br></li><li>  deuxièmement, un concurrent sans scrupules sélectionnera de tels mots clés pour l'attaque, selon lesquels il peut arrêter de diffuser ses annonces sans trop de mal pour lui-même. <br></li></ol><br>  Dans notre cas, le concurrent a également commencé à cliquer sur la fraude dans 4 directions dans deux villes, il n'a donc pas été difficile de la calculer. <br><br>  Pour faciliter l'analyse des concurrents avec lesquels vous vous croisez, vous pouvez voir toutes les annonces de concurrents incluses pour chaque mot clé dans l'interface Yandex.Direct: <br><br><img src="https://habrastorage.org/webt/w2/_t/4p/w2_t4p4zpj0imyxdogo7saha0sg.png"><br>  <font color="#7c8792">Figure 9. Toutes les annonces des concurrents par mot clé</font> <br></div></div><br><br>  <b>Qui a également fait face au clic publicitaire contextuel - écrivez dans les commentaires, nous allons essayer de nous entraider!</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr423335/">https://habr.com/ru/post/fr423335/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr423317/index.html">Pourquoi l'homme Scala?</a></li>
<li><a href="../fr423319/index.html">Intégration de code Vivaldi. Nos développeurs racontent</a></li>
<li><a href="../fr423321/index.html">Protection des référentiels GitHub contre les validations malveillantes</a></li>
<li><a href="../fr423323/index.html">"Vous devez être paresseux pour devenir un bon testeur."</a></li>
<li><a href="../fr423329/index.html">Se préparer pour un entretien avec une entreprise des Big Five</a></li>
<li><a href="../fr423337/index.html">Comment se faire des amis PHPstorm, xDebug et les branches distantes compilées via Docker? Trop simple ...</a></li>
<li><a href="../fr423339/index.html">Y a-t-il de la vie sous Windows 98, première partie - à propos du matériel</a></li>
<li><a href="../fr423341/index.html">Sous la pression du public, Sony a admis que les œuvres de Bach ne lui appartenaient pas.</a></li>
<li><a href="../fr423343/index.html">Les valeurs culturelles en plastique commencent à se dégrader</a></li>
<li><a href="../fr423345/index.html">Noeud de peur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>