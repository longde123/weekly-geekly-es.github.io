<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõÄüèΩ üè• üë∂ Opera√ß√£o de aprendizado de m√°quina no Mail.ru Mail üèÆ üèâ ü§°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Baseado nas minhas performances no Highload ++ e no DataFest Minsk 2019 

 Para muitos, o correio hoje √© parte integrante da vida online. Com sua ajud...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Opera√ß√£o de aprendizado de m√°quina no Mail.ru Mail</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/476714/"><img src="https://habrastorage.org/webt/k-/h5/xj/k-h5xjc6xswda5namvb8vgzjnns.jpeg"><br><br>  <i>Baseado nas minhas performances no Highload ++ e no DataFest Minsk 2019</i> <br><br>  Para muitos, o correio hoje √© parte integrante da vida online.  Com sua ajuda, realizamos correspond√™ncia comercial, armazenamos todos os tipos de informa√ß√µes importantes relacionadas a finan√ßas, reservas de hotel, check-out e muito mais.  Em meados de 2018, formulamos uma estrat√©gia de produto de desenvolvimento de correio.  O que deve ser o correio moderno? <br><br>  O correio deve ser <b>inteligente</b> , ou seja, ajudar os usu√°rios a navegar na crescente quantidade de informa√ß√µes: filtrar, estruturar e fornec√™-las da maneira mais conveniente.  Deve ser <b>√∫til</b> , permitindo diretamente na caixa de correio resolver v√°rios problemas, por exemplo, pagar multas (uma fun√ß√£o que, infelizmente, uso).  E, ao mesmo tempo, √© claro, o correio deve fornecer prote√ß√£o de informa√ß√µes cortando spam e protegendo contra hackers, ou seja, estar <b>seguro</b> . <br><a name="habracut"></a><br>  Essas √°reas determinam v√°rias tarefas importantes, muitas das quais podem ser efetivamente resolvidas usando o aprendizado de m√°quina.  Aqui est√£o exemplos de recursos existentes desenvolvidos como parte da estrat√©gia - um para cada dire√ß√£o. <br><br><ul><li>  <b>Resposta inteligente</b> .  H√° uma fun√ß√£o de resposta inteligente no e-mail.  A rede neural analisa o texto da carta, entende seu significado e prop√≥sito e, como resultado, oferece as tr√™s op√ß√µes de resposta mais adequadas: positiva, negativa e neutra.  Isso ajuda a economizar significativamente tempo ao responder cartas e tamb√©m costuma responder de maneira n√£o padronizada e divertida. <br></li><li> <b>Agrupamento de cartas</b> relacionadas a pedidos em lojas online.  Frequentemente fazemos compras na Internet e, como regra, as lojas podem enviar v√°rias cartas para cada pedido.  Por exemplo, no AliExpress, o maior servi√ßo, existem muitas letras para um pedido e conclu√≠mos que no caso terminal o n√∫mero pode chegar a 29. Portanto, usando o modelo de Reconhecimento de entidade nomeada, selecionamos o n√∫mero do pedido e outras informa√ß√µes no texto e no grupo todas as letras em uma linha.  Tamb√©m mostramos as informa√ß√µes b√°sicas sobre o pedido em uma caixa separada, o que facilita o trabalho com esse tipo de letras. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f1/b29/7f7/3f1b297f73ba953ecda62e89fee2ee9c.png"><br></li><li>  <b>Antiphishing</b> .  Phishing √© um tipo de e-mail fraudulento particularmente perigoso, com a ajuda dos quais os invasores tentam obter informa√ß√µes financeiras (incluindo cart√µes banc√°rios do usu√°rio) e logins.  Tais cartas imitam as reais enviadas pelo servi√ßo, inclusive visualmente.  Portanto, com a ajuda da Computer Vision, reconhecemos os logotipos e o estilo das cartas de grandes empresas (por exemplo, Mail.ru, Sberbank, Alpha) e levamos isso em conta, al√©m de texto e outros sinais em nossos classificadores de spam e phishing. <br></li></ul><br><h2>  Aprendizado de m√°quina </h2><br>  Um pouco sobre o aprendizado de m√°quina no correio em geral.  O Mail √© um sistema altamente carregado: em nossos servidores, uma m√©dia de 1,5 bilh√£o de cartas por dia passa para 30 milh√µes de usu√°rios de DAU.  Servir todas as fun√ß√µes e recursos necess√°rios de cerca de 30 sistemas de aprendizado de m√°quina. <br><br>  Cada letra passa por um transportador de classifica√ß√£o inteiro.  Primeiro, eliminamos o spam e deixamos bons e-mails.  Os usu√°rios geralmente n√£o percebem a opera√ß√£o do anti-spam, porque 95-99% do spam nem chega √† pasta correspondente.  O reconhecimento de spam √© uma parte muito importante do nosso sistema e o mais dif√≠cil, pois na esfera anti-spam h√° uma constante adapta√ß√£o entre os sistemas de defesa e ataque, o que fornece um desafio cont√≠nuo de engenharia para nossa equipe. <br><br>  Em seguida, separamos letras de pessoas e rob√¥s.  As cartas das pessoas s√£o mais importantes, portanto, para elas, fornecemos fun√ß√µes como Resposta Inteligente.  As cartas dos rob√¥s s√£o divididas em duas partes: transacional - s√£o cartas importantes de servi√ßos, por exemplo, confirma√ß√£o de compras ou reservas de hot√©is, finan√ßas e informa√ß√µes - publicidade comercial, descontos. <br><br>  Acreditamos que as letras transacionais s√£o iguais em valor √† correspond√™ncia pessoal.  Eles devem estar √† m√£o, porque muitas vezes √© necess√°rio encontrar rapidamente informa√ß√µes sobre o pedido ou reservar um bilhete, e passamos um tempo pesquisando essas cartas.  Portanto, por conveni√™ncia, as dividimos automaticamente em seis categorias principais: viagens, reservas, finan√ßas, passagens, registros e, finalmente, multas. <br><br>  Os boletins s√£o o maior e provavelmente menos importante grupo que n√£o requer rea√ß√£o instant√¢nea, pois nada de significativo mudar√° na vida do usu√°rio se ele n√£o ler essa carta.  Em nossa nova interface, os agrupamos em dois segmentos: redes sociais e boletins, limpando visualmente a caixa de correio e deixando apenas cartas importantes √† vista. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/300/e18/9b9/300e189b9567866cb526eb34be80b3b4.jpg"><br><br><h3>  Opera√ß√£o </h3><br>  Um grande n√∫mero de sistemas causa muitas dificuldades na opera√ß√£o.  Afinal, os modelos degradam-se com o tempo, como qualquer software: sinais quebram, m√°quinas falham, um c√≥digo rola.  Al√©m disso, os dados est√£o mudando constantemente: novos s√£o adicionados, o padr√£o de comportamento do usu√°rio √© transformado etc., portanto, o modelo sem suporte adequado funcionar√° cada vez mais com o passar do tempo. <br><br>  N√£o devemos esquecer que quanto mais o aprendizado de m√°quina penetra na vida dos usu√°rios, maior o impacto que eles causam no ecossistema e, como resultado, mais perdas ou lucros financeiros os participantes do mercado podem obter.  Portanto, em um n√∫mero crescente de √°reas, os jogadores est√£o se adaptando ao trabalho dos algoritmos de ML (exemplos cl√°ssicos s√£o publicidade, pesquisa e anti-spam j√° mencionados). <br><br>  Al√©m disso, as tarefas de aprendizado de m√°quina t√™m uma peculiaridade: qualquer altera√ß√£o, embora insignificante, no sistema pode gerar muito trabalho com o modelo: trabalhar com dados, reciclagem, implanta√ß√£o, o que pode levar semanas ou meses.  Portanto, quanto mais r√°pido o ambiente em que seus modelos operam, mais esfor√ßo exige o suporte deles.  Uma equipe pode criar muitos sistemas e se divertir, e depois gastar quase todos os recursos em seu suporte, sem a capacidade de fazer algo novo.  Uma vez, encontramos essa situa√ß√£o em uma equipe anti-spam.  E eles chegaram √† conclus√£o √≥bvia de que a manuten√ß√£o deve ser automatizada. <br><br><h3>  Automa√ß√£o </h3><br>  O que pode ser automatizado?  De fato, quase tudo.  Eu identifiquei quatro √°reas que definem a infraestrutura do aprendizado de m√°quina: <br><br><ul><li>  coleta de dados; <br></li><li>  educa√ß√£o continuada; <br></li><li>  implanta√ß√£o; <br></li><li>  teste e monitoramento. <br></li></ul><br>  Se o ambiente √© inst√°vel e muda constantemente, toda a infraestrutura em torno do modelo √© muito mais importante que o pr√≥prio modelo.  Pode ser o bom e velho classificador linear, mas se voc√™ aplicar corretamente os sinais e estabelecer um bom feedback dos usu√°rios, ele funcionar√° muito melhor do que os modelos de √∫ltima gera√ß√£o com todos os sinos e assobios. <br><br><h4>  Loop de feedback </h4><br>  Esse ciclo combina coleta de dados, treinamento adicional e implanta√ß√£o - de fato, todo o ciclo de atualiza√ß√£o do modelo.  Por que isso √© importante?  Veja a programa√ß√£o de registro pelo correio: <br><br><img src="https://habrastorage.org/webt/8b/nj/qx/8bnjqxedzuj9ubakau7yd1vh_cc.png"><br><br>  O desenvolvedor de aprendizado de m√°quina introduziu um modelo de antibot que impede o registro de bots no correio.  O gr√°fico cai para um valor em que apenas usu√°rios reais permanecem.  Est√° tudo √≥timo!  Mas quatro horas se passam, os botvods apertam seus scripts e tudo volta √† estaca zero.  Nesta implementa√ß√£o, o desenvolvedor passou um m√™s adicionando recursos e um modelo de treinamento, mas o remetente de spam conseguiu se adaptar em quatro horas. <br><br>  Para n√£o ser t√£o dolorosamente doloroso e n√£o precisar refazer tudo mais tarde, precisamos pensar inicialmente sobre como ser√° o ciclo de feedback e o que faremos se o ambiente mudar.  Vamos come√ßar coletando dados - esse √© o combust√≠vel para nossos algoritmos. <br><br><h2>  Coleta de dados </h2><br>  √â claro que as redes neurais modernas, quanto mais dados, melhor, e elas, de fato, geram usu√°rios do produto.  Os usu√°rios podem nos ajudar a marcar os dados, mas voc√™ n√£o pode abusar deles, porque em algum momento os usu√°rios estar√£o cansados ‚Äã‚Äãde concluir seus modelos e mudar√£o para outro produto. <br><br>  Um dos erros mais comuns (aqui fa√ßo uma refer√™ncia a Andrew Ng) √© que a orienta√ß√£o para as m√©tricas no conjunto de dados de teste √© muito forte, e n√£o para o feedback do usu√°rio, que √© realmente a principal medida da qualidade do trabalho, pois criamos um produto para o usu√°rio.  Se o usu√°rio n√£o entender ou n√£o gostar do trabalho do modelo, tudo ser√° perec√≠vel. <br><br>  Portanto, o usu√°rio sempre deve poder votar, deve fornecer a ele uma ferramenta para feedback.  Se acharmos que uma carta relacionada a finan√ßas chegou na caixa, precisamos marc√°-la como "financiar" e pressionar um bot√£o no qual o usu√°rio pode clicar e dizer que n√£o √© financiada. <br><br><h3>  Qualidade do feedback </h3><br>  Vamos falar sobre a qualidade do feedback do usu√°rio.  Primeiramente, voc√™ e o usu√°rio podem colocar significados diferentes em um conceito.  Por exemplo, voc√™ e os gerentes de produto pensam que "finan√ßas" s√£o cartas do banco e o usu√°rio acredita que a carta da minha av√≥ sobre a aposentadoria tamb√©m se refere a finan√ßas.  Em segundo lugar, existem usu√°rios que gostam de pressionar bot√µes sem l√≥gica.  Terceiro, o usu√°rio pode estar profundamente enganado em suas conclus√µes.  Um exemplo v√≠vido de nossa pr√°tica √© a introdu√ß√£o do classificador de <a href="https://ru.wikipedia.org/wiki/%25D0%259D%25D0%25B8%25D0%25B3%25D0%25B5%25D1%2580%25D0%25B8%25D0%25B9%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B5_%25D0%25BF%25D0%25B8%25D1%2581%25D1%258C%25D0%25BC%25D0%25B0">spam nigeriano</a> , um tipo de spam muito engra√ßado, quando o usu√°rio √© solicitado a coletar v√°rios milh√µes de d√≥lares de um parente distante encontrado de repente na √Åfrica.  Ap√≥s a introdu√ß√£o desse classificador, verificamos os cliques "Sem spam" nessas cartas e constatamos que 80% deles s√£o spam nigeriano suculento, o que sugere que os usu√°rios podem ser extremamente confi√°veis. <br><br>  E n√£o vamos esquecer que n√£o apenas as pessoas podem apertar os bot√µes, mas todos os tipos de bots que fingem ser um navegador.  Portanto, o feedback bruto n√£o √© bom para o aprendizado.  O que pode ser feito com essa informa√ß√£o? <br><br>  Usamos duas abordagens: <br><br><ul><li>  <b>Feedback de ML relacionado</b> .  Por exemplo, temos um sistema antibot online, que, como mencionei, toma uma decis√£o r√°pida com base em um n√∫mero limitado de sinais.  E existe um segundo sistema lento que funciona ex post.  Ela tem mais dados sobre o usu√°rio, sobre o comportamento dele etc.  Como resultado, a decis√£o mais equilibrada √© tomada, respectivamente, com maior precis√£o e perfei√ß√£o.  Voc√™ pode direcionar a diferen√ßa no trabalho desses sistemas no primeiro como dados para treinamento.  Assim, um sistema mais simples sempre tentar√° se aproximar de um desempenho mais complexo. <br></li><li>  <b>Classifica√ß√£o de cliques</b> .  Voc√™ pode simplesmente classificar cada clique do usu√°rio, avaliar sua validade e capacidade de uso.  Fazemos isso no correio anti-spam usando os atributos do usu√°rio, seu hist√≥rico, os atributos do remetente, o pr√≥prio texto e o resultado dos classificadores.  Como resultado, obtemos um sistema autom√°tico que valida o feedback do usu√°rio.  E como √© necess√°rio trein√°-lo com muito menos frequ√™ncia, seu trabalho pode se tornar o principal para todos os outros sistemas.  A precis√£o √© a principal prioridade desse modelo, porque o treinamento de um modelo em dados imprecisos √© repleto de consequ√™ncias. <br></li></ul><br>  Enquanto limpamos os dados e reciclamos nossos sistemas ML, n√£o devemos esquecer os usu√°rios, porque para n√≥s milhares e milh√µes de erros em um gr√°fico s√£o estat√≠sticas e, para um usu√°rio, todo bug √© uma trag√©dia.  Al√©m do fato de que o usu√°rio precisa, de alguma forma, conviver com seu erro no produto, ele, ap√≥s o feedback, espera excluir uma situa√ß√£o semelhante no futuro.  Portanto, voc√™ deve sempre dar aos usu√°rios n√£o apenas a oportunidade de votar, mas tamb√©m corrigir o comportamento dos sistemas de ML, criando, por exemplo, heur√≠sticas pessoais para cada clique de feedback, no caso de correio, pode ser poss√≠vel filtrar essas mensagens por remetente e cabe√ßalho para esse usu√°rio. <br><br>  Voc√™ tamb√©m precisa incluir o modelo com base em alguns relat√≥rios ou chamadas de suporte no modo semiautom√°tico ou manual, para que outros usu√°rios tamb√©m n√£o sofram problemas semelhantes. <br><br><h3>  Heur√≠stica para a Aprendizagem </h3><br>  Existem dois problemas com essas heur√≠sticas e muletas.  A primeira √© que √© dif√≠cil manter um n√∫mero cada vez maior de muletas, sem mencionar a qualidade e o desempenho a longa dist√¢ncia.  O segundo problema √© que o erro pode n√£o ser a frequ√™ncia e alguns cliques para treinar novamente o modelo n√£o ser√£o suficientes.  Parece que esses dois efeitos n√£o relacionados podem ser substancialmente nivelados se a abordagem a seguir for aplicada. <br><br><ol><li>  Crie uma muleta tempor√°ria. <br></li><li>  Os dados s√£o direcionados para o modelo, que s√£o recuperados regularmente, incluindo os dados recebidos.  Aqui, √© claro, √© importante que a heur√≠stica tenha alta precis√£o para n√£o reduzir a qualidade dos dados no conjunto de treinamento. <br></li><li>  Em seguida, desligamos o monitoramento para a opera√ß√£o da muleta e, se depois de algum tempo a muleta n√£o funcionar mais e for completamente coberta pelo modelo, voc√™ poder√° remov√™-la com seguran√ßa.  Agora, √© improv√°vel que esse problema se repita. <br></li></ol><br>  Portanto, o ex√©rcito de muletas √© muito √∫til.  O principal √© que seu servi√ßo √© urgente, n√£o permanente. <br><br><h2>  Educa√ß√£o continuada </h2><br>  A reciclagem √© o processo de adicionar novos dados obtidos como resultado do feedback dos usu√°rios ou de outros sistemas e treinar o modelo existente sobre eles.  Pode haver v√°rios problemas com a reciclagem: <br><br><ol><li>  Um modelo pode simplesmente n√£o apoiar o ensino superior e aprender apenas do zero. <br></li><li>  Em nenhum lugar do livro da natureza est√° escrito que a educa√ß√£o continuada certamente melhorar√° a qualidade do trabalho em produ√ß√£o.  Muitas vezes acontece exatamente o oposto, ou seja, apenas a deteriora√ß√£o √© poss√≠vel. <br></li><li>  Mudan√ßas podem ser imprevis√≠veis.  Este √© um ponto bastante sutil que identificamos para n√≥s mesmos.  Mesmo que o novo modelo no teste A / B mostre resultados semelhantes em compara√ß√£o ao atual, isso n√£o significa que funcionar√° de forma id√™ntica.  Seu trabalho pode diferir em um por cento, o que pode trazer novos erros ou retornar os antigos j√° corrigidos.  N√≥s e os usu√°rios j√° sabemos como conviver com os erros atuais e, quando ocorre um grande n√∫mero de novos erros, o usu√°rio tamb√©m pode n√£o entender o que est√° acontecendo, porque espera um comportamento previs√≠vel. <br></li></ol><br>  Portanto, a coisa mais importante na reciclagem √© garantida para melhorar o modelo, ou pelo menos para n√£o pior√°-lo. <br><br>  A primeira coisa que vem √† mente quando falamos sobre educa√ß√£o continuada √© a abordagem do Aprendizado Ativo.  O que isso significa?  Por exemplo, o classificador determina se a carta se refere a finan√ßas e, em torno de sua fronteira de tomada de decis√£o, adicionamos uma sele√ß√£o de exemplos marcados.  Isso funciona bem, por exemplo, na publicidade, onde h√° muito feedback e voc√™ pode treinar o modelo online.  E, se houver pouco feedback, obtemos uma amostra fortemente tendenciosa em rela√ß√£o √† produ√ß√£o da distribui√ß√£o de dados, com base na qual √© imposs√≠vel avaliar o comportamento do modelo durante a opera√ß√£o. <br><br><img src="https://habrastorage.org/webt/wz/1c/0g/wz1c0gfwffg6kh2gnc76v_-70ai.jpeg"><br><br>  De fato, nosso objetivo √© preservar padr√µes antigos, modelos j√° conhecidos e adquirir novos.  Aqui, a continuidade √© importante.  O modelo, que costumamos lan√ßar com grande dificuldade, j√° funciona, para que possamos focar em seu desempenho. <br><br>  No correio, diferentes modelos s√£o usados: √°rvores, lineares, redes neurais.  Para cada um, criamos nosso pr√≥prio algoritmo de reciclagem.  No processo de reciclagem, obtemos n√£o apenas novos dados, mas muitas vezes novos recursos que levaremos em considera√ß√£o em todos os algoritmos abaixo. <br><br><h3>  Modelos lineares </h3><br>  Digamos que temos uma regress√£o log√≠stica.  Compomos o modelo de perda a partir dos seguintes componentes: <br><br><ul><li>  LogLoss em novos dados; <br></li><li>  regularizamos o peso de novos sinais (n√£o tocamos nos antigos); <br></li><li>  aprendemos com dados antigos para preservar padr√µes antigos; <br></li><li>  e, talvez, o mais importante: anexamos a Regulariza√ß√£o Harm√¥nica, que garante uma ligeira altera√ß√£o nos pesos em rela√ß√£o ao modelo antigo de acordo com a norma. <br></li></ul><br>  Como cada componente de perda possui coeficientes, podemos escolher os valores ideais para nossa tarefa de valida√ß√£o cruzada ou com base nos requisitos do produto. <br><br><img src="https://habrastorage.org/webt/kz/ej/-r/kzej-rg5tcarotc9l25xe7x9d8a.jpeg"><br><br><h3>  √Årvores </h3><br>  Vamos para as √°rvores de decis√£o.  Filmamos o seguinte algoritmo de reciclagem de √°rvores: <br><br><ol><li>  Uma floresta de 100 a 300 √°rvores trabalha no produto, que foi treinado no antigo conjunto de dados. <br></li><li>  No final, exclu√≠mos M = 5 partes e adicionamos 2M = 10 novas, treinadas em todo o conjunto de dados, mas com alto peso a partir dos novos dados, o que naturalmente garante uma altera√ß√£o incremental no modelo. <br></li></ol><br>  Obviamente, com o tempo, o n√∫mero de √°rvores aumenta significativamente, e elas devem ser periodicamente reduzidas para se ajustarem aos hor√°rios.  Para fazer isso, usamos a agora onipresente Destila√ß√£o de Conhecimento (KD).  Brevemente sobre o princ√≠pio de seu trabalho. <br><br><ol><li>  Temos o atual modelo "complexo".  Come√ßamos no conjunto de dados de treinamento e obtemos a distribui√ß√£o de probabilidade das classes na sa√≠da. <br></li><li>  Em seguida, ensinamos o modelo do aluno (um modelo com menos √°rvores neste caso) a repetir os resultados do modelo, usando a distribui√ß√£o de classes como uma vari√°vel de destino. <br></li><li>  √â importante observar aqui que n√£o usamos a marca√ß√£o do conjunto de dados de nenhuma maneira e, portanto, podemos usar dados arbitr√°rios.  Obviamente, usamos uma amostra de dados do fluxo de combate como uma amostra de treinamento para o modelo do aluno.  Assim, o conjunto de treinamento nos permite garantir a precis√£o do modelo, e uma amostra do fluxo garante um desempenho semelhante na distribui√ß√£o da produ√ß√£o, compensando o deslocamento da amostra de treinamento. <br></li></ol><br><img src="https://habrastorage.org/webt/a9/y-/qb/a9y-qbwv-wg1r8w7ohezamjzbi4.jpeg"><br><br>  A combina√ß√£o dessas duas t√©cnicas (adicionando √°rvores e reduzindo periodicamente seu n√∫mero usando a Destila√ß√£o de conhecimento) garante a introdu√ß√£o de novos padr√µes e a continuidade completa. <br><br>  Com a ajuda da KD, tamb√©m realizamos a distin√ß√£o de opera√ß√µes com caracter√≠sticas de um modelo, por exemplo, remo√ß√£o de caracter√≠sticas e trabalho em passes.  No nosso caso, temos v√°rios recursos estat√≠sticos importantes (por remetentes, hashes de texto, URLs etc.) armazenados em um banco de dados que tem a propriedade de recusar.  O modelo, √© claro, n√£o est√° pronto para esse desenvolvimento de eventos, pois n√£o h√° situa√ß√µes de falha no conjunto de treinamento.  Nesses casos, combinamos KD e t√©cnicas de aumento: ao treinar para uma parte dos dados, exclu√≠mos ou zeramos os sinais necess√°rios e tomamos os r√≥tulos (sa√≠das do modelo atual) como os iniciais, o modelo do aluno nos ensina a repetir essa distribui√ß√£o. <br><br><img src="https://habrastorage.org/webt/xz/dc/12/xzdc12577_krj0_-qknhnh8eqvo.jpeg"><br><br>  Percebemos que quanto mais s√©ria a manipula√ß√£o dos modelos ocorre, maior a porcentagem de fluxo de amostra necess√°ria. <br><br>  Para remover recursos, a opera√ß√£o mais simples, apenas uma pequena parte do fluxo √© necess√°ria, pois apenas alguns recursos mudam e o modelo atual estudado no mesmo conjunto - a diferen√ßa √© m√≠nima.  Para simplificar o modelo (reduzindo o n√∫mero de √°rvores em v√°rias vezes), j√° √© necess√°rio 50 a 50. E omitir recursos estat√≠sticos importantes que afetam seriamente o desempenho do modelo requer ainda mais fluxo para uniformizar o trabalho do novo modelo, que √© resistente a omiss√µes, em todos os tipos de letras. <br><br><img src="https://habrastorage.org/webt/xw/b5/ib/xwb5ibcbds7xt3asahheyhpj9v4.jpeg"><br><br><h3>  Texto r√°pido </h3><br>  Vamos para o FastText.  Deixe-me lembr√°-lo de que a representa√ß√£o (incorpora√ß√£o) de uma palavra consiste na soma da incorpora√ß√£o da pr√≥pria palavra e de todas as letras N-gramas, geralmente trigramas.  Como os trigramas podem ser bastante, o Hashing de balde √© usado, ou seja, a convers√£o de todo o espa√ßo em um determinado hashmap fixo.  Como resultado, a matriz de pesos √© obtida pela dimens√£o da camada interna pelo n√∫mero de palavras + balde. <br><br>  Durante a educa√ß√£o continuada, novos sinais aparecem: palavras e trigramas.  No p√≥s-treinamento padr√£o do Facebook, nada de significativo acontece.  Somente pesos antigos com entropia cruzada em novos dados s√£o reciclados.  ,    , ,      ,      .     FastText.     (  ),     -         ,      . <br><br><img src="https://habrastorage.org/webt/ib/0g/v3/ib0gv3rq9xvxitkbimz_6f4yaqs.jpeg"><br><br><h3> CNN </h3><br>     .   CNN   , , ,       .    ,     ,         .         Triplet Loss ( <a href="https://arxiv.org/abs/1503.03832"> </a> ). <br><br><h4> Triplet Loss </h4><br>         Triplet Loss.   ,         .         ,     ,     . <br><br><img src="https://habrastorage.org/webt/h9/uz/cy/h9uzcyjc9y86mc2inrlv0wq3kwm.jpeg"><br><br>    ,       ,       .     ,  .    ,       . <br><br>      -       .        (Finetuning):    ,     .            ,  ‚Äî   .  ,         v1  v2.    . <br><br><img src="https://habrastorage.org/webt/eb/iu/ro/ebiurox9uuibm_meuq8tap3zyzw.jpeg"><br><br><h3>   </h3><br>        ,    ,     .  ,    ,   CNN  Fast Text  .     ,       ( , ,  ).            .                    ,           . <br><br><img src="https://habrastorage.org/webt/ik/42/y4/ik42y4lvyzbhbsuywkmrxwg6bp4.jpeg"><br><br>        .     CNN  Fast Text    ,     ‚Äî          .          Knowledge Distillation. <br><br>           ,             .               ,            ,        . <br><br><h2>  </h2><br>         ,        . <br><br><h3> /B- </h3><br>    ,     ,  ,   ,     - .          ,  ,      ,    A/B-.              .       5 %,  30 %,  50 %   100 % ,            .   -      ,    ,     ,     .       50 %   ,       ,      . <br><br>   A/B-    .   ,   A/B-   (      6  24      ),         .         ,       /B- (            ),    A/B-  . ,          ,        . <br><br>        ,   A/B-.         , Precision, Recall      ,       .       ,  ,      (Complexity) .    ,       -,      ,   ,      A/B-. <br><br><img src="https://habrastorage.org/webt/jf/nf/mu/jfnfmu8eoxpau1ux_n_ndww9ffi.jpeg"><br><br>             A/B-. <br><br><h3>  &amp;  </h3><br>   ,   ,    , , ,      .    ,   ‚Äî   ,     . <br><br>   ,          ‚Äî       .          ,          .      ,     ‚Äî -      ,     . <br><br>     ,                 .             (     ).  -       .  ,      ,         ¬´¬ª       .    ,     ,        .          . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/db1/f2f/6a9/db1f2f6a95922c5c4caf13e5aab1be57.jpg"><br><br>            .     ,       ,      .   KL-           A/B-   ,          . <br><br>               ,       . ,  NER-       -,         ,    .     ! <br><br><h2>  Sum√°rio </h2><br>       . <br><br><ul><li> <b></b> .    :       ,     .  ,   ‚Äî       ,        ML-.       ,     , ,  . <br></li><li> <b></b> .   ‚Äî  ,     -.    ,              . </li><li> <b></b> .         .      ,            . <br></li></ul><br>  , ,        ML-,          ,     . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt476714/">https://habr.com/ru/post/pt476714/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt476704/index.html">Como automatizar o layout de emails com o mesmo tipo de elementos: usamos objetos inteligentes</a></li>
<li><a href="../pt476706/index.html">Cerebras Systems introduziu um computador com o maior processador do mundo 22 √ó 22 cent√≠metros</a></li>
<li><a href="../pt476708/index.html">Slurm Basic em Moscou. Terceiro dia A cole√ß√£o de contra-intelig√™ncia e o cluster, voando Pavel Selivanov e "Slurm Inspires!"</a></li>
<li><a href="../pt476710/index.html">Registro aberto: Mergulhe profundamente em TI na Mars</a></li>
<li><a href="../pt476712/index.html">Servi√ßo para reuni√µes aleat√≥rias com estranhos, mas n√£o namoro. Hist√≥ria aleat√≥ria de inicializa√ß√£o do Coffee</a></li>
<li><a href="../pt476718/index.html">Hist√≥ria de uma r√°dio nacional: Mussolini da Rural Radio e Joseph Goebbels aquecem l√¢mpadas</a></li>
<li><a href="../pt476720/index.html">Como identificar um funcion√°rio em potencial no est√°gio de curr√≠culo</a></li>
<li><a href="../pt476722/index.html">Automa√ß√£o de entrega de fluxo Apache NiFi</a></li>
<li><a href="../pt476724/index.html">Instale o VMware ESXi no Mac Pro 1.1</a></li>
<li><a href="../pt476726/index.html">Graduado pela Universidade de Innopolis sobre estudar na Universidade de Grenoble, AI, ingl√™s com franc√™s e queijo com percevejos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>