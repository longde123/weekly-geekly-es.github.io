<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí™üèΩ üöê ü§© Wirklich einfache Grafiken in R f√ºr Wissenschaft und Journalismus üö£üèø üí• üë©üèº‚Äçüè´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="R ist ein sehr leistungsf√§higes Werkzeug f√ºr die Arbeit mit Statistiken: von der Vorverarbeitung bis zur Erstellung von Modellen beliebiger Komplexit√§...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wirklich einfache Grafiken in R f√ºr Wissenschaft und Journalismus</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/486024/"><p>  R ist ein sehr leistungsf√§higes Werkzeug f√ºr die Arbeit mit Statistiken: von der Vorverarbeitung bis zur Erstellung von Modellen beliebiger Komplexit√§t und entsprechender Grafiken. </p><br><p>  Eine einfache Google-Anfrage liefert eine gro√üe Menge an Literatur zum Thema ‚ÄûEinfache und schnelle Verwendung von R‚Äú. Es werden riesige B√ºcher und zahlreiche Notizen zum <a href="https://stackoverflow.com/questions/tagged/r">Stapel√ºberlauf angezeigt</a> , die auf den ersten Blick wie ein endloses Lagerhaus von Beispielen wirken, von denen jedes in zwei Z√§hlungen vorliegt sammelt den notwendigen Code, um ein bestimmtes Problem zu l√∂sen.  In Wirklichkeit ist dies jedoch √ºberhaupt nicht wahr.  Es gibt nur sehr wenige Materialien, aus denen hervorgeht, wie ein einfacher Zeitplan ‚Äûvon Grund auf‚Äú mit vorgefertigten Rezepten erstellt werden kann, um die bei der L√∂sung dieses Problems auftretenden Probleme zu l√∂sen. </p><br><p>  Um praktische Probleme zu l√∂sen, sind spezifische schrittweise Anleitungen erforderlich und keine detaillierte Beschreibung der vollen Leistungsf√§higkeit eines Pakets.  Dar√ºber hinaus sind vorgefertigte Fallstudien (die gleichen <a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D1%2580%25D0%25B8%25D1%2581%25D1%258B_%25D0%25A4%25D0%25B8%25D1%2588%25D0%25B5%25D1%2580%25D0%25B0">Schwertlilien</a> ) oft wenig n√ºtzlich, da sie eine der wichtigsten Phasen der Arbeit mit Statistiken √ºberspringen - die vorl√§ufige Erfassung und Verarbeitung der Daten selbst.  Aber genau f√ºr diese Arbeit braucht fast ein Gro√üteil aller Zeit oft!  Ein separates Problem ist die Erstellung von Zeitpl√§nen, die formellen und h√§ufig informellen Standards eines bestimmten beruflichen Umfelds entsprechen. </p><br><p>  Meine Kollegen und ich m√ºssen regelm√§√üig mehr und mehr Statistiken und darauf basierende Modelle visualisieren, um wissenschaftliche Ergebnisse zu ver√∂ffentlichen.  Da sich das Studium mit Wirtschaft befasst, √§hneln viele dieser Arbeiten dem professionellen Journalismus. </p><br><p>  Irgendwann wurde klar, dass f√ºr eine effektive Teamarbeit eine Art vollwertige Pipeline f√ºr die Verarbeitung von Statistiken erforderlich ist.  Dieser Artikel wurde als Einf√ºhrung f√ºr Kollegen und als Spickzettel f√ºr mich zum Betrieb dieses F√∂rderers erstellt.  Es scheint, dass dieses Material f√ºr ein breiteres Publikum n√ºtzlich sein kann. </p><a name="habracut"></a><br><h1 id="grafika-v-r-bez-boli-poshagovoe-rukovodstvo">  R Schmerzfreie Grafik: Komplettl√∂sung </h1><br><h2 id="bazovaya-nastroyka-r">  Grundeinstellung R </h2><br><p>  Zum Arbeiten ben√∂tigen Sie ein Standardpaket: <a href="https://www.r-project.org/">R</a> + <a href="https://rstudio.com/products/rstudio/download/">RStudio</a> .  Sie sind f√ºr alle g√§ngigen Plattformen kostenlos erh√§ltlich.  R wird zuerst installiert, dann RStudio.  Es gibt normalerweise keine Probleme. </p><br><p>  Bevor Sie arbeiten, ist es besser, das neue Skript sofort irgendwo in Ihrem Dateisystem zu speichern und das Arbeitsverzeichnis R sofort in dem Ordner zu installieren, in dem das Skript gespeichert ist (Men√º Sitzung - Arbeitsverzeichnis festlegen - Speicherort der Quelldatei).  Der letzte Hinweis ist wichtig, da ansonsten nach dem Neustart von RStudio kein externes oder natives Skript gestartet werden kann.  Aus irgendeinem Grund macht RStudio dies nicht standardm√§√üig, was logisch w√§re. </p><br><p>  Selbst im Basispaket R gibt es Standard-Visualisierungswerkzeuge ( <em>Plot-</em> Funktion), mit denen Sie viele Arten von Diagrammen erstellen k√∂nnen. Dennoch reichen diese Funktionen f√ºr vollwertige, hochgradig anpassbare Illustrationen eindeutig nicht aus. </p><br><p>  Die am h√§ufigsten verwendete Bibliothek f√ºr Grafiken in R ist das Paket <a href="https://ggplot2.tidyverse.org/">ggplot2</a> , das wir ebenfalls verwenden werden. </p><br><p>  Es lohnt sich auch, die <em>readxl-</em> Pakete (zum Lesen von .xls-, .xlsx-Dateien) und <em>dplyr</em> (zum Arbeiten mit Arrays), <em>scales</em> (zum Arbeiten mit verschiedenen Datenma√üst√§ben) und <em>Cairo</em> (zum Zeichnen von Grafiken von ggplot in Dateien) sofort zu installieren.  All dies kann mit einem einzigen Befehl ausgef√ºhrt werden: </p><br><pre><code class="plaintext hljs">install.packages("ggplot2", "readxl", "scales", "dplyr", "Cairo")</code> </pre> <br><h2 id="sbor-i-podgotovka-dannyh">  Datenerhebung und -aufbereitung </h2><br><p>  Das Erstaunlichste ist, dass diese Phase in jeder Literatur, sei es ein ernstes theoretisches Buch √ºber angewandte theoretische Statistik oder ein Leitfaden f√ºr bestimmte statistische Pakete, sich katastrophal wenig Raum und Zeit widmet.  Nach den Erfahrungen der unabh√§ngigen Forschung und Leitung von Studenten und Nachwuchskollegen ist jedoch bekannt, dass in diesem Stadium der L√∂wenanteil der Zeit und des Aufwands sinken kann, weshalb es sehr wichtig ist, diese auch bei der L√∂sung rein technischer Probleme zu sparen. </p><br><p>  Hier gibt es zwei Fragen: </p><br><ol><li>  Wie w√§hle ich das richtige Dateiformat? </li><li>  Wie lassen sich Daten am besten strukturieren? </li></ol><br><p>  Mit dem Format ist das Dilemma einfach: CSV im Vergleich zu Microsoft Excel (nicht so wichtig, "neue" .xlsx alte .xls).  Viele Leute glauben, dass CSV von Einfachheit (in der Tat handelt es sich um eine normale Textdatei, bei der die Spaltenwerte durch Komma oder Semikolon getrennt sind) und Geschwindigkeit profitiert.  Ich habe mich aus zwei Gr√ºnden f√ºr Excel entschieden: Erstens k√∂nnen Sie in dieser Datei mehrere Tabellen gleichzeitig auf verschiedenen Registerkarten speichern, und zweitens m√ºssen Sie, was noch wichtiger ist, nicht √ºberlegen, ob Sie das richtige Spaltentrennzeichen und die richtige Dezimalstelle ausw√§hlen.  Bei CSV muss dies h√§ufig manuell in den R-Code geschrieben werden, und es muss sichergestellt werden, dass die Datendatei mit denselben Einstellungen gespeichert wird. </p><br><p>  Die Strukturierung von Daten ist komplexer und erfordert ein grundlegendes Verst√§ndnis f√ºr die Anordnung von Datenbanken. <del>  Wenn Sie sich nicht mit der Theorie relationaler Datenbanken √ºber verschiedene Normalformen befassen, dann </del>  Die Datentabelle muss <em>redundant sein,</em> d. H. Zus√§tzliche Spalten enthalten.  Dies ist notwendig, damit Sie sp√§ter im Skript in R bestimmte Informationen f√ºr die weitere Verarbeitung flexibel ausw√§hlen k√∂nnen.  Wenn wir beispielsweise eine primitive Zeitreihe darstellen m√∂chten, m√ºssen wir Spalten erstellen, die allen m√∂glichen Gruppierungsmerkmalen entsprechen.  Wenn es sich zum Beispiel um eine Reihe j√§hrlicher Beobachtungen der Bev√∂lkerung der bedingten Stadt Sewerowostotschinsk handelt, werden die folgenden Spalten ben√∂tigt: <em>Jahr</em> (Jahr), <em>Var</em> (Indikatorname), <em>Wert</em> (Indikatorwert). </p><br><div class="scrollable-table"><table><thead><tr><th>  Jahr </th><th>  var </th><th>  Wert </th></tr></thead><tbody><tr><td>  1990 </td><td>  Populationsgr√∂√üe </td><td>  102 </td></tr><tr><td>  1991 </td><td>  Populationsgr√∂√üe </td><td>  103 </td></tr><tr><td>  1992 </td><td>  Populationsgr√∂√üe </td><td>  104 </td></tr></tbody></table></div><br><p>  Wir werden alle Eingabedaten f√ºr diese Art der Darstellung von Informationen bereitstellen. </p><br><h2 id="primer">  Beispiel </h2><br><p>  <strong>Ziel:</strong> 2009-2018 einen Vergleich der Dynamik der Erntemengen in Russland, Sibirien und der Region Krasnojarsk erstellen. </p><br><p>  Das Abrufen von Daten f√ºr diese Aufgabe ist ganz einfach: Finden Sie einfach den entsprechenden Indikator im <a href="https://fedstat.ru/indicator/37848">einheitlichen abteilungs√ºbergreifenden Informations- und Statistiksystem</a> .  Subtilit√§t kommt als n√§chstes.  Sie k√∂nnen die Daten sofort im XLSX-Format herunterladen und dann wie oben gezeigt manuell strukturieren.  Gl√ºcklicherweise k√∂nnen Sie dies bei einigen Informationsquellen (z. B. EMISS) mit den Funktionen des Dienstes selbst tun. Dies vereinfacht die Arbeit erheblich und verk√ºrzt den Zeitaufwand f√ºr die Erledigung. </p><br><p>  F√ºr EMISS ist es also ausreichend, in den Modus ‚ÄûEinstellungen‚Äú (die entsprechende Schaltfl√§che in der oberen rechten Ecke der Datenseite) zu wechseln und alle Zeichen au√üer dem ‚ÄûPunkt‚Äú aus der Spalte ‚ÄûSpalten‚Äú in die Spalte ‚ÄûZeilen‚Äú zu verschieben.  Es stellt sich heraus, dass ein Tisch fast bereit f√ºr unsere zuk√ºnftige Arbeit ist.  Dar√ºber hinaus ist es bereits in Excel (oder einem anderen geeigneten Editor) sinnvoll, die Tabellenstruktur auf eine √§hnliche Form wie die oben dargestellte zu bringen und sicherzustellen, dass die erste Zeile nur die Namen von Variablen mit lateinischen Daten enth√§lt (im Prinzip kann R mit russischsprachigen √úberschriften arbeiten) Dies ist jedoch unpraktisch beim Schreiben von Code.  Das Ergebnis war eine solche Tabelle (ein Fragment ist in mehreren Zeilen angegeben). </p><br><div class="scrollable-table"><table><thead><tr><th>  Titel </th><th>  Standort </th><th>  Jahr </th><th>  Wert </th></tr></thead><tbody><tr><td>  Holz geschlagen </td><td>  Russland als Ganzes </td><td>  2009 </td><td>  158868.3 </td></tr><tr><td>  Holz geschlagen </td><td>  Russland als Ganzes </td><td>  2010 </td><td>  173633.7 </td></tr><tr><td>  Holz geschlagen </td><td>  Sibirische FD </td><td>  2009 </td><td>  47161.58 </td></tr><tr><td>  Holz geschlagen </td><td>  Region Krasnojarsk </td><td>  2009 </td><td>  12111,48 </td></tr><tr><td>  Holz geschlagen </td><td>  Region Krasnojarsk </td><td>  2010 </td><td>  12078.6 </td></tr></tbody></table></div><br><p>  Jetzt k√∂nnen Sie diese <code>graphs.xlsx</code> aufrufen, das gesamte Buch in der Datei <code>graphs.xlsx</code> speichern und zu RStudio <code>graphs.xlsx</code> . </p><br><p>  Wir verbinden die notwendigen Bibliotheken. </p><br><pre> <code class="plaintext hljs">library(ggplot2) library(readxl) library(Cairo) library(scales) library(dplyr)</code> </pre> <br><p>  Wenn ein Zeitplan f√ºr eine russischsprachige Ver√∂ffentlichung vorbereitet wird, m√ºssen Sie das entsprechende Gebietsschema unbedingt konfigurieren.  Die modernste Option, die in den meisten F√§llen funktioniert, ist nat√ºrlich die UTF-8-Codierung: </p><br><pre> <code class="plaintext hljs">Sys.setlocale("LC_ALL", "ru_RU.UTF-8")</code> </pre> <br><p>  Wenn das System alt ist (einige alte Windows- oder Linux-Versionen), m√ºssen Sie zun√§chst verstehen, welche Codierung standardm√§√üig verwendet wird - dies ist keine so einfache Aufgabe, die weit vom Zweck dieses Artikels entfernt ist. </p><br><p>  Jetzt m√ºssen Sie die Daten in R laden. </p><br><pre> <code class="plaintext hljs">df_logging &lt;- read_excel("graphs.xlsx", sheet ="logging")</code> </pre> <br><p>  Die Blattoption hier legt den Namen des Blatts in der Excel-Arbeitsmappe fest, aus der die Daten geladen werden. </p><br><p>  Wir erstellen die einfachste Version des erforderlichen Zeitplans. </p><br><pre> <code class="plaintext hljs">ggplot(data=df_logging, aes(x=year, y=value)) + geom_line(aes(linetype=location))</code> </pre> <br><img src="https://habrastorage.org/webt/us/fr/of/usfrof2gizhjlejcid_nvctyf6y.png"><br><p>  Im Prinzip erwies sich fast ‚Äûout of the box‚Äú als sehr lohnenswerter Zeitplan, der f√ºr eine erste Analyse des untersuchten Prozesses durchaus geeignet ist, im Hinblick auf eine m√∂gliche Ver√∂ffentlichung jedoch noch erhebliche Verbesserungen erfordert. </p><br><p>  Lassen Sie uns zun√§chst den Grafikstil auf einen akademischeren √ºbertragen.  Das <code>ggplot2</code> Paket enth√§lt mehrere vorgefertigte <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">Grundthemen</a> .  Das Theme von <code>theme_classic</code> ist f√ºr unseren Fall am besten geeignet.  Im Rahmen der Konfiguration k√∂nnen Sie die Basisgr√∂√üe der Schriftart und des Headsets sofort festlegen.  Meine pers√∂nlichen Vorlieben geh√∂ren zum modernen Schriftsystem <a href="http://rus.paratype.ru/pt-sans-pt-serif">PT Sans, PT Serif, PT Mono</a> .  Aber Sie k√∂nnen nat√ºrlich auch nach einer klassischeren Times oder nach Helvetica fragen.  Auch die Ver√∂ffentlichung, in der die Ver√∂ffentlichung geplant ist, kann diesbez√ºglich spezielle Anweisungen enthalten.  Der Basispunkt wird empirisch zu 12 pt bestimmt. </p><br><pre> <code class="plaintext hljs">ggplot(data=df_logging, aes(x=year, y=value)) + geom_line(aes(linetype=location)) + theme_classic(base_family = "PT Sans", base_size = 12)</code> </pre> <br><img src="https://habrastorage.org/webt/qi/iu/xo/qiiuxoipgdyjymilgxmuobd1eqm.png"><br><p>  Bewegen Sie anschlie√üend die Legende aus dem rechten Feld des Diagramms nach unten (mithilfe der <code>theme</code> ) und geben Sie den Achsen gleichzeitig aussagekr√§ftige Namen ( <code>labs</code> ).  Entlang der Y-Achse schreiben wir den Namen des Indikators mit Ma√üeinheiten ("Protokollvolumen, Millionen Kubikmeter") und l√∂schen die Beschriftungen entlang der X-Achse insgesamt, da klar ist, dass dort Jahre markiert sind. </p><br><pre> <code class="plaintext hljs">ggplot(data=df_logging, aes(x=year, y=value)) + geom_line(aes(linetype=location)) + theme_classic(base_family = "PT Sans", base_size = 12) + theme(legend.title = element_blank(), legend.position="bottom", legend.spacing.x = unit(0.5, "lines")) + labs(x = "", y = " , . . ", color="")</code> </pre> <br><img src="https://habrastorage.org/webt/ia/lb/ww/ialbww1uazrcpr094vbiivbkw84.png"><br><p>  Um die Ma√üeinheiten f√ºr die Wahrnehmung komfortabler zu machen, werden wir von tausend Kubikmetern abweichen.  m bis Millionen.  Teilen Sie dazu einfach die Werte durch 1000, dh passen Sie die erste Zeile unseres Codes wie folgt an: </p><br><pre> <code class="plaintext hljs">ggplot(data=df_logging, aes(x=year, y=value/1000))</code> </pre> <br><p>  Gleichzeitig m√ºssen Sie die Einheiten in der Beschriftung √§ndern: </p><br><pre> <code class="plaintext hljs">labs(x = "", y = " ,  . ", color="")</code> </pre> <br><p>  Und sofort werden wir den Bildstil leicht verbessern, indem wir Punkte hinzuf√ºgen, um jeden beobachteten Wert anzuzeigen, f√ºr den wir eine Anweisung hinzuf√ºgen: </p><br><pre> <code class="plaintext hljs">geom_point(size=2)</code> </pre> <br><p>  Sie k√∂nnen auch den Stil der Linien selbst explizit festlegen.  Es ist logisch, den Indikator f√ºr Russland als durchgezogene Linie und f√ºr den Sibirischen F√∂derationsbezirk und das Krasnojarsker Territorium zu definieren - verschiedene Versionen von intermittierenden: </p><br><pre> <code class="plaintext hljs">scale_linetype_manual(values=c("twodash", "solid", "dotted"))</code> </pre> <br><p>  Nun sehen der allgemeine Code und das Diagramm folgenderma√üen aus: </p><br><pre> <code class="plaintext hljs">ggplot(data=df_logging, aes(x=year, y=value/1000)) + geom_line(aes(linetype=location)) + geom_point(size=1) + theme_classic(base_family = "PT Sans", base_size = 12) + theme(legend.title = element_blank(), legend.position="bottom", legend.spacing.x = unit(0.5, "lines")) + scale_linetype_manual(values=c("twodash", "solid", "dotted")) + labs(x = "", y = " ,  . ", color="")</code> </pre> <br><img src="https://habrastorage.org/webt/x_/0i/-q/x_0i-qbvghhild9wwm3jab5kpcc.png"><br><p>  Es bleibt eine inhaltlichere Aufgabe zu l√∂sen - den Informationsgehalt unseres Zeitplans zu erh√∂hen.  Daraus ist nun zu ersehen, dass der Indikator f√ºr alle Beobachtungsobjekte im Allgemeinen gewachsen ist, au√üerdem ist er seit etwa 2014 st√§rker als zuvor.  Aber es w√§re viel klarer, wenn wir auch die Werte im ersten und letzten Jahr und zum Beispiel in der Spitze des Jahres 2011 direkt in der Grafik darstellen w√ºrden.  Die neue <code>geom_text</code> Anweisung hilft: </p><br><pre> <code class="plaintext hljs">geom_text(aes(label=format(value/1000, digits = 3, decimal.mark = ",")), data = subset(df_logging, year == 2009 | year == 2018 | year == 2011), check_overlap = TRUE, vjust=-0.8)</code> </pre> <br><p>  Auf den ersten Blick sieht es ziemlich kompliziert aus, und ich muss sagen, dass es wirklich nicht so einfach war, es zusammenzubauen.  Ich werde versuchen zu erkl√§ren, was hier passiert.  <code>geom_text</code> f√ºgt dem Diagramm <code>geom_text</code> hinzu.  F√ºr diesen Befehl wird ein Datensatz ben√∂tigt.  Wenn wir <code>df_logging</code> direkt darin spezifizieren <code>df_logging</code> , w√ºrden wir Beschriftungen √ºber jedem Punkt erhalten.  Dies wird ziemlich oft gemacht, aber f√ºr relativ einfache Zeitreihen wie unsere wird dieser Ansatz nur unn√∂tiges visuelles Rauschen erzeugen, ohne uns neue Informationen √ºber das Verhalten des beobachteten Indikators zu liefern.  Daher werden wir nur die Jahre ber√ºcksichtigen, die f√ºr das Verst√§ndnis der Dynamik des Indikators wesentlich sind: 2009 (Beginn der Beobachtungen), 2011 (lokaler H√∂chstwert), 2018 (Ende der Beobachtungen).  Dies wird der Standard- <code>subset</code> helfen. </p><br><p>  F√ºr die korrekte Darstellung von Zahlen gem√§√ü der russischsprachigen Tradition ben√∂tigen wir ein Komma als Trennzeichen zwischen Ganzzahl und Dezimalstelle ( <code>decimal.mark</code> ) und f√ºr das Abschneiden der Anzahl der Nachkommastellen die <code>decimal.mark</code> .  Verschiedene Experimente damit, einschlie√ülich der Verwendung der Rundungsfunktion, f√ºhrten dazu, dass wir, wenn wir eine Dezimalstelle ben√∂tigen, den Wert <code>3</code> an die <code>digits</code> . </p><br><p>  Die Option <code>check_overlap</code> wird hier nicht direkt ben√∂tigt, kann aber in anderen F√§llen n√ºtzlich sein: Sie dient zur automatischen Kontrolle √ºberlappender Beschriftungen.  Die Option vjust steuert die vertikale Platzierung von Beschriftungen.  Der Wert wird nach Geschmacksgesichtspunkten ausgew√§hlt. </p><br><img src="https://habrastorage.org/webt/fk/m2/fb/fkm2fbzy05xdbulnx1rs8mznimu.png"><br><p>  Nun ist der Zeitplan wirklich interessant zu betrachten! </p><br><p>  Es wurde jedoch ein unerwartetes Problem festgestellt: Der obere rechte Wert wird durch die vertikale Gr√∂√üe des Bildes abgeschnitten.  Es gibt verschiedene M√∂glichkeiten, um dieses Problem zu l√∂sen.  Ich stieg mit einer leichten Ausdehnung der vertikalen Achsenskala mit einer expliziten Obergrenze von 250 Millionen Kubikmetern aus.  m: </p><br><pre> <code class="plaintext hljs">scale_y_continuous(limits = c(0,250))</code> </pre> <br><img src="https://habrastorage.org/webt/nm/sv/il/nmsvilg49qwuzhj3biqrhohepao.png"><br><p>  Fertig  Der endg√ºltige Code sieht also so aus: </p><br><pre> <code class="plaintext hljs">ggplot(data=df_logging, aes(x=year, y=value/1000)) + geom_line(aes(linetype=location)) + geom_point(size=1) + theme_classic(base_family = "PT Sans", base_size = 12) + theme(legend.title = element_blank(), legend.position="bottom", legend.spacing.x = unit(0.5, "lines")) + geom_text(aes(label=format(value/1000, digits = 3, decimal.mark = ",")), data = subset(df_logging, year == 2009 | year == 2018 | year == 2011), check_overlap = TRUE, vjust=-0.8) + geom_text(aes(label=format(value/1000, digits = 3, decimal.mark = ",")), data = subset(df_logging, year == 2009 | year == 2018 | year == 2011), check_overlap = TRUE, vjust=-0.8) + scale_linetype_manual(values=c("twodash", "solid", "dotted")) + scale_y_continuous(limits = c(0,250)) + labs(x = "", y = " ,  . ", color="")</code> </pre> <br><blockquote>  Das resultierende Bild ist in der Monografie enthalten: Strukturmodernisierung als Faktor zur Steigerung der Wettbewerbsf√§higkeit der Region (am Beispiel des Krasnojarsker Territoriums) / ed.  Shishatsky N.G. - Novosibirsk: IEOPP SB RAS, 2020 (im Druck). </blockquote><br><h2 id="eksport">  Exportieren </h2><br><p>  Mit dem in RStudio integrierten Plug-In f√ºr die Grafikanzeige k√∂nnen Sie Bilder in verschiedenen Formaten ohne zus√§tzliche Befehle mit nur wenigen Klicks exportieren.  Das Problem ist, dass dieser Dienst f√ºr praktische Aufgaben praktisch nutzlos ist.  Beim Speichern in Rasterformaten (.jpg, .png) ist die Standardeinstellung sehr niedrig. Wenn Sie also beispielsweise ein Bild in Word importieren, wird es unscharf.  Bei den Vektoren .eps oder .pdf ist die Situation offen gesagt noch schlimmer: Das Speichern erfolgt entweder bei Fehlern, bei denen das √ñffnen der Datei nicht m√∂glich ist, oder ohne die M√∂glichkeit, russischsprachige Inschriften zu verwenden. </p><br><p>  Die L√∂sung besteht darin, die <code>ggsave</code> Funktion aus dem <code>ggplot</code> Paket zu verwenden. </p><br><p>  Wenn f√ºr die Ausgabe eine normale Rasterdatei erforderlich ist, z. B. im PNG-Format, ist alles ganz einfach: </p><br><pre> <code class="plaintext hljs">ggsave("logging.png", width=709, height=549, units="px")</code> </pre> <br><p>  Die Geometrie (Optionen <code>width</code> und <code>height</code> ) und Ma√üeinheiten ( <code>units</code> ) k√∂nnen weggelassen werden, aber dann wird das Bild standardm√§√üig quadratisch exportiert, was kaum praktisch ist.  Aus diesem Grund ist es besser, Ihren eigenen Anteil und die erforderliche Gr√∂√üe zu ermitteln und diese Parameter manuell festzulegen, wie in der obigen Codezeile beschrieben. </p><br><p>  F√ºr die sp√§tere Verwendung des Bildes in Papierpublikationen ist es sinnvoll, das Bild in Vektorformaten zu exportieren, damit sp√§ter im Layout die Bildgeometrie frei ver√§ndert werden kann.  Viele Magazine bevorzugen das .eps-Format - es ist auch praktisch, es f√ºr den Export nach Word zu verwenden.  Wir ben√∂tigen den bereits installierten und verbundenen Cairo-Treiber: </p><br><pre> <code class="plaintext hljs">ggsave(filename = "export.eps", width=15, height=11.6, units="cm", device = cairo_ps)</code> </pre> <br><p>  Dateien werden in dem aktuellen Verzeichnis gespeichert, in dem sich das R-Skript befindet. </p><br><h1 id="chto-esche-pochitat">  Was gibt es noch zu lesen </h1><br><p>  Die Literatur zu Grafiken in R ist ziemlich umfangreich.  Hier sind einige Beispiele, von denen das erste die Arbeit des Autors des ggplot-Pakets ist: </p><br><ul><li>  <a href="https://ggplot2-book.org/">Wickham, Hadley.</a>  <a href="https://ggplot2-book.org/">ggplot2: Elegante Grafiken f√ºr die Datenanalyse</a> ; </li><li>  <a href="https://r-graphics.org/">Chang, Winston.</a>  <a href="https://r-graphics.org/">R Graphics Cookbook, 2. Auflage</a> ; </li><li>  <a href="http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html">Prabhakaran, Selva.</a>  <a href="http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html">Top 50 ggplot2-Visualisierungen - Die Master-Liste (mit vollst√§ndigem R-Code)</a> . </li></ul><br><p>  Das wahrscheinlich beste und ausf√ºhrlichste Buch √ºber Grafiken in R in russischer Sprache ist das Buch von <a href="https://tsamsonov.github.io/r-geo-course/">Timofei Samsonov.</a>  <a href="https://tsamsonov.github.io/r-geo-course/">Visualisierung und Analyse von Geodaten in der R-Sprache</a> .  Dies ist eine ausgezeichnete, detaillierte Anleitung zu vielen allgemeinen und spezifischen Problemen, die mit R gel√∂st werden k√∂nnen. </p><br><p>  Sie k√∂nnen auch ein Buch in Russisch √ºber R im Allgemeinen empfehlen: <br>  <a href="https://github.com/ranalytics/data-mining">Shitikov V.K., Mastitsky S.E. Klassifikation, Regression, Data Mining-Algorithmen unter Verwendung von R. 2017</a> . </p><br><p>  Ein interessantes und motivierendes Beispiel ist eine <a href="http://johnburnmurdoch.github.io/slides/r-ggplot/">aussagekr√§ftige Pr√§sentation zum Einsatz von ggplot2 bei der Erstellung von Zeichnungen f√ºr die einflussreiche Financial Times</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de486024/">https://habr.com/ru/post/de486024/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de486000/index.html">ADSM3. IPAM / DCIM-Systeme</a></li>
<li><a href="../de486006/index.html">Speichern Sie den Chat-Status auf dem Stapel</a></li>
<li><a href="../de486010/index.html">Erstellen Sie eine Demo f√ºr ein altes Telefon - AONDEMO</a></li>
<li><a href="../de486014/index.html">SLAC-Tour: Nationales Beschleunigerlabor des US-Energieministeriums in Stanford</a></li>
<li><a href="../de486018/index.html">Ergebnisse der Sitzungsumfrage</a></li>
<li><a href="../de486028/index.html">Neuronale Netze bei der Herstellung von Zahnersatz</a></li>
<li><a href="../de486030/index.html">TL-SREET 55 5K LED Stra√üenlaterne Bewertung</a></li>
<li><a href="../de486032/index.html">So werden Sie Dialogdesigner</a></li>
<li><a href="../de486034/index.html">Schneller Einstieg in das Produktmanagement √ºber Open Source</a></li>
<li><a href="../de486036/index.html">Text-Stimmungsanalyse auf Node.js</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>