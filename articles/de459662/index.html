<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõ¢Ô∏è ‚òïÔ∏è üêá PVS-Studio wollte, konnte aber keine Fehler in robots.txt finden üë®‚Äçüë¶ üëª ‚Ü©Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Neulich hat Google den Quellcode f√ºr den Parser robots.txt ver√∂ffentlicht. F√ºhren Sie das bereits von PVS-Studio getestete Projekt aus und finden Sie ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PVS-Studio wollte, konnte aber keine Fehler in robots.txt finden</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/459662/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6a4/303/c49/6a4303c496535ce7c7fc9ff84f2608ee.png" alt="Bild 1"></div><br>  Neulich hat Google den Quellcode f√ºr den Parser robots.txt ver√∂ffentlicht.  F√ºhren Sie das bereits von PVS-Studio getestete Projekt aus und finden Sie m√∂glicherweise einen Fehler.  Kaum gesagt als getan.  Schade, dass nichts Bedeutendes gefunden werden konnte.  Dann ist es nur eine Ausrede, Google-Entwickler zu loben. <br><br>  robots.txt - Eine Indexdatei, die die Regeln f√ºr Suchroboter enth√§lt.  Es gilt f√ºr die Protokolle https, http und ftp.  Google hat seinen Datei-Parser robots.txt f√ºr alle verf√ºgbar gemacht.  Lesen Sie hier mehr √ºber diese Neuigkeiten: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Google √∂ffnet den Quellcode des Pars robots.txt</a> <br><a name="habracut"></a><br>  Ich denke, dass die meisten Leser unserer Artikel wissen, was PVS-Studio macht.  Falls Sie neu in unserem Blog sind, geben wir eine kurze Referenz.  PVS-Studio ist ein statischer Code-Analysator, mit dem Sie eine Vielzahl von Fehlern, Schwachstellen und M√§ngeln in Projekten finden k√∂nnen, die in C, C ++, C # und Java geschrieben wurden.  Mit anderen Worten, PVS-Studio ist eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SAST-</a> L√∂sung und kann sowohl auf Benutzercomputern oder Build-Servern als auch in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cloud verwendet werden</a> .  Das PVS-Studio-Team schreibt gerne <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> √ºber die √úberpr√ºfung verschiedener Projekte.  Kommen wir also zur Sache und versuchen, Fehler im Parser-Quellcode von Google zu finden. <br><br>  Zu unserem Bedauern und zur Freude aller anderen wurden keine Fehler gefunden.  Es wurden nur ein paar kleinere M√§ngel gefunden, √ºber die wir sprechen werden.  Du musst wenigstens etwas schreiben :).  Das Fehlen von Fehlern erkl√§rt sich aus dem geringen Projektvolumen und der hohen Qualit√§t des Codes.  Dies bedeutet nicht, dass sich einige Fehler dort nicht verbergen, aber die statische Analyse erwies sich im Moment als machtlos. <br><br>  Im Allgemeinen stellte sich dieser Artikel im Geiste unserer anderen Ver√∂ffentlichung heraus: " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Der k√ºrzeste Artikel zur Nginx-Verifizierung</a> ." <br><br>  Es bestand die M√∂glichkeit einer kleinen Optimierung: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V805</a> Leistungsminderung.  Es ist ineffizient, eine leere Zeichenfolge mithilfe des Konstrukts 'strlen (str)&gt; 0' zu identifizieren.  Eine effizientere M√∂glichkeit besteht darin, Folgendes zu √ºberpr√ºfen: str [0]! = '\ 0'.  robots.cc 354 <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> RobotsTxtParser::GetKeyAndValueFrom(<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **key, ....) { .... *key = line; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(*key) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br>  Das Aufrufen der Funktion <i>strlen</i> , um herauszufinden, ob eine Zeichenfolge nicht leer ist, ist ineffizient.  Eine solche √úberpr√ºfung kann viel einfacher gemacht werden: <i>if (* key [0]! = '\ 0')</i> , und Sie m√ºssen nicht alle Elemente der Zeichenfolge durchgehen, wenn sie nicht leer ist. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Das V808</a> -Objekt 'path' vom Typ 'basic_string' wurde erstellt, aber nicht verwendet.  robots.cc 123 <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPathParamsQuery</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> path; .... }</code> </pre> <br>  Die Pfadzeichenfolge wird deklariert, aber nicht weiter verwendet.  In einigen F√§llen k√∂nnen nicht verwendete Variablen auf einen Fehler hinweisen.  Aber hier scheint es, dass diese Variable fr√ºher irgendwie verwendet wurde, aber nach den √Ñnderungen wurde sie nicht mehr ben√∂tigt.  Daher hilft der Analysator h√§ufig auch dabei, den Code sauberer zu gestalten und Fehler zu vermeiden, indem einfach die Voraussetzungen f√ºr ihr Erscheinungsbild entfernt werden. <br><br>  Im folgenden Fall empfiehlt der Analysator im Wesentlichen, eine Standardr√ºckgabe hinzuzuf√ºgen, nachdem alle <i>Hauptdaten</i> verarbeitet wurden.  Es k√∂nnte sich lohnen, ganz am Ende eine <i>Rendite</i> hinzuzuf√ºgen, damit Sie verstehen, dass alles wirklich funktioniert hat.  Wenn dieses Verhalten jedoch geplant war und nichts ge√§ndert werden musste und ich die Analysatormeldung nicht sehen m√∂chte, k√∂nnen Sie diese Warnung im Fall von PVS-Studio unterdr√ºcken und nie wieder sehen :). <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V591</a> Die Funktion 'main' gibt keinen Wert zur√ºck, der 'return 0' entspricht.  Es ist m√∂glich, dass dies ein unbeabsichtigtes Verhalten ist.  robots_main.cc 99 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">** argv)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (filename == <span class="hljs-string"><span class="hljs-string">"-h"</span></span> || filename == <span class="hljs-string"><span class="hljs-string">"-help"</span></span> || filename == <span class="hljs-string"><span class="hljs-string">"--help"</span></span>) { ShowHelp(argc, argv); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (argc != <span class="hljs-number"><span class="hljs-number">4</span></span>) { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"...."</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } }</code> </pre> <br>  Es wurde auch festgestellt, dass die beiden folgenden Funktionen mit unterschiedlichen Namen dieselbe Implementierung haben.  Vielleicht ist dies das Ergebnis der Tatsache, dass diese Funktionen zuvor unterschiedliche Logik hatten, aber zu derselben kamen.  Oder es kann sein, dass sich irgendwo ein Tippfehler eingeschlichen hat, weshalb solche Warnungen sorgf√§ltig gepr√ºft werden sollten. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V524</a> Es ist seltsam, dass der Hauptteil der Funktion 'MatchDisallow' dem Hauptteil der Funktion 'MatchAllow' vollst√§ndig entspricht.  robots.cc 645 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MatchAllow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(absl::string_view path, absl::string_view pattern)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Matches(path, pattern) ? pattern.length() : <span class="hljs-number"><span class="hljs-number">-1</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MatchDisallow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(absl::string_view path, absl::string_view pattern)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Matches(path, pattern) ? pattern.length() : <span class="hljs-number"><span class="hljs-number">-1</span></span>; }</code> </pre> <br>  Dies ist der einzige Ort, der mich misstrauisch macht.  Es sollte von den Autoren des Projekts √ºberpr√ºft werden. <br><br>  Die √úberpr√ºfung des Robser.txt-Parsers von Google ergab daher, dass das Projekt, das so aktiv verwendet und h√∂chstwahrscheinlich wiederholt auf Fehler getestet wird, einen qualitativ hochwertigen Code aufweist.  Und die festgestellten M√§ngel k√∂nnen den Eindruck nicht zerst√∂ren, welche coolen Codierer von Google an diesem Projekt beteiligt waren :). <br><br>  Wir bieten Ihnen an <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">, PVS-Studio</a> f√ºr das Projekt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">herunterzuladen und zu testen,</a> an dem Sie interessiert sind. <br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/c78/30f/70c/c7830f70c5577c3d6704f254d7cad6a3.png" align="left"></a> </p><br><br>  Wenn Sie diesen Artikel einem englischsprachigen Publikum zug√§nglich machen m√∂chten, verwenden Sie bitte den Link zur √úbersetzung: Victoria Khanieva.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PVS-Studio wollte, konnte aber keine Fehler in robots.txt finden</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de459662/">https://habr.com/ru/post/de459662/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de459648/index.html">Im Analysator sollte alles in Ordnung sein: sowohl Funktionalit√§t als auch Schnittstelle ... Wir untersuchen die neue Solar AppScreener 3.1-Schnittstelle</a></li>
<li><a href="../de459650/index.html">So verlieren Sie kein Geld in der Black Box: Abrechnungstestmethoden</a></li>
<li><a href="../de459652/index.html">Automatisierter Regressionstestansatz</a></li>
<li><a href="../de459656/index.html">OData-Dienst ohne Code schreiben</a></li>
<li><a href="../de459658/index.html">PVS-Studio wollte, konnte aber keine Fehler in robots.txt finden</a></li>
<li><a href="../de459668/index.html">Erkennen von Text auf einem Foto: Neue Funktionen des Vision-Frameworks</a></li>
<li><a href="../de459670/index.html">Gehe nach Amsterdam</a></li>
<li><a href="../de459672/index.html">Unterstreichen Sie in Python</a></li>
<li><a href="../de459674/index.html">Threat Intelligence Epic Saga</a></li>
<li><a href="../de459680/index.html">Nach Highload ++ Siberia 2019 - 8 Oracle-Aufgaben</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>