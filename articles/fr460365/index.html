<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💿 🤰🏼 ⚫️ Trace distribuée: nous avons tout mal fait 🤱🏽 🤞 ⏲️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Remarque perev. : L'auteur de ce document est Cindy Sridharan, une ingénieure d'imgix impliquée dans le développement d'API et, en particulier, dans l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Trace distribuée: nous avons tout mal fait</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/460365/">  <i><b>Remarque</b></i>  <i><b>perev.</b></i>  <i>: L'auteur de ce document est Cindy Sridharan, une ingénieure d'imgix impliquée dans le développement d'API et, en particulier, dans le test de microservices.</i>  <i>Dans cet article, elle partage sa vision détaillée des problèmes réels dans le domaine du traçage distribué, où, à son avis, il y a un manque d'outils vraiment efficaces pour résoudre les problèmes urgents.</i> <br><br><img src="https://habrastorage.org/webt/zu/va/og/zuvaogffo6d3gqi1mmzq5ts3zoc.png"><br>  <i>[L'illustration est empruntée à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un autre document</a> sur le traçage distribué.]</i> <br><br>  On pense que le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">traçage distribué est</a> difficile à mettre en œuvre et son retour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">est au mieux douteux</a> .  Le «problème» de la trace s'explique par de nombreuses raisons, faisant souvent référence à la complexité de la configuration de chaque composant du système pour transmettre les en-têtes correspondants avec chaque requête.  Bien que ce problème se produise, il ne peut pas du tout être qualifié d'insurmontable.  Soit dit en passant, cela n'explique pas pourquoi les développeurs n'aiment pas vraiment le traçage (même déjà fonctionnel). <a name="habracut"></a><br><br>  La principale difficulté du suivi distribué n'est pas de collecter des données, de ne pas normaliser les formats de distribution et de présentation des résultats, et de ne pas déterminer quand, où et comment échantillonner.  Je n'essaie pas du tout de présenter ces «problèmes de digestibilité» comme <i>triviaux</i> - en fait, il y a des défis techniques et politiques (si nous examinons vraiment les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">normes et protocoles</a> Open Source) politiques qui doivent être surmontés pour que ces problèmes puissent être considérés résolus. <br><br>  Cependant, si vous imaginez que tous ces problèmes ont été résolus, il est probable que rien ne changera considérablement en termes d' <i>expérience de l'utilisateur final</i> .  Le suivi n'est peut-être toujours pas pratique dans les scénarios de débogage les plus courants, même après son déploiement. <br><br><h2>  Une telle trace différente </h2><br>  Le traçage distribué comprend plusieurs composants disparates: <br><br><ul><li>  équiper les applications et les middlewares de commandes; </li><li>  Transmission de contexte distribué </li><li>  collecte de traces; </li><li>  stockage des traces; </li><li>  leur extraction et visualisation. </li></ul><br>  Beaucoup de discussions sur le traçage distribué se résument à le considérer comme une sorte d'opération unaire, dont le seul but est d'aider au diagnostic complet du système.  Cela est largement dû à la manière dont le concept de traçage distribué a été formé.  Dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un blog</a> publié lors de l'ouverture des sources Zipkin, il a été mentionné <i>qu'il [Zipkin] rend Twitter plus rapide</i> .  Les premières offres commerciales de traçage ont également été promues comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">outils APM</a> . <br><br>  <i><b>Remarque</b></i>  <i><b>perev.</b></i>  <i>: Afin de mieux comprendre le texte, nous définissons deux termes de base selon la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation du projet OpenTracing</a> :</i> <br><br><ul><li>  <i><b>Span</b> - l'élément de base du traçage distribué.</i>  <i>Il s'agit d'une description d'un certain flux de travail (par exemple, une requête de base de données) avec un nom, des heures de début et de fin, des balises, des journaux et un contexte.</i> </li><li>  <i>Les travées contiennent généralement des liens vers d'autres travées, ce qui vous permet de combiner plusieurs travées dans <b>Trace</b> - une visualisation de la durée de vie d'une demande lorsqu'elle se déplace à travers un système distribué.</i> </li></ul><br>  Trace'y contient des données incroyablement précieuses qui peuvent vous aider dans des tâches telles que: tests en production, tests de reprise après sinistre, tests avec introduction d'erreurs, etc.  En fait, certaines entreprises utilisent déjà le traçage à ces fins.  Pour commencer, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le transfert de contexte universel</a> a d'autres utilisations en plus du simple transfert de portées vers le système de stockage: <br><br><ul><li>  Par exemple, Uber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">utilise</a> les résultats de la trace pour faire la distinction entre le trafic de test et le trafic de production. </li><li>  Facebook <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">utilise des</a> données de trace pour analyser le chemin critique et pour basculer le trafic lors des tests de reprise après sinistre réguliers. </li><li>  Le réseau social <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">utilise</a> également <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">des</a> blocs-notes Jupyter, qui permettent aux développeurs d'exécuter des requêtes arbitraires sur les résultats du traçage. </li><li>  Les adhérents <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">LDFI</a> (Lineage Driven Failure Injection <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">)</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">utilisent</a> des traces distribuées pour les tests d'erreur. </li></ul><br>  Aucune des options ci-dessus ne se rapporte entièrement au scénario de <i>débogage</i> , au cours duquel l'ingénieur essaie de résoudre le problème en examinant la trace. <br><br>  En ce qui concerne le scénario de débogage, le diagramme <i>traceview</i> reste l'interface principale (bien que certains l'appellent également le <i>"diagramme de Gantt"</i> ou le <i>"diagramme en cascade"</i> ).  Par <i>traceview,</i> je <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">veux dire</a> toutes les <i>étendues</i> et les métadonnées associées qui constituent ensemble la trace.  Chaque système de trace open source, ainsi que chaque solution de trace commerciale, offre une interface utilisateur basée sur <i>traceview</i> pour visualiser, détailler et filtrer les données de trace. <br><br>  Le problème avec tous les systèmes de trace que je connais en ce moment est que la <i>visualisation</i> finale <i>(traceview)</i> reflète presque complètement les caractéristiques du processus de génération de trace.  Même lorsque des visualisations alternatives sont proposées: cartes d'intensité (heatmap), topologies de service, histogrammes de latence - au final, elles se <i>résument</i> toujours à <i>traceview</i> . <br><br>  Dans le passé, je me <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">plaignais</a> que la plupart des «innovations» en matière de traçabilité en ce qui concerne l'interface utilisateur / l'expérience utilisateur semblent <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">se</a> limiter à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">inclure</a> des métadonnées supplémentaires dans la trace, à incorporer des informations avec <i>une cardinalité élevée</i> , ou à fournir la possibilité de parcourir des plages spécifiques ou exécuter des requêtes <i>inter- et intra-trace</i> .  Dans ce cas, <i>traceview</i> reste le principal moyen de visualisation.  Tant que cet état de choses persiste, le traçage distribué occupera (au mieux) la 4e place en tant qu'outil de débogage, suivi des métriques, des journaux et des traces de pile, et au pire, cela se révélera être une perte d'argent et de temps. <br><br><h2>  Problème avec traceview </h2><br>  Le but de <i>traceview</i> est de fournir une image complète du mouvement d'une demande individuelle à travers tous les composants d'un système distribué auquel elle se rapporte.  Certains systèmes de traçage plus avancés vous permettent d'explorer des plages individuelles et de visualiser la répartition du temps <i>au sein d'un</i> même processus (lorsque les plages ont des limites fonctionnelles). <br><br>  Le principe de base de l'architecture de microservices est l'idée que la structure organisationnelle croît avec les besoins de l'entreprise.  Les partisans des microservices soutiennent que la distribution de diverses tâches commerciales sur des services distincts permet à de petites équipes de développement autonomes de contrôler l'ensemble du cycle de vie de ces services, leur permettant de créer, tester et déployer ces services de manière indépendante.  Cependant, l'inconvénient de cette distribution est la perte d'informations sur la façon dont chaque service interagit avec les autres.  Dans de telles circonstances, le traçage distribué prétend être un outil indispensable pour <i>déboguer</i> les interactions complexes entre les services. <br><br>  Si vous avez un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">système distribué</a> vraiment <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">incroyablement complexe</a> , alors personne ne peut garder à l'esprit son image <i>complète</i> .  En fait, développer un outil basé sur l'hypothèse qu'il est généralement possible est un peu un contre-modèle (approche inefficace et improductive).  Idéalement, le débogage nécessite un outil pour <i>affiner votre recherche</i> afin que les ingénieurs puissent se concentrer sur un sous-ensemble des dimensions (services / utilisateurs / hôtes, etc.) qui sont pertinentes pour le scénario en question.  Pour déterminer la cause de la panne, les ingénieurs ne sont pas tenus de comprendre ce qui s'est passé dans <i>tous les services à la fois</i> , car une telle exigence contredirait l'idée même d'une architecture de microservice. <br><br>  Cependant, traceview n'est <i>que</i> cela.  Oui, certains systèmes de trace offrent des vues de trace compressées lorsque le nombre de plages de trace est si important qu'elles ne peuvent pas être affichées dans une seule visualisation.  Cependant, en raison de la grande quantité d'informations contenues même dans une visualisation aussi réduite, les ingénieurs sont toujours <i>obligés de les</i> «filtrer», en limitant manuellement la sélection à un ensemble de sources de problèmes de service.  Hélas, dans ce domaine, les machines sont beaucoup plus rapides que les humains, moins sujettes aux erreurs et leurs résultats sont plus reproductibles. <br><br>  Une autre raison pour laquelle je pense que la méthode traceview est erronée est qu'elle ne convient pas au débogage hypothétique.  À la base, le débogage est un processus <i>itératif</i> commençant par une hypothèse, suivi de la vérification de diverses observations et faits reçus du système à l'aide de différents vecteurs, conclusions / généralisations et une évaluation plus approfondie de la vérité de l'hypothèse. <br><br>  La capacité <i>de</i> tester des hypothèses <i>rapidement et à moindre coût</i> et d'améliorer le modèle mental en conséquence est la <i>pierre angulaire du</i> débogage.  Tout outil de débogage doit être <i>interactif</i> et restreindre l'espace de recherche ou, dans le cas d'une fausse trace, permettre à l'utilisateur de revenir en arrière et de se concentrer sur une autre zone du système.  Un outil idéal le fera de <i>manière proactive</i> , attirant immédiatement l'attention de l'utilisateur sur les zones potentiellement problématiques. <br><br>  Hélas, <i>traceview</i> ne peut pas être appelé un outil d'interface interactive.  Le mieux que vous puissiez espérer en l'utilisant est de détecter une certaine source de retards accrus et de visualiser toutes sortes de balises et de journaux qui lui sont associés.  Cela n'aide pas l'ingénieur à identifier les <i>modèles</i> de trafic, tels que les spécificités de la distribution des retards, ou à détecter les corrélations entre les différentes mesures.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">L'analyse générique des traces</a> peut contourner certains de ces problèmes.  En effet, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">il existe des exemples d'</a> analyse réussie utilisant l'apprentissage automatique pour identifier des plages anormales et identifier un sous-ensemble de balises pouvant être associées à un comportement anormal.  Néanmoins, je n'ai pas encore rencontré de visualisations convaincantes de découvertes faites à l'aide de l'apprentissage automatique ou de l'analyse de données appliquées à des étendues qui seraient significativement différentes de traceview ou DAG (graphique directionnel acyclique). <br><br><h3>  Les portées sont trop faibles </h3><br>  Le problème fondamental avec traceview est que les étendues sont des primitives de niveau trop bas pour l'analyse de latence et l'analyse des causes profondes.  C'est comme analyser des commandes de processeur individuelles dans le but d'éliminer une exception, sachant qu'il existe des outils de niveau beaucoup plus élevé comme backtrace, qui sont beaucoup plus pratiques à utiliser. <br><br>  De plus, je me permettrai d'affirmer ce qui suit: idéalement, nous n'avons pas besoin d'une <i>image complète de</i> ce qui s'est passé pendant le cycle de vie de la demande, que représentent les outils modernes de traçage.  Au lieu de cela, une forme d'abstraction de niveau supérieur est requise, contenant des informations sur ce qui <i>n'a pas fonctionné</i> (similaire à la trace), ainsi qu'un certain contexte.  Au lieu d'observer toute la trace, je préfère en voir une <i>partie</i> où quelque chose d'intéressant ou d'inhabituel se produit.  Actuellement, la recherche est effectuée manuellement: l'ingénieur reçoit une trace et analyse indépendamment les portées à la recherche de quelque chose d'intéressant.  L'approche lorsque les gens regardent des travées sur des traces distinctes dans l'espoir de détecter une activité suspecte n'est pas du tout mise à l'échelle (en particulier lorsqu'ils doivent comprendre toutes les métadonnées encodées dans différentes travées, telles que l'ID de portée, le nom de la méthode RPC, la durée de la portée 'a, journaux, balises, etc.). <br><br><h2>  Alternatives à Traceview </h2><br>  Les résultats de traçage sont plus utiles lorsqu'ils peuvent être visualisés de manière à avoir une idée non triviale de ce qui se passe dans les parties interconnectées du système.  Jusqu'à ce que ce soit le cas, le processus de débogage reste largement <i>inerte</i> et dépend de la capacité de l'utilisateur à remarquer les corrélations correctes, à vérifier les bonnes parties du système ou à assembler des morceaux de la mosaïque ensemble - contrairement à l' <i>outil</i> qui aide l'utilisateur à formuler ces hypothèses. <br><br>  Je ne suis pas un concepteur visuel ou un spécialiste UX, mais dans la section suivante, je veux partager quelques idées sur l'apparence de telles visualisations. <br><br><h3>  Focus sur des services spécifiques </h3><br>  Dans un environnement où l'industrie se consolide autour des idées de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SLO (objectifs de niveau de service) et de SLI (indicateurs de niveau de service)</a> , il semble raisonnable que les équipes individuelles surveillent d'abord la pertinence de leurs services par rapport à ces objectifs.  Il s'ensuit que <i>la</i> visualisation <i>orientée service</i> est la mieux adaptée à de telles équipes. <br><br>  Les traces, en particulier sans échantillonnage, sont un réservoir d'informations sur chaque composant d'un système distribué.  Ces informations peuvent être transmises à un gestionnaire délicat qui fournira aux utilisateurs des découvertes orientées <i>service</i> , qui peuvent être détectées à l'avance - avant même que l'utilisateur ne regarde les traces: <br><br><ol><li>  Diagrammes de distribution des retards uniquement pour les demandes fortement distinguées <i>(demandes aberrantes)</i> ; </li><li>  Diagrammes de distribution des retards pour les cas où les objectifs de service SLO ne sont pas atteints; </li><li>  Les balises les plus «communes», «intéressantes» et «étranges» dans les requêtes, qui sont le plus souvent <i>répétées</i> ; </li><li>  Répartition des retards pour les cas où les <i>dépendances de</i> service n'atteignent pas les objectifs SLO définis; </li><li>  Répartition des retards pour divers services en aval. </li></ol><br>  Les métriques intégrées ne peuvent tout simplement pas répondre à certaines de ces questions, forçant les utilisateurs à étudier attentivement les portées.  En conséquence, nous avons un mécanisme extrêmement hostile à l'utilisateur. <br><br>  À cet égard, la question se pose: qu'en est-il des interactions complexes entre les différents services contrôlés par différentes équipes?  <i>Traceview</i> n'est-il pas considéré comme l'outil le plus approprié pour couvrir une telle situation? <br><br>  Les développeurs mobiles, les propriétaires de services sans état, les propriétaires de services gérés avec état (comme les bases de données) et les propriétaires de plates-formes peuvent être intéressés par une autre <i>vision d'un</i> système distribué;  <i>traceview</i> est une solution beaucoup trop universelle pour ces besoins fondamentalement différents.  Même dans une architecture de microservices très complexe, les propriétaires de services n'ont pas besoin d'une connaissance approfondie de plus de deux ou trois services en amont et en aval.  En substance, dans la plupart des scénarios, les utilisateurs n'ont qu'à répondre à des questions concernant un <i>ensemble limité de services</i> . <br><br>  C'est comme regarder un petit sous-ensemble de services à travers une loupe pour une étude minutieuse.  Cela permettra à l'utilisateur de poser des questions plus pressantes concernant l'interaction complexe entre ces services et leurs dépendances immédiates.  Ceci est similaire à la trame dans le monde des services, où l'ingénieur sait <i>ce qui</i> ne va pas et a également une idée de ce qui se passe dans les services environnants pour comprendre <i>pourquoi</i> . <br><br>  L'approche que je préconise est l'exact opposé de l'approche descendante basée sur traceview, lorsque l'analyse commence par la trace entière, puis descend progressivement vers des travées individuelles.  Au contraire, l'approche ascendante commence par l'analyse d'une petite zone proche de la cause potentielle de l'incident, puis l'espace de recherche est élargi si nécessaire (avec la participation éventuelle d'autres équipes pour analyser une gamme plus large de services).  La seconde approche est mieux adaptée pour tester rapidement les hypothèses initiales.  Après avoir obtenu des résultats spécifiques, il sera possible de passer à une analyse plus ciblée et détaillée. <br><br><h3>  Construction de la topologie </h3><br>  Les vues associées à un service particulier peuvent être incroyablement utiles si l'utilisateur sait <i>quel</i> service ou groupe de services est responsable de l'augmentation des retards ou est une source d'erreurs.  Cependant, dans un système complexe, l'identification d'un intrus peut ne pas être une tâche triviale lors d'une panne, surtout si aucun message d'erreur n'a été reçu des services. <br><br>  La création d'une topologie de service peut être très utile pour déterminer quel service affiche une augmentation du taux d'erreur ou une augmentation de la latence, entraînant une détérioration notable des performances du service.  Parlant de la construction d'une topologie, je ne parle pas d' <i>une carte de service</i> qui affiche tous les services disponibles dans le système et connus pour leurs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cartes d'architecture sous la forme d'une étoile de la mort</a> .  Une telle représentation n'est pas meilleure qu'une trace vue basée sur un graphe acyclique dirigé.  Au lieu de cela, j'aimerais voir une <i>topologie de service générée dynamiquement</i> basée sur certains attributs, tels que le taux d'erreur, le temps de réponse ou tout paramètre spécifié par l'utilisateur qui aide à clarifier la situation avec des services suspects spécifiques. <br><br>  Regardons un exemple.  Imaginez un site de nouvelles hypothétique.  Le service de <i>première page</i> communique avec Redis, avec un service de recommandation, avec un service de publicité et un service vidéo.  Le service vidéo prend des vidéos de S3 et les métadonnées de DynamoDB.  Le service de recommandation reçoit les métadonnées de DynamoDB, télécharge les données de Redis et MySQL, écrit des messages dans Kafka.  Le service de publicité reçoit des données de MySQL et écrit des messages à Kafka. <br><br>  Ce qui suit est une représentation schématique de cette topologie (de nombreux programmes de routage commerciaux construisent la topologie).  Cela peut être utile si vous avez besoin de comprendre les dépendances des services.  Cependant, lors du <i>débogage</i> , lorsqu'un certain service (par exemple, un service vidéo) affiche un temps de réponse accru, une telle topologie n'est pas très utile. <br><br><img src="https://habrastorage.org/webt/qr/85/y9/qr85y98gth6ybvwt5yuditlnack.png"><br>  <i>Système de services de site de nouvelles hypothétiques</i> <br><br>  Le diagramme ci-dessous serait mieux.  Un service problématique <i>(vidéo) y est</i> représenté en plein centre.  L'utilisateur le remarque immédiatement.  De cette visualisation, il devient clair que le service vidéo fonctionne anormalement en raison de l'augmentation du temps de réponse de S3, ce qui affecte la vitesse de téléchargement d'une partie de la page principale. <br><br><img src="https://habrastorage.org/webt/v2/w5/za/v2w5zaf_s1_r8mzo0j6r2dopyyk.png"><br>  <i>Topologie dynamique qui affiche uniquement les services «intéressants»</i> <br><br>  Les schémas topologiques générés dynamiquement peuvent être plus efficaces que les cartes de service statiques, en particulier dans les infrastructures flexibles et évolutives.  La possibilité de comparer et de contraster les topologies de services permet à l'utilisateur de poser des questions plus pertinentes.  Des questions plus précises sur le système sont plus susceptibles de conduire à une meilleure compréhension du fonctionnement du système. <br><br><h3>  Affichage comparatif </h3><br>  Une autre visualisation utile serait un affichage comparatif.  Les traces ne sont actuellement pas bien adaptées aux comparaisons côte à côte, de sorte que les <i>plages</i> sont généralement comparées.  Et l'idée principale de cet article est précisément que les intervalles sont trop bas pour extraire les informations les plus précieuses des résultats de la trace. <br><br>  La comparaison de deux traces'ov ne nécessite pas de visualisations fondamentalement nouvelles.  En fait, quelque chose comme un histogramme représentant les mêmes informations que traceview suffit.  Étonnamment, même cette méthode simple peut apporter beaucoup plus de fruits qu'une simple étude de deux traces séparément.  Encore plus puissant serait la possibilité de <i>visualiser la</i> comparaison des traces <i>dans l'agrégat</i> .  Il serait extrêmement utile de voir comment un changement de configuration de base de données récemment déployé avec l'inclusion de GC (garbage collection) affecte le temps de réponse d'un service en aval en quelques heures.  Si ce que je décris ici ressemble à une analyse A / B de l'impact des changements d'infrastructure <i>dans une variété de services en</i> utilisant des résultats de trace, alors vous n'êtes pas trop loin de la vérité. <br><br><h2>  Conclusion </h2><br>  Je ne remets pas en question l'utilité de la trace elle-même.  Je crois sincèrement qu'il n'y a pas d'autre moyen de collecter des données aussi riches, informelles et contextuelles que celles contenues dans la trace.    ,          .   ,        traceview-,          ,     ,   trace'.  ,          ,         . <br><br>   ,     ,  .        , <b> </b>  ,        .  ,           production   ,   ,      ,       ,     . <br><br>    ,   ,     ,    , ,      .  ,         ,      ,     trace'  span'. <br><br>           (  UI). ,         ,        .        ,           .           .      . <br><br><h2>  PS du traducteur </h2><br>  Lisez aussi dans notre blog: <br><br><ul><li> « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> kubectl-debug    pod' Kubernetes</a> »; </li><li> « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">:   ,     Kubernetes</a> »; </li><li> « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  Kubernetes (   )</a> ». </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr460365/">https://habr.com/ru/post/fr460365/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr460353/index.html">Réseau de neurones dans le verre. Ne nécessite pas d'alimentation, reconnaît les chiffres</a></li>
<li><a href="../fr460355/index.html">Sauver la noyade est notre métier: comment gérer la démotivation des équipes</a></li>
<li><a href="../fr460359/index.html">Cours Young Game Designer 2: équilibrer la progression et la dynamique sans mathématiques</a></li>
<li><a href="../fr460361/index.html">Grande FAQ sur la cybersécurité des systèmes d'information médicale</a></li>
<li><a href="../fr460363/index.html">7 facteurs manquants dans l'approche 12 Factor App</a></li>
<li><a href="../fr460367/index.html">Chaos Engineering: l'art de la destruction intentionnelle. Partie 1</a></li>
<li><a href="../fr460373/index.html">Under the Hood Turbo Pages: Architecture de la technologie de téléchargement rapide des pages Web</a></li>
<li><a href="../fr460375/index.html">Livre "Machine Learning for Business and Marketing"</a></li>
<li><a href="../fr460377/index.html">Utilisation de Liquibase pour gérer la structure de la base de données dans une application Spring Boot. Partie 1</a></li>
<li><a href="../fr460381/index.html">Qu'est-ce que l'assertivité et pourquoi est-elle nécessaire</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>