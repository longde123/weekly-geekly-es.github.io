<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔦 🍲 🍽️ Masalah Pencatatan Kejadian Keamanan Sistem Windows ✋🏼 🌒 ↩️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sistem operasi Windows memiliki sistem pencatatan peristiwa keamanan yang cukup bagus. Banyak hal baik telah ditulis tentangnya di berbagai publikasi ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Masalah Pencatatan Kejadian Keamanan Sistem Windows</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476464/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/r3/ka/al/r3kaaljcd70px_fvggsc4jmu4es.jpeg"></a> <br><br>  Sistem operasi Windows memiliki sistem pencatatan peristiwa keamanan yang cukup bagus.  Banyak hal baik telah ditulis tentangnya di berbagai publikasi dan ulasan, tetapi artikel ini akan membahas hal lain.  Di sini kita berbicara tentang masalah dan kekurangan dalam sistem ini.  Beberapa masalah yang dipertimbangkan akan menjadi tidak kritis, hanya mempersulit prosedur untuk menganalisis peristiwa, sementara yang lain akan menimbulkan ancaman keamanan yang sangat serius. <br><br>  Masalah yang diidentifikasi diuji pada Windows 7 Maximum (versi Rusia), Windows 7 Professional (versi bahasa Inggris), Windows 10 Pro (versi Rusia), Windows Server 2019 Datacenter (versi Rusia).  Semua sistem operasi telah sepenuhnya diperbarui. <br><a name="habracut"></a><br><h2>  Masalah No. 1. Sistem manajemen parameter audit gagal </h2><br>  <i>Masalahnya dikonfirmasi pada Windows 7/10 / Server 2019.</i> <br><br><h3>  Deskripsi masalah </h3><br>  Ambil Windows 7 dan instal dengan pengaturan default.  Kami tidak akan memasukkan domain.  Mari kita lihat pengaturan audit acara keamanan.  Untuk melakukan ini, buka snap-in Kebijakan Keamanan Lokal (secpol.msc, atau Control Panel -&gt; Tools Administratif -&gt; Kebijakan Keamanan Lokal) dan lihat pengaturan audit dasar (Pengaturan Keamanan -&gt; Kebijakan Lokal -&gt; Kebijakan Audit) ) <br><br><img src="https://habrastorage.org/webt/bd/sm/cw/bdsmcwohkqtxgp9dzcac8p63daw.jpeg"><br><br>  Seperti yang Anda lihat, audit tidak dikonfigurasi.  Sekarang mari kita lihat kebijakan audit lanjutan ("Pengaturan Keamanan -&gt; Konfigurasi Kebijakan Audit Lanjutan -&gt; Kebijakan Audit Sistem - Objek Kebijakan Grup Lokal"). <br><br><img src="https://habrastorage.org/webt/om/oy/po/omoypoc15q9ynn0osefv-gawd4i.jpeg"><br><br>  Di sini, audit juga tidak dikonfigurasikan.  Jika demikian, maka secara teori seharusnya tidak ada peristiwa keamanan dalam log.  Kami periksa.  Buka log keamanan (eventvwr.exe, atau "Panel Kontrol -&gt; Alat Administratif -&gt; Lihat Acara"). <br><br><img src="https://habrastorage.org/webt/j0/s4/ot/j0s4otidlwtntmyx-s02-kom3uk.jpeg"><br><br>  <b>Pertanyaan: "Dari mana peristiwa itu berasal dari log keamanan jika audit tidak dikonfigurasi sama sekali?!"</b> <br><br><h3>  Penjelasan </h3><br>  Untuk memahami alasan perilaku ini, Anda perlu "berada di bawah tudung" sistem operasi.  Untuk memulainya, kita akan berurusan dengan kebijakan audit dasar dan lanjutan. <br><br>  Sebelum Windows Vista, hanya ada satu kebijakan audit, yang sekarang disebut dasar.  Masalahnya adalah bahwa rincian manajemen audit pada saat itu sangat rendah.  Jadi, jika diminta untuk melacak akses ke file, maka mereka memasukkan kategori kebijakan dasar "Audit akses ke objek".  Akibatnya, selain melakukan operasi file, banyak acara "noise" lainnya dituangkan ke dalam log keamanan.  Ini sangat mempersulit pemrosesan log dan pengguna yang bingung. <br><br>  Microsoft mendengar "rasa sakit" ini dan memutuskan untuk membantu.  Masalahnya adalah bahwa Windows dibangun pada konsep kompatibilitas ke belakang, dan membuat perubahan pada mekanisme manajemen audit yang ada akan mematikan kompatibilitas ini.  Oleh karena itu, vendor pergi dengan cara lain.  Dia menciptakan alat baru dan menyebutnya Kebijakan Audit Lanjutan. <br><br>  Inti dari alat ini adalah bahwa dari kategori kebijakan audit dasar, dibuat kebijakan tingkat lanjut, dan pada gilirannya dibagi menjadi beberapa subkategori yang dapat dihidupkan dan dimatikan secara terpisah.  Sekarang, jika Anda perlu melacak akses ke file dalam kebijakan audit lanjutan, Anda hanya perlu mengaktifkan subkategori "Sistem File", yang termasuk dalam kategori "Akses Objek".  Pada saat yang sama, kejadian "noise" yang terkait dengan akses ke registri atau penyaringan lalu lintas jaringan tidak akan dimasukkan dalam log keamanan. <br><br>  Kebingungan yang sangat besar dalam keseluruhan skema ini disebabkan oleh fakta bahwa nama-nama kategori kebijakan audit dasar dan lanjutan tidak sesuai, dan pada awalnya mungkin terlihat bahwa ini adalah hal-hal yang sama sekali berbeda, tetapi tidak demikian halnya. <br><br>  Berikut ini adalah tabel kesesuaian nama-nama kategori dasar dan lanjutan dari manajemen audit <br><div class="scrollable-table"><table><tbody><tr><td>  <b>Nama kebijakan audit dasar</b> </td><td>  <b>Nama kebijakan audit yang diperluas</b> </td></tr><tr><td>  Audit Akses Layanan Direktori </td><td>  Akses Layanan Direktori (DS) </td></tr><tr><td>  Audit Akses Objek </td><td>  Akses ke fasilitas </td></tr><tr><td>  Audit Privilege </td><td>  Penggunaan hak </td></tr><tr><td>  Login Audit </td><td>  Masuk / keluar </td></tr><tr><td>  Acara Login Audit </td><td>  Login akun </td></tr><tr><td>  Perubahan Kebijakan Audit </td><td>  Perubahan kebijakan </td></tr><tr><td>  Acara Sistem Audit </td><td>  Sistem </td></tr><tr><td>  Audit Manajemen Akun </td><td>  Manajemen akun </td></tr><tr><td>  Audit Pelacakan Proses </td><td>  Pelacakan terperinci </td></tr></tbody></table></div><br>  Penting untuk dipahami bahwa kategori dasar dan lanjutan pada dasarnya mengendalikan hal yang sama.  Dimasukkannya kategori kebijakan audit dasar mengarah ke dimasukkannya kategori kebijakan audit diperpanjang yang sesuai dan, sebagai hasilnya, semua subkategori.  Untuk menghindari konsekuensi yang tidak terduga, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Microsoft tidak merekomendasikan</a> penggunaan kebijakan audit dasar dan lanjutan secara bersamaan. <br><br>  Sekarang adalah waktu untuk mencari tahu di mana pengaturan audit disimpan.  Untuk mulai dengan, kami memperkenalkan sejumlah konsep: <br><br><ol><li>  <i>Kebijakan audit yang efektif</i> - informasi yang disimpan dalam RAM yang menentukan parameter operasi saat ini dari modul sistem operasi yang menerapkan fungsi audit. </li><li>  <i>Kebijakan audit tersimpan</i> - informasi yang disimpan dalam registri di HKEY_LOCAL_MACHINE \ SECURITY \ Policy \ PolAdtEv dan digunakan untuk menentukan kebijakan audit yang efektif setelah sistem dinyalakan ulang. </li></ol><br>  Kami akan mempertimbangkan berbagai alat administratif dan menunjukkan parameter audit mana yang ditampilkan dan yang ditetapkan.  Data dalam tabel didasarkan pada eksperimen. <br><div class="scrollable-table"><table><tbody><tr><td>  <b>Nama dana</b> </td><td>  <b>Kebijakan Audit Ditampilkan</b> </td><td>  <b>Kebijakan Audit yang Persisten</b> </td></tr><tr><td>  Kebijakan Audit Dasar dari Kebijakan Keamanan Lokal snap-in </td><td>  Kebijakan Audit yang Efektif </td><td>  Kebijakan audit yang efektif, kebijakan audit yang disimpan </td></tr><tr><td>  Kebijakan Audit Lanjutan dari Kebijakan Keamanan Lokal snap-in </td><td colspan="2"> File <code>%SystemRoot%\System32\GroupPolicy\Machine\Microsoft\Windows NT\Audit\audit.csv</code> </td></tr><tr><td>  Utilitas Auditpol </td><td>  Pengaturan Audit Tersimpan </td><td>  Pengaturan audit yang efektif, pengaturan audit yang disimpan </td></tr></tbody></table></div><br>  Mari kita jelaskan tabelnya dengan contoh. <br><br>  <b>Contoh 1</b> <br><br>  Jika Anda menjalankan auditpol untuk melihat pengaturan audit: <br>  <code>auditpol /get /category:*</code> , maka pengaturan audit yang disimpan akan ditampilkan, yaitu yang disimpan dalam registri di HKEY_LOCAL_MACHINE \ SECURITY \ Policy \ PolAdtEv. <br><br>  <b>Contoh 2</b> <br><br>  Jika Anda menjalankan utilitas yang sama, tetapi sudah mengatur parameter: <br>  <code>auditpol /set /category:*</code> , pengaturan audit yang efektif dan pengaturan audit yang disimpan akan diubah. <br><br>  Komentar terpisah membutuhkan urutan pengaturan audit yang ditampilkan di snap-in "Kebijakan Keamanan Lokal" snap-in.  Kategori kebijakan audit dasar ditampilkan sebagaimana diatur jika semua subkategori dari kebijakan audit diperluas yang terkait diinstal.  Jika setidaknya salah satu dari mereka tidak diinstal, maka kebijakan akan ditampilkan sebagai tidak diinstal. <br><br>  <b>Contoh 3</b> <br><br>  Menggunakan perintah <code>auditpol /set /category:*</code> , <code>auditpol /set /category:*</code> mengatur semua subkategori audit ke Mode Keberhasilan Audit.  Pada saat yang sama, jika Anda masuk ke "Kebijakan audit dasar" snap-in "Kebijakan keamanan lokal", maka Audit Keberhasilan akan dipasang di seberang setiap kategori. <br><br>  <b>Contoh 4</b> <br><br>  Sekarang administrator telah <code>auditpol /clear</code> dan mengatur ulang semua pengaturan audit.  Dia kemudian mengatur audit sistem file dengan menjalankan <code>auditpol /set /subcategory:" "</code> .  Sekarang, jika Anda masuk ke "Kebijakan audit dasar" dari snap-in "Kebijakan keamanan lokal", maka semua kategori akan ditentukan dalam status "Tidak audit", karena tidak satu pun kategori kebijakan audit tambahan yang sepenuhnya ditentukan. <br><br>  Sekarang, akhirnya, kita dapat menjawab pertanyaan dari mana log berasal dari sistem operasi yang baru diinstal.  Masalahnya adalah bahwa setelah instalasi, audit di Windows dikonfigurasi dan ditentukan dalam pengaturan audit yang disimpan.  Anda dapat memverifikasi ini dengan menjalankan perintah <code>auditpol /get /category:*</code> . <br><br><img src="https://habrastorage.org/webt/dx/ot/1s/dxot1swbotmghm7jxzo0zuafvcy.jpeg"><br><br>  Dalam Kebijakan Audit Dasar snap-in Kebijakan Keamanan Lokal, informasi audit ini tidak ditampilkan, karena semua kategori tidak memiliki satu atau beberapa subkategori yang ditentukan.  Dalam Kebijakan Audit Lanjut dari snap-in Kebijakan Keamanan Lokal, informasi ini tidak ditampilkan karena snap-in hanya berfungsi dengan pengaturan audit yang disimpan dalam file% SystemRoot% \ System32 \ GroupPolicy \ Machine \ Microsoft \ Windows NT \ Audit \ audit.csv. <br><br><h3>  Apa inti dari masalahnya? </h3><br>  Pada awalnya mungkin tampak bahwa semua ini bukan masalah sama sekali, tetapi sebenarnya tidak.  Fakta bahwa semua alat menunjukkan parameter audit dengan cara yang berbeda menciptakan peluang untuk manipulasi kebijakan yang berbahaya dan, sebagai hasilnya, hasil audit. <br><br>  <b>Pertimbangkan skenario yang mungkin terjadi</b> <br><br>  Biarkan workstation teknologi berbasis Windows 7 bekerja di jaringan perusahaan. <br><br>  Mesin tidak termasuk dalam domain dan melakukan fungsi robot yang mengirim laporan setiap hari ke pihak berwenang.  Penyerang dalam satu atau lain cara mendapatkan akses jarak jauh dengan hak administrator.  Pada saat yang sama, tujuan utama penyerang adalah spionase, dan tugasnya adalah tetap tidak terdeteksi dalam sistem.  Penyerang diam-diam memutuskan sehingga tidak ada peristiwa dengan kode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4719 "Perubahan kebijakan audit"</a> dalam log keamanan, nonaktifkan audit akses ke file, tetapi pada saat yang sama semua alat administrasi mengatakan bahwa audit diaktifkan.  Untuk mencapai tugas, mereka melakukan tindakan berikut: <br><br><ol><li>  Pada workstation yang diserang, mereka memberi diri mereka menulis izin ke kunci registri HKEY_LOCAL_MACHINE \ SECURITY \ Policy \ PolAdtEv dan mengekspor kunci ini ke file bernama "+ fs.reg". </li><li>  File ini diimpor di komputer lain, reboot, dan kemudian auditpol mematikan audit sistem file, setelah itu kunci registri di atas diekspor ke file "-fs.reg". </li><li>  Pada mesin yang diserang, file "-fs.reg" diimpor ke dalam registri. </li><li>  Kami membuat salinan cadangan dari% SystemRoot% \ System32 \ GroupPolicy \ Machine \ Microsoft \ Windows NT \ Audit \ audit.csv file yang terletak di mesin yang diserang dan kemudian menghapus subkategori Sistem File dari itu. </li><li>  Kami mem-boot ulang workstation yang diserang, dan kemudian mengganti file% SystemRoot% \ System32 \ GroupPolicy \ Machine \ Microsoft \ Windows NT \ Audit \ audit.csv dengan salinan cadangan yang sebelumnya tersimpan di dalamnya dan juga mengimpor file "+ fs.reg" </li></ol><br>  Sebagai hasil dari semua manipulasi ini, tidak ada entri perubahan kebijakan dalam log keamanan, semua alat menunjukkan bahwa audit diaktifkan, tetapi pada kenyataannya itu tidak berfungsi. <br><br><h2>  Masalah No. 2. Operasi logging yang gagal untuk menghapus file, direktori dan kunci registri </h2><br>  <i>Masalahnya dikonfirmasi pada Windows 7/10 / Server 2019.</i> <br><br><h3>  Deskripsi masalah </h3><br>  Untuk satu operasi untuk menghapus file, direktori atau kunci registri, sistem operasi menghasilkan urutan peristiwa dengan kode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4663</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4660</a> .  Masalahnya adalah bahwa dari seluruh aliran acara, pasangan ini tidak begitu mudah terhubung satu sama lain.  Untuk melakukan ini, peristiwa yang dianalisis harus memiliki parameter berikut: <br><br>  <i>Peristiwa 1. Kode 4663 "Suatu upaya dilakukan untuk mendapatkan akses ke objek."</i>  Parameter acara: <br>  "ObjectType" = File. <br>  "ObjectName" = nama file atau direktori yang akan dihapus. <br>  "HandleId" = handle ke file yang akan dihapus. <br>  “AcessMask” = 0x10000 (Kode ini sesuai dengan operasi DELETE. Anda dapat menemukan dekripsi semua kode operasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di situs web Microsoft</a> ). <br><br><img src="https://habrastorage.org/webt/ez/it/6z/ezit6zapdorhyh5blpomzppv1dc.jpeg"><br><br>  <i>Acara 2. Kode 4660 "Objek dihapus."</i> <br>  Parameter acara: <br><br>  "HandleId" = "HandleId acara 1" <br>  "System \ EventRecordID" = "System \ EventRecordID dari event 1" + 1. <br><br><img src="https://habrastorage.org/webt/qy/bj/6a/qybj6a3724rrph9wsqki1bpcntm.jpeg"><br><br>  Dengan penghapusan kunci registri (kunci), semuanya sama, hanya pada acara pertama dengan kode 4663, parameter "ObjectType" = Kunci. <br><br>  Perhatikan bahwa penghapusan nilai dalam registri dijelaskan oleh peristiwa lain (kode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4657</a> ) dan tidak menyebabkan masalah seperti itu. <br><br><h3>  Fitur menghapus file di Windows 10 dan Server 2019 </h3><br>  Di Windows 10 / Server 2019, ada dua cara untuk menghapus file. <br><br><ol><li>  Jika file dihapus ke tempat sampah, maka, seperti sebelumnya, urutan kejadian 4663 dan 4660. </li><li>  Jika file dihapus secara permanen (melewati tempat sampah), maka dengan satu peristiwa dengan kode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4659</a> . </li></ol><br>  Suatu hal yang aneh terjadi.  Jika sebelumnya, untuk menentukan file yang dihapus, perlu untuk memantau totalitas peristiwa 4663 dan 4660, sekarang Microsoft telah "pergi untuk bertemu pengguna", dan alih-alih dua peristiwa, sekarang kita perlu memantau tiga.  Perlu juga dicatat bahwa prosedur untuk menghapus direktori tidak berubah, itu, seperti sebelumnya, terdiri dari dua peristiwa 4663 dan 4660. <br><br><h3>  Apa inti dari masalahnya? </h3><br>  Masalahnya adalah bahwa mencari tahu siapa yang menghapus file atau direktori menjadi tugas yang tidak sepele.  Alih-alih mencari secara dangkal peristiwa terkait dalam log keamanan, perlu untuk menganalisis urutan peristiwa, yang agak melelahkan untuk dilakukan secara manual.  Pada habr bahkan tentang ini ada sebuah artikel: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"Mengaudit penghapusan dan akses ke file dan merekam peristiwa dalam file log menggunakan Powershell</a> . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"</a> <br><br><h2>  Masalah nomor 3 (kritis).  Pencatatan operasi penggantian nama untuk file, direktori, dan kunci registri yang gagal </h2><br>  <i>Masalahnya dikonfirmasi pada Windows 7/10 / Server 2019.</i> <br><br><h3>  Deskripsi masalah </h3><br>  Masalah ini memiliki dua sub-masalah: <br><br><ol><li>  Dalam peristiwa yang dihasilkan oleh sistem selama penggantian nama, nama objek baru tidak diperbaiki di mana pun. </li><li>  Prosedur penggantian nama sangat mirip dengan penghapusan.  Itu hanya dapat dibedakan dengan fakta bahwa peristiwa pertama dengan kode 4663, dengan parameter "AcessMask" = 0x10000 (HAPUS) <b>tidak memiliki</b> peristiwa 4660. </li></ol><br>  Perlu dicatat bahwa berkenaan dengan registri, masalah ini hanya berlaku untuk kunci.  Mengganti nama nilai dalam registri dijelaskan oleh urutan peristiwa 4657 dan tidak menyebabkan keluhan seperti itu, meskipun, tentu saja, akan jauh lebih nyaman jika hanya ada satu peristiwa. <br><br><h3>  Apa inti dari masalahnya? </h3><br>  Selain kesulitan mencari operasi penggantian nama file, fitur penjurnalan ini tidak memungkinkan pelacakan siklus hidup lengkap objek sistem file atau kunci registri.  Akibatnya, menjadi sangat sulit untuk menentukan riwayat file yang telah berganti nama berkali-kali pada server file yang digunakan secara aktif. <br><br><h2>  Masalah nomor 4 (kritis).  Tidak dapat melacak pembuatan direktori dan kunci registri </h2><br>  <i>Masalahnya dikonfirmasi pada Windows 7/10 / Server 2019.</i> <br><br><h3>  Deskripsi masalah </h3><br>  Windows tidak melacak pembuatan direktori sistem file dan kunci registri.  Ini terdiri dari kenyataan bahwa sistem operasi tidak menghasilkan suatu peristiwa yang akan mengandung nama direktori atau kunci registri yang dibuat, dan yang parameternya akan menunjukkan bahwa ini adalah operasi pembuatan. <br><br>  Secara teoritis, dengan tanda-tanda tidak langsung, fakta membuat katalog adalah mungkin.  Misalnya, jika dibuat melalui "Explorer", maka selama proses pembuatan, peristiwa polling untuk atribut direktori baru akan dihasilkan.  Masalahnya adalah bahwa jika Anda membuat direktori melalui perintah <code>mkdir</code> , maka tidak ada peristiwa yang dihasilkan sama sekali.  Semua yang sama berlaku untuk membuat kunci di registri. <br><br><h3>  Apa inti dari masalahnya? </h3><br>  Masalah ini membuatnya sangat sulit untuk menyelidiki insiden keamanan informasi.  Tidak ada penjelasan yang masuk akal untuk fakta bahwa informasi ini tidak dicatat dalam jurnal. <br><br><h2>  Masalah nomor 5 (kritis).  Pengaturan audit buruk dalam versi Rusia Windows </h2><br>  <i>Kehadiran masalah dikonfirmasi pada edisi Rusia Windows 7/10 / Server 2019.</i> <br><br><h3>  Deskripsi masalah </h3><br>  Ada kesalahan dalam versi Rusia Windows yang membuat sistem manajemen audit keamanan tidak beroperasi. <br><br><h3>  Gejala </h3><br>  Mengubah kebijakan keamanan tingkat lanjut tidak memengaruhi pengaturan audit yang efektif, atau, dengan kata lain, kebijakan tersebut tidak diterapkan.  Sebagai contoh, administrator mengaktifkan subkategori "Login", mem-boot ulang sistem, menjalankan perintah <code>auditpol /get /category:*</code> , dan subkategori ini tetap <code>auditpol /get /category:*</code> .  Masalahnya relevan untuk kedua komputer domain yang dikelola melalui kebijakan grup dan komputer non-domain yang dikelola menggunakan GPO lokal yang dikonfigurasi melalui snap-in Kebijakan Keamanan Lokal. <br><br><h3>  Alasan </h3><br>  Masalah muncul jika administrator telah mengaktifkan setidaknya satu subkategori “gagal” dari kebijakan audit lanjutan.  Kategori yang gagal tersebut, khususnya, meliputi: <br><br><ol><li>  Penggunaan hak -&gt; Audit penggunaan hak yang memengaruhi data rahasia.  PANDUAN: {0cce9228-69ae-11d9-bed3-505054503030}. </li><li>  Penggunaan hak -&gt; Audit penggunaan hak yang tidak memengaruhi data rahasia.  GUID: {0cce9229-69ae-11d9-bed3-505054503030}. </li><li>  Akses ke objek -&gt; Acara audit yang dibuat oleh aplikasi.  PANDUAN: {0cce9222-69ae-11d9-bed3-505054503030}. </li></ol><br><h3>  Rekomendasi untuk menyelesaikan masalah </h3><br>  Jika masalah belum terjadi, maka jangan aktifkan sub-kategori "gagal" yang ditunjukkan.  Jika peristiwa dari subkategori ini sangat diperlukan, maka gunakan utilitas auditpol untuk mengaktifkannya atau mengelola audit menggunakan kebijakan dasar. <br><br>  Jika masalah terjadi, Anda harus: <br><br><ol><li>  Dari direktori kebijakan grup domain, hapus file \ Machine \ microsoft \ windows nt \ Audit \ audit.csv </li><li>  Dari semua komputer yang memiliki masalah dengan audit, hapus file:% SystemRoot% \ security \ audit \ audit.csv,% SystemRoot% \ System32 \ GroupPolicy \ Machine \ Microsoft \ Windows NT \ Audit \ audit.csv </li></ol><br><h3>  Apa inti dari masalahnya? </h3><br>  Kehadiran masalah ini mengurangi jumlah peristiwa keamanan yang dapat dipantau secara teratur melalui kebijakan audit lanjutan, dan juga menciptakan ancaman untuk memutus, memblokir, dan mengacaukan pengelolaan sistem audit dalam jaringan perusahaan. <br><br><h2>  Masalah nomor 6 (kritis).  Sialan "New text document.txt ... serta bitmap.bmp" </h2><br>  <i>Masalahnya telah dikonfirmasi pada Windows 7. Masalahnya hilang pada Windows 10 / Server 2019.</i> <br><br><h3>  Deskripsi masalah </h3><br>  Ini adalah masalah yang sangat aneh yang ditemukan secara tidak sengaja.  Inti dari masalahnya adalah bahwa sistem operasi memiliki celah yang memungkinkan Anda untuk melewati audit pembuatan file. <br><br>  <b>Bagian persiapan:</b> <br><br><ol><li>  Ambil Windows 7 yang baru saja diinstal. </li><li>  Atur ulang semua pengaturan audit menggunakan perintah <code>auditpol /clear</code> .  Item ini opsional dan hanya berfungsi untuk kenyamanan menganalisis majalah. </li><li>  Kami mengatur audit sistem file dengan menjalankan <code>auditpol /set /subcategory:" "</code> . </li><li>  Mari kita membuat direktori C: \ TEST dan menetapkan parameter audit untuk akun "Semuanya": "Buat File / Tulis Data", "Buat Folder / Tulis Data", "Tulis Atribut", "Tulis Atribut Tambahan", "Hapus Subfolder dan file ”,“ Hapus ”,“ Ubah izin ”,“ Ubah kepemilikan ”, yaitu segala sesuatu yang terkait dengan penulisan data ke sistem file. </li></ol><br>  Untuk kejelasan, sebelum setiap percobaan, kami akan menghapus log keamanan sistem operasi. <br><br>  <b>Eksperimen 1.</b> <br>  <b>Kami lakukan:</b> <br><br>  Dari baris perintah, jalankan perintah: <code>echo &gt; "c:\test\  .txt"</code> <br>  <b>Kami mengamati:</b> <br><br>  Setelah membuat file, peristiwa dengan kode 4663 muncul di log keamanan, yang berisi nama file yang dibuat di bidang "ObjectName" dan 0x2 di bidang "AccessMask" ("Menulis data atau menambahkan file"). <br><br><img src="https://habrastorage.org/webt/k3/cn/6l/k3cn6ltuqg-gclek4pgtn7u_tea.jpeg"><br><br>  Untuk melakukan percobaan berikut, kami menghapus folder dan log peristiwa. <br><br>  <b>Eksperimen 2.</b> <br>  <b>Kami lakukan:</b> <br><br>  Buka folder C: \ TEST melalui "Explorer" dan gunakan menu konteks "Create -&gt; Text Document", dipanggil dengan mengklik kanan, buat file "New Text Document.txt". <br><br><img src="https://habrastorage.org/webt/cc/nh/gj/ccnhgj_6_2xrciyj4m6ubv9hmpk.jpeg"><br><br>  <b>Kami mengamati:</b> <br><br>  Tindakan ini tidak tercermin dalam log peristiwa !!!  Juga, tidak akan ada entri jika menggunakan menu konteks yang sama untuk membuat "Bitmap". <br><br><img src="https://habrastorage.org/webt/-y/52/4b/-y524b96wuzs9eszx5cybyrwsdk.jpeg"><br><br>  <b>Eksperimen 3.</b> <br>  <b>Kami lakukan:</b> <br><br>  Menggunakan Explorer, buka folder C: \ TEST dan gunakan menu konteks "Buat -&gt; Dokumen dalam format RTF", dipanggil dengan mengklik kanan, buat file "Dokumen baru dalam format RTF.rtf". <br><br>  <b>Kami mengamati:</b> <br><br>  Seperti halnya dengan pembuatan file melalui baris perintah, peristiwa dengan kode 4663 dan konten yang sesuai muncul di log. <br><br><img src="https://habrastorage.org/webt/de/pf/wq/depfwqhwv1umoii77gpofddmoro.jpeg"><br><br><h3>  Apa inti dari masalahnya? </h3><br>  Tentu saja, membuat dokumen teks atau gambar tidak terlalu berbahaya.  Namun, jika "Explorer" dapat mem-bypass pencatatan operasi file, maka malware akan dapat melakukan ini. <br><br>  Masalah ini mungkin yang paling signifikan dari semua yang dipertimbangkan, karena ini secara serius merusak kredibilitas hasil audit operasi file. <br><br><h2>  Kesimpulan </h2><br>  Daftar masalah di atas tidak lengkap.  Dalam prosesnya, saya berhasil menemukan sejumlah kecil kelemahan kecil yang masih agak besar, yang meliputi penggunaan konstanta yang dilokalisasi sebagai nilai parameter untuk sejumlah peristiwa, yang memaksa kami untuk menulis skrip analisis kami untuk setiap lokalisasi sistem operasi, pembagian kode acara yang tidak masuk akal ke dalam operasi yang dekat dengan makna, misalnya, menghapus kunci registri adalah urutan peristiwa 4663 dan 4660, dan menghapus nilai dalam registri adalah 4.657, dan juga hal-hal kecil ... <br><br>  Dalam keadilan, kami mencatat bahwa terlepas dari semua kekurangannya, sistem pencatatan peristiwa keamanan di Windows memiliki sejumlah besar aspek positif.  Memperbaiki masalah-masalah penting yang tercantum di sini dapat mengembalikan mahkota ke solusi yang lebih baik untuk keluar dari acara keamanan. <br><br>  MEMBUAT WINDOWS KEAMANAN PERISTIWA BESAR LAGI! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id476464/">https://habr.com/ru/post/id476464/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id476450/index.html">Gambaran umum cPanel - konsol berbasis web untuk mengelola situs dan hosting</a></li>
<li><a href="../id476452/index.html">Penyimpanan bernilai kunci, atau bagaimana aplikasi kita menjadi lebih nyaman</a></li>
<li><a href="../id476454/index.html">5G akan datang: perusahaan mana yang akan memastikan pengenalan teknologi baru pada tahun 2020</a></li>
<li><a href="../id476456/index.html">Sistem kredit sosial Cina, pertama-tama, bukan sistem penilaian warga, tetapi API besar-besaran</a></li>
<li><a href="../id476460/index.html">Format file hit pertama di Internet bukan MP3, tetapi MIDI</a></li>
<li><a href="../id476466/index.html">Buku "Arsitek kecerdasan"</a></li>
<li><a href="../id476468/index.html">Kursus analisis teks jaringan saraf online baru Samsung gratis</a></li>
<li><a href="../id476474/index.html">Kami mengembalikan Keenetic pada dukungan KN-1310 dari modem usb</a></li>
<li><a href="../id476476/index.html">Tampilkan Gmail dalam html saja</a></li>
<li><a href="../id476478/index.html">Tahapan memperkenalkan model pembelajaran mesin di perusahaan besar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>