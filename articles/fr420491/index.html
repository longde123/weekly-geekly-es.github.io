<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë±üèø üìú ‚öìÔ∏è Ma mani√®re de guerrier, ou comment j'ai pr√©par√© une demande de vie √† Sailfish üòé ü§ûüèΩ ü§ú</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'art d'un guerrier est de maintenir l'√©quilibre 
 entre l'horreur d'√™tre humain et le miracle d'√™tre humain. 
 "Voyage √† Ixtlan" 

 Mon chemin de gue...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ma mani√®re de guerrier, ou comment j'ai pr√©par√© une demande de vie √† Sailfish</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/digdes/blog/420491/">  <i>L'art d'un guerrier est de maintenir l'√©quilibre</i> <i><br></i>  <i>entre l'horreur d'√™tre humain et le miracle d'√™tre humain.</i> <i><br></i>  <i>"Voyage √† Ixtlan"</i> <br><br>  Mon chemin de guerrier - un d√©veloppeur frontend brutal sur les pros - √©tait de trouver un √©quilibre entre le d√©veloppement d'une application qui fonctionne sur Sailfish et une application multiplateforme. <br><br>  R√©cemment, j'ai travaill√© sur le poste de d√©veloppeur chez Digital Design, et parfois je dois faire face √† des t√¢ches que je n'avais pas rencontr√©es auparavant.  C'est int√©ressant et souvent amusant.  Maintenant, par exemple, j'√©cris une application d'entreprise pour Sailfish OS et je veux partager mon exp√©rience avec vous - cela sera discut√© ci-dessous.  Suivez-moi sous la coupe, si vous √™tes un d√©veloppeur d√©butant ou, tout comme moi, confront√© √† la t√¢che d'adapter une application d'entreprise pour OS Sailfish et ne savez pas par o√π commencer, ainsi que ceux qui n'ont pas entendu parler des fonctionnalit√©s de Qt et Sailfish. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zr/xh/si/zrxhsitmn-nk4wa5iic71hc7wfu.jpeg"></div><a name="habracut"></a><br><h3>  Un peu d'histoire, ou pourquoi je l'ai fait </h3><br>  Lorsque la soci√©t√© a d√©velopp√© la solution Areopad ISCO pour iPad (iOS) il y a 5 ans, personne ne pouvait penser que les clients auraient besoin d'une application pour travailler sur un appareil avec Sailfish OS (alors l'OS appartenait √† la soci√©t√© finlandaise Jolla, cependant, maintenant aussi).  Mais en 2016, la soci√©t√© russe Open Mobile Platform a acquis une licence pour son utilisation, sa modification, sa distribution et l'a √©voqu√©e: elle a adapt√© les appareils mobiles et les utilisateurs nationaux (principalement des entreprises et des organismes gouvernementaux) et a enregistr√© Sailfish Mobile OS RUS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dans le registre</a> .  Et maintenant, on pourrait dire que c'est le seul syst√®me d'exploitation russe officiel pour les appareils mobiles. <br><br>  Naturellement, nous voulions le comprendre - nous avons d√©j√† conquis le reste du syst√®me d'exploitation, et Sailfish, apparemment, a un grand avenir (oui, je parle de substitution des importations).  De tout cela, il s'ensuit que la demande pour Sailfish soit!  La premi√®re application √† √™tre test√©e a √©t√© l'application mobile Syst√®me d'information pour le travail des instances coll√©giales Areopad (elle n'en √©tait qu'au stade de la modernisation). <br><br><h3>  Maintenant sur qt </h3><br>  Un merveilleux outil multiplateforme qui comprend un environnement de d√©veloppement, une tonne de biblioth√®ques utiles et pratiques, et m√™me votre propre langage de balisage QML.  Je ne m'y attarderai pas longtemps, car de nombreux articles ont √©t√© √©crits sur ce miracle sur l'Habr√©, et vous pouvez √©galement lire la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> , qui se lit facilement et naturellement. <br><br>  Juste au cas o√π, je pr√©ciserai que les calculs et le mappage ont lieu dans diff√©rents langages dans diff√©rents modules (C ++ et QML) qui interagissent les uns avec les autres en utilisant des m√©thodes d√©licates sp√©ciales (propri√©t√©, signal-slot). <br><br>  Et Qt est le cadre principal utilis√© dans le d√©veloppement de logiciels pour Sailfish. <br><br><h3>  Approches pour r√©soudre le probl√®me: allez √† gauche - vous gagnerez une b√©quille, allez √† droite - vous perdrez des fonctionnalit√©s </h3><br>  Au d√©but, inspir√© par l'id√©e de multiplateforme et par le fait que je vais l'impl√©menter, je pensais qu'une application √©crite pour Sailfish ne d√©collerait pas, mais flopperait volontiers sur n'importe quel autre OS, m√™me un r√©frig√©rateur ou une bouilloire.  Mais mon bonheur a dur√© exactement jusqu'au moment o√π je me suis assis pour l'ex√©cuter sur Android - puis je me suis senti triste.  Sailfish n'est pas du tout adapt√© √† cette activit√© et n'a nullement l'intention de changer quoi que ce soit. <br><br>  Si Android ou iOS vous permettent d'utiliser la compilation conditionnelle et de fournir une sorte de bo√Æte √† outils pour cela, Sailfish ne peut pas √™tre distingu√© de Linux (dans Qt, bien s√ªr). <br><br>  Ensuite, le probl√®me de compatibilit√© QML se pose: dans Sailfish, la version obsol√®te de Qt Quick (2.6 pour Sailfish et d√©j√† 2.11 pour tout le monde), Android ne conna√Æt pas Silica, Sailfish ne conna√Æt pas QtQuick.Controls.  Par cons√©quent, pour diff√©rents syst√®mes d'exploitation, vous devez extraire les m√™mes composants de diff√©rentes biblioth√®ques, ce qui produit presque les m√™mes fichiers pour chaque syst√®me d'exploitation. <br>  Dans le m√™me temps, Silica poss√®de probablement toutes les m√™mes fonctionnalit√©s que QtQuick.Controls, mais refuse de s'ex√©cuter sur toute autre plate-forme. <br><br><h3>  Caract√©ristiques Sailfish </h3><br>  √âtant une personne cr√©ative <s>paresseuse,</s> aussi cr√©ative que possible avec le d√©sir d'optimiser les co√ªts de main-d'≈ìuvre, j'ai pris le chemin de la moindre <s>r√©sistance</s> fonctionnelle et j'ai √©crit mon chef-d'≈ìuvre en Qt pur, sans utiliser QtQuick.Controls et Silica.  En cons√©quence, tout fonctionne correctement et noblement sur Sailfish, mais sur Android, la moiti√© des √©l√©ments, malgr√© mon ordre strict de rester immobile, sont all√©s quelque part pour leurs questions probablement importantes, donc la prochaine √©tape sera toujours faite chez un adulte et divorc√© fichiers de balisage pour chaque syst√®me d'exploitation sous diff√©rents angles.  [Ce que j'ai fait plus tard, en pr√©parant un article pour publication.  Cette histoire s'appuie sur un article s√©par√©].  N'oubliez pas et acceptez: les constantes magiques sont mauvaises (par exemple, largeur: 15).  Et sur deux appareils presque identiques, m√™me avec le m√™me OS, ils peuvent diff√©rer de 2 fois. <br><br>  Cependant, je ne peux que noter qu'il y a certainement des choses int√©ressantes dans la version Sailfish.  Bien s√ªr, pendant une si courte p√©riode que je le connais, il est presque impossible de conna√Ætre tout le monde int√©rieur riche de Sailfish - notre relation avec lui est au stade de la "p√©riode du bouquet de bonbons", et une grande partie de ce que je n'ai pas encore √©tudi√©e dans son caract√®re complexe.  De plus, il a √©t√© d√©cid√© de dessiner une application universelle pour tous les syst√®mes d'exploitation, donc je n'ai pas eu la chance d'utiliser des m√©canismes plus sophistiqu√©s pour utiliser cette chance, mais je vais probablement vous parler de quelques points int√©ressants. <br><br>  Nous ne parlerons que d'une seule biblioth√®que pour impl√©menter l'interface graphique Silica, car le reste que j'ai r√©ussi √† apprendre et √† comprendre n'est pas diff√©rent de la programmation QML standard. <br><br><ul><li>  <b>Th√®me.</b> </li></ul><br>  Cet outil m'a le plus int√©ress√© parce que je n'ai pas vu d'analogue dans d'autres syst√®mes d'exploitation, et il est √©galement simple.  L'essentiel est que la conception de l'application n'est pas une constante, mais d√©pend du sujet choisi. <br><br>  L'√©l√©ment de th√®me contient des informations sur le sujet actuellement s√©lectionn√©: couleurs primaires, tailles de police, retraits et composants.  Ainsi, lorsque vous √©crivez des applications, vous n'avez pas besoin de coder en dur les couleurs, d'ajuster la taille pour s'adapter √† l'√©cran et de regarder g√©n√©ralement la mise en page (pardonnez aux concepteurs, vous avez d√©j√† beaucoup de travail), vous pouvez simplement tout tirer de l'√©l√©ment Th√®me.  Eh bien, n'est-ce pas cool! <br><br><img src="https://habrastorage.org/webt/ak/pr/wa/akprwaderu8np2wpkch4j_qo9xa.png"><br><br><ul><li>  <b>Le menu</b> </li></ul><br>  Aussi une fonctionnalit√© de Sailfish (bien que cela puisse √™tre possible dans Android, mais je ne l'ai pas vu). <br><br>  Il existe trois types de menus: <br>  <b>PullDownMenu - PushUpMenu - ContextMenu</b> <br><br><img src="https://habrastorage.org/webt/bu/y7/a5/buy7a5tkeexpsohiexbtm4oydfm.jpeg"><img src="https://habrastorage.org/webt/jk/sl/4n/jksl4n-kik82otj40tdtcn9q4jq.jpeg"><img src="https://habrastorage.org/webt/ny/ti/tw/nytitwwksf94j2c1oraw50qea7q.jpeg"><br><br>  Quant √† Silica ... View - ils ne diff√®rent pas de la vue standard ... View (ce sont ¬± quelques propri√©t√©s peu visibles), et le composant Button vous rend assez nerveux - la hauteur du bouton ne peut pas √™tre modifi√©e, vous devez √©crire Rectangle et MouseArea partout.  Si je faisais une application pour Sailfish uniquement, en utilisant la conception standard de ce syst√®me d'exploitation, il ne serait pas n√©cessaire de modifier la hauteur du bouton ou il serait possible d'utiliser un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">composant de Silica</a> .  Mais comme j'√©cris une application pour tous les appareils, il a √©t√© d√©cid√© d'utiliser le design le plus massif (Android), pour que tout le monde soit familier et confortable.  Beaucoup sont en d√©saccord avec moi et disent que vous devez utiliser des √©l√©ments d'interface utilisateur natifs pour chaque plate-forme, mais c'est un sujet compl√®tement diff√©rent, il fait l'objet d'holivars depuis de nombreuses ann√©es, pendant cette p√©riode, plus d'une g√©n√©ration de d√©veloppeurs a grandi. <br><br><h3>  Volez dans la pommade vers le d√©veloppement mobile sur Qt </h3><br><ul><li>  <b>Assychronisme</b> </li></ul><br>  Dans Qt, pour communiquer avec le serveur, appeler une fonction ne suffit pas, vous devez envoyer une demande et demander √† un objet sp√©cial responsable de la r√©ponse du serveur d'appeler la fonction de traitement des r√©ponses (qui, bien s√ªr, nous nous √©crivons) lorsque la r√©ponse est re√ßue: <br><br><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-function">QNetworkRequest </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">request</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"http://www.leningrad.spb.ru"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; QNetworkReply *reply = mngr-&gt;get(request); connect(reply, &amp;QNetworkReply::finished, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, &amp;Class:: onReplyFinished); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onReplyFinished</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ QNetworkReply *reply = (QNetworkReply*)sender(); QByteArray ans = reply-&gt;readAll(); qDebug() &lt;&lt; ans; }</code> </pre> <br>  La fonction onRhnessFinished sera appel√©e lorsqu'une r√©ponse est re√ßue du serveur, et cela peut prendre peu importe combien de temps cela d√©pend de la qualit√© de la connexion et du c√¥t√© serveur.  Imaginez maintenant comment tout cela sera organis√© avec 1500 √† 2000 requ√™tes, qui dans ce cas d√©pendent les unes des autres et doivent √™tre ex√©cut√©es dans un ordre strict.  Et si vous vous souvenez que toute la partie de l'interface utilisateur d√©pend de la r√©ponse, cela devient compl√®tement effrayant. <br><br><ul><li>  <b>Programmation orient√©e b√©quille ou approche cr√©ative pour r√©soudre les probl√®mes</b> </li></ul><br>  Un autre sujet est ListView, qui est un probl√®me Qt tr√®s local, mais toujours d√©sagr√©able. <br><br>  Tout ListView qui se respecte doit avoir un composant d'en-t√™te qui, en tant que premier d√©l√©gu√©, ins√®re un √©l√©ment fondamentalement diff√©rent du reste.  Oui, il le fait, oui, il peint tout parfaitement, si ce n'√©tait pas pour un "mais": mon d√©l√©gu√© occupe tout l'√©cran, et il faut le faire d√©filer, mais d√®s que j'essaie de faire d√©filer vers la gauche vers l'en-t√™te √† partir de l'index z√©ro, il refuse fondamentalement cela afficher l'en-t√™te.  Que faire √† ce sujet?  Remplissez avec une b√©quille.  Un morceau de mon code de formation de mod√®le pour ce ListView dans la partie cpp, qui d√©crit ce qui se passe aussi pr√©cis√©ment que possible: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (QVariant quest, QQuestions) { Questions.append(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Question(client, quest)); } kostilQuestions = Questions; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Questions.size() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) kostilQuestions.prepend(Questions[<span class="hljs-number"><span class="hljs-number">0</span></span>]);</code> </pre> <br>  Ensuite, 2 √©l√©ments ind√©pendants sont cr√©√©s dans le d√©l√©gu√©, dont la visibilit√© d√©pend de l'index. <br>  Lorsque l'indice est nul, on en voit un, sinon l'autre. <br><br><h4>  R√©sum√© </h4><br>  En cons√©quence, j'ai obtenu une application qui "vole" √† la fois sur Android et iOS, et Sailfish, plus pr√©cis√©ment une application flexible qui s'adapte √† ces syst√®mes d'exploitation.  Et la magie n'a rien √† voir avec √ßa.  J'ai trouv√© un moyen d'√©viter les conflits et de faire des amis tous les OS avec Sailfish en substituant certains fichiers √† Sailfish et √† tout le monde.  Cela nous a permis de s√©lectionner des couches d'interface utilisateur pour chaque syst√®me d'exploitation dans le code d'application. <br><br>  Nous pouvons supposer que nous avons fait le premier pas - nous nous sommes li√©s d'amiti√© avec Sailfish.  Mais le travail √† ce sujet n'est pas termin√©, Sailfish et moi allons √† un nouveau niveau de notre relation - nous pr√©parons la demande Areopad CSIS pour l'enregistrement dans le registre (comme l'application Sailfish), ce qui signifie que nous devrons l'adapter √©galement pour le registre. <br><br>  J'esp√®re que c'√©tait int√©ressant.  √Ä suivre. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr420491/">https://habr.com/ru/post/fr420491/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr420475/index.html">Comparaison des machines de d√©coupe laser Raylogic 11G et Raylogic V12</a></li>
<li><a href="../fr420477/index.html">Revue HyperX Cloud Stinger Core: un casque de personnage l√©ger et robuste</a></li>
<li><a href="../fr420479/index.html">Injection de d√©pendances dans le service Apache Ignite.NET</a></li>
<li><a href="../fr420487/index.html">Les entreprises demandent le droit aux donn√©es personnelles des utilisateurs</a></li>
<li><a href="../fr420489/index.html">Les nouveaux processeurs ARM peuvent rivaliser avec le Core i5</a></li>
<li><a href="../fr420493/index.html">Le service am√©ricain de commande de produits alimentaires peut-il devenir Amazon dans le monde des restaurants</a></li>
<li><a href="../fr420495/index.html">Rendu de l'eau √† l'√©cran</a></li>
<li><a href="../fr420497/index.html">Singularit√© des l√©gumes: Kroger lance des robots pour les clients des fruits et l√©gumes en Arizona</a></li>
<li><a href="../fr420499/index.html">Anatomie des syst√®mes de recommandation. Premi√®re partie</a></li>
<li><a href="../fr420501/index.html">Linux en RAM: debirf way 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>