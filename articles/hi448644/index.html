<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>тЬК ЁЯФв ЁЯСР рдПрдХ рдореБрдХреНрдд рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рдирдХрд╛рд░ рдХреЗ рд░реВрдк рдореЗрдВ рд▓рд╛рдЧреВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдирд┐рдпрдорд┐рдд рднрд╛рд╡ ЁЯУЕ ЁЯСб ЁЯШм</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдореИрдВ рдЖрдкрдХрд╛ рдзреНрдпрд╛рди рдЬрд╕реНрдЯрд┐рди рд▓реЗ рдХреЗ рдПрдХ рдЕрджреНрднреБрдд рддрд╛рдЬрд╝рд╛ рд▓реЗрдЦ рдХреЗ рдЕрдиреБрд╡рд╛рдж рдкрд░ рд▓рд╛рддрд╛ рд╣реВрдБред рдХреЛрдб рдореЗрдВ рдЕрдкрдиреЗ рдмреНрд▓реЙрдЧ рдореЗрдВ, рдпрд╣ рд▓реЗрдЦрдХ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕реБрдВрджрд░ рдФрд░ рд╕реБрд░реБрдЪрд┐рдкреВрд░реНрдг...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдПрдХ рдореБрдХреНрдд рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рдирдХрд╛рд░ рдХреЗ рд░реВрдк рдореЗрдВ рд▓рд╛рдЧреВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдирд┐рдпрдорд┐рдд рднрд╛рд╡</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448644/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/zn/lx/ku/znlxkuzq-mdn9op_dfy7enlrwsy.png" width="90%"></div><br><p>  <em>рдореИрдВ рдЖрдкрдХрд╛ рдзреНрдпрд╛рди рдЬрд╕реНрдЯрд┐рди рд▓реЗ рдХреЗ рдПрдХ рдЕрджреНрднреБрдд рддрд╛рдЬрд╝рд╛ рд▓реЗрдЦ рдХреЗ рдЕрдиреБрд╡рд╛рдж рдкрд░ рд▓рд╛рддрд╛ рд╣реВрдБред</em>  <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреЛрдб</a> рдореЗрдВ рдЕрдкрдиреЗ рдмреНрд▓реЙрдЧ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдореЗрдВ,</a> рдпрд╣ рд▓реЗрдЦрдХ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕реБрдВрджрд░ рдФрд░ рд╕реБрд░реБрдЪрд┐рдкреВрд░реНрдг рдХрд╛рд░реНрдпрд╛рддреНрдордХ рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреЗ рдЧрдгрд┐рддреАрдп рд╕рд╛рд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЖрд╕рд╛рди рднрд╛рд╖рд╛ рдореЗрдВ рдмрд╛рдд рдХрд░рддрд╛ рд╣реИред</em>  <em>рдпрд╣ рдЖрд▓реЗрдЦ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдЙрджрд╛рд╣рд░рдг рджреЗрддрд╛ рд╣реИ рдХрд┐ рдЧрдгрд┐рддреАрдп рд╕рдВрд░рдЪрдирд╛ рдХреЛ рдХреИрд╕реЗ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП рдЬреЛ рд╡рд┐рд╖рдп рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдбреЗрдЯрд╛ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдкреНрд░рдХрд╛рд░реЛрдВ рдХреА рдПрдХ рдкреНрд░рдгрд╛рд▓реА рдХреЗ рд░реВрдк рдореЗрдВ рддреБрд░рдВрдд рддреИрдпрд╛рд░ рд╣реЛ, рдЬреИрд╕рд╛ рдХрд┐ рдЧреЗрд░рд╛рд▓реНрдб рдФрд░ рд╕рд╕реНрдорд╛рди рдиреЗ "рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ" рд▓рд┐рдЦрд╛ рдерд╛, рдПрдХ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рдорд╛рдзрд╛рди рдХрд╛ рдиреЗрддреГрддреНрд╡ рдХрд░рддрд╛ рд╣реИред</em> </p><br><p> <em>рддрд╕реНрд╡реАрд░ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рдХреЛрдб рдПрдХ рдкреВрд░реНрдг рд╕реНрд╡-рдирд┐рд╣рд┐рдд, рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдкрд╛рд░реНрд╕рд░ рдХрд╛ рдПрдХреНрд╕реНрдЯреЗрдВрд╕рд┐рдмрд▓ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╣реИ, рдЬрд┐рд╕реЗ рд╕реНрдХреНрд░реИрдЪ рд╕реЗ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИред</em>  <em>рд╢реАрд░реНрд╖ рд╡рд░реНрдЧ, рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЬрд╛рджреВ!</em> </p><a name="habracut"></a><br><p>  рдЖрдЬ рд╣рдо рдореБрдХреНрдд рдмреАрдЬреАрдп рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╡реЗрджрдХ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдФрд░ рдкрд╛рд░реНрд╕рд░ ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд░реЗрдЧреЗрдХреНрд╕-рдПрдкреЗрд░реЗрдЯрд┐рд╡</a> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреА рднрд╛рд╡рдирд╛ рдореЗрдВ) рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ!  рд╣рд╛рд╕реНрдХреЗрд▓ рдореЗрдВ рдореБрдлреНрдд рд╕рдВрд░рдЪрдирд╛рдПрдВ рдореЗрд░реЗ рдкрд╕рдВрджреАрджрд╛ рдЙрдкрдХрд░рдгреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИрдВ рдФрд░ рдореИрдВрдиреЗ рдкрд╣рд▓реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдореБрдХреНрдд рд╕рдореВрд╣реЛрдВ</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдореБрдлреНрдд рдордареЛрдВ</a> рдХреЗ рд╡рд┐рд╖рдп рдореЗрдВ рднрд┐рдиреНрдирддрд╛рдПрдВ рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдореЛрдиреЛрдЗрдбреНрд╕</a> рдкрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">"рдореБрдХреНрдд"</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЖрд╡реЗрджрдирдХрд░реНрддрд╛ рдлрд╝рдирдХрд╛рд░ рдХреЗ</a> рдмрд╛рд░реЗ рдореЗрдВ рд▓рд┐рдЦрд╛ рдерд╛ред </p><br><p>  рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ (рдФрд░ рдЙрдирдХреЗ рд▓рд┐рдП рдкрд╛рд░реНрд╕рд░) рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдФрд░ рдХрдВрдкреНрдпреВрдЯрд░ рд╡рд┐рдЬреНрдЮрд╛рди рдореЗрдВ рд╕рд░реНрд╡рд╡реНрдпрд╛рдкреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдореБрдЭреЗ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рд╡реЗ рдореБрдХреНрдд рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рддрдирд╛ рд╕рд░рд▓ рдкреНрд░рджрд░реНрд╢рди рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдореИрдВ рдЕрдирд╛рд╡рд╢реНрдпрдХ рд╡рд┐рд╡рд░рдгреЛрдВ рдореЗрдВ рдЦреЛ рдЬрд╛рдиреЗ рдХреЗ рдбрд░ рдХреЗ рдмрд┐рдирд╛ рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рдЧреБрдгреЛрдВ рдХреА рд╕рд░рд╛рд╣рдирд╛ рдХрд░рдиреЗ рдореЗрдВ рдкрд╛рдардХ рдХреА рдорджрдж рдХрд░реВрдВрдЧрд╛ред </p><br><p> рд▓реЗрдЦ рдХрд╛ рд╕рднреА рдХреЛрдб "рд╕реНрдЯреИрдХ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓" рдХреЗ рд░реВрдк рдореЗрдВ рдСрдирд▓рд╛рдЗрди <a href="">рдЙрдкрд▓рдмреНрдз рд╣реИ</a> ред  рдпрджрд┐ рдЖрдк рдЗрд╕реЗ ( <code>./regexp.hs</code> ) рдЪрд▓рд╛рддреЗ рд╣реИрдВ, рддреЛ GHCi рд╕рддреНрд░ рд╕рднреА рдкрд░рд┐рднрд╛рд╖рд╛рдУрдВ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЗ рдкрд╛рд╕ рдлрд╝рдВрдХреНрд╢рди рдФрд░ рдЙрдирдХреЗ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдЦреЗрд▓рдиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рд╣реЛрдЧрд╛ред </p><br><p>  рдпрд╣ рд▓реЗрдЦ "рдЙрдиреНрдирдд рд╢реБрд░реБрдЖрдд", рдпрд╛ рд╣рд╛рд╕реНрдХреЗрд▓ рдореЗрдВ "рд╢реБрд░реБрдЖрддреА рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ" рдХреЗ рд▓рд┐рдП рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕рдордЭрдиреЗ рдпреЛрдЧреНрдп рд╣реЛрдЧрд╛ред  рдЗрд╕рдХреЗ рд▓рд┐рдП рднрд╛рд╖рд╛ рдХреА рдореВрд▓ рдЕрд╡рдзрд╛рд░рдгрд╛рдУрдВ рдХрд╛ рдЬреНрдЮрд╛рди рд╣реЛрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ: рдкреИрдЯрд░реНрди рдорд┐рд▓рд╛рди, рдмреАрдЬреАрдп рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░, рдФрд░ рдЕрдореВрд░реНрдд рдЬреИрд╕реЗ рдХрд┐ рдореЛрдиреЙрдпрдб, рдлрдВрдХреНрд╢рдирд▓рд░реНрд╕, рдФрд░ рдиреЛрдЯреЗрд╢рдиред </p><br><h1 id="regulyarnye-yazyki">  рдирд┐рдпрдорд┐рдд рднрд╛рд╖рд╛ </h1><br><p>  рдПрдХ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреБрдЫ рдирд┐рдпрдорд┐рдд рднрд╛рд╖рд╛ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рд╣реИред  рдФрдкрдЪрд╛рд░рд┐рдХ рд░реВрдк рд╕реЗ, рдРрд╕реА рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рддреАрди рдореВрд▓ рддрддреНрд╡реЛрдВ рд╕реЗ рдирд┐рд░реНрдорд┐рдд рд╣реЛрддреА рд╣реИ: </p><br><ol><li>  рдПрдХ рдЦрд╛рд▓реА рд╕реЗрдЯ рдПрдХ рдРрд╕рд╛ рддрддреНрд╡ рд╣реИ рдЬреЛ рдХрд┐рд╕реА рднреА рдЪреАрдЬрд╝ рдХреЗ рд▓рд┐рдП рдореИрдк рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред </li><li>  рдПрдХ рдЦрд╛рд▓реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдПрдХ рддрдЯрд╕реНрде рддрддреНрд╡ рд╣реИ рдЬреЛ рддреБрдЪреНрдЫ рд░реВрдк рд╕реЗ рдПрдХ рд░рд┐рдХреНрдд рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред </li><li>  рдПрдХ рд╢рд╛рдмреНрджрд┐рдХ рдПрдХ рдкреНрд░рддреАрдХ рд╣реИ рдЬреЛ рд╕реНрд╡рдпрдВ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред  рдмрд╣реБрдд рд╕реЗ рдПрдХ рддрддреНрд╡ред </li></ol><br><p>  рдФрд░ рддреАрди рдСрдкрд░реЗрд╢рдиреЛрдВ рд╕реЗ рднреА: </p><br><ol><li>  рд╕рдорд╛рд╕: <code>RS</code> , рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХрд╛ рдХреНрд░рдоред  рд╕реЗрдЯ (рдХрд╛рд░реНрдЯреЗрд╢рд┐рдпрди) рдХрд╛ рдЙрддреНрдкрд╛рджред </li><li>  рд╡реИрдХрд▓реНрдкрд┐рдХ: <code>R|S</code> , рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЗ рдмреАрдЪ рд╡рд┐рдХрд▓реНрдкред  рд╕реЗрдЯ рдХрд╛ рд╕рдВрдШред </li><li>  рд╡реЗрдЬ рд╕реНрдЯрд╛рд░: <code>R*</code> , рдПрдХ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреА рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдПрдХ рдордирдорд╛рдирд╛ рд╕рдВрдЦреНрдпрд╛ (рд╢реВрдиреНрдп рд╕рд╣рд┐рдд)ред </li></ol><br><p>  рдФрд░ рд╡рд╣ рд╕рдм рдЬреЛ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХрд░рддрд╛ рд╣реИ, рдХреЛрдИ рдФрд░ рдЕрдзрд┐рдХ, рдХреЛрдИ рдХрдо рдирд╣реАрдВред  рдЗрди рдмреБрдирд┐рдпрд╛рджреА рдШрдЯрдХреЛрдВ рд╕реЗ, рдЖрдк рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдкрд░ рдЕрдиреНрдп рд╕рднреА рдЬреНрдЮрд╛рдд рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ - рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <code>a+</code> рдХреЛ <code>aa*</code> рд░реВрдк рдореЗрдВ рд╡реНрдпрдХреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдЙрдкрдпреБрдХреНрдд рд╡рд░реНрдгреЛрдВ рдХреЗ рд╡рд┐рдХрд▓реНрдк рдХреЗ рд░реВрдк рдореЗрдВ <code>\w</code> рдЬреИрд╕реА рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </p><br><div class="spoiler">  <b class="spoiler_title">рдЕрдиреБрд╡рд╛рджрдХ рдХрд╛ рдиреЛрдЯ</b> <div class="spoiler_text"><p>  рдПрдХ рдирд┐рдпрдорд┐рдд рднрд╛рд╖рд╛ рдХреА рдЙрдкрд░реЛрдХреНрдд рдиреНрдпреВрдирддрдо рдкрд░рд┐рднрд╛рд╖рд╛ рдПрдХ рдЧрдгрд┐рддрдЬреНрдЮ рдХреЗ рд▓рд┐рдП рдХрд╛рдлреА рдкреВрд░реНрдг рд╣реИ, рд▓реЗрдХрд┐рди рдЕрд╡реНрдпрд╡рд╣рд╛рд░рд┐рдХ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдирдХрд╛рд░ рдпрд╛ рдЬреЛрдбрд╝ рдХреЗ рд╕рдВрдЪрд╛рд▓рди ("рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХреЛ рдЫреЛрдбрд╝рдХрд░ рдХрд┐рд╕реА рднреА рдЪрд░рд┐рддреНрд░") рдХреЛ рдореВрд▓ рдкрд░рд┐рднрд╛рд╖рд╛ рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд░реВрдк рдореЗрдВ рд▓рд┐рдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рдкреНрд░рддреНрдпрдХреНрд╖ рдЖрд╡реЗрджрди рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдореЗрдВ рдПрдХ рдШрд╛рддреАрдп рд╡реГрджреНрдзрд┐ рд╣реЛрдЧреАред </p></div></div><br><h1 id="alternativnyy-funktor">  рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рдирдХрд╛рд░ </h1><br><p>  рдЬрдм рдЖрдк рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ, рддреЛ рдХреНрдпрд╛ рдпрд╣ рдкрд░рд┐рдЪрд┐рдд рдирд╣реАрдВ рд▓рдЧрддрд╛ рд╣реИ?  рдпрд╣ рдореБрдЭреЗ рдХрдИ рдкреНрд░рдХрд╛рд░ рдХреЗ <code>Alternative</code> рд╡рд░реНрдЧ рдХреА рдпрд╛рдж рджрд┐рд▓рд╛рддрд╛ рд╣реИред  рдпрджрд┐ рдХреЛрдИ рдлрд╝рдирдХрд╛рд░ рдЗрд╕ рд╡рд░реНрдЧ рдХрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЗрд╕рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реИрдВ: </p><br><ol><li>  рд╡рд┐рдлрд▓рддрд╛ рдпрд╛ рдЧрдгрдирд╛ рддреНрд░реБрдЯрд┐ рдХреЗ рдЕрдиреБрд░реВрдк рдПрдХ рдЦрд╛рд▓реА рддрддреНрд╡ред </li><li>  <code>pure x</code> - рдПрдХ рдПрдХрд▓ рддрддреНрд╡ (рд▓рд╛рдЧреВ рд╡рд░реНрдЧ рд╕реЗ)ред </li><li>  рдСрдкрд░реЗрд╢рди <code>&lt;*&gt;</code> , рдЕрдиреБрдХреНрд░рдорд┐рдХ рдЧрдгрдирд╛ рдХрд╛ рдЖрдпреЛрдЬрдиред </li><li>  рдСрдкрд░реЗрд╢рди <code>&lt;|&gt;</code> , рд╡реИрдХрд▓реНрдкрд┐рдХ рдЧрдгрдирд╛рдУрдВ рдХрд╛ рдЖрдпреЛрдЬрдиред </li><li>  <code>many</code> рдлрд╝рдВрдХреНрд╢рди рд╢реВрдиреНрдп рдпрд╛ рдЕрдзрд┐рдХ рдмрд╛рд░ рдЧрдгрдирд╛ рджреЛрд╣рд░рд╛рдП рдЬрд╛рдиреЗ рдХрд╛ рд╕рдВрдЪрд╛рд▓рди рд╣реИред </li></ol><br><p>  рдпрд╣ рд╕рдм рдПрдХ рдирд┐рдпрдорд┐рдд рднрд╛рд╖рд╛ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рд╕рдорд╛рди рд╣реИ, рд╣реИ рдирд╛?  рд╢рд╛рдпрдж рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рдирдХрд╛рд░ рдХреЛ рд▓рдЧрднрдЧ рд╡рд╣реА рдЪрд╛рд╣рд┐рдП рдЬреЛ рд╣рдореЗрдВ рдЪрд╛рд╣рд┐рдП, рдХреЗрд╡рд▓ рдПрдХ рдЪреАрдЬрд╝ рдЬреЛ рдЧрд╛рдпрдм рд╣реИ рд╡рд╣ рд╣реИ рд╢рд╛рдмреНрджрд┐рдХ рд╡рд░реНрдг рдХреЗ рдЕрдиреБрд░реВрдк рдЖрджрд┐рдоред </p><br><p>  <code>Alternative</code> рд╡рд░реНрдЧ рдореЗрдВ рдХреЛрдИ рднреА рдирдпрд╛ рд╡реНрдпрдХреНрддрд┐ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Typeclassopedia рдХрд╛</a> рдПрдХ рдЕрдЪреНрдЫрд╛ рдкрд░рд┐рдЪрдп рдкрд╛ рд╕рдХрддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рд╣рдорд╛рд░реЗ рд▓реЗрдЦ рдХреЗ рдврд╛рдВрдЪреЗ рдореЗрдВ, рдпрд╣ рд╡рд░реНрдЧ рдХреЗрд╡рд▓ рдПрдХ "рджреЛрд╣рд░реЗ рдореЛрдиреЙрдЗрдб" рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╕рдВрдпреЛрдЬрди рдХреЗ рджреЛ рддрд░реАрдХреЛрдВ рдХреЗ рд╕рд╛рде <code>&lt;*&gt;</code> рдФрд░ <code>&lt;|&gt;</code> , рдЬреЛ рдПрдХ рдЕрд░реНрде рдореЗрдВ, рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрдЪрд╛рд▓рди <code>*</code> рдФрд░ <code>+</code> рд╕рд╛рде рддреБрд▓рдирд╛ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдПрдХ рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рдирдХрд╛рд░ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрдкрд░реНрдпреБрдХреНрдд рдкрд╛рдБрдЪ рдмрд┐рдВрджреБ рдФрд░ рдХрдореНрдпреВрдЯрд┐рд╡рд┐рдЯреА рдФрд░ рд╡рд┐рддрд░рдг рдХреЗ рдХреБрдЫ рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рдиреВрди рдкрд░реНрдпрд╛рдкреНрдд рд╣реИрдВред </p><br><div class="spoiler">  <b class="spoiler_title">рдЕрдиреБрд╡рд╛рджрдХ рдХрд╛ рдиреЛрдЯ (рдЙрдмрд╛рдК)</b> <div class="spoiler_text"><p>  рд╕рдЯреАрдХ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рд▓реЗрдЦрдХ "рдбрдмрд▓ рдореЛрдиреЙрдЗрдб" рдХреЗ рд╕рд╛рде рдереЛрдбрд╝рд╛ рдЙрддреНрд╕рд╛рд╣рд┐рдд рд╣реЛ рдЧрдпрд╛ред  <code>Alternative</code> рд╡рд░реНрдЧ рдЖрд╡реЗрджрдХ рдлрд╝рдирдХрд╛рд░ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ (рдХреБрдЫ рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рддрд╣рдд) рдПрдХ рдЕрд░реНрдзрд╡реГрддреНрдд рд╣реИ, рдПрдХ рд╕рдВрдЧреЛрд╖реНрдареА рдХреЗ рд▓рд┐рдП, рдЬрд╣рд╛рдВ рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рдВрдЪрд╛рд▓рди <code>&lt;|&gt;</code> рддрдЯрд╕реНрде рддрддреНрд╡ рдХреЗ рд╕рд╛рде рдПрдХ рд╕реНрдорд╛рд░рдХ monoid рдХреА рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рддрд╛ рд╣реИред  рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдСрдкрд░реЗрдЯрд░ </p><br><pre> <code class="haskell hljs">(&lt;*&gt;) :: <span class="hljs-type"><span class="hljs-type">Applicative</span></span> f =&gt; f (a -&gt; b) -&gt; fa -&gt; fb</code> </pre> <br><p>  рдПрдХ рд╕реЗрдорд┐рдирд╛рд░ рдореЗрдВ рдЧреБрдгрд╛ рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рдПрдирд╛рд▓реЙрдЧ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдореИрдЧреНрдорд╛</a> рднреА рдирд╣реАрдВ рдмрдирд╛рддрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдБрдХрд┐, <code>&lt;*&gt;</code> рдСрдкрд░реЗрдЯрд░ рдХреЗ рд╕рд╛рде, "рдПрдХрддрд░рдлрд╛" рдСрдкрд░реЗрдЯрд░ <code>*&gt;</code> рдФрд░ <code>&lt;*</code> <code>Control.Applicative</code> рдореЗрдВ рд▓рд╛рдЧреВ <code>&lt;*</code> ред <code>Control.Applicative</code> рдкреИрдХреЗрдЬред  рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдСрдкрд░реЗрдВрдб рдХреЗ рдкрд░рд┐рдгрд╛рдо рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рддрд╛ рд╣реИ рдЬреЛ "рдХреЛрдиреЗ" рдирд╣реАрдВ рджрд┐рдЦрд╛рддрд╛ рд╣реИ: </p><br><pre> <code class="haskell hljs">(&lt;*) :: <span class="hljs-type"><span class="hljs-type">Applicative</span></span> f =&gt; fa -&gt; fb -&gt; fa (*&gt;) :: <span class="hljs-type"><span class="hljs-type">Applicative</span></span> f =&gt; fa -&gt; fb -&gt; fb</code> </pre> <br><p>  рдпрджрд┐ рдкреНрд░рдХрд╛рд░ <code>a</code> рдФрд░ <code>b</code> рд╕рдВрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЗрди рдкрд░рд┐рдЪрд╛рд▓рдиреЛрдВ рдХреЗ рд╕рд╛рде рд╣рдо рдПрдХ рд╕реЗрдореАрдЧреНрд░реБрдк (рд╕рдВрд░рдЪрдирд╛ рдХреЗ рдЧреБрдгреЛрдВ рд╕реЗ рд╕рдВрдмрджреНрдзрддрд╛) рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВред  рдпрд╣ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдПрдХ рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рдирдХрд╛рд░ рдХреЗ рд▓рд┐рдП, рдЧреБрдгрди рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рджрд╛рдИрдВ рдФрд░ рдмрд╛рдИрдВ рдУрд░ рджреЛрдиреЛрдВ рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ рд╡рд┐рддрд░рдг рдпреЛрдЧреНрдп рд╣реИ, рдФрд░, рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд рддрдЯрд╕реНрде рддрддреНрд╡ (рд╢реВрдиреНрдп рдХрд╛ рдПрдирд╛рд▓реЙрдЧ) рдЧреБрдгрди рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд╡рд╢реЛрд╖рд┐рдд рддрддреНрд╡ рд╣реИред </p><br><p>  рд╕реЗрдореАрд░рд┐рдВрдЧреНрд╕ рднреА рд╕рдВрдЦреНрдпрд╛рдУрдВ, рд╕реЗрдЯреЛрдВ, рд╕реЗрдореАрд░рд┐рдВрдЧреНрд╕, рдмреАрдЬреАрдп рдкреНрд░рдХрд╛рд░реЛрдВ рдФрд░ ... рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдмрдирд╛рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╣рдо рдПрдХ рд╣реА рдмреАрдЬреАрдп рд╕рдВрд░рдЪрдирд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВред </p></div></div><br><p>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╣рдо рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдПрдХ рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рдирдХрд╛рд░, рдкреНрд▓рд╕ рд╢рд╛рдмреНрджрд┐рдХ рдЪрд░рд┐рддреНрд░ рдХреЗ рд▓рд┐рдП рдЖрджрд┐рдо рдорд╛рди рд╕рдХрддреЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди, рдЙрдиреНрд╣реЗрдВ рджреЗрдЦрдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реИ, рдФрд░ рдпрд╣ рд╣рдореЗрдВ рд╕реАрдзреЗ рдореБрдХреНрдд рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреА рдУрд░ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИред  "рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рдВрдХреНрдЯрд░ рдХреЗ рд╕рд╛рде рд╢рд╛рдмреНрджрд┐рдХ" рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рд╢рд╛рдмреНрджрд┐рдХ рдХреЛ <code>Alternative</code> рд╡рд░реНрдЧ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред </p><br><h1 id="svoboda">  рд╕реНрд╡рддрдВрддреНрд░рддрд╛ </h1><br><p>  рдЗрд╕ рддрд░рд╣ рд▓рд┐рдЦреЗрдВред  рдЖрджрд┐рдо рд╢рд╛рдмреНрджрд┐рдХ рдХреЗ рд▓рд┐рдП рдЯрд╛рдЗрдк рдХрд░реЗрдВ: </p><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Prim</span></span></span><span class="hljs-class"> a = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Prim</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Char</span></span></span><span class="hljs-class"> a </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Functor</span></span></span></span></code> </pre> <br><p>  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЬрдм рд╕реЗ рд╣рдо рдлрдВрдХреНрд╢рдирд▓рд░реНрд╕ (рдПрдкреНрд▓рд╛рдПрдВрдЯрд┐рд╡, рд╡реИрдХрд▓реНрдкрд┐рдХ) рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ, рддрдм рд╣рдорд╛рд░реЗ рд╕рднреА рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд "рдкрд░рд┐рдгрд╛рдо" рдЬреБрдбрд╝рд╛ рд╣реЛрдЧрд╛ред  рдРрд╕рд╛ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ <code>Functor</code> , <code>Functor</code> рдФрд░ <code>Alternative</code> рдХрдХреНрд╖рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╕рдордп, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдкреНрд░рдХрд╛рд░ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред </p><br><p>  рдПрдХ рдУрд░, рдЖрдк рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдЙрдкреЗрдХреНрд╖рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рджреВрд╕рд░реА рдУрд░, рдЖрдкрдХреЛ рдЗрд╕ рдореВрд▓реНрдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рдиреЗ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬреИрд╕рд╛ рдХрд┐ рдФрджреНрдпреЛрдЧрд┐рдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред </p><br><p>  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, <code>Prim 'a' 1 :: Prim Int</code> рдПрдХ рдЖрджрд┐рдо рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░реЗрдЧрд╛ рдЬреЛ рдХрд┐ рдЪрд░рд┐рддреНрд░ <code>'a'</code> рдирдХреНрд╢реЗ рдХрд░рддрд╛ рд╣реИ рдФрд░ рддреБрд░рдВрдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреА рдЬрд╛рддреА рд╣реИ, рдЬрд┐рд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдПрдХ рдЗрдХрд╛рдИ рд╣реЛрддреА рд╣реИред </p><br><p>  рдареАрдХ рд╣реИ, рдЕрдм ... рдЖрдЗрдП рд╣рдо рдЕрдкрдиреЗ рдЖрджрд┐рдо рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><code>free</code></a> рдкреБрд╕реНрддрдХрд╛рд▓рдп рд╕реЗ рдореБрдХреНрдд рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рд╛рдЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд╛рдВрдЫрд┐рдд рдЧрдгрд┐рддреАрдп рд╕рдВрд░рдЪрдирд╛ рджреЗрдВ: </p><br><pre> <code class="haskell hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Control.Alternative.Free type RegExp = Alt Prim</code> </pre> <br><p>  рд╡рд╣ рд╕рдм рд╣реИ!  рдпрд╣ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░рд╛ рдкреВрд░реНрдг рдкреНрд░рдХрд╛рд░ рд╣реИ!  <code>Functor</code> рдкреНрд░рдХрд╛рд░ рдХреЛ <code>Functor</code> рдХреНрд▓рд╛рд╕ рдХрд╛ рдЙрджрд╛рд╣рд░рдг рдШреЛрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдордиреЗ рд╕рднреА рдСрдкрд░реЗрд╢рдВрд╕ рдХреЛ <code>Alternative</code> рдФрд░ <code>Alternative</code> рдХрдХреНрд╖рд╛рдУрдВ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ <code>Applicative (Alt f)</code> рдФрд░ <code>Alternative (Alt f)</code> рдЙрджрд╛рд╣рд░рдг рд╣реИрдВред  рдЕрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╣реИ: </p><br><ul><li>  рддреБрдЪреНрдЫ рдЦрд╛рд▓реА рд╕реЗрдЯ - <code>Alternative</code> рд╡рд░реНрдЧ рд╕реЗ <code>empty</code> </li><li>  рдЦрд╛рд▓реА рд╕реНрдЯреНрд░рд┐рдВрдЧ - <code>pure</code> рдХреНрд▓рд╛рд╕ рд╕реЗ <code>pure</code> </li><li>  рд▓рд┐рдЯрд░рд▓ рдХреИрд░реЗрдХреНрдЯрд░ - рдмреЗрд╕рд┐рдХ <code>Prim</code> </li><li>  рд╕рд╛рдВрддреНрд╡рдирд╛ - <code>&lt;*&gt;</code> рдЖрд╡реЗрджрдирдХрд░реНрддрд╛ рд╡рд░реНрдЧ рд╕реЗ </li><li>  рд╡реИрдХрд▓реНрдкрд┐рдХ - <code>&lt;|&gt;</code> <code>Alternative</code> рд╡рд░реНрдЧ рд╕реЗ </li><li>  рдХреНрд▓реЗрди рд╕реНрдЯрд╛рд░ - <code>Alternative</code> рд╡рд░реНрдЧ рд╕реЗ <code>many</code> </li></ul><br><p>  рдФрд░ рдпрд╣ рд╕рдм рд╣рдореЗрдВ рдкреВрд░реА рддрд░рд╣ рд╕реЗ "рдореБрдлреНрдд" рдорд┐рд▓рд╛, рдЕрд░реНрдерд╛рдд "рдореБрдлреНрдд рдореЗрдВ"! </p><br><p>  рдЕрдирд┐рд╡рд╛рд░реНрдп рд░реВрдк рд╕реЗ, рдПрдХ рд╕реНрд╡рддрдВрддреНрд░ рд╕рдВрд░рдЪрдирд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╣рдореЗрдВ рдЖрдзрд╛рд░ рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдПрдХ рдЕрдореВрд░реНрддрддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ рдФрд░ рдЗрд╕рд╕реЗ рдЕрдзрд┐рдХ рдХреБрдЫ рдирд╣реАрдВред  рд▓реЗрдХрд┐рди рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ, рд╕реНрд╡рдпрдВ рдХреЗ рджреНрд╡рд╛рд░рд╛ рднреА, рдХреЗрд╡рд▓ рдПрдХ рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддреЗ рд╣реИрдВ: рдореВрд▓ рддрддреНрд╡ рдФрд░ рд╕рдВрдЪрд╛рд▓рди рдХрд╛ рдПрдХ рд╕реЗрдЯ, рди рддреЛ рдЕрдзрд┐рдХ рдФрд░ рди рд╣реА рдХрдо, рдЗрд╕рд▓рд┐рдП рдореБрдлреНрдд рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рдирдХрд╛рд░ рд╣рдореЗрдВ рдареАрдХ рд╡рд╣реА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдХреА рд╣рдореЗрдВ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдФрд░ рдирд╣реАрдВ, рд▓реЗрдХрд┐рди рдХрдо рдирд╣реАрдВред </p><br><p>  рдХреБрдЫ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдЖрд╡рд░рдг рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рдмрд╛рдж ... рдкреНрд░рдХрд╛рд░ рдкрд░ рдХрд╛рдо рдкреВрд░рд╛ рд╣реЛ рдЧрдпрд╛ рд╣реИ! </p><br><pre> <code class="haskell hljs"><span class="hljs-comment"><span class="hljs-comment">-- | charAs:   ,    charAs :: Char -&gt; a -&gt; RegExp a charAs cx = liftAlt (Prim cx) -- liftAlt :: fa -&gt; Alt fa   --   Prim   RegExp -- | char:         char :: Char -&gt; RegExp Char char c = charAs cc -- | string:         string :: String -&gt; RegExp String string = traverse char -- , ?</span></span></code> </pre> <br><h1 id="primery">  рдЙрджрд╛рд╣рд░рдг </h1><br><p>  рдЕрдЪреНрдЫрд╛, рдЪрд▓реЛ рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ?  рдЖрдЗрдП рдПрдХ рдореИрдЪ рдХреЗ рд╕рдлрд▓ рд╣реЛрдиреЗ рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ, <code>(a|b)(cd)*e</code> , рдЬреЛ рдХрд┐ рд░рд┐рдЯрд░реНрди рджреЗрддреЗ рд╣реИрдВ, рдпреВрдирд┐рдЯ рдкреНрд░рдХрд╛рд░ <code>()</code> : </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">testRegExp_</span></span> :: <span class="hljs-type"><span class="hljs-type">RegExp</span></span> () testRegExp_ = void $ (char 'a' &lt;|&gt; char 'b') *&gt; many (string <span class="hljs-string"><span class="hljs-string">"cd"</span></span>) *&gt; char 'e'</code> </pre> <br><p>  рдлрд╝рдВрдХреНрд╢рди <code>void :: Functor f =&gt; fa -&gt; f ()</code> <code>Data.Functor</code> рдкреИрдХреЗрдЬ рд╕реЗ рдкрд░рд┐рдгрд╛рдо рдХреЛ рдЫреЛрдбрд╝ рджреЗрддрд╛ рд╣реИ, рд╣рдо рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдХреЗрд╡рд▓ рддреБрд▓рдирд╛ рдХреА рд╕рдлрд▓рддрд╛ рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди рд╕рдВрдЪрд╛рд▓рдХ <code>&lt;|&gt;</code> , <code>*&gt;</code> рдФрд░ <code>many</code> рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рдареАрдХ рдЙрд╕реА рддрд░рд╣ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ рдпрд╣ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕реА рд╡рд┐рдХрд▓реНрдк рдХреЛ рдЪреБрдирдиреЗ рдпрд╛ рдЪреБрдирдиреЗ рдкрд░ред </p><br><p>  рдпрд╣рд╛рдВ рдПрдХ рджрд┐рд▓рдЪрд╕реНрдк рдФрд░ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рдЙрджрд╛рд╣рд░рдг рд╣реИ, рдЪрд▓реЛ рдЙрд╕реА рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЕрдм, рдорд┐рд▓рд╛рди рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдо рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди <code>cd</code> рдХреА рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВред </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">testRegExp</span></span> :: <span class="hljs-type"><span class="hljs-type">RegExp</span></span> <span class="hljs-type"><span class="hljs-type">Int</span></span> testRegExp = (char 'a' &lt;|&gt; char 'b') *&gt; (length &lt;$&gt; many (string <span class="hljs-string"><span class="hljs-string">"cd"</span></span>)) &lt;* char 'e'</code> </pre> <br><p>  <code>*&gt;</code> рдФрд░ <code>&lt;*</code> рдСрдкрд░реЗрдЯрд░реЛрдВ рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдореЗрдВ рдПрдХ рд╕реВрдХреНрд╖реНрдорддрд╛ рд╣реИ: рддреАрд░ рдкрд░рд┐рдгрд╛рдо рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдмрдЪрд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдФрд░ <code>many (string "cd") :: RegExp [String]</code> рджреЛрд╣рд░рд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рддрддреНрд╡реЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рджреЗрддрд╛ рд╣реИ, рд╣рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдлрд╝рдирдХрд╛рд░ рдХреЗ рдЕрдВрджрд░ рд╢реЗрд╖, рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдХреЗ рдЗрд╕ рд╕реВрдЪреА рдХреА рд▓рдВрдмрд╛рдИ рдХреА рдЧрдгрдирд╛ рдХрд░реЗрдВред </p><br><p>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, GHC <code>-XApplicativeDo</code> рд╕рдВрдХрд▓рдХ <code>-XApplicativeDo</code> do-notation рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреА рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ <code>-XApplicativeDo</code> , рдЬрд┐рд╕реЗ рд╕рдордЭрдирд╛ рдЖрд╕рд╛рди рд╣реИ: </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">testRegExpDo</span></span> :: <span class="hljs-type"><span class="hljs-type">RegExp</span></span> <span class="hljs-type"><span class="hljs-type">Int</span></span> testRegExpDo = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> char 'a' &lt;|&gt; char 'b' cds &lt;- many (string <span class="hljs-string"><span class="hljs-string">"cd"</span></span>) char 'e' pure (length cds)</code> </pre> <br><p>  рдпрд╣ рд╕рдм рдХреБрдЫ рдЗрд╕реА рддрд░рд╣ рд╣реИ рдХрд┐ рд╣рдо рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдХреИрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдПрдХ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рд╣реИред  рдпрд╣рд╛рдБ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ рд░реВрдмреА рдореЗрдВ: </p><br><pre> <code class="ruby hljs">irb&gt; <span class="hljs-regexp"><span class="hljs-regexp">/(a|b)((cd)*)e/</span></span>.match(<span class="hljs-string"><span class="hljs-string">"acdcdcdcde"</span></span>)[<span class="hljs-number"><span class="hljs-number">2</span></span>] =&gt; <span class="hljs-string"><span class="hljs-string">"cdcdcdcd"</span></span></code> </pre> <br><p>  рдПрдХрдорд╛рддреНрд░ рдЕрдВрддрд░ рдпрд╣ рд╣реИ рдХрд┐ рд╣рдордиреЗ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдкреЛрд╕реНрдЯ-рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЛ рдЬреЛрдбрд╝рд╛ред </p><br><p>  рдпрд╣рд╛рдВ рдПрдХ рдФрд░ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдирд┐рдпрдорд┐рдд <code>\d</code> рдЬреЛ 0 рд╕реЗ 9 рддрдХ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ рдФрд░ рдПрдХ рдирдВрдмрд░ рджреЗрддрд╛ рд╣реИ: </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">digit</span></span> :: <span class="hljs-type"><span class="hljs-type">RegExp</span></span> <span class="hljs-type"><span class="hljs-type">Int</span></span> digit = asum [ charAs (intToDigit i) i | i &lt;- [<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-number"><span class="hljs-number">.9</span></span>] ]</code> </pre> <br><p>  рдпрд╣рд╛рдВ, <code>Control.Applicative.Alternative</code> рдкреИрдХреЗрдЬ рд╕реЗ <code>asum</code> рдлрд╝рдВрдХреНрд╢рди рд╕реВрдЪреА рдЖрдЗрдЯрдо <code>asum [x,y,z] = x &lt;|&gt; y &lt;|&gt; z</code> рд╕реЗ рдПрдХ рдЪрдпрди рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ, рдФрд░ <code>intToDigit</code> рдлрд╝рдВрдХреНрд╢рди <code>Data.Char</code> рдкреИрдХреЗрдЬ рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдФрд░, рдлрд┐рд░ рд╕реЗ, рд╣рдо рдХрд╛рдлреА рд╕реБрд░реБрдЪрд┐рдкреВрд░реНрдг рдЪреАрдЬреЗрдВ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╡рд░реНрдЧ рдХреЛрд╖реНрдардХ рдореЗрдВ рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдЕрдиреБрд░реВрдк рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ <code>\[\d\]</code> : </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">bracketDigit</span></span> :: <span class="hljs-type"><span class="hljs-type">RegExp</span></span> <span class="hljs-type"><span class="hljs-type">Int</span></span> bracketDigit = char '[' *&gt; digit &lt;* char ']'</code> </pre> <br><h1 id="parsing">  рдкрджрдЪреНрдЫреЗрдж </h1><br><p>  рдареАрдХ рд╣реИ, рдареАрдХ рд╣реИ, рд╣рдо рд╕рдм рдХрд┐рдпрд╛ рдерд╛ рд╡рд░реНрдгрди, рдЪрдпрди, рдФрд░ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рд╢рд╛рдмреНрджрд┐рдХ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░ред  рдмрд╣реБрдд рдмрдврд╝рд┐рдпрд╛!  рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рд╣рдореЗрдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреА рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рд╣реИ рдирд╛?  рдПрдХ рдореБрдлреНрдд рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рдирдХрд╛рд░ рдХреИрд╕реЗ рд╣рдорд╛рд░реА рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИ?  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдмрд╣реБрдд рдорджрдж рдХрд░реЗрдЧрд╛ред  рдЖрдЗрдП рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рджреЛ рддрд░реАрдХреЗ рджреЗрдЦреЗрдВ! </p><br><h2 id="razgruzhaem-alternativnyy-funktor">  рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рдирдХрд╛рд░ рдХреЛ рдЙрддрд╛рд░реЗрдВ </h2><br><p>  <strong>рд╕реНрд╡рддрдВрддреНрд░рддрд╛ рдХреНрдпрд╛ рд╣реИ?</strong> </p><br><p>  рдПрдХ рд╕реНрд╡рддрдВрддреНрд░ рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рд╡рд┐рд╣рд┐рдд рддрд░реАрдХрд╛ рдЙрдкрдпреБрдХреНрдд рдмреАрдЬрдЧрдгрд┐рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдПрдХ рдареЛрд╕ рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рдореЛрдбрд╝рдирд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <code>foldMap</code> рдЯреНрд░рд╛рдВрд╕рдлрд╝реЙрд░реНрдо рдПрдХ рдореБрдХреНрдд <code>foldMap</code> (рд╕реВрдЪреА) рдХреЛ <code>Monoid</code> рд╡рд░реНрдЧ рдХреЗ рдХрд┐рд╕реА рднреА рдЙрджрд╛рд╣рд░рдг рдХреЗ рдореВрд▓реНрдп рдореЗрдВ рдмрджрд▓ рджреЗрддрд╛ рд╣реИ: </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">foldMap</span></span> :: <span class="hljs-type"><span class="hljs-type">Monoid</span></span> m =&gt; (a -&gt; m) -&gt; ([a] -&gt; m)</code> </pre> <br><p>  <code>foldMap</code> рдлрд╝рдВрдХреНрд╢рди рд░реВрдкрд╛рдВрддрд░рдг рдХреЛ <code>a -&gt; m</code> <code>foldMap</code> <code>a -&gt; m</code> рдХреЗ рд╕рд╛рде рд░реВрдкрд╛рдВрддрд░рдг <code>[a] -&gt; m</code> рдореЗрдВ рдмрджрд▓ рджреЗрддрд╛ рд╣реИ <code>[a] -&gt; m</code> (рдпрд╛, <code>FreeMonoid a -&gt; m</code> )ред  рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рдЪрд╛рд░ рдпрд╣ рд╣реИ рдХрд┐ рдПрдХ рд╕реНрд╡рддрдВрддреНрд░ рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрдкрдХреЛ рдЗрд╕рдХреЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЙрдкрдпреЛрдЧ рдХреЛ "рдмрд╛рдж рдХреЗ рд▓рд┐рдП" рд╕реНрдердЧрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд░рдЪрдирд╛ рд╕рдордп рдФрд░ рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рдЕрд▓рдЧ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕рдВрдЦреНрдпрд╛рдУрдВ рд╕реЗ рдореБрдХреНрдд рдореЛрдиреЙрдЗрдб рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="haskell hljs"><span class="hljs-comment"><span class="hljs-comment">-- |  "" `Int`     `Int`,  `liftAlt`. liftFM :: Int -&gt; [Int] liftFM x = [x] myMon :: [Int] myMon = liftFM 1 &lt;&gt; liftFM 2 &lt;&gt; liftFM 3 &lt;&gt; liftFM 4</span></span></code> </pre> <br><p>  рдФрд░ рдЕрдм рд╣рдо рддрдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╣рдо рдСрдкрд░реЗрд╢рди рдХреА рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреИрд╕реЗ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ <code>&lt;&gt;</code> : <br>  рд╢рд╛рдпрдж рдпрд╣ рдЬреЛрдбрд╝? </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">ghci</span></span>&gt; foldMap <span class="hljs-type"><span class="hljs-type">Sum</span></span> myMon <span class="hljs-type"><span class="hljs-type">Sum</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-comment"><span class="hljs-comment">-- 1 + 2 + 3 + 4</span></span></code> </pre> <br><p>  рдпрд╛ рдЧреБрдгрд╛? </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">ghci</span></span>&gt; foldMap <span class="hljs-type"><span class="hljs-type">Product</span></span> myMon <span class="hljs-type"><span class="hljs-type">Product</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-comment"><span class="hljs-comment">-- 1 * 2 * 3 * 4</span></span></code> </pre> <br><p>  рдпрд╛ рд╢рд╛рдпрдж рдЕрдзрд┐рдХрддрдо рд╕рдВрдЦреНрдпрд╛ рдХреА рдЧрдгрдирд╛? </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">ghci</span></span>&gt; foldMap <span class="hljs-type"><span class="hljs-type">Max</span></span> myMon <span class="hljs-type"><span class="hljs-type">Max</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-comment"><span class="hljs-comment">-- 1 `max` 2 `max` 3 `max` 4</span></span></code> </pre> <br><p>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рд╕рдВрдЦреНрдпрд╛ 1, 2, 3, рдФрд░ 4 рдХреЗ рдПрдХ рдирд┐: рд╢реБрд▓реНрдХ рд╕рдВрдЧреНрд░рд╣ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░рдХреЗ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдореЛрдиреЙрдпрдб рдХреЗ рдЪрдпрди рдХреЛ рд╕реНрдердЧрд┐рдд рдХрд░рдиреЗ рдХрд╛ рд╡рд┐рдЪрд╛рд░ рд╣реИред рд╕рдВрдЦреНрдпрд╛рдУрдВ рдкрд░ рдПрдХ рдореБрдХреНрдд рдореЛрдиреЙрдЗрдб рдЙрдирдХреЗ рдКрдкрд░ рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдХреА рдЖрдкрдХреЛ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдХреЛрдИ рдФрд░ рдЕрдзрд┐рдХ, рдХреЛрдИ рдХрдо рдирд╣реАрдВред  <code>foldMap</code> рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>foldMap</code> рд╣рдо рдПрдХ рд╡рд┐рд╢реЗрд╖ рдореЛрдиреЙрдЗрдб рдХреЗ рд▓рд┐рдП <code>&lt;&gt;</code> рдСрдкрд░реЗрдЯрд░ рдХреЛ рдкрд╛рд╕ рдХрд░рдХреЗ "рдЖрдзрд╛рд░ рдкреНрд░рдХрд╛рд░ рдХреЛ рдХреИрд╕реЗ рджреЗрдЦреЗрдВ" рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреЗ рд╣реИрдВред </p><br><p>  <strong>рдПрдХ <code>State</code> рдлрдирдХрд╛рд░ рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛</strong> </p><br><p>  рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ, рдПрдХ рдореБрдХреНрдд рд╕рдВрд░рдЪрдирд╛ рд╕реЗ рдПрдХ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдПрдХ рдЙрдкрдпреБрдХреНрдд рдлрд╝рдирдХрд╛рд░ рдХреЛ рдЦреЛрдЬрдиреЗ (рдпрд╛ рдмрдирд╛рдиреЗ) рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рд╣рдореЗрдВ рд╡рд╛рдВрдЫрд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рдкреНрд░рджрд╛рди рдХрд░реЗрдЧрд╛ред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рднрд╛рдЧреНрдпрд╢рд╛рд▓реА рд╣реИрдВ рдХрд┐ <code>Alternative</code> рд╡рд░реНрдЧ рдХрд╛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╣реИ рдЬреЛ рдареАрдХ рд╡реИрд╕реЗ рд╣реА рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕реЗ рд╣рдореЗрдВ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: <code>StateT String Maybe</code> ред </p><br><p>  рдЗрд╕ рдлрд╝рдирдХрд╛рд░ рдХреЗ рд▓рд┐рдП рдЙрддреНрдкрд╛рдж <code>&lt;*&gt;</code> рдореЗрдВ рд░рд╛рдЬреНрдп рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЗ рдХреНрд░рдо рдХреЛ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд░рд╛рдЬреНрдп рдХреЗ рддрд╣рдд, рд╣рдо рдкрд╛рд░реНрд╕ рдХрд┐рдП рдЧрдП рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд╢реЗрд╖ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВрдЧреЗ, рддрд╛рдХрд┐ рдЕрдиреБрдХреНрд░рдорд┐рдХ рдкрд╛рд░реНрд╕рд┐рдВрдЧ рдСрдкрд░реЗрд╢рди рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдореИрдЪ <code>&lt;*&gt;</code> ред </p><br><p>  рдФрд░ рдЗрд╕рдХрд╛ рдпреЛрдЧ <code>&lt;|&gt;</code> рдмреИрдХрдЯреНрд░реИрдХрд┐рдВрдЧ рдХреА рддрд░рд╣ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд╡рд┐рдлрд▓рддрд╛ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд╡рд┐рдХрд▓реНрдк рдХреА рд╡рд╛рдкрд╕реА рдХреЗ рд╕рд╛рде рдПрдХ рдЦреЛрдЬред  рдпрд╣ рдЕрдВрддрд┐рдо рд╕рдлрд▓ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдмрд╛рдж рд╕реЗ рд░рд╛рдЬреНрдп рдХреЛ рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИ рдФрд░ рдпрджрд┐ рд╡рд┐рдХрд▓реНрдк рдЕрд╕рдлрд▓ рд░реВрдк рд╕реЗ рдЪреБрдирд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдпрд╣ рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ рдмрд┐рд▓реНрдХреБрд▓ рдРрд╕рд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рд╣реИ рдЬреЛ рд╣рдо рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рд╕реЗ рдЙрдореНрдореАрдж рдХрд░рддреЗ рд╣реИрдВ <code>R|S</code> </p><br><p>  рдЕрдВрдд рдореЗрдВ, рдПрдХ рдореБрдлреНрдд рд╡реИрдХрд▓реНрдкрд┐рдХ <code>runAlt</code> рд▓рд┐рдП рдПрдХ рдкреНрд░рд╛рдХреГрддрд┐рдХ рдкрд░рд┐рд╡рд░реНрддрди рдХреЛ <code>runAlt</code> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ: </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">runAlt</span></span> :: <span class="hljs-type"><span class="hljs-type">Alternative</span></span> f =&gt; (<span class="hljs-keyword"><span class="hljs-keyword">forall</span></span> b. pb -&gt; fb) -&gt; <span class="hljs-type"><span class="hljs-type">Alt</span></span> pa -&gt; fa</code> </pre> <br><p>  рдпрд╛, RegExp рдЯрд╛рдЗрдк рдХрд░реЗрдВ: </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">runAlt</span></span> :: <span class="hljs-type"><span class="hljs-type">Alternative</span></span> f =&gt; (<span class="hljs-keyword"><span class="hljs-keyword">forall</span></span> b. <span class="hljs-type"><span class="hljs-type">Prim</span></span> b -&gt; fb) -&gt; <span class="hljs-type"><span class="hljs-type">RegExp</span></span> a -&gt; fa</code> </pre> <br><p>  рдпрджрд┐ рдЖрдк <code>RankN</code> рдкреНрд░рдХрд╛рд░ ( <code>forall b.</code> рдХрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдХреЗ рд╕рд╛рде) рд╕реЗ рдкрд░рд┐рдЪрд┐рдд рдирд╣реАрдВ рд╣реИрдВ, рддреЛ рдЖрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рдПрдХ рдЕрдЪреНрдЫрд╛ рдкрд░рд┐рдЪрдп рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред  рдпрд╣рд╛рдБ рдореБрджреНрджрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЖрдкрдХреЛ рдПрдХ <code>runAlt</code> рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рджрд╛рди рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬреЛ рдХрд┐ рдХрд┐рд╕реА рднреА <code>b</code> рд▓рд┐рдП <code>Prim b</code> рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <code>Int</code> рдФрд░ <code>Bool</code> рдЬреИрд╕реЗ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдирд╣реАрдВред  рдпрд╣ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ <code>foldMap</code> рд╕рд╛рде рд╣реИ <code>foldMap</code> рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдпрд╣ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдЖрдзрд╛рд░ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рд╛рде рдХреНрдпрд╛ рдХрд░рдирд╛ рд╣реИред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЗрд╕ рдкреНрд░рд╢реНрди рдХрд╛ рдЙрддреНрддрд░ рджреЗрдВ: "рдЯрд╛рдЗрдк <code>Prim</code> рд╕рд╛рде рдХреНрдпрд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ?" </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">processPrim</span></span> :: <span class="hljs-type"><span class="hljs-type">Prim</span></span> a -&gt; <span class="hljs-type"><span class="hljs-type">StateT</span></span> <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-type"><span class="hljs-type">Maybe</span></span> a processPrim (<span class="hljs-type"><span class="hljs-type">Prim</span></span> cx) = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> d:ds &lt;- get guard (c == d) put ds pure x</code> </pre> <br><p>  рдпрд╣ <code>StateT String Maybe</code> рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдПрдХ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреЗ рд░реВрдк рдореЗрдВ <code>Prim</code> рд╡реНрдпрд╛рдЦреНрдпрд╛ рд╣реИ, рдЬрд╣рд╛рдВ рд░рд╛рдЬреНрдп рдПрдХ <code>StateT String Maybe</code> рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╣реИред  рдЖрдкрдХреЛ рдпрд╛рдж рджрд┐рд▓рд╛ рджреВрдВ рдХрд┐ <code>Prim</code> рдореЗрдВ рдореИрдЪрд┐рдВрдЧ рдХреИрд░реЗрдХреНрдЯрд░ <code>c</code> рдФрд░ рдЗрд╕рдХреЗ <code>x</code> рдХреЗ рдХреБрдЫ рдореВрд▓реНрдп рдХреЗ рд░реВрдк рдореЗрдВ рдЗрд╕рдХреА рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╣реИред  <code>Prim</code> рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд░рдг рд╣реЛрддреЗ рд╣реИрдВ: </p><br><ul><li>  Get рдХрд╛ рдЙрдкрдпреЛрдЧ <code>get</code> рд░рд╛рдЬреНрдп (рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХрд╛ рдЕрднреА рддрдХ рдкрд╛рд░реНрд╕ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣рд┐рд╕реНрд╕рд╛) рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рддреБрд░рдВрдд рдЕрдкрдиреЗ рдкрд╣рд▓реЗ рдЪрд░рд┐рддреНрд░ рдХрд╛ рдкреНрд░рд┐рдВрдЯ рдирд┐рдХрд╛рд▓рддреЗ рд╣реИрдВ рдФрд░ рд╢реЗрд╖ рд░рд╣рддреЗ рд╣реИрдВред  рдпрджрд┐ рд░реЗрдЦрд╛ рдЦрд╛рд▓реА рд╣реИ, рддреЛ рдПрдХ рд╡рд┐рдХрд▓реНрдк рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рдПрдЧрд╛ред  ( <em><code>StateT</code> рд╢рд╛рдпрдж <code>StateT</code> рдЕрдВрджрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЕрдЧрд░ рдпрд╣ рдмреНрд▓реЙрдХ рдХреЗ рдЕрдВрджрд░ <code>&lt;-</code> рдСрдкрд░реЗрдЯрд░ рдХреЗ рджрд╛рдИрдВ рдУрд░ рдкреИрдЯрд░реНрди рд╕реЗ рдореЗрд▓ рдХрд░рдирд╛ рдЕрд╕рдВрднрд╡ рд╣реИ, рддреЛ рдЧрдгрдирд╛ рдкрд░рд┐рдгрд╛рдо рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рдПрдЧреА, рдЕрд░реНрдерд╛рдд, <code>Nothing</code> ред рд▓рдЧрднрдЧред рдЯреНрд░рд╛рдВрд╕ред</em> ) </li><li>  рд╣рдо рджрд┐рдП рдЧрдП рдЪрд░рд┐рддреНрд░ рдХреЗ рд╕рд╛рде рд╡рд░реНрддрдорд╛рди рдЪрд░рд┐рддреНрд░ рд╕реЗ рдореЗрд▓ рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЧрд╛рд░реНрдб рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рд╡рд┐рдлрд▓рддрд╛ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, <code>empty</code> рд▓реМрдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рд╣рдо рд╡реИрдХрд▓реНрдкрд┐рдХ рд╡рд┐рдХрд▓реНрдк рдХреЗ рдкрд╛рд╕ рдЬрд╛рддреЗ рд╣реИрдВред </li><li>  рд╣рдо рдЕрдкрдиреА "рдкреВрдВрдЫ" рдХреЗ рд╕рд╛рде рдкрд╛рд░реНрд╕ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдмрджрд▓рдХрд░ рд░рд╛рдЬреНрдп рдмрджрд▓рддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕ рдХреНрд╖рдг рддрдХ рд╡рд░реНрддрдорд╛рди рдЪрд░рд┐рддреНрд░ рдХреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </li><li>  рд╣рдо рд╡рд╣реА рд▓реМрдЯрддреЗ рд╣реИрдВ рдЬреЛ рдХрд┐ рдЖрджрд┐рдо рдХреЛ рд╡рд╛рдкрд╕ рд▓реМрдЯрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред </li></ul><br><p>  рдЖрдк рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА RegEx рдХреЛ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдЙрдкрд╕рд░реНрдЧ рдореЗрдВ рдореИрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ <code>runAlt</code> рдФрд░ <code>runStateT</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЧрдгрдирд╛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдПрдХ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд┐рдЫрд▓реЗ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкрд╛рд░реНрд╕ рдХрд┐рдП рдЧрдП рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдкрд╛рд╕ рдХрд░рдирд╛: </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">matchPrefix</span></span> :: <span class="hljs-type"><span class="hljs-type">RegExp</span></span> a -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Maybe</span></span> a matchPrefix re = evalStateT (runAlt processPrim re)</code> </pre> <br><p>  рдмрд╕ рдЗрддрдирд╛ рд╣реА!  рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рд╣рдорд╛рд░рд╛ рдкрд╣рд▓рд╛ рд╕рдорд╛рдзрд╛рди рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ: </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">ghci</span></span>&gt; matchPrefix testRegexp_ <span class="hljs-string"><span class="hljs-string">"acdcdcde"</span></span> <span class="hljs-type"><span class="hljs-type">Just</span></span> () ghci&gt; matchPrefix testRegexp_ <span class="hljs-string"><span class="hljs-string">"acdcdcdx"</span></span> <span class="hljs-type"><span class="hljs-type">Nothing</span></span> ghci&gt; matchPrefix testRegexp <span class="hljs-string"><span class="hljs-string">"acdcdcde"</span></span> <span class="hljs-type"><span class="hljs-type">Just</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> ghci&gt; matchPrefix testRegexp <span class="hljs-string"><span class="hljs-string">"bcdcdcdcdcdcdcde"</span></span> <span class="hljs-type"><span class="hljs-type">Just</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> ghci&gt; matchPrefix digit <span class="hljs-string"><span class="hljs-string">"9"</span></span> <span class="hljs-type"><span class="hljs-type">Just</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> ghci&gt; matchPrefix bracketDigit <span class="hljs-string"><span class="hljs-string">"[2]"</span></span> <span class="hljs-type"><span class="hljs-type">Just</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> ghci&gt; matchPrefix (many bracketDigit) <span class="hljs-string"><span class="hljs-string">"[2][3][4][5]"</span></span> <span class="hljs-type"><span class="hljs-type">Just</span></span> [<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>] ghci&gt; matchPrefix (sum &lt;$&gt; many bracketDigit) <span class="hljs-string"><span class="hljs-string">"[2][3][4][5]"</span></span> <span class="hljs-type"><span class="hljs-type">Just</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span></code> </pre> <br><p>  <strong>рд░реБрдХреЛ, рд╡рд╣ рдХреНрдпрд╛ рдерд╛?</strong> </p><br><p>  рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╕рдм рдХреБрдЫ рдЖрдкрдХреА рдЕрдкреЗрдХреНрд╖рд╛ рд╕реЗ рдереЛрдбрд╝рд╛ рддреЗрдЬ рд╣реБрдЖред  рдПрдХ рдорд┐рдирдЯ рдкрд╣рд▓реЗ рд╣рдордиреЗ рдЕрдкрдирд╛ рдЖрджрд┐рдо рд▓рд┐рдЦрд╛, рдФрд░ рдлрд┐рд░ рдлрд┐рд░ рд╕реЗ!  рдФрд░ рд╡рд░реНрдХрд┐рдВрдЧ рдкрд╛рд░реНрд╕рд░ рддреИрдпрд╛рд░ рд╣реИред  рдпрд╣рд╛рдБ, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╕рднреА рдкреНрд░рдореБрдЦ рдХреЛрдб, рд╣рд╛рд╕реНрдХреЗрд▓ рдореЗрдВ рдХреБрдЫ рдкрдВрдХреНрддрд┐рдпрд╛рдБ: </p><br><pre> <code class="haskell hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Control.Monad.Trans.State (<span class="hljs-title"><span class="hljs-title">evalStateT</span></span>, <span class="hljs-title"><span class="hljs-title">put</span></span>, <span class="hljs-title"><span class="hljs-title">get</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Control.Alternative.Free (<span class="hljs-title"><span class="hljs-title">runAlt</span></span>, <span class="hljs-type"><span class="hljs-type">Alt</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Control.Applicative <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Control.Monad (<span class="hljs-title"><span class="hljs-title">guard</span></span>) data Prim a = Prim Char a deriving Functor type RegExp = Alt Prim matchPrefix :: RegExp a -&gt; String -&gt; Maybe a matchPrefix re = evalStateT (<span class="hljs-title"><span class="hljs-title">runAlt</span></span> <span class="hljs-title"><span class="hljs-title">processPrim</span></span> <span class="hljs-title"><span class="hljs-title">re</span></span>) where processPrim (<span class="hljs-type"><span class="hljs-type">Prim</span></span> <span class="hljs-title"><span class="hljs-title">cx</span></span>) = do d:ds &lt;- get guard (<span class="hljs-title"><span class="hljs-title">c</span></span> == <span class="hljs-title"><span class="hljs-title">d</span></span>) put ds pure x</code> </pre> <br><p>  рдФрд░ рдХреНрдпрд╛ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкреВрд░реА рддрд░рд╣ рдХрд╛рд░реНрдпрд╛рддреНрдордХ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдкрд╛рд░реНрд╕рд░ рд╣реИ?  рдХреНрдпрд╛ рд╣реБрдЖ? </p><br><p>  рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рдЕрдореВрд░реНрддрддрд╛ рдХреЗ рдЙрдЪреНрдЪ рд╕реНрддрд░ рдкрд░, <code>Alt Prim</code> рдкрд╣рд▓реЗ рд╕реЗ рд╣реА <code>pure</code> , <code>empty</code> , <code>Prim</code> , <code>&lt;*&gt;</code> , <code>&lt;|&gt;</code> рдФрд░ <code>&lt;|&gt;</code> рдФрд░ рдЗрд╕рдХреА рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ <code>many</code> (рдЗрд╕ рдСрдкрд░реЗрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдЕрдкреНрд░рд┐рдп рд╕реВрдХреНрд╖реНрдорддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдмрд╛рдж рдореЗрдВ рдЙрд╕ рдкрд░ рдФрд░ рдЕрдзрд┐рдХ)ред  <code>runAlt</code> рдЬреЛ <code>runAlt</code> рдХрд░рддрд╛ рд╣реИ, рд╡рд╣ <code>pure</code> , <code>empty</code> , <code>&lt;*&gt;</code> , <code>&lt;|&gt;</code> , рдФрд░ <code>many</code> рдСрдкрд░реЗрдЯрд░реЛрдВ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╡реИрдХрд▓реНрдкрд┐рдХ <code>StateT String Maybe</code> (рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ <code>StateT String Maybe</code> ) рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдВрдХрд┐, <code>StateT</code> рдореЗрдВ <code>Prim</code> рд╕рдорд╛рди рдПрдХ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдСрдкрд░реЗрдЯрд░ рдирд╣реАрдВ рд╣реИ, рдФрд░ рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ <code>processPrim</code> рд▓рд┐рдЦрдиреЗ рдХреА <code>processPrim</code> ред </p><br><p>  рддреЛ, <code>Prim</code> рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓рд┐рдП, <code>runAlt</code> рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рдХреНрд░рд┐рдпрд╛рдкреНрд░реАрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдФрд░ <code>pure</code> , <code>empty</code> , <code>&lt;*&gt;</code> , <code>&lt;|&gt;</code> , рдФрд░ <code>many</code> , <code>Alternative</code> рд╡рд░реНрдЧ рдХрд╛ рдПрдХ рдЙрдкрдпреБрдХреНрдд рдЙрджрд╛рд╣рд░рдг рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, 83% рдХрд╛рдо рд╣рдорд╛рд░реЗ рд▓рд┐рдП <code>StateT</code> рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рд╢реЗрд╖ 17% <code>StateT</code> рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╕рдЪ рдореЗрдВ, рдпрд╣ рдХреБрдЫ рд╣рдж рддрдХ рдирд┐рд░рд╛рд╢рд╛рдЬрдирдХ рд╣реИред  рдПрдХ рдкреВрдЫ рд╕рдХрддрд╛ рд╣реИ: <code>Alt</code> рд░реИрдкрд░ рдХреЗ рд╕рд╛рде рд╢реБрд░реБрдЖрдд рдХрд░рдирд╛ рдХреНрдпреЛрдВ рдЖрд╡рд╢реНрдпрдХ рдерд╛?  рдХреНрдпреЛрдВ рдирд╣реАрдВ рддреБрд░рдВрдд рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ <code>RegExp = StateT String Maybe</code> рдФрд░ рдЙрдкрдпреБрдХреНрдд рдЖрджрд┐рдо <code>char :: Char -&gt; StateT String Maybe Char</code> ?  рдпрджрд┐ рд╕рдм рдХреБрдЫ рд╕реНрдЯреЗрдЯрдЯреА рдлрд╝рдирдХрд╛рд░ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ <code>Alt</code> рд╕рд╛рде рдкрд░реЗрд╢рд╛рди рдХреНрдпреЛрдВ рд╣реИ - рдПрдХ рдореБрдлреНрдд рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рдирдХрд╛рд░? </p><br><p>  <code>StateT</code> рдкрд░ <code>Alt</code> рдореБрдЦреНрдп рд▓рд╛рдн рдпрд╣ рд╣реИ рдХрд┐ <code>StateT</code> ... рдПрдХ рдмрд╣реБрдд рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдЙрдкрдХрд░рдг рд╣реИред  рд▓реЗрдХрд┐рди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╡рд╣ рдмреЗрддреБрдХреА рдмрд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рд╣реИред  рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╡рд┐рд╡рд┐рдз рдХрдореНрдкреНрдпреВрдЯреЗрд╢рдВрд╕ рдФрд░ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреА рдПрдХ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░, рдЕрдкреНрд░рд┐рдп рд░реВрдк рд╕реЗ, рдХрд┐рд╕реА рдРрд╕реА рдЪреАрдЬрд╝ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реИ рдЬреЛ рдПрдХ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдирд╣реАрдВ рд╣реИред  рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рдХреБрдЫ рдореВрд▓ рд╢рдмреНрдж рдЬреИрд╕реЗ <code>put "hello" :: StateT String Maybe ()</code> рдХрд┐рд╕реА рднреА рдорд╛рдиреНрдп рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рд╕реЗ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдЙрд╕реА рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣реИ рдЬреИрд╕реЗ рдХрд┐ <code>RegExp ()</code> ред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдЬрдмрдХрд┐ рд╣рдо рдХрд╣рддреЗ рд╣реИрдВ рдХрд┐ <code>Alt Prim</code> рдПрдХ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ, рдФрд░ рдЕрдзрд┐рдХ рдирд╣реАрдВ, рд▓реЗрдХрд┐рди рдХрдо рдирд╣реАрдВ, рд╣рдо <code>StateT String Maybe</code> рд╕рд╛рде рднреА <code>StateT String Maybe</code> рдирд╣реАрдВ рдХрд╣ рд╕рдХрддреЗред  <code>Alt Prim</code> рдкреНрд░рдХрд╛рд░ рдПрдХ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХрд╛ рд╕рд╣реА рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рд╣реИред  рдЗрд╕рдХреА рд╕рд╣рд╛рдпрддрд╛ рд╕реЗ рд╡реНрдпрдХреНрдд рдХреА рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реА рдкреНрд░рддреНрдпреЗрдХ рдЪреАрдЬрд╝ рдПрдХ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рд╣реИ, рд▓реЗрдХрд┐рди рдРрд╕реА рдХреЛрдИ рднреА рдЪреАрдЬрд╝ рдЬреЛ рдРрд╕реА рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рдХреА рд╕рд╣рд╛рдпрддрд╛ рд╕реЗ рд╡реНрдпрдХреНрдд рдирд╣реАрдВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред  рдпрд╣рд╛рдБ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╣рд╛рд╕реНрдХреЗрд▓ рдХреЗ рдЖрд▓рд╕реНрдп рд╕реЗ рдЬреБрдбрд╝реА рдХреБрдЫ рдЕрдкреНрд░рд┐рдп рд╕реВрдХреНрд╖реНрдорддрд╛рдПрдБ рднреА рд╣реИрдВ, рдЗрд╕ рдкрд░ рдмрд╛рдж рдореЗрдВ рдФрд░ рднреАред </p><br><p>  рдпрд╣рд╛рдВ рд╣рдо <code>StateT</code> рдХреЗрд╡рд▓ рдПрдХ рд╕рдВрджрд░реНрдн рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ <br>  рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рд╡реНрдпрд╛рдЦреНрдпрд╛рдПрдВ - рдПрдХ рдкрд╛рд░реНрд╕рд░ рдХреЗ рд░реВрдк рдореЗрдВред  рд▓реЗрдХрд┐рди рдЖрдк <code>RegExp</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЛрдВ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЗрд╕рдХреЗ <code>StateT</code> рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬреЛ рдХрд┐ <code>StateT</code> рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрдЧрд╛ред </p><br><p>  рд╣рдо рдпрд╣ рдирд╣реАрдВ рдХрд╣ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ <code>StateT String Maybe</code> рдПрдХ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рд╣реИ, рдХреЗрд╡рд▓ рдпрд╣ рдХрд┐ рдпрд╣ <code>StateT String Maybe</code> рдирд┐рдпрдорд┐рдд рд╡реНрдпрд╛рдХрд░рдг рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдПрдХ рдкрд╛рд░реНрд╕рд░ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди <code>Alt Prim</code> рдмрд╛рд░реЗ рдореЗрдВ <code>Alt Prim</code> рд╣рдо рдпрд╣ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдХрд╣ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдПрдХ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рд╣реИ ( <em>рдЬреИрд╕рд╛ рдХрд┐ рдЧрдгрд┐рддрдЬреНрдЮ рдХрд╣рддреЗ рд╣реИрдВ, рд╡реЗ рд╕рдорд░реВрдкрддрд╛рд╡рд╛рдж рдХреЗ рд▓рдЧрднрдЧ рдмрд░рд╛рдмрд░ рд╣реИрдВред рд▓рдЧрднрдЧред</em> ) </p><br><h2 id="neposredstvennoe-ispolzovanie-svobodnoy-struktury">  рдореБрдХреНрдд рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдкреНрд░рддреНрдпрдХреНрд╖ рдЙрдкрдпреЛрдЧ </h2><br><p>  рдпрд╣ рд╕рдм, рдЬрд╝рд╛рд╣рд┐рд░ рд╣реИ, рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдЕрдЧрд░ рд╣рдо 83% рдХрд╛рдо рдХреЛ рдЙрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓рд┐рдП рдХреЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдЬреЛ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдХрд┐рд╕реА рд╡реНрдпрдХреНрддрд┐ рджреНрд╡рд╛рд░рд╛ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдерд╛ред  рдХреНрдпрд╛ рдкрд╛рд░реНрд╕рд░ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реАрдзреЗ рдореБрдХреНрдд <code>Alt</code> рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ?  рдпрд╣ рдкреНрд░рд╢реНрди рдЗрд╕ рддрд░рд╣ рд╕реЗ рд╣реИ: рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреИрд╕реЗ рд▓рд┐рдЦрдирд╛ рд╣реИ рдЬреЛ рдХреЗрд╡рд▓ <code>foldMap</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп рдирд┐рд░реНрдорд╛рдг <code>(:)</code> рдФрд░ <code>[]</code> рдорд┐рд▓рд╛рди рдХрд░рдХреЗ) рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИ?  рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдореЛрдиреЙрдЗрдб рдХреЛ рдХрд╛рдо рд╕реМрдВрдкрдиреЗ рдХреЗ рдмрдЬрд╛рдп рд╕реАрдзреЗ рдЗрд╕ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдХрд╛рдо рдХрд░реЗрдВ? </p><br><p>  рдЦреБрд╢реА рд╣реИ рдХрд┐ рдЖрдкрдиреЗ рдкреВрдЫрд╛!  рдЖрдЗрдП рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓рддреЗ рд╣реИрдВ рдореБрдлреНрдд рд╡реИрдХрд▓реНрдкрд┐рдХ рдлрд╝рдирдХрд╛рд░ рдХреА рдкрд░рд┐рднрд╛рд╖рд╛ рдкрд░: </p><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">newtype</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Alt</span></span></span><span class="hljs-class"> fa = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Alt</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">alternatives</span></span></span><span class="hljs-class"> :: [</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AltF</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fa</span></span></span><span class="hljs-class">] } </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AltF</span></span></span><span class="hljs-class"> fa = forall r. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ap</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fr</span></span></span><span class="hljs-class">) (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Alt</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">r</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">)) | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pure</span></span></span><span class="hljs-class"> a</span></span></code> </pre> <br><p>  рдпрд╣ рдкрд╛рд░рд╕реНрдкрд░рд┐рдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдПрдХ рдЕрд╕рд╛рдорд╛рдиреНрдп рдкреНрд░рдХрд╛рд░ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдмрд╣реБрдд рднреНрд░рд╛рдордХ рд▓рдЧ рд╕рдХрддрд╛ рд╣реИред  рдЗрд╕реЗ рд╕рдордЭрдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдпрд╣ рдХрд▓реНрдкрдирд╛ рдХрд░рдирд╛ рд╣реИ рдХрд┐ <code>Alt xs</code> рдореЗрдВ <code>&lt;|&gt;</code> рдСрдкрд░реЗрдЯрд░ рдХреЗ рдЙрдкрдпреЛрдЧ рд╕реЗ рдмрдирдиреЗ рд╡рд╛рд▓реЗ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рд╣реИред       <code>AltF</code> ,     <code>f</code> ,     <code>&lt;*&gt;</code> (   ). </p><br><p>   <code>AltF fa</code>    <code>[fr]</code> ,   <code>r</code>   . <code>Ap</code>   <code>(:)</code> ,  <code>fr</code> ,  <code>Pure</code> тАФ   <code>[]</code> .  <code>forall r.</code>       <code>-XExistentialQuantification</code>         . </p><br><p>   , <code>Alt f</code>   ,      .     ,      ( )  <code>&lt;*&gt;</code>  <code>&lt;|&gt;</code> ,  ,   <code>[a]</code>      <code>&lt;&gt;</code> . </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><p>       ,     : </p><br><ul><li>   () тАФ ,   <code>&lt;&gt;</code> : <br><pre> <code class="haskell hljs">[a,b,c,d] = [a]&lt;&gt;[b]&lt;&gt;[c]&lt;&gt;[d]</code> </pre> </li><li>   () тАФ  ,   <code>+</code> ,   тАФ ,   <code>*</code> : <br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">a</span></span>*(b+c)+d*(x+y+z)*h</code> </pre> </li><li>    (Alt f) тАФ  ,   <code>&lt;|&gt;</code> ,   тАФ ,   <code>&lt;*&gt;</code> : <br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">fa</span></span> &lt;*&gt; (fb &lt;|&gt; fc) &lt;|&gt; fd &lt;*&gt; (fx &lt;|&gt; fy &lt;|&gt; fz) &lt;*&gt; fh</code> </pre> </li></ul></div></div><br><p>   ,       <code>RegExp a -&gt; String -&gt; Maybe a</code> ,   ,     .          :         . </p><br><p>  ,   <code>Alt</code> .   ,           ,     . </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">matchAlts</span></span> :: <span class="hljs-type"><span class="hljs-type">RegExp</span></span> a -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Maybe</span></span> a matchAlts (<span class="hljs-type"><span class="hljs-type">Alt</span></span> res) xs = asum [ matchChain re xs | re &lt;- res ]</code> </pre> <br><p>   <code>asum :: [Maybe a] -&gt; Maybe a</code>   ,   <code>Just</code> . ( <em>   ,   <code>Maybe a</code>       <code>Alternative</code> тАФ   <code>Nothing</code> ,   <code>&lt;|&gt;</code>    . . .</em> ) </p><br><p>     .       <code>AltF</code> ,   <code>Ap</code>  <code>Pure</code> : </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">matchChain</span></span> :: <span class="hljs-type"><span class="hljs-type">AltF</span></span> <span class="hljs-type"><span class="hljs-type">Prim</span></span> a -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Maybe</span></span> a matchChain (<span class="hljs-type"><span class="hljs-type">Ap</span></span> (<span class="hljs-type"><span class="hljs-type">Prim</span></span> cx) next) cs = _ matchChain (<span class="hljs-type"><span class="hljs-type">Pure</span></span> x) cs = _</code> </pre> <br><p>      "  ":     GHC   "",   ,    ,   . ( <em> Haskell "" (holes)     ,   <code>_</code> ,      . . .</em> )        : </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">matchChain</span></span> :: <span class="hljs-type"><span class="hljs-type">AltF</span></span> <span class="hljs-type"><span class="hljs-type">Prim</span></span> a -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Maybe</span></span> a matchChain (<span class="hljs-type"><span class="hljs-type">Ap</span></span> (<span class="hljs-type"><span class="hljs-type">Prim</span></span> cx) next) cs = <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> cs <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> [] -&gt; <span class="hljs-type"><span class="hljs-type">Nothing</span></span> d:ds | c == d -&gt; matchAlts (($ x) &lt;$&gt; next) ds | otherwise -&gt; <span class="hljs-type"><span class="hljs-type">Nothing</span></span> matchChain (<span class="hljs-type"><span class="hljs-type">Pure</span></span> x) _ = <span class="hljs-type"><span class="hljs-type">Just</span></span> x</code> </pre><br><p>   <code>Ap</code> (  <code>(:)</code> ),  ,  -    .         ,       .    <code>Prim r</code> ,   ,           <code>next :: RegExp (r -&gt; a)</code> .    ,       <code>next</code> .   , ""  ,  <code>Nothing</code> . ,     <code>Pure x</code> (   <code>[]</code> ), ,  ,      . </p><br><p> ,        ,    .  ,  ,  " "    <code>Ap</code> , <code>Pure</code> , <code>AltF</code>  ..,            . </p><br><p>          : </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">ghci</span></span>&gt; matchAlts testRegexp_ <span class="hljs-string"><span class="hljs-string">"acdcdcde"</span></span> <span class="hljs-type"><span class="hljs-type">Just</span></span> () ghci&gt; matchAlts testRegexp_ <span class="hljs-string"><span class="hljs-string">"acdcdcdx"</span></span> <span class="hljs-type"><span class="hljs-type">Nothing</span></span> ghci&gt; matchAlts testRegexp <span class="hljs-string"><span class="hljs-string">"acdcdcde"</span></span> <span class="hljs-type"><span class="hljs-type">Just</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> ghci&gt; matchAlts testRegexp <span class="hljs-string"><span class="hljs-string">"bcdcdcdcdcdcdcde"</span></span> <span class="hljs-type"><span class="hljs-type">Just</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> ghci&gt; matchAlts digit <span class="hljs-string"><span class="hljs-string">"9"</span></span> <span class="hljs-type"><span class="hljs-type">Just</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> ghci&gt; matchAlts bracketDigit <span class="hljs-string"><span class="hljs-string">"[2]"</span></span> <span class="hljs-type"><span class="hljs-type">Just</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> ghci&gt; matchAlts (many bracketDigit) <span class="hljs-string"><span class="hljs-string">"[2][3][4][5]"</span></span> <span class="hljs-type"><span class="hljs-type">Just</span></span> [<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>] ghci&gt; matchAlts (sum &lt;$&gt; many bracketDigit) <span class="hljs-string"><span class="hljs-string">"[2][3][4][5]"</span></span> <span class="hljs-type"><span class="hljs-type">Just</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span></code> </pre> <br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><p>              . ,      () ,            .    ,  ,   . </p></div></div><br><h1 id="chto-zhe-imenno-my-sdelali">     ? </h1><br><p>                <code>foldMap</code>     .    ,   ,         foldMap,     ,     ,    ,   ! ,   тАФ    ,           тАФ    <code>(:)</code>  <code>[]</code> . </p><br><p>  ,   ,    : ,   ,    ,  <code>(:)</code> ,  <code>[]</code> .  ,     .  ,  <code>[1,2,3] &lt;&gt; [4]</code>      ,   <code>[1] &lt;&gt; [2,3] &lt;&gt; [4]</code> .  ,    ,      . </p><br><p>        .  ,     : </p><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RegExp</span></span></span><span class="hljs-class"> a = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Empty</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pure</span></span></span><span class="hljs-class"> a | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Prim</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Char</span></span></span><span class="hljs-class"> a | forall r. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Seq</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RegExp</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">r</span></span></span><span class="hljs-class">) (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RegExp</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">r</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">)) | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Union</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RegExp</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">) (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RegExp</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">) | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Many</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RegExp</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">)</span></span></code> </pre> <br><p>       <code>RegExp</code> ,        .      . ,      <code>RegExp</code>       : </p><br><pre> <code class="haskell hljs"><span class="hljs-comment"><span class="hljs-comment">-- | a|(b|c) abc1 :: RegExp Int abc1 = Prim 'a' 1 `Union` (Prim 'b' 2 `Union` Prim 'c' 3) -- | (a|b)|c abc2 :: RegExp Int abc2 = (Prim 'a' 1 `Union` Prim 'b' 2) `Union` Prim 'c' 3</span></span></code> </pre> <br><p>  ,             . </p><br><p>    <code>Alt Prim</code> ,       ,        ,       .  ,       <code>matchAlts</code> ,            .     <code>(a|b)|c</code>  <code>a|(b|c)</code> .     <code>Alt</code>        . ,     ,    . </p><br><p>    ,    ,       <code>(a|b)|c</code>  ,  <code>(a|b)|c</code> , , ,       <code>RegExp</code> .  <code>Alt</code>       ,       . </p><br><p> ,  ,    <code>Alt</code>    , <code>Alt Prim</code>       . , <code>Alt Prim</code>       <code>a|a</code>  <code>a</code> .    ,   <code>Alt f</code>       <code>f</code> .        ,   :      .        , ,  ,     . </p><br><h1 id="nekotorye-dosadnye-tonkosti">    </h1><br><p>     ,     .      ,      ,            .        <code>RegExp</code>  ,            ,    тАФ . </p><br><p>    ,          Haskell. ,  -  <code>[a]</code>      . ( <em>       ,       -  ,   "" </em> <math> </math><em><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x22A5;</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.808ex" height="1.937ex" viewBox="0 -728.2 778.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/448644/&amp;usg=ALkJrhiezbSJeEEbiRlV3lBrWnDXtSHu0A#MJMAIN-22A5" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">тКе</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">\bot</script></em>  <em>,      - "" . . .</em>  ) </p><br><p>       : <code>a|aa|aaa|aaaa|aaaaa|aaaaaa|...</code> ,              ( <em>,    ,       ,      . . .</em> ).  ,  Haskell     .   ,    <code>Alt</code>   <code>many</code> .  , <code>a*</code>   <code>a|aa|aaa|aaaa|aaaaa|aaaaaa|...</code> ,             .     -    <code>many (char 'a')</code> ,    . Haskell       <code>Alt</code>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="> </a> ,      . </p><br><p>  ,    ,   ,      ,           (),         .        ,     <code>many</code>    . </p><br><p> ,   !    ""   <code>Alt</code> ,    <code>Control.Alternative.Free.Final</code> ,     <code>many</code> (,    ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="> </a> ). </p><br><p>           ,    ,  <code>runAlt</code> . ,        <code>Alternative</code> ,     <code>many</code> (  <code>RE</code>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">regex-applicative</a> )       .      ,  Haskell      , ,   , <code>many</code>       . </p><br><p>    ,   .          (       ),          ( <em>,        , . .</em> ).    <code>matchPrefix</code> ,        ,   ,        .  ,   ,    ,      ,       .      ,   GHC        . </p><br><h1 id="poslednie-shtrihi">   </h1><br><p>         ,       ,   <code>tails</code> (   )  <code>mapMaybe</code> (           ).    ,     ,    <code>listToMaybe</code> . </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">matches</span></span> :: <span class="hljs-type"><span class="hljs-type">RegExp</span></span> a -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> -&gt; [a] matches re = mapMaybe (matchPrefix re) . tails firstMatch :: <span class="hljs-type"><span class="hljs-type">RegExp</span></span> a -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Maybe</span></span> a firstMatch re = listToMaybe . matches re</code> </pre> <br><p>    ,   ,   <code>matchPrefix</code>   <code>Nothing</code>      ,  <code>listToMaybe</code>      ,   <code>Nothing</code> ( <em>      ,      . . .</em> ). </p><br><p> ,        .    ,       ,     тАФ  ,    .       ,         .    ,     ,    ,      . </p><br><p>        <code>Alt Prim</code>         ,    :   ,  ,  ,    . </p><br><p>       ?        .      : </p><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Prim</span></span></span><span class="hljs-class"> a = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Only</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Char</span></span></span><span class="hljs-class"> a </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">--    | Letter a --     | Digit (Int -&gt; a) --    , | Wildcard (Char -&gt; a) --    , | Satisfy (Char -&gt; Maybe a) --    , --  </span></span></span></span></code> </pre> <br><p>       ,      .      . </p><br><p>      ,   ,   .      <code>runAlt</code>      <code>Alt</code> . </p><br><p>                (). ,    ,        ,    ,    .       <code>|</code>      . ( <em>         ,        . . .</em> ).     ,  -     .  ,   <code>MonadPlus</code>     -   ,        ,     .     ,      . </p><br><p> ,   ,         .  ,   ! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi448644/">https://habr.com/ru/post/hi448644/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi448634/index.html">рдпреВрдХреНрд░реЗрдиреА рд╕рдмрдХ</a></li>
<li><a href="../hi448636/index.html">рд╣реИрдХрд╛рдбрд╛рдп рд░реЗрдЯреНрд░реЛ рдХрдВрдкреНрдпреВрдЯрд░ рдХреЗрд╕</a></li>
<li><a href="../hi448638/index.html">рдмрд┐рд▓реНрдбрд░реЛрдЯ - рднрд╛рдЧ 1. рд╕рд╛рдорд╛рдиреНрдп рдЬрд╛рдирдХрд╛рд░реА, рдПрдХ рдиреНрдпреВрдирддрдо рдкреНрд░рдгрд╛рд▓реА рдХрд╛ рдирд┐рд░реНрдорд╛рдг, рдореЗрдиреВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реЗрдЯрд┐рдВрдЧ</a></li>
<li><a href="../hi448640/index.html">SSD GIGABYTE рдЖрд░рд╕ RGB M.2: RGB LED рдХреЗ рд▓рд┐рдП рдЫреЛрдЯрд╛, рд░рд┐рдореЛрдЯ рднреА (2 рднрд╛рдЧ)</a></li>
<li><a href="../hi448642/index.html">FreeBSD рдореЗрдВ рдЕрдзрд┐рдХрд╛рд░ рдореЙрдбрд▓ рдХрд╛ рдЕрдирд┐рд╡рд╛рд░реНрдп рд╡рд┐рддрд░рдг</a></li>
<li><a href="../hi448652/index.html">рд░рд╛рд╕реНрдкрдмреЗрд░реА рдкрд╛рдИ рдкрд░ рдореЛрдЬрд╝рд┐рд▓рд╛ рд╡реЗрдмрдЯрд┐рдВрдЧреНрд╕ - рдЖрд░рдВрдн рдХрд░рдирд╛</a></li>
<li><a href="../hi448654/index.html">рдореЛрдЬрд╝рд┐рд▓рд╛ рд╡реЗрдмрд┐рдВрдЧреНрд╕ - рдЧреЗрдЯрд╡реЗ рд╕реЗрдЯрдЕрдк</a></li>
<li><a href="../hi448656/index.html">рдмрдбрд╝рд╛ рднрд╛рдИ рджреЗрдЦ рд░рд╣рд╛ рд╣реИ ... рдЦреБрдж рдпрд╛ рд╣реЛрдордПрд╕реНрдЯрд┐рд╕реНрдЯреЗрдВрдЯ рдореЗрдВ рдЖрдВрджреЛрд▓рдиреЛрдВ рдХреЗ рдЗрддрд┐рд╣рд╛рд╕ рдХреЗ рд╕рд╛рде рдПрдХ рдирдХреНрд╢рд╛</a></li>
<li><a href="../hi448658/index.html">рдХрд╛рд░ рдореЗрдВ рдУрдмреАрдбреА рдХрдиреЗрдХреНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреНрдпрд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ</a></li>
<li><a href="../hi448662/index.html">"рд░реВрд╕ 404": рд╢реЛ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>