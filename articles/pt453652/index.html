<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚óºÔ∏è üêú ‚åõÔ∏è LogRock: testando atrav√©s do log üëèüèø üõí üå∂Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="LogRock: testando atrav√©s do log 
 Por mais de 2 anos, trabalhamos em nosso projeto Cleverbrush . Este √© um software para trabalhar com gr√°ficos vetor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>LogRock: testando atrav√©s do log</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453652/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0a0/8fe/e87/0a08fee87984969110aef2080f4687ae.png" alt="Logrock"></div><br><h2>  LogRock: testando atrav√©s do log </h2><br>  Por mais de 2 anos, trabalhamos em nosso projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cleverbrush</a> .  Este √© um software para trabalhar com gr√°ficos vetoriais.  Trabalhar com um editor gr√°fico implica em um grande n√∫mero de casos de uso de aplicativos.  Estamos tentando economizar dinheiro e tempo, ent√£o otimizamos tudo, incluindo testes.  Cobrir os casos de teste com cada op√ß√£o √© muito caro e irracional, principalmente porque √© imposs√≠vel cobrir todas as op√ß√µes. <br><br>  Durante o desenvolvimento, um m√≥dulo para aplicativos React JS foi criado - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">LogRock (github)</a> . <br><br>  Este m√≥dulo permite organizar aplicativos de registro modernos.  Com base nos logs, realizamos testes.  Neste artigo, falarei sobre os meandros do uso deste m√≥dulo e como organizar os testes por meio do log. <br><a name="habracut"></a><br><h2>  Qual √© o problema? </h2><br>  Se voc√™ comparar o programa com um organismo vivo, um bug nele √© uma doen√ßa.  A causa dessa "doen√ßa" pode ser uma s√©rie de fatores, incluindo o ambiente de um usu√°rio espec√≠fico.  Isto √© especialmente verdade se estamos considerando uma plataforma web.  √Äs vezes, um relacionamento causal √© muito complexo, e o bug encontrado durante o teste √© o resultado de v√°rios eventos. <br><br>  Como nas doen√ßas humanas, ningu√©m explica melhor seus sintomas do que o paciente, nenhum testador ser√° capaz de dizer o que aconteceu, melhor do que o pr√≥prio programa. <br><br><h2>  O que fazer? </h2><br>  Para entender o que est√° acontecendo, precisamos de uma lista de a√ß√µes que o usu√°rio executou em nosso aplicativo. <br><br>  Para que nosso pr√≥prio programa possa nos dizer o que "d√≥i", <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pegaremos o</a> m√≥dulo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">LogRock (github)</a> e o associaremos ao ElasticSearch, LogStash e Kibana. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d4/1d6/7ea/6d41d67ea5bd247827fd03948fc8b0dd.png" alt="imagem"></div><br>  <b>O ElasticSearch</b> √© um poderoso mecanismo de pesquisa de texto completo.  Voc√™ pode assistir ao tutorial do ElasticSearch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br>  <b>O LogStash</b> √© um sistema para coletar logs de v√°rias fontes, que podem enviar logs, inclusive para o ElasticSearch. <br>  <b>Kibana</b> √© uma interface da web para o ElasticSearch com muitos complementos. <br><br><h2>  Como isso funciona? </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dcf/06e/706/dcf06e706a5ae052a2f15eaf09e45c93.png" alt="imagem"></div><br>  Em caso de erro (ou apenas sob demanda), o aplicativo envia logs para o servidor onde eles s√£o salvos em um arquivo.  O logstash salva incrementalmente os dados no ElasticSearch - no banco de dados.  O usu√°rio efetua login no Kibana e v√™ os logs salvos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e19/0b0/244/e190b0244b22db314385b5156e5c56cd.png" alt="imagem"></div><br>  Parece um Kibana bem ajustado.  Ele exibe dados do ElasticSearch.  O Kibana pode exibir dados na forma de tabelas, gr√°ficos, mapas etc., o que √© muito conveniente para analisar e entender o que est√° acontecendo com nosso aplicativo. <br><br>  <b><u>Neste artigo, N√ÉO discutirei a configura√ß√£o do ElasticStack!</u></b> <br><br><h2>  Criando um sistema de log </h2><br>  Como exemplo, integraremos o sistema de registro em um aplicativo JS de uma p√°gina escrito em React.  Realmente n√£o importa em qual estrutura seu aplicativo ser√° gravado.  Vou tentar descrever a abordagem da constru√ß√£o de um sistema de log. <br><br><h3>  1. Cliente </h3><br><h4>  1.0 LogRock.  Instala√ß√£o </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Link para LogRock</a> <br><br>  Para instalar, voc√™ deve executar: <br><br><pre><code class="bash hljs">npm install logrock  yarn add logrock</code> </pre> <br><h4>  1.1 LogRock.  Configura√ß√£o do aplicativo </h4><br>  Para come√ßar, envolva nosso aplicativo em um componente <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { LoggerContainer } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"logrock"</span></span>; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">LoggerContainer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">App</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">LoggerContainer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  LoggerContainer √© um componente que responde aos erros do aplicativo e forma uma pilha. <br><br>  Uma pilha √© um objeto com informa√ß√µes sobre o sistema operacional do usu√°rio, navegador, qual bot√£o do mouse ou teclado foi pressionado e, √© claro, a sub-matriz de a√ß√µes, onde s√£o registradas todas as a√ß√µes do usu√°rio que ele executou em nosso sistema. <br><br>  O LoggerContainer possui v√°rias configura√ß√µes, considere algumas delas <br><br><pre> <code class="javascript hljs">&lt;LoggerContainer active={<span class="hljs-literal"><span class="hljs-literal">true</span></span>|<span class="hljs-literal"><span class="hljs-literal">false</span></span>} limit={<span class="hljs-number"><span class="hljs-number">20</span></span>} onError={stack =&gt; { sendToServer(stack); }} &gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">App</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">LoggerContainer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  active - ativar ou desativar o criador de logs <br><br>  limite - define um limite para o n√∫mero de a√ß√µes recentes salvas pelo usu√°rio.  Se o usu√°rio executar 21 a√ß√µes, o primeiro nesta matriz ser√° exclu√≠do automaticamente.  Assim, teremos as √∫ltimas 20 a√ß√µes que precederam o erro. <br><br>  onError - o retorno de chamada que √© chamado quando ocorre um erro.  O objeto Stack aparece nele, no qual todas as informa√ß√µes sobre o ambiente, a√ß√µes do usu√°rio etc. s√£o armazenadas.  √â a partir desse retorno de chamada que precisamos enviar esses dados para o ElasticSearch ou o back-end ou salv√°-los em um arquivo para an√°lise e monitoramento adicionais. <br><br><h4>  1.2 LogRock.  Registo </h4><br>  Para fazer o log de alta qualidade das a√ß√µes do usu√°rio, teremos que cobrir nosso c√≥digo com chamadas de log. <br><br>  O m√≥dulo LogRock vem com um logger associado a um LoggerContainer <br><br>  Suponha que tenhamos um componente <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { useState } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Toggle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [toggleState, setToggleState] = useState(<span class="hljs-string"><span class="hljs-string">"off"</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toggle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ setToggleState(toggleState === <span class="hljs-string"><span class="hljs-string">"off"</span></span> ? <span class="hljs-string"><span class="hljs-string">"on"</span></span> : <span class="hljs-string"><span class="hljs-string">"off"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag">`</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">switch</span></span></span></span><span class="xml"><span class="hljs-tag"> ${</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">toggleState</span></span></span></span><span class="xml"><span class="hljs-tag">}`} </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{toggle}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">; }</span></span></code> </pre> <br>  Para cobri-lo adequadamente com um log, precisamos modificar o m√©todo de altern√¢ncia <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toggle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> state = toggleState === <span class="hljs-string"><span class="hljs-string">"off"</span></span> ? <span class="hljs-string"><span class="hljs-string">"on"</span></span> : <span class="hljs-string"><span class="hljs-string">"off"</span></span>; logger.info(<span class="hljs-string"><span class="hljs-string">`React.Toggle|Toggle component changed state </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${state}</span></span></span><span class="hljs-string">`</span></span>); setToggleState(state); }</code> </pre> <br>  Adicionamos um logger no qual as informa√ß√µes s√£o divididas em 2 partes.  React.Toggle nos mostra que essa a√ß√£o ocorreu no n√≠vel de React, o componente Toggle, e ent√£o temos uma explica√ß√£o verbal da a√ß√£o e do estado atual que veio a esse componente.  Essa separa√ß√£o em n√≠veis n√£o √© necess√°ria, mas com essa abordagem ficar√° mais claro onde exatamente nosso c√≥digo foi executado. <br><br>  Tamb√©m podemos usar o m√©todo ‚ÄúcomponentDidCatch‚Äù, que foi introduzido no React vers√£o 16, em caso de erro. <br><br><h4>  2. Intera√ß√£o com o servidor </h4><br>  Considere o seguinte exemplo. <br><br>  Suponha que tenhamos um m√©todo que coleta dados do usu√°rio de um back-end.  O m√©todo √© ass√≠ncrono, parte da l√≥gica est√° oculta no back-end.  Como registrar esse c√≥digo corretamente? <br><br>  Primeiro, como temos um aplicativo cliente, todas as solicita√ß√µes enviadas ao servidor passar√£o por uma √∫nica sess√£o de usu√°rio, sem recarregar a p√°gina.  Para associar a√ß√µes no cliente a a√ß√µes no servidor, devemos criar um SessionID global e adicion√°-lo ao cabe√ßalho de cada solicita√ß√£o no servidor.  No servidor, podemos usar qualquer criador de logs que cubra nossa l√≥gica como um exemplo do frontend e, em caso de erro, envie esses dados com o sessionID anexado no Elastic para a placa de back-end. <br><br>  1. Geramos o SessionID no cliente <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.SESSION_ID = <span class="hljs-string"><span class="hljs-string">`sessionid-</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-built_in"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-built_in">Math</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.random().toString(</span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">36</span></span></span></span><span class="hljs-string"><span class="hljs-subst">).substr(</span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">3</span></span></span></span><span class="hljs-string"><span class="hljs-subst">, </span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">9</span></span></span></span><span class="hljs-string"><span class="hljs-subst">)}</span></span></span><span class="hljs-string">`</span></span>;</code> </pre> <br>  2. Devemos definir o SessionID para todas as solicita√ß√µes ao servidor.  Se usarmos bibliotecas para consultas, isso √© muito simples, declarando um SessionID para todas as consultas. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> fetch = axios.create({...}); fetch.defaults.headers.common.sessionId = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.SESSION_ID;</code> </pre> <br>  3. No LoggerContainer, h√° um campo especial para SessionID <br><br><pre> <code class="javascript hljs">&lt;LoggerContainer active={<span class="hljs-literal"><span class="hljs-literal">true</span></span>|<span class="hljs-literal"><span class="hljs-literal">false</span></span>} sessionID={<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.SESSION_ID} limit={<span class="hljs-number"><span class="hljs-number">20</span></span>} onError={stack =&gt; { sendToServer(stack); }} &gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">App</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">LoggerContainer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  4. A solicita√ß√£o em si (no cliente) ter√° a seguinte apar√™ncia: <br><br><pre> <code class="javascript hljs">logger.info(<span class="hljs-string"><span class="hljs-string">`store.getData|User is ready for loading... User ID is </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${id}</span></span></span><span class="hljs-string">`</span></span>); getData(<span class="hljs-string"><span class="hljs-string">'/api/v1/user'</span></span>, { id }) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">userData</span></span></span><span class="hljs-function"> =&gt;</span></span> { logger.info(<span class="hljs-string"><span class="hljs-string">`store.getData|User have already loaded. User count is </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-built_in"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-built_in">JSON</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.stringify(userData)}</span></span></span><span class="hljs-string">`</span></span>); }) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function"> =&gt;</span></span> { logger.error(<span class="hljs-string"><span class="hljs-string">`store.getData|User loaded fail </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${err.message}</span></span></span><span class="hljs-string">`</span></span>); });</code> </pre> <br>  Como tudo funcionar√°: registramos um log antes da solicita√ß√£o no cliente.  De acordo com nosso c√≥digo, vemos que o carregamento de dados do servidor come√ßar√° agora.  Anexamos um SessionID √† solicita√ß√£o.  Se nosso back-end estiver coberto de logs com a adi√ß√£o deste SessionID e a solicita√ß√£o falhar, podemos ver o que aconteceu no back-end. <br><br>  Assim, monitoramos todo o ciclo de nossa aplica√ß√£o, n√£o apenas no cliente, mas tamb√©m no back-end. <br><br><h4>  3. O testador </h4><br>  Trabalhar com um testador merece uma descri√ß√£o separada do processo. <br><br>  Como temos uma startup, n√£o temos requisitos formais e, √†s vezes, nem tudo √© l√≥gico no trabalho. <br><br>  Se o testador n√£o entender o comportamento, esse √© um caso que pelo menos precisa ser considerado.  Al√©m disso, frequentemente, um testador simplesmente n√£o pode repetir uma situa√ß√£o duas vezes.  Como as etapas que levam ao comportamento incorreto podem ser numerosas e n√£o triviais.  Al√©m disso, nem todos os erros levam a consequ√™ncias cr√≠ticas, como a exce√ß√£o.  Alguns deles podem alterar apenas o comportamento do aplicativo, mas n√£o podem ser interpretados pelo sistema como um erro.  Para esses fins, na prepara√ß√£o, voc√™ pode adicionar um bot√£o no cabe√ßalho do aplicativo para for√ßar o envio de logs.  O testador v√™ que algo n√£o est√° funcionando direito, clica no bot√£o e envia a pilha com a√ß√µes para o ElasticSearch. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/553/154/7f0/5531547f03a044eda98449e829d67839.png" alt="imagem"></div><br><br>  Se, no entanto, ocorreu um erro cr√≠tico, devemos bloquear a interface para que o testador n√£o clique mais e n√£o atinja um beco sem sa√≠da. <br><br>  Para esses fins, exibimos a tela azul da morte. <br><br>  Vemos no topo o texto com Pilha desse erro cr√≠tico e abaixo - as a√ß√µes que o precederam.  Tamb√©m obtemos o ID do erro, basta o testador selecion√°-lo e anex√°-lo ao ticket.  Posteriormente, esse erro pode ser facilmente encontrado no Kibana por esse ID. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7f3/5b8/4b7/7f35b84b746e584111ce64e6416e1f36.png" alt="imagem"></div><br>  Para esses fins, o LoggerContainer possui suas pr√≥prias propriedades. <br><br><pre> <code class="javascript hljs">&lt;LoggerContainer active={<span class="hljs-literal"><span class="hljs-literal">true</span></span>|<span class="hljs-literal"><span class="hljs-literal">false</span></span>} limit={<span class="hljs-number"><span class="hljs-number">20</span></span>} bsodActive={<span class="hljs-literal"><span class="hljs-literal">true</span></span>} bsod={BSOD} onError={stack =&gt; { sendToServer(stack); }} &gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">App</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">LoggerContainer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  bsodActive - ativa / desativa o BSOD (desabilitar o BSOD se aplica ao c√≥digo de produ√ß√£o) <br><br>  O bsod √© um componente.  Por padr√£o, parece com a captura de tela acima. <br><br>  Para exibir um bot√£o em um UI LoggerContainer, podemos usar em contexto <br><br><pre> <code class="javascript hljs">context.logger.onError(context.logger.getStackData());</code> </pre> <br><h4>  4. LogRock.  Intera√ß√£o do usu√°rio </h4><br>  Voc√™ pode enviar logs para o console ou mostr√°-los ao usu√°rio. Para isso, √© necess√°rio usar o m√©todo stdout: <br><br><pre> <code class="javascript hljs">&lt;LoggerContainer active={<span class="hljs-literal"><span class="hljs-literal">true</span></span>|<span class="hljs-literal"><span class="hljs-literal">false</span></span>} limit={<span class="hljs-number"><span class="hljs-number">20</span></span>} bsodActive={<span class="hljs-literal"><span class="hljs-literal">true</span></span>} bsod={BSOD} onError={stack =&gt; { sendToServer(stack); }} stdout={(level, message, important) =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>[level](message); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (important) { alert(message); } }} &gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">App</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">LoggerContainer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  stdout √© um m√©todo respons√°vel pela exibi√ß√£o de mensagens. <br><br>  Para que a mensagem se torne importante, basta passar o segundo par√¢metro verdadeiro para o criador de logs.  Portanto, essa mensagem pode ser exibida ao usu√°rio em uma janela pop-up; por exemplo, se o carregamento dos dados falhar, podemos exibir uma mensagem de erro. <br><br><pre> <code class="javascript hljs">logger.log(<span class="hljs-string"><span class="hljs-string">'Something was wrong'</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>);</code> </pre> <br><h3>  Registro avan√ßado </h3><br>  Se voc√™ usar Redux ou solu√ß√µes semelhantes em uma loja, poder√° colocar um registrador no Middleware processando suas a√ß√µes, assim, todas as a√ß√µes significativas passar√£o pelo nosso sistema. <br><br>  Para um registro eficaz, voc√™ pode agrupar seus dados em um objeto proxy e colocar os registradores em todas as a√ß√µes com o objeto. <br><br>  Para cobrir m√©todos de terceiros com o log (m√©todos de biblioteca, m√©todos de c√≥digo herdado), voc√™ pode usar decoradores - ‚Äú@‚Äù. <br><br><h3>  Dicas </h3><br>  Aplicativos de log, inclusive na produ√ß√£o, porque, melhor que os usu√°rios reais, nenhum testador encontrar√° gargalos. <br><br>  N√£o se esque√ßa de indicar a cole√ß√£o de logs no contrato de licen√ßa. <br><br>  <b>N√ÉO registre senhas, dados banc√°rios e outras informa√ß√µes pessoais!</b> <br><br>  A redund√¢ncia de logs tamb√©m √© ruim, torne as assinaturas o mais claras poss√≠vel. <br><br><h3>  Alternativas </h3><br>  Como abordagens alternativas, destaco: <br><br><ul><li>  A barra de rolagem √© altamente personaliz√°vel.  Permite registrar 500 mil erros por US $ 150 por m√™s.  Eu recomendo us√°-lo se voc√™ estiver desenvolvendo um aplicativo a partir do zero. </li><li>  O Sentry √© mais f√°cil de integrar, mas menos personaliz√°vel.  Permite registrar 1 milh√£o de eventos por US $ 200 por m√™s. </li></ul><br>  Ambos os servi√ßos permitem que voc√™ fa√ßa quase a mesma coisa e integre-se ao back-end. <br><br><h3>  O que vem a seguir </h3><br>  O registro n√£o √© apenas a busca de erros, mas tamb√©m o monitoramento de a√ß√µes do usu√°rio, coleta de dados.  O registro em log pode ser um bom complemento para os testes do Google Analytics e da experi√™ncia do usu√°rio. <br><br><h3>  Conclus√µes </h3><br>  Quando voc√™ lan√ßa o aplicativo, a vida est√° apenas come√ßando para ele.  Seja respons√°vel por sua ideia, obtenha feedback, monitore logs e aprimore-o.  Escreva software de alta qualidade e prospere :) <br><br>  PS Se voc√™ quiser ajudar no desenvolvimento de m√≥dulos para Angular, Vue, etc.  Ficarei feliz em receber solicita√ß√µes - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt453652/">https://habr.com/ru/post/pt453652/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt453634/index.html">Escola de An√°lise de Sistemas do Banco Alfa</a></li>
<li><a href="../pt453642/index.html">Analisador inteligente para um n√∫mero escrito em palavras</a></li>
<li><a href="../pt453644/index.html">Entrevista - 10 perguntas sobre Swift. Parte 3</a></li>
<li><a href="../pt453646/index.html">Normaliza√ß√£o de dados em banco de dados distribu√≠do, microsservi√ßos e ERP</a></li>
<li><a href="../pt453650/index.html">N√∫cleo de software da infraestrutura cibern√©tica a bordo do ca√ßa unificado F-35</a></li>
<li><a href="../pt453656/index.html">Web est√°tica: de volta ao b√°sico?</a></li>
<li><a href="../pt453660/index.html">A Intel mostrou o novo processador i9-9900KS com frequ√™ncia Turbo de 5 GHz por n√∫cleo</a></li>
<li><a href="../pt453662/index.html">Marte - ainda mais gelo no P√≥lo Norte, mas profundo</a></li>
<li><a href="../pt453664/index.html">Inicializa√ß√£o de primavera - OAuth2 e JWT</a></li>
<li><a href="../pt453666/index.html">Como andei de t√°xi n√£o tripulado</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>