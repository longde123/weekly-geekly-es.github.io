<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐖 👨🏿‍🏫 👂🏼 Création d'herbe interactive dans Unreal Engine 👩🏿‍🤝‍👩🏾 🛒 🈂️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jusqu'à récemment, l'herbe dans les jeux était généralement indiquée par une texture au sol, plutôt que par le rendu de tiges individuelles. Mais avec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Création d'herbe interactive dans Unreal Engine</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420079/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/dg/d_/sg/dgd_sg8pss1hh54majrmgysw5fi.gif"></div><br>  Jusqu'à récemment, l'herbe dans les jeux était généralement indiquée par une texture au sol, plutôt que par le rendu de tiges individuelles.  Mais avec une augmentation de la puissance du fer, il est devenu possible de rendre l'herbe.  De grands exemples de ce rendu peuvent être vus dans des jeux comme <i>Horizon Zero Dawn</i> et <i>The Legend of Zelda: Breath of the Wild</i> .  Dans ces jeux, le joueur peut parcourir les prairies herbeuses et, plus important encore, l'herbe <i>répond</i> aux actions du joueur. <br><br>  Heureusement, la création d'un tel système n'est pas très difficile.  En fait, l'article vous apprendra exactement cela!  Dans ce didacticiel, vous apprendrez ce qui suit: <br><br><ul><li>  Créer un champ vectoriel à l'aide d'un système de capture de scène et de particules </li><li>  Pliez l'herbe d'un joueur en fonction d'un champ vectoriel </li></ul><a name="habracut"></a><blockquote>  <em>Remarque:</em> ce didacticiel suppose que vous connaissez déjà les bases de l'utilisation d'Unreal Engine.  Si vous débutez avec Unreal Engine, consultez notre série en dix parties de didacticiels <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Unreal Engine pour les débutants</a> .  En particulier, consultez le didacticiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Systèmes de particules</a> pour savoir comment utiliser Cascade dans ce didacticiel. </blockquote><blockquote>  <em>Remarque:</em> ce didacticiel fait partie d'une série de trois didacticiels sur l'utilisation des cibles de rendu: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 1: dessiner avec des cibles de rendu</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 2: neige déformable</a> </li><li>  Partie 3: herbe interactive </li></ul></blockquote><h2>  Se rendre au travail </h2><br>  Commençons par télécharger le matériel de ce tutoriel (vous pouvez les télécharger <a href="">ici</a> ).  Décompressez-les, accédez à <em>InteractiveGrassStarter</em> et ouvrez <em>InteractiveGrass.uproject</em> .  Vous verrez un petit champ d'herbe qui sera le thème de ce tutoriel.  J'ai également créé un widget pour afficher la cible de rendu de la capture de scène. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8fa/004/60f/8fa00460f2e914dedb752443b566d226.gif"></div><br><br>  Avant de commencer, vous devez étudier le didacticiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur la création d'empreintes de pas dans la neige</a> , car je vais ignorer certaines informations.  Il convient de noter que la capture et la projection sont également utilisées dans ce didacticiel.  Pour gagner du temps, j'ai préparé une capture de plan, similaire au plan du didacticiel sur les pistes dans la neige. <br><br>  Pour commencer, examinons une autre façon de créer du gazon interactif.  La manière la plus courante consiste à transférer les coordonnées du joueur sur le matériau de l'herbe et à utiliser un masque sphérique pour plier l'herbe dans un certain rayon par rapport au joueur. <br><br>  Bien que cette approche soit assez bonne, elle ne s’adapte pas bien lorsque nous voulons ajouter plus d’acteurs à l’herbe.  Pour chaque acteur que vous ajoutez, vous devrez ajouter un autre paramètre de coordonnées et un masque sphérique au matériau.  Une méthode plus évolutive consiste à utiliser un <em>champ vectoriel</em> . <br><br><h2>  Qu'est-ce qu'un champ vectoriel? </h2><br>  Un champ vectoriel n'est qu'une texture dont chaque pixel correspond à une direction.  Si vous travailliez avec des cartes de flux, elles sont similaires.  Mais au lieu de déplacer les UV, nous utiliserons le contact <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">World Position Offset</a> pour déplacer les sommets.  Contrairement à la solution avec un masque sphérique, pour obtenir la direction de flexion, il suffit que les matériaux échantillonnent le champ vectoriel <i>une</i> seule <i>fois</i> . <br><br>  Voyons comment enregistrer les itinéraires dans une texture.  Regardez cette grille: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/553/651/6d2/5536516d26f67d5e2e5928db30b1608a.jpg"></div><br>  Disons que le point rouge est l'objet que nous voulons déplacer.  Si nous le déplaçons dans le coin inférieur droit, alors quel vecteur dénotera ce mouvement?  Si vous avez répondu <em>(1, 1)</em> , alors vous avez raison!  Comme vous le savez probablement, vous pouvez également représenter des vecteurs comme des fleurs, et ainsi les sauvegarder dans leur texture.  Insérons ce vecteur dans le sélecteur de couleurs Unreal et voyons de quelle couleur il retourne. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b21/5d6/59b/b215d659be2f7f813add96b32fcabae4.jpg"></div><br>  Comme vous pouvez le voir, la direction <em>(1, 1)</em> revient en jaune.  Cela signifie que si nous voulons plier l'herbe dans la direction des axes XY positifs, nous devrons utiliser cette couleur de texture.  Regardons maintenant les couleurs de tous les vecteurs. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fbf/302/8bd/fbf3028bd6456dac8ca27a9c1bf2146d.jpg"></div><br>  Le carré en bas à droite semble assez bon car il a des dégradés sur les deux axes.  Cela signifie que nous pouvons stocker n'importe quel vecteur dans ce quadrant en tant que couleur, car chaque vecteur a une couleur unique. <br><br>  Mais il y a un problème avec les trois autres quadrants.  Nous n'avons qu'un gradient le long d'un axe, ou aucun gradient du tout.  Cela signifie que plusieurs vecteurs auront la même couleur.  Par exemple, nous ne pouvons pas distinguer les vecteurs <em>(-1, 1)</em> et <em>(0, 1)</em> . <br><br>  Ces trois quadrants n'ont pas de couleurs uniques pour chaque vecteur car nous ne pouvons représenter les couleurs qu'en utilisant des valeurs de 0 à 1. Cependant, ces trois quadrants utilisent des valeurs négatives en dehors de cette plage. <br><br>  La solution consiste à redistribuer les vecteurs afin qu'ils s'inscrivent tous dans l'intervalle de 0 à 1. Cela peut être fait en multipliant le vecteur par <em>0,5</em> et en ajoutant <em>0,5</em> .  Voici une visualisation de ce que nous obtenons: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c6/334/31a/1c633431aa88cde88b2f2af01ede9f89.gif"></div><br>  Maintenant, chaque vecteur a une couleur unique.  Lorsque nous devons l'utiliser pour des calculs, nous le redistribuons simplement dans l'intervalle de -1 à 1. Voici quelques couleurs et les directions correspondantes après la redistribution: <br><br><ul><li>  <em>(0, 0):</em> X et Y négatifs </li><li>  <em>(0,5, 0,5):</em> aucun mouvement </li><li>  <em>(0, 1):</em> X négatif et Y positif </li><li>  <em>(1, 0):</em> X positif et Y négatif </li></ul><br>  Maintenant, apprenons à créer un champ vectoriel dans Unreal. <br><br><h3>  Création d'un champ vectoriel </h3><br>  Contrairement à la création de traces dans la neige, nous n'effectuerons pas la capture de la forme des objets.  Au lieu de cela, nous allons peindre sur la cible de rendu avec des pinceaux.  Ce ne seront que des images du champ vectoriel sélectionné.  Je les appellerai des <em>pinceaux de direction</em> . <br><br>  Au lieu de dessiner sur la cible de rendu avec des contours, nous pouvons utiliser des <em>particules</em> .  Les particules afficheront une brosse de directions et émises par le lecteur.  Pour créer un champ vectoriel, il suffit d'utiliser la capture de scène et de capturer uniquement les particules.  L'avantage de cette méthode est que la création de traces est très simple.  De plus, il vous permet de gérer facilement des propriétés telles que la durée de stockage des pistes et leur taille.  De plus, les particules créent des traces temporairement persistantes, car elles existent après avoir quitté la zone de capture et y être retournées. <br><br>  Voici quelques exemples de brosses directionnelles que nous pouvons utiliser, ainsi que leur effet sur l'herbe.  Notez que dans l'exemple ci-dessous, les particules sont invisibles. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06a/7ac/976/06a7ac9766e63da84aec88bca2338b9a.gif"></div><br>  Pour commencer, créons un matériau qui affichera une brosse directionnelle. <br><br><h2>  Création de matériel pour les directions </h2><br>  Il existe deux façons de créer un pinceau de direction: <br><br><ol><li>  <em>Mathématique: les</em> directions et la forme sont définies à l'intérieur du matériau.  Son avantage est qu'il ne nécessite pas de logiciel tiers et est pratique pour les formulaires simples. </li><li>  <em>Conversion de carte normale:</em> créez une carte normale des directions et des formes souhaitées.  Pour convertir la carte en champ vectoriel approprié, il nous suffit de supprimer le canal bleu.  L'avantage de cette méthode est que vous pouvez très facilement créer des formes complexes.  Vous trouverez ci-dessous un exemple de pinceau qui sera difficile à créer mathématiquement. </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ddd/e44/0e5/ddde440e52ce5e3bbc6cdece65815265.jpg"></div><br>  Pour ce tutoriel, nous allons créer un pinceau mathématiquement.  Accédez au dossier <em>Matériaux</em> et ouvrez <em>M_Direction</em> .  Notez que le modèle d'ombrage <em>Éteint est</em> sélectionné pour ce matériau.  Ceci est important car il permet la capture d'une scène pour capturer des particules sans les affecter. <br><br>  Afin de ne pas compliquer les choses, nous allons créer un matériau qui fera que l'herbe s'éloignera du centre de la particule.  Pour ce faire, créez le schéma suivant: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/826/06f/fc1/82606ffc1df0425a75ef17c334a23470.jpg"></div><br>  Maintenant, nous devons redistribuer.  Pour ce faire, ajoutez les nœuds sélectionnés et connectez tout comme suit: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/02b/eb0/98a/02beb098a304fb3b9ff13a3852c664cd.jpg"></div><br>  Donnons maintenant au pinceau une forme ronde.  Pour ce faire, ajoutez les nœuds sélectionnés: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b97/4bf/702/b974bf7024f3487a8161e279ad3fb350.jpg"></div><br>  <em>RadialGradientExponential</em> contrôle la taille et la netteté de la circonférence du cercle.  La multiplication par la <em>couleur des particules</em> vous permet de contrôler l'opacité des particules du système de particules.  Je vais en discuter plus en détail dans la section suivante. <br><br>  Voici à quoi ressemble le pinceau: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/529/d6e/349/529d6e34937588676b1a20d03fdac107.jpg"></div><br>  Cliquez sur <em>Appliquer</em> et fermez le matériau.  Maintenant que nous avons créé le matériau, il est temps de se lancer dans un système de traces de particules. <br><br><h2>  Création d'un système de traces de particules </h2><br>  Accédez au dossier <em>ParticleSystems</em> et ouvrez <em>PS_GrassTrail</em> .  Pour gagner du temps, j'ai déjà créé tous les modules nécessaires. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6aa/008/5ee/6aa0085ee0867456e29f574511b43ec2.jpg"></div><br>  Voici comment chaque module affecte les empreintes de gazon: <br><br><ul><li>  <em>Spawn: la</em> fréquence de création affecte la fluidité des pistes.  Si les pistes semblent intermittentes, vous devez augmenter la fréquence de création.  Dans ce tutoriel, nous laisserons la valeur par défaut (20). </li><li>  <em>Durée de vie:</em> la durée de vie du sentier jusqu'à ce que l'herbe retrouve son état d'origine </li><li>  <em>Taille initiale:</em> taille de trace </li><li>  <em>Color Over Life:</em> puisque nous utilisons la couleur des particules dans le matériau, vous pouvez contrôler l'opacité ici.  Vous pouvez également modifier la courbe alpha pour contrôler la disparition de la piste.  Par exemple, vous pouvez choisir la disparition linéaire, l'accélération et / ou la décélération.  Dans ce tutoriel, nous laisserons le paramètre par défaut, c'est-à-dire la perte linéaire. </li><li>  <em>Verrouiller l'axe:</em> utilisé pour diriger les particules vers la capture de scène </li><li>  <em>Rotation initiale:</em> utilisée pour s'assurer que les particules sont orientées le long des axes corrects (plus de détails ci-dessous) </li></ul><br>  Nous devons d'abord définir le matériau.  Sélectionnez le module <em>requis</em> et définissez <em>Material</em> sur <em>M_Direction</em> .  <em>Définissez</em> également <em>Mode de tri</em> sur <em>PSORTMODE Âge le plus récent en premier</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb0/a43/fa3/bb0a43fa369abea85bc7a9ff6a80b06e.jpg"></div><br>  Ce mode de tri vous permet de rendre de nouvelles particules par-dessus les anciennes.  Si cela n'est pas fait, ce n'est pas nouveau, mais les vieilles particules affecteront l'herbe. <br><br>  Vient ensuite la durée de la trace.  Sélectionnez le module <em>Lifetime</em> et définissez <em>Constant</em> sur <em>5</em> .  Grâce à cela, la trace disparaîtra dans les cinq secondes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/505/d9d/b73/505d9db732f69d4b68b4079bd330553c.jpg"></div><br>  Passons maintenant à la taille de la trace.  Sélectionnez le module <em>Taille initiale</em> et définissez la <em>constante</em> sur <em>(150, 150, 0)</em> .  Pour cette raison, chaque particule couvrira une zone de 150 × 150. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/231/dba/9c5/231dba9c5421f8bdd79aba23f8def0cd.jpg"></div><br>  Maintenant, nous devons le faire regarder dans le sens de la capture de la scène.  Puisque la scène est capturée par le haut, les particules doivent regarder dans la direction de l'axe Z positif. Pour ce faire, sélectionnez le module <em>Verrouiller l'axe</em> et réglez les <em>drapeaux de l'axe de verrouillage</em> sur <em>Z.</em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b74/b2b/69c/b74b2b69c7d38785c7ad78d8ec6f250e.jpg"></div><br>  Enfin, nous devons définir la rotation des particules.  Actuellement, les couleurs des pinceaux ne sont pas alignées avec la direction qu'elles représentent.  Cela s'est produit parce que par défaut, le système de particules est appliqué avec une rotation de 90 degrés.  Pour résoudre ce problème, sélectionnez le module de <em>rotation initiale</em> et définissez la valeur <em>constante</em> sur <em>-0,25</em> .  Cela fera tourner les particules de 90 degrés dans le sens antihoraire. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/41d/a09/000/41da09000032c1023438b15a3a74f341.jpg"></div><br>  Et c'est tout ce dont nous avons besoin pour le système de particules, alors fermons-le. <br><br>  Ensuite, nous devons attacher un système de particules à ce qui est censé créer des traces.  Dans notre cas, nous devons l'attacher au personnage du joueur. <br><br><h3>  Fixation du système de particules </h3><br>  Accédez à <em>Personnages \ Mannequin</em> et ouvrez <em>BP_Mannequin</em> .  Ensuite, créez le composant <em>Partice System</em> et nommez-le <em>GrassParticles</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b72/9e0/811/b729e08111d25a301682968f1d878da0.jpg"></div><br>  Ensuite, nous devons définir un système de particules.  Accédez au panneau Détails et définissez <em>Particles \ Template</em> sur <em>PS_GrassTrail</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/491/45d/7d3/49145d7d362eb92443a8cfe93bd8a023.jpg"></div><br>  Il serait étrange que le joueur puisse voir la piste dans le jeu, donc ça vaut le coup de la cacher.  Pour ce faire, activez <em>Rendu \ Owner No See</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad4/de5/7a8/ad4de57a8d9f0eeee254a58c0de8e8d6.jpg"></div><br>  Puisque le système de particules est attaché au joueur (propriétaire), le joueur ne le verra pas, mais il sera visible pour tout le reste. <br><br>  Cliquez sur <em>Compiler</em> , puis sur <em>Lecture</em> .  Notez que les particules n'apparaissent pas pour la caméra du lecteur, mais sont affichées sur la cible de rendu. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c9d/4d5/4ac/c9d4d54ac998a6aa80da5887dc199b23.gif"></div><br>  Jusqu'à présent, la capture de scène est configurée pour <i>tout</i> capturer.  Évidemment, cela ne nous convient pas, car seules les particules affectent l'herbe.  Dans la section suivante, nous apprendrons à capturer uniquement les particules. <br><br><h2>  Capture de particules </h2><br>  Si nous capturons des particules maintenant, nous effectuerons une flexion inutile dans les zones sans particules.  En effet, la couleur d'arrière-plan de la cible de rendu est noire.  La flexion se produit parce que le noir indique un mouvement vers les axes XY négatifs (après redistribution).  Pour que les zones vides ne contiennent pas de mouvement, nous devons effectuer le rendu de la cible d'arrière-plan <em>(0,5, 0,5, 0)</em> .  La façon la plus simple de le faire est de créer un énorme avion et de le fixer au lecteur. <br><br>  Tout d'abord, créez du matériel pour l'arrière-plan.  Revenez au Navigateur de contenu et ouvrez <em>Materials \ M_Background</em> .  Connectez ensuite la constante <em>(0,5, 0,5, 0)</em> avec <em>Emissive Color</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/31b/46f/306/31b46f306ba4f2a0df310d36e54a000b.jpg"></div><br><blockquote>  <em>Remarque:</em> comme pour le matériau particulaire, tout matériau que nous capturons doit avoir un modèle de <em>shader non éclairé</em> . </blockquote><br>  Cliquez sur <em>Appliquer</em> et fermez le matériau.  Revenez à <em>BP_Mannequin</em> , puis créez un nouveau composant <em>Plan</em> .  Nommez-le <em>Contexte</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc4/0aa/1ff/bc40aa1ffbb655e576ce999318f4342b.jpg"></div><br>  Ensuite, définissez les propriétés suivantes: <br><br><ul><li>  <em>Emplacement:</em> (0, 0, -5000).  Nous plaçons l'avion si bas qu'il ne chevauche aucune particule. </li><li>  <em>Echelle:</em> (100, 100, 1).  Nous évoluons donc à une taille suffisante pour couvrir toute la zone de capture. </li><li>  <em>Matériel:</em> M_Background </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e6d/824/d3b/e6d824d3b427cff5e136a2861eb02bed.jpg"></div><br>  Comme pour les particules, il serait étrange que le joueur voie un énorme avion jaune en dessous.  Pour le masquer, activez <em>Rendu \ Owner No See</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cad/164/7df/cad1647dfe62bb1e29733ac8e6d6b712.jpg"></div><br>  Maintenant que nous avons configuré l'arrière-plan, il est temps de capturer les particules.  Nous pouvons le faire en ajoutant un système de particules à la <em>liste en lecture seule</em> de la capture de scène.  Il s'agit d'une liste de composants qui captureront la capture de scène. <br><br><h3>  Utilisation de la liste en lecture seule </h3><br>  Avant de pouvoir ajouter à la liste des émissions uniquement, nous avons besoin d'un moyen d'obtenir tous les acteurs qui affectent l'herbe.  Une façon de les obtenir est d'utiliser des <em>balises</em> .  Les balises sont de simples chaînes qui peuvent être attribuées aux acteurs et aux composants.  Ensuite, vous pouvez utiliser le nœud Obtenir tous les acteurs avec le tag pour obtenir tous les acteurs avec le tag correspondant. <br><br>  Puisque l'acteur du joueur doit influencer l'herbe, il a besoin d'une étiquette.  Pour ajouter une balise, cliquez sur le bouton <em>Class Defaults</em> .  Créez ensuite une nouvelle balise dans <em>Actor \ Tags</em> et nommez-la <em>GrassAffector</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/759/df5/711/759df57115fd0a2172f9c9c4c5b0505d.jpg"></div><br>  Étant donné que seuls les <i>composants</i> peuvent être transférés dans la liste en lecture seule, nous devons ajouter des balises aux <i>composants</i> qui affectent le gazon.  Sélectionnez le composant <em>GrassParticles</em> et ajoutez une nouvelle balise située dans la section <em>Balises</em> .  Nommez-le également <em>GrassAffector</em> (il n'est <i>pas nécessaire d'</i> utiliser cette balise).  Répétez la même chose pour le composant <em>Arrière</em> - <em>plan</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8f4/3f4/05a/8f43f405a8cf96083d5df56e54d21576.jpg"></div><br>  Maintenant, nous devons ajouter des composants influençant l'herbe à la liste de capture de scène uniquement visible.  Cliquez sur <em>Compiler</em> et fermez <em>BP_Mannequin</em> .  Ouvrez ensuite <em>Blueprints \ BP_Capture</em> .  Accédez à <em>Event BeginPlay</em> et ajoutez les nœuds en surbrillance.  Assurez-vous également que les broches marquées sont connectées. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7d9/e82/3cf/7d9e823cffefede4f0273a81b9363ecb.jpg"></div><br>  Ce circuit <em>parcourra</em> tous les acteurs avec la balise <em>GrassAffector</em> .  Après quoi, elle vérifiera si l'acteur a des composants avec cette balise et les ajoutera à la liste en lecture seule. <br><br>  Ensuite, nous devons dire à la capture de scène d'utiliser uniquement la liste à afficher uniquement.  Sélectionnez le composant <em>SceneCapture</em> et accédez à la section <em>Capture de scène</em> .  Définissez le <em>mode de rendu primitif</em> pour <em>utiliser la liste ShowOnly</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/675/ecd/6eb/675ecd6eb2a1c867734b920bbeaeedd4.jpg"></div><br>  Cliquez sur <em>Compiler</em> et fermez le plan.  Si vous cliquez sur <em>Lecture</em> , vous verrez que la cible de rendu capture désormais uniquement les particules et le plan d'arrière-plan. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ee0/a1f/3d7/ee0a1f3d7bb9687f81ec2e7d0faaf61b.gif"></div><br>  Dans la section suivante, nous arrivons à ce que nous attendions.  Il est temps d'apprendre à l'herbe à se plier! <br><br><h2>  Pliez l'herbe </h2><br>  Nous devons d'abord projeter la cible de rendu sur l'herbe.  Accédez au dossier <em>Matériaux</em> et ouvrez <em>M_Grass</em> .  Créez ensuite les nœuds illustrés ci-dessous.  Définissez la texture sur <em>RT_Capture</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ec0/fd7/4e6/ec0fd74e6e18c21da2d9b647c878613c.jpg"></div><br>  Puisque nous avons redistribué les couleurs dans l'intervalle de 0 à 1, avant de les utiliser, nous devons redistribuer les couleurs dans l'intervalle de -1 à 1. Pour ce faire, ajoutez les nœuds en surbrillance: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/25d/dc7/0be/25ddc70be17e726bd3089c21ee5be21e.jpg"></div><br>  Maintenant que nous avons la direction de flexion, nous avons besoin d'un moyen de faire tourner l'herbe dans cette direction.  Heureusement, il existe un nœud appelé <em>RotateAboutAxis</em> pour cela.  Créons-le. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a92/4a0/127/a924a0127868686cf2616c8d994e9b5a.jpg"></div><br>  Commençons par le contact <em>NormalizedRotationAxis</em> .  Comme son nom l'indique, il s'agit de l'axe autour duquel le sommet tournera.  Pour calculer, nous avons juste besoin d'un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">produit vectoriel de la</a> direction de flexion de <em>(0, 0, -1)</em> .  Pour ce faire, nous devons ajouter les nœuds sélectionnés: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5c3/898/ece/5c3898ecee9d7a4fd9ea75e53072acd1.jpg"></div><br>  Nous devons également spécifier le <em>RotationAngle</em> , c'est-à-dire la quantité de rotation du sommet par rapport au point de rotation.  Par défaut, la valeur doit être comprise entre 0 et 1, où 0 est 0 degré et 1 est 360 degrés.  Pour obtenir l'angle de rotation, on peut utiliser la longueur du sens de flexion, multipliée par la rotation maximale. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d4/171/800/6d417180067018db8df09f878251f6e8.jpg"></div><br>  La multiplication par une rotation maximale de <em>0,2</em> signifie que l'angle de rotation maximal est de <em>72</em> degrés. <br><br>  Le calcul de <em>PivotPoint</em> est un peu plus difficile, car un seul maillage d'herbe contient plusieurs tiges.  Cela signifie que nous ne pouvons pas utiliser quelque chose comme le nœud <em>Position de</em> l' <em>objet</em> , car il renverra un seul point pour toutes les tiges d'herbe. <br><br>  Idéalement, vous devez utiliser un éditeur 3D tiers pour enregistrer les points de pivot à l'intérieur des canaux UV.  Mais pour ce tutoriel, nous approchons simplement le point de pivot.  Cela peut être fait en se déplaçant du haut <em>vers</em> le <em>bas</em> jusqu'à un certain décalage. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f47/6ac/cdf/f476accdf57bca37d5bd7994f53b6b47.jpg"></div><br>  Pour ce faire, ajoutez les nœuds sélectionnés: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/05a/1bd/208/05a1bd2082b7044a1535aaf38cf33264.jpg"></div><br>  Dans ce didacticiel, l'herbe mesure environ <em>80</em> unités de hauteur, j'ai donc défini cette valeur pour <em>PivotOffset</em> . <br><br>  Ensuite, nous devons effectuer deux masques.  Le premier masque garantit que la racine de la tige ne bougera pas.  Le deuxième masque garantit qu'aucun champ vectoriel n'agit sur l'herbe en dehors de la zone de capture. <br><br><h3>  Masquage </h3><br>  Pour ce tutoriel, j'ai défini les couleurs des sommets de l'herbe afin que les sommets inférieurs soient noirs et les sommets supérieurs blancs. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/199/0ff/45b/1990ff45be26b99bf5330a0d2817e102.jpg"></div><br>  Pour masquer les racines, nous multiplions simplement le résultat de <em>RotateAboutAxis</em> par le nœud <em>Vertex Color</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/522/568/0fc/5225680fcb4fd4bedf2f7ec7a49ebb58.jpg"></div><br>  Pour masquer l'herbe en dehors de la zone de capture, nous multiplions le résultat précédent par le nœud sélectionné: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/37b/da2/e95/37bda2e954f8e160ab3b0c80d5269acf.jpg"></div><br>  Cliquez sur <em>Appliquer</em> et fermez le matériau.  Cliquez sur <em>Play</em> et courez à travers l'herbe pour y laisser des empreintes! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1dc/058/185/1dc058185c158d1ef243b04f5d041174.gif"></div><br><h2>  Où aller ensuite? </h2><br>  Le projet terminé peut être téléchargé <a href="">ici</a> . <br><br>  Bien que la méthode présentée dans le didacticiel fonctionne très bien pour les objets simples tels que l'herbe, elle n'est pas suffisante lorsque vous utilisez des objets qui nécessitent plus de dynamisme.  Une solution partielle au problème consiste à utiliser les versions physiques du feuillage.  Voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet article</a> sur le feuillage interactif pour plus d'informations. <br><br>  Enfin, je tiens à remercier Deathrey de la communauté Unreal Engine pour le conseil de cette méthode des particules! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr420079/">https://habr.com/ru/post/fr420079/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr420069/index.html">Richard Hamming: Chapitre 20. Modélisation - III</a></li>
<li><a href="../fr420071/index.html">Différents prix pour les entrepôts en multi-entrepôt. Raffinement 1C-Bitrix</a></li>
<li><a href="../fr420073/index.html">The Art of Management: A Review of the Best Reports with Teamlead Conf 2018. Partie 2</a></li>
<li><a href="../fr420075/index.html">Cette ingénieuse carte explique comment tout se combine en physique.</a></li>
<li><a href="../fr420077/index.html">Nouvelles opportunités de trading en ligne</a></li>
<li><a href="../fr420081/index.html">Installez Archlinux avec le chiffrement complet du système et LVM sur LUKS</a></li>
<li><a href="../fr420083/index.html">Action idéale pour Google Assistant - 8 leçons du Hackathon de Moscou</a></li>
<li><a href="../fr420085/index.html">Reconnaissance d'objets et d'émotions humaines à l'aide du kit Firebase ML</a></li>
<li><a href="../fr420087/index.html">Il s'agit d'un article avec des rapports et des vidéos sur MS SQL Server.</a></li>
<li><a href="../fr420089/index.html">Robomobiles: peloton et saucisses bavaroises</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>