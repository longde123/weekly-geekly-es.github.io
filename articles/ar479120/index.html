<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔍 🏴󠁧󠁢󠁥󠁮󠁧󠁿 🤞🏾 فشل الإقبال: نأتي AgentTesla لتنظيف المياه. الجزء 2 👨‍🎓 🐿️ 📃</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="نواصل سلسلة من المقالات حول تحليل البرامج الضارة. في الجزء الأول ، تحدثنا عن كيفية قيام Ilya Pomerantsev ، وهو خبير تحليل الشفرات الخبيثة في CERT Grou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>فشل الإقبال: نأتي AgentTesla لتنظيف المياه. الجزء 2</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/479120/" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/vz/an/r5/vzanr5kxitvhd3zqrcdh1qhctjm.png"></div><br>  نواصل سلسلة من المقالات حول تحليل البرامج الضارة.  في الجزء <a href="https://habr.com/ru/company/group-ib/blog/478176/">الأول</a> ، تحدثنا عن كيفية قيام Ilya Pomerantsev ، وهو خبير تحليل الشفرات الخبيثة في CERT Group-IB ، بإجراء تحليل مفصل لملف تم استلامه عن طريق البريد من إحدى الشركات الأوروبية ووجد <b>برنامج التجسس AgentTesla هناك</b> .  في هذه المقالة ، يعرض Ilya نتائج تحليل تدريجي لوحدة <b>AgentTesla</b> الرئيسية. <br><a name="habracut"></a><br><blockquote style=";text-align:right;direction:rtl"> Agent Tesla هو برنامج تجسس معياري يتم توزيعه على أنه برنامج ضار كخدمة تحت ستار منتج keylogger قانوني.  يمكن للعامل Tesla استخراج ونقل بيانات اعتماد المستخدم من المتصفحات وعملاء البريد الإلكتروني وعملاء FTP إلى الخادم للمهاجمين وتسجيل بيانات الحافظة والتقاط شاشة الجهاز.  في وقت التحليل ، كان الموقع الرسمي للمطورين غير متاح. <br></blockquote><br><h2 style=";text-align:right;direction:rtl">  ملف التكوين </h2><br>  يسرد الجدول أدناه الميزات التي يتم استخدامها في العينة المستخدمة: <br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <strong>وصف</strong> <br></td><td>  <strong>قيمة</strong> <br></td></tr><tr><td>  KeyLogger استخدام العلم <br></td><td>  صحيح <br></td></tr><tr><td>  إشارة لاستخدام ScreenLogger <br></td><td>  زائف <br></td></tr><tr><td>  سجل KeyLogger إرسال الفاصل في دقائق <br></td><td>  20 <br></td></tr><tr><td>  سجل ScreenLogger إرسال الفاصل في دقائق <br></td><td>  20 <br></td></tr><tr><td>  علامة لمعالجة مفتاح مسافة للخلف.  خطأ - تسجيل فقط.  صحيح - محو المفتاح السابق <br></td><td>  زائف <br></td></tr><tr><td>  اكتب CnC.  خيارات: بروتوكول نقل البريد الإلكتروني ، لوحة الويب ، بروتوكول نقل الملفات <br></td><td>  بروتوكول نقل البريد الإلكتروني <br></td></tr><tr><td>  علامة التنشيط لمؤشر الترابط لإنهاء العمليات من القائمة "٪ filter_list٪" <br></td><td>  زائف <br></td></tr><tr><td>  UAC تعطيل العلم <br></td><td>  زائف <br></td></tr><tr><td>  تعطيل إشارة مدير المهام <br></td><td>  زائف <br></td></tr><tr><td>  CMD تعطيل العلم <br></td><td>  زائف <br></td></tr><tr><td>  تشغيل نافذة تعطيل العلم <br></td><td>  زائف <br></td></tr><tr><td>  تعطيل علامة عارض التسجيل <br></td><td>  زائف <br></td></tr><tr><td>  تعطيل نقاط استعادة النظام <br></td><td>  صحيح <br></td></tr><tr><td>  لوحة التحكم تعطيل العلم <br></td><td>  زائف <br></td></tr><tr><td>  MSCONFIG تعطيل العلم <br></td><td>  زائف <br></td></tr><tr><td>  مستكشف سياق قائمة تعطيل العلم <br></td><td>  زائف <br></td></tr><tr><td>  علم دبوس النظام <br></td><td>  زائف <br></td></tr><tr><td>  مسار لنسخ الوحدة الرئيسية عند الالتحام في النظام <br></td><td>  ٪ startupfolder٪ \\٪ insfolder٪ \\٪ insname٪ <br></td></tr><tr><td>  علم لوضع سمات "النظام" و "السرية" للوحدة الرئيسية المثبتة في النظام <br></td><td>  زائف <br></td></tr><tr><td>  أعد تشغيل علامة التنفيذ عند الإصلاح على النظام <br></td><td>  زائف <br></td></tr><tr><td>  علم لنقل الوحدة الرئيسية إلى مجلد مؤقت <br></td><td>  زائف <br></td></tr><tr><td>  UAC الالتفافية تشغيل العلم <br></td><td>  زائف <br></td></tr><tr><td>  تنسيق التاريخ والوقت للتسجيل <br></td><td>  yyyy-MM-dd HH: mm: ss <br></td></tr><tr><td>  إشارة إلى استخدام برنامج تصفية KeyLogger <br></td><td>  صحيح <br></td></tr><tr><td>  نوع تصفية البرنامج. <br>  1- يتم البحث عن اسم البرنامج في رؤوس النافذة <br>  2 - يتم البحث عن اسم البرنامج في اسم عملية النافذة <br></td><td>  1 <br></td></tr><tr><td>  مرشح البرنامج <br></td><td>  «الفيسبوك»، <br>  «تويتر»، <br>  «جوجل»، <br>  «إينستاجرام»، <br>  «السينما»، <br>  «سكايب»، <br>  «اباحي»، <br>  «هاك»، <br>  «واتس اب»، <br>  «الفتنة» <br></td></tr></tbody></table></div><br><h2 style=";text-align:right;direction:rtl">  إصلاح الوحدة الرئيسية في النظام </h2><br>  إذا تم تعيين العلامة المقابلة ، يتم نسخ الوحدة الرئيسية على طول المسار المحدد في التكوين كمسار للتثبيت في النظام. <br><br>  اعتمادًا على القيمة من التكوين ، يُعطى الملف سمات "مخفي" و "نظام". <br>  يتم توفير التشغيل التلقائي بواسطة فرعين التسجيل: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>HKCU \ البرامج \ Microsoft \ Windows \ CurrentVersion \ Run \٪ insregname٪</b> </li><li style=";text-align:right;direction:rtl">  <b>HKCU \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Explorer \ StartupAppro \ Run \٪ insregname٪</b> </li></ul><br>  نظرًا <b>لضخ</b> محمل الإقلاع في عملية <b>RegAsm</b> ، يؤدي تعيين العلامة المستمرة للوحدة الرئيسية إلى عواقب مثيرة جدًا للاهتمام.  بدلاً من نسخ نفسه ، قامت البرامج الضارة بتأمين ملف <b>RegAsm.exe</b> الأصلي في النظام ، حيث تم إجراء الحقن. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/a8/mx/in/a8mxinpopuoixolt4r7tiwulc70.png"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/9p/-f/ui/9p-fui42mv7y06i5ivacsyh2zqm.png"></div><br><h2 style=";text-align:right;direction:rtl">  التفاعل مع C&amp;C </h2><br>  بغض النظر عن الطريقة المستخدمة ، يبدأ تفاعل الشبكة في الحصول على IP الخارجي للضحية باستخدام <b><a href="http://checkip/">checkip</a> [.] Amazonaws [.] Com /</b> resource. <br>  فيما يلي وصف لأساليب الشبكات المقدمة في البرامج الضارة. <br><br><h3 style=";text-align:right;direction:rtl">  webpanel </h3><br>  التفاعل هو عبر بروتوكول HTTP.  تنفذ البرامج الضارة طلبًا POST بالرؤوس التالية: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>User-Agent: Mozilla / 5.0 (Windows U Windows NT 6.1 ru rv: 1.9.2.3) Gecko / 20100401 Firefox / 4.0 (.NET CLR 3.5.30729)</b> </li><li style=";text-align:right;direction:rtl">  <b>اتصال: الحفاظ على الحياة</b> </li><li style=";text-align:right;direction:rtl">  <b>نوع المحتوى: application / x-www-form-urlencoded</b> </li></ul><br>  تم تعيين عنوان الخادم على <b>٪ PostURL٪</b> .  يتم تمرير الرسالة المشفرة في المعلمة <b>"p"</b> .  يتم وصف آلية التشفير في قسم <b>"خوارزميات التشفير" (الطريقة الثانية)</b> . <br><br>  الرسالة المرسلة هي كما يلي: <br><br>  <b>اكتب = {0} \ nhwid = {1} \ ntime = {2} \ npcname = {3} \ nlogdata = {4} \ nscreen = {5} \ nipadd = {5} \ nipadd = {6} \ nwebcam_link = {7} \ nclient = {8} \ nlink = {9} \ nusername = {10} \ npassword = {11} \ nscreen_link = {12}</b> <br><br>  تشير المعلمة <b>type</b> إلى نوع الرسالة: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/lc/5l/yr/lc5lyrzbeie0jr9z-6dpzpylaze.jpeg"></div><br>  <b>hwid</b> - تتم كتابة علامة MD5 من قيم الرقم التسلسلي للوحة الأم ومعرف المعالج.  على الأرجح تستخدم كمعرف مستخدم. <br>  <b>الوقت</b> - يعمل على نقل الوقت والتاريخ الحاليين. <br>  <b>pcname</b> - معرّف كـ <b>&lt;Username&gt; / &lt;Computer Name&gt;</b> . <br>  <b>logdata</b> - بيانات السجل. <br><br>  عند نقل كلمات المرور ، تبدو الرسالة كما يلي: <br><br>  <b>اكتب = {0} \ nhwid = {1} \ ntime = {2} \ npcname = {3} \ nlogdata = {4} \ nscreen = {5} \ nipadd = {5} \ nipadd = {6} \ nwebcam_link = {7} \ nscreen_link = {8} \ n [كلمات المرور]</b> <br><br>  فيما يلي وصف للبيانات المسروقة بالتنسيق <b>\ nclient [] = {0} \ nlink [] = {1} \ nusername [] = {2} \ n كلمة المرور [] = {3}</b> . <br><br><h3 style=";text-align:right;direction:rtl">  بروتوكول نقل البريد الإلكتروني </h3><br>  التفاعل عبر بروتوكول SMTP.  الرسالة المرسلة بتنسيق HTML.  المعلمة <b>BODY</b> هي: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/gh/vg/np/ghvgnpycvdbcsyyakmwjvfppnw4.png"></div><br>  يحتوي عنوان الرسالة على الشكل العام: <b>&lt;اسم المستخدم&gt; / &lt;اسم الكمبيوتر&gt; &lt;CONTENT TYPE&gt;</b> .  محتويات الرسالة ، وكذلك مرفقاتها ، غير مشفرة. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/x5/7c/5o/x57c5ojnqhgfpnec0jnsqix931c.jpeg"></div><br>  التفاعل هو عبر بروتوكول نقل الملفات.  يتم نقل ملف يحمل الاسم <b>&lt;CONTENT TYPE&gt; _ &lt;اسم المستخدم&gt; - &lt;اسم الكمبيوتر&gt; _ &lt;DATE AND TIME&gt; .html</b> إلى الخادم المحدد.  محتويات الملف غير مشفرة. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/r-/2n/wr/r-2nwryzwnv7voneopya8y5aazq.jpeg"></div><br><h2 style=";text-align:right;direction:rtl">  خوارزميات التشفير </h2><br>  يتم استخدام أساليب التشفير التالية في هذه الحالة: <br><br><h3 style=";text-align:right;direction:rtl">  طريقة 1 </h3><br>  تستخدم هذه الطريقة لتشفير السلاسل في الوحدة الرئيسية.  للتشفير ، يتم <b>استخدام</b> خوارزمية <b>AES</b> . <br><br>  الإدخال رقم عشري مكون من ستة أرقام.  يتم تنفيذ التحويل التالي على ذلك: <br><br>  <b>f (x) = (((x &gt;&gt; 2 - 31059) ^ 6380) - 1363) &gt;&gt; 3</b> <br><br>  القيمة الناتجة هي فهرس صفيف البيانات المضمن. <br><br>  كل عنصر من عناصر الصفيف هو تسلسل <b>DWORD</b> .  عند دمج <b>DWORD ،</b> يتم الحصول على صفيف من وحدات البايت: أول 32 بايت هي مفتاح التشفير ، يليه 16 بايت من متجه التهيئة ، والبايتات المتبقية هي البيانات المشفرة. <br><br><h3 style=";text-align:right;direction:rtl">  الطريقة 2 </h3><br>  يتم استخدام خوارزمية <b>3DES</b> في <b>وضع ECB</b> مع الحشو بالبايت بالكامل ( <b>PKCS7</b> ). <br><br>  يتم تحديد المفتاح بواسطة المعلمة <b>٪ urlkey٪</b> ، ولكن يتم استخدام تجزئة MD5 للتشفير. <br><br><h2 style=";text-align:right;direction:rtl">  وظيفة ضارة </h2><br>  تستخدم العينة قيد الدراسة البرامج التالية لتنفيذ وظيفتها الضارة: <br><br><h3 style=";text-align:right;direction:rtl">  كلوغر </h3><br>  في حالة وجود علامة VPO مقابلة باستخدام وظيفة WinAPI ، يعين <b>SetWindowsHookEx</b> معالجه الخاص لأحداث ضغط المفاتيح في لوحة المفاتيح.  تبدأ وظيفة المعالج بالحصول على عنوان الإطار النشط. <br><br>  إذا تم تعيين علامة أداء تصفية التطبيقات ، فسيتم إجراء التصفية حسب النوع المحدد: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  يتم البحث عن اسم البرنامج في رؤوس النوافذ </li><li style=";text-align:right;direction:rtl">  يتم البحث عن اسم البرنامج في اسم عملية النافذة </li></ol><br>  بعد ذلك ، يتم إضافة سجل إلى السجل مع معلومات حول الإطار النشط بالتنسيق: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/bx/r0/cj/bxr0cj1srz9us2a4il4rwjfpoqo.png"></div><br>  ثم يتم تسجيل المعلومات حول المفتاح المضغوط: <br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <strong>مفتاح</strong> <br></td><td>  <strong>سجل</strong> <br></td></tr><tr><td>  مسافة للخلف <br></td><td>  اعتمادًا على علامة معالجة مفتاح مسافة للخلف: False - <font color="#008000">{BACK}</font> <br>  صحيح - محو المفتاح السابق <br></td></tr><tr><td>  CAPSLOCK <br></td><td>  <font color="#008000">{CAPSLOCK}</font> <br></td></tr><tr><td>  ESC <br></td><td>  <font color="#008000">{ESC}</font> <br></td></tr><tr><td>  PAGEUP <br></td><td>  <font color="#008000">{PAGEUP}</font> <br></td></tr><tr><td>  إلى <br></td><td>  <font color="#008000">؟ دار</font> <br></td></tr><tr><td>  DELETE <br></td><td>  <font color="#008000">{DEL}</font> <br></td></tr><tr><td>  " <br></td><td>  &amp; quot؛ <br></td></tr><tr><td>  F5 <br></td><td>  <font color="#008000">{F5}</font> <br></td></tr><tr><td>  و <br></td><td>  &amp; amp؛ <br></td></tr><tr><td>  F10 <br></td><td>  <font color="#008000">{F10}</font> <br></td></tr><tr><td>  TAB <br></td><td>  <font color="#008000">{TAB}</font> <br></td></tr><tr><td>  &lt; <br></td><td>  &amp; lt؛ <br></td></tr><tr><td>  &gt; <br></td><td>  &amp; gt؛ <br></td></tr><tr><td>  فجوة <br></td><td></td></tr><tr><td>  F8 <br></td><td>  <font color="#008000">{F8}</font> <br></td></tr><tr><td>  F12 <br></td><td>  <font color="#008000">{F12}</font> <br></td></tr><tr><td>  F9 <br></td><td>  <font color="#008000">{F9}</font> <br></td></tr><tr><td>  ALT + TAB <br></td><td>  <font color="#008000">{ALT + TAB}</font> <br></td></tr><tr><td>  END <br></td><td>  <font color="#008000">{END}</font> <br></td></tr><tr><td>  F4 <br></td><td>  <font color="#008000">{F4}</font> <br></td></tr><tr><td>  F2 <br></td><td>  <font color="#008000">{F2}</font> <br></td></tr><tr><td>  CTRL <br></td><td>  <font color="#008000">{CTRL}</font> <br></td></tr><tr><td>  F6 <br></td><td>  <font color="#008000">{F6}</font> <br></td></tr><tr><td>  حق <br></td><td>  <font color="#008000">؟ رر ؛</font> <br></td></tr><tr><td>  فوق <br></td><td>  <font color="#008000">&amp; uarr؛</font> <br></td></tr><tr><td>  F1 <br></td><td>  <font color="#008000">{F1}</font> <br></td></tr><tr><td>  اليسار <br></td><td>  <font color="#008000">&amp; larr؛</font> <br></td></tr><tr><td>  بين pagedown <br></td><td>  <font color="#008000">{بين pagedown}</font> <br></td></tr><tr><td>  إدراج <br></td><td>  <font color="#008000">{إدراج}</font> <br></td></tr><tr><td>  فاز <br></td><td>  <font color="#008000">{وين}</font> <br></td></tr><tr><td>  يكون NumLock <br></td><td>  <font color="#008000">{} يكون NumLock</font> <br></td></tr><tr><td>  F11 <br></td><td>  <font color="#008000">{F11}</font> <br></td></tr><tr><td>  F3 <br></td><td>  <font color="#008000">{F3}</font> <br></td></tr><tr><td>  منزل <br></td><td>  <font color="#008000">{منزل}</font> <br></td></tr><tr><td>  ENTER <br></td><td>  <font color="#008000">{ENTER}</font> <br></td></tr><tr><td>  ALT + F4 <br></td><td>  <font color="#008000">{ALT + F4}</font> <br></td></tr><tr><td>  F7 <br></td><td>  <font color="#008000">{F7}</font> <br></td></tr><tr><td>  مفتاح آخر <br></td><td>  الأحرف الكبيرة أو الأحرف الصغيرة بناءً على موضع مفاتيح CapsLock و Shift <br></td></tr></tbody></table></div><br>  مع تردد معين ، يتم إرسال السجل الذي تم جمعه إلى الخادم.  إذا لم ينجح النقل ، <b>فسيتم</b> حفظ السجل في الملف <b>٪ TEMP٪ \\ log.tmp</b> بالتنسيق: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/xn/pz/eb/xnpzeba3_y7ulwz0wesksvlspkg.png"></div><br>  عند تشغيل المؤقت ، سيتم نقل الملف إلى الخادم. <br><br><h3 style=";text-align:right;direction:rtl">  ScreenLogger </h3><br>  باستخدام التردد المحدد ، تقوم البرامج الضارة بإنشاء لقطة شاشة بتنسيق <b>Jpeg</b> بقيمة <b>جودة</b> قدرها 50 وتحفظها في الملف <b>٪ APPDATA٪ \\ &lt;التسلسل التعسفي المكون من 10 أحرف&gt; .jpg</b> .  بعد النقل ، يتم حذف الملف. <br><br><h3 style=";text-align:right;direction:rtl">  ClipboardLogger </h3><br>  إذا تم تعيين العلامة المقابلة ، يتم إجراء بدائل في النص الذي تم اعتراضه وفقًا للجدول أدناه. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/xh/wc/y7/xhwcy7r4g5duormggz-texkxemi.jpeg"></div><br>  بعد ذلك ، يتم إدراج النص في السجل: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ft/6l/2p/ft6l2pmpzecwtkh0hhgbblet30q.png"></div><br><h3 style=";text-align:right;direction:rtl">  PasswordStealer </h3><br>  يمكن للبرامج الضارة تنزيل كلمات المرور من التطبيقات التالية: <br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <strong>المتصفحات</strong> <br></td><td>  <strong>عملاء البريد الإلكتروني</strong> <br></td><td>  <strong>عملاء FTP</strong> <br></td></tr><tr><td>  الكروم <br></td><td>  توقعات <br></td><td>  فايلزيلا <br></td></tr><tr><td>  فايرفوكس <br></td><td>  ثندربيرد <br></td><td>  WS_FTP <br></td></tr><tr><td>  IE / الحافة <br></td><td>  Foxmail <br></td><td>  وين إس سي بي <br></td></tr><tr><td>  رحلات السفاري <br></td><td>  بريد الأوبرا <br></td><td>  CoreFTP <br></td></tr><tr><td>  متصفح الاوبرا <br></td><td>  إنكريديميل <br></td><td>  بروتوكول نقل الملفات المستكشف <br></td></tr><tr><td>  ياندكس <br></td><td>  Pocomail <br></td><td>  برنامج FlashFXP <br></td></tr><tr><td>  كمودو <br></td><td>  يودورا <br></td><td>  سمارت <br></td></tr><tr><td>  ChromePlus <br></td><td>  TheBat <br></td><td>  FTPCommander <br></td></tr><tr><td>  الكروم <br></td><td>  صندوق البريد <br></td><td></td></tr><tr><td>  شعلة <br></td><td>  ClawsMail <br></td><td></td></tr><tr><td>  7Star <br></td><td></td><td></td></tr><tr><td>  أميغو <br></td><td></td><td></td></tr><tr><td>  BraveSoftware <br></td><td>  <strong>عملاء جابر</strong> <br></td><td>  <strong>عملاء VPN</strong> <br></td></tr><tr><td>  CentBrowser <br></td><td>  psi / psi + <br></td><td>  افتح VPN <br></td></tr><tr><td>  Chedot <br></td><td></td><td></td></tr><tr><td>  CocCoc <br></td><td></td><td></td></tr><tr><td>  عناصر المتصفح <br></td><td>  <strong>مديري التنزيل</strong> <br></td><td></td></tr><tr><td>  متصفح ملحمة الخصوصية <br></td><td>  مدير تحميل الانترنت <br></td><td></td></tr><tr><td>  KOMETA <br></td><td>  JDownloader <br></td><td></td></tr><tr><td>  Orbitum <br></td><td></td><td></td></tr><tr><td>  السبوتنيك قمر صناعي <br></td><td></td><td></td></tr><tr><td>  uCozMedia <br></td><td></td><td></td></tr><tr><td>  فيفالدي <br></td><td></td><td></td></tr><tr><td>  إضافات <br></td><td></td><td></td></tr><tr><td>  متصفح القطيع <br></td><td></td><td></td></tr><tr><td>  متصفح UC <br></td><td></td><td></td></tr><tr><td>  بلاك هوك <br></td><td></td><td></td></tr><tr><td>  CyberFox <br></td><td></td><td></td></tr><tr><td>  ك Meleon <br></td><td></td><td></td></tr><tr><td>  التجارية Icecat <br></td><td></td><td></td></tr><tr><td>  IceDragon <br></td><td></td><td></td></tr><tr><td>  PaleMoon <br></td><td></td><td></td></tr><tr><td>  WaterFox <br></td><td></td><td></td></tr><tr><td>  متصفح فالكون <br></td><td></td><td></td></tr></tbody></table></div><br><br><h2 style=";text-align:right;direction:rtl">  مواجهة التحليل الديناميكي <br></h2><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  باستخدام وظيفة <b>النوم</b> .  يسمح بتجاوز بعض صناديق الرمل عن طريق المهلة </li><li style=";text-align:right;direction:rtl">  تدمير دفق <b>Zone.Identifier</b> .  يسمح لك بإخفاء حقيقة تنزيل ملف من الإنترنت </li><li style=";text-align:right;direction:rtl">  <b>تعيّن</b> المعلمة <b>٪ filter_list٪</b> قائمة العمليات التي <b>سيكملها البرنامج الضريبي</b> بفاصل زمني واحد </li><li style=";text-align:right;direction:rtl">  تعطيل <b>UAC</b> </li><li style=";text-align:right;direction:rtl">  تعطيل مدير المهام </li><li style=";text-align:right;direction:rtl">  تعطيل <b>CMD</b> </li><li style=";text-align:right;direction:rtl">  تعطيل نافذة <b>التشغيل</b> </li><li style=";text-align:right;direction:rtl">  تعطيل لوحة التحكم </li><li style=";text-align:right;direction:rtl">  تعطيل <b>أداة RegEdit</b> </li><li style=";text-align:right;direction:rtl">  تعطيل نقاط استعادة النظام </li><li style=";text-align:right;direction:rtl">  تعطيل قائمة السياق في Explorer </li><li style=";text-align:right;direction:rtl">  تعطيل <b>مسكونفيغ</b> </li><li style=";text-align:right;direction:rtl">  تجاوز <b>UAC</b> : <br></li></ul><br><h2 style=";text-align:right;direction:rtl">  ميزات غير نشطة من الوحدة الرئيسية </h2><br>  أثناء تحليل الوحدة الرئيسية ، تم تحديد الوظائف المسؤولة عن الانتشار عبر الشبكة وتعقب موضع الماوس. <br><br><h3 style=";text-align:right;direction:rtl">  دودة </h3><br>  في دفق منفصل ، تتم مراقبة أحداث اتصال الوسائط القابلة للنقل.  عند الاتصال بجذر نظام الملفات ، <b>يتم</b> نسخ <b>البرامج الضارة</b> باستخدام اسم <b>scr.exe</b> ، وبعد ذلك يبحث عن الملفات ذات الامتداد <b>lnk</b> .  يتغير كل <b>أمر lnk</b> إلى <b>cmd.exe / c start scr.exe وبدء &lt;الأمر الأصلي&gt; والخروج</b> . <br><br>  يتم إعطاء السمة <b>المخفية</b> لكل دليل في جذر الوسيط ويتم إنشاء ملف بامتداد <b>lnk</b> باسم الدليل المخفي ، <b>وسيبدأ</b> الأمر <b>cmd.exe / c في بدء scr.exe &amp; explorer / root ، \ "٪ CD٪ &lt;DIRECTORY NAME&gt; \" والخروج</b> . <br><br><h3 style=";text-align:right;direction:rtl">  MouseTracker </h3><br>  تشبه طريقة الاعتراض تلك المستخدمة في لوحة المفاتيح.  هذه الوظيفة لا تزال قيد التطوير. <br><br><h2 style=";text-align:right;direction:rtl">  نشاط الملف </h2><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <strong>الطريق</strong> <br></td><td>  <strong>وصف</strong> <br></td></tr><tr><td>  ٪ Temp٪ \ temp.tmp <br></td><td>  يحتوي على عداد لمحاولات تجاوز UAC <br></td></tr><tr><td>  ٪ startupfolder٪ \٪ insfolder٪ \٪ insname٪ <br></td><td>  طريقة لتعزيز في نظام HPE <br></td></tr><tr><td>  ٪ Temp٪ \ tmpG \ {الوقت الحالي بالمللي ثانية} .tmp <br></td><td>  مسار النسخ الاحتياطي للوحدة الرئيسية <br></td></tr><tr><td>  ٪ Temp٪ \ log.tmp <br></td><td>  ملف السجل <br></td></tr><tr><td>  ٪ AppData٪ \ {التسلسل التعسفي المكون من 10 أحرف} .jpeg <br></td><td>  لقطات <br></td></tr><tr><td>  C: \ Users \ Public \ {تسلسل تعسفي من 10 أحرف} .vbs <br></td><td>  المسار إلى ملف vbs الذي يمكن أن يستخدمه أداة تحميل التشغيل لإغلاق النظام <br></td></tr><tr><td>  ٪ Temp٪ \ {اسم المجلد التعسفي} \ {اسم الملف} <br></td><td>  المسار المستخدم من قبل أداة تحميل التشغيل لرسو السفن في النظام <br></td></tr></tbody></table></div><br><h2 style=";text-align:right;direction:rtl">  الملف الشخصي الدخيل </h2><br>  بفضل بيانات المصادقة "السلكية" ، تمكنا من الوصول إلى مركز القيادة. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/nq/q0/eb/nqq0ebtlfljriwj4m-97hm7-aww.png"></div><br>  هذا سمح لنا بتحديد البريد النهائي للمهاجمين: <br><br>  <b>junaid [.] في *** @ gmail [.] com</b> . <br><br>  يتم تسجيل اسم مجال مركز القيادة في <b>sg *** @ gmail [.] Com</b> . <br><br><h2 style=";text-align:right;direction:rtl">  استنتاج </h2><br>  في سياق تحليل مفصل للبرامج الضارة المستخدمة في الهجوم ، تمكنا من إنشاء وظائفه والحصول على قائمة أشمل من مؤشرات التسوية ذات الصلة بهذه الحالة.  إن فهم آليات تفاعل شبكة malvari جعل من الممكن تقديم توصيات بشأن ضبط تشغيل أدوات حماية المعلومات ، وكذلك كتابة قواعد IDS مستقرة. <br><br>  يتمثل الخطر الرئيسي لـ <b>AgentTesla</b> كـ DataStealer في أنه من أجل القيام بمهامه ، فإنه لا يحتاج إلى إجراء تثبيت في النظام أو انتظار أمر تحكم.  بمجرد تشغيل الجهاز ، يبدأ على الفور في جمع المعلومات الخاصة ونقلها إلى CnC.  يشبه هذا السلوك العدواني إلى حد ما سلوك أجهزة التشفير ، مع وجود الفرق الوحيد في أن الأخير لا يحتاج حتى إلى اتصال الشبكة.  في حالة حدوث تصادم مع هذه العائلة بعد تنظيف النظام المصاب من البرامج الضارة نفسها ، من الضروري تغيير جميع كلمات المرور التي يمكن تخزينها نظريًا على الأقل في أحد التطبيقات المذكورة أعلاه. <br><br>  بالنظر إلى المستقبل ، دعنا نقول أن المهاجمين الذين يرسلون <b>AgentTesla</b> غالبًا ما <b>يقومون</b> بتغيير أداة تحميل التشغيل الأولية.  هذا يسمح لك بالمرور دون أن يلاحظها أحد من قبل الماسحات الضوئية الثابتة والمحللات الإرشادية في وقت الهجوم.  وميل هذه العائلة للبدء في نشاطها على الفور يجعل النظام يراقب عديمة الفائدة.  أفضل طريقة للتعامل مع AgentTesla هي تحليل أولي في صندوق الحماية. <br><br>  في المقالة الثالثة من هذه السلسلة ، سننظر إلى محمل الإقلاع الأخرى المستخدمة من قِبل <b>AgentTesla</b> ، <b>ونتعرف</b> أيضًا على عملية <b>تفريغها</b> شبه التلقائي.  لا تفوت! <br><br><h2 style=";text-align:right;direction:rtl">  مزيج </h2><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <strong>SHA1</strong> <br></td></tr><tr><td>  A8C2765B3D655BA23886D663D22BDD8EF6E8E894 <br></td></tr><tr><td>  8010CC2AF398F9F951555F7D481CE13DF60BBECF <br></td></tr><tr><td>  79B445DE923C92BF378B19D12A309C0E9C5851BF <br></td></tr><tr><td>  15839B7AB0417FA35F2858722F0BD47BDF840D62 <br></td></tr><tr><td>  1C981EF3EEA8548A30E8D7BF8D0D61F9224288DD <br></td></tr></tbody></table></div><br><h2 style=";text-align:right;direction:rtl">  C &amp; C </h2><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <strong>URL</strong> <br></td></tr><tr><td>  sina-c0m [.] ICU <br></td></tr><tr><td>  smtp [.] sina-c0m [.] ICU <br></td></tr></tbody></table></div><br><br><h2 style=";text-align:right;direction:rtl">  RegKey </h2><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <strong>سجل</strong> <br></td></tr><tr><td>  HKCU \ البرامج \ Microsoft \ Windows \ CurrentVersion \ Run \ {Script Name} <br></td></tr><tr><td>  HKCU \ البرامج \ Microsoft \ Windows \ CurrentVersion \ Run \٪ insregname٪ <br></td></tr><tr><td>  HKCU \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Explorer \ StartupAppro \ Run \٪ insregname٪ <br></td></tr></tbody></table></div><br><h3 style=";text-align:right;direction:rtl">  مزامنة </h3><br>  لا توجد مؤشرات. <br><br><h3 style=";text-align:right;direction:rtl">  ملفات </h3><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <strong>نشاط الملف</strong> <br></td></tr><tr><td>  ٪ Temp٪ \ temp.tmp <br></td></tr><tr><td>  ٪ startupfolder٪ \٪ insfolder٪ \٪ insname٪ <br></td></tr><tr><td>  ٪ Temp٪ \ tmpG \ {الوقت الحالي بالمللي ثانية} .tmp <br></td></tr><tr><td>  ٪ Temp٪ \ log.tmp <br></td></tr><tr><td>  ٪ AppData٪ \ {التسلسل التعسفي المكون من 10 أحرف} .jpeg <br></td></tr><tr><td>  C: \ Users \ Public \ {تسلسل تعسفي من 10 أحرف} .vbs <br></td></tr><tr><td>  ٪ Temp٪ \ {اسم المجلد التعسفي} \ {اسم الملف} <br></td></tr></tbody></table></div><br><h2 style=";text-align:right;direction:rtl">  عينات من المعلومات </h2><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <strong>اسم</strong> <br></td><td>  غير معروف <br></td></tr><tr><td>  <strong>MD5</strong> <br></td><td>  F7722DD8660B261EA13B710062B59C43 <br></td></tr><tr><td>  <strong>SHA1</strong> <br></td><td>  15839B7AB0417FA35F2858722F0BD47BDF840D62 <br></td></tr><tr><td>  <strong>SHA256</strong> <br></td><td>  41DC0D5459F25E2FDCF8797948A7B315D3CB0753 <br>  98D808D1772CACCC726AF6E9 <br></td></tr><tr><td>  <strong>نوع</strong> <br></td><td>  PE (.NET) <br></td></tr><tr><td>  <strong>حجم</strong> <br></td><td>  327680 <br></td></tr><tr><td>  <strong>OrginalName</strong> <br></td><td>  AZZRIDKGGSLTYFUBCCRRCUMRKTOXFVPDKGAGPUZI_20190701133545943.exe <br></td></tr><tr><td>  <strong>تاريخ الختم</strong> <br></td><td>  2019/01/07 <br></td></tr><tr><td>  <strong>مترجم</strong> <br></td><td>  VB.NET <br></td></tr></tbody></table></div><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <strong>اسم</strong> <br></td><td>  IELibrary.dll <br></td></tr><tr><td>  <strong>MD5</strong> <br></td><td>  BFB160A89F4A607A60464631ED3ED9FD <br></td></tr><tr><td>  <strong>SHA1</strong> <br></td><td>  1C981EF3EEA8548A30E8D7BF8D0D61F9224288DD <br></td></tr><tr><td>  <strong>SHA256</strong> <br></td><td>  D55800A825792F55999ABDAD199DFA54F3184417 <br>  215A298910F2C12CD9CC31EE <br></td></tr><tr><td>  <strong>نوع</strong> <br></td><td>  PE (.NET DLL) <br></td></tr><tr><td>  <strong>حجم</strong> <br></td><td>  16896 <br></td></tr><tr><td>  <strong>OrginalName</strong> <br></td><td>  IELibrary.dll <br></td></tr><tr><td>  <strong>تاريخ الختم</strong> <br></td><td>  2016/10/11 <br></td></tr><tr><td>  <strong>مترجم</strong> <br></td><td>  Microsoft Linker (48.0 *) <br></td></tr></tbody></table></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar479120/">https://habr.com/ru/post/ar479120/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar479100/index.html">دوجو الأمامية: مشاريع لمهارات مطور التدريب (5 جديد + 43 سنة)</a></li>
<li><a href="../ar479102/index.html">التعرف على Yandex.Maps أو كم أحب الوثائق</a></li>
<li><a href="../ar479106/index.html">كم تكلفة الحيل السحرية</a></li>
<li><a href="../ar479108/index.html">حياة فارس - الساحة على الإنترنت مع عناصر آر بي جي</a></li>
<li><a href="../ar479116/index.html">مرات الظهور عند البحث Y. Direct: لماذا تدفع أكثر 1.5 مرة لكل نقرة</a></li>
<li><a href="../ar479122/index.html">كيفية البدء في مشروع الحيوانات الأليفة وعدم الحصول على فوائد</a></li>
<li><a href="../ar479124/index.html">الذكاء الاصطناعي في الخيال العلمي</a></li>
<li><a href="../ar479126/index.html">بيثون في تطوير المحمول</a></li>
<li><a href="../ar479128/index.html">كيف تعمل الخدمة الطبية في المطار</a></li>
<li><a href="../ar479132/index.html">مكون خارجي لمنصة Mobile 1C (BroadcastReceiver)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>