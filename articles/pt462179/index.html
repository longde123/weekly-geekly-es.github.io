<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎰 👼🏻 🧔 F-strings ou como tornar o código um pouco mais rápido e mais legível 👩🏻‍🎓 📟 🙎🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O Python tem três maneiras de formatar strings, e uma delas é melhor que as outras. Mas não vamos nos antecipar - de que tipo de formatação estamos fa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>F-strings ou como tornar o código um pouco mais rápido e mais legível</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462179/"><img src="https://habrastorage.org/webt/mq/77/12/mq7712kpaxqkzvpwfsor7b6cjbw.jpeg"><br><br>  O Python tem três maneiras de formatar strings, e uma delas é melhor que as outras.  Mas não vamos nos antecipar - de que tipo de formatação estamos falando?  Toda vez que queremos cumprimentar um usuário pelo nome, precisamos inserir uma sequência com um nome na sequência do modelo.  As entradas de log mais úteis também contêm valores variáveis.  E aqui está um exemplo: <br><br><pre><code class="python hljs">integer = <span class="hljs-number"><span class="hljs-number">42</span></span> string = <span class="hljs-string"><span class="hljs-string">'FORTY_TWO'</span></span> print(<span class="hljs-string"><span class="hljs-string">'string number %s, or simply %d'</span></span> % (string, integer)) print(<span class="hljs-string"><span class="hljs-string">'string number {}, or simply {}'</span></span>.format(string, integer)) print(<span class="hljs-string"><span class="hljs-string">f'string number </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{string}</span></span></span><span class="hljs-string">, or simply </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{integer}</span></span></span><span class="hljs-string">'</span></span>)</code> </pre> <br>  O primeiro método, formatado com o operador%, veio no Python do C - imita a função printf.  Esse método foi o primeiro no python e continua sendo o único (discutido no artigo) no Python versão 2.5 e abaixo. <br><br>  A segunda maneira é o método str.format, que pertence à classe de string interna.  Ele veio com o Python 3.0 e foi portado para a versão 2.6.  Este método foi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">recomendado</a> por ter uma sintaxe mais rica. <br><br>  O terceiro método, f-string, apareceu no Python versão 3.6.  Conforme explicado no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PEP-0498</a> , a criação de uma nova maneira de formatar seqüências de caracteres foi motivada pelas deficiências dos métodos existentes, que os autores caracterizam como propensos a erros, não são flexíveis o suficiente e não são elegantes: <br><blockquote>  Esse PEP é impulsionado pelo desejo de ter uma maneira mais simples de formatar seqüências de caracteres em Python.  As formas de formatação existentes são propensas a erros, inflexíveis ou complicadas. </blockquote>  Portanto, temos três maneiras de resolver um problema.  Mas talvez isso seja uma questão de gosto e preferência pessoal?  Talvez, mas o estilo do seu código (especialmente o código em um projeto com um grande número de participantes) se beneficiará definitivamente da uniformidade.  Na melhor das hipóteses, você deve usar um método de formatação de seqüências de caracteres, e a leitura do código será mais fácil.  Mas qual método escolher?  E existe uma diferença no desempenho do código? <br><a name="habracut"></a><br>  Vamos tentar responder à pergunta sobre desempenho experimentalmente: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> timeit setup = <span class="hljs-string"><span class="hljs-string">""" integer = 42 string = 'FORTY_TWO' """</span></span>.strip() percent_stmt =<span class="hljs-string"><span class="hljs-string">"'Number %s or simply %d' % (string, integer)"</span></span> call_stmt = <span class="hljs-string"><span class="hljs-string">"'Number {} or simply {}'.format(string, integer)"</span></span> fstr_stmt = <span class="hljs-string"><span class="hljs-string">"""f'Number {string} or simply {integer}'"""</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(stmt)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">f"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{timeit.timeit(stmt, setup, number=int(</span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">1e7</span></span></span></span><span class="hljs-string"><span class="hljs-subst">)):</span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">.3</span></span></span></span><span class="hljs-string"><span class="hljs-subst">f}</span></span></span><span class="hljs-string">"</span></span> print(<span class="hljs-string"><span class="hljs-string">f"Timing percent formating: | </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{time(percent_stmt)}</span></span></span><span class="hljs-string">"</span></span>) print(<span class="hljs-string"><span class="hljs-string">f"Timing call formating: | </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{time(call_stmt)}</span></span></span><span class="hljs-string">"</span></span>) print(<span class="hljs-string"><span class="hljs-string">f"Timing f-string formating: | </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{time(fstr_stmt)}</span></span></span><span class="hljs-string">"</span></span>)</code> </pre> <br>  Resultados no MacBook com Python 3.7: <br><br><pre> <code class="plaintext hljs">Timing percent formating: | 2.025 Timing call formating: | 2.943 Timing f-string formating: | 1.348</code> </pre> <br>  A diferença é significativa.  Então agora, execute a pesquisa regex em ".format" e reescreva centenas de expressões?  Em princípio, a tarefa é simples, mas demorada.  Mais a chance de cometer um erro e colocar um bug no código que estava funcionando anteriormente!  Parece haver espaço para automação.  De fato, existem bibliotecas que podem converter a maioria das expressões em strings: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">flynt</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pyupgrade</a> . <br><br>  Flynt é fácil de usar.  Por exemplo, execute a conversão no código-fonte do balão: <br><br><pre> <code class="plaintext hljs">38f9d3a65222:~ ikkamens$ git clone https://github.com/pallets/flask.git Cloning into 'flask'... ... Resolving deltas: 100% (12203/12203), done. 38f9d3a65222:~ ikkamens$ flynt flask Flynt run has finished. Stats: Execution time: 0.623s Files modified: 18 Expressions transformed: 43 Character count reduction: 241 (0.04%) _-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_. Please run your tests before commiting. Report bugs as github issues at: https://github.com/ikamensh/flynt Thank you for using flynt! Fstringify more projects and recommend it to your colleagues! _-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_. 38f9d3a65222:~ ikkamens$</code> </pre> <br>  Também é importante destacar a possibilidade de converter expressões que ocupam várias linhas e coletar estatísticas sobre as alterações feitas.  O sinalizador --line_length XX define o limite de comprimento da linha após a conversão.  Flynt permite chamar pyupgrade com o sinalizador --upgrade. <br><br>  O Pyupgrade inclui mais funcionalidades e pode limpar seu código de muitos artefatos do Python 2 - como herdar de objetos, especificar nomes de classes em super e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">muito mais</a> .  O Pyupgrade foi desenvolvido para uso com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pré-confirmação</a> , um utilitário para modificar automaticamente o código antes da confirmação. <br><br>  É melhor converter a fonte em um gita ou outro controle de versão.  Vale a pena executar testes e analisar as alterações você mesmo (usando ambientes git diff ou PyCharm).  Enquanto estivermos vivos entre os que se importam, que o código se tornou um par de caracteres mais curto, a conversão proativa também economizará seu tempo.  Afinal, mais cedo ou mais tarde alguém começará a fazer com as mãos o que pode ser transformado em um utilitário.  As strings F funcionam apenas no Python 3.6+, mas em breve isso não será um problema, já que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">outras versões se tornarão obsoletas</a> . <br><br>  Vale a pena notar que o método .format clássico não funcionará completamente.  No caso em que você use o mesmo modelo para criar mensagens com variáveis ​​diferentes em lugares diferentes do código, salve esse modelo em uma variável e use-o - o princípio "Não se repita" é muito mais importante do que ganhar nanossegundos na formatação de uma string. <br><br>  Conclusões: <br><br>  Analisamos os três métodos de formatação de strings disponíveis no Python 3.6+, seu breve histórico e comparamos seu desempenho.  Também examinamos as ferramentas de código aberto para converter automaticamente código em um novo método para formatar seqüências de caracteres e suas funções adicionais.  Não esqueça as coisas simples do seu código e boa sorte! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt462179/">https://habr.com/ru/post/pt462179/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt462169/index.html">Resumo de notícias de aprendizado de máquina e inteligência artificial de julho</a></li>
<li><a href="../pt462171/index.html">Visualização SCADA para projetos de IoT [Biblioteca Livre]</a></li>
<li><a href="../pt462173/index.html">Conferências. Resultados intermediários do primeiro semestre de 2019</a></li>
<li><a href="../pt462175/index.html">Lidamos com abreviações e frases em latim em inglês</a></li>
<li><a href="../pt462177/index.html">Visita fotográfica ao Museu Mineralógico com o nome de Fersman</a></li>
<li><a href="../pt462181/index.html">Regras para comunicação eficaz em bate-papos em grupo</a></li>
<li><a href="../pt462185/index.html">A revolução acabou. Existe uma alternativa para uma bateria de íons de lítio?</a></li>
<li><a href="../pt462189/index.html">Gravando dados com travajs</a></li>
<li><a href="../pt462191/index.html">DataArt Museum: um passeio pelo norte da Itália</a></li>
<li><a href="../pt462197/index.html">Dicas sobre como libertar sua mente e aumentar sua criatividade</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>