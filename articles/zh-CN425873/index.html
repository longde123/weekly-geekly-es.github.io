<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>âï¸ ğŸ‘ğŸ¾ â¯ï¸ [CppCon 2018] Herb Sutterï¼šè¿ˆå‘æ›´ç®€å•ï¼Œæ›´å¼ºå¤§çš„C ++ ğŸ ğŸ¤¸ ğŸ¤ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨2018å¹´CppConå¤§ä¼šä¸Šçš„æ¼”è®²ä¸­ï¼ŒHerb Sutteråœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šå‘å…¬ä¼—å±•ç¤ºäº†ä»–çš„æˆå°±ã€‚ é¦–å…ˆï¼Œå®ƒæ˜¯å˜é‡ç”Ÿå­˜æœŸçš„æ§åˆ¶ ï¼ˆLifetimeï¼‰ï¼Œå®ƒå…è®¸åœ¨ç¼–è¯‘é˜¶æ®µæ£€æµ‹æ•´ä¸ªbugç±»ã€‚ å…¶æ¬¡ï¼Œè¿™æ˜¯æœ‰å…³å…ƒç±»çš„æ›´æ–°å»ºè®®ï¼Œä¸€æ—¦æè¿°äº†ç±»ç±»åˆ«çš„è¡Œä¸ºï¼Œç„¶åç”¨ä¸€è¡Œå°†å…¶è¿æ¥åˆ°ç‰¹å®šç±»ï¼Œå°±å¯ä»¥é¿å…ä»£ç é‡å¤ã€‚ 
 å‰è¨€ï¼šæ›´...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>[CppCon 2018] Herb Sutterï¼šè¿ˆå‘æ›´ç®€å•ï¼Œæ›´å¼ºå¤§çš„C ++</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425873/"><iframe width="560" height="315" src="https://www.youtube.com/embed/80BZxujhY38" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>åœ¨2018å¹´CppConå¤§ä¼šä¸Šçš„æ¼”è®²ä¸­ï¼ŒHerb Sutteråœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šå‘å…¬ä¼—å±•ç¤ºäº†ä»–çš„æˆå°±ã€‚ é¦–å…ˆï¼Œå®ƒæ˜¯å˜é‡<strong>ç”Ÿå­˜æœŸ</strong>çš„<strong>æ§åˆ¶</strong> ï¼ˆLifetimeï¼‰ï¼Œå®ƒå…è®¸åœ¨ç¼–è¯‘é˜¶æ®µæ£€æµ‹æ•´ä¸ªbugç±»ã€‚ å…¶æ¬¡ï¼Œè¿™æ˜¯æœ‰å…³<strong>å…ƒç±»</strong>çš„æ›´æ–°å»ºè®®ï¼Œä¸€æ—¦æè¿°äº†ç±»ç±»åˆ«çš„è¡Œä¸ºï¼Œç„¶åç”¨ä¸€è¡Œå°†å…¶è¿æ¥åˆ°ç‰¹å®šç±»ï¼Œå°±å¯ä»¥é¿å…ä»£ç é‡å¤ã€‚ </p><a name="habracut"></a><br><h2 id="predislovie-bolshe--prosche"> å‰è¨€ï¼šæ›´å¤š=æ›´å®¹æ˜“ï¼Ÿ </h2><br><p> å¬åˆ°C ++çš„æŒ‡æ§ï¼Œè¯¥æ ‡å‡†æ­£åœ¨æ¯«æ— æ„ä¹‰å’Œæ®‹é…·åœ°å¢é•¿ã€‚ ä½†æ˜¯ï¼Œå³ä½¿æ˜¯æœ€çƒ­å¿ƒçš„ä¿å®ˆæ´¾ä¹Ÿä¸ä¼šè®¤ä¸ºrange-forï¼ˆæ”¶é›†å‘¨æœŸï¼‰å’Œautoï¼ˆè‡³å°‘å¯¹äºè¿­ä»£å™¨ï¼‰è¿™æ ·çš„æ–°æ„é€ ä¼šä½¿ä»£ç æ›´ç®€å•ã€‚ æ‚¨å¯ä»¥åˆ¶å®šï¼ˆè‡³å°‘ä¸€ç§ï¼Œæœ€å¥½æ˜¯å…¨éƒ¨ï¼‰æ–°è¯­è¨€æ‰©å±•å¿…é¡»æ»¡è¶³çš„è¿‘ä¼¼æ ‡å‡†ï¼Œä»¥ç®€åŒ–å®è·µä¸­çš„ä»£ç ï¼š </p><br><ol><li> å‡å°‘ï¼Œç®€åŒ–ä»£ç ï¼Œåˆ é™¤é‡å¤çš„ä»£ç ï¼ˆèŒƒå›´ï¼Œè‡ªåŠ¨ï¼Œlambdaï¼Œå…ƒç±»ï¼‰ </li><li> ä½¿å®‰å…¨ä»£ç æ›´æ˜“äºç¼–å†™ï¼Œé˜²æ­¢å‡ºç°é”™è¯¯å’Œç‰¹æ®Šæƒ…å†µï¼ˆæ™ºèƒ½æŒ‡é’ˆï¼Œç”Ÿå‘½å‘¨æœŸï¼‰ </li><li> å®Œå…¨æ›¿æ¢æ—§çš„ï¼ŒåŠŸèƒ½è¾ƒå°‘çš„åŠŸèƒ½ï¼ˆtypedefâ†’ä½¿ç”¨ï¼‰ </li></ol><br><p>  Herb Sutterè¯†åˆ«â€œç°ä»£C ++â€-ç¬¦åˆç°ä»£ç¼–ç æ ‡å‡†ï¼ˆä¾‹å¦‚<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">C ++æ ¸å¿ƒå‡†åˆ™</a> ï¼‰çš„åŠŸèƒ½çš„å­é›†ï¼Œå¹¶å°†å®Œæ•´æ ‡å‡†è§†ä¸ºæ¯ä¸ªäººéƒ½ä¸éœ€è¦çŸ¥é“çš„â€œå…¼å®¹æ¨¡å¼â€ã€‚ å› æ­¤ï¼Œå¦‚æœâ€œç°ä»£C ++â€æ²¡æœ‰å¢é•¿ï¼Œé‚£ä¹ˆä¸€åˆ‡éƒ½å¾ˆå¥½ã€‚ </p><br><h2 id="proverki-vremeni-zhizni-peremennyh-lifetime"> æ£€æŸ¥å˜é‡çš„ç”Ÿå‘½å‘¨æœŸï¼ˆç”Ÿå‘½å‘¨æœŸï¼‰ </h2><br><p> ç°åœ¨ï¼Œæ–°çš„ç»ˆèº«éªŒè¯ç»„å¯ä½œä¸ºClangå’ŒVisual C ++çš„æ ¸å¿ƒå‡†åˆ™æ£€æŸ¥å™¨çš„ä¸€éƒ¨åˆ†ã€‚ ç›®æ ‡ä¸æ˜¯è¦åƒRustä¸­é‚£æ ·è¾¾åˆ°ç»å¯¹çš„ä¸¥æ ¼æ€§å’Œå‡†ç¡®æ€§ï¼Œè€Œæ˜¯è¦åœ¨å„ä¸ªåŠŸèƒ½å†…æ‰§è¡Œç®€å•è€Œå¿«é€Ÿçš„æ£€æŸ¥ã€‚ </p><br><h3 id="osnovnye-principy-proverki"> éªŒè¯çš„åŸºæœ¬åŸåˆ™ </h3><br><p> ä»ç”Ÿå‘½å‘¨æœŸåˆ†æçš„è§’åº¦æ¥çœ‹ï¼Œç±»å‹åˆ†ä¸ºä¸‰ç±»ï¼š </p><br><ul><li> è¯¥å€¼æ˜¯æŒ‡é’ˆå¯ä»¥æŒ‡å‘çš„å€¼ã€‚ </li><li>æŒ‡é’ˆ-æŒ‡å€¼ï¼Œä½†ä¸æ§åˆ¶å…¶å¯¿å‘½ã€‚ å¯èƒ½ä¼šæŒ‚ï¼ˆæ‚¬ç©ºçš„æŒ‡é’ˆï¼‰ã€‚ ç¤ºä¾‹ï¼š <code>T*</code> ï¼Œ <code>T&amp;</code> ï¼Œè¿­ä»£å™¨ï¼Œ <code>std::observer_ptr&lt;T&gt;</code> ï¼Œ <code>std::string_view</code> ï¼Œ <code>gsl::span&lt;T&gt;</code> </li><li> æ‰€æœ‰è€…-æ§åˆ¶ä»·å€¼çš„æœ‰æ•ˆæœŸã€‚ é€šå¸¸å¯ä»¥æå‰åˆ é™¤å…¶å€¼ã€‚ ä¾‹å¦‚ï¼š <code>std::unique_ptr&lt;T&gt;</code> ï¼Œ <code>std::shared_ptr&lt;T&gt;</code> ï¼Œ <code>std::vector&lt;T&gt;</code> ï¼Œ <code>std::string</code> ï¼Œ <code>gsl::owner&lt;T*&gt;</code> </li></ul><br><p> æŒ‡é’ˆå¯ä»¥å¤„äºä»¥ä¸‹çŠ¶æ€ä¹‹ä¸€ï¼š </p><br><ul><li> æŒ‡å‘å­˜å‚¨åœ¨å †æ ˆä¸­çš„å€¼ </li><li> æŒ‡å‘æŸä¸ªæ‰€æœ‰è€…â€œå†…éƒ¨â€åŒ…å«çš„å€¼ </li><li> ä¸ºç©ºï¼ˆç©ºï¼‰ </li><li> æŒ‚èµ·ï¼ˆæ— æ•ˆï¼‰ </li></ul><br><h3 id="ukazateli-i-znacheniya"> æŒ‡æ ‡ä¸ä»·å€¼ </h3><br><p> å¯¹äºæ¯ä¸ªæŒ‡é’ˆ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="1.817ex" viewBox="-38.5 -520.7 542 782.1" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-70" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> p </script> è¢«è¿½è¸ª <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">t</span><span class="MJXp-mrow" id="MJXp-Span-8"><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼ˆ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">p</span><span class="MJXp-mrow" id="MJXp-Span-11"><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼‰</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.297ex" height="2.419ex" viewBox="-38.5 -780.1 4003 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-73" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-65" x="973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-74" x="1439" y="0"></use><g transform="translate(1801,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">ï¼ˆ</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-70" x="2630" y="0"></use><g transform="translate(3134,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">ï¼‰</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-2"> psetï¼ˆpï¼‰</script>  -å®ƒå¯èƒ½æŒ‡ç¤ºçš„ä¸€ç»„å€¼ã€‚ åˆ é™¤å€¼æ—¶ï¼Œå®ƒåœ¨æ‰€æœ‰å€¼ä¸­éƒ½å‡ºç° <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.272ex" height="2.298ex" viewBox="-38.5 -728.2 1839.5 989.6" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-73" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-65" x="973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-74" x="1439" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> pset </script> æ›¿æ¢ä¸º <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-18"><span class="MJXp-mrow" id="MJXp-Span-19"><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0.278em; margin-right: 0.278em;">æ— </span></span><span class="MJXp-mrow" id="MJXp-Span-21"><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0.278em; margin-right: 0.278em;">æ•ˆ</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.855ex" height="2.298ex" viewBox="0 -780.1 1660 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">æ— </text><g transform="translate(829,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">æ•ˆ</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-4">æ— æ•ˆ</script>  ã€‚ è®¿é—®æŒ‡é’ˆå€¼æ—¶ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-23"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="1.817ex" viewBox="-38.5 -520.7 542 782.1" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-70" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> p </script> è¿™æ · <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-25"><span class="MJXp-mrow" id="MJXp-Span-26"><span class="MJXp-mo" id="MJXp-Span-27" style="margin-left: 0.278em; margin-right: 0.278em;">æ— </span></span><span class="MJXp-mrow" id="MJXp-Span-28"><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0.278em; margin-right: 0.278em;">æ•ˆ</span></span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0.333em; margin-right: 0.333em;">âˆˆ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">t</span><span class="MJXp-mrow" id="MJXp-Span-35"><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼ˆ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">p</span><span class="MJXp-mrow" id="MJXp-Span-38"><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼‰</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.904ex" height="2.419ex" viewBox="0 -780.1 6847.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">æ— </text><g transform="translate(829,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">æ•ˆ</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMAIN-2208" x="1937" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-70" x="2883" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-73" x="3386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-65" x="3856" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-74" x="4322" y="0"></use><g transform="translate(4684,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">ï¼ˆ</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-70" x="5514" y="0"></use><g transform="translate(6017,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">ï¼‰</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-6">æ— æ•ˆâˆˆpsetï¼ˆpï¼‰</script> å‘å‡ºé”™è¯¯ã€‚ </p><br><pre> <code class="cpp hljs">string_view s; <span class="hljs-comment"><span class="hljs-comment">// pset(s) = {null} { char a[100]; s = a; // pset(s) = {a} cout &lt;&lt; s[0]; // OK } // pset(s) = {invalid} cout &lt;&lt; s[0]; // ERROR: invalid âˆˆ pset(s)</span></span></code> </pre> <br><p> ä½¿ç”¨æ³¨é‡Šï¼Œå¯ä»¥é…ç½®å°†å“ªäº›æ“ä½œè§†ä¸ºè®¿é—®å€¼çš„æ“ä½œã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼š <code>*</code> ï¼Œ <code>-&gt;</code> ï¼Œ <code>[]</code> ï¼Œ <code>begin()</code> ï¼Œ <code>end()</code> ã€‚ </p><br><p> è¯·æ³¨æ„ï¼Œè­¦å‘Šä»…åœ¨<em>è®¿é—®</em>æ— æ•ˆç´¢å¼•æ—¶å‘å‡ºã€‚ å¦‚æœâ€œå€¼â€è¢«åˆ é™¤ï¼Œä½†æ²¡æœ‰äººè®¿é—®è¿‡è¯¥æŒ‡é’ˆï¼Œåˆ™ä¸€åˆ‡æ­£å¸¸ã€‚ </p><br><h3 id="ukazateli-i-vladelcy"> è·¯æ ‡å’Œæ‰€æœ‰è€… </h3><br><p> å¦‚æœæŒ‡é’ˆ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-40"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="1.817ex" viewBox="-38.5 -520.7 542 782.1" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-70" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> p </script> æŒ‡ç¤ºæ‰€æœ‰è€…ä¸­åŒ…å«çš„å€¼ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-42"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">o</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.128ex" height="1.455ex" viewBox="0 -520.7 485.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/425873/&amp;usg=ALkJrhg3lNPDGnz-P0KPEvW5JLcCDOIg3w#MJMATHI-6F" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> o </script> ç„¶åè¿™ä¸ª <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-44"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">t</span><span class="MJXp-mrow" id="MJXp-Span-49"><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼ˆ</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">p</span><span class="MJXp-mrow" id="MJXp-Span-52"><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0.278em; margin-right: 0.278em;">ï¼‰</span></span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-55"><span class="MJXp-msup" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57" style="margin-right: 0.05em;">o</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-58" style="vertical-align: 0.5em;">â€²</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> psetï¼ˆpï¼‰= {o'} </script>  ã€‚ </p><br><p> æ‹¥æœ‰è€…çš„æ–¹æ³•å’ŒåŠŸèƒ½åˆ†ä¸ºï¼š </p><br><ul><li> æ‰€æœ‰è€…ä»·å€¼è®¿é—®æ“ä½œã€‚ é»˜è®¤å€¼ï¼š <code>*</code> ï¼Œ <code>-&gt;</code> ï¼Œ <code>[]</code> ï¼Œ <code>begin()</code> ï¼Œ <code>end()</code> </li><li> å¯¹æ‰€æœ‰è€…æœ¬èº«çš„è®¿é—®æ“ä½œï¼Œ <code>v.clear()</code>æŒ‡é’ˆï¼Œå¦‚<code>v.clear()</code> ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº›æ˜¯æ‰€æœ‰å…¶ä»–éå¸¸é‡æ“ä½œ </li><li> å¯¹æ‰€æœ‰è€…æœ¬èº«ï¼ˆéæ— æ•ˆæŒ‡é’ˆ<code>v.empty()</code>è®¿é—®æ“ä½œï¼Œä¾‹å¦‚<code>v.empty()</code> ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº›éƒ½æ˜¯constæ“ä½œã€‚ </li></ul><br><p> æ—§å†…å®¹æ‰€æœ‰è€…å®£å¸ƒ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-59"><span class="MJXp-mrow" id="MJXp-Span-60"><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0.278em; margin-right: 0.278em;">æ— </span></span><span class="MJXp-mrow" id="MJXp-Span-62"><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0.278em; margin-right: 0.278em;">æ•ˆ</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10">æ— æ•ˆ</script> ç§»èµ°æ‰€æœ‰è€…æˆ–åº”ç”¨æ— æ•ˆæ“ä½œåã€‚ </p><br><p> è¿™äº›è§„åˆ™è¶³ä»¥æ£€æµ‹C ++ä»£ç ä¸­çš„è®¸å¤šå…¸å‹é”™è¯¯ï¼š </p><br><pre> <code class="cpp hljs">string_view s; <span class="hljs-comment"><span class="hljs-comment">// pset(s) = {null} string name = "foo"; s = name; // pset(s) = {name'} cout &lt;&lt; s[0]; // OK name = "bar"; // pset(s) = {invalid} cout &lt;&lt; s[0]; // ERROR</span></span></code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; v = get_ints(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>* p = &amp;v[<span class="hljs-number"><span class="hljs-number">5</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// pset(p) = {v'} v.push_back(42); // pset(p) = {invalid} cout &lt;&lt; *p; // ERROR</span></span></code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::string_view s = <span class="hljs-string"><span class="hljs-string">"foo"</span></span>s; <span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; s[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// ERROR // :       std::string_view s = "foo"s // pset(s) = {"foo"s '} ; // pset(s) = {invalid}</span></span></code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; v = get_ints(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> i = v.begin(); i != v.end(); ++i) { <span class="hljs-comment"><span class="hljs-comment">// pset(i) = {v'} if (*i == 2) { v.erase(i); // pset(i) = {invalid} } // pset(i) = {v', invalid} } // ERROR: ++i for (auto i = v.begin(); i != v.end(); ) { if (*i == 2) i = v.erase(i); // OK else ++i; }</span></span></code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::optional&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;&gt; get_data(); <span class="hljs-comment"><span class="hljs-comment">//   ,  get_data() != nullopt for (int value : *get_data()) // ERROR cout &lt;&lt; value; // *get_data() â€”     for (int value : std::vector&lt;int&gt;(*get_data())) // OK cout &lt;&lt; value;</span></span></code> </pre> <br><h3 id="otslezhivanie-vremeni-zhizni-parametrov-funkciy"> è·Ÿè¸ªåŠŸèƒ½å‚æ•°çš„å¯¿å‘½ </h3><br><p> å½“æˆ‘ä»¬å¼€å§‹ä½¿ç”¨C ++ä¸­çš„è¿”å›æŒ‡é’ˆçš„å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬åªèƒ½çŒœæµ‹å‚æ•°çš„ç”Ÿå­˜æœŸä¸è¿”å›å€¼ä¹‹é—´çš„å…³ç³»ã€‚ å¦‚æœä¸€ä¸ªå‡½æ•°æ¥å—å¹¶è¿”å›ç›¸åŒç±»å‹çš„Pointerï¼Œåˆ™å‡å®šè¯¥å‡½æ•°ä»è¾“å…¥å‚æ•°ä¹‹ä¸€â€œè·å–â€è¿”å›å€¼ï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">* p, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">* q)</span></span></span><span class="hljs-function"> -&gt; </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function">*</span></span>; <span class="hljs-comment"><span class="hljs-comment">// pset(ret) = {p', q'} auto g(std::string&amp; s) -&gt; char*; // pset(ret) = {s'}</span></span></code> </pre> <br><p> å¾ˆå®¹æ˜“æ£€æµ‹åˆ°å¯ç–‘å‡½æ•°ï¼Œè¿™äº›å‡½æ•°ä»æ— å¤„è·å¾—ç»“æœï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::reference_wrapper&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; get_data() { <span class="hljs-comment"><span class="hljs-comment">//    int i = 3; return {i}; // pset(ret) = {i'} } // pset(ret) = {invalid}</span></span></code> </pre> <br><p> ç”±äºå¯ä»¥å°†ä¸´æ—¶å€¼ä¼ é€’ç»™<code>const T&amp;</code>å‚æ•°ï¼Œå› æ­¤ä¸ä¼šè€ƒè™‘å®ƒä»¬ï¼Œé™¤éç»“æœæ— å¤„å¯å–ï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> T&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">min</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> T&amp; x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> T&amp; y)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">// pset(ret) = {x', y'} //    const T&amp;- //        auto x = 10, y = 2; auto&amp; bad = min(x, y + 1); // pset(bad) = {x, temp} // pset(bad) = {x, invalid} cout &lt;&lt; bad; // ERROR</span></span></code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> K = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> V = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> V&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find_or_default</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">map</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;K, V&gt;&amp; m, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> K&amp; key, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> V&amp; def)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">// pset(ret) = {m', key', def'} std::map&lt;K, V&gt; map; K key = "foo"; const V&amp; s = find_or_default(map, key, "none"); // pset(s) = {map', key', temp} â‡’ pset(s) = {map', key', invalid} cout &lt;&lt; s; // ERROR</span></span></code> </pre> <br><p> è¿˜å¯ä»¥ç›¸ä¿¡ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ªæŒ‡é’ˆï¼ˆè€Œä¸æ˜¯å¼•ç”¨ï¼‰ï¼Œåˆ™å®ƒå¯ä»¥æ˜¯nullptrï¼Œå¹¶ä¸”åœ¨ä¸nullptræ¯”è¾ƒä¹‹å‰ä¸èƒ½ä½¿ç”¨è¯¥æŒ‡é’ˆã€‚ </p><br><h3 id="zaklyuchenie-po-kontrolyu-vremeni-zhizni"> å¯¿å‘½æ§åˆ¶ç»“è®º </h3><br><p> æˆ‘å†è¯´ä¸€éï¼ŒLifetimeå¹¶ä¸æ˜¯é’ˆå¯¹C ++æ ‡å‡†çš„å»ºè®®ï¼Œè€Œæ˜¯å¤§èƒ†å°è¯•åœ¨C ++ä¸­å®ç°ç”Ÿå‘½å‘¨æœŸæ£€æŸ¥ï¼Œä¾‹å¦‚ï¼Œä¸Rustä¸åŒï¼Œé‚£é‡Œä»æ¥æ²¡æœ‰ç›¸åº”çš„æ³¨é‡Šã€‚ æœ€åˆï¼Œä¼šæœ‰å¾ˆå¤šè¯¯æŠ¥ï¼Œä½†éšç€æ—¶é—´çš„æµé€ï¼Œå¯å‘å¼æ–¹æ³•å°†ä¸æ–­å®Œå–„ã€‚ </p><br><h3 id="voprosy-iz-zala"> å¬ä¼—çš„æé—® </h3><br><p>  <strong>ç”Ÿå‘½å‘¨æœŸç»„æ£€æŸ¥æ˜¯å¦æä¾›æ•°å­¦ä¸Šå‡†ç¡®çš„ä¿è¯ï¼Œç¡®ä¿æ²¡æœ‰æ‚¬ç©ºçš„æŒ‡é’ˆï¼Ÿ</strong> </p><br><p> ä»ç†è®ºä¸Šè®²ï¼Œæœ‰å¯èƒ½ï¼ˆåœ¨æ–°ä»£ç ä¸­ï¼‰åœ¨ç±»å’Œå‡½æ•°ä¸Šæ‚¬æŒ‚ä¸€å †æ³¨é‡Šï¼Œä½œä¸ºå›æŠ¥ï¼Œç¼–è¯‘å™¨å°†æä¾›æ­¤ç±»ä¿è¯ã€‚ ä½†æ˜¯è¿™äº›æ£€æŸ¥æ˜¯éµå¾ª80:20åŸåˆ™å¼€å‘çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å°‘é‡è§„åˆ™å¹¶åº”ç”¨æœ€å°‘çš„æ³¨é‡Šæ¥æ•è·å¤§å¤šæ•°é”™è¯¯ã€‚ </p><br><h2 id="metaklassy"> å…ƒç±» </h2><br><p> å…ƒç±»ä»¥æŸç§æ–¹å¼è¡¥å……äº†åº”ç”¨å®ƒçš„ç±»çš„ä»£ç ï¼Œå¹¶ä¸”è¿˜å……å½“æ»¡è¶³æŸäº›æ¡ä»¶çš„ä¸€ç»„ç±»çš„åç§°ã€‚ ä¾‹å¦‚ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ <code>interface</code>å…ƒç±»å°†ä½¿æ‰€æœ‰åŠŸèƒ½å…¬å¼€ï¼Œå¹¶ä¸”å¯¹æ‚¨è€Œè¨€å®Œå…¨æ˜¯è™šæ‹Ÿçš„ã€‚ </p><br><p> å»å¹´ï¼ŒHerb Sutterè¿›è¡Œäº†ä»–çš„ç¬¬ä¸€ä¸ªå…ƒç±»é¡¹ç›®ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯·å‚é˜…æ­¤å¤„</a> ï¼‰ã€‚ ä»é‚£æ—¶èµ·ï¼Œå½“å‰å»ºè®®çš„è¯­æ³•å·²æ›´æ”¹ã€‚ </p><br><p> é¦–å…ˆï¼Œä½¿ç”¨å…ƒç±»çš„è¯­æ³•å·²æ›´æ”¹ï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//  interface Shape { int area() const; void scale_by(double factor); }; //  class(interface) Shape { â€¦ }</span></span></code> </pre> <br><p> å®ƒå·²ç»å˜é•¿äº†ï¼Œä½†æ˜¯ç°åœ¨æœ‰ä¸€ç§è‡ªç„¶çš„è¯­æ³•å¯ä»¥ä¸€æ¬¡åº”ç”¨å‡ ä¸ªå…ƒç±»ï¼š <code>class(meta1, meta2)</code> ã€‚ </p><br><h3 id="opisanie-metaklassa"> å…ƒç±»æè¿° </h3><br><p> ä»¥å‰ï¼Œå…ƒç±»æ˜¯ç”¨äºä¿®æ”¹ç±»çš„ä¸€ç»„è§„åˆ™ã€‚ ç°åœ¨ï¼Œå…ƒç±»æ˜¯ä¸€ä¸ªconstexprå‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªæ—§ç±»ï¼ˆåœ¨ä»£ç ä¸­å£°æ˜ï¼‰å¹¶åˆ›å»ºä¸€ä¸ªæ–°ç±»ã€‚ </p><br><p> å³ï¼Œè¯¥å‡½æ•°é‡‡ç”¨ä¸€ä¸ªå‚æ•°-æœ‰å…³æ—§ç±»çš„å…ƒä¿¡æ¯ï¼ˆå‚æ•°çš„ç±»å‹å–å†³äºå®ç°ï¼‰ï¼Œåˆ›å»ºç±»å…ƒç´ ï¼ˆç‰‡æ®µï¼‰ï¼Œç„¶åä½¿ç”¨<code>__generate</code>æŒ‡ä»¤å°†å…¶æ·»åŠ åˆ°æ–°ç±»çš„ä¸»ä½“ä¸­ã€‚ </p><br><p> å¯ä»¥ä½¿ç”¨<code>__fragment</code> ï¼Œ <code>__inject</code>å’Œ<code>idexpr(â€¦)</code>æ„é€ ç”Ÿæˆç‰‡æ®µã€‚ å‘è¨€è€…å¸Œæœ›ä¸è¦ä¸“æ³¨äºä»–ä»¬çš„ç›®çš„ï¼Œå› ä¸ºåœ¨å°†å…¶æäº¤ç»™æ ‡å‡†åŒ–å§”å‘˜ä¼šä¹‹å‰ï¼Œè¿™éƒ¨åˆ†ä»ä¼šæ›´æ”¹ã€‚ åç§°æœ¬èº«ä¿è¯ä¼šè¢«æ›´æ”¹ï¼Œä¸“é—¨æ·»åŠ äº†åŒä¸‹åˆ’çº¿ä»¥æ¾„æ¸…è¿™ä¸€ç‚¹ã€‚ æŠ¥å‘Šä¸­çš„é‡ç‚¹æ˜¯æ›´è¿›ä¸€æ­¥çš„ä¾‹å­ã€‚ </p><br><h3 id="interface"> ä»‹é¢ </h3><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">interface</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T source)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// source    //     .     //  ~X,  X â€”   . __generate __fragment struct X { virtual ~X noexcept {} }; //    static_assert, compiler.require   //   constexpr-. //      . compiler.require(source.variables().empty(), "interfaces may not contain data members"); // member_functions(), ,  tuple&lt;â€¦&gt;,   for... for... (auto f : source.member_functions()) { // ,   â€”   / compiler.require(!f.is_copy() &amp;&amp; !f.is_move(), "interfaces may not copy or move; consider a virtual clone()"); //   public   if (!f.has_default_access()) f.make_public(); // (1) // ,       protected/private compiler.require(f.is_public(), "interface functions must be public"); //     f.make_pure_virtual(); // (2) //   f     __generate f; } }</span></span></code> </pre> <br><p> æ‚¨å¯èƒ½ä¼šè®¤ä¸ºåœ¨ç¬¬ï¼ˆ1ï¼‰å’Œï¼ˆ2ï¼‰è¡Œä¸­ï¼Œæˆ‘ä»¬ä¿®æ”¹äº†åŸå§‹ç±»ï¼Œä½†æ²¡æœ‰ã€‚ è¯·æ³¨æ„ï¼Œæˆ‘ä»¬é€šè¿‡å¤åˆ¶æ¥éå†åŸå§‹ç±»çš„åŠŸèƒ½ï¼Œä¿®æ”¹è¿™äº›åŠŸèƒ½ï¼Œç„¶åå°†å…¶æ’å…¥æ–°ç±»ä¸­ã€‚ </p><br><p> å…ƒç±»åº”ç”¨ç¨‹åºï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">interface</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shape</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">area</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">scale_by</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> factor)</span></span></span></span>; }; <span class="hljs-comment"><span class="hljs-comment">//  : class Shape { public: virtual ~Shape noexcept {} public: virtual int area() const = 0; public: virtual void scale_by(double factor) = 0; };</span></span></code> </pre> <br><h3 id="otladka-myuteksa"> äº’æ–¥è°ƒè¯• </h3><br><p> å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªäº’æ–¥é”ä¿æŠ¤çš„éçº¿ç¨‹å®‰å…¨æ•°æ®ã€‚ å¦‚æœåœ¨è°ƒè¯•ç¨‹åºé›†ä¸­çš„æ¯ä¸ªè°ƒç”¨ä¸­æ£€æŸ¥å½“å‰è¿›ç¨‹æ˜¯å¦å·²é”å®šæ­¤äº’æ–¥é”ï¼Œåˆ™å¯ä»¥ä¿ƒè¿›è°ƒè¯•ã€‚ ä¸ºæ­¤ï¼Œç¼–å†™äº†ä¸€ä¸ªç®€å•çš„TestableMutexç±»ï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestableMutex</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lock</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ m.lock(); id = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::this_thread::get_id(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unlock</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ id = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::thread::id{}; m.unlock(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">is_held</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> id == <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::this_thread::get_id(); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::mutex m; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::atomic&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::thread::id&gt; id; };</code> </pre> <br><p> æ­¤å¤–ï¼Œåœ¨MyDataç±»ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›æ¯ä¸ªå…¬å…±é¢†åŸŸéƒ½å–œæ¬¢ </p><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; v;</code> </pre> <br><p> æ›¿æ¢ä¸º+ getterï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; v_; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;&amp; v() { assert(m_.is_held()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v_; }</code> </pre> <br><p> å¯¹äºåŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œç±»ä¼¼çš„è½¬æ¢ã€‚ </p><br><p> ä½¿ç”¨å®å’Œä»£ç ç”Ÿæˆå¯è§£å†³æ­¤ç±»ä»»åŠ¡ã€‚ èµ«ä¼¯Â·è¨ç‰¹ï¼ˆHerb Sutterï¼‰å‘å®å®£æˆ˜ï¼šå®ƒä»¬æ˜¯ä¸å®‰å…¨çš„ï¼Œä¼šå¿½ç•¥è¯­ä¹‰ï¼Œåç§°ç©ºé—´ç­‰ã€‚ è§£å†³æ–¹æ¡ˆåœ¨å…ƒç±»ä¸Šçœ‹èµ·æ¥åƒä»€ä¹ˆï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">guarded_with_mutex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ __generate __fragment <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> {</span></span> TestableMutex m_; <span class="hljs-comment"><span class="hljs-comment">// lock, unlock } } template &lt;typename T, typename U&gt; constexpr void guarded_member(T type, U name) { auto field = â€¦; __generate field; auto getter = â€¦; __generate getter; } template &lt;typename T&gt; constexpr void guarded(T source) { guarded_with_mutex(); for... (auto o : source.member_variables()) { guarded_member(o.type(), o.name()); } }</span></span></code> </pre> <br><p> ä½¿ç”¨æ–¹æ³•ï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">guarded</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyData</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; v; Widget* w; }; MyData&amp; x = findData(<span class="hljs-string"><span class="hljs-string">"foo"</span></span>); xv().clear(); <span class="hljs-comment"><span class="hljs-comment">// assertion failed: m_.is_held()</span></span></code> </pre> <br><h3 id="actor"> æ¼”å‘˜ </h3><br><p> å¥½å§ï¼Œå³ä½¿æˆ‘ä»¬ç”¨äº’æ–¥é”ä¿æŠ¤äº†æŸä¸ªå¯¹è±¡ï¼Œä½†ç°åœ¨æ‰€æœ‰å†…å®¹éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¹Ÿæ²¡æœ‰è¦æ±‚æ­£ç¡®æ€§ã€‚ ä½†æ˜¯ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡ç»å¸¸å¯ä»¥è¢«å¤šä¸ªå¹¶è¡Œçº¿ç¨‹è®¿é—®ï¼Œåˆ™äº’æ–¥å¯¹è±¡å°†è¿‡è½½ï¼Œå¹¶ä¸”å ç”¨å¤§é‡å¼€é”€ã€‚ </p><br><p> è§£å†³å¤šè™«äº’æ–¥é—®é¢˜çš„æ ¹æœ¬è§£å†³æ–¹æ¡ˆæ˜¯å‚ä¸è€…çš„æ¦‚å¿µï¼Œå½“ä¸€ä¸ªå¯¹è±¡æœ‰ä¸€ä¸ªè¯·æ±‚é˜Ÿåˆ—æ—¶ï¼Œå¯¹è¯¥å¯¹è±¡çš„æ‰€æœ‰è°ƒç”¨éƒ½å°†æ’å…¥é˜Ÿåˆ—ï¼Œå¹¶åœ¨ä¸€ä¸ªç‰¹æ®Šçº¿ç¨‹ä¸­ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ‰§è¡Œã€‚ </p><br><p> è®©Activeç±»åŒ…å«æ‰€æœ‰è¿™äº›çš„å®ç°-å®é™…ä¸Šï¼Œæ˜¯å…·æœ‰å•ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± /æ‰§è¡Œç¨‹åºã€‚ å¥½å§ï¼Œå…ƒç±»å°†å¸®åŠ©æ‘†è„±é‡å¤çš„ä»£ç å¹¶ä½¿æ‰€æœ‰æ“ä½œæ’é˜Ÿï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">active</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ImageFilter</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: ImageFilter(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::function&lt;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>(Buffer*)&gt; w) : work(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(w)) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">apply</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Buffer* b)</span></span></span><span class="hljs-function"> </span></span>{ work(b); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::function&lt;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>(Buffer*)&gt; work; } <span class="hljs-comment"><span class="hljs-comment">//  : class ImageFilter { public: ImageFilter(std::function&lt;void(Buffer*)&gt; w) : work(std::move(w)) {} void apply(Buffer* b) { a.send([=] { work(b); }).join(); } private: std::function&lt;void(Buffer*)&gt; work; Active a; //   ,     work }</span></span></code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">active</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">log</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::fstream f; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">info</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(â€¦)</span></span></span><span class="hljs-function"> </span></span>{ f &lt;&lt; â€¦; } };</code> </pre> <br><h3 id="property"> è´¢äº§ </h3><br><p> å‡ ä¹æ‰€æœ‰ç°ä»£ç¼–ç¨‹è¯­è¨€éƒ½å…·æœ‰å±æ€§ï¼Œè€Œæ²¡æœ‰æ ¹æ®C ++å®ç°å®ƒä»¬çš„äººï¼šQtï¼ŒC ++ / CLIï¼Œå„ç§ä¸‘é™‹çš„å®ã€‚ ä½†æ˜¯ï¼Œå®ƒä»¬æ°¸è¿œä¸ä¼šè¢«æ·»åŠ åˆ°C ++æ ‡å‡†ä¸­ï¼Œå› ä¸ºå®ƒä»¬æœ¬èº«è¢«è®¤ä¸ºè¿‡äºç‹­çª„ï¼Œå¹¶ä¸”å§‹ç»ˆå¸Œæœ›æœ‰ä¸€äº›ææ¡ˆå¯ä»¥å°†å®ƒä»¬ä½œä¸ºä¸€ç§ç‰¹æ®Šæƒ…å†µæ¥å®ç°ã€‚ å¥½äº†ï¼Œå®ƒä»¬å¯ä»¥åœ¨å…ƒç±»ä¸Šå®ç°ï¼ </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//  class X { public: class(property&lt;int&gt;) WidthClass { } width; }; //  class X { public: class WidthClass { int value; int get() const; void set(const int&amp; v); void set(int&amp;&amp; v); public: WidthClass(); WidthClass(const int&amp; v); WidthClass&amp; operator=(const int&amp; v); operator int() const; //   move! WidthClass(int&amp;&amp; v); WidthClass&amp; operator=(int&amp;&amp; v); } width; };</span></span></code> </pre> <br><p> æ‚¨å¯ä»¥è®¾ç½®è‡ªå·±çš„getterå’Œsetterï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Date</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property</span></span></span><span class="hljs-class">&lt;int&gt;) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonthClass</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> month; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> month; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> m)</span></span></span><span class="hljs-function"> </span></span>{ assert(m &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; m &lt; <span class="hljs-number"><span class="hljs-number">13</span></span>); month = m; } } month; }; Date date; date.month = <span class="hljs-number"><span class="hljs-number">15</span></span>; <span class="hljs-comment"><span class="hljs-comment">// assertion failed</span></span></code> </pre> <br><p> ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘æƒ³å°†<code>property int month { â€¦ }</code>å†™ä¸º<code>property int month { â€¦ }</code> ï¼Œä½†æ˜¯å³ä½¿è¿™æ ·çš„å®ç°ä¹Ÿå°†å–ä»£å‘æ˜å±æ€§çš„C ++æ‰©å±•çš„åŠ¨ç‰©å›­ã€‚ </p><br><h3 id="zaklyuchenie-po-metaklassam"> å…ƒç±»ç»“è®º </h3><br><p> å¯¹äºå·²ç»å¾ˆå¤æ‚çš„è¯­è¨€ï¼Œå…ƒç±»æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ–°åŠŸèƒ½ã€‚ å€¼å¾—å—ï¼Ÿ è¿™é‡Œæœ‰ä¸€äº›å¥½å¤„ï¼š </p><br><ul><li> è®©ç¨‹åºå‘˜æ›´æ¸…æ¥šåœ°è¡¨è¾¾è‡ªå·±çš„æ„å›¾ï¼ˆæˆ‘æƒ³å†™æ¼”å‘˜ï¼‰ </li><li> å‡å°‘ä»£ç é‡å¤å¹¶ç®€åŒ–éµå¾ªæŸäº›æ¨¡å¼çš„ä»£ç çš„å¼€å‘å’Œç»´æŠ¤ </li><li> æ¶ˆé™¤ä¸€äº›å¸¸è§çš„é”™è¯¯ï¼ˆä¸€æ¬¡è¶³ä»¥è§£å†³æ‰€æœ‰ç»†å¾®å·®åˆ«ï¼‰ </li><li> å…è®¸æ‘†è„±å®å—ï¼Ÿ  ï¼ˆè‰è¯è¨ç‰¹éå¸¸å¥½æˆ˜ï¼‰ </li></ul><br><h3 id="voprosy-iz-zala-1"> å¬ä¼—çš„æé—® </h3><br><p>  <strong>å¦‚ä½•è°ƒè¯•å…ƒç±»ï¼Ÿ</strong> </p><br><p> è‡³å°‘å¯¹äºClangï¼Œæœ‰ä¸€ä¸ªå†…åœ¨å‡½æ•°ï¼Œå¦‚æœè¢«è°ƒç”¨ï¼Œå®ƒå°†åœ¨ç¼–è¯‘æ—¶æ‰“å°ç±»çš„å®é™…å†…å®¹ï¼Œå³åœ¨åº”ç”¨æ‰€æœ‰å…ƒç±»åè·å¾—çš„å†…å®¹ã€‚ </p><br><p>  <strong>æ®è¯´å®ƒèƒ½å¤Ÿåœ¨å…ƒç±»ä¸­å£°æ˜éæˆå‘˜ï¼Œå¦‚swapå’Œhashã€‚</strong>  <strong>å¥¹å»å“ªäº†</strong> </p><br><p> è¯­æ³•å°†è¿›ä¸€æ­¥å‘å±•ã€‚ </p><br><p>  <strong>å¦‚æœå·²ç»ä¸ºæ ‡å‡†åŒ–é‡‡ç”¨äº†æ¦‚å¿µï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å…ƒç±»ï¼Ÿ</strong> </p><br><p> è¿™äº›æ˜¯ä¸åŒçš„ä¸œè¥¿ã€‚ éœ€è¦ä½¿ç”¨å…ƒç±»æ¥å®šä¹‰ç±»çš„å„ä¸ªéƒ¨åˆ†ï¼Œå¹¶ä¸”æ¦‚å¿µä¼šä½¿ç”¨ç±»ç¤ºä¾‹æ£€æŸ¥ç±»æ˜¯å¦ç¬¦åˆç‰¹å®šæ¨¡å¼ã€‚ å®é™…ä¸Šï¼Œå…ƒç±»å’Œæ¦‚å¿µå¯ä»¥å¾ˆå¥½åœ°ååŒå·¥ä½œã€‚ ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å®šä¹‰è¿­ä»£å™¨çš„æ¦‚å¿µå’Œâ€œå…¸å‹è¿­ä»£å™¨â€çš„å…ƒç±»ï¼Œè¯¥â€œå…¸å‹è¿­ä»£å™¨â€å®šä¹‰å…¶ä½™çš„ä¸€äº›å†—ä½™æ“ä½œã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN425873/">https://habr.com/ru/post/zh-CN425873/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN425859/index.html">åŒºåŸŸè¿è¥å•†åå¯¹å–æ¶ˆæ¼«æ¸¸</a></li>
<li><a href="../zh-CN425861/index.html">æµ‹è¯•ä¸€ä¸‹è‡ªå·±ï¼šæ‚¨å¯ä»¥ä¿æŠ¤å…¬å¸å…å—ç½‘ç»œæ”»å‡»å—ï¼Ÿ</a></li>
<li><a href="../zh-CN425867/index.html">WebæœåŠ¡æ€§èƒ½æµ‹è¯•ï¼Œä½œä¸ºæŒç»­é›†æˆçš„ä¸€éƒ¨åˆ†ã€‚ Yandexç»éªŒ</a></li>
<li><a href="../zh-CN425869/index.html">iFixitï¼šè‹¹æœå°šæœªæ¿€æ´»é˜»æ­¢ç¿»æ–°çš„MacBookçš„åŠŸèƒ½</a></li>
<li><a href="../zh-CN425871/index.html">å¶å¡æ·ç³å ¡ï¼Œ10æœˆ11æ—¥-Atlassiané‡åˆ°docker</a></li>
<li><a href="../zh-CN425875/index.html">ç¬”è®°æœ¬ç”µè„‘çŸ©é˜µå‡çº§TN-> IPSæˆ–å¦‚ä½•ä»å»‰ä»·ç¬”è®°æœ¬ç”µè„‘ä¸­è·å¾—æ›´é«˜çº§çš„ç¬”è®°æœ¬ç”µè„‘</a></li>
<li><a href="../zh-CN425877/index.html">è‹¹æœé¦–å¸­æ‰§è¡Œå®˜è¡¨ç¤ºï¼Œè¶…å¾®æœåŠ¡å™¨ä¸­çš„ä¸­å›½é—´è°èŠ¯ç‰‡æ˜¯è™šæ„çš„</a></li>
<li><a href="../zh-CN425879/index.html">Googleåœ¨æ¼”è®²ä¸­æ˜¾ç¤ºçš„å†…å®¹</a></li>
<li><a href="../zh-CN425881/index.html">æ‚¨éœ€è¦äº†è§£çš„æœ‰å…³Flexboxä¸­å¯¹é½çš„æ‰€æœ‰ä¿¡æ¯</a></li>
<li><a href="../zh-CN425883/index.html">å…¨èŒ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>