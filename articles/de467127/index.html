<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìí üî§ ‚õé Testen von APIs mit Postman und Excel üêç üßõüèº üíÉüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo allerseits, ich bin der Leiter der Testabteilung, und k√ºrzlich wurde eine Aufgabe zum Testen der API angezeigt. Um es zu l√∂sen, habe ich das neu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Testen von APIs mit Postman und Excel</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467127/">  Hallo allerseits, ich bin der Leiter der Testabteilung, und k√ºrzlich wurde eine Aufgabe zum Testen der API angezeigt.  Um es zu l√∂sen, habe ich das neue Postman- und JavaScript-Tool f√ºr mich gemeistert. <br><br>  Zun√§chst schrieb ich f√ºr jede API meine Sammlungen und bereitete Testdaten im JSON-Format vor.  Dies ist recht praktisch, aber bei einer gro√üen Anzahl von Tests und Sammlungen wird die Wartung unrentabel.  Und es ist nicht bequem, Daten in JSON zu validieren. <br><br>  Um diese Probleme zu l√∂sen, habe ich ein Makro f√ºr Excel und eine Sammlung in Postman geschrieben.  Jetzt habe ich in Postman eine Sammlung f√ºr alle APIs und einen Standardsatz von Funktionen zum Verarbeiten eingehender Daten und zum √úberpr√ºfen der zur√ºckgegebenen Ergebnisse.  Ich habe es geschafft, die Testdatenverwaltung und die Abfrageausf√ºhrungssequenz nach Excel zu √ºbertragen. <br><br><h4>  Was war </h4><br>  1. JSON mit Daten <br><br><img src="https://habrastorage.org/webt/be/l-/78/bel-78hyknqwqra9c8qovryx9fm.png"><br>  <i>Zuvor wurde das Testkit in dieser Form gespeichert</i> <br><a name="habracut"></a><br>  2. 2. Die Reihenfolge der Abfrageausf√ºhrung mit JS-Handlern wurde in Postman-Sammlungen gespeichert. <br><br><img src="https://habrastorage.org/webt/gi/tw/4j/gitw4j_h_todey0pzbyvou9sinc.png"><br><br><h4>  Was ist geworden </h4><br>  1. Die Testsuite wurde nach Excel verschoben <br><br><img src="https://habrastorage.org/webt/j5/0e/fv/j50efvyvp-dspfoobtcpjgjbemg.png"><br><br>  Alle Daten werden in Excel eingegeben (Steuerschl√ºsselzeichen: R, H, I usw. Ich werde unten schreiben) und dann mithilfe eines Makros in das JSON-Format √ºbertragen: <br><br><img src="https://habrastorage.org/webt/y9/dp/5q/y9dp5q9c_fdj7_zbxun6-ebl1tk.png"><br><br>  2. Im Postboten <br><br><img src="https://habrastorage.org/webt/ry/mq/jl/rymqjl-zkqsqakx6fxuqkxpy110.png"><br><br>  Das Experiment wurde mit einem Standardsatz von CRUD-Operationen durchgef√ºhrt, die weiter erweitert werden k√∂nnen. <br><br>  Da in Postman alle Operationen nur im Rahmen der Anfrage ausgef√ºhrt werden, musste ich eine leere Get-Anfrage eingeben, an deren Ende die n√§chste Anfrage aus der Sequenz ermittelt wird.  F√ºhren Sie JS-Code vor der Anforderung aus und ermitteln Sie die erste Anforderung, ohne dass ein Leerzeichen fehlgeschlagen ist. <br><br>  In allen Anforderungen sind die Abschnitte "Voranforderungsskript" und "Test" leer, der gesamte Code ist f√ºr Anforderungen vereinheitlicht und wird in den allgemeinen Abschnitten des Voranforderungsskripts und des Ordners "Test der API-Sammlung" gespeichert. <br><br><img src="https://habrastorage.org/webt/dz/jc/ao/dzjcaoa2elumolbw2wbp_d1dhe0.png"><br><br>  Bei allen Anforderungen ist es wichtig, bei POST- und PUT-Anforderungen auf die URL und den Body-Abschnitt zu achten. Ihre Werte werden durch Variablen bestimmt, deren Werte von JSON mit Daten eingegeben werden. <br><br><img src="https://habrastorage.org/webt/gj/yu/y0/gjyuy08umwwocw2aayfgd0legtm.png"><br><br><h4>  Nun zu den Tests selbst </h4><br><img src="https://habrastorage.org/webt/zg/as/ah/zgasahcnnfy4uv3w2cijha956kq.png"><br><br>  <b>Wie man Excel liest</b> .  Die erste nicht leere Zeile ist die Nummer des Testfalls, dh der Testfall wird vertikal gespeichert und auf dieser Seite befinden sich 9 Testf√§lle.  In der aktuellen Gruppe wird in jedem Testfall zuerst eine POST-Anforderung ausgef√ºhrt und dann L√∂schen. <br><br>  <b>So starten Sie die Json-Generierung aus Excel</b> .  Dr√ºcken Sie in Excel F11 und gehen Sie zu "EtaBook", dort f√ºhren Sie das Makro aus. <br><br><h4>  Stichworte </h4><br>  <b>R</b> - Anfrage bedeutet den Beginn einer neuen Anfrage, in der zweiten Zelle der Zeile wird der Typ der Anfrage gespeichert, in der dritten die Adresse, an die Sie sich wenden m√ºssen.  Bitte beachten Sie, dass Sie in der URL Postman-Variablen angeben k√∂nnen <br><br><img src="https://habrastorage.org/webt/9o/ex/nq/9oexnqprk9duapwq6zcxoe5hsae.png"><br>  <i>Der Wert aus der Variablen wird abgerufen</i> <br><br>  <b>H</b> - Daten zur √úberpr√ºfung im Header, bisher wurde nur der Antwortcode eingegeben, Postman pr√ºft nur im Postman.  Es ist wichtig, dass der Name in Excel der gleiche "Antwortcode" ist oder in Postman korrigiert wird <br><br><img src="https://habrastorage.org/webt/74/26/if/7426ifzzmp0fljuy6t0tgzww5oo.png"><br><br>  <b>I, I2 ...</b> - Der Abschnitt Eingabedaten unterst√ºtzt die Speicherung von Datenmodellen f√ºr jede Verschachtelung. Die Abbildung rechts von I ist f√ºr die Verschachtelungsebene verantwortlich.  Der n√§chste Datensatz wird wie folgt in JSON eingeschlossen.  Wenn die Variable, in der die Daten gespeichert sind, leer ist, wird sie nicht hinzugef√ºgt.  Das hei√üt, wenn die inn-Variable keinen Wert enth√§lt, wird sie nicht hinzugef√ºgt, und die Hauptvariable wird hinzugef√ºgt, da sie das Modell speichert.  Wenn das gesamte Modell leer ist, wird es auch nicht hinzugef√ºgt. <br><br><img src="https://habrastorage.org/webt/x-/ku/bg/x-kubguayoz-z57pewwztbltnsq.png"><br>  <i>Die Daten in diesem Abschnitt werden im Anfragetext √ºbermittelt.</i> <br><br><img src="https://habrastorage.org/webt/mu/og/ne/muognet9_l6pj_l5gbc9ugici6q.png"><br><br>  <b>O, O2 ...</b> - Abschnitt der Ausgabeparameter, sie werden mit denen verglichen, die durch Antwort zur√ºckgegeben werden.  Wie der Abschnitt Eingabe unterst√ºtzt er die Modellspeicherung. <br><br><img src="https://habrastorage.org/webt/i8/yz/xm/i8yzxm_jo-3bd5fgdvyfraz_g_u.png"><br>  <i>Beim Vergleichen werden die Daten in Zeichenfolgen konvertiert, ich habe zus√§tzlich den Rekursionsgrad begrenzt, dieser kann entfernt werden</i> <br><br>  <b>PO</b> - Postman-Ausgabe: Die Werte aus diesem Abschnitt werden dem Antworttext der Anforderung mit dem Namen der Variablen entnommen und in die Postman-Variable geschrieben. <br><br><img src="https://habrastorage.org/webt/vx/ho/fz/vxhofzpxvogjohpodrnu0zl9vvc.png"><br>  <i>In Excel reicht es aus, ein beliebiges Zeichen einzuf√ºgen. Der Wert aus der Antwort und nicht aus Excel wird in die Variable geschrieben</i> <br><br><img src="https://habrastorage.org/webt/-j/e9/qg/-je9qgf4r93uv3nhj69fksobm0c.png"><br>  <i>Dieser Abschnitt wird zum Speichern von Daten zwischen Skripten ben√∂tigt, um beispielsweise ein Objekt mit der ID zu l√∂schen, die in der vorherigen Anforderung erstellt wurde</i> <br><br>  <b>PC</b> - Postman-Befehl, der nur einen "Beenden" -Befehl eingef√ºhrt hat. Er wird verwendet, um die Beendigung nach Ausf√ºhrung der aktuellen Anforderung zu erzwingen.  N√ºtzlich f√ºr einen negativen Test, um keinen Schritt zum L√∂schen des erstellten Objekts zu verursachen. <br><br><img src="https://habrastorage.org/webt/b4/c-/a-/b4c-a-z_r2b4t_icmwb2fpsaerq.png"><br>  <i>Durch Eingabe dieses Befehls konnten sowohl positive als auch negative Tests auf einem Blatt gespeichert werden</i> <br><br><img src="https://habrastorage.org/webt/18/w3/o-/18w3o-70cys7nv7dulrifg5ja7s.png"><br><br>  <b>PI</b> - Postman Input, Werte aus diesem Abschnitt werden vor der URL-Definition in Postman-Variablen geschrieben <br><br><img src="https://habrastorage.org/webt/kh/rc/vz/khrcvzvphiglyotfonirlen-hr8.png"><br>  Dies kann hilfreich sein, wenn Sie die in der Anforderungs-URL angegebenen Variablen √ºberschreiben m√ºssen. <br><br>  √úbrigens k√∂nnen Sie Daten aus Postman-Variablen in den bereitgestellten Daten verwenden, daf√ºr m√ºssen Sie ein spezielles Design verwenden <br><br><img src="https://habrastorage.org/webt/v6/bv/8r/v6bv8r4dsxo3sslgpfnmqjk7cuy.png"><br><br>  In Fall 1 haben wir den erhaltenen Wert in eine Variable eingegeben, in Fall 2 haben wir ihn verwendet.  Es kann nicht nur im n√§chsten Fall verwendet werden, sondern auch im aktuellen bei der n√§chsten Anforderung.  Beispielsweise kann es erforderlich sein, wenn die Definition des Objekts f√ºr die √Ñnderung nicht der URL folgt, sondern dem Wert der Variablen in der Anforderung entspricht. <br><br><h4>  Vorbereitung f√ºr den Lauf </h4><br>  F√ºhren Sie nun den Postman-L√§ufer aus, w√§hlen Sie die gew√ºnschte Sammlung aus und laden Sie die Datei mit den Testdaten hoch: <br><br><img src="https://habrastorage.org/webt/qz/j7/v7/qzj7v7qfatkjb5qs9uanx8pj1gg.png"><br><br>  Wir werden das folgende Set servieren: <br><br><img src="https://habrastorage.org/webt/yr/rl/e0/yrrle0uje4xycw_yfhtnkuel9io.png"><br><br>  Hier werden 15 Tests beschrieben, wobei die Schritte 1 bis 11, 13, 15 mit einem Ergebnis von 200 f√ºr eine POST-Anforderung positiv sind und die Schritte 12, 14 mit einem Ergebnis von 400 negativ sind. Es werden keine Informationen in die Datenbank eingegeben, und daher ist der Abschnitt Ausgabe leer, und der Befehl wird angezeigt beenden.  Dieser Befehl unterbricht die Ausf√ºhrung der Sequenz und die Anforderung zum L√∂schen von "L√∂schen" wird nicht gesendet. <br><br>  Nach den F√§llen 1-11, 13, 15 merken wir uns die ID, die dem neuen Objekt zugewiesen wurde, und l√∂schen es dann. <br><br><h4>  Wir starten </h4><br><img src="https://habrastorage.org/webt/lv/i-/lp/lvi-lpm3jj-12nmimyar_tulyxu.png"><br>  <i>Alle 15 Tests waren erfolgreich, das Bild zeigt Test 14, bei dem Delete nach POST nicht aufgerufen wird</i> <br><br>  In den Tests 1-11,13,15 nach dem POST wird das L√∂schen des erstellten Objekts aufgerufen: <br><br><img src="https://habrastorage.org/webt/vz/i9/e3/vzi9e3bm7n2xyadpllytq-s1czm.png"><br><br><h4>  Zusammenfassung </h4><br><ul><li>  Die Reihenfolge der Anforderungen zum Testen der API erfolgt in Excel und wird in Postman verarbeitet. </li><li>  Alle Testdaten werden auch in Excel gerendert. Sie k√∂nnen bequem verwaltet und validiert werden.  Zumindest bequemer als im JSON-Format. </li><li>  Die Postman-Sammlung ist standardisiert und muss beim Testen √§hnlicher APIs nicht verbessert werden. </li></ul><br><h4>  Referenzen </h4><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub-Repository gibt es Excel und die Postman-Sammlung</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">In der Entwicklung wurde ein von Tim Hall verfasstes VBA-JSON-Tool verwendet.</a> </li></ol><br><br>  <b>Update vom 15.10.2019</b> <br><br>  1. Die M√∂glichkeit, JSON-Dateien zu generieren, ohne Excel auszuf√ºhren, wurde verbessert. F√ºgen Sie sie in das Git GenerateAll.cmd ein, in dem das vb-Skript GenerateJsonFiles.vbs ausgef√ºhrt wird.  Das aufgerufene Skript durchsucht den aktuellen Ordner und alle Unterordner und generiert JSON-Dateien <br>  2. F√ºhren Sie RunAll.cmd aus, um alle generierten JSON-Datendateien auszuf√ºhren, auch den aktuellen Ordner und alle Unterordner.  Neben jedem von ihnen wird output-report.log mit den Ergebnissen des Laufs abgelegt. <br><br>  Jetzt sollte das Anschrauben an CI kein Problem sein.  Sie k√∂nnen die json-Generierung auch an der git-Bereitstellung befestigen und Daten in Excel auf √Ñnderungen in json-Dateien vergleichen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de467127/">https://habr.com/ru/post/de467127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de467113/index.html">Wie halte ich den Benutzer auf der Website? Usability-Geheimnisse</a></li>
<li><a href="../de467115/index.html">Atypisches "ls" - Habr Edition</a></li>
<li><a href="../de467117/index.html">Manuskripte brennen nicht: Das Geheimnis der Langlebigkeit der Schriftrollen vom Toten Meer aus dem Jahr 250 v</a></li>
<li><a href="../de467119/index.html">Spielen Sie IT-Alias ‚Äã‚Äãmit Badoo Engineers</a></li>
<li><a href="../de467125/index.html">Modernes NES-Spiel in einer Lisp-√§hnlichen Sprache</a></li>
<li><a href="../de467129/index.html">Kognitive Begradigung 2: Illusionen und Verzerrungen lernen</a></li>
<li><a href="../de467131/index.html">CLRium # 6: Paarbericht √ºber Lock-Free, viel Theorie und praktisches Wissen</a></li>
<li><a href="../de467135/index.html">USB-Pedal zum Umschalten zwischen Computern</a></li>
<li><a href="../de467137/index.html">Sicherstellung eines zuverl√§ssigen Betriebs des Zextras-Teams in komplexen Unternehmensnetzwerken</a></li>
<li><a href="../de467141/index.html">Mitapa Saint TeamLead Conf f√ºr ein tieferes Thema</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>