<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üà∑Ô∏è ‚õ±Ô∏è üí° So erm√∂glichen Sie Mikrozahlungen in Ihrer App üôåüèø üë©üèª‚Äçü§ù‚Äçüë®üèº üë∂üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Diese Woche habe ich meine erste √∂ffentliche Haustier-App basierend auf dem Telegramm-Chat-Bot codiert, der als Bitcoin-Brieftasche fungiert und das S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So erm√∂glichen Sie Mikrozahlungen in Ihrer App</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452666/"><p>  Diese Woche habe ich meine erste √∂ffentliche Haustier-App basierend auf dem Telegramm-Chat-Bot codiert, der als Bitcoin-Brieftasche fungiert und das Senden und Empfangen von Tipps zwischen Telegrammbenutzern und anderen sogenannten ‚ÄûLightning-Apps‚Äú erm√∂glicht.  Ich gehe davon aus, dass Sie mit Bitcoin &amp; Telegram im Allgemeinen vertraut sind. Ich werde versuchen, kurz und ohne tiefe Details zu posten.  Weitere <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ressourcen zu Bitcoin finden Sie hier.</a> Telegram ist einfach ein Instant Messenger, mit dem Sie Ihre benutzerdefinierten Apps (Chat-Bots) mithilfe ihrer Plattform erstellen k√∂nnen. </p><br><h3>  Was sind die wichtigsten Punkte einer solchen App? </h3><br><ul><li>  Erm√∂glicht die Bewertung von Ideen und Antworten anderer Benutzer mit echtem Wert anstelle von <br>  "Virtuelle Likes".  Dies bringt Online-Konversation auf ein v√∂llig neues Niveau </li><li>  Ein echtes Beispiel f√ºr eine funktionierende Micro-Payment-App, die mit anderen Unternehmen zusammenarbeiten kann <br>  √ºber das Internet mit offenem Protokoll </li><li>  Alle Module sind Open-Source-Projekte und k√∂nnen einfach wiederverwendet und angepasst werden <br>  f√ºr Ihr eigenes Projekt.  Die App wird nicht an kommerzielle Dienste von Drittanbietern weitergeleitet. <br>  Auch f√§llt es unter E-Commerce-Bereich, der derzeit fast geschlossen ist, die App <br>  basiert auf offenen L√∂sungen. </li></ul><br><h3>  Was sind die Anwendungsf√§lle? </h3><br><p>  so etwas ... <br></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/097/02b/175/09702b1750c94616a10fc66c1275c00f.png" alt="Bild"></div><a name="habracut"></a><br>  oder so .. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ef/1ff/85f/3ef1ff85f1e7b77662c63a9d4d838666.png" alt="Bild"></div><br><p>  Was bedeuten Zahlen?  Dies sind <b>Bitcoin-Einheiten - Satoshis</b> .  Mitte 2019 haben 1000 Satoshis einen Wert von 0,06 USD.  Sie k√∂nnen es online ausgeben oder mit vielen verf√ºgbaren Diensten in Ihre lokale W√§hrung umtauschen.  Dies ist also nicht nur eine andere <i>"Nummer in einer Datenbank"</i> oder ein <i>"Gutschein, den Sie in unserem Partnergesch√§ft ausgeben k√∂nnen"</i> , sondern ein <b>echtes Internetgeld</b> . </p><br><p>  Sie k√∂nnen fragen, was zu tun ist, wenn Sie kein Bitcoin in der App verwenden k√∂nnen.  Sie k√∂nnen einfach einen Tipp von einem vorhandenen App-Benutzer erhalten oder eine kleine Menge Bitcoin an verschiedenen B√∂rsen oder Bitcoin-Geldb√∂rsen f√ºr Mobiltelefone oder PCs kaufen. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/883/661/461/883661461bdc686aec7d084d5d581236.png" alt="Bild"><img src="https://habrastorage.org/getpro/habr/post_images/779/716/5d9/7797165d93d292700d9a41a171d882a6.png" alt="Bild"><img src="https://habrastorage.org/getpro/habr/post_images/8fe/33b/84b/8fe33b84bb127132304634363bb4af42.png" alt="Bild"></p><br><p>  Wenn Sie Bitcoin erhalten haben, k√∂nnen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">@atomic_tipbot</a> starten und eine Einzahlung vornehmen. </p><br><p>  Sie sehen eine Rechnung, Sie k√∂nnen die bevorzugte Zahlungsmethode ausw√§hlen und Geld senden, indem Sie einfach den QR-Code scannen oder per Knopfdruck ( <i>"In Brieftasche √∂ffnen"</i> ) auf der Rechnung. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/8fe/33b/84b/8fe33b84bb127132304634363bb4af42.png" alt="Bild"><img src="https://habrastorage.org/getpro/habr/post_images/4a3/da5/f76/4a3da5f76574ac9ebb2161d56bceff62.png" alt="Bild"><img src="https://habrastorage.org/getpro/habr/post_images/54d/a43/0be/54da430be68237193dee82ade50bab37.png" alt="Bild"></p><br><p>  Best√§tigen Sie die Zahlung in Ihrer mobilen Geldb√∂rse, und im Telegramm wird fast sofort ein Best√§tigungsbildschirm angezeigt. </p><br><p>  Bisher haben wir zwei separate Teile der App ber√ºhrt: das Telegramm-Bot-Back-End und das Zahlungsverarbeitungssystem (eigentlich eher das Front-End). </p><br><p>  Um diesen Telegramm-Bot zu erstellen, habe ich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Python-Telegramm-Bot verwendet</a> .  Und nat√ºrlich ist der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bot Open Source</a> . </p><br><p>  Als Zahlungsverarbeitungssystem zur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erstellung von</a> Rechnungen, zur √úberpr√ºfung des Status, zum Senden von Benachrichtigungen und zur Pflege von UX wird <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">BTCPayServer</a> verwendet. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation finden Sie hier</a> . </p><br><p>  Wenn Sie wissen, wie Zahlungsereignisse direkt verarbeitet werden k√∂nnen, k√∂nnen Sie auf den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Handbuchseiten von Electrum CLI</a> nach Zahlungen in der Kette suchen und nach L√∂sungen f√ºr Zahlungen au√üerhalb der Kette (Lightning) wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lightning-Charge</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sparko suchen</a> . </p><br><h3>  Sie sagten "keine Drittanbieter" und "keine Cloud-Dienste" !? </h3><br><p>  Ja, das stimmt.  In meiner App verwende ich kostenloses Shared Hosting der BTCPayServer-Instanz - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">BTCPayJungle</a> , aber es ist m√∂glich, auch auf Ihrem eigenen dedizierten Server <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hochzufahren</a> .  Denken Sie daran, dass Sie dann ca. 500 GB Speicherplatz ben√∂tigen, um die Bitcoin- und Litecoin-Blockchain zu speichern.  BTCPayServer enth√§lt keine privaten Schl√ºssel oder vertraulichen Informationen, mit denen Hacker das Geld in Ihrer Brieftasche kontrollieren k√∂nnen.  F√ºr On-Chain-Zahlungen (Standardzahlungen) m√ºssen Sie BTCPayServer einen xpub-Schl√ºssel aus Ihrer Brieftasche zur Verf√ºgung stellen, damit √∂ffentliche Adressen generiert werden k√∂nnen.  Auf diese Weise erm√∂glicht die BTCPay-Architektur die vertrauensw√ºrdige Verarbeitung von Zahlungen auch in einer gemeinsam genutzten Umgebung.  Die Konfiguration ist sehr einfach, wenn Sie bew√§hrte Geldb√∂rsen wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Electrum verwenden</a> . </p><br><h3>  Was ist Lightning Network? </h3><br><p>  Es ist so etwas wie ein Add-On zu Bitcoin, das eine zus√§tzliche Abstraktionsschicht hinzuf√ºgt und es erm√∂glicht, sofortige und fast kostenlose Bitcoin-Transaktionen durchzuf√ºhren.  All dies ist dank der kryptografischen Magie mit mehreren Signaturen m√∂glich, die oft als <em>Smart-Contract bezeichnet wird</em> .  Es gibt mehrere Implementierungen des LN-Protokolls.  Ich verwende die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">C-Lightning</a> C-Implementierung. </p><br><p>  Der Hauptunterschied zwischen On-Chain- und Off-Chain-Zahlungen (Lightning) besteht darin, wie Transaktionen gespeichert werden.  Alle <b>On-Chain-</b> Transaktionen werden an das gesamte Netzwerk gesendet, sodass jeder laufende Bitcoin-Knoten diese Transaktion in Blockchain aufzeichnet, wenn der Block, der diese Transaktion enth√§lt, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">abgebaut wird</a> .  Hey, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">BitFury</a> , habe ich recht?  ;) Deshalb nennen wir solche Transaktionen <b>On-Chain</b> .  Solche Transaktionen werden bis zum Ende ihrer Existenz in Blockchain gespeichert.  Es ist m√∂glich, solche Transaktionen √∂ffentlich √ºber das Netzwerk zu verfolgen, zu analysieren und zu √ºberwachen. </p><br><p>  Bei Transaktionen <b>au√üerhalb der Kette</b> (Lightning) geschieht dies auf andere Weise.  Jeder Blitzknoten hat <i>(m√∂glicherweise mehrere)</i> Adressen in der Kette, von denen aus alle beginnen.  Wenn Gelder an einer solchen Adresse eingehen, kann der Knoten unter Verwendung von Kryptografietechniken einen sogenannten <i>Blitzkanal</i> f√ºr einen anderen Knoten √∂ffnen, was bedeutet, dass diese beiden Knoten eine Vereinbarung √ºber die Verf√ºgbarkeit von Geldern zwischen ihnen getroffen haben.  Sp√§ter werden alle Transaktionen, die √ºber den Kanal ausgef√ºhrt werden (eigene Transaktionen oder Routing-Transaktionen von einem anderen Knoten), nur auf diesen beiden Knoten (und dem Zwischenknoten, falls vorhanden) gespeichert.  Die einzigen Transaktionen, die in der Blockchain des Netzwerks gespeichert sind, sind Transaktionen zum √ñffnen und Schlie√üen von Kan√§len.  Aus diesem Grund nennen wir Lightning-Transaktionen <b>Off-Chain</b> .  Meist existieren sie nur in der Knotendatenbankdatei. </p><br><h3>  Das Ganze wird im Diagramm visualisiert </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/3c6/636/b8c/3c6636b8c98d52aab9bd09ff9c52afcb.png" alt="Bild"><br><p>  Kurzgeschichte: </p><br><p>  1) Der Benutzer sendet eine Nachricht und fordert eine Einzahlung an den Bot per <b>Telegramm an</b> </p><br><p>  2) Telegramm l√∂st die <b>Python-App des</b> Bots aus </p><br><p>  3) Die <b>Python-App</b> sendet eine Anfrage an <b>BTCPayServer</b> </p><br><p>  4) BTCPayServer generiert eingehende Adressen f√ºr BTC und LTC und kontaktiert die Blitzgeb√ºhr, die Daten vom <b>c-lightning-</b> Daemon erh√§lt.  Als Ergebnis erhalten wir einen gut gehandhabten HTML-Frame f√ºr die Zahlungsabwicklung </p><br><p>  5) Der Benutzer zahlt die Rechnung und erh√§lt eine Best√§tigung </p><br><p>  6) <b>BTCPayServer</b> sendet eine <b>Rechnungszahlungsbenachrichtigung</b> (IPN) an die angegebene R√ºckruf-URL, in unserem Fall <br>  geht zu <b>callbacks.py</b> (eine andere Python-App, um auf R√ºckrufe zu warten) </p><br><p>  7) Entsprechend den vollst√§ndigen Zahlungsdetails wird das Benutzerguthaben ge√§ndert und der Benutzer erh√§lt eine Benachrichtigung </p><br><p>  <i>... wenn der Benutzer beschlie√üt, Geld abzuheben (erhaltene Tipps) ...</i> </p><br><p>  8) <b>Die Python-App von Bot</b> h√∂rt sich Text oder Bild von QR an. Wenn sie Rechnungsdaten (lange Zeichenfolge) erh√§lt, sendet sie eine Zahlungsaufforderung an diese Rechnung an eine andere Python-App <b>paylightning.py *</b> , die die Auszahlungen mit c-lightning initialisiert RPC </p><br><img src="https://habrastorage.org/getpro/habr/post_images/518/3dc/c81/5183dcc817817f1aa676ff74d17d08bb.png" alt="Bild"><br><p>  <i>* Um fair zu sein, muss ich erw√§hnen, dass mein Pay-Wrapper paylightning.py unvollst√§ndig ist und in bestimmten F√§llen falsch negativ zur√ºckgeben kann.</i>  <i>Bei produktions√§hnlicher Verwendung sollten Sie einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bew√§hrten Zahlungs-Wrapper f√ºr C-Lightning</a> verwenden.</i> </p><br><p>  Benutzer k√∂nnen sich gegenseitig Tipps zu Gruppenchats senden und <b>Werte</b> ohne Einschr√§nkungen senden / empfangen.  Aber das ist noch nicht alles.  Dank des Lightning Network-Protokolls, das sich in einer Art einheitlichem und vereinfachtem Zahlungsnetzwerk befindet, k√∂nnen Sie dieselben Guthabenm√ºnzen an v√∂llig unterschiedliche Apps senden.  Es gibt einen weiteren Bitcoin-Tipp-Bot im Telegramm - @lntxbot.  Der Benutzer kann eine Einzahlung f√ºr diesen Bot beantragen </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/f09/c3a/ef9/f09c3aef995f7a82560987646b0d8ee0.png" alt="Bild"><img src="https://habrastorage.org/getpro/habr/post_images/1e2/344/82c/1e234482c56aa0df1d4b341ecfe3beb8.png" alt="Bild"></p><br><p>  Leiten Sie einfach Daten von @lntxbot an @atomic_tipbot und voul'a weiter! </p><br><p>  Dies ist kein "Nummernwechsel in der Datenbank" mehr, sondern eine Zahlung zwischen zwei separaten, nicht verwandten "Datenbanken".  Bot hat bereits einige 'LApps' integriert: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sat2.io</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">lnsms.world</a> . </p><br><p>  <b>Sie fragen sich vielleicht, was genau <i>LApp-Integration</i> bedeutet?</b> </p><br><p>  Jeder <i>Lightning Network-</i> Knoten fungiert als Bitcoin-Brieftasche.  Es hat sowohl ein Gleichgewicht in der Kette als auch au√üerhalb der Kette.  Das On-Chain-Guthaben wird normalerweise verwendet, um Kan√§le zu √∂ffnen und Gelder aus geschlossenen Kan√§len zu speichern, kurz Wartungsaufgaben f√ºr kurze Knoten.  Das Off-Chain-Gleichgewicht wird genau verwendet, um Geld zwischen Knoten auszutauschen.  Die Kernfunktionen jedes Knotens sind die F√§higkeit, Geld zu senden oder zu empfangen. Daher bietet der Knoten als Software <i><b>Zahlungs-</b></i> und <i><b>Rechnungsmethoden</b></i> .  Ich werde kurz zeigen, wie es passiert: </p><br><pre><code class="bash hljs">user@ln-node:/ % lightning-cli invoice 1000000000 internal_description external_description { <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0"</span></span>, <span class="hljs-string"><span class="hljs-string">"expires_at"</span></span> : 1558709834, <span class="hljs-string"><span class="hljs-string">"bolt11"</span></span> : <span class="hljs-string"><span class="hljs-string">"lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6"</span></span> }</code> </pre> <br><p>  In diesem Fall wird die <a href="">BOLT11-Rechnung</a> erstellt. Dies ist ein einheitliches Format f√ºr Zahlungsanforderungen im Bitcoin-Netzwerk (sowie im Litecoin-Netzwerk).  Diese Zeichenfolge enth√§lt Daten zu Rechnungsempf√§nger, Betrag, Zeitstempel, Ablauf usw.  Um diesen String zu dekodieren, bietet c-lightning eine Decodepay-Methode: </p><br><pre> <code class="bash hljs">user@ln-node:/ % lightning-cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6 { <span class="hljs-string"><span class="hljs-string">"currency"</span></span> : <span class="hljs-string"><span class="hljs-string">"bc"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558105034, <span class="hljs-string"><span class="hljs-string">"expiry"</span></span> : 604800, <span class="hljs-string"><span class="hljs-string">"payee"</span></span> : <span class="hljs-string"><span class="hljs-string">"025a14b8ed40583d67aec92da19453e0b2d1fbbf75f96f85d3dd0ff61a51ee0490"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 1000000000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"1000000000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span> : <span class="hljs-string"><span class="hljs-string">"external_description"</span></span>, <span class="hljs-string"><span class="hljs-string">"min_final_cltv_expiry"</span></span> : 10, <span class="hljs-string"><span class="hljs-string">"routes"</span></span> : [ [ { <span class="hljs-string"><span class="hljs-string">"pubkey"</span></span> : <span class="hljs-string"><span class="hljs-string">"03a20c0c2ae4508b669a70e5f82f08f69a3da5da3bf0c973673c3fe977db0f61e3"</span></span>, <span class="hljs-string"><span class="hljs-string">"short_channel_id"</span></span> : <span class="hljs-string"><span class="hljs-string">"574012x1255x1"</span></span>, <span class="hljs-string"><span class="hljs-string">"fee_base_msat"</span></span> : 1000, <span class="hljs-string"><span class="hljs-string">"fee_proportional_millionths"</span></span> : 1, <span class="hljs-string"><span class="hljs-string">"cltv_expiry_delta"</span></span> : 144 } ] ], <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0"</span></span>, <span class="hljs-string"><span class="hljs-string">"signature"</span></span> : <span class="hljs-string"><span class="hljs-string">"304502210099f31dffd18b6db8296637db3e3a1ffbaf7b7db087a2ad1eedb7639f25e78b25022079038370073681aa1e1a7a05de6588e98ead078896d0a37a15b755c212dc3d37"</span></span> }</code> Blitz-cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6 <code class="bash hljs">user@ln-node:/ % lightning-cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6 { <span class="hljs-string"><span class="hljs-string">"currency"</span></span> : <span class="hljs-string"><span class="hljs-string">"bc"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558105034, <span class="hljs-string"><span class="hljs-string">"expiry"</span></span> : 604800, <span class="hljs-string"><span class="hljs-string">"payee"</span></span> : <span class="hljs-string"><span class="hljs-string">"025a14b8ed40583d67aec92da19453e0b2d1fbbf75f96f85d3dd0ff61a51ee0490"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 1000000000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"1000000000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span> : <span class="hljs-string"><span class="hljs-string">"external_description"</span></span>, <span class="hljs-string"><span class="hljs-string">"min_final_cltv_expiry"</span></span> : 10, <span class="hljs-string"><span class="hljs-string">"routes"</span></span> : [ [ { <span class="hljs-string"><span class="hljs-string">"pubkey"</span></span> : <span class="hljs-string"><span class="hljs-string">"03a20c0c2ae4508b669a70e5f82f08f69a3da5da3bf0c973673c3fe977db0f61e3"</span></span>, <span class="hljs-string"><span class="hljs-string">"short_channel_id"</span></span> : <span class="hljs-string"><span class="hljs-string">"574012x1255x1"</span></span>, <span class="hljs-string"><span class="hljs-string">"fee_base_msat"</span></span> : 1000, <span class="hljs-string"><span class="hljs-string">"fee_proportional_millionths"</span></span> : 1, <span class="hljs-string"><span class="hljs-string">"cltv_expiry_delta"</span></span> : 144 } ] ], <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0"</span></span>, <span class="hljs-string"><span class="hljs-string">"signature"</span></span> : <span class="hljs-string"><span class="hljs-string">"304502210099f31dffd18b6db8296637db3e3a1ffbaf7b7db087a2ad1eedb7639f25e78b25022079038370073681aa1e1a7a05de6588e98ead078896d0a37a15b755c212dc3d37"</span></span> }</code> </pre> <br><p>  F√ºr den Fall, dass wir eine Rechnung bezahlen m√ºssen, sollten wir die Zahlungsmethode von c-lightning verwenden: </p><br><pre> <code class="bash hljs">user@ln-node:/ % lightning-cli pay lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : 163, <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"c3e644a005f56e33df89facbce2c9dfcabbef5d105285a98272cacc77ab2de63"</span></span>, <span class="hljs-string"><span class="hljs-string">"destination"</span></span> : <span class="hljs-string"><span class="hljs-string">"03021c5f5f57322740e4ee6936452add19dc7ea7ccf90635f95119ab82a62ae268"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 200000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi_sent"</span></span> : 200003, <span class="hljs-string"><span class="hljs-string">"amount_sent_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200003msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558106072, <span class="hljs-string"><span class="hljs-string">"status"</span></span> : <span class="hljs-string"><span class="hljs-string">"complete"</span></span>, <span class="hljs-string"><span class="hljs-string">"payment_preimage"</span></span> : <span class="hljs-string"><span class="hljs-string">"1a9552b9f4e9199e26839353f870b12cc85b7674a2fb134e78aa370032611019"</span></span>, <span class="hljs-string"><span class="hljs-string">"bolt11"</span></span> : <span class="hljs-string"><span class="hljs-string">"lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j"</span></span> }</code> Blitz-cli Pay lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j <code class="bash hljs">user@ln-node:/ % lightning-cli pay lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : 163, <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"c3e644a005f56e33df89facbce2c9dfcabbef5d105285a98272cacc77ab2de63"</span></span>, <span class="hljs-string"><span class="hljs-string">"destination"</span></span> : <span class="hljs-string"><span class="hljs-string">"03021c5f5f57322740e4ee6936452add19dc7ea7ccf90635f95119ab82a62ae268"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 200000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi_sent"</span></span> : 200003, <span class="hljs-string"><span class="hljs-string">"amount_sent_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200003msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558106072, <span class="hljs-string"><span class="hljs-string">"status"</span></span> : <span class="hljs-string"><span class="hljs-string">"complete"</span></span>, <span class="hljs-string"><span class="hljs-string">"payment_preimage"</span></span> : <span class="hljs-string"><span class="hljs-string">"1a9552b9f4e9199e26839353f870b12cc85b7674a2fb134e78aa370032611019"</span></span>, <span class="hljs-string"><span class="hljs-string">"bolt11"</span></span> : <span class="hljs-string"><span class="hljs-string">"lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j"</span></span> }</code> </pre> <br><p>  Alle Status von Zahlungen werden vom gesamten Netzwerk und Ihrem eigenen Knoten verwaltet.  Sie m√ºssen (m√ºssen aber nicht) √ºberhaupt mit empfangsseitigen App-Entwicklern oder deren API, einem Kartenverarbeitungsanbieter oder einer Bank kommunizieren, um eine Best√§tigung √ºber Ihre Zahlung zu erhalten oder Geld von Ihrem eigenen freizugeben Konto.  Es gibt keine R√ºckbuchungen oder sonstigen externen Einfl√ºsse auf Ihren Kontostand.  Sie ben√∂tigen lediglich eine Software, die nach dezentralen Netzwerkregeln arbeitet.  Dies ist eine L√∂sung, um einen Wert √ºber das Internet auszutauschen, ohne dass ein Schiedsrichter in der Mitte ben√∂tigt wird, der √ºber Ihre Zahlungskompatibilit√§t mit einigen Regeln entscheidet, die manchmal sogar allen Parteien bisher unbekannt waren.  Es gibt keine "internen" Regeln in Bitcoin. Alle Regeln, die Ihre App erf√ºllen muss, sind offen und bekannt. </p><br><p>  Dies erm√∂glicht einen <b>direkten</b> , <b>fast kostenlosen</b> und <b>sofortigen</b> Werteaustausch √ºber das Internet zwischen Menschen oder sogar der Software selbst auf wirklich autonome Weise. </p><br><p>  Wenn es eine M√∂glichkeit gibt, Zahlungsdaten von einer anderen App abzurufen, k√∂nnen Sie finanziell damit umgehen.  Wie in unserem Beispiel ist lnsms.world eine Web-App, mit der Sie SMS an eine beliebige Nummer senden und mit Bitcoin bezahlen k√∂nnen.  Um eine solche Option in unsere App zu integrieren, m√ºssen wir lediglich die erforderlichen Daten vom Webformular an lnsms.world √ºbergeben: </p><br><pre> <code class="python hljs">payload = { <span class="hljs-string"><span class="hljs-string">'number'</span></span>: phone_number, <span class="hljs-string"><span class="hljs-string">'text'</span></span>: text, <span class="hljs-string"><span class="hljs-string">'force_unicode'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> } send_req = requests.post(<span class="hljs-string"><span class="hljs-string">'https://lnsms.world/invoice'</span></span>, data=payload) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> send_req.status_code == <span class="hljs-number"><span class="hljs-number">201</span></span>: plain_invoice = str(send_req.text)</code> </pre> <br><p>  Ich wei√ü nicht aus welchem ‚Äã‚ÄãGrund, aber lnsms antwortet mit 201 HTTP-Statuscode und gibt die BOLT11-Rechnung zur√ºck.  Nun, das reicht aus, um diese Rechnung zu bezahlen, und unsere Benutzer senden kurz nach Zahlungseingang eine SMS.  Wir k√∂nnen zus√§tzlich eine Geb√ºhr erheben oder nicht, das ist unsere freie Wahl. </p><br><p>  Stellen Sie sich nun vor, Ihr Bot ist tats√§chlich eine n√ºtzlichere App und zahlt nicht einen anderen Bot, sondern eine andere Entit√§t, die mit dem Internet verbunden ist.  Oder k√∂nnen dies Zahlungen zwischen Software, Maschinen, Gesch√§ften und Dienstleistern sein, die regelm√§√üig alle paar Sekunden wiederholt werden?  Sp√ºren Sie die Kraft von Mikrozahlungen?  So wird das Internet der Dinge aussehen.  Bereits jetzt gibt es Projekte wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://althea.org/,</a> und in naher Zukunft werden wir gro√üen Ver√§nderungen auf dem Gebiet gegen√ºberstehen, das wir E-Commerce nennen. </p><br><p>  Wenn Ihnen dieser Beitrag gef√§llt und Sie Bitcoin-Zahlungen selbst ausprobieren m√∂chten, k√∂nnen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mir einen Tipp auf meiner Trinkgeldseite hinterlassen</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de452666/">https://habr.com/ru/post/de452666/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de452648/index.html">PHP: Wie man eine komplexe XML-Datei analysiert und nicht in nativem Code ertrinkt</a></li>
<li><a href="../de452652/index.html">Sicherheitswoche 21: Eine L√ºcke in WhatsApp, eine neue Sicherheitsl√ºcke in Intel-Prozessoren, Zero-Day in Windows</a></li>
<li><a href="../de452656/index.html">Entwicklung der einfachsten ‚ÄûFirmware‚Äú f√ºr in Redd installierte FPGAs und Debugging am Beispiel des Speichertests</a></li>
<li><a href="../de452662/index.html">HPE Server in Selectel</a></li>
<li><a href="../de452664/index.html">Ich habe 18.000 US-Dollar f√ºr eine statische Webseite in Rechnung gestellt ... und bin damit durchgekommen</a></li>
<li><a href="../de452668/index.html">So √ºberpr√ºfen Sie Cookies auf Einhaltung der DSGVO - ein neues offenes Tool hilft dabei</a></li>
<li><a href="../de452670/index.html">Wer sind Dateningenieure und wie werden sie?</a></li>
<li><a href="../de452672/index.html">W√∂chentlich Habr. Lernen Sie die Habrapodcast-Pilotversion kennen</a></li>
<li><a href="../de452674/index.html">Digitale Veranstaltungen in Moskau vom 21. bis 26. Mai</a></li>
<li><a href="../de452682/index.html">Prognose und Diskussion: Hybridspeichersysteme werden All-Flash weichen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>