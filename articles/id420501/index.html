<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👍🏻 🚈 🎫 Linux dalam RAM: cara debirf 2018 🌥️ 🏵️ 🍞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Linux dalam RAM: cara debirf 


 Apakah Anda ingin memiliki kecepatan disk absolut saat ini, bukan? Mari kita merevisi bagaimana hal itu dapat dilakuk...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Linux dalam RAM: cara debirf 2018</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420501/"><h1 id="linux-in-ram-debirf-way">  Linux dalam RAM: cara debirf </h1><br><p>  Apakah Anda ingin memiliki kecepatan disk absolut saat ini, bukan?  Mari kita merevisi bagaimana hal itu dapat dilakukan dengan versi dan otomatisasi pada tahun 2018. </p><br><blockquote>  Dari moderator: sebuah artikel dalam bahasa Inggris datang kepada kami di Sandbox.  Kami membacanya dan memutuskan untuk menerbitkannya sebagai percobaan hari Jumat.  Jangan menilai dengan ketat, semua orang damai dan senang Jumat!  Ayo datang bersama!  Singkatnya, Dari Bawah Hati Aua. </blockquote><a name="habracut"></a><br><h2 id="changelog">  Changelog: </h2><br><ul><li>  Bahasa artikel dikoreksi dalam bahasa Inggris </li><li>  repositori sampel diperkenalkan di <a href="">github</a> </li><li>  Menambahkan params uji </li><li>  tambah asciicast </li></ul><br><h2 id="you-must-know-before-running-this-tutorial">  Anda harus tahu sebelum menjalankan tutorial ini: </h2><br><ul><li>  linux penting </li><li>  perbedaan utama antara bash dan sh (debirf tertulis di sh, jadi saya sarankan untuk mengikuti style) </li><li>  cara memformat kunci usb (dengan cara apa pun) </li><li>  driver apa yang dibutuhkan untuk perangkat keras Anda (atau Anda dapat men-debug-nya via dmesg | lspci) </li><li>  cara mendapatkan tujuan tugas Anda melalui skrip </li></ul><br><h3 id="you-can-replace">  Anda dapat mengganti: </h3><br><ul><li> surat usb dari <code>/dev/sdb</code> ke yang lain ( <code>/dev/sdd</code> ) </li><li>  direktori kerja dari <code>/root/Projects/debirf/</code> ke pilihan Anda ( <code>/home/username/Documents/debirf</code> ) </li><li>  mountpoint dari <code>/media/root/8B46-1189</code> ke <code>/media/username/myflashdrive</code> </li></ul><br><h2 id="steps-to-preparing">  Langkah-langkah persiapan </h2><br><p>  Mereka (opsional) mengaktifkan komponen yang tidak bebas untuk instalasi dasar.  Selain itu, saya pikir, Anda akan memerlukan repositori yang tidak bebas. </p><br><ul><li>  buka baris nomor 107 dari file <code>/usr/bin/debirf</code> seperti <code>nano +107 $(which debirf)</code> </li><li>  temukan fungsi <code>create_debootstrap</code> </li><li>  temukan baris seperti <code>local OPTS="</code> </li><li>  tambahkan <code>--components main,contrib,non-free</code> dalam tanda kurung </li></ul><br><h3 id="up-to-start">  Mulai: </h3><br><p>  Bayangkan, flash drive kami: </p><br><ul><li>  harus cepat, jadi disarankan untuk menggunakan kelas 8+, atau booting akan memakan waktu yang cukup </li><li>  / dev / sdb </li><li>  dibentuk </li><li>  dipasang di <code>/media/root/8B46-1189</code> . </li><li>  direktori kerja kami <code>/root/Projects/debirf/</code> </li></ul><br><h3 id="install-debirf">  Instal debirf </h3><br><pre> <code class="bash hljs">apt-get install -yq debirf mtools genisoimage</code> </pre> <br><ul><li>  mtools diperlukan untuk membuat iso melalui debirf (tidak berfungsi, tetapi dibutuhkan) </li><li>  genisoimage diperlukan untuk membuat iso yang berfungsi nyata (opsional) </li></ul><br><h3 id="prepare-debirf-working-directory">  Mempersiapkan direktori kerja debirf </h3><br><pre> <code class="bash hljs">mkdir -p /root/Projects/debirf tar xzf /usr/share/doc/debirf/example-profiles/rescue.tgz -C /root/Projects/debirf <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /root/Projects/debirf/rescue</code> </pre> <br><h3 id="and-configure-rootprojectsdebirfrescuedebirfconf">  Dan konfigurasikan /root/Projects/debirf/rescue/debirf.conf </h3><br><pre> <code class="bash hljs">DEBIRF_LABEL=<span class="hljs-string"><span class="hljs-string">"debirf-rescue"</span></span> DEBIRF_SUITE=stretch DEBIRF_DISTRO=debian DEBIRF_MIRROR=http://ftp.ru.debian.org/debian/</code> </pre> <br><h2 id="create-lir">  Buat LiR </h2><br><ul><li>  Jalankan <code>debirf make .</code>  dan pergi.  Perlu banyak waktu, minimal 15 menit pada perangkat keras teratas. </li><li>  Jalankan <code>debirf makeiso .</code>  untuk membuat iso yang tidak berfungsi (diperlukan untuk file grub.cfg) </li></ul><br><h2 id="test-it">  Uji itu </h2><br><ul><li>  Instal qemu <br><ul><li>  untuk linux: <code>apt-get install -yq qemu</code> </li><li>  untuk macos: <code>brew install qemu</code> </li></ul></li><li>  memutuskan sumber daya mana yang akan dialokasikan untuk VM <br><ul><li>  <code>-smp 1</code> 1 kernel sebenarnya </li><li>  <code>-m 1G</code> 1G memori </li></ul></li><li>  tambahan <br><ul><li>  <code>-nographic</code> akan meluncurkan VM di jendela terminal saat ini </li><li>  <code>--enable-kvm</code> memungkinkan akselerasi perangkat keras </li><li>  <code>-kernel vmlinuz-*</code> izin langsung lewat kernel </li><li>  <code>-initrd *.cgz</code> akses langsung ke file .cgz dengan initramfs </li><li>  <code>-append</code> memungkinkan memotong kernel kernel, berikut adalah parameter untuk berjalan tanpa shell grafis </li></ul></li></ul><br><p>  Perintah untuk memulai mesin virtual: </p><br><pre> <code class="hljs powershell">qemu<span class="hljs-literal"><span class="hljs-literal">-system</span></span><span class="hljs-literal"><span class="hljs-literal">-x86_64</span></span> -<span class="hljs-literal"><span class="hljs-literal">-enable</span></span><span class="hljs-literal"><span class="hljs-literal">-kvm</span></span> <span class="hljs-literal"><span class="hljs-literal">-kernel</span></span> vmlinuz-* <span class="hljs-literal"><span class="hljs-literal">-initrd</span></span> *.cgz <span class="hljs-literal"><span class="hljs-literal">-append</span></span> <span class="hljs-string"><span class="hljs-string">"console=tty0 console=ttyS0,115200n8"</span></span> <span class="hljs-literal"><span class="hljs-literal">-m</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>G <span class="hljs-literal"><span class="hljs-literal">-smp</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-literal"><span class="hljs-literal">-net</span></span> nic,vlan=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-literal"><span class="hljs-literal">-net</span></span> user <span class="hljs-literal"><span class="hljs-literal">-nographic</span></span></code> </pre> <br><h2 id="test-sample">  Sampel uji </h2><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/598/20d/844/59820d84417c9906094293213420985a.png" alt="asciicast"></a> </p><br><h3 id="install-grub-to-flash-drive-and-copy-lir-on-it">  Instal grub ke flash drive dan salin LiR di atasnya </h3><br><p>  Saya sarankan Anda menggunakan boot BIOS legacy dan paket grub-pc.  Tidak diuji dengan UEFI, tetapi harus bekerja.  Baris selanjutnya akan dilakukan: </p><br><ul><li>  buat mount point (pada sistem bertenaga GUI diaktifkan auto-mount tidak diperlukan) </li><li>  pasang kunci usb ke titik pemasangan (pada sistem bertenaga GUI diaktifkan, pasang otomatis tidak diperlukan) </li><li>  instal grub </li><li>  salin file grub </li><li>  salin initramfs (sistem) </li><li>  salin vmlinuz (kernel) </li><li>  lepaskan kunci usb </li><li>  hapus mount point </li></ul><br><pre> <code class="bash hljs">mkdir -p /media/root/8B46-1189 mount /dev/sdb1 /media/root/8B46-1189 grub-install --boot-directory=/media/root/8B46-1189/boot /dev/sdb cp /root/Projects/debirf/rescue/iso/boot/grub/grub.cfg /media/root/8B46-1189/boot/grub/ cp /root/Projects/debirf/rescue/*.cgz /media/root/8B46-1189 cp /root/Projects/debirf/rescue/vmlinuz-* /media/root/8B46-1189 umount /media/root/8B46-1189 rm -rf /media/root/8B46-1189</code> </pre> <br><h3 id="create-bootable-iso-optional">  Buat iso yang dapat di-boot (opsional) </h3><br><ul><li>  unduh isolinux.bin </li><li>  buat file konfigurasi isolinux </li><li>  buat iso </li></ul><br><pre> <code class="bash hljs">mkdir -p rescue/iso/isolinux/ wget -O rescue/iso/isolinux/isolinux.bin <span class="hljs-string"><span class="hljs-string">'http://mirror.yandex.ru/centos/7/os/x86_64/isolinux/isolinux.bin'</span></span> cat &lt;&lt; EOF &gt; rescue/iso/isolinux/isolinux.cfg TIMEOUT 5 DEFAULT lir LABEL lir LINUX /vmlinuz-4.9.0-7-amd64 INITRD /debirf-rescue_stretch_4.9.0-7-amd64.cgz EOF genisoimage -b isolinux/isolinux.bin -c isolinux/boot.cat -no-emul-boot -boot-load-size 4 -boot-info-table -l -input-charset default -V LiR -A <span class="hljs-string"><span class="hljs-string">"Linux in RAM"</span></span> -o rescue/rescue.iso rescue/iso/</code> </pre> <br><h2 id="check-result">  Periksa hasilnya </h2><br><ul><li>  Instal QEMU hypervisor <code>apt-get install -yq qemu</code> </li><li>  jalankan <code>qemu-system-x86_64 -enable-kvm -m 512 -hda /dev/sdb</code> </li><li>  jika perintah sebelumnya gagal, hapus <code>-enable-kvm</code> </li><li>  VM akan dimulai, di-boot dari kunci usb </li><li>  Anda harus melihat dua item menu, perbedaan pada akhirnya: konsol dan serial.  Pilih entri pertama. </li><li>  dalam ~ menit Anda akan melihat banyak baris.  setelah itu berakhir - tekan enter untuk melihat pesan selamat datang </li><li>  login: root, tanpa kata sandi </li></ul><br><h2 id="customize-it-create-custom-debirf-module">  Kustomisasi: Buat modul debirf khusus </h2><br><p>  Modul - skrip sh yang dapat dieksekusi untuk dijalankan selama pembuatan LiR </p><br><ul><li>  buat file modul </li><li>  urutan nama file itu penting.  Dalam <code>network</code> file, file penyelesaian akan diubah menjadi sistem-diselesaikan, dan Anda tidak dapat bekerja dengan jaringan; </li><li>  baris dari 1 hingga 3 harus ada, baris 3 harus menunjukkan nama file </li><li>  jika Anda ingin menginstal paket - gunakan konstruksi <code>#DEBIRF_PACKAGE&gt;+</code> </li><li>  jika Anda ingin bekerja dengan rootfs - gunakan <code>$DEBIRF_ROOT</code> </li><li>  jika Anda ingin menjalankan perintah di fakeroot - gunakan <code>debirf_exec</code> </li></ul><br><h3 id="sample">  Sampel: </h3><br><pre> <code class="bash hljs">cat &lt;&lt;&lt; EOF &gt; rescue/modules/mi <span class="hljs-comment"><span class="hljs-comment">#!/bin/sh -e # debirf module: mi # prepare to run on mi notebook # # This script were written by # Eduard Generalov &lt;eduard@generalov.net&gt; # # They are Copyright 2018, and published under the MIT, #DEBIRF_PACKAGE&gt;+firmware-iwlwifi #DEBIRF_PACKAGE&gt;+firmware-misc-nonfree #DEBIRF_PACKAGE&gt;+wpasupplicant echo 'iwlwifi' &gt;&gt; $DEBIRF_ROOT/etc/modules cat &lt;&lt; EOF &gt; $DEBIRF_ROOT/etc/wpa_supplicant/wpa_supplicant-wlp1s0.conf ctrl_interface=/run/wpa_supplicant update_config=1 network={ ssid="WiFi_SSID" psk="WIFIPASSWORD" } EOF cat &lt;&lt; EOF &gt; $DEBIRF_ROOT/etc/systemd/network/wireless.network [Match] Name=wlp1s0 [Network] DHCP=ipv4 [DHCP] RouteMetric=20 EOF</span></span></code> </pre><br><p>  dan ganti baris dengan yang <code>resolved</code> dalam file rescue / modul / jaringan dengan <code>debirf_exec systemctl enable wpa_supplicant@wlp1s0.service systemd-networkd.service systemd-resolved.service</code> </p><br><h3 id="bonus-lxc-on-lir">  Bonus: lxc pada LiR </h3><br><p>  penyelamatan modul / modul / lxc </p><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh -e # debirf module: lxc # prepare lxc # # This script were written by # Eduard Generalov &lt;eduard@generalov.net&gt; # # They are Copyright 2018, and published under the MIT, #DEBIRF_PACKAGE&gt;+lxc mkdir -p $DEBIRF_ROOT/root/.ssh/ ssh-keygen -b 2048 -t rsa -f $DEBIRF_ROOT/root/.ssh/id_rsa -q -N "" cp $DEBIRF_ROOT/root/.ssh/id_rsa $DEBIRF_ROOT/root/.ssh/authorized_keys chmod 400 $DEBIRF_ROOT/root/.ssh/authorized_keys debirf_exec systemctl enable lxc-net cat &lt;&lt; EOF &gt; $DEBIRF_ROOT/etc/lxc/default.conf lxc.network.type = veth lxc.network.link = lxc lxc.network.name = eth0 lxc.network.flags = up lxc.network.hwaddr = 00:FF:AA:FF:xx:xx lxc.mount.entry=/var/cache/apt var/cache/apt none bind,rw 0 0 lxc.mount.entry = /root/.ssh/ root/.ssh none bind,create=dir 0 0 EOF cat &lt;&lt; EOF &gt; $DEBIRF_ROOT/etc/default/lxc-net USE_LXC_BRIDGE="true" LXC_BRIDGE="lxc" LXC_ADDR="10.0.3.1" LXC_NETMASK="255.255.255.0" LXC_NETWORK="10.0.3.0/24" LXC_DHCP_RANGE="10.0.3.2,10.0.3.254" LXC_DHCP_MAX="253" LXC_DHCP_CONFILE="" LXC_DOMAIN="lxc" EOF</span></span></code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id420501/">https://habr.com/ru/post/id420501/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id420491/index.html">Caraku seorang pejuang, atau bagaimana aku menyiapkan aplikasi untuk hidup di Sailfish</a></li>
<li><a href="../id420493/index.html">Bisakah layanan pemesanan makanan Amerika menjadi Amazon di dunia restoran</a></li>
<li><a href="../id420495/index.html">Rendering air layar</a></li>
<li><a href="../id420497/index.html">Singularity Sayuran: Kroger Meluncurkan Robocouriers untuk Pelanggan Buah dan Sayuran di Arizona</a></li>
<li><a href="../id420499/index.html">Anatomi sistem rekomendasi. Bagian satu</a></li>
<li><a href="../id420503/index.html">Hari Pengembang JS, berbagai kota dan komunitas - satu hari libur</a></li>
<li><a href="../id420505/index.html">Akankah OpenAI Five memenangkan tim profesional di The International</a></li>
<li><a href="../id420507/index.html">Latar Belakang: Internet global untuk semua dan penciptanya</a></li>
<li><a href="../id420509/index.html">Masalah yang jelas dengan menggunakan menegaskan</a></li>
<li><a href="../id420511/index.html">Bekerja sebagai spesialis IT di Timur Jauh - Wilayah Amur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>