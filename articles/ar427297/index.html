<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฉ๐ผโ๐ญ ๐ ๐ฆ Apache Ignite + Apache Spark Data Frames: ูุนูุง ุฃูุซุฑ ูุชุนุฉ ๐ ๐ค ๐๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฑุญุจุง ูุง ูุจุฑ! ุงุณูู ูููููุงู ุฅูุฒูููู ุ ุฃุนูู ูุฏู Sberbank Technologies ูู ูุฑูู ุชุทููุฑ ุญููู ุงููุตุงุฏุฑ ุงูููุชูุญุฉ. ุฎูู 15 ุนุงููุง ูู ุงูุชุทููุฑ ุงูุชุฌุงุฑู ูู ุฌุงูุฉ. ุฃูุง ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Apache Ignite + Apache Spark Data Frames: ูุนูุง ุฃูุซุฑ ูุชุนุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sberbank/blog/427297/" style=";text-align:right;direction:rtl">  ูุฑุญุจุง ูุง ูุจุฑ!  ุงุณูู ูููููุงู ุฅูุฒูููู ุ ุฃุนูู ูุฏู Sberbank Technologies ูู ูุฑูู ุชุทููุฑ ุญููู ุงููุตุงุฏุฑ ุงูููุชูุญุฉ.  ุฎูู 15 ุนุงููุง ูู ุงูุชุทููุฑ ุงูุชุฌุงุฑู ูู ุฌุงูุฉ.  ุฃูุง ุนุถู ูู Apache Ignite ููุณุงูู ูู Apache Kafka. <br><br>  ุชุญุช ุงููุทุฉ ุ ุณุชุฌุฏ ูุณุฎุฉ ููุฏูู ููุต ูู ุชูุฑูุฑู ุนู Apache Ignite Meetup ุญูู ููููุฉ ุงุณุชุฎุฏุงู Apache Ignite ูุน Apache Spark ูุงูููุฒุงุช ุงูุชู ูููุง ุจุชูููุฐูุง ููุฐุง ุงูุบุฑุถ. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f42/5f3/df5/f425f3df59ff99d03d4a3e6aff3b2655.png"><br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ูุง ูููู ุฃู ููุนูู ุฃุจุงุชุดู ุณุจุงุฑู </h2><br>  ูุง ูู ุฃุจุงุชุดู ุณุจุงุฑูุ  ูุฐุง ููุชุฌ ูุณูุญ ูู ุจุฅุฌุฑุงุก ุงุณุชุนูุงูุงุช ุงูุญูุณุจุฉ ูุงูุชุญููู ุงูููุฒุนุฉ ุจุณุฑุนุฉ.  ูู ุงูุฃุณุงุณ ุ ุชูุช ูุชุงุจุฉ Apache Spark ูู Scala. <br><br>  ูุญุชูู Apache Spark ุนูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ุบููุฉ ููุงุชุตุงู ุจุฃูุธูุฉ ุงูุชุฎุฒูู ุงููุฎุชููุฉ ุฃู ุงุณุชูุจุงู ุงูุจูุงูุงุช.  ูุงุญุฏุฉ ูู ููุฒุงุช ุงูููุชุฌ ูู ูุญุฑู ุงุณุชุนูุงู ุนุงููู ูุดุจู SQL ููุจูุงูุงุช ุงููุณุชููุฉ ูู ูุตุงุฏุฑ ูุฎุชููุฉ.  ุฅุฐุง ูุงู ูุฏูู ุงูุนุฏูุฏ ูู ูุตุงุฏุฑ ุงููุนูููุงุช ุ ูุฃูุช ุชุฑูุฏ ุฏูุฌูุง ูุงูุญุตูู ุนูู ุจุนุถ ุงููุชุงุฆุฌ ุ ูุฅู Apache Spark ูู ูุง ุชุญุชุงุฌู. <br><br>  ูุงุญุฏุฉ ูู ุงูุชุฌุฑูุฏุงุช ุงูุฑุฆูุณูุฉ ุงูุชู ุชููุฑูุง Spark ูู Data Frame ู DataSet.  ูู ุญูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุนูุงุฆููุฉ ุ ูุฐุง ุฌุฏูู ุ ูุตุฏุฑ ูููุฑ ุงูุจูุงูุงุช ุจุทุฑููุฉ ููุธูุฉ.  ุงููููู ูููุน ูู ุนููุฏ ูุงุณูู ุ ููุง ุฅูู ุฐูู ุ ูุนุฑูู.  ูููู ุฅูุดุงุก ุฅุทุงุฑุงุช ุงูุจูุงูุงุช ูู ูุตุงุฏุฑ ูุฎุชููุฉ.  ุชุชุถูู ุงูุฃูุซูุฉ ูููุงุช json ูููุงุนุฏ ุงูุจูุงูุงุช ุงูุนูุงุฆููุฉ ูุฃูุธูุฉ hadoop ุงููุฎุชููุฉ ู Apache Ignite. <br><br>  ูุฏุนู Spark ุงูุตูุงุช ูู ุงุณุชุนูุงูุงุช SQL.  ููููู ุงูุฌูุน ุจูู ุงูุจูุงูุงุช ูู ูุตุงุฏุฑ ูุฎุชููุฉ ูุงูุญุตูู ุนูู ูุชุงุฆุฌ ูุฅุฌุฑุงุก ุงุณุชุนูุงูุงุช ุชุญููููุฉ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ููุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ูุญูุธ ุงูุจูุงูุงุช.  ุนูุฏ ุงูุงูุชูุงุก ูู ุงูุงุณุชุนูุงูุงุช ุ ูุฅุฌุฑุงุก ุฏุฑุงุณุฉ ุ ูููุฑ Spark ุงููุฏุฑุฉ ุนูู ุญูุธ ุงููุชุงุฆุฌ ุฅูู ุฌูุงุฒ ุงูุงุณุชูุจุงู ุงูุฐู ูุฏุนู ูุฐู ุงูููุฒุฉ ุ ูุจุงูุชุงูู ุ ุญู ูุดููุฉ ูุนุงูุฌุฉ ุงูุจูุงูุงุช. <br><br><h2 style=";text-align:right;direction:rtl">  ูุง ูู ุงูููุฒุงุช ุงูุชู ูููุง ุจุชุทุจูููุง ูุฏูุฌ Apache Spark ูุน Apache Ignite </h2><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฑุงุกุฉ ุงูุจูุงูุงุช ูู ุฌุฏุงูู Apache Ignite SQL. </li><li style=";text-align:right;direction:rtl">  ูุชุงุจุฉ ุงูุจูุงูุงุช ุนูู Apache Ignite ุฌุฏุงูู SQL. </li><li style=";text-align:right;direction:rtl">  IgniteCatalog ุฏุงุฎู IgniteSparkSession - ุงููุฏุฑุฉ ุนูู ุงุณุชุฎุฏุงู ุฌููุน ุฌุฏุงูู Ignite SQL ุงูููุฌูุฏุฉ ุฏูู ุชุณุฌูู "ูุฏูููุง". </li><li style=";text-align:right;direction:rtl">  ุชุญุณูู SQL - ุงููุฏุฑุฉ ุนูู ุชูููุฐ ุนุจุงุฑุงุช SQL ุฏุงุฎู Ignite. </li></ol><br>  ูููู ูู Apache Spark ูุฑุงุกุฉ ุงูุจูุงูุงุช ูู Apache Ignite ุฌุฏุงูู SQL ููุชุงุจุชูุง ูู ุดูู ูุซู ูุฐุง ุงูุฌุฏูู.  ูููู ุญูุธ ุฃู DataFrame ุชู ุชููููู ูู Spark ูุฌุฏูู Apache Ignite SQL. <br><br>  ูุณูุญ ูู Apache Ignite ุจุงุณุชุฎุฏุงู ุฌููุน ุฌุฏุงูู Ignite SQL ุงูููุฌูุฏุฉ ูู Spark Session ุฏูู ุชุณุฌูู "ูุฏูููุง" - ุจุงุณุชุฎุฏุงู IgniteCatalog ุฏุงุฎู ุงูุชุฏุงุฏ SparkSession ุงูููุงุณู - IgniteSparkSession. <br><br>  ููุง ุชุญุชุงุฌ ุฅูู ุงูุชุนูู ุฃูุซุฑ ูู ุฌูุงุฒ Spark.  ูู ุญูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุนุงุฏูุฉ ุ ุงูุฏููู ูู ููุงู ูุชู ููู ุชุฎุฒูู ุงููุนูููุงุช ุงููุตููุฉ: ุงูุฌุฏุงูู ุงููุชุงุญุฉ ุ ูุงูุฃุนูุฏุฉ ุงูููุฌูุฏุฉ ูููุง ุ ุฅูุฎ.  ุนูุฏ ูุตูู ุทูุจ ุ ูุชู ุณุญุจ ูุนูููุงุช ุงูุชุนุฑูู ูู ุงููุชุงููุฌ ููููู ูุดุบู SQL ุจุดูุก ูุน ุงูุฌุฏุงูู ูุงูุจูุงูุงุช.  ุจุดูู ุงูุชุฑุงุถู ุ ูู Spark ุ ูุฌุจ ุชุณุฌูู ุฌููุน ุฌุฏุงูู ุงููุฑุงุกุฉ (ูุง ููู ุ ูู ูุงุนุฏุฉ ุจูุงูุงุช ุนูุงุฆููุฉ ุ Ignite ุ Hadoop) ูุฏูููุง ูู ุงูุฌูุณุฉ.  ููุชูุฌุฉ ูุฐูู ุ ุชุญุตู ุนูู ูุฑุตุฉ ูุฅุฌุฑุงุก ุงุณุชุนูุงู SQL ุนูู ูุฐู ุงูุฌุฏุงูู.  ุงูุชุดู ุณุจุงุฑู ุนููู. <br><br>  ููุนูู ูุน ุงูุจูุงูุงุช ุงูุชู ูููุง ุจุชุญููููุง ุฅูู Ignite ุ ูุญุชุงุฌ ุฅูู ุชุณุฌูู ุงูุฌุฏุงูู.  ูููู ุจุฏูุงู ูู ุชุณุฌูู ูู ุทุงููุฉ ุจุฃูุฏููุง ุ ูููุง ุจุชูููุฐ ุงููุฏุฑุฉ ุนูู ุงููุตูู ุชููุงุฆููุง ุฅูู ุฌููุน ุฌุฏุงูู Ignite. <br><br>  ูุง ูู ุงูููุฒุฉ ููุงุ  ูุณุจุจ ูุง ูุง ุฃุนุฑูู ุ ูุฅู ุงูุฏููู ูู Spark ุนุจุงุฑุฉ ุนู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ุฏุงุฎููุฉ ุ ุฃู  ูุง ูููู ูุดุฎุต ุบุฑูุจ ุฃู ูุฃุชู ูุฅูุดุงุก ุชุทุจูู ุงููุชุงููุฌ ุงูุฎุงุต ุจู.  ูุจูุง ุฃู ุณุจุงุฑู ุฎุฑุฌ ูู Hadoop ุ ูุฅูู ูุฏุนู Hive ููุท.  ููุฌุจ ุนููู ุชุณุฌูู ูู ุดูุก ุขุฎุฑ ุจูุฏูู.  ุบุงูุจูุง ูุง ูุณุฃู ุงููุณุชุฎุฏููู ููู ููููู ุงูุงูุชูุงู ุญูู ูุฐุง ูุฅุฌุฑุงุก ุงุณุชุนูุงูุงุช SQL ุนูู ุงูููุฑ.  ููุฏ ููุช ุจุชุทุจูู ุฏููู ูุณูุญ ูู ุจุชุตูุญ ุฌุฏุงูู Ignite ูุงููุตูู ุฅูููุง ุฏูู ุชุณุฌูู ~ ูุฑุณุงุฆู sms ~ ุ ููุฏ ุงูุชุฑุญุช ูุฐุง ุงูุชุตุญูุญ ูู ุงูุจุฏุงูุฉ ูู ูุฌุชูุน Spark ุ ูุงูุฐู ุชูููุช ุฅุฌุงุจุฉ ุนููู: ูุซู ูุฐุง ุงูุชุตุญูุญ ุบูุฑ ูุซูุฑ ููุงูุชูุงู ูุจุนุถ ุงูุฃุณุจุงุจ ุงูุฏุงุฎููุฉ.  ููู ูุนุทูุง API ุงูุฏุงุฎูู. <br><br>  ูุนุฏ ูุชุงููุฌ Ignite ุงูุขู ููุฒุฉ ูุซูุฑุฉ ููุงูุชูุงู ูุชู ุชูููุฐูุง ุจุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Spark ุงูุฏุงุฎููุฉ.  ูุงุณุชุฎุฏุงู ูุฐุง ุงูุฏููู ุ ูุฏููุง ุชูููุฐูุง ุงูุฎุงุต ููุฌูุณุฉ. ูุฐุง ูู SparkSession ุงููุนุชุงุฏ ุ ุงูุฐู ููููู ูู ุฎูุงูู ุชูุฏูู ุงูุทูุจุงุช ููุนุงูุฌุฉ ุงูุจูุงูุงุช.  ุงูุงุฎุชูุงูุงุช ูู ุฃููุง ุฏูุฌูุง ExternalCatalog ููู ููุนูู ูุน ุฌุฏุงูู Ignite ุ ุจุงูุฅุถุงูุฉ ุฅูู IgniteOptimization ุ ูุงูุฐู ุณูุชู ูุตูู ุฃุฏูุงู. <br><br>  <b>ุชุญุณูู SQL</b> - ุงููุฏุฑุฉ ุนูู ุชูููุฐ ุนุจุงุฑุงุช SQL ุฏุงุฎู Ignite.  ุจุดูู ุงูุชุฑุงุถู ุ ุนูุฏ ุฅุฌุฑุงุก ุงูุงูุถูุงู ูุงูุชุฌููุน ูุงูุญุณุงุจ ุงูุชุฌููุนู ูุงุณุชุนูุงูุงุช SQL ุงููุนูุฏุฉ ุงูุฃุฎุฑู ุ ููุฑุฃ Spark ุงูุจูุงูุงุช ูู ูุถุน ุงูุตู ุชูู ุงูุขุฎุฑ.  ุงูุดูุก ุงููุญูุฏ ุงูุฐู ูููู ููุตุฏุฑ ุงูุจูุงูุงุช ุงูููุงู ุจู ูู ุชุตููุฉ ุงูุตููู ุจููุงุกุฉ. <br><br>  ุฅุฐุง ููุช ุชุณุชุฎุฏู ุงูุงูุถูุงู ุฃู ุงูุชุฌููุน ุ ูุฅู Spark ุชุณุญุจ ุฌููุน ุงูุจูุงูุงุช ูู ุงูุฌุฏูู ุฅูู ุฐุงูุฑุชูุง ููุนุงูู ุ ุจุงุณุชุฎุฏุงู ุนูุงูู ุงูุชุตููุฉ ุงููุญุฏุฏุฉ ุ ูุนูุฏุฆุฐ ููุท ุชููู ุจุชุฌููุนูุง ุฃู ุฅุฌุฑุงุก ุนูููุงุช SQL ุฃุฎุฑู.  ูู ุญุงูุฉ Ignite ุ ููุณ ูุฐุง ูู ุงูุฃูุซู ุ ูุฃู Ignite ููุณูุง ูุฏููุง ุจููุฉ ููุฒุนุฉ ููุฏููุง ูุนุฑูุฉ ุจุงูุจูุงูุงุช ุงููุฎุฒูุฉ ูููุง.  ูุฐูู ุ ูููู ูู Ignite ููุณูุง ุญุณุงุจ ุงูุชุฌููุนุงุช ุจููุงุกุฉ ูุชูููุฐ ุงูุชุฌููุน.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูููู ุฃู ูููู ููุงู ุงููุซูุฑ ูู ุงูุจูุงูุงุช ุ ููุฌูุนูุง ุ ุณุชุญุชุงุฌ ุฅูู ุทุฑุญ ูู ุดูุก ุ ูุฑูุน ุฌููุน ุงูุจูุงูุงุช ูู Spark ุ ููู ุฃูุฑ ูููู ููุบุงูุฉ. <br><br>  ูููุฑ Spark ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ููููู ูู ุฎูุงููุง ุชุบููุฑ ุงูุฎุทุฉ ุงูุฃูููุฉ ูุงุณุชุนูุงู SQL ุ ูุฅุฌุฑุงุก ุงูุชุญุณูู ูุฅุนุงุฏุฉ ุชูุฌูู ุฌุฒุก ุงุณุชุนูุงู SQL ุงูุฐู ูููู ุชูููุฐู ููุงู ูู Ignite.  ุณูููู ูุฐุง ูุนุงููุง ูู ุญูุซ ุงูุณุฑุนุฉ ููุฐูู ุงุณุชููุงู ุงูุฐุงูุฑุฉ ุ ูุฃููุง ูู ูุณุชุฎุฏูู ูุณุญุจ ุงูุจูุงูุงุช ุงูุชู ุณูุชู ุชุฌููุนูุง ุนูู ุงูููุฑ. <br><br><h2 style=";text-align:right;direction:rtl">  ููู ูุนูู </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/b28/1df/0ef/b281df0ef5f2ea2a08f73267ef7f5edb.png"><br><br>  ูุฏููุง ูุฌููุนุฉ Ignite - ูุฐุง ูู ุงููุตู ุงูุณููู ูู ุงูุตูุฑุฉ.  ูุง ููุฌุฏ Zookeeper ุ ุญูุซ ูุง ููุฌุฏ ุณูู ุฎูุณ ุนูุฏ.  ููุงู ุนูุงู ุดุฑุงุฑุฉ ุ ุฏุงุฎู ูู ุนุงูู ูุชู ุฑูุน ุนูุฏุฉ ุนููู ุฅูุฌูุงูุช.  ูู ุฎูุงูู ุ ูููููุง ุชูุฏูู ุทูุจ ููุฑุงุกุฉ ุงูุจูุงูุงุช ูุงูุชูุงุนู ูุน ุงููุชูุฉ.  ุฃูุถุง ุ ุชุฑุชูุน ุนูุฏุฉ ุงูุนููู ุฏุงุฎู IgniteSparkSession ููุฏููู ููุนูู. <br><br><h2 style=";text-align:right;direction:rtl">  ุฅุดุนุงู ุฅุทุงุฑ ุงูุจูุงูุงุช </h2><br>  ููุชูู ุฅูู ุงูุฑูุฒ: ููู ุชูุฑุฃ ุงูุจูุงูุงุช ูู ุฌุฏูู SQLุ  ูู ุญุงูุฉ Spark ุ ูู ุดูุก ุจุณูุท ุฌุฏูุง ูุฌูุฏ: ูููู ุฅููุง ูุฑูุฏ ุญุณุงุจ ุจุนุถ ุงูุจูุงูุงุช ุ ูุงูุฅุดุงุฑุฉ ุฅูู ุงูุชูุณูู - ูุฐุง ุซุงุจุช ูุนูู.  ุนูุงูุฉ ุนูู ุฐูู ุ ูุฏููุง ุงูุนุฏูุฏ ูู ุงูุฎูุงุฑุงุช - ุงููุณุงุฑ ุฅูู ููู ุงูุชูููู ูุนูุฏุฉ ุงูุนููู ุ ูุงูุฐู ูุจุฏุฃ ุนูุฏ ูุฑุงุกุฉ ุงูุจูุงูุงุช.  ูุดูุฑ ุฅูู ุงูุฌุฏูู ุงูุฐู ูุฑูุฏ ูุฑุงุกุชู ููุทูุจ ูู Spark ุชุญูููู.  ูุญุตู ุนูู ุงูุจูุงูุงุช ููููููุง ุฃู ููุนู ูุง ูุฑูุฏ ูุนูุง. <br><br><pre style=";text-align:right;direction:rtl"><code class="scala hljs">spark.read .format(<span class="hljs-type"><span class="hljs-type">FORMAT_IGNITE</span></span>) .option(<span class="hljs-type"><span class="hljs-type">OPTION_CONFIG_FILE</span></span>, <span class="hljs-type"><span class="hljs-type">TEST_CONFIG_FILE</span></span>) .option(<span class="hljs-type"><span class="hljs-type">OPTION_TABLE</span></span>, <span class="hljs-string"><span class="hljs-string">"person"</span></span>) .load()</code> </pre> <br>  ุจุนุฏ ุฅูุดุงุก ุงูุจูุงูุงุช - ุงุฎุชูุงุฑููุง ูู Ignite ุ ูู ุฃู ูุตุฏุฑ - ูููููุง ุญูุธ ูู ุดูุก ุจุณูููุฉ ุนู ุทุฑูู ุชุญุฏูุฏ ุงูุชูุณูู ูุงูุฌุฏูู ุงูููุงุจู.  ูุญู ูุฃูุฑ ุณุจุงุฑู ุจุงููุชุงุจุฉ ุ ูุญุฏุฏ ุงูุชูุณูู.  ูู ุงูุชูููู ุ ูุตู ุงููุฌููุนุฉ ุงูุชู ุณูุชู ุงูุงุชุตุงู ุจูุง.  ุญุฏุฏ ุงูุฌุฏูู ุงูุฐู ูุฑูุฏ ุญูุธู ููู.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูููููุง ูุตู ุฎูุงุฑุงุช ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ - ุญุฏุฏ ุงูููุชุงุญ ุงูุฃุณุงุณู ุงูุฐู ูููู ุจุฅูุดุงุฆู ูู ูุฐุง ุงูุฌุฏูู.  ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ูุถุทุฑุจุฉ ุจุจุณุงุทุฉ ุฏูู ุฅูุดุงุก ุฌุฏูู ุ ููู ุชููู ูุฐู ุงููุนููุฉ ูุทููุจุฉ.  ูู ุงูููุงูุฉ ุ ุงููุฑ ููู ุญูุธ ููุชุงุจุฉ ุงูุจูุงูุงุช. <br><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs">tbl.write. format(<span class="hljs-type"><span class="hljs-type">FORMAT_IGNITE</span></span>). option(<span class="hljs-type"><span class="hljs-type">OPTION_CONFIG_FILE</span></span>, <span class="hljs-type"><span class="hljs-type">CFG_PATH</span></span>). option(<span class="hljs-type"><span class="hljs-type">OPTION_TABLE</span></span>, tableName). option(<span class="hljs-type"><span class="hljs-type">OPTION_CREATE_TABLE_PRIMARY_KEY_FIELDS</span></span>, pk). save</code> </pre><br>  ุงูุขู ุฏุนููุง ูุฑู ููู ูุนูู ูู ุดูุก. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b35/41a/b86/b3541ab86eca15cd240765bf15907979.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">LoadDataExample.scala</a> <br><br>  ุณููุถุญ ูุฐุง ุงูุชุทุจูู ุงููุงุถุญ ุฃููุงู ูุฏุฑุงุช ุงูุชุณุฌูู.  ุนูู ุณุจูู ุงููุซุงู ุ ุงุฎุชุฑุช ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุจุงุฑูุงุช ูุฑุฉ ุงููุฏู ูุงูุฅุญุตุงุฆูุงุช ุงูุชู ุชู ุชูุฒูููุง ูู ููุฑุฏ ูุนุฑูู.  ูุญุชูู ุนูู ูุนูููุงุช ุนู ุงูุจุทููุงุช: ุงูุฏูุฑูุงุช ุ ุงููุจุงุฑูุงุช ุ ุงููุงุนุจูู ุ ุงููุฑู ุ ุณูุงุช ุงููุงุนุจ ุ ุณูุงุช ุงููุฑูู - ุงูุจูุงูุงุช ุงูุชู ุชุตู ูุจุงุฑูุงุช ูุฑุฉ ุงููุฏู ูู ุงูุฏูุฑูุงุช ุงูุฃูุฑูุจูุฉ (ุฅูุฌูุชุฑุง ุ ูุฑูุณุง ุ ุฅุณุจุงููุง ุ ุฅูุฎ). <br><br>  ุฃุฑูุฏ ุชุญููููุง ุนูู Ignite.  ูููู ุจุฅูุดุงุก ุฌูุณุฉ Spark ุ ูุชุญุฏูุฏ ุนููุงู ุงููุนุงูุฌ ูุงุณุชุฏุนุงุก ุชุญููู ูุฐู ุงูุฌุฏุงูู ุ ูุชูุฑูุฑ ุงููุนููุงุช.  ุงููุซุงู ููุฌูุฏ ูู Scala ุ ูููุณ Java ุ ูุฃู Scala ูููู ูุทูููุง ูุฃูุถู ุนูู ุณุจูู ุงููุซุงู. <br><br>  ูููู ุจููู ุงุณู ุงูููู ุ ููุฑุงุกุชู ุ ูุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ูุชุนุฏุฏ ุงูุฎุทูุท ุ ููุฐุง ููู json ููุงุณู.  ุซู ููุชุจ ูู Ignite.  ูุง ูููู ูุตู ูููู ููููุง - ูุญุฏุฏ Spark ููุณู ุงูุจูุงูุงุช ุงููุชููุฑุฉ ูุฏููุง ููุงููุชูุง.  ุฅุฐุง ุณุงุฑ ูู ุดูุก ุจุณูุงุณุฉ ุ ูุชู ุฅูุดุงุก ุฌุฏูู ููู ุฌููุน ุงูุญููู ุงููุงุฒูุฉ ูุฃููุงุน ุงูุจูุงูุงุช ุงููุทููุจุฉ.  ุจูุฐู ุงูุทุฑููุฉ ูููููุง ุชุญููู ูู ุดูุก ุฏุงุฎู Ignite. <br><br>  ุนูุฏูุง ูุชู ุชุญููู ุงูุจูุงูุงุช ุ ูููููุง ุฑุคูุชูุง ูู Ignite ูุงุณุชุฎุฏุงููุง ุนูู ุงูููุฑ.  ููุซุงู ุจุณูุท ุ ุงุณุชุนูุงู ูุชูุญ ูู ูุนุฑูุฉ ุงููุฑูู ุงูุฐู ูุนุจ ุฃูุจุฑ ุนุฏุฏ ูู ุงููุจุงุฑูุงุช.  ูุฏููุง ุนููุฏูู: hometeam ู awayteam ุ ุงููุถูููู ูุงูุถููู.  ูุฎุชุงุฑ ุงูุจูุงูุงุช ููุฌูุนูุง ููุญุณุจูุง ููุฌูุนูุง ูููุถู ุฅูููุง ุจุงุณุชุฎุฏุงู ุงูุจูุงูุงุช - ูุฅุฏุฎุงู ุงุณู ุงูุฃูุฑ.  Ta-dam - ูุงูุจูุงูุงุช ูู json-chiks ุงูุชู ุญุตููุง ุนูููุง ูู Ignite.  ูุฑู ุจุงุฑูุณ ุณุงู ุฌูุฑูุงู ุ ุชูููุฒ - ูุฏููุง ุงููุซูุฑ ูู ุงูุจูุงูุงุช ุนู ุงููุฑู ุงููุฑูุณูุฉ. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8a4/202/52b/8a420252be6fb8df3a9083d7411911a9.png"><br><br>  ููุฎุต.  ููุฏ ูููุง ุงูุขู ุจุชุญููู ุงูุจูุงูุงุช ูู ุงููุตุฏุฑ ุ ููู json ุ ุฅูู Ignite ุ ูุจุณุฑุนุฉ ูุจูุฑุฉ.  ุฑุจูุง ุ ูู ูุฌูุฉ ูุธุฑ ุงูุจูุงูุงุช ุงูุถุฎูุฉ ุ ูุฐุง ููุณ ูุจูุฑูุง ุฌุฏูุง ุ ููููู ูุงุฆู ูุฌูุงุฒ ุงูููุจููุชุฑ ุงููุญูู.  ูุชู ุฃุฎุฐ ูุฎุทุท ุงูุฌุฏูู ูู ููู json ูู ุดููู ุงูุฃุตูู.  ุชู ุฅูุดุงุก ุงูุฌุฏูู ุ ุชู ูุณุฎ ุฃุณูุงุก ุงูุฃุนูุฏุฉ ูู ุงูููู ุงููุตุฏุฑ ุ ูุชู ุฅูุดุงุก ุงูููุชุงุญ ุงูุฃุณุงุณู.  ุงููุนุฑู ูู ูู ููุงู ุ ูุงูููุชุงุญ ุงูุฃุณุงุณู ูู ุงููุนุฑู.  ุฏุฎูุช ูุฐู ุงูุจูุงูุงุช ูู Ignite ุ ูููููุง ุงุณุชุฎุฏุงููุง. <br><br><h2 style=";text-align:right;direction:rtl">  IgniteSparkSession ู IgniteCatalog </h2><br>  ุฏุนููุง ูุฑู ููู ูุนูู. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/654/24a/4ee/65424a4eeda4a4c2c6cce7038e13d1a9.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CatalogExample.scala</a> <br><br>  ุจุทุฑููุฉ ุจุณูุทุฉ ุฅูู ุญุฏ ูุง ุ ููููู ุงููุตูู ุฅูู ุฌููุน ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจู ูุงูุงุณุชุนูุงู ุนููุง.  ูู ุงููุซุงู ุงูุฃุฎูุฑ ุ ุจุฏุฃูุง ุฌูุณุฉ ุงูุดุฑุฑ ุงูููุงุณูุฉ.  ููู ููู ููุงู ุฎุตูุตูุฉ Ignite ููุงู - ุจุงุณุชุซูุงุก ุฃูู ูุฌุจ ุนููู ูุถุน ุจุฑุทูุงู ูุน ูุตุฏุฑ ุงูุจูุงูุงุช ุงูุตุญูุญ - ุนูู ููุงุณู ุชูุงููุง ูู ุฎูุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูุนุงูุฉ.  ูููู ุ ุฅุฐุง ููุช ุชุฑูุฏ ุงููุตูู ุฅูู ุฌุฏุงูู Ignite ุชููุงุฆููุง ุ ูููููู ุงุณุชุฎุฏุงู ุงูุงูุชุฏุงุฏ ุงูุฎุงุต ุจูุง.  ุงููุฑู ูู ุฃูู ุจุฏูุงู ูู SparkSession ููุชุจ IgniteSparkSession. <br><br>  ุจูุฌุฑุฏ ุฅูุดุงุก ูุงุฆู IgniteSparkSession ุ ุณุชุฑู ูู ุงูุฏููู ุฌููุน ุงูุฌุฏุงูู ุงูุชู ุชู ุชุญููููุง ููุชู ูู Ignite.  ููููู ุฑุคูุฉ ุงูุฑุณู ุงูุจูุงูู ุงูุฎุงุต ุจูู ูุฌููุน ุงููุนูููุงุช.  ูุนุฑู Spark ุจุงููุนู ุนู ุงูุฌุฏุงูู ุงูููุฌูุฏุฉ ูู Ignite ุ ูููููู ุจุณูููุฉ ุงูุญุตูู ุนูู ุฌููุน ุงูุจูุงูุงุช. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dec/f1b/a0c/decf1ba0c5db2e0d84e50a0e88b6c192.png"><br><br><h2 style=";text-align:right;direction:rtl">  ุงูุงุดุชุนุงู </h2><br>  ุนูุฏูุง ุชููู ุจุนูู ุงุณุชุนูุงูุงุช ูุนูุฏุฉ ูู Ignite ุจุงุณุชุฎุฏุงู JOIN ุ ูููู Spark ุจุณุญุจ ุงูุจูุงูุงุช ุฃููุงู ุ ูุจุนุฏ ุฐูู ููุท ูููู JOIN ุจุชุฌููุนูุง.  ูุชุญุณูู ุงูุนูููุฉ ุ ูููุง ุจุนูู ููุฒุฉ IgniteOptimization - ุฅููุง ุชุนูู ุนูู ุชุญุณูู ุฎุทุฉ ุงุณุชุนูุงู Spark ูุชุณูุญ ูู ุจุฅุนุงุฏุฉ ุชูุฌูู ุฃุฌุฒุงุก ุงูุทูุจ ุงูุชู ูููู ุชูููุฐูุง ุฏุงุฎู Ignite ุฏุงุฎู Ignite.  ูุธูุฑ ุงูุชุญุณูู ุนูู ุทูุจ ูุญุฏุฏ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="sql hljs">SQL Query: <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span>   city_id,   <span class="hljs-keyword"><span class="hljs-keyword">count</span></span>(*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span>   person p <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> city_id <span class="hljs-keyword"><span class="hljs-keyword">HAVING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">count</span></span>(*) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  ููุจู ุงูุทูุจ.  ูุฏููุง ุทุงููุฉ ุดุฎุต - ุจุนุถ ุงูููุธููู ูุงููุงุณ.  ูุนุฑู ูู ููุธู ูููุฉ ุงููุฏููุฉ ุงูุชู ูุนูุด ูููุง.  ูุฑูุฏ ุฃู ูุนุฑู ุนุฏุฏ ุงูุฃุดุฎุงุต ุงูุฐูู ูุนูุดูู ูู ูู ูุฏููุฉ.  ูููู ุจุงูุชุตููุฉ - ูู ุฃู ูุฏููุฉ ูุนูุด ุฃูุซุฑ ูู ุดุฎุต ูุงุญุฏ.  ูููุง ููู ุงูุฎุทุฉ ุงูุฃูููุฉ ุงูุชู ูุจูููุง Spark: <br><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs">== <span class="hljs-type"><span class="hljs-type">Analyzed</span></span> <span class="hljs-type"><span class="hljs-type">Logical</span></span> <span class="hljs-type"><span class="hljs-type">Plan</span></span> == city_id: bigint, count(<span class="hljs-number"><span class="hljs-number">1</span></span>): bigint <span class="hljs-type"><span class="hljs-type">Project</span></span> [city_id#<span class="hljs-number"><span class="hljs-number">19</span></span>L, count(<span class="hljs-number"><span class="hljs-number">1</span></span>)#<span class="hljs-number"><span class="hljs-number">52</span></span>L] +- <span class="hljs-type"><span class="hljs-type">Filter</span></span> (count(<span class="hljs-number"><span class="hljs-number">1</span></span>)#<span class="hljs-number"><span class="hljs-number">54</span></span>L &gt; cast(<span class="hljs-number"><span class="hljs-number">1</span></span> as bigint))  +- <span class="hljs-type"><span class="hljs-type">Aggregate</span></span> [city_id#<span class="hljs-number"><span class="hljs-number">19</span></span>L], [city_id#<span class="hljs-number"><span class="hljs-number">19</span></span>L, count(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-type"><span class="hljs-type">AS</span></span> count(<span class="hljs-number"><span class="hljs-number">1</span></span>)#<span class="hljs-number"><span class="hljs-number">52</span></span>L, count(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-type"><span class="hljs-type">AS</span></span> count(<span class="hljs-number"><span class="hljs-number">1</span></span>)#<span class="hljs-number"><span class="hljs-number">54</span></span>L] +- <span class="hljs-type"><span class="hljs-type">SubqueryAlias</span></span> p    +- <span class="hljs-type"><span class="hljs-type">SubqueryAlias</span></span> person       +- <span class="hljs-type"><span class="hljs-type">Relation</span></span>[<span class="hljs-type"><span class="hljs-type">NAME</span></span>#<span class="hljs-number"><span class="hljs-number">11</span></span>,<span class="hljs-type"><span class="hljs-type">BIRTH_DATE</span></span>#<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-type"><span class="hljs-type">IS_RESIDENT</span></span>#<span class="hljs-number"><span class="hljs-number">13</span></span>,<span class="hljs-type"><span class="hljs-type">SALARY</span></span>#<span class="hljs-number"><span class="hljs-number">14</span></span>,<span class="hljs-type"><span class="hljs-type">PENSION</span></span>#<span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-type"><span class="hljs-type">ACCOUNT</span></span>#<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-type"><span class="hljs-type">AGE</span></span>#<span class="hljs-number"><span class="hljs-number">17</span></span>,<span class="hljs-type"><span class="hljs-type">ID</span></span>#<span class="hljs-number"><span class="hljs-number">18</span></span>L,<span class="hljs-type"><span class="hljs-type">CITY_ID</span></span>#<span class="hljs-number"><span class="hljs-number">19</span></span>L]         <span class="hljs-type"><span class="hljs-type">IgniteSQLRelation</span></span>[table=<span class="hljs-type"><span class="hljs-type">PERSON</span></span>]</code> </pre><br>  ุงูุนูุงูุฉ ูู ูุฌุฑุฏ ุฌุฏูู Ignite.  ูุง ุชูุฌุฏ ููุงุชุฑ - ูููู ุจุจุณุงุทุฉ ุจุถุฎ ุฌููุน ุงูุจูุงูุงุช ูู ุฌุฏูู ุงูุดุฎุต ุนุจุฑ ุงูุดุจูุฉ ูู ุงููุชูุฉ.  ุซู ูุฌูุน Spark ูู ูุฐุง - ููููุง ููุทูุจ ููุนูุฏ ูุชูุฌุฉ ุงูุทูุจ. <br><br>  ูู ุงูุณูู ุฃู ูุฑู ุฃูู ูููู ุชูููุฐ ูู ูุฐู ุงูุดุฌุฑุฉ ุงููุฑุนูุฉ ูุน ุงูููุชุฑ ูุงูุชุฌููุน ุฏุงุฎู Ignite.  ุณูููู ูุฐุง ุฃูุซุฑ ููุงุกุฉ ูู ุณุญุจ ุฌููุน ุงูุจูุงูุงุช ูู ุฌุฏูู ูุจูุฑ ูุญุชูู ูู Spark - ููุฐุง ูุง ุชูุนูู ููุฒุฉ IgniteOptimization.  ุจุนุฏ ุชุญููู ุงูุดุฌุฑุฉ ูุชุญุณูููุง ุ ูุญุตู ุนูู ุงูุฎุทุฉ ุงูุชุงููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs">== <span class="hljs-type"><span class="hljs-type">Optimized</span></span> <span class="hljs-type"><span class="hljs-type">Logical</span></span> <span class="hljs-type"><span class="hljs-type">Plan</span></span> == <span class="hljs-type"><span class="hljs-type">Relation</span></span>[<span class="hljs-type"><span class="hljs-type">CITY_ID</span></span>#<span class="hljs-number"><span class="hljs-number">19</span></span>L,<span class="hljs-type"><span class="hljs-type">COUNT</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>)#<span class="hljs-number"><span class="hljs-number">52</span></span>L]   <span class="hljs-type"><span class="hljs-type">IgniteSQLAccumulatorRelation</span></span>(     columns=[<span class="hljs-type"><span class="hljs-type">CITY_ID</span></span>, <span class="hljs-type"><span class="hljs-type">COUNT</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>)], qry=<span class="hljs-type"><span class="hljs-type">SELECT</span></span> <span class="hljs-type"><span class="hljs-type">CITY_ID</span></span>, <span class="hljs-type"><span class="hljs-type">COUNT</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-type"><span class="hljs-type">FROM</span></span> <span class="hljs-type"><span class="hljs-type">PERSON</span></span> <span class="hljs-type"><span class="hljs-type">GROUP</span></span> <span class="hljs-type"><span class="hljs-type">BY</span></span> city_id <span class="hljs-type"><span class="hljs-type">HAVING</span></span> count(<span class="hljs-number"><span class="hljs-number">1</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  ููุชูุฌุฉ ูุฐูู ุ ูุญุตู ุนูู ุนูุงูุฉ ูุงุญุฏุฉ ููุท ุ ุญูุซ ูููุง ุจุชุญุณูู ุงูุดุฌุฑุฉ ุจุฃููููุง.  ููู ุงูุฏุงุฎู ููููู ุฃู ุชุฑู ุจุงููุนู ุฃู Ignite ุณูุฑุณู ุทูุจูุง ูุฑูุจูุง ุจูุง ููู ุงูููุงูุฉ ููุทูุจ ุงูุฃุตูู. <br><br>  ูููุชุฑุถ ุฃููุง ููุถู ุฅูู ูุตุงุฏุฑ ุจูุงูุงุช ูุฎุชููุฉ: ุนูู ุณุจูู ุงููุซุงู ุ ูุฏููุง ูุงุญุฏ DataFrame ูู Ignite ุ ูุงูุซุงูู ูู json ุ ูุงูุซุงูุซ ูุฑุฉ ุฃุฎุฑู ูู Ignite ุ ูุงูุฑุงุจุน ูู ููุน ูุง ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุนูุงุฆููุฉ.  ูู ูุฐู ุงูุญุงูุฉ ุ ุณูุชู ุชุญุณูู ุงูุดุฌุฑุฉ ุงููุฑุนูุฉ ููุท ูู ุงูุฎุทุฉ.  ูููู ุจุชุญุณูู ูุง ูุณุชุทูุน ุ ูุฅุณูุงุทู ูู Ignite ุ ูุณูููู Spark ุจุงูุจุงูู.  ูุชูุฌุฉ ูุฐูู ุ ูุญุตู ุนูู ููุงุณุจ ูู ุงูุณุฑุนุฉ. <br><br>  ูุซุงู ุขุฎุฑ ูุน JOIN: <br><br><pre style=";text-align:right;direction:rtl"> <code class="sql hljs">SQL Query - <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> jt1.id <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> id1, jt1.val1, jt2.id <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> id2, jt2.val2 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> jt1 <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> jt2 <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> jt1.val1 = jt2.val2</code> </pre><br>  ูุฏููุง ุฌุฏูููู.  ูุญู ูุชูุณู ุจุงููููุฉ ููุฎุชุงุฑ ูููุง ุฌููุนูุง - ุงููุนุฑูุงุช ูุงูููู.  ุชูุฏู ุณุจุงุฑู ูุซู ูุฐู ุงูุฎุทุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs">== <span class="hljs-type"><span class="hljs-type">Analyzed</span></span> <span class="hljs-type"><span class="hljs-type">Logical</span></span> <span class="hljs-type"><span class="hljs-type">Plan</span></span> == id1: bigint, val1: string, id2: bigint, val2: string <span class="hljs-type"><span class="hljs-type">Project</span></span> [id#<span class="hljs-number"><span class="hljs-number">4</span></span>L <span class="hljs-type"><span class="hljs-type">AS</span></span> id1#<span class="hljs-number"><span class="hljs-number">84</span></span>L, val1#<span class="hljs-number"><span class="hljs-number">3</span></span>, id#<span class="hljs-number"><span class="hljs-number">6</span></span>L <span class="hljs-type"><span class="hljs-type">AS</span></span> id2#<span class="hljs-number"><span class="hljs-number">85</span></span>L, val2#<span class="hljs-number"><span class="hljs-number">5</span></span>] +- <span class="hljs-type"><span class="hljs-type">Join</span></span> <span class="hljs-type"><span class="hljs-type">Inner</span></span>, (val1#<span class="hljs-number"><span class="hljs-number">3</span></span> = val2#<span class="hljs-number"><span class="hljs-number">5</span></span>) :- <span class="hljs-type"><span class="hljs-type">SubqueryAlias</span></span> jt1 : +- <span class="hljs-type"><span class="hljs-type">Relation</span></span>[<span class="hljs-type"><span class="hljs-type">VAL1</span></span>#<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-type"><span class="hljs-type">ID</span></span>#<span class="hljs-number"><span class="hljs-number">4</span></span>L] <span class="hljs-type"><span class="hljs-type">IgniteSQLRelation</span></span>[table=<span class="hljs-type"><span class="hljs-type">JT1</span></span>] +- <span class="hljs-type"><span class="hljs-type">SubqueryAlias</span></span> jt2    +- <span class="hljs-type"><span class="hljs-type">Relation</span></span>[<span class="hljs-type"><span class="hljs-type">VAL2</span></span>#<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-type"><span class="hljs-type">ID</span></span>#<span class="hljs-number"><span class="hljs-number">6</span></span>L] <span class="hljs-type"><span class="hljs-type">IgniteSQLRelation</span></span>[table=<span class="hljs-type"><span class="hljs-type">JT2</span></span>]</code> </pre> <br>  ูุฑู ุฃูู ุณูุณุญุจ ูู ุงูุจูุงูุงุช ูู ุฌุฏูู ูุงุญุฏ ุ ูู ุงูุจูุงูุงุช ูู ุงูุฌุฏูู ุงูุซุงูู ุ ููุถู ุฅูููุง ุฏุงุฎู ููุณู ููุนุทู ุงููุชุงุฆุฌ.  ุจุนุฏ ุงููุนุงูุฌุฉ ูุงูุชุญุณูู ุ ูุญุตู ุนูู ููุณ ุงูุทูุจ ุจุงูุถุจุท ุงูุฐู ูุฐูุจ ุฅูู Ignite ุ ุญูุซ ูุชู ุชูููุฐู ุจุณุฑุนุฉ ูุณุจูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs">== <span class="hljs-type"><span class="hljs-type">Optimized</span></span> <span class="hljs-type"><span class="hljs-type">Logical</span></span> <span class="hljs-type"><span class="hljs-type">Plan</span></span> == <span class="hljs-type"><span class="hljs-type">Relation</span></span>[<span class="hljs-type"><span class="hljs-type">ID</span></span>#<span class="hljs-number"><span class="hljs-number">84</span></span>L,<span class="hljs-type"><span class="hljs-type">VAL1</span></span>#<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-type"><span class="hljs-type">ID</span></span>#<span class="hljs-number"><span class="hljs-number">85</span></span>L,<span class="hljs-type"><span class="hljs-type">VAL2</span></span>#<span class="hljs-number"><span class="hljs-number">5</span></span>] <span class="hljs-type"><span class="hljs-type">IgniteSQLAccumulatorRelation</span></span>(columns=[<span class="hljs-type"><span class="hljs-type">ID</span></span>, <span class="hljs-type"><span class="hljs-type">VAL1</span></span>, <span class="hljs-type"><span class="hljs-type">ID</span></span>, <span class="hljs-type"><span class="hljs-type">VAL2</span></span>], qry= <span class="hljs-type"><span class="hljs-type">SELECT</span></span> <span class="hljs-type"><span class="hljs-type">JT1</span></span>.<span class="hljs-type"><span class="hljs-type">ID</span></span> <span class="hljs-type"><span class="hljs-type">AS</span></span> id1, <span class="hljs-type"><span class="hljs-type">JT1</span></span>.<span class="hljs-type"><span class="hljs-type">VAL1</span></span>, <span class="hljs-type"><span class="hljs-type">JT2</span></span>.<span class="hljs-type"><span class="hljs-type">ID</span></span> <span class="hljs-type"><span class="hljs-type">AS</span></span> id2, <span class="hljs-type"><span class="hljs-type">JT2</span></span>.<span class="hljs-type"><span class="hljs-type">VAL2</span></span> <span class="hljs-type"><span class="hljs-type">FROM</span></span> <span class="hljs-type"><span class="hljs-type">JT1</span></span> <span class="hljs-type"><span class="hljs-type">JOIN</span></span> <span class="hljs-type"><span class="hljs-type">JT2</span></span> <span class="hljs-type"><span class="hljs-type">ON</span></span> <span class="hljs-type"><span class="hljs-type">JT1</span></span>.val1 = <span class="hljs-type"><span class="hljs-type">JT2</span></span>.val2 <span class="hljs-type"><span class="hljs-type">WHERE</span></span> <span class="hljs-type"><span class="hljs-type">JT1</span></span>.val1 <span class="hljs-type"><span class="hljs-type">IS</span></span> <span class="hljs-type"><span class="hljs-type">NOT</span></span> <span class="hljs-type"><span class="hljs-type">NULL</span></span> <span class="hljs-type"><span class="hljs-type">AND</span></span> <span class="hljs-type"><span class="hljs-type">JT2</span></span>.val2 <span class="hljs-type"><span class="hljs-type">IS</span></span> <span class="hljs-type"><span class="hljs-type">NOT</span></span> <span class="hljs-type"><span class="hljs-type">NULL</span></span>)</code> </pre> <br>  ุณุฃุฑููู ูุซุงูุง. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ba4/39a/493/ba439a493e76dd573966cad413c07650.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชุญุณูู Example.scala</a> <br><br>  ูุญู ูููู ุจุฅูุดุงุก ุฌูุณุฉ IgniteSpark ุญูุซ ูุชู ุชุถููู ุฌููุน ุฅููุงูุงุช ุงูุชุญุณูู ุงูุฎุงุตุฉ ุจูุง ุชููุงุฆููุง ุชููุงุฆููุง.  ุงูุทูุจ ููุง ูู: ุงูุจุญุซ ุนู ุงููุงุนุจูู ุงูุญุงุตููู ุนูู ุฃุนูู ุชุตููู ูุนุฑุถ ุฃุณูุงุฆูู.  ูู ุฌุฏูู ุงููุงุนุจ ุ ุตูุงุชูู ูุจูุงูุงุชูู.  ูุญู ููุถู ููุตูู ุงูุจูุงูุงุช ุบูุฑ ุงููุฑุบูุจ ูููุง ููุนุฑุถ ุงููุงุนุจูู ุงูุญุงุตููู ุนูู ุฃุนูู ุชุตููู.  ุฏุนููุง ูุฑู ููุน ุงูุฎุทุฉ ุงูุชู ุญุตููุง ุนูููุง ุจุนุฏ ุงูุชุญุณูู ููุนุฑุถ ูุชุงุฆุฌ ูุฐุง ุงูุงุณุชุนูุงู. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c7d/c51/9ab/c7dc519abdfa6b3b1d7a8396ef9725b3.png"><br><br>  ูุจุฏุฃ.  ูุฑู ุฃููุงุจ ูุฃูููุฉ: ููุณู ุ ุจูููู ุ ุฑููุงูุฏู ุ ุฅูุฎ.  ุจุงูููุงุณุจุฉ ุ ููุชูู ุงูุจุนุถ ูุณุจุจูู ูู ุดูููู - ููุณู ูุฑููุงูุฏู.  ูุฏ ูุฌุฏ ุนุดุงู ูุฑุฉ ุงููุฏู ุฃูู ูู ุงูุบุฑูุจ ุฃู ูุธูุฑ ูุงุนุจูู ุบูุฑ ูุนุฑูููู ูู ุงููุงุฆูุฉ.  ูุคูุงุก ูู ุญุฑุงุณ ุงููุฑูู ุ ูุงููุงุนุจูู ุฐูู ุงูุฎุตุงุฆุต ุงูุนุงููุฉ ุฅูู ุญุฏ ูุง - ุนูู ุฎูููุฉ ูุงุนุจูู ุขุฎุฑูู.  ุงูุขู ูููู ูุธุฑุฉ ุนูู ุฎุทุฉ ุงูุงุณุชุนูุงู ุงูุชู ุชู ุชูููุฐูุง.  ูู Spark ุ ูู ูุชู ูุนู ุฃู ุดูุก ุชูุฑูุจูุง ุ ุฃู ุฃููุง ุฃุฑุณููุง ุงูุทูุจ ุจุงููุงูู ูุฑุฉ ุฃุฎุฑู ุฅูู Ignite. <br><br><h2 style=";text-align:right;direction:rtl">  ุชุทููุฑ Apache Ignite </h2><br>  ูุดุฑูุนูุง ููุชุฌ ููุชูุญ ุงููุตุฏุฑ ุ ูุฐูู ูุญู ุฏุงุฆููุง ุณุนุฏุงุก ุจุงูุชุตุญูุญุงุช ูุงูุชุนูููุงุช ูู ุงููุทูุฑูู.  ูุณุงุนุฏุชู ูููุงุญุธุงุชู ูุชุตุญูุญุงุชู ูุฑุญุจ ุจูุง ููุบุงูุฉ.  ูุญู ูู ุงูุชุธุงุฑูู.  90ูช ูู ูุฌุชูุน ุฅูุฌูุงูุช ูุชุญุฏุซูู ุงูุฑูุณูุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุจุงููุณุจุฉ ูู ุ ุญุชู ุจุฏุฃุช ุงูุนูู ุนูู Apache Ignite ุ ูู ุชูู ุฃูุถู ูุนุฑูุฉ ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ ุฑุงุฏุนุฉ.  ุจุงููุงุฏ ุชุณุชุญู ุงููุชุงุจุฉ ุจุงููุบุฉ ุงูุฑูุณูุฉ ูู ูุงุฆูุฉ ุงูุชุทููุฑ ุ ูููู ุญุชู ุฅุฐุง ูุชุจุช ุดูุฆูุง ุฎุงุทุฆูุง ุ ูุณูุฌูุจูู ููุณุงุนุฏููู. <br><br>  ูุง ุงูุฐู ูููู ุชุญุณููู ูู ูุฐุง ุงูุชูุงููุ  ููู ูููููู ุงููุณุงุนุฏุฉ ุฅุฐุง ูุงู ูุฏูู ูุซู ูุฐู ุงูุฑุบุจุฉุ  ุงููุงุฆูุฉ ุฃุฏูุงู.  ุชุดูุฑ ุงูุนูุงูุงุช ุงููุฌููุฉ ุฅูู ุงูุชุนููุฏ. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/de4/d43/ed0/de4d43ed01894ce6b02865ad9f6aef5d.png"><br>  ูุงุฎุชุจุงุฑ ุงูุชุญุณูู ุ ุชุญุชุงุฌ ุฅูู ูุชุงุจุฉ ุงุฎุชุจุงุฑุงุช ูุน ุงุณุชุนูุงูุงุช ูุนูุฏุฉ.  ุฃุนูุงู ุ ุนุฑุถุช ุจุนุถ ุงูุงุณุชูุณุงุฑุงุช ุงููุงุถุญุฉ.  ูู ุงููุงุถุญ ุฃูู ุฅุฐุง ูุชุจุช ุงููุซูุฑ ูู ุงูุชุฌูุนุงุช ูุงููุซูุฑ ูู ุงูุตูุงุช ุ ููุฏ ูุณูุท ุดูุก ูุง.  ูุฐู ูููุฉ ุจุณูุทุฉ ููุบุงูุฉ - ุชุนุงู ูุงูุนููุง.  ุฅุฐุง ูุฌุฏูุง ุฃู ุฃุฎุทุงุก ุงุณุชูุงุฏูุง ุฅูู ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑ ุ ูุณุชุญุชุงุฌ ุฅูู ุฅุตูุงุญูุง.  ุณูููู ููุงู ุฃุตุนุจ ููุงู. <br><br>  ูููุฉ ุฃุฎุฑู ูุงุถุญุฉ ููุซูุฑุฉ ููุงูุชูุงู ูู ุฏูุฌ Spark ูุน ุนููู ุฑููุน.  ุฅูู ูุงุฏุฑ ูู ุงูุจุฏุงูุฉ ุนูู ุชุญุฏูุฏ ุจุนุถ ูุฌููุนุงุช ุนูุงููู IP ุ ููุฐุง ูููู ููุงูุถูุงู ุฅูู ูุฌููุนุฉ Ignite ุ ููู ููุงุณุจ ูู ุญุงูุฉ ุงูุชูุงูู ูุน ูุธุงู ุฎุงุฑุฌู.  ุฅุฐุง ููุช ุชุฑูุฏ ูุฌุฃุฉ ุงูุงูุถูุงู ุฅูู ุญู ูุฐู ุงููุดููุฉ ุ ูุณุฃุณุงุนุฏู ุดุฎุตููุง ูู ุฐูู. <br><br>  ุฅุฐุง ููุช ุชุฑูุฏ ุงูุงูุถูุงู ุฅูู ูุฌุชูุน Apache Ignite ุ ูุฅููู ุจุนุถ ุงูุฑูุงุจุท ุงููููุฏุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>ุงุจุฏุฃ ููุง - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=http://yu">https://ignite.apache.org/community/resources.html</a></i> <br></li><li style=";text-align:right;direction:rtl">  <i>ุงููุตุงุฏุฑ ููุง - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://github.com/apache/ignite/</a></i> <br></li><li style=";text-align:right;direction:rtl">  <i>ุงูุงุญูุงุถ ููุง - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://apacheignite.readme.io/docs</a></i> <br></li><li style=";text-align:right;direction:rtl">  <i>ุงูุฃุฎุทุงุก ููุง - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://issues.apache.org/jira/browse/IGNITE</a></i> <br></li><li style=";text-align:right;direction:rtl">  <i>ููููู ุงููุชุงุจุฉ ููุง - dev@ignite.apache.org ุ user@ignite.apache.org</i> <br></li></ul><br>  ูุฏููุง ูุงุฆูุฉ ูุทูุฑุฉ ูุชุฌุงูุจุฉ ุ ุณุชุณุงุนุฏู.  ุฅููุง ูุง ุชุฒุงู ุจุนูุฏุฉ ุนู ุงููุซุงููุฉ ุ ูููู ุจุงูููุงุฑูุฉ ูุน ุงููุดุงุฑูุน ุงูุฃุฎุฑู ุ ููู ุญููุง ุญูุฉ. <br><br>  <i>ุฅุฐุง ููุช ุชุนุฑู Java ุฃู C ++ ุ ูุฃูุช ุชุจุญุซ ุนู ุนูู ูุชุฑูุฏ ุชุทููุฑ Open Source (Apache Ignite ุ Apache Kafka ุ Tarantool ุ ุฅูุฎ) ุงูุชุจ ููุง: join-open-source@sberbank.ru.</i> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/CzbAweNKEVY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar427297/">https://habr.com/ru/post/ar427297/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar427285/index.html">ูุฏุฑุณุฉ ุญูู ุฃุณุงุณูุงุช ุงูุฏูุงุฆุฑ ุงูุฑูููุฉ: ููููุณูุจูุฑุณู - ุญุณููุง ุ ูุฑุงุณูููุงุฑุณู - ุงุณุชุนุฏ</a></li>
<li><a href="../ar427289/index.html">ุงูููุฐุฌุฉ ุงูุฌููููุฌูุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ ูุชุณุฌูู ุงููุทุน ูุงูุชููุงุชูู ูู ุงุจุชูุงุฑุงุช ุฃุฑุงููู</a></li>
<li><a href="../ar427291/index.html">ุชูููู ุญุฑูุฉ ุงููุฑูุฑ ูู ููุงุฐุฌ ููุจ ASP.NET ุ ู div ููููุฑ ูุงูุงุณุชูุตุงุก ุงูุฏูุฑู ููุฎุงุฏู</a></li>
<li><a href="../ar427293/index.html">ุฃููุงุท ุชุตููู ุฌุงูุง ุณูุฑูุจุช</a></li>
<li><a href="../ar427295/index.html">ูุธุงุฆู JavaScript Currying</a></li>
<li><a href="../ar427299/index.html">ุฏุนููุง ูุญุตู ุนูู ุดูุก ุขุฎุฑ ูุฌูุนูุ ููุดุฆ 3 ูู 1 "ุฃุณุทูู ุงูููุฑ"</a></li>
<li><a href="../ar427301/index.html">ุชุนุทู GitHub ูุงุนุฏุฉ ุงูุจูุงูุงุช</a></li>
<li><a href="../ar427303/index.html">ุชุจุงุทุค ุฌุฒุก Windows 2: ุฅูุดุงุก ุงูุนูููุงุช</a></li>
<li><a href="../ar427307/index.html">ููุงุฑุณุฉ ุงุฎุชุจุงุฑ ุงููุงุฌูุฉ ุงูุฎูููุฉ Java + Rest-Assured</a></li>
<li><a href="../ar427309/index.html">ููู ุชุจูู ุฃู PVS-Studio ุฃูุซุฑ ุงูุชุจุงููุง ูู ุซูุงุซุฉ ูุจุฑูุฌูู ููุตู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>