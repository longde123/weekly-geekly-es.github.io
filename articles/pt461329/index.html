<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïµüèª üë©‚Äçüíª üöé Segmenta√ß√£o autom√°tica de √≥rg√£os respirat√≥rios üíÜüèª ü§§ üçÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A segmenta√ß√£o manual do pulm√£o leva cerca de 10 minutos e requer uma certa habilidade para obter o mesmo resultado de alta qualidade que a segmenta√ß√£o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Segmenta√ß√£o autom√°tica de √≥rg√£os respirat√≥rios</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/inobitec/blog/461329/"><p>  A segmenta√ß√£o manual do pulm√£o leva cerca de 10 minutos e requer uma certa habilidade para obter o mesmo resultado de alta qualidade que a segmenta√ß√£o autom√°tica.  A segmenta√ß√£o autom√°tica leva cerca de 15 segundos. </p><br><p>  Supus que, sem uma rede neural, seria poss√≠vel obter uma precis√£o de n√£o mais que 70%.  Eu tamb√©m assumi que opera√ß√µes morfol√≥gicas s√£o apenas a prepara√ß√£o de uma imagem para algoritmos mais complexos.  Mas, como resultado do processamento dessas, embora poucas, 40 amostras de dados tomogr√°ficos dispon√≠veis, o algoritmo segmentou os pulm√µes sem erros.  Al√©m disso, ap√≥s o teste nos cinco primeiros casos, o algoritmo n√£o mudou significativamente e funcionou corretamente nos outros 35 estudos sem alterar as configura√ß√µes. </p><br><p>  Al√©m disso, as redes neurais t√™m uma desvantagem - para seu treinamento, precisamos de centenas de amostras de pulm√£o, que precisam ser marcadas manualmente. </p><br><p><img src="https://habrastorage.org/webt/fg/uv/-r/fguv-r_mn7ybraf34p_1ybbphwa.jpeg"></p><a name="habracut"></a><br><h1>  Conte√∫do </h1><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Estrutura do sistema respirat√≥rio</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Escala de Haunsfield</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Morfologia matem√°tica</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Algoritmo de Lee e compacta√ß√£o RLE</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Transforma√ß√£o de limiar do volume base</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Remo√ß√£o de ar externo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Segmenta√ß√£o do objeto de volume m√°ximo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Fechando os vasos dentro dos pulm√µes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Algoritmo de segmenta√ß√£o de √≥rg√£os respirat√≥rios</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Implementa√ß√£o de algoritmos no MATLAB</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Conclus√£o</a> </li></ul><br><h1 id="paragraph1">  Estrutura do sistema respirat√≥rio </h1><br><p>  O sistema respirat√≥rio inclui as vias a√©reas e os pulm√µes.  As vias a√©reas s√£o divididas nas vias a√©reas superior e inferior.  O ponto de separa√ß√£o entre o trato respirat√≥rio inferior e superior √© o ponto de intersec√ß√£o do es√¥fago com as vias a√©reas.  Todos os √≥rg√£os que est√£o acima da laringe s√£o o trato superior e a laringe e os √≥rg√£os abaixo s√£o o trato inferior. </p><br><p>  Lista dos √≥rg√£os respirat√≥rios: </p><br><p>  <strong>A cavidade nasal</strong> √© uma cavidade cheia de ar entre o nariz e a faringe. <br>  <strong>A faringe</strong> √© um canal atrav√©s do qual a comida e o ar viajam. <br>  <strong>A traqu√©ia</strong> √© um tubo conectado √† laringe e br√¥nquios. <br>  <strong>A laringe</strong> √© respons√°vel pela forma√ß√£o da voz.  Est√° no n√≠vel das v√©rtebras cervicais C4-C6. <br>  <strong>Os br√¥nquios</strong> s√£o os canais respirat√≥rios, cuja parte principal est√° localizada dentro dos pulm√µes. <br>  <strong>Os pulm√µes</strong> s√£o o principal √≥rg√£o respirat√≥rio. </p><br><p><img src="https://habrastorage.org/webt/kf/jv/kj/kfjvkjeioihehmpbzprc5bvgf8y.png"></p><br><h1 id="paragraph2">  Escala de Haunsfield </h1><br><p> Godfrey Hounsfield era um engenheiro el√©trico ingl√™s que, juntamente com o te√≥rico americano Allan Cormack, desenvolveu tomografia computadorizada, pela qual compartilhou o Pr√™mio Nobel em 1979. </p><br><p><img src="https://habrastorage.org/webt/jv/bl/ho/jvblho_x-0woitx02gbfjuxxhju.jpeg"></p><br><p>  A escala de Hounsfield - √© uma escala quantitativa para descrever a radiodensidade, medida em unidades de Hounsfield, denominada HU. </p><br><p>  A radiodensidade √© calculada com base no coeficiente de atenua√ß√£o da radia√ß√£o.  O coeficiente de atenua√ß√£o caracteriza a facilidade com que um volume de material pode ser penetrado pela radia√ß√£o. </p><br><p>  A radiodensidade √© calculada pela f√≥rmula: </p><br><p><math> </math> $$ display $$ {Œº_ {X} -Œº_ {water} \ over Œº_ {water} -Œº_ {air}} \ times 1000 $$ display $$ </p><br><p>  onde <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3BC;</mo></mrow><mi>X</mi></msub><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3BC;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>w</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>r</mi></mrow></msub><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3BC;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mi>i</mi><mi>r</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.696ex" height="2.057ex" viewBox="0 -520.7 6327.4 885.9" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhjVFhpY_MOlxnvfe5kfQThu0Bu4yA#MJMATHI-3BC" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhjVFhpY_MOlxnvfe5kfQThu0Bu4yA#MJMATHI-58" x="853" y="-357"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhjVFhpY_MOlxnvfe5kfQThu0Bu4yA#MJMAIN-2C" x="1306" y="0"></use><g transform="translate(1751,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhjVFhpY_MOlxnvfe5kfQThu0Bu4yA#MJMATHI-3BC" x="0" y="0"></use><g transform="translate(603,-253)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhjVFhpY_MOlxnvfe5kfQThu0Bu4yA#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhjVFhpY_MOlxnvfe5kfQThu0Bu4yA#MJMATHI-61" x="716" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhjVFhpY_MOlxnvfe5kfQThu0Bu4yA#MJMATHI-74" x="1246" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhjVFhpY_MOlxnvfe5kfQThu0Bu4yA#MJMATHI-65" x="1607" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhjVFhpY_MOlxnvfe5kfQThu0Bu4yA#MJMATHI-72" x="2074" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhjVFhpY_MOlxnvfe5kfQThu0Bu4yA#MJMAIN-2C" x="4240" y="0"></use><g transform="translate(4685,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhjVFhpY_MOlxnvfe5kfQThu0Bu4yA#MJMATHI-3BC" x="0" y="0"></use><g transform="translate(603,-253)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhjVFhpY_MOlxnvfe5kfQThu0Bu4yA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhjVFhpY_MOlxnvfe5kfQThu0Bu4yA#MJMATHI-69" x="529" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/inobitec/blog/461329/&amp;usg=ALkJrhjVFhpY_MOlxnvfe5kfQThu0Bu4yA#MJMATHI-72" x="874" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mo>Œº</mo></mrow><mi>X</mi></msub><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><mo>Œº</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>w</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>r</mi></mrow></msub><mo>,</mo><msub><mrow class="MJX-TeXAtom-ORD"><mo>Œº</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>i</mi><mi>r</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2"> Œº_X, Œº_ {water}, Œº_ {air} </script>  s√£o coeficientes de atenua√ß√£o linear para o material medido, √°gua e ar. </p><br><p>  A radiodensidade pode ser negativa porque a radiodensidade zero corresponde √† √°gua.  Isso significa que todos os materiais com um coeficiente de atenua√ß√£o menor que o coeficiente de atenua√ß√£o da √°gua (por exemplo, tecido pulmonar, ar) ter√£o uma radiodensidade negativa. </p><br><p>  As radiodensidades aproximadas para v√°rios tecidos est√£o listadas abaixo: </p><br><ul><li>  Ar: -1000 HU. </li><li>  √ìrg√£os respirat√≥rios: de -950 a -300 HU. </li><li>  Sangue (sem contrastar os vasos): de 0 a 100 HU. </li><li>  Ossos: 100 a 1000 HU. </li></ul><br><p><img src="https://habrastorage.org/webt/zv/zz/v_/zvzzv_n2koandwhyv-nw1ciunou.png"></p><br><p>  Links para a Wikipedia: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">escala de Hounsfield</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Godfrey Hounsfield</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">coeficiente de atenua√ß√£o</a> . </p><br><h1 id="paragraph3">  Morfologia matem√°tica </h1><br><p>  <strong>As opera√ß√µes morfol√≥gicas</strong> s√£o as principais ferramentas utilizadas no algoritmo. <br>  No campo da vis√£o computacional, as opera√ß√µes morfol√≥gicas s√£o chamadas de grupo de algoritmos para a transforma√ß√£o da forma dos objetos.  Na maioria das vezes, opera√ß√µes morfol√≥gicas s√£o aplicadas a imagens binarizadas, onde as unidades correspondem a voxels de objetos e os zeros a vazios. <br>  As principais opera√ß√µes morfol√≥gicas incluem: </p><br><p>  <strong>Dilata√ß√£o morfol√≥gica</strong> √© a adi√ß√£o de novos voxels a todos os voxels de borda dos objetos.  Em outras palavras, o algoritmo verifica todos os voxels correspondentes √† borda do objeto e os amplia usando um kernel com uma determinada forma (esfera, cubo, cruz etc).  O n√∫cleo tem seu pr√≥prio raio (para a esfera) ou a largura do lado (para o cubo).  Essa opera√ß√£o √© frequentemente usada para mesclar v√°rios objetos pr√≥ximos em um √∫nico objeto. </p><br><p>  <strong>A eros√£o morfol√≥gica</strong> √© o corte de todos os voxels situados na borda (limite) dos objetos.  Esta opera√ß√£o √© inversa √† dilata√ß√£o.  Esta opera√ß√£o √© √∫til para remover ru√≠dos que t√™m a forma de muitos pequenos objetos interconectados.  No entanto, esse m√©todo de remo√ß√£o de ru√≠do deve ser usado apenas se o objeto de interesse tiver uma espessura muito maior que o raio de eros√£o.  Caso contr√°rio, as informa√ß√µes √∫teis ser√£o perdidas. </p><br><p>  <strong>O fechamento morfol√≥gico</strong> √© uma dilata√ß√£o seguida por uma eros√£o.  √â usado para fechar furos dentro de objetos e mesclar objetos pr√≥ximos. </p><br><p>  <strong>A abertura morfol√≥gica</strong> √© uma eros√£o seguida de uma dilata√ß√£o.  √â usado para remover pequenos objetos com ru√≠do e separ√°-los em v√°rios objetos. </p><br><p><img src="https://habrastorage.org/webt/7n/tt/ux/7nttuxnqs66djkmrav1amhg4mei.gif"></p><br><h1 id="paragraph4">  Algoritmo de Lee e compacta√ß√£o RLE </h1><br><p>  Para selecionar objetos no volume bin√°rio de voxel, o algoritmo de Lie √© usado.  Originalmente, esse algoritmo foi inventado para encontrar a sa√≠da mais curta do labirinto.  N√≥s o usamos para selecionar o objeto e mov√™-lo de uma matriz tridimensional de voxels para outra.  A id√©ia b√°sica do algoritmo consiste em movimento paralelo em todas as dire√ß√µes poss√≠veis a partir do ponto de partida.  Para um caso tridimensional, √© poss√≠vel mover-se em 26 ou 6 dire√ß√µes a partir de um voxel. </p><br><p>  Para otimizar o desempenho, o algoritmo de codifica√ß√£o de execu√ß√£o foi aplicado.  A id√©ia principal do algoritmo √© que a sequ√™ncia de uns e zeros seja substitu√≠da por um d√≠gito igual ao n√∫mero de elementos na sequ√™ncia.  Por exemplo, a cadeia "00110111" pode ser substitu√≠da por: "2;  2;  1;  3 ".  Isso reduz o n√∫mero de acessos √† mem√≥ria. </p><br><p><img src="https://habrastorage.org/webt/if/kr/h6/ifkrh6br6sgi65g8sowexfxxsis.gif"><img src="https://habrastorage.org/webt/9f/rr/nc/9frrncdin9axwhdwgad8vndnlqy.gif"></p><br><p>  Links da Wikipedia: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">algoritmo de Lee</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">algoritmo RLE</a> . </p><br><h1 id="paragraph5">  Transforma√ß√£o de limiar do volume base </h1><br><p>  Utilizando o tom√≥grafo, foram obtidos os dados sobre uma radiodensidade em cada ponto do espa√ßo digitalizado.  Os voxels do ar t√™m uma radiodensidade na faixa de -1100 a -900 HU, e os voxels dos √≥rg√£os respirat√≥rios t√™m uma radiodensidade de -900 a -300 HU.  Portanto, podemos remover todos os voxels desnecess√°rios com radiodensidade maior que -300 HU.  Como resultado, obtemos um volume de voxel binarizado contendo apenas os √≥rg√£os respirat√≥rios e o ar. </p><br><p><img src="https://habrastorage.org/webt/di/lv/ss/dilvssyv2do2rvjlbb3xov798rw.gif"></p><br><h1 id="paragraph6">  Remo√ß√£o de ar externo </h1><br><p>  Para segmentar o ar interno do corpo, exclu√≠mos todos os objetos adjacentes aos cantos do volume 3D.  Assim, removemos o ar externo. </p><br><p><img src="https://habrastorage.org/webt/_b/ol/mh/_bolmh5kdpm65pt0ysosn-zk4iu.png"></p><br><p>  No entanto, nem em todos os casos o ar dentro da mesa do tom√≥grafo ser√° removido, pois pode n√£o haver conex√£o com os cantos do volume 3D. </p><br><p><img src="https://habrastorage.org/webt/mu/m1/bi/mum1bidj1at0nvceitxh5jtzqs4.png"></p><br><p>  Portanto, analisaremos n√£o apenas os cantos, mas tamb√©m todos os voxels localizados em qualquer um dos planos de arestas do f.  Mas, como podemos ver na imagem abaixo, os pulm√µes tamb√©m foram removidos.  Acontece que a traqu√©ia tamb√©m teve uma conex√£o com o plano superior do volume 3D. </p><br><p><img src="https://habrastorage.org/webt/fu/zb/3b/fuzb3bzxnvxvofjz-mxoelly5w4.gif"></p><br><p>  Teremos que excluir o plano superior da √°rea de digitaliza√ß√£o.  Tamb√©m existem estudos em que os pulm√µes n√£o foram totalmente capturados e o plano inferior est√° conectado aos pulm√µes. <br>  Portanto, se desejar, voc√™ tamb√©m pode excluir o plano inferior. </p><br><p><img src="https://habrastorage.org/webt/uf/ja/mb/ufjambvoavwiks-09hms7wc02lg.png"></p><br><p>  Mas esse m√©todo afeta apenas estudos no peito.  No caso da captura de todo o volume do corpo, a conex√£o do ar interno e externo atrav√©s da cavidade nasal aparecer√°. Portanto, √© necess√°rio aplicar eros√£o morfol√≥gica para separar o ar interno e externo. </p><br><p><img src="https://habrastorage.org/webt/zf/za/ej/zfzaejokke75l8wiqqj20ma_mjs.gif"></p><br><p>  Ap√≥s a aplica√ß√£o da eros√£o, podemos retornar ao m√©todo de segmenta√ß√£o do ar externo obtido anteriormente, que se baseia na conectividade do ar externo com planos laterais do volume 3D. </p><br><p><img src="https://habrastorage.org/webt/yj/i7/nh/yji7nhiveqpxbky3_qgj9b6n0zq.png"></p><br><p>  Ap√≥s a segmenta√ß√£o do ar externo, poder√≠amos subtrair imediatamente o ar externo de todo o volume do ar e dos pulm√µes e obter o ar interno do corpo e dos pulm√µes.  Mas h√° um problema.  Ap√≥s a eros√£o, algumas informa√ß√µes sobre o ar externo foram perdidas.  Para restaur√°-lo, aplicamos dilata√ß√£o do ar externo. </p><br><p><img src="https://habrastorage.org/webt/vn/tu/ns/vntunsho-og3pm1at7dqi3_ltna.gif"></p><br><p>  Em seguida, subtra√≠mos o ar externo de todo o ar e √≥rg√£os respirat√≥rios e obtemos o ar interno e os √≥rg√£os respirat√≥rios. </p><br><p><img src="https://habrastorage.org/webt/fr/hx/df/frhxdfz7ax9fz-ps7x9zjrlgiqo.png"></p><br><p><img src="https://habrastorage.org/webt/mw/d6/qc/mwd6qcn4xkuj5m5xsp-trc0usk4.png"></p><br><h1 id="paragraph7">  Segmenta√ß√£o do objeto de volume m√°ximo </h1><br><p>  A seguir, segmentamos os √≥rg√£os respirat√≥rios como o objeto m√°ximo em volume.  Os √≥rg√£os respirat√≥rios n√£o t√™m conex√£o com o ar no interior do trato gastrointestinal. </p><br><p><img src="https://habrastorage.org/webt/7l/gt/bd/7lgtbdfvf0st73wqzlacvax1r-0.png"><img src="https://habrastorage.org/webt/5d/ce/8u/5dce8urp2qvopyat905ex9y_qqs.png"></p><br><p>  Vale ressaltar que a escolha correta do limiar de radiodensidade na etapa inicial √© importante.  Caso contr√°rio, em alguns casos, pode n√£o haver conex√£o entre os dois pulm√µes como resultado de baixa resolu√ß√£o.  Por exemplo, se assumirmos que os voxels dos √≥rg√£os respirat√≥rios t√™m radiodensidade de -500 HU e menos, no caso abaixo, a segmenta√ß√£o dos √≥rg√£os respirat√≥rios como o maior objeto em volume levar√° a um erro, porque n√£o h√° conex√£o entre os dois pulm√µes.  Portanto, o limite deve ser aumentado para -300 HU. </p><br><p><img src="https://habrastorage.org/webt/jr/mi/m2/jrmim2de5siht6zo2nhoz8l1e5e.png"></p><br><h1 id="paragraph8">  Fechando os vasos dentro dos pulm√µes </h1><br><p>  Para capturar os vasos dentro dos pulm√µes, usaremos fechamento morfol√≥gico, ou seja, dilata√ß√£o seguida de eros√£o com o mesmo raio.  A radiodensidade dos vasos (sem contraste) √© de cerca de 0..100 HU. </p><br><p><img src="https://habrastorage.org/webt/po/1a/nz/po1anz0m9em66lsawok9fuwncvo.png"></p><br><p>  Na imagem, podemos ver que grandes canais sangu√≠neos n√£o est√£o fechados.  Mas isso n√£o √© necess√°rio.  O objetivo desta opera√ß√£o era destruir os muitos pequenos orif√≠cios dentro dos pulm√µes para simplificar o processo de segmenta√ß√£o pulmonar nas pr√≥ximas etapas. </p><br><h1 id="paragraph9">  Algoritmo de segmenta√ß√£o de √≥rg√£os respirat√≥rios </h1><br><p>  Como resultado, obtemos o seguinte algoritmo de segmenta√ß√£o de √≥rg√£os respirat√≥rios: </p><br><ol><li>  Transforma√ß√£o de limite do volume base com o limite "&lt;-300 HU". </li><li>  Eros√£o morfol√≥gica com raio de 3 mm para a separa√ß√£o do ar externo e interno. </li><li>  Segmenta√ß√£o do ar externo com base na conectividade do ar externo com os planos laterais de limite do volume 3D. </li><li>  Dilata√ß√£o morfol√≥gica do ar externo para restaurar as informa√ß√µes perdidas ap√≥s a eros√£o. </li><li>  Subtra√ß√£o do ar externo de todo o ar e √≥rg√£os respirat√≥rios para obter o ar interno e os √≥rg√£os respirat√≥rios. </li><li>  Segmenta√ß√£o do objeto de volume m√°ximo. </li><li>  Fechamento morfol√≥gico dos vasos dentro dos pulm√µes. </li></ol><br><p><img src="https://habrastorage.org/webt/pv/xf/ee/pvxfee1i06siq8wa66ynzbuxku0.png"></p><br><h1 id="paragraph10">  Implementa√ß√£o de algoritmos no MATLAB </h1><br><h3 id="function-getrespiratoryorgans">  Fun√ß√£o "getRespiratoryOrgans" </h3><br><pre><code class="matlab hljs"><span class="hljs-comment"><span class="hljs-comment">% Returns the whole respiratory organs volume (lung and airway volume) % without separating of the left and right lung. % V = base volume with radiodensity data in Hounsfield units. % cr = radius of vessels morphological closing. % ci = iteration count of vessels morphological closing (fe 3-times % make dilation and after that 3-times make erosion. function RO = getRespiratoryOrgans(V,cr,ci) % Threshold transform of the base volume with the threshold level "&lt;-300 HU". AL=~imbinarize(V,-300); % Morphological erosion with the 3 mm radius for the separation of external % and internal air. SE=strel('sphere',3); EAL=imerode(AL,SE); % Segmentation of external air based on external air connectivity with the % boundary side planes of the 3D volume. EA=getExternalAir(EAL); % Morphological dilation of the external air to restore the information lost % after the erosion. DEA=EA; for i=1:4 DEA=imdilate(DEA,SE); DEA=DEA&amp;AL; end % Subtraction of the external air from the whole air and respiratory organs to % obtain the internal air and respiratory organs. IAL=AL-DEA; % Segmentation of the maximum volume object. RO=getMaxObject(IAL); Morphological closing of the vessels inside the lungs. RO=closeVoxelVolume(RO,3,2);</span></span></code> </pre> <br><h3 id="function-getexternalair">  Fun√ß√£o "getExternalAir" </h3><br><pre> <code class="matlab hljs"><span class="hljs-comment"><span class="hljs-comment">% Returns the volume which is connected with the edge surfaces of % the voxel scene (except the top surface, because lungs can have % a connection with the top surface). % EAL = eroded lung-and-air binarized volume. function EA = getExternalAir(EAL) % The ‚Äúbwlabeln‚Äù function segments objects: voxels of a one object % equates to 1, and of another one - to 2, etc. V=bwlabeln(EAL); % We request such characteristics of the objects as bounding box and % list of all object voxels. R=regionprops3(V,'BoundingBox','VoxelList'); n=height(R); % Create a 3D matrix for storing external air voxels. s=size(EAL); EA=zeros(s,'logical'); % Scan all the objects to find objects belonging to the external air. for i=1:n % Define the minimum and maximum x and y coordinates of the object. x0=R(i,1).BoundingBox(1); y0=R(i,1).BoundingBox(2); x1=x0+R(i,1).BoundingBox(4); y1=y0+R(i,1).BoundingBox(5); % If the edge voxels of the object are in contact with the side planes of % the 3D volume, then copy all the voxels of this object into the matrix EA. if (x0 &lt; 1 || x1 &gt; s(1)-1 || y0 &lt; 1 || y1 &gt; s(2)-1) % Convert the object voxel coordinates data to the matrix type: % [[x1 y1 z1] [x2 y2 z3] ... [xn yn zn]]. mat=cell2mat(R(i,2).VoxelList); ms=size(mat); % Fill the matrix containing the voxels of the external air. for j=1:ms(1) x=mat(j,2); y=mat(j,1); z=mat(j,3); EA(x,y,z)=1; end end end</span></span></code> </pre> <br><h3 id="function-getmaxobject">  Fun√ß√£o "getMaxObject" </h3><br><pre> <code class="matlab hljs"><span class="hljs-comment"><span class="hljs-comment">% Returns the largest object in the voxel volume V. % O = the voxels of the largest object. % m = the volume of the largest object. function [O,m] = getMaxObject(V) % Segment the objects. V=bwlabeln(V); % Reqiest the information about the objects volume and objects voxel coordinates. R=regionprops3(V,'Volume','VoxelList'); % Determine the index of the maximum volume object. v=R(:,1).Volume; [m,i]=max(v); % Create the 3D matrix for storing the largest object voxels. s=size(V); O=zeros(s,'logical'); % Copy the largest object voxels to the new matrix. mat=cell2mat(R(i,2).VoxelList); ms=size(mat); for j=1:ms(1) x=mat(j,2); y=mat(j,1); z=mat(j,3); O(x,y,z)=1; end</span></span></code> </pre> <br><p>  O c√≥digo fonte pode ser baixado pela <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">refer√™ncia</a> . </p><br><h1 id="paragraph11">  Conclus√£o </h1><br><p>  Os seguintes artigos ser√£o: </p><br><ol><li>  segmenta√ß√£o de traqu√©ia e br√¥nquios; </li><li>  segmenta√ß√£o pulmonar; </li><li>  segmenta√ß√£o dos lobos pulmonares. </li></ol><br><p>  Os seguintes algoritmos ser√£o considerados: </p><br><ol><li>  transforma√ß√£o √† dist√¢ncia; </li><li>  transforma√ß√£o de vizinho mais pr√≥ximo, tamb√©m conhecida como transforma√ß√£o de recurso; </li><li>  c√°lculo dos autovalores da matriz de Hessian para segmenta√ß√£o de objetos 3D planos; </li><li>  segmenta√ß√£o de bacias hidrogr√°ficas. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt461329/">https://habr.com/ru/post/pt461329/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt461319/index.html">O que um designer de jogos faz?</a></li>
<li><a href="../pt461321/index.html">Modelos gen√©ricos e de metaprograma√ß√£o: Go, Rust, Swift, D e outros</a></li>
<li><a href="../pt461323/index.html">Uma explica√ß√£o acess√≠vel do algoritmo de colapso da fun√ß√£o de onda</a></li>
<li><a href="../pt461325/index.html">Vit√≥ria na PHDays 9. Compartilhamos hacks em tr√™s partes. Parte 3</a></li>
<li><a href="../pt461327/index.html">Crise de front-end?</a></li>
<li><a href="../pt461333/index.html">ITX5 mitap: JAVA ao vivo, magia Kotlin e tinder de tomate</a></li>
<li><a href="../pt461339/index.html">Como ser orientado por dados. Desde o come√ßo</a></li>
<li><a href="../pt461341/index.html">Desenvolvimento m√≥vel hh.ru e onde ele mora</a></li>
<li><a href="../pt461345/index.html">Como convertemos o calor humano em eletricidade</a></li>
<li><a href="../pt461351/index.html">Caleidosc√≥pio como na inf√¢ncia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>