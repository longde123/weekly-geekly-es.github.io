<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí® ü§∑üèæ ‚ô†Ô∏è De zero ao her√≥i "Actions on Google": start üõÄüèª üîü ‚õπüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Google hackathon, e tudo que voc√™ precisa para come√ßar a desenvolver seus aplicativos para um assistente. 


 O Google organizou um hackathon dedicado...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>De zero ao her√≥i "Actions on Google": start</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redmadrobot/blog/419773/"><img src="https://habrastorage.org/webt/ek/p5/kq/ekp5kqbvvl0p4mdidicbmgfw5b0.png" alt="imagem"><br><p>  Google hackathon, e tudo que voc√™ precisa para come√ßar a desenvolver seus aplicativos para um assistente. </p><br><p>  O Google organizou um hackathon dedicado √† tecnologia Actions On Google.  Essa √© uma boa oportunidade para adquirir experi√™ncia e pensar em como come√ßar a criar a interface do usu√°rio de conversa√ß√£o (CUI) para nossos aplicativos.  Portanto, reunimos uma equipe de dois desenvolvedores do Android: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">shipa_o</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">raenardev</a> e designer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">comradeguest,</a> e fomos participar. </p><a name="habracut"></a><br><h2>  O que √© a√ß√µes no Google? </h2><br><p>  A√ß√µes no Google (AoG) √© uma maneira de adicionar sua a√ß√£o ao assistente. <br>  Voc√™ pode fazer isso usando 4 ferramentas: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A√ß√µes de Conte√∫do</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Fatias</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A√ß√µes do aplicativo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Habilidade para o Google Assistant</a> . </li></ul><br><p>  No hackathon, desenvolvemos uma habilidade - um aplicativo que expande os recursos de um assistente, ent√£o vamos parar por a√≠. </p><br><p> Ap√≥s a apela√ß√£o, ‚ÄúOk Google.  Quero conversar com <code>${_}</code> ‚Äù, o assistente abre a habilidade com a qual o usu√°rio conduz um di√°logo: </p><br><img src="https://habrastorage.org/webt/l2/vw/es/l2vwesoe1sywaswq0_8bmgjhhga.jpeg" alt="imagem" width="50%"><br><h3>  Como escrever uma habilidade? <br></h3><br><p>  Voc√™ precisar√° de duas habilidades: <br>  - compreens√£o da interface do usu√°rio conversacional (CUI), a capacidade de projet√°-las; <br>  - Capacidade de trabalhar com o Natural Language Processing (NLP), por exemplo, Dialogflow. </p><br><h4>  Etapa 1: Design </h4><br><p>  Para que sua habilidade tenha um interlocutor de prote√≠nas, √© melhor pensar no futuro agora.  Demanda ser√£o aqueles que levarem em conta o contexto de uso.  As interfaces de di√°logo ser√£o usadas quando for poss√≠vel falar em voz alta e interagir com dispositivos com voz de maneira mais conveniente e r√°pida do que com m√£os, olhos e outras partes do corpo. </p><br><p>  A interface de voz √© serial.  Se for poss√≠vel mostrar toda a forma de fazer um pedido em um gr√°fico, e a pr√≥pria pessoa escolher o que procurar primeiro e depois o que, ent√£o voc√™ s√≥ poder√° fazer perguntas uma ap√≥s a outra em voz alta.  Para criar um aplicativo popular e conveniente, encontre a interse√ß√£o entre as necessidades do usu√°rio e a capacidade de usar a interface de voz (ou a incapacidade de usar outras pessoas). </p><br><p>  A primeira coisa que vem √† mente √© um assistente de voz para cegos, que ajuda a resolver os problemas do dia a dia.  Por exemplo, fa√ßa um pedido em uma loja, chame um t√°xi, ligue para parentes.  O segundo √© um livro de receitas falante para donas de casa com as m√£os na farinha.  Terceiro, jogos em que voc√™ precisa explicar algo. </p><br><p>  Decidimos come√ßar com um simples e desenvolvemos um rob√¥ que aconselha as pessoas sobre bons filmes.  Vencemos a imperfei√ß√£o dos sintetizadores de voz: nosso assistente nem mesmo finge ser um homem e enfatiza sua v√≠vida personalidade eletr√¥nica em todos os aspectos. </p><br><p>  O Google escreveu excelentes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">diretrizes</a> sobre como desenvolver interfaces interativas.  E falaremos sobre como projetamos nosso primog√™nito falante. </p><br><p>  <b>1. Invoca√ß√£o</b> </p><br><p>  Primeiro, voc√™ precisa chamar um assistente.  A chamada pode ser expl√≠cita (chamada expl√≠cita) e indireta (chamada impl√≠cita).  As pessoas usar√£o tratamento expl√≠cito quando j√° conhecerem o aplicativo.  Indiretamente, o Assistente do Google pode recomendar um aplicativo adequado em uma situa√ß√£o espec√≠fica.  As op√ß√µes escolhidas corretamente para apelo indireto - como as palavras-chave corretas na publicidade contextual, s√£o apenas mais "humanas". </p><br><div class="scrollable-table"><table><tbody><tr><td>  Tipo de recurso </td><td><p>  Descri√ß√£o do produto </p><br></td><td>  Exemplo </td></tr><tr><td>  Invoca√ß√£o Expl√≠cita </td><td>  Com o nome do assistente </td><td><p><br>  Ok Google, eu quero falar com o Red Passionate Movie Robot. <br>  Me chame de rob√¥ de filme. <br>  Onde √© vermelho e apaixonado por l√°? </p><br></td></tr><tr><td><br>  Invoca√ß√£o impl√≠cita </td><td><br>  No contexto de quando voc√™ precisa de um assistente </td><td><br>  Ok Google, me aconselhe um filme. <br>  Eu quero ver uma com√©dia engra√ßada. <br>  Que tipo de filme assistir com uma garota? </td></tr></tbody></table></div><br><p>  √â importante que as chamadas indiretas n√£o sejam muito gerais.  Como palavras-chave gerais na publicidade contextual, elas apenas impedem que voc√™ encontre o aplicativo certo e diminua a classifica√ß√£o do aplicativo na emiss√£o do Assistente. </p><br><p>  As chamadas podem conter um link direto para os recursos individuais do assistente de voz.  Por exemplo, geralmente nosso rob√¥-filme come√ßa a se comunicar com o fato de oferecer uma pessoa para escolher um g√™nero.  Mas se ele for chamado para um apelo indireto, "Quero ver uma com√©dia engra√ßada", √© l√≥gico iniciar um di√°logo com a oferta de um bom filme garantido do g√™nero mencionado. </p><br><p>  <b>2. Primeira sauda√ß√£o</b> </p><br><p>  A primeira sauda√ß√£o √© o que o aplicativo diz √† pessoa imediatamente ap√≥s a liga√ß√£o. <br>  Primeiro, voc√™ precisa informar ao usu√°rio que o assistente j√° est√° aqui: </p><br><blockquote>  Oi, uma forma de prote√≠na da vida.  Eu sou um rob√¥-filme apaixonado por Red.  O objetivo da minha exist√™ncia √© aconselhar filmes biol√≥gicos sobre bons filmes. </blockquote><p>  E ent√£o - sugira o que fazer a seguir.  Nosso rob√¥ est√° procurando filmes por g√™nero, por isso sugerimos com que solicita√ß√£o uma pessoa pode ir al√©m: <br>  O que voc√™ quer ver: talvez com√©dia, a√ß√£o ou horror? </p><br><p>  Usu√°rios novos e experientes podem ser recebidos de v√°rias maneiras.  Se uma pessoa estiver conversando com seu assistente pela primeira vez, voc√™ poder√° falar um pouco sobre voc√™.  Se n√£o for o primeiro - uma longa sauda√ß√£o vai incomod√°-lo.  Portanto, voc√™ pode come√ßar imediatamente a trabalhar: </p><br><div class="scrollable-table"><table><tbody><tr><td>  Primeira vez </td><td><p>  Repetidamente </p><br></td></tr><tr><td>  Oi, uma forma de prote√≠na da vida.  Eu sou um rob√¥-filme apaixonado por Red.  O objetivo da minha exist√™ncia √© aconselhar filmes biol√≥gicos sobre bons filmes.  O que voc√™ quer ver: talvez com√©dia, a√ß√£o ou horror? </td><td><br>  Sauda√ß√µes, cara!  Em que g√™nero voc√™ est√° interessado? </td></tr></tbody></table></div><br><p>  <b>3. Conversa humana</b> </p><br><p>  Ensine seu assistente a entender a fala natural e manter a conversa em andamento.  A maneira mais f√°cil de fazer isso √© se comunicar com as pessoas do p√∫blico-alvo antes mesmo do in√≠cio do desenvolvimento.  Al√©m disso, √© desej√°vel verbalmente, e n√£o por escrito, porque o discurso coloquial escrito √© mais escasso que o oral.  Desempenhe o papel de rob√¥ e pe√ßa ao interlocutor para imaginar que ele est√° usando seu aplicativo futuro.  Grave todas as caixas de di√°logo no gravador e descriptografe.  Isso o ajudar√° a criar um diagrama de conversa√ß√£o t√≠pico e descobrir onde as ramifica√ß√µes podem aparecer. </p><br><h4>  Etapa 2: Desenvolvimento </h4><br><p>  Existem v√°rias maneiras de desenvolver sua a√ß√£o para um assistente: </p><br><ul><li>  Com o Dialogflow. </li><li>  Com a√ß√µes no Google SDK. </li><li>  O texto pode ser processado independentemente - por exemplo, se voc√™ tiver sua pr√≥pria solu√ß√£o para o processamento de linguagem natural (PNL - Natural Language Processing). </li></ul><br><p>  A seguir, a intera√ß√£o de um assistente com sua habilidade. <br>  A caixa de di√°logo √© mais ou menos assim: </p><br><ol><li><p>  O assistente traduz o discurso em texto e o envia para sua a√ß√£o. </p><br></li><li><p>  O texto √© processado de uma das maneiras acima.  Neste diagrama, atrav√©s do Dialogflow. </p><br></li><li><p>  O fluxo de di√°logo define inten√ß√£o (a inten√ß√£o espec√≠fica do usu√°rio) e recebe <br>  dele entidades (par√¢metros). </p><br></li><li><p>  (Opcional) O Dialogflow pode chamar o webhook correspondente, processar os dados no back-end e obter uma resposta. </p><br></li><li><p>  O fluxo de di√°logo forma a resposta. </p><br></li><li><p>  O assistente d√° a resposta, liga o microfone e ouve o que o usu√°rio diz. </p><br></li></ol><br><img src="https://habrastorage.org/webt/ib/us/uf/ibusuffx_dlpg1eewj7ev4xcpzc.png" alt="imagem"><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Diagrama de a√ß√£o do assistente</a> </p><br><h4>  Fluxo de Di√°logo </h4><br><p>  N√£o detalharemos os conceitos b√°sicos do Dialogflow - o Google lan√ßou bons v√≠deos tutoriais. </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Inten√ß√µes</a> - sobre o reconhecimento da inten√ß√£o, como exatamente o Dialogflow entende o que o usu√°rio pede ou que a√ß√£o ele deseja executar. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Entidades</a> - sobre o reconhecimento de par√¢metros dentro de uma frase.  Por exemplo, no caso de recomendar filmes, esse √© um g√™nero espec√≠fico. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Controle de</a> caixa de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">di√°logo</a> - sobre o mecanismo de contexto (sobre ele abaixo) e o cumprimento: sobre como processar a solicita√ß√£o do usu√°rio acessando seu back-end e como retornar algo mais interessante do que uma resposta de texto. </li></ol><br><p>  Assumimos que voc√™ j√° assistiu ao v√≠deo e descobriu o console do Dialogflow.  Vejamos os problemas que surgiram em cada uma das partes do processo de implementa√ß√£o e o que √© interessante pode ser observado. </p><br><p>  Lembre-se tamb√©m das regras para criar um bom di√°logo ao avan√ßar para a implementa√ß√£o - isso afetar√° o conjunto de inten√ß√µes, o conjunto de entidades e seu uso em respostas, o uso de contextos e tudo mais. </p><br><h4>  Inten√ß√µes </h4><br><p>  Existem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">recomenda√ß√µes</a> - para fazer uma sauda√ß√£o mais detalhada para o novo usu√°rio e para o restante para torn√°-lo mais conciso.  Como implementar isso? </p><br><p>  No console do Dialogflow, essa l√≥gica n√£o pode ser determinada.  Isso pode ser feito dentro do cumprimento para a inten√ß√£o de boas-vindas.  Em outras palavras, voc√™ precisar√° fazer isso com as m√£os. </p><br><p>  Isso tamb√©m se aplica ao tratamento de erros.  Por exemplo, pela primeira vez, voc√™ pode simplesmente perguntar novamente, e na segunda vez, pode dizer que tipo de resposta espera do usu√°rio. </p><br><p>  Voc√™ n√£o far√° isso por meio de respostas - uma resposta aleat√≥ria ser√° selecionada.  Voc√™ pode fazer isso atrav√©s da realiza√ß√£o ou um pouco mais complicado, vinculando-o ao contexto (mais sobre isso abaixo). </p><br><h4>  Entidades </h4><br><p>  <b>"Permitir expans√£o automatizada" e sys.Any</b> </p><br><p>  Se a frase tiver estrutura semelhante, quando "Permitir expans√£o automatizada" estiver ativada como uma entidade reconhecida, poder√° ocorrer algo que ainda n√£o pode ser processado com lucro. </p><br><p>  Por exemplo, seu aplicativo reconhece a frase "Sugira-me algo do &lt;g√™nero&gt;" para obter dicas de filmes.  Se voc√™ disser ‚ÄúAconselhe-me algo sobre comida‚Äù, como par√¢metro ‚Äúg√™nero‚Äù voc√™ n√£o obter√° o que esperaria.  Isso faz sentido se o conjunto de g√™neros voc√™ √© atualizado dinamicamente constantemente no back-end e a resposta do usu√°rio √© processada l√°, mas voc√™ n√£o tem tempo para atualizar a entidade. </p><br><p>  Outra solu√ß√£o √© usar o sys.Any.  Nesse caso, ele transmitir√° tudo o que estava ap√≥s o design esperado, que pode ser toda a proposta.  Isso oferece mais oportunidades do que a expans√£o automatizada, mas tamb√©m h√° mais desvantagens. </p><br><p>  <b>Singular e plural, casos, g√™nero</b> </p><br><p>  Vamos criar um exemplo simples.  Falaremos sobre suas frutas favoritas e o aplicativo responder√° como s√£o legais.  Nos exemplos abaixo, P √© o usu√°rio, A √© a nossa a√ß√£o. </p><br><blockquote>  P: O abacaxi √© o mais saboroso. <br>  A: Sim, o abacaxi √© a fruta mais legal! <br></blockquote><p>  Neste exemplo, temos a entidade: Abacaxis <br>  Mas e se o usu√°rio disser "Abacaxi"?  Podemos adicionar um sin√¥nimo. </p><br><blockquote>  P: Gostei do abacaxi. <br>  A: Sim, o abacaxi √© a fruta mais legal! </blockquote><p>  O padr√£o √© o formul√°rio de refer√™ncia - ou seja,  √© a forma original, n√£o seus sin√¥nimos.  √â por isso que o aplicativo n√£o diz "Sim, abacaxi √© a fruta mais legal!" </p><br><p>  Tamb√©m vale a pena considerar ao escrever respostas.  Se tiv√©ssemos a resposta "Sim, $ fruit √© o mais legal!", Ter√≠amos o seguinte: </p><br><blockquote>  P: Gostei do abacaxi. <br>  A: Sim, o abacaxi √© o mais legal! </blockquote><p>  E n√£o se esque√ßa dos casos: </p><br><blockquote>  P: eu quero drama <br>  A: Aqui est√° um drama legal ... <br></blockquote><p>  Portanto, voc√™ deve escrever os valores iniciais da entidade e as respostas de forma consistente.  Por exemplo, podemos fazer todas as formas originais de entidade para frutas no plural e sin√¥nimos em qualquer. </p><br><p>  Faremos g√™neros em russo no caso nominativo, mas em qualquer n√∫mero (drama, horrores). </p><br><p>  Quando chegarmos √†s respostas, n√£o escreveremos "Sim, $ fruta √© a fruta mais legal!"  e "Sim, $ fruit √© o mais legal!"  - os frutos est√£o sempre no plural. </p><br><p>  No caso do idioma russo, vale a pena ir ainda mais longe e pensar em como escrever uma resposta acordada - temos n√£o apenas casos (drama / drama), mas tamb√©m g√™nero (drama / western). </p><br><blockquote>  P: Eu quero um ocidental <br>  A: Aqui est√° um ocidental legal ... <br></blockquote><br><blockquote>  P: Eu quero um ocidental <br>  A: Ocidental?  Ok, aqui est√° um filme legal ... </blockquote><p>  Mas como retornar exatamente o formul√°rio da entidade que o usu√°rio disse? </p><br><p>  No caso de g√™neros, o sin√¥nimo de "fic√ß√£o cient√≠fica" poderia ser "alien√≠genas".  Ent√£o, se o usu√°rio dissesse "alien√≠genas", "fic√ß√£o cient√≠fica" retornaria como par√¢metro. <br>  Se queremos obter a entidade da forma que o usu√°rio disse, vale a pena escolher o valor de $ entity.original </p><br><img src="https://habrastorage.org/webt/vf/eq/9f/vfeq9fm3m3dbgzmmyik5qxvvd0q.png" alt="imagem"><br><p>  Mas ent√£o pode haver problemas com a inconsist√™ncia do n√∫mero e (especialmente) a inconsist√™ncia dos casos.  Isso √© realmente necess√°rio?  Nesse caso, crie uma entidade para singular, plural e mai√∫sculas e min√∫sculas.  As respostas tamb√©m devem ser consistentes com o formul√°rio da entidade que eles usam. </p><br><h4>  Contextos </h4><br><p>  Talvez com isso a maioria dos problemas. </p><br><p>  <b>Contexto de entrada</b> </p><br><p>  Este √© o contexto ao qual uma inten√ß√£o espec√≠fica est√° vinculada.  V√°rias inten√ß√µes podem responder √† mesma frase, e aquela com o contexto de entrada ativo provavelmente funcionar√°. <br>  Assim, por exemplo, voc√™ pode anexar uma resposta sim / n√£o a uma pergunta espec√≠fica, o que √© feito usando a inten√ß√£o de acompanhamento no Dialogflow </p><br><p>  <b>Contexto de sa√≠da</b> </p><br><p>  Este √© o contexto que √© ativado quando a inten√ß√£o √© acionada.  √â assim que os contextos s√£o ativados no console do Dialogflow (isso tamb√©m pode ser feito em execu√ß√£o).  Indicamos o n√∫mero de voltas do di√°logo durante o qual ele estar√° ativo e, ap√≥s redefinir o contador ou ap√≥s 20 minutos, ele √© desativado.  Isso significa que os dados nesse contexto n√£o estar√£o mais dispon√≠veis e as inten√ß√µes para as quais s√£o inseridos n√£o funcionar√£o. </p><br><p>  Outro truque est√° ligado ao mesmo: voc√™ pode ativar um contexto com uma inten√ß√£o e desativ√°-lo manualmente com outra, simplesmente colocando-o como contexto de sa√≠da para a segunda inten√ß√£o com o n√∫mero de respostas 0. </p><br><p>  Se voc√™ n√£o deseja escrever c√≥digo em cumprimento, dessa forma, voc√™ pode implementar uma l√≥gica interessante, por exemplo, usando o contexto como um contador, implementar o tratamento de erros quando o assistente n√£o entender o usu√°rio. </p><br><h4>  Dicas de fluxo de di√°logo </h4><br><ul><li><p>  N√£o h√° necessidade de reiniciar a p√°gina com a visualiza√ß√£o do assistente - quando voc√™ tiver feito altera√ß√µes no agente de fluxo de di√°logo, poder√° aguardar a conclus√£o do treinamento e repetir imediatamente a frase n√£o reconhecida no simulador.  O fluxo de di√°logo pode ser pensado como um back-end ao qual um assistente se refere. </p><br></li><li><p>  Use agentes pr√©-criados - voc√™ pode ver como implementar um cen√°rio t√≠pico. </p><br></li><li><p>  Tenha cuidado com a se√ß√£o de conversas pequenas.  Seu uso n√£o desliga o microfone no final da conversa, e essas respostas geralmente n√£o cont√™m frases de chamariz.  Voc√™ n√£o direciona o usu√°rio para a pr√≥xima rodada de di√°logo e n√£o est√° totalmente claro para ele o que deve ser dito mais adiante.  Com uma alta probabilidade, por isso, voc√™ n√£o pode passar na revis√£o.  √â melhor fazer inten√ß√µes separadas para isso, se voc√™ puder inseri-las na caixa de di√°logo. </p><br></li><li><p>  N√£o edite a mesma inten√ß√£o ao mesmo tempo.  Agora, o trabalho simult√¢neo de v√°rias pessoas n√£o √© suportado - n√£o se sabe cujas altera√ß√µes ser√£o substitu√≠das. </p><br></li><li><p>  Se for necess√°rio paralelizar o trabalho com a inten√ß√£o, ele pode ser realizado em projetos separados, basta selecionar os necess√°rios e transferi-los.  Tamb√©m importe e exporte entidades no json / xml e importe / exporte para a inten√ß√£o. </p><br></li><li><p>  Imediatamente, vale a pena considerar que voc√™ escreve uma a√ß√£o para um idioma espec√≠fico.  Escrever respostas em russo tem nuances adicionais.  Portanto, localizar a a√ß√£o parece ser mais desafiador do que com a GUI do aplicativo m√≥vel. </p><br></li><li><p>  Considere as regras de design das interfaces de voz - elas afetam n√£o apenas o conjunto de r√©plicas, mas tamb√©m a estrutura como um todo.  Voc√™ est√° construindo um di√°logo, portanto, cada resposta deve deixar um plano de a√ß√£o para que o usu√°rio entenda o que dizer. </p><br></li><li><p>  Depois que tudo estiver pronto e voc√™ come√ßar a testar, n√£o tenha medo de abandonar ramos individuais do di√°logo ou dos formul√°rios de perguntas.  Talvez no est√°gio de teste voc√™ entenda como conectar as inten√ß√µes e o que est√° faltando para facilitar o uso. </p><br></li></ul><br><h4>  Conex√£o com o servidor </h4><br><p>  Para conectar o servidor, voc√™ precisa usar o preenchimento.  Existem duas op√ß√µes para isso: </p><br><ul><li>  <strong>Cliente Webhook</strong> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Muitos</a> idiomas suportados. </li><li>  <strong>Editor</strong> embutido nas fun√ß√µes da nuvem para Firebase (node.js). </li></ul><br><p>  Vamos considerar o mais simples - o Editor embutido. </p><br><p>  N√£o pretendemos ser um especialista em node.js; corrigir erros nos coment√°rios √© bem-vindo. </p><br><p>  √â importante prestar aten√ß√£o √† vers√£o da API do Dialogflow. <br>  Vers√£o mais recente v2.  Tudo escrito para a vers√£o v1 n√£o funciona com ele. <br>  Leia mais sobre migra√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . </p><br><p>  Links √∫teis: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">C√≥digo-fonte da documenta√ß√£o e da biblioteca para trabalhar com o cumprimento do fluxo de di√°logo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Introdu√ß√£o ao cumprimento do Dialogflow</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Exemplos</a> </li><li>  Os logs podem ser visualizados aqui: <a href="">V√° para o console do firebase ao lado do bot√£o Implementar</a> </li></ul><br><h4>  Analisar o modelo padr√£o </h4><br><div class="spoiler">  <b class="spoiler_title">Quando voc√™ abre a se√ß√£o Cumprimento, o seguinte c√≥digo √© exibido no arquivo / guia `index.js`:</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">'use strict'; const functions = require('firebase-functions'); const {WebhookClient} = require('dialogflow-fulfillment'); const {Card, Suggestion} = require('dialogflow-fulfillment'); process.env.DEBUG = 'dialogflow:debug'; // enables lib debugging statements exports.dialogflowFirebaseFulfillment = functions.https.onRequest((request, response) =&gt; { const agent = new WebhookClient({ request, response }); console.log('Dialogflow Request headers: ' + JSON.stringify(request.headers)); console.log('Dialogflow Request body: ' + JSON.stringify(request.body)); function welcome(agent) { agent.add(`Welcome to my agent!`); } function fallback(agent) { agent.add(`I didn't understand`); agent.add(`I'm sorry, can you try again?`); } // // Uncomment and edit to make your own intent handler // // uncomment `intentMap.set('your intent name here', yourFunctionHandler);` // // below to get this function to be run when a Dialogflow intent is matched // function yourFunctionHandler(agent) { // agent.add(`This message is from Dialogflow's Cloud Functions for Firebase editor!`); // agent.add(new Card({ // title: `Title: this is a card title`, // imageUrl: 'https://developers.google.com/actions/images/badges/XPM_BADGING_GoogleAssistant_VER.png', // text: `This is the body text of a card. You can even use line\n breaks and emoji! `, // buttonText: 'This is a button', // buttonUrl: 'https://assistant.google.com/' // }) // ); // agent.add(new Suggestion(`Quick Reply`)); // agent.add(new Suggestion(`Suggestion`)); // agent.setContext({ name: 'weather', lifespan: 2, parameters: { city: 'Rome' }}); // } // // Uncomment and edit to make your own Google Assistant intent handler // // uncomment `intentMap.set('your intent name here', googleAssistantHandler);` // // below to get this function to be run when a Dialogflow intent is matched // function googleAssistantHandler(agent) { // let conv = agent.conv(); // Get Actions on Google library conv instance // conv.ask('Hello from the Actions on Google client library!') // Use Actions on Google library // agent.add(conv); // Add Actions on Google library responses to your agent's response // } // // See https://github.com/dialogflow/dialogflow-fulfillment-nodejs/tree/master/samples/actions-on-google // // for a complete Dialogflow fulfillment library Actions on Google client library v2 integration sample // Run the proper function handler based on the matched Dialogflow intent name let intentMap = new Map(); intentMap.set('Default Welcome Intent', welcome); intentMap.set('Default Fallback Intent', fallback); // intentMap.set('your intent name here', yourFunctionHandler); // intentMap.set('your intent name here', googleAssistantHandler); agent.handleRequest(intentMap); });</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">E essas depend√™ncias no arquivo / guia `package.json`:</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">{ "name": "dialogflowFirebaseFulfillment", "description": "This is the default fulfillment for a Dialogflow agents using Cloud Functions for Firebase", "version": "0.0.1", "private": true, "license": "Apache Version 2.0", "author": "Google Inc.", "engines": { "node": "~6.0" }, "scripts": { "start": "firebase serve --only functions:dialogflowFirebaseFulfillment", "deploy": "firebase deploy --only functions:dialogflowFirebaseFulfillment" }, "dependencies": { "actions-on-google": "2.0.0-alpha.4", "firebase-admin": "^4.2.1", "firebase-functions": "^0.5.7", "dialogflow": "^0.1.0", "dialogflow-fulfillment": "0.3.0-beta.3" } }</code> </pre> </div></div><br><p>  Primeiro, atualize as depend√™ncias alfa e beta para as mais recentes est√°veis. </p><br><div class="spoiler">  <b class="spoiler_title">Aqui est√£o as vers√µes mais recentes no momento.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">{ "dependencies": { "actions-on-google": "^2.2.0", "firebase-admin": "^5.2.1", "firebase-functions": "^0.6.2", "dialogflow": "^0.6.0", "dialogflow-fulfillment": "^0.5.0" } }</code> </pre> </div></div><br><p>  E agora vamos dar uma olhada no c√≥digo. </p><br><div class="spoiler">  <b class="spoiler_title">Acima √© feito a importa√ß√£o de depend√™ncias</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">// Cloud Functions  Firebase library const functions = require('firebase-functions'); //       const {WebhookClient} = require('dialogflow-fulfillment'); //       const {Card, Suggestion} = require('dialogflow-fulfillment');</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">O ponto principal do cumprimento √© substituir o retorno de chamada - um `dialogflowFirebaseFulfillment`</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">exports.dialogflowFirebaseFulfillment = functions.https.onRequest((request, response) =&gt; { console.log('Dialogflow Request headers: ' + JSON.stringify(request.headers)); console.log('Dialogflow Request body: ' + JSON.stringify(request.body)); //   . const agent = new WebhookClient({ request, response }); //   let result = request.body.queryResult; //  action  entities https://dialogflow.com/docs/actions-and-parameters let action = result.action; let parameters = result.parameters; //    https://dialogflow.com/docs/contexts let outputContexts = result.outputContexts; //       let intentRequest = request.body.originalDetectIntentRequest; });</code> </pre> </div></div><br><p>  Esse retorno de chamada ser√° chamado para as inten√ß√µes para as quais voc√™ ativa o preenchimento completo. </p><br><div class="spoiler">  <b class="spoiler_title">Agora redefina a resposta para a inten√ß√£o</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">exports.dialogflowFirebaseFulfillment = functions.https.onRequest((request, response) =&gt; { const agent = new WebhookClient({ request, response }); function welcome(agent) { //   agent.add(`Welcome to my agent!`); } function fallback(agent) { agent.add(`I didn't understand`); agent.add(`I'm sorry, can you try again?`); } //   ,  : // key -   intent-. // value -   ,   . let intentMap = new Map(); intentMap.set('Default Welcome Intent', welcome); intentMap.set('Default Fallback Intent', fallback); agent.handleRequest(intentMap); });</code> </pre> </div></div><br><p>  Ao mesmo tempo, o c√≥digo substitui completamente a resposta de inten√ß√£o da se√ß√£o Respostas. <br>  As respostas ser√£o chamadas apenas se o retorno de chamada falhar, para que voc√™ possa manipular erros l√°. </p><br><p>  Removemos as fun√ß√µes de processamento de inten√ß√£o do retorno de chamada. <br>  As fun√ß√µes de boas-vindas e fallback est√£o no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fechamento</a> . </p><br><div class="spoiler">  <b class="spoiler_title">Para remov√™-los do retorno de chamada, voc√™ precisar√° adicionar a transfer√™ncia do contexto da fun√ß√£o e dos par√¢metros via `bind`</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">exports.dialogflowFirebaseFulfillment = functions.https.onRequest((request, response) =&gt; { const agent = new WebhookClient({ request, response }); let intentMap = new Map(); //  set  Map.      intentMap .set('Default Welcome Intent', welcome.bind(this, agent)) .set('Default Fallback Intent', fallback.bind(this, agent)); agent.handleRequest(intentMap); }); function welcome(agent) { agent.add(`Welcome to my agent!`); } function fallback(agent) { //   2   add    agent.add([ `I didn't understand`, `I'm sorry, can you try again?` ]); }</code> </pre> </div></div><br><p> ,     ,       Google Assistant.  ,       . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt419773/">https://habr.com/ru/post/pt419773/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt419763/index.html">Exemplos de c√°lculo do "fator de disponibilidade" para conjuntos de equipamentos de rede</a></li>
<li><a href="../pt419765/index.html">O curso "Linguagens de programa√ß√£o da Web" (baseado em Ruby) do MSTU. N.E. Bauman no canal Technostream</a></li>
<li><a href="../pt419767/index.html">O criador da Wikipedia responde a perguntas: programa√ß√£o, sono, livros, dicas para a vida</a></li>
<li><a href="../pt419769/index.html">O WireGuard "chegar√°" ao kernel do Linux - por qu√™?</a></li>
<li><a href="../pt419771/index.html">Resumo da Fintech: o Banco Central acelera a coleta de biometria dos clientes, as criptomoedas est√£o caindo e o mercado para a Internet das coisas est√° crescendo</a></li>
<li><a href="../pt419775/index.html">Minha vers√£o do "dispositivo para sonhos l√∫cidos" √© uma breve hist√≥ria e descri√ß√£o da primeira vers√£o</a></li>
<li><a href="../pt419777/index.html">Como vender servidores NNN na Holanda e n√£o ficar com puro entusiasmo: segredos de vendas</a></li>
<li><a href="../pt419779/index.html">Os pulm√µes crescidos foram transplantados com sucesso para um porco; ap√≥s 5 anos, testes em humanos s√£o poss√≠veis</a></li>
<li><a href="../pt419781/index.html">A SpaceX realizou o primeiro Workshop de Marte</a></li>
<li><a href="../pt419783/index.html">Homem versus m√°quina: uma nova √©tica para a seguran√ßa cibern√©tica</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>