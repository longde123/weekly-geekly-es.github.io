<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ›©ï¸ ğŸ˜ ğŸ¤´ğŸ¿ File QVD - apa yang ada di dalamnya, bagian 2 ğŸŒ± ğŸ¦• ğŸš•</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam artikel pertama tentang struktur file QVD, saya menggambarkan struktur umum dan memikirkan metadata dengan cukup detail. Pada artikel ini, saya ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>File QVD - apa yang ada di dalamnya, bagian 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/alfastrah/blog/455940/"><p>  Dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel pertama</a> tentang struktur file QVD, saya menggambarkan struktur umum dan memikirkan metadata dengan cukup detail.  Pada artikel ini, saya akan menjelaskan format untuk menyimpan informasi tentang kolom, dan berbagi pengalaman saya dalam menafsirkan data ini. </p><br><p>  Jadi (ingat) file QVD sesuai dengan tabel relasional, yang, seperti yang Anda ketahui, terdiri dari baris.  Setiap baris tabel, pada gilirannya, terdiri dari kolom (atau bidang), dan baris memiliki struktur yang sama, yang dapat dijelaskan, misalnya oleh operator SQL (buat tabel). </p><br><p>  Dalam file QVD, sebuah tabel disimpan sebagai dua bagian yang tidak langsung terkait: </p><br><p>  <strong>Tabel karakter</strong> (istilah saya) mengandung nilai unik untuk setiap kolom di tabel sumber.  Ini tentang mereka yang akan kita bahas di bawah ini. </p><br><p>  <strong>Tabel</strong> baris berisi baris tabel sumber, setiap baris menyimpan indeks nilai kolom (bidang) dari baris dalam tabel simbol yang sesuai.  Saya akan membahas tabel baris secara lebih rinci di bagian <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ketiga</a> dari seri ini. </p><a name="habracut"></a><br><p>  Pada contoh piring kami (ingat - dari bagian pertama) </p><br><pre><code class="plaintext hljs">SET NULLINTERPRET =&lt;sym&gt;; tab1: LOAD * INLINE [ ID, NAME 123.12,"Pete" 124,12/31/2018 -2,"Vasya" 1,"John" &lt;sym&gt;,"None" ];</code> </pre> <br><p>  Di piring ini: </p><br><ul><li>  5 baris </li><li>  bidang "ID" memiliki 4 nilai unik (NULL tidak dianggap sebagai nilai, lebih detail tentangnya di bagian ketiga) </li><li>  bidang â€œNAMEâ€ memiliki 5 nilai unik </li><li>  baris pertama dalam tabel baris akan berisi indeks 0 dan 0, masing-masing sesuai dengan nilai 123,12 dan "Pete" </li></ul><br><h2 id="specialnye-sluchai">  Acara khusus </h2><br><p>  Sebagai aturan, tabel simbol dibuat untuk semua bidang tabel dalam file QVD.  Namun ada nuansa. </p><br><p>  Jika bidang memiliki satu nilai, maka nilai ini biasanya disimpan dalam tabel simbol (dalam hal ini, tabel simbol akan berisi satu catatan).  Dan dalam tabel baris, bidang tidak akan ada (karena jelas nilai bidang ini di setiap baris ...) </p><br><p>  Jika bidang tidak memiliki nilai sama sekali (selalu berisi NULL), tidak ada tabel simbol yang dibuat di sana. </p><br><p>  Kasus khusus ini akan dijelaskan di bagian ketiga, ketika kita sampai pada garis dan algoritma untuk rekreasi mereka. </p><br><h2 id="hranenie-tablic-simvolov-v-fayle">  Menyimpan tabel karakter dalam file </h2><br><p>  Setiap tabel simbol disimpan dalam file QVD sebagai blok biner, offsetnya (relatif terhadap awal blok biner) terkandung dalam bidang Offset bagian metadata dari bidang ini, panjangnya (dalam byte) adalah di bidang Panjang metadata. </p><br><p>  Dengan demikian, tabel karakter pertama akan selalu memiliki offset 0. </p><br><p>  Tabel simbol mengikuti satu demi satu dan tidak dipisahkan satu sama lain dengan cara apa pun. </p><br><h2 id="struktura-tablicy-simvolov">  Struktur Tabel Karakter </h2><br><p>  Tabel simbol berisi nilai-nilai bidang yang saling mengikuti tanpa pemisah, setiap nilai diwakili sebagai berikut: </p><br><ul><li>  satu byte mengkodekan tipe bidang (saya akan jelaskan di bawah) </li><li>  kemudian muncul nilai biner opsional (tergantung pada jenis bidang) </li><li>  diikuti oleh nilai string opsional (tergantung pada jenis bidang) </li></ul><br><p>  String disimpan "sebagaimana adanya" (dalam pengkodean yang ditentukan dalam metadata), string berakhir dengan byte nol.  String dapat memiliki panjang nol, mis.  hanya terdiri dari nol byte. </p><br><p>  Nilai biner disimpan sesuai dengan aturan arsitektur tempat file QVD dihasilkan (dari pengalaman saya, Anda bisa membacanya sebagai nilai biner dengan mata "endian"). </p><br><h1 id="tipy-poley">  Jenis bidang </h1><br><p>  Seluruh variasi tipe data QVD disatukan dengan tiga dasar </p><br><ul><li>  (1) integer (4 byte) </li><li>  (2) titik apung (8 byte) </li><li>  (4) baris yang diakhiri dengan nol </li></ul><br><p>  Ada juga tipe gabungan </p><br><ul><li>  (5) integer diikuti oleh representasi stringnya (4 byte plus string dengan byte nol) </li><li>  (6) angka floating-point diikuti oleh representasi string-nya (8 byte plus string dengan byte nol) </li></ul><br><p>  Dalam tanda kurung saya telah memberikan nilai numerik dari "jenis" (byte pertama dari nilai bidang dalam tabel simbol). </p><br><p>  Pikiran yang bertanya akan bertanya, "di mana ketiganya?"  Ini bukan untuk saya, saya juga punya banyak pertanyaan, dari komentar di sini, seperti kata pahlawan Khabensky dalam film terkenal "Aku akan menahan diri ...". </p><br><p>  Secara umum, itu saja, tidak sulit - kan? </p><br><h1 id="dva-ne-ochen-priyatnyh-prakticheskih-nablyudeniya">  Dua pengamatan praktis yang tidak terlalu menyenangkan </h1><br><p>  Satu dan bidang yang sama dapat memiliki nilai tipe yang berbeda di tabel simbol (integer, mengambang, dan string).  Saya sendiri tidak percaya sampai saya melakukan serangkaian percobaan ... Satu-satunya hal yang dapat "dijamin" (dengan peringatan dari bagian pertama - tidak ada yang bisa dijamin) - tidak ada campuran "angka" dan "angka dengan string" (baik satu atau yang lain) )  Ini penting, pikiran yang bertanya akan mengerti :-). </p><br><p>  Nilai-nilai bidang non-numerik (bukan tipe 1 dan 2 dalam notasi di atas) harus dibaca berturut-turut - tidak mungkin untuk memposisikan diri pada nomor bidang N ... Dapat dimengerti, tetapi tidak efisien (dalam hal pemrosesan). </p><br><p>  Perhatikan lagi label kami di atas, tabel karakter bidang ID akan terlihat seperti ini (saya menulis byte / karakter): </p><br><ul><li>  angka 6 (tipe) + 8 byte (nilai mengambang 123,12) + 7 byte (string "123,12" dengan nol byte) </li><li>  angka 5 (tipe) + 4 byte (nilai integer 124) + 4 byte (string "124" dengan byte nol) </li><li>  angka 5 (tipe) + 4 byte (integer -2) + 3 byte (string "-2" dengan nol byte) </li><li>  angka 5 (tipe) + 4 byte (integer 1) + 2 byte (string "1" dengan byte nol) </li></ul><br><p>  Total 40 byte (lihat bagian sebelumnya - metadata, nilai atribut Length untuk bidang ID). </p><br><h2 id="iz-praktiki">  Dari latihan </h2><br><p>  Tugas praktis (salah satunya), seperti yang sudah saya tulis, bagi saya adalah membuat ulang tabel menggunakan file QVD.  Dari uraian di atas berikut (setidaknya - harus mengikuti, saya mencoba :-)) bahwa dari uraian kolom (metadata plus data) tidak mungkin menentukan jenis bidang secara jelas (yang, misalnya, tulis dalam "buat tabel ...") . </p><br><p>  Seperti yang saya sebutkan di bagian pertama - 90% bidang memiliki tipe UNKNOWN dalam metadata, tag juga tidak memungkinkan Anda untuk secara unik mengatur jenis bidang (Saya tidak akan memuat pembaca dengan detail - percayalah) ... </p><br><p>  Bagaimana menjadi </p><br><p>  Dalam pekerjaan saya, saya mengikuti jalur statistik - saya menganalisis persentase tertentu dari nilai kolom dan, berdasarkan hasil, menarik kesimpulan - jenis apa yang akan ditugaskan padanya.  Keakuratannya cukup memuaskan, masalahnya adalah Anda perlu menganalisis (dalam kasus umum) semua data ... Dalam praktik saya, saya membatasi diri pada 5-10% pertama dari nilai bidang. </p><br><p>  Jika kita berakhir dengan tentang tipe data, maka pikiran yang bertanya akan mengajukan pertanyaan yang masuk akal - "buat tabel" yang disebutkan menyiratkan lebih banyak tipe data ... </p><br><p>  Saya akan mengatakan ini: dalam file yang diproses tidak ditemukan tipe data selain yang tercantum di atas.  File-file tersebut berhubungan dengan tabel nyata dari database nyata dan berisi seluruh spektrum tipe data (misalnya, saya bahkan mendapat gumpalan ... Mengapa mereka berada di QVD ??? Akan lebih baik untuk menulis komentar). </p><br><p>  Mungkin, untuk melengkapi gambar dengan tipe data, Anda perlu menjelaskan tentang tanggal dan stempel waktu (tipe lain adalah masalah panjang). </p><br><p>  Tanggal disajikan dalam QVD sebagai bilangan bulat - jumlah hari dari awal era (era klik).  Pakar QlikView / QlikSense akan dengan mudah memberi tahu Anda saat dimulai (meskipun 30 Desember 1899, jangan tanya kenapa). </p><br><p>  Stempel waktu di QVD diwakili oleh angka floating-point yang berisi tanggal seperti yang dijelaskan di atas, dan waktu di bagian fraksional (di mana 0,0 sesuai dengan waktu "00:00:00" dan 0,999999 sesuai dengan waktu "23:59:59" - lihat lebih detail, misalnya di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> ). </p><br><p>  Saya belum menggali jauh ke arah ini - tabel saya yang dibuat ulang dari QVD berisi tipe bilangan bulat dan mengambang untuk bidang seperti "tanggal" dan "datetime".  Atau, Anda bisa menggunakan representasi string - untuk bidang tipe ini representasi gabungan selalu digunakan (tipe 5 dan 6). </p><br><p>  Yang terakhir (tentang latihan) - saat membaca file besar, adalah logis untuk membuat indeks untuk bidang string, yang saya lakukan.  Ini secara signifikan mengurangi waktu pemrosesan dalam kasus di mana ukuran tabel simbol jauh lebih sedikit daripada jumlah baris (mis., Satu nilai terjadi lebih dari satu kali di bidang tabel asli). </p><br><h2 id="podytozhim">  Untuk meringkas </h2><br><p>  Dalam artikel ini, kami memeriksa penyimpanan nilai unik bidang (kolom), melihat bahwa kolom disimpan sebagai urutan nilai unik, menyadari bahwa tipe data dicampur dan hanya ada tiga jenis (integer, mengambang, dan baris). </p><br><p>  Selanjutnya, kita perlu berkenalan dengan bagaimana string disimpan - bagian <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ketiga</a> dan terakhir dari serangkaian artikel tentang struktur QVD akan dikhususkan untuk ini. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id455940/">https://habr.com/ru/post/id455940/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id455930/index.html">Java, Istio, Kubernetes, Docker - kami mengundang Anda ke pertemuan IBM di Moskow dan St. Petersburg</a></li>
<li><a href="../id455932/index.html">Bagaimana Kami Menemukan Cara Keren untuk Menghubungkan Bisnis dan DevOps</a></li>
<li><a href="../id455934/index.html">Transfer data cadangan dari versi baru MS SQL Server ke versi yang lebih lama</a></li>
<li><a href="../id455936/index.html">Bapak Perangkat Lunak Bebas, Richard Stallman, datang ke Rusia. Kami mencari seseorang yang siap untuk melindunginya selama beberapa hari</a></li>
<li><a href="../id455938/index.html">Apakah perangkat lunak berkualitas tinggi sepadan dengan biaya pengembangannya?</a></li>
<li><a href="../id455942/index.html">Protokol untuk komunikasi antara iframe dan jendela browser utama</a></li>
<li><a href="../id455944/index.html">Mulai bekerja dengan freelancer. Belajar berkeliling</a></li>
<li><a href="../id455946/index.html">Konten yang dilarang di Google Play - pencarian survival</a></li>
<li><a href="../id455948/index.html">RAMBleed: mengambil kunci RSA dalam 34 jam</a></li>
<li><a href="../id455950/index.html">Bahasa pemrograman yang paling langka dan paling mahal. Bagian II</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>