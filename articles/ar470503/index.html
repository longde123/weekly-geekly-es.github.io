<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌲 🎠 💶 Kubernetes RBAC المستخدمين والترخيص 🧑 ☎️ 🚴</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="تقريبا. العابرة. : استمرارًا للموضوع الذي تم طرحه مؤخرًا حول أمان Kubernetes بشكل عام و RBAC على وجه الخصوص ، فإننا ننشر ترجمة لهذه المادة من مستشار ف...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kubernetes RBAC المستخدمين والترخيص</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/470503/" style=";text-align:right;direction:rtl">  <i><b>تقريبا.</b></i>  <i><b>العابرة.</b></i>  <i>: استمرارًا للموضوع الذي <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تم طرحه مؤخرًا</a> حول أمان Kubernetes بشكل عام و RBAC على وجه الخصوص ، فإننا ننشر ترجمة لهذه المادة من مستشار فرنسي من شركة Adaltas Big Data الدولية.</i>  <i>يوضح المؤلف بالتفصيل كيفية إنشاء المستخدمين ومنحهم الحقوق والاستمرار في الخدمة.</i> <br><br>  إن بدء وبدء تشغيل مجموعة Kubernetes هو البداية فقط: يجب استغلالها أيضًا.  لتأمين الوصول إلى الكتلة ، تحتاج إلى تعيين بيانات اعتماد المستخدم وإدارة إعدادات المصادقة والتخويل بشكل صحيح. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/m5/y9/az/m5y9azz-gbidcxue2_eesz-gvxo.png"></div>  <i>(رسم توضيحي مأخوذ من <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مدونة CNCF</a> - ترجمة تقريبية.)</i> <br><br>  تتناول هذه المقالة كيفية إنشاء مستخدمين يستخدمون شهادات عميل <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">X.509</a> ، وكيفية إدارة التخويل باستخدام واجهات برمجة تطبيقات <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">RBAC</a> الأساسية في Kubernetes.  سنتحدث أيضًا عن بعض مشاريع المصادر المفتوحة التي تعمل على تبسيط إدارة نظام المجموعة: rakkess ، و kubectl-who-can ، و rbac-lookup ، و RBAC Manager. <a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  الشروط المسبقة والافتراضات </h2><br>  بادئ ذي بدء ، يجب وضع عدة افتراضات: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">على</a> الأقل يمكنك أن تتخيل <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">كيف تعمل Kubernetes</a> . </li><li style=";text-align:right;direction:rtl">  لديك <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">كتلة Kubernetes</a> أو Minikube العمل. </li><li style=";text-align:right;direction:rtl">  لديك <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الأداة المساعدة kubectl CLI مثبتة</a> . </li><li style=";text-align:right;direction:rtl">  لديك حزمة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">OpenSSL</a> مثبتة. </li></ul><cut></cut><br>  إذا لم يكن لديك نظام Kubernetes جاهز ، فأنا أوصي بالرجوع إلى مقالة زميل (Arthur BUSSER) يتحدث فيها عن <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تثبيت Kubernetes على CentOS 7</a> باستخدام Vagrant. <br><br>  هناك 4 نقاط في مجموعتنا: سيد واحد و 3 عمال.  سيتم استخدام المعالج أيضًا كعقدة حافة للتفاعل مع الكتلة. <br><br><h2 style=";text-align:right;direction:rtl">  واجهات برمجة التطبيقات RBAC </h2><br>  التحكم في الوصول المستند إلى الدور (RBAC) هو طريقة للتحكم في الوصول إلى أجهزة الكمبيوتر وموارد الشبكة ، استنادًا إلى أدوار المستخدمين الفرديين في الشركة.  يمكن استخدام RBAC مع جميع موارد Kubernetes التي تدعم CRUD (إنشاء ، قراءة ، تحديث ، حذف).  أمثلة على هذه الموارد: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  مساحة الاسم. </li><li style=";text-align:right;direction:rtl">  Pod'y. </li><li style=";text-align:right;direction:rtl">  Deployment'y. </li><li style=";text-align:right;direction:rtl">  وحدات التخزين الثابتة (PersistentVolumes) ؛ </li><li style=";text-align:right;direction:rtl">  ConfigMap'y. </li></ul><br>  وإليك أمثلة لعمليات محتملة معهم: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>create</code> </li><li style=";text-align:right;direction:rtl">  <code>get</code> <i>(الاستقبال)؛</i> </li><li style=";text-align:right;direction:rtl">  <code>delete</code> <i>(حذف)</i> ؛ </li><li style=";text-align:right;direction:rtl">  <code>list</code> <i>(عرض</i> <code>list</code> <i>)</i> ؛ </li><li style=";text-align:right;direction:rtl">  <code>update</code> . </li></ul><br>  لإدارة RBAC في Kubernetes ، نحتاج إلى إعلان: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b><code>Role</code> و <code>ClusterRole</code></b> .  هذه ببساطة مجموعات قواعد تمثل مجموعة من الأذونات.  لا يمكن استخدام <code>Role</code> إلا لتوفير الوصول إلى الموارد داخل مساحات الأسماء.  يمكن أن يوفر <code>ClusterRole</code> نفس أذونات <code>Role</code> ، كما يتيح الوصول إلى الموارد المتاحة داخل المجموعة بأكملها ، وما يسمى بنقاط النهاية غير المتعلقة بالموارد <i>(مثل <code>/healthz</code> - approx. Transl.)</i> . </li><li style=";text-align:right;direction:rtl">  <b><code>Subjects</code></b> .  الموضوع هو كيان يقوم بإجراء عمليات في كتلة.  يمكن أن يكون المستخدمون أو الخدمات أو حتى المجموعات. </li><li style=";text-align:right;direction:rtl">  <b><code>RoleBinding</code> و <code>ClusterRoleBinding</code></b> .  كما يوحي الاسم ، هذا هو ببساطة ملزمة للموضوع إلى دور أو ClusterRole. </li></ul><br>  Kubernetes لديه الأدوار الافتراضية التالية: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>view</code> : الوصول للقراءة فقط ، باستثناء الأسرار ؛ </li><li style=";text-align:right;direction:rtl">  <code>edit</code> : أعلاه + القدرة على تحرير معظم الموارد ، يستبعد الأدوار وربط الأدوار ؛ </li><li style=";text-align:right;direction:rtl">  <code>admin</code> : ما سبق + القدرة على إدارة الأدوار وتعيينات الأدوار على مستوى مساحة الاسم ؛ </li><li style=";text-align:right;direction:rtl">  <code>cluster-admin</code> : جميع الامتيازات الممكنة. </li></ul><br>  بالطبع ، يمكنك إنشاء <code>ClusterRoles</code> و <code>ClusterRoles</code> الخاصة بك ، لكننا نوصيك باستخدام الأدوار الافتراضية قدر الإمكان ، بقدر ما يسمح الموقف.  خلاف ذلك ، يمكنك الحصول على الخلط بسرعة في كل هذا. <br><br><h2 style=";text-align:right;direction:rtl">  مثال للاستخدام </h2><br>  سننشئ مساحات أسماء اثنين: <code>my-project-dev</code> و <code>my-project-prod</code> ، - بالإضافة إلى اثنين من المستخدمين: <code>jean</code> و <code>sarah</code> - مع أدوار مختلفة في مساحات الأسماء هذه: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  بلدي مشروع ديف: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  جان: تحرير </li></ul></li><li style=";text-align:right;direction:rtl">  بلدي مشروع همز: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  جان: رأي </li><li style=";text-align:right;direction:rtl">  سارة: تحرير </li></ul></li></ul><br><h3 style=";text-align:right;direction:rtl">  إنشاء ومصادقة المستخدمين باستخدام شهادات عميل X.509 </h3><br>  عادة ، هناك نوعان من المستخدمين: <i>حسابات الخدمة</i> التي تديرها Kubernetes والمستخدمون العاديون.  سوف نركز على هذا الأخير.  إليك كيفية وصفها في الوثائق الرسمية: <br><br><blockquote style=";text-align:right;direction:rtl">  من المفترض أن تتم إدارة المستخدمين العاديين بواسطة خدمة خارجية مستقلة.  يمكن لعب الدور بواسطة مسؤول يوزع المفاتيح الخاصة ، أو مستودع مستخدم مثل Keystone أو Google Accounts ، أو حتى ملف به قائمة بأسماء المستخدمين وكلمات المرور.  في هذا الصدد ، Kubernetes لا يوجد لديه كائنات تمثل المستخدمين العاديين.  لا يمكن إضافة المستخدمين العاديين إلى الكتلة من خلال مكالمة API. </blockquote><br>  هناك عدة طرق لإدارة المستخدمين العاديين: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>المصادقة</i> الأساسية: <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  نقل التكوين إلى خادم API بالمحتويات التالية (أو ما شابه): كلمة المرور ، اسم المستخدم ، معرف المستخدم ، المجموعة ؛ </li></ul></li><li style=";text-align:right;direction:rtl">  شهادة عميل X.509: <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  إنشاء المفتاح السري للمستخدم وتوقيع الشهادة ؛ </li><li style=";text-align:right;direction:rtl">  شهادة في مرجع مصدق (Kubernetes CA) للحصول على شهادة مستخدم ؛ </li></ul></li><li style=";text-align:right;direction:rtl">  رموز حامل (JSON Web Tokens، JWT): <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  OpenID الاتصال </li><li style=";text-align:right;direction:rtl">  طبقة المصادقة أعلى OAuth 2.0 ؛ </li><li style=";text-align:right;direction:rtl">  السنانير ويب <i>(webhooks).</i> </li></ul></li></ul><br>  في هذه المقالة ، سوف نستخدم شهادات X.509 و OpenSSL بسبب بساطتها.  يتم إنشاء المستخدمين على عدة مراحل - سنستعرضهم جميعًا.  يجب إجراء العمليات تحت حساب المستخدم مع امتيازات مسؤول الكتلة (نظام المجموعة).  فيما يلي جميع الخطوات لإنشاء مستخدم (باستخدام <code>jean</code> كمثال): <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  قم بإنشاء مستخدم على المعالج ، ثم انتقل إلى دليله الرئيسي لإكمال الخطوات المتبقية: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">useradd jean &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /home/jean</code> </pre> </li><li style=";text-align:right;direction:rtl">  إنشاء مفتاح خاص: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">openssl genrsa -out jean.key 2048</code> </pre> </li><li style=";text-align:right;direction:rtl">  قم بإنشاء طلب توقيع شهادة (CSR).  <code>CN</code> هو اسم المستخدم ، <code>O</code> هي المجموعة.  يمكنك تعيين أذونات حسب المجموعة.  سيؤدي ذلك إلى تبسيط العمل ، على سبيل المثال ، إذا كان لديك العديد من المستخدمين بنفس الأذونات: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#   openssl req -new -key jean.key \ -out jean.csr \ -subj "/CN=jean" #     $group openssl req -new -key jean.key \ -out jean.csr \ -subj "/CN=jean/O=$group" #       openssl req -new -key jean.key \ -out jean.csr \ -subj "/CN=jean/O=$group1/O=$group2/O=$group3"</span></span></code> </pre> </li><li style=";text-align:right;direction:rtl">  تسجيل المسؤولية الاجتماعية للشركات في Kubernetes CA.  يجب علينا استخدام شهادة المرجع المصدق والمفتاح ، والتي توجد عادة في <code>/etc/kubernetes/pki</code> .  ستكون الشهادة صالحة لمدة 500 يوم: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">openssl x509 -req -<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> jean.csr \ -CA /etc/kubernetes/pki/ca.crt \ -CAkey /etc/kubernetes/pki/ca.key \ -CAcreateserial \ -out jean.crt -days 500</code> </pre> </li><li style=";text-align:right;direction:rtl">  قم <code>.certs</code> دليل <code>.certs</code> .  فيه ، سنقوم بتخزين مفاتيح المستخدم العامة والخاصة: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mkdir .certs &amp;&amp; mv jean.crt jean.key .certs</code> </pre> </li><li style=";text-align:right;direction:rtl">  إنشاء مستخدم داخل Kubernetes: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl config <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>-credentials jean \ --client-certificate=/home/jean/.certs/jean.crt \ --client-key=/home/jean/.certs/jean.key</code> </pre> </li><li style=";text-align:right;direction:rtl">  تعيين السياق للمستخدم: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl config <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>-context jean-context \ --cluster=kubernetes --user=jean</code> </pre> </li><li style=";text-align:right;direction:rtl">  تحرير ملف تكوين المستخدم.  أنه يحتوي على المعلومات اللازمة للمصادقة في كتلة.  يمكنك استخدام ملف تكوين نظام المجموعة ، والذي يوجد عادةً في <code>/etc/kubernetes</code> : يجب أن تكون متغيرات <code>certificate-authority-data</code> <code>server</code> ومتغيرات <code>server</code> كما هي في الملف المذكور: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: v1 clusters: - cluster: certificate-authority-data: {  } server: {  } name: kubernetes contexts: - context: cluster: kubernetes user: jean name: jean-context current-context: jean-context kind: Config preferences: {} users: - name: jean user: client-certificate: /home/jean/.certs/jean.cert client-key: /home/jean/.certs/jean.key</code> </pre> <br>  أنت الآن بحاجة إلى نسخ التكوين أعلاه إلى دليل <code>.kube</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mkdir .kube &amp;&amp; vi .kube/config</code> </pre> </li><li style=";text-align:right;direction:rtl">  يبقى لجعل المستخدم مالك جميع الملفات والدلائل التي تم إنشاؤها: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">chown -R jean: /home/jean/</code> </pre> </li></ul><br>  <code>jean</code> إنشاء <code>jean</code> المستخدم بنجاح.  سنفعل نفس الشيء من أجل <code>sarah</code> .  هناك خطوات قليلة للغاية ، ويمكن أن يستغرق إنشاء عدد كبير من المستخدمين وقتًا طويلاً.  لذلك ، كتبت نصوص Bash التي تعمل على أتمتة العملية: يمكن العثور عليها في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">المستودع على GitHub</a> . <br><br>  <i><b>تقريبا.</b></i>  <i><b>العابرة.</b></i>  <i>: كما كتبنا في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مقالتنا الأخيرة</a> ، يمكن تبسيط هذا الإجراء بطريقة أكثر "محلية" إلى Kubernetes - من خلال ميزات جديدة في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الأداة المساعدة kubeadm console</a> .</i>  <i>ومع ذلك ، تذكر أنه في وقت نشر هذه الترجمة ، كانت متوفرة في شكل ألفا.</i>  <i>مثال على الأمر لإنشاء مستخدم هو مستخدم <code>kubeadm alpha kubeconfig user</code> .</i> <br><br>  لدينا الآن مستخدمون ، ويمكننا الانتقال إلى إنشاء مساحات أسماء اثنين: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl create namespace my-project-dev kubectl create namespace my-project-prod</code> </pre> <br>  نظرًا لأننا لم نحدد بعد ترخيص المستخدم ، فلا ينبغي أن يكون لهم حق الوصول إلى موارد نظام المجموعة: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">User: Jean kubectl get nodes Error from server (Forbidden): nodes is forbidden: User <span class="hljs-string"><span class="hljs-string">"jean"</span></span> cannot list resource <span class="hljs-string"><span class="hljs-string">"nodes"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> API group <span class="hljs-string"><span class="hljs-string">""</span></span> at the cluster scope kubectl get pods -n default Error from server (Forbidden): pods is forbidden: User <span class="hljs-string"><span class="hljs-string">"jean"</span></span> cannot list resource <span class="hljs-string"><span class="hljs-string">"pods"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> API group <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the namespace <span class="hljs-string"><span class="hljs-string">"default"</span></span> kubectl get pods -n my-project-prod Error from server (Forbidden): pods is forbidden: User <span class="hljs-string"><span class="hljs-string">"jean"</span></span> cannot list resource <span class="hljs-string"><span class="hljs-string">"pods"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> API group <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the namespace <span class="hljs-string"><span class="hljs-string">"my-project-prod"</span></span> kubectl get pods -n my-project-dev Error from server (Forbidden): pods is forbidden: User <span class="hljs-string"><span class="hljs-string">"jean"</span></span> cannot list resource <span class="hljs-string"><span class="hljs-string">"pods"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> API group <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the namespace <span class="hljs-string"><span class="hljs-string">"my-project-dev"</span></span></code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">User: Sarah kubectl get nodes Error from server (Forbidden): nodes is forbidden: User <span class="hljs-string"><span class="hljs-string">"sarah"</span></span> cannot list resource <span class="hljs-string"><span class="hljs-string">"nodes"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> API group <span class="hljs-string"><span class="hljs-string">""</span></span> at the cluster scope kubectl get pods -n default Error from server (Forbidden): pods is forbidden: User <span class="hljs-string"><span class="hljs-string">"sarah"</span></span> cannot list resource <span class="hljs-string"><span class="hljs-string">"pods"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> API group <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the namespace <span class="hljs-string"><span class="hljs-string">"default"</span></span> kubectl get pods -n my-project-prod Error from server (Forbidden): pods is forbidden: User <span class="hljs-string"><span class="hljs-string">"sarah"</span></span> cannot list resource <span class="hljs-string"><span class="hljs-string">"pods"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> API group <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the namespace <span class="hljs-string"><span class="hljs-string">"my-project-prod"</span></span> kubectl get pods -n my-project-dev Error from server (Forbidden): pods is forbidden: User <span class="hljs-string"><span class="hljs-string">"sarah"</span></span> cannot list resource <span class="hljs-string"><span class="hljs-string">"pods"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> API group <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the namespace <span class="hljs-string"><span class="hljs-string">"my-project-dev"</span></span></code> </pre> <br><h3 style=";text-align:right;direction:rtl">  خلق الدور و ClusterRole </h3><br>  سوف نستخدم <code>ClusterRole</code> ، المتاحة بشكل افتراضي.  ومع ذلك ، نعرض أيضًا كيفية إنشاء <code>Role</code> و <code>ClusterRole</code> الخاص بك.  في الجوهر ، يمثل كل من <code>Role</code> and <code>ClusterRole</code> مجرد مجموعة من الإجراءات <i>(تسمى <code>verbs</code> ، أي الأفعال الكلامية)</i> المسموح بها لموارد ومساحات أسماء معينة.  فيما يلي مثال لملف YAML: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: rbac.authorization.k8s.io/v1beta1 kind: Role metadata: name: list-deployments namespace: my-project-dev rules: - apiGroups: [ apps ] resources: [ deployments ] verbs: [ get, list ] --------------------------------- apiVersion: rbac.authorization.k8s.io/v1beta1 kind: ClusterRole metadata: name: list-deployments rules: - apiGroups: [ apps ] resources: [ deployments ] verbs: [ get, list ]</code> </pre> <br>  لإنشائها ، قم بتشغيل الأمر: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl create -f /path/to/your/yaml/file</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ربط دور أو ClusterRole للمستخدمين </h3><br>  الآن ربط <code>ClusterRole</code> الافتراضي ( <code>edit</code> <code>view</code> ) لمستخدمينا على النحو التالي: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>jean</code> : <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>edit</code> - في مساحة الاسم <code>my-project-dev</code> ؛ </li><li style=";text-align:right;direction:rtl">  <code>view</code> - في مساحة الاسم <code>my-project-prod</code> ؛ </li></ul></li><li style=";text-align:right;direction:rtl">  <code>sarah</code> : <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>edit</code> - في مساحة الاسم <code>my-project-prod</code> . </li></ul></li></ul><br>  يجب تحديد RoleBindings بمساحات الأسماء ، وليس بواسطة المستخدمين.  بمعنى آخر ، لتخويل <code>jean</code> سننشئ اثنين من RoleBindings.  مثال على ملف YAML يعرّف RoleBindings لـ <code>jean</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: rbac.authorization.k8s.io/v1 kind: RoleBinding metadata: name: jean namespace: my-project-dev subjects: - kind: User name: jean apiGroup: rbac.authorization.k8s.io roleRef: kind: ClusterRole name: edit apiGroup: rbac.authorization.k8s.io --------------------------------- apiVersion: rbac.authorization.k8s.io/v1 kind: RoleBinding metadata: name: jean namespace: my-project-prod subjects: - kind: User name: jean apiGroup: rbac.authorization.k8s.io roleRef: kind: ClusterRole name: view apiGroup: rbac.authorization.k8s.io</code> </pre> <br>  نحن نسمح لـ <code>jean</code> <code>view</code> <code>my-project-prod</code> وتعديل <code>my-project-dev</code> .  نفس الشيء يجب القيام به <code>sarah</code> .  لتنشيطها ، قم بتشغيل الأمر: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl apply -f /path/to/your/yaml/file</code> </pre> <br>  في هذه الحالة ، تم استخدام <code>kubectl apply</code> بدلاً من <code>kubectl create</code> .  الفرق بينهما هو أن <code>create</code> يخلق الكائن ولا يفعل أي شيء آخر ، <code>apply</code> - ليس فقط إنشاء الكائن (إذا لم يكن موجودا) ، ولكن أيضا التحديثات إذا لزم الأمر. <br><br>  دعونا نتحقق مما إذا كان مستخدمونا قد حصلوا على الأذونات اللازمة. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  مستخدم: <code>sarah</code> ( <code>edit</code> في <code>my-project-prod</code> ) <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <code>my-project-prod</code> <ul style=";text-align:right;direction:rtl"> <li style=";text-align:right;direction:rtl">  يمكن سرد القرون (1) ؛ </li><li style=";text-align:right;direction:rtl">  يمكن إنشاء نشرات (2). </li></ul></li><li style=";text-align:right;direction:rtl"> <code>my-project-dev</code> <ul style=";text-align:right;direction:rtl"> <li style=";text-align:right;direction:rtl">  لا يمكن سرد القرون (4) ؛ </li><li style=";text-align:right;direction:rtl">  لا يمكن إنشاء نشرات (5). </li></ul></li></ul></li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">(1) kubectl get pods -n my-project-prod No resources found. (2) kubectl run nginx --image=nginx --replicas=1 -n my-project-prod deployment.apps/nginx created (3) kubectl get pods -n my-project-prod NAME READY STATUS RESTARTS AGE nginx-7db9fccd9b-t14qw 1/1 Running 0 4s (4) kubectl get pods -n my-project-dev Error from server (Forbidden): pods is forbidden: User <span class="hljs-string"><span class="hljs-string">"sarah"</span></span> cannot list resource <span class="hljs-string"><span class="hljs-string">"pods"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> API group <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the namespace <span class="hljs-string"><span class="hljs-string">"my-project-dev"</span></span> (5) kubectl run nginx --image=nginx --replicas=1 -n my-project-dev Error from server (Forbidden): deployments.apps is forbidden: User <span class="hljs-string"><span class="hljs-string">"sarah"</span></span> cannot create resource <span class="hljs-string"><span class="hljs-string">"deployments"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> API group <span class="hljs-string"><span class="hljs-string">"apps"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the namespace <span class="hljs-string"><span class="hljs-string">"my-project-dev"</span></span></code> </pre> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  المستخدم: <code>jean</code> ( <code>view</code> في <code>my-project-prod</code> في <code>my-project-dev</code> ) <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <code>my-project-prod</code> <ul style=";text-align:right;direction:rtl"> <li style=";text-align:right;direction:rtl">  يمكن سرد القرون (1) ؛ </li><li style=";text-align:right;direction:rtl">  يمكن سرد نشر '2 (؛ </li><li style=";text-align:right;direction:rtl">  لا يمكن حذف النشرات (3). </li></ul></li><li style=";text-align:right;direction:rtl">  بلدي مشروع ديف: <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  يمكن سرد القرون (4) ؛ </li><li style=";text-align:right;direction:rtl">  يمكن إنشاء نشرات (5) ؛ </li><li style=";text-align:right;direction:rtl">  يمكن سرد نشر '6 (؛ </li><li style=";text-align:right;direction:rtl">  يمكن إزالة النشرات (7). </li></ul></li></ul></li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">(1) kubectl get pods -n my-project-prod NAME READY STATUS RESTARTS AGE nginx-7db9fccd9b-t14qw 1/1 Running 0 101s (2) kubectl get deploy -n my-project-prod NAME READY UP-TO-DATE AVAILABLE AGE nginx 1/1 1 1 110s (3) kubectl delete deploy/nginx -n my-project-prod Error from server (Forbidden): deployments.extensions <span class="hljs-string"><span class="hljs-string">"nginx"</span></span> is forbidden: User <span class="hljs-string"><span class="hljs-string">"jean"</span></span> cannot delete resource <span class="hljs-string"><span class="hljs-string">"deployments"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> API group <span class="hljs-string"><span class="hljs-string">"extensions"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the namespace <span class="hljs-string"><span class="hljs-string">"my-project-prod"</span></span> (4) kubectl get pods -n my-project-dev No resources found. (5) kubectl run nginx --image=nginx --replicas=1 -n my-project-dev deployment.apps/nginx created (6) kubectl get deploy -n my-project-dev NAME READY UP-TO-DATE AVAILABLE AGE nginx 0/1 1 0 13s (7) kubectl delete deploy/nginx -n my-project-dev deployment.extensions <span class="hljs-string"><span class="hljs-string">"nginx"</span></span> deleted (8) kubectl get deploy -n my-project-dev No resources found.</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  إدارة المستخدم والترخيص </h2><br>  لذلك ، قمنا بتعيين الأدوار المختلفة وتصاريح المستخدم بنجاح.  السؤال الذي يطرح نفسه: كيف الآن لإدارة كل هذا؟  كيف أعرف ما إذا تم تعيين أذونات مستخدم معين بشكل صحيح؟  كيف أعرف من لديه السلطة لأداء إجراء محدد؟  كيفية الحصول على صورة عامة لأذونات المستخدم؟ <br><br>  نحتاج إلى إجابات على كل هذه الأسئلة لضمان أمان نظام المجموعة.  يسمح لك الأمر <code>kubectl auth can-i</code> بمعرفة ما إذا كان بإمكان المستخدم تنفيذ إجراء معين: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># kubectl auth can-i $action $resource --as $subject (1) kubectl auth can-i list pods (2) kubectl auth can-i list pods --as jean</span></span></code> </pre> <br>  يسمح الأمر الأول (1) للمستخدم بمعرفة ما إذا كان يمكنه القيام ببعض الإجراءات.  الثاني (2) - يسمح للمسؤول بانتحال شخصية المستخدم لمعرفة ما إذا كان يمكنه تنفيذ إجراء معين.  يُسمح بهذا "التناسخ" فقط للمستخدمين ذوي امتيازات مسؤول الكتلة. <br><br>  هذا هو عمليا كل ما يمكن القيام به مع مجموعة الأدوات المدمجة.  هذا هو السبب في أنني سأقدم بعض مشاريع المصادر المفتوحة التي تعمل على توسيع القدرات التي يوفرها فريق can-i kubectl.  قبل تقديمها ، لنقم بإنشاء التبعيات: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Go</a> and <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Krew</a> . <br><br><h2 style=";text-align:right;direction:rtl">  الذهاب التثبيت </h2><br>  Go هي لغة برمجة مفتوحة المصدر تتيح لك إنشاء برامج بسيطة وموثوقة وفعالة.  تم تطويره بواسطة Google تحت إلهام C و Pascal ، استنادًا إلى المفاهيم الأصلية <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">لروبرت Griesemer</a> و <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Rob Pike</a> و <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ken Thompson</a> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">wget https://dl.google.com/go/go1.12.5.linux-amd64.tar.gz sudo tar -C /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span> -xzf go1.12.5.linux-amd64.tar.gz <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> PATH=<span class="hljs-variable"><span class="hljs-variable">$PATH</span></span>:/usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/go/bin</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  Krew التثبيت </h2><br>  Krew هي أداة تعمل على تبسيط استخدام <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الإضافات kubectl</a> .  يساعدك Krew في العثور على المكونات الإضافية وتثبيتها وإدارتها.  فيما يتعلق بالوظائف ، فهي تشبه أدوات مثل apt أو dnf أو brew.  Krew متوافق فقط مع kubectl الإصدار 1.12 وأعلى. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> -x; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$(mktemp -d)</span></span></span><span class="hljs-string">"</span></span> &amp;&amp; curl -fsSLO <span class="hljs-string"><span class="hljs-string">"https://storage.googleapis.com/krew/v0.2.1/krew.{tar.gz,yaml}"</span></span> &amp;&amp; tar zxvf krew.tar.gz &amp;&amp; ./krew-<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$(uname | tr '[:upper:]' '[:lower:]')</span></span></span><span class="hljs-string">_amd64"</span></span> install \ --manifest=krew.yaml --archive=krew.tar.gz <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> PATH=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${KREW_ROOT:-$HOME/.krew}</span></span></span><span class="hljs-string">/bin:</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PATH</span></span></span><span class="hljs-string">"</span></span></code> </pre> <br><h2 style=";text-align:right;direction:rtl">  rakkess </h2><br>  يسمح لك <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هذا المشروع</a> بعرض جميع الأذونات الممنوحة للمستخدم.  على سبيل المثال ، يساعد في الإجابة على سؤال ما الذي يمكن أن يفعله <code>jean</code> .  بادئ ذي بدء ، دعونا تثبيته: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl krew install access-matrix</code> </pre> <br>  يمكن العثور على وثائق المشروع في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">المستودع على GitHub</a> .  هنا مثال على عمله: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl access-matrix -n my-project-dev --as jean</code> </pre> <br><img src="https://habrastorage.org/webt/0g/sq/b6/0gsqb6cw-paqkn6yxbuozzccgpq.png"><br><br><h2 style=";text-align:right;direction:rtl">  kubect الذين يمكن، </h2><br>  يسمح لنا <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هذا المشروع</a> بمعرفة المستخدمين الذين يمكنهم تنفيذ إجراء محدد.  إنها تساعد في الإجابة على السؤال: "من يستطيع فعل هذا؟"  الإعداد: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">go get -v github.com/aquasecurity/kubectl-who-can</code> </pre> <br>  الوثائق في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مستودع جيثب</a> .  مثال العمل: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl-who-can list pods -n default No subjects found with permissions to list pods assigned through RoleBindings CLUSTERROLEBINDING SUBJECT TYPE SA-NAMESPACE cluster-admin system:masters Group rbac-manager rbac-manager ServiceAccount rbac-manager system:controller:attachdetach-controller attachdetach-controller ServiceAccount kube-system system:controller:clusterrole-aggregation-controller clusterrole-aggregation-controller ServiceAccount kube-system system:controller:cronjob-controller cronjob-controller ServiceAccount kube-system system:controller:daemon-set-controller daemon-set-controller ServiceAccount kube-system system:controller:deployment-controller deployment-controller ServiceAccount kube-system system:controller:endpoint-controller endpoint-controller ServiceAccount kube-system system:controller:generic-garbage-collector generic-garbage-collector ServiceAccount kube-system system:controller:horizontal-pod-autoscaler horizontal-pod-autoscaler ServiceAccount kube-system system:controller:job-controller job-controller ServiceAccount kube-system system:controller:namespace-controller namespace-controller ServiceAccount kube-system system:controller:node-controller node-controller ServiceAccount kube-system system:controller:persistent-volume-binder persistent-volume-binder ServiceAccount kube-system system:controller:pod-garbage-collector pod-garbage-collector ServiceAccount kube-system system:controller:pvc-protection-controller pvc-protection-controller ServiceAccount kube-system system:controller:replicaset-controller replicaset-controller ServiceAccount kube-system system:controller:replication-controller replication-controller ServiceAccount kube-system system:controller:resourcequota-controller resourcequota-controller ServiceAccount kube-system system:controller:statefulset-controller statefulset-controller ServiceAccount kube-system system:coredns coredns ServiceAccount kube-system system:kube-controller-manager system:kube-controller-manager User system:kube-scheduler system:kube-scheduler User</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  RBAC-بحث </h2><br>  يوفر <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هذا المشروع</a> نظرة عامة على قواعد RBAC.  إنها تساعد في الإجابة على الأسئلة: "ما هو الدور الذي ينتمي إليه <code>jean</code> <code>sarah</code> ؟" ، "ما هو الدور الذي ينتمي إليه جميع المستخدمين؟" ، "ما هو الدور الذي تنتمي إليه المجموعة بأكملها؟".  لتثبيت ، قم بتشغيل الأمر: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl krew install rbac-lookup</code> </pre> <br>  الوثائق في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مستودع جيثب</a> .  هنا مثال على العمل: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl-rbac_lookup jean SUBJECT SCOPE ROLE jean my-project-dev ClusterRole/edit jean my-project-prod ClusterRole/view kubectl-rbac_lookup sarah SUBJECT SCOPE ROLE sarah my-project-prod ClusterRole/edit kubectl-rbac_lookup --kind user SUBJECT SCOPE ROLE jean my-project-dev ClusterRole/edit jean my-project-prod ClusterRole/view sarah my-project-prod ClusterRole/edit system:anonymous kube-public Role/kubeadm:bootstrap-signer-clusterinfo system:kube-controller-manager kube-system Role/extension-apiserver-authentication-reader system:kube-controller-manager kube-system Role/system::leader-locking-kube-controller-manager system:kube-controller-manager cluster-wide ClusterRole/system:kube-controller-manager system:kube-proxy cluster-wide ClusterRole/system:node-proxier system:kube-scheduler kube-system Role/extension-apiserver-authentication-reader system:kube-scheduler kube-system Role/system::leader-locking-kube-scheduler system:kube-scheduler cluster-wide ClusterRole/system:kube-scheduler system:kube-scheduler cluster-wide ClusterRole/system:volume-scheduler kubectl-rbac_lookup --kind group SUBJECT SCOPE ROLE system:authenticated cluster-wide ClusterRole/system:basic-user system:authenticated cluster-wide ClusterRole/system:discovery system:authenticated cluster-wide ClusterRole/system:public-info-viewer system:bootstrappers:kubeadm:default-node-token cluster-wide ClusterRole/system:node-bootstrapper system:bootstrappers:kubeadm:default-node-token cluster-wide ClusterRole/system:certificates.k8s.io:certificatesigningrequests:nodeclient system:bootstrappers:kubeadm:default-node-token kube-system Role/kube-proxy system:bootstrappers:kubeadm:default-node-token kube-system Role/kubeadm:kubelet-config-1.14 system:bootstrappers:kubeadm:default-node-token kube-system Role/kubeadm:nodes-kubeadm-config system:masters cluster-wide ClusterRole/cluster-admin system:nodes kube-system Role/kubeadm:kubelet-config-1.14 system:nodes kube-system Role/kubeadm:nodes-kubeadm-config system:nodes cluster-wide ClusterRole/system:certificates.k8s.io:certificatesigningrequests:selfnodeclient system:unauthenticated cluster-wide ClusterRole/system:public-info-viewer</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  مدير RBAC </h2><br>  كما يوحي اسم <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هذا المشروع</a> بوضوح ، فهو مدير RBAC.  يبسط العديد من التلاعب اللازمة.  ربما الأهم هو إنشاء RoleBindings.  لقد رأينا في وقت سابق أنه عند إنشاء أدوار مختلفة للمستخدم ، من الضروري إنشاء RoleBindings مختلفة.  يساعد مدير RBAC من خلال السماح لك بإنشاء رولبينغ واحد فقط مع كل التفويض في وقت واحد.  للتثبيت ، يجب عليك تنزيل ملف YAML من المستودع على GitHub: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">kubectl apply -f /path/to/rbac/manager/yaml/file</code> </pre> <br>  الوثائق الرسمية موجودة في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مستودع جيثب</a> .  مثال العمل: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: rbacmanager.reactiveops.io/v1beta1 kind: RBACDefinition metadata: name: jose rbacBindings: - name: jose subjects: - kind: User name: jose roleBindings: - namespace: my-project-prod clusterRole: edit - namespace: my-project-dev clusterRole: edit</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  استنتاج </h2><br>  أنشأنا مستخدمين في نظام Kubernetes باستخدام شهادة عميل X.509 مع OpenSSL وتمكينهم.  لتسهيل إنشاء المستخدم ، يمكنك استخدام البرنامج النصي المتاح في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مستودع التخزين الخاص بي على GitHub</a> <i>(أو <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">أوامر kubeadm</a> التجريبية - ترجمة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تقريبية</a> )</i> .  أما بالنسبة لإدارة نظام المجموعة ، فيمكنك استخدام المشاريع مفتوحة المصدر الواردة في المقالة: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">kubectl auth can-i</a> : معرفة ما إذا كان يمكن للمستخدم إجراء بعض الإجراءات ؛ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">rakkess</a> : اكتشف جميع الإجراءات التي يمكن للمستخدم القيام بها ؛ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">kubectl-who-can</a> : تحديد المستخدمين الذين يمكنهم القيام ببعض الإجراءات ؛ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">rbac-lookup</a> : الحصول على نظرة عامة على RBAC ؛ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مدير RBAC</a> : تبسيط التكوين من خلال الجمع بين روابط الحقوق ، وأتمتة التغييرات على RBAC ، وذلك باستخدام التصنيفات كمحددات لتعيين الحقوق. </li></ul><br>  يمكن أن يتحول إنشاء المستخدمين إلى مهمة تستغرق وقتًا كبيرًا ، خاصةً إذا كنت بحاجة إلى تعيين عدد كبير من المستخدمين في وقت واحد (أو إنشائها كثيرًا).  للتخفيف من هذا الموقف ، يمكن توصيل LDAP للشركات بمجموعة Kubernetes.  تقدم بعض مشاريع المصادر المفتوحة ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Kismatic</a> <i>[</i> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Object</a> <i>تبدو مهجورة]</i> و <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ObjectifLibre</a> ) Kooknet webhooks التي تتيح المصادقة المباشرة من خلال LDAP.  حل آخر ممكن هو تكوين خادم OpenID مع LDAP للشركات كخلفية. <br><br><h2 style=";text-align:right;direction:rtl">  PS من المترجم </h2><br>  اقرأ أيضًا في مدونتنا: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">أبجديات الأمن في Kubernetes: المصادقة ، إذن ، التدقيق</a> " ؛ </li><li style=";text-align:right;direction:rtl">  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">فهم RBAC في Kubernetes</a> " ؛ </li><li style=";text-align:right;direction:rtl">  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">33+ أدوات أمان Kubernetes</a> " ؛ </li><li style=";text-align:right;direction:rtl">  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">9 من أفضل ممارسات الأمان في Kubernetes</a> ." </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar470503/">https://habr.com/ru/post/ar470503/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar470487/index.html">المسابقات التكنولوجية Radiofest-2019</a></li>
<li><a href="../ar470489/index.html">أسبوع الأمان 41: المزيد من نقاط الضعف في بطاقات SIM ، فك تشفير PDF</a></li>
<li><a href="../ar470497/index.html">كيفية استخدام systemd-nspawn لاستعادة نظام Linux</a></li>
<li><a href="../ar470499/index.html">كيفية استخدام الانقطاعات في Unity Animator على أكمل وجه</a></li>
<li><a href="../ar470501/index.html">Monad "Reader" عبر المزامنة / في انتظار C #</a></li>
<li><a href="../ar470513/index.html">كيف وجدت منزلاً ذكيًا يهيمن عليه الروبوتات</a></li>
<li><a href="../ar470515/index.html">خطوة صغيرة للاختبار: أفضل 10 تقارير من Heisenbug 2019 Piter</a></li>
<li><a href="../ar470517/index.html">EP الروسية لأصغر</a></li>
<li><a href="../ar470519/index.html">تجربة بناء مجموعات Linux للحصول على تحديثات اللوحة الفردية مع الدعم</a></li>
<li><a href="../ar470529/index.html">كيف قمنا بترجمة المشروع القديم إلى GraphQL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>