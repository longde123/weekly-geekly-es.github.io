<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📪 🙏🏼 💷 Programmation relationnelle: douleur, intérêt et douleur à nouveau 😦 ✋🏻 💃🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans le post précédent, nous avons expliqué en détail ce que nous enseignons aux étudiants dans le domaine de la "programmation industrielle". Pour ce...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Programmation relationnelle: douleur, intérêt et douleur à nouveau</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hsespb/blog/441114/"> Dans le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">post</a> précédent, nous avons expliqué en détail ce que nous enseignons aux étudiants dans le domaine de la "programmation industrielle".  Pour ceux dont le domaine d'intérêt se situe dans un domaine plus théorique, par exemple, attiré par les nouveaux paradigmes de programmation ou les mathématiques abstraites utilisées dans la recherche théorique sur la programmation, il existe une autre spécialisation - «Langages de programmation». <br><br>  Aujourd'hui je vais vous parler de mes recherches dans le domaine de la programmation relationnelle, que je fais à l'université et en tant qu'étudiant-chercheur au laboratoire des outils linguistiques JetBrains Research. <br><br>  Qu'est-ce que la programmation relationnelle?  Habituellement, nous exécutons une fonction avec des arguments et obtenons le résultat.  Et dans le cas relationnel, vous pouvez faire le contraire: corriger le résultat et un argument, et obtenir le deuxième argument.  L'essentiel est d'écrire le code correctement et d'être patient et d'avoir un bon cluster. <br><br><img src="https://habrastorage.org/webt/_u/8b/t2/_u8bt2bceznm8e2ujbrvhwn8awy.jpeg"><br><a name="habracut"></a><br><h2>  À propos de moi </h2><br>  Je m'appelle Dmitry Rozplohas, je suis un étudiant de première année du HSE de Saint-Pétersbourg, et l'année dernière j'ai obtenu mon diplôme du programme de baccalauréat de l'Université académique dans le domaine des «langages de programmation».  Depuis la troisième année d'études de premier cycle, je suis également étudiante de recherche au laboratoire d'outils linguistiques JetBrains Research. <br><br><h2>  Programmation relationnelle </h2><br><h3>  Faits généraux </h3><br>  La programmation relationnelle, c'est quand, au lieu de fonctions, vous décrivez la relation entre les arguments et le résultat.  Si le langage est affiné pour cela, vous pouvez obtenir certains bonus, par exemple, la possibilité d'exécuter la fonction dans le sens opposé (restaurer les valeurs possibles des arguments en conséquence). <br><br>  En général, cela peut être fait dans n'importe quel langage logique, mais l'intérêt pour la programmation relationnelle est apparu simultanément avec l'avènement d'un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">miniKanren en</a> langage logique pur minimaliste il y a une dizaine d'années, ce qui a permis de décrire et d'utiliser commodément de telles relations. <br><br>  Voici certains des cas d'utilisation les plus avancés: vous pouvez écrire un vérificateur de preuve et l'utiliser pour trouver des preuves ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Near et al., 2008</a> ) ou créer un interpréteur pour une langue et l'utiliser pour générer des programmes de suite de tests ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Byrd et al., 2017</a> ). <br><br><h3>  Exemple de syntaxe et de jouet </h3><br>  miniKanren est un petit langage; seules les constructions mathématiques de base sont utilisées pour décrire les relations.  Il s'agit d'un langage intégré, ses primitives sont une bibliothèque pour certains langages externes et de petits programmes miniKanren peuvent être utilisés dans un programme dans une autre langue. <br><br>  Langues étrangères adaptées à miniKanren, tout un tas.  Initialement, il y avait Scheme, nous travaillons avec la version pour Ocaml ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OCanren</a> ), et la liste complète peut être consultée sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">minikanren.org</a> .  Les exemples de cet article concerneront également OCanren.  De nombreuses implémentations ajoutent des fonctions d'assistance, mais nous nous concentrerons uniquement sur le langage principal. <br><br>  Commençons par les types de données.  Classiquement, ils peuvent être divisés en deux types: <br><br><ul><li>  Les constantes sont des données du langage dans lequel nous sommes intégrés.  Chaînes, nombres, même tableaux.  Mais pour le miniKanren de base, tout cela est une boîte noire, l'égalité des constantes ne peut être vérifiée. <br></li><li>  Un «terme» est un tuple de plusieurs éléments.  Couramment utilisé de la même manière que les constructeurs de données dans Haskell: constructeur de données (chaîne) plus zéro ou plusieurs paramètres.  OCanren utilise des constructeurs de données réguliers d'OCaml. <br></li></ul><br>  Par exemple, si nous voulons travailler avec des tableaux dans miniKanren lui-même, alors il doit être décrit en termes de termes similaires aux langages fonctionnels - comme une liste liée individuellement.  Une liste est soit une liste vide (indiquée par un terme simple), soit une paire du premier élément de la liste («tête») et d'autres éléments («queue»). <br><br><pre><code class="plaintext hljs">let emptyList = Nil let list_123 = Cons (1, Cons (2, Cons (3, Nil)))</code> </pre> <br>  Un programme miniKanren est la relation entre certaines variables.  Au démarrage, le programme donne toutes les valeurs possibles des variables sous une forme générale.  Souvent, les implémentations vous permettent de limiter le nombre de réponses dans la sortie, par exemple, ne trouvez que la première - la recherche ne s'arrête pas toujours après avoir trouvé toutes les solutions. <br><br>  Vous pouvez écrire plusieurs relations définies les unes par rapport aux autres et même appelées de manière récursive en tant que fonctions.  Par exemple, ci-dessous, nous au lieu de la fonction <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mi>p</mi><mi>p</mi><mi>e</mi><mi>n</mi><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mi>a</mi><mi>v</mi><mi>e</mi><mi>c</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.395ex" height="2.66ex" viewBox="0 -832 8781.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-70" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-70" x="1033" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-65" x="1536" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-6E" x="2003" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-64" x="2603" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMAIN-28" x="3127" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-61" x="3516" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMAIN-2C" x="4046" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-62" x="4491" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMAIN-29" x="4920" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMAIN-2192" x="5587" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-61" x="6866" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-76" x="7395" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-65" x="7881" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-63" x="8347" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></mi><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></mo><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un</font></font></mi><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></mo><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></mi><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></mo><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">→</font></font></mo><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> append (a, b) → avec </script>  définir la relation <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mi>p</mi><mi>p</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>o</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>c</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.502ex" height="2.66ex" viewBox="0 -832 6674.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-70" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-70" x="1033" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-65" x="1536" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-6E" x="2003" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-64" x="2603" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-6F" x="3127" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMAIN-28" x="3612" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-61" x="4002" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMAIN-2C" x="4531" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-62" x="4976" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMAIN-2C" x="5406" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-63" x="5851" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMAIN-29" x="6284" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></mi><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></mo><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un</font></font></mi><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></mo><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></mi><mo><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></mo><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></mi><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></mo></math></span></span><script type="math/tex" id="MathJax-Element-2"> appendo (a, b, c) </script>  : liste <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.007ex" height="1.455ex" viewBox="0 -520.7 433.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-63" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> c </script>  est une concaténation de listes <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.455ex" viewBox="0 -520.7 529.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-61" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un</font></font></mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> a </script>  et <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.057ex" viewBox="0 -780.1 429.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></mi></math></span></span><script type="math/tex" id="MathJax-Element-5"> b </script>  .  Les fonctions qui renvoient des relations se terminent traditionnellement par un «o» pour les distinguer des fonctions ordinaires. <br><br>  Une relation est écrite comme une déclaration concernant ses arguments.  Nous avons <b>quatre opérations de base</b> : <br><br><ul><li>  Unification ou égalité (===) de deux termes, les termes peuvent inclure des variables.  Par exemple, vous pouvez écrire la relation «liste <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.693ex" height="2.057ex" viewBox="0 -780.1 298.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-6C" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></mi></math></span></span><script type="math/tex" id="MathJax-Element-6"> l </script>  se compose d'un élément <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></mi></math></span></span><script type="math/tex" id="MathJax-Element-7"> x </script>  ": <br><br><pre> <code class="plaintext hljs">let isSingletono xl = l === Cons (x, Nil)</code> </pre></li><li>  Conjonction (logique «et») et disjonction (logique «ou») - comme dans la logique ordinaire.  OCanren sont appelés &amp;&amp;&amp; et |||.  Mais il n'y a fondamentalement aucun déni logique dans MiniKanren. <br></li><li>  Ajout de nouvelles variables.  En logique, c'est un quantificateur d'existence.  Par exemple, pour vérifier la liste de non-vide, vous devez vérifier que la liste se compose d'une tête et d'une queue.  Ce ne sont pas des arguments de la relation, vous devez donc créer de nouvelles variables: <br><br><pre> <code class="plaintext hljs">let nonEmptyo l = fresh (ht) (l === Cons (h, t))</code> </pre></li></ul><br>  Une relation peut s'invoquer récursivement.  Par exemple, vous devez définir l'élément "relation" <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></mi></math></span></span><script type="math/tex" id="MathJax-Element-8"> x </script>  se trouve sur la liste. "  Nous allons résoudre ce problème en analysant des cas triviaux, comme dans les langages fonctionnels: <br><br><ol><li>  Ou la tête de liste est <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> x </script><br></li><li>  Soit <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> x </script>  se trouve dans la queue <br></li></ol><br><pre> <code class="plaintext hljs">let membero lx = fresh (ht) ( (l === Cons (h, t)) &amp;&amp;&amp; (x === h ||| membero tx) )</code> </pre><br>  La version de base du langage est construite sur ces quatre opérations.  Il existe également des extensions qui vous permettent d'utiliser d'autres opérations.  Le plus utile d'entre eux est la contrainte de déséquilibre pour fixer l'inégalité de deux termes (= / =). <br><br>  Malgré le minimalisme, miniKanren est un langage assez expressif.  Par exemple, regardez la concaténation relationnelle de deux listes.  La fonction de deux arguments se transforme en une triple relation " <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.227ex" height="2.057ex" viewBox="0 -780.1 959 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-62" x="529" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un</font></font></mi><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> ab </script>  est une concaténation de listes <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.455ex" viewBox="0 -520.7 529.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-61" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un</font></font></mi></math></span></span><script type="math/tex" id="MathJax-Element-12"> a </script>  et <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.057ex" viewBox="0 -780.1 429.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></mi></math></span></span><script type="math/tex" id="MathJax-Element-13"> b </script>  ". <br><br><pre> <code class="plaintext hljs">let appendo ab ab = (a === Nil &amp;&amp;&amp; ab === b) ||| (fresh (ht tb) (*  :  fresh   &amp;&amp;&amp; *) (a = Cons (h, t)) (appendo tb tb) (ab === Cons (h, tb)))</code> </pre><br>  La solution n'est pas structurellement différente de la façon dont nous l'écririons dans un langage fonctionnel.  Nous analysons deux cas unis par une clause: <br><br><ol><li>  Si la première liste est vide, la deuxième liste et le résultat de la concaténation sont égaux. <br></li><li>  Si la première liste n'est pas vide, alors nous l'analysons dans la tête et la queue et construisons le résultat en utilisant un appel récursif de la relation. <br></li></ol><br>  Nous pouvons faire une demande à cette relation, en fixant le premier et le deuxième argument - nous obtenons la concaténation des listes: <br><br><pre> <code class="plaintext hljs">run 1 (λ q -&gt; appendo (Cons (1, Cons (2, Nil))) (Cons (3, Cons (4, Nil))) q)</code> </pre> <br>  ⇒ <br><pre> <code class="plaintext hljs">q = Cons (1, Cons (2, Cons (3, Cons (4, Nil))))</code> </pre> <br>  Nous pouvons corriger le dernier argument - nous obtenons toutes les partitions de cette liste en deux. <br><br><pre> <code class="plaintext hljs">run 4 (λ qr -&gt; appendo qr (Cons (1, Cons (2, Cons (3, Nil)))))</code> </pre> <br>  ⇒ <br><pre> <code class="plaintext hljs">q = Nil, r = Cons (1, Cons (2, Cons (3, Nil))) | q = Cons (1, Nil), r = Cons (2, Cons (3, Nil)) | q = Cons (1, Cons (2, Nil)), r = Cons (3, Nil) | q = Cons (1, Cons (2, Cons (3, Nil))), r = Nil</code> </pre><br>  Vous pouvez faire autre chose.  Un exemple légèrement plus non standard, dans lequel nous ne corrigeons qu'une partie des arguments: <br><br><pre> <code class="plaintext hljs">run 1 (λ qr -&gt; appendo (Cons (1, Cons (q, Nil))) r (Cons (1, Cons (2, Cons (3, Cons (4, Nil))))))</code> </pre> <br>  ⇒ <br><pre> <code class="plaintext hljs">q = 2, r = Cons (3, Cons (4, Nil))</code> </pre> <br><br><h3>  Comment ça marche </h3><br>  Du point de vue de la théorie, il n'y a rien d'impressionnant ici: vous pouvez toujours simplement commencer à rechercher toutes les options possibles pour tous les arguments, en vérifiant pour chaque ensemble s'ils se comportent par rapport à une fonction / relation donnée comme nous le souhaiterions (voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"The British Museum Algorithm"</a> ) .  Il est intéressant de noter qu'ici, la recherche (en d'autres termes, la recherche d'une solution) utilise uniquement la structure de la relation décrite, grâce à laquelle elle peut être relativement efficace dans la pratique. <br><br>  La recherche est en relation avec l'accumulation d'informations sur diverses variables dans l'état actuel.  Soit nous ne savons rien de chaque variable, soit nous savons comment elle est exprimée en termes, valeurs et autres variables.  Par exemple: <br><br> <code>b = Cons (x, y) <br> c = Cons (10, z) <br> x = ? <br> y = ? <br> z = ? <br></code> <br>  En passant par l'unification, nous examinons deux termes avec ces informations à l'esprit et mettons à jour l'état ou terminons la recherche si deux termes ne peuvent pas être unifiés.  Par exemple, en complétant l'unification b = c, nous obtenons de nouvelles informations: x = 10, y = z.  Mais l'unification b = Nil provoquera une contradiction. <br><br>  Nous recherchons les conjoints de manière séquentielle (afin que les informations s'accumulent), et dans une disjonction, nous divisons la recherche en deux branches parallèles et continuons, en alternant les étapes en elles - c'est ce que l'on appelle la recherche entrelacée.  Grâce à cette alternance, la recherche est terminée - chaque solution appropriée sera trouvée après un temps limité.  Par exemple, dans le langage Prolog, ce n'est pas le cas.  Il fait quelque chose comme une exploration profonde (qui peut s'accrocher à une branche infinie), et la recherche entrelacée est essentiellement une modification de l'analyse large délicate. <br><br>  Voyons maintenant comment fonctionne la première requête de la section précédente.  Puisque appendo a des appels récursifs, nous ajouterons des index aux variables pour les distinguer.  La figure ci-dessous montre l'arbre d'énumération.  Les flèches indiquent le sens de diffusion de l'information (à l'exception du retour de récursivité).  Entre les disjonctions, l'information n'est pas distribuée, et entre les conjonctions est distribuée de gauche à droite. <br><br><img src="https://habrastorage.org/webt/3j/np/fg/3jnpfgkkgbyyf5-or5g_noicxg4.png"><br><br><ol><li>  Nous commençons par un appel externe à appendo.  La branche gauche de la disjonction décède en raison d'une controverse: liste <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.455ex" viewBox="0 -520.7 529.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-61" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un</font></font></mi></math></span></span><script type="math/tex" id="MathJax-Element-14"> a </script>  pas vide. <br></li><li>  Dans la branche de droite, des variables auxiliaires sont introduites, qui sont ensuite utilisées pour «analyser» la liste <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mn>1</mn></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.284ex" height="1.696ex" viewBox="0 -520.7 983.4 730.2" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMAIN-31" x="748" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un</font></font></mi><mn><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-15"> a_1 </script>  sur la tête et la queue. <br></li><li>  Après cela, l'appel récursif appendo se produit pour a = [2], b = [3, 4], ab = ?, dans lequel des opérations similaires se produisent. <br></li><li>  Mais dans le troisième appel à appendo, nous avons déjà a = [], b = [3,4], ab =?, Puis la disjonction gauche fonctionne, après quoi nous obtenons les informations ab = b.  Mais dans la bonne branche, il y a une contradiction. <br></li><li>  Nous pouvons maintenant écrire toutes les informations disponibles et restaurer la réponse en substituant les valeurs des variables: <br><br> <code>a_1 = [1, 2] <br> b_1 = [3, 4] <br> ab_1 = Cons h_1 tb_1 <br> h_1 = 1 <br> a_2 = t_1 = [2] <br> b_2 = b_1 = [3, 4] <br> ab_2 = tb_1 = Cons h_2 tb_2 <br> h_2 = 2 <br> a_3 = t_2 = Nil <br> b_3 = b_2 = b_1 = [3, 4] <br> ab_3 = tb_2 = b_3 = [3, 4] <br></code> <br></li><li>  Il s'ensuit que <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><msub><mi>b</mi><mn>1</mn></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.282ex" height="2.298ex" viewBox="0 -780.1 1412.9 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMAIN-31" x="607" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un</font></font></mi><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></mi><mn><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-16"> ab_1 </script>  = Contre (1, Contre (2, [3, 4])) = [1, 2, 3, 4], selon les besoins. <br></li></ol><br><br><h2>  Ce que j'ai fait au premier cycle </h2><br><h3>  Tout ralentit </h3><br>  Comme toujours: ils vous promettent que tout sera super déclaratif, mais en réalité, vous devez vous adapter à la langue et tout écrire de manière spéciale (en gardant à l'esprit comment tout sera exécuté) afin qu'au moins quelque chose fonctionne, à l'exception des exemples les plus simples.  C'est décevant. <br><br>  L'un des premiers problèmes auxquels est confronté un programmeur débutant de miniKanren est qu'il dépend beaucoup de l'ordre dans lequel vous décrivez les conditions (conjoints) dans le programme.  Avec une seule commande, tout va bien, mais deux conjonctions ont été échangées et tout a commencé à fonctionner très lentement ou n'a pas fini du tout.  C'est inattendu. <br><br>  Même dans l'exemple avec appendo, le lancement dans la direction opposée (générant la division de la liste en deux) ne se termine pas sauf si vous spécifiez explicitement le nombre de réponses que vous souhaitez (alors la recherche se terminera une fois le nombre requis trouvé). <br><br>  Supposons que nous fixions les variables d'origine comme suit: a = ?, B = ?, Ab = [1, 2, 3] (voir la figure ci-dessous) Dans la deuxième branche, ces informations ne seront en aucun cas utilisées lors d'un appel récursif (la variable ab et les restrictions sur <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mn>1</mn></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.393ex" height="2.298ex" viewBox="0 -780.1 1030.4 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-68" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMAIN-31" x="815" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></mi><mn><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-17"> h_1 </script>  et <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><msub><mi>b</mi><mn>1</mn></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.891ex" height="2.298ex" viewBox="0 -780.1 1244.9 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-74" x="0" y="0"></use><g transform="translate(361,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMAIN-31" x="607" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></mi><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></mi><mn><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-18"> tb_1 </script>  n'apparaissent qu'après cet appel).  Par conséquent, au premier appel récursif, tous ses arguments seront des variables libres.  Cet appel générera toutes sortes de triplets à partir de deux listes et de leur concaténation (et cette génération ne se terminera jamais), puis parmi eux seront choisis ceux pour lesquels le troisième élément s'est avéré exactement la façon dont nous avons besoin. <br><br><img src="https://habrastorage.org/webt/pg/gn/jg/pggnjghrld84iyiybo9au0nyilk.png"><br><br>  Tout n'est pas aussi mauvais que cela puisse paraître à première vue, car nous allons trier ces triplets en grands groupes.  Les listes avec la même longueur mais des éléments différents ne diffèrent pas du point de vue de la fonction, donc elles tomberont dans une solution - il y aura des variables libres à la place des éléments.  Néanmoins, nous allons toujours trier toutes les longueurs de liste possibles, bien que nous n'en ayons besoin que d'une seule, et nous savons laquelle.  Il s'agit d'une utilisation très irrationnelle (non-utilisation) des informations dans la recherche. <br><br>  Cet exemple spécifique est facile à corriger: il vous suffit de déplacer l'appel récursif à la fin et tout fonctionnera comme il se doit.  Avant l'appel récursif, l'unification avec la variable ab aura lieu et l'appel récursif sera effectué à partir de la fin de la liste donnée (comme une fonction récursive normale).  Cette définition avec un appel récursif à la fin fonctionnera bien dans toutes les directions: à l'appel récursif, nous parvenons à accumuler toutes les informations possibles sur les arguments. <br><br>  Cependant, dans tout exemple légèrement plus complexe, lorsqu'il y a plusieurs appels significatifs, un ordre spécifique pour lequel tout ira bien n'existe pas.  L'exemple le plus simple: développer une liste en utilisant la concaténation.  Nous corrigeons le premier argument - nous avons besoin de cet ordre particulier, nous corrigeons le second - nous devons échanger les appels.  Sinon, la recherche est longue et la recherche ne s'arrête pas. <br><br><pre> <code class="plaintext hljs">reverso x xr = (x === Nil &amp;&amp;&amp; xr == Nil) ||| (fresh (ht tr) (x === Cons (h, t)) (reverso t tr) (appendo tr (Cons (h, Nil)) xr))</code> </pre><br>  En effet, l'entrelacement des processus de recherche se conjugue de manière séquentielle, et personne ne pouvait penser à comment le faire différemment sans perdre une efficacité acceptable, bien qu'ils aient essayé.  Bien sûr, toutes les solutions seront un jour trouvées, mais avec le mauvais ordre, elles seront recherchées de manière si irréaliste qu'il n'y a aucun sens pratique à cela. <br><br>  Il existe des techniques pour écrire des programmes pour éviter ce problème.  Mais beaucoup d'entre eux nécessitent des compétences et une imagination particulières pour être utilisés, et le résultat est de très gros programmes.  Un exemple est le terme technique de délimitation de taille et la définition de la division binaire avec le reste par multiplication avec son aide.  Au lieu d'écrire bêtement une définition mathématique <br><br><pre> <code class="plaintext hljs">divo nmqr = (fresh (mq) (multo mq mq) (pluso mq rn) (lto rm))</code> </pre><br>  Je dois écrire une définition récursive de 20 lignes + une grande fonction auxiliaire qui n'est pas réaliste à lire (je ne comprends toujours pas ce qui se fait là-bas).  Il peut être trouvé dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dissertation de</a> Will Bird dans la section Pure Binary Arithmetic. <br><br>  Compte tenu de ce qui précède, je voudrais proposer une sorte de modification de la recherche afin que des programmes simples et écrits naturellement fonctionnent également. <br><br><h3>  Optimiser </h3><br>  Nous avons remarqué que lorsque tout va mal, la recherche ne se terminera que si vous indiquez explicitement le nombre de réponses et le cassez.  Par conséquent, ils ont décidé de lutter précisément contre le caractère incomplet de la recherche - il est beaucoup plus facile à concrétiser que «ça marche depuis longtemps».  En général, bien sûr, je veux juste accélérer la recherche, mais c'est beaucoup plus difficile à formaliser, alors nous avons commencé avec une tâche moins ambitieuse. <br><br>  Dans la plupart des cas, lorsque la recherche diverge, une situation se produit qui est facile à suivre.  Si une fonction est appelée récursivement, et dans un appel récursif, les arguments sont identiques ou moins spécifiques, puis dans l'appel récursif une autre de ces sous-tâches est à nouveau générée et une récursion infinie se produit.  Formellement, cela ressemble à ceci: il y a une substitution, en appliquant laquelle aux nouveaux arguments, nous obtenons les anciens.  Par exemple, dans la figure ci-dessous, un appel récursif est une généralisation de l'original: vous pouvez remplacer <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>c</mi><mn>2</mn></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.061ex" height="1.696ex" viewBox="0 -520.7 887.4 730.2" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMAIN-32" x="613" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></mi><mn><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-19"> c_2 </script>  = [x, 3], <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>d</mi><mn>2</mn></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.263ex" height="2.298ex" viewBox="0 -780.1 974.4 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/hsespb/blog/441114/&amp;usg=ALkJrhgnkxj88EcT0n9IjXy4ugWkhLaVKQ#MJMAIN-32" x="736" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></mi><mn><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-20"> d_2 </script>  = x et obtenez l'appel d'origine. <br><br><img src="https://habrastorage.org/webt/kh/22/mk/kh22mkjyiwzn3as3manr6jftdrm.png"><br><br>  On peut constater que cette situation se produit également dans les exemples de divergence que nous avons déjà rencontrés.  Comme je l'ai écrit plus tôt, lorsque vous exécutez appendo dans la direction opposée, un appel récursif sera effectué avec des variables libres au lieu de toutes les variables, ce qui, bien sûr, est moins spécifique que l'appel d'origine, dans lequel le troisième argument a été fixé. <br><br>  Si nous exécutons reverso avec x =?  et xr = [1, 2, 3], on peut voir que le premier appel récursif se produira à nouveau avec deux variables libres, donc de nouveaux arguments peuvent de nouveau être évidemment transférés aux précédents. <br><br><pre> <code class="plaintext hljs">reverso x x_r  (* x = ?, x_r = [1, 2, 3] *) fresh (ht t_r) (x === Cons (h, t)) (* x_r = [1, 2, 3] = Cons 1 (Cons 2 (Cons 3 Nil))) x = Cons (h, t) *) (reverso t t_r) (* :   t=x, t_r=[1,2,3],    *)</code> </pre><br>  En utilisant ce critère, nous pouvons détecter une divergence dans le processus d'exécution du programme, comprendre que tout va mal avec cet ordre et le changer dynamiquement en un autre.  Grâce à cela, idéalement, la bonne commande sera sélectionnée pour chaque appel. <br>  Vous pouvez le faire naïvement: si une divergence est trouvée dans le conjonctif, alors nous martelons toutes les réponses qu'il a déjà trouvées et reportons son exécution pour plus tard, «sautant en avant» le prochain conjonctif.  Ensuite, peut-être, lorsque nous continuerons à l'exécuter, plus d'informations seront déjà connues et aucune divergence ne se produira.  Dans nos exemples, cela conduira aux conjonctions de swap souhaitées. <br><br>  Il existe des moyens moins naïfs qui permettent, par exemple, de ne pas perdre le travail déjà fait, de reporter la performance.  Déjà avec la variante la plus stupide de changer l'ordre, la divergence a disparu dans tous les exemples simples souffrant de la non-commutativité de la conjonction, que nous connaissons, notamment: <br><br><ul><li>  trier la liste des nombres (c'est aussi la génération de toutes les permutations de la liste), <br></li><li>  Arithmétique peano et arithmétique binaire, <br></li><li>  génération d'arbres binaires d'une taille donnée. <br></li></ul><br>  Ce fut une surprise inattendue pour nous.  En plus de la divergence, l'optimisation lutte également contre les ralentissements de programme.  Les diagrammes ci-dessous montrent le temps d'exécution de programmes avec deux ordres différents en conjonction (relativement parlant, l'un des meilleurs et l'un des nombreux mauvais).  Il a été lancé sur un ordinateur avec la configuration du processeur Intel Core i7 M 620, 2,67 GHz x 4, 8 Go de RAM avec le système d'exploitation Ubuntu 16.04. <br><br>  Lorsque l' <b>ordre est déjà optimal</b> (nous le sélectionnons à la main), l'optimisation ralentit un peu l'exécution, mais pas critique <br><img src="https://habrastorage.org/webt/3a/si/4z/3asi4zevbggj_7hmjk6j2lilk0u.png"><br><br>  Mais lorsque la <b>commande n'est pas optimale</b> (par exemple, ne convient que pour un lancement dans la direction opposée), avec l'optimisation, cela se révèle beaucoup plus rapide.  Les croix signifient que nous ne pouvions tout simplement pas attendre la fin, cela fonctionne beaucoup plus longtemps <br><img src="https://habrastorage.org/webt/yw/-_/sn/yw-_snesnrnadqet8zmgbbpk3la.png"><br><br><h3>  Comment ne rien casser </h3><br>  Tout cela était basé uniquement sur l'intuition et nous voulions le prouver strictement.  Théorie après tout. <br><br>  Pour prouver quelque chose, nous avons besoin d'une sémantique formelle du langage.  Nous avons décrit la sémantique opérationnelle pour miniKanren.  Il s'agit d'une version simplifiée et mathématique d'une implémentation de langage réel.  Il utilise une version très limitée (donc facile à utiliser), dans laquelle vous ne pouvez spécifier que l'exécution finale des programmes (la recherche doit être finale).  Mais pour nos besoins, c'est exactement ce dont nous avons besoin. <br><br>  Pour prouver le critère, le lemme est d'abord formulé: l'exécution du programme à partir d'un état plus général fonctionnera plus longtemps.  Formellement: l'arborescence de sortie en sémantique a une grande hauteur.  Cela est prouvé par induction, mais l'énoncé doit être très soigneusement généralisé, sinon l'hypothèse inductive ne sera pas assez forte.  Il résulte de ce lemme que si un critère a fonctionné pendant l'exécution du programme, alors l'arbre de sortie a son propre sous-arbre de hauteur supérieure ou égale.  Cela donne une contradiction, car pour une sémantique inductive, tous les arbres sont finis.  Cela signifie que dans notre sémantique, l'exécution de ce programme est inexprimable, ce qui implique que sa recherche ne se termine pas. <br><br>  La méthode proposée est conservatrice: nous ne changeons quelque chose que lorsque nous sommes convaincus que tout est déjà complètement mauvais et impossible de faire pire, donc nous ne cassons rien en termes d'achèvement du programme. <br><br>  La preuve principale contient beaucoup de détails, nous avons donc voulu la vérifier formellement en écrivant à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Coq</a> .  Cependant, cela s'est avéré assez difficile techniquement, nous avons donc calmé notre ardeur et nous nous sommes sérieusement engagés dans la vérification automatique uniquement dans la magistrature. <br><br><h3>  Publication </h3><br>  Au milieu du travail, nous avons présenté cette étude lors de la session d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">affiches</a> de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ICFP-2017 au Concours de recherche des étudiants</a> .  Nous y avons rencontré les créateurs de la langue - Will Bird et Daniel Friedman - et ils ont dit qu'elle était significative et que nous devions la regarder plus en détail.  Soit dit en passant, Will est généralement ami avec notre laboratoire de JetBrains Research.  Toutes nos recherches sur miniKanren ont commencé quand, en 2015, Will a organisé une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">école d'été</a> en programmation relationnelle à Saint-Pétersbourg. <br><br>  Un an plus tard, nous avons amené notre travail sous une forme plus ou moins complète et présenté l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> aux Principes et pratiques de la programmation déclarative 2018. <br><br><h2>  Que dois-je faire à l'école d'études supérieures </h2><br>  Nous voulions continuer à nous engager dans une sémantique formelle pour miniKanren et une preuve rigoureuse de toutes ses propriétés.  Dans la littérature, les propriétés (souvent loin d'être évidentes) sont simplement postulées et démontrées à l'aide d'exemples, mais personne ne prouve rien.  Par exemple, le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">livre principal</a> sur la programmation relationnelle est une liste de questions et réponses, chacune étant consacrée à un morceau de code spécifique.  Même pour la déclaration d'intégralité de la recherche entrelacée (et c'est l'un des avantages les plus importants de miniKanren par rapport au Prolog standard), il est impossible de trouver une formulation stricte.  Vous ne pouvez pas vivre comme ça, nous avons décidé, et, après avoir reçu une bénédiction de Will, nous nous sommes mis au travail. <br><br>  Permettez-moi de vous rappeler que la sémantique que nous avons développée à l'étape précédente avait une limitation importante: seuls les programmes à recherche finie ont été décrits.  Dans miniKanren, les programmes en cours d'exécution sont également intéressants car ils peuvent répertorier un nombre infini de réponses.  Par conséquent, nous avions besoin d'une sémantique plus cool. <br><br>  Il existe de nombreuses façons standard de définir la sémantique d'un langage de programmation, nous n'avons eu qu'à en choisir une et à l'adapter à un cas spécifique.  Nous avons décrit la sémantique comme un système de transition étiqueté - un ensemble d'états possibles dans le processus de recherche et les transitions entre ces états, dont certains sont marqués, ce qui signifie qu'à ce stade de la recherche, une autre réponse a été trouvée.  L'exécution d'un programme particulier est ainsi déterminée par la séquence de ces transitions.  Ces séquences peuvent être finies (arriver à un état terminal) ou infinies, décrivant simultanément la fin et la fin de programmes.  Afin de spécifier complètement un tel objet mathématiquement, il faut utiliser une définition coinductive. <br><br>     <b></b> —     .      <b></b> ,            (,          ,  —     ..).          ,   miniKanren'      (   ). <br><br>      ,    ,        —        .    .  (  ),       ,       . <br>            (    ):        , ,        ,      . <br><br>           , ,  /     . <br><br>             Coq'a.        ,             ,      «. Qed».      . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr441114/">https://habr.com/ru/post/fr441114/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr441098/index.html">Profondeurs SIEM: corrélations prêtes à l'emploi. Partie 4. Modèle de système comme contexte de règles de corrélation</a></li>
<li><a href="../fr441102/index.html">Kaspersky Mobile Talks - une réunion pour les développeurs avancés</a></li>
<li><a href="../fr441104/index.html">Obtention d'informations et contournement de l'authentification à deux facteurs sur les cartes bancaires du TOP-10 (Ukraine)</a></li>
<li><a href="../fr441108/index.html">Déjà pas un concept: Samsung a présenté le téléphone pliable Galaxy Fold pour 1980 $</a></li>
<li><a href="../fr441112/index.html">Nous attachons l'autorisation LDAP à Kubernetes</a></li>
<li><a href="../fr441116/index.html">KubeSail et son cluster Kubernetes gratuit pour les développeurs</a></li>
<li><a href="../fr441118/index.html">Les résultats de l'expérience d'une semaine de travail de quatre jours pour les employés de bureau en Nouvelle-Zélande</a></li>
<li><a href="../fr441122/index.html">Magento 2 EAV: Présentation des structures de données</a></li>
<li><a href="../fr441124/index.html">Faux positifs dans PVS-Studio: la profondeur du trou du lapin</a></li>
<li><a href="../fr441126/index.html">Faux positifs dans PVS-Studio: à quelle profondeur le trou du lapin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>