<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¿â€âš–ï¸ ğŸ‘¨ğŸ½â€âš–ï¸ ğŸ§’ğŸ¾ è®©æˆ‘ä»¬åœ¨Goä¸Šå¤„ç†å£°éŸ³ ğŸˆ³ ğŸ”µ ğŸ‘‰ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å…è´£å£°æ˜ï¼šæˆ‘ä¸è€ƒè™‘ç”¨äºå£°éŸ³å’Œè¯­éŸ³è¯†åˆ«çš„ä»»ä½•ç®—æ³•å’ŒAPIã€‚ æœ¬æ–‡ä»‹ç»éŸ³é¢‘é—®é¢˜ä»¥åŠå¦‚ä½•ä½¿ç”¨Goè§£å†³é—®é¢˜ã€‚ 




 phonoæ˜¯ç”¨äºå¤„ç†å£°éŸ³çš„åº”ç”¨ç¨‹åºæ¡†æ¶ã€‚ å®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨å„ç§æŠ€æœ¯æ¥åˆ¶é€ è¾“é€æœºï¼Œä»¥å¤„ç†å£°éŸ³  ä¸ºä½   ä»¥æ‚¨éœ€è¦çš„æ–¹å¼ã€‚ 


 é™¤äº†é‡‡ç”¨ä¸åŒçš„æŠ€æœ¯å¤–ï¼Œè¾“é€æœºè¿˜éœ€è¦åšä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>è®©æˆ‘ä»¬åœ¨Goä¸Šå¤„ç†å£°éŸ³</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424623/"><blockquote> å…è´£å£°æ˜ï¼šæˆ‘ä¸è€ƒè™‘ç”¨äºå£°éŸ³å’Œè¯­éŸ³è¯†åˆ«çš„ä»»ä½•ç®—æ³•å’ŒAPIã€‚ æœ¬æ–‡ä»‹ç»éŸ³é¢‘é—®é¢˜ä»¥åŠå¦‚ä½•ä½¿ç”¨Goè§£å†³é—®é¢˜ã€‚ </blockquote><p><img src="https://habrastorage.org/webt/gg/cf/7i/ggcf7ihwchhcfrbsnrwdpohwczg.png" alt="åœ°é¼ "></p><br><p> <code>phono</code>æ˜¯ç”¨äºå¤„ç†å£°éŸ³çš„åº”ç”¨ç¨‹åºæ¡†æ¶ã€‚ å®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨å„ç§æŠ€æœ¯æ¥åˆ¶é€ è¾“é€æœºï¼Œä»¥å¤„ç†å£°éŸ³ <del> ä¸ºä½  </del> ä»¥æ‚¨éœ€è¦çš„æ–¹å¼ã€‚ </p><br><p> é™¤äº†é‡‡ç”¨ä¸åŒçš„æŠ€æœ¯å¤–ï¼Œè¾“é€æœºè¿˜éœ€è¦åšä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨å…¶ä»–æ¡†æ¶ï¼Ÿ ç°åœ¨è®©æˆ‘ä»¬å¼„æ¸…æ¥šã€‚ </p><a name="habracut"></a><br><h2 id="otkuda-zvuk"> å£°éŸ³ä»å“ªé‡Œæ¥ï¼Ÿ </h2><br><p> åˆ°2018å¹´ï¼Œå£°éŸ³å·²æˆä¸ºäººç±»ä¸æŠ€æœ¯äº’åŠ¨çš„æ ‡å‡†æ–¹å¼ã€‚ å¤§å¤šæ•°ITå·¨å¤´<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å·²ç»åˆ›å»º</a>äº†è‡ªå·±çš„è¯­éŸ³åŠ©æ‰‹ï¼Œæˆ–è€…ç°åœ¨æ­£åœ¨è¿™æ ·åšã€‚ è¯­éŸ³æ§åˆ¶å·²ç»åœ¨å¤§å¤šæ•°æ“ä½œç³»ç»Ÿä¸Šï¼Œå¹¶ä¸”è¯­éŸ³æ¶ˆæ¯ä¼ é€’æ˜¯ä»»ä½•Messengerçš„å…¸å‹åŠŸèƒ½ã€‚ åœ¨ä¸–ç•Œä¸Šï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¤§çº¦ä¸€åƒå®¶</a>åˆåˆ›å…¬å¸æ­£åœ¨ä»äº‹è‡ªç„¶è¯­è¨€å¤„ç†ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çº¦æœ‰200å®¶æ­£åœ¨</a>ä»äº‹è¯­éŸ³è¯†åˆ«ã€‚ </p><br><p> ä¸éŸ³ä¹ç±»ä¼¼çš„æ•…äº‹ã€‚ å®ƒå¯ä»¥åœ¨ä»»ä½•è®¾å¤‡ä¸Šæ’­æ”¾ï¼Œå¹¶ä¸”å½•éŸ³å¯¹æ‰€æœ‰æ‹¥æœ‰è®¡ç®—æœºçš„äººéƒ½å¯ç”¨ã€‚ éŸ³ä¹è½¯ä»¶æ˜¯ç”±<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å…¨çƒæ•°ç™¾å®¶å…¬å¸</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å’Œæ•°åƒåçˆ±å¥½è€…å¼€å‘</a>çš„ã€‚ </p><br><h2 id="a-nametasksa-obschie-zadachi"> å¸¸è§ä»»åŠ¡ </h2><br><p> å¦‚æœæ‚¨å¿…é¡»å¤„ç†å£°éŸ³ï¼Œé‚£ä¹ˆä»¥ä¸‹æ¡ä»¶å¬èµ·æ¥åº”è¯¥å¾ˆç†Ÿæ‚‰ï¼š </p><br><ul><li> å¿…é¡»ä»æ–‡ä»¶ï¼Œè®¾å¤‡ï¼Œç½‘ç»œç­‰<strong>è·å¾—</strong>éŸ³é¢‘ã€‚ </li><li> å¿…é¡»<strong>å¤„ç†</strong>éŸ³é¢‘ï¼šæ·»åŠ æ•ˆæœï¼Œè½¬ç ï¼Œåˆ†æç­‰ã€‚ </li><li> éŸ³é¢‘å¿…é¡»<strong>ä¼ è¾“</strong>åˆ°æ–‡ä»¶ï¼Œè®¾å¤‡ï¼Œç½‘ç»œç­‰ã€‚ </li><li> æ•°æ®åœ¨å°ç¼“å†²åŒºä¸­ä¼ è¾“ã€‚ </li></ul><br><p> äº‹å®è¯æ˜ï¼Œè¿™æ˜¯ä¸€æ¡å¸¸è§„çš„ç®¡é“-æ•°æ®æµç»è¿‡å¤šä¸ªå¤„ç†é˜¶æ®µã€‚ </p><br><h2 id="resheniya"> è§£å†³æ–¹æ¡ˆ </h2><br><p> ä¸ºäº†æ¸…æ¥šèµ·è§ï¼Œè®©æˆ‘ä»¬ä»ç°å®ç”Ÿæ´»ä¸­å®Œæˆä¸€é¡¹ä»»åŠ¡ã€‚ ä¾‹å¦‚ï¼Œæ‚¨éœ€è¦å°†è¯­éŸ³è½¬æ¢ä¸ºæ–‡æœ¬ï¼š </p><br><ul><li> æˆ‘ä»¬ä»è®¾å¤‡å½•åˆ¶éŸ³é¢‘ </li><li> æ¶ˆé™¤å™ªéŸ³ </li><li> å‡è¡¡ </li><li> å°†ä¿¡å·ä¼ é€’åˆ°è¯­éŸ³è¯†åˆ«API </li></ul><br><p> åƒå…¶ä»–ä»»ä½•ä»»åŠ¡ä¸€æ ·ï¼Œæ­¤ä»»åŠ¡æœ‰å¤šç§è§£å†³æ–¹æ¡ˆã€‚ </p><br><h3 id="v-lob"> é¢å¤´ </h3><br><p> ä»…é“æ† <del> éª‘å•è½¦çš„äºº </del> ç¨‹åºå‘˜ã€‚ æˆ‘ä»¬ç›´æ¥é€šè¿‡å£°å¡é©±åŠ¨ç¨‹åºå½•åˆ¶å£°éŸ³ï¼Œç¼–å†™æ™ºèƒ½é™å™ªå’Œå¤šé¢‘æ®µå‡è¡¡å™¨ã€‚ è¿™éå¸¸æœ‰è¶£ï¼Œä½†æ˜¯æ‚¨å¯èƒ½ä¼šå¿˜è®°å‡ ä¸ªæœˆçš„åŸå§‹ä»»åŠ¡ã€‚ </p><br><p> å¾ˆé•¿å¾ˆå›°éš¾ã€‚ </p><br><h3 id="po-normalnomu"> æ­£å¸¸çš„ </h3><br><p> ä¸€ç§æ›¿ä»£æ–¹æ³•æ˜¯ä½¿ç”¨ç°æœ‰çš„APIã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ASIOï¼ŒCoreAudioï¼ŒPortAudioï¼ŒALSAç­‰å½•åˆ¶éŸ³é¢‘ã€‚ è¿˜æœ‰å¤šç§ç±»å‹çš„æ’ä»¶éœ€è¦å¤„ç†ï¼šAAXï¼ŒVST2ï¼ŒVST3ï¼ŒAUã€‚ </p><br><p> å¤šç§é€‰æ‹©å¹¶ä¸æ„å‘³ç€æ‚¨å¯ä»¥ä¸€æ¬¡ä½¿ç”¨æ‰€æœ‰å†…å®¹ã€‚ é€šå¸¸ï¼Œä»¥ä¸‹é™åˆ¶é€‚ç”¨ï¼š </p><br><ol><li> ä½œä¸šç³»ç»Ÿ å¹¶éæ‰€æœ‰APIåœ¨æ‰€æœ‰æ“ä½œç³»ç»Ÿä¸Šéƒ½å¯ç”¨ã€‚ ä¾‹å¦‚ï¼ŒAUæ˜¯æœ¬æœºOS XæŠ€æœ¯ï¼Œä»…åœ¨æ­¤å¯ç”¨ã€‚ </li><li> ç¨‹å¼è¯­è¨€ å¤§å¤šæ•°éŸ³é¢‘åº“éƒ½æ˜¯ç”¨Cæˆ–C ++ç¼–å†™çš„ã€‚  1996å¹´ï¼ŒSteinbergå‘è¡Œäº†ç¬¬ä¸€ä¸ªç‰ˆæœ¬çš„VST SDKï¼Œå®ƒä»ç„¶æ˜¯æœ€å—æ¬¢è¿çš„æ’ä»¶æ ‡å‡†ã€‚  20å¹´åï¼Œä¸å†éœ€è¦ç”¨C / C ++ç¼–å†™ï¼šå¯¹äºVSTï¼ŒJavaï¼ŒPythonï¼ŒCï¼ƒï¼ŒRustä¸­éƒ½æœ‰åŒ…è£…å™¨ï¼Œè¿˜æœ‰è°çŸ¥é“ã€‚ å°½ç®¡è¯­è¨€ä»ç„¶æœ‰å±€é™æ€§ï¼Œä½†ç°åœ¨ç”šè‡³å¯ä»¥åœ¨JavaScriptä¸­å¤„ç†å£°éŸ³ã€‚ </li><li> åŠŸèƒ½æ€§ã€‚ å¦‚æœä»»åŠ¡ç®€å•æ˜äº†ï¼Œåˆ™æ— éœ€ç¼–å†™æ–°çš„åº”ç”¨ç¨‹åºã€‚ ç›¸åŒçš„FFmpegå¯ä»¥åšå¾ˆå¤šäº‹æƒ…ã€‚ </li></ol><br><p> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¤æ‚ç¨‹åº¦å–å†³äºæ‚¨çš„é€‰æ‹©ã€‚ åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œæ‚¨å¿…é¡»å¤„ç†å¤šä¸ªåº“ã€‚ å¦‚æœæ‚¨æ ¹æœ¬ä¸èµ°è¿ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥ä½¿ç”¨å¤æ‚çš„æŠ½è±¡å’Œå®Œå…¨ä¸åŒçš„ç•Œé¢ã€‚ </p><br><h3 id="chto-v-itoge"> ç»“æœå¦‚ä½•ï¼Ÿ </h3><br><p> æ‚¨å¿…é¡»åœ¨<strong>éå¸¸å¤æ‚</strong>å’Œ<strong>å¤æ‚</strong>ä¹‹é—´é€‰æ‹©ï¼š </p><br><ul><li> è¦ä¹ˆå¤„ç†å‡ ä¸ªåº•å±‚APIæ¥ç¼–å†™è‡ªè¡Œè½¦ </li><li> è¦ä¹ˆå¤„ç†å¤šä¸ªAPIï¼Œç„¶åå°è¯•ä¸ä»–ä»¬æˆä¸ºæœ‹å‹ </li></ul><br><p> æ— è®ºé€‰æ‹©å“ªç§æ–¹æ³•ï¼Œä»»åŠ¡å§‹ç»ˆè½åœ¨ä¼ é€å¸¦ä¸Šã€‚ æ‰€ä½¿ç”¨çš„æŠ€æœ¯å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä½†æœ¬è´¨æ˜¯ç›¸åŒçš„ã€‚ é—®é¢˜æ˜¯ï¼Œé™¤äº†è§£å†³å®é™…é—®é¢˜ï¼Œæ‚¨è¿˜å¿…é¡»ç¼–å†™ <del> è‡ªè¡Œè½¦ </del> ä¼ é€å¸¦ã€‚ </p><br><p> ä½†æ˜¯æœ‰ä¸€ä¸ªå‡ºè·¯ã€‚ </p><br><h2 id="phono"> å”±æœº </h2><br><p><img src="https://habrastorage.org/webt/ym/fw/h6/ymfwh6c8hjwgig8hzksgbut2ifm.jpeg" alt="å”±æœº"></p><br><p>  <code>phono</code>åˆ›å»ºæ˜¯ä¸ºäº†è§£å†³å¸¸è§é—®é¢˜-â€œ <strong>æ¥æ”¶ï¼Œå¤„ç†å’Œä¼ è¾“</strong> â€å£°éŸ³ã€‚ ä¸ºæ­¤ï¼Œä»–ä½¿ç”¨ç®¡é“ä½œä¸ºæœ€è‡ªç„¶çš„æŠ½è±¡ã€‚  Go <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®˜æ–¹åšå®¢ä¸Š</a>æœ‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸€ç¯‡æ–‡ç« </a>æè¿°äº†ç®¡é“æ¨¡å¼ã€‚ ç®¡é“çš„ä¸»è¦æ€æƒ³æ˜¯ï¼Œæ•°æ®å¤„ç†æœ‰å¤šä¸ªé˜¶æ®µï¼Œè¿™äº›é˜¶æ®µå½¼æ­¤ç‹¬ç«‹å·¥ä½œå¹¶é€šè¿‡é€šé“äº¤æ¢æ•°æ®ã€‚ æ‚¨éœ€è¦ä»€ä¹ˆã€‚ </p><br><p> ä¸ºä»€ä¹ˆå» </p><br><p> é¦–å…ˆï¼Œå¤§å¤šæ•°éŸ³é¢‘ç¨‹åºå’Œåº“éƒ½æ˜¯ç”¨Cç¼–å†™çš„ï¼Œè€ŒGoé€šå¸¸è¢«ç§°ä¸ºå…¶åç»§ç¨‹åºã€‚ æ­¤å¤–ï¼Œè¿˜æœ‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">cgo</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è®¸å¤š</a>ç°æœ‰éŸ³é¢‘åº“çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ´»é¡µå¤¹</a> ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ã€‚ </p><br><p> å…¶æ¬¡ï¼Œä»¥æˆ‘ä¸ªäººçš„è§‚ç‚¹ï¼ŒGoæ˜¯ä¸€é—¨å¥½è¯­è¨€ã€‚ æˆ‘ä¸ä¼šæ·±å…¥ï¼Œä½†æ˜¯æˆ‘ä¼šæ³¨æ„åˆ°å®ƒçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¤šçº¿ç¨‹</a> ã€‚ é€šé“å’Œgorutinså¤§å¤§ç®€åŒ–äº†è¾“é€æœºçš„å®æ–½ã€‚ </p><br><h3 id="abstrakcii"> æŠ½è±¡åŒ– </h3><br><p>  <code>phono</code>çš„å¿ƒè„æ˜¯<code>pipe.Pipe</code>ç±»å‹ã€‚ å®ç°ç®¡é“çš„æ˜¯ä»–ã€‚ å°±åƒ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åšå®¢ç¤ºä¾‹ä¸­ä¸€æ ·</a> ï¼Œå…±æœ‰ä¸‰ç§ç±»å‹çš„é˜¶æ®µï¼š </p><br><ol><li>  <code>pipe.Pump</code> ï¼ˆè‹±å¼æ³µï¼‰- <strong>æ¥æ”¶</strong>å£°éŸ³ï¼Œä»…è¾“å‡ºé€šé“ </li><li>  <code>pipe.Processor</code> ï¼ˆè‹±è¯­å¤„ç†å™¨ï¼‰-å£°éŸ³<strong>å¤„ç†</strong> ï¼Œè¾“å…¥å’Œè¾“å‡ºé€šé“ </li><li>  <code>pipe.Sink</code> ï¼ˆè‹±è¯­æ°´æ§½ï¼‰-å£°éŸ³<strong>ä¼ è¾“</strong> ï¼Œä»…è¾“å…¥é€šé“ </li></ol><br><p> åœ¨<code>pipe.Pipe</code>å†…éƒ¨<code>pipe.Pipe</code>æ•°æ®åœ¨ç¼“å†²åŒºä¸­ä¼ é€’ã€‚ å»ºç«‹ç®¡é“çš„è§„åˆ™ï¼š </p><br><p><img src="https://habrastorage.org/webt/go/ym/ep/goymepjg4pds_picireejjsshnq.png" alt="pipe_diagram"></p><br><ol><li> ä¸€ç®¡<code>pipe.Pump</code> </li><li>  <code>pipe.Processor</code>ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ”¾ç½® </li><li> ä¸€ä¸ªæˆ–å¤šä¸ª<code>pipe.Sink</code>å¹³è¡Œæ”¾ç½® </li><li> æ‰€æœ‰<code>pipe.Pipe</code>ç»„ä»¶å¿…é¡»å…·æœ‰ç›¸åŒçš„å†…å®¹ï¼š <br><ul><li> ç¼“å†²åŒºå¤§å°ï¼ˆæ¶ˆæ¯ï¼‰ </li><li> é‡‡æ ·ç‡ </li><li> é€šé“æ•° </li></ul></li></ol><br><p> æœ€ä½é…ç½®ä¸ºæ³µå’Œä¸€ä¸ªæ°´æ§½ï¼Œå…¶ä½™ä¸ºå¯é€‰ã€‚ </p><br><p> è®©æˆ‘ä»¬çœ‹å‡ ä¸ªä¾‹å­ã€‚ </p><br><h3 id="prostoy"> ç®€å•çš„ </h3><br><p>  <strong>ä»»åŠ¡ï¼š</strong>æ’­æ”¾wavæ–‡ä»¶ã€‚ </p><br><p> è®©æˆ‘ä»¬<strong>å°†</strong>å…¶è½¬æ¢ä¸ºâ€œ <strong>æ¥æ”¶ï¼Œå¤„ç†ï¼Œè½¬ç§»</strong> â€çš„å½¢å¼ï¼š </p><br><ol><li> ä»WAVæ–‡ä»¶<strong>è·å–</strong>éŸ³é¢‘ </li><li>  <strong>å°†</strong>éŸ³é¢‘<strong>ä¼ è¾“</strong>åˆ°ç«¯å£éŸ³é¢‘è®¾å¤‡ </li></ol><br><p><img src="https://habrastorage.org/webt/qz/5p/qg/qz5pqgxqfydujch359ei8fsp0pg.png"></p><br><p> éŸ³é¢‘è¢«è¯»å–å¹¶ç«‹å³æ’­æ”¾ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">ä»£å·</b> <div class="spoiler_text"><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> example <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"github.com/dudk/phono"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/dudk/phono/pipe"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/dudk/phono/portaudio"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/dudk/phono/wav"</span></span> ) <span class="hljs-comment"><span class="hljs-comment">// Example: // Read .wav file // Play it with portaudio func easy() { wavPath := "_testdata/sample1.wav" bufferSize := phono.BufferSize(512) // wav pump wavPump, err := wav.NewPump( wavPath, bufferSize, ) check(err) // portaudio sink paSink := portaudio.NewSink( bufferSize, wavPump.WavSampleRate(), wavPump.WavNumChannels(), ) // build pipe p := pipe.New( pipe.WithPump(wavPump), pipe.WithSinks(paSink), ) defer p.Close() // run pipe err = p.Do(pipe.Run) check(err) }</span></span></code> </pre> </div></div><br><p> é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºæœªæ¥ç®¡é“çš„å…ƒç´ ï¼š <code>wav.Pump</code>å’Œ<code>portaudio.Sink</code>å¹¶å°†å®ƒä»¬ä¼ é€’ç»™<code>pipe.New</code>æ„é€ å‡½æ•°ã€‚  <code>p.Do(pipe.actionFn) error</code>å‡½æ•°å¯åŠ¨ç®¡é“å¹¶ç­‰å¾…å…¶å®Œæˆã€‚ </p><br><h3 id="slozhnee"> æ›´éš¾ </h3><br><p>  <strong>ä»»åŠ¡ï¼š</strong>å°†wavæ–‡ä»¶æ‹†åˆ†ä¸ºæ ·æœ¬ï¼Œä»æ ·æœ¬ä¸­ç»„æˆæ›²ç›®ï¼Œä¿å­˜ç»“æœå¹¶åŒæ—¶æ’­æ”¾ã€‚ </p><br><p> éŸ³è½¨æ˜¯æ ·æœ¬åºåˆ—ï¼Œæ ·æœ¬æ˜¯ä¸€å°æ®µéŸ³é¢‘ã€‚ è¦å‰ªåˆ‡éŸ³é¢‘ï¼Œå¿…é¡»é¦–å…ˆå°†å…¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ ä¸ºæ­¤ï¼Œè¯·ä½¿ç”¨<code>phono/asset</code>åŒ…ä¸­çš„<code>asset.Asset</code>ç±»å‹ã€‚ æˆ‘ä»¬å°†ä»»åŠ¡åˆ†ä¸ºæ ‡å‡†æ­¥éª¤ï¼š </p><br><ol><li> ä»WAVæ–‡ä»¶<strong>è·å–</strong>éŸ³é¢‘ </li><li>  <strong>å°†</strong>éŸ³é¢‘<strong>ä¼ è¾“</strong>åˆ°å†…å­˜ </li></ol><br><p> ç°åœ¨ï¼Œæˆ‘ä»¬ç”¨æ‰‹åˆ¶ä½œæ ·æœ¬ï¼Œå°†å…¶æ·»åŠ åˆ°è½¨é“ä¸­å¹¶å®Œæˆä»»åŠ¡ï¼š </p><br><ol><li> ä»è½¨é“<strong>è·å–</strong>éŸ³é¢‘ </li><li>  <strong>å°†</strong>éŸ³é¢‘<strong>ä¼ è¾“</strong>åˆ° <br><ul><li>  WAVæ–‡ä»¶ </li><li> ç«¯å£éŸ³é¢‘è®¾å¤‡ </li></ul></li></ol><br><p><img src="https://habrastorage.org/webt/r3/q7/yv/r3q7yvccvkpjxbho7s3iwr2zisc.png" alt="example_normal"></p><br><p> åŒæ ·ï¼Œæ²¡æœ‰å¤„ç†é˜¶æ®µï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªç®¡é“ï¼ </p><br><div class="spoiler">  <b class="spoiler_title">ä»£å·</b> <div class="spoiler_text"><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> example <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"github.com/dudk/phono"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/dudk/phono/asset"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/dudk/phono/pipe"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/dudk/phono/portaudio"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/dudk/phono/track"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/dudk/phono/wav"</span></span> ) <span class="hljs-comment"><span class="hljs-comment">// Example: // Read .wav file // Split it to samples // Put samples to track // Save track into .wav and play it with portaudio func normal() { bufferSize := phono.BufferSize(512) inPath := "_testdata/sample1.wav" outPath := "_testdata/example4_out.wav" // wav pump wavPump, err := wav.NewPump(inPath, bufferSize) check(err) // asset sink asset := &amp;asset.Asset{ SampleRate: wavPump.WavSampleRate(), } // import pipe importAsset := pipe.New( pipe.WithPump(wavPump), pipe.WithSinks(asset), ) defer importAsset.Close() err = importAsset.Do(pipe.Run) check(err) // track pump track := track.New(bufferSize, asset.NumChannels()) // add samples to track track.AddFrame(198450, asset.Frame(0, 44100)) track.AddFrame(66150, asset.Frame(44100, 44100)) track.AddFrame(132300, asset.Frame(0, 44100)) // wav sink wavSink, err := wav.NewSink( outPath, wavPump.WavSampleRate(), wavPump.WavNumChannels(), wavPump.WavBitDepth(), wavPump.WavAudioFormat(), ) // portaudio sink paSink := portaudio.NewSink( bufferSize, wavPump.WavSampleRate(), wavPump.WavNumChannels(), ) // final pipe p := pipe.New( pipe.WithPump(track), pipe.WithSinks(wavSink, paSink), ) err = p.Do(pipe.Run) }</span></span></code> </pre> </div></div><br><p> ä¸å‰é¢çš„ç¤ºä¾‹ç›¸æ¯”ï¼Œæœ‰ä¸¤ä¸ª<code>pipe.Pipe</code> ã€‚ ç¬¬ä¸€ä¸ªå°†æ•°æ®ä¼ è¾“åˆ°å†…å­˜ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥å‰ªåˆ‡æ ·æœ¬ã€‚ ç¬¬äºŒä¸ªåœ¨æœ«å°¾æœ‰ä¸¤ä¸ªæ”¶ä»¶äººï¼š <code>wav.Sink</code>å’Œ<code>portaudio.Sink</code> ã€‚ ä½¿ç”¨æ­¤æ–¹æ¡ˆï¼Œå£°éŸ³å¯ä»¥åŒæ—¶è®°å½•åœ¨wavæ–‡ä»¶ä¸­å¹¶è¿›è¡Œæ’­æ”¾ã€‚ </p><br><h3 id="esche-slozhnee"> æ›´éš¾ </h3><br><p>  <strong>ä»»åŠ¡ï¼š</strong>è¯»å–ä¸¤ä¸ªwavæ–‡ä»¶ï¼Œæ··åˆï¼Œå¤„ç†vst2æ’ä»¶å¹¶ä¿å­˜åˆ°æ–°çš„wavæ–‡ä»¶ã€‚ </p><br><p>  <code>phono/mixer</code> <code>mixer.Mixer</code>æœ‰ä¸€ä¸ªç®€å•çš„<code>mixer.Mixer</code> ã€‚ å®ƒå¯ä»¥ä»å¤šä¸ªæº<strong>ä¼ è¾“</strong>ä¿¡å·å¹¶æ··åˆä¸€ä¸ªã€‚ ä¸ºæ­¤ï¼Œå®ƒåŒæ—¶å®ç°äº†<code>pipe.Pump</code>å’Œ<code>pipe.Sink</code> ã€‚ </p><br><p> åŒæ ·ï¼Œè¯¥ä»»åŠ¡åŒ…å«ä¸¤ä¸ªå­ä»»åŠ¡ã€‚ ç¬¬ä¸€ä¸ªçœ‹èµ·æ¥åƒè¿™æ ·ï¼š </p><br><ol><li>  <strong>è·å–</strong>éŸ³é¢‘WAVæ–‡ä»¶ </li><li>  <strong>å°†</strong>éŸ³é¢‘<strong>ä¼ è¾“</strong>åˆ°è°ƒéŸ³å° </li></ol><br><p> ç¬¬äºŒï¼š </p><br><ol><li> ä»è°ƒéŸ³å°<strong>è·å–</strong>éŸ³é¢‘ã€‚ </li><li>  <strong>å¤„ç†</strong>éŸ³é¢‘æ’ä»¶ </li><li>  <strong>å°†</strong>éŸ³é¢‘<strong>ä¼ è¾“</strong>åˆ°WAVæ–‡ä»¶ </li></ol><br><p><img src="https://habrastorage.org/webt/xw/hj/ad/xwhjadlajgapbhjufym72qjgssq.png" alt="example_hard"></p><br><div class="spoiler">  <b class="spoiler_title">ä»£å·</b> <div class="spoiler_text"><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> example <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"github.com/dudk/phono"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/dudk/phono/mixer"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/dudk/phono/pipe"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/dudk/phono/vst2"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/dudk/phono/wav"</span></span> vst2sdk <span class="hljs-string"><span class="hljs-string">"github.com/dudk/vst2"</span></span> ) <span class="hljs-comment"><span class="hljs-comment">// Example: // Read two .wav files // Mix them // Process with vst2 // Save result into new .wav file // // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">NOTE:</span></span></span><span class="hljs-comment"> For example both wav files have same characteristics ie: sample rate, bit depth and number of channels. // In real life implicit conversion will be needed. func hard() { bs := phono.BufferSize(512) inPath1 := "../_testdata/sample1.wav" inPath2 := "../_testdata/sample2.wav" outPath := "../_testdata/out/example5.wav" // wav pump 1 wavPump1, err := wav.NewPump(inPath1, bs) check(err) // wav pump 2 wavPump2, err := wav.NewPump(inPath2, bs) check(err) // mixer mixer := mixer.New(bs, wavPump1.WavNumChannels()) // track 1 track1 := pipe.New( pipe.WithPump(wavPump1), pipe.WithSinks(mixer), ) defer track1.Close() // track 2 track2 := pipe.New( pipe.WithPump(wavPump2), pipe.WithSinks(mixer), ) defer track2.Close() // vst2 processor vst2path := "../_testdata/Krush.vst" vst2lib, err := vst2sdk.Open(vst2path) check(err) defer vst2lib.Close() vst2plugin, err := vst2lib.Open() check(err) defer vst2plugin.Close() vst2processor := vst2.NewProcessor( vst2plugin, bs, wavPump1.WavSampleRate(), wavPump1.WavNumChannels(), ) // wav sink wavSink, err := wav.NewSink( outPath, wavPump1.WavSampleRate(), wavPump1.WavNumChannels(), wavPump1.WavBitDepth(), wavPump1.WavAudioFormat(), ) check(err) // out pipe out := pipe.New( pipe.WithPump(mixer), pipe.WithProcessors(vst2processor), pipe.WithSinks(wavSink), ) defer out.Close() // run all track1Done, err := track1.Begin(pipe.Run) check(err) track2Done, err := track2.Begin(pipe.Run) check(err) outDone, err := out.Begin(pipe.Run) check(err) // wait results err = track1.Wait(track1Done) check(err) err = track2.Wait(track2Done) check(err) err = out.Wait(outDone) check(err) }</span></span></code> </pre> </div></div><br><p> å·²ç»æœ‰ä¸‰ä¸ª<code>pipe.Pipe</code> ï¼Œå®ƒä»¬éƒ½é€šè¿‡ä¸€ä¸ªæ··åˆå™¨äº’è¿ã€‚ é¦–å…ˆï¼Œä½¿ç”¨<code>p.Begin(pipe.actionFn) (pipe.State, error)</code>å‡½æ•°ã€‚ ä¸<code>p.Do(pipe.actionFn) error</code> ï¼Œå®ƒä¸ä¼šé˜»æ­¢è°ƒç”¨ï¼Œè€Œåªæ˜¯è¿”å›ä¸€ä¸ªçŠ¶æ€ï¼Œç„¶åå¯ä»¥ç­‰å¾…<code>p.Wait(pipe.State) error</code> ã€‚ </p><br><h2 id="chto-dalshe"> æ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆï¼Ÿ </h2><br><p> æˆ‘å¸Œæœ›<code>phono</code>æˆä¸ºæœ€æ–¹ä¾¿çš„åº”ç”¨ç¨‹åºæ¡†æ¶ã€‚ å¦‚æœæ‚¨åœ¨å£°éŸ³æ–¹é¢é‡åˆ°é—®é¢˜ï¼Œåˆ™æ— éœ€äº†è§£å¤æ‚çš„APIï¼Œä¹Ÿæ— éœ€èŠ±æ—¶é—´ç ”ç©¶æ ‡å‡†ã€‚ æ‰€éœ€è¦åšçš„å°±æ˜¯ç”¨åˆé€‚çš„å…ƒä»¶å»ºé€ ä¸€æ¡è¾“é€æœºå¹¶è¿è¡Œå®ƒã€‚ </p><br><p> åŠå¹´æ¥ï¼Œæ‹æ‘„äº†ä»¥ä¸‹åŒ…è£…ï¼š </p><br><ul><li>  <code>phono/wav</code>è¯»å–/å†™å…¥WAVæ–‡ä»¶ </li><li>  <code>phono/vst2</code> -VST2 SDKçš„ç»‘å®šä¸å®Œæ•´ï¼Œè€Œæ‚¨åªèƒ½æ‰“å¼€æ’ä»¶å¹¶è°ƒç”¨å…¶æ–¹æ³•ï¼Œä½†ä¸èƒ½è°ƒç”¨æ‰€æœ‰ç»“æ„ </li><li>  <code>phono/mixer</code> -æ··éŸ³å™¨ï¼Œæ·»åŠ Nä¸ªä¿¡å·ï¼Œæ²¡æœ‰å¹³è¡¡å’ŒéŸ³é‡ </li><li>  <code>phono/asset</code> -ç¼“å†²é‡‡æ · </li><li>  <code>phono/track</code> -é¡ºåºè¯»å–æ ·æœ¬ï¼ˆåˆ†å±‚ä¸å®Œæ•´ï¼‰ </li><li>  <code>phono/portaudio</code>å®éªŒæœŸé—´çš„ä¿¡å·æ’­æ”¾ </li></ul><br><p> é™¤äº†æ­¤åˆ—è¡¨ä»¥å¤–ï¼Œæ–°æƒ³æ³•å’Œæƒ³æ³•çš„ç§¯å‹ä¹Ÿä¸æ–­å¢åŠ ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š </p><br><ul><li> å€’æ•°è®¡æ—¶ </li><li> åŠ¨æ€å˜åŒ–çš„ç®¡é“ </li><li>  HTTPæ³µ/æ°´æ§½ </li><li> å‚æ•°è‡ªåŠ¨åŒ– </li><li> é‡é‡‡æ ·å¤„ç†å™¨ </li><li> æ…æ‹Œæœºå¹³è¡¡å’Œä½“ç§¯ </li><li> å®æ—¶æ³µ </li><li> å¤šè½¨åŒæ­¥æ³µ </li><li> å®Œæ•´çš„vst2 </li></ul><br><p> åœ¨ä»¥ä¸‹æ–‡ç« ä¸­ï¼Œæˆ‘å°†åˆ†æï¼š </p><br><ul><li>  <code>pipe.Pipe</code>ç”Ÿå‘½å‘¨æœŸ-ç”±äºç»“æ„å¤æ‚ï¼Œå…¶çŠ¶æ€ç”±æœ€ç»ˆåŸå­æ§åˆ¶ </li><li> å¦‚ä½•ç¼–å†™ç®¡é“é˜¶æ®µ </li></ul><br><p> è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå› æ­¤ï¼Œæˆ‘å°†æ„Ÿè°¢æ‚¨çš„å¸®åŠ©å’Œå»ºè®®ã€‚ ä¸å®¢æ°” </p><br><h2 id="ssylki"> å‚è€ƒæ–‡çŒ® </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å”±æœº</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¹¶å‘æ¨¡å¼ï¼šç®¡é“å’Œå–æ¶ˆ</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN424623/">https://habr.com/ru/post/zh-CN424623/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN424609/index.html">å¦‚ä½•æ‰©å±•Kubernetes</a></li>
<li><a href="../zh-CN424611/index.html">å¦‚ä½•ä»è‡ªç”±èŒä¸šè€…åˆ›å»ºå‘˜å·¥</a></li>
<li><a href="../zh-CN424613/index.html">ä½“éªŒæ²¡æœ‰Reduceçš„Reduxä½¿ç”¨</a></li>
<li><a href="../zh-CN424615/index.html">æ›²çº¿å‡½æ•°è¾“å‡ºä¸ä»…å¯ä»¥åœ¨Wolfram Mathematicaä¸­å¹³æ»‘é™åˆ¶å‚æ•°ï¼Œä¿¡å·</a></li>
<li><a href="../zh-CN424621/index.html">éç”µå½±è¶…çº§è‹±é›„ã€‚ è°ä»¥åŠå¦‚ä½•ä¿æŠ¤Lakhta Centeræ–½å·¥ç°åœºå…äºç«ç¾ï¼Ÿ</a></li>
<li><a href="../zh-CN424625/index.html">Aeroflot WebæœåŠ¡æºä»£ç æ³„æ¼</a></li>
<li><a href="../zh-CN424627/index.html">æ›´æ”¹æ”¶é“¶æœºã€‚ ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN424629/index.html">åˆåˆ›ä¼ä¸šå¦‚ä½•ä¸æŠ•èµ„è€…äº¤æµæ—¶å¢åŠ æŠ•èµ„æœºä¼šï¼Ÿ</a></li>
<li><a href="../zh-CN424633/index.html">STACKLEAKå¦‚ä½•æé«˜Linuxå†…æ ¸å®‰å…¨æ€§</a></li>
<li><a href="../zh-CN424635/index.html">æ¬¢è¿æ¥åˆ°Sberbank Data Science Journey 2018-æœºå™¨å­¦ä¹ ç®—æ³•ç«èµ›</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>