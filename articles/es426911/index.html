<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>   GreyEnergy: el sucesor de BlackEnergy ataca a las empresas del sector energ茅tico 筹  </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Los especialistas de ESET realizaron un an谩lisis de malware complejo que no se ha estudiado antes, dise帽ado para ataques dirigidos a empresas de infra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>GreyEnergy: el sucesor de BlackEnergy ataca a las empresas del sector energ茅tico</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/426911/">  Los especialistas de ESET realizaron un an谩lisis de malware complejo que no se ha estudiado antes, dise帽ado para ataques dirigidos a empresas de infraestructura cr铆tica en Europa Central y del Este.  El programa, llamado GreyEnergy, tiene un parecido conceptual con BlackEnergy, un malware que se utiliz贸 en ataques contra compa帽铆as energ茅ticas ucranianas en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">diciembre de 2015</a> .  Adem谩s, hay enlaces que indican que los operadores de GreyEnergy trabajaron con el grupo TeleBots detr谩s de una serie de ataques destructivos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dv/d5/8-/dvd58-ginvoshns9sbcaupqnvzy.jpeg"></div><br>  El informe proporciona informaci贸n sobre las actividades del Grupo GreyEnergy en los 煤ltimos a帽os.  Tenga en cuenta que no atribuimos ataques y desarrollo de malware a ning煤n estado.  Seg煤n nuestra terminolog铆a, "ART-group" es un conjunto de indicadores t茅cnicos. <br><a name="habracut"></a><br><h2>  Introduccion </h2><br>  En diciembre de 2015, el grupo BlackEnergy atac贸 el complejo energ茅tico ucraniano utilizando malware de las familias BlackEnergy y KillDisk.  Este fue el 煤ltimo incidente conocido con el software BlackEnergy en condiciones reales.  Despu茅s de este ataque, el grupo se transform贸 en al menos dos subgrupos: TeleBots y GreyEnergy. <br><br>  TeleBots se especializa en ciber-sabotaje mediante ataques inform谩ticos en red (CNA).  El grupo ha contado los ataques destructivos, que incluyen: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">una serie de ataques</a> con la versi贸n actualizada de KillDisk para Windows y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Linux</a> en diciembre de 2016; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Epidemia de NotPetya</a> en junio de 2017, implementada con la ayuda de una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">puerta trasera</a> compleja implementada con la ayuda del software de contabilidad MEDoc; </li><li>  ataque usando el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">codificador BadRabbit</a> en octubre de 2017. </li></ul><br>  Los expertos de ESET han estado monitoreando la actividad del grupo GreyEnergy durante varios a帽os.  El grupo utiliza la familia 煤nica de malware del mismo nombre.  La arquitectura de Malvari se asemeja a la familia BlackEnergy. <br><br>  Adem谩s de las similitudes conceptuales de los programas, hay otros enlaces que indican que los operadores de GreyEnergy trabajan en estrecha colaboraci贸n con el grupo TeleBots.  En particular, en diciembre de 2016, el grupo GreyEnergy lanz贸 un gusano parecido a NotPetya, y una versi贸n m谩s avanzada de este programa apareci贸 en junio de 2017 en un ataque de TeleBots. <br><br>  Vale la pena se帽alar que GreyEnergy y TeleBots tienen objetivos diferentes: GreyEnergy est谩 principalmente interesado en redes industriales propiedad de empresas de infraestructura cr铆tica y, a diferencia de TeleBots, no se limita a objetos en Ucrania. <br><br>  A finales de 2015, notamos por primera vez el malware GreyEnergy dirigido a una compa帽铆a energ茅tica en Polonia.  Sin embargo, GreyEnergy tambi茅n ataca objetivos ucranianos.  El grupo se centra en el sector energ茅tico, la infraestructura de transporte y otras instalaciones de alto rango.  GreyEnergy ha atacado al menos una organizaci贸n objetivo de BlackEnergy.  El 煤ltimo uso de GreyEnergy se registr贸 a mediados de 2018. <br><br>  El programa malicioso GreyEnergy tiene una arquitectura modular; sin embargo, a diferencia de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Industroyer</a> , no vimos ning煤n m贸dulo que pudiera afectar los sistemas de control industrial (ICS).  Sin embargo, los operadores de GreyEnergy desplegaron una v铆bora en el disco al menos una vez para interrumpir los flujos de trabajo y ocultar los rastros de un ciberataque. <br><br>  Uno de los detalles m谩s interesantes encontrados durante nuestra investigaci贸n es que una de las muestras de GreyEnergy se firm贸 con un certificado digital v谩lido.  Lo m谩s probable es que este certificado fue robado de un fabricante taiwan茅s de equipos ICS.  En este sentido, el grupo GreyEnergy sigui贸 los pasos de los autores de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Stuxnet</a> . <br><br><h2>  GreyEnergy: m茅todo de trabajo </h2><br>  Durante las observaciones de la actividad del grupo GreyEnergy, vimos principalmente dos vectores de infecci贸n iniciales.  El primero se refiere a organizaciones con servicios web ubicados en los propios servidores de las v铆ctimas.  Si el servicio web p煤blico se ejecuta en un servidor conectado a la red interna, los atacantes intentar谩n comprometerlo para penetrar en la red.  El segundo vector es el phishing dirigido con archivos adjuntos de correo electr贸nico malicioso. <br><br>  Los documentos maliciosos descargan GreyEnergy mini: una puerta trasera liviana de la primera etapa que no requiere privilegios administrativos.  Despu茅s de que una computadora se ve comprometida con GreyEnergy mini, los atacantes crean un mapa de red y recopilan contrase帽as para obtener derechos de administrador de dominio.  Con estos privilegios, los atacantes pueden controlar toda la red.  El grupo GreyEnergy utiliza herramientas bastante est谩ndar para realizar estas tareas: Nmap y Mimikatz. <br><br>  Despu茅s de una exploraci贸n inicial de la red, los atacantes pueden desplegar una puerta trasera insignia, la principal GreyEnergy.  El software malicioso requiere derechos de administrador, que deben obtenerse antes de la fase de implementaci贸n de GreyEnergy principal.  Seg煤n nuestra investigaci贸n, los operadores de GreyEnergy instalan la puerta trasera principal principalmente en dos tipos de puntos finales: servidores con tiempo de actividad prolongado y estaciones de trabajo utilizadas para administrar entornos ICS. <br><br>  Para enmascarar las comunicaciones con los servidores de C&amp;C, los atacantes pueden instalar software adicional en servidores internos de una red comprometida para que cada servidor act煤e como un proxy.  Tal proxy C &amp; C redirige las solicitudes de los nodos infectados dentro de la red a un servidor C &amp; C externo en Internet.  La "comunicaci贸n" de varias computadoras en red con un servidor interno no parece tan sospechosa como con una externa.  El m茅todo tambi茅n se puede utilizar para administrar malware en diferentes segmentos de una red comprometida.  Se observ贸 un m茅todo similar usando servidores internos como proxy-C &amp; C en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">campa帽a ART de Duqu 2.0</a> . <br><br>  Si la organizaci贸n comprometida tiene servidores web p煤blicos conectados a la red interna, los atacantes pueden implementar puertas traseras de "respaldo" en estos servidores.  Se utilizan para restaurar el acceso a la red en caso de que se descubran y eliminen las puertas traseras principales. <br><br>  Todos los servidores de C&amp;C relacionados con malware de GreyEnergy usan Tor. <br><br><img src="https://habrastorage.org/webt/xx/oq/go/xxoqgo-8cdke9obd1fcazkwa3cq.png"><br>  <i>Figura 1. Un diagrama simplificado de dos escenarios de compromiso de red utilizados por el grupo GreyEnergy</i> <br><br><h2>  Greyenergy mini </h2><br>  GreyEnergy mini es una puerta trasera liviana de la primera etapa, que fue utilizada por los atacantes para evaluar una computadora comprometida y proporcionar una cabeza de puente inicial en la red.  Por lo general, GreyEnergy mini se descargaba utilizando un documento malicioso distribuido en correos electr贸nicos de phishing.  GreyEnergy mini tambi茅n se conoce como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">FELIXROOT</a> . <br><br>  En septiembre de 2017, ESET descubri贸 un documento de Microsoft Word de Ucrania que conten铆a una macro maliciosa.  El documento de cebo imita un formulario interactivo para alentar a la v铆ctima a encender la macro y completarla. <br><br><img src="https://habrastorage.org/webt/fw/vr/33/fwvr33hhjxbw8fufl_c6qpeluoo.png"><br>  <i>Figura 2. Documento de cebo utilizado por GreyEnergy en septiembre de 2017</i> <br><br>  Despu茅s de encender la macro, su c贸digo intenta descargar y ejecutar el archivo binario desde el servidor remoto. <br><br><img src="https://habrastorage.org/webt/lu/xi/c8/luxic8ibbi5mgwhz7rhefr978ak.png"><br>  <i>Figura 3. Macro maliciosa de VBA (comentarios agregados por ESET)</i> <br><br>  Curiosamente, un enlace que conduce a una imagen externa est谩 incrustado en el cuerpo del documento.  Despu茅s de abrir el documento, intenta cargar esta imagen, de esta manera los atacantes se enteran de que el archivo est谩 abierto.  El m茅todo le permite rastrear qu茅 objetivos incluyen una macro maliciosa y cu谩les acaban de abrir un documento. <br><br><img src="https://habrastorage.org/webt/0j/td/ot/0jtdotwwqqa9vzly3-cd92brvsa.png"><br>  <i>Figura 4. Enlace a un dibujo "rastreador" externo en un documento malicioso</i> <br><br>  El ejecutable descargado es un mini cuentagotas GreyEnergy.  El cuentagotas escribe la DLL maliciosa en la carpeta <code>%APPDATA%</code> , utilizando un GUID generado aleatoriamente como nombre.  Adem谩s, el cuentagotas crea un archivo <code>.LNK</code> con un nombre de archivo vac铆o en la carpeta <code></code> en el men煤 Inicio con una entrada que ejecuta <code>rundll32.exe</code> con la ruta a la DLL como argumento de l铆nea de comando.  Este es el m茅todo de mini persistencia GreyEnergy. <br><br>  El DLL vaciado es el m贸dulo principal de GreyEnergy mini;  se disfraza como un archivo leg铆timo relacionado con Microsoft Windows. <br><br><img src="https://habrastorage.org/webt/ly/yu/lg/lyyulg-m5vxpbdbsgqvyssghhww.png"><br>  <i>Figura 5. La mini DLL de puerta trasera GreyEnergy se hace pasar por una DLL de Windows leg铆tima</i> <br><br>  Para evaluar una computadora comprometida, el malware recopila la mayor cantidad de informaci贸n posible y env铆a datos a C&amp;C.  Los datos se recopilan utilizando el lenguaje de consulta WMI (WQL) y las consultas del registro de Windows.  Se recopilan los siguientes datos: <br><br><ul><li>  nombre de la computadora </li><li>  versi贸n del sistema operativo, incluida la versi贸n del paquete de servicio </li><li>  idioma predeterminado </li><li>  nombre de usuario </li><li>  privilegios de usuario actuales de Windows, elevaci贸n, nivel UAC </li><li>  configuraci贸n de proxy </li><li>  informaci贸n de la computadora (fabricante, modelo, tipo de sistema) </li><li>  zona horaria </li><li>  software de seguridad instalado (antivirus y firewall) </li><li>  lista de usuarios y dominios </li><li>  lista de programas instalados obtenidos del registro </li><li>  informaci贸n de red (direcciones IP, servidor DHCP, etc.) </li><li>  lista de procesos en ejecuci贸n </li></ul><br>  El software malicioso recibe comandos del servidor C&amp;C.  Se proporciona soporte para los siguientes comandos (debajo de la ID del comando y sus significados): <br><br><ol><li>  recopilar informaci贸n de la computadora </li><li>  descargue y ejecute el archivo ejecutable desde la carpeta de archivos temporales </li><li>  ejecutar el comando de shell </li><li>  quitarse de una computadora comprometida </li><li>  descargue y ejecute el archivo .BAT desde la carpeta de archivos temporales </li><li>  descargar el archivo al disco local </li><li>  subir archivo </li></ol><br>  La configuraci贸n de malware en formato JSON est谩 incrustada dentro del archivo binario y encriptada usando un algoritmo personalizado.  Los datos cifrados contienen cuatro bytes al principio;  Estos bytes se utilizan como clave para que la operaci贸n XOR descifre el resto de los datos.  La mayor铆a de las cadenas utilizadas por el malware est谩n encriptadas usando este algoritmo. <br><br><img src="https://habrastorage.org/webt/ra/1e/7q/ra1e7q7lgjkezdzs1cvknhtjytc.png"><br>  <i>Figura 6. Configuraci贸n mini GreyEnergy incorporada antes y despu茅s del descifrado</i> <br><br>  Todas las mini configuraciones de GreyEnergy que vimos incluyen servidores HTTPS y HTTP utilizados como C&amp;C.  Esto permite a los atacantes cambiar a HTTP en destinos donde la conexi贸n HTTPS no es compatible con la configuraci贸n de red o firewall. <br><br>  GreyEnergy mini tiene similitudes en el c贸digo con otros programas maliciosos de la familia GreyEnergy.  Adem谩s de esto, tanto el GreyEnergy mini como la puerta trasera principal de GreyEnergy usan los mismos servidores de C&amp;C. <br><br><h2>  Puerta trasera principal GreyEnergy </h2><br>  GreyEnergy es la puerta trasera principal de este cibergrupo.  Las muestras de malware analizadas aqu铆 est谩n escritas en C y compiladas usando Visual Studio, pero sin usar las funciones est谩ndar de la biblioteca de tiempo de ejecuci贸n C (CRT).  Las muestras empaquetadas pueden contener una marca de tiempo de PE falsa, pero despu茅s de desempacar, la marca de tiempo se restablece (1 de enero de 1970). <br><br><img src="https://habrastorage.org/webt/4g/30/bx/4g30bxseryscxui0m-0z3hrdrzo.png"><br>  <i>Figura 7. Marca de tiempo de PE de la muestra desempaquetada de GreyEnergy</i> <br><br>  Curiosamente, una de las primeras muestras de GreyEnergy analizadas se firm贸 con un certificado propiedad de Advantech.  Esta es una empresa taiwanesa que fabrica equipos para la industria y la IoT.  Como descubrimos que se utiliz贸 el mismo certificado para firmar el software limpio y no malicioso de Advantech, creemos que fue robado.  Tenga en cuenta que la muestra detectada no tiene una firma digital; esto significa que la firma dej贸 de ser v谩lida cuando expir贸 el certificado. <br><br><img src="https://habrastorage.org/webt/y4/qe/i8/y4qei8gt9buk4eftsr5_5bukgiy.png"><br>  <i>Figura 8. Certificado Advantech utilizado para firmar la muestra de malware GreyEnergy</i> <br><br>  Los datos del certificado son los siguientes: <br><br> <code>Serial Number: 15:f4:8f:98:c5:79:41:00:6f:4c:9a:63:9b:f3:c1:cc <br> Validity: <br> Not Before: Feb 10 00:00:00 2014 GMT <br> Not After : Feb 26 23:59:59 2017 GMT <br> SHA1 Fingerprint=97:53:AD:54:DF:6B:D6:73:E0:6C:00:36:3D:34:6A:06:00:7A:0A:9B</code> <br> <br>  Notamos que GreyEnergy generalmente se implementa en dos modos: solo en la memoria y con la persistencia del servicio DLL.  El primer modo se usa cuando los atacantes est谩n seguros de que la instalaci贸n no requiere medidas especiales para garantizar la estabilidad (por ejemplo, en servidores con un tiempo de actividad prolongado);  El segundo modo es cuando el malware debe resistir cualquier reinicio. <br><br><h4>  Modo solo memoria </h4><br>  Para este modo, los atacantes colocan el archivo DLL en una carpeta espec铆fica y luego lo ejecutan usando la aplicaci贸n Windows <code>rundll32.exe</code> .  Observamos que los atacantes utilizan la herramienta PsExec de Windows Sysinternals localmente para ejecutar <code>rundll32.exe</code> con los privilegios m谩s altos posibles ( <code>NT AUTHORITY\SYSTEM</code> ). <br><br>  A continuaci贸n se muestra la l铆nea de comando utilizada en la fase de ejecuci贸n inicial de GreyEnergy solo en la memoria: <br><br> <code>cmd.exe /c "C:\Windows\System32\rundll32.exe "C:\Sun\Thumbs.db",#1 CAIAABBmAAAgAAAA8GFGvkHVGDtGRqcl3Z3nYJ9aXCm7TVZX8klEdjacOSU="</code> <br> <br>  En este ejemplo, <code>Thumbs.db</code> es un archivo DLL de GreyEnergy desde el cual el proceso <code>rundll32.exe</code> llama a la funci贸n con el primer n煤mero de secuencia.  El ejemplo de l铆nea de comando dado contiene una secuencia de bytes cifrados con base64, que posteriormente se utiliza como una clave AES-256 para descifrar un peque帽o c贸digo auxiliar.  Despu茅s de eso, el c贸digo en el "c贸digo auxiliar" inicia una nueva copia del proceso <code>svchost.exe</code> e inyecta la carga 煤til de GreyEnergy.  En la 煤ltima etapa, finaliza el proceso <code>rundll32.exe</code> rundll32.exe, el archivo DLL malicioso est谩 protegido contra la eliminaci贸n del disco.  Por lo tanto, la carga 煤til de GreyEnergy existir谩 solo en el contexto de la memoria de proceso de <code>svchost.exe</code> . <br><br>  Lo m谩s probable es que los autores tuvieran la intenci贸n de desarrollar malware de tal manera que sin una clave en la l铆nea de comando fuera imposible descifrar el "trozo" y la carga 煤til. <br><br><img src="https://habrastorage.org/webt/rb/l5/vt/rbl5vtt2xe-e3ud4p9wxpuhsgz8.png"><br>  <i>Figura 9. Nombre interno de GreyEnergy DLL para el modo de solo memoria</i> <br><br>  Si utiliza el modo "solo en memoria", completar el proceso <code>svchost.exe</code> correspondiente o reiniciar la computadora es suficiente para eliminar GreyEnergy. <br><br><h4>  Persistencia del servicio DLL </h4><br>  Para utilizar este m茅todo, los operadores implementan el cuentagotas de GreyEnergy, que debe ejecutarse con privilegios de administrador. <br><br>  La clave de registro <code>ServiceDLL</code> permite iniciar el m贸dulo DLL de servicio en el contexto del proceso <code>svchost.exe</code> .  Caracter铆stica no documentada por Microsoft;  sin embargo, lo utilizan varias familias de malware, incluido el gusano Conficker. <br><br>  Para garantizar la persistencia del servicio DLL, el cuentagotas busca un servicio existente y agrega una nueva clave de registro <code>ServiceDLL</code> .  Dado que el m茅todo puede conducir a una falla del sistema, el cuentagotas inicialmente realiza una serie de verificaciones para seleccionar un servicio que cumpla con una serie de requisitos. <br><br>  Primero, el cuentagotas encuentra todos los servicios de Windows que actualmente est谩n detenidos al ejecutar la siguiente consulta WQL: <br><br> <code>Select * from Win32_Service where PathName Like '%%svchost%%' and State = 'Stopped'</code> <br> <br>  Se pueden agregar las siguientes condiciones a la solicitud: <br><br><ul><li>  <code>and StartMode = 'Disabled'</code> o <code>and StartMode = 'Manual'</code> </li><li>  <code>and ServiceType = 'Own Process'</code> o <code>and ServiceType = 'Share Process'</code> </li></ul><br>  Luego, el cuentagotas intenta seleccionar el servicio deseado, verificando los resultados y omitiendo aquellos que cumplen con las siguientes condiciones: <br><br><ul><li>  el nombre del servicio contiene <code>winmgmt</code> (Instrumental de administraci贸n de Windows) o <code>BITS</code> (Servicio de transferencia inteligente en <code>BITS</code> plano) </li><li>  el cuentagotas no tiene acceso al servicio o clave de registro </li><li>  <code>DependOnService</code> registro <code>DependOnService</code> no <code>DependOnService</code> vac铆o </li><li>  el valor de registro para <code>ServiceDll</code> o <code>ImagePath</code> no existe </li><li>  La l铆nea de comando de servicio contiene una de las siguientes palabras: </li><li>  <code>DcomLaunch</code> , <code>LocalServiceNetworkRestricted</code> , <code>LocalServiceNoNetwork</code> , <code>LocalServicePeerNet</code> , <code>LocalSystemNetworkRestricted</code> , <code>NetworkServiceNetworkRestricted</code> , <code>secsvcs</code> , <code>wcssvc</code> </li></ul><br>  Al detectar un servicio que cumple con estas condiciones, el programa de malware descarga el archivo DLL en el directorio <code>system32</code> Windows y escribe la clave de registro <code>ServiceDLL</code> .  El nombre de la DLL contiene cuatro caracteres generados aleatoriamente y <code>svc.dll</code> o <code>srv.dll</code> al final.  Adem谩s, el cuentagotas falsifica los metadatos de tiempo del archivo copi谩ndolo del archivo <code>user32.dll</code> existente. <br><br>  La 煤ltima versi贸n del cuentagotas GreyEnergy es compatible con los sistemas operativos de 32 bits y 64 bits. <br><br><img src="https://habrastorage.org/webt/ih/kq/uu/ihkquuwr7ha_ggshsdfwgngg3sw.png"><br>  <i>Figura 10. DLL GreyEnergy DLL implementado a trav茅s del m茅todo de persistencia del servicio DLL</i> <br><br>  Dropper utiliza un m茅todo interesante para disfrazar una DLL maliciosa como un archivo leg铆timo.  En particular, el cuentagotas copia el recurso VERSIONINFO, que contiene una descripci贸n detallada del archivo ejecutable que pertenece al servicio de Windows en cuesti贸n, y escribe estos datos en un archivo DLL malicioso.  Para este prop贸sito, se <code>BeginUpdateResource</code> funciones API de Windows <code>BeginUpdateResource</code> / <code>UpdateResource</code> / <code>EndUpdateResource</code> .  Las versiones recientes no llaman a estas funciones desde la API;  su c贸digo se implementa en el propio programa malicioso para evitar vaciar el archivo DLL en el disco sin un recurso falso de VERSIONINFO.  Presumiblemente, esto evita la detecci贸n de ciertos productos de seguridad.  El mismo cuentagotas puede crear archivos DLL maliciosos con diferentes descripciones en diferentes computadoras.  Cada patr贸n expandido de esta manera tendr谩 un hash 煤nico. <br><br>  Si el malware ya est谩 presente en el sistema, el cuentagotas puede actualizarlo utilizando la canalizaci贸n con nombre. <br><br>  En la 煤ltima etapa, el cuentagotas se elimina autom谩ticamente sobrescribiendo el archivo con ceros y borr谩ndolo del disco.  Dropper tambi茅n borra la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">revista USN</a> .  Las acciones se realizan a trav茅s de los siguientes comandos de shell: <br><br> <code>timeout 2 &gt; nul &amp; fsutil file setzerodata offset=0 length=%DROPPER_FILESIZE% "%DROPPER_PATH%" &amp; timeout 2 &amp; cmd /c del /F /Q "%DROPPER_PATH%" &amp; fsutil usn deletejournal /D %DROPPER_DRIVE%</code> <br> <br><h4>  Configuracion y Comunicaciones </h4><br>  El modo de persistencia seleccionado por los operadores no afecta la funcionalidad del programa malicioso, que permanece sin cambios con ambos m茅todos. <br><br>  El software malicioso contiene una configuraci贸n incrustada que se cifra con el algoritmo AES-256 y se comprime con LZNT1. <br><br>  El formato MIME de m煤ltiples componentes se utiliza para la configuraci贸n de malware incrustado.  Los autores no implementaron su propio analizador para este formato;  en su lugar, usan las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">interfaces IMimeMessage</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">IMimeBody</a> COM.  Curiosamente, la documentaci贸n de Microsoft recomienda no usar estas interfaces. <br><br><img src="https://habrastorage.org/webt/wr/uw/mb/wruwmbzmf4phjtbinjintm9ryfw.png"><br>  <i>Figura 11. Ejemplo de configuraci贸n incorporada de GreyEnergy</i> <br><br>  Para la configuraci贸n externa, se utiliza el formato MIME id茅ntico;  sin embargo, el malware encripta la configuraci贸n externa de varias maneras.  Utiliza la interfaz de programaci贸n de aplicaciones de protecci贸n de datos (DPAPI), en particular, las funciones API de Windows <code>CryptProtectData</code> y <code>CryptUnprotectData</code> .  La configuraci贸n externa se guarda en la siguiente ruta <code>C:\ProgramData\Microsoft\Windows\%GUID%</code> , donde <code>%GUID%</code> es un valor GUID generado aleatoriamente en funci贸n del n煤mero de serie del volumen de la unidad C:. <br><br>  Algunas muestras de GreyEnergy contienen una versi贸n ofuscada de la configuraci贸n.  En particular, los campos <code>Type</code> de tales configuraciones contienen letras en lugar de nombres de opciones. <br><br><img src="https://habrastorage.org/webt/wj/dl/7-/wjdl7-_lpzwki1oifgi_awjctxy.png"><br>  <i>Figura 12. Un ejemplo de una configuraci贸n de GreyEnergy ofuscada</i> <br><br>  La configuraci贸n puede contener los siguientes valores: <br><br><img src="https://habrastorage.org/webt/yo/_s/8e/yo_s8eqfgp-xgxf3mooreev9tmo.png"><br><br>  Un programa malicioso se elimina del sistema infectado si el n煤mero de intentos fallidos excede el valor de <code>MaxAttempts</code> , y la 煤ltima conexi贸n exitosa fue hace m谩s de <code>Lifetime</code> d铆as. <br><br>  La comunicaci贸n con C&amp;C generalmente se realiza a trav茅s de HTTPS;  sin embargo, en algunos casos, tambi茅n se usa HTTP.  El mismo formato MIME est谩 encapsulado en solicitudes HTTP.  Vale la pena se帽alar que los datos se cifran con AES-256 y RSA-2048. <br><br><img src="https://habrastorage.org/webt/b1/g8/6d/b1g86dydvt2stlutlwkgy79ydem.png"><br>  <i>Figura 13. GreyEnergy sobre la comunicaci贸n HTTP capturada en Wireshark</i> <br><br>  Si usa HTTP, es m谩s f谩cil identificar una m谩quina comprometida en la red analizando su tr谩fico de red.  Las muestras de malware que se han estudiado siempre han utilizado los siguientes agentes de usuario codificados: <br><br><ul><li> <code>Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko</code> </li> <li> <code>Mozilla/5.0 (compatible, MSIE 11, Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko</code> </li> </ul><br>  Para ayudar a los operadores de GreyEnergy a identificar las computadoras infectadas, el malware env铆a los resultados de las siguientes consultas WQL al servidor de C&amp;C: <br><br><ul><li> <code>SELECT Caption, Version, CSName, ProductType, CurrentTimeZone, LocalDateTime, OSLanguage, OSType FROM Win32_OperatingSystem</code> </li> <li> <code>SELECT MACAddress, IPAddress, IPSubnet, DHCPEnabled, DHCPServer, DNSDomain FROM Win32_NetworkAdapterConfiguration WHERE MACAddress IS NOT NULL</code> </li> </ul><br>  Las respuestas del servidor C&amp;C est谩n cifradas, pero despu茅s del descifrado contienen el mismo formato MIME con los siguientes valores posibles: <br><img src="https://habrastorage.org/webt/go/am/pd/goampdwrvmb0ospdus377v4jvj8.png"><br><br>  GreyEnergy carga m贸dulos adicionales y carga 煤til en la memoria utilizando su propio cargador de archivos PE. <br><br><h4>  M贸dulos GreyEnergy </h4><br>  Como muchas amenazas complejas, el malware GreyEnergy tiene una arquitectura modular.  Su funcionalidad se puede ampliar agregando m贸dulos adicionales.  El m贸dulo GreyEnergy es un archivo DLL que se ejecuta llamando a una funci贸n con el primer n煤mero de secuencia.  Cada m贸dulo, incluido el m贸dulo principal de GreyEnergy, acepta comandos de texto con varios par谩metros. <br><br>  Los operadores de GreyEnergy no env铆an inmediatamente todos los m贸dulos a una m谩quina comprometida.  Como regla general, un programa malicioso descarga y ejecuta los m贸dulos necesarios para realizar tareas espec铆ficas. <br><br>  Somos conscientes de la existencia de los siguientes m贸dulos de GreyEnergy: <br><br>  <code>remoteprocessexec</code> : inyecta un archivo RE binario en un proceso remoto <br>  <code>info</code> : recopila informaci贸n del sistema, registros de eventos, malware SHA-256 <br>  <code>file</code> - operaciones del sistema de archivos <br>  <code>sshot</code> : toma capturas de pantalla <br>  <code>keylogger</code> - intercepta las pulsaciones de teclas <br>  <code>passwords</code> : recopila contrase帽as almacenadas en varias aplicaciones <br>  <code>mimikatz</code> : herramienta <code>mimikatz</code> utilizada para recopilar credenciales de Windows <br>  <code>plink</code> : software <code>plink</code> utilizado para crear t煤neles SSH <br>  <code>3proxy</code> - software <code>3proxy</code> usado para crear proxies <br><br>  El m贸dulo <code>remoteprocessexec</code> permite a un atacante ejecutar archivos binarios arbitrarios en el contexto de procesos existentes.  Por ejemplo, puede ejecutar Mimikatz o un esc谩ner de puertos en el contexto del Explorador de Windows sin soltarlos en el disco.  Para redirigir la salida est谩ndar y los subprocesos del proceso y la terminaci贸n del proceso, el m贸dulo intercepta cinco funciones API de Windows. <br><br><img src="https://habrastorage.org/webt/vn/c9/2a/vnc92aap-hqdl_ps_0r-tzj4ngc.png"><br>  <i>Figura 14. Funciones de la API de Windows capturadas por remoteprocessexec</i> <br><br>  Dado que la DLL de GreyEnergy restablecida es 煤nica para cada m谩quina infectada, los atacantes pueden recopilar hash SHA-256 utilizando el m贸dulo de informaci贸n.  La presencia de hashes le permitir谩 rastrear si el archivo se ha subido a servicios web p煤blicos como VirusTotal. <br><br><h4>  Protecci贸n inversa y m茅todos anti-criminales </h4><br>  GreyEnergy utiliza varios m茅todos para complicar el an谩lisis.  Por ejemplo, un programa de malware encripta cadenas.  Algunas opciones usan el mismo algoritmo que GreyEnergy mini. <br><br>  Sin embargo, la mayor铆a de las muestras de GreyEnergy tienen un algoritmo de cifrado diferente.  En particular, los primeros cuatro bytes en un blob cifrado no se usan como clave para las operaciones XOR.  En cambio, se usan para inicializar el n煤mero inicial del algoritmo de generaci贸n de n煤meros pseudoaleatorio ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mersenne Whirlwind</a> ), y luego los cuatro bytes generados son la clave.  Antes de liberar un b煤fer de memoria que contiene una cadena de texto sin formato, el malware sobrescribe el b煤fer con ceros. <br><br><img src="https://habrastorage.org/webt/on/px/a6/onpxa6j99a73zoqabotlcujmfyu.png"><br>  <i>Figura 15. C贸digo descompilado para la funci贸n de decodificaci贸n de cadenas GreyEnergy</i> <br><br>  El programa malicioso intercepta las <code>DeleteFileW</code> <code>DeleteFileA</code> y <code>DeleteFileW</code> en la tabla de importaci贸n de cada archivo PE binario cargado en la memoria.  El gancho reemplaza estas funciones con funciones que borran archivos de manera segura.  En particular, el archivo se sobrescribir谩 con ceros antes de eliminarse del disco.  Cada carga 煤til o complemento utilizar谩 dicha funci贸n sin la necesidad de su implementaci贸n en cada m贸dulo. <br><br><img src="https://habrastorage.org/webt/h1/ii/9y/h1ii9yhj8un7_f4zsauhxcaf4wg.png"><br>  <i>Figura 16. C贸digo descompilado para una rutina que intercepta DeleteFileA y DeleteFileW</i> <br><br><h2>  Las herramientas </h2><br>  Los atacantes utilizaron el esc谩ner de puertos Nmap como la herramienta principal para mapear las redes internas de la v铆ctima.  Adem谩s, observamos el uso de un esc谩ner de puertos personalizado liviano donde Nmap no era posible. <br><br><img src="https://habrastorage.org/webt/6s/6p/wu/6s6pwugb_rufwoeytkhlkorgc_m.png"><br>  <i>Figura 17. Salida de la consola de un esc谩ner de puertos de grupo GreyEnergy personalizado</i> <br><br>  Los atacantes utilizan activamente herramientas leg铆timas, como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SysInternals PsExec</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">WinExe</a> , para el movimiento horizontal dentro de redes comprometidas.  La herramienta WinExe, el an谩logo de c贸digo abierto de WinExe, se puede controlar desde un dispositivo Linux, por ejemplo, desde un servidor web Linux comprometido. <br><br>  Vale la pena se帽alar que, adem谩s de estas herramientas, los atacantes usan scripts de PowerShell. <br><br><h2>  Puertas traseras del servidor web </h2><br>  Como se mencion贸 anteriormente, el grupo GreyEnergy implementa puertas traseras adicionales en los servidores web, si estos servidores son accesibles desde Internet.  Notamos que los atacantes usan puertas traseras escritas en PHP para este prop贸sito.  Utilizan el shell web PHP de acceso p煤blico WSO webshell y c99shell. <br><br>  Los atacantes pueden modificar un script PHP existente en un servidor web o implementar uno nuevo.  El c贸digo PHP de puerta trasera real generalmente oculta varios niveles de ofuscaci贸n y cifrado. <br><br><img src="https://habrastorage.org/webt/zo/ri/hz/zorihzdc7ajclfmonz_fcia53yy.png"><br>  <i>Figura 18. C贸digo ofuscado de la puerta trasera PHP del grupo GreyEnergy</i> <br><br>  El 煤ltimo nivel de c贸digo est谩 protegido por el cifrado de flujo.  La generaci贸n de claves para este cifrado se basa en una cadena del valor de cookie proporcionado por los atacantes a trav茅s de una solicitud HTTP.  Cada una de estas puertas traseras PHP est谩 encriptada con una clave separada. <br><br><img src="https://habrastorage.org/webt/cs/8t/yh/cs8tyhnegnb6c1rk1avs7dxfgtk.png"><br>  <i>Figura 19. El 煤ltimo nivel que decodifica el c贸digo de puerta trasera de PHP</i> <br><br>  La t茅cnica de ofuscaci贸n se utiliza para evitar el an谩lisis, as铆 como la imposibilidad de usar una puerta trasera de PHP de este tipo por otros grupos cibern茅ticos. <br><br><h2>  Proxy C&amp;C (triulina) </h2><br>  Como mencionamos anteriormente, los atacantes pueden usar el servidor interno como un proxy C&amp;C. <br><br>  Descubrimos que los atacantes incluso crearon cadenas de servidores proxy C&amp;C en los que el primer servidor de este tipo puede redirigir el tr谩fico de red al siguiente y as铆 sucesivamente hasta que llega al destino final en Internet. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los atacantes usan varios m茅todos para convertir el servidor interno en un proxy C&amp;C. </font><font style="vertical-align: inherit;">Para hacer esto, pueden usar directamente el malware GreyEnergy, software adicional de terceros o scripts. </font><font style="vertical-align: inherit;">En el primer caso, los operadores pueden comprometer el servidor de Windows usando GreyEnergy, convertirlo en un proxy C&amp;C usando los m贸dulos 3proxy y plink. </font><font style="vertical-align: inherit;">En el proceso de monitoreo de la actividad de GreyEnergy, observamos la instalaci贸n de los siguientes programas leg铆timos en servidores internos de Linux:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Proxy peque帽o 3proxy </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Servidor Dante SOCKS </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Enlace PuTTY (Plink) </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En lugar de software de terceros, los atacantes pueden usar servidores web internos instalando sus propios scripts en ellos. Se utilizan los lenguajes de programaci贸n PHP y ASP. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En todos los casos que observamos, las secuencias de comandos PHP implementadas se ofuscaron y se cifraron utilizando el mismo tipo de ofuscaci贸n que en las puertas traseras para servidores web. Sin embargo, en este caso, la cookie que contiene la clave de descifrado es proporcionada por el malware GreyEnergy. Por esta raz贸n, los operadores deben usar un formato de configuraci贸n especial para la URL del servidor. </font></font><br><br><img src="https://habrastorage.org/webt/ms/tm/84/mstm84awqgzzm0rxykrmni1ocmw.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 20. El 煤ltimo nivel que descifra el c贸digo de puerta trasera de PHP usando una cookie.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Curiosamente, la configuraci贸n de malware contiene la palabra </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">triungulina</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">camino al script PHP ofuscado del servidor proxy. </font><font style="vertical-align: inherit;">Este parece ser el nombre interno de este m茅todo utilizado por las declaraciones de GreyEnergy. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si el programa malicioso tiene un proxy C&amp;C incorporado en la configuraci贸n, no contiene servidores C&amp;C externos. </font><font style="vertical-align: inherit;">Por lo tanto, para encontrar la direcci贸n externa de C&amp;C, debe tener una muestra de malware y todos los scripts PHP asociados. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observamos el uso de los siguientes scripts PHP:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> script de proxy php personalizado </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versi贸n ligeramente modificada del </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">servidor Antichat Socks5</font></font></a> </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un script proxy PHP personalizado contiene una URL con un encabezado externo de C&amp;C. </font></font><br><br><img src="https://habrastorage.org/webt/z1/il/bq/z1ilbqnz3shhbn__app1xhpgtem.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 21. Un servidor C&amp;C externo incrustado en un script de servidor proxy PHP personalizado. Un</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> script </font><i><font style="vertical-align: inherit;">PHP personalizado</font></i><font style="vertical-align: inherit;"> utiliza las bibliotecas OpenSSL y Curl para redirigir una solicitud de un programa malicioso a un servidor C&amp;C externo en Internet. </font></font><br><br><img src="https://habrastorage.org/webt/ph/bc/20/phbc20w7dx91bjkhopbartak4cw.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 22. C贸digo para el script PHP personalizado del servidor proxy del grupo GreyEnergy</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Como se mencion贸 anteriormente, los atacantes pueden usar scripts ASP para el mismo prop贸sito. En un caso que observamos, el script ASP us贸 una cookie provista por el malware para descifrar solo la direcci贸n C&amp;C real usando AES; el resto del c贸digo no estaba encriptado u ofuscado. </font></font><br><br><img src="https://habrastorage.org/webt/y-/2k/tq/y-2ktq8-zcd2m9e70sobitai9se.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 23. C贸digo proxy ASP utilizado por el grupo GreyEnergy</font></font></i> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Servidores C y C con acceso a Internet </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todos los servidores de GreyEnergy C&amp;C usaban Tor cuando estaban activos. </font><font style="vertical-align: inherit;">La configuraci贸n de la infraestructura de C&amp;C es similar a BlackEnergy, TeleBots e Industroyer, que tambi茅n usaban servidores Tor. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Probablemente todos los servidores de C&amp;C tienen una direcci贸n de cebolla, y los atacantes la usan para acceder, administrar o transmitir datos. </font><font style="vertical-align: inherit;">Esto parece ser un requisito de OPSEC que agrega una capa adicional de anonimato a los atacantes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los expertos de ESET han identificado los servidores de C&amp;C utilizados por el malware GreyEnergy en los 煤ltimos tres a帽os. </font><font style="vertical-align: inherit;">La lista se proporciona a continuaci贸n en la secci贸n "Indicadores de compromiso".</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comparaci贸n de GreyEnergy y BlackEnergy </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las familias de malware GreyEnergy y BlackEnergy tienen la misma estructura, conjunto de m贸dulos y funciones. </font><font style="vertical-align: inherit;">Aunque la implementaci贸n de estas funciones es diferente, a煤n son comparables.</font></font><br><img src="https://habrastorage.org/webt/mn/zc/sj/mnzcsjrof8t61sfkfi3lzs15p8k.png"><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Petya Moonraker </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En diciembre de 2016, los atacantes lanzaron un gusano que, en nuestra opini贸n, fue el predecesor de NotPetya (tambi茅n conocido como Petya, ExPetr, Nyetya, EternalPetya). El gusano se us贸 en ataques contra un peque帽o n煤mero de objetos y ten铆a capacidades de distribuci贸n limitadas, por lo que no se conoc铆a ampliamente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un gusano es un archivo DLL con un nombre </font></font><code>msvcrt120b.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ubicado en el directorio de Windows. El nombre interno del archivo es </font></font><code>moonraker.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, lo que, tal vez, es una referencia a la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pel铆cula</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">novela de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bond </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">del</font></a><font style="vertical-align: inherit;"> mismo </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">nombre</font></a><font style="vertical-align: inherit;"> . En general, llamamos al programa Moonraker Petya. </font></font><br><br><img src="https://habrastorage.org/webt/21/ez/o5/21ezo5wz4iwkebpqamk88nnuv3e.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 24. El nombre interno del gusano instalado en diciembre de 2016</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La marca de tiempo PE en la DLL sugiere que el archivo se compil贸 en diciembre de 2016, presumiblemente justo antes de la instalaci贸n. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moonraker Petya contiene un c贸digo despu茅s del cual la computadora deja de cargar. En particular, sobrescribe el valor </font></font><code>ImagePath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en las claves de registro </font></font><code>[HKEY_LOCAL_MACHINE\System\ControlSet001\Services\ACPI]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font><code>[HKEY_LOCAL_MACHINE\System\ControlSet002\Services\ACPI]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y borra el primer sector de la unidad del sistema. A diferencia de NotPetya, Moonraker Petya no contiene c贸digo que interact煤e directamente con MBR y el gestor de arranque del sistema operativo. En cambio, la DLL de Moonraker Petya contiene un blob de datos binarios cifrados. El malware espera un argumento de l铆nea de comandos que luego se utilizar谩 como clave de descifrado. Despu茅s de descifrar y descomprimir usando la biblioteca zlib, el c贸digo se carga en la memoria como un archivo RE binario y se ejecuta. No tenemos una clave de descifrado, pero analizamos las im谩genes de disco de las computadoras infectadas. Conten铆an el c贸digo MBR y el gestor de arranque, que corresponde al c贸digo encontrado en el Green Petya original utilizado por diferentes grupos cibern茅ticos. Suponemos que la gota puede contener la Petya verde original.</font></font><br><br><img src="https://habrastorage.org/webt/ok/4h/pk/ok4hpk-oion7dmngxdeo0ud8tka.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 25. La pantalla emergente que se muestra despu茅s de reiniciar en computadoras infectadas con Moonraker Petya</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es interesante que el descifrado en Moonraker Petya sea muy similar al mismo proceso en los archivos DLL de GreyEnergy en el modo "solo en memoria". </font></font><br><br><img src="https://habrastorage.org/webt/mb/ef/mq/mbefmqjst4qziv5a8wxnrggyxky.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 26. Comparaci贸n del c贸digo descompilado de Moonraker Petya (izquierda) y GreyEnergy (derecha) El c贸digo de</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Moonraker Petya se puede distribuir a trav茅s de una red local utilizando SysInternals PsExec. Los programas maliciosos contienen archivos binarios comprimidos en zlib en sus recursos. M谩s tarde, el binario se vac铆a en el directorio de Windows con el nombre del archivo </font></font><code>conhost.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este programa malicioso se distribuye de manera similar NotPetya: enumera los nodos de red utilizando diferentes m茅todos ( </font></font><code>WNetEnumResourceW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>GetIpNetTable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>GetExtendedTcpTable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>NetServerEnum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, TERMSRV-registros usando</font></font><code>CredEnumerateW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), luego se conecta al host de la red mediante la funci贸n </font></font><code>WNetAddConnection2W</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y guarda el malware como </font></font><code>\\%TARGET-HOST%\admin$\%MALWARE%</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Despu茅s de eso, Moonraker Petya ejecuta el siguiente comando, que lanza el malware en la computadora remota usando el PsExec de reinicio: </font></font><br><br> <code>C:\Windows\conhost.exe \\%TARGET-HOST% -accepteula -s -d C:\Windows\System32\rundll32.exe "C:\Windows\msvcrt120b.dll", #1 %TIMEOUT% "USER1:PASSWORD1;USER2:PASSWORD2" "%DECRYPTIONKEY%"</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es importante tener en cuenta que el malware no tiene funciones de recopilaci贸n de credenciales con Mimikatz y no contiene el exploit EternalBlue. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adem谩s de las caracter铆sticas enumeradas, Moonraker Petya tambi茅n admite el cifrado de archivos. El programa malicioso escanea todos los archivos en los discos duros, luego de lo cual intenta encriptarlos usando el algoritmo AES-256. Una vez que se completa el proceso de cifrado, el malware puede crear un archivo </font></font><code>README.txt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">con instrucciones de pago.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La instrucci贸n contiene una clave personal encriptada usando RSA-2048. Adem谩s, contiene el mismo texto y direcciones de cebolla que el Green Petya original. Parece que los atacantes quer铆an disfrazar el uso de este malware como un ataque con Green Petya. </font></font><br><br><img src="https://habrastorage.org/webt/9f/i3/qu/9fi3quz_fckxngvtzjm6eay2svy.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 27. Archivo L茅ame con instrucciones de pago creado por Moonraker Petya</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Como paso final, Moonraker Petya intenta reiniciar la computadora.</font></font><br><br><h2>  Conclusi贸n </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GreyEnergy es una parte importante del arsenal de uno de los grupos ART m谩s peligrosos que ha estado atacando objetivos ucranianos en los 煤ltimos a帽os. La vemos como la sucesora de BlackEnergy, las similitudes y diferencias se enumeran en esta publicaci贸n. Las principales razones por las que llegamos a esta conclusi贸n son una estructura similar de malware, una selecci贸n de objetivos y m茅todos de trabajo. La transici贸n de BlackEnergy a GreyEnergy tuvo lugar a fines de 2015, tal vez porque los atacantes tuvieron que actualizar el paquete de malware despu茅s de aumentar la atenci贸n a la infraestructura de BlackEnergy.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Una parte interesante del rompecabezas es el hecho establecido de usar Moonraker Petya en junio de 2016, que, seg煤n nuestras estimaciones, es el predecesor del programa destructivo NotPetya. </font><font style="vertical-align: inherit;">Esto puede indicar que los grupos TeleBots y GreyEnergy est谩n colaborando, o al menos compartiendo c贸digo y algunas ideas. </font><font style="vertical-align: inherit;">Sin embargo, los consideramos como grupos separados, cuyos objetivos son algo diferentes. </font><font style="vertical-align: inherit;">Al momento de escribir esto, no vimos las actividades intencionales de TeleBots fuera de Ucrania, a diferencia de GreyEnergy y BlackEnergy antes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En cualquier caso, los operadores de GreyEnergy representan un grave peligro. </font><font style="vertical-align: inherit;">Continuamos monitoreando la actividad de GreyEnergy y TeleBots y recomendamos que los usuarios privados y corporativos usen los productos m谩s avanzados para proteger los puntos finales.</font></font><br><br><h2>  Indicadores de compromiso </h2><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Detecci贸n por productos ESET: </font></font></h4><br> <code>VBA/TrojanDownloader.Agent.EYV <br> Win32/Agent.SCT <br> Win32/Agent.SCM <br> Win32/Agent.SYN <br> Win64/Agent.SYN <br> Win32/Agent.WTD <br> Win32/GreyEnergy <br> Win64/GreyEnergy <br> Win32/Diskcoder.MoonrakerPetya.A <br> PHP/Agent.JS <br> PHP/Agent.JX <br> PHP/Agent.KJ <br> PHP/Agent.KK <br> PHP/Agent.KL <br> PHP/Agent.KM <br> PHP/Agent.KN <br> PHP/Agent.KO <br> PHP/Agent.KP <br> PHP/Agent.KQ <br> PHP/Agent.KR <br> PHP/Agent.KS <br> PHP/Agent.KT <br> PHP/Agent.KU <br> PHP/Agent.LC <br> PHP/Agent.NBP <br> PHP/Kryptik.AB <br> PHP/TrojanProxy.Agent.B <br> ASP/Agent.L <br> Win64/HackTool.PortScanner.A <br> Win64/Riskware.Mimikatz.A <br> Win64/Riskware.Mimikatz.AE <br> Win64/Riskware.Mimikatz.AH <br> Win32/Winexe.A <br> Win64/Winexe.A <br> Win64/Winexe.B</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Documento GreyEnergy: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>177AF8F6E8D6F4952D13F88CDF1887CB7220A645</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GreyEnergy mini: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>455D9EB9E11AA9AF9717E0260A70611FF84EF900 <br> 51309371673ACD310F327A10476F707EB914E255 <br> CB11F36E271306354998BB8ABB6CA67C1D6A3E24 <br> CC1CE3073937552459FB8ED0ADB5D56FA00BCD43 <br> 30AF51F1F7CB9A9A46DF3ABFFB6AE3E39935D82C</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Goteros GreyEnergy: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>04F75879132B0BFBA96CB7B210124BC3D396A7CE <br> 69E2487EEE4637FE62E47891154D97DFDF8AAD57 <br> 716EFE17CD1563FFAD5E5E9A3E0CAC3CAB725F92 <br> 93EF4F47AC160721768A00E1A2121B45A9933A1D <br> 94F445B65BF9A0AB134FAD2AAAD70779EAFD9288 <br> A414F0A651F750EEA18F6D6C64627C4720548581 <br> B3EF67F7881884A2E3493FE3D5F614DBBC51A79B <br> EBD5DC18C51B6FB0E9985A3A9E86FF66E22E813E <br> EC7E018BA36F07E6DADBE411E35B0B92E3AD8ABA</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> DLL reiniciables de GreyEnergy: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>0B5D24E6520B8D6547526FCBFC5768EC5AD19314 <br> 10D7687C44BECA4151BB07F78C6E605E8A552889 <br> 2A7EE7562A6A5BA7F192B3D6AED8627DFFDA4903 <br> 3CBDC146441E4858A1DE47DF0B4B795C4B0C2862 <br> 4E137F04A2C5FA64D5BF334EF78FE48CF7C7D626 <br> 62E00701F62971311EF8E57F33F6A3BA8ED28BF7 <br> 646060AC31FFDDFBD02967216BC71556A0C1AEDF <br> 748FE84497423ED209357E923BE28083D42D69DE <br> B75D0379C5081958AF83A542901553E1710979C7 <br> BFC164E5A28A3D56B8493B1FC1CA4A12FA1AC6AC <br> C1EB0150E2FCC099465C210B528BF508D2C64520 <br> CBB7BA92CDF86FA260982399DAB8B416D905E89B <br> DF051C67EE633231E4C76EC247932C1A9868C14F <br> DFD8665D91C508FAF66E2BC2789B504670762EA2 <br> E2436472B984F4505B4B938CEE6CAE26EF043FC7 <br> E3E61DF9E0DD92C98223C750E13001CBB73A1E31 <br> E496318E6644E47B07D6CAB00B93D27D0FE6B415 <br> EDA505896FFF9A29BD7EAE67FD626D7FFA36C7B2 <br> F00BEFDF08678B642B69D128F2AFAE32A1564A90 <br> F36ECAC8696AA0862AD3779CA464B2CD399D8099</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GreyEnergy DLL (modo "solo en memoria"): </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>0BCECB797306D30D0BA5EAEA123B5BF69981EFF4 <br> 11159DB91B870E6728F1A7835B5D8BE9424914B9 <br> 6ABD4B82A133C4610E5779C876FCB7E066898380 <br> 848F0DBF50B582A87399428D093E5903FFAEEDCD <br> 99A81305EF6E45F470EEE677C6491045E3B4D33A <br> A01036A8EFE5349920A656A422E959A2B9B76F02 <br> C449294E57088E2E2B9766493E48C98B8C9180F8 <br> C7FC689FE76361EF4FDC1F2A5BAB71C0E2E09746 <br> D24FC871A721B2FD01F143EB6375784144365A84 <br> DA617BC6DCD2083D93A9A83D4F15E3713D365960 <br> E4FCAA1B6A27AA183C6A3A46B84B5EAE9772920B</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Petya Moonraker </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>1AA1EF7470A8882CA81BB9894630433E5CCE4373</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PHP y scripts ASP </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>10F4D12CF8EE15747BFB618F3731D81A905AAB04 <br> 13C5B14E19C9095ABA3F1DA56B1A76793C7144B9 <br> 1BA30B645E974DE86F24054B238FE77A331D0D2C <br> 438C8F9607E06E7AC1261F99F8311B004C23DEC3 <br> 4D1C282F9942EC87C5B4D9363187AFDC120F4DC7 <br> 4E0C5CCFFB7E2D17C26F82DB5564E47F141300B3 <br> 5377ADB779DE325A74838C0815EEA958B4822F82 <br> 58A69A8D1B94E751050DECF87F2572E09794F0F8 <br> 5DD34FB1C8E224C17DCE04E02A4409E9393BCE58 <br> 639BCE78F961C4B9ECD9FE1A8537733388B99857 <br> 7127B880C8E31FBEB1D376EB55A6F878BC77B21A <br> 71BA8FE0C9C32A9B987E2BB827FE54DAE905D65E <br> 78A7FBDD6ADF073EA6D835BE69084E071B4DA395 <br> 81332D2F96A354B1B8E11984918C43FB9B5CB9DB <br> 8CC008B3189F8CE9A96C2C41F864D019319EB2EE <br> 940DE46CD8C50C28A9C0EFC65AEE7D567117941B <br> A415E12591DD47289E235E7022A6896CB2BFDE96 <br> D3AE97A99D826F49AD03ADDC9F0D5200BE46AB5E <br> E69F5FF2FCD18698BB584B6BC15136D61EB4F594 <br> E83A090D325E4A9E30B88A181396D62FEF5D54D5 <br> ECF21EFC09E4E2ACFEEB71FB78CB1F518E1F5724</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Esc谩ner de puerto personalizado </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>B371A5D6465DC85C093A5FB84D7CDDEB1EFFCC56 <br> B40BDE0341F52481AE1820022FA8376E53A20040</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mimikatz </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>89D7E0DA80C9973D945E6F62E843606B2E264F7E <br> 8B295AB4789105F9910E4F3AF1B60CBBA8AD6FC0 <br> AD6F835F239DA6683CAA54FCCBCFDD0DC40196BE</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Winexe </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHA-1: </font><font style="vertical-align: inherit;">Advertencia: la mayor铆a de los servidores con estas direcciones IP formaban parte de la red Tor, es decir, el uso de estos indicadores puede generar falsos positivos.</font></font><br> <code>0666B109B0128599D535904C1F7DDC02C1F704F2 <br> 2695FCFE83AB536D89147184589CCB44FC4A60F3 <br> 3608EC28A9AD7AF14325F764FB2F356731F1CA7A <br> 37C837FB170164CBC88BEAE720DF128B786A71E0 <br> 594B809343FEB1D14F80F0902D764A9BF0A8C33C <br> 7C1F7CE5E57CBDE9AC7755A7B755171E38ABD70D <br> 90122C0DC5890F9A7B5774C6966EA694A590BD38 <br> C59F66808EA8F07CBDE74116DDE60DAB4F9F3122 <br> CEB96B364D6A8B65EA8FA43EB0A735176E409EB0 <br> FCEAA83E7BD9BCAB5EFBA9D1811480B8CB0B8A3E</code> <br> <br><font style="vertical-align: inherit;"></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El servidor de C&amp;C se dirige a GreyEnergy mini </font></font></h4><br> <code>https://82.118.236[.]23:8443/27c00829d57988279f3ec61a05dee75a <br> http://82.118.236[.]23:8080/27c00829d57988279f3ec61a05dee75a <br> https://88.198.13[.]116:8443/xmlservice <br> http://88.198.13[.]116:8080/xmlservice <br> https://217.12.204[.]100/news/ <br> http://217.12.204[.]100/news/ <br> http://pbank.co[.]ua/favicon.ico (IP: 185.128.40.90)</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Direcciones del servidor GreyEnergy C &amp; C (per铆odos de actividad e IP) </font></font></h4><br> <code>20152016  109.200.202.7 <br> 20152015  193.105.134.68 <br> 20152016  163.172.7.195 <br> 20152016  163.172.7.196 <br> 20162016  5.149.248.77 <br> 20162016  31.148.220.112 <br> 20162016  62.210.77.169 <br> 20162016  85.25.211.10 <br> 20162016  138.201.198.164 <br> 20162017  124.217.254.55 <br> 20172017  46.249.49.231 <br> 20172017  37.59.14.94 <br> 20172017  213.239.202.149 <br> 20172017  88.198.13.116 <br> 20172017  217.12.202.111 <br> 20172017  176.31.116.140 <br> 20172018  185.217.0.121 <br> 20172018  178.150.0.200 <br> 20182018  176.121.10.137 <br> 20182018  178.255.40.194 <br> 20182018  193.105.134.56 <br> 20182018  94.130.88.50 <br> 20182018  185.216.33.126</code> </div> </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es426911/">https://habr.com/ru/post/es426911/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es426899/index.html">Video Science Meetup Video</a></li>
<li><a href="../es426901/index.html">La c谩mara m谩s r谩pida del mundo dispara 10 billones de fotogramas por segundo</a></li>
<li><a href="../es426903/index.html">La ciudad de Chengdu quiere poner en 贸rbita un reflector de sat茅lite para iluminar las calles con una mancha de luz solar de 10 a 80 km</a></li>
<li><a href="../es426905/index.html">Versi贸n PVS-Studio 6.26</a></li>
<li><a href="../es426907/index.html">Problemas comunes de seguridad de la red corporativa que se pueden detectar con Check Point Security CheckUP</a></li>
<li><a href="../es426913/index.html">C贸mo hacer entrevistas entre informes y un peque帽o informe sobre DevOops</a></li>
<li><a href="../es426915/index.html">NASA Hackathon: desaf铆o de aplicaciones espaciales</a></li>
<li><a href="../es426917/index.html">Plataforma inteligente y segura de Cisco para negocios en la era digital</a></li>
<li><a href="../es426919/index.html">Presentamos Microsoft Learn</a></li>
<li><a href="../es426921/index.html">Oh, mi c贸digo: c贸mo tener 茅xito en TI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>