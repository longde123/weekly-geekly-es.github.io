<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ง๐ฟโ๐คโ๐ง๐ฝ ๐ฉ๐พโ๐พ ๐ ุฃูุจููุชู 18.04 ุงูุฌุฐุฑ ุนูู ZFS โฉ ๐๏ธ โซ๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ุงูุนุงู ุงููุงุถู ููุช ุจุญุงุฌุฉ ูุฅูุดุงุก ุชุนูููุงุช ูุชุซุจูุช ูุธุงู ุงูุชุดุบูู Ubuntu 18.04. ุจุงูููุงุณุจุฉ ุ ูุง ููุฌุฏ ุดูุก ูุนูุฏ ูู ุชุซุจูุช ุฃูุจููุชู ุ ูููู ููุงู ูุงุฑู ุจุณูุท: ุฃุฑุฏุช ุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฃูุจููุชู 18.04 ุงูุฌุฐุฑ ุนูู ZFS</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439860/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูู ุงูุนุงู ุงููุงุถู ููุช ุจุญุงุฌุฉ ูุฅูุดุงุก ุชุนูููุงุช ูุชุซุจูุช ูุธุงู ุงูุชุดุบูู Ubuntu 18.04.  ุจุงูููุงุณุจุฉ ุ ูุง ููุฌุฏ ุดูุก ูุนูุฏ ูู ุชุซุจูุช ุฃูุจููุชู ุ ูููู ููุงู ูุงุฑู ุจุณูุท: ุฃุฑุฏุช ุงุณุชุฎุฏุงู ูุธุงู ุงููููุงุช ZFS ููุงุนุฏุฉ.  ูู ูุงุญูุฉ ุ ูุฏุนู Ubuntu ZFS ุนูู ูุณุชูู kernel ุ ููู ูุง ููุฌุฏ ุจุฑูุงูุฌ ุชุซุจูุช ูู ุญุชู ุงูุขู ุ ูููู ููุงู ุชุนูููุงุช ุ ูุนู: </p><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://github.com/zfsonlinux/zfs/wiki/Ubuntu-18.04-Root-on-ZFS</a> </p><br><p style=";text-align:right;direction:rtl">  ุชุณูุณู ุงูุฅุฌุฑุงุกุงุช ูู ูุฐุง ุงูุฏููู ุตุญูุญ ุจุดูู ุนุงู ุ ููู ุจุนุถ ุงูููุงุท ุชุชุทูุจ ุงูุถุจุท.  ุฅุฐู ูุง ููู ููุณ ุชุฑุฌูุฉ ูุจุงุดุฑุฉ ููุชุนูููุงุช ุ ูููู ูุฌุงููุง ุ ูุน ูุฑุงุนุงุฉ ุงูุชุตุญูุญุงุช ูุชุฌุฑุจุชู ูุน ZFS ูุฃุดูุงุก ุฃุฎุฑู.  ุฃูุง ุฃูุถูุง ูุง ุฃุนุชุจุฑ ูุดููุงุช ุชุดููุฑ ุงููุฑุต ูุงุณุชุฎุฏุงู ุฃุฏุงุฉ ุชุญููู ุฃุฏุงุฉ MBR.  ูููู ุงูุญุตูู ุนูู ุชุนูููุงุช ุงูุชุซุจูุช ุงูุฎุงุตุฉ ุจู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง.</a> </p><br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl"><blockquote style=";text-align:right;direction:rtl">  0. ุฅุนุฏุงุฏ ุงูุฎุงุฏู </blockquote></h2><br><p style=";text-align:right;direction:rtl"> ุฃูู ุดูุก ููููุฏ ูู ุงูุฅุฑุดุงุฏุงุช ููุง ูุชู ุงุนุชุจุงุฑู ุจุฃู ุดูู ูู ุงูุฃุดูุงู ูู ุฃู ZFS ูุง ูุนูู ุจุดูู ุฌูุฏ ูุน ุตูุงุฆู RAID ููุฃุฌูุฒุฉ ุ ุนูู ูุฌู ุงูุฎุตูุต ุ ุฅูู ูุชุตู ุจู "ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูููุชุงุจุฉ" ุ ููู ุฃูุฑ ููููู: ูุชู ุนูู ูุธุงู ูููุงุช ZFS ุจุดูู ูููู ููุชุทูุจ ุงูุชุญูู ุงููุงูู ูู ุนูููุงุช ุงููุชุงุจุฉ.  ุฃูุถูุง ุ ุนูุฏ ุงุณุชุฎุฏุงู ูุฌููุนุฉ RAID ููุฃุฌูุฒุฉ ุงูุฌุงูุฒุฉ ุ ูุชู ููุฏ ุฅููุงูุงุช ZFS ูู ุญูุซ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ู Spare ูุงููุฒูุฏ.  ูุฐูู ุ ูุฌุจ ููู ุฌููุน ุงูุฃูุฑุงุต ุฅูู ูุถุน HBA ุ ูุฅุฐุง ูู ููู ุฐูู ูููููุง - ูุฅูุดุงุก RAID ูููุตู ููู ูุฑุต ูุชุนุทูู ุฌูุงุฒ ุงูุชุญูู ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูููุชุงุจุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฃูุถูุง ุ ุนูุฏ ุงุณุชุฎุฏุงู ุชุฌููุน ููุงูุฐ ุงูุดุจูุฉ ุ ููููู ุชุนุทูููุง ูู ูุฑุญูุฉ ุงูุชุซุจูุช ุ ุญุชู ูุง ูุชู ุชุนููุฏูุง (ุณุฃููู ุจุฅุฌุฑุงุก ุฌููุน ุงูุนูููุงุช ุงูุฃุฎุฑู ุฏูู ุงูุฑุจุท). </p><br><h2 style=";text-align:right;direction:rtl">  1. ุฅุนุฏุงุฏ ุจูุฆุฉ ุงูุชุซุจูุช </h2><br><h3 style=";text-align:right;direction:rtl">  1.1.  ูุฑุต ุญู </h3><br><p style=";text-align:right;direction:rtl">  ููุง ุฐูุฑูุง ุณุงุจููุง ุ ูุณูุก ุงูุญุธ ุ ูุง ููุฌุฏ ูุซุจุช ุฃูุจููุชู ุฌุงูุฒ ูุณุชุฎุฏู ุงูุฌุฐุฑ ุนูู ZFS ุ ูุฐูู ูุชู ุงูุชุซุจูุช ุจุงุณุชุฎุฏุงู ูุฑุต ูุฑุต ุญู: </p><br><p style=";text-align:right;direction:rtl">  ูู ุจุงูุชูุฒูู ูู ููุง: <a href="">http://releases.ubuntu.com/18.04/ubuntu-18.04.1-desktop-amd64.iso</a> </p><br><blockquote style=";text-align:right;direction:rtl">  ูู ุงูููุช ููุณู ุ ุญุงููุช ูุน ุฒููุงุฆู ุงุณุชุฎุฏุงู ุตูุฑ ูุฎุชููุฉ ูููุฑุต ูุฃููู ูุง ุฃุฑูุฏ ุญููุง ุงุณุชุฎุฏุงู ุงููุดุฑุฉ ุงูุฑุณูููุฉ ุ ููู ูุฐุง ูู ูุคุฏู ุฅูู ุฃู ุดูุก ุฌูุฏ. </blockquote><br><p style=";text-align:right;direction:rtl">  ูููู ุจุงูุชูููุฏ ูู ูุฑุต ุญู ุ ุญุฏุฏ Try Ubuntu ูุงูุชุญ ุงูุฌูุงุฒ (Ctrl + Alt + T). </p><br><h3 style=";text-align:right;direction:rtl">  1.2.  ุชุญุฏูุซ ูุชุซุจูุช ุงููุณุชูุฏุนุงุช </h3>  '' <br><pre style=";text-align:right;direction:rtl"><code class="bash hljs">sudo apt-add-repository universe sudo apt update</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ูุญู ููุง ูู ุงูุชุธุงุฑ ุงููุดูู ุงูุฃูู ุฅุฐุง ูู ูุชู ุชุญุฏูุฏ ุฅุนุฏุงุฏุงุช ุงูุดุจูุฉ ููุฎุงุฏู ุจูุงุณุทุฉ DHCP.  ูู ุชุนูู ุชุญุฏูุซ ุงููุณุชูุฏุนุงุช ุ ูุฐูู ุฏุนููุง ูููู ุจุฅุนุฏุงุฏ ุงูุดุจูุฉ. </blockquote><br><p style=";text-align:right;direction:rtl">  ูุญู ูููู ูุธุฑุฉ ุนูู ูุงุฌูุงุช ุงูุดุจูุฉ ููุฌุฏ ูุงุฌูุฉ ุงูุชูุงุตู ูู ุฎูุงููุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo ip a</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชูููู ูุงุฌูุฉ ุงูุดุจูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"auto {{ NAME }}"</span></span> &gt;&gt; /etc/network/interfaces sudo <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"iface {{ NAME }} inet static"</span></span> &gt;&gt; /etc/network/interfaces sudo <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">" address {{ IP }}"</span></span> &gt;&gt; /etc/network/interfaces sudo <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">" netmask {{ NETMASK }}"</span></span> &gt;&gt; /etc/network/interfaces sudo <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">" gateway {{ GATEWAY }}"</span></span> &gt;&gt; /etc/network/interfaces sudo service networking restart</code> </pre><br><p style=";text-align:right;direction:rtl">  ููุญูู DNS: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'nameserver 8.8.8.8'</span></span> &gt;&gt; /etc/resolv.conf</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุญุฏูุซ ุงููุณุชูุฏุนุงุช: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo apt update</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  1.3.  ุฎุงุฏู SSH (ุงุฎุชูุงุฑู) </h3><br><p style=";text-align:right;direction:rtl">  ูุณูููุฉ ุงูุชุซุจูุช ุ ููููู ุฑูุน ุฎุงุฏู OpenSSH ูุชูููุฐ ุฌููุน ุงูุนูููุงุช ุงูุฃุฎุฑู ูู ุฎูุงู ุนููู SSH </p><br><p style=";text-align:right;direction:rtl">  ูู ุจุชุนููู ูููุฉ ุงููุฑูุฑ ูููุณุชุฎุฏู ุฃูุจููุชู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">passwd</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ูุฐุง ููู!  ููุฐ ุฎูุงู ุฐูู ุ ุณูุชู ุงููุตูู ุนุจุฑ ssh ุจุฏูู ูููุฉ ูุฑูุฑ ูุน ุญููู sudo.  ููุน ุฐูู ุ ูุง ููููู ุชุนููู ูููุฉ ูุฑูุฑ ุจุณูุทุฉ. </blockquote><br><p style=";text-align:right;direction:rtl">  ุชุซุจูุช ูุชุดุบูู OpenSSH: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo apt install openssh-server sudo service ssh start</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููู ูุญุทุฉ ูุญุทุฉ ุงูุนูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">ssh ubuntu@{{ ip server }}</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  1.4.  ุชุตุจุญ ุงูุฌุฐุฑ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo -s</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  1.5.  ุชุซุจูุช ุฏุนู ZFS ูู ุจูุฆุฉ ูุฑุต ุญู </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">apt install --yes debootstrap gdisk zfs-initramfs</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  2. ุชูุณูู ูุชูุณูู ุงูุฃูุฑุงุต ุงูุตูุจุฉ </h2><br><h3 style=";text-align:right;direction:rtl"><blockquote style=";text-align:right;direction:rtl">  2.0.  ุชุญุฏูุฏ ุตูุงุฆู ุงููุฑุต </blockquote></h3><br><p style=";text-align:right;direction:rtl">  ูุง ุชุญุชูู ุงูุชุนูููุงุช ุงูุฑุฆูุณูุฉ ุนูู ููุทุฉ ูููุฉ ุญูู ููููุฉ ุชุญุฏูุฏ ุตูุงุฆู ุงููุฑุต. </p><br><p style=";text-align:right;direction:rtl">  ุนุงุฏุฉู ูุง ูููู ุนุฏุฏ ุงูุฃูุฑุงุต ุนูู ุงูุฎูุงุฏู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  2 ุฃูุฑุงุต ุ </li><li style=";text-align:right;direction:rtl">  4 ุงุณุทูุงูุงุช </li><li style=";text-align:right;direction:rtl">  ุงูุนุฏูุฏ ูู ุงูุฃูุฑุงุต. </li></ul><br><p style=";text-align:right;direction:rtl">  ูุง ูุนุชุจุฑ ูุฑุตูุง ูุงุญุฏูุง ูุธุฑูุง ูุฃูู ุดุงุฐ ุจุดูู ุนุงู. </p><br><h4 style=";text-align:right;direction:rtl">  2.0.1.  2 ุฃูุฑุงุต </h4><br><p style=";text-align:right;direction:rtl">  ูู ุดูุก ุจุณูุท ููุง ุ ุตููู MIRROR ูุงุญุฏ (RAID1).  ุฅุฐุง ูุงู ููุงู ูุญุฑู ุฃูุฑุงุต ุซุงูุซ ุขุฎุฑ ุ ูููููู ูุถุนู ูู ููุงู ุณุงุฎู (SPARE) ุฃู ุชุฌููุน ูุฌููุนุฉ RAIDZ (RAID5).  ูููู 3 ุฃูุฑุงุต ูู ุงูุฎุงุฏู ูุงุฏุฑุฉ ุฌุฏุง. </p><br><h4 style=";text-align:right;direction:rtl">  2.0.2.  4 ุฃูุฑุงุต </h4><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงูุช ุฌููุน ูุญุฑูุงุช ุงูุฃูุฑุงุต ูุชูุงุซูุฉ ุ ูููุงู ุซูุงุซุฉ ุฎูุงุฑุงุช ููุท (RAID0 ุงูุฑุงุจุนุฉ ูุง ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุจุดูู ุฃุณุงุณู): </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  MIRROR + MIRROR ูู ูุธูุฑ ูู RAID10 ุ ุจุชุนุจูุฑ ุฃุฏู RAID01 ุ ูุฃูู ูู ZFS ูู ูุฑุขุฉ + ูุฑุขุฉ.  50 ูช ูู ูุณุงุญุฉ ุงููุฑุต ุงููุชุงุญุฉ ุ </li><li style=";text-align:right;direction:rtl">  RAIDZ ูู ุงูุชูุงุธุฑูุฉ RAID5.  75 ูช ูู ูุณุงุญุฉ ุงููุฑุต ุงููุชุงุญุฉ ุ </li><li style=";text-align:right;direction:rtl">  RAIDZ2 ูู ุชูุงุธุฑูุฉ RAID6.  50 ูช ูู ูุณุงุญุฉ ุงููุฑุต ุงููุชุงุญุฉ ุ </li></ul><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ุฃุณุชุฎุฏู ุตููู MIRROR + MIRROR ุ ูู ุญูู ุฃูู ูู ุงููุงุถุญ ุฃู ุตููู RAIDZ ูู ุงูุฃูุซุฑ ุฑุจุญูุฉ ุ ูุฃูู ูููุฑ ูุณุงุญุฉ ุฃูุจุฑ ุนูู ุงููุฑุต ุ ูููู ููุงู ูุฑูู ุฏูููุฉ </p><br><p style=";text-align:right;direction:rtl">  ูู ุญูุซ ุงูุชุณุงูุญ ูุน ุงูุฎุทุฃ ุ ูุชู ุชุฑุชูุจ ุงููุตูููุงุช ุจุงูุชุฑุชูุจ (ูู ุงูุฃูุถู ุฅูู ุงูุฃุณูุฃ): </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  RAIDZ2 - ูุฏ ูุชู ููุฏ ูุฑุตูู ุฏูู ููุฏ ุงูุจูุงูุงุช ุ </li><li style=";text-align:right;direction:rtl">  MIRROR + MIRROR - ูุฏ ูุชู ููุฏ ูุฑุต ูุงุญุฏ ุฏูู ููุฏ ุงูุจูุงูุงุช ุ ูุจุงุญุชูุงู ุจูุณุจุฉ 66ูช ุ ูุฏ ูุชู ููุฏ ูุฑุต ุซุงูู ุฏูู ููุฏ ุงูุจูุงูุงุช ุ </li><li style=";text-align:right;direction:rtl">  RAIDZ - ูููู ููุฏ ูุฑุต ูุงุญุฏ ููุท ุฏูู ููุฏ ุงูุจูุงูุงุช ุ </li></ul><br><p style=";text-align:right;direction:rtl">  ูู ุญูุซ ุงูุณุฑุนุฉ ุ ูุชู ุชุฑุชูุจ ุงููุตูููุงุช ุจุงูุชุฑุชูุจ ุงูุชุงูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  MIRROR + MIRROR - ุณูุงุก ูู ุญูุซ ุงููุชุงุจุฉ ูุงููุฑุงุกุฉ ุ </li><li style=";text-align:right;direction:rtl">  RAIDZ - ูู ุญูุซ ุงูุชุณุฌูู ุฃุจุทุฃ ุ ูุฃูู ุจุงูุฅุถุงูุฉ ุฅูู ุงูุชุณุฌูู ุ ูุฌุจ ุญุณุงุจ ุงููุฌููุน ุงูุงุฎุชุจุงุฑู ุ </li><li style=";text-align:right;direction:rtl">  RAIDZ2 - ูู ุญูุซ ุงููุชุงุจุฉ ูู ุฃุจุทุฃ ูุฃูู ูุชุทูุจ ุญุณุงุจ ุงุฎุชุจุงุฑู ุฃูุซุฑ ุชุนููุฏูุง ุ </li></ul><br><p style=";text-align:right;direction:rtl">  ูู ุญูุซ ุณุฑุนุฉ ุงููุตูููุฉ ุฃุซูุงุก ุชุฏููุฑ ูุฑุต ูุงุญุฏ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  MIRROR + MIRROR - ุนูุฏ ุณููุท ูุญุฑู ุฃูุฑุงุต ูุงุญุฏ ุ ูููุฏุงู ุงููุฑุงุกุฉ ุงููุชูุงุฒูุฉ ููุท ูู ูุฑุขุฉ ูุงุญุฏุฉ ููุท ุ ุชุนูู ุงููุฑุขุฉ ุงูุซุงููุฉ ุฏูู ุชุฏููุฑ ุงูุฃุฏุงุก ุ </li><li style=";text-align:right;direction:rtl">  RAIDZ2 - ุงูุชุฏููุฑ ูู ุชุฏููุฑ ุงูุฃุฏุงุก ุฃุนูู ูุฃูู ูุชุทูุจ ุชุฎุตูุตูุง ููุฎูู ูููุชูุฉ ูู ุงููุฌููุน ุงูุงุฎุชุจุงุฑู ูู 1/4 ูู ุงูุจุญุซ ุนู ุงูุจูุงูุงุช + ุงููุชูุฉ ุ </li><li style=";text-align:right;direction:rtl">  RAIDZ - ุงูุชุฏููุฑ ุฃูุจุฑ ุจูุซูุฑ ุ ูุฃูู ูุชุทูุจ ุฅุนุงุฏุฉ ุญุณุงุจ ุงููุชูุฉ ูู ุงููุฌููุน ุงูุงุฎุชุจุงุฑู ูู 1/3 ูู ุงูุจุญุซ ุนู ุงูุจูุงูุงุช + ุงููุชูุฉ ุ </li></ul><br><p style=";text-align:right;direction:rtl">  ููุงุฑูุฉ ุงูุฎุตุงุฆุต ุฐุงุชูุฉ ุ ููู ูุนูุณ ุจูุง ููู ุงูููุงูุฉ ุฎูุงุฑู ูุญู ูุณุท. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุช ููุณู ุ ุนููู ุฃู ุชููู ุฃู "ุฃุจุทุฃ" ู "ุญุชู ุฃุจุทุฃ" ููุณ ูู ุจุนุถ ุงูุฃุญูุงู ุ ูููู ููุท 10-20 ูช ูู ุฃุณูุฃ ุงูุญุงูุงุช ุ ูุจุงูุชุงูู ุ ุฅุฐุง ูู ูุชู ุชุญุณูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฃู ุงูุชุทุจูู ุงูุฎุงุต ุจู ููุนูู ูุน ุงูุฃูุฑุงุต ุ ููู ุชุณูุท ุจุณุฑุนุฉ ูู ุญูุซ ุงููุจุฏุฃ ุ ูุง ุชูุงุญุธ.  ูุฌุจ ูุฑุงุนุงุฉ ุนุงูู ุณุฑุนุฉ ุงูุชุณุฌูู ููุท ุนูุฏูุง ุชุญุชุงุฌู ุญููุง. </p><br><h4 style=";text-align:right;direction:rtl">  2.0.2.  ุงูุนุฏูุฏ ูู ุงูุฃูุฑุงุต </h4><br><p style=";text-align:right;direction:rtl">  ุชููู ุงููุดููุฉ ุงูุฑุฆูุณูุฉ ูู ุฃูู ุฅุฐุง ูุงู ูุฏููุง ุงูุนุฏูุฏ ูู ุงูุฃูุฑุงุต ููุฑูุฏ ุฅูุดุงุก ูุฌููุนุฉ ูุงุญุฏุฉ ูุดุชุฑูุฉ ููู ุดูุก ุ ูุณูุญุชุงุฌ ุฅูู ูุถุน ุนูุงูุฉ ุนูู ูู ูุฑุต ุจูุทุงุน ุงูุชูููุฏ ุฃู ุนูู ุงููููู ูู ุงูุฎุฏุน ูุน ุขุฐุงููุง.  ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ุจุงููุณุจุฉ ููุฃูุธูุฉ ูุชุนุฏุฏุฉ ุงูุฃูุฑุงุต ุ ุฃุญุงูู ุจูุงุก ูุฐุง ุงูุชูููู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  2 ุฃูุฑุงุต SSD - ูููู ุจุนูู ูุณุฎุฉ ูุชุทุงุจูุฉ ููุตููู ุงูุชูููุฏ ุงูุฑุฆูุณู ูุน ูุธุงู ุงูุชุดุบูู ูุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ZFS ูุตููู ุงููุฑุต ุงูุซุงูู ุ </li><li style=";text-align:right;direction:rtl">  ูุชู ุงูุณุฏุงุฏ ุงูุจุงูู ุจุงุณุชุฎุฏุงู ุฃูุฑุงุต SATA ุฃู SAS ูุจุฏูู ุงูุนูุงูุงุช ูููู ุจุชุฌููุน ุตููู ูุฑุต ZFS ุ </li></ul><br><p style=";text-align:right;direction:rtl">  ุงูุฃูุฑ ููุณู ููุทุจู ุนูู ุงูุฎูุงุฏู ุฐุงุช ุงูุฃูุฑุงุต ุงูุฃุฑุจุนุฉ ุฅุฐุง ุฃุฑุฏูุง ุงูุญุตูู ุนูู ูุธุงู ุฃุณุงุณู ุนุงููู ุฅูู ุญุฏ ูุง ุ </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงูุช ูู ุงูุฃูุฑุงุต ูุชุดุงุจูุฉ ุ ููู ุบูุฑ ุงูููุทูู ุชุฎุตูุต ูุฑุตูู ูุตููู ูููุตู (ุนูู ุณุจูู ุงููุซุงู ุ 6 ุฃูุฑุงุต ูู ููููุง 8 ุชูุฑุงุจุงูุช ููู ููููุง) ุ ูููููู ุฌุนู ุฃูุฑุงุต ุงููุฌููุนุฉ ุงูุฃููู ูู ุงููุตูููุฉ ูุงุจูุฉ ููุชูููุฏ.  ูุฐุง ูู ุ ุฅุฐุง ููุช ุณุชููู ุจุฅูุดุงุก ุตููู ูุซู: MIRROR + MIRROR + MIRROR ุฃู RAIDZ + RAIDZ ุ ูุณูููู ุจุชุฑููุฒ ูุทุงุน ุงูุชูููุฏ ูููุฌููุนุฉ ุงูุฃููู ููุท.  ูู ุญูุซ ุงููุจุฏุฃ ุ ูู ุงููููู ุชูุณูู ูุญุฑู ุฃูุฑุงุต ูุงุญุฏ ุนูู ุงูุฅุทูุงู ุ ุญุชู ุจุงููุณุจุฉ ูู MIRROR ู RAIDZ ุ ูุงุณุชุจุฏุงู ุงูุจุงูู ูู ุดูู ุฃููู ุ ุณุชููู ZFS ุจุฅุนุฏุงุฏ ุงูุตููู ุจูุงุณุทุฉ ุงูุนูุตุฑ ุงูุฃุตุบุฑ ููุณู ุ ูููู ูู ูุฐู ุงูุญุงูุฉ ุ ุฅุฐุง ูุดู ูุญุฑู ุงูุฃูุฑุงุต ุงูุฃูู ุ ูุณุชููุฏ ูุฑุต ุงูุชูููุฏ ุงููุญูุฏ ุ ูุฐูู ูุง ูุณุชุญู ุงูููุงู ุจุฐูู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููู ุฃู ูููู ุฃู ูุธุงู ุงููููุงุช ZFS - ุดุฑูุท ููุณ RAID0 ุจุงูุถุจุท ุ ูุฃูู ูุนูู ุจุดูู ูุฎุชูู ููููุงู ููุง ูุชุทูุจ ููุณ ุฃุญุฌุงู ุงููุฑุต ุ ูุฐูู ูู ูุคุฏู ุชุฎุตูุต ูุณุงุญุฉ ุตุบูุฑุฉ ููุทุงุน ุงูุชูููุฏ ููุทูุณ ุฅูู ุงูููุงู ุจุงููุซูุฑ ุ ูุงูุดูุก ุงูุฑุฆูุณู ูู ุงูุฅุดุงุฑุฉ ุฅูู ุฃู BIOS ูู ุงููุฑุต ุงูุตุญูุญ ุงูุฐู ุณูุชู ุงูุชูููุฏ ููู . </p><br><h3 style=";text-align:right;direction:rtl">  2.1.  ุงูุชูุณูู ูุชูุธูู ุงููุฑุต </h3><br><p style=";text-align:right;direction:rtl">  ูุชู ุงุณุชุฎุฏุงู ุญุฒูุฉ mdadm ูุชูููุฒ ุงููุฑุต ููุถุนู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">apt install --yes mdadm</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุธุฑ ุฅูู ุงูุฃูุฑุงุต ุงููุชููุฑุฉ ูุฏููุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">lsblk</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชูุธูููุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sgdisk --zap-all /dev/{{ disk name }}</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  2.2.  ุชุฎุทูุท ุงููุฑุต </h3><br><p style=";text-align:right;direction:rtl">  ูู ุงููุงูุน ุ ูุณู ุงูุชูููุฏ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sgdisk -a1 -n1:34:2047 -t1:EF02 /dev/{{ disk name }}</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงููุณู ุงูุฑุฆูุณู. </p><br><blockquote style=";text-align:right;direction:rtl">  ููุง ูุฏ ูููู ููุงู ุงุฎุชูุงูุงุช: ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ุชุฎุตูุต ูุณู ุฅุถุงูู ูู ุฃูุฑุงุต SSD ุ ุนูู ุณุจูู ุงููุซุงู ุ ู ZFS Cache ุฃู Aerospike ุ ูุฃูุช ุชููู ุจุฅูุดุงุก ุงููุณู ุงูุฑุฆูุณู ูู ูุญุฏุฉ ุงูุชุฎุฒูู ุงููุญุฏูุฏุฉ: </blockquote><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sgdisk -n2:0:+100GB -t2:BF01 /dev/{{ disk name }} sgdisk -n3:0:0 -t2:BF01 /dev/{{ disk name }}</code> </pre><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ุงุณุชุฎุฏููุง ูู ุงููุณุงุญุฉ ุ ููู ููุท ุจุฅูุดุงุก ูุณู ูููุณุงุญุฉ ุงููุชุจููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sgdisk -n2:0:0 -t2:BF01 /dev/{{ disk name }}</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุง ุชูุณู ุฃู ุชุญูู ููู ุงุชุถุญ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">lsblk NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT sda 8:0 0 1.8T 0 disk โโsda1 8:1 0 1007K 0 part โโsda2 8:2 0 1.8T 0 part sdb 8:16 0 1.8T 0 disk โโsdb1 8:17 0 1007K 0 part โโsdb2 8:18 0 1.8T 0 part ...</code> </pre><br><h3 style=";text-align:right;direction:rtl">  2.3.  ุฅูุดุงุก ุตููู ZFS </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">zpool create \ -o ashift=12 \ -O atime=off \ -O canmount=off \ -O compression=lz4 \ -O checksum=fletcher4 \ -O normalization=formD \ -m legacy \ -R /mnt \ -f \ tank \ mirror \ /dev/{{ disk a part 2}} \ /dev/{{ disk b part 2}}</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ุฃูู ุฃุดุนู ุงููุงุฑ ุนูู ุฃุญุฏ ูุณุคููู ุงููุฃููู ููุฑูุง ุ ุฅูู ุนูุฏ ุฅูุดุงุก ุตููู ZFS ุ ูุฌุจ ุชุญุฏูุฏ ููุณ ูุฑุตูุง ูููู ุชูุณูููุง ุนูู ุงููุฑุต ุ ุฅุฐุง ุชู ุฅูุดุงุคู ุฎุตูุตูุง ููุฐุง ุงูุบุฑุถ. </blockquote><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ุจุงูุชุฑุชูุจ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ashift = 12 - ุงุณุชุฎุฏุงู ุญุฌู ุงููุชูุฉ ูู 4K ุ ูู ุญูุซ ุงููุจุฏุฃ ุ ูุง ุฒูุช ูุง ุฃููู ููุงุฐุง ูู ูุซูุฑ ูู ุงูุฃุญูุงู ูู ุฃูุธูุฉ ุงูุชุดุบูู ุญุฌู ุงููุชูุฉ ุงูุงูุชุฑุงุถู ูู 512 ุจุงูุช ุนูุฏูุง ูุง ุชูุฌุฏ ุนูููุง ูุซู ูุฐู ุงูุฃูุฑุงุต ุ </li><li style=";text-align:right;direction:rtl">  atime = off - ุชุนุทูู ุชุงุฑูุฎ ุชุญุฏูุซ ุงููุตูู ุฅูู ุงููููุงุช ุ ูุฃูุง ุฃุทูุฆู ุฏุงุฆููุง ูุฃููู ูู ุฃูู ุจุญุงุฌุฉ ุฅูู ูุฐู ุงููุนูููุงุช ูุทูููุง ููุง ููุฒู ุชุญููู ุงูููุงุฉ ูุฑุฉ ุฃุฎุฑู ุ </li><li style=";text-align:right;direction:rtl">  canmount = off - ุชุนุทูู ุงููุฏุฑุฉ ุนูู ุชุญููู ูุณู ุงูุฌุฐุฑ ุ </li><li style=";text-align:right;direction:rtl">  ุถุบุท = lz4 - ุชูููู ุถุบุท ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ LZ4.  ููุตู ุจุชุถููู ูุฐู ุงููุนููุฉ ููุณ ููุท ูุชูููุฑ ูุณุงุญุฉ ุนูู ุงููุฑุต ุ ูููู ุฃูุถูุง ูุชูููู ุนุฏุฏ ุนูููุงุช ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ.  ูู ุงูููุช ููุณู ุ ููุฐุง aglorhythm ุถุบุท ุ ูุงุณุชุฎุฏุงู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ููุฎูุถุฉ ููุบุงูุฉ. </li><li style=";text-align:right;direction:rtl">  ุงููุฌููุน ุงูุงุฎุชุจุงุฑู = fletcher4 - ุฎูุงุฑุฒููุฉ ุงููุฌููุน ุงูุงุฎุชุจุงุฑู ุงูุงูุชุฑุงุถู ุ ูุจุงูุชุงูู ูุฅู fletcher4 ูุณุชุญู ุงูุชุฏููู ูุฑุฉ ุฃุฎุฑู ุ </li><li style=";text-align:right;direction:rtl">  normalization = formD - ูุณุชุฎุฏู ูุชุญุณูู ุงูุนูู ูุน UTF-8 ุ ูู ุงููุงูุน ูุญุฏ ูู ุฅููุงููุฉ ุงุณุชุฎุฏุงู ุฃุณูุงุก ูููุงุช ุบูุฑ UTF-8.  ููุฑุฑ ุงูุฌููุน ููุง ุจููุณู ุ ูู ุนูููุง ูุณุชุฎุฏู ุฏุงุฆููุง ููุท ุชุฑููุฒ UTF-8 ุ </li><li style=";text-align:right;direction:rtl">  xattr = sa - ุชุณุฑูุน ุงูุนูู ูุน ุงูุณูุงุช ุงูููุณุนุฉ.  ูุง ุฃุณุชุฎุฏู ูุฐุง ุงูุฎูุงุฑ ูุธุฑูุง ูุญูููุฉ ุฃูู ุนูุฏ ุงุณุชุฎุฏุงู ูุฐุง ุงูุฎูุงุฑ ุ ูุชู ุชุนุทูู ุงูุชูุงูู ูุน ุชุทุจููุงุช OpenZFS ุงูุฃุฎุฑู (ุนูู ุณุจูู ุงููุซุงู: FreeBSD).  ูุงูุชูุงูู ูุน ูููุฏูุฒ ูุจุงูููุงุณุจุฉ ุ ุฃูุง ุจุญุงุฌุฉ ุฅูู.  ุนูุงูุฉ ุนูู ุฐูู ุ ูููู ุชูููู ูุฐุง ุงูุฎูุงุฑ ูู ุงููุณู ุงูุฃุฎูุฑ ุ </li><li style=";text-align:right;direction:rtl">  -m ุฅุฑุซ - ููุทุฉ ุงูุชุญููู ุฅูู ุฃู ููุงู ุ ููุง ุญุงุฌุฉ ูุชุฑููุจ ูุณู ุงูุฌุฐุฑ ุ </li><li style=";text-align:right;direction:rtl">  -R / mnt - ุจุงุฏุฆุฉ ุชุฑููุจ ุงููุณู ุงููุคูุช ูุชุซุจูุช ุงูููุงุฉ ุ </li><li style=";text-align:right;direction:rtl">  -f - ุฅูุดุงุก ูุฌููุนุฉ ุงูููุฉ.  ุฅุฐุง ุชู ุฌูุน ุตููู ZFS ุนูู ุงูุฃูุฑุงุต ูู ูุจู ุ ููู ูุนูู ุฃูุฑ ุฅูุดุงุก ุ ููุง ุชุนูููู ุ ุฑุจูุง ุงุฑุชูุจุช ุฎุทุฃ ูุชุฑูุฏ ูุณุญ ุงูุจูุงูุงุช ุงููููุฉ ุ </li></ul><br><blockquote style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุฃุดูุฑ ุนุงุฏุฉู ุฅูู ุงุณู ุตููู ูุฑุต ูุธุงู ุงูุฌุฐุฑ ูุฎุฒุงู ุ ุฑุบู ุฃููู ููุถููู ูู ุงูููุช ุงูุญุงูู ุงุณุชุฎุฏุงู ุงูุงุณู rpool (ุชุฌูุน ุงูุฌุฐุฑ) ูู ุจูุฆุฉ Linux.  ูู ููุงุฑุณุชู ุ ุฃุณุชุฎุฏู ุชุณููุฉ ุงููุตูููุงุช ูุฐู ุจุดูู ุนุงู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฎุฒุงู - ูุฌููุนุฉ ุงููุธุงู ุงูุฑุฆูุณู. </li><li style=";text-align:right;direction:rtl">  ุชุฎุฒูู - ูุฌููุนุฉ ุฅุถุงููุฉ ูุน ุฃูุฑุงุต ูุจูุฑุฉ ูุชุฎุฒูู ุงูุจูุงูุงุช ุ </li><li style=";text-align:right;direction:rtl">  ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช - ูุฌููุนุฉ ุฅุถุงููุฉ ูู ุฃูุฑุงุต SSD ุ ุฅุฐุง ูู ููู ุงููุณู ุงูุฑุฆูุณู ุนูููุง ุ </li></ul><br><p style=";text-align:right;direction:rtl">  ุจุดูู ุนุงู ุ ุฃูุตู ุจุดุฏุฉ ุจุชุทููุฑ ููุงุฑุณุฉ ุชุณููุฉ ุดูุก ูุง ูููู ุงูุฎูุท ููู. </p></blockquote><br><h2 style=";text-align:right;direction:rtl">  3. ุชุฑููุจ ุงููุธุงู </h2><br><h3 style=";text-align:right;direction:rtl">  3.1.  ู 3.2.  ุฅูุดุงุก ูุธุงู ูููุงุช ุงูุฌุฐุฑ </h3><br><blockquote style=";text-align:right;direction:rtl">  ุฌูุนุช ุนูู ูุฌู ุงูุชุญุฏูุฏ ุงูููุฑุงุช 3.1.  ู 3.2.  ูุฃููู ุฃุนุชูุฏ ุฃู ุชุญุฏูุฏ ูุณู ุงูุฌุฐุฑ ูู ุงููุณุชูู ุงูุซุงูุซ ูุง ูุฒูู ูู ุนูู ุงูุฅุทูุงู.  ูุฐุง ุตุญูุญ ุ ูุนุฏุฉ ุณููุงุช ูู ุงูุนูู ูุน ZFS ุ ูู ุฃูู ุจุญุงุฌุฉ ุฃุจุฏูุง ุฅูู ุฅุฌุฑุงุก ุฃู ุชูุงุนุจ ูุน ูุณู ุงูุฌุฐุฑ.  ุนูุงูุฉ ุนูู ุฐูู ุ ููุงู ุตูุฑ ููููู ุจูุง ุฅูุดุงุก ููุงุท ุชุญูู.  ูุฐูู ุ ูุณู ุงูุฌุฐุฑ ุงูุฎุงุต ุจู ูู ุงูุฎุฒุงู / ุงูุฌุฐุฑ: </blockquote><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">zfs create -o mountpoint=/ tank/root</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ูู ููุณ ุงูููุช ุ ูุชู ุงูุชุดุงู ุงูุฎุทุฃ ุงููุงุฏุญ ุงูุฃูู ูู ุงูุชุนูููุงุช ุงูุฃุตููุฉ ุ ููู ุนุฏู ูุฌูุฏ ูุณู ุชูููุฏ ูุตููู ุงูุฃูุฑุงุต: </blockquote><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">zpool <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> bootfs=tank/root tank</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  3.3.  ุฅูุดุงุก ุฃูุณุงู ุฅุถุงููุฉ </h3><br><blockquote style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ุงูุฌุฒุก ูู ุงูุชุนูููุงุช ุงูุฃุณุงุณูุฉ ุ ููููู ุฑูู ูู ุดูุก ููุณูุงูู.  ูู ุงููุงุถุญ ุฃู ุงููุงุนุจูู ุชุฌุงูุฒูุง ุงูุฃูุฑ ุจุงูุณุญู ูุงูุฎูุงุฑุงุช ุ ูููุฐุง ุงูุณุจุจ ุ ูุงู ุนููู ุฅุตูุงุญ ุดูุก ูุง.  ุตุญูุญ ุ ูู ูุณุงุนุฏ ูุซูุฑุง.  ููุฐ ุธููุฑ ุงููุดุงูู ุงููุงุญูุฉ ูุฑุฉ ุฃุฎุฑู ููู ุงูููุงูุฉ ุงุชุถุญ ุฃู ูู ูุฐุง ูุง ูุนูู ุ ูุฐูู ุ ูู ุงูููุฑุฉ 4.11.  ุชู ุชุตุญูุญ ูุฐุง ูุฑุฉ ุฃุฎุฑู. </p><br><p style=";text-align:right;direction:rtl">  ูุจุฏู ูุตู ูุณู ูููุตู ุนู / var / games ููุญูููุง ุชูุงููุง.  ุฃูุง ูุง ุฃูุงูุน ุ ูููู ูู ุงููุงุถุญ ุฃู ูุฐุง ูุซูุฑ ููุบุงูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุญูููุฉ ุฃู ูุชู ุฅูุดุงุก ุฃูุณุงู ูู ZFS ุจุจุณุงุทุฉ ูุฏุนู ุงูุชุณูุณู ุงููุฑูู ูุง ูุนูู ุฃูู ููุจุบู ุงูุชุฎูู ุนู ุงูุฏูุงุฆู ุงูููุงุณูููุฉ.  ูุซุงู ุจุณูุท: ุฐุงุช ูุฑุฉ ูุงู ูุฏู ุฃูุซุฑ ูู 4K ZFS ูู ุฃูุณุงู ูุฌููุนุฉ ุงูุฎูุงุฏู ุ ูุงู ุฐูู ุถุฑูุฑููุง ุ ูููู ุชุจุงุทุฃ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู ูุนุฏุฉ ุฏูุงุฆู ุจุณุจุจ ุชุฑููุจ ูุฐู ุงูุฃูุณุงู. </p></blockquote><br><p style=";text-align:right;direction:rtl">  ููุจุฏุฃ ูุน ูุงุฆุญุฉ ูุธููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููุงู ุฃูุณุงู ููู ุซุงุจุช ูุฏููุงูููู. </p><br><p style=";text-align:right;direction:rtl">  ุชุชุถูู ุฃูุณุงู ุงููููุงุช ุงูุซุงุจุชุฉ ุฃูุณุงููุง ุชุญุชูู ุนูู ุจุฑุงูุฌ ูุฅุนุฏุงุฏุงุชูุง ุ ููุชู ููุคูุง ูุฑุฉ ูุงุญุฏุฉ ููุง ุชุชุบูุฑ ุฃุซูุงุก ุงูุชุดุบูู.  ูู ุงูููุช ููุณู ุ ุชู ุชูุณูู ุงูุฃูุณุงู ุงูุซุงุจุชุฉ ุงูุณุงุจูุฉ ุฅูู ุฃูุณุงู ุงููุธุงู ูุงููุณุชุฎุฏููู (/ usr) ุ ูููู ูู ุงูููุช ุงูุญุงูู ูุชู ุฎูุทูุง ูู ุฃูุธูุฉ ุชุดุบูู Linux ููุง ููุฌุฏ ุฃู ูุนูู ููุตููุง ุ ููู ููุฌุญ ุงูุฃูุฑ. </p><br><p style=";text-align:right;direction:rtl">  ุชุดุชูู ุฃูุณุงู ุงููููุงุช ุงูุฏููุงููููุฉ ุนูู ุฃูุณุงู ูุชู ุชุฎุฒูููุง ูููุง: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุจูุงูุงุช ุงููุคูุชุฉ - ููุงูุฆ: tmp ุ ูุจุงุฏูุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุณุฌูุงุช ุงูุนูู - ููุงูุฆ: var / logุ </li><li style=";text-align:right;direction:rtl">  ุจูุงูุงุช ุงููุณุชุฎุฏู - ููุงูุฆ: homeุ </li><li style=";text-align:right;direction:rtl">  ุงูุจูุงูุงุช - ููุงูุฆ: var / db ูููู ูุญุงููู ุงูุญุธ ุ </li><li style=";text-align:right;direction:rtl">  ูุชุงุฆุฌ ุงูุจุฑูุงูุฌ ุงูุฃุฎุฑู ูู ุดูู ูููุงุช. </li></ul><br><p style=";text-align:right;direction:rtl">  ูู ุนุงุฆูุงุช Linux ุ ุชุชุถูู ุงูุฃูุณุงู ุงูุฏููุงููููุฉ / tmp ู / var ุ ููู ูุฐุง ุบูุฑ ุฏููู ุ ูุธุฑูุง ูุฃููุง ูููู ุฃู ุชุฏุฎู / var / lib ุ ุงูุจุฑุงูุฌ ูุงูููุชุจุงุช ุ ุจุดูู ุนุงู ุ ูู ุดูุก ูุฎุชูุท ุ ููู ูุน ุฐูู ... </p><br><p style=";text-align:right;direction:rtl">  ุชุญุชุงุฌ ุฃููุงู ุฅูู ุชุญุฏูุฏ ูุง ุฅุฐุง ููุช ุชุฑูุฏ ุฅูุดุงุก ูุณู / tmp ุนูู ุงููุฑุต ุฃู ูู ุงูุฐุงูุฑุฉ ูู tmpfs.  ุฅุฐุง ุฃูุดุฃูุง ุนูู ุงููุฑุต ุ ููู ุจุฅูุดุงุก ูุณู ูููุตู ูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">zfs create -o mountpoint=legacy tank/tmp</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ุฎูุงุฑุงุช com.sun: ููุทุฉ ุชููุงุฆูุฉ = setuid false = ูุง ุชุนูู ุจุดูู ุฌูุฏ ุ ุจุบุถ ุงููุธุฑ ุนู ููููุฉ ุนูู ุงูุทูุณ ุ ูุง ุชุนูุฏ.  ูููู ูุน SWAP ุณููุนู ูุงุญููุง ูู ุงูุฎุทูุฉ 7. </blockquote><br><p style=";text-align:right;direction:rtl">  ุงูุตู ูุณู var ุจุดูู ูููุตู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">zfs create -o mountpoint=legacy tank/var</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฃูุณุงู ุงููุณุชุฎุฏู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">zfs create -o mountpoint=/home tank/home zfs create -o mountpoint=legacy tank/home/root</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ูู ุงูููุทูู ุชุฎุตูุต ุฃูุณุงู ุงููุณุชุฎุฏู ุ ูุธุฑูุง ูุฃูู ูู ุงููุงุญูุฉ ุงูุนูููุฉ ูุชู ุงูุณุฏุงุฏูุง ุจุดูู ุฏูุฑู ุจูุตููุนุงุช ูุฎุชููุฉ ููุชุณููู ูุฑุงูุจุชูุง ุ ูู ุงูุฃูุถู ุฅูุดุงุก ุฃูุณุงู ูููุตูุฉ ููู ุ ููุฐูู ุงูุฏููู ุงูุฑุฆูุณู ููุณุชุฎุฏู ุงูุฌุฐุฑ (ุฎุงุตุฉ ุจุงููุณุจุฉ ูุฃููุฆู ุงูุฐูู ูุญุจูู ุงูุนูู ูุฌุฐุฑ).  ูุง ูุณุงุนุฏ ุงุณุชุฎุฏุงู ุงูุญุตุต ุงููุณุจูุฉ ุนูู ุฏูุงุฆู ุงููุณุชุฎุฏู ูู ุงูุณุฏุงุฏ ูุณุงุญุฉ ุงููุฑุต ูุญุณุจ ุ ุจู ูุณุงุนุฏ ุฃูุถูุง ุนูู ุงูุชุฏุงุฎู ุ ูุฃูู ูู ูุซู ูุฐู ุงูุญุงูุงุช ุ ูุจุฏุฃ ุงููุณุชุฎุฏููู ูู ุชุฑู ุงููุทุน ุงูุฃุซุฑูุฉ ูู ุฃู ููุงู ููุฏ ูููู ูู ุงูุตุนุจ ุฌุฏูุง ุงูุนุซูุฑ ุนูููุง ูุงุญููุง.  ูุง ูุชู ูุนุงูุฌุฉ ูุฐุง ุงูุฃูุฑ ุ ูุฐูู ุชุญุชุงุฌ ููุท ุฅูู ุงูุชุญูู ูุถุฑุจ ุงูุฃูุฏู. </blockquote><br><p style=";text-align:right;direction:rtl">  ูุชู ุฅุฏุฑุงุฌ ุฏุจุงุจุฉ ููุทุฉ ุงูุชุญููู / ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ / ุงูุฌุฐุฑ ูุฅุฑุซ ุ ูููุณ ูุฌุฐุฑ /.  ูุฐุง ุตุญูุญ ุ ุญูุซ ูุชู ุชุฑููุจ ูุฐุง ุงููุณู ูู ุงููุณู 4.11 </p><br><p style=";text-align:right;direction:rtl">  ูุญู ุงูุขู ุจุญุงุฌุฉ ุฅูู ุชุฑููุจ ุฃูุณุงููุง ุงูุฏููุงููููุฉ ูุคูุชูุง ูู / mnt: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /mnt/ mkdir var tmp root mount -t zfs tank/var /mnt/var/ mount -t zfs tank/tmp /mnt/tmp/ mount -t zfs tank/home/root /mnt/root/</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  3.4 ุชุซุจูุช ุงูููุงุฉ </h3><br><blockquote style=";text-align:right;direction:rtl">  ูู ุงูุฅุฑุดุงุฏุงุช ุงูุฑุฆูุณูุฉ ุ ููุฌุฏ ุฃูุฑุงู ูุง ูุฒูู ูููุง ุ ููุญู ูุง ูููู ุงูุชูุงููุง ุ ููุจุฏู ุฃูููุง ูู ุงูุชุฌุงุฑุจ: </blockquote><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">debootstrap bionic /mnt</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชูุฌุฉ ูุฐูู ุ ูุฌุจ ุฃู ุชุญุตู ุนูู ุดูุก ูุซู ูุฐุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">zfs list NAME USED AVAIL REFER MOUNTPOINT tank 213M 1.76T 96K legacy tank/home 208K 1.76T 96K /mnt/home tank/home/root 112K 1.76T 112K legacy tank/root 147M 1.76T 147M /mnt tank/tmp 96K 1.76T 96K legacy tank/var 64.6M 1.76T 64.6M legacy</code> </pre><br><p style=";text-align:right;direction:rtl">  ุญุฌู ุงููุณู 96K ุงููุงุฑุบ ุ ุนูู ุงูุชูุงูู ุ ุจูู ููุท ุงูุฎุฒุงู / tmp ูุงุฑุบูุง ุ ูุชู ุชุณุฌูู ุงูุจุงูู ุฃุซูุงุก ุชุซุจูุช kernel ุ ููุง ูุนูู ุฃูู ุชู ุชุฑููุจ ุงูุฃูุณุงู ุจุดูู ุตุญูุญ. </p><br><h2 style=";text-align:right;direction:rtl">  4. ุชูููู ุงููุธุงู </h2><br><h3 style=";text-align:right;direction:rtl">  4.1.  ุชูููู ุงููุถูููู ูุงุณู ุงููุถูู </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> HOSTNAME &gt; /mnt/etc/hostname <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> โ127.0.0.1 localhostโ &gt; /mnt/etc/hosts <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> โ127.0.0.1 HOSTNAMEโ &gt;&gt; /mnt/etc/hosts</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  4.2.  ุชูููู ูุงุฌูุฉ ุงูุดุจูุฉ </h3><br><blockquote style=";text-align:right;direction:rtl">  ูุนู ุ ูุฏููุง ุจุงููุนู ุฎุทุฉ ููุง: </blockquote><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">nano /mnt/etc/netplan/setup.yaml network: version: 2 renderer: networkd ethernets: eno2: dhcp4: no dhcp6: no addresses: [ {{ IP }}/{{ netmask }}, ] gateway4: {{ gateway IP }} nameservers: addresses: [8.8.8.8]</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  4.3.  ุชูููู ูุณุชูุฏุนุงุช ููุงุฆูุฉ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">nano /mnt/etc/apt/sources.list deb http://archive.ubuntu.com/ubuntu/ bionic main restricted universe deb http://security.ubuntu.com/ubuntu/ bionic-security main restricted universe deb http://archive.ubuntu.com/ubuntu/ bionic-updates main restricted universe</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  src - ููุณุช ููุงู ุญุงุฌุฉ ูู ุงูุบุงูุจ </blockquote><br><h3 style=";text-align:right;direction:rtl">  4.4.  ูุญู ุชุฑููุจ ุฃูุณุงู ุงููููุงุช ุงูุงูุชุฑุงุถูุฉ ูุฑุต ุญู ู "ุงูุฐูุงุจ" ุฅูู ุงููุธุงู ุงูุฌุฏูุฏ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mount --rbind /dev /mnt/dev mount --rbind /proc /mnt/proc mount --rbind /sys /mnt/sys chroot /mnt /bin/bash --login</code> </pre><br><blockquote style=";text-align:right;direction:rtl">  ูุทููุจ ูุงุณุชุฎุฏุงู - rbind ุ ูููู ููุณ - ุฑุจุท </blockquote><br><p style=";text-align:right;direction:rtl">  ูุญู ุจุงููุนู ูู ุงููุธุงู ุงูุฌุฏูุฏ ... </p><br><h3 style=";text-align:right;direction:rtl">  4.5.  ุฅุนุฏุงุฏ ุงูุจูุฆุฉ ุงูุฃุณุงุณูุฉ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">ln -s /proc/self/mounts /etc/mtab chmod 1777 /tmp apt update</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงููุบุฉ ูุงูููุช: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">dpkg-reconfigure locales * en_US.UTF-8 * ru_RU.UTF-8 dpkg-reconfigure tzdata</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุงููุญุฑุฑูู ุงูุฅุถุงูููู ุงูุฐูู ูุญุจูู ูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">apt install --yes vim nano</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  4.6.  ุชุซุจูุช ุฏุนู ZFS </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">apt install --yes --no-install-recommends linux-image-generic apt install --yes zfs-initramfs</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  4.8.  ุชุซุจูุช ูุญูู ุงูุฅููุงุน </h3><br><p style=";text-align:right;direction:rtl">  ููุง ุฐูุฑ ุณุงุจููุง ุ ุฃุณุชุฎุฏู MBR ูุฏูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">apt install --yes grub-pc</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ุฃุซูุงุก ุชุซุจูุช ุฃุฏุงุฉ ุชุญููู ุงูุชุดุบูู ุ ูุฌุจ ุชุญุฏูุฏ ูู ุงูุฃูุฑุงุต ุงูุชู ุญุฏุฏูุงูุง ุนูู ุฃููุง ูุงุจูุฉ ููุชูููุฏ ุ ุจูููุง ููุณู ุงููุซุจุช ุนูู ูุงูุฉ ุงูุฃูุฑุงุต ุงูุฃุฎุฑู ุจุงุณุชุซูุงุก ุงููุฑุต ุงูุฃูู ุ ูุญู ูุชูู ููููุฐ ุงูุฎุทูุฉ 5 (ููุณ ูู ุงููุงุถุญ ุณุจุจ ุชุฑู ุงูุจุงูู ูู ููุช ูุงุญู): </blockquote><br><h4 style=";text-align:right;direction:rtl">  4.8.1.  (5.1) ุชุญูู ูู ุงูุชุนุฑู ุนูู ูุธุงู ุงููููุงุช ุงูุฌุฐุฑ: </h4><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">grub-probe / zfs</code> </pre> <br><h4 style=";text-align:right;direction:rtl">  4.8.2.  (5.2) ุชุญุฏูุซ initrd </h4><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">update-initramfs -u -k al</code> </pre> <br><h4 style=";text-align:right;direction:rtl">  4.8.3.  (5.3) ุชุจุณูุท ุชุตุญูุญ ุงููุฑูุฉ </h4><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">vi /etc/default/grub ... GRUB_CMDLINE_LINUX_DEFAULT=<span class="hljs-string"><span class="hljs-string">""</span></span> GRUB_CMDLINE_LINUX=<span class="hljs-string"><span class="hljs-string">"console"</span></span> ...</code> </pre><br><h4 style=";text-align:right;direction:rtl">  4.8.4.  (5.4.) ุชุญุฏูุซ ุชูููู ุฃุฏุงุฉ ุชุญููู ุงูุชุดุบูู </h4><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">update-grub</code> </pre> <br><h4 style=";text-align:right;direction:rtl">  4.8.5.  (5.5.) ูู ุจุชุซุจูุช ุฃุฏุงุฉ ุชุญููู ุงูุชุดุบูู ุนูู ูู ูุฑุต ุชู ุชูููุฒู ุนูู ุฃูู ูุงุจู ููุชูููุฏ </h4><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">grub-install /dev/sda grub-install /dev/sdb ...</code> </pre><br><blockquote style=";text-align:right;direction:rtl">  ูู ุงูููู ุฃู ุชุนูู ูุฐู ุงูุฃูุงูุฑ ุจุดูู ุตุญูุญ.  ููู ุฃููู ุฃููููุง ุ ูู ุฃุชููู ูู ุงูุญุตูู ุนูู ุงูุนูุณ ูุฑุฉ ูุงุญุฏุฉ ุนูู ุงูุฃูู ุ ูุฐูู ูุง ุฃุนุฑู ูุงุฐุง ุฃูุนู ุ ูููู ุนูู ุงูุฃุฑุฌุญ ุ ุฅุฐุง ูุงู ูุฏูู ุฎุทุฃ ุ ููู ุงููุญุชูู ุฃูู ุงุฑุชูุจุช ุฎุทุฃู ุนูุฏ ูุถุน ุนูุงูุฉ ุนูู ุงููุฑุต (ุงููุณู 2.2). </blockquote><br><h4 style=";text-align:right;direction:rtl">  4.8.6.  (5.6.) ุชุญูู ูู ุชุซุจูุช ูุญุฏุฉ ZFS </h4><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">ls /boot/grub/*/zfs.mod /boot/grub/i386-pc/zfs.mod</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  4.10.  ุชุนููู ูููุฉ ูุฑูุฑ ุงูุฌุฐุฑ (ุงูุซุงุจุช!) </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">passwd</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ููุนู ุ ุณูููู ุจุชุซุจูุช opensh ุนูู ุงูููุฑ ุ ูุฅูุง ูุณููุงุฌุฃ ุจุนุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู ุฅุฐุง ุนูููุง ุนู ุจูุนุฏ: </blockquote><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">apt install --yes openssh-server</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุง ุชูุณ ุชุตุญูุญ ุงูุชูููู sshd: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">vi /etc/ssh/sshd_config ... PermitRootLogin yes ... PasswordAuthentication yes ...</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  4.11.  ุฅุตูุงุญ ุฃูุธูุฉ ุงููููุงุช ุฌุจู </h3><br><blockquote style=";text-align:right;direction:rtl">  ููุง ูุตููุง ุฅูู ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู.  ูู ุงูุญูููุฉ ุ ูุชู ุชุซุจูุช ุฃูุณุงู ZFS ุจุนุฏ ุจุฏุก ุจุนุถ ุงูุดูุงุทูู (ููุง ุฃุซุฑูุง ุฃูุถูุง ุนูู ZFS_INITRD_ADDITIONAL_DATASETS ูู / etc / default / zfs) ุ ูุงูุชู ุจุฏูุฑูุง ุชููู ุจุฅูุดุงุก ุจุนุถ ุงูุจููุฉ ุงูุฎุงุตุฉ ุจูุง / var ุชุจุฏุฃ ูู ููุก ุณุฌูุงุช ุงููุธุงู.  ุนูุฏูุง ูุญูู ุงูููุช ูุชุฑููุจ ุฃูุณุงู ZFS ุ ุงุชุถุญ ุฃู ููุงุท ุงูุชุญููู ููุณุช ูุงุฑุบุฉ ููุง ุดูุก ูุชุตุงุนุฏ ุ ุงูุจูุงูุงุช ูุจุนุซุฑุฉ ุ ูู ุดูุก ุณูุก.  ูุฐูู ุ ุชุญุชุงุฌ ุฅูู ุชุญุฏูุฏ ููุงุท ุงูุชุญููู ูู / etc / fstab ูุฃู systemd ูุฑูุฒ ุนูููุง ุจุดูู ุฃุณุงุณู ุนูุฏ ุงููุตูู ุฅูู ุงููุฌูุฏ: </blockquote><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">vi /etc/fstab tank/var /var zfs noatime,nodev 0 0 tank/tmp /tmp zfs noatime,nodev 0 0 tank/home/root /root zfs noatime,nodev 0 0</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ุงูุจุงูู ูุชุฑูู ููููุฑุฉ 6.  ูุนูุช ุจุงููุนู </blockquote><br><h2 style=";text-align:right;direction:rtl">  6. ุฅุนุงุฏุฉ ุงูุชูููุฏ ุงูุฃูู </h2><br><h3 style=";text-align:right;direction:rtl">  6.1.  ุงูุชูุงุท ุตูุฑุฉ ูููุณู ุงูุฌุฐุฑ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">zfs snapshot tank/root@setup</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ูุง ููุฌุฏ ุฃู ูุนูู ููู ุ ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ูู ุฃูู ูุฏ ุงูุชุฒุช ูุณู ุงูุฌุฐุฑ ูููุธุงู ููู ุฃุณุชุฎุฏู ูุท ููุทุงุช ูู ูุฐุง ุงููุณู ุ ููู ูุน ุฐูู ุฏุนู ููุฐุจ ุ ููุฏ ูููู ูููุฏูุง </blockquote><br><h3 style=";text-align:right;direction:rtl">  6.2.  ุฎุฑูุฌ chroot </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">exit</span></span></code> </pre> <br><h3 style=";text-align:right;direction:rtl">  6.3.  ูู ุจุฅูุบุงุก ุชุซุจูุช ุฃูุณุงู ูุฑุต ุญู ูุชุตุฏูุฑ ูุฌููุนุฉ ZFS </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> mount | grep -v zfs | tac | awk <span class="hljs-string"><span class="hljs-string">'/\/mnt/ {print $3}'</span></span> | xargs -i{} umount -lf {} umount /mnt/root umount /mnt/var umount /mnt/tmp zpool <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> tank</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ุชุตุฏูุฑ ูุฌููุนุฉ ุงูุฃูุฑุงุต ุงููุทููุจุฉ ููุณุญ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช zfs </blockquote><br><h3 style=";text-align:right;direction:rtl">  6.4 ุฅุนุงุฏุฉ ุงูุชุดุบูู </h3><br><blockquote style=";text-align:right;direction:rtl">  ุชุชู ุฅุนุงุฏุฉ ุงูุชุดุบูู ุจุดูู ุฃูุถู ูู ูุญุทุฉ ูุฑุต ุญู ุ ุญูุซ ุฅุฐุง ููุช ุชุนูู ูู ุฎูุงู ุนููู ssh ุ ูุฅู ุฅุนุงุฏุฉ ุงูุชุดุบูู ูู ุฎูุงูู ูููู ุฃู ูุคุฏู ุฅูู "ุชุฌููุฏ" ุงูุฎุงุฏู. </blockquote><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">reboot</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ููุน ุฐูู ุ ุฅุฐุง ุญุฏุซ ุฎุทุฃ ูุง ููู ูุฐูุจ ุงูุฎุงุฏู ุฅูู ุฅุนุงุฏุฉ ุงูุชุดุบูู ุ ูููููู ุฅุนุงุฏุฉ ุงูุชุดุบูู ุจุฃู ุทุฑููุฉ ุ ุญูุซ ูุชู ุชุตุฏูุฑ ุตููู ZFS ููู ุงูุตุนุจ ุฅุชูุงูู. </blockquote><br><h3 style=";text-align:right;direction:rtl">  6.5.  ูุญู ููุชุธุฑ ุฅุนุงุฏุฉ ุงูุชุดุบูู ููุฐูุจ ุฅูู ุงูุฌุฐุฑ </h3><br><h3 style=";text-align:right;direction:rtl">  6.6.  ุฅูุดุงุก ุญุณุงุจ ุงููุณุชุฎุฏู ุงูุฎุงุต ุจู </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">zfs create tank/home/{{ LOGIN }} useradd -u {{ UID }} -G adm,sudo -d /home/{{ LOGIN }}/ -s /bin/bash {{ LOGIN }} cp -a /etc/skel/.[!.]* /home/{{ LOGIN }} chown -R {{ LOGIN }}:{{ LOGIN }} /home/{{ LOGIN }}</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃุถู ููุชุงุญ ssh ุงูุนุงู ุฅูู ุงููุณุชุฎุฏู ูุงุถุจุท ูููุฉ ุงููุฑูุฑ ูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">su - {{ LOGIN }} mkdir .ssh chmod 0700 .ssh vi .ssh/authorized_keys <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> passwd {{ LOGIN }}</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ูู OpenSSH ูุฒูู ุงููุฏุฑุฉ ุนูู ุชุณุฌูู ุงูุฏุฎูู ููุตุงุฏูุฉ ุงูุฌุฐุฑ ููููุฉ ุงููุฑูุฑ: </blockquote><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">vi /etc/ssh/sshd_config ... PermitRootLogin no ... PubkeyAuthentication yes ... PasswordAuthentication no ... service ssh restart</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  6.7.  6.8.  ูู ูุนุฏ ูุทููุจุง </h3><br><h2 style=";text-align:right;direction:rtl">  7. ุชูููู ุงููุจุงุฏูุฉ </h2><br><h3 style=";text-align:right;direction:rtl">  7.1.  ุฅูุดุงุก ูุณู ZFS </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">zfs create \ -V 32G \ -b $(getconf PAGESIZE) \ -o compression=<span class="hljs-built_in"><span class="hljs-built_in">zle</span></span> \ -o logbias=throughput \ -o sync=always \ -o primarycache=metadata \ -o secondarycache=none \ tank/swap</code> </pre> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  -V 32G - ุญุฌู SWAP ูุฏููุง ุ ููููู ุชุญุฏูุฏ ูุง ูู ูุทููุจ ุจุงููุนู ุ </li><li style=";text-align:right;direction:rtl">  -b $ (getconf PAGESIZE) - ุญุฌู ุงููุชูุฉ (4K ูุน ashift = 12) ุ </li><li style=";text-align:right;direction:rtl">  compression = zle - ุงุฎุชุฑ ุฎูุงุฑุฒููุฉ ุงูุถุบุท ุงูุฃูู ูู ุญูุซ ุงุณุชููุงู ุงูููุงุฑุฏ ุ ูุธุฑูุง ูุฃู ุญุฌู ุงููุชูุฉ ูู ุงููุงูุน 4 ูููู ุจุงูุช ุ ูุฅู ุงูุถุบุท ุนูู ูุฐุง ุงููุญู ูู ูุณูุญ ุจุงุณุชุฎุฏุงู ูุฏุฎูุงุช ุงููุฎุฑุฌุงุช ุ ููู ุณูููู ูู ุงููููู ุญูุธูุง ุนูู ูุชู ุงูุตูุฑ ุ </li><li style=";text-align:right;direction:rtl">  logbias = ุณุฑุนุฉ - ุถุจุท ุงููุทุงู ุงูุชุฑุฏุฏู ูุชุญุณูู ุงูุนูููุงุช ุงููุชุฒุงููุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุชุฒุงูู = ุฏุงุฆูุง - ุฏุงุฆูุง ูุฒุงููุฉ ุงูุณุฌู.  ูุฐุง ูููู ุจุดูู ุทููู ูู ุงูุฃุฏุงุก ุ ูููู ูุถูู ุชูุงููุง ููุซูููุฉ ุงูุจูุงูุงุช ุ </li><li style=";text-align:right;direction:rtl">  primarycache = ุจูุงูุงุช ุงูุชุนุฑูู - ุจูุงูุงุช ุชุนุฑูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููุท ุ ุญูุซ ูู ูุชู ุงุณุชุฎุฏุงู ุงููุจุงุฏูุฉ ููุฑุงุกุฉ ุงููุชูุฉ ููุณูุง ุนุฏุฉ ูุฑุงุช ุ </li><li style=";text-align:right;direction:rtl">  secondarycache = ุจูุง - ุชุนุทูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงูุซุงูููุฉ ุชูุงููุง ููุฃุณุจุงุจ ุงููุฐููุฑุฉ ุฃุนูุงู ุ </li></ul><br><h3 style=";text-align:right;direction:rtl">  7.2.  ูู ุจุฅุนุฏุงุฏ ูุณู ุงููุจุงุฏูุฉ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mkswap -f /dev/zvol/tank/swap <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> /dev/zvol/tank/swap none swap defaults 0 0 &gt;&gt; /etc/fstab <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> RESUME=none &gt; /etc/initramfs-tools/conf.d/resume</code> </pre><br><h3 style=";text-align:right;direction:rtl">  7.3.  ุจุฏูุฑู ุนูู ุงููุจุงุฏูุฉ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">swapon -av</code> </pre> <br><blockquote style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุนูุงูุฉ ุนูู ุงูุชุนูููุงุช ุ ููุงู ุงููููู ูู ุงูุงูุชูุงู ุ ูุฃูู ูุนุชูุฏ ุจุดุฏุฉ ุนูู ุชูุถููุงุช ูุณุคูููู ูุนูููู ูููุงู ุงูุฎุงุฏู ููู ุ ุจุงุณุชุซูุงุก ููุทุฉ ูุงุญุฏุฉ ุ ููู: "ุงูุชูููุฏ ูู ุญุงูุงุช ุงูุทูุงุฑุฆ" </p><p style=";text-align:right;direction:rtl">  ููุง ุชูุณู ุฃู ุชุถุน ุฌุฏุงุฑ ุงูุญูุงูุฉ </p></blockquote><br><h2 style=";text-align:right;direction:rtl">  ุฑ ุงูุชูููุฏ ูู ุญุงูุงุช ุงูุทูุงุฑุฆ </h2><br><p style=";text-align:right;direction:rtl">  ูุญู ูุณุชุนุฏ ุจูุฆุฉ ุงูุชุซุจูุช (ุงูุจูุฏ 1.) </p><br><p style=";text-align:right;direction:rtl">      ZFS ,    ,     : </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">zpool <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> -a zpool import -N -R /mnt tank zfs mount -a</code> </pre> <br><blockquote style=";text-align:right;direction:rtl"> , ,      ,        fstab,    : </blockquote><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mount -t zfs tank/var /mnt/var/ mount -t zfs tank/tmp /mnt/tmp/ mount -t zfs tank/home/root /mnt/root/</code> </pre> <br><p style=";text-align:right;direction:rtl"> ,   ,   chroot   .4.4.,          . 6.3. </p><br><h2 style=";text-align:right;direction:rtl"> D.   </h2><br><p style=";text-align:right;direction:rtl">   3.3.             .      ,        : ,       /spool,      /data.       ZFS     . </p><br><h2 style=";text-align:right;direction:rtl">  ููุฎุต </h2><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">       ZFS  ,     ,     ; </li><li style=";text-align:right;direction:rtl">        ZFS,                 ,     .    ZFS โ       ,   ; </li><li style=";text-align:right;direction:rtl">      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">.</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar439860/">https://habr.com/ru/post/ar439860/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar439850/index.html">ุงููุดู ุนู ุงููุดุงุนุฑ ูู ุงูุณูุงู ูู ุงููุญุงุฏุซุงุช ุงููุตูุฉ ุจุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ</a></li>
<li><a href="../ar439852/index.html">ุฅุตุฏุงุฑ ุชุทุจูู ุงูุชุญูู ุนู ุจุนุฏ: Aspia 1.1.0</a></li>
<li><a href="../ar439854/index.html">ุฅูู ุ ูุงุญุฏ ุ ูุฑุฉ ุฃุฎุฑู: ูุง ูุฌุจ ุงูููุงู ุจู ูุน ุนููู ูู CRM ุจุนุฏ ุฃู ุงุดุชุฑู</a></li>
<li><a href="../ar439856/index.html">ูุงูุฏูุณ! ุดูุฑุง ูุฃูุจุฑ</a></li>
<li><a href="../ar439858/index.html">Prometheus + Grafana + Node Exporter + Docker in Azure ูุน ุงูุฅุฎุทุงุฑุงุช ูู Telegram</a></li>
<li><a href="../ar439862/index.html">ุงูุฃุญุฏุงุซ ุงูุฑูููุฉ ูู ููุณูู ูู ุงููุชุฑุฉ ูู 11 ุฅูู 17 ูุจุฑุงูุฑ</a></li>
<li><a href="../ar439864/index.html">ุฅุฏุงุฑุฉ ุงููุนุฑูุฉ ุ ููุงุฐุง ูููู ูููุง ุจุฐูู</a></li>
<li><a href="../ar439866/index.html">ูุจุงุฏุฆ ุชุตููู ุฃุฏูุฉ ุงูุฏูุงุฆู ูู 1C Enterprise Management 2 (ERP 2.4.6)</a></li>
<li><a href="../ar439868/index.html">ุงูุญูุงุฉ ุจุฏูู Facebook: ุขุฑุงุก ุฃูู ุชุทุฑููุง ุ ูุฒุงุฌ ุฌูุฏ ุ ุงููุฒูุฏ ูู ุงูููุช ููุฃุญุจุงุก. ุซุจุช ุงูุขู ูู ูุจู ุงูุนูู</a></li>
<li><a href="../ar439870/index.html">ุงูููุฏูู ููุญุฑู ููุชูุฏู: ุชุทูุฑ ุฃูุธูุฉ ุงููุฑุงูุจุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>