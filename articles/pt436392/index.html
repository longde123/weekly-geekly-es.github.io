<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìã üåê üï¶ Benef√≠cios da an√°lise de aplicativos de n√≠vel 7 em firewalls. Parte 1. No√ß√µes b√°sicas üòû üë®üèæ‚Äçü§ù‚Äçüë®üèª üë©üèº‚Äçü§ù‚Äçüë®üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A nova gera√ß√£o de firewalls √© mais conveniente e segura, gra√ßas √† nova arquitetura de mecanismo e √† nova ideologia de gerenciamento de fluxos de rede....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Benef√≠cios da an√°lise de aplicativos de n√≠vel 7 em firewalls. Parte 1. No√ß√µes b√°sicas</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436392/"><img src="https://habrastorage.org/getpro/habr/post_images/786/9e4/d4e/7869e4d4eac6b07b8bfa763cb3985347.png"><br>  A nova gera√ß√£o de firewalls √© mais conveniente e segura, gra√ßas √† nova arquitetura de mecanismo e √† nova ideologia de gerenciamento de fluxos de rede. <br><h3>  Por que este artigo apareceu? </h3><blockquote>  Repetidamente, vi colegas de seguran√ßa que usam uma nova gera√ß√£o de firewalls e viram que continuam a escrever regras sobre n√∫meros de portas.  Por sugest√£o de continuar escrevendo pelo nome dos aplicativos, ouvi "E se n√£o funcionar assim?".  Se voc√™ tamb√©m est√° "assustado" ou n√£o est√° claro por que escrever as regras para aplicativos, este artigo √© para voc√™. </blockquote><br><a name="habracut"></a><br><h1>  PARTE 1. No√ß√µes b√°sicas de firewall </h1><br><h3>  CONTE√öDO </h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1. Introdu√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Defini√ß√µes</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Firewall</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Firewall L3</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Firewall L4</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Firewall L7</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">UTM</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NGFW</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Exemplos</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Servidor proxy</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O que √© USER-ID</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Equ√≠vocos sobre Inspe√ß√£o com Estado: Estado L4 vs L7</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Equ√≠vocos sobre Inspe√ß√£o com Estado: N√∫mero de Sess√µes L4 vs L7</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Equ√≠vocos sobre Inspe√ß√£o com Estado: L4 Cluster vs L7</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2. Impacto na seguran√ßa do firewall L7</a> <br><br><a name="Intro"></a><h2>  1. Introdu√ß√£o </h2><br>  O Skype, o TOR, o Ultrasurf, o TCP-over-DNS e v√°rias centenas de aplicativos e t√∫neis passam silenciosamente pelo firewall de inspe√ß√£o do estado e pelos proxies HTTP.  Muitas prote√ß√µes abrem conex√µes, mas n√£o verificam o que est√° dentro delas.  Proponho descobrir como controlar as conex√µes de aplicativos em uma nova gera√ß√£o de firewall de maneira controlada, onde as regras s√£o escritas pelos nomes dos aplicativos, o que corresponde ao n√≠vel 7 do modelo OSI ISO.  Esses firewalls s√£o chamados de Next Generation Firewall, uma nova gera√ß√£o de firewalls ou simplesmente NGFW. <br><blockquote>  O administrador do firewall precisa n√£o apenas permitir a conex√£o, mas tamb√©m garantir que o que voc√™ deseja esteja dentro da conex√£o permitida, incluindo a verifica√ß√£o dos arquivos transferidos.  Isso √© chamado de <b>permiss√£o de aplicativo seguro</b> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9b2/d52/1e2/9b2d521e2806d725232f208f318014fb.jpg"></blockquote>  Existem v√°rias diferen√ßas importantes no trabalho com tr√°fego, que voc√™ entende apenas quando muda para o uso real de regras, em que o crit√©rio √© a aplica√ß√£o do n√≠vel 7 do modelo ISO OSI: <br><br><ul><li>  O administrador de TI v√™ que o NGFW visualiza o tr√°fego da rede, ou seja, mostra o conte√∫do do campo de dados do pacote, nomes de usu√°rio e qual aplicativo est√° sendo executado e quais arquivos ele transmite. <br></li><li>  A seguran√ßa de TI v√™ que o NGFW fornece resolu√ß√£o segura de aplicativos, porque uma an√°lise mais profunda dos dados no pacote permite que voc√™ veja v√≠rus, envie arquivos desconhecidos para a sandbox, verifique o tipo de arquivo, as palavras-chave para DLP, verifique a categoria da URL, verifique o que est√° dentro do SSL e SSH, Compare com indicadores de compromisso j√° conhecidos em todo o mundo, habilite o filtro DNS e outras t√©cnicas modernas. <br></li></ul><br>  Para entender os motivos disso, compare os logs de firewall L4 e L7. <br><blockquote>  A) Compare a entrada no log do <b>firewall L4</b> , que analisa apenas o cabe√ßalho do n√≠vel de transporte (quarto) do modelo OSI ISO - neste caso, o TCP: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d8a/7bd/dbd/d8a7bddbdb4f4b2de47d82f964de4075.png"></blockquote>  Sim, h√° informa√ß√µes sobre a origem e o destino, voc√™ pode adivinhar pelo n√∫mero da porta 443 que dentro, com um alto grau de probabilidade (como dizem os ingleses), a conex√£o SSL.  Pessoalmente, n√£o vejo nenhum incidente nesta entrada.  E voc√™? <br><blockquote>  B) Compare a entrada no log do <b>firewall L7</b> para a mesma conex√£o TCP, onde o conte√∫do em si tamb√©m √© transferido para o campo de dados TCP / IP: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cea/5fc/e07/cea5fce0756312001f33bc13bf101d7a.png"></blockquote>  Aqui voc√™ v√™ que Ivanov, do departamento de marketing, carregou um arquivo marcado como "n√£o para distribui√ß√£o" no Slideshare.  Este √© um exemplo de um incidente real em que um funcion√°rio postou planos confidenciais de desenvolvimento da empresa por um ano na Internet.  Essas informa√ß√µes foram obtidas no firewall L7 com base na an√°lise da mesma conex√£o acima do firewall L4 e imediatamente as informa√ß√µes se tornam suficientes para entender que houve um incidente.  E essa √© uma abordagem completamente diferente para a an√°lise de tr√°fego.  Mas avisarei imediatamente que uma an√°lise t√£o profunda coloca uma carga s√©ria no processador e na RAM do dispositivo. <br><br>  √Äs vezes, considera-se que o n√≠vel de detalhe das revistas no NGFW √© semelhante ao n√≠vel de detalhe nos sistemas SIEM que coletam informa√ß√µes pouco a pouco de diferentes fontes.  √â por isso que o NGFW √© uma das melhores fontes de informa√ß√£o para o SIEM. <br><br><a name="Def"></a><h2>  Defini√ß√µes </h2><br>  √â necess√°rio destacar os termos com os quais continuaremos a operar.  N√£o tenho nenhum prop√≥sito em detalhes para fornecer todas as defini√ß√µes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/871/b80/69b/871b8069b4cf331d60aeb72e986a6fa1.png"><br><br>  <b>O modelo OSI ISO de sete n√≠veis</b> √© um modelo de intera√ß√£o entre dispositivos de rede, que afirma que existem 7 n√≠veis consecutivos de abstra√ß√£o de intera√ß√£o: o primeiro √© f√≠sico, o pr√≥ximo √© canal, rede, o quarto √© transporte e, em seguida, a sess√£o, apresenta√ß√£o e s√©timo n√≠vel s√£o aplicativos (veja a figura acima) ) <br><br>  Cada dispositivo de rede opera em seu pr√≥prio n√≠vel de abstra√ß√£o: o servidor da web e o navegador - no n√≠vel do aplicativo (n√≠vel 7 ou brevemente L7), os roteadores - se comunicam entre si no canal (2) e no n√≠vel da rede (3) quando transmitem quadros e pacotes entre si. . <br><br>  Os firewalls tamb√©m s√£o dispositivos de rede e, dependendo do tipo, tamb√©m podem ser comutadores e roteadores e at√© ser um "cabo virtual" do ponto de vista da topologia de rede, mas esses dispositivos de rede t√™m uma carga adicional: eles devem analisar o conte√∫do dos pacotes. <br><br>  E a profundidade da an√°lise de pacotes de rede pode variar.  Se eles analisam os n√≠veis 4 ou 7 √© uma diferen√ßa importante. <br><br><a name="FW"></a><h2>  Firewall </h2><br>  <b>Firewall (ITU), o Firewall de rede</b> √© um dispositivo de rede que divide a rede em segmentos com diferentes pol√≠ticas de seguran√ßa e controla essas pol√≠ticas.  Por exemplo, o segmento da Internet - tudo pode ser feito l√°.  E o segmento do seu data center - l√° voc√™ pode trabalhar apenas uma lista dedicada de funcion√°rios para aplicativos permitidos.  Em um √∫nico host VMware, pode haver v√°rias redes virtuais com m√°quinas virtuais e pol√≠ticas de acesso diferentes para eles. <br><br>  A pol√≠tica de seguran√ßa do firewall cont√©m regras que aplicam o c√≥digo do programa do dispositivo, analisando cada quadro e pacote que vem e sai do firewall.  Nas regras do firewall, s√£o definidos crit√©rios de inspe√ß√£o (qualificadores), segundo os quais √© tomada uma decis√£o para permitir ou bloquear o tr√°fego.  Exemplos de qualificadores nas regras s√£o: endere√ßo, porta, aplicativo, usu√°rio, zona.  O firewall sequencialmente, regra por regra, varre os crit√©rios de cima para baixo na lista e, se o tr√°fego de entrada atender a todos os crit√©rios da regra (opera√ß√£o l√≥gica ‚ÄúAND‚Äù entre os crit√©rios), a a√ß√£o indicada ser√° aplicada: bloquear ou pular.  A a√ß√£o √© executada para o primeiro pacote e para todos os pacotes subsequentes da mesma conex√£o TCP / IP. <br><br>  Existem diferentes tipos e implementa√ß√µes de firewall.  Consideraremos a classifica√ß√£o de acordo com o grau de profundidade da an√°lise de tr√°fego utilizado: L3, L4 e L7. <br><br><a name="L3"></a><h2>  Firewall L3 </h2><br>  <b>O firewall L3</b> √© um firewall que passa o tr√°fego por si mesmo e analisa apenas os cabe√ßalhos do protocolo IP, ou seja, o endere√ßo de onde e para onde o tr√°fego vai.  Esses firewalls s√£o chamados <b>de filtragem de pacotes</b> .  As regras s√£o chamadas de "lista de acesso" ou lista de acesso (ACL) e essa funcionalidade hoje funciona em quase todos os roteadores e sistemas operacionais.  Essa an√°lise n√£o requer uma carga s√©ria nos processadores e na mem√≥ria do firewall. <br><br><a name="L4"></a><h2>  Firewall L4 </h2><br>  <b>O firewall L4</b> √© um firewall que passa o tr√°fego por si pr√≥prio e verifica os cabe√ßalhos dos protocolos de quatro n√≠veis: TCP, UDP, ICMP, ou seja, os principais crit√©rios de verifica√ß√£o para a passagem do tr√°fego s√£o endere√ßos IP e portas TCP / UDP ou servi√ßos ICMP. <br><br>  O conceito de inspe√ß√£o com estado tamb√©m aparece no firewall L4, onde cada solicita√ß√£o de passagem √© armazenada e o estado da solicita√ß√£o √© armazenado para permitir as conex√µes de resposta necess√°rias.  Ou seja, o conceito de um iniciador de conex√£o √© exibido, o que √© l√≥gico nas redes criadas na tecnologia cliente-servidor.  Esse firewall gasta mem√≥ria no armazenamento de dados sobre cada conex√£o, ou seja, h√° um limite para o n√∫mero m√°ximo de sess√µes simult√¢neas armazenadas na mem√≥ria.  No firewall L4, voc√™ n√£o precisa mais escrever uma regra de resposta para a conex√£o reversa, conforme √© exigido no firewall L3, porque, com base no status da conex√£o, o firewall permite automaticamente conex√µes reversas.  Ou seja, o firewall L4 √© mais conveniente do que um filtro de pacotes. <br><br>  Os modernos firewalls L4 armazenam o estado n√£o apenas do TCP, UDP e ICMP, mas tamb√©m acompanham a intera√ß√£o de alguns aplicativos L7.  Por exemplo, o status do FTP, HTTP, SIP e outros aplicativos, que j√° dependem da implementa√ß√£o espec√≠fica do firewall.  Precisamos perguntar ao fabricante do firewall L4: quais aplicativos espec√≠ficos o mecanismo de firewall de inspe√ß√£o com estado suporta? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fbb/493/449/fbb49344946f0e1ae8ecde30d879b35e.png"><br><br><a name="L7"></a><h2>  Firewall L7 </h2><br>  <b>O firewall L7</b> √© um firewall que transmite o tr√°fego de rede IP e verifica os cabe√ßalhos de n√≠vel 4 e o segmento de dados de cada pacote IP, ou seja, entende o tr√°fego no n√≠vel de aplicativo L7, at√© o qual os arquivos s√£o transferidos e em que dire√ß√£o.  Como mais dados s√£o analisados, h√° mais crit√©rios de verifica√ß√£o nas regras do firewall L7: nome do usu√°rio, aplicativo, categoria de URL, status do software no computador do usu√°rio. <br><br>  A carga no firewall L7 √© muito maior, porque seu processador deve analisar constantemente os megabytes do campo de dados que o aplicativo transmite, enquanto o firewall L4 verifica apenas alguns bytes do cabe√ßalho do pacote IP com endere√ßos e portas de origem e destino.  O tamanho do buffer para armazenar o estado de cada aplicativo L7 requer muito mais, porque mais dados s√£o transferidos para o L7 do que apenas no cabe√ßalho TCP / IP.  Devido ao aumento do tamanho do buffer ao usar a an√°lise de aplicativos, o n√∫mero de sess√µes armazenadas simultaneamente na mem√≥ria do firewall L7 √© menor que o firewall L4 com a mesma quantidade de mem√≥ria.  Como o firewall L7 v√™ pelo conte√∫do que tipo de aplicativo passa pela rede, o n√∫mero da porta n√£o faz muito sentido e as regras podem ser escritas pelo nome do aplicativo L7.  Al√©m disso, aplicativos modernos geram muitas conex√µes e todas essas conex√µes fazem parte de um √∫nico aplicativo.  Esse tipo de firewall permite recuperar o controle de aplicativos din√¢micos modernos em execu√ß√£o em qualquer porta, por exemplo, teamviewer, bittorent, tor, sobre o qual o firewall L4 n√£o sabe nada.  Ou seja, o firewall L7 nas realidades modernas √© necess√°rio se a rede precisar de seguran√ßa. <br><blockquote>  Se, depois de ler este artigo, voc√™ continuar usando o firewall L4, isso significa que voc√™ n√£o est√° nem a√≠ para seguran√ßa. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9dd/ded/ecb/9dddedecb30376ea249d293db19a016d.png"><br></blockquote><br><a name="UTM"></a><h2>  UTM </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/ab9/466/fc5/ab9466fc51717a9788e0093244b6261d.png"><br><br>  <b>Um UTM</b> √© um dispositivo de rede que possui v√°rios componentes de seguran√ßa diferentes instalados dentro dele que analisam sequencialmente o tr√°fego que passa pelo dispositivo.  O n√∫cleo do UTM √© o firewall L4, o sistema de preven√ß√£o de ataques (IPS), o antiv√≠rus e a an√°lise das categorias de URL em HTTP e HTTPS.  Freq√ºentemente, os UTMs ainda fornecem fun√ß√µes de gateway VPN.  Todos esses componentes s√£o geralmente gerenciados a partir de v√°rios sistemas de controle diferentes.  O tr√°fego dentro do UTM passa sequencialmente pelos m√≥dulos de filtragem e a sa√≠da √© tr√°fego puro, o que √© permitido pelas pol√≠ticas de seguran√ßa de cada m√≥dulo.  O UTM pode ser usado como plataforma para outras fun√ß√µes: prote√ß√£o contra v√≠rus, IPS, DDoS, QoS, DLP, filtro DNS, banco de dados de indicadores de Intelig√™ncia contra Amea√ßas, prote√ß√£o contra phishing e assim por diante (dependendo do fabricante). <br><br><blockquote>  A par√°bola sobre a pessoa que encomendou sete chap√©us de uma capa tamb√©m foi escrita para os clientes da UTM: quanto mais fun√ß√µes voc√™ deseja ativar ap√≥s a compra, maior a carga no processador da UTM para analisar a mesma quantidade de tr√°fego.  Mais recursos - menos velocidade do dispositivo. </blockquote><br><br>  A id√©ia do UTM - carregar um processador com o maior n√∫mero poss√≠vel de fun√ß√µes se tornou um beco sem sa√≠da evolutivo, porque o n√∫mero de fun√ß√µes cresceu e os processadores n√£o conseguiram suportar toda essa carga.  Hoje, apesar dos bons recursos declarados, ningu√©m inclui toda a funcionalidade do UTM para eliminar atrasos no tr√°fego. <br><blockquote>  O objetivo da UTM: implementar o maior n√∫mero poss√≠vel de fun√ß√µes em um servidor para reduzir o custo do dispositivo para o usu√°rio. </blockquote>  Agora, os fabricantes de UTM come√ßaram a instalar mecanismos de an√°lise de aplicativos de n√≠vel 7 para dizer que s√£o NGFW, o que confunde o consumidor.  No entanto, isso √© f√°cil de reconhecer se voc√™ observar a pol√≠tica de seguran√ßa: as regras ainda s√£o baseadas nos crit√©rios para verificar os campos L4.  E para filtrar aplicativos L7, uma se√ß√£o de configura√ß√µes separada √© usada, ou seja, o aplicativo L7 n√£o √© um qualificador, como deveria estar no firewall L7.  Reconhecer o aplicativo L7 e usar o aplicativo L7 como crit√©rio para a pol√≠tica de seguran√ßa s√£o "duas grandes diferen√ßas". <br><br><a name="NGFW"></a><h2>  NGFW </h2><br>  <b>NGFW</b> √© um dispositivo de rede no qual o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">firewall L7</a> √© implementado.  Como o qualificador principal se torna o nome do aplicativo L7, as regras s√£o escritas de acordo com novos crit√©rios.  No NGFW, o mapeamento din√¢mico de endere√ßos IP para usu√°rios da rede sempre funciona, portanto o nome de usu√°rio tamb√©m se torna um qualificador (crit√©rio).  O NGFW inclui fun√ß√µes de descriptografia SSL / TLS e SSH para reconhecer aplicativos e ataques dentro deles, IPS, antiv√≠rus e filtragem de URL. <br><br>  O termo NGFW foi cunhado pela empresa de marketing Palo Alto Networks.  Mas gradualmente se enraizou no mercado e todos os fabricantes de UTM agora tamb√©m se chamam NGFW.  De fato, o NGFW tamb√©m executa v√°rias fun√ß√µes simultaneamente; por que ent√£o o NGFW n√£o √© UTM?  A diferen√ßa √© importante saber.  √â que nas fun√ß√µes de seguran√ßa do aplicativo NGFW (IPS, antiv√≠rus, filtragem de URL) s√£o aceleradas pelo hardware.  Existem chips de hardware especializados: o IPS verifica ataques no chip, antiv√≠rus exclusivo por assinatura, descriptografia SSL por conta pr√≥pria e assim por diante.  A separa√ß√£o de fun√ß√µes entre diferentes processadores torna poss√≠vel executar fun√ß√µes de prote√ß√£o em paralelo e n√£o esperar que a fun√ß√£o anterior termine de funcionar, como no UTM.  Por exemplo, at√© 60 s√£o instalados nos firewalls de hardware da Palo Alto Networks <br>  Processadores especializados da Cavium que aceleram as fun√ß√µes de seguran√ßa, rede e gerenciamento.  √â importante que os NGFWs contenham uma √∫nica interface de software para gerenciar todas as fun√ß√µes ao mesmo tempo. <br><blockquote>  A id√©ia do NGFW, ao contr√°rio do UTM, √© implementar cada fun√ß√£o em um processador separado, especializado na funcionalidade necess√°ria. </blockquote>  Os fabricantes de computadores costumavam seguir o mesmo padr√£o e levavam as fun√ß√µes da matem√°tica e dos gr√°ficos para coprocessadores gr√°ficos e matem√°ticos separados.  Portanto, o NGFW possui processadores separados para reconhecer aplicativos L7, descriptografar SSL / SSH, verificar assinaturas de antiv√≠rus, verificar assinaturas de IPS e assim por diante.  Isso permite que voc√™ ative todas as fun√ß√µes ao mesmo tempo, sem degrada√ß√£o e atraso do tr√°fego no dispositivo durante a verifica√ß√£o.  Por que ningu√©m compra computadores sem aceleradores gr√°ficos e firewalls sem acelera√ß√£o?  Como a acelera√ß√£o n√£o √© necess√°ria em baixas velocidades, mas quando as velocidades de an√°lise de tr√°fego ultrapassam 1-5 Gigabits, j√° √© imposs√≠vel implementar todas as fun√ß√µes de seguran√ßa sem acelera√ß√£o. <br><br>  O objetivo do dispositivo NGFW √© permitir que as empresas trabalhem com seguran√ßa sem diminuir o tr√°fego.  Isso permite que voc√™ verifique constantemente se os aplicativos transmitem conte√∫do seguro para a empresa que voc√™ precisa, e a opera√ß√£o paralela dos mecanismos de prote√ß√£o com um fluxo de tr√°fego garante o desempenho especificado com todos os recursos de seguran√ßa ativados e tamb√©m minimiza o atraso no tr√°fego. <br><br><a name="Ex"></a><h2>  Exemplos </h2><br><blockquote>  Exemplo de pol√≠tica L7 na Palo Alto Networks NGFW <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c3d/433/201/c3d433201745dec7e570b6fe82769f2b.png"></blockquote>  Por que voc√™ pode precisar de uma categoria de URL como um qualificador?  Por exemplo, voc√™ pode permitir que alguns funcion√°rios ainda visitem sites maliciosos com um navegador, mas bloqueie o download de arquivos para eles. <br><blockquote>  Um exemplo de pol√≠tica da Palo Alto Networks usando verifica√ß√µes de Perfil de informa√ß√µes do host e URLs de categoria. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/957/d22/0a0/957d220a05d44f91fef65d4cebf76b89.png"></blockquote>  Essa pol√≠tica tamb√©m envolve a verifica√ß√£o da prote√ß√£o do host TRAPS na coluna Perfil HIP, que impedir√° que os usu√°rios entrem no site com c√≥digos e explora√ß√µes mal-intencionados, sem a prote√ß√£o instalada no computador.  O TRAPS √© um agente antimalware e de prote√ß√£o contra explora√ß√£o. <br><br>  O download do arquivo √© bloqueado nas configura√ß√µes da coluna Perfil, onde o perfil para bloquear a transfer√™ncia de todos os arquivos para qualquer aplicativo √© aplicado.  √â assim que sua configura√ß√£o se parece: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/480/87e/6e2/48087e6e2f973ee821ef6240828dfd6a.png"><br><br><a name="Proxy"></a><h2>  Servidor proxy </h2><br>  <b>Um servidor proxy</b> √© um dispositivo que encerra o tr√°fego de um aplicativo em si mesmo, verifica esse tr√°fego usando v√°rios m√©todos e envia esse tr√°fego ainda mais.  Geralmente usado em redes proxy para HTTP e HTTPS.  Como o UTM e o NGFW analisam os fluxos HTTP e HTTPS de forma transparente, sem exigir configura√ß√µes expl√≠citas do servidor proxy dos clientes, os proxies HTTP est√£o gradualmente desaparecendo das empresas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bf2/e91/3eb/bf2e913eb4c39a379ff76818a6173b6d.png"><br><br><a name="USER-ID"></a><h2>  O que √© USER-ID </h2><br>  O NGFW inventou um mecanismo para identificar usu√°rios.  O algoritmo funciona internamente ou √© executado em um agente externo.  Vou chamar isso de um mecanismo de identifica√ß√£o do usu√°rio.  O USER-ID cria e mant√©m uma tabela de mapeamento para o nome de usu√°rio e seu endere√ßo IP atual.  Tamb√©m acontece que na tabela h√° um valor e uma porta para um determinado usu√°rio, se os usu√°rios trabalharem com VDI (ou seja, os usu√°rios v√™m do mesmo endere√ßo e podem ser distinguidos apenas pela porta). <br><img src="https://habrastorage.org/getpro/habr/post_images/37d/0cc/99b/37d0cc99baa26dc2597b17e7ae9ed7a4.png" alt="imagem"><br>  Vou listar mecanismos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ID de USU√ÅRIO</a> na Palo Alto Networks <br><ol><li>  <b>Monitoramento de servidor</b> : o agente de identifica√ß√£o de usu√°rio l√™ eventos de servidores Exchange, controladores de dom√≠nio ou servidores Novell eDirectory </li><li>  <b>An√°lise do cliente</b> : o agente de ID do usu√°rio pesquisa os clientes do Windows via WMI </li><li>  <b>Agente de servi√ßos de terminal</b> : o <b>agente</b> TS distribui para diferentes usu√°rios diferentes intervalos de portas TCP / UDP para trabalhar com Windows / Citrix Terminal Servers </li><li>  An√°lise de mensagens <b>syslog</b> : O agente de identifica√ß√£o de usu√°rio l√™ mensagens de autentica√ß√£o syslog de v√°rios sistemas, controladores sem fio, dispositivos 802.1x, servidores Apple Open Directory, servidores proxy, gateways VPN, Cisco ISE </li><li>  Autentica√ß√£o via <b>GlobalProtect</b> Client: VPN + nome de usu√°rio e senha podem ser adicionados ao MFA </li><li>  Autentica√ß√£o por meio do <b>Portal Captive</b> : o tr√°fego da Web √© autenticado pelo formul√°rio da Web NTLM ou AAA (o Portal Captive √© usado nos caf√©s e metr√¥ de Moscou. O NTLM permite tornar a autentica√ß√£o transparente) </li><li>  <b>API XML</b> : informa√ß√µes sobre entrada e sa√≠da s√£o transmitidas pelo agente User-ID com comandos especiais atrav√©s do firewall da API REST </li><li>  <b>X-Forwarded-For</b> : proxies preenchem este campo na solicita√ß√£o HTTP para que fique claro quem est√° se escondendo atr√°s do proxy </li></ol><br>  A leitura de logs dos controladores do Active Directory √© o recurso mais usado no USER-ID.  USER-ID       AD,       IP  ,    USER-ID            NGFW,   Windows 2008/2012  : <br> ‚Äî 4768 ‚Äì Authentication Ticket Granted <br> ‚Äî 4769 ‚Äî Service Ticket Granted <br> ‚Äî 4770 ‚Äì Ticket Granted Renewed <br> ‚Äî 4264 ‚Äì Logon Success <br>     USER-ID     Even Log Reader. <br><br><a name="Stateful"></a><h2>   Stateful Inspection </h2><br>             .      ,        .      stateful inspection,        . <br><br> <b>  </b> ,      .  Aten√ß√£o! Stateful inspection ‚Äî       TCP, UDP  ICMP!           : FTP, SIP, RPC, SMTP, SMB   ! <br><blockquote> . <br><br>  FTP ‚Äî    .      PORT,     TCP .  firewall,     stateful inspection firewall,    FTP    PORT       ,   .     : firewall       PORT    ,  FTP    NAT. </blockquote>      L4 firewall  ,    L7 .     :   HTTP, RPC,  ‚Ä¶     7   Application Layer Gateway (ALG). <br><blockquote> . <br><br>  ¬´¬ª      ‚Äì  ALG  SIP,   ,   SIP ALG  L4 firewall  ,     . </blockquote>     L4 firewall     7 . L4 firewall       ALG.     L4 firewall,       :        Stateful Inspection?     . <blockquote> ,  L7 firewall ‚Äî   stateful inspection firewall,        ,    ,  L4 firewall. </blockquote><br><br><a name="Sessions"></a> <b> </b>    firewall.   datasheet,     ,  ¬´  ¬ª.    :              stateful  TCP,        L7 ? <br><br>  ,        ,   firewall.           .  ,  ¬´  ¬ª           .  ,   L4 firewall        TCP   UDP.    TCP  ,     IP   .     L7 , , HTTP      ,  , ,   GET  HTTP   .    . ,       ¬´  ¬ª,    : <br><ul><li>         /, c  stateful inspection, </li><li>     L4,      TCP/IP, </li><li>   -  L7    . </li></ul><br>  L7 firewall      HTTP,    : 64, 44, 16, 1.5. ,   -       UDP 1518 ,          ,       UDP   1518  ‚Äì  ,          HTTP.    ,   L7 firewall         HTTP.   ,     :  NSS Labs. <br>   firewall       ,      , : 30%  HTTPS, 10%  SMB, 10%  FTP   . <br><blockquote> . <br><br>      IXIA     UTM: <br><ul><li>   L4 firewall ‚Äî 4 000 000  , </li><li>   L7 firewall ‚Äî 200 000  . </li></ul><br>   ,     L7     -   . </blockquote><br> ,  ,       :          10  ,   .     4     ,    . <br><br><a name="Cluster"></a> <b>  </b> ‚Äì   .       ,        ,    ¬´ ¬ª     ‚Äî        .  ¬´¬ª firewall  ,           firewall.      ,    ?    firewall     ,         IP       L7 :     - SSL         IPS   ‚Äì     ,   .     L4  L7 firewall :   L4    ,    L7.    . <br><br> <b>   </b> ,  L7 firewall        ‚Äî  ,     L7                      .           L4,           . <br><br>     L4  L7 firewall,              . L7 firewall         ,                 !      . <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> 2.  L7 Firewall  </a> <br><a name="Opros"></a></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt436392/">https://habr.com/ru/post/pt436392/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt436376/index.html">Vis√£o geral do rob√¥ todo-o-terreno EZ-Robot Roli Rover</a></li>
<li><a href="../pt436378/index.html">bobaos.pub - KNX TP / UART, Raspberry Pi e Redis</a></li>
<li><a href="../pt436380/index.html">In√≠cio r√°pido na impress√£o 3D: impressoras econ√¥micas para iniciantes ou tecnologia para as massas</a></li>
<li><a href="../pt436382/index.html">Antiguidades: dez anos de evolu√ß√£o do laptop usando o ThinkPad X301</a></li>
<li><a href="../pt436390/index.html">N√≥s criamos o UITableView. Para iniciantes</a></li>
<li><a href="../pt436394/index.html">Demis Hassabis - o grande intelecto que criou o grande intelecto</a></li>
<li><a href="../pt436396/index.html">Posso usar programa√ß√£o funcional no meu idioma?</a></li>
<li><a href="../pt436398/index.html">Agua</a></li>
<li><a href="../pt436400/index.html">Configure o ambiente de desenvolvimento para aprender HTML, CSS, PHP no Windows</a></li>
<li><a href="../pt436404/index.html">Balanceamento de tr√°fego VoIP tolerante a falhas. Troca de carga entre data centers no hor√°rio de pico</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>