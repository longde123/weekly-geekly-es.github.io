<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ¿â€ğŸ­ ğŸ§–ğŸ½ ğŸ™ğŸ¿ Kamera visi mesin untuk penggemar. Bagaimana cara menggunakan kamera untuk navigasi offline? ğŸ‘‡ ğŸ› ğŸ§’ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kami membuat kamera untuk mendeteksi AprilTag dan ArTag dengan mROS. Terhubung melalui Uart atau Ethernet. 

 Kami mencoba JeVois dan OpenMV, mengharg...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kamera visi mesin untuk penggemar. Bagaimana cara menggunakan kamera untuk navigasi offline?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/robogazon/blog/426695/"><h2>  Kami membuat kamera untuk mendeteksi AprilTag dan ArTag dengan mROS.  Terhubung melalui Uart atau Ethernet. </h2><br><br>  Kami mencoba JeVois dan OpenMV, menghargai pro dan kontra, dan memasang kamera kami. <br><br><img src="https://habrastorage.org/webt/lp/nb/qx/lpnbqx9egbtr4id5i-oftxtjpj4.jpeg"><br><br>  Cari tag visual dan orientasi robot berdasarkan data.  Kami sedang mengembangkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">robot untuk mengumpulkan bola golf di driving range</a> .  Sekarang di dunia hanya satu perusahaan yang menjual robot untuk menyelesaikan masalah ini.  Pasarnya sangat menjanjikan, ini mendorong kami untuk mengubah proyek dari DIY menjadi startup teknologi. <br><a name="habracut"></a><br>  Menggunakan GPS tanpa RTK untuk menavigasi robot, sulit untuk mencapai akurasi yang dibutuhkan untuk mencari pangkalan dan parkir dengan benar.  Menggunakan Kinematik Waktu Nyata, saya akan mengalami masalah saat mendekati bangunan.  Kami mencoba berbagai opsi dan memutuskan untuk membuat kamera kami sendiri untuk mencari tanda visual di pintu masuk pangkalan. <br><br>  Bagian dari pengembangan robot adalah parkirnya di stasiun docking untuk membongkar kompartemen bola dan mengisi baterai.  Kami sudah lama berpikir tentang cara memarkirnya, setuju bahwa robot akan menemukan objek cerah optik dan mengikutinya. <br><br>  Tag AprilTag atau ArTag dipilih sebagai target, tergantung pada bagaimana mereka menunjukkan diri mereka di lapangan.  Karena  kami tidak menderita sindrom <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">NIH</a> - pencarian kamera penglihatan mesin dengan dukungan untuk penanda ini dan dengan dukungan skrip tepat di kamera telah dimulai. <br><br><h3>  JeVois pertama </h3><br>  Dari apa yang dengan cepat ditemukan - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">JeVois</a> , dikembangkan oleh lab University of Southern California.  Sayangnya, saya harus memesan ke Rusia melalui Amazon, tidak ada reseller internal dan tampaknya tidak akan ada - tampaknya pemasaran dan penjualan dilakukan oleh pengembang sendiri (kami cukup terkejut ketika kami harus beralih dari Jevois ke Jevois inc untuk membeli kamera , dan kemudian mencari tautan ke direktori - pilih kamera di suatu tempat di tengah posisi 10-12). <br><br><img src="https://habrastorage.org/webt/2i/b6/yp/2ib6ypwgyxfvfswidighr735btq.png"><br><br>  Berjalan pertama di komputer cukup menggembirakan, secara umum, semuanya bekerja langsung dan terlihat cukup menarik.  Namun, setelah tes dengan menghubungkan ke papan kontrol, empat masalah serius menjadi jelas: <br><br>  60-90 FPS yang ditunjukkan dalam materi iklan diberikan untuk resolusi 160x120 atau 320x240, yang sama sekali tidak cocok untuk parkir - tangkapan masih diinginkan dari jarak minimal 5 meter.  Dan agar persegi jatuh ke butir 160x120 dari 6-8 meter - Anda harus membuatnya setidaknya setengah meter dan ketika mendekat, pertama-tama benar-benar menutup bingkai, dan kemudian berhenti mendeteksi sama sekali. <br><br>  Konsumsi 800mA, sementara daya hanya melalui kabel USB dengan mini USB, yang dapat menahan arus ini tanpa banyak drop tegangan.  Ternyata sangat sulit menemukan kabel dengan panjang setidaknya setengah meter dengan fitur-fitur seperti itu - sekitar 15 opsi dipilih, dan hasilnya toh tidak terlalu memuaskan. <br><br>  Kamera buta pada malam hari atau berkedip di siang hari.  Keseimbangan otomatis bekerja melampaui kebaikan dan kejahatan. <br><br>  Kamera didinginkan oleh kipas.  Kipasnya sangat kecil, kecepatannya tinggi - noise frekuensi tinggi atau hanya deritan. <br><br><blockquote>  Robot melengking adalah hal terakhir yang ingin kami lakukan. </blockquote><br>  Menulis kode eksekusi di dalam kamera adalah hiburan terpisah - menginstal lingkungan adalah hal yang agak membingungkan, dan merakit dan mengunggah ke kartu SD memerlukan waktu setidaknya 2-5 menit.  Ya, tidak ada flash - semuanya ada di kartu SD. <br><br>  Kesimpulan: kamera untuk bermain dengan penggemar di dalam ruangan dan dengan pencahayaan yang baik.  Pada saat yang sama, akan lebih baik jika para peminatnya adalah siswa - antarmuka, dokumentasi, dan metode bekerja dengan kamera dengan jelas mengingatkan saya pada pekerjaan laboratorium siswa, di mana hampir tidak ada perhatian diberikan pada kenyamanan bekerja dengan sistem dan kelebihan lainnya.  Ini tentang modul C ++, tentu saja.  Skrip python dapat diedit melalui Jevois Inventor, tetapi FPS juga jauh lebih rendah.  Di luar tempat, kamera bahkan tidak selamat dari dua hujan, dan kipas menyumbat tanah di lapangan dengan kecepatan ruang. <br><br>  Hasilnya - tidak cocok untuk digunakan pada robot, tetapi kemungkinan mendasar dari parkir telah terbukti. <br><br><h3>  OpenMV 3 dan semua variannya </h3><br><img src="https://habrastorage.org/webt/jl/0l/xr/jl0lxryl0tksfb1vyvdomcyh8wm.jpeg"><br><br>  Pada saat pencarian pertama, itu tidak tersedia - ada kampanye di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kickstarter</a> . <br><br>  Setelah kami bermain cukup dengan JeVois dan 100 dolar dibuang ke tempat sampah - seorang penjual dengan stok ditemukan dan 2 buah dibeli. <br><br>  Secara umum, tayangannya sangat menyenangkan - antarmuka yang sangat dipikirkan dalam OpenMV IDE, kompilasi python transparan, lebih nyaman untuk menonton algoritma bekerja, dan men-debug-nya.  Namun, ada masalah di sini: <br><br><ul><li>  Resolusi dapat berupa apa saja, tetapi AprilTag hanya dapat dicari di area yang tidak lebih dari 200x200 piksel.  Kami kembali ke masalah gandum, dll.  Pengembang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">merekomendasikan</a> pertama menarik gumpalan, kemudian melihat kode di dalamnya.  Tetapi pada sesuatu selain latar belakang polos (idealnya dinding putih) ini tidak berfungsi, rumput hijau dan matahari cerah dengan latar belakang mengubah segalanya menjadi bubur.  Plus FPS turun hingga maksimal 5. </li><li>  Sensor Omnivision murah + optik murah = gambar sabun.  Secara visual, ini tidak terlalu terlihat saat melihat streaming video, tetapi ketika melihat masing-masing frame itu terlihat jelas. </li><li>  Tidak ada tirai IR, tetapi ada pencahayaan IR.  [WHAAAAT?] </li><li>  Tidak ada perlindungan dari lingkungan eksternal.  Tidak semuanya. </li></ul><br><img src="https://habrastorage.org/webt/wk/fw/pk/wkfwpkju7byid4w9pqq6g0iggpo.png"><br><br>  Script itu debug pada kamera ini, beberapa lusin parkir dibuat.  Namun, setelah robot bergulir dari Moskow ke St. Petersburg dan kembali, kamera berhenti mulai - regulator daya pingsan.  Tindakan yang jelas adalah pengemasan dan stabilisasi daya.  Dan di sini hal yang paling menarik ditemukan - kasus dengan IP yang tepat untuk kamera ini tidak dapat ditemukan, atau kotak dengan penutup transparan, tanpa pemasangan internal dan input / output kabel yang ketat.  Sebagai hasil dari pencarian, banyak kamera pengintai China murah dengan kasus yang tepat ditemukan.  Kamera dibeli dan dimusnahkan, salinan kedua OpenMV menggantikan board, semuanya bekerja. <br>  Tapi malam dan malam menjadi rintangan yang hampir tidak dapat diatasi - tidak ada tirai IR. <br><br>  Hasil: kamera SANGAT nyaman untuk prototyping, sumber daya terbatas, tidak ada perlindungan dari lingkungan eksternal sama sekali (kamera kedua kemudian pergi ke freezer industri dan tidak bertahan -30).  Tidak bagus <br><br>  Dan kemudian menjadi sangat menarik bagi kami papan macam apa yang kami dapatkan dari kamera Cina <br><br><h4>  Klon HiSilicon </h4><br>  Pada pemeriksaan lebih dekat, ternyata papan memiliki ARM 2-core, prosesor DSP, tirai IR, pencahayaan IR, sensor yang layak dari Sony, papan ditutupi dengan senyawa pelindung + perumahan untuk jalan.  Apa yang Anda butuhkan - tetap mengumpulkan perangkat lunak. <br><br>  Di dalam ternyata klon Linux yang cukup berfungsi dari HiSilicon + u-boot. <br>  Saya harus mengunduh SDK dari sumber daya Tiongkok dan berurusan dengan majelis.  Pada prinsipnya, tidak ada hal buruk yang ditemukan di sepanjang jalan, kecuali bahwa itu perlu untuk memperbaiki beberapa file di dalam SDK - distribusi Linux di mana SDK akan menjadi sangat tua, dan beberapa file header telah berubah sejak saat itu.  Yah, saya harus mengganti shell dari zsh ke bash.  Saya akan mengabaikan detailnya; demi kebaikan, artikel ini harus terpisah. <br><br>  <b>Sumber daya ini membantu:</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Parsing, menghubungkan ke kamera</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Contoh diagram perakitan perangkat lunak</a> <br><br>  Kemudian semuanya berjalan sesuai dengan skema yang terkenal: <br><br><img src="https://habrastorage.org/webt/ce/nx/u5/cenxu5leurcipqbzgfmzyxhdhhq.jpeg"><br><br>  Sebagian besar waktu yang dibutuhkan untuk mendapatkan gambar dari sensor, saya menulis sisanya hanya dalam 4 jam, hanya dengan porting algoritma debugged dari Python ke C ++. <br>  Bekerja dengan sensor membutuhkan waktu sekitar satu setengah minggu.  Tentu saja tidak ada / dev / video0 di perangkat ini, hampir perangkat keras telanjang dengan kerja langsung dengan memori dan port. <br>  Kita harus segera mengatakan bahwa sampel dari SDK berfungsi tanpa modifikasi hanya pada papan debug untuk SDK ini, jika tidak maka diperlukan banyak pengeditan kecil.  Lucu seperti kelihatannya, masalah utama adalah untuk menentukan sensor mana yang ada di kamera, karena  Cina menulis satu dalam deskripsi, yang lain ditandai di papan tulis, model ketiga diinisialisasi dalam perangkat lunak.  Sebagai contoh, kamera memiliki sensor IMX323 dalam deskripsi, papan ditandai SC2235, ketika diluncurkan dalam skrip init, dimulai dengan AR130, dan perangkat lunak kamera menginisialisasi sebagai SC2235P. <br><br>  Alasan untuk semua ini cukup sederhana: untuk pengguna akhir, bahwa IMX323, bahwa SC2235 semuanya sama, gambarnya sangat mirip.  Kernel dan rootfs dengan skrip int dikumpulkan dari SDK dengan perubahan minimal dan tidak repot dengan skrip inisialisasi terpisah untuk masing-masing model - hanya parameter peluncuran yang benar, dan nama dibiarkan apa adanya.  Dalam perangkat lunak untuk bekerja dengan kamera, bagian kedua menginisialisasi DSP dengan sensor sudah diluncurkan dan model kamera yang tepat sudah kritis di sana - oleh karena itu, log sudah memiliki model yang tepat - SC2235P.  P - ini penting, ini merupakan sensor yang berbeda dalam hal karakteristik, yang bahkan bekerja pada frekuensi bus yang sedikit berbeda dan resolusi yang berbeda dibandingkan dengan SC2235. <br><br>  Bagian kedua dari pencarian adalah lembar data pada sensor, yang pada umumnya tidak.  Oleh karena itu, saya harus membangun kembali modul hi_i2c dengan mencetak ke log melalui printk dan menggantinya di tempat sampah yang dihapus dari kamera, menulis peredam konfigurasi DSP dari prosesor video dan menghapus konfigurasi dari kamera yang berfungsi, ditambah beberapa kali untuk melihat driver dari proyek DafangSoftware.  Secara terperinci, ini menarik 3-4 artikel terpisah, yang ingin saya tulis setelah NG. <br><br>  Pada akhirnya, semuanya ternyata lebih baik dari yang diharapkan - pekerjaan yang percaya diri untuk menangkap AprilTag dari 6 meter bahkan dalam kegelapan yang hampir sempurna, 25-12 fps, pengontrol kontrol parkir PID, dll. <br>  Hasilnya - ini yang paling untuk bekerja di lapangan, banyak hal telah dipertimbangkan untuk melindungi dari kondisi eksternal.  Satu-satunya hal yang tidak dapat diverifikasi sepenuhnya adalah pekerjaan di bawah sinar matahari yang cerah, cuaca sejak Oktober telah memburuk. <br><br><h3>  Gagasan untuk pengembangan </h3><br>  Dan di sini kami memiliki sebuah ide - kami memiliki analog OpenMV dengan fitur-fitur perangkat keras yang jauh lebih baik dan produksi massal.  Tetap membawa pekerjaan dengan kamera ke level OpenMV, ke micropython di sana, membuat IDE yang nyaman dan memeriksa ulang bagaimana skrip saat ini dari OpenMV akan bekerja.  Selain itu, mRos sepenuhnya porting di sana, dan ini segera memperluas penggunaan kamera tersebut untuk sistem ROS. <br><br>  Sebagai hasilnya, kami berencana untuk mengirimkan analog OpenMV pada bulan Maret dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mROS</a> pada bulan Mei. <br><br>  Untuk mengurangi harga penyesuaian kamera, kami siap menawarkannya kepada Anda.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Isi formulir</a> dan kami akan menghubungi Anda ketika kami siap memesan batch pertama. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id426695/">https://habr.com/ru/post/id426695/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id426685/index.html">Kami mengontrol ratusan perangkat rumah pintar dengan suara dan teks dari telepon pintar. Alexa Echo di pembawa pesan</a></li>
<li><a href="../id426687/index.html">Membuat case robot dengan anggaran terbatas. Vakum membentuk</a></li>
<li><a href="../id426689/index.html">Kami bertanggung jawab atas pasar orang lain: apa yang dikatakan jejaring sosial tentang CRM</a></li>
<li><a href="../id426691/index.html">Programmer cuti sakit</a></li>
<li><a href="../id426693/index.html">Layanan navigasi robot di lapangan golf. Membangun jalan dan menghindari rintangan</a></li>
<li><a href="../id426697/index.html">Bekerja dengan perangkat LibUsb dari bawah Android</a></li>
<li><a href="../id426699/index.html">Pengujian Python dengan pytest. Sederhana, Cepat, Efisien, dan Dapat diskalakan. Kata Pengantar dan Pengantar</a></li>
<li><a href="../id426701/index.html">Flutter - tampilan baru pada pengembangan lintas platform</a></li>
<li><a href="../id426703/index.html">Apa yang menarik dari DataVizDay di Minsk</a></li>
<li><a href="../id426705/index.html">Hyperledger Fabric Pengembangan dan Pengujian Kontrak Pintar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>