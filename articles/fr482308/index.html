<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚óæÔ∏è üå©Ô∏è ü¶Ä Nous faisons un projet de plugin avec compilation pour diff√©rentes versions de Revit / AutoCAD üòì ü•ò üíÉüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lors du d√©veloppement de plugins pour des applications de CAO ( dans mon cas, AutoCAD, Revit et Renga), un probl√®me se pose au fil du temps - de nouve...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous faisons un projet de plugin avec compilation pour diff√©rentes versions de Revit / AutoCAD</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482308/"><img src="https://habrastorage.org/webt/u7/vh/xi/u7vhxitqphrjiza_fsmzmoclmha.png"><br><br><p>  Lors du d√©veloppement de plugins pour des applications de CAO ( <a href="https://modplus.org/ru/" rel="nofollow">dans mon cas,</a> AutoCAD, Revit et Renga), un probl√®me se pose au fil du temps - de nouvelles versions de programmes sortent, leurs modifications d'API et de nouvelles versions de plugins doivent √™tre apport√©es. </p><br><p>  Lorsque vous n'avez qu'un seul plugin ou que vous √™tes encore un d√©butant autodidacte dans ce domaine, vous pouvez simplement faire une copie du projet, changer les endroits n√©cessaires et cr√©er une nouvelle version du plugin.  Par cons√©quent, les modifications ult√©rieures du code entra√Æneront une augmentation multiple des co√ªts de main-d'≈ìuvre. </p><br><p>  Au fur et √† mesure que vous acqu√©rez de l'exp√©rience et des connaissances, vous trouverez plusieurs fa√ßons d'automatiser ce processus.  Je suis all√© de cette fa√ßon et je veux vous dire √† quoi je suis finalement arriv√© et √† quel point c'est pratique. </p><a name="habracut"></a><br><p>  Pour commencer, pensez √† une m√©thode qui est √©vidente et que j'utilise depuis longtemps </p><br><h3>  Liens vers les fichiers de projet </h3><br><p>  Et pour rendre tout simple, clair et compr√©hensible, je vais tout d√©crire en utilisant un exemple abstrait de d√©veloppement de plug-in. </p><br><p>  Ouvrez Visual Studio (j'ai la version Community 2019. Et oui - en russe) et cr√©ez une nouvelle solution.  Appelons √ßa <b>MySuperPluginForRevit</b> </p><br><img src="https://blog.modplus.org/images/Blog/Blog24_1.png" alt="image1"><br><br><p>  Nous allons cr√©er un plugin pour Revit pour les versions 2015-2020.  Par cons√©quent, nous allons cr√©er un nouveau projet dans la solution (biblioth√®que de classes Net Framework) et l'appeler <b>MySuperPluginForRevit_2015</b> </p><br><img src="https://blog.modplus.org/images/Blog/Blog24_2.png" alt="image2"><br><br><p>  Nous devons ajouter des liens vers l'API Revit.  Bien s√ªr, nous pouvons ajouter des liens vers des fichiers locaux (vous devrez installer tous les SDK n√©cessaires ou toutes les versions de Revit), mais nous irons directement sur le bon chemin et connectons le package NuGet.  Vous ne pouvez pas trouver un petit nombre de packages, mais j'utiliserai le mien. </p><br><p>  Apr√®s avoir connect√© le package, <em>faites un</em> clic droit sur l'√©l√©ment " <em>Liens</em> " et s√©lectionnez " <em>Transf√©rer packages.config vers PackageReference ...</em> " dans le menu </p><br><img src="https://blog.modplus.org/images/Blog/Blog24_3.png" alt="image3"><br><br><p>  Si vous paniquez soudainement √† ce stade, car la fen√™tre des propri√©t√©s du package ne contient pas l'√©l√©ment important " <em>Copier localement</em> ", que nous devons d√©finitivement d√©finir sur <em>faux</em> , alors nous ne devrions pas paniquer - nous allons dans le dossier du projet et ouvrons le fichier avec l'extension. csproj dans un √©diteur pratique (j'utilise Notepad ++) et on y trouve un enregistrement sur notre package.  Il ressemble √† ceci maintenant: </p><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ModPlus.Revit.API.2015"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Ajoutez-y la <em>propri√©t√© &lt;ExcludeAssets&gt; runtime &lt;/ExcludeAssets&gt;</em> .  Il se pr√©sente comme ceci: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ModPlus.Revit.API.2015"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcludeAssets</span></span></span><span class="hljs-tag">&gt;</span></span>runtime<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcludeAssets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  D√©sormais, lors de la construction d'un projet, les fichiers du package ne seront pas copi√©s dans le dossier de sortie. <br>  Nous allons plus loin - imaginez imm√©diatement que notre plugin utilisera quelque chose de l'API Revit, qui a chang√© avec la sortie de nouvelles versions.  Eh bien, ou tout simplement, nous devons changer quelque chose dans le code, selon la version de Revit pour laquelle nous faisons le plugin.  Pour r√©soudre de telles diff√©rences dans le code, nous utiliserons des symboles de compilation conditionnelle.  Ouvrez les propri√©t√©s du projet, allez dans l'onglet " <em>Assemblage</em> " et dans le champ " <em>Symboles de compilation conditionnelle</em> " √©crivez <strong>R2015</strong> . </p><br><img src="https://blog.modplus.org/images/Blog/Blog24_4.png" alt="image4"><br><br><p>  Notez que le symbole doit √™tre ajout√© √† la fois pour la configuration de d√©bogage et la configuration de version. </p><br><p>  Eh bien, pendant que nous sommes dans la fen√™tre des propri√©t√©s, nous allons imm√©diatement dans l'onglet ¬´ <em>Application</em> ¬ª et <strong>supprimons</strong> le suffixe <strong>_2015</strong> dans le champ ¬´ <strong>Espace</strong> de <em>noms par d√©faut</em> ¬ª afin que notre espace de noms soit universel et ind√©pendant du nom de l'assembly: </p><br><img src="https://blog.modplus.org/images/Blog/Blog24_5.png" alt="image5"><br><br><p>  Dans mon cas, dans le produit final, les plugins de toutes les versions sont plac√©s dans un dossier, donc mes noms d'assembly restent avec le suffixe du formulaire <strong>_20xx</strong> .  Mais vous pouvez √©galement supprimer le suffixe du nom de l'assembly si l'emplacement des fichiers dans diff√©rents dossiers est suppos√©. </p><br><p>  Nous passons au code du fichier <em>Class1.cs</em> et y <em>simulons du</em> code, en tenant compte des diff√©rentes versions de Revit: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">MySuperPluginForRevit</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.Revit.Attributes; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.Revit.DB; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.Revit.UI; [Regeneration(RegenerationOption.Manual)] [Transaction(TransactionMode.Manual)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Class1</span></span> : <span class="hljs-title"><span class="hljs-title">IExternalCommand</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Result </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Execute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ExternalCommandData commandData, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message, ElementSet elements</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> R2015 TaskDialog.Show("ModPlus", "Hello Revit 2015"); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">elif</span></span></span><span class="hljs-meta"> R2016 TaskDialog.Show("ModPlus", "Hello Revit 2016"); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">elif</span></span></span><span class="hljs-meta"> R2017 TaskDialog.Show("ModPlus", "Hello Revit 2017"); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">elif</span></span></span><span class="hljs-meta"> R2018 TaskDialog.Show("ModPlus", "Hello Revit 2018"); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">elif</span></span></span><span class="hljs-meta"> R2019 TaskDialog.Show("ModPlus", "Hello Revit 2019"); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">elif</span></span></span><span class="hljs-meta"> R2020 TaskDialog.Show("ModPlus", "Hello Revit 2020"); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> return Result.Succeeded; } } }</span></span></code> </pre> <br><p>  J'ai imm√©diatement pris en compte toutes les versions de Revit au-dessus de la version 2015 (qui √©taient au moment de la r√©daction) et imm√©diatement pris en compte la pr√©sence de symboles de compilation conditionnelle, que je cr√©e en utilisant le m√™me mod√®le. </p><br><p>  Nous passons au point culminant principal.  Nous cr√©ons un nouveau projet dans notre solution, uniquement pour la version plug-in pour Revit 2016. Nous r√©p√©tons toutes les √©tapes d√©crites ci-dessus, respectivement, en rempla√ßant le num√©ro 2015 par le num√©ro 2016. Mais nous <em>supprimons le</em> fichier <em>Class1.cs</em> du nouveau projet. </p><br><img src="https://blog.modplus.org/images/Blog/Blog24_6.png" alt="image6"><br><br><p>  Le fichier avec le code souhait√© - <em>Class1.cs</em> - nous l'avons d√©j√† et nous avons juste besoin d'ins√©rer un lien vers celui-ci dans le nouveau projet.  Il existe deux fa√ßons d'ins√©rer des liens: </p><br><ol><li>  <strong>Long</strong> - cliquez sur le projet avec le bouton droit de la souris, s√©lectionnez l'√©l√©ment " <em>Ajouter</em> " -&gt; " <em>√âl√©ment existant</em> ", dans la fen√™tre qui s'ouvre, recherchez le fichier souhait√© et au lieu de l'option " <em>Ajouter</em> " s√©lectionnez l'option " <em>Ajouter comme lien</em> " </li></ol><br><img src="https://blog.modplus.org/images/Blog/Blog24_7.png" alt="image7"><br><br><ol><li>  <strong>Court</strong> - droit dans l'explorateur de solutions, s√©lectionnez le fichier souhait√© (ou m√™me des fichiers. Ou m√™me des dossiers entiers) et faites glisser et d√©posez dans le nouveau projet avec la touche Alt enfonc√©e.  Lors du glissement, vous verrez que lorsque vous appuyez sur la touche Alt, le curseur de la souris passera d'un signe plus √† une fl√®che. <br>  <strong>UPD:</strong> J'ai fait un peu de confusion dans cette section - pour transf√©rer plusieurs fichiers, maintenez <strong>Shift + Alt</strong> ! </li></ol><br><p>  Apr√®s la proc√©dure, nous verrons dans le deuxi√®me projet le fichier <em>Class1.cs</em> avec l'ic√¥ne correspondante (fl√®che bleue): </p><br><img src="https://blog.modplus.org/images/Blog/Blog24_8.png" alt="image8"><br><br><p>  Lors de l'√©dition du code dans la fen√™tre de l'√©diteur, vous pouvez √©galement choisir dans le contexte de quel projet afficher le code, ce qui vous permet de voir le code en cours d'√©dition avec diff√©rents symboles de compilation conditionnelle: </p><br><img src="https://blog.modplus.org/images/Blog/Blog24_9.png" alt="image9"><br><br><p>  Dans le cadre de ce programme, nous cr√©ons tous les autres projets (2017-2020).  Life hack - si vous faites glisser et d√©posez des fichiers dans l'explorateur de solutions non pas depuis le projet de base, mais depuis le projet o√π ils sont d√©j√† ins√©r√©s en tant que lien, vous ne pouvez pas maintenir la touche Alt enfonc√©e! </p><br><p>  L'option d√©crite est assez bonne jusqu'au moment o√π la nouvelle version du plugin est ajout√©e ou jusqu'√† ce que les nouveaux fichiers soient ajout√©s au projet - tout cela devient tr√®s morne.  Et r√©cemment, j'ai soudainement r√©alis√© comment r√©soudre tout cela avec un seul projet et nous passons √† la deuxi√®me m√©thode </p><br><h3 id="magiya-konfiguraciy">  Magie de configuration </h3><br><p>  Apr√®s avoir lu ici, vous pouvez vous exclamer: "Qu'est-ce que tu as d√©crit la premi√®re m√©thode, si l'article concerne imm√©diatement la seconde?!"  Et j'ai tout d√©crit pour expliquer pourquoi nous avons besoin de symboles de compilation conditionnelle et √† quels endroits nos projets diff√®rent.  Et maintenant, il devient plus clair pour nous quelles diff√©rences de projet sp√©cifiques nous devons mettre en ≈ìuvre, ne laissant qu'un seul projet. </p><br><p>  Et pour que tout soit plus √©vident, nous ne cr√©erons pas un nouveau projet, mais apporterons des modifications √† notre projet actuel, cr√©√© de la premi√®re mani√®re. </p><br><p>  Donc, tout d'abord, nous supprimons tous les projets de la solution, √† l'exception du principal (contenant directement les fichiers).  C'est-√†-dire  projets pour les versions 2016-2020.  Ouvrez le dossier de solution et supprimez-y les dossiers de ces projets. </p><br><p>  Il nous reste une solution dans la solution - <strong>MySuperPluginForRevit_2015</strong> .  Nous ouvrons ses propri√©t√©s et: </p><br><ol><li>  Dans l'onglet <em>Application</em> , supprimez le suffixe <strong>_2015</strong> du <strong>nom</strong> de l'assembly (il deviendra clair pourquoi) </li><li>  Dans l'onglet ¬´ <em>Assemblage</em> ¬ª, supprimez le <strong>symbole</strong> de compilation conditionnelle <strong>R2015</strong> du champ correspondant </li></ol><br><blockquote>  Remarque: dans la derni√®re version de Visual Studio, il y a un probl√®me - les symboles de compilation conditionnelle ne sont pas affich√©s dans la fen√™tre des propri√©t√©s du projet, bien qu'ils existent.  Si vous rencontrez ce probl√®me, vous devez les supprimer manuellement du fichier .csproj.  Cependant, nous y travaillons toujours, alors lisez la suite. </blockquote><p>  Renommez le projet dans la fen√™tre de l' <strong>explorateur de</strong> solutions en supprimant le suffixe <strong>_2015</strong> , puis supprimez le projet de la solution.  Cela est n√©cessaire pour maintenir l'ordre et les sentiments des perfectionnistes!  Nous ouvrons le dossier de notre solution, y renommons le dossier du projet de la m√™me mani√®re et chargeons le projet dans la solution. </p><br><p>  Ouvrez le gestionnaire de configuration.  En principe, nous n'aurons pas besoin de la configuration <strong>Release</strong> , nous la supprimons donc.  Nous cr√©ons de nouvelles configurations avec les noms <strong>R2015</strong> , <strong>R2016</strong> , ..., <strong>R2020</strong> qui nous sont d√©j√† familiers.  Veuillez noter que vous n'avez pas besoin de copier les param√®tres d'autres configurations et que vous n'avez pas besoin de cr√©er des configurations de projet: </p><br><img src="https://blog.modplus.org/images/Blog/Blog24_10.png" alt="image10"><br><p>  Nous allons dans le dossier du projet et ouvrons le fichier avec l'extension .csproj dans un √©diteur pratique.  Soit dit en passant, il peut √©galement √™tre ouvert dans Visual Studio - vous devez d√©charger le projet, puis le bon √©l√©ment sera dans le menu contextuel: </p><br><img src="https://blog.modplus.org/images/Blog/Blog24_11.png" alt="image11"><br><br><p>  L'√©dition dans Visual Studio est m√™me pr√©f√©rable, car l'√©diteur √† la fois aligne et invite. </p><br><p>  Dans le fichier, nous verrons les √©l√©ments <a href="https://docs.microsoft.com/ru-ru/visualstudio/msbuild/propertygroup-element-msbuild%3Fview%3Dvs-2019" rel="nofollow">PropertyGroup</a> - tout en haut est le g√©n√©ral, puis avec les conditions.  Ces √©l√©ments d√©finissent les propri√©t√©s du projet lors de son assemblage.  Le premier √©l√©ment, qui sans conditions, d√©finit les propri√©t√©s g√©n√©rales et les √©l√©ments avec conditions, respectivement, modifient certaines propri√©t√©s en fonction des configurations. </p><br><p>  Nous allons √† l'√©l√©ment g√©n√©ral (premier) du <em>PropertyGroup</em> et regardons la propri√©t√© <strong>AssemblyName</strong> - c'est le nom de l'assembly et nous devrions l'avoir sans le suffixe <strong>_2015</strong> .  S'il y a un suffixe, supprimez-le. </p><br><p>  On trouve un √©l√©ment avec la condition </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' "</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Nous n'en avons pas besoin - nous le supprimons. </p><br><p>  Clause de condition </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' "</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Il sera n√©cessaire de travailler au stade de d√©veloppement et de d√©bogage du code.  Vous pouvez modifier ses propri√©t√©s selon vos besoins - d√©finir diff√©rents chemins de sortie, modifier les symboles de compilation conditionnelle, etc. </p><br><p>  Cr√©ez maintenant de nouveaux √©l√©ments <em>PropertyGroup</em> pour nos configurations.  Dans ces √©l√©ments, nous avons juste besoin de d√©finir quatre propri√©t√©s: </p><br><ul><li>  <strong>OutputPath</strong> est le dossier de sortie.  J'ai d√©fini la valeur standard <strong>bin \ R20xx</strong> </li><li>  <strong>DefineConstants</strong> - symboles de compilation conditionnelle.  <strong>D√©finissez TRACE; R20xx</strong> </li><li>  <strong>TargetFrameworkVersion</strong> - version de la plateforme.  Pour diff√©rentes versions de l'API Revit, diff√©rentes plates-formes doivent √™tre d√©finies. </li><li>  <strong>AssemblyName</strong> - nom de l'assembly (c'est-√†-dire le nom du fichier).  Vous pouvez √©crire directement le nom d'assembly souhait√©, mais pour l'universalit√©, je recommande d'√©crire la valeur de <strong>$ (AssemblyName) _20xx</strong> .  Pour ce faire, nous avons pr√©c√©demment supprim√© le suffixe du nom de l'assembly </li></ul><br><p>  La caract√©ristique la plus importante de tous ces √©l√©ments est qu'ils peuvent √™tre copi√©s trivialement dans d'autres projets sans les changer du tout.  Plus loin dans l'article, je joindrai tout le contenu du fichier .csproj. </p><br><p>  Eh bien, nous avons d√©termin√© les propri√©t√©s du projet - ce n'est pas difficile.  Mais que faire des biblioth√®ques de plug-ins (packages NuGet).  Si nous regardons plus loin, nous verrons que les biblioth√®ques de plug-ins sont d√©finies par des √©l√©ments <a href="https://docs.microsoft.com/ru-ru/visualstudio/msbuild/itemgroup-element-msbuild%3Fview%3Dvs-2019" rel="nofollow">ItemGroup</a> .  Mais voici la malchance - cet √©l√©ment traite incorrectement les conditions, comme un √©l√©ment <em>PropertyGroup</em> .  Il s'agit peut-√™tre m√™me d'un probl√®me de Visual Studio, mais si vous d√©finissez plusieurs √©l√©ments <em>ItemGroup</em> avec des conditions de configuration et ins√©rez diff√©rents liens vers les packages NuGet √† l'int√©rieur, puis lorsque vous modifiez la configuration, tous les packages sp√©cifi√©s sont connect√©s au projet. </p><br><p>  L'√©l√©ment <a href="https://docs.microsoft.com/ru-ru/visualstudio/msbuild/choose-element-msbuild%3Fview%3Dvs-2019" rel="nofollow">Choose</a> vient √† notre aide, qui fonctionne selon la logique habituelle <strong>if-then-else</strong> . </p><br><p>  En utilisant l'√©l√©ment <em>Choose</em> , nous d√©finissons diff√©rents packages NuGet pour diff√©rentes configurations: </p><br><div class="spoiler">  <b class="spoiler_title">Tout le contenu de csproj</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ToolsVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"15.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/developer/msbuild/2003"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Project</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Configuration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)' == '' "</span></span></span><span class="hljs-tag">&gt;</span></span>Debug<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Platform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Platform)' == '' "</span></span></span><span class="hljs-tag">&gt;</span></span>AnyCPU<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Platform</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProjectGuid</span></span></span><span class="hljs-tag">&gt;</span></span>{5AD738D6-4122-4E76-B865-BE7CE0F6B3EB}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProjectGuid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputType</span></span></span><span class="hljs-tag">&gt;</span></span>Library<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputType</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AppDesignerFolder</span></span></span><span class="hljs-tag">&gt;</span></span>Properties<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AppDesignerFolder</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RootNamespace</span></span></span><span class="hljs-tag">&gt;</span></span>MySuperPluginForRevit<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RootNamespace</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AssemblyName</span></span></span><span class="hljs-tag">&gt;</span></span>MySuperPluginForRevit<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AssemblyName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFrameworkVersion</span></span></span><span class="hljs-tag">&gt;</span></span>v4.5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFrameworkVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FileAlignment</span></span></span><span class="hljs-tag">&gt;</span></span>512<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FileAlignment</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Deterministic</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Deterministic</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DebugSymbols</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DebugSymbols</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DebugType</span></span></span><span class="hljs-tag">&gt;</span></span>full<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DebugType</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Optimize</span></span></span><span class="hljs-tag">&gt;</span></span>false<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Optimize</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputPath</span></span></span><span class="hljs-tag">&gt;</span></span>bin\Debug\<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputPath</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DefineConstants</span></span></span><span class="hljs-tag">&gt;</span></span>DEBUG;R2015<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DefineConstants</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ErrorReport</span></span></span><span class="hljs-tag">&gt;</span></span>prompt<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ErrorReport</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WarningLevel</span></span></span><span class="hljs-tag">&gt;</span></span>4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WarningLevel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)|$(Platform)' == 'R2015|AnyCPU' "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputPath</span></span></span><span class="hljs-tag">&gt;</span></span>bin\R2015\<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputPath</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DefineConstants</span></span></span><span class="hljs-tag">&gt;</span></span>TRACE;R2015<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DefineConstants</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFrameworkVersion</span></span></span><span class="hljs-tag">&gt;</span></span>v4.5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFrameworkVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AssemblyName</span></span></span><span class="hljs-tag">&gt;</span></span>$(AssemblyName)_2015<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AssemblyName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)|$(Platform)' == 'R2016|AnyCPU' "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputPath</span></span></span><span class="hljs-tag">&gt;</span></span>bin\R2016\<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputPath</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DefineConstants</span></span></span><span class="hljs-tag">&gt;</span></span>TRACE;R2016<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DefineConstants</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFrameworkVersion</span></span></span><span class="hljs-tag">&gt;</span></span>v4.5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFrameworkVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AssemblyName</span></span></span><span class="hljs-tag">&gt;</span></span>$(AssemblyName)_2016<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AssemblyName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)|$(Platform)' == 'R2017|AnyCPU' "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputPath</span></span></span><span class="hljs-tag">&gt;</span></span>bin\R2017\<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputPath</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DefineConstants</span></span></span><span class="hljs-tag">&gt;</span></span>TRACE;R2017<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DefineConstants</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFrameworkVersion</span></span></span><span class="hljs-tag">&gt;</span></span>v4.5.2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFrameworkVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AssemblyName</span></span></span><span class="hljs-tag">&gt;</span></span>$(AssemblyName)_2017<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AssemblyName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)|$(Platform)' == 'R2018|AnyCPU' "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputPath</span></span></span><span class="hljs-tag">&gt;</span></span>bin\R2018\<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputPath</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DefineConstants</span></span></span><span class="hljs-tag">&gt;</span></span>TRACE;R2018<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DefineConstants</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFrameworkVersion</span></span></span><span class="hljs-tag">&gt;</span></span>v4.5.2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFrameworkVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AssemblyName</span></span></span><span class="hljs-tag">&gt;</span></span>$(AssemblyName)_2018<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AssemblyName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)|$(Platform)' == 'R2019|AnyCPU' "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputPath</span></span></span><span class="hljs-tag">&gt;</span></span>bin\R2019\<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputPath</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DefineConstants</span></span></span><span class="hljs-tag">&gt;</span></span>TRACE;R2019<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DefineConstants</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFrameworkVersion</span></span></span><span class="hljs-tag">&gt;</span></span>v4.7<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFrameworkVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AssemblyName</span></span></span><span class="hljs-tag">&gt;</span></span>$(AssemblyName)_2019<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AssemblyName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)|$(Platform)' == 'R2020|AnyCPU' "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputPath</span></span></span><span class="hljs-tag">&gt;</span></span>bin\R2020\<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputPath</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DefineConstants</span></span></span><span class="hljs-tag">&gt;</span></span>TRACE;R2020<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DefineConstants</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFrameworkVersion</span></span></span><span class="hljs-tag">&gt;</span></span>v4.7<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFrameworkVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AssemblyName</span></span></span><span class="hljs-tag">&gt;</span></span>$(AssemblyName)_2020<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AssemblyName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Core"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Xml.Linq"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Data.DataSetExtensions"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft.CSharp"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Data"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Net.Http"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Reference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Xml"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Compile</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Class1.cs"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Compile</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Properties\AssemblyInfo.cs"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Choose</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">When</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)'=='R2015' "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ModPlus.Revit.API.2015"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcludeAssets</span></span></span><span class="hljs-tag">&gt;</span></span>runtime<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcludeAssets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">When</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">When</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)'=='R2016' "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ModPlus.Revit.API.2016"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcludeAssets</span></span></span><span class="hljs-tag">&gt;</span></span>runtime<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcludeAssets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">When</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">When</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)'=='R2017' "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ModPlus.Revit.API.2017"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcludeAssets</span></span></span><span class="hljs-tag">&gt;</span></span>runtime<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcludeAssets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">When</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">When</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)'=='R2018' "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ModPlus.Revit.API.2018"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcludeAssets</span></span></span><span class="hljs-tag">&gt;</span></span>runtime<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcludeAssets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">When</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">When</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)'=='R2019' "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ModPlus.Revit.API.2019"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcludeAssets</span></span></span><span class="hljs-tag">&gt;</span></span>runtime<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcludeAssets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">When</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">When</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Condition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" '$(Configuration)'=='R2020' or '$(Configuration)'=='Debug'"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ModPlus.Revit.API.2020"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcludeAssets</span></span></span><span class="hljs-tag">&gt;</span></span>runtime<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcludeAssets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">When</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Choose</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Project</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(MSBuildToolsPath)\Microsoft.CSharp.targets"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br><p>  Veuillez noter que dans l'une des conditions, j'ai sp√©cifi√© deux configurations via <strong>OR (ou)</strong> .  Ainsi, le package n√©cessaire sera connect√© lors de la configuration du <strong>d√©bogage</strong> . </p><br><p>  Et ici, nous avons presque tout est parfait.  Nous chargeons le projet, <em>activons</em> la configuration dont nous avons besoin, appelons l'√©l√©ment ¬´ <em>Restaurer tous les packages NuGet</em> ¬ª dans le menu contextuel de la solution (pas le projet) et voyons comment les packages changent. </p><br><img src="https://blog.modplus.org/images/Blog/Blog24_12.png" alt="image12"><br><br><p>  Et √† ce stade, je me suis arr√™t√© - afin de collecter toutes les configurations √† la fois, nous pourrions utiliser l'assemblage par lots (menu " <em>Assemblage</em> " -&gt; " <em>Assemblage par lots</em> "), mais lors du changement de configuration, les packages ne sont pas automatiquement restaur√©s.  Et lors de l'assemblage du projet, cela ne se produit pas non plus, m√™me si, en th√©orie, cela devrait se produire.  Je n'ai pas trouv√© de solution √† ce probl√®me par des moyens standard.  Et il s'agit tr√®s probablement d'un bogue de Visual Studio. </p><br><p>  Par cons√©quent, pour l'assemblage par lots, il a √©t√© d√©cid√© d'utiliser un syst√®me d'assemblage automatis√© sp√©cial <a href="https://nuke.build/" rel="nofollow">Nuke</a> .  En fait, je ne le voulais pas, car je le consid√®re inutile dans le cadre du d√©veloppement de plug-ins, mais pour le moment je ne vois pas d'autre solution.  Et la question ¬´Pourquoi exactement Nuke?¬ª La r√©ponse est simple - nous l'utilisons au travail. </p><br><p>  Donc, nous allons dans le dossier de notre solution (pas le projet), maintenez la <strong>touche Maj enfonc√©e</strong> et cliquez avec le bouton droit sur un emplacement vide dans le dossier - dans le menu contextuel, s√©lectionnez l'√©l√©ment " <em>Ouvrir la fen√™tre PowerShell ici</em> ". </p><br><img src="https://blog.modplus.org/images/Blog/Blog24_13.png" alt="image13"><br><br><p>  Si vous n'avez pas install√© <em>Nuke</em> , √©crivez d'abord la commande </p><br><pre> <code class="powershell hljs">dotnet tool install Nuke.GlobalTool ‚Äìglobal</code> </pre> <br><p>  Maintenant, √©crivez la commande <strong>nuke</strong> et il vous sera demand√© de configurer <em>nuke</em> pour le projet en cours.  Je ne sais pas comment l'√©crire plus correctement en russe - Impossible de trouver le fichier .nuke sera √©crit en anglais.  Voulez-vous configurer une build?  [o / n] </p><br><p>  Appuyez sur la touche Y, puis il y aura les param√®tres imm√©diats.  Nous avons besoin de l'option la plus simple √† l'aide de <strong>MSBuild</strong> , nous r√©pondons donc comme dans la capture d'√©cran: </p><br><img src="https://blog.modplus.org/images/Blog/Blog24_14.png" alt="image14"><br><br><p>  Passons √† Visual Studio, qui nous proposera de recharger la solution, puisqu'un nouveau projet y a √©t√© ajout√©.  Nous red√©marrons la solution et voyons que nous avons un projet de <strong>build</strong> dans lequel nous ne sommes int√©ress√©s que par un seul fichier - <em>Build.cs</em> </p><br><img src="https://blog.modplus.org/images/Blog/Blog24_15.png" alt="image15"><br><br><p>  Ouvrez ce fichier et √©crivez un script pour g√©n√©rer le projet pour toutes les configurations.  Eh bien, ou utilisez mon script, que vous pouvez modifier vous-m√™me: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Nuke.Common; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Nuke.Common.Execution; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Nuke.Common.ProjectModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Nuke.Common.Tools.MSBuild; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Nuke.Common.Tools.MSBuild.MSBuildTasks; [CheckBuildProjectConfigurations] [UnsetVisualStudioEnvironmentVariables] <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Build</span></span> : <span class="hljs-title"><span class="hljs-title">NukeBuild</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; Execute&lt;Build&gt;(x =&gt; x.Compile); [Solution] <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> Solution Solution; <span class="hljs-comment"><span class="hljs-comment">// If the solution name and the project (plugin) name are different, then indicate the project (plugin) name here string PluginName =&gt; Solution.Name; Target Compile =&gt; _ =&gt; _ .Executes(() =&gt; { var project = Solution.GetProject(PluginName); if (project == null) throw new FileNotFoundException("Not found!"); var build = new List&lt;string&gt;(); foreach (var (_, c) in project.Configurations) { var configuration = c.Split("|")[0]; if (configuration == "Debug" || build.Contains(configuration)) continue; Logger.Normal($"Configuration: {configuration}"); build.Add(configuration); MSBuild(_ =&gt; _ .SetProjectFile(project.Path) .SetConfiguration(configuration) .SetTargets("Restore")); MSBuild(_ =&gt; _ .SetProjectFile(project.Path) .SetConfiguration(configuration) .SetTargets("Rebuild")); } }); }</span></span></code> </pre> <br><p>  Nous revenons √† la fen√™tre PowerShell et √©crivons √† nouveau la commande <strong>nuke</strong> (vous pouvez √©crire la commande <strong>nuke</strong> avec la <em>cible</em> souhait√©e. Mais nous avons une <em>cible</em> , qui d√©marre par d√©faut).  Apr√®s avoir appuy√© sur la touche Entr√©e, nous nous sentirons comme de vrais hackers, car comme dans un film, notre projet sera automatiquement assembl√© pour diff√©rentes configurations. </p><br><p>  Soit dit en passant, vous pouvez utiliser PowerShell directement √† partir de Visual Studio (menu " <em>Affichage</em> " -&gt; " <em>Autres fen√™tres</em> " -&gt; " <em>Console du gestionnaire de packages</em> "), mais tout sera en noir et blanc, ce qui n'est pas tr√®s pratique. </p><br><p>  Sur ce mon article est termin√©.  Je suis s√ªr que vous pouvez trouver vous-m√™me l'option pour AutoCAD.  J'esp√®re que le mat√©riel pr√©sent√© ici trouvera ses "clients". </p><br><p>  Merci de votre attention! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr482308/">https://habr.com/ru/post/fr482308/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr482296/index.html">Tutoriel du tutoriel Ember.js. Application Super Rentals. Partie 1.1</a></li>
<li><a href="../fr482300/index.html">Explorer les enregistrements Java 14</a></li>
<li><a href="../fr482302/index.html">Brume psychologique sur la nouvelle ann√©e</a></li>
<li><a href="../fr482304/index.html">Made for China: comment cr√©er la banni√®re parfaite pour le consommateur chinois</a></li>
<li><a href="../fr482306/index.html">Histoire du porno sur Internet. Partie 1</a></li>
<li><a href="../fr482310/index.html">Le transport des animaux au 21e si√®cle</a></li>
<li><a href="../fr482314/index.html">Cr√©ation d'un cluster PostgreSQL haute disponibilit√© √† l'aide de Patroni, etcd, HAProxy</a></li>
<li><a href="../fr482316/index.html">Nous compliquons les mod√®les de science-fiction sur le plan de la proc√©dure: qu'est-ce que Greeble et comment l'utiliser</a></li>
<li><a href="../fr482318/index.html">Pourquoi Rust devrait devenir un langage de programmation fonctionnel</a></li>
<li><a href="../fr482328/index.html">V&V pas pour vendetta</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>