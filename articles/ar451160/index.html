<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ค๏ธ ๐ ๐ฅ ุฃุจุงุชุดู ูุงููุง ูุงูุฌุฑู ูุน ุดุฑุงุฑุฉ ุงูุฌุฑู ๐ค๏ธ ๐ ๐จ๐ปโ๐จ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฑุญุจุง ูุง ูุจุฑ! ุงูููู ุณูููู ุจุจูุงุก ูุธุงู ูุณุชุฎุฏู Apark Kafka ููุนุงูุฌุฉ ุชุฏููุงุช ุงูุฑุณุงุฆู ุจุงุณุชุฎุฏุงู Spark Streaming ููุชุงุจุฉ ูุชูุฌุฉ ุงููุนุงูุฌุฉ ุฅูู ูุงุนุฏุฉ ุจูุงูุงุช AWS RDS...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฃุจุงุชุดู ูุงููุง ูุงูุฌุฑู ูุน ุดุฑุงุฑุฉ ุงูุฌุฑู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451160/" style=";text-align:right;direction:rtl">  ูุฑุญุจุง ูุง ูุจุฑ!  ุงูููู ุณูููู ุจุจูุงุก ูุธุงู ูุณุชุฎุฏู Apark Kafka ููุนุงูุฌุฉ ุชุฏููุงุช ุงูุฑุณุงุฆู ุจุงุณุชุฎุฏุงู Spark Streaming ููุชุงุจุฉ ูุชูุฌุฉ ุงููุนุงูุฌุฉ ุฅูู ูุงุนุฏุฉ ุจูุงูุงุช AWS RDS ุงูุณุญุงุจูุฉ. <br><br>  ุชุฎูู ุฃู ูุคุณุณุฉ ุงุฆุชูุงููุฉ ูุนููุฉ ูุฏ ุญุฏุฏุช ููุง ูููุฉ ูุนุงูุฌุฉ ุงููุนุงููุงุช ุงููุงุฑุฏุฉ ูู ุฌููุน ูุฑูุนูุง.  ูููู ุงูููุงู ุจุฐูู ูู ุฃุฌู ุญุณุงุจ ูุฑูุฒ ุงูุนููุฉ ุงูููุชูุญุฉ ุจุณุฑุนุฉ ููุฎุฒุงูุฉ ุฃู ุงูุญุฏูุฏ ุฃู ุงููุชุงุฆุฌ ุงููุงููุฉ ูููุนุงููุงุช ุ ุฅูุฎ. <br><br>  ููููุฉ ุชูููุฐ ูุฐู ุงูุญุงูุฉ ุฏูู ุงุณุชุฎุฏุงู ุชุนุงููุฐ ุณุญุฑูุฉ ูุณุญุฑ - ููุฑุฃ ุชุญุช ุฎูุถ!  ุฏุนูุง ูุฐูุจ! <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/5w/sb/8v/5wsb8vvncrzhysct-pd6oqraqky.jpeg"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">(ูุตุฏุฑ ุงูุตูุฑุฉ)</a> <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ููุฏูุฉ </h2><br>  ุจุงูุทุจุน ุ ุชููุฑ ูุนุงูุฌุฉ ูุฌููุนุฉ ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ูู ุงูููุช ุงูุญูููู ูุฑุตูุง ูุจูุฑุฉ ููุงุณุชุฎุฏุงู ูู ุงูุฃูุธูุฉ ุงูุญุฏูุซุฉ.  ูุงุญุฏุฉ ูู ุฃูุซุฑ ุงููุฌููุนุงุช ุดููุนูุง ููุฐุง ุงูุฃูุฑ ูู Apache Kafka ู Spark Streaming ุฌูุจูุง ุฅูู ุฌูุจ ุ ุญูุซ ุชูุดุฆ Kafka ูุฌููุนุฉ ูู ุญุฒู ุงูุฑุณุงุฆู ุงููุงุฑุฏุฉ ุ ููููู Spark Streaming ุจูุนุงูุฌุฉ ูุฐู ุงูุญุฒู ูู ูุชุฑุฉ ุฒูููุฉ ูุญุฏุฏุฉ. <br><br>  ูุฒูุงุฏุฉ ุงูุชุณุงูุญ ูุน ุงูุฎุทุฃ ููุชุทุจูู ุ ุณูู ูุณุชุฎุฏู ููุงุท ุงูุชูุชูุด - ููุงุท ุงูุชูุชูุด.  ุจุงุณุชุฎุฏุงู ูุฐู ุงูุขููุฉ ุ ุนูุฏูุง ุชุญุชุงุฌ ูุญุฏุฉ Spark Streaming ูุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช ุงูููููุฏุฉ ุ ูุฅููุง ุชุญุชุงุฌ ููุท ููุนูุฏุฉ ุฅูู ููุทุฉ ุงูุชุญูู ุงูุฃุฎูุฑุฉ ูุงุณุชุฆูุงู ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ูููุง. <br><br><h2 style=";text-align:right;direction:rtl">  ุจููุฉ ุงููุธุงู ููุฏ ุงูุชุทููุฑ </h2><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/od/ef/zc/odefzciug8ckvim4-ei6pdg49tw.png"></div><br><br>  ุงูููููุงุช ุงููุณุชุฎุฏูุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><b>Apache Kafka</b></a> ูู ูุธุงู ุฑุณุงุฆู ููุฒุน ูุน ูุดุฑ ูุงุดุชุฑุงู.  ููุงุณุจุฉ ูููุง ุงุณุชููุงู ุงูุฑุณุงุฆู ุนุจุฑ ุงูุฅูุชุฑูุช ูุบูุฑ ูุชุตู.  ูููุน ููุฏุงู ุงูุจูุงูุงุช ุ ูุชู ุชุฎุฒูู ุฑุณุงุฆู ูุงููุง ุนูู ุงููุฑุต ูุชูุฑุงุฑูุง ุฏุงุฎู ุงููุฌููุนุฉ.  ูุธุงู Kafka ูุจูู ุนูู ุฃุนูู ุฎุฏูุฉ ูุฒุงููุฉ ZooKeeper ุ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><b>Apache Spark Streaming</b></a> - ูููู Spark ููุนุงูุฌุฉ ุจูุงูุงุช ุงูุชุฏูู.  ุชู ุชุตููู ูุญุฏุฉ Spark Streaming ุจุงุณุชุฎุฏุงู ุจููุฉ ุงูุฏููุนุงุช ุงูุตุบูุฑุฉ ุ ุนูุฏูุง ูุชู ุชูุณูุฑ ุฏูู ุงูุจูุงูุงุช ุนูู ุฃูู ุชุณูุณู ูุณุชูุฑ ูุญุฒู ุงูุจูุงูุงุช ุงูุตุบูุฑุฉ.  ูุชููู Spark Streaming ุงูุจูุงูุงุช ูู ูุตุงุฏุฑ ูุฎุชููุฉ ููุฌูุนูุง ูู ุญุฒู ุตุบูุฑุฉ.  ูุชู ุฅูุดุงุก ุญุฒู ุฌุฏูุฏุฉ ุนูู ูุชุฑุงุช ููุชุธูุฉ.  ูู ุจุฏุงูุฉ ูู ูุงุตู ุฒููู ุ ูุชู ุฅูุดุงุก ุญุฒูุฉ ุฌุฏูุฏุฉ ุ ููุชู ุชุถููู ุฃู ุจูุงูุงุช ูุชู ุชููููุง ุฎูุงู ูุฐู ุงููุชุฑุฉ ูู ุงูุญุฒูุฉ.  ูู ููุงูุฉ ุงููุงุตู ุงูุฒููู ุ ูุชููู ููู ุงูุญุฒูุฉ.  ูุชู ุชุญุฏูุฏ ุญุฌู ุงููุงุตู ุงูุฒููู ุจูุงุณุทุฉ ูุนููุฉ ุชุณูู ุงููุงุตู ุงูุฏูุนูุ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><b>ุ Apache Spark SQL</b></a> - ูุฌูุน ุจูู ุงููุนุงูุฌุฉ ุงูุนูุงุฆููุฉ ูุงูุจุฑูุฌุฉ ุงููุธูููุฉ ูู Spark.  ุชุดูุฑ ุงูุจูุงูุงุช ุงููููููุฉ ุฅูู ุงูุจูุงูุงุช ุงูุชู ุชุญุชูู ุนูู ูุฎุทุท ุ ุฃู ูุฌููุนุฉ ูุงุญุฏุฉ ูู ุงูุญููู ูุฌููุน ุงูุณุฌูุงุช.  ูุฏุนู Spark SQL ุงููุฏุฎูุงุช ูู ูุฌููุนุฉ ูุชููุนุฉ ูู ูุตุงุฏุฑ ุงูุจูุงูุงุช ุงููููููุฉ ุ ูุจูุถู ุชูุงูุฑ ุงููุนูููุงุช ุญูู ุงููุฎุทุท ุ ููููู ุงุณุชุฑุฏุงุฏ ุญููู ุงูุณุฌูุงุช ุงููุทููุจุฉ ุจููุงุกุฉ ุ ููุง ูููุฑ ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช DataFrame ุ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><b>AWS RDS</b></a> ูู ูุงุนุฏุฉ ุจูุงูุงุช ุนูุงุฆููุฉ ูุณุชูุฏุฉ ุฅูู ูุฌููุนุฉ ุงููุธุฑุงุก ุบูุฑ ููููุฉ ูุณุจููุง ุ ููู ุฎุฏูุฉ ููุจ ุชุนูู ุนูู ุชุจุณูุท ุงูุชูููู ูุงูุชุดุบูู ูุงูุชุญุฌูู ุ ูุชุฏูุฑูุง Amazon ูุจุงุดุฑุฉู. </li></ul><br><h2 style=";text-align:right;direction:rtl">  ุชุซุจูุช ูุจุฏุก ุฎุงุฏู ูุงููุง </h2><br>  ูุจู ุงุณุชุฎุฏุงู Kafka ูุจุงุดุฑุฉ ุ ุชุญุชุงุฌ ุฅูู ุงูุชุฃูุฏ ูู ุชููุฑ Java ุ ูุซู  ูุณุชุฎุฏู JVM ููุนูู: <br><br><pre style=";text-align:right;direction:rtl"><code class="bash hljs">sudo apt-get update sudo apt-get install default-jre java -version</code> </pre> <br>  ูู ุจุฅูุดุงุก ูุณุชุฎุฏู ุฌุฏูุฏ ููุนูู ูุน Kafka: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo useradd kafka -m sudo passwd kafka sudo adduser kafka sudo</code> </pre><br>  ุจุนุฏ ุฐูู ุ ูู ุจุชูุฒูู ุงูุชูุฒูุน ูู ูููุน Apache Kafka ุงูุฑุณูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">wget -P /YOUR_PATH <span class="hljs-string"><span class="hljs-string">"http://apache-mirror.rbc.ru/pub/apache/kafka/2.2.0/kafka_2.12-2.2.0.tgz"</span></span></code> </pre> <br>  ูู ุงูุฃุฑุดูู ุงูุฐู ุชู ุชูุฒููู: <br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">tar -xvzf /YOUR_PATH/kafka_2.12-2.2.0.tgz ln -s /YOUR_PATH/kafka_2.12-2.2.0 kafka</code> </pre><br>  ุงูุฎุทูุฉ ุงูุชุงููุฉ ุงุฎุชูุงุฑูุฉ.  ุงูุญูููุฉ ูู ุฃู ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ ูุง ุชุณูุญ ุจุงูุงุณุชุฎุฏุงู ุงููุงูู ูุฌููุน ููุฒุงุช Apache Kafka.  ุนูู ุณุจูู ุงููุซุงู ุ ุงุญุฐู ููุถูุนูุง ุฃู ูุฆุฉ ุฃู ูุฌููุนุฉ ูููู ูุดุฑ ุงูุฑุณุงุฆู ุนูููุง.  ูุชุบููุฑ ูุฐุง ุ ูู ุจุชุญุฑูุฑ ููู ุงูุชูููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">vim ~/kafka/config/server.properties</code> </pre> <br>  ุฃุถู ูุง ููู ุฅูู ููุงูุฉ ุงูููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">delete.topic.enable = <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br>  ูุจู ุจุฏุก ุชุดุบูู ุฎุงุฏู Kafka ุ ุชุญุชุงุฌ ุฅูู ุจุฏุก ุชุดุบูู ุฎุงุฏู ZooKeeper ุ ูุณูู ูุณุชุฎุฏู ุงูุจุฑูุงูุฌ ุงููุตู ุงููุณุงุนุฏ ุงูุฐู ูุฃุชู ูุน ุชูุฒูุน Kafka: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">Cd ~/kafka bin/zookeeper-server-start.sh config/zookeeper.properties</code> </pre><br>  ุจุนุฏ ุจุฏุก ZooKeeper ุจูุฌุงุญ ุ ูู ูุญุทุฉ ูููุตูุฉ ูุทูู ุฎุงุฏู Kafka: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">bin/kafka-server-start.sh config/server.properties</code> </pre> <br>  ุฅูุดุงุก ููุถูุน ุฌุฏูุฏ ูุณูู ุงููุนุงููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 3 --topic transaction</code> </pre> <br>  ุชุฃูุฏ ูู ุฅูุดุงุก ุงูููุถูุน ุจุงูุนุฏุฏ ุงูุตุญูุญ ูู ุงูุฃูุณุงู ูุงููุณุฎ ุงููุชูุงุซู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">bin/kafka-topics.sh --describe --zookeeper localhost:2181</code> </pre> <br><img src="https://habrastorage.org/webt/s5/gh/bu/s5ghbuswhb0dcc0pmlvu_uloes4.png"><br><br>  ุณููุชูุฏ ูุญุธุงุช ุงุฎุชุจุงุฑ ุงูููุชุฌ ูุงููุณุชููู ููููุถูุน ุงูุฐู ุชู ุฅูุดุงุคู ุญุฏูุซูุง.  ููุฒูุฏ ูู ุงูุชูุงุตูู ุญูู ููููุฉ ุงุฎุชุจุงุฑ ุฅุฑุณุงู ูุงุณุชูุจุงู ุงูุฑุณุงุฆู ุ ุฑุงุฌุน ุงููุซุงุฆู ุงูุฑุณููุฉ - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฅุฑุณุงู ุจุนุถ ุงูุฑุณุงุฆู</a> .  ุญุณููุง ุ ููุชูู ุฅูู ูุชุงุจุฉ ููุชุฌ ูู Python ุจุงุณุชุฎุฏุงู API KafkaProducer. <br><br><h2 style=";text-align:right;direction:rtl">  ูุชุงุจุฉ ุงูููุชุฌ </h2><br>  ุณูููู ุงูููุชุฌ ุจุฅูุดุงุก ุจูุงูุงุช ุนุดูุงุฆูุฉ - 100 ุฑุณุงูุฉ ูู ูู ุซุงููุฉ.  ูุนูู ุจุงูุจูุงูุงุช ุงูุนุดูุงุฆูุฉ ูุงููุณ ูุชููู ูู ุซูุงุซุฉ ุญููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>ุงููุฑุน</b> - ุงุณู ููุทุฉ ุจูุน ุงููุคุณุณุฉ ุงูุงุฆุชูุงููุฉ ุ </li><li style=";text-align:right;direction:rtl">  <b>ุงูุนููุฉ</b> - <b>ุนููุฉ</b> ุงููุนุงููุฉ ุ </li><li style=";text-align:right;direction:rtl">  <b>ุงููุจูุบ</b> - ูุจูุบ ุงูุตููุฉ.  ุณูููู ุงููุจูุบ ุฑูููุง ุฅูุฌุงุจููุง ุฅุฐุง ูุงู ุดุฑุงุก ุนููุฉ ูู ูุจู ุงูุจูู ุ ูุณุงูุจูุง ุฅุฐุง ูุงู ุนูููุฉ ุจูุน. </li></ul><br>  ุฑูุฒ ุงูููุชุฌ ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> numpy.random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> choice, randint <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_random_value</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> new_dict = {} branch_list = [<span class="hljs-string"><span class="hljs-string">'Kazan'</span></span>, <span class="hljs-string"><span class="hljs-string">'SPB'</span></span>, <span class="hljs-string"><span class="hljs-string">'Novosibirsk'</span></span>, <span class="hljs-string"><span class="hljs-string">'Surgut'</span></span>] currency_list = [<span class="hljs-string"><span class="hljs-string">'RUB'</span></span>, <span class="hljs-string"><span class="hljs-string">'USD'</span></span>, <span class="hljs-string"><span class="hljs-string">'EUR'</span></span>, <span class="hljs-string"><span class="hljs-string">'GBP'</span></span>] new_dict[<span class="hljs-string"><span class="hljs-string">'branch'</span></span>] = choice(branch_list) new_dict[<span class="hljs-string"><span class="hljs-string">'currency'</span></span>] = choice(currency_list) new_dict[<span class="hljs-string"><span class="hljs-string">'amount'</span></span>] = randint(<span class="hljs-number"><span class="hljs-number">-100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> new_dict</code> </pre><br>  ุจุนุฏ ุฐูู ุ ุจุงุณุชุฎุฏุงู ุทุฑููุฉ ุงูุฅุฑุณุงู ุ ูุฑุณู ุฑุณุงูุฉ ุฅูู ุงูุฎุงุฏู ุ ูู ุงูููุถูุน ุงูุฐู ูุญุชุงุฌู ุ ุจุชูุณูู JSON: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kafka <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> KafkaProducer producer = KafkaProducer(bootstrap_servers=[<span class="hljs-string"><span class="hljs-string">'localhost:9092'</span></span>], value_serializer=<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x:dumps(x).encode(<span class="hljs-string"><span class="hljs-string">'utf-8'</span></span>), compression_type=<span class="hljs-string"><span class="hljs-string">'gzip'</span></span>) my_topic = <span class="hljs-string"><span class="hljs-string">'transaction'</span></span> data = get_random_value() <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: future = producer.send(topic = my_topic, value = data) record_metadata = future.get(timeout=<span class="hljs-number"><span class="hljs-number">10</span></span>) print(<span class="hljs-string"><span class="hljs-string">'--&gt; The message has been sent to a topic: \ {}, partition: {}, offset: {}'</span></span> \ .format(record_metadata.topic, record_metadata.partition, record_metadata.offset )) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e: print(<span class="hljs-string"><span class="hljs-string">'--&gt; It seems an Error occurred: {}'</span></span>.format(e)) <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span>: producer.flush()</code> </pre><br>  ุนูุฏ ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู ุ ูุชููู ุงูุฑุณุงุฆู ุงูุชุงููุฉ ูู ุงูุฌูุงุฒ: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/_e/3g/zj/_e3gzjrmsycjb8ntjmur6ztaspw.png"></div><br>  ูุฐุง ูุนูู ุฃู ูู ุดูุก ูุนูู ููุง ุฃุฑุฏูุง - ูููู ุงูููุชุฌ ุจุฅูุดุงุก ูุฅุฑุณุงู ุฑุณุงุฆู ุฅูู ุงูููุถูุน ุงูุฐู ูุญุชุงุฌ ุฅููู. <br><br>  ูุงูุฎุทูุฉ ุงูุชุงููุฉ ูู ุชุซุจูุช Spark ููุนุงูุฌุฉ ุชุฏูู ุงูุฑุณุงูุฉ ูุฐุง. <br><br><h2 style=";text-align:right;direction:rtl">  ุชุซุจูุช ุงุจุงุชุดู ุณุจุงุฑู </h2><br>  <b>Apache Spark</b> ุนุจุงุฑุฉ ุนู ููุตุฉ ุญูุณุจุฉ ุนูููุฏูุฉ ูุชุนุฏุฏุฉ ุงูุงุณุชุฎุฏุงูุงุช ูุนุงููุฉ ุงูุฃุฏุงุก. <br><br>  ูููุง ูุชุนูู ุจุงูุฃุฏุงุก ุ ูุชููู Spark ุนูู ุงูุชุทุจููุงุช ุงูุดุงุฆุนุฉ ููููุฐุฌ MapReduce ุ ููููุฑ ูู ุงูููุช ููุณู ุงูุฏุนู ููุฌููุนุฉ ูุงุณุนุฉ ูู ุฃููุงุน ุงูุญุณุงุจุงุช ุ ุจูุง ูู ุฐูู ุงูุงุณุชุนูุงูุงุช ุงูุชูุงุนููุฉ ููุนุงูุฌุฉ ุงูุฏูู.  ุชูุนุจ ุงูุณุฑุนุฉ ุฏูุฑูุง ููููุง ูู ูุนุงูุฌุฉ ูููุงุช ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ุ ููู ุงูุณุฑุนุฉ ุงูุชู ุชุชูุญ ูู ุงูุนูู ุจุดูู ุชูุงุนูู ุฏูู ูุถุงุก ุฏูุงุฆู ุฃู ุณุงุนุงุช ูู ุงูุงูุชุธุงุฑ.  ูุงุญุฏุฉ ูู ุฃุนุธู ููุงุท ููุฉ ุณุจุงุฑู ูู ูุซู ูุฐู ุงูุณุฑุนุฉ ุงูุนุงููุฉ ูู ูุฏุฑุชูุง ุนูู ุฃุฏุงุก ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ูู ุงูุฐุงูุฑุฉ. <br><br>  ูุฐุง ุงูุฅุทุงุฑ ููุชูุจ ูู Scala ุ ูุฐูู ูุฌุจ ุนููู ุชุซุจูุชู ุฃููุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo apt-get install scala</code> </pre> <br>  ูู ุจุชูุฒูู Spark ุงูุชูุฒูุน ูู ุงููููุน ุงูุฑุณูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">wget <span class="hljs-string"><span class="hljs-string">"http://mirror.linux-ia64.org/apache/spark/spark-2.4.2/spark-2.4.2-bin-hadoop2.7.tgz"</span></span></code> </pre> <br>  ูู ุงูุฃุฑุดูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo tar xvf spark-2.4.2/spark-2.4.2-bin-hadoop2.7.tgz -C /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/spark</code> </pre> <br>  ุฃุถู ุงููุณุงุฑ ุฅูู Spark ูู ููู bash: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">vim ~/.bashrc</code> </pre> <br>  ุฃุถู ุงูุฃุณุทุฑ ุงูุชุงููุฉ ูู ุฎูุงู ุงููุญุฑุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">SPARK_HOME=/usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/spark <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> PATH=<span class="hljs-variable"><span class="hljs-variable">$SPARK_HOME</span></span>/bin:<span class="hljs-variable"><span class="hljs-variable">$PATH</span></span></code> </pre><br>  ูู ุจุชุดุบูู ุงูุฃูุฑ ุฃุฏูุงู ุจุนุฏ ุฅุฌุฑุงุก ุชุบููุฑุงุช ุนูู bashrc: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">source</span></span> ~/.bashrc</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  ูุดุฑ AWS ุจูุณุชุฌุฑุณ </h2><br>  ูุจูู ูุดุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ุญูุซ ุณูููู ุจุชุญููู ุงููุนูููุงุช ุงูุชู ุชูุช ูุนุงูุฌุชูุง ูู ุงูุชุฏููุงุช.  ููุฐุง ุณูู ูุณุชุฎุฏู ุฎุฏูุฉ AWS RDS. <br><br>  ุงูุชูู ุฅูู ูุญุฏุฉ ุงูุชุญูู AWS -&gt; AWS RDS -&gt; ููุงุนุฏ ุงูุจูุงูุงุช -&gt; ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/dg/os/m7/dgosm7dwnh3fr-uksjdt_xpltsk.png"></div><br>  ุญุฏุฏ PostgreSQL ูุงููุฑ ููู ุงูุฒุฑ "ุงูุชุงูู": <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/3y/d_/8r/3yd_8rsz2swfgaxaafpkyizthac.png"></div><br>  ูุฃู  ูุชู ููู ูุฐุง ุงููุซุงู ููุท ููุฃุบุฑุงุถ ุงูุชุนููููุฉ ุ ูุณูู ูุณุชุฎุฏู ุฎุงุฏููุง ูุฌุงูููุง "ุนูู ุงูุฃูู" (ุงููุณุชูู ุงููุฌุงูู): <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/fn/6p/5b/fn6p5bjyitndy_ozs2cdcw_ssi0.png"></div><br>  ุจุนุฏ ุฐูู ุ ุถุน ุนูุงูุฉ ูู ูุชูุฉ ุงููุณุชูู ุงููุฌุงูู ุ ูุจุนุฏ ุฐูู ุณูุชู ุชูุฏูู ูุซูู ูุฆุฉ t2.micro ุชููุงุฆููุง - ุฑุบู ุฃูู ุถุนูู ุ ุฅูุง ุฃูู ูุฌุงูู ูููุงุณุจ ุชูุงููุง ููููุชูุง: <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/mj/jh/wg/mjjhwg3cknoehrq8wyxk3uw5v74.png"></div><br>  ุชุชุจุน ุงูุฃููุฑ ุงููููุฉ ุฌุฏูุง: ุงุณู ูุซูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูุงุณู ุงููุณุชุฎุฏู ุงูุฑุฆูุณู ููููุฉ ุงููุฑูุฑ ุงูุฎุงุตุฉ ุจู.  ูููู ุจุชุณููุฉ ุงููุซุงู: myHabrTest ุ ุงููุณุชุฎุฏู ุงูุฑุฆูุณู: <b>habr</b> ุ ูููุฉ ุงููุฑูุฑ: <b>habr12345</b> ูุงููุฑ ุนูู ุงูุฒุฑ "ุงูุชุงูู": <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/lg/jt/mf/lgjtmfdfst0pvqthojb_bdpeohc.png"></div><br><br>  ุชุญุชูู ุงูุตูุญุฉ ุงูุชุงููุฉ ุนูู ุงููุนููุงุช ุงููุณุคููุฉ ุนู ุชููุฑ ุฎุงุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฏููุง ูู ุงูุฎุงุฑุฌ (ุฅููุงููุฉ ุงููุตูู ุงูุนุงูุฉ) ูุชูุงูุฑ ุงููููุฐ: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/40/z9/q7/40z9q7owar5kpnimyzrdj5laqgs.png"></div><br>  ูููู ุจุฅูุดุงุก ุชูููู ุฌุฏูุฏ ููุฌููุนุฉ ุงูุฃูุงู VPC ุ ูุงูุชู ุณูู ุชุชูุญ ููุง ุงููุตูู ุฅูู ุฎุงุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฏููุง ูู ุงูุฎุงุฑุฌ ูู ุฎูุงู ุงููููุฐ 5432 (PostgreSQL). <br><br>  ูู ูุงูุฐุฉ ูุชุตูุญ ูููุตูุฉ ุ ุงูุชูู ุฅูู ูุญุฏุฉ ุชุญูู AWS ูู ููุญุฉ ูุนูููุงุช VPC -&gt; ูุฌููุนุงุช ุงูุฃูุงู -&gt; ุฅูุดุงุก ูุณู ูุฌููุนุฉ ุงูุฃูุงู: <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/fl/2i/ne/fl2inejlgnghwsh3itdrlcywdsu.png"></div><br>  ุนููู ุงุณู ูุฌููุนุฉ ุงูุฃูุงู - ูุดูุฑ PostgreSQL ุ ููู ูุตู ุ ุฅูู VPC ุงูุฐู ูุฌุจ ุฃู ุชุฑุชุจุท ุจู ูุฐู ุงููุฌููุนุฉ ูุงููุฑ ููู ุงูุฒุฑ "ุฅูุดุงุก": <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/js/8r/tv/js8rtvp8tudwjtpgso6xota5h-g.png"></div><br>  ุงููุฃ ูุฌููุนุฉ ููุงุนุฏ Inbound ุงูุชู ุชู ุฅูุดุงุคูุง ุญุฏูุซูุง ูููููุฐ 5432 ุ ููุง ูู ููุถุญ ูู ุงูุตูุฑุฉ ุฃุฏูุงู.  ููุณ ูุฏูู ูุชุญุฏูุฏ ูููุฐ ูุฏูู ุ ูููู ุญุฏุฏ PostgreSQL ูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ ุงูููุน. <br><br>  ุจุงููุนูู ุงูุฏููู ูููููุฉ ุ ุชุนูู ุงููููุฉ :: / 0 ุชููุฑ ุญุฑูุฉ ุงููุฑูุฑ ุงููุงุฑุฏุฉ ูุฎุงุฏู ูู ุฌููุน ุฃูุญุงุก ุงูุนุงูู ุ ููู ุฃูุฑ ุบูุฑ ุตุญูุญ ุชูุงููุง ุ ูููู ูู ุฃุฌู ุชุญููู ุงููุซุงู ุ ุฏุนููุง ูุณุชุฎุฏู ูุฐุง ุงูุฃุณููุจ: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ge/8j/bn/ge8jbntssnooajc8so36h0tjo80.png"></div><br>  ูุนูุฏ ุฅูู ุตูุญุฉ ุงููุชุตูุญ ุ ุญูุซ ูุฏููุง "ุชูููู ุงูุฅุนุฏุงุฏุงุช ุงููุชูุฏูุฉ" ููุชูุญุฉ ูุญุฏุฏ ูู ูุณู ูุฌููุนุงุช ุฃูุงู VPC -&gt; ุงุฎุชุฑ ูุฌููุนุงุช ุฃูุงู VPC ุงูุญุงููุฉ -&gt; PostgreSQL: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/nk/ae/-s/nkae-ste1tp3wgvmyilicvwlk8e.png"></div><br>  ุจุนุฏ ุฐูู ุ ูู ุงููุณู ุฎูุงุฑุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช -&gt; ุงุณู ูุงุนุฏุฉ ุงูุจูุงูุงุช -&gt; ุชุนููู ุงูุงุณู - <b>habrDB</b> . <br><br>  ูููููุง ุชุฑู ุจููุฉ ุงููุนููุงุช ุ ุจุงุณุชุซูุงุก ุชุนุทูู ุงููุณุฎ ุงูุงุญุชูุงุทู (ูุชุฑุฉ ุงูุงุญุชูุงุธ ุจุงููุณุฎ ุงูุงุญุชูุงุทู - 0 ููููุง) ุ ูุงูุฑุตุฏ ุ ูุฑุคู ุงูุฃุฏุงุก ุ ุงูุชุฑุงุถููุง.  ุงููุฑ ุนูู ุฒุฑ <b>ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช</b> : <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ex/1p/po/ex1ppogq_vdsk3nnvywm7l8vq8i.png"></div><br><h2 style=";text-align:right;direction:rtl">  ุฏูู ูุนุงูุฌ </h2><br>  ุณุชููู ุงูุฎุทูุฉ ุงูุฃุฎูุฑุฉ ูู ุชุทููุฑ Spark-jobs ุ ูุงูุชู ุณุชููู ุจูุนุงูุฌุฉ ูู ุซุงููุชูู ุจูุงูุงุช ุฌุฏูุฏุฉ ูุงุฏูุฉ ูู Kafka ูุฅุฏุฎุงู ุงููุชูุฌุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. <br><br>  ููุง ูู ูุฐููุฑ ุฃุนูุงู ุ ูุฅู ููุงุท ุงูุชูุชูุด ูู ุงูุขููุฉ ุงูุฃุณุงุณูุฉ ูู SparkStreaming ุงูุชู ูุฌุจ ุชูููููุง ูุชูููุฑ ุงูุชุณุงูุญ ูุน ุงูุฎุทุฃ.  ุณูุณุชุฎุฏู ููุงุท ุงูุชุญูู ุ ููู ุญุงูุฉ ุญุฏูุซ ุงูุฎูุงุถ ูู ุงูุฅุฌุฑุงุกุงุช ุ ุณุชุญุชุงุฌ ูุญุฏุฉ Spark Streaming ููุท ููุนูุฏุฉ ุฅูู ููุทุฉ ุงูุชุญูู ุงูุฃุฎูุฑุฉ ูุงุณุชุฆูุงู ุงูุญุณุงุจุงุช ูููุง ูุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช ุงูููููุฏุฉ. <br><br>  ููููู ุชูููู ููุทุฉ ุงูุชูุชูุด ุนู ุทุฑูู ุชุนููู ุงูุฏููู ูู ูุธุงู ูููุงุช ููุซูู ูููุงูู ููุฃุฎุทุงุก (ุนูู ุณุจูู ุงููุซุงู ุ HDFS ุ S3 ุ ุฅูุฎ) ุ ุญูุซ ุณูุชู ุญูุธ ูุนูููุงุช ููุทุฉ ุงูุชูุชูุด.  ูุชู ุฐูู ุจุงุณุชุฎุฏุงู ุ ุนูู ุณุจูู ุงููุซุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">streamingContext.checkpoint(checkpointDirectory)</code> </pre> <br>  ูู ุงููุซุงู ุงูุฎุงุต ุจูุง ุ ุณูู ูุณุชุฎุฏู ุงูุทุฑููุฉ ุงูุชุงููุฉ ุ ุฃู ูู ุญุงูุฉ ูุฌูุฏ checkpointDirectory ุ ุณูุชู ุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุณูุงู ูู ุจูุงูุงุช ููุทุฉ ุงูุชุญูู.  ุฅุฐุง ูุงู ุงูุฏููู ุบูุฑ ููุฌูุฏ (ุฃู ุฃูู ูุชู ุชูููุฐู ูุฃูู ูุฑุฉ) ุ ูุณูุชู ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ functionToCreateContext ูุฅูุดุงุก ุณูุงู ุฌุฏูุฏ ูุชูููู DStreams: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyspark.streaming <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StreamingContext context = StreamingContext.getOrCreate(checkpointDirectory, functionToCreateContext)</code> </pre><br>  ูู ุจุฅูุดุงุก ูุงุฆู DirectStream ููุงุชุตุงู ุจููุถูุน "ุงููุนุงููุฉ" ุจุงุณุชุฎุฏุงู ุทุฑููุฉ createDirectStream ูููุชุจุฉ KafkaUtils: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyspark.streaming.kafka <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> KafkaUtils sc = SparkContext(conf=conf) ssc = StreamingContext(sc, <span class="hljs-number"><span class="hljs-number">2</span></span>) broker_list = <span class="hljs-string"><span class="hljs-string">'localhost:9092'</span></span> topic = <span class="hljs-string"><span class="hljs-string">'transaction'</span></span> directKafkaStream = KafkaUtils.createDirectStream(ssc, [topic], {<span class="hljs-string"><span class="hljs-string">"metadata.broker.list"</span></span>: broker_list})</code> </pre><br>  ุชุญููู ุงูุจูุงูุงุช ุงููุงุฑุฏุฉ ุจุชูุณูู JSON: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">rowRdd = rdd.map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> w: Row(branch=w[<span class="hljs-string"><span class="hljs-string">'branch'</span></span>], currency=w[<span class="hljs-string"><span class="hljs-string">'currency'</span></span>], amount=w[<span class="hljs-string"><span class="hljs-string">'amount'</span></span>])) testDataFrame = spark.createDataFrame(rowRdd) testDataFrame.createOrReplaceTempView(<span class="hljs-string"><span class="hljs-string">"treasury_stream"</span></span>)</code> </pre><br>  ุจุงุณุชุฎุฏุงู Spark SQL ุ ูููู ุจุนูู ุชุฌููุน ุจุณูุท ูุทุจุงุนุฉ ุงููุชูุฌุฉ ุนูู ูุญุฏุฉ ุงูุชุญูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> from_unixtime(<span class="hljs-keyword"><span class="hljs-keyword">unix_timestamp</span></span>()) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> curr_time, t.branch <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> branch_name, t.currency <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> currency_code, <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(amount) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> batch_value <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> treasury_stream t <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> t.branch, t.currency</code> </pre><br>  ุงูุญุตูู ุนูู ูุต ุงูุงุณุชุนูุงู ูุชุดุบููู ูู ุฎูุงู Spark SQL: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">sql_query = get_sql_query() testResultDataFrame = spark.sql(sql_query) testResultDataFrame.show(n=<span class="hljs-number"><span class="hljs-number">5</span></span>)</code> </pre><br>  ุซู ูุญูุธ ุงูุจูุงูุงุช ุงููุฌูุนุฉ ุงููุณุชููุฉ ูู ุฌุฏูู ูู AWS RDS.  ูุญูุธ ูุชุงุฆุฌ ุงูุชุฌููุน ูู ุฌุฏูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ุณูุณุชุฎุฏู ุทุฑููุฉ ุงููุชุงุจุฉ ูููุงุฆู DataFrame: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">testResultDataFrame.write \ .format(<span class="hljs-string"><span class="hljs-string">"jdbc"</span></span>) \ .mode(<span class="hljs-string"><span class="hljs-string">"append"</span></span>) \ .option(<span class="hljs-string"><span class="hljs-string">"driver"</span></span>, <span class="hljs-string"><span class="hljs-string">'org.postgresql.Driver'</span></span>) \ .option(<span class="hljs-string"><span class="hljs-string">"url"</span></span>,<span class="hljs-string"><span class="hljs-string">"jdbc:postgresql://myhabrtest.ciny8bykwxeg.us-east-1.rds.amazonaws.com:5432/habrDB"</span></span>) \ .option(<span class="hljs-string"><span class="hljs-string">"dbtable"</span></span>, <span class="hljs-string"><span class="hljs-string">"transaction_flow"</span></span>) \ .option(<span class="hljs-string"><span class="hljs-string">"user"</span></span>, <span class="hljs-string"><span class="hljs-string">"habr"</span></span>) \ .option(<span class="hljs-string"><span class="hljs-string">"password"</span></span>, <span class="hljs-string"><span class="hljs-string">"habr12345"</span></span>) \ .save()</code> </pre><br><blockquote style=";text-align:right;direction:rtl">  ุจุถุน ูููุงุช ุญูู ุฅุนุฏุงุฏ ุงุชุตุงู AWS RDS.  ููุฏ ุฃูุดุฃูุง ุงููุณุชุฎุฏู ููููุฉ ุงููุฑูุฑ ุงูุฎุงุตุฉ ุจู ูู ุฎุทูุฉ "ูุดุฑ AWS PostgreSQL".  ุจุงููุณุจุฉ ูุนููุงู URL ูุฎุงุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ุงุณุชุฎุฏู Endpoint ุ ูุงูุฐู ูุชู ุนุฑุถู ูู ูุณู ุงูุงุชุตุงู ูุงูุฃูุงู: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/9n/sj/jd/9nsjjdun0hdy5qtwqub0xhvzunk.png"></div></blockquote><br>  ูู ุฃุฌู ุชูุตูู Spark ู Kafka ุจุดูู ุตุญูุญ ุ ูุฌุจ ุชุดุบูู ุงููููุฉ ูู ุฎูุงู smark-submit ุจุงุณุชุฎุฏุงู <b>ูุทุนุฉ ุฃุซุฑูุฉ ูู spark-streaming-kafka-0-8_2.11</b> .  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุทุจู ุฃูุถูุง ุงูุฃุฏุงุฉ ููุชูุงุนู ูุน ูุงุนุฏุฉ ุจูุงูุงุช PostgreSQL ุ ูุณูููููุง ูู ุฎูุงู - ุญุฒู. <br><br>  ูู ุฃุฌู ูุฑููุฉ ุงูุจุฑูุงูุฌ ุงููุตู ุ ูุฃุฎุฐ ุฃูุถูุง ุงุณู ุฎุงุฏู ุงูุฑุณุงุฆู ูุงูููุถูุน ุงูุฐู ูุฑูุฏ ุงุณุชูุงู ุงูุจูุงูุงุช ููู ููุนููุงุช ุฅุฏุฎุงู. <br><br>  ูุฐูู ุ ุญุงู ุงูููุช ูุจุฏุก ูุงุฎุชุจุงุฑ ุงููุธุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">spark-submit \ --packages org.apache.spark:spark-streaming-kafka-0-8_2.11:2.0.2,\ org.postgresql:postgresql:9.4.1207 \ spark_job.py localhost:9092 transaction</code> </pre><br>  ูู ุดูุก ูุนูู ุจูุง!  ููุง ุชุฑู ูู ุงูุตูุฑุฉ ุฃุฏูุงู ุ ุฃุซูุงุก ุนูู ุงูุชุทุจูู ุ ูุชู ุนุฑุถ ูุชุงุฆุฌ ุงูุชุฌููุน ุงูุฌุฏูุฏุฉ ูู ุซุงููุชูู ุ ูุฃููุง ูููุง ุจุชุนููู ุงููุงุตู ุงูุฒููู ููุฏูุน ุฅูู ุซุงููุชูู ุนูุฏ ุฅูุดุงุก ูุงุฆู StreamingContext: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/cf/q1/25/cfq125zpzkyldktsuvdo175fazy.png"></div><br>  ุจุนุฏ ุฐูู ุ ูููู ุจุฅุฌุฑุงุก ุงุณุชุนูุงู ุจุณูุท ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุชุญูู ูู ุงูุณุฌูุงุช ูู ุฌุฏูู <b>ุงููุนุงููุงุช_ุงูุชุฏูู</b> : <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/7j/j9/qm/7jj9qmf4zpter3jkbblrmiqni2s.png"></div><br><h2 style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h2><br>  ุฏุฑุณุช ูุฐู ุงูููุงูุฉ ูุซุงููุง ุนูู ูุนุงูุฌุฉ ูุนูููุงุช ุงูุชุฏูู ุจุงุณุชุฎุฏุงู Spark Streaming ุจุงูุชุฒุงูู ูุน Apache Kafka ู PostgreSQL.  ูุน ููู ุงูุจูุงูุงุช ูู ูุตุงุฏุฑ ูุฎุชููุฉ ุ ูู ุงูุตุนุจ ุงููุจุงูุบุฉ ูู ุชูุฏูุฑ ุงููููุฉ ุงูุนูููุฉ ูู Spark Streaming ูุฅูุดุงุก ุชุทุจููุงุช ูุชุทุจููุงุช ูุชุฏููุฉ ุชุนูู ูู ุงูููุช ุงููุนูู. <br><br>  ููููู ุงูุนุซูุฑ ุนูู ุดูุฑุฉ ุงููุตุฏุฑ ุงููุงููุฉ ูู ูุณุชูุฏุน ุงูุชุฎุฒูู ุงูุฎุงุต ุจู ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฌูุซุจ</a> . <br><br>  ุฃูุง ูุณุชุนุฏ ูููุงูุดุฉ ูุฐุง ุงูููุงู ุจูู ุณุฑูุฑ ุ ูุฃุชุทูุน ุฅูู ุชุนูููุงุชูู ุ ูุขูู ุฃูุถูุง ุฃู ูุชู ุชูุฌูู ุงูููุฏ ุงูุจูุงุก ูุฌููุน ุงููุฑุงุก ุงููุนูููู. <br><br>  ุงุชููู ูู ุงูุชูููู <br><br>  <b>ููุงุญุธุฉ:</b> ูุงู ูู ุงููุฎุทุท ุฃุตูุงู ุงุณุชุฎุฏุงู ูุงุนุฏุฉ ุจูุงูุงุช PostgreSQL ูุญููุฉ ุ ููู ุจุงููุธุฑ ุฅูู ุญุจู ูู AWS ุ ูุฑุฑุช ุฃู ุฃุถุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ุงูุณุญุงุจุฉ.  ูู ุงูููุงูุฉ ุงูุชุงููุฉ ุญูู ูุฐุง ุงูููุถูุน ุ ุณุฃุนุฑุถ ููููุฉ ุชูููุฐ ุงููุธุงู ุจุงููุงูู ุงูููุถุญ ุฃุนูุงู ูู AWS ุจุงุณุชุฎุฏุงู AWS Kinesis ู AWS EMR.  ุงุชุจุน ุงูุฃุฎุจุงุฑ! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar451160/">https://habr.com/ru/post/ar451160/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar451148/index.html">ุจุฑูุฌุฉ ุงููุงุฆูุงุช ูู ุงููุบุงุช ุงูุฑุณูููุฉ</a></li>
<li><a href="../ar451150/index.html">ุงูุณููู ุงุฐุง ุงุณุชุทุนุช. ูุณุฎุฉ ูุฏูุฑ</a></li>
<li><a href="../ar451152/index.html">ุงูููุงูู ูู ุงูุฏุงุฆุฑุฉ ุงูุจูุงุจุฉ ุฃู ููููุฉ ุงูููุงู ุจุฐูู ุจุดูู ุตุญูุญ</a></li>
<li><a href="../ar451154/index.html">ูุธุงู ุงูุญุตูู ุนูู ุงูุจูุงูุงุช ุงููุญููุฉ ุงููุณุชููุฉ (ุชุงุจุน)</a></li>
<li><a href="../ar451158/index.html">ุงูุฏูุงุฆุฑ ุงูููุฑุจุงุฆูุฉ. ุฃููุงุน ุงูุฏูุงุฆุฑ</a></li>
<li><a href="../ar451162/index.html">ุชุตุญูุญ ุงูุฎุทุฃ - ุงูุซูุงุจุช ุงูููุฒูุงุฆูุฉ ูู ุงูุฅุตุฏุงุฑุงุช ุงูุญุงููุฉ ูุงูุฌุฏูุฏุฉ ููุธุงู ุงููุญุฏุงุช ุงูุฏููู (SI)</a></li>
<li><a href="../ar451164/index.html">ุชุจุญุซ ุนู ูุณุงุญุฉ ููุงูู ูุฌุงููุฉ ููุณูุงุฑุงุช ูุน ุจูุซูู</a></li>
<li><a href="../ar451166/index.html">ูุง ุงูุฐู ุณุชููุฑู ุงููุณุชูุฏุนุงุช ุงูุฌุฏูุฏุฉ ูุฃูุธูุฉ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูุงูู MOุ</a></li>
<li><a href="../ar451170/index.html">ุฃุนูู ุฌูู ุจูุฒูุณ ุนู ุฎุทุท ููุชุบูุจ ุนูู ุงูููุฑ</a></li>
<li><a href="../ar451172/index.html">ุฌูููุง: ูุธุงุฆู ูููุงูู ูุธุงุฆู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>