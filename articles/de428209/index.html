<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“ ğŸŠ ğŸ¥¡ Entwicklerkochbuch: Domain Driven Design Rezepte (Teil 2, Struktur und Interaktion) ğŸ‘‹ğŸ» âŒšï¸ ğŸ–ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="EinfÃ¼hrung 


 Im ersten Artikel haben wir den Umfang der angegebenen Praktiken hervorgehoben, fÃ¼r welche Projekte sie angewendet werden kÃ¶nnen und fÃ¼...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Entwicklerkochbuch: Domain Driven Design Rezepte (Teil 2, Struktur und Interaktion)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428209/"><p><img src="https://habrastorage.org/webt/fr/vw/on/frvwonyhe7k6st_x65v67hcbrcs.jpeg" alt="ddd-header"></p><br><h1 id="vvedenie">  EinfÃ¼hrung </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Im ersten Artikel haben</a> wir den Umfang der angegebenen Praktiken hervorgehoben, fÃ¼r welche Projekte sie angewendet werden kÃ¶nnen und fÃ¼r welche nicht. </p><br><p> In diesem Artikel mÃ¶chte ich einen kurzen Ãœberblick Ã¼ber die Grundprinzipien von DDD geben und meine persÃ¶nlichen Erfahrungen mit deren Anwendung teilen.  Wir werden detaillierter auf Kommunikations- und StrukturansÃ¤tze mit Beispielen fÃ¼r deren Umsetzung eingehen. </p><br><p>  Im folgenden Artikel werde ich mÃ¶gliche Kombinationen der angewendeten Entwurfsmuster unter BerÃ¼cksichtigung ihrer Implementierung aufschreiben und schlieÃŸlich ein Beispiel fÃ¼r eine spezifische Implementierung eines kleinen Mikroservices geben. </p><a name="habracut"></a><br><h1 id="ddd">  DDD </h1><br><p>  Erinnern Sie sich an die frÃ¼here Definition: </p><br><blockquote>  Domain-Driven Design (DDD) ist ein Ansatz zur Softwareentwicklung zur umfassenden Befriedigung von Anforderungen, indem die Implementierung eng mit den wichtigsten GeschÃ¤ftsmodellen verknÃ¼pft wird, die stÃ¤ndig weiterentwickelt werden. </blockquote><p>  Das Nachschlagewerk, das die Praxis des Aufbaus komplexer Systeme beschreibt, ist Eric Evans ' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Domain Driven Dedign</a> (Big Blue Book).  Wenn Sie einen Ãœbersichtsartikel zu diesem Thema lesen, wissen Sie bereits davon.  Wenn Sie DDD in der Praxis verwenden, mÃ¼ssen Sie es lesen.  Dies ist nicht das am einfachsten zu lesende Buch: </p><br><blockquote>  Die kanonische Quelle fÃ¼r DDD ist Eric Evans 'Buch.  Es ist nicht das am einfachsten zu lesende in der Softwareliteratur, aber es ist eines dieser BÃ¼cher, die eine erhebliche Investition reichlich zurÃ¼ckzahlen. <br><br>  Martin Fowler: 15. Januar 2014 </blockquote><p>  Wenn Sie durch den Inhalt des Buches scrollen, erscheint es Ihnen nicht ganz strukturiert.  Aber die Karte wird uns helfen. <br><img src="https://habrastorage.org/webt/oh/5e/tj/oh5etj1mf-uvet2bdyn7y1olj8k.png" alt="DDD-Karte"></p><br><p>  Auf der Karte sind jene Praktiken, die wir heute betrachten werden. </p><br><p>  Der Umfang der im Buch behandelten Praktiken ist riesig.  Der Umfang der Praktiken, die auÃŸerhalb dieses Buches angewendet werden kÃ¶nnen, ist noch grÃ¶ÃŸer.  Identifizieren Sie Ihre Ziele, bevor Sie zumindest einen Teil davon in Betrieb nehmen.  Ich werde mein eigenes als Beispiel geben. </p><br><ul><li>  Steigern Sie die ProduktivitÃ¤t. </li><li>  Schreiben Sie verstÃ¤ndlichen Code. </li><li>  Skalierung auf Softwareentwicklungsebene. </li></ul><br><h2 id="edinyy-yazyk">  Einzelne Sprache </h2><br><p>  Softwareentwicklung fÃ¼hrt selten zur Schaffung von etwas Neuem, in der Regel ist dies eine Simulation von etwas Bestehendem. </p><br><blockquote>  Ein Modell ist eine Darstellung eines realen Objekts, die nur die erforderlichen Eigenschaften und Funktionen enthÃ¤lt. </blockquote><p>  Wir kÃ¶nnen kein Softwareprodukt erstellen, das den gesamten Themenbereich abdeckt.  Es ist mÃ¶glich, nur den Teil davon zu reproduzieren, der die erforderliche FunktionalitÃ¤t reproduziert. </p><br><p>  Ein gutes Beispiel fÃ¼r ein Modell wÃ¤re eine topografische Karte.  Sie ist ein GelÃ¤ndemodell.  Die Karte enthÃ¤lt keine Wiesen mit Feldern und FlÃ¼ssen, sondern spiegelt nur die Position realer Objekte relativ zueinander wider. </p><br><p>  Um ein klares und klares Modell fÃ¼r alle zu erstellen, mÃ¼ssen Sie dieselbe Sprache sprechen.  Dies sagt uns nicht nur Eric Evans, sondern auch der gesunde Menschenverstand.  Wenn Programmierer ihre Begriffe verwenden und ihren eigenen "Slang" verwenden, wird der erstere einfach nicht verstehen, was zu tun ist.  In diesem Fall kann das Unternehmen die tatsÃ¤chlichen Kosten fÃ¼r die Entwicklung des einen oder anderen â€Featuresâ€œ nicht realisieren.  Wie oft haben Sie schon gehÃ¶rt: "Ja, es ist nur eine SchaltflÃ¤che zum HinzufÃ¼gen"? </p><br><p>  Ihr Ziel als Systemdesigner sollte es sein, das maximale VerstÃ¤ndnis des gesamten Teams voneinander zu erlangen.  Wie erreicht man das?  Fang an zu reden.  Wenn Menschen beginnen, in einer engen Gruppe zu kommunizieren, haben sie bestimmte allgemein akzeptierte Begriffe.  In verschiedenen Unternehmen ist der Prozess der EinfÃ¼hrung einer gemeinsamen Sprache wahrscheinlich unterschiedlich.  Dies kann entweder eine willensstarke Entscheidung oder ein demokratisches Verfahren sein.  Die Sprache kann explizit angegeben werden und wird nicht explizit eingegeben. In diesem Fall beginnen sie einfach, sie zu sprechen.  Eine gute Technik zur EinfÃ¼hrung einer gemeinsamen Sprache ist die allgemeine Dokumentation. </p><br><h3 id="kak-vesti-dokumentaciyu-proekta">  So bewahren Sie die Projektdokumentation auf </h3><br><ol><li>  Jede Kommunikation zwischen GeschÃ¤ft und Entwicklung sollte Ihr Modell verbessern. </li><li>  Notieren Sie nach dem Meeting das Ergebnis in Form einer Dokumentation (Scrum-Artefakt) und zeigen Sie diese Dokumentation allen Teilnehmern des Entwicklungsprozesses. </li><li>  Verwenden Sie eine einzige Sprache in der Dokumentation. </li><li>  Am wichtigsten: Verschwenden Sie keine Zeit mit der Dokumentation.  Sie mÃ¼ssen noch Code schreiben, und die Dokumentation wird viele Male neu geschrieben. Das Ausgeben von Ressourcen ist teuer.  Verwenden Sie eine Serviette, einen Stift und eine Kamera auf Ihrem Telefon, anstatt lange mit der UML-Diagrammanwendung herumzuspielen. </li><li>  Dokumentation erfordert Disziplin, Sie kÃ¶nnen sie nicht von Zeit zu Zeit schreiben. </li><li>  Trennen Sie die Dokumentation: <br><ul><li> Kommentare im Code - Beschreiben Sie unverstÃ¤ndliche Momente direkt im Code. Lassen Sie <code>#ODO:</code> (entfernen, wenn Sie den Code in den Master einfÃ¼gen).  DrÃ¼cken Sie Ihre Meinung in den Kommentaren aus, zum Beispiel mÃ¼ssen Sie die eine oder andere KrÃ¼cke verwenden, wenn Sie mit Legasy-Code arbeiten. </li><li>  Kommentare zum Projekt <code>README.md</code> im Stammverzeichnis Ihres Projekts sollten technische Informationen enthalten: Starten des Projekts, AusfÃ¼hren von Tests usw.  Es ist auch eine gute Idee, eine Karte zu erstellen, auf der Sie alle Projekte haben und auf welchen Servern sie ausgefÃ¼hrt werden.  Notieren Sie alle akzeptierten Vereinbarungen separat. </li><li>  Und vor allem die Wissensbasis.  Eine Sammlung von Dokumenten, die GeschÃ¤ftsprozesse beschreiben. Dies ist der Teil der Dokumente, der sowohl Ihnen als auch dem Unternehmen zur VerfÃ¼gung steht. </li></ul></li><li>  Der Hauptfehler derjenigen, die Dokumentation schreiben, ist Redundanz.  Versuchen Sie nicht, alles und jedes abzudecken, sondern vermitteln Sie nur die allgemeine Bedeutung.  Die Dokumentation sollte Ihr Projekt ergÃ¤nzen, aber in keiner Weise ersetzen.  Schreiben Sie nicht alle Begriffe auf, die nur mehrdeutig sind.  Wenn eine Definition mehr als zwei SÃ¤tze umfasst, ist sie eine schlechte Definition. </li></ol><br><p>  Dokumentationsbeispiel: </p><br><pre> <code class="markdown hljs"><span class="hljs-section"><span class="hljs-section">#         . # :  : -    - email -  ## : ###        ,     email  ,    1  (      email  ). ###           .          email . ###  email  email     .    ,    email.   . ###       ,     ,    .   . ###      email,    ,       .   2 . ###                  .    ,     ,             .</span></span></code> </pre><br><p>  Beachten Sie, dass wir in diesem Beispiel kein explizites WÃ¶rterbuch angegeben haben, das Konzept von <em>Benutzer</em> , <em>Autorisierung</em> und <em>Registrierung jedoch korrigiert haben</em> .  Das Schreiben einer solchen Dokumentation dauert fÃ¼r den Experten nicht lÃ¤nger als 20 Minuten. </p><br><p>  FÃ¼r eine Person, die kein Experte auf dem Gebiet ist, wird der Prozess des Schreibens von Dokumentation als etwas Kompliziertes empfunden.  Es ist notwendig, die Sammlung von Wissen und die Aufzeichnung des gesammelten Wissens zu trennen. <code> !=  +  .</code> </p><br><blockquote>  "Was Sie das Universum nennen", sagte der vierte, "ist in der Tat eine Ansammlung von Welten, die wie die Haut eines Bogens Ã¼bereinander liegen und allmÃ¤hlich voneinander getrennt werden." <br><br>  - UngewÃ¶hnlich klar gesagt!  - bewunderte die Abderiten.  - Erstaunlich klar!  "Sie dachten, sie hÃ¤tten den Philosophen verstanden, weil sie sehr gut wussten, was die Zwiebel war." <br><br>  Aberdeen Story, Cristov Martin Wieland </blockquote><br><h2 id="ogranichennyy-konteksty-i-domeny">  Begrenzte Kontexte und DomÃ¤nen </h2><br><p>  Stellen Sie sich vor, wir wÃ¤ren Designer eines progressiven Startups.  Wir alle lieben gekÃ¼hlte Pizza, fluchen mit Kurieren und fÃ¼llen stundenlang Formulare auf der Baustelle aus.  Deshalb haben wir uns ein wunderbares Startup â€Vier SchildkrÃ¶ten und eine Ratteâ€œ ausgedacht: </p><br><ul><li>  Es gibt eine Seite, auf der Pizzerien registriert sind und ihre tatsÃ¤chlichen Gerichte verÃ¶ffentlichen. </li><li>  Diese Pizzerien haben keinen eigenen Kurierdienst. </li><li>  Es gibt Kunden, die die Pizzeria nicht erreichen kÃ¶nnen, aber bereit sind, eine Bestellung Ã¼ber die Website oder die mobile Anwendung aufzugeben. </li><li>  Killer-Feature: Kuriere sind keine speziell eingestellten Mitarbeiter, sondern normale Leute, die sich Ã¼ber die mobile Anwendung registriert haben </li><li>  Kuriere erhalten Befehle, nach ihrer AusfÃ¼hrung erhalten sie eine Bezahlung fÃ¼r die geleistete Arbeit. </li><li>  Das Warten auf solche Kuriere dauert lÃ¤nger, aber die Lieferung und dementsprechend die Pizza sind billiger. </li></ul><br><p>  Erinnern wir uns an die Dokumentation, die wir im vorherigen Kapitel beschrieben haben.  Dort wurde in unserem einzigen WÃ¶rterbuch der Begriff <em>Registrierung verwendet</em> .  Aber in diesem Projekt haben wir mehrere davon: </p><br><ul><li>  Kundenregistrierung </li><li>  Pizzeria Registrierung </li><li>  Kurierregistrierung </li><li>  Bestellregistrierung </li></ul><br><p>  Eine einheitliche Sprache gehÃ¶rt zu einem begrenzten Kontext.  Die DomÃ¤ne der obigen Dokumentation ist "Autorisierungssystem".  Versuchen wir, Domains fÃ¼r unser Startup zuzuweisen. </p><br><p>  Bevor wir beginnen, schauen wir uns eine kleine Terminologie an, was eine Domain ist und was ein begrenzter Kontext ist. </p><br><blockquote>  Domain (Domain) - eine Darstellung einer realen GeschÃ¤ftsstruktur, die ein bestimmtes Problem lÃ¶st. </blockquote><p>  Zum Beispiel: Logistiksystem, Zahlungssystem, Autorisierungssystem, Auftragsverwaltungssystem. </p><br><p>  Die Domain ist in Subdomains unterteilt, die kleinere Strukturen beschreiben, zum Beispiel: einen Auftragskorb, ein System zum Erstellen von Routen. </p><br><p>  Jede Domain hat einen begrenzten Verantwortungsbereich - eingeschrÃ¤nkte FunktionalitÃ¤t. </p><br><blockquote>  Begrenzter Kontext - Eine Reihe von DomÃ¤neneinschrÃ¤nkungen, mit denen sich die DomÃ¤ne auf nur eine Aufgabe konzentrieren kann, um die beste LÃ¶sung zu finden. </blockquote><p>  Ich mÃ¶chte diesen Begriff als solche Abstraktion prÃ¤sentieren.  Eine Domain ist ein Kreis.  Ein eingeschrÃ¤nkter Kontext ist ein Kreis. </p><br><p><img src="https://habrastorage.org/webt/nf/nm/jz/nfnmjzlgui85mvfatppogqv-kdq.jpeg" alt="Domain-Kontext"></p><br><p>  Auch in der DDD-Terminologie wird der Kernel zugewiesen. </p><br><blockquote>  Der Kern (KerndomÃ¤ne) - die wichtigste DomÃ¤ne, die Ihr Unternehmen am meisten charakterisiert. </blockquote><p>  Also, die DomÃ¤nen des Projekts "Vier SchildkrÃ¶ten und eine Ratte": </p><br><p>  <strong>Arbeit mit einer Pizzeria</strong> (Pizzarias) </p><br><p>  <em>Kontext</em> : b2b alles was mit Pizzerien zu tun hat </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  Registrierung neuer Pizzerien </li><li>  Sortiment hinzufÃ¼gen </li><li>  Aktualisieren des Status der VerfÃ¼gbarkeit eines Produkts </li></ul><br><p>  <strong>Arbeiten Sie mit dem Kunden</strong> (Kunden) </p><br><p>  <em>Kontext</em> : b2c, alles was mit der Arbeit mit Pizzakunden zu tun hat </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  Sortiment anzeigen </li><li>  Informationsmaterialien </li></ul><br><p>  <strong>Arbeit mit Kurieren</strong> (Liefersystem) </p><br><p>  <em>Kontext</em> : b2e, alles was mit der Arbeit mit Kurieren zu tun hat </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  Kurierregistrierung </li><li>  Aufgabenverteilung </li><li>  Registrierung von AntrÃ¤gen auf Abhebung von Geldern, die der Kurier verdient hat. </li></ul><br><p>  Bestellsystem </p><br><p>  <em>Kontext</em> : Kernel.  ErmÃ¶glicht die Koordination aller einzelnen Domains und bietet einen vollstÃ¤ndigen Zyklus vom Eingang einer Bestellung bis zur Lieferung der Pizza an den Benutzer.  Es ist kein Performer, sondern spielt die Rolle eines Dirigenten. </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  Auftragsannahme </li><li>  AuftragsausfÃ¼hrung </li><li>  Auftragsstatusverfolgung </li></ul><br><p>  <strong>Abrechnungssystem</strong> (Abrechnung) </p><br><p>  <em>Kontext</em> : EnthÃ¤lt alle Finanztransaktionen.  Es bietet Interaktion mit dem Bearbeitungszentrum. </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  Geld fÃ¼r Bestellungen annehmen </li><li>  Kurieren Geld fÃ¼r geleistete Arbeit geben </li></ul><br><p>  <strong>Statistiksystem</strong> </p><br><p>  <em>Kontext</em> : Das Sammeln und Verarbeiten (nicht Ausgeben) von analytischen Informationen. </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  Statistiken Ã¼ber Fonds </li><li>  Anwendungsstatistik </li></ul><br><p>  <strong>Managementsystem</strong> ( <strong>Management</strong> Panel) </p><br><p>  <em>Kontext</em> : Die Ausgabe von analytischen Informationen.  Toolkit fÃ¼r Managemententscheidungen. </p><br><ul><li>  Analyse basierend auf gesammelten Statistiken </li><li>  Vormoderation von Zahlungen an Kuriere </li></ul><br><p>  Lassen Sie es uns anhand der Domains zuordnen. </p><br><blockquote>  Eine Domain Map (Context Map) ist ein grafisches Tool, mit dem Sie die Beziehungen zwischen einzelnen Domains beschreiben kÃ¶nnen. </blockquote><p><img src="https://habrastorage.org/webt/p1/ks/po/p1kspot2qqut90gzcn1b9fhxyn8.png" alt="Kontext-Karte"></p><br><p>  Die Karte zeigt Links zwischen Domains.  Diese Karte ist sehr oberflÃ¤chlich, aber der Themenbereich ist nicht gut verstanden.  Dies ist die erste Skizze, bei der Sie das erwartete Ergebnis erhalten. </p><br><p>  Das Wichtigste auf der Karte ist, dass wir Verbindungen zwischen DomÃ¤nen sehen.  Eine solche Struktur passt sehr gut zur Microservice-Architektur: </p><br><blockquote>  Das Hauptprinzip der Microservice-Architektur: schwache KonnektivitÃ¤t und starke Haftung. </blockquote><p>  Dieses Prinzip wird in dem Buch von Sam Newman - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Creating Microservices beschrieben</a> . Dies ist das zweite Buch, das Sie lesen mÃ¼ssen, um die in diesem Artikel beschriebenen AnsÃ¤tze in die Praxis umzusetzen.  Was ist gemeint: DomÃ¤nen sollten lose gekoppelt, aber intern eng miteinander verbunden sein. </p><br><p>  Die Ãœbersetzung dieser Begriffe stammt aus der offiziellen russischen Ãœbersetzung und spiegelt mÃ¶glicherweise die Ã¼bermittelte Bedeutung nur schlecht wider.  In den ursprÃ¼nglichen Begriffen sind: Geringe Kopplung (KonnektivitÃ¤t, Eingriff, Griffigkeit, Konjugation), hohe KohÃ¤sion (KonnektivitÃ¤t, StÃ¤rke). </p><br><h2 id="praktika-realizacii-domennogo-razdelenie">  Implementierungspraxis fÃ¼r die gemeinsame Nutzung von DomÃ¤nen </h2><br><p>  Ich mÃ¶chte meine persÃ¶nlichen Erfahrungen teilen - eine Reihe von fundierten Entscheidungen.  Ich fordere Sie nicht auf, diese LÃ¶sungen zu verwenden.  Aber sie kÃ¶nnen eine gute Wahl sein, wenn Sie nicht wissen, wo Sie anfangen sollen.  Mit persÃ¶nlicher Erfahrung werden die Tools weiter auf Ihre BedÃ¼rfnisse zugeschnitten. </p><br><p>  Die Hauptprinzipien, die uns geleitet haben: </p><br><ul><li>  Die Einfachheit der LÃ¶sung.  Machen Sie komplexe Dinge einfach, nicht einfach kompliziert. </li><li>  Pragmatismus  Sie mÃ¼ssen immer die Situation betrachten und in Ermangelung einer vorhandenen LÃ¶sung eine neue entwickeln.  Versuchen Sie, alles zu typisieren, aber vermeiden Sie Dogmatismus. </li><li>  Code! = Dokumentation.  Der Code ist eine Anweisung fÃ¼r die Maschine, die Dokumentation ist eine Anweisung fÃ¼r Personen.  Keine Notwendigkeit, sie zu verwirren und nacheinander herauszugeben. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">FEST</a> </li></ul><br><h3 id="kak-realizovat-domeny">  Wie implementiere ich Domains? </h3><br><p>  Es ist sehr praktisch, DomÃ¤nen als separate Mikrodienste auszuwÃ¤hlen. </p><br><blockquote>  Microservices ist eine separate Anwendung, die die Logik einer DomÃ¤ne implementiert. </blockquote><p>  In der DDD-Entwicklung ist das Prinzip der Zuordnung eines Mikrodienstes zu einer separaten Anwendung in einem begrenzten Kontext begrenzt.  Dies negiert nicht das technische Prinzip der Trennung von Diensten (wenn dies auf die Notwendigkeit zurÃ¼ckzufÃ¼hren ist, eine hohe Leistung sicherzustellen).  Das Kontextprinzip wird jedoch dominant und bindend sein. </p><br><h3 id="kak-vydelit-svyazi-mezhdu-domenami">  Wie kann die Beziehung zwischen DomÃ¤nen hervorgehoben werden? </h3><br><p>  Beziehungen zwischen DomÃ¤nen sind immer eine API.  Es kÃ¶nnte RESTful json api, gRPC, AMPQ sein.  Im Rahmen dieses Artikels werden wir kein Protokoll mit einem anderen vergleichen und ihre Vor- und Nachteile hervorheben, da jedes von ihnen seinen eigenen Anwendungsbereich hat.  Lassen Sie uns dennoch auf allgemeine Empfehlungen eingehen: </p><br><p>  <strong>Seien Sie flexibel bei der Auswahl eines Protokolls und starr in der Einheitlichkeit seiner Implementierung.</strong> </p><br><p>  WÃ¤hlen Sie ein Protokoll fÃ¼r jedes DomÃ¤nenpaar einzeln aus. Versuchen Sie nicht, http Ã¼berall zu verwenden. MÃ¶glicherweise benÃ¶tigen Sie irgendwo asynchrone Warteschlangen, und die Vorteile von AMPQ werden fÃ¼r Sie offensichtlich.  Ignorieren Sie diese Gelegenheit nicht, denn Sie haben Ã¼berall RESTful. </p><br><p>  Wenn Sie andererseits RESTful json implementieren, verwenden Sie einen Datenstrukturierungsstandard.  Sie kÃ¶nnen zum Beispiel jsonapi oder openapi fertig machen.  Wenn aus irgendeinem Grund vorgefertigte LÃ¶sungen nicht zu Ihnen passen und Sie das GefÃ¼hl haben, dass Sie Ihren Standard entwickeln, beschreiben und verwenden kÃ¶nnen.  Aber verwenden Sie es Ã¼berall, zÃ¼chten Sie keine "Zoo" -Standards.  Wenn Sie mit einem externen System kommunizieren mÃ¼ssen, das nichts Ã¼ber Ihre Standards weiÃŸ, schreiben Sie einen Microservice-Adapter. </p><br><p><img src="https://habrastorage.org/webt/cz/ff/go/czffgobmp7v9lr2pzkjx0-3y5xq.png" alt="Adapter"></p><br><h3 id="kak-realizovat-sabdomeny">  Wie implementiere ich Subdomains? </h3><br><p>  Als separate Module innerhalb eines Microservices. </p><br><blockquote>  Ein Modul ist eine Implementierung einer Subdomain, indem Logik in einem separaten Namespace (Namespace) innerhalb eines einzelnen Microservices abgelegt wird. </blockquote><p>  Wie sieht das alles aus?  Schauen wir uns ein Beispiel an.  Wie wir uns erinnern, haben wir eine LiefersystemdomÃ¤ne - diese DomÃ¤ne hat drei UnterdomÃ¤nen: </p><br><ul><li>  Kurierregistrierung </li><li>  Ausgabe von Aufgaben (Aufgaben) </li><li>  Registrierung von AntrÃ¤gen auf Abhebung von Geldern, die der Kurier verdient hat (Abhebung) </li><li>  ÃœberprÃ¼fen, ob Ihr Microservice funktioniert, technisches Hilfswerkzeug (healt_checker) </li></ul><br><p>  Stellen Sie sich das alles in Form einer Ordnerstruktur vor: </p><br><pre> <code class="bash hljs">$ tree --dirsfirst delivery_system delivery_system â”œâ”€â”€ app/ â”‚ â”œâ”€â”€ health_checker/ â”‚ â”‚ â””â”€â”€ endpoints.rb â”‚ â”œâ”€â”€ registrations/ â”‚ â”‚ â”œâ”€â”€ entities/ â”‚ â”‚ â”œâ”€â”€ forms/ â”‚ â”‚ â”œâ”€â”€ repositories/ â”‚ â”‚ â”œâ”€â”€ interactor/ â”‚ â”‚ â”œâ”€â”€ services/ â”‚ â”‚ â”œâ”€â”€ validations/ â”‚ â”‚ â”œâ”€â”€ endpoints.rb â”‚ â”‚ â””â”€â”€ helpers.rb â”‚ â”œâ”€â”€ tasks â”‚ â”‚ â”œâ”€â”€ entities/ â”‚ â”‚ â”œâ”€â”€ queries/ â”‚ â”‚ â”œâ”€â”€ repositories/ â”‚ â”‚ â”œâ”€â”€ endpoints.rb â”‚ â”‚ â””â”€â”€ helpers.rb â”‚ â””â”€â”€ withdrawals â”‚ â”œâ”€â”€ entities/ â”‚ â”œâ”€â”€ forms/ â”‚ â”œâ”€â”€ repositories/ â”‚ â”œâ”€â”€ interactor/ â”‚ â”œâ”€â”€ services/ â”‚ â”œâ”€â”€ validations/ â”‚ â”œâ”€â”€ endpoints.rb â”‚ â””â”€â”€ helpers.rb â”œâ”€â”€ config/ â”œâ”€â”€ db/ â”œâ”€â”€ docs/ â”œâ”€â”€ lib/ â”‚ â”œâ”€â”€ schemas/ â”‚ â””â”€â”€ values/ â”œâ”€â”€ public â”œâ”€â”€ specs â”œâ”€â”€ config.ru â”œâ”€â”€ Gemfile â”œâ”€â”€ Gemfile.lock â”œâ”€â”€ Rakefile â””â”€â”€ README.md</code> </pre> <br><p>  Jeder Ordner im <code>apps/</code> Verzeichnis implementiert die eine oder andere UnterdomÃ¤ne. Innerhalb jeder DomÃ¤ne gibt es verschiedene Muster: <code>entities</code> , <code>forms</code> , <code>services</code> usw. Wir werden jedes der angewendeten Muster in einem zukÃ¼nftigen Artikel ausfÃ¼hrlich betrachten. </p><br><p>  Jedes dieser Muster ist im entsprechenden Namespace (Namespace) implementiert.  Zum Beispiel ein Formular zum Erstellen eines Antrags auf Zahlung an einen Kurier: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Withdrawal</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#   module Forms #  class Create end end end</span></span></span></span></code> </pre> <br><h3 id="kak-realizovat-svyazi-mezhdu-sabdomeny">  Wie implementiere ich die Kommunikation zwischen Subdomains? </h3><br><p>  Schauen wir uns ein konkretes Beispiel an.  Wir haben ein Kurierkonto: <code>Registrations::Entities::Account</code> .  Es bezieht sich auf die Subdomain <code>Registrations</code> - da wir diese Domain nicht als Registrierungsprozess betrachten, sondern als Kontotabelle und Registrierungsbuch, wie in unserer GeschÃ¤ftsdokumentation angegeben. </p><br><p>  Wir haben zwei <em>Prozesse,</em> in deren AusfÃ¼hrung wir auf dieses Konto zugreifen. </p><br><ul><li>  Konto erstellen (Registrierung) </li><li>  Erstellung eines Antrags auf Abhebung von Geldern, die von einem Kurier verdient wurden (Wihtdrawal) </li></ul><br><p>  Wie wir sehen, gehÃ¶ren diese beiden Prozesse zu verschiedenen SubdomÃ¤nen - Registrierung und Wihtdrawal. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Registrations</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serivices</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateAccount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities::Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Withdrwals</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serivices</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateOrder</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Registrations::Entities::Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Im ersten Fall wird ein Aufruf der Klasse durch einen Aufruf von <code>Entities::Account</code> implementiert.  Und im zweiten Fall durch einen expliziten Aufruf von <code>Registrations::Entities::Account</code> .  Das heiÃŸt,  Wenn wir explizit eine Subdomain angeben, stammt die Klasse aus einer anderen Subdomain und wir geben die Verbindung klar an. </p><br><p>  Wenn die Klasse nicht explizit auf eine der SubdomÃ¤nen angewendet wird, ist es sinnvoll, sie in den Ordner <code>lib/</code> .  In der Regel sind dies Klassen, die das 'ValueObject'-Muster implementieren.  Wir werden dieses Muster in einem der folgenden Artikel genauer untersuchen. </p><br><h2 id="realizaciya-cherez-model">  Implementierung durch das Modell. </h2><br><p>  Um Eric Evans zu zitieren: </p><br><blockquote>  Wenn die Architektur des Programms oder zumindest ein zentraler Teil davon nicht der Struktur des DomÃ¤nenmodells entspricht, ist ein solches Modell praktisch nutzlos, und die korrekte Funktionsweise des Programms sollte ebenfalls in Frage gestellt werden.  Gleichzeitig sind zu komplexe Beziehungen zwischen Modellen und Funktionen in der Softwarearchitektur schwer zu verstehen und in der Praxis schwer aufrechtzuerhalten, wenn sich die Architektur Ã¤ndert. </blockquote><p>  Erinnern wir uns an das Beispiel eines guten Modells, das ich bereits am Anfang dieses Artikels zitiert habe - eine topografische Karte.  Unser Ziel ist es, schnell die Entfernung zwischen zwei Siedlungen zu finden.  Wir kÃ¶nnten eine Referenztabelle verwenden, die zwei Punkte zwischen StÃ¤dten zeigt.  Und wir kÃ¶nnen die Karte benutzen.  Sowohl dort als auch dort erhalten wir ungefÃ¤hr zur gleichen Zeit das gleiche Ergebnis.  Die Karte ist jedoch kompakter, zeigt den Themenbereich genauer an und ist universeller.  Die Karte als Modell ist unglaublich ausdrucksstark.  Und wenn wir es im Rahmen dieser Aufgabe betrachten, ist die Messung der Entfernung auf der Karte bequemer als auf dem Gebiet selbst, das sie widerspiegelt.  Ein Modell, das einen Themenbereich widerspiegelt, kann ihn in einigen Eigenschaften Ã¼bertreffen.  Es ist wirklich unglaublich. </p><br><p>  Die Implementierung des Modells ist immer ein kreativer Prozess mit unvorhersehbaren Ergebnissen.  Die QualitÃ¤t Ihres Codes ist weder seine Leistung noch seine KomplexitÃ¤t, sondern seine Einfachheit und Ausdruckskraft.  Verbessern Sie es durch stÃ¤ndiges Refactoring, machen Sie es flexibel und schneiden Sie alles UnnÃ¶tige ab.  Trennen Sie die Ebene, die fÃ¼r die GeschÃ¤ftslogik des Modells verantwortlich ist, von den Ebenen, deren Bedarf auf die technische Implementierung zurÃ¼ckzufÃ¼hren ist.  Wie wir das geschafft haben, wird spÃ¤ter beschrieben. </p><br><hr><br><div class="spoiler">  <b class="spoiler_title">Inspirationsquellen</b> <div class="spoiler_text"><ul><li>  Problemorientiertes Design, Eric J. Evans </li><li>  Erstellen von Microservices, Sam Newman </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://gorodinski.com/blog/2013/04/29/sub-domains-and-bounded-contexts-in-domain-driven-design-ddd/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://martinfowler.com/bliki/BoundedContext.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://habr.com/post/316438/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://dotnetcodr.com/2015/08/06/domain-driven-design-with-web-api-revisited-part-1-introduction/</a> </li><li>  Aberdeen Geschichte, Cristov Martin Wieland </li></ul><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de428209/">https://habr.com/ru/post/de428209/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de428193/index.html">Ãœber Touren gehen</a></li>
<li><a href="../de428197/index.html">Effektive persÃ¶nliche Finanzierung. Stufe 1</a></li>
<li><a href="../de428201/index.html">MaulwurfslÃ¶cher in JavaScript</a></li>
<li><a href="../de428203/index.html">Wir sehen uns die Diagramme an: SchÃ¤tzungen und Prognosen fÃ¼r den Cloud-Computing-Markt, Daten fÃ¼r 2018</a></li>
<li><a href="../de428205/index.html">Lifehacks NaviHaka</a></li>
<li><a href="../de428211/index.html">Das Buch â€EvolutionÃ¤re Architektur. UnterstÃ¼tzung fÃ¼r stÃ¤ndigen Wandel "</a></li>
<li><a href="../de428213/index.html">Interpretieren von Modellvorhersagen in SHAP</a></li>
<li><a href="../de428217/index.html">Millionen Videoanrufe pro Tag oder "Call Mom!"</a></li>
<li><a href="../de428219/index.html">Woher kommt die Praxis der Massenverlagerung von qualifiziertem Personal?</a></li>
<li><a href="../de428221/index.html">KI-Erzeugung realistischer Gesichter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>