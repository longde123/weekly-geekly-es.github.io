<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêì üéä ü•° Entwicklerkochbuch: Domain Driven Design Rezepte (Teil 2, Struktur und Interaktion) üëãüèª ‚åöÔ∏è üñêÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einf√ºhrung 


 Im ersten Artikel haben wir den Umfang der angegebenen Praktiken hervorgehoben, f√ºr welche Projekte sie angewendet werden k√∂nnen und f√º...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Entwicklerkochbuch: Domain Driven Design Rezepte (Teil 2, Struktur und Interaktion)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428209/"><p><img src="https://habrastorage.org/webt/fr/vw/on/frvwonyhe7k6st_x65v67hcbrcs.jpeg" alt="ddd-header"></p><br><h1 id="vvedenie">  Einf√ºhrung </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Im ersten Artikel haben</a> wir den Umfang der angegebenen Praktiken hervorgehoben, f√ºr welche Projekte sie angewendet werden k√∂nnen und f√ºr welche nicht. </p><br><p> In diesem Artikel m√∂chte ich einen kurzen √úberblick √ºber die Grundprinzipien von DDD geben und meine pers√∂nlichen Erfahrungen mit deren Anwendung teilen.  Wir werden detaillierter auf Kommunikations- und Strukturans√§tze mit Beispielen f√ºr deren Umsetzung eingehen. </p><br><p>  Im folgenden Artikel werde ich m√∂gliche Kombinationen der angewendeten Entwurfsmuster unter Ber√ºcksichtigung ihrer Implementierung aufschreiben und schlie√ülich ein Beispiel f√ºr eine spezifische Implementierung eines kleinen Mikroservices geben. </p><a name="habracut"></a><br><h1 id="ddd">  DDD </h1><br><p>  Erinnern Sie sich an die fr√ºhere Definition: </p><br><blockquote>  Domain-Driven Design (DDD) ist ein Ansatz zur Softwareentwicklung zur umfassenden Befriedigung von Anforderungen, indem die Implementierung eng mit den wichtigsten Gesch√§ftsmodellen verkn√ºpft wird, die st√§ndig weiterentwickelt werden. </blockquote><p>  Das Nachschlagewerk, das die Praxis des Aufbaus komplexer Systeme beschreibt, ist Eric Evans ' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Domain Driven Dedign</a> (Big Blue Book).  Wenn Sie einen √úbersichtsartikel zu diesem Thema lesen, wissen Sie bereits davon.  Wenn Sie DDD in der Praxis verwenden, m√ºssen Sie es lesen.  Dies ist nicht das am einfachsten zu lesende Buch: </p><br><blockquote>  Die kanonische Quelle f√ºr DDD ist Eric Evans 'Buch.  Es ist nicht das am einfachsten zu lesende in der Softwareliteratur, aber es ist eines dieser B√ºcher, die eine erhebliche Investition reichlich zur√ºckzahlen. <br><br>  Martin Fowler: 15. Januar 2014 </blockquote><p>  Wenn Sie durch den Inhalt des Buches scrollen, erscheint es Ihnen nicht ganz strukturiert.  Aber die Karte wird uns helfen. <br><img src="https://habrastorage.org/webt/oh/5e/tj/oh5etj1mf-uvet2bdyn7y1olj8k.png" alt="DDD-Karte"></p><br><p>  Auf der Karte sind jene Praktiken, die wir heute betrachten werden. </p><br><p>  Der Umfang der im Buch behandelten Praktiken ist riesig.  Der Umfang der Praktiken, die au√üerhalb dieses Buches angewendet werden k√∂nnen, ist noch gr√∂√üer.  Identifizieren Sie Ihre Ziele, bevor Sie zumindest einen Teil davon in Betrieb nehmen.  Ich werde mein eigenes als Beispiel geben. </p><br><ul><li>  Steigern Sie die Produktivit√§t. </li><li>  Schreiben Sie verst√§ndlichen Code. </li><li>  Skalierung auf Softwareentwicklungsebene. </li></ul><br><h2 id="edinyy-yazyk">  Einzelne Sprache </h2><br><p>  Softwareentwicklung f√ºhrt selten zur Schaffung von etwas Neuem, in der Regel ist dies eine Simulation von etwas Bestehendem. </p><br><blockquote>  Ein Modell ist eine Darstellung eines realen Objekts, die nur die erforderlichen Eigenschaften und Funktionen enth√§lt. </blockquote><p>  Wir k√∂nnen kein Softwareprodukt erstellen, das den gesamten Themenbereich abdeckt.  Es ist m√∂glich, nur den Teil davon zu reproduzieren, der die erforderliche Funktionalit√§t reproduziert. </p><br><p>  Ein gutes Beispiel f√ºr ein Modell w√§re eine topografische Karte.  Sie ist ein Gel√§ndemodell.  Die Karte enth√§lt keine Wiesen mit Feldern und Fl√ºssen, sondern spiegelt nur die Position realer Objekte relativ zueinander wider. </p><br><p>  Um ein klares und klares Modell f√ºr alle zu erstellen, m√ºssen Sie dieselbe Sprache sprechen.  Dies sagt uns nicht nur Eric Evans, sondern auch der gesunde Menschenverstand.  Wenn Programmierer ihre Begriffe verwenden und ihren eigenen "Slang" verwenden, wird der erstere einfach nicht verstehen, was zu tun ist.  In diesem Fall kann das Unternehmen die tats√§chlichen Kosten f√ºr die Entwicklung des einen oder anderen ‚ÄûFeatures‚Äú nicht realisieren.  Wie oft haben Sie schon geh√∂rt: "Ja, es ist nur eine Schaltfl√§che zum Hinzuf√ºgen"? </p><br><p>  Ihr Ziel als Systemdesigner sollte es sein, das maximale Verst√§ndnis des gesamten Teams voneinander zu erlangen.  Wie erreicht man das?  Fang an zu reden.  Wenn Menschen beginnen, in einer engen Gruppe zu kommunizieren, haben sie bestimmte allgemein akzeptierte Begriffe.  In verschiedenen Unternehmen ist der Prozess der Einf√ºhrung einer gemeinsamen Sprache wahrscheinlich unterschiedlich.  Dies kann entweder eine willensstarke Entscheidung oder ein demokratisches Verfahren sein.  Die Sprache kann explizit angegeben werden und wird nicht explizit eingegeben. In diesem Fall beginnen sie einfach, sie zu sprechen.  Eine gute Technik zur Einf√ºhrung einer gemeinsamen Sprache ist die allgemeine Dokumentation. </p><br><h3 id="kak-vesti-dokumentaciyu-proekta">  So bewahren Sie die Projektdokumentation auf </h3><br><ol><li>  Jede Kommunikation zwischen Gesch√§ft und Entwicklung sollte Ihr Modell verbessern. </li><li>  Notieren Sie nach dem Meeting das Ergebnis in Form einer Dokumentation (Scrum-Artefakt) und zeigen Sie diese Dokumentation allen Teilnehmern des Entwicklungsprozesses. </li><li>  Verwenden Sie eine einzige Sprache in der Dokumentation. </li><li>  Am wichtigsten: Verschwenden Sie keine Zeit mit der Dokumentation.  Sie m√ºssen noch Code schreiben, und die Dokumentation wird viele Male neu geschrieben. Das Ausgeben von Ressourcen ist teuer.  Verwenden Sie eine Serviette, einen Stift und eine Kamera auf Ihrem Telefon, anstatt lange mit der UML-Diagrammanwendung herumzuspielen. </li><li>  Dokumentation erfordert Disziplin, Sie k√∂nnen sie nicht von Zeit zu Zeit schreiben. </li><li>  Trennen Sie die Dokumentation: <br><ul><li> Kommentare im Code - Beschreiben Sie unverst√§ndliche Momente direkt im Code. Lassen Sie <code>#ODO:</code> (entfernen, wenn Sie den Code in den Master einf√ºgen).  Dr√ºcken Sie Ihre Meinung in den Kommentaren aus, zum Beispiel m√ºssen Sie die eine oder andere Kr√ºcke verwenden, wenn Sie mit Legasy-Code arbeiten. </li><li>  Kommentare zum Projekt <code>README.md</code> im Stammverzeichnis Ihres Projekts sollten technische Informationen enthalten: Starten des Projekts, Ausf√ºhren von Tests usw.  Es ist auch eine gute Idee, eine Karte zu erstellen, auf der Sie alle Projekte haben und auf welchen Servern sie ausgef√ºhrt werden.  Notieren Sie alle akzeptierten Vereinbarungen separat. </li><li>  Und vor allem die Wissensbasis.  Eine Sammlung von Dokumenten, die Gesch√§ftsprozesse beschreiben. Dies ist der Teil der Dokumente, der sowohl Ihnen als auch dem Unternehmen zur Verf√ºgung steht. </li></ul></li><li>  Der Hauptfehler derjenigen, die Dokumentation schreiben, ist Redundanz.  Versuchen Sie nicht, alles und jedes abzudecken, sondern vermitteln Sie nur die allgemeine Bedeutung.  Die Dokumentation sollte Ihr Projekt erg√§nzen, aber in keiner Weise ersetzen.  Schreiben Sie nicht alle Begriffe auf, die nur mehrdeutig sind.  Wenn eine Definition mehr als zwei S√§tze umfasst, ist sie eine schlechte Definition. </li></ol><br><p>  Dokumentationsbeispiel: </p><br><pre> <code class="markdown hljs"><span class="hljs-section"><span class="hljs-section">#         . # :  : -    - email -  ## : ###        ,     email  ,    1  (      email  ). ###           .          email . ###  email  email     .    ,    email.   . ###       ,     ,    .   . ###      email,    ,       .   2 . ###                  .    ,     ,             .</span></span></code> </pre><br><p>  Beachten Sie, dass wir in diesem Beispiel kein explizites W√∂rterbuch angegeben haben, das Konzept von <em>Benutzer</em> , <em>Autorisierung</em> und <em>Registrierung jedoch korrigiert haben</em> .  Das Schreiben einer solchen Dokumentation dauert f√ºr den Experten nicht l√§nger als 20 Minuten. </p><br><p>  F√ºr eine Person, die kein Experte auf dem Gebiet ist, wird der Prozess des Schreibens von Dokumentation als etwas Kompliziertes empfunden.  Es ist notwendig, die Sammlung von Wissen und die Aufzeichnung des gesammelten Wissens zu trennen. <code> !=  +  .</code> </p><br><blockquote>  "Was Sie das Universum nennen", sagte der vierte, "ist in der Tat eine Ansammlung von Welten, die wie die Haut eines Bogens √ºbereinander liegen und allm√§hlich voneinander getrennt werden." <br><br>  - Ungew√∂hnlich klar gesagt!  - bewunderte die Abderiten.  - Erstaunlich klar!  "Sie dachten, sie h√§tten den Philosophen verstanden, weil sie sehr gut wussten, was die Zwiebel war." <br><br>  Aberdeen Story, Cristov Martin Wieland </blockquote><br><h2 id="ogranichennyy-konteksty-i-domeny">  Begrenzte Kontexte und Dom√§nen </h2><br><p>  Stellen Sie sich vor, wir w√§ren Designer eines progressiven Startups.  Wir alle lieben gek√ºhlte Pizza, fluchen mit Kurieren und f√ºllen stundenlang Formulare auf der Baustelle aus.  Deshalb haben wir uns ein wunderbares Startup ‚ÄûVier Schildkr√∂ten und eine Ratte‚Äú ausgedacht: </p><br><ul><li>  Es gibt eine Seite, auf der Pizzerien registriert sind und ihre tats√§chlichen Gerichte ver√∂ffentlichen. </li><li>  Diese Pizzerien haben keinen eigenen Kurierdienst. </li><li>  Es gibt Kunden, die die Pizzeria nicht erreichen k√∂nnen, aber bereit sind, eine Bestellung √ºber die Website oder die mobile Anwendung aufzugeben. </li><li>  Killer-Feature: Kuriere sind keine speziell eingestellten Mitarbeiter, sondern normale Leute, die sich √ºber die mobile Anwendung registriert haben </li><li>  Kuriere erhalten Befehle, nach ihrer Ausf√ºhrung erhalten sie eine Bezahlung f√ºr die geleistete Arbeit. </li><li>  Das Warten auf solche Kuriere dauert l√§nger, aber die Lieferung und dementsprechend die Pizza sind billiger. </li></ul><br><p>  Erinnern wir uns an die Dokumentation, die wir im vorherigen Kapitel beschrieben haben.  Dort wurde in unserem einzigen W√∂rterbuch der Begriff <em>Registrierung verwendet</em> .  Aber in diesem Projekt haben wir mehrere davon: </p><br><ul><li>  Kundenregistrierung </li><li>  Pizzeria Registrierung </li><li>  Kurierregistrierung </li><li>  Bestellregistrierung </li></ul><br><p>  Eine einheitliche Sprache geh√∂rt zu einem begrenzten Kontext.  Die Dom√§ne der obigen Dokumentation ist "Autorisierungssystem".  Versuchen wir, Domains f√ºr unser Startup zuzuweisen. </p><br><p>  Bevor wir beginnen, schauen wir uns eine kleine Terminologie an, was eine Domain ist und was ein begrenzter Kontext ist. </p><br><blockquote>  Domain (Domain) - eine Darstellung einer realen Gesch√§ftsstruktur, die ein bestimmtes Problem l√∂st. </blockquote><p>  Zum Beispiel: Logistiksystem, Zahlungssystem, Autorisierungssystem, Auftragsverwaltungssystem. </p><br><p>  Die Domain ist in Subdomains unterteilt, die kleinere Strukturen beschreiben, zum Beispiel: einen Auftragskorb, ein System zum Erstellen von Routen. </p><br><p>  Jede Domain hat einen begrenzten Verantwortungsbereich - eingeschr√§nkte Funktionalit√§t. </p><br><blockquote>  Begrenzter Kontext - Eine Reihe von Dom√§neneinschr√§nkungen, mit denen sich die Dom√§ne auf nur eine Aufgabe konzentrieren kann, um die beste L√∂sung zu finden. </blockquote><p>  Ich m√∂chte diesen Begriff als solche Abstraktion pr√§sentieren.  Eine Domain ist ein Kreis.  Ein eingeschr√§nkter Kontext ist ein Kreis. </p><br><p><img src="https://habrastorage.org/webt/nf/nm/jz/nfnmjzlgui85mvfatppogqv-kdq.jpeg" alt="Domain-Kontext"></p><br><p>  Auch in der DDD-Terminologie wird der Kernel zugewiesen. </p><br><blockquote>  Der Kern (Kerndom√§ne) - die wichtigste Dom√§ne, die Ihr Unternehmen am meisten charakterisiert. </blockquote><p>  Also, die Dom√§nen des Projekts "Vier Schildkr√∂ten und eine Ratte": </p><br><p>  <strong>Arbeit mit einer Pizzeria</strong> (Pizzarias) </p><br><p>  <em>Kontext</em> : b2b alles was mit Pizzerien zu tun hat </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  Registrierung neuer Pizzerien </li><li>  Sortiment hinzuf√ºgen </li><li>  Aktualisieren des Status der Verf√ºgbarkeit eines Produkts </li></ul><br><p>  <strong>Arbeiten Sie mit dem Kunden</strong> (Kunden) </p><br><p>  <em>Kontext</em> : b2c, alles was mit der Arbeit mit Pizzakunden zu tun hat </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  Sortiment anzeigen </li><li>  Informationsmaterialien </li></ul><br><p>  <strong>Arbeit mit Kurieren</strong> (Liefersystem) </p><br><p>  <em>Kontext</em> : b2e, alles was mit der Arbeit mit Kurieren zu tun hat </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  Kurierregistrierung </li><li>  Aufgabenverteilung </li><li>  Registrierung von Antr√§gen auf Abhebung von Geldern, die der Kurier verdient hat. </li></ul><br><p>  Bestellsystem </p><br><p>  <em>Kontext</em> : Kernel.  Erm√∂glicht die Koordination aller einzelnen Domains und bietet einen vollst√§ndigen Zyklus vom Eingang einer Bestellung bis zur Lieferung der Pizza an den Benutzer.  Es ist kein Performer, sondern spielt die Rolle eines Dirigenten. </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  Auftragsannahme </li><li>  Auftragsausf√ºhrung </li><li>  Auftragsstatusverfolgung </li></ul><br><p>  <strong>Abrechnungssystem</strong> (Abrechnung) </p><br><p>  <em>Kontext</em> : Enth√§lt alle Finanztransaktionen.  Es bietet Interaktion mit dem Bearbeitungszentrum. </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  Geld f√ºr Bestellungen annehmen </li><li>  Kurieren Geld f√ºr geleistete Arbeit geben </li></ul><br><p>  <strong>Statistiksystem</strong> </p><br><p>  <em>Kontext</em> : Das Sammeln und Verarbeiten (nicht Ausgeben) von analytischen Informationen. </p><br><p>  <em>Subdomains</em> : </p><br><ul><li>  Statistiken √ºber Fonds </li><li>  Anwendungsstatistik </li></ul><br><p>  <strong>Managementsystem</strong> ( <strong>Management</strong> Panel) </p><br><p>  <em>Kontext</em> : Die Ausgabe von analytischen Informationen.  Toolkit f√ºr Managemententscheidungen. </p><br><ul><li>  Analyse basierend auf gesammelten Statistiken </li><li>  Vormoderation von Zahlungen an Kuriere </li></ul><br><p>  Lassen Sie es uns anhand der Domains zuordnen. </p><br><blockquote>  Eine Domain Map (Context Map) ist ein grafisches Tool, mit dem Sie die Beziehungen zwischen einzelnen Domains beschreiben k√∂nnen. </blockquote><p><img src="https://habrastorage.org/webt/p1/ks/po/p1kspot2qqut90gzcn1b9fhxyn8.png" alt="Kontext-Karte"></p><br><p>  Die Karte zeigt Links zwischen Domains.  Diese Karte ist sehr oberfl√§chlich, aber der Themenbereich ist nicht gut verstanden.  Dies ist die erste Skizze, bei der Sie das erwartete Ergebnis erhalten. </p><br><p>  Das Wichtigste auf der Karte ist, dass wir Verbindungen zwischen Dom√§nen sehen.  Eine solche Struktur passt sehr gut zur Microservice-Architektur: </p><br><blockquote>  Das Hauptprinzip der Microservice-Architektur: schwache Konnektivit√§t und starke Haftung. </blockquote><p>  Dieses Prinzip wird in dem Buch von Sam Newman - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Creating Microservices beschrieben</a> . Dies ist das zweite Buch, das Sie lesen m√ºssen, um die in diesem Artikel beschriebenen Ans√§tze in die Praxis umzusetzen.  Was ist gemeint: Dom√§nen sollten lose gekoppelt, aber intern eng miteinander verbunden sein. </p><br><p>  Die √úbersetzung dieser Begriffe stammt aus der offiziellen russischen √úbersetzung und spiegelt m√∂glicherweise die √ºbermittelte Bedeutung nur schlecht wider.  In den urspr√ºnglichen Begriffen sind: Geringe Kopplung (Konnektivit√§t, Eingriff, Griffigkeit, Konjugation), hohe Koh√§sion (Konnektivit√§t, St√§rke). </p><br><h2 id="praktika-realizacii-domennogo-razdelenie">  Implementierungspraxis f√ºr die gemeinsame Nutzung von Dom√§nen </h2><br><p>  Ich m√∂chte meine pers√∂nlichen Erfahrungen teilen - eine Reihe von fundierten Entscheidungen.  Ich fordere Sie nicht auf, diese L√∂sungen zu verwenden.  Aber sie k√∂nnen eine gute Wahl sein, wenn Sie nicht wissen, wo Sie anfangen sollen.  Mit pers√∂nlicher Erfahrung werden die Tools weiter auf Ihre Bed√ºrfnisse zugeschnitten. </p><br><p>  Die Hauptprinzipien, die uns geleitet haben: </p><br><ul><li>  Die Einfachheit der L√∂sung.  Machen Sie komplexe Dinge einfach, nicht einfach kompliziert. </li><li>  Pragmatismus  Sie m√ºssen immer die Situation betrachten und in Ermangelung einer vorhandenen L√∂sung eine neue entwickeln.  Versuchen Sie, alles zu typisieren, aber vermeiden Sie Dogmatismus. </li><li>  Code! = Dokumentation.  Der Code ist eine Anweisung f√ºr die Maschine, die Dokumentation ist eine Anweisung f√ºr Personen.  Keine Notwendigkeit, sie zu verwirren und nacheinander herauszugeben. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">FEST</a> </li></ul><br><h3 id="kak-realizovat-domeny">  Wie implementiere ich Domains? </h3><br><p>  Es ist sehr praktisch, Dom√§nen als separate Mikrodienste auszuw√§hlen. </p><br><blockquote>  Microservices ist eine separate Anwendung, die die Logik einer Dom√§ne implementiert. </blockquote><p>  In der DDD-Entwicklung ist das Prinzip der Zuordnung eines Mikrodienstes zu einer separaten Anwendung in einem begrenzten Kontext begrenzt.  Dies negiert nicht das technische Prinzip der Trennung von Diensten (wenn dies auf die Notwendigkeit zur√ºckzuf√ºhren ist, eine hohe Leistung sicherzustellen).  Das Kontextprinzip wird jedoch dominant und bindend sein. </p><br><h3 id="kak-vydelit-svyazi-mezhdu-domenami">  Wie kann die Beziehung zwischen Dom√§nen hervorgehoben werden? </h3><br><p>  Beziehungen zwischen Dom√§nen sind immer eine API.  Es k√∂nnte RESTful json api, gRPC, AMPQ sein.  Im Rahmen dieses Artikels werden wir kein Protokoll mit einem anderen vergleichen und ihre Vor- und Nachteile hervorheben, da jedes von ihnen seinen eigenen Anwendungsbereich hat.  Lassen Sie uns dennoch auf allgemeine Empfehlungen eingehen: </p><br><p>  <strong>Seien Sie flexibel bei der Auswahl eines Protokolls und starr in der Einheitlichkeit seiner Implementierung.</strong> </p><br><p>  W√§hlen Sie ein Protokoll f√ºr jedes Dom√§nenpaar einzeln aus. Versuchen Sie nicht, http √ºberall zu verwenden. M√∂glicherweise ben√∂tigen Sie irgendwo asynchrone Warteschlangen, und die Vorteile von AMPQ werden f√ºr Sie offensichtlich.  Ignorieren Sie diese Gelegenheit nicht, denn Sie haben √ºberall RESTful. </p><br><p>  Wenn Sie andererseits RESTful json implementieren, verwenden Sie einen Datenstrukturierungsstandard.  Sie k√∂nnen zum Beispiel jsonapi oder openapi fertig machen.  Wenn aus irgendeinem Grund vorgefertigte L√∂sungen nicht zu Ihnen passen und Sie das Gef√ºhl haben, dass Sie Ihren Standard entwickeln, beschreiben und verwenden k√∂nnen.  Aber verwenden Sie es √ºberall, z√ºchten Sie keine "Zoo" -Standards.  Wenn Sie mit einem externen System kommunizieren m√ºssen, das nichts √ºber Ihre Standards wei√ü, schreiben Sie einen Microservice-Adapter. </p><br><p><img src="https://habrastorage.org/webt/cz/ff/go/czffgobmp7v9lr2pzkjx0-3y5xq.png" alt="Adapter"></p><br><h3 id="kak-realizovat-sabdomeny">  Wie implementiere ich Subdomains? </h3><br><p>  Als separate Module innerhalb eines Microservices. </p><br><blockquote>  Ein Modul ist eine Implementierung einer Subdomain, indem Logik in einem separaten Namespace (Namespace) innerhalb eines einzelnen Microservices abgelegt wird. </blockquote><p>  Wie sieht das alles aus?  Schauen wir uns ein Beispiel an.  Wie wir uns erinnern, haben wir eine Liefersystemdom√§ne - diese Dom√§ne hat drei Unterdom√§nen: </p><br><ul><li>  Kurierregistrierung </li><li>  Ausgabe von Aufgaben (Aufgaben) </li><li>  Registrierung von Antr√§gen auf Abhebung von Geldern, die der Kurier verdient hat (Abhebung) </li><li>  √úberpr√ºfen, ob Ihr Microservice funktioniert, technisches Hilfswerkzeug (healt_checker) </li></ul><br><p>  Stellen Sie sich das alles in Form einer Ordnerstruktur vor: </p><br><pre> <code class="bash hljs">$ tree --dirsfirst delivery_system delivery_system ‚îú‚îÄ‚îÄ app/ ‚îÇ ‚îú‚îÄ‚îÄ health_checker/ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îú‚îÄ‚îÄ registrations/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ entities/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ forms/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ repositories/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ interactor/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ services/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ validations/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ helpers.rb ‚îÇ ‚îú‚îÄ‚îÄ tasks ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ entities/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ queries/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ repositories/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ helpers.rb ‚îÇ ‚îî‚îÄ‚îÄ withdrawals ‚îÇ ‚îú‚îÄ‚îÄ entities/ ‚îÇ ‚îú‚îÄ‚îÄ forms/ ‚îÇ ‚îú‚îÄ‚îÄ repositories/ ‚îÇ ‚îú‚îÄ‚îÄ interactor/ ‚îÇ ‚îú‚îÄ‚îÄ services/ ‚îÇ ‚îú‚îÄ‚îÄ validations/ ‚îÇ ‚îú‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îî‚îÄ‚îÄ helpers.rb ‚îú‚îÄ‚îÄ config/ ‚îú‚îÄ‚îÄ db/ ‚îú‚îÄ‚îÄ docs/ ‚îú‚îÄ‚îÄ lib/ ‚îÇ ‚îú‚îÄ‚îÄ schemas/ ‚îÇ ‚îî‚îÄ‚îÄ values/ ‚îú‚îÄ‚îÄ public ‚îú‚îÄ‚îÄ specs ‚îú‚îÄ‚îÄ config.ru ‚îú‚îÄ‚îÄ Gemfile ‚îú‚îÄ‚îÄ Gemfile.lock ‚îú‚îÄ‚îÄ Rakefile ‚îî‚îÄ‚îÄ README.md</code> </pre> <br><p>  Jeder Ordner im <code>apps/</code> Verzeichnis implementiert die eine oder andere Unterdom√§ne. Innerhalb jeder Dom√§ne gibt es verschiedene Muster: <code>entities</code> , <code>forms</code> , <code>services</code> usw. Wir werden jedes der angewendeten Muster in einem zuk√ºnftigen Artikel ausf√ºhrlich betrachten. </p><br><p>  Jedes dieser Muster ist im entsprechenden Namespace (Namespace) implementiert.  Zum Beispiel ein Formular zum Erstellen eines Antrags auf Zahlung an einen Kurier: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Withdrawal</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#   module Forms #  class Create end end end</span></span></span></span></code> </pre> <br><h3 id="kak-realizovat-svyazi-mezhdu-sabdomeny">  Wie implementiere ich die Kommunikation zwischen Subdomains? </h3><br><p>  Schauen wir uns ein konkretes Beispiel an.  Wir haben ein Kurierkonto: <code>Registrations::Entities::Account</code> .  Es bezieht sich auf die Subdomain <code>Registrations</code> - da wir diese Domain nicht als Registrierungsprozess betrachten, sondern als Kontotabelle und Registrierungsbuch, wie in unserer Gesch√§ftsdokumentation angegeben. </p><br><p>  Wir haben zwei <em>Prozesse,</em> in deren Ausf√ºhrung wir auf dieses Konto zugreifen. </p><br><ul><li>  Konto erstellen (Registrierung) </li><li>  Erstellung eines Antrags auf Abhebung von Geldern, die von einem Kurier verdient wurden (Wihtdrawal) </li></ul><br><p>  Wie wir sehen, geh√∂ren diese beiden Prozesse zu verschiedenen Subdom√§nen - Registrierung und Wihtdrawal. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Registrations</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serivices</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateAccount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities::Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Withdrwals</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serivices</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateOrder</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Registrations::Entities::Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Im ersten Fall wird ein Aufruf der Klasse durch einen Aufruf von <code>Entities::Account</code> implementiert.  Und im zweiten Fall durch einen expliziten Aufruf von <code>Registrations::Entities::Account</code> .  Das hei√üt,  Wenn wir explizit eine Subdomain angeben, stammt die Klasse aus einer anderen Subdomain und wir geben die Verbindung klar an. </p><br><p>  Wenn die Klasse nicht explizit auf eine der Subdom√§nen angewendet wird, ist es sinnvoll, sie in den Ordner <code>lib/</code> .  In der Regel sind dies Klassen, die das 'ValueObject'-Muster implementieren.  Wir werden dieses Muster in einem der folgenden Artikel genauer untersuchen. </p><br><h2 id="realizaciya-cherez-model">  Implementierung durch das Modell. </h2><br><p>  Um Eric Evans zu zitieren: </p><br><blockquote>  Wenn die Architektur des Programms oder zumindest ein zentraler Teil davon nicht der Struktur des Dom√§nenmodells entspricht, ist ein solches Modell praktisch nutzlos, und die korrekte Funktionsweise des Programms sollte ebenfalls in Frage gestellt werden.  Gleichzeitig sind zu komplexe Beziehungen zwischen Modellen und Funktionen in der Softwarearchitektur schwer zu verstehen und in der Praxis schwer aufrechtzuerhalten, wenn sich die Architektur √§ndert. </blockquote><p>  Erinnern wir uns an das Beispiel eines guten Modells, das ich bereits am Anfang dieses Artikels zitiert habe - eine topografische Karte.  Unser Ziel ist es, schnell die Entfernung zwischen zwei Siedlungen zu finden.  Wir k√∂nnten eine Referenztabelle verwenden, die zwei Punkte zwischen St√§dten zeigt.  Und wir k√∂nnen die Karte benutzen.  Sowohl dort als auch dort erhalten wir ungef√§hr zur gleichen Zeit das gleiche Ergebnis.  Die Karte ist jedoch kompakter, zeigt den Themenbereich genauer an und ist universeller.  Die Karte als Modell ist unglaublich ausdrucksstark.  Und wenn wir es im Rahmen dieser Aufgabe betrachten, ist die Messung der Entfernung auf der Karte bequemer als auf dem Gebiet selbst, das sie widerspiegelt.  Ein Modell, das einen Themenbereich widerspiegelt, kann ihn in einigen Eigenschaften √ºbertreffen.  Es ist wirklich unglaublich. </p><br><p>  Die Implementierung des Modells ist immer ein kreativer Prozess mit unvorhersehbaren Ergebnissen.  Die Qualit√§t Ihres Codes ist weder seine Leistung noch seine Komplexit√§t, sondern seine Einfachheit und Ausdruckskraft.  Verbessern Sie es durch st√§ndiges Refactoring, machen Sie es flexibel und schneiden Sie alles Unn√∂tige ab.  Trennen Sie die Ebene, die f√ºr die Gesch√§ftslogik des Modells verantwortlich ist, von den Ebenen, deren Bedarf auf die technische Implementierung zur√ºckzuf√ºhren ist.  Wie wir das geschafft haben, wird sp√§ter beschrieben. </p><br><hr><br><div class="spoiler">  <b class="spoiler_title">Inspirationsquellen</b> <div class="spoiler_text"><ul><li>  Problemorientiertes Design, Eric J. Evans </li><li>  Erstellen von Microservices, Sam Newman </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://gorodinski.com/blog/2013/04/29/sub-domains-and-bounded-contexts-in-domain-driven-design-ddd/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://martinfowler.com/bliki/BoundedContext.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://habr.com/post/316438/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://dotnetcodr.com/2015/08/06/domain-driven-design-with-web-api-revisited-part-1-introduction/</a> </li><li>  Aberdeen Geschichte, Cristov Martin Wieland </li></ul><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de428209/">https://habr.com/ru/post/de428209/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de428193/index.html">√úber Touren gehen</a></li>
<li><a href="../de428197/index.html">Effektive pers√∂nliche Finanzierung. Stufe 1</a></li>
<li><a href="../de428201/index.html">Maulwurfsl√∂cher in JavaScript</a></li>
<li><a href="../de428203/index.html">Wir sehen uns die Diagramme an: Sch√§tzungen und Prognosen f√ºr den Cloud-Computing-Markt, Daten f√ºr 2018</a></li>
<li><a href="../de428205/index.html">Lifehacks NaviHaka</a></li>
<li><a href="../de428211/index.html">Das Buch ‚ÄûEvolution√§re Architektur. Unterst√ºtzung f√ºr st√§ndigen Wandel "</a></li>
<li><a href="../de428213/index.html">Interpretieren von Modellvorhersagen in SHAP</a></li>
<li><a href="../de428217/index.html">Millionen Videoanrufe pro Tag oder "Call Mom!"</a></li>
<li><a href="../de428219/index.html">Woher kommt die Praxis der Massenverlagerung von qualifiziertem Personal?</a></li>
<li><a href="../de428221/index.html">KI-Erzeugung realistischer Gesichter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>