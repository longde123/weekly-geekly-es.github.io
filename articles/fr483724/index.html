<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßî üéûÔ∏è üå®Ô∏è Travailler avec des pneus personnalis√©s complexes Redd üßùüèº üë®üèæ‚Äçüî¨ ‚ÅâÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans le dernier article, nous avons commenc√© √† nous familiariser avec la fa√ßon dont vous pouvez travailler avec des pneus standard bien connus en util...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Travailler avec des pneus personnalis√©s complexes Redd</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483724/">  Dans le <a href="https://habr.com/ru/post/477662/">dernier article,</a> nous avons commenc√© √† nous familiariser avec la fa√ßon dont vous pouvez travailler avec des pneus standard bien connus en utilisant le complexe Redd, apr√®s quoi j'ai promis de passer √† la fa√ßon d'acc√©der √† des pneus plus exotiques.  Mais apr√®s avoir parl√© avec quelques connaissances, j'ai soudain r√©alis√© que tout le monde ne lisait pas l'article √©crit sur le complexe Redd en dehors de ce cycle.  Et, en cons√©quence, tout le monde ne sait pas pourquoi ces pneus ont √©t√© ajout√©s au complexe.  Vous pouvez, bien s√ªr, simplement vous r√©f√©rer √† <a href="https://habr.com/ru/post/440156/">cet article</a> , mais il me semble qu'il serait plus correct de redire sa partie correspondante en r√©f√©rence au th√®me de ce cycle particulier.  Par cons√©quent, aujourd'hui, nous examinerons non seulement les questions pratiques, mais aussi th√©oriques concernant les pneus vendus par le complexe Redd. <br><br><img src="https://habrastorage.org/webt/af/-c/vx/af-cvxucoo4l55__goxrdffbbtc.png"><br><a name="habracut"></a><br><h2>  Partie th√©orique ennuyeuse </h2><br><h3>  Ce que nous consid√©rerons </h3><br>  Passons bri√®vement (autant que possible) en revue certaines questions th√©oriques pour comprendre clairement pourquoi tout se fait dans le complexe Redd d'une mani√®re ou d'une autre.  Tout d'abord, la t√¢che principale du complexe ... Curieusement, dans le cadre de cette s√©rie d'articles, je n'ai jamais √©crit √† ce sujet.  Oui, et je n'ai pas l'intention d'√©crire.  Le fait est que la t√¢che principale est un acc√®s √† distance conjoint au d√©bogage de certains mat√©riels (des microcontr√¥leurs aux √©normes syst√®mes de processeurs multic≈ìurs).  R√©servation du temps de travail, offrant un acc√®s physique √† travers des canaux de moche moyenne (et pas seulement id√©ale) et d'autres d√©lices.  Le d√©bogage peut se faire via JTAG ou via d'autres outils fournis par les environnements de d√©veloppement.  Une grande √©quipe y travaille, tout y est tr√®s int√©ressant, mais je n'aime pas la bureaucratie, donc je ne veux pas √©crire sur ces sujets.  Peut-√™tre qu'√† l'avenir, quelqu'un d'autre comblera cette lacune ... En attendant, j'√©cris sur les outils <b>auxiliaires</b> du complexe. <br><br>  Oui, oui, tout ce que je d√©cris depuis plus de six mois n'est que des choses con√ßues pour <b>aider les</b> d√©veloppeurs. <br><br><div class="spoiler">  <b class="spoiler_title">Articles du cycle pr√©c√©dent</b> <div class="spoiler_text"><ol><li>  <a href="https://habr.com/ru/post/452656/">D√©veloppement du ¬´firmware¬ª le plus simple pour les FPGA install√©s dans Redd, et d√©bogage en utilisant le test de m√©moire comme exemple.</a> </li><li>  <a href="https://habr.com/ru/post/453682/">D√©veloppement du ¬´firmware¬ª le plus simple pour les FPGA install√©s dans Redd.</a>  <a href="https://habr.com/ru/post/453682/">Partie 2. Code de programme.</a> </li><li>  <a href="https://habr.com/ru/post/454938/">D√©veloppement de son propre noyau pour l'int√©gration dans un syst√®me de processeur FPGA.</a> </li><li>  <a href="https://habr.com/ru/post/456008/">D√©veloppement de programmes pour le processeur central Redd sur l'exemple d'acc√®s au FPGA.</a> </li><li>  <a href="https://habr.com/ru/post/462253/">Les premi√®res exp√©riences utilisant le protocole de streaming sur l'exemple de la communication CPU et processeur dans le FPGA Redd</a> </li><li>  <a href="https://habr.com/ru/post/464795/">Joyeux Quartusel, ou comment le processeur est arriv√© √† une telle vie.</a> </li><li>  <a href="https://habr.com/ru/post/467353/">M√©thodes d'optimisation de code pour Redd.</a>  <a href="https://habr.com/ru/post/467353/">Partie 1: effet de cache.</a> </li><li>  <a href="https://habr.com/ru/post/468027/">M√©thodes d'optimisation de code pour Redd.</a>  <a href="https://habr.com/ru/post/468027/">Partie 2: m√©moire non mise en cache et fonctionnement sur bus parall√®le.</a> </li><li>  <a href="https://habr.com/ru/post/469985/">Optimisation √©tendue du code: remplacement d'un g√©n√©rateur d'horloge pour am√©liorer les performances du syst√®me.</a> </li><li>  <a href="https://habr.com/ru/post/477662/">Acc√®s aux bus Redd mis en ≈ìuvre sur les contr√¥leurs FTDI</a> </li></ol><br></div></div><br><h3>  Pourquoi dans le complexe Redd, des pneus standard sont mis en ≈ìuvre </h3><br>  Tr√®s souvent, vous devez d√©velopper du mat√©riel sans y avoir acc√®s vous-m√™me.  Regardons un exemple sp√©cifique d'un projet qui a de bons liens.  Voici, par exemple, mes <a href="https://www.astrosoft.ru/about/clients/cassel-aero/" rel="nofollow">h√©licopt√®res</a> pr√©f√©r√©s.  Nous sommes ici et les h√©licopt√®res sont en Su√®de.  De plus, nous avons ordonn√© le d√©veloppement en hiver, lorsque les h√©licopt√®res ne pouvaient physiquement pas remplir les fonctions que nous leur avons mises en place (√† savoir, fertiliser le sol dans les for√™ts: le sol √©tait √† l'√©poque sous des cong√®res).  Il s'av√®re que les appareils install√©s dans l'h√©licopt√®re doivent √™tre √©mul√©s pendant le d√©bogage et le vol - virtuellement. <br><br>  Mais c'est du d√©bogage.  Lors du test d'un projet, l'√©mulation est la seule option.  Le testeur doit tout v√©rifier dans le nombre maximum de modes, en triant diff√©rentes combinaisons.  De plus, il doit cr√©er des situations avec des conditions critiques et d'urgence (un tel travail destructeur pour les testeurs).  Comment le faire sur du vrai mat√©riel?  Uniquement sur les √©mulateurs. <br><br>  Comment se passe la communication avec les appareils modernes?  Habituellement - via des bus standard, car les d√©veloppeurs d'appareils ont tendance √† se connecter via quelque chose que les consommateurs connaissent d√©j√†.  C'est juste Redd et agira comme un √©mulateur de nombreux appareils.  Ses bus sont connect√©s au bloc d√©velopp√©.  Et l'appareil sera s√ªr de fonctionner avec un √©quipement r√©el, ne sachant pas que de l'autre c√¥t√© des pneus n'est pas un tas de fer, mais le complexe Redd, sur lequel tournent un certain nombre d'√©mulateurs. <br><br>  Lorsque vous travaillez avec un √©quipement r√©el, les pneus peuvent agir comme des analyseurs, enregistrant le travail avec du mat√©riel r√©el pour analyser les vols en cas de probl√®mes. <br><br>  En g√©n√©ral, il devrait y avoir autant de pneus que possible et leur ensemble aussi vari√© que possible.  Cependant, dans tout ce dont vous avez besoin pour conna√Ætre la mesure.  Eh bien, ne serait-ce que parce que chaque bus co√ªte de l'argent et prend de la place dans le bo√Ætier et √©galement sur le connecteur.  Voyons maintenant quelles strat√©gies sont les mieux utilis√©es pour contr√¥ler ces bus par programmation. <br><br><h3>  Qui dirigera le d√©veloppement du code pour Redd </h3><br>  Dans les entreprises modernes, Sa Majest√© l'heure de l'homme est au premier plan.  Le fait est que c'est une ressource tr√®s co√ªteuse √† bien des √©gards (argent, temps de d√©veloppement, disponibilit√© d'un sp√©cialiste √† ce moment particulier pour cela et d'autres t√¢ches de l'entreprise, etc.), donc si la direction peut √©conomiser des heures, elle le fera.  S'il est possible de ne pas ajouter de d√©veloppeurs √† l'√©quipe, ils ne seront pas ajout√©s.  S'il est possible de tout faire en moins de temps, ils √©limineront les d√©veloppeurs afin qu'ils puissent le faire en moins de temps. <br><br>  Il en r√©sulte qu'il est peu probable qu'ils confient √† des sp√©cialistes individuels l'√©criture d'√©mulateurs.  Et s'ils le font, ils seront des programmeurs ordinaires travaillant dans la m√™me entreprise. <br><br>  Pourquoi j'√©cris √ßa.  Dans certains articles, il est consid√©r√© comme chic lorsque certains langages sp√©cialis√©s sont utilis√©s pour les t√¢ches d'entretien des pneus non standard.  J'ai eu la chance de travailler avec quelque chose comme √ßa.  Permettez-moi de d√©crire mes impressions sur l'exemple de choses qui ont jamais √©t√© publi√©es.  Ici, par exemple, <a href="https://www.astrosoft.ru/about/clients/bvg-group/case-959/" rel="nofollow">https://www.astrosoft.ru/about/clients/bvg-group/case-959/</a> .  De plus, le langage GOST est r√©cemment sorti m√™me GOST.  Mon opinion est la suivante: ce qui √©tait n√©cessaire √† la fin des ann√©es 70 - au d√©but des ann√©es 80, puis absolument pas n√©cessaire √† la fin du premier quart du XXIe si√®cle.  Voici un merveilleux article de Konstantin Chizhov, dans lequel la chose la plus importante de cette langue (groupes de contact) est parfaitement et presque gratuitement mise en ≈ìuvre gr√¢ce √† la m√©taprogrammation en C ++ <a href="http://easyelectronics.ru/rabota-s-portami-vvoda-vyvoda-mikrokontrollerov-na-si.html" rel="nofollow">http://easyelectronics.ru/rabota-s-portami-vvoda-vyvoda-mikrokontrollerov-na- si.html</a> .  Cet article v√©rifie tout pour AVR.  J'ai fait une excellente v√©rification de l'option de biblioth√®que pour Cortex M, les r√©sultats sont √©galement incroyables.  Les optimiseurs emballent tout de mani√®re √† ce que le d√©veloppement direct dans l'assembleur ne donne aucun gain.  Et cela s'applique non seulement aux groupes de contact, mais en g√©n√©ral √† tous les pilotes de mcucpp.  Il est seulement dommage que les autorit√©s n'aient pas autoris√© cette id√©ologie dans le MAX RTOS, donc les r√©sultats de la recherche ne sont pas entr√©s dans la publication.  Mais √† la maison, j'utilise uniquement cette biblioth√®que. <br><br>  Toutes les autres choses impl√©ment√©es sur YASTEK sont √©galement parfaitement packag√©es dans la construction C ++.  Mais l'interactivit√© pour l'op√©rateur √† la jonction des ann√©es 70 et 80 ne l'√©tait pas.  Certes, ce n'√©tait pas dans les compilateurs d'alors de Pascal, C et d'autres langages.  La plupart du temps, les compilateurs √©taient par lots et g√©n√©raient simplement du texte d'assembleur sans aucun outil de d√©bogage.  Lors du remake de YASTEC, nous avons ajout√© des op√©rateurs pour la sortie des donn√©es √† l'√©cran et m√™me un d√©bogueur interactif, mais de toute fa√ßon, ce sont des demi-mesures dans le contexte de ce qui se passe dans les environnements de d√©veloppement pr√™ts √† l'emploi pour les langages de programmation ordinaires.  Bref, l'√©poque o√π il y avait des raisons techniques de faire dispara√Ætre le langage sp√©cial de YASTEK.  Aujourd'hui, dans un langage de programmation commun, on peut r√©aliser le m√™me, et bien plus encore. <br><br>  Quelqu'un peut dire que ce ne sont pas des experts C ++ qui ont √©crit le code, mais des personnalisateurs ordinaires ... C'est comme √ßa, mais j'ai d√©j√† not√© que les programmeurs ordinaires √©criront le code pour Redd.  La direction n'a aucun sens de garder un sp√©cialiste √©troit pour les t√¢ches occasionnelles.  Et cela n'a aucun sens pour un sp√©cialiste ordinaire d'apprendre une autre langue. <br><br>  Et quelles autres caract√©ristiques expressives cela aura-t-il?  Lors du d√©veloppement d'√©mulateurs, vous devrez peut-√™tre des choses compl√®tement exotiques.  Par exemple, pour l'√©mulateur GPS en mode interactif, nous contr√¥lons √† l'aide du joystick.  Quel langage orient√© probl√®me le prend en charge?  Et la flexibilit√© de ces langues est toujours.  Enfin, la r√©utilisation du code dans le YASTEC discut√© n'est pas √† la hauteur, mais la recherche de solutions toutes faites sur le r√©seau ... M√™me dans les langues les plus courantes, ce n'est pas seulement pour trouver un <b>bon</b> exemple, mais aussi exotique. <br><br>  La m√™me chose s'applique √† <a href="https://www.astrosoft.ru/about/clients/cassel-aero/case-786/" rel="nofollow">un tel cas</a> , qui s'est facilement transform√© en <a href="https://www.astrosoft.ru/about/clients/cassel-aero/case-786/" rel="nofollow">un</a> <a href="https://www.astrosoft.ru/about/clients/cassel-aero/case-787/" rel="nofollow">tel</a> <a href="https://www.astrosoft.ru/about/clients/cassel-aero/case-786/" rel="nofollow">cas</a> .  Dans le cadre de l'automatisation d'entreprise, SIMATIC avec son syst√®me de configuration et de programmation avanc√© est bon, mais pour un petit projet, il a cr√©√© plus de probl√®mes qu'il n'en a r√©solu, il a donc √©t√© remplac√© par une solution plus universelle. <br><br><blockquote>  Au total, nous concluons que le travail des programmeurs ordinaires dans leurs langages habituels est normal pour Redd.  Pour d'autres t√¢ches - cela est discut√©, et sp√©cifiquement pour les t√¢ches auxiliaires r√©solues par le complexe Redd, c'est normal. </blockquote><br><br><h3>  Comment mettre en place des pneus </h3><br>  Mais si nous disons que les programmeurs ordinaires utiliseront les pneus dans leurs langages habituels, alors les biblioth√®ques pour travailler avec ces bus devraient √™tre aussi typiques que possible.  En particulier, la phrase a √©t√© imm√©diatement not√©e: ¬´Et mettons les microcontr√¥leurs dans le complexe, et les programmeurs √©criront tout sur eux.¬ª  Cette option n√©cessite √† nouveau des sp√©cialistes de ces contr√¥leurs.  De plus, il n√©cessite une synchronisation s√©rieuse entre les sous-syst√®mes.  Il a √©t√© d√©cid√© que, si possible, le programmeur devait travailler sur le processeur central PC familier.  "Mais qu'en est-il des FPGA?", Demandez-vous.  Eh bien, oups, tout le monde a probablement remarqu√© que pour les FPGA, j'ai choisi l'id√©ologie du ¬´d√©veloppement minimum sur Verilog, maximum familier aux programmeurs¬ª.  L√†, vous ne pouvez pas le faire plus facilement.  Mais nous travaillons dur. <br><br>  Donc, impl√©mentations de pneus typiques.  Avec UART, tout est clair.  Avec SPI / I <sup>2</sup> C, diverses options ont √©t√© envisag√©es, car il n‚Äôexiste pas de norme de facto √©tablie pour les PC.  Mais il y avait un d√©sir de se passer de l'option d'√©crire un ensemble complet: "firmware" du contr√¥leur, du pilote et des biblioth√®ques.  Je voulais prendre quelque chose de pr√™t.  N√©anmoins, jusqu'√† la derni√®re fois, nous avons envisag√© l'option avec des microcontr√¥leurs qui impl√©mentent au niveau USB un d√©bogueur √† la fois de Cypress.  Le point en a √©t√© mis en √©vidence par les d√©couvertes d√©crites dans l' <a href="https://habr.com/ru/post/437112/">article sur le DMA</a> .  Il est impossible de garantir la bande passante demand√©e dans le TOR si tous les bus avec des flux de donn√©es pr√©c√©demment inconnus fonctionnent simultan√©ment.  Et s'il est r√©parti sur plusieurs contr√¥leurs - nous nous reposons sur la bande passante de l'USB 2.0 FS.  Par cons√©quent, seuls les ponts FTDI.  Un pont est une fonction et USB 2.0 HS fournit une bande passante. <br><br>  Par ailleurs, dans la derni√®re section, j'ai toujours fait r√©f√©rence au langage C ++ commun.  Le fait est qu'√† ce stade du voyage de ma vie, c'est mon langage de programmation principal (bien que ce n'ait pas toujours √©t√© le cas).  Mais les solutions standard, ce sont des solutions standard afin de fonctionner parfaitement dans d'autres langages courants aujourd'hui, que ce soit Python, Java ou autre chose.  Par cons√©quent, si un sp√©cialiste de ces langues est lanc√© dans la bataille, lui, en utilisant ces langues, fera tout non moins facilement.  Telle est la beaut√© des solutions universelles. <br><br>  Mais il y a quelques pneus qui sont idiots pour poser des puces FTDI co√ªteuses.  Nous allons parler de la fa√ßon dont ils sont mis en ≈ìuvre dans le complexe. <br><br><h2>  Mille petites choses </h2><br><h3>  Pourquoi le complexe Redd a-t-il une carte SD commut√©e </h3><br>  Un certain nombre d'appareils en cours de d√©veloppement mettent √† jour leur ¬´firmware¬ª √† l'aide d'une carte SD.  Le plus souvent, le ¬´firmware¬ª est vers√© sur la carte sous la forme d'un fichier, apr√®s quoi l'appareil s'√©teint et lorsqu'il est allum√©, il d√©tecte le fichier de mise √† jour et l'applique.  J'ai r√©cemment essay√© une nouvelle carte pour l'une de mes imprimantes 3D.  L√†, le ¬´firmware¬ª de Marlin 2.0, apr√®s certaines des commandes M (je ne me souviens pas du code exact), a ouvert le contenu de la SD via le bus USB, afin que je puisse injecter des mises √† jour sans trucs.  Je me suis connect√© via USB, apr√®s quoi je savais que je mettais hors / sous tension (comment le faire avec l'aide du complexe Redd, nous avons examin√© dans l' <a href="https://habr.com/ru/post/477662/">article pr√©c√©dent</a> ), donn√© la commande pour connecter la carte SD √† USB, attendu que le disque apparaisse, rempli le ¬´firmware¬ª, mis hors / sous tension √† nouveau, et attendu .  Le firmware a √©t√© mis √† jour.  Mais tout n'est pas si beau.  Parfois, une carte SD doit √™tre pr√©par√©e √† l'avance.  Soit dit en passant, si vous ajoutez la courbe ¬´firmware¬ª √† l'imprimante 3D, l'option id√©ale d√©crite ci-dessus ne fonctionnera pas non plus et vous devrez √©galement pr√©parer la carte √† l'avance.  Et lors du d√©veloppement, cr√©ez un ¬´firmware¬ª qui ne fonctionne pas - quelques bagatelles. <br><br>  Dans ce cas, le complexe Redd dispose d'une carte SD commut√©e.  Sur le sch√©ma √©lectrique, il est inclus comme suit: <br><br><img src="https://habrastorage.org/webt/9e/su/xj/9esuxjssl9kznrnz4dodepejj9k.png"><br><br>  Au d√©but, nous avons essay√© de trouver une solution typique qui permettrait de commuter le bus SDIO (pas SPI, √† savoir SDIO, les appareils peuvent √©galement fonctionner via cette interface) via FPGA.  Il s'est av√©r√© qu'une belle solution n'existe pas.  M√™me les solutions des fabricants de FPGA sont complexes et peu cr√©dibles.  Par cons√©quent, des cl√©s analogiques ont √©t√© fournies pour connecter physiquement la carte √† un connecteur externe ou √† un lecteur dans le cadre de Redd.  Par cons√©quent, l'algorithme de fonctionnement est le suivant: connect√© √† un lecteur, fichiers pr√©par√©s √† l'aide de Linux OS, connect√© au p√©riph√©rique cible.  Nous utilisons l√†-bas. <br><br>  Comme travailler avec le syst√®me de fichiers n'appartient pas √† des choses critiques (nous pr√©parons juste les donn√©es, donc aucune vitesse sp√©ciale n'est requise), il a √©t√© d√©cid√© de faire un lecteur bas√© sur le microcontr√¥leur STM32F103.  La prise en charge de SDIO complet n'est disponible que dans la version maximale de cette puce.  Et puisque ce contr√¥leur a beaucoup de contacts libres, il a √©t√© d√©cid√© de faire d'autres fonctions √† basse vitesse sur eux.  Consid√©rons un fragment d'un sch√©ma de circuit √©lectrique, √† partir duquel leur liste sera visible. <br><br><img src="https://habrastorage.org/webt/q_/lt/lq/q_ltlqt32trstidfnkm7aeffhtw.png"><br><br>  En fait, les signaux li√©s √† la commutation SDIO et carte SD sont surlign√©s en rouge.  Nous proc√©dons √† l'examen des couleurs de r√©tro-√©clairage restantes. <br><br><h3>  Lecteur flash SPI </h3><br>  La deuxi√®me technique courante pour mettre √† jour le ¬´firmware¬ª des √©quipements cibles est avec un lecteur flash SPI.  De nos jours, ce n'est pas de plus en plus SPI, mais Quad-SPI.  Le principe est le m√™me.  Rempli les donn√©es, puis connect√© le lecteur flash √† l'appareil et allum√©.  Le m√©canisme Bootstrap ¬´aspire¬ª le firmware dans la RAM au d√©marrage. <br><br>  Le m√™me sch√©ma est appliqu√© ici - avec des commutateurs analogiques: <br><br><img src="https://habrastorage.org/webt/l8/zn/v_/l8znv_7bcjtawlsxmrfbypheab0.png"><br><br>  Eh bien, les lignes li√©es √† l'utilisation d'un lecteur flash ont √©t√© mises en √©vidence en vert. <br><br><h3>  Relais √† semi-conducteurs bas </h3><br>  P√©riodiquement, la t√¢che se pose de simuler la pression des boutons sur l'appareil.  Une situation typique: les testeurs doivent v√©rifier le fonctionnement du menu de l'appareil cible.  Non, une fois que vous pouvez passer en revue tous les points, mais si les d√©veloppeurs apportent des modifications?  Pour automatiser le processus, il est pr√©f√©rable que les boutons de navigation dans le menu soient cr√©√©s automatiquement (des captures d'√©cran peuvent √™tre prises soit par le syst√®me d'exploitation sur l'appareil cible, soit en scannant le bus allant √† l'√©cran √† l'aide du renifleur vers le FPGA).  Eh bien, il existe de nombreuses autres t√¢ches o√π vous devez simuler par programmation une pression sur un bouton.  Pour cela, des relais statiques sont ajout√©s au circuit: <br><br><img src="https://habrastorage.org/webt/uf/4g/yo/uf4gyofip5mjrwxmejjm96l0i5w.png"><br><br>  ... et leurs lignes de contr√¥le √©taient surlign√©es en bleu. <br><br><h3>  Configuration des ponts USB-SPI / I <sup>2</sup> C </h3><br>  Dans un article pr√©c√©dent, j'ai not√© que les ponts FTDI sur lesquels les bus SPI et I <sup>2</sup> C sont impl√©ment√©s ont des jambes de contr√¥le CFG0 et CFG1.  En g√©n√©ral, tr√®s probablement, personne n'aura besoin de modifier leurs valeurs par d√©faut (tous des z√©ros), mais si n√©cessaire, les lignes qui contr√¥lent ces signaux quittent √©galement le contr√¥leur STM32 en question et ont √©t√© surlign√©es en violet. <br><br><h3>  R√©initialisation du p√©riph√©rique USB </h3><br>  Au cours du d√©veloppement du syst√®me, il a √©t√© d√©cid√© que, purement th√©orique, les appareils pouvaient ¬´geler¬ª.  Par exemple, les ponts FTDI de la premi√®re s√©rie avaient la propri√©t√© de ¬´geler¬ª avec un ¬´sol¬ª instable.  Oui, c'√©tait il y a plus de dix ans.  Oui, √† l'int√©rieur du complexe, la terre est extr√™mement stable, car le pont est dans le m√™me b√¢timent que l'ordinateur.  Mais tout d'un coup.  En g√©n√©ral, dans les TdR √©tait pr√©vue la possibilit√© de r√©initialiser l'un des appareils.  Les demandes correspondantes sont g√©n√©r√©es par le m√™me contr√¥leur STM32 et surlign√©es en jaune. <br><br><h2>  Acc√®s par programmation au contr√¥leur STM32 </h2><br>  Comme vous pouvez le voir, la plupart des appareils d√©crits ci-dessus ne sont pas standard.  Plus pr√©cis√©ment, la plupart d'entre eux peuvent √™tre class√©s comme GPIO, mais il n'y a pas de norme de facto pour cela.  La partie la plus difficile des appareils est le lecteur de carte SD.  Par cons√©quent, il a √©t√© d√©cid√© d'impl√©menter la fonctionnalit√© SD Reader sur le contr√¥leur STM32 (heureusement, l'environnement STM Cube MX vous permet de le faire en n'√©crivant que quelques lignes de votre propre code), et d'impl√©menter le reste des fonctions selon les demandes du fournisseur au p√©riph√©rique de stockage de masse sous-jacent au lecteur.  Mais comme il a √©t√© d√©cid√© il y a plusieurs articles, les √©normes r√©cits ne conviennent pas √† la lecture.  Par cons√©quent, les principes d'envoi de commandes au p√©riph√©rique de stockage de masse √† partir de Linux et des exemples d'acc√®s par programmation au p√©riph√©rique r√©sultant seront examin√©s la prochaine fois. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr483724/">https://habr.com/ru/post/fr483724/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr483714/index.html">Prix ‚Äã‚Äãet concours pour des projets innovants. Exp√©rience des vendeurs mondiaux</a></li>
<li><a href="../fr483716/index.html">Utilisation de Vulnerability Scanner dans les biblioth√®ques de v√©rification des d√©pendances utilis√©es dans GitlabCI</a></li>
<li><a href="../fr483718/index.html">Comment VDI transforme l'environnement de bureau</a></li>
<li><a href="../fr483720/index.html">Ce qui nous a apport√© Pandas 1.0</a></li>
<li><a href="../fr483722/index.html">G√©oanalytique dans le commerce de d√©tail, partie 1: nous automatisons le processus de choix d'un lieu pour une entreprise. 2GIS + MS Azure + ML</a></li>
<li><a href="../fr483726/index.html">JavaScript et HTML vanille. Aucun cadre. Pas de biblioth√®ques. Pas de probl√®me</a></li>
<li><a href="../fr483730/index.html">Programmers Union 2: les pantoufles ont cess√© de rire et sont devenues r√©fl√©chies</a></li>
<li><a href="../fr483732/index.html">Lire le firmware s√©curis√© du flash STM32F1xx √† l'aide de ChipWhisperer</a></li>
<li><a href="../fr483734/index.html">Quel prix payons-nous pour utiliser async / attendre dans JS / C # / Rust</a></li>
<li><a href="../fr483736/index.html">Recherche d'image invers√©e: un guide de l'agence de d√©tective Bellingcat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>