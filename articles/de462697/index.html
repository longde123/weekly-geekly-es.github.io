<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçÅ üßùüèª üçö uWSGI zur Unterst√ºtzung von Metriken. Yandex-Bericht ‚õ∏Ô∏è üõê üì∑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Neulich fand das Moscow Python Meetup # 66 statt - die Community diskutiert weiterhin relevante Tools, die die Sprache verbessern und an verschiedene ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>uWSGI zur Unterst√ºtzung von Metriken. Yandex-Bericht</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/462697/">  Neulich fand das Moscow Python Meetup # 66 statt - die Community diskutiert weiterhin relevante Tools, die die Sprache verbessern und an verschiedene Umgebungen anpassen.  Einschlie√ülich des Treffens wurde mein Bericht erstellt.  Mein Name ist Nail, ich mache Yandex.Connect. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/oh/bd/zt/ohbdztka-hxtbhnhb8gz2g1ohmc.jpeg"></a> <br><br>  Die Geschichte, die ich vorbereitet habe, handelte von uWSGI.  Dies ist ein multifunktionaler Webanwendungsserver, und jede moderne Anwendung wird von Metriken begleitet.  Ich habe versucht zu zeigen, wie die Funktionen von uWSGI beim Sammeln von Metriken helfen k√∂nnen. <br><br><a name="habracut"></a>  - Hallo allerseits, ich freue mich, Sie alle an den W√§nden von Yandex begr√º√üen zu d√ºrfen.  Es ist sch√∂n, dass so viele Leute gekommen sind, um meine und andere Berichte zu sehen, dass so viele Leute interessiert sind und in Python leben.  Worum geht es in meinem Bericht?  Es hei√üt "uWSGI zur Unterst√ºtzung von Metriken".  Ich werde dir ein wenig √ºber mich erz√§hlen.  Ich bin seit sechs Jahren mit Python besch√§ftigt. Ich habe im Yandex.Connect-Team gearbeitet. Wir schreiben eine Gesch√§ftsplattform, die Yandex-Dienste bereitstellt, die intern f√ºr Drittbenutzer entwickelt wurden, dh f√ºr alle.  Jede Person oder Organisation kann die von Yandex entwickelten Produkte f√ºr sich selbst f√ºr ihre eigenen Zwecke verwenden. <br><br>  Wir werden √ºber Metriken sprechen, wie man diese Metriken erh√§lt, wie wir in unserem Team uWSGI als Werkzeug verwenden, um Metriken zu erhalten, wie es uns hilft.  Dann erz√§hle ich Ihnen eine kleine Optimierungsgeschichte. <br><br>  Ein paar Worte zu Metriken.  Wie Sie wissen, ist die Entwicklung einer modernen Anwendung ohne Tests nicht m√∂glich.  Es ist seltsam, wenn jemand seine Anwendungen ohne Tests entwickelt.  Gleichzeitig scheint mir der Betrieb einer modernen Anwendung ohne Metriken nicht m√∂glich zu sein.  Unsere Anwendung ist ein lebender Organismus.  Eine Person kann einige Metriken wie Druck, Herzfrequenz verwenden. Die Anwendung enth√§lt auch Indikatoren, an denen wir interessiert sind und die wir beobachten m√∂chten.  Im Gegensatz zu einer Person, die diese wichtigen Kennzahlen normalerweise verwendet, wenn sie sich schlecht f√ºhlt, k√∂nnen wir sie im Fall einer Anwendung immer verwenden. <br><br><img src="https://habrastorage.org/webt/gm/3s/oi/gm3soikaaai-tmfoi6mf7_u3waq.jpeg"><br><br>  Warum nehmen wir Metriken?  Wer verwendet √ºbrigens Metriken?  Ich hoffe, dass es nach meinem Bericht mehr H√§nde geben wird und die Leute interessiert sind und anfangen, Metriken zu sammeln. Sie werden verstehen, dass dies notwendig und n√ºtzlich ist. <br><br>  Warum brauchen wir also Metriken?  Zun√§chst sehen wir, was mit dem System passiert, wir heben einige normative Indikatoren f√ºr unser System hervor und verstehen, ob wir w√§hrend des Bewerbungsprozesses √ºber diese Indikatoren hinausgehen oder nicht.  Sie k√∂nnen ein abnormales Verhalten des Systems feststellen, z. B. eine Zunahme der Anzahl von Fehlern, verstehen, was mit dem System vor unseren Benutzern nicht stimmt, und Nachrichten √ºber Vorf√§lle nicht von Benutzern, sondern vom √úberwachungssystem erhalten.  Basierend auf Metriken k√∂nnen wir Benachrichtigungen einrichten und SMS, Briefe und Anrufe empfangen, wie Sie m√∂chten. <br><br><img src="https://habrastorage.org/webt/sw/1a/ru/sw1arunikx2d6u7ngqaiofuqfvo.jpeg"><br><br>  Was sind in der Regel Metriken?  Dies sind einige Zahlen, vielleicht ein Z√§hler, der monoton w√§chst.  Zum Beispiel die Anzahl der Anfragen.  Einige Zeitwerte, die sich mit der Zeit √§ndern, nehmen zu oder ab.  Ein Beispiel ist die Anzahl der Aufgaben in einer Warteschlange.  Oder Histogramme - Werte, die in bestimmte Intervalle fallen, die sogenannten K√∂rbe.  In der Regel ist es zweckm√§√üig, diese zeitbezogenen Daten zu lesen und herauszufinden, in welches Zeitintervall wie viele Werte passen. <br><br><img src="https://habrastorage.org/webt/ba/in/dk/baindkmahmhfz9-wq20ahlm4oyg.jpeg"><br><br>  Welche Art von Metriken k√∂nnen wir verwenden?  Ich werde mich auf die Entwicklung von Webanwendungen konzentrieren, da diese n√§her bei mir liegen.  Zum Beispiel k√∂nnen wir die Anzahl der Anforderungen, unsere Endpunkte, die Antwortzeit unserer Endpunkte und die Antwortcodes der zugeh√∂rigen Dienste erfassen, wenn wir zu ihnen gehen und √ºber eine Microservice-Architektur verf√ºgen.  Wenn wir den Cache verwenden, k√∂nnen wir verstehen, wie effizient der Miss- oder Hit-Cache ist, die Verteilung der Antwortzeiten beider Server von Drittanbietern und beispielsweise der Datenbank verstehen.  Aber um die Metriken zu sehen, m√ºssen Sie sie irgendwie sammeln. <br><br><img src="https://habrastorage.org/webt/4f/x3/9a/4fx39auteviuwx9dfiefacsjz_q.jpeg"><br><br>  Wie k√∂nnen wir sie sammeln?  Es gibt mehrere M√∂glichkeiten.  Ich m√∂chte Ihnen von der ersten Option erz√§hlen - einem Push-Schema.  Woraus besteht es? <br><br>  Angenommen, wir erhalten eine Anfrage von einem Benutzer.  Vor Ort installieren wir mit unserer Anwendung eine Art, normalerweise einen Push-Agenten.  Nehmen wir an, wir haben einen Docker, darin befindet sich eine Anwendung, und ein Push-Agent steht immer noch parallel.  Der Push-Agent empf√§ngt den Wert von Metriken lokal von uns, puffert sie irgendwie, erstellt Stapel und sendet sie an das Metrikspeichersystem. <br><br>  Was ist der Vorteil von Push-Schemata?  Wir k√∂nnen einige Metriken von der Anwendung direkt an das Metriksystem senden, aber gleichzeitig erhalten wir eine Art Netzwerkinteraktion, Latenz und Overhead, um Metriken zu erfassen.  Im Fall eines lokalen Push-Clients wird dies ausgeglichen. <br><br><img src="https://habrastorage.org/webt/n5/ff/o7/n5ffo732rxl3styovoxwmjnffim.jpeg"><br><br>  Eine weitere Option ist ein Pull-Schema.  Mit dem Pull-Schema haben wir das gleiche Szenario.  Eine Anfrage des Benutzers kommt zu uns, wir behalten sie irgendwie zu Hause.  Und dann kommt das Metrik-Erfassungssystem mit einer bestimmten H√§ufigkeit - einmal pro Sekunde, einmal pro Minute, wie es Ihnen passt - zu einem speziellen Endpunkt unserer Anwendung und verwendet diese Indikatoren. <br><br><img src="https://habrastorage.org/webt/ob/xy/88/obxy88kzj0owhgydp-kr02gisx0.jpeg"><br><br>  Eine weitere Option sind die Protokolle.  Wir alle schreiben Protokolle und schicken sie irgendwohin.  Nichts hindert uns daran, diese Protokolle zu √ºbernehmen, sie irgendwie zu verarbeiten und Metriken basierend auf den Protokollen abzurufen. <br><br>  Zum Beispiel schreiben wir die Tatsache einer Benutzeranforderung in das Protokoll und nehmen dann die Protokolle, Hop-Hop, gez√§hlt.  Ein typisches Beispiel ist ELK (Elasticsearch, Logstash, Kibana). <br><br><img src="https://habrastorage.org/webt/qb/r1/ji/qbr1ji36v03ahocy3_hj5wy7ihs.jpeg"><br><br>  Wie funktioniert das bei uns?  Yandex verf√ºgt √ºber eine eigene Infrastruktur und ein eigenes System zur Erfassung von Metriken.  Sie erwartet eine standardisierte Antwort f√ºr einen Griff, der ein Pull-Schema implementiert.  Au√üerdem haben wir eine interne Cloud, in der wir unsere Anwendung starten.  Und das alles in einem einzigen System integriert.  Beim Hochladen in die Cloud geben wir einfach an: "Gehen Sie zu diesem Stift und holen Sie sich die Metriken." <br><br><img src="https://habrastorage.org/webt/p7/ug/ls/p7uglskaraaguno_ngqnemhmbgc.jpeg"><br><br>  Hier ist eine Beispielantwort f√ºr das Pull-Schema, das unser Metrik-Erfassungssystem erwartet. <br><br>  F√ºr uns im Team haben wir uns entschieden, einen f√ºr uns geeigneteren Weg zu w√§hlen, um verschiedene Kriterien hervorzuheben, anhand derer wir die beste Option f√ºr uns ausw√§hlen.  Effizienz ist, wie schnell wir im metrischen System eine Anzeige der Tatsache einer Aktion erhalten k√∂nnen.  Abh√§ngigkeit - ob wir zus√§tzliche Tools installieren oder die Infrastruktur irgendwie konfigurieren m√ºssen, um die Metrik zu erhalten.  Und Vielseitigkeit - wie diese Methode f√ºr verschiedene Arten von Anwendungen geeignet ist. <br><br><img src="https://habrastorage.org/webt/h2/ao/s4/h2aos4jq6iboqpi9ze3254om0rs.jpeg"><br><br>  Das haben wir am Ende bekommen.  Obwohl nach den Kriterien der Effizienz und Vielseitigkeit das Push-Schema gewinnen wird.  Wir entwickeln jedoch eine Webanwendung, und unsere Cloud verf√ºgt bereits √ºber eine vorgefertigte Infrastruktur f√ºr die Arbeit mit dieser Aufgabe. Daher haben wir uns f√ºr ein Pull-Schema entschieden.  Wir werden √ºber sie reden. <br><br>  Um dem Pull-Schema etwas zu geben, m√ºssen wir es irgendwo voraggregieren und speichern.  Unser √úberwachungssystem wird alle f√ºnf Sekunden in Zuggriffe eingesetzt.  Wo k√∂nnen wir sparen?  Lokal in Ihrem Speicher oder in einem Speicher eines Drittanbieters. <br><br><img src="https://habrastorage.org/webt/pa/ft/sb/paftsbyryl5ojm43di6mhwrxge4.jpeg"><br><br>  Wenn wir lokal speichern, ist dies in der Regel f√ºr den Fall mit einem Prozess geeignet.  Und wir f√ºhren in unserem uWSGI mehrere Prozesse parallel aus.  Oder wir k√∂nnen eine Art gemeinsam genutzten Speicher verwenden.  Was f√§llt uns mit dem Wort ‚ÄûShared Storage‚Äú ein?  Dies ist eine Art Redis, Memcached, relationale oder nicht relationale Datenbanken oder sogar eine Datei. <br><br><img src="https://habrastorage.org/webt/ms/um/fb/msumfb5j3za1j6b7qxrklpnvww8.jpeg"><br><br>  √úber uWSGI.  Ich m√∂chte Sie an diejenigen erinnern, die es nur selten oder selten verwenden: uWSGI ist ein Anwendungswebserver, mit dem Sie Python-Anwendungen unter Ihnen ausf√ºhren k√∂nnen.  Es implementiert die Schnittstelle, das uWSGI-Protokoll.  Dieses Protokoll ist in PEP 333 beschrieben, die interessiert sind, k√∂nnen Sie lesen. <br><br><img src="https://habrastorage.org/webt/vg/ke/yy/vgkeyyiamyh4dfcbclpg-rhi17m.jpeg"><br><br>  Es wird uns auch helfen, die beste Yandex.Tank-L√∂sung auszuw√§hlen.  Dies ist ein Lasttest-Tool, mit dem Sie unsere Anwendung mit verschiedenen Lastprofilen sch√§len und wundersch√∂ne Grafiken erstellen k√∂nnen.  Oder es funktioniert in der Konsole, wie Sie m√∂chten. <br><br><img src="https://habrastorage.org/webt/vl/79/jq/vl79jqtqnv8hgqvjeqhetqdzhpi.jpeg"><br><br>  Die Experimente.  Wir werden eine synthetische Anwendung f√ºr unsere synthetischen Tests erstellen, wir werden sie mit einem Tank sch√§len.  Die uWSGI-Anwendung hat einen einfachen Konflikt mit 10 Arbeitern. <br><br><img src="https://habrastorage.org/webt/nk/ui/s4/nkuis4s4fgzpkj7tmvlchyn0dr4.jpeg"><br><br>  Hier ist unsere Flask App.  Mit der Nutzlast, die unsere Anwendung ausf√ºhrt, emulieren wir eine leere Schleife. <br><br><img src="https://habrastorage.org/webt/sc/d5/qt/scd5qtepls29c1u46xknxbcwfxm.jpeg"><br><br>  Wir feuern und Yandex.Tank gibt uns eine dieser Grafiken.  Was zeigt er?  Perzentile der Antwortzeiten.  Die schr√§ge Linie ist der RPS, der w√§chst, und die Histogramme sind die Perzentile, in die unser Webserver unter einer solchen Last passt. <br><br>  Wir werden diese Option als Referenz verwenden und untersuchen, wie sich verschiedene Optionen zum Speichern von Metriken auf die Leistung auswirken. <br><br><img src="https://habrastorage.org/webt/9d/j2/x_/9dj2x_mwlyb7ovl-e9y24nkey1c.jpeg"><br><br>  Die einfachste Option ist die Verwendung von PostgreSQL.  Da wir mit PostgreSQL arbeiten, haben wir es.  Verwenden wir das, was bereits fertig ist. <br><br>  Angenommen, wir haben eine Bezeichnung in PostgreSQL, in der wir einfach den Z√§hler erh√∂hen. <br><br><img src="https://habrastorage.org/webt/_7/zx/ja/_7zxjarhpil1cwhzw2q-b1j48rg.jpeg"><br><br>  Bereits bei kleinen RPS-Mengen sehen wir einen starken Leistungsabfall.  Es kann nur riesig gesagt werden. <br><br><img src="https://habrastorage.org/webt/ox/c7/tm/oxc7tm1_kizqnqdli6rkzunqeau.jpeg"><br><br>  Die n√§chste Option ist Redis.  Aber hier machen wir es schlauer: Wir installieren es lokal und gehen nicht √ºber das Netzwerk, sondern √ºber den Unix-Socket dorthin.  Erh√∂hen Sie auch den Z√§hler. <br><br><img src="https://habrastorage.org/webt/6k/zv/wv/6kzvwvil-aitqzp2rdys3ggjz5e.jpeg"><br><br>  Wir erhalten das Histogramm der Antwortzeiten am Ausgang.  Wir sehen, dass die Dinge hier besser sind, aber irgendwann sto√üen wir auf ein Regal, und dann w√§chst die Produktivit√§t nicht mehr.  Diese Option scheint optimaler zu sein, aber wir wollen es noch besser machen. <br><br><img src="https://habrastorage.org/webt/ts/xs/m7/tsxsm7cnr7qsk0-aydibqnsmobg.jpeg"><br><br>  Hier hilft uns uWSGI, ein echter M√§hdrescher.  Es gibt viele verschiedene Module.  Mule zum Ausf√ºhren von Unterprozessen, Caching-Framework, Cron, Metrik-Subsystem und Warnsystem.  "Subsystem Metrics System" - klingt vielversprechend. <br><br><img src="https://habrastorage.org/webt/xt/rd/ip/xtrdipfn_v0kmanjjipkuc2fd_w.jpeg"><br><br>  Sie wei√ü, wie man Metriken hinzuf√ºgt, den Z√§hler erh√∂ht, den Z√§hler verringert, multipliziert, dividiert - was auch immer Ihr Herz begehrt. <br><br>  Das einzige Metrik-Subsystem kann nicht genau die darin enthaltenen Metriken angeben. <br><br>  Warum ist uns das wichtig?  Wie Sie bereits gesehen haben, haben wir ein Handle zum Bereitstellen von Statistiken in einem bestimmten Format, und mehrere Mitarbeiter werden ausgef√ºhrt.  Wir wissen nicht, welcher der Mitarbeiter die Anfrage erhalten wird, aber um alle Metriken zur√ºckzugeben, m√ºssen wir eine Art Namensregister erstellen und sie irgendwie zwischen den Prozessen verschl√ºsseln.  Das ist eine gro√üe Sache, ich m√∂chte das vermeiden.  Was haben wir noch? <br><br><img src="https://habrastorage.org/webt/tu/st/ir/tustir9lyytiuq5noxzeosk7uyq.jpeg"><br><br>  Nat√ºrlich Cache-Subsystem.  Und hier sehen wir: Er kann fast das Gleiche tun und auch die Namen der im Cache gespeicherten Schl√ºssel angeben.  Das brauchen Sie. <br><br><img src="https://habrastorage.org/webt/4l/le/um/4lleum60xf9n635wiue31dvaptk.jpeg"><br><br>  Das Cache-Subsystem ist ein in uWSGI integrierter Cache.  Ein schnelles und threadsicheres Modul, bei dem es sich um einen normalen Schl√ºsselwertspeicher handelt. <br><br><img src="https://habrastorage.org/webt/gf/a3/w4/gfa3w4hje0atgnlctpzdr6n1hcg.jpeg"><br><br>  Da es sich jedoch um einen Cache handelt, gibt es ein bekanntes zweites Problem: Wie benennt man eine Variable und wie macht man den Cache ung√ºltig?  In unserem Fall sehen wir uns die Standard-Cache-Einstellungen an.  Die L√§nge des Schl√ºssels ist begrenzt.  In unserem Fall ist dies der Name der Metrik.  Der Standardwert betr√§gt 2048 Byte.  Und Sie k√∂nnen die Konfiguration bei Bedarf erh√∂hen.  Die Anzahl der Elemente, die standardm√§√üig gespeichert werden, betr√§gt 65.536. Dieser Wert sollte anscheinend f√ºr alle ausreichen.  Es ist unwahrscheinlich, dass jemand eine solche Anzahl von Metriken aus seiner Anwendung sammelt. <br><br>  Und ttl ist standardm√§√üig 0. Das hei√üt, die Werte der gespeicherten Caches sind nicht zeitlich ung√ºltig.  Wir k√∂nnen sie also aus dem Cache abrufen und an das Metriksystem senden. <br><br><img src="https://habrastorage.org/webt/nb/q8/zu/nbq8zuosdcqk0rss824oiweqifc.jpeg"><br><br>  Auch hier ist die Option eine Anwendung, die die uWSGI-Box verwendet. <br><br><img src="https://habrastorage.org/webt/v6/ri/fb/v6rifbjrax-igqz5bfpn2m5powu.jpeg"><br><br>  Hier sind die Ergebnisse des Beschusses dieser Anwendung. <br><br><img src="https://habrastorage.org/webt/qs/dg/0-/qsdg0-_dj_bqttsbdoewg5rcps8.jpeg"><br><br>  Das Ergebnis ohne Metriken, wenn mit uWSGI, mit einer Dehnung sieht es fast gleich aus. <br><br><img src="https://habrastorage.org/webt/lw/xp/xz/lwxpxzc2jf-hyfnx4fcysnfmrfi.jpeg"><br><br>  Wie Sie sehen, verlieren wir im Fall von uWSGI nur 5% der Leistung im Vergleich zur "Vanilla" -Version ohne Metriken.  Andere Optionen haben einen ziemlich erheblichen Drawdown, und daher gewinnt uWSGI aufgrund der Zuschauerabstimmung. <br><br><img src="https://habrastorage.org/webt/xw/sg/hf/xwsghfrlb5z8kwt_kzv4mgvxjhe.jpeg"><br><br>  Wie haben wir das angewendet?  Wir haben eine kleine Bibliothek geschrieben, einen Wrapper um uWSGI.  Zum Beispiel installieren wir eine Instanz unserer Bibliothek und f√ºgen hier als Beispiel die Metrik ‚ÄûDatenbankabfragezeit‚Äú hinzu. <br><br><img src="https://habrastorage.org/webt/jh/k2/qa/jhk2qajtaazyhqvckbyi63r8iiy.jpeg"><br><br>  Wir sind auch daran interessiert zu verfolgen, wie der Cache funktioniert.  Wir definieren einfach die Methoden des Client-Memca neu, sparen Zeit f√ºr den Empfang von Daten, Zeit f√ºr das Herunterladen und die Anzahl der Cache-Treffer und Cache-Miss. <br><br><img src="https://habrastorage.org/webt/6r/cy/v7/6rcyv7zh51cjphtabkfhwwgjui4.jpeg"><br><br>  Wie machen wir das in der Bibliothek?  Um die Werte zu versenden, erhalten wir die Namen der im Cache gespeicherten Schl√ºssel, durchlaufen sie und geben sie einfach im gew√ºnschten Format an den Endpunkt weiter. <br><br><img src="https://habrastorage.org/webt/3g/ts/y-/3gtsy-g-qfq9ro1h71j_pjkhtk0.jpeg"><br><br>  Als Ergebnis erhalten wir ein Diagramm. In diesem Fall ist es das 99. Perzentil der Cache-Zugriffszeit beim Lesen und Schreiben. <br><br><img src="https://habrastorage.org/webt/ho/fg/td/hofgtdq1ewg1qoqabjpid3ukpds.jpeg"><br><br>  Oder optional die Anzahl der Serviceanfragen von Drittanbietern an unsere API. <br><br><img src="https://habrastorage.org/webt/dk/ba/zw/dkbazwujnh0sq9uf2uyj6wmgy_o.jpeg"><br><br>  Wir haben Geschichten √ºber Misserfolg und Erfolg.  Wir f√ºgten immer mehr Metriken hinzu und sahen einen Leistungsabfall.  Die Metriken selbst haben uns geholfen.  Wenn Sie Metriken erfassen, k√∂nnen Sie feststellen, dass etwas nicht stimmt.  Daher empfehle ich Ihnen auch, die Kennzahlen, die Sie in den Wochen, Monaten und sechs Monaten gesammelt haben, nachtr√§glich zu betrachten.  Und sehen Sie, welchen Trend Ihre Anwendung in welchen Indikatoren zeigt.  Wir stellten fest, dass wir uns auf die Berechnung von Metriken st√ºtzten. <br><br><img src="https://habrastorage.org/webt/if/k_/uc/ifk_ucasa_eegw5jangcb-oudwm.jpeg"><br><br>  Profiling hat uns geholfen.  Hier sehen Sie einen Flammengraphen, der uns visuell zeigt, wie viele Aufrufe verschiedener Funktionen w√§hrend des Prozesses ausgef√ºhrt wurden, wobei die Aufrufe den gr√∂√üten zeitlichen Beitrag geleistet haben.  Wir haben festgestellt, dass wir in der ersten Version mit Pickle nicht sehr gut abschneiden.  In unserer Bibliothek verbrachte sie viel Zeit mit Beizen. <br><br><img src="https://habrastorage.org/webt/kd/xn/nm/kdxnnm1oaklpbbsdoiw48yljkc8.jpeg"><br><br>  Wir lehnten das Beizen ab, √ºbergaben es an cashe inc, ma√üen alles, es wurde schneller. <br><br><img src="https://habrastorage.org/webt/fp/v_/qe/fpv_qetjlbsj1dcgt4wo2z3xr2q.jpeg"><br><br>  In der neuen Implementierung arbeiten wir die meiste Zeit mit dem Cache und nicht mit dem Beizen. <br><br><img src="https://habrastorage.org/webt/ju/x2/cs/jux2cs4k52ekeeqalcaeltpawkc.jpeg"><br><br>  Warum erz√§hle ich dir das?  Ich fordere Sie dringend auf, Metriken zu sammeln, Metriken zu beobachten und sich auf Metriken zu konzentrieren.  Vergleichen Sie bei der Auswahl einer m√∂glichen Option zur Erfassung von Metriken die Optionen, um herauszufinden, welche f√ºr Sie am besten geeignet ist.  Und nat√ºrlich ist die Profilerstellung gut.  Wenn Sie sehen, dass etwas nicht stimmt, verlangsamt sich etwas - Profil. <br><br>  Danke an alle!  Wie ich versprochen habe, Referenzen: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Yandex.Tank</a> , </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">py-spy</a> Profiling Utility geschrieben in Rust, </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bericht von</a> Alexander Koshelev √ºber die Verwendung von uWSGI. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de462697/">https://habr.com/ru/post/de462697/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de462687/index.html">Neues Hosting Control Panel von ISPsystem: wie man es sieht</a></li>
<li><a href="../de462689/index.html">DISKOBALL: HDD-Wurfwettbewerbe, 23. August, Moskau</a></li>
<li><a href="../de462691/index.html">So migrieren Sie von AD zu LDAP, wenn Sie Zimbra verwenden</a></li>
<li><a href="../de462693/index.html">Auf dem Weg zu dauerhaften Anwendungen am Beispiel des statischen PSKOV-Standortgenerators</a></li>
<li><a href="../de462695/index.html">Material als WebComponents</a></li>
<li><a href="../de462699/index.html">Servicegitter, "Datenebene" und "Steuerebene" (Service-Mesh-Datenebene vs. Steuerebene)</a></li>
<li><a href="../de462701/index.html">Assembler-Codegenerator-Bibliothek f√ºr AVR-Mikrocontroller. Teil 2</a></li>
<li><a href="../de462703/index.html">Das ‚Äûbilligste‚Äú Drehkreuz in Russland, das √ºber ein Smartphone gesteuert wird</a></li>
<li><a href="../de462705/index.html">Top 5 Fehler in meinen ReactJS-Anwendungen</a></li>
<li><a href="../de462707/index.html">Kubernetes Starten Sie Application Developer Tools</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>