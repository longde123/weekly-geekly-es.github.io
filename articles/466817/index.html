<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüè≠ ‚èÆÔ∏è üßùüèª Varonis descubri√≥ un virus crypto mining: nuestra investigaci√≥n üëÜüèæ üíÜüèø üë´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nuestra unidad de investigaci√≥n de seguridad realiz√≥ recientemente un caso de una red de virus de cripto miner√≠a casi completamente en una de las empr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Varonis descubri√≥ un virus crypto mining: nuestra investigaci√≥n</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/varonis/blog/466817/"><img src="https://habrastorage.org/webt/b3/fo/_5/b3fo_5ib64rlap_izdap4paolls.jpeg"><br><br>  Nuestra unidad de investigaci√≥n de seguridad realiz√≥ recientemente un caso de una red de virus de cripto miner√≠a casi completamente en una de las empresas medianas.  An√°lisis <br>  Las muestras de malware recopiladas mostraron que se encontr√≥ una nueva modificaci√≥n <br>  tales virus, llamados <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Norman</a> , usan varios m√©todos para ocultar su presencia.  Adem√°s, se descubri√≥ un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">shell web interactivo</a> , que puede estar relacionado con los operadores de miner√≠a. <br><a name="habracut"></a><br><h2>  <font color="#D21927">Resumen del estudio</font> </h2><br><ul><li>  Varonis detect√≥ una infecci√≥n a gran escala con criptomineros: casi todos los servidores y estaciones de trabajo de la compa√±√≠a estaban infectados con dicho software </li><li>  Desde la infecci√≥n inicial que ocurri√≥ hace m√°s de un a√±o, el n√∫mero de modificaciones y dispositivos infectados ha aumentado constantemente </li><li>  El nuevo tipo de cripto minero Monero (Norman) que descubrimos utiliza varios m√©todos para ocultarlo del an√°lisis por software de seguridad para evitar la detecci√≥n </li><li>  La mayor√≠a de las variantes de malware utilizan DuckDNS (un servicio DNS din√°mico gratuito) para conectarse al centro de control (servidores C&amp;C), as√≠ como para obtener par√°metros de configuraci√≥n o enviar nuevos datos. </li><li>  Norman - minero de criptomonedas Monero de c√≥digo abierto de alto rendimiento basado en mineros - XMRig </li><li>  No tenemos evidencia concluyente de la conexi√≥n de los criptomineros con un shell PHP interactivo.  Sin embargo, hay buenas razones para creer que su fuente es el mismo atacante.  Los investigadores recopilan evidencia adicional de la presencia o ausencia de dicha relaci√≥n. </li><li>  En este art√≠culo, puede encontrar recomendaciones de Varonis con respecto a la protecci√≥n contra shells web remotos y cripto mineros. </li></ul><br><h2>  <font color="#D21927">Investigaci√≥n</font> </h2><br>  La investigaci√≥n comenz√≥ durante el pr√≥ximo proyecto piloto de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Plataforma.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">La seguridad cibern√©tica de Varonis</a> (Varonis Data Security Platform), que le permiti√≥ identificar r√°pidamente varios eventos an√≥malos sospechosos a nivel de red durante las solicitudes de Internet (a trav√©s de proxies web) asociadas con acciones anormales en el sistema de archivos. <br>  El Cliente indic√≥ inmediatamente que los dispositivos identificados por nuestra Plataforma, <br>  pertenec√≠a a los mismos usuarios que recientemente informaron bloqueos de aplicaciones y ralentizaciones de la red. <br><br>  Nuestro equipo examin√≥ manualmente el entorno del cliente, pasando de una estaci√≥n infectada a otra de acuerdo con las alertas generadas por la Plataforma Varonis.  El equipo de respuesta a incidentes tambi√©n desarroll√≥ una regla especial en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el m√≥dulo DatAlert</a> para detectar computadoras que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">explotaban</a> activamente, lo que ayud√≥ a eliminar r√°pidamente la amenaza.  Se enviaron muestras del malware recolectado a los equipos de departamentos forenses y de desarrollo, quienes dijeron que era necesario realizar una investigaci√≥n adicional sobre las muestras. <br>  Los sitios infectados se descubrieron mediante el uso de <b>llamadas DuckDNS</b> , DNS din√°mico, que permite a sus usuarios crear sus propios nombres de dominio y <b>asignarlos</b> r√°pidamente a direcciones IP cambiantes.  Como se mencion√≥ anteriormente, la mayor√≠a del malware en el incidente recurri√≥ a DuckDNS para conectarse al centro de control (C&amp;C), el otro para obtener par√°metros de configuraci√≥n o enviar nuevos datos. <br><br>  Casi todos los servidores y computadoras estaban infectados con malware.  Mayormente aplicado <br>  Opciones comunes de miner√≠a criptogr√°fica.  Otro malware inclu√≠a herramientas de descarga de contrase√±as, shells PHP y varias herramientas hab√≠an estado funcionando durante varios a√±os. <br><br>  Proporcionamos los resultados al cliente, eliminamos el malware de su entorno y detuvimos m√°s infecciones. <br><br>  Entre todas las muestras descubiertas de criptomineros, una se destac√≥.  Lo llamamos <strong>Norman</strong> . <br><br><h2>  <font color="#D21927">Conoceme</font>  <font color="#D21927">Normando</font>  <font color="#D21927">Criptominer</font> </h2><br>  Norman es un minero de criptomonedas Monero de alto rendimiento basado en el c√≥digo XMRig.  A diferencia de otras muestras mineras encontradas, Norman utiliza m√©todos para ocultarlo del an√°lisis con software de seguridad para evitar la detecci√≥n y evitar una mayor distribuci√≥n. <br><br>  A primera vista, este malware es un minero normal que se esconde bajo el nombre svchost.exe.  Sin embargo, el estudio mostr√≥ que utiliza m√©todos m√°s interesantes para esconderse de la detecci√≥n y el mantenimiento del trabajo. <br><br>  El proceso de implementaci√≥n de este malware se puede dividir en tres etapas: <br><br><ul><li>  cumplimiento </li><li>  implementaci√≥n; </li><li>  miner√≠a </li></ul><br><h2>  <font color="#D21927">An√°lisis paso a paso.</font> </h2><br><h3>  Etapa 1. Ejecuci√≥n </h3><br>  El primer paso comienza con el archivo ejecutable svchost.exe. <br><br>  El software malicioso se compila con NSIS (Nullsoft Scriptable Install System), lo cual es inusual.  NSIS es un sistema de c√≥digo abierto utilizado para crear instaladores de Windows.  Al igual que SFX, este sistema crea un archivo comprimido y un archivo de script que se ejecuta durante el instalador.  El archivo de script le dice al programa qu√© archivos ejecutar, y puede interactuar con otros archivos en el archivo. <br><br>  <i><strong>Nota:</strong> Para obtener el archivo de secuencia de comandos NSIS del archivo ejecutable, debe usar 7zip versi√≥n 9.38, ya que esta funci√≥n no se implementa en versiones posteriores.</i> <br><br>  El malware archivado por NSIS contiene los siguientes archivos: <br><br><ul><li>  CallAnsiPlugin.dll, CLR.dll: m√≥dulos NSIS para llamar a funciones .NET DLL; </li><li>  5zmjbxUIOVQ58qPR.dll: la DLL de carga principal; </li><li>  4jy4sobf.acz, es1qdxg2.5pk, OIM1iVhZ.txt - archivos de carga √∫til; </li><li>  Retreat.mp3, Cropped_controller_config_controller_i_lb.png son simplemente archivos que de ninguna manera est√°n asociados con m√°s actividades maliciosas. </li></ul><br>  El comando del archivo de script NSIS que ejecuta la carga √∫til se proporciona a continuaci√≥n. <br><br><img src="https://habrastorage.org/webt/dc/ch/st/dcchst5kvffhufreb1smhmw3lzs.png"><br><br>  El software malicioso se ejecuta llamando a la funci√≥n 5zmjbxUIOVQ58qPR.dll, que toma otros archivos como par√°metros. <br><br><h3>  Etapa 2. Implementaci√≥n </h3><br>  El archivo 5zmjbxUIOVQ58qPR.dll es la carga principal, que se desprende del script NSIS anterior.  Un an√°lisis r√°pido de los metadatos mostr√≥ que la DLL se llamaba originalmente Norman.dll, por eso la llamamos as√≠. <br><br>  Archivo DLL desarrollado en .NET y protegido contra ingenier√≠a inversa por triple ofuscaci√≥n <br>  utilizando el conocido producto comercial Agile .NET Obfuscator. <br><br>  En el curso de la implementaci√≥n, intervienen muchas operaciones para introducir la autointroducci√≥n en su propio proceso, as√≠ como en otros procesos.  Dependiendo de la profundidad de bits del sistema operativo, el malware <br>  elija diferentes rutas a las carpetas del sistema e inicie diferentes procesos. <br><br><img src="https://habrastorage.org/webt/jp/sy/zn/jpsyzngdt-zv5qoswztui4odjrs.png"><br><br>  Seg√∫n la ruta a la carpeta del sistema, el malware seleccionar√° diferentes procesos para comenzar. <br><br><img src="https://habrastorage.org/webt/wp/q9/jc/wpq9jcqxrvwvbfkgh9-wca2qmsi.png"><br><br>  La carga √∫til desplegada tiene dos funciones principales: ejecutar un cripto minero y evitar la detecci√≥n. <br><br><h4>  Si el sistema operativo es de 64 bits </h4><br>  Al ejecutar el archivo fuente svchosts.exe (archivo NSIS), crea un nuevo proceso propio e inyecta la carga √∫til en √©l (1).  Poco despu√©s, lanza notepad.exe o explorer.exe e inyecta un cryptominer en √©l (2). <br><br><img src="https://habrastorage.org/webt/3n/rc/bt/3nrcbtfzkotbmjp_zqdvrzt9r_0.jpeg"><br><br>  Despu√©s de eso, el archivo original svchost.exe se cierra y el nuevo archivo svchost.exe se usa como un programa que monitorea el funcionamiento del proceso minero. <br><br><img src="https://habrastorage.org/webt/ng/ze/bq/ngzebqxper1bhxzwrqxvygimlac.png"><br><br><h4>  Si el sistema operativo es de 32 bits </h4><br>  Durante la ejecuci√≥n del archivo original svchosts.exe (archivo NSIS), duplica su propio proceso e inyecta una carga √∫til, como en la versi√≥n de 64 bits. <br><br>  En este caso, el malware inyecta la carga √∫til en el proceso de usuario explorer.exe.  Desde all√≠, el c√≥digo malicioso inicia un nuevo proceso (wuapp.exe o vchost.exe) e inyecta el minero en √©l. <br><br><img src="https://habrastorage.org/webt/kb/c3/2q/kbc32qdqrmcwqzciy5vhesry224.png"><br><br>  El software malicioso oculta el hecho de la implementaci√≥n en explorer.exe, sobrescribiendo el c√≥digo implementado previamente por medio de wuapp.exe y valores vac√≠os. <br><br><img src="https://habrastorage.org/webt/dz/uz/ct/dzuzct_donm4jroc54uj4bqzy2i.png"><br><br>  Como en el caso de la ejecuci√≥n en un entorno de 64 bits, el proceso original svchost.exe se cierra y el segundo se usa para volver a inyectar c√≥digo malicioso en explorer.exe si el proceso es finalizado por el usuario. <br><br>  Al final del algoritmo de ejecuci√≥n, el malware siempre inyecta el cryptominer en su proceso leg√≠timo. <br><br>  Est√° dise√±ado para evitar la detecci√≥n al cerrar el minero cuando el usuario inicia el Administrador de tareas. <br><br>  Tenga en cuenta que despu√©s de iniciar el Administrador de tareas, el proceso wuapp.exe finaliza. <br><br><img src="https://habrastorage.org/webt/nm/dw/y0/nmdwy02bz2qho6dgotsq_wprv6a.gif"><br><br>  Despu√©s de cerrar el administrador de tareas, el malware inicia el proceso wuapp.exe una y otra vez <br>  introduce un minero en √©l. <br><br><h3>  Etapa 3. Minero </h3><br>  Considere el minero XMRig mencionado anteriormente. <br><br>  El software malicioso inyecta la versi√≥n UPX disfrazada del minero en el bloc de notas, exe, explorer.exe, <br>  svchost.exe o wuapp.exe, seg√∫n la profundidad de bits del sistema operativo y la etapa del algoritmo de ejecuci√≥n. <br><br>  El encabezado PE en el minero se ha eliminado, y en la siguiente captura de pantalla podemos ver que est√° enmascarado con UPX. <br><br><img src="https://habrastorage.org/webt/u0/es/8g/u0es8g-pm5lpx7bov_hwarxv-ws.png"><br><br>  Despu√©s de crear un volcado y reconstruir el ejecutable, logramos ejecutarlo: <br><br><img src="https://habrastorage.org/webt/il/nl/c-/ilnlc-lauzxcgsjrkg0pggo1wik.png"><br><br>  Cabe se√±alar que el acceso al sitio XMR objetivo est√° prohibido, lo que efectivamente neutraliza a este minero. <br><br>  <strong>Configuraci√≥n minera:</strong> <br><br><pre><code class="plaintext hljs">"url": "pool.minexmr.com:5555","user": "49WvfokdnuK6ojQePe6x2M3UCD59v3BQiBszkuTGE7wmNJuyAvHM9ojedgxMwNx9tZA33P84EeMLte7t6qZhxNHqHyfq9xA","pass":"x"</code> </pre> <br><h2>  <font color="#D21927">Misterioso shell PHP que transfiere datos a C&amp;C</font> </h2><br>  En el curso de esta investigaci√≥n, nuestros expertos forenses descubrieron un archivo XSL que les llam√≥ la atenci√≥n.  Despu√©s de un an√°lisis profundo de la muestra, se descubri√≥ un nuevo shell PHP que est√° constantemente conectado al centro de control (servidor C&amp;C). <br><br>  En varios servidores en el entorno del cliente, se encontr√≥ un archivo XSL que fue ejecutado por el conocido ejecutable de Windows (mscorsv.exe) desde una carpeta en el directorio sysWOW64. <br><br>  La carpeta de malware se llamaba Autorrecuperaci√≥n y conten√≠a <b>varios archivos:</b> <br><br><ul><li>  Archivo XSL: xml.XSL </li><li>  nueve archivos dll </li></ul><br>  <b>Archivos ejecutables:</b> <br><ul><li>  Msscorsv.exe </li><li>  Wmiprvse.exe </li></ul><br><img src="https://habrastorage.org/webt/dr/bc/nv/drbcnvij4atirz8jn_tncb6ndkc.png"><br><br><h2>  <font color="#D21927">Archivo XSL</font> </h2><br>  Los archivos XSL son hojas de estilo similares a las tablas utilizadas en CSS que describen c√≥mo mostrar un documento XML. <br><br>  Usando el Bloc de notas, descubrimos que en realidad no era un archivo XSL, sino el c√≥digo PHP Zend Guard ofuscado.  Este hecho curioso sugiri√≥ que esto <br>  carga de malware basada en su algoritmo de ejecuci√≥n. <br><br><img src="https://habrastorage.org/webt/b9/gx/z5/b9gxz56io5zcmlgbtephvyuxyn8.png"><br><br><h2>  <font color="#D21927">Nueve DLL</font> </h2><br>  Un an√°lisis inicial del archivo XSL nos llev√≥ a concluir que tener tantos <br>  Las DLL tienen sentido.  La carpeta principal contiene una DLL llamada php.dll y otras tres bibliotecas relacionadas con SSL y MySQL.  En las subcarpetas, los expertos encontraron cuatro bibliotecas PHP y una biblioteca Zend Guard.  Todos ellos son leg√≠timos y se obtienen del paquete de instalaci√≥n de PHP o como dlls externos. <br><br>  En esta etapa, se asumi√≥ que el malware estaba basado en PHP y ofuscado por Zend Guard. <br><br><h2>  <font color="#D21927">Ejecutables</font> </h2><br>  Tambi√©n en esta carpeta hab√≠a dos archivos ejecutables: Mscorsv.exe y Wmiprvse.exe. <br><br>  Despu√©s de analizar el archivo mscorsv.exe, descubrimos que no estaba firmado por Microsoft, aunque su par√°metro ProductName se estableci√≥ en "Microsoft".  Marco Neto ". <br>  Al principio, parec√≠a extra√±o, pero el an√°lisis de Wmiprvse.exe permiti√≥ comprender mejor la situaci√≥n. <br><br>  El archivo Wmiprvse.exe tampoco estaba firmado, pero conten√≠a el s√≠mbolo de copyright del grupo PHP y el √≠cono PHP.  Durante un escaneo superficial, se encontraron comandos de la ayuda de PHP en sus l√≠neas.  Al ejecutarlo con el modificador -version, se descubri√≥ que este es un archivo ejecutable dise√±ado para ejecutar Zend Guard. <br><br><img src="https://habrastorage.org/webt/9c/xw/ju/9cxwjuu7xoqggrzco-tgun7kpsw.png"><br><br>  Cuando se lanz√≥ mscorsv.exe de la misma manera, se mostraron los mismos datos.  Comparamos los datos binarios de estos dos archivos y vimos que son id√©nticos, con la excepci√≥n de los metadatos. <br>  Copyright y nombre de la empresa / nombre del producto. <br><br><img src="https://habrastorage.org/webt/mp/7y/qk/mp7yqkfz6uqusknzixm5vrwun9e.png"><br><br>  En base a esto, se concluy√≥ que el archivo XSL contiene c√≥digo PHP que se ejecuta utilizando el ejecutable Zend Guard, oculto bajo el nombre mscorsv.exe. <br><br><h2>  <font color="#D21927">Analizando un archivo XSL</font> </h2><br>  Mediante la b√∫squeda en Internet, los expertos recibieron r√°pidamente una herramienta para desofuscar Zend Guard y restauraron el archivo xml.XSL original: <br><br><img src="https://habrastorage.org/webt/5a/ek/nj/5aeknjt7mwgxx96m3t5twger2h0.png"><br><br>  Result√≥ que el malware en s√≠ mismo es un shell PHP que est√° constantemente conectado al centro de control (servidor C&amp;C). <br><br>  Los comandos y resultados que env√≠a y recibe est√°n encriptados.  Desde que recibimos el c√≥digo fuente, ten√≠amos una clave de cifrado y comandos. <br><br>  Este malware contiene la siguiente funcionalidad incorporada: <br><br><ul><li>  Eval: com√∫nmente utilizado para modificar las variables existentes en el c√≥digo </li><li>  Registro de archivo local </li><li>  Caracter√≠sticas de la base de datos </li><li>  Caracter√≠sticas de PSEXEC </li><li>  Ejecuci√≥n oculta </li><li>  Mapeo de procesos y servicios </li></ul><br>  La siguiente variable sugiere que el malware tiene varias versiones. <br><br><img src="https://habrastorage.org/webt/al/id/bs/alidbstswyy1huff1onuh5ma7bg.png"><br><br>  Al recolectar muestras, se descubrieron las siguientes versiones: <br><br><ul><li>  0.5f </li><li>  0.4p </li><li>  0.4o </li></ul><br>  La √∫nica funci√≥n de garantizar la presencia constante de malware en el sistema es que, cuando se ejecuta, crea un servicio que se ejecuta solo, y su nombre <br>  var√≠a de una versi√≥n a otra. <br><br>  Los especialistas intentaron encontrar muestras similares en Internet y encontraron malware, <br>  que, en su opini√≥n, era la versi√≥n anterior de la muestra existente.  El contenido de la carpeta era similar, pero el archivo XSL era diferente y se especificaba un n√∫mero de versi√≥n diferente. <br><br><h2>  <font color="#D21927">Parle Wu Malvare?</font> </h2><br>  Quiz√°s el lugar de nacimiento de este malware es Francia u otro pa√≠s de habla francesa: el archivo SFX conten√≠a comentarios en franc√©s que indican que el autor utiliz√≥ la versi√≥n francesa de WinRAR para crearlo. <br><br><img src="https://habrastorage.org/webt/xq/e2/cd/xqe2cddtfruhzwvz3mro0iqglpm.png"><br><br>  Adem√°s, algunas variables y funciones en el c√≥digo tambi√©n se nombraron en franc√©s. <br><br><img src="https://habrastorage.org/webt/vx/95/9d/vx959dqslson6ybxzoawqzzyvog.png"><br><br><img src="https://habrastorage.org/webt/sk/cv/rd/skcvrd_tj6ntrgghhjzl1fhpjy8.png"><br><br><h2>  <font color="#D21927">Monitorear la ejecuci√≥n y esperar nuevos equipos.</font> </h2><br>  Los especialistas modificaron el c√≥digo de malware y lanzaron de forma segura el ya modificado <br>  versi√≥n para recopilar informaci√≥n sobre los equipos que recibi√≥. <br><br><img src="https://habrastorage.org/webt/xv/tf/uf/xvtfufticasuciea8sfzqyrpppc.png"><br><br>  Al final de la primera sesi√≥n de comunicaci√≥n, los especialistas vieron que el malware recibi√≥ un comando codificado con Base64 como argumento para la clave de inicio EVAL64. <br>  Este comando se decodifica y ejecuta.  Cambia varias variables internas (el tama√±o de los b√∫feres de lectura y escritura), despu√©s de lo cual el malware ingresa al ciclo de trabajo de espera de comandos. <br><br>  No se han recibido nuevos equipos en este momento. <br><br><h2>  <font color="#D21927">Shell PHP interactivo y crypto miner: ¬øest√°n relacionados?</font> </h2><br>  Los expertos de Varonis no est√°n seguros de si Norman est√° asociado con el shell PHP, ya que existen argumentos importantes a favor y en contra de esta suposici√≥n: <br><br><h3>  ¬øPor qu√© pueden estar relacionados? </h3><br><ul><li>  Ninguna de las muestras de software de miner√≠a criptogr√°fica maliciosa ten√≠a la capacidad de distribuirse de forma independiente a otros sistemas, aunque se encontraron en varios dispositivos en diferentes segmentos de red.  Es posible que el atacante haya infectado cada nodo por separado (posiblemente usando el mismo vector de ataque que al infectar al "paciente cero"), aunque ser√≠a m√°s eficiente usar un shell PHP para extenderse por la red que fue el objetivo del ataque. </li><li>  Las campa√±as automatizadas dirigidas a gran escala dirigidas contra una organizaci√≥n espec√≠fica a menudo dejan artefactos t√©cnicos o rastros reconocibles de amenazas de ciberseguridad en su implementaci√≥n.  En este caso, no se encontr√≥ nada por el estilo. </li><li>  Tanto Norman como el shell PHP utilizaron el servicio DuckDNS. </li></ul><br><h3>  Por qu√© pueden no estar relacionados </h3><br><ul><li>  No hay similitudes t√©cnicas entre las opciones de malware de cripto miner√≠a y el shell PHP.  El cryptominer malicioso se cre√≥ en C ++ y el shell en PHP.  Adem√°s, no hay similitudes en la estructura del c√≥digo, y las funciones de red se implementan de manera diferente. </li><li>  No hay interacci√≥n directa entre las opciones de malware y el shell PHP para el intercambio de datos. </li><li>  No tienen comentarios generales del desarrollador, archivos, metadatos o huellas digitales. </li></ul><br><h3>  Tres recomendaciones para la protecci√≥n contra conchas removidas </h3><br>  El software malicioso, que requiere comandos del centro de control (servidores C&amp;C), no se parece a los virus comunes.  Sus acciones no son tan predecibles y m√°s bien se parecer√°n a las acciones de un hacker o un pentester realizado sin herramientas o scripts automatizados.  Por lo tanto, detectar estos ataques sin firmas de malware es una tarea m√°s compleja que los an√°lisis antivirus convencionales. <br><br>  <strong>A continuaci√≥n se presentan tres recomendaciones para proteger a las empresas de los dep√≥sitos remotos:</strong> <br><ol><li>  <b>Mantenga todo el software actualizado</b> <br>  Los atacantes a menudo explotan vulnerabilidades en software y sistemas operativos para propagarse por la red de la organizaci√≥n y buscar datos de inter√©s para <br>  robo  La instalaci√≥n oportuna de parches reduce significativamente el riesgo de tales amenazas. </li><li>  <b>Seguimiento de eventos anormales de acceso a datos</b> <br>  Lo m√°s probable es que los atacantes intenten mostrar los datos confidenciales de la organizaci√≥n en todo el per√≠metro.  El monitoreo de eventos anormales de acceso a estos datos permitir√° <br>  detectar usuarios comprometidos y todo el conjunto de carpetas y archivos que realmente podr√≠an caer en manos de los atacantes, y no solo considerar todos los datos disponibles para estos usuarios como tales. </li><li>  <b>Rastrea el tr√°fico de red</b> <br>  Gracias al uso de un servidor de seguridad y / o servidor proxy, es posible detectar y bloquear conexiones maliciosas a los centros de control de malware (servidores C&amp;C), lo que evitar√° que los atacantes ejecuten comandos y complicar√° la tarea de salida <br>  datos perimetrales. </li></ol><br>  <strong>¬øPreocupado por el tema de la miner√≠a gris?</strong>  <strong>Seis recomendaciones para la protecci√≥n:</strong> <br><br><ol><li>  <b>Mantenga todos los sistemas operativos actualizados.</b> <br>  La administraci√≥n de parches es muy importante para evitar el mal uso de los recursos y la infecci√≥n de malware. </li><li>  <b>Monitoree el tr√°fico de red y los proxies web</b> <br>  Haga esto para detectar algunos ataques y para evitar parte de ellos, puede bloquear el tr√°fico en funci√≥n de la informaci√≥n sobre dominios maliciosos o limitar los canales de transmisi√≥n de datos innecesarios. </li><li>  <b>Use y mantenga soluciones antivirus y sistemas de seguridad de punto final</b> (pero en ning√∫n caso lim√≠tese a usar solo esta capa de protecci√≥n). <br>  Los productos en los dispositivos finales permiten la detecci√≥n de criptomineros conocidos y la prevenci√≥n de infecciones antes de que el rendimiento de los sistemas y el uso de electricidad se vean comprometidos.  Debe tenerse en cuenta que las nuevas modificaciones o los nuevos m√©todos para evitar la detecci√≥n pueden hacer que las funciones de seguridad en los dispositivos finales no detecten nuevas versiones del mismo malware. </li><li>  <b>Monitorear la actividad de la CPU de la computadora</b> <br>  Como regla, los mineros criptogr√°ficos usan el procesador central de la computadora para la miner√≠a.  Es necesario analizar cualquier mensaje sobre la degradaci√≥n del rendimiento ("Mi computadora comenz√≥ a ralentizarse"). </li><li>  <b>Supervise el DNS para el uso inusual de los servicios de DNS din√°mico (como DuckDNS)</b> \ <br><br>  A pesar de que DuckDNS y otros servicios de DNS din√°mico en s√≠ mismos no son da√±inos para el sistema, el uso de malware DuckDNS simplific√≥ la detecci√≥n de nodos infectados para los equipos de especialistas involucrados en la investigaci√≥n. </li><li>  <b>Desarrollar un plan de respuesta a incidentes.</b> <br>  Aseg√∫rese de tener los procedimientos necesarios descritos para tales incidentes que detectan, limitan y eliminan autom√°ticamente la amenaza de la miner√≠a de criptograf√≠a gris. </li></ol><br>  <strong>Nota para los clientes de Varonis.</strong> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Varonis DatAlert</a> incluye modelos de amenazas que detectan malware para la miner√≠a de cifrado.  Los clientes tambi√©n pueden crear sus propias reglas para el descubrimiento dirigido de software basado en dominios que son candidatos para la lista negra.  Para asegurarse de que est√° utilizando la √∫ltima versi√≥n de DatAlert y est√° aplicando los modelos de amenaza apropiados, comun√≠quese con su representante de ventas o con el Soporte de Varonis. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/466817/">https://habr.com/ru/post/466817/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../466807/index.html">Python, devorando el mundo: como proyecto paralelo de un desarrollador se ha convertido en un lenguaje de programaci√≥n popular</a></li>
<li><a href="../466809/index.html">El circulo esta cerrado. C√≥mo los mitaps me ayudaron a encontrar el trabajo so√±ado</a></li>
<li><a href="../466811/index.html">Historia y alternativas a la plataforma .NET</a></li>
<li><a href="../466813/index.html">Posit-aritm√©tica: derrotando un punto flotante en su propio campo. Parte 2</a></li>
<li><a href="../466815/index.html">Descripci√≥n t√©cnica general de NEC HYDRAstor HS8 y m√°s</a></li>
<li><a href="../466819/index.html">Implementaci√≥n de ofertas promocionales en iOS. ¬øC√≥mo ganar m√°s en suscripciones?</a></li>
<li><a href="../466821/index.html">Instale 3CX desde Amazon AWS Marketplace</a></li>
<li><a href="../466823/index.html">C√≥mo configuramos migraciones para procesos empresariales en Bitrix24</a></li>
<li><a href="../466829/index.html">Algunos toques para trabajar con ID de bigint en R</a></li>
<li><a href="../466831/index.html">Desarrollo de un sistema operativo monol√≠tico similar a Unix - Heap (4)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>