<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏾‍🤝‍🧑🏼 🚜 🖖🏻 Sistem perlindungan kebocoran 🐥 🙏🏼 ‼️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Saya ingin berbagi pengalaman dalam membuat perangkat yang tidak hanya menarik untuk diterapkan, tetapi juga bisa bermanfaat. Mungkin seseorang akan m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sistem perlindungan kebocoran</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/382065/"><img src="https://habrastorage.org/files/055/477/b38/055477b3811b49e2b9123bdccca872f1.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya ingin berbagi pengalaman dalam membuat perangkat yang tidak hanya menarik untuk diterapkan, tetapi juga bisa bermanfaat. </font><font style="vertical-align: inherit;">Mungkin seseorang akan mengatakan bahwa itu mungkin untuk melakukan sesuatu yang lebih sederhana, tetapi ini bukan cara kita ...</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya berawal dari fakta bahwa setelah perbaikan apartemen ditemukan masalah potensial. </font><font style="vertical-align: inherit;">Dalam hal terjadi kebocoran di suatu tempat, itu tidak akan berhasil untuk mendapatkan crane untuk memasuki apartemen tanpa upaya fisik dan ketangkasan tertentu, karena menetas menutup crane tidak terpasang dengan sangat baik. </font><font style="vertical-align: inherit;">Oleh karena itu, dalam kasus kebutuhan mendesak (kecelakaan) untuk mematikan keran dengan cepat tidak akan berfungsi. </font><font style="vertical-align: inherit;">Itu perlu untuk melakukan sesuatu dengan ini, dan solusi muncul - untuk merealisasikan peluang dari jarak jauh, mis. </font><font style="vertical-align: inherit;">tanpa membuka palka, hentikan pasokan air. </font><font style="vertical-align: inherit;">Dan sebagai bonus, untuk mengimplementasikan segala sesuatu yang dapat dipercaya dengan elektronik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beginilah tampilan perangkat. </font></font><br>
<br>
<img src="https://habrastorage.org/files/9fa/6a7/137/9fa6a713753a403ab27be8f6c4ffe0da.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fitur utama:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Matikan pasokan air secara independen jika terjadi kebocoran</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Matikan pasokan air "dalam mode manual" - di panel depan ada "tombol merah" dan sakelar sakelar dua posisi</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tampilan pembacaan meteran pada tampilan sendiri</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tampilkan informasi bermanfaat lainnya pada layar</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak bisa, tetapi merencanakan:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bekerja dari sumber daya cadangan. </font><font style="vertical-align: inherit;">Sekarang jika terjadi pemadaman listrik - perangkat tidak berguna</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bekerja dengan sensor kebocoran nirkabel</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bersihkan diri Anda. </font><font style="vertical-align: inherit;">Agar tidak menjadi asam, disarankan untuk membuka / menutupnya sebulan sekali</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beri tahu tentang acara di smartphone dan dikendalikan oleh "udara"</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak bisa (dan betapapun diperlukan):</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memiliki beberapa saluran untuk membaca sensor kebocoran kabel yang berbeda, sekarang semua sensor (5 pcs) terhubung secara paralel</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kelola derek secara terpisah. </font><font style="vertical-align: inherit;">Ada dua dari mereka (satu di panas, yang kedua di air dingin), dan mereka terhubung secara paralel</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontrol kerusakan sensor</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berikut ini adalah deskripsi komponen dan tujuannya (harga per Juli 2015).</font></font><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">    1/2 " DN15 DC5V</a> ( CR02,  ,     ) — 3080   </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Maple Mini (  stm32f103c8t6)</a>    — 233 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SPI TFT LCD  ILI9341</a> — 302 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> Ds3231 + AT24C32</a>   ,  ,   — 4  EEPROM — 38 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ULN2003 DIP-16</a> —    — 123 /10  ( )</li>
<li>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a> — 239 /10  (  )</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a>     — 164 /5  ( )</li>
<li>  ,  : ,  (    ), ,  , </li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja, saya juga memerlukan programmer / emulator, saya menggunakan yang ini: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ARM Emulator, mendukung ARM7, ARM9, ARM11, inti Cortex-M3, ADS, IAR, STM32, antarmuka JTAG, versi V8 buffered ganda</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dari fitur, kita dapat menyebutkan bahwa selain </font><font style="vertical-align: inherit;">kabel </font><font style="vertical-align: inherit;">standar untuk </font><font style="vertical-align: inherit;">pemrograman </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SW</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , saya harus menerapkan catu daya saat ini dari chip yang dapat diprogram, 3,3 volt, dalam kasus saya. </font><font style="vertical-align: inherit;">Adalah penting bagi programmer untuk memahami level voltase dari nilai-nilai logis. </font><font style="vertical-align: inherit;">Tanpa ini, chip yang dapat diprogram tidak ingin terdeteksi. </font><font style="vertical-align: inherit;">Juga, programmer ini memiliki kemampuan untuk menyalakan perangkat yang dapat diprogram, pin disediakan untuk ini, tegangan dinyalakan / dimatikan oleh utilitas JLink.exe.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lebih banyak tentang besi</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikrokontroler</font></font></h3><img src="https://habrastorage.org/files/73d/47b/3b3/73d47b3b3ca9476dafadf503b3162931.jpg" width="300" align="right"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otak seluruh sistem adalah mikrokontroler 32-bit dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ST yang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> disolder dengan rapi oleh pekerja Cina di pabrik-pabrik Cina ke papan yang "kompatibel" dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leaf Maple Mini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tentang Leaf Maple Mini</font></font></b><div class="spoiler_text">   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">eta4ever</a> <blockquote>  ,  </blockquote>        «»     ,    …<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Memiliki 48 kesimpulan. </font><font style="vertical-align: inherit;">Inti berjalan pada 72MHz, telah terintegrasi SRAM - 20KB dan Flash - 128KB. </font><font style="vertical-align: inherit;">Lebih detail di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Parameter seperti itu pasti mendorong penggunaan alat dan alat tingkat tinggi, yaitu </font><font style="vertical-align: inherit;">ini adalah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FreeRTOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tampilan warna grafis, C ++, dll. </font><font style="vertical-align: inherit;">(dan bukan dua LED dan assembler). </font><font style="vertical-align: inherit;">Secara umum, jangan menyangkal diri sendiri apa pun ... kecuali C ++, tapi ini bukan masalah chip.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengapa?</font></font></b><div class="spoiler_text">       C++ ,  ,     ,     . ,     C++      ,   ,  ,   , ..      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">STM32CubeMX</a>      ,   FreeRTOS.     ,      .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menggunakan kesimpulan dari mikrokontroler. </font><font style="vertical-align: inherit;">Dari sini Anda dapat menebak apa yang terhubung.</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/173/70e/067/17370e0676c64b75b9ddf7ec11a1ae29.png"><br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tampilan</font></font></h3><br>
<img src="https://habrastorage.org/files/c09/361/5b6/c093615b66774fb7969845db6584ee70.jpg" width="300" align="right"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modul dengan layar TFT 320x240 piksel yang dibangun di atas pengontrol yang kompatibel dengan ILI9341 bertanggung jawab untuk menampilkan informasi, ia bekerja dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pada frekuensi maksimum yang dimungkinkan untuk bundel ini (18MHz). </font><font style="vertical-align: inherit;">SPI terhubung ke mikrokontroler hanya dalam satu arah, output untuk membaca data dari modul display tetap menggantung di udara, karena </font><font style="vertical-align: inherit;">Saya tidak menemukan fungsi ini, tetapi saya menyimpannya di kaki mikrokontroler yang bebas. </font><font style="vertical-align: inherit;">Transfer data berfungsi pada </font></font><abbr title="DMA, atau Direct Memory Access - teknologi akses memori langsung melewati prosesor pusat"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DMA</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Konektor untuk menghubungkan kartu SD disolder ke modul di sisi belakang, saya belum diuji bekerja dengan kartu SD dan konektor tidak terlibat dalam proyek ini.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modul RTC dan EEPROM</font></font></h3><br>
<img src="https://habrastorage.org/files/527/406/51e/52740651ee344478a84c0a15f43c3c51.jpg" width="300" align="right"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jam pada modul diimplementasikan dengan chip DS3231. Saya tidak menyebabkan masalah khusus, satu-satunya ketidaknyamanan adalah bahwa semua nilai (tanggal, waktu) disimpan dalam register dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format BCD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ketika dua digit desimal tercermin dalam satu byte (dalam empat bit atas - digit paling signifikan, di bawah - digit paling signifikan) . Misalnya, nilai "38 menit" disimpan sebagai nilai desimal 56 (ini adalah "38" dalam notasi heksadesimal). Itu tidak mungkin untuk mengetahui apakah mungkin untuk beralih ke format biner.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modul ini memiliki baterai sendiri, jadi setiap kali Anda kehilangan daya, Anda tidak perlu mengatur waktu dan tanggal. Juga, mikrokontroler AT24C32 disolder pada papan modul, memiliki bit EEPROM sebanyak 32768! Sederhananya, itu adalah 4 Kbytes memori non-volatile. Jam dan memori berada di bus I2C yang sama. Saat ini, memori hanya digunakan untuk menyimpan pengaturan perangkat, nilai saat ini dari pembacaan counter, dan sesuatu yang lain. akhirnya ditempati ... 25 byte. Nantinya akan digunakan untuk menyimpan log dari berbagai acara, dan mungkin untuk menjaga statistik konsumsi (saya tidak tahu mengapa, tetapi akan ada kesempatan untuk memprogram tampilan grafik).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain kontak dan daya bus I2C, ada dua lagi di papan tulis. </font><font style="vertical-align: inherit;">"SQW" adalah sinyal dari jam alarm yang dapat diprogram melalui register dan "32K" adalah frekuensi yang dihasilkan oleh DS3231 untuk perangkat lain. </font><font style="vertical-align: inherit;">Proyek ini tidak berlaku.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modul dengan sensor kelembaban</font></font></h3><br>
<img src="https://habrastorage.org/files/6a9/b19/bc1/6a9b19bc17f64a42bc008a3c5a3fe058.jpg" align="right" width="300"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini digunakan sebagai penyangga antara dunia luar dan mikrokontroler. </font><font style="vertical-align: inherit;">Kabel yang menuju ke probe secara total memiliki panjang sekitar 10 meter, tanpa layar. </font><font style="vertical-align: inherit;">Kabel telepon dua kawat konvensional. </font><font style="vertical-align: inherit;">Jika ada hit statis, saya harap hanya modul ini yang akan mati, tetapi bukan mikrokontroler. </font><font style="vertical-align: inherit;">Ia mampu mengukur resistansi antara dua elektroda dan memberikan informasi ini dalam bentuk analog (tegangan dari 0 hingga tegangan suplai) dan dalam digital (0/1, modul memiliki resistor variabel yang dapat disesuaikan dengan batas operasi).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada masalah kecil dengan modul ini. Saat menerapkan dan melepaskan tegangan suplai, modul pada output digital memberi sinyal trip, ini dapat dilihat dengan LED berkedip selama sepersekian detik (pada papan modul, LED dipasang secara paralel dengan output digital). Mikrokontroler berhasil membaca sinyal abnormal ketika daya sistem diterapkan / direset (masalah No. 1). Solusinya diimplementasikan dengan melewatkan pulsa operasi pendek, untuk mengantisipasi kondisi tetap untuk sementara waktu.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Variabel resistor memiliki sudut penyesuaian yang sangat kecil di mana saya tidak dapat menemukan batas antara tidak adanya alarm palsu dan sensitivitas yang baik (masalah No. 2). Kemudian diimplementasikan membaca sinyal analog melalui mikrokontroler ADC. Pada saat yang sama, dimungkinkan untuk menetapkan batas respons di pengaturan perangkat sebagai parameter. Kemampuan untuk menyesuaikan tingkat respons sekarang dianggap berlebihan, dan mungkin lebih baik untuk meng-hardcode nilai batas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Telah diperhatikan bahwa setelah beberapa menit operasi (pemanasan?), Modul tiba-tiba mulai memberi sinyal operasi spontan (masalah nomor 3, berapa banyak dari mereka?!).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada batas respon abnormal, intensitas cahaya LED (pada modul) secara bertahap meningkat atau menurun, seolah-olah dikendalikan oleh generator PWM, jelas bahwa ini adalah noise dan frekuensi tinggi, hal yang sama dapat diharapkan pada output "digital" dari modul (masalah No. 4 ) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya akan mengklarifikasi bahwa semua masalah ini diselesaikan ketika membaca sinyal analog dari modul diimplementasikan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Probe (bagian-bagian dari sensor yang terletak langsung di tempat-tempat penumpukan air jika terjadi kecelakaan) dibuat dari cara yang diimprovisasi. Ini adalah timah (baja) dan kotak persimpangan bundar kecil, dimodifikasi secara mekanis ke tipe yang diinginkan dan dengan kabel yang disolder di dalamnya. Ketika air masuk di antara pasangan elektroda, resistansi berkurang dan dianggap oleh pengontrol sebagai "kebocoran".</font></font><br>
<br>
<img src="https://habrastorage.org/files/bc7/366/3ad/bc73663ad6f048079b0ca835a353a0b6.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pengujian laboratorium menunjukkan bahwa produk menjalankan fungsinya dengan baik dan bukan merupakan tautan lemah dalam sistem.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nutrisi</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seluruh sistem bekerja dari pengisian daya untuk telepon - 5 volt, 2A (di sini dengan margin). </font><font style="vertical-align: inherit;">Regulator tegangan 3.3V dipasang pada papan Mini Maple, tegangan input bisa sampai 12 volt, karakteristik stabilizer memungkinkan, tetapi tegangan besar seperti itu tidak nyaman digunakan, lebih lanjut tentang itu di bawah ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan stabilizer, 3,3 volt juga digunakan untuk kekuatan RTC, modul TFT dan ke modul pengukuran kelembaban. </font><font style="vertical-align: inherit;">Crane terhubung melalui unit saklar daya ULN2003AN, langsung dari catu daya, mis. </font><font style="vertical-align: inherit;">bekerja dari 5 volt, minus drop pada tombol. </font><font style="vertical-align: inherit;">ULN2003AN hanya menggunakan dua dari tujuh saluran.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja, disarankan untuk mengganti catu daya dengan yang lain, dengan tegangan yang sedikit lebih tinggi, karena kadang-kadang, ketika menutup crane, salah satunya, pada posisi yang hampir ekstrem akibat pengoperasian trailernya sendiri (dua buah dipasang di badan katup, untuk mengerjakan posisi ekstrem), berhenti selama sepersekian detik, kemudian "rebound" terjadi (karena permainan di roda gigi gearbox) ), kemudian upaya berulang untuk mengencangkan katup bola dan seterusnya hingga pengontrol melepaskan tegangan suplai dari penggerak servo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penjual di situs memiliki informasi bahwa crane harus bekerja mulai dari 5 volt, dalam hal ini tegangan yang disediakan lebih sedikit. </font><font style="vertical-align: inherit;">Perangkat lunak dibuat sehingga untuk membuka dan menutup keran, tegangan hanya disuplai untuk waktu tertentu (6 detik), selama itu keran harus memiliki waktu untuk membuka atau menutup. </font><font style="vertical-align: inherit;">Perlu dicatat bahwa efek ini tidak mempengaruhi penutupan keran yang tidak lengkap </font><font style="vertical-align: inherit;">momen ini datang setelah keran benar-benar mematikan aliran air. </font><font style="vertical-align: inherit;">Dimungkinkan juga untuk menyebutkan bahwa terlalu banyak tegangan ke servos (diterapkan 9 volt untuk percobaan) membuat mereka bergerak dengan inersia lebih lanjut (setelah saklar batas dipicu) dan berbatasan dengan posisi ekstrem dengan suara karakteristik dampak.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servo Ball Valves</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Katup pemutus terlihat andal, tetapi bagian elektronik harus diselesaikan. </font></font><br>
<br>
<img src="https://habrastorage.org/files/b73/ca0/7bb/b73ca07bb94e48278a4de7c54d6056bb.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda melihat sirkuit kontrol derek, Anda akan melihat bahwa mereka dikendalikan oleh tegangan positif. </font><font style="vertical-align: inherit;">Kabel "minus" dan dua sinyal-kekuatan "plus", satu untuk menutup, yang lain untuk pembukaan. </font><font style="vertical-align: inherit;">Tetapi ULN2003AN tidak dapat bekerja dalam mode ini, di dalamnya, ketika kunci dibuka, output yang dikelola terhubung ke minus. </font><font style="vertical-align: inherit;">Solusinya adalah mengubah kontrol polaritas crane itu sendiri. </font><font style="vertical-align: inherit;">Untuk melakukan ini, saya harus menukar sinyal "trailer", karena </font><font style="vertical-align: inherit;">karena perubahan polaritas, motor listrik berputar ke arah yang berlawanan (dibandingkan dengan sirkuit stok), sedangkan posisi ekstrem sekarang dalam arah yang berlawanan. </font><font style="vertical-align: inherit;">Akibatnya, kami memiliki crane dengan "plus" dan dua kontrol "minus" yang sama. </font><font style="vertical-align: inherit;">Persis apa yang dibutuhkan!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cranes dengan servo dalam kondisi "pertempuran".</font></font><br>
<br>
<img src="https://habrastorage.org/files/7b0/9c1/7ae/7b09c17aebf74188a522f485fc6361fe.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pembacaan meter</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja, tidak ada data yang disimpan di konter itu sendiri, yang dapat dibaca oleh dua kabel yang dihapus darinya. </font><font style="vertical-align: inherit;">Ini hanya rantai dengan sakelar buluh dan magnet yang terletak pada impeller yang berputar. </font><font style="vertical-align: inherit;">Pengukuran dengan multimeter tidak menunjukkan adanya resistensi atau kapasitansi listrik di sirkuit. </font><font style="vertical-align: inherit;">Di penghitung saya, sirkuit (dengan pembukaan berikutnya) dari saklar buluh terjadi pada laju aliran satu liter air. </font><font style="vertical-align: inherit;">Di suatu tempat ada informasi tentang meter, sinyal dari mana terbentuk setiap 10 liter. </font><font style="vertical-align: inherit;">Itu </font><font style="vertical-align: inherit;">mereka berbeda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mikrokontroler diperlukan untuk membaca pulsa ini. </font><font style="vertical-align: inherit;">Antarmuka pengguna perangkat, tentu saja, memberikan nilai awal.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dari masalah yang ada: dengan tidak adanya listrik, konsumsi air tidak akan diperhitungkan. Ada cacat perangkat keras, perlu untuk memperbaikinya - lakukan cadangan daya pada baterai, ini juga diperlukan untuk fungsi utama perangkat, jika tidak perangkat tidak akan dapat mematikan keran jika perlu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dari sini muncul dua tugas berikut:</font></font><br>
<ol>
<li>      . , ,    « »,     ,     () /     .      ,           (  ),       «»,   ,    (,        ),   ,      FreeRTOS.</li>
<li>        ,           ,          « ».<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Matikan keran?</font></font></b><div class="spoiler_text">,   , , ,       , 11  ,    ,  «» ,          ,      «»  , !<br>
</div></div></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontrol</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encoder</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terletak di sebelah tampilan dan dirancang untuk menavigasi menu. </font><font style="vertical-align: inherit;">Rotasi - pergi ke item menu berikutnya / sebelumnya, tekan - pilih / aktifkan item menu.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Tombol merah"</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cara termudah untuk mematikan keran adalah dengan menekan tombol merah. </font><font style="vertical-align: inherit;">Meskipun itu tidak boleh bermanfaat, karena </font><font style="vertical-align: inherit;">beberapa waktu sebelumnya, perangkat itu sendiri harus melakukan segalanya. </font><font style="vertical-align: inherit;">Tapi untuk jaga-jaga, tombol ada. </font><font style="vertical-align: inherit;">Pers berulang, tahan lama, klik dua kali, dll. </font><font style="vertical-align: inherit;">tidak dihitung, hanya pers pertama dan hanya itu. </font><font style="vertical-align: inherit;">Mode "darurat" diaktifkan, hanya dapat dinonaktifkan melalui item menu khusus.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On / Off Toggle Switch</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mereka juga dapat dimatikan dengan ketukan, tetapi juga dapat dibuka, tentu saja, jika sistem tidak dalam mode "crash". </font><font style="vertical-align: inherit;">Ini mungkin berguna untuk penghentian sementara pasokan air.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LED tiga warna</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya di sini juga sederhana. </font><font style="vertical-align: inherit;">Untuk menunjukkan mode saat ini: hijau - semuanya rapi, merah - tidak semuanya rapi, biru - keran ditutup menggunakan sakelar sakelar (lihat paragraf di atas). </font><font style="vertical-align: inherit;">Warna pencampuran tidak digunakan, tiga sudah cukup. </font><font style="vertical-align: inherit;">Tapi di sini muncul masalah. </font><font style="vertical-align: inherit;">Cahaya sangat kuat sehingga menyilaukan ketika Anda melihat tampilan. </font><font style="vertical-align: inherit;">470 ohm untuk setiap warna tidak cukup. </font><font style="vertical-align: inherit;">Diperbaiki secara terprogram. </font><font style="vertical-align: inherit;">Ketika layar dalam keadaan aktif (dan itu aktif saat Anda menggunakan kontrol dan untuk sementara waktu), LED ini mati.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perangkat berfungsi, pengujian berkala menunjukkan bahwa perangkat itu berfungsi dengan baik. </font><font style="vertical-align: inherit;">Itu tidak membeku, tidak buggy. </font><font style="vertical-align: inherit;">Meskipun saya tahu di mana ada potensi, tetapi kesalahan tidak kritis dalam kode, ini tidak dibahas dalam artikel ini. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sumber, proyek uVision 5 Keil, file proyek untuk STM32CubeMX</font></font></a></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id382065/">https://habr.com/ru/post/id382065/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id382051/index.html">Mengapa mendeklarasikan pochta.fi paket di pabean Finlandia?</a></li>
<li><a href="../id382053/index.html">Menyelidiki DNA kelinci yang bengkok</a></li>
<li><a href="../id382057/index.html">Saran buruk untuk panduan copter pemula. Bagian 2</a></li>
<li><a href="../id382059/index.html">[Informasi pos] Sistem file untuk drive USB dan kartu memori</a></li>
<li><a href="../id382063/index.html">Perasaan organ-organ mobil</a></li>
<li><a href="../id382067/index.html">Tulisan tangan dari jaringan saraf berpura-pura menjadi tulisan tangan seseorang</a></li>
<li><a href="../id382071/index.html">Untuk pertama kalinya, sebuah program yang lebih baik daripada seseorang mengatasi pengenalan pola</a></li>
<li><a href="../id382073/index.html">Penyelamatan tenggelam - karya robot</a></li>
<li><a href="../id382075/index.html">Kisah bagaimana saya membawa NAO ke Rusia</a></li>
<li><a href="../id382077/index.html">Jimmy Wales Meluncurkan Jaringan Sosial dan Operator Telepon untuk Membantu Orang Menyumbang untuk Amal</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>