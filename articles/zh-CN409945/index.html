<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🎤 👩🏿‍✈️ 😥 Sysadmin EDC设备：随身携带Linux 🕑 ♈️ ⏲️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="也许每个管理员都有一个案例，当某件事突然发生故障，而您在路上某个地方：您开车去，坐火车，或者平时坐在公园的长椅上某个地方，松散然后冲到某个地方欲望不是丝毫的。 您需要修复它。 或至少评估已到达的白色毛皮动物的规模。 

 显然，您可以使用智能手机或平板电脑，尤其是仅需要通过ssh进行操作时。 但是对...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sysadmin EDC设备：随身携带Linux</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/409945/">也许每个管理员都有一个案例，当某件事突然发生故障，而您在路上某个地方：您开车去，坐火车，或者平时坐在公园的长椅上某个地方，松散然后冲到某个地方欲望不是丝毫的。 您需要修复它。 或至少评估已到达的白色毛皮动物的规模。 <br><br> 显然，您可以使用智能手机或平板电脑，尤其是仅需要通过ssh进行操作时。 但是对于我来说，在这种情况下使用触摸屏是痛苦和痛苦。 <br><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hd/-j/nd/hd-jndx6jjchvd9ggnpyj-ynvhw.jpeg"></div><br> 您可以购买平板电脑的外接键盘，支架或支架，但我认为随身携带完整的笔记本电脑会更容易。 地点将大致相同。 <br><a name="habracut"></a><br><h2> 一些记忆和推理 </h2><br> 懒得阅读，您可以立即进入<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">实际部分。</a> <br><br> 有一次，当时还不存在Android和iPhone，为此，我使用了“互联网平板电脑”诺基亚N810。 该手机具有现代智能手机的尺寸，同时具有qwerty键盘，甚至配备完整的Linux。  ssh，vnc，rdesktop-是的，没有问题！ 另外，当我需要快速计算某些东西并显示结果时，我积极使用CAS Maxima。 <br><br><br> <a href=""><img src="https://habrastorage.org/webt/bd/e7/kx/bde7kxemqv5fuchk9o5aujaokte.jpeg"></a> <br> <a href=""><img src="https://habrastorage.org/webt/so/ya/xr/soyaxrvavdiymhza5xjuv0mhy7q.png"></a> <br><br> 但是随着时间的流逝，Android智能手机开始出现。 我想这就是：几乎成熟的Linux，同时，您无需携带其他设备来分发Internet。 我开始用qwerty看设备，用旧的n810代替了我，那时候的n810已经很累了（屏幕电缆，两次更换电池，键盘，外壳坏了）。 选择权落在了摩托罗拉里程碑上。 <br><br> 这部分是我的旧款Palm V和N810旁边的部分： <br><br> <a href=""><img src="https://habrastorage.org/webt/hh/vf/bm/hhvfbmnvsxhy_2srw11rhwt8r5g.jpeg"></a> <br><br> 我必须说，该产品并不能证明信任。 键盘让人完全失望。 甚至不是因为布局，而是因为做工极其差劲：使用六个月后，它开始脱落并脱落。 <br><br> 加密的引导加载程序为棺材加了个钉子：由于电源的特殊性，无法使用自定义内核带来所有后果，debian chroot像自己一样对电池进行了充电，但是仍然可以以某种方式产品解决分配给它的任务。 <br><br> 至少，它在制造商确定的计划淘汰时间到期后继续使用，当时又发布了多个最新型号（有所不同，可能是布局略有更改，并且拥有大量RAM），而且它的越野车速度很慢且缓慢。 <br><br> 好的，因为ssh终端将关闭，智能手机也将关闭（当然，它将吞噬掉一定数量的神经细胞）。 但是在某些情况下，您需要使用控制台电缆固定在一块铁板上，或者需要使用无响应的IP设备删除tcpdump，以便可以对其进行处理。 <br><br> 当由于对接站上有COM端口而使人拖着沉重的17英寸HP shnuy傻瓜，一个坞站和一个1.5千克的电源，然后将所有这些东西挂在柜台前的梯子上时，这简直令人着迷。 <br><br> 最近，我使用了12个“带有usb2com适配器的ThinkPad x220。但是越来越多的我开始将笔记本电脑留在家中，直到有一天（再次）” $用户名，一切都破了！”，而且我的Android上只有一部智能手机。 <br><br><h2> 这就是我梦the以求的鱼（事实上，没有） </h2><br> 当我遇到一个名为GPD Pocket的产品时。 功能齐全的笔记本电脑，具有重新智能手机或超大尺寸平板电脑的外形。  7“，qwerty-keyboard，相当不错的自治权-呃，您需要拿走它。 <br><br> 与x220和n810进行比较： <br><br> <a href=""><img src="https://habrastorage.org/webt/jg/kj/hq/jgkjhqw3ulrb3i956decqaladlk.jpeg"></a> <br><br> 我不会描述那些需要它的人的特征-他们会在Internet上找到它，尤其是因为最近从girbest进行的一篇简短评论中。 只需给出排气lshw和lspci： <br><br>  lshw： <br><br><div class="spoiler">  <b class="spoiler_title">隐藏文字</b> <div class="spoiler_text"><pre><code class="plaintext hljs">:   : Default string (Default string) : Default string : Default string  №: Default string : 64 bits : smbios-3.0 dmi-3.0 vsyscall32 : boot=normal chassis=desktop family=Default string sku=Default string uuid=00020003-0004-0005-0006-000700080009 *-core :   : Default string : AMI Corporation  ID: 0 : Default string  №: Default string : Default string *-firmware : BIOS : American Megatrends Inc.  ID: 0 : 5.11 date: 08/07/2017 : 64KiB capacity: 4032KiB : pci upgrade shadowing cdboot bootselect socketedrom edd int13floppy1200 int13floppy720 int13floppy2880 int5printscreen int14serial int17printer acpi usb biosbootspecification uefi *-memory :    ID: 28 :      : 8GiB *-bank:0 : DIMM DDR3 1066 MHz (0,9 ns) : 00000000 : Hynix Semiconductor  ID: 0  №: 00000000 : A1_DIMM0 : 4GiB : 8 bits : 1066MHz (0.9ns) *-bank:1 : DIMM DDR3 1066 MHz (0,9 ns) : 00000000 : Hynix Semiconductor  ID: 1  №: 00000000 : A1_DIMM1 : 4GiB : 8 bits : 1066MHz (0.9ns) *-cache:0 : L1   ID: 32 : CPU Internal L1 : 224KiB capacity: 224KiB : internal write-back : level=1 *-cache:1 : L2   ID: 33 : CPU Internal L2 : 2MiB capacity: 2MiB : internal write-back unified : level=2 *-cpu :  : Intel(R) Atom(TM) x7-Z8750 CPU @ 1.60GHz : Intel Corp.  ID: 34   : cpu@0 : Intel(R) Atom(TM) x7-Z8750 CPU @ 1.60GHz : SOCKET 0 : 889MHz capacity: 2560MHz : 64 bits : 80MHz : x86-64 fpu fpu_exception wp vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx rdtscp constant_tsc arch_perfmon pebs bts rep_good nopl xtopology tsc_reliable nonstop_tsc cpuid aperfmperf tsc_known_freq pni pclmulqdq dtes64 monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr pdcm sse4_1 sse4_2 movbe popcnt tsc_deadline_timer aes rdrand lahf_lm 3dnowprefetch epb pti tpr_shadow vnmi flexpriority ept vpid tsc_adjust smep erms dtherm ida arat cpufreq : cores=4 enabledcores=4 threads=4 *-pci : Host bridge : Intel Corporation : Intel Corporation  ID: 100   : pci@0000:00:00.0 : 34 : 32 bits : 33MHz : driver=iosf_mbi_pci : IRQ:0 *-display : VGA compatible controller : Intel Corporation : Intel Corporation  ID: 2   : pci@0000:00:02.0 : 34 : 64 bits : 33MHz : pm msi vga_controller bus_master cap_list rom : driver=i915 latency=0 : IRQ:123 :a0000000-a0ffffff :80000000-9fffffff ioport:f000(=64) :c0000-dffff *-generic:0 : Signal processing controller : Intel Corporation : Intel Corporation  ID: b   : pci@0000:00:0b.0 : 34 : 64 bits : 33MHz : msi pm cap_list : driver=proc_thermal latency=0 : IRQ:129 :a1a3b000-a1a3bfff *-usb : USB controller : Intel Corporation : Intel Corporation  ID: 14   : pci@0000:00:14.0 : 34 : 64 bits : 33MHz : pm msi xhci bus_master cap_list : driver=xhci_hcd latency=0 : IRQ:121 :a1a00000-a1a0ffff *-usbhost:0 : xHCI Host Controller : Linux 4.15.0-rc7-stockmind-gpdpocket xhci-hcd  ID: 0   : usb@1  : usb1 : 4.15 : usb-2.00 : driver=hub slots=7 speed=480Mbit/s *-usb:0 :  : Gaming Keyboard : SINO WEALTH  ID: 2   : usb@1:2 : 1.00 : usb-1.10 : driver=usbhid maxpower=100mA speed=1Mbit/s *-usb:1 :  USB- : BCM2045A0 : Broadcom Corp  ID: 3   : usb@1:3 : 1.12  №: B0F1ECED56A9 : usb-2.00 : driver=btusb maxpower=100mA speed=12Mbit/s *-usbhost:1 : xHCI Host Controller : Linux 4.15.0-rc7-stockmind-gpdpocket xhci-hcd  ID: 1   : usb@2  : usb2 : 4.15 : usb-3.00 : driver=hub slots=6 speed=5000Mbit/s *-generic:1 : Encryption controller : Intel Corporation : Intel Corporation  ID: 1a   : pci@0000:00:1a.0 : 34 : 32 bits : 33MHz : pm msi bus_master cap_list : driver=mei_txe latency=0 : IRQ:130 :a1900000-a19fffff :a1800000-a18fffff *-pci : PCI bridge : Intel Corporation : Intel Corporation  ID: 1c   : pci@0000:00:1c.0 : 34 : 32 bits : 33MHz : pci pciexpress msi pm normal_decode bus_master cap_list : driver=pcieport : IRQ:117 :a1000000-a14fffff *-network :   : BCM4356 802.11ac Wireless Network Adapter : Broadcom Corporation  ID: 0   : pci@0000:01:00.0  : wlp1s0 : 02  №: b0:f1:ec:ed:56:a8 : 64 bits : 33MHz : pm msi pciexpress bus_master cap_list ethernet physical wireless : broadcast=yes driver=brcmfmac driverversion=7.35.180.119 firmware=01-1a5c4016 ip=192.168.1.142 latency=0 multicast=yes wireless=IEEE 802.11 : IRQ:125 :a1400000-a1407fff :a1000000-a13fffff *-isa : ISA bridge : Intel Corporation : Intel Corporation  ID: 1f   : pci@0000:00:1f.0 : 34 : 32 bits : 33MHz : isa bus_master cap_list : driver=lpc_ich latency=0 : IRQ:0</code> </pre> </div></div><br>  lspci： <br><br><div class="spoiler">  <b class="spoiler_title">隐藏文字</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">00:00.0 Host bridge: Intel Corporation Device 2280 (rev 34) 00:02.0 VGA compatible controller: Intel Corporation Device 22b0 (rev 34) 00:0b.0 Signal processing controller: Intel Corporation Device 22dc (rev 34) 00:14.0 USB controller: Intel Corporation Device 22b5 (rev 34) 00:1a.0 Encryption controller: Intel Corporation Device 2298 (rev 34) 00:1c.0 PCI bridge: Intel Corporation Device 22c8 (rev 34) 00:1f.0 ISA bridge: Intel Corporation Device 229c (rev 34) 01:00.0 Network controller: Broadcom Corporation BCM4356 802.11ac Wireless Network Adapter (rev 02)</code> </pre></div></div><br> 建造质量好，不打任何东西，不嘎吱作响，不弯曲。 外壳是铝的，通常，该设备给人一种整体块的印象。 这是一个加号。 <br><br> 但是也有足够的缺点。 光滑的屏幕。 不，它不仅有光泽-实际上是一面镜子。 也就是说，您将在任何非零照度的条件下观察反射。 套件中有保护膜，但不能解决问题。 <br><br> 第二个是键盘。 她很出色的事实。 <br><br> <a href=""><img src="https://habrastorage.org/webt/zx/ac/cf/zxaccfpxwmrrsoxazzhah3yffk0.jpeg"></a> <br><br> 但是如何实现它却是可耻和恐怖的。 尝试破解Macbook，并在按钮之间留出巨大的空隙-嗯，为什么？ 毕竟，目标受众似乎并不是迷人的小猫-他们只是拿下一本ipad或macbook。 没有这些不愉快的间隙，可以将键的大小做得更大。 <br><br>  Fn按钮的层很薄：这是2个用于调整亮度的按钮，分别是F1-F12和Insert。 为什么我们需要第一行？ 它可以实现为单独的层。 <br><br>  Vim用户特别痛苦，并且在ctrl旁边的底行放置了一个冒号。 <br><br> 好的，一切都不好，我们会解决的，因为有一些方法（下面有更多介绍）。 <br><br> 哦，是的，这里有一个跟踪点。 作为经验丰富的ThinkPad用户，对我来说，这让我感到非常温暖。 但是只有一件事：跟踪点位于错误的位置，要使用它，您必须弯曲拇指。 不幸的是，这是无法治愈的。 但是，当然要感谢套件中的其他两个红色帽子。 <br><br> 健康人追踪点： <br><img src="https://habrastorage.org/webt/hl/qp/9_/hlqp9_0jr_ergvl5hklnu3js1l4.jpeg"><br><br> 吸烟者的追踪点： <br><img src="https://habrastorage.org/webt/vm/be/dm/vmbedms-h1ze_4cnu9_vpecgtri.jpeg"><br><br><h2> 在GPD Pocket上安装和配置Linux </h2><br> 显然，“ windows”，尤其是“ windows 10”并不是我在此设备上需要的，只是禁忌的。 <br><br> 由于设备的功能（例如屏幕的方向（向侧面旋转）），无法简单地拿起并安装您喜欢的Debian而不用铃鼓跳舞。 <br><br> <a href=""><img src="https://habrastorage.org/webt/j_/xy/ai/j_xyai5nsa-njzt67cjgkq4joq4.jpeg"></a> <br><br> 原则上，官方网站具有Ubuntu LTS 16.04的官方图像（在我看来，它是稳定Debian的一个很好的替代品），但是在阅读了Internet上的讨论后，决定使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GPD Pocket Ubuntu Respin项目</a> <br><br> 我通常强调，显而易见的事情是，只有在Ubuntu上构建的映像才适合使用并提供脚本，例如Debian，将不起作用： <br><br><pre> <code class="plaintext hljs">$./build.sh debian-9.3.0-amd64-netinst.iso Display setting: Xorg-Standard Looking for kernel image... Extracting kernel files... Archive: gpdpocket-20180115-kernel-files.zip inflating: linux-headers-4.15.0-rc7-stockmind-gpdpocket_4.15.0-rc7-stockmind-gpdpocket-1_amd64.deb inflating: linux-image-4.15.0-rc7-stockmind-gpdpocket_4.15.0-rc7-stockmind-gpdpocket-1_amd64.deb inflating: linux-libc-dev_4.15.0-rc7-stockmind-gpdpocket-1_amd64.deb ./isorespin.sh: 'debian-9.3.0-amd64-netinst.iso' must be an Ubuntu (or Ubuntu flavour), Linux Mint, neon, elementary, BackBox or Peppermint desktop ISO.</code> </pre><br> 在输出中，我们获得linuxium-xubuntu-16.04-desktop-amd64.iso文件，该文件写入USB闪存驱动器： <br><br><pre> <code class="plaintext hljs">#dd if=linuxium-xubuntu-16.04-desktop-amd64.iso of=/dev/sdX</code> </pre> <br> 我们通过设置启动设备从其启动，并在启动时通过Delete按钮进入UEFI设置。 <br><br> 安装过程很简单，我看不到任何分散的意义。 我只注意到最好从实时模式下生成它，因此不会将屏幕转到侧面。 <br><br> 我使用全盘加密，以防设备突然丢失或被盗。 因此，至少，您的所有ssh密钥（是的，我知道密码保护和ssh-agent）以及Internet资源登录都将保持不变。 因此，我将LVM放在LUKS之上，我也希望您能这样做。 <br><br><h2> 纠正曲线 </h2><br><h3> 睡眠和冬眠 </h3><br> 能够将笔记本电脑放在包里，然后在需要之前忘掉它会很好。 幸运的是，尺寸和重量允许。 最好不要每次都手动启动必要的应用程序，而是仅从上次停止的地方继续工作。 <br><br> 睡眠模式似乎是开箱即用的。 它是通过常规方式实现的，即通过systemctl挂起。 但是，根据经验，发现在这种模式下的功耗并不比空闲功耗差很多。 显然，该设备只需熄灭屏幕，网络接口并关闭冷却器即可。 结果，电池将在零天内降落两天。 <br><br> 需要休眠。 常规的systemctl休眠状态无法正常工作：状态已转储到交换区中，但无法在启动时恢复。 <br><br> 我记得有一个项目<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-Userspace Software Suspend</a>及其软件包位于存储库中。 <br><br><pre> <code class="plaintext hljs">#apt install hibernate</code> </pre> <br> 我们检查： <br><br><pre> <code class="plaintext hljs">#hibernate-disk</code> </pre> <br> 瞧，行得通！ 系统转储并关闭。 输入密码LUKS后，已恢复。 但是声音和wifi被覆盖了，屏幕背光的亮度被重置为最大。 我们将完成它。 <br><br><h3> 安装必要的 </h3><br> 在继续配置ACPI之前，您将需要安装几个实用程序。 <br><br> 因此，用于调整屏幕亮度的原因是xbacklight。 <br><br><pre> <code class="plaintext hljs">#apt install xbacklight</code> </pre> <br> 笔记本电脑不是硬盘驱动器，而是闪存驱动器，因此我不想通过交换将其杀死。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ZRam</a>就是这样，我们将在这里使用它。 现在，一切都变得很简单，您无需在rc.local中开出图纸，而只需执行以下操作： <br><br><pre> <code class="plaintext hljs">#apt install zram-config #sudo systemctl enable zram-config.service</code> </pre><br> 脚本本身将计算所需的内存量并进行交换。 <br><br> 正如注释中正确指出的那样，闪存资源不仅耗尽了交换空间，而且还消耗了日志记录。 因此，/ tmp和/ var / log将被放在tmpfs上的ram中。 为此，请在/ etc / fstab中添加两行： <br><br><pre> <code class="plaintext hljs">tmpfs /tmp tmpfs nodev,nosuid,size=256M 0 0 tmpfs /var/log tmpfs nodev,nosuid,size=512M 0 0</code> </pre><br><br><h3> 我们完成了acpi </h3><br> 首先，禁用systemg'shnyh处理程序。 既然它用自己的方法来做所有事情，但是它们是无效的。 座右铭-我们做一切，但做得不好。 例如，还没有学习如何处理电源适配器或耳机，击键等的连接。 <br><br><div class="spoiler">  <b class="spoiler_title">他吃了点零食，但仍然饿了！</b>  <b class="spoiler_title">（4Mb）</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/3g/yu/fa/3gyufa5pfygiidcnl4zw2xxmcxi.gif"></div></div><br>  /etc/systemd/logind.conf <br><br><pre> <code class="plaintext hljs">HandlePowerKey=ignore HandleLidSwitch=ignore</code> </pre><br><pre> <code class="plaintext hljs">#systemctl restart systemd-logind.service</code> </pre> <br>  acpid守护程序负责处理acpi事件，该事件的配置文件突然存储在/ etc / acpi中。 <br><br> 我们将通过按电源按钮使笔记本电脑进入休眠状态。 为此，请编辑以下文件（如果没有，则需要创建）： <br><br>  / etc / acpi /事件/ powerbtn <br><br><pre> <code class="plaintext hljs">event=button[ /]power action=/etc/acpi/hibernate.sh</code> </pre><br>  /etc/acpi/hibernate.sh（带有注释） <br><br><div class="spoiler">  <b class="spoiler_title">隐藏文字</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#!/bin/bash #    ,        LUKS mv /home/user/bin/lock /home/user/bin/nolock # - killall -9 pulseaudio # zram   swap systemctl stop zram-config.service swapon /dev/xubuntu-vg/swap_1 #    DISPLAY=:0.0 su user -c "xbacklight &gt;/tmp/xbl" #    umount -alt nfs4 umount -alt cifs # wpa_supplicant /sbin/wpa_cli suspend hibernate-disk sleep 2 #   DISPLAY=:0.0 su user -c "xbacklight -set `cat /tmp/xbl`" # wpa_supplicant /sbin/wpa_cli resume #  alsa,    . -     /sbin/alsa force-reload #     .  ,      DAC1,            amixer -c 1 set 'DAC1' 90% #    ,        killall i3lock #    mv /home/user/bin/nolock /home/user/bin/lock # zram systemctl start zram-config.service #    swapoff /dev/xubuntu-vg/swap_1</code> </pre></div></div><br> 低电量自动休眠并不容易实现，但非常简单： <br><br><pre> <code class="plaintext hljs">#apt install acpi</code> </pre> <br>  /etc/acpi/ifbatlowgotosleep.sh <br><br><pre> <code class="plaintext hljs">#!/bin/bash level=`/usr/bin/acpi -b|sed '/unava/d'|awk -F\ '{ print $4 }'|sed -e 's/,//' -e's/%//'` if [ "$level" -lt "10" ] then /etc/acpi/hibernate.sh fi</code> </pre><br> 该脚本检查充电状态。 如果小于10％，它将执行上面的休眠脚本。 <br><br> 通过crontab设置定期执行： <br><br><pre> <code class="plaintext hljs">$sudo crontab -e */3 * * * * /etc/acpi/ifbatlowgotosleep.sh 2&gt;/dev/null</code> </pre><br> 以我为例，每3分钟检查一次电池。 <br><br> 如上所述，睡眠模式（systemctl挂起）几乎没有用。 因此，我没有理由在关闭盖子时将其激活。 此外，例如，人们可能希望从口袋里的封闭式笔记本电脑听音乐（这并不是“口袋”）。 <br><br> 因此，我们只是在关闭时关闭屏幕，而在打开时打开屏幕。 <br><br> 删除/ etc / acpi / lidbtn。 <br><br> 我们创建和编辑： <br><br>  / etc / acpi / events / lidclose： <br><br><pre> <code class="plaintext hljs">event=button/lid LID close action=/etc/acpi/lidclose.sh</code> </pre><br>  / etc / acpi / events / lidopen： <br><br><pre> <code class="plaintext hljs">event=button/lid LID open action=/etc/acpi/lidopen.sh</code> </pre><br>  /etc/acpi/lidopen.sh <br><br><pre> <code class="plaintext hljs">DISPLAY=:0.0 su user -c "xrandr --output DSI1 --off"</code> </pre> <br>  /etc/acpi/lidclose.sh <br><br><pre> <code class="plaintext hljs">DISPLAY=:0.0 su user -c "xrandr --output DSI1 --auto --rotate right --dpi 200"</code> </pre> <br> 将DPI值设置为您喜欢的名称，并且user是我的帐户的简单名称（将其更改为您的帐户）。 <br><br><h3> 配置声音和亮度控制键 </h3><br> 我们通过所有相同的acpi事件来执行此操作。 <br><br>  / etc / acpi /事件/ voldown <br><br><pre> <code class="plaintext hljs">event=button[ /]volumedown action=/etc/acpi/volume-down.sh</code> </pre><br>  / etc / acpi /事件/ volup <br><br><pre> <code class="plaintext hljs">event=button[ /]volumeup action=/etc/acpi/volume-up.sh</code> </pre><br>  / etc / acpi /事件/静音 <br><br><pre> <code class="plaintext hljs">event=button[ /]mute action=/etc/acpi/volume-toggle.sh</code> </pre><br> 脚本： <br><br>  /etc/acpi/volume-toggle.sh <br><br><pre> <code class="plaintext hljs">amixer -c 1 set 'Speaker Channel' toggle amixer -c 1 set 'Headphone Channel' toggle</code> </pre><br>  /etc/acpi/volume-up.sh <br><br><pre> <code class="plaintext hljs">amixer -c 1 set 'Headphone' 5%+ amixer -c 1 set 'Speaker' 5%+</code> </pre><br>  /etc/acpi/volume-down.sh <br><br><pre> <code class="plaintext hljs">amixer -c 1 set 'Headphone' 5%- amixer -c 1 set 'Speaker' 5%-</code> </pre><br> 同样的亮度： <br>  / etc / acpi / events / bdown <br><br><pre> <code class="plaintext hljs">event=button[ /]brightnessdown action=/etc/acpi/bdown.sh</code> </pre><br>  / etc / acpi /事件/ bup <br><br><pre> <code class="plaintext hljs">event=button[ /]brightnessup action=/etc/acpi/bup.sh</code> </pre><br>  /etc/acpi/bup.sh <br><br><pre> <code class="plaintext hljs">DISPLAY=:0.0 su user -c "xbacklight -inc 5%"</code> </pre><br>  /etc/acpi/bdown.sh <br><br><pre> <code class="plaintext hljs">DISPLAY=:0.0 su user -c "xbacklight -dec 5%"</code> </pre><br> 让我提醒您，用户是我的帐户名称。 输入您的。 <br><br><h3> 头戴式耳机 </h3><br>  ^ W连接耳机时，独特的Realtek ALC5645芯片无法独立关闭扬声器。 您必须教系统自己如何做。 <br><br>  respin中有这样一个脚本： <br><br><div class="spoiler">  <b class="spoiler_title">隐藏文字</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#!/bin/bash set -e -u if [ "$1" = "jack/headphone" -a "$2" = "HEADPHONE" ]; then case "$3" in plug) sink="[Out] Headphones" ;; *) sink="[Out] Speaker" ;; esac for userdir in /run/user/*; do uid="$(basename $userdir)" user="$(id -un $uid)" if [ -f "$userdir/pulse/pid" ]; then su "$user" -c "pacmd set-sink-port alsa_output.platform-cht-bsw-rt5645.HiFi__hw_chtrt5645__sink $sink" fi done fi</code> </pre></div></div><br> 但这行不通。 尝试通过音频的同步控制进行切换，但失败。 因为： <br><br><pre> <code class="plaintext hljs">$sudo su #su user -c "pacmd set-sink-port alsa_output.platform-cht-bsw-rt5645.HiFi__hw_chtrt5645__sink '[Out] Speaker'"    PulseAudio,        .</code> </pre><br> 解决方案很简单：当客户端尚未调用音频过程时，没有任何联系pacmd。 您当然可以将其启动行添加到rc.local，xinitrc或什至编写一个单独的systemg单元，但是我认为计划自己的拐杖比修理其他拐杖更好。 我想我写了自己的剧本，不那么复杂和复杂。 <br><br>  /etc/acpi/headphone-jack.sh <br><br><pre> <code class="plaintext hljs">#!/bin/bash set -e -u if [ "$3" = "plug" ]; then amixer -c 1 set 'Speaker Channel' mute &gt;/dev/null amixer -c 1 set 'Headphone Channel' unmute &gt;/dev/null else amixer -c 1 set 'Speaker Channel' unmute &gt;/dev/null amixer -c 1 set 'Headphone Channel' mute &gt;/dev/null fi</code> </pre><br><h3> 我们对待布局和其他小东西 </h3><br> 如前所述，布局使我非常恼火。 删除按钮应位于反斜杠和竖杠的位置，最下面一行是冒号，尚不清楚为什么键菜单，选项卡是普通键盘中的转义符所在的位置... <br><br> 通过分析，我不会详细介绍，我只会带来〜/ .xmodmaprc并描述它是如何完成的。 <br><br> 首先，我们需要捕获键码。 这是使用xev程序完成的（#apt install xev，是的）。 运行，按所需的键并获得如下输出： <br><br><pre> <code class="plaintext hljs">KeyPress event, serial 33, synthetic NO, window 0x3200001, root 0x2c0, subw 0x0, time 187713326, (979,493), root:(982,1078), state 0x0, keycode 119 (keysym 0xffff, Delete), same_screen YES, XLookupString gives 1 bytes: (7f) "" XmbLookupString gives 1 bytes: (7f) "" XFilterEvent returns: False</code> </pre><br> 我们需要值“键码119”。 <br><br> 接下来，打开〜/ .xmodmaprc并在其中写入 <br><br><pre> <code class="plaintext hljs">keycode 119 = backslash bar backslash bar</code> </pre> <br> 并且，我们将xmodmap〜/ .xmodmaprc的执行引入您的xinitrc中，或者在您启动自己喜欢的DE或WM时执行的调用。 <br><br> 我的〜/ .xmodmaprc： <br><br><div class="spoiler">  <b class="spoiler_title">隐藏文字</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">pointer = 1 2 3 4 5 remove Lock = Caps_Lock remove Control = Control_L keycode 0x42 = Control_L keycode 135 = Alt_R keycode 0x25 = Super_R keycode 133 = Super_R add Control = Control_L keycode 113 = Left keycode 111 = Up keycode 114 = Right keycode 116 = Down keycode 110 = Home keycode 115 = End keycode 108 = ISO_Next_Group keycode 136 = ISO_First_Group keycode 49 = asciitilde grave asciitilde grave keycode 119 = backslash bar backslash bar keycode 51 = Delete keycode 48 = colon semicolon Cyrillic_zhe Cyrillic_ZHE keycode 47 = apostrophe quotedbl Cyrillic_e Cyrillic_E keycode 130 = XF86Explorer keycode 121 = XF86AudioMute keycode 198 = XF86AudioMicMute keycode 122 = XF86AudioLowerVolume keycode 123 = XF86AudioRaiseVolume keycode 37 = Tab clear mod5 add mod5 = XF86Explorer keycode 166 = Prior keycode 167 = Next</code> </pre></div></div><br> 对于大多数用户而言，它使用了诸如此类的可疑事物：将ctrl转移到caps-lock，将tab转移到ctrl_l，将alt_gr转移到菜单，并将布局切换到旧的altgr位置。 <br><br> 我也使用xcape来模拟ctrl_l上的按一下转义。 这样称呼： <br><br><pre> <code class="plaintext hljs"> xcape -t 1000 -e "Control_L=Escape"</code> </pre> <br> 由于我喜欢在弱光条件下更舒适（我认为，辣根会辩解）的黑暗主题，但通常必须在明亮的日光下工作，因此有一个小技巧：图像的颜色可以反转。 为此，您需要xcalib程序： <br><br><pre> <code class="plaintext hljs">#apt install xcalib</code> </pre> <br> 反转： <br><br><pre> <code class="plaintext hljs">$xcalib -i -a</code> </pre> <br> 您可以使用窗口管理器绑定到任何方便的热键。 我挂在Super_L + Backspace上。 <br><br><h2> 总结 </h2><br> 装置的印象比负面印象更积极。 我不后悔花了钱。 该设备不会在袋子中占用太多空间，它可以放入工装裤和类似烟熏夹克的口袋中。 <br><br> <a href=""><img src="https://habrastorage.org/webt/xz/u5/a2/xzu5a2lnxboqgbrkw8chzh3zlzu.jpeg"></a> <br><br> 它可以用电池长时间工作，在测试中，我滚动了三个半小时的电影，打开了wifi，放了一半电。 通过交流适配器从带有USB-A的摊铺机中充电。 <br><br> 所有遇到的软弯曲素均已成功治疗。 <br><br> 不幸的是，没有rj45端口，但是我希望可以通过带USB的订购适配器来解决。 我认为，在全面监控的情况下，缺乏移动通信和摄像头是一个加号。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN409945/">https://habr.com/ru/post/zh-CN409945/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN409933/index.html">HiSilicon Kirin 970 Android SoC评估-性能和效率</a></li>
<li><a href="../zh-CN409935/index.html">故事“生活高”</a></li>
<li><a href="../zh-CN409937/index.html">胜利与日常生活。 如何在摩天大楼拉赫塔中心上安装尖塔。 第一部分</a></li>
<li><a href="../zh-CN409939/index.html">Bezos如何解决在宣传其智能专栏广告时遇到的意外问题</a></li>
<li><a href="../zh-CN409943/index.html">为什么学校要花更多的时间研究离散数学很重要</a></li>
<li><a href="../zh-CN409947/index.html">超流体宇宙：玻色-爱因斯坦凝聚物的暗物质</a></li>
<li><a href="../zh-CN409949/index.html">大爆炸和通货膨胀</a></li>
<li><a href="../zh-CN409951/index.html">LED面板带WIFI Sonoff BN-SZ01</a></li>
<li><a href="../zh-CN409953/index.html">10分钟内心脏病发作和败血症</a></li>
<li><a href="../zh-CN409955/index.html">特斯拉利用250MW虚拟电站联合南澳大利亚的50,000户贫困房屋</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>