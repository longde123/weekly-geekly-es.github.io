<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçó üöÇ üõ†Ô∏è Amazon Lumberyard: le cri de l'√¢me üîú ‚ûó üë©üèº‚Äçüè≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les jeux sont l'un des logiciels les plus populaires. Il s'agit d'une √©norme industrie dans laquelle un nouveau moteur de jeu - Amazon Lumberyard. Le ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Amazon Lumberyard: le cri de l'√¢me</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/416565/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/94c/9b7/4f0/94c9b74f00eae5bc8d344548dd744585.png"></div><br>  Les jeux sont l'un des logiciels les plus populaires.  Il s'agit d'une √©norme industrie dans laquelle un nouveau moteur de jeu - Amazon Lumberyard.  Le projet est toujours en version b√™ta et il a le temps de corriger les erreurs et d'am√©liorer la qualit√© du code.  Les d√©veloppeurs du moteur ont beaucoup de travail √† faire dans un avenir proche pour ne pas d√©cevoir des millions de joueurs et de d√©veloppeurs de jeux. <br><a name="habracut"></a><br><h2>  Pr√©sentation </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Amazon Lumberyard</a> est un moteur de jeu multiplateforme AAA gratuit d√©velopp√© par Amazon et bas√© sur l'architecture du moteur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CryEngine</a> , qui a √©t√© autoris√© par Crytek en 2015.  Soit dit en passant, l'analyse de CryEngine a d√©j√† √©t√© effectu√©e deux fois par moi en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ao√ªt 2016</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">avril 2017</a> .  En m√™me temps, je dois noter qu'apr√®s un an, le code n'a fait qu'empirer.  Et l'autre jour, j'ai d√©cid√© de voir ce qu'Amazon a fait sur la base de ce moteur de jeu.  Ils ont tr√®s bien travaill√© sur l'environnement.  La documentation pour les d√©veloppeurs et les logiciels pour d√©ployer un environnement de travail est rendue tr√®s cool et √† un niveau √©lev√©.  Mais le probl√®me est √† nouveau avec le code!  J'esp√®re qu'Amazon a beaucoup plus de ressources pour travailler avec le projet, et qu'ils font toujours attention √† la qualit√© du code.  Avec cette revue, j'esp√®re attirer l'attention des d√©veloppeurs sur la qualit√© du code et pousser pour une nouvelle approche dans le d√©veloppement de ce moteur de jeu.  L'√©tat actuel du code √©tait dans un √©tat tellement d√©plorable que j'ai chang√© plusieurs fois le titre de l'article et redessin√© l'image du titre en parcourant le rapport avec les r√©sultats de l'analyse.  La premi√®re version de l'image √©tait moins √©motionnelle: <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e6d/fa3/c02/e6dfa3c02fad5fb4eadd6ca01cd68b62.png"></div><br><br>  Nous avons analys√© les sources d'Amazon Lumberyard de la derni√®re version disponible 1.14.0.1.  Le code source est extrait du r√©f√©rentiel sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Github</a> .  L'un des premiers jeux sur le moteur Lumberyard devrait √™tre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Star Citizen</a> .  Joueuses potentielles qui l'attendent, je vous invite √©galement √† jeter un ≈ìil √† ce qui est actuellement "sous le capot" du jeu. <br><br><h2>  Int√©gration avec PVS-Studio </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PVS-Studio a √©t√©</a> utilis√© comme analyseur de code statique.  Il est disponible pour Windows, Linux et macOS.  C'est-√†-dire  pour l'analyse d'un projet multiplateforme, il y a m√™me quelque chose √† choisir pour un travail plus confortable.  En plus de C et C ++, l'analyse des projets en langage C # est prise en charge.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Plans Java</a> .  La grande majorit√© du code dans le monde est √©crit dans les langues r√©pertori√©es (non sans erreurs, bien s√ªr), alors essayez l'analyseur PVS-Studio sur votre projet, vous apprendrez beaucoup de choses int√©ressantes ;-). <br><br>  En tant que syst√®me d'assemblage Lumberyard, WAF est utilis√©, ce qui √©tait √©galement dans CryEngine.  L'analyseur n'a pas de moyen sp√©cial pour s'int√©grer √† ce syst√®me d'assemblage.  J'ai d√©cid√© de travailler avec un projet sur Windows et j'ai choisi cette m√©thode de d√©marrage de l'analyse: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un syst√®me de surveillance de compilation</a> .  Le fichier de projet pour Visual Studio est g√©n√©r√© automatiquement.  Il peut √™tre utilis√© pour cr√©er le projet et afficher le rapport de l'analyseur. <br><br>  La liste des commandes d'analyse ressemble √† ceci: <br><br><pre><code class="cpp hljs">cd /path/to/lumberyard/dev lmbr_waf.bat ... CLMonitor.exe monitor MSBuild.exe ... LumberyardSDK_vs15.sln ... CLMonitor.exe analyze --<span class="hljs-built_in"><span class="hljs-built_in">log</span></span> /path/to/report.plog</code> </pre> <br>  Comme je l'ai dit, le rapport peut √™tre consult√© dans Visual Studio. <br><br><h2>  √Ä propos d'Igor et de Qualcomm </h2><br>  Amazon Lumberyard se positionne comme un moteur de jeu multiplateforme.  Promouvoir un projet aupr√®s des masses avec une telle fonctionnalit√© est facile, mais le maintenir est tr√®s difficile.  L'un des avertissements de PVS-Studio a √©t√© √©mis sur un fragment de code o√π le programmeur Igor s'est battu avec le compilateur Qualcomm.  Peut-√™tre qu'il a r√©solu son probl√®me, mais a laiss√© un code extr√™mement suspect.  J'ai d√©cid√© de le dessiner avec une photo. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V523</a> L' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">instruction</a> 'then' est √©quivalente √† l'instruction 'else'.  toglsloperand.c 700 <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/933/cc0/610/933cc0610c9968b8c0d1455ffcd4f245.png"></p><br>  Ici, le m√™me code est ex√©cut√©, quelle que soit la condition calcul√©e.  Dans le contexte des commentaires laiss√©s, une telle d√©cision semble suspecte. <br><br>  En g√©n√©ral, le projet n'est pas le seul endroit o√π les conditions doivent √™tre simplifi√©es pour plus de clart√© ou pour corriger une erreur r√©elle.  Voici une liste de ces endroits: <br><br><ul><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  livingentity.cpp 1385 </li><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  tometalinstruction.c 4201 </li><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  scripttable.cpp 905 </li><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  budgetingsystem.cpp 701 </li><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  editorframeworkapplication.cpp 562 </li><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  particuleitem.cpp 130 </li><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  trackviewnodes.cpp 1223 </li><li>  V523 L'instruction 'then' est √©quivalente √† l'instruction 'else'.  propertyoarchive.cpp 447 </li></ul><br><h2>  Python ++ </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/000/30b/8bd/00030b8bd5aa006af7df8c98db5ef66f.png"></div><br><br>  L'analyseur a trouv√© un code aussi amusant: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V709</a> CWE-682 Comparaison suspecte trouv√©e: 'a == b == c'.  N'oubliez pas que ¬´a == b == c¬ª n'est pas √©gal √† ¬´a == b &amp;&amp; b == c¬ª.  toglslinstruction.c 564 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CallBinaryOp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> src1SwizCount = GetNumSwizzleElements(....); <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> src0SwizCount = GetNumSwizzleElements(....); <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> dstSwizCount = GetNumSwizzleElements(....); .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (src1SwizCount == src0SwizCount == dstSwizCount) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { .... } .... }</span></span></code> </pre> <br>  En C ++, un tel code, malheureusement, se compile avec succ√®s, mais il ne s'ex√©cute pas du tout comme cela peut sembler.  Les expressions en C ++ sont √©valu√©es par ordre de priorit√©, ex√©cutant des castes implicites, si n√©cessaire. <br><br>  Une telle v√©rification serait correcte, par exemple, dans le langage Python.  Mais dans cette situation, le d√©veloppeur "s'est tir√© une balle dans le pied". <br><br>  3 autres coups de contr√¥le: <br><br><ul><li>  V709 CWE-682 Comparaison suspecte trouv√©e: 'a == b == c'.  N'oubliez pas que ¬´a == b == c¬ª n'est pas √©gal √† ¬´a == b &amp;&amp; b == c¬ª.  toglslinstruction.c 654 </li><li>  V709 CWE-682 Comparaison suspecte trouv√©e: 'a == b == c'.  N'oubliez pas que ¬´a == b == c¬ª n'est pas √©gal √† ¬´a == b &amp;&amp; b == c¬ª.  toglslinstruction.c 469 </li><li>  V709 CWE-682 Comparaison suspecte trouv√©e: 'a == b == c'.  N'oubliez pas que ¬´a == b == c¬ª n'est pas √©gal √† ¬´a == b &amp;&amp; b == c¬ª.  tometalinstruction.c 539 </li></ul><br><h2>  Le premier et l'un des meilleurs diagnostics </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9e9/03c/f55/9e903cf5512521593ce3a8f226105025.png"></div><br><br>  Il s'agira d'avertissement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V501</a> - les premiers diagnostics √† usage g√©n√©ral dans PVS-Studio.  Les erreurs trouv√©es par ce diagnostic √† elles seules peuvent suffire √† √©crire un article.  Et le projet Amazon Lumberyard le d√©montre tr√®s bien. <br><br>  Malheureusement, il est ennuyeux de regarder les erreurs du m√™me type pendant longtemps, donc dans cette section, je ne commenterai que quelques fragments de code, et le reste des avertissements seront r√©pertori√©s. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V501</a> Il existe des sous-expressions identiques √† gauche et √† droite de '||'  op√©rateur: hotX &lt;0 ||  hotX &lt;0 editorutils.cpp 166 <br><br><pre> <code class="cpp hljs">QCursor CMFCUtils::LoadCursor(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!pm.isNull() &amp;&amp; (hotX &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> || hotX &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>)) { <span class="hljs-function"><span class="hljs-function">QFile </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(path)</span></span></span></span>; f.open(QFile::ReadOnly); <span class="hljs-function"><span class="hljs-function">QDataStream </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stream</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;f)</span></span></span></span>; stream.setByteOrder(QDataStream::LittleEndian); f.read(<span class="hljs-number"><span class="hljs-number">10</span></span>); quint16 x; stream &gt;&gt; x; hotX = x; stream &gt;&gt; x; hotY = x; } .... }</code> </pre> <br>  La condition n'a pas la variable <b><i>Y</i></b> <i>chaud</i> <b><i>.</i></b>  Typo classique. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V501</a> Il existe des sous-expressions identiques 'sp.m_pTexture == m_pTexture' √† gauche et √† droite de l'op√©rateur '&amp;&amp;'.  shadercomponents.h 487 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V501</a> Il existe des sous-expressions identiques ¬´sp.m_eCGTextureType == m_eCGTextureType¬ª √† gauche et √† droite de l'op√©rateur ¬´&amp;&amp;¬ª.  shadercomponents.h 487 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> != (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SCGTexture&amp; sp) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sp.m_RegisterOffset == m_RegisterOffset &amp;&amp; sp.m_Name == m_Name &amp;&amp; sp.m_pTexture == m_pTexture &amp;&amp; <span class="hljs-comment"><span class="hljs-comment">// &lt;= 1 sp.m_RegisterCount == m_RegisterCount &amp;&amp; sp.m_eCGTextureType == m_eCGTextureType &amp;&amp; // &lt;= 2 sp.m_BindingSlot == m_BindingSlot &amp;&amp; sp.m_Flags == m_Flags &amp;&amp; sp.m_pAnimInfo == m_pAnimInfo &amp;&amp; sp.m_pTexture == m_pTexture &amp;&amp; // &lt;= 1 sp.m_eCGTextureType == m_eCGTextureType &amp;&amp; // &lt;= 2 sp.m_bSRGBLookup == m_bSRGBLookup &amp;&amp; sp.m_bGlobal == m_bGlobal) { return false; } return true; }</span></span></code> </pre> <br>  Deux copies-p√¢tes ont √©t√© trouv√©es dans ce fragment √† la fois.  Pour plus de clart√©, j'ai peint des fl√®ches. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V501</a> Il existe des sous-expressions identiques √† gauche et √† droite de l'op√©rateur '==': pSrc.GetLen () == pSrc.GetLen () fbxpropertytypes.h 978 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FbxTypeCopy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FbxBlob&amp; pDst, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> FbxString&amp; pSrc)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> lCastable = pSrc.GetLen() == pSrc.GetLen(); FBX_ASSERT( lCastable ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( lCastable ) pDst.Assign(pSrc.Buffer(), (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)pSrc.GetLen()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lCastable; }</code> </pre> <br>  Ici, je veux dire bonjour aux d√©veloppeurs d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AUTODESK</a> .  Cette erreur provient de leur biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SDK FBX</a> .  Variables confuses <i>pSrc</i> et <i>pDst</i> .  Je pense que, outre Lumberyard, il y a aussi beaucoup d'autres utilisateurs dont les projets d√©pendent du code avec cette erreur. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V501</a> Il existe des sous-expressions identiques √† gauche et √† droite de l'op√©rateur '&amp;&amp;': pTS-&gt; pRT_ALD_1 &amp;&amp; pTS-&gt; pRT_ALD_1 d3d_svo.cpp 857 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> CSvoRenderer::ConeTracePass(SSvoTargetsSet* pTS) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pTS-&gt;pRT_ALD_1 &amp;&amp; pTS-&gt;pRT_ALD_1) { <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> nPrevWidth = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { pTS-&gt;pRT_ALD_1-&gt;Apply(<span class="hljs-number"><span class="hljs-number">10</span></span>, m_nTexStateLinear); pTS-&gt;pRT_RGB_1-&gt;Apply(<span class="hljs-number"><span class="hljs-number">11</span></span>, m_nTexStateLinear); } } .... }</code> </pre> <br>  Revenons au code Lumberyard.  Dans la condition, le m√™me pointeur <i>pTS-&gt; pRT_ALD_1 est v√©rifi√©</i> .  L'un d'eux aurait d√ª √™tre <i>pTS-&gt; pRT_RGB_1</i> .  Peut-√™tre m√™me apr√®s l'explication, il n'est pas imm√©diatement possible de voir la diff√©rence, mais il y en a une: la diff√©rence est dans les sous-cha√Ænes courtes <i>ALD</i> et <i>RGB</i> .  Si on vous dit que la r√©vision manuelle du code est suffisante, montrez cet exemple. <br><br>  Et si cet exemple ne suffit pas, il y en a 5 de plus similaires. <br><ul><li>  V501 Il existe des sous-expressions identiques √† gauche et √† droite de '||'  op√©rateur:! pTS-&gt; pRT_ALD_0 ||! pTS-&gt; pRT_ALD_0 d3d_svo.cpp 1041 </li><li>  V501 Il existe des sous-expressions identiques √† gauche et √† droite de l'op√©rateur '&amp;&amp;': m_pRT_AIR_MIN &amp;&amp; m_pRT_AIR_MIN d3d_svo.cpp 1808 </li><li>  V501 Il existe des sous-expressions identiques √† gauche et √† droite de l'op√©rateur '&amp;&amp;': m_pRT_AIR_MAX &amp;&amp; m_pRT_AIR_MAX d3d_svo.cpp 1819 </li><li>  V501 Il existe des sous-expressions identiques √† gauche et √† droite de l'op√©rateur '&amp;&amp;': m_pRT_AIR_SHAD &amp;&amp; m_pRT_AIR_SHAD d3d_svo.cpp 1830 </li><li>  V501 Il existe des sous-expressions identiques √† gauche et √† droite de l'op√©rateur '&amp;&amp;': s_pPropertiesPanel &amp;&amp; s_pPropertiesPanel entityobject.cpp 1700 </li></ul><br>  Et comme je l'ai promis, voici une liste des avertissements <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V501</a> restants sans exemples de code: <div class="spoiler">  <b class="spoiler_title">D√©velopper la liste</b> <div class="spoiler_text"><ul><li>  V501 Il existe des sous-expressions identiques ¬´MaxX &lt;0¬ª √† gauche et √† droite de ¬´||¬ª  op√©rateur.  czbufferculler.h 128 </li><li>  V501 Il existe des sous-expressions identiques ¬´m_joints [op [1]]. Limites [1] [i]¬ª √† gauche et √† droite de l'op√©rateur ¬´-¬ª.  articulatedentity.cpp 795 </li><li>  V501 Il existe des sous-expressions identiques ¬´m_joints [i] .limits [1] [j]¬ª √† gauche et √† droite de l'op√©rateur ¬´-¬ª.  articulatedentity.cpp 2044 </li><li>  V501 Il existe des sous-expressions identiques ¬´irect [0] .x + 1 - irect [1] .x &gt;&gt; 31¬ª √† gauche et √† droite de ¬´|¬ª  op√©rateur.  trimesh.cpp 4029 </li><li>  V501 Il existe des sous-expressions identiques ¬´b-&gt; mlen &lt;= 0¬ª √† gauche et √† droite de ¬´||¬ª  op√©rateur.  bstrlib.c 1779 </li><li>  V501 Il existe des sous-expressions identiques ¬´b-&gt; mlen &lt;= 0¬ª √† gauche et √† droite de ¬´||¬ª  op√©rateur.  bstrlib.c 1827 </li><li>  V501 Il existe des sous-expressions identiques ¬´b-&gt; mlen &lt;= 0¬ª √† gauche et √† droite de ¬´||¬ª  op√©rateur.  bstrlib.c 1865 </li><li>  V501 Il existe des sous-expressions identiques ¬´b-&gt; mlen &lt;= 0¬ª √† gauche et √† droite de ¬´||¬ª  op√©rateur.  bstrlib.c 1779 </li><li>  V501 Il existe des sous-expressions identiques ¬´b-&gt; mlen &lt;= 0¬ª √† gauche et √† droite de ¬´||¬ª  op√©rateur.  bstrlib.c 1827 </li><li>  V501 Il existe des sous-expressions identiques ¬´b-&gt; mlen &lt;= 0¬ª √† gauche et √† droite de ¬´||¬ª  op√©rateur.  bstrlib.c 1865 </li><li>  V501 Il existe des sous-expressions identiques √† gauche et √† droite de l'op√©rateur '-': dd - dd finalizingspline.h 669 </li><li>  V501 Il existe des sous-expressions identiques 'pVerts [2] - pVerts [3]' √† gauche et √† droite de l'op√©rateur '^'.  roadrendernode.cpp 307 </li><li>  V501 Il existe des sous-expressions identiques '! PGroup-&gt; GetStatObj ()' √† gauche et √† droite de '||'  op√©rateur.  terrain_node.cpp 594 </li><li>  V501 Il existe des sous-expressions identiques √† gauche et √† droite de '||'  op√©rateur: val == 0 ||  val == - 0 xmlcpb_attrwriter.cpp 367 </li><li>  V501 Il existe des sous-expressions identiques 'geom_colltype_solid' √† gauche et √† droite de '|'  op√©rateur.  attachmentmanager.cpp 1058 </li><li>  V501 Il existe des sous-expressions identiques '(TriMiddle - RMWPosition)' √† gauche et √† droite de '|'  op√©rateur.  modelmesh.cpp 174 </li><li>  V501 Il existe des sous-expressions identiques '(objectif - pAbsPose [b3] .t)' √† gauche et √† droite du '|'  op√©rateur.  posemodifierhelper.cpp 115 </li><li>  V501 Il existe des sous-expressions identiques '(objectif - pAbsPose [b4] .t)' √† gauche et √† droite du '|'  op√©rateur.  posemodifierhelper.cpp 242 </li><li>  V501 Il existe des sous-expressions identiques '(m_eTFSrc == eTF_BC6UH)' √† gauche et √† droite de '||'  op√©rateur.  texturestreaming.cpp 983 </li><li>  V501 Il existe des sous-expressions identiques √† gauche et √† droite de l'op√©rateur '-': q2.vz - q2.vz azentitynode.cpp 102 </li><li>  V501 Il existe des sous-expressions identiques √† gauche et √† droite de l'op√©rateur '-': q2.vz - q2.vz entitynode.cpp 107 </li><li>  V501 Il existe des sous-expressions identiques ¬´m_listRect.contains (event-&gt; pos ())¬ª √† gauche et √† droite de ¬´||¬ª  op√©rateur.  aidebuggerview.cpp 463 </li><li>  V501 Il existe des sous-expressions identiques √† gauche et √† droite de l'op√©rateur '&amp;&amp;': pObj-&gt; GetParent () &amp;&amp; pObj-&gt; GetParent () designerpanel.cpp 253 </li></ul></div></div><br><h2>  √Ä propos de la position de la cam√©ra dans les jeux </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/564/587/079/5645870792e812044ad7bd3df6fdd2f0.png"></div><br><br>  Il existe le deuxi√®me diagnostic le plus rapide dans PVS-Studio - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V502</a> .  Ce diagnostic est plus ancien que certains nouveaux langages de programmation, dans lesquels une telle erreur ne peut plus √™tre faite.  Et pour C ++, cette erreur sera pertinente, peut-√™tre toujours. <br><br>  Commen√ßons par un petit exemple simple. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V502</a> L'op√©rateur '?:' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Fonctionne</a> peut-√™tre d'une mani√®re diff√©rente de celle attendue.  L'op√©rateur '?:' A une priorit√© inf√©rieure √† l'op√©rateur '+'.  zipencryptor.cpp 217 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> ZipEncryptor::ParseKey(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> pos = i * <span class="hljs-number"><span class="hljs-number">2</span></span> + (v1 == <span class="hljs-number"><span class="hljs-number">0xff</span></span>) ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">2</span></span>; RCLogError(<span class="hljs-string"><span class="hljs-string">"...."</span></span>, pos); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; .... }</code> </pre> <br>  L'op√©ration d'addition a une priorit√© plus √©lev√©e que l'op√©rateur ternaire.  Par cons√©quent, cette expression a une logique de calcul compl√®tement diff√©rente de celle suppos√©e par l'auteur. <br><br>  Vous pouvez corriger l'erreur de cette fa√ßon: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> pos = i * <span class="hljs-number"><span class="hljs-number">2</span></span> + (v1 == <span class="hljs-number"><span class="hljs-number">0xff</span></span> ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">2</span></span>);</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V502</a> L'op√©rateur '?:' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Fonctionne</a> peut-√™tre d'une mani√®re diff√©rente de celle attendue.  L'op√©rateur '?:' A une priorit√© inf√©rieure √† l'op√©rateur '-'.  3dengine.cpp 1898 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> C3DEngine::GetDistanceToSectorWithWater() { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (bCameraInTerrainBounds &amp;&amp; (m_pTerrain &amp;&amp; m_pTerrain-&gt;GetDistanceToSectorWithWater() &gt; <span class="hljs-number"><span class="hljs-number">0.1f</span></span>)) ? m_pTerrain-&gt;GetDistanceToSectorWithWater() : max(camPostion.z - OceanToggle::IsActive() ? OceanRequest::GetOceanLevel() : GetWaterLevel(), <span class="hljs-number"><span class="hljs-number">0.1f</span></span>); }</code> </pre> <br>  Et voici un exemple de code o√π ils travaillent avec la position de la cam√©ra.  Un exemple est difficile √† percevoir avec les yeux et contient une erreur.  Pour la publication, la mise en forme du code a √©t√© modifi√©e, mais dans le fichier source, ce code est encore plus illisible. <br><br>  Une erreur est pr√©sente dans cette sous-cha√Æne: <br><br><pre> <code class="cpp hljs">camPostion.z - OceanToggle::IsActive() ? .... : ....</code> </pre> <br>  Si la cam√©ra de votre jeu a soudainement commenc√© √† se comporter de mani√®re inappropri√©e, vous devez savoir que les d√©veloppeurs ont √©conomis√© sur l'analyse de code statique: D. <br><br>  Autres exemples avec des avertissements similaires: <br><br><ul><li>  V502 L'op√©rateur '?:' Fonctionne peut-√™tre d'une mani√®re diff√©rente de celle attendue.  L'op√©rateur '?:' A une priorit√© inf√©rieure √† l'op√©rateur '-'.  scriptbind_ai.cpp 5203 </li><li>  V502 L'op√©rateur '?:' Fonctionne peut-√™tre d'une mani√®re diff√©rente de celle attendue.  L'op√©rateur '?:' A une priorit√© inf√©rieure √† l'op√©rateur '+'.  qcolumnwidget.cpp 136 </li><li>  V502 L'op√©rateur '?:' Fonctionne peut-√™tre d'une mani√®re diff√©rente de celle attendue.  L'op√©rateur '?:' A une priorit√© plus faible que l'op√©rateur '&amp;&amp;'.  shapetool.h 98 </li></ul><br><h2>  CryEngine Legacy </h2><br>  Amazon Lumberyard est bas√© sur le code <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CryEngine</a> .  Et pas sur sa meilleure version.  J'ai fait une telle conclusion en regardant le rapport de l'analyseur.  Certains bogues trouv√©s ont d√©j√† √©t√© corrig√©s dans la derni√®re version de CryEngine pour mes deux revues de code, mais sont toujours pr√©sents dans le code Lumberyard.  De plus, au cours de la derni√®re ann√©e, l'analyseur a √©t√© consid√©rablement am√©lior√© et il a √©t√© possible de trouver des erreurs suppl√©mentaires qui sont maintenant pr√©sentes dans deux moteurs de jeu.  Mais avec Lumberyard la situation est pire.  Amazon a essentiellement h√©rit√© de la totalit√© de la dette technique de CryEngine.  Mais son propre devoir technique, bien s√ªr, appara√Æt dans chaque entreprise de son propre chef :). <br><br>  Dans cette section, je vais vous donner quelques erreurs qui ont √©t√© corrig√©es dans la derni√®re version de CryEngine, et qui ne restent maintenant qu'un probl√®me du projet Lumberyard. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V519</a> La <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">variable</a> 'BlendFactor [2]' re√ßoit des valeurs successives deux fois.  C'est peut-√™tre une erreur.  V√©rifiez les lignes: 1283, 1284. ccrydxgldevicecontext.cpp 1284 <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/659/fb5/4bb/659fb54bb651df9abf4568dec3b76bf4.png"></div><br><br>  De telles √©motions seront ressenties par les d√©veloppeurs de Lumberyard lorsqu'ils d√©couvriront que cette erreur n'est rest√©e qu'en eux. <br><br>  Soit dit en passant, il y en a deux autres: <br><br><ul><li>  V519 La variable 'm_auBlendFactor [2]' se voit attribuer des valeurs deux fois de suite.  C'est peut-√™tre une erreur.  V√©rifiez les lignes: 919, 920. ccrydxgldevicecontext.cpp 920 </li><li>  V519 La variable 'm_auBlendFactor [2]' se voit attribuer des valeurs deux fois de suite.  C'est peut-√™tre une erreur.  V√©rifiez les lignes: 926, 927. ccrydxgldevicecontext.cpp 927 </li></ul><br>  Il y a une telle erreur: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V546 Le</a> membre d'une classe est initialis√© par lui-m√™me: 'eConfigMax (eConfigMax.VeryHigh)'.  particulesparams.h 1837 <br><br><pre> <code class="cpp hljs">ParticleParams() : .... fSphericalApproximation(<span class="hljs-number"><span class="hljs-number">1.f</span></span>), fVolumeThickness(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>), fSoundFXParam(<span class="hljs-number"><span class="hljs-number">1.f</span></span>), eConfigMax(eConfigMax.VeryHigh), <span class="hljs-comment"><span class="hljs-comment">// &lt;= fFadeAtViewCosAngle(0.f) {}</span></span></code> </pre> <br>  Dans CryEngine, cette classe √©tait g√©n√©ralement r√©√©crite, mais ici l'erreur d'initialisation est rest√©e. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V521</a> De telles expressions utilisant l'op√©rateur ',' sont dangereuses.  Assurez-vous que l'expression ¬´! SWords [iWord] .empty (), iWord ++¬ª est correcte.  tacticalpointsystem.cpp 3376 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> CTacticalPointSystem::Parse(....) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sInput</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sSpec)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> MAXWORDS = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> sWords[MAXWORDS]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> iC = <span class="hljs-number"><span class="hljs-number">0</span></span>, iWord = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (; iWord &lt; MAXWORDS; !sWords[iWord].empty(), iWord++) { sWords[iWord] = sInput.Tokenize(<span class="hljs-string"><span class="hljs-string">"_"</span></span>, iC); } .... }</code> </pre> <br>  Le cycle suspect que CryEngine a √©galement r√©√©crit. <br><br><h2>  Les erreurs vivent plus longtemps que vous ne le pensez </h2><br>  Les utilisateurs qui commencent √† utiliser PVS-Studio pour la premi√®re fois ont une situation √† peu pr√®s identique: ils trouvent une erreur, d√©couvrent qu'elle a √©t√© ajout√©e il y a plusieurs mois et sont heureux de r√©aliser qu'ils ont miraculeusement √©vit√© la manifestation du probl√®me chez leurs utilisateurs.  Beaucoup de nos clients ont commenc√© √† utiliser r√©guli√®rement PVS-Studio pr√©cis√©ment apr√®s de telles histoires. <br><br>  Parfois, afin de d√©marrer des processus de contr√¥le de la qualit√© du code, une entreprise doit visiter de telles situations plusieurs fois.  Voici un exemple sur CryEngine et Lumberyard: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V557</a> CWE-119 Le d√©passement de matrice est possible.  L'index 'id' pointe au-del√† de la limite du tableau.  gameobjectsystem.cpp 113 <br><br><pre> <code class="cpp hljs">uint32 CGameObjectSystem::GetExtensionSerializationPriority(....) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (id &gt; m_extensionInfo.size()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0xffffffff</span></span>; <span class="hljs-comment"><span class="hljs-comment">// minimum possible priority } else { return m_extensionInfo[id].serializationPriority; } }</span></span></code> </pre> <br>  Comme vous le savez, Amazon Lumberyard n'est pas bas√© sur la derni√®re version de CryEngine.  N√©anmoins, √† l'aide de l'analyseur PVS-Studio, il a √©t√© possible de trouver une erreur qui est maintenant pr√©sente dans deux moteurs de jeu.  Il fallait v√©rifier l'index √† l'aide de l'op√©rateur '&gt; =' ... <br><br>  L'erreur d'indexation est grave.  De plus, il y en a <b>six!</b>  Voici un autre exemple: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V557</a> CWE-119 Le d√©passement de matrice est possible.  L'index ¬´index¬ª pointe au-del√† de la limite du tableau.  vehicleseatgroup.cpp 73 <br><br><pre> <code class="cpp hljs">CVehicleSeat* CVehicleSeatGroup::GetSeatByIndex(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> index) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (index &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; index &lt;= m_seats.size()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> m_seats[index]; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; }</code> </pre> <br>  Quelqu'un a fait des erreurs du m√™me type, et elles n'ont pas √©t√© corrig√©es simplement parce qu'elles n'avaient pas √©t√© incluses une fois dans les critiques de bogues de CryEngine. <br><br>  Avertissements restants: <br><br><ul><li>  V557 CWE-119 Le d√©passement de matrice est possible.  L'index 'id' pointe au-del√† de la limite du tableau.  gameobjectsystem.cpp 195 </li><li>  V557 CWE-119 Le d√©passement de matrice est possible.  L'index 'id' pointe au-del√† de la limite du tableau.  gameobjectsystem.cpp 290 </li><li>  V557 CWE-119 Le d√©passement de matrice est possible.  L'index ¬´stateId¬ª pointe au-del√† de la limite du tableau.  vehicleanimation.cpp 311 </li><li>  V557 CWE-119 Le d√©passement de matrice est possible.  L'index ¬´stateId¬ª pointe au-del√† de la limite du tableau.  vehicleanimation.cpp 354 </li></ul><br>  La longue existence d'erreurs dans le code ne peut √™tre expliqu√©e que par le niveau correspondant de test de projet.  On pense que l'analyse statique ne trouve des erreurs que dans le code inutilis√©.  Ce n'est donc pas le cas.  Les d√©veloppeurs oublient que la plupart des utilisateurs souffrent silencieusement de bogues non √©vidents dans les programmes, et la manifestation de ces bogues tr√®s rares affecte souvent le travail de toute l'entreprise, sa r√©putation et ses ventes, le cas √©ch√©ant. <br><br><h2>  Diff√©rentes nuances de programmation par copier-coller </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b7b/18c/0d2/b7b18c0d2641836736a2bde2d19ba5ba.png"></div><br><br>  Lorsque vous avez atteint cette section de l'article, vous avez probablement remarqu√© que la programmation de copier-coller est la cause de nombreux probl√®mes.  Dans PVS-Studio, la recherche de ces erreurs est impl√©ment√©e dans divers diagnostics.  Cette section donne des exemples de copier-coller trouv√©s avec le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V561</a> . <br><br>  Voici un exemple de code suspect lors de la d√©claration de variables portant le m√™me nom dans des √©tendues qui se chevauchent. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V561</a> CWE-563 Il est probablement pr√©f√©rable d'attribuer une valeur √† la variable 'pLibrary' que de la d√©clarer √† nouveau.  D√©claration pr√©c√©dente: entityobject.cpp, ligne 4703. entityobject.cpp 4706 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> CEntityObject::OnMenuConvertToPrefab() { .... IDataBaseLibrary* pLibrary = GetIEditor()-&gt;Get....; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pLibrary == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { IDataBaseLibrary* pLibrary = GetIEditor()-&gt;Get....; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pLibrary == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { QString sError = tr(....); CryMessageBox(....); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } .... }</code> </pre> <br>  Le pointeur pLibrary ne remplace pas comme pr√©vu.  L'initialisation de ce pointeur a √©t√© compl√®tement copi√©e sous la condition avec la d√©claration de type. <br><br>  Je vais lister tous les endroits similaires: <br><br><ul><li>  V561 CWE-563 Il est probablement pr√©f√©rable d'attribuer une valeur √† la variable 'eType' que de la d√©clarer √† nouveau.  D√©claration pr√©c√©dente: toglsloperand.c, ligne 838. toglsloperand.c 1224 </li><li>  V561 CWE-563 Il est probablement pr√©f√©rable d'attribuer une valeur √† la variable 'eType' que de la d√©clarer √† nouveau.  D√©claration pr√©c√©dente: toglsloperand.c, ligne 838. toglsloperand.c 1305 </li><li>  V561 CWE-563 Il est probablement pr√©f√©rable d'attribuer une valeur √† la variable 'rSkelPose' que de la d√©clarer √† nouveau.  D√©claration pr√©c√©dente: attachmentmanager.cpp, ligne 409. attachmentmanager.cpp 458 </li><li>  V561 CWE-563 Il est probablement pr√©f√©rable d'attribuer une valeur √† la variable 'nThreadID' que de la d√©clarer √† nouveau.  D√©claration pr√©c√©dente: d3dmeshbaker.cpp, ligne 797. d3dmeshbaker.cpp 867 </li><li>  V561 CWE-563 Il vaut probablement mieux attribuer une valeur √† la variable 'directoryNameList' que de la d√©clarer √† nouveau.  D√©claration pr√©c√©dente: assetimportermanager.cpp, ligne 720. assetimportermanager.cpp 728 </li><li>  V561 CWE-563 Il est probablement pr√©f√©rable d'attribuer une valeur √† la variable 'pNode' que de la d√©clarer √† nouveau.  D√©claration pr√©c√©dente: breakpointsctrl.cpp, ligne 340. breakpointsctrl.cpp 349 </li><li>  V561 CWE-563 Il est probablement pr√©f√©rable d'attribuer une valeur √† la variable 'pLibrary' que de la d√©clarer √† nouveau.  D√©claration pr√©c√©dente: prefabobject.cpp, ligne 1443. prefabobject.cpp 1446 </li><li>  V561 CWE-563 Il est probablement pr√©f√©rable d'attribuer une valeur √† la variable 'pLibrary' que de la d√©clarer √† nouveau.  D√©claration pr√©c√©dente: prefabobject.cpp, ligne 1470. prefabobject.cpp 1473 </li><li>  V561 CWE-563 Il est probablement pr√©f√©rable d'attribuer une valeur √† la variable 'cmdLine' que de la d√©clarer √† nouveau.  D√©claration pr√©c√©dente: fileutil.cpp, ligne 110. fileutil.cpp 130 </li><li>  V561 CWE-563 Il vaut probablement mieux attribuer une valeur √† la variable 'sfunctionArgs' que de la d√©clarer √† nouveau.  D√©claration pr√©c√©dente: attributeitemlogiccallbacks.cpp, ligne 291. attributeitemlogiccallbacks.cpp 303 </li><li>  V561 CWE-563 Il est probablement pr√©f√©rable d'attribuer une valeur √† la variable 'curveName' que de la d√©clarer √† nouveau.  D√©claration pr√©c√©dente: qgradientselectorwidget.cpp, ligne 475. qgradientselectorwidget.cpp 488 </li></ul><br>  Une longue liste ... certains des endroits √©num√©r√©s sont m√™me des copies compl√®tes de l'exemple d√©crit. <br><br><h2>  Initialisation des valeurs propres </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/54a/3e3/bff/54a3e3bff4ffeeeb75087c52d644eaa6.png"></div><br><br>  Dans le code du moteur de jeu, de nombreux endroits ont √©t√© trouv√©s o√π la variable est assign√©e √† elle-m√™me.  Quelque part ce code a √©t√© laiss√© pour le d√©bogage, quelque part le code est simplement magnifiquement con√ßu (c'est aussi souvent une source d'erreurs), donc je vais vous donner un morceau de code qui me semble le plus suspect. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V570</a> La variable 'behaviorParams.ignoreOnVehicleDestroyed' est assign√©e √† elle-m√™me.  vehiclecomponent.cpp 168 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> CVehicleComponent::Init(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!damageBehaviorTable.getAttr(....) { behaviorParams.ignoreOnVehicleDestroyed = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { behaviorParams.ignoreOnVehicleDestroyed = <span class="hljs-comment"><span class="hljs-comment">// &lt;= behaviorParams.ignoreOnVehicleDestroyed; // &lt;= } .... }</span></span></code> </pre> <br>  Dans la vue actuelle, la branche <i>else</i> n'est pas du tout n√©cessaire.  Mais peut-√™tre que ce morceau de code contient une erreur: ils voulaient assigner la valeur oppos√©e √† la variable: <br><br><pre> <code class="cpp hljs">bValue = !bValue</code> </pre> <br>  Mais les d√©veloppeurs connaissent mieux les r√©sultats de ce diagnostic. <br><br><h2>  Gestion des probl√®mes </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cef/4fe/a30/cef4fea30182004f3debd9467c1e8d16.png"></div><br><br>  Cette section donne de nombreux exemples en cas de probl√®me lors de la gestion des erreurs. <br><br>  <b>Exemple 1</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V606</a> Jeton sans propri√©taire 'nullptr'.  dx12rootsignature.cpp 599 <br><br><pre> <code class="cpp hljs">RootSignature* RootSignatureCache::AcquireRootSignature(....) { .... RootSignature* result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RootSignature(m_pDevice); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!result-&gt;Init(params)) { DX12_ERROR(<span class="hljs-string"><span class="hljs-string">"Could not create root signature!"</span></span>); <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; } m_RootSignatureMap[hash] = result; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } }</code> </pre> <br>  Oubli√© d'√©crire <i>return nullptr;</i>  .  Maintenant, la valeur non valide de la variable de <i>r√©sultat</i> sera utilis√©e ailleurs dans le code. <br><br>  Le m√™me code exact a √©t√© copi√© dans un autre emplacement: <br><br><ul><li>  V606 Jeton sans propri√©taire 'nullptr'.  dx12rootsignature.cpp 621 </li></ul><br>  <b>Exemple 2</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V606</a> Jeton sans propri√©taire ¬´faux¬ª.  fillspacetool.cpp 191 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> FillSpaceTool::FillHoleBasedOnSelectedElements() { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (validEdgeList.size() == <span class="hljs-number"><span class="hljs-number">2</span></span>) { .... } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (validEdgeList.empty()) { .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, iVertexSize(....); i &lt; iVertexSize; ++i) { validEdgeList.push_back(....); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (validEdgeList.empty()) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { false; // &lt;= fail } std::vector&lt;BrushEdge3D&gt; linkedEdgeList; std::set&lt;int&gt; usedEdgeSet; linkedEdgeList.push_back(validEdgeList[0]); // &lt;= fail .... }</span></span></code> </pre> <br>  Un exemple tr√®s int√©ressant d'une erreur avec une <i>instruction de retour</i> manquante.  Maintenant, une situation d'acc√®s √† un conteneur vide de l'index est possible. <br><br>  <b>Exemple 3</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V564</a> CWE-480 L'op√©rateur '&amp;' est appliqu√© √† la valeur de type bool.  Vous avez probablement oubli√© d'inclure des parenth√®ses ou avez l'intention d'utiliser l'op√©rateur '&amp;&amp;'.  toglslinstruction.c 2914 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetDataTypes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-comment"><span class="hljs-comment">// Check assumption that both the values which MOVC might pick // have the same basic data type. if(!psContext-&gt;flags &amp; HLSLCC_FLAG_AVOID_TEMP_REGISTER_ALIASING) { ASSERT(GetOperandDataType(psContext, &amp;psInst-&gt;asOperands[2]) == GetOperandDataType(psContext, &amp;psInst-&gt;asOperands[3])); } .... }</span></span></code> </pre> <br>  V√©rification incorrecte de la pr√©sence de bits dans l'indicateur.  L'op√©rateur de n√©gation s'applique √† la valeur de l'indicateur, pas √† l'expression enti√®re.  √âcrivez correctement comme ceci: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!(psContext-&gt;flags &amp; ....))</code> </pre> <br>  Avertissements plus similaires: <br><br><ul><li>  V564 CWE-480 Le '|'  L'op√©rateur est appliqu√© √† la valeur de type bool.  Vous avez probablement oubli√© d'inclure des parenth√®ses ou avez l'intention d'utiliser le '||'  op√©rateur.  d3dhwshader.cpp 1832 </li><li>  V564 CWE-480 L'op√©rateur '&amp;' est appliqu√© √† la valeur de type bool.  Vous avez probablement oubli√© d'inclure des parenth√®ses ou avez l'intention d'utiliser l'op√©rateur '&amp;&amp;'.  trackviewdialog.cpp 2112 </li><li>  V564 CWE-480 Le '|'  L'op√©rateur est appliqu√© √† la valeur de type bool.  Vous avez probablement oubli√© d'inclure des parenth√®ses ou avez l'intention d'utiliser le '||'  op√©rateur.  imagecompiler.cpp 1039 </li></ul><br>  <b>Exemple 4</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V596</a> CWE-390 L'objet a √©t√© cr√©√© mais il n'est pas utilis√©.  Le mot cl√© ¬´throw¬ª peut √™tre manquant: throw runtime_error (FOO);  prefabobject.cpp 1491 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt; PyGetPrefabLibrarys() { CPrefabManager* pPrefabManager = GetIEditor()-&gt;GetPrefabMa....; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!pPrefabManager) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::runtime_error(<span class="hljs-string"><span class="hljs-string">"Invalid Prefab Manager."</span></span>); } .... }</code> </pre> <br>  Erreur lors de la lev√©e de l'exception.  Il fallait √©crire comme ceci: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::runtime_error(<span class="hljs-string"><span class="hljs-string">"Invalid Prefab Manager."</span></span>);</code> </pre> <br>  La liste compl√®te de ces erreurs: <br><br><ul><li>  V596 CWE-390 L'objet a √©t√© cr√©√© mais il n'est pas utilis√©.  Le mot cl√© ¬´throw¬ª peut √™tre manquant: throw runtime_error (FOO);  prefabobject.cpp 1515 </li><li>  V596 CWE-390 L'objet a √©t√© cr√©√© mais il n'est pas utilis√©.  Le mot cl√© ¬´throw¬ª peut √™tre manquant: throw runtime_error (FOO);  prefabobject.cpp 1521 </li><li>  V596 CWE-390 L'objet a √©t√© cr√©√© mais il n'est pas utilis√©.  Le mot cl√© ¬´throw¬ª peut √™tre manquant: throw runtime_error (FOO);  prefabobject.cpp 1543 </li><li>  V596 CWE-390 L'objet a √©t√© cr√©√© mais il n'est pas utilis√©.  Le mot cl√© ¬´throw¬ª peut √™tre manquant: throw runtime_error (FOO);  prefabobject.cpp 1549 </li><li>  V596 CWE-390 L'objet a √©t√© cr√©√© mais il n'est pas utilis√©.  Le mot cl√© ¬´throw¬ª peut √™tre manquant: throw runtime_error (FOO);  prefabobject.cpp 1603 </li><li>  V596 CWE-390 L'objet a √©t√© cr√©√© mais il n'est pas utilis√©.  Le mot cl√© ¬´throw¬ª peut √™tre manquant: throw runtime_error (FOO);  prefabobject.cpp 1619 </li><li>  V596 CWE-390 L'objet a √©t√© cr√©√© mais il n'est pas utilis√©.  Le mot cl√© ¬´throw¬ª peut √™tre manquant: throw runtime_error (FOO);  prefabobject.cpp 1644 </li></ul><br><br><h2>  Quelques probl√®mes lors de l'utilisation de la m√©moire </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/521/55f/307/52155f307f3824842c324aa99902796e.png"></div><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V549</a> CWE-688 Le premier argument de la fonction 'memcmp' est √©gal au deuxi√®me argument.  meshutils.h 894 <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VertexLess</span></span></span><span class="hljs-class"> {</span></span> .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m.m_links[a].links.size() != m.m_links[b].links.size()) { res = (m.m_links[a].links.size() &lt; m.m_links[b].links.size()) ? <span class="hljs-number"><span class="hljs-number">-1</span></span> : +<span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { res = <span class="hljs-built_in"><span class="hljs-built_in">memcmp</span></span>(&amp;m.m_links[a].links[<span class="hljs-number"><span class="hljs-number">0</span></span>], &amp;m.m_links[a].links[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(m.m_links[a].links[<span class="hljs-number"><span class="hljs-number">0</span></span>]) * m.m_links[a].links.size()); } .... } .... };</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La condition compare les tailles de deux vecteurs. </font><font style="vertical-align: inherit;">S'ils sont √©gaux, alors dans la branche </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">else</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , les </font><font style="vertical-align: inherit;">valeurs des premiers √©l√©ments des vecteurs sont compar√©es √† l'aide de la fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memcmp ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Mais les premier et deuxi√®me arguments de cette fonction sont les m√™mes! </font><font style="vertical-align: inherit;">L'acc√®s aux √©l√©ments du tableau est assez lourd. </font><font style="vertical-align: inherit;">Il existe des indices </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Tr√®s probablement, une faute de frappe est en eux. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V611</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CWE-762 La m√©moire a √©t√© allou√©e √† l'aide de l'op√©rateur 'new T []' mais a √©t√© lib√©r√©e √† l'aide de l'op√©rateur 'delete'. </font><font style="vertical-align: inherit;">Pensez √† inspecter ce code. </font><font style="vertical-align: inherit;">Il vaut probablement mieux utiliser 'delete [] data;'. </font><font style="vertical-align: inherit;">vectorn.h 102</font></font><br><br><pre> <code class="cpp hljs">~vectorn_tpl() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(flags &amp; mtx_foreign_data)) { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>[] data; } } vectorn_tpl&amp; <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>=(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> vectorn_tpl&lt;ftype&gt;&amp; src) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (src.len != len &amp;&amp; !(flags &amp; mtx_foreign_data)) { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> data; <span class="hljs-comment"><span class="hljs-comment">// &lt;= data = new ftype[src.len]; } .... }</span></span></code> </pre> <br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La m√©moire du</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pointeur de </font><i><font style="vertical-align: inherit;">donn√©es est</font></i><font style="vertical-align: inherit;"> lib√©r√©e avec une instruction non valide. </font><font style="vertical-align: inherit;">L'op√©rateur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">delete []</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> doit √™tre utilis√© </font><i><font style="vertical-align: inherit;">partout</font></i><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Code inaccessible </font></font></h2><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V779</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CWE-561 Code inaccessible d√©tect√©. </font><font style="vertical-align: inherit;">Il est possible qu'une erreur soit pr√©sente. </font><font style="vertical-align: inherit;">fbxskinimporter.cpp 67</font></font><br><br><pre> <code class="cpp hljs">Events::ProcessingResult FbxSkinImporter::ImportSkin(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (BuildSceneMeshFromFbxMesh(....) { context.m_createdData.push_back(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(createdData)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Events::ProcessingResult::Success; <span class="hljs-comment"><span class="hljs-comment">// &lt;= } else { return Events::ProcessingResult::Failure; // &lt;= } context.m_createdData.push_back(); // &lt;= fail return Events::ProcessingResult::Success; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toutes les branches de l'instruction conditionnelle se terminent par la sortie de la fonction. </font><font style="vertical-align: inherit;">Cependant, certains codes ne sont pas ex√©cut√©s. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V779</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CWE-561 Code inaccessible d√©tect√©. </font><font style="vertical-align: inherit;">Il est possible qu'une erreur soit pr√©sente. </font><font style="vertical-align: inherit;">dockablelibrarytreeview.cpp 153</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> DockableLibraryTreeView::Init(IDataBaseLibrary* lib) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_treeView &amp;&amp; m_titleBar &amp;&amp; m_defaultView) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_treeView-&gt;topLevelItemCount() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { ShowTreeView(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ShowDefaultView(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">// &lt;= } else { return false; // &lt;= } emit SignalFocused(this); // &lt;= fail }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est facile de rep√©rer une erreur sur ce morceau de code. </font><font style="vertical-align: inherit;">Mais si vous √©crivez le code pendant une longue p√©riode, l'attention diminue fortement et de telles erreurs tombent facilement dans le projet. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V622</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CWE-478 Envisagez d'inspecter l'instruction 'switch'. </font><font style="vertical-align: inherit;">Il est possible que le premier op√©rateur ¬´case¬ª soit manquant. </font><font style="vertical-align: inherit;">datum.cpp 872</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">AZ_INLINE </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsDataGreaterEqual</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (type.GetType()) { AZ_Error(<span class="hljs-string"><span class="hljs-string">"ScriptCanvas"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"...."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Data::eType::Number: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> IsDataGreaterEqual&lt;Data::NumberType&gt;(lhs, rhs); .... <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Data::eType::AABB: AZ_Error(<span class="hljs-string"><span class="hljs-string">"ScriptCanvas"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"...."</span></span>, Data::Traits&lt;Data::AABBType&gt;::GetName()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Data::eType::OBB: AZ_Error(<span class="hljs-string"><span class="hljs-string">"ScriptCanvas"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"...."</span></span>, Data::Traits&lt;Data::OBBType&gt;::GetName()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commutateur</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contient du code en dehors de l' </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instruction case / default</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il n'est jamais ex√©cut√©.</font></font><br><br><h2>  Conclusion </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'article comprend </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">95</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avertissements d'analyseur, dont 25 avec des exemples de code. Quelle est la quantit√© de mat√©riel de l'ensemble du rapport de l'analyseur? J'ai fait d√©filer rapidement un </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tiers seulement des alertes de haut niveau</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Il existe √©galement Medium et Low, un groupe de diagnostics pour rechercher des optimisations, et d'autres opportunit√©s inexploit√©es de l'analyseur - ce sont des centaines d'erreurs plus √©videntes et des milliers d'avertissements inexplor√©s.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et puis le lecteur doit se poser la question: "Est-il possible avec cette approche du projet de sortir un bon moteur de jeu?". Il n'y a pas de contr√¥le de qualit√© du code. Le code CryEngine avec d'anciennes erreurs a √©t√© pris comme base, de nouvelles erreurs ont √©t√© ajout√©es. CryEngine lui-m√™me n'est finalis√© qu'apr√®s la prochaine r√©vision du code. Amazon a toutes les chances avec ses ressources de travailler dans le sens de la qualit√© du code et de sortir le moteur de jeu le plus cool! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ne soyez pas tr√®s contrari√©. Parmi les clients de PVS-Studio, plus de trente autres soci√©t√©s sont impliqu√©es dans les jeux. Vous pouvez vous familiariser avec eux et leurs produits sur la page de notre site " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clients</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " en s√©lectionnant le filtre "D√©veloppement de jeux". Nous am√©liorons donc progressivement le monde. Nous pouvons peut-√™tre am√©liorer Amazon Lumberyard :).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un coll√®gue a r√©cemment √©crit un article sur le th√®me de la qualit√© des logiciels de jeux vid√©o, je vous sugg√®re de lire: " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyse statique dans l'industrie du jeu vid√©o: les 10 principales erreurs logicielles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lien pour t√©l√©charger l'analyseur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , comment vous en passer ;-)</font></font><br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/ts/z9/km/tsz9kmyjtteajhd4x1au60rsrvq.png" align="left"></a> </p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous souhaitez partager cet article avec un public anglophone, veuillez utiliser le lien vers la traduction: Svyatoslav Razmyslov. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon Lumberyard: un cri d'angoisse</font></font></a> <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avez-vous lu l'article et avez une question?</font></font></b> <div class="spoiler_text">          .      : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">      PVS-Studio,  2015</a> . ,   . </div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr416565/">https://habr.com/ru/post/fr416565/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr416551/index.html">Th√©orie du bonheur. La loi du zeste de past√®que et la normalit√© de l'anomalie</a></li>
<li><a href="../fr416553/index.html">Comment √©voluent les approches du d√©veloppement des terminaux de trading en bourse: 4 tendances 2018</a></li>
<li><a href="../fr416555/index.html">Fil d'actualit√©s: pourquoi faisons-nous cela mal?</a></li>
<li><a href="../fr416557/index.html">GitLab 11.0: Auto DevOps et gestion des licences publi√©s</a></li>
<li><a href="../fr416561/index.html">L'imprimante a v√©cu, l'imprimante est vivante, l'imprimante vivra! Traitement Canon MG7140</a></li>
<li><a href="../fr416569/index.html">Comme Prius, mais uniquement sous Linux: penser √† un bureau hybride</a></li>
<li><a href="../fr416573/index.html">Envoi d'e-mails √† partir de n'importe quelle adresse</a></li>
<li><a href="../fr416575/index.html">Analyse des perturbations de supraconductivit√© des grands aimants collisionneurs de hadrons au CERN</a></li>
<li><a href="../fr416577/index.html">Digest MBLT DEV - frais pour les d√©veloppeurs iOS</a></li>
<li><a href="../fr416579/index.html">Nous contr√¥lons les LED √† l'aide de l'API Web Bluetooth et d'Arduino</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>