<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîä üïõ üì± Analisis Pintu Belakang Outlook Turberg Cybergroup ü¶Ä ü•§ ‚ÜòÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Turla (Snake, Uroboros) adalah kelompok spionase dunia maya yang memperoleh ketenaran pada tahun 2008 setelah meretas benda yang dilindungi, termasuk ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Analisis Pintu Belakang Outlook Turberg Cybergroup</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/421399/"><p>  Turla (Snake, Uroboros) adalah kelompok spionase dunia maya yang memperoleh ketenaran pada tahun 2008 setelah meretas benda yang dilindungi, termasuk jaringan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Komando Pusat Angkatan Bersenjata AS</a> .  Sejak itu, ia berspesialisasi dalam serangan terhadap instalasi militer dan agen diplomatik di seluruh dunia.  Korban terkenal termasuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kementerian Luar Negeri Finlandia</a> pada 2013, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">perusahaan pertahanan Swiss RUAG</a> dari 2014 hingga 2016.  dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pemerintah Jerman</a> pada akhir 2017 - awal 2018. </p><br><p>  Setelah kejadian terakhir, beberapa outlet media menerbitkan informasi tentang metode penyerang - menggunakan lampiran email untuk mengontrol malware dan mentransfer data curian dari sistem.  Namun, tidak ada informasi teknis yang diberikan tentang pintu belakang.  Dalam laporan ini, kami mempublikasikan analisis backdoor Turla, yang dikelola menggunakan lampiran PDF di email. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l_/db/ws/l_dbws8skuoavwqn1vorwdhobgo.jpeg"></div><a name="habracut"></a><br><p>  Menurut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">laporan media</a> , beberapa komputer dari Kementerian Luar Negeri Jerman terinfeksi dengan backdoor.  Rupanya, serangan itu dimulai pada 2016 dan ditemukan oleh dinas keamanan pada akhir 2017. Awalnya, para penyerang berkompromi dengan Sekolah Tinggi Administrasi Publik Federal (Hochschule des Bundes), setelah itu mereka pindah ke dalam jaringannya sampai mereka mendapatkan akses ke jaringan Kementerian Luar Negeri pada Maret 2017. .  Operator Turla memiliki akses ke beberapa data rahasia (misalnya, email karyawan Departemen Luar Negeri Jerman) selama sekitar satu tahun. </p><br><p>  Investigasi kami juga mengungkapkan bahwa malware yang menargetkan Microsoft Outlook ini digunakan terhadap berbagai departemen politik dan militer.  Kami memastikan bahwa kementerian luar negeri dari dua negara Eropa lainnya dan kontraktor pertahanan utama juga dikompromikan.  Penyelidikan kami memungkinkan kami untuk membuat lusinan alamat email yang terdaftar oleh operator Turla untuk kampanye ini dan digunakan untuk mendapatkan data korban yang disaring. </p><br><h2>  1. Poin-poin penting </h2><br><p>  Pintu belakang Outlook Turla Group memiliki dua fungsi. </p><br><p>  Pertama, pencurian surat keluar yang diteruskan ke penyerang.  Sebagian besar memengaruhi Microsoft Outlook, tetapi juga relevan untuk The Bat !, Populer di Eropa Timur. </p><br><p>  Kedua, penggunaan huruf sebagai lapisan transport protokol C&amp;C-nya.  File yang diminta melalui perintah backdoor di-exfiltrasi dalam dokumen PDF yang dibuat khusus sebagai lampiran surat-surat.  Perintah pintu belakang juga dikirim dalam lampiran PDF.  Ini memungkinkan kerahasiaan.  Penting untuk dicatat bahwa penyerang tidak mengeksploitasi kerentanan apa pun di pembaca PDF atau Microsoft Outlook.  Perangkat lunak berbahaya dapat mendekode data dari dokumen PDF dan menafsirkannya sebagai perintah. </p><br><p>  Sasaran kampanye adalah tipikal Turla.  Kami telah mengidentifikasi beberapa agen pemerintah Eropa dan perusahaan pertahanan yang dikompromikan oleh pintu belakang ini.  Kemungkinan penyerang menggunakannya untuk memastikan kegigihan dalam jaringan akses terbatas, di mana firewall yang dikonfigurasi dengan baik atau alat keamanan jaringan lainnya secara efektif memblokir komunikasi tradisional dengan server C&amp;C melalui HTTP (S).  Gambar di bawah mencantumkan baris kode pintu belakang yang menyebutkan beberapa domain tingkat atas pemerintah.  mfa adalah domain dari Kementerian Luar Negeri, .gouv adalah subdomain dari pemerintah Perancis (.gouv.fr), ocse adalah Organisasi untuk Keamanan dan Kerjasama di Eropa. </p><br><img src="https://habrastorage.org/webt/xt/ix/e9/xtixe9vxop-os9ktobaea5qqdbu.png"><br><p>  <i>Gambar 1. Domain yang terkait dengan layanan publik ditemukan dalam kode Malvari</i> </p><br><p>  Berdasarkan analisis dan data telemetri, kami menemukan bahwa pintu belakang ini telah didistribusikan di alam liar setidaknya sejak 2013.  Seperti biasa dengan Turla, kami tidak dapat fokus pada cap waktu kompilasi, karena mereka biasanya dipalsukan.  Namun, kami percaya bahwa versi pertama dikompilasi sebelum 2013, karena versi tahun ini sudah cukup maju.  Setelah itu, kami menemukan versi yang lebih mirip dengan basis, kompilasi yang tertanggal 2009.  Menentukan tanggal rilis yang tepat belum dimungkinkan.  Garis waktu di bawah ini didasarkan pada telemetri dan data kami dari sumber terbuka: </p><br><p>  <b>2009</b> : Kompilasi timestamp (mungkin palsu) dari versi dasar dari backdoor Outlook.  Hanya snapshot dari konten email. <br>  <b>2013</b> : Peningkatan: backdoor dapat menjalankan perintah.  Mereka diemail dalam format XML. <br>  <b>2013</b> : Versi terbaru yang diketahui ditargetkan di The Bat! .. <br>  <b>2016</b> : Peningkatan: tim dikirim sebagai lampiran dalam dokumen PDF yang dibuat khusus. <br>  <b>2017</b> : Ditingkatkan: Pintu belakang dapat membuat dokumen PDF untuk mengekstrak data oleh penyerang. <br>  <b>Maret 2018</b> : Melaporkan kompromi dari jaringan pemerintah Jerman. <br>  <b>April 2018</b> : Peningkatan: Backdoor dapat menjalankan perintah PowerShell menggunakan Empire PSInject. </p><br><h2>  2. Arsitektur global </h2><br><p>  Dalam versi terbaru, backdoor adalah DLL mandiri, di mana ada kode untuk instalasi sendiri dan interaksi dengan Outlook dan The Bat !, klien email, bahkan jika hanya instalasi untuk Outlook yang diterapkan.  Itu dapat dengan mudah dijatuhkan oleh komponen Turla yang memungkinkan Anda untuk melakukan proses tambahan. </p><br><p>  Di bagian ini, analisis kami didasarkan pada sampel yang dirilis pada paruh pertama 2017.  Informasi tentang sampel yang lebih tua atau yang lebih baru dapat dimasukkan. </p><br><h3>  2.1.  Instalasi </h3><br><p>  Untuk membangun backdoor, penyerang mengekspor DLL yang disebut Instal atau daftarkan dengan regsvr32.exe.  Argumennya adalah klien email target.  Gambar di bawah ini menunjukkan nilai yang mungkin.  Di versi terbaru, hanya instalasi untuk Outlook yang diterapkan. </p><br><img src="https://habrastorage.org/webt/9g/8r/qm/9g8rqm3z7keq_phkhvlztwzwtyo.png"><br><p>  <i>Gambar 2. Kemungkinan argumen instalasi</i> </p><br><p>  Karena tidak ada jalur kode keras, file DLL dapat ditemukan di mana saja pada disk. </p><br><h4>  2.1.1.  Microsoft Outlook </h4><br><p>  Pengembang Turla mengandalkan pembajakan objek COM untuk memastikan kegigihan malware.  Ini adalah metode terkenal yang digunakan di alam liar selama bertahun-tahun, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">termasuk oleh kelompok Turla</a> .  Inti dari metode ini adalah untuk mengarahkan kembali objek COM yang digunakan oleh aplikasi target dengan memodifikasi entri CLSID yang sesuai di registri Windows. </p><br><p>  Dalam kasus kami, perubahan berikut telah dibuat untuk registri Windows: </p><br><pre><code class="hljs powershell">HKCU\Software\Classes\CLSID\{<span class="hljs-number"><span class="hljs-number">49</span></span>CBB1C7<span class="hljs-literal"><span class="hljs-literal">-97D1</span></span><span class="hljs-literal"><span class="hljs-literal">-485A</span></span><span class="hljs-literal"><span class="hljs-literal">-9EC1</span></span><span class="hljs-literal"><span class="hljs-literal">-A26065633066</span></span>} = Mail Plugin HKCU\Software\Classes\CLSID\{<span class="hljs-number"><span class="hljs-number">49</span></span>CBB1C7<span class="hljs-literal"><span class="hljs-literal">-97D1</span></span><span class="hljs-literal"><span class="hljs-literal">-485A</span></span><span class="hljs-literal"><span class="hljs-literal">-9EC1</span></span><span class="hljs-literal"><span class="hljs-literal">-A26065633066</span></span>}\InprocServer32 = [<span class="hljs-type"><span class="hljs-type">Path</span></span> <span class="hljs-type"><span class="hljs-type">to</span></span> <span class="hljs-type"><span class="hljs-type">the</span></span> <span class="hljs-type"><span class="hljs-type">backdoor</span></span> <span class="hljs-type"><span class="hljs-type">DLL</span></span>] HKCU\Software\Classes\CLSID\{<span class="hljs-number"><span class="hljs-number">49</span></span>CBB1C7<span class="hljs-literal"><span class="hljs-literal">-97D1</span></span><span class="hljs-literal"><span class="hljs-literal">-485A</span></span><span class="hljs-literal"><span class="hljs-literal">-9EC1</span></span><span class="hljs-literal"><span class="hljs-literal">-A26065633066</span></span>}\InprocServer32\ThreadingModel = Apartment HKCU\Software\Classes\CLSID\{<span class="hljs-number"><span class="hljs-number">84</span></span>DA0A92<span class="hljs-literal"><span class="hljs-literal">-25E0</span></span><span class="hljs-literal"><span class="hljs-literal">-11D3</span></span><span class="hljs-literal"><span class="hljs-literal">-B9F7</span></span><span class="hljs-literal"><span class="hljs-literal">-00C04F4C8F5D</span></span>}\TreatAs = {<span class="hljs-number"><span class="hljs-number">49</span></span>CBB1C7<span class="hljs-literal"><span class="hljs-literal">-97D1</span></span><span class="hljs-literal"><span class="hljs-literal">-485A</span></span><span class="hljs-literal"><span class="hljs-literal">-9EC1</span></span><span class="hljs-literal"><span class="hljs-literal">-A26065633066</span></span>}</code> </pre> <br><p>  <code>{84DA0A92-25E0-11D3-B9F7-00C04F4C8F5D}</code> - ditangkap CLSID.  Ini sesuai dengan Outlook Protocol Manager dan, secara teori, memuat Outlook DLL <code>OLMAPI32.DLL</code> sah.  <code>{49CBB1C7-97D1-485A-9EC1-A26065633066}</code> tidak terkait dengan perangkat lunak yang dikenal.  CLSID ini arbitrer dan hanya digunakan sebagai pengganti untuk pengalihan COM. </p><br><p>  Ketika modifikasi selesai, DLL backdoor akan dimuat setiap kali Outlook memuat objek COM-nya.  Menurut pengamatan kami, ini terjadi selama startup Outlook. </p><br><p>  Pengalihan COM tidak memerlukan hak administrator, karena hanya berlaku untuk pengguna saat ini.  Langkah-langkah perlindungan dilakukan untuk mencegah pengalihan berbahaya tersebut.  Menurut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">MSDN</a> : "Dengan Windows Vista dan Windows Server 2008, jika tingkat integritas proses di atas rata-rata, runtime COM mengabaikan konfigurasi COM pengguna dan hanya mengakses konfigurasi COM untuk setiap mesin." </p><br><p>  Proses Outlook berjalan pada integritas sedang, seperti yang ditunjukkan pada gambar di bawah ini.  Dengan demikian, itu tidak dilindungi dari penerusan COM untuk setiap pengguna. </p><br><img src="https://habrastorage.org/webt/q4/uq/zt/q4uqzt_g3c6vgonoluf_7ttrqpw.png"><br><p>  <i>Gambar 3. Tingkat integritas proses Outlook</i> </p><br><p>  Akhirnya, menggunakan penangkapan objek COM memungkinkan pintu belakang untuk menghindari deteksi, karena jalur ke pintu belakang ( <code>C:\Users\User\Documents\mapid.tlb</code> dalam contoh kami) tidak muncul dalam daftar plugin, seperti yang ditunjukkan pada gambar berikut. </p><br><img src="https://habrastorage.org/webt/4l/cj/s3/4lcjs3tai1gd5gopfekwd7skjra.png"><br><p>  <i>Gambar 4. Daftar plugins Outlook - mapid.tlb tidak muncul</i> </p><br><p>  Bahkan jika program jahat tidak muncul dalam daftar add-on, standar Microsoft API - MAPI (Messaging Application Programming Interface) digunakan untuk berinteraksi dengan Outlook. </p><br><h4>  2.1.2.  Kelelawar! </h4><br><p>  Seperti yang ditentukan dalam kronologi, versi terbaru dari pintu belakang tidak lagi menyertakan kode registrasi untuk plugin The Bat! .. Namun, semua kode untuk mengelola kotak surat dan pesan masih ada.  Jika perlu, dapat dikonfigurasi secara manual. </p><br><p>  Untuk mendaftar sebagai plugin untuk The Bat!  malware memodifikasi file <code>%appdata%\The Bat!\Mail\TBPlugin.INI</code> .  Ini adalah cara yang sah untuk mendaftarkan plugin untuk The Bat !, beberapa plugin (misalnya, antispam) juga menggunakannya. </p><br><p>  Setelah mendaftar setiap kali Anda memulai The Bat!  DLL backdoor disebut.  Gambar di bawah ini menunjukkan bagaimana DLL mengimplementasikan ekspor yang diperlukan untuk plugin. </p><br><img src="https://habrastorage.org/webt/xq/x7/zs/xqx7zsv5pwjjmhonegcsmpmnwx0.png"><br><p>  <i>Gambar 5. Ekspor standar untuk The Bat! Plugin</i> </p><br><h3>  2.2.  Interaksi dengan klien email </h3><br><p>  Interaksi dengan klien surat tergantung pada tujuannya. </p><br><h4>  2.2.1.  Microsoft Outlook </h4><br><p>  Microsoft mendukung Antarmuka Pemrograman Aplikasi Pesan (MAPI), yang memungkinkan aplikasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">berinteraksi dengan Outlook</a> .  Backdoor Turla menggunakan API ini untuk mengakses dan mengelola kotak surat pengguna / pengguna sistem yang disusupi. </p><br><p>  Pertama, pintu belakang terhubung ke sistem pesan menggunakan MAPILogonEx, seperti yang ditunjukkan pada gambar. </p><br><img src="https://habrastorage.org/webt/nf/fp/u1/nffpu1duhw9u7rmxytdm1chwpey.png"><br><p>  <i>Gambar 6. Log masuk MAPI</i> </p><br><p>  Parameter kedua (lpszProfileName) kosong, bendera <code>MAPI_USE_DEFAULT</code> .  Menurut dokumentasi: "Subsistem perpesanan harus mengganti nama profil default untuk parameter lpszProfileName. Bendera <code>MAPI_EXPLICIT_PROFILE</code> diabaikan kecuali lpszProfileName NULL atau kosong." </p><br><p>  Sebaliknya, bendera <code>MAPI_NEW_SESSION</code> tidak disetel.  Menurut dokumentasi: "Parameter <code>lpszProfileName</code> diabaikan jika sesi sebelumnya bernama MapiLogonEx ada dengan flag <code>MAPI_ALLOW_OTHERS</code> dan jika flag <code>MAPI_NEW_SESSION</code> tidak disetel." </p><br><p>  Menurut pendapat kami, Outlook membuka sesi default dengan bendera <code>MAPI_ALLOW_OTHERS</code> .  Dengan demikian, pintu belakang akan menggunakan sesi yang sebelumnya dibuka untuk mendapatkan akses ke profil default kotak surat.  Ini menjelaskan kurangnya permintaan nama pengguna dan kata sandi saat menginisialisasi plugin backdoor. </p><br><p>  Setelah melakukan ini, pintu belakang akan mendapatkan akses ke kotak surat dan akan dapat dengan mudah mengelolanya menggunakan fungsi MAPI lainnya.  Itu akan berulang melalui berbagai penyimpanan pesan, parse surat, dan menambahkan panggilan balik ke pesan masuk dan keluar.  File log menampilkan proses ini (nama pengguna dan alamat diubah): </p><br><pre> <code class="hljs pgsql">&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; ========= Analyzing msg store ( <span class="hljs-number"><span class="hljs-number">1</span></span> / <span class="hljs-number"><span class="hljs-number">1</span></span> ) ========= Service <span class="hljs-type"><span class="hljs-type">name</span></span>:MSUPST MS Pst <span class="hljs-type"><span class="hljs-type">path</span></span>:C:\Users\[username]\Documents\Outlook Files\[email address].pst Wait main <span class="hljs-keyword"><span class="hljs-keyword">window</span></span> <span class="hljs-keyword"><span class="hljs-keyword">before</span></span> <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> store <span class="hljs-keyword"><span class="hljs-keyword">Loop</span></span> count = <span class="hljs-number"><span class="hljs-number">46</span></span> This <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> message store PUSH store <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> list &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; _____________ FOLDERS _____________ Setting sink <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> folders <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> stores. ========Process msg store ( <span class="hljs-number"><span class="hljs-number">1</span></span> / <span class="hljs-number"><span class="hljs-number">1</span></span> ) ========= Account: [email address] Successfull <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> sink <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> Outbox folder <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> store. Successfull <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> sink <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> Inbox folder <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> store.</code> </pre> <br><p>  Ini mengatur panggilan balik di setiap kotak masuk dan <code>HrAllocAdviseSink</code> menggunakan fungsi <code>HrAllocAdviseSink</code> , seperti yang ditunjukkan. </p><br><img src="https://habrastorage.org/webt/ud/df/js/uddfjs5ub7qj9n3gxlxslirppcq.png"><br><p>  <i>Gambar 7. Mendaftarkan panggilan balik di Kotak keluar</i> </p><br><p>  <b>2.2.1.1.</b>  <b>Kotak masuk panggilan balik</b> </p><br><p>  Callback di kotak masuk mencatat metadata dari pesan yang masuk, termasuk alamat pengirim dan penerima, subjek dan nama lampiran.  Contoh di bawah ini (ejaan pengembang disimpan): </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">RECIVE</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span>&gt;{ <span class="hljs-attribute"><span class="hljs-attribute">From</span></span>: sender@example.com To: receiver@example.net Cc: Bcc: Subj: Mail subject Att: an_attachment.pdf }</code> </pre> <br><p>  Kemudian dia menganalisis surat dan lampiran pada subjek tim dari penyerang.  Fungsi ini dijelaskan pada bagian 2.3. </p><br><p>  Akhirnya, ia memotong NDR dengan memeriksa pesan yang masuk dengan alamat email operator.  Surat apa pun yang berisi alamat operator akan ditolak.  Ini dapat menimbulkan masalah jika korban mencurigai ada sesuatu yang salah dan menghubungi layanan dukungan tanpa melihat jawabannya. </p><br><p>  <b>2.2.1.2.</b>  <b>Panggilan balik di kotak keluar</b> </p><br><p>  Seperti di kotak masuk, kotak keluar mencatat metadata dari semua email yang dikirim.  Catatan berikut dihasilkan (alamat operator diubah): </p><br><pre> <code class="hljs css">21<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:57</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:56</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SEND</span></span> &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">From</span></span>: To: recipient@example.com Cc: Bcc: Subj: My title Att: [<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-string"><span class="hljs-string">"last_presentation.pdf"</span></span> } 21<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:57</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:56</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Sending</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">data</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">message</span></span> 21<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:57</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:56</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Message</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ENTRYID</span></span>: <span class="hljs-selector-attr"><span class="hljs-selector-attr">[Message ENTRYID]</span></span> 21<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:57</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:56</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Data</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">message</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">was</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">send</span></span>. <span class="hljs-selector-tag"><span class="hljs-selector-tag">To</span></span>: <span class="hljs-selector-attr"><span class="hljs-selector-attr">[redacted]</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">gmx</span></span>[.]<span class="hljs-keyword"><span class="hljs-keyword">com</span></span> From: Subj: My title <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">57</span></span>:<span class="hljs-number"><span class="hljs-number">56</span></span> Set last time. <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">57</span></span>:<span class="hljs-number"><span class="hljs-number">56</span></span> Spawned thread for cleaning up outgoing messages (id <span class="hljs-number"><span class="hljs-number">2848</span></span>) <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">58</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span> Ending work, client: Outlook <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">58</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span> Number of messages to remove: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">58</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span> Message ENTRYID: [Message ENTRYID] <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">58</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span> DeleteMessages executed successfully. <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">58</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span> Number of not removed messages: <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br><p>  Anda mungkin memperhatikan bahwa itu meneruskan setiap pesan keluar ke alamat penyerang, <code>[‚Ä¶]@gmx[.]com</code> .  GMX - layanan email gratis populer;  penyerang mungkin memilihnya, karena organisasi biasanya tidak memblokir domain gmx.com. </p><br><p>  Alamat email ini adalah kode-keras dalam sampel yang kami pelajari, seperti yang ditunjukkan pada gambar di bawah ini.  Namun, ini dapat diperbarui menggunakan salah satu fungsi backdoor.  Penyerang tampaknya mendaftarkan setidaknya satu alamat email untuk setiap target <br>  organisasi menggunakan format <code>firstname.lastname@gmx[.]com</code> dengan nama karyawan asli.  Ini menghindari deteksi, karena seringkali sulit untuk membedakan alamat seperti itu dari kotak surat pribadi karyawan yang sebenarnya.  Pada saat analisis sampel pada Juni 2018, alamat itu tidak tersedia. </p><br><img src="https://habrastorage.org/webt/9c/tr/-d/9ctr-dcusp0p35kcuhiqw4pypns.png"><br><p>  <i>Gambar 8. Alamat operator hard-coded</i> </p><br><p>  Pintu belakang mengirim laporan ke alamat operator pada interval tertentu.  Laporan mencakup pengidentifikasi unik, termasuk alamat MAC, file log lengkap, dan hasil perintah, jika ada.  Kemudian mengenkripsi data menggunakan MISTY1, seperti yang dijelaskan lebih lanjut di bagian 2.3.2.2, dan membuat file PDF yang valid dengan konten terenkripsi.  Sebelum gumpalan data terenkripsi ini, dokumen berisi gambar putih 1x1 di jpeg, yang dikodekan dalam program jahat.  Ini memungkinkan Anda untuk membuat PDF yang valid yang, ketika dibuka, hanya menampilkan satu halaman kosong. </p><br><p>  Akhirnya, pintu belakang melampirkan PDF dan mengirim email ke penyerang.  Gambar di bawah ini adalah contoh file PDF yang dibuat oleh backdoor. </p><br><img src="https://habrastorage.org/webt/d4/6f/yx/d46fyxd9n7e-ziu9jwjxdtedqke.png"><br><p>  <i>Gambar 9. Awal dokumen PDF yang dibuat oleh backdoor untuk mengekstrak data</i> </p><br><p>  Laporan dikirim menggunakan fungsi panggilan balik di kotak keluar.  Ini berarti bahwa surat itu akan pergi bersamaan dengan mengirim pesan pengguna yang sah.  Backdoor tidak dapat mengirim surat dengan data curian pada waktu yang tidak biasa bagi pengguna dan karenanya menghindari deteksi.  Berkat stealth, mekanisme kontrol dan kontrol ini sangat sulit dideteksi di alam liar. </p><br><h4>  2.2.2.  Menyamarkan perilaku pengguna jahat </h4><br><p>  Karena pintu belakang bertindak ketika pengguna bekerja dengan komputer dan Outlook, malware mencoba untuk menyembunyikan aktivitas berbahaya, misalnya, pesan masuk dari operator. </p><br><p>  Pertama-tama, pintu belakang selalu menghapus surat yang dikirim atau diterima dari operator.  Seperti yang ditunjukkan pada gambar di bawah ini, selama beberapa detik Anda dapat melihat bahwa pesan baru telah muncul, yang, bagaimanapun, tidak muncul di kotak surat. </p><br><img src="https://habrastorage.org/webt/o7/pc/wh/o7pcwhrtwemk2qfqrfdtgjb6p0o.png"><br><p>  <i>Gambar 10. Pesan yang belum dibaca</i> </p><br><p>  Kedua, pintu belakang memotong <code>CreateWindowsEx</code> , seperti yang ditunjukkan pada gambar di bawah ini.  Ini mencegah pembuatan windows seperti NetUIHWND yang digunakan Outlook untuk notifikasi yang muncul di kanan bawah layar. </p><br><img src="https://habrastorage.org/webt/7y/wn/xq/7ywnxqshbevin9-ncsw8lhprkvo.png"><br><p>  <i>Gambar 11. Mengkonfigurasi penangkapan fungsi CreateWindowsEx</i> </p><br><img src="https://habrastorage.org/webt/ki/1_/zr/ki1_zrks5vaspkm-bpz2j-z9asu.png"><br><p>  <i>Gambar 12. Intercept CreateWindowsEx</i> </p><br><p>  Gambar di bawah ini menunjukkan contoh jendela NetUIHWND, yang biasanya ditampilkan di desktop ketika pesan baru diterima.  Sebagai hasil dari intersepsi <code>CreateWindowEx</code> , pemberitahuan tidak ditampilkan ketika penyerang mengirim surat ke pintu belakang. </p><br><img src="https://habrastorage.org/webt/bd/5n/3b/bd5n3bq_pijmhlosvf6muvjcyjq.png"><br><p>  <i>Gambar 13. Notifikasi pesan baru</i> </p><br><h4>  2.2.3.  Kelelawar! </h4><br><p>  Terlepas dari kenyataan bahwa fungsi registrasi plugin untuk The Bat!  tidak ada lagi, ada kode warisan yang melakukan fungsi yang sama seperti untuk Outlook menggunakan The Bat! API. </p><br><p>  Seperti yang ditunjukkan pada gambar berikut, pintu belakang menggunakan saluran komunikasi dengan The Bat !, untuk menerima informasi pengguna, membaca dan mengirim surat.  Namun, semua fungsi lain, misalnya, digunakan untuk mencatat pesan atau menjalankan perintah, identik dengan Outlook. </p><br><img src="https://habrastorage.org/webt/iy/qb/ub/iyqbubrelp4uwudy8n4gby7n6lq.png"><br><p>  <i>Gambar 14. Saluran Bat!</i> </p><br><h3>  2.3.  Pintu belakang </h3><br><p>  Seperti yang ditunjukkan di bagian sebelumnya, malware dapat memproses dan memfilter pesan.  Pada saat yang sama, ini adalah backdoor yang digerakkan oleh email yang berfungsi penuh yang dapat bekerja secara independen dari komponen Turla lainnya.  Backdoor tidak memerlukan koneksi Internet permanen dan dapat berfungsi di komputer mana pun yang mengirim pesan ke alamat eksternal.  Ini berguna dalam jaringan yang dikontrol secara ketat, misalnya, menggunakan pemfilteran lalu lintas Internet.  Selain itu, bahkan jika alamat email penyerang tidak aktif, mereka dapat memperoleh kembali kendali dengan mengirimkan perintah dari alamat yang berbeda.  Dalam hal ini, surat itu juga akan disembunyikan dari pengguna, karena akan berisi perintah yang ditafsirkan oleh backdoor.  Dengan demikian, backdoor sama tolerannya dengan kesalahan dengan rootkit yang memeriksa lalu lintas jaringan yang masuk. </p><br><h4>  2.3.1.  Format pdf </h4><br><p>  Pada awal 2018, beberapa media menyatakan bahwa operator Turla menggunakan lampiran email untuk mengelola komputer yang terinfeksi.  Media benar.  Analisis dari backdoor Turla Outlook mengungkapkan bagaimana ia mengirim dan menafsirkan perintah. </p><br><p>  Perintah diemail menggunakan lampiran PDF yang dibuat khusus.  Kami tidak dapat menemukan sampel PDF nyata dengan perintah, tetapi ini mungkin adalah dokumen PDF yang valid, serta file PDF yang dibuat oleh backdoor untuk exfiltration. </p><br><p>  Dari dokumen PDF, pintu belakang dapat mengembalikan apa yang operator sebut wadah di majalah.  Ini adalah gumpalan dengan format khusus yang berisi perintah terenkripsi untuk backdoor.  Gambar di bawah ini menunjukkan prosedur untuk menghapus wadah ini.  Secara teknis, aplikasi tidak harus berupa dokumen PDF yang valid.  Satu-satunya persyaratan adalah bahwa itu termasuk wadah dalam format yang benar. </p><br><img src="https://habrastorage.org/webt/hb/r_/yf/hbr_yfy47qewou5f_tqbrpdn5ck.png"><br><p>  <i>Gambar 15. Mengekstrak wadah perintah dari PDF</i> </p><br><p>  Wadah memiliki struktur yang kompleks dengan banyak pemeriksaan berbeda.  Itu dapat dirancang untuk mencegah kesalahan komunikasi, tetapi kami percaya bahwa struktur itu dibuat terutama untuk menangkal rekayasa terbalik.  Struktur wadah ditunjukkan pada gambar di bawah ini. </p><br><img src="https://habrastorage.org/webt/ud/aa/6w/udaa6wvubnjskhmfrgsoalfke70.png"><br><p>  <i>Gambar 16. Struktur wadah perintah</i> </p><br><p>  Segera sebelum vektor inisialisasi, ada daftar deskriptor perintah.  Nilai ID yang berbeda disajikan dalam tabel: </p><br><img src="https://habrastorage.org/webt/jy/sg/5o/jysg5opuoyhwir5hre-xi9quhxq.png"><br><p><br>  ID deskriptor 2 dan 4 digunakan untuk mengekstrak fungsi enkripsi dan dekompresi, seperti yang ditunjukkan pada gambar berikut.  Namun, program jahat hanya menerapkan satu algoritma enkripsi dan satu algoritma kompresi.  Dengan demikian, satu-satunya tujuan bidang ini adalah mempersulit analisis backdoor. </p><br><img src="https://habrastorage.org/webt/h8/sh/gu/h8shgunmwafcbx6h1shccn9-ndo.png"><br><p>  <i>Gambar 17. Fungsi dekompresi dan dekripsi offset</i> </p><br><p>  Tim berada di bagian terakhir dari struktur.  Mereka dienkripsi menggunakan MISTY1 dan dikompres dengan bzip2.  Ada banyak perintah berbeda dalam file PDF yang sama, dan masing-masing dapat memiliki beberapa argumen. </p><br><h4>  2.3.2.  Kriptografi </h4><br><p>  Di sini kami menjelaskan algoritma enkripsi yang digunakan. </p><br><p>  <b>2.3.2.1.</b>  <b>Enkripsi XOR</b> </p><br><p>  Bagian dari wadah (dimulai dengan CRC32 pertama) dienkripsi dengan XOR dengan aliran byte yang dihasilkan oleh fungsi yang ditentukan pengguna.  Dibutuhkan seed, yang dilewatkan ke <code>srand</code> untuk menghasilkan nomor kedua dengan memanggil rand.  Seed kedua digunakan dalam fungsi yang ditunjukkan di bawah ini sebagai argumen untuk data dalam XOR. </p><br><pre> <code class="hljs powershell">int __usercall F_bytestream_xor<span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>&lt;eax&gt;(unsigned int len<span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>&lt;edx&gt;, int ciphertext<span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>&lt;ecx&gt;, unsigned int seed) { unsigned int v3; // ebx int v4; // esi unsigned int v5; // edi int result; // eax unsigned int v7; // ecx char *v8; // edx unsigned int v9; // esi byte key[<span class="hljs-number"><span class="hljs-number">512</span></span>]; // [<span class="hljs-type"><span class="hljs-type">esp</span></span>+<span class="hljs-type"><span class="hljs-type">Ch</span></span>] [<span class="hljs-type"><span class="hljs-type">ebp</span></span>-<span class="hljs-number"><span class="hljs-number">204</span></span><span class="hljs-type"><span class="hljs-type">h</span></span>] char *v11; // [<span class="hljs-type"><span class="hljs-type">esp</span></span>+<span class="hljs-number"><span class="hljs-number">20</span></span><span class="hljs-type"><span class="hljs-type">Ch</span></span>] [<span class="hljs-type"><span class="hljs-type">ebp</span></span>-<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-type"><span class="hljs-type">h</span></span>] v3 = len; v11 = (char *)ciphertext; srand(seed); v4 = <span class="hljs-number"><span class="hljs-number">0</span></span>; v5 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { result = rand(); *(_DWORD *)&amp;key[<span class="hljs-number"><span class="hljs-number">4</span></span> * <span class="hljs-type"><span class="hljs-type">v5</span></span>++] = result; } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( v5 &lt; <span class="hljs-number"><span class="hljs-number">128</span></span> ); v7 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !v3 ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; v8 = v11; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { v8[<span class="hljs-type"><span class="hljs-type">v7</span></span>] ^= key[<span class="hljs-type"><span class="hljs-type">v4</span></span>]; v9 = v4 + <span class="hljs-number"><span class="hljs-number">1</span></span>; result = -(v9 &lt; <span class="hljs-number"><span class="hljs-number">512</span></span>); v4 = result &amp; v9; ++v7; } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( v7 &lt; v3 ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br><p>  <strong>2.3.2.2.</strong>  <strong>MISTY1</strong> </p><br><p>  Pengembang Turla lebih suka menggunakan algoritma enkripsi yang kurang umum atau dimodifikasi di halaman belakang mereka: </p><br><ul><li>  dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Karbon dan Ular</a> - CAST-128 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Gazer</a> - implementasi RSA khusus </li><li>  di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Mosquito</a> - Blum Blum Shub sebagai generator angka acak untuk aliran byte XOR </li><li>  di rootkit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Uroburos</a> - versi modifikasi dari ThreeFish </li></ul><br><p>  Di Outlook backdoor, mereka mengimplementasikan MISTY1, algoritma enkripsi simetris yang dikembangkan oleh kriptografer Mitsubishi Electric pada 1995.  Ini memiliki sifat-sifat berikut: </p><br><ul><li>  simetris </li><li>  memiliki kunci 128-bit </li><li>  menggunakan dua tabel prakomputasi: s7 (128 byte) dan s9 (2048 byte) </li><li>  menggunakan tiga fungsi: FL, FO, FI <br>  o FL melakukan beberapa operasi XOR antara penulisan byte dan tombol extended <br>  o FO melakukan operasi XOR antara catatan dan kunci yang diperluas, dan juga menggunakan FI <br>  o FI melakukan ekspansi nonlinear menggunakan s7 dan s9 </li><li>  beroperasi dengan blok 64 bit </li><li>  melakukan delapan siklus (fungsi siklus - panggilan FO) </li><li>  menggunakan cipher Feistel </li></ul><br><img src="https://habrastorage.org/webt/jf/d4/_i/jfd4_iplej2iexnsc2pkxkeracy.png"><br><p>  <em>Gambar 18. MISTY1</em> </p><br><img src="https://habrastorage.org/webt/08/qc/_h/08qc_hxb2xju1yxbfsqmizuocwy.png"><br><p>  <em>Gambar 19. Delapan siklus untuk enkripsi blok</em> </p><br><p>  Pengembang Turla sedikit memodifikasi algoritme: </p><br><ul><li>  menambahkan dua operasi XOR ke fungsi FI seperti yang ditunjukkan pada gambar di bawah ini </li><li>  Kunci 128-bit dihasilkan dari dua kunci 1024-bit yang dikodekan dan ditambah vektor inisialisasi 2048-bit </li><li>  mengubah tabel s7 dan s9.  Ini mengganggu operasi semua alat yang mengenali algoritma kriptografi berdasarkan nilai s-table.  Kedua tabel s dimodifikasi dan asli berisi nilai yang sama, mereka hanya dikocok </li></ul><br><img src="https://habrastorage.org/webt/74/ge/qg/74geqg_tqugk_mgizdhn07hrcp0.png"><br><p>  <em>Gambar 20. Perbandingan fungsi FI (asli di kiri, pengembangan Turla di kanan)</em> </p><br><h4 id="233-funkcii">  2.3.3.  Fungsi </h4><br><p>  Backdoor memiliki banyak fungsi, dari exfilting file hingga mengeksekusi perintah.  Deskripsi berbagai fungsi ada pada tabel di bawah ini. </p><br><img src="https://habrastorage.org/webt/zk/ij/od/zkijodwltfd9en0cxuya189_758.png"><br><p><br>  Untuk fungsi 0x29, pengembang Turla menyalin kode dari proyek Empire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PSInject</a> .  Ini memungkinkan Anda untuk menjalankan kode PowerShell dalam file yang dapat dieksekusi khusus yang disebut PowerShell Runner tanpa memanggil <code>powershell.exe</code> .  Keuntungan utama adalah bahwa malware masih dapat menjalankan perintah PowerShell bahkan jika file <code>powershell.exe</code> terkunci di komputer yang dikompromikan. </p><br><p>  Setelah menganalisis pintu belakang, kami dapat membuat dokumen PDF yang dapat berhasil ditafsirkan oleh program jahat.  Gambar berikut ini menunjukkan pelaksanaan MessageBox dan peluncuran kalkulator ( <code>calc.exe</code> ) setelah Outlook menerima email yang berisi PDF ini.  Ini menunjukkan bahwa pintu belakang, mungkin dimaksudkan untuk menerima perintah dalam lampiran PDF, fungsional dan dapat dikontrol oleh siapa saja yang mengerti format kustom ini. </p><br><img src="https://habrastorage.org/webt/-t/xc/lr/-txclr3f050ahxdxykqgnimnr5g.png"><br><p>  <em>Gambar 21. Menjalankan perintah yang ditentukan dalam dokumen PDF</em> </p><br><h3 id="24-dopolnitelnye-funkcii">  2.4.  Fungsi tambahan </h3><br><p>  Selain kemampuan backdoor yang diterapkan sebagai plug-in untuk klien email, malware ini memiliki fungsi lain. </p><br><h4 id="241-virtualnaya-faylovaya-sistema">  2.4.1.  Sistem file virtual </h4><br><p>  Program jahat tidak menggunakan file konfigurasi apa pun, tetapi mendukung sistem file virtual kecil di <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Settings\ZonePolicy\</code> registri Windows <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Settings\ZonePolicy\</code> .  Backdoor Turla lainnya, seperti <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Gazer</a> , juga menyimpan sistem file virtual di registri Windows.  Kami dapat menentukan beberapa nilai registri, seperti yang ditunjukkan pada tabel berikut. </p><br><img src="https://habrastorage.org/webt/gi/g-/wt/gig-wt39jwfeznw0kpe7qjzvhpm.png"><br><h4 id="242-zhurnaly">  2.4.2.  Majalah </h4><br><p>  Seperti disebutkan sebelumnya, program menyimpan jurnal, yang secara teratur dikirim ke operator melalui email dalam dokumen PDF yang dibuat khusus.  Ini disimpan dalam <code>%appdata%/Microsoft/Windows/scawrdot.db</code> dan dienkripsi menggunakan kunci XOR 512-byte yang dikodekan dengan keras.  File log dihapus setelah setiap exfiltration ke operator.  Dengan demikian, selama pemeriksaan forensik tidak mungkin untuk melihat semua tindakan masa lalu dari pintu belakang, hanya yang terakhir. </p><br><p>  Log sangat informatif, mereka memungkinkan operator Turla untuk melacak tindakan backdoor.  Gambar di bawah ini menunjukkan contoh log yang didekripsi. </p><br><img src="https://habrastorage.org/webt/yo/q_/z6/yoq_z6lfqy5b3ozw3f4lh6reqr4.png"><br><p>  <em>Gambar 22. File log yang didekripsi</em> </p><br><h2 id="3-vyvody">  3. Kesimpulan </h2><br><p>  Laporan tersebut menunjukkan bahwa pengembang Turla memiliki cukup ide ketika mereka mengembangkan backdoors.  Sejauh yang kami tahu, Turla adalah satu-satunya kelompok spionase cyber yang saat ini menggunakan pintu belakang yang sepenuhnya dikelola melalui email, atau lebih tepatnya, lampiran PDF. </p><br><p>  Backdoor Turla bukan yang pertama menggunakan kotak surat asli korban untuk menerima perintah dan mengekstrak data.  Namun, ini adalah pintu belakang pertama yang dipelajari menggunakan API standar (MAPI) untuk berinteraksi dengan Microsoft Outlook.  Ini adalah peningkatan yang signifikan dibandingkan dengan versi sebelumnya yang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kami pelajari</a> , yang menggunakan Outlook Express.  Sebaliknya, backdoor Turla baru berfungsi bahkan dengan versi Outlook terbaru. </p><br><p>   ,  ,     ,         ,  Turla   .      ,   Uroburos,      . </p><br><p>   ,         Turla,  ,    .     ,  ,     .  ,      -   ,        . </p><br><p>    ,     PDF-,     Turla,      ,     . </p><br><p>  ESET     Turla,        . </p><br><p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">GitHub</a> . </p><br><h2 id="4-indikatory-komprometacii"> 4.   </h2><br><h3 id="41-heshi"> 4.1.  Hash </h3><br><p> 8A7E2399A61EC025C15D06ECDD9B7B37D6245EC2 ‚Äî  Win32/Turla.N;   (GMT) 2013-06-28 14:15:54 <br> F992ABE8A67120667A01B88CD5BF11CA39D491A0 ‚Äî  Win32/Turla.AW; GMT 2014-12-03 20:50:08 <br> CF943895684C6FF8D1E922A76B71A188CFB371D7 ‚Äî  Win32/Turla.R; GMT 2014-12-03 20:44:27 <br> 851DFFA6CD611DC70C9A0D5B487FF00BC3853F30 ‚Äî  Win32/Turla.DA; GMT 2016-09-15 08:14:47 </p><br><h3 id="42-imena-faylov"> 4.2.   </h3><br><p> %appdata%/Microsoft/Windows/scawrdot.db <br> %appdata%/Microsoft/Windows/flobcsnd.dat <br> mapid.tlb </p><br><h3 id="43-klyuchi-reestra"> 4.3.   </h3><br><p> HKCU\Software\Microsoft\Windows\CurrentVersion\Settings\ZonePolicy\ <br> HKCU\Software\Classes\CLSID{49CBB1C7-97D1-485A-9EC1-A26065633066} <br> HKCU\Software\Classes\CLSID{84DA0A92-25E0-11D3-B9F7-00C04F4C8F5D} </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id421399/">https://habr.com/ru/post/id421399/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id421389/index.html">Pemisahan kekuatan administratif di Zimbra</a></li>
<li><a href="../id421391/index.html">HackThings - hackathon besar di Internet hal 7-9 September di Skoltech</a></li>
<li><a href="../id421393/index.html">Keranjang Mailchimp yang Ditinggalkan: Panduan untuk Malas</a></li>
<li><a href="../id421395/index.html">Laporan Club of Rome 2018, Bab 3.7: "Iklim: kabar baik, tetapi masalah besar"</a></li>
<li><a href="../id421397/index.html">Luncurkan Mini AI Cup # 3. Pertempuran mesin di ruang terbatas</a></li>
<li><a href="../id421401/index.html">Anatomi sistem rekomendasi. Bagian dua</a></li>
<li><a href="../id421403/index.html">Pekan Keamanan 32: Drama Fortnite-Android</a></li>
<li><a href="../id421407/index.html">Pertemuan teknis di St. Petersburg 13 September - Cara membuat perubahan besar di backend</a></li>
<li><a href="../id421409/index.html">Mengintai hal-hal: menjaga rahasia</a></li>
<li><a href="../id421411/index.html">Pengantar Modul Go</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>