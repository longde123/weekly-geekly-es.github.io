<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>   Integraci贸n del motor HTML en la aplicaci贸n nativa de Windows: elecci贸n y arquitectura   </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="C贸mo tradujimos el trabajo con HTML en 1C: Enterprise de Internet Explorer a WebKit 

 La capacidad de mostrar HTML en formularios 1C apareci贸 en la p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Integraci贸n del motor HTML en la aplicaci贸n nativa de Windows: elecci贸n y arquitectura</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/1c/blog/425713/">  <b>C贸mo tradujimos el trabajo con HTML en 1C: Enterprise de Internet Explorer a WebKit</b> <br><br>  La capacidad de mostrar HTML en formularios 1C apareci贸 en la plataforma 1C: Enterprise en 2003, versi贸n 8.0.  Para trabajar con HTML, la plataforma utiliz贸 el motor de navegador Internet Explorer (1C: Enterprise en ese momento solo funcionaba bajo Windows).  El motor del navegador fue utilizado por la plataforma con fines utilitarios.  Por ejemplo, para escribir desde cero un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">elemento</a> completo para editar texto a la Palabra, con la posibilidad de varias soluciones de color y fuente, insertar im谩genes, etc.  - Una tarea muy dif铆cil.  Y si utiliza HTML para estos fines y utiliza el motor del navegador de Internet como herramienta de visualizaci贸n, la tarea se simplifica enormemente.  Adem谩s, con la ayuda del motor, se implementaron otros mecanismos (por ejemplo, mostrar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">informaci贸n de ayuda</a> ) y elementos (por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Scheduler</a> ). <br><br>  Bueno, la capacidad de los desarrolladores de aplicaciones de mostrar usando un dise帽o HTML personalizado seg煤n los est谩ndares del mundo de los sistemas de contabilidad a veces hizo posible traer una variedad de aspectos agradables a la interfaz de las aplicaciones comerciales. <br><br>  Con el paso del tiempo, la plataforma comenz贸 a admitir Linux primero, y luego macOS.  Internet Explorer no era adecuado para trabajar con HTML en estos sistemas operativos por razones obvias;  en Linux, utilizamos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">WebKitGTK +</a> , y en macOs, una biblioteca basada en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cocoa</a> .  Por lo tanto, la unidad de la base del c贸digo para diferentes sistemas operativos (que tratamos de mantener para el c贸digo del cliente al nivel del 95%) se viol贸 en esta 谩rea.  Bueno, el motor IE en este momento se convirti贸 en la fuente de una serie de problemas. <br><img src="https://habrastorage.org/webt/xo/c6/2k/xoc62k11ifqv9dfeunr279csd4q.png" alt="imagen"><br><a name="habracut"></a><br>  Los problemas: <br><br><ul><li>  El motor IE ha cerrado el c贸digo fuente; significa: <br><ul><li>  No es posible un ajuste flexible del motor a las necesidades de la plataforma. </li><li>  Depuraci贸n y comprensi贸n de los procesos internos. </li><li>  No se pueden corregir errores y errores al actualizar la versi贸n del motor </li></ul></li><li>  El motor no es adecuado para la implementaci贸n de tareas modernas de programaci贸n web. </li><li>  Problemas de rendimiento en m谩quinas d茅biles </li></ul><br>  Entonces, la traducci贸n de trabajar con HTML en la versi贸n 1C: Enterprise para Windows del motor de IE a otra cosa fue obvia.  Que elegir <br><br>  Para empezar, formulamos los requisitos para el motor: <br><br><ul><li>  Soporte para tecnolog铆as modernas de programaci贸n web. </li><li> C贸digo abierto para una personalizaci贸n flexible del motor y la comprensi贸n de su l贸gica. </li><li>  Alto rendimiento en computadoras m谩s lentas </li><li>  Es deseable que el motor requiera una peque帽a cantidad de bibliotecas de terceros para funcionar </li></ul><br><h2>  Selecci贸n del motor </h2><br>  驴De qu茅 elegir?  Comenzamos, por supuesto, con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">WebKit</a> , con el que ya trabajamos en versiones de la plataforma para Linux y macOS. <br><br>  WebKit fue desarrollado en Apple a principios de la d茅cada de 2000 basado en los motores de c贸digo abierto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">KHTML</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">KJS</a> .  Basado en WebKit, se cre贸 el navegador Safari, m谩s tarde, Chrome (incluso m谩s tarde Chrome cambi贸 de WebKit a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Blink</a> , que nuevamente se basa en el c贸digo WebCore de WebKit). <br><br>  El c贸digo fuente de WebKit es de c贸digo abierto y tiene licencia bajo la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">LGPL</a> .  WebKit est谩 escrito para macOS, hay varios puertos para Windows: <br><br><h3>  WebKit AppleWin </h3><br>  Este es el puerto que los desarrolladores de WebKit sugieren construir en Windows de forma predeterminada.  Fue hecho por empleados de Apple a mediados y finales de la d茅cada de 2000.  Utiliza la biblioteca de gr谩ficos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CoreGraphics</a> , que es una versi贸n simplificada de la biblioteca para macOS, portada a Windows.  Para ejecutar JavaScript, el puerto usa la biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JavaScriptCore</a> con la misma API que se usa en la implementaci贸n de la plataforma para Linux.  Esto lo convierte en un candidato ideal para su uso. <br><br><h3>  WebKit WinCairo </h3><br>  Este puerto utiliza la biblioteca de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El Cairo</a> para gr谩ficos.  Durante alg煤n tiempo, Apple ha estado desarrollando activamente este puerto como un an谩logo al puerto principal AppleWin.  La ventaja de este puerto es que depende menos de las bibliotecas espec铆ficas de macOS que requiere CoreGraphics.  Adem谩s, el puerto utiliza la misma biblioteca para gr谩ficos ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cairo</a> ) que el motor WebKitGTK +, que utilizamos en la implementaci贸n de Linux de la plataforma, lo cual es bueno para estandarizar el comportamiento de nuestro c贸digo. <br><br><h3>  QtWebKit </h3><br>  Otra implementaci贸n del motor WebKit para Windows, ahora independiente de los desarrolladores del propio motor.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Qt</a> es una biblioteca multiplataforma popular con su propia biblioteca de gr谩ficos QtGui.  Este puerto tambi茅n usa la biblioteca JavaScriptCore para manejar JavaScript, sin embargo tiene desventajas: <br><br><ul><li>  Fuerte dependencia de los componentes principales de Qt, que, si se usan en software de terceros, deber谩n entregarse con 茅l </li><li>  Un conjunto diferente de interfaces para trabajar con componentes para renderizar HTML en comparaci贸n con WebKitGTK y su propia l贸gica para trabajar con ellos. </li></ul><br><h3>  WebKitGtk + para Windows </h3><br>  Ya hemos usado WebKitGtk + en la versi贸n de Linux de la plataforma.  Pero la opci贸n de usarlo en Windows se descart贸 debido a la complejidad del ensamblaje, la documentaci贸n deficiente de este proceso y la falta de soporte constante para esta 谩rea de desarrollo por parte de los desarrolladores de WebKitGTK +. <br><br><h3>  Cromo (parpadeo) </h3><br>  El primer y 煤nico motor no similar a WebKit, que se consider贸 como un candidato para resolver el problema.  Fue rechazado debido a las grandes diferencias en la l贸gica de los componentes para renderizar HTML en comparaci贸n con WebKitGTK + y otra biblioteca para trabajar con JavaScript ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">V8</a> ). <br><br><h3>  Que elegir </h3><br>  Despu茅s de la investigaci贸n, AppleWin y WinCairo llegaron a la final. <br>  Para tomar la decisi贸n final, estudiamos c贸mo funciona WebKit. <br><br><h2>  Estructura del motor de WebKit </h2><br>  Por lo general, los diferentes puertos de WebKit difieren de dos maneras.  El primero es directamente la implementaci贸n de un sistema operativo particular utilizando componentes espec铆ficos del sistema operativo.  El segundo es una biblioteca de gr谩ficos.  La siguiente figura describe las diferencias en este sentido entre los puertos WebKit.  Para Windows, los desarrolladores de WebKit escribieron puertos en la biblioteca CoreGraphics y Cairo adaptadas. <br><br><img src="https://habrastorage.org/webt/y5/m5/mo/y5m5moefn2yjpbt4ohq9iwqqqj4.png" alt="imagen"><br><br>  Un modelo simplificado del motor: tres mecanismos tradicionales para formatear una p谩gina web (HTML, JavaScript y CSS) se alimentan al motor, y forma y muestra la p谩gina desde ellos: <br><br><img src="https://habrastorage.org/webt/j4/2n/r5/j42nr5vmxoryxsbq-c_mxe9oots.png" alt="imagen"><br><br>  El motor en s铆 consta de varios componentes: <br><br><ul><li>  WTF (Web Template Framework, no lo que podr铆a haber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">pensado</a> ): aqu铆 encontrar谩 sus propias implementaciones de estructuras de datos para el funcionamiento del motor, as铆 como trabajar con flujos </li><li>  JavaScriptCore: un componente, como su nombre lo indica, para trabajar con el lenguaje JavaScript </li><li>  WebCore: todo el trabajo con DOM, estilos, an谩lisis HTML y XML est谩 escrito aqu铆.  Aqu铆 se hace toda la "magia" principal del motor. </li><li>  Plataforma: realiza acciones t茅cnicas para interactuar con la red, colocar datos en una base de datos, decodificar im谩genes, trabajar con medios </li><li>  WebKit y WebKit2 API: vinculan todos los componentes y proporcionan acceso a ellos </li></ul><br><img src="https://habrastorage.org/webt/ao/zr/gp/aozrgpbezfy8ex2ufhbnrzqf68e.png" alt="imagen"><br>  La relaci贸n entre los componentes de WebKit y las caracter铆sticas espec铆ficas del sistema operativo se muestra en la figura a continuaci贸n.  Como puede ver, hay bastantes puntos espec铆ficos que deben implementarse para cada sistema operativo por separado.  Aunque JavaScriptCore le permite usar usted mismo en cada puerto sin implementaciones separadas. <br><br><img src="https://habrastorage.org/webt/r7/hz/c8/r7hzc8sbq6bcn_qpltvdzpimugu.png" alt="imagen"><br><br><h3>  C贸mo se forma una p谩gina web </h3><br>  Desde la red, una respuesta llega a una solicitud al servidor con datos para descargar.  El cargador pasa los datos al analizador, que, al interactuar con el componente de JavaScript, forma el DOM y la hoja de estilo.  A continuaci贸n, los datos generados se transfieren al 谩rbol de representaci贸n y se muestran en un contexto gr谩fico. <br><img src="https://habrastorage.org/webt/k-/id/dh/k-iddhrnyvvcw8yzacaigtetlai.png" alt="imagen"><br>  La p谩gina en s铆 tambi茅n consta de componentes individuales.  El componente WebCore implementa la clase Page, que permite el acceso a toda la p谩gina.  La p谩gina tiene un marco principal: MainFrame, un marco siempre tiene un documento.  El marco principal puede tener cualquier n煤mero de otros marcos, tambi茅n con documentos dentro.  Para cada marco, algunos eventos se forman por separado, as铆 como contextos gr谩ficos y JavaScript espec铆ficos. <br><br><img src="https://habrastorage.org/webt/zv/fo/9c/zvfo9cqiclfhckd1wmzpnnv4jx4.png" alt="imagen"><br><br>  El analizador HTML simplificado funciona as铆.  Del conjunto de bytes recibidos del servidor, el decodificador genera un conjunto de caracteres para el an谩lisis.  Los s铆mbolos se convierten en tokens o tokens, que generalmente son piezas elementales de c贸digo con metainformaci贸n sobre qu茅 tipo de texto es, ya sea que forme parte de la sintaxis o el contenido del lenguaje.  Luego, los nodos se forman a partir de tokens para construir un 谩rbol DOM.  Un generador de 谩rboles a partir de un conjunto de nodos forma un modelo de objeto completo para un documento de p谩gina web. <br><br><img src="https://habrastorage.org/webt/iq/9q/b5/iq9qb5qwciws_d-rfzze2afuopw.png" alt="imagen"><br><br><h2>  Elecci贸n final </h2><br><ul><li>  Applewin <ul><li>  Pros: <ul><li>  Implementado en una biblioteca de gr谩ficos que se ejecuta en macOS, la plataforma de destino principal para los desarrolladores de WebKit </li></ul></li><li>  Contras: <ul><li>  Falta de implementaci贸n del mecanismo de impresi贸n. </li><li>  Un gran n煤mero de dependencias. </li></ul></li></ul></li><li>  Wincairo <ul><li>  Pros: <ul><li>  La misma biblioteca de gr谩ficos (Cairo), utilizada en el puerto Linux de la plataforma 1C. </li></ul></li><li>  Contras: <ul><li>  Esencial para nuestras tareas no encontradas </li></ul></li></ul></li></ul><br>  Derrotado WinCairo.  Para el desarrollo, se tom贸 la 煤ltima versi贸n de WebKit disponible en ese momento: 605.1.11. <br><br><h2>  Implementaci贸n </h2><br>  Aunque el motor est谩 bastante bien cubierto por las pruebas unitarias (alrededor de 30,000 para todos los componentes del motor, escritos por los autores del motor), existen errores y deficiencias en las implementaciones para sistemas operativos "no b谩sicos" (es decir, para todo lo que no es macOS).  Estas brechas de implementaci贸n se descubrieron gradualmente a medida que el motor se desarroll贸 y prob贸 como parte de la plataforma 1C: Enterprise. <br><br><h3>  Descargar HTML a trav茅s de arrastrar y soltar </h3><br>  Al arrastrar texto a la ventana, se descubri贸 que si el texto que se arrastra contiene caracteres que no son ASCII, los jerogl铆ficos se insertan en el documento final.  El error apareci贸 solo en la implementaci贸n de Windows del motor, porque funcionaba con un mecanismo espec铆fico del sistema operativo para arrastrar y soltar elementos.  Resulta que el texto no se decodific贸 de UNICODE a UTF-16 antes de pasarlo al controlador de eventos de inserci贸n. <br><br><h3>  Cambiar Shift + Enter Comportamiento del teclado </h3><br>  En la mayor铆a de los editores de texto (incluido Microsoft Word), esta combinaci贸n inserta un salto de l铆nea.  El comportamiento est谩ndar de WebKit es insertar un nuevo p谩rrafo (como si simplemente presionara Enter).  Cambiamos el motor, haciendo que el comportamiento sea m谩s familiar para los usuarios. <br><br><h3>  Organizaci贸n del mecanismo de deshacer y rehacer. </h3><br>  WebKit proporciona una API para implementar su propio mecanismo para cancelar y repetir acciones del usuario.  Su esquema es el siguiente: cuando el usuario realiza una determinada acci贸n discreta desde el punto de vista del motor (por ejemplo, cambiar a un nuevo p谩rrafo, formatear en cursiva, pegar), WebKit informa al desarrollador acerca de esto utilizando la API para que pueda registrar esta acci贸n. <br><br>  En el proceso de probar el mecanismo implementado, se descubri贸 algo desagradable: el motor no informa cambios en la estructura de las tablas.  Se agregaron comandos para agregar y eliminar celdas y cambiar el atributo colSpan, que se convirti贸 en parte de acciones compuestas, como, por ejemplo, agregar / eliminar una columna o una fila en una tabla.  Dichos comandos compuestos se registran en la misma pila de deshacer y rehacer, y junto con los comandos del motor aseguran el funcionamiento correcto del mecanismo. <br><br><h3>  Pegar desde Excel </h3><br>  Aquellos que trabajaron con el portapapeles de Windows y Excel pueden saber que, en primer lugar, al copiar de Excel a HTML, el formato del portapapeles en el fragmento copiado contiene solo las etiquetas de las celdas y filas, pero no la etiqueta de la tabla en s铆, y en segundo lugar, Los estilos de un documento de Excel no se transfieren a las celdas.  Debido a esto, insertar, por ejemplo, una tabla de colores en un elemento editable en Chrome tiene este aspecto: <br><br>  Original: <br><br><img src="https://habrastorage.org/webt/gp/qu/fd/gpqufdcqtefrrio5zechwq0ufus.png" alt="imagen"><br><br>  En cromo: <br><br><img src="https://habrastorage.org/webt/gf/6y/uu/gf6yuuqrxmu8il-7bgoeql7xtwy.png" alt="imagen"><br><br>  Los desarrolladores de WebKit no tuvieron en cuenta estos dos factores.  La apertura del c贸digo del motor nos permiti贸 refinar el mecanismo de inserci贸n, y ahora el fragmento de la tabla insertada en el campo HTML del documento est谩 cerca del original: <br><br><img src="https://habrastorage.org/webt/l8/pi/bo/l8piboap1-odjv6iwb2jd4zdhim.png" alt="imagen"><br><br><h3>  Generaci贸n de letra cursiva </h3><br>  Si Windows no tiene una versi贸n en cursiva de una fuente no est谩ndar, la mayor铆a de los editores de texto pueden generar dicha fuente utilizando su versi贸n normal.  Sin embargo, WebKit no pudo hacer esto y enga帽贸 a los desarrolladores un par de veces: c贸mo es que en el c贸digo HTML del documento colocamos el texto en la etiqueta &lt;i&gt;, pero a pesar de esto, el texto se mantuvo recto.  La raz贸n es que el motor WebKit selecciona la fuente deseada en el puerto WinCairo que usamos; si no hay una versi贸n en cursiva, el motor usa la versi贸n normal.  Este comportamiento ha sido reemplazado por el uso de la fuente en cursiva generada por la biblioteca de gr谩ficos Cairo. <br><br><h3>  Errores en la decodificaci贸n de im谩genes y animaciones </h3><br>  Se encontraron errores en el comportamiento del motor al trabajar con elementos gr谩ficos.  Al cargar algunas im谩genes en formato PNG, se observ贸 distorsi贸n de la imagen y, a veces, su ausencia.  No fue posible averiguar la raz贸n de este comportamiento, ya que se produce un error al decodificar im谩genes en los intestinos de la biblioteca libpng. <br><br>  Emp铆ricamente, se encontr贸 que al vincular la biblioteca libpng de forma din谩mica en lugar de una est谩tica, el problema se soluciona.  Por cierto, en la versi贸n actual del motor, el enlace se realiza de esta manera.  Se decidi贸 hacer lo mismo. <br><br>  Otro problema era el motor al cargar animaciones en formato GIF.  El error se reprodujo peri贸dicamente al cargar la p谩gina con tales animaciones y provoc贸 el bloqueo del programa.  El error fue causado por la falta de sincronizaci贸n al trabajar con el b煤fer en el que se coloca el siguiente cuadro de la animaci贸n.  El problema se resolvi贸 utilizando herramientas de sincronizaci贸n internas de WebKit. <br><br><h3>  Soporte ortogr谩fico </h3><br>  En el ensamblaje con Internet Explorer, en Windows versi贸n 8 y posterior, la correcci贸n ortogr谩fica podr铆a habilitarse para el campo editable HTML.  Para hacer esto, fue suficiente para atribuir "corrector ortogr谩fico" igual a "verdadero".  WebKit ten铆a diferentes soluciones para diferentes puertos: en Linux es la biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Enchant</a> , en macOS tiene su propio mecanismo, familiar para todos los usuarios de productos Apple.  Pero para Windows no hay implementaci贸n, pero se proporciona una API para su propia soluci贸n.  Utilizamos la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">API de correcci贸n ortogr谩fica de Windows</a> , disponible a partir de Windows 8, e implementamos un mecanismo similar a la compilaci贸n con Internet Explorer.  Por cierto, ahora en un documento formateado en clientes nativos de 1C: Enterprise, esta funcionalidad tambi茅n funciona.  Antes de la versi贸n 8.3.14, estaba deshabilitado debido al bajo rendimiento de Internet Explorer. <br><br><h3>  Soporte de Windows XP </h3><br>  Algunos de nuestros clientes a煤n trabajan en Windows XP y no van a actualizar el sistema operativo en un futuro pr贸ximo.  Triste para nosotros como desarrolladores, pero cierto.  Entonces, necesitamos apoyarlos.  Y aqu铆 tuvimos una sorpresa desagradable: los desarrolladores de WebKit durante aproximadamente un a帽o no han admitido el motor en WinXP.  El intento de compilar una versi贸n del motor con un conjunto de herramientas de compilaci贸n para WinXP no tuvo 茅xito: los desarrolladores de WebKit usan bibliotecas que solo est谩n disponibles desde Windows Vista y versiones posteriores. <br><br>  Que hacer  Las opciones fueron las siguientes: <br><br><ol><li>  Deje la implementaci贸n de WinXP con el motor de Internet Explorer y use WebKit en versiones anteriores de Windows </li><li>  Tome para el desarrollo una versi贸n anterior del motor WebKit, que funciona en WinXP, y use esta versi贸n en todos los SO </li><li>  Use la versi贸n adecuada de WebKit en WinXP y use el 煤ltimo motor en versiones anteriores de Windows </li><li>  Transfiera la versi贸n actual del motor a WinXP y 煤selo en todas partes </li></ol><br>  La pregunta no fue simple.  La primera opci贸n le permit铆a usar la 煤ltima versi贸n del motor WebKit, pero lo obligar铆a a devolver la implementaci贸n anterior con Internet Explorer.  En tal soluci贸n, ser铆a dif铆cil garantizar un funcionamiento sin errores del programa, y el c贸digo en s铆 ser铆a muy complicado.  La segunda opci贸n proporcion贸 el mismo comportamiento en todos los sistemas operativos Windows, sin embargo, no nos dejar铆a la oportunidad de desarrollar: actualizar el motor para corregir errores y obtener nuevas caracter铆sticas de los desarrolladores del motor en versiones posteriores.  La tercera opci贸n le permit铆a usar la versi贸n actual del motor en versiones anteriores de Windows, pero complicaba enormemente la l贸gica de instalaci贸n y garantizaba el mismo comportamiento de versi贸n en todos los sistemas operativos.  La cuarta opci贸n parec铆a preferible a todas las dem谩s, pero era imposible predecir la complejidad y, en general, la posibilidad de tal soluci贸n. <br><br>  Sin embargo, decidimos arriesgarnos e implementar la cuarta opci贸n, la m谩s correcta desde el punto de vista arquitect贸nico (usando un 煤nico c贸digo fuente del motor en todas las versiones de Windows).  La versi贸n portada de WebKit funciona de manera diferente en WinXP y en las versiones m谩s recientes de Windows: <br><br><ul><li>  Tuve que abandonar las herramientas del nuevo DirectX (d3d11) en favor del antiguo DirectX9 (d3d9) y adaptar sus archivos de encabezado a la versi贸n m谩s joven del SDK. </li><li>  Las funciones del nuevo SDK, cuando se ejecutan en nuevas versiones de Windows, se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">invocan</a> en la direcci贸n (obtenida a trav茅s de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GetProcAddress</a> ). </li><li>  Para transferir datos entre flujos en el motor, WinXP utiliza el almacenamiento local de subprocesos, en nuevas versiones: almacenamiento local de fibra. </li></ul><br><h2>  Resumen </h2><br>  Entonces, ahora en nuestra plataforma 1C: Enterprise a partir de la versi贸n 8.3.14 (lanzamiento - finales de 2018) HTML ser谩 compatible al m谩s alto nivel: HTML5, OpenGL, etc.  Tanto la cantidad como la calidad de las pasas que se pueden incorporar a las decisiones en nuestra plataforma est谩n limitadas solo por la imaginaci贸n del desarrollador.  Y, sin embargo, por supuesto, el sistema operativo del cliente: en WinXP, muchos sabrosos bollos HTML5 no funcionar谩n, por razones obvias. <br><br>  Ahora en aplicaciones de Windows en la plataforma 1C: Enterprise podr谩 mostrar esto: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/zL6beG-cNEI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Pero, usando las "ventajas" de HTML en soluciones de aplicaci贸n, no olvide el sentido com煤n.  El uso de HTML es apropiado y recomendado para tareas especializadas (mostrar ayuda, t茅cnicas, descripciones de productos, ...), pero no para implementar tareas de l贸gica de negocios (entrada / salida de informaci贸n estructurada).  Para hacer esto, debe usar los mecanismos de interfaz est谩ndar 1C: Enterprise que brindan soporte autom谩tico para los derechos de acceso, administraci贸n de funcionalidad, adaptaci贸n al factor de forma del dispositivo, soporte para la configuraci贸n del usuario y el trabajo de muchos otros mecanismos, sin los cuales el funcionamiento completo de una aplicaci贸n comercial se vuelve casi imposible. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es425713/">https://habr.com/ru/post/es425713/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es425703/index.html">Kafka en Wargaming: Blitz</a></li>
<li><a href="../es425705/index.html">Replicaci贸n del Servidor Percona para MySQL a PostgreSQL usando la herramienta pg_chameleon</a></li>
<li><a href="../es425707/index.html">Sistema de notificaciones desde la consola a Telegram</a></li>
<li><a href="../es425709/index.html">Hicimos una nota para los chinos que vinieron a ti</a></li>
<li><a href="../es425711/index.html">P茅rdida de l铆nea no coincidente</a></li>
<li><a href="../es425715/index.html">Programa educativo en qu铆mica: reversi贸n 谩cida de microcircuitos (c贸mo exponer un cristal de un microcircuito para su posterior fotograf铆a)</a></li>
<li><a href="../es425717/index.html">Red neuronal para desarrolladores de C ++</a></li>
<li><a href="../es425719/index.html">Apio en proyectos ocupados: un poco de pr谩ctica</a></li>
<li><a href="../es425723/index.html">Facebook est谩 desarrollando activamente un servicio para encontrar trabajo y contratar empleados en una red social</a></li>
<li><a href="../es425725/index.html">Nintendo Patents Case - Game Boy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>