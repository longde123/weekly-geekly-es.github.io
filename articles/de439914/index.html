<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✊🏿 🙌🏿 👊🏼 Reduziererorganisation - einen Schritt weiter gehen 💪🏻 😽 ✍️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Was werden wir hier behandeln? 


 Wir werden einen Überblick über die Entwicklung der Reduzierungen in meinen Redux / NGRX-Apps geben, die in den let...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Reduziererorganisation - einen Schritt weiter gehen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439914/"><p><img src="https://habrastorage.org/webt/ud/sm/oe/udsmoenal1bazibn-vxzwkytz_8.jpeg"></p><br>
<h2 id="what-are-we-gonna-cover-here">  Was werden wir hier behandeln? </h2><br><p> Wir werden einen Überblick über die Entwicklung der Reduzierungen in meinen Redux / NGRX-Apps geben, die in den letzten zwei Jahren stattgefunden haben.  Ausgehend vom Vanille- <code>switch-case</code> ein Reduzierer aus einem Objekt per Schlüssel ausgewählt und schließlich mit klassenbasierten Reduzierern entschieden.  Wir werden nicht nur darüber sprechen, wie, sondern auch darüber, warum. </p><a name="habracut"></a><br><blockquote>  Wenn Sie daran interessiert sind, zu viel Boilerplate in Redux / NGRX zu umgehen, sollten Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diesen Artikel</a> lesen. <br><br>  Wenn Sie bereits mit der Auswahl eines Reduzierers aus einer Kartentechnik vertraut sind, sollten Sie direkt zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">klassenbasierten Reduzierern</a> springen. </blockquote><br><h2 id="vanilla-switch-case">  Vanille-Schaltergehäuse </h2><br><p>  Schauen wir uns also eine alltägliche Aufgabe an, bei der asynchron eine Entität auf dem Server erstellt wird.  Dieses Mal schlage ich vor, wir beschreiben, wie wir einen neuen Jedi erschaffen können. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeJediCreateInit = <span class="hljs-string"><span class="hljs-string">'jedi-app/jedi-create-init'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeJediCreateSuccess = <span class="hljs-string"><span class="hljs-string">'jedi-app/jedi-create-success'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeJediCreateError = <span class="hljs-string"><span class="hljs-string">'jedi-app/jedi-create-error'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerJediInitialState = { <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-comment"><span class="hljs-comment">// List of our jedi data: [], error: undefined, } const reducerJedi = (state = reducerJediInitialState, action) =&gt; { switch (action.type) { case actionTypeJediCreateInit: return { ...state, loading: true, } case actionTypeJediCreateSuccess: return { loading: false, data: [...state.data, action.payload], error: undefined, } case actionTypeJediCreateError: return { ...state, loading: false, error: action.payload, } default: return state } }</span></span></code> </pre> <br><p>  Lassen Sie mich ehrlich sein, ich habe diese Art von Reduzierstücken noch nie in der Produktion verwendet.  Meine Argumentation ist dreifach: </p><br><ul><li>  <code>switch-case</code> führt einige Spannungspunkte und undichte Rohre ein, die wir möglicherweise irgendwann vergessen, rechtzeitig zu reparieren.  Wir könnten immer vergessen, eine <code>break</code> wenn wir nicht sofort <code>return</code> . Wir könnten immer vergessen, <code>default</code> hinzuzufügen, das wir jedem Reduzierer hinzufügen müssen. </li><li>  <code>switch-case</code> hat selbst einen Boilerplate-Code, der keinen Kontext hinzufügt. </li><li>  <code>switch-case</code> ist O (n), <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Art von</a> .  Es ist kein solides Argument für sich, weil Redux sowieso nicht sehr performant ist, aber es macht meinen inneren Perfektionisten wütend. </li></ul><br><p>  Der logische nächste Schritt, den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die offizielle Dokumentation von Redux</a> vorschlägt, besteht darin, einen Reduzierer anhand eines Schlüssels aus einem Objekt auszuwählen. </p><br><h2 id="selecting-a-reducer-from-an-object-by-key">  Auswahl eines Reduzierers aus einem Objekt per Schlüssel </h2><br><p>  Die Idee ist einfach.  Jede Zustandstransformation ist eine Funktion aus Zustand und Aktion und hat einen entsprechenden Aktionstyp.  Wenn man bedenkt, dass jeder Aktionstyp eine Zeichenfolge ist, können wir ein Objekt erstellen, wobei jeder Schlüssel ein Aktionstyp ist und jeder Wert eine Funktion ist, die den Status transformiert (ein Reduzierer).  Dann könnten wir einen erforderlichen Reduzierer aus diesem Objekt per Schlüssel auswählen, nämlich O (1), wenn wir eine neue Aktion erhalten. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeJediCreateInit = <span class="hljs-string"><span class="hljs-string">'jedi-app/jedi-create-init'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeJediCreateSuccess = <span class="hljs-string"><span class="hljs-string">'jedi-app/jedi-create-success'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeJediCreateError = <span class="hljs-string"><span class="hljs-string">'jedi-app/jedi-create-error'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerJediInitialState = { <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerJediMap = { [actionTypeJediCreateInit]: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ ...state, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, }), [actionTypeJediCreateSuccess]: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: [...state.data, action.payload], <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, }), [actionTypeJediCreateError]: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ ...state, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: action.payload, }), } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerJedi = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state = reducerJediInitialState, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Pick a reducer by action type const reducer = reducerJediMap[action.type] if (!reducer) { // Return state unchanged if we did not find a suitable reducer return state } // Run suitable reducer if found one return reducer(state, action) }</span></span></code> </pre> <br><p>  Das Coole dabei ist, dass die Logik im <code>reducerJedi</code> für jedes Reduzierstück gleich bleibt, was bedeutet, dass wir es wiederverwenden können.  Es gibt sogar eine kleine Bibliothek namens <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Redux-Create-Reducer</a> , die genau das tut.  Dadurch sieht der Code folgendermaßen aus: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createReducer } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-create-reducer'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeJediCreateInit = <span class="hljs-string"><span class="hljs-string">'jedi-app/jedi-create-init'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeJediCreateSuccess = <span class="hljs-string"><span class="hljs-string">'jedi-app/jedi-create-success'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeJediCreateError = <span class="hljs-string"><span class="hljs-string">'jedi-app/jedi-create-error'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerJediInitialState = { <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerJedi = createReducer(reducerJediInitialState, { [actionTypeJediCreateInit]: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ ...state, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, }), [actionTypeJediCreateSuccess]: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: [...state.data, action.payload], <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, }), [actionTypeJediCreateError]: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ ...state, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: action.payload, }), })</code> </pre> <br><p>  Schön und hübsch, oder?  Obwohl dies hübsch noch ein paar Einschränkungen hat: </p><br><ul><li>  Bei komplexen Reduzierern müssen wir viele Kommentare hinterlassen, die beschreiben, was dieser Reduzierer tut und warum. </li><li>  Riesige Reduzierkarten sind schwer zu lesen. </li><li>  Jeder Reduzierer hat nur einen entsprechenden Aktionstyp.  Was ist, wenn ich denselben Reduzierer für mehrere Aktionen ausführen möchte? </li></ul><br><p>  Klassenbasierter Reduzierer wurde zu meinem Lichtblick im Königreich der Nacht. </p><br><h2 id="class-based-reducers">  Klassenbasierte Reduzierungen </h2><br><p>  Lassen Sie mich diesmal mit dem Warum dieses Ansatzes beginnen: </p><br><ul><li>  Die Methoden der Klasse werden unsere Reduzierer sein und die Methoden haben Namen, was eine nützliche Metainformation ist, und wir könnten in 90% der Fälle Kommentare aufgeben. </li><li>  Die Methoden der Klasse könnten dekoriert werden, was eine leicht zu lesende deklarative Methode ist, um Aktionen und Reduzierungen abzugleichen. </li><li>  Wir könnten immer noch eine Karte von Aktionen unter der Haube verwenden, um O (1) -Komplexität zu haben. </li></ul><br><p>  Wenn das nach einer vernünftigen Liste von Gründen für Sie klingt, lassen Sie uns eintauchen! </p><br><p>  Zunächst möchte ich definieren, was wir als Ergebnis erhalten möchten. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeJediCreateInit = <span class="hljs-string"><span class="hljs-string">'jedi-app/jedi-create-init'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeJediCreateSuccess = <span class="hljs-string"><span class="hljs-string">'jedi-app/jedi-create-success'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeJediCreateError = <span class="hljs-string"><span class="hljs-string">'jedi-app/jedi-create-error'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ReducerJedi</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Take a look at "Class field delcaratrions" proposal, which is now at Stage 3. // https://github.com/tc39/proposal-class-fields initialState = { loading: false, data: [], error: undefined, } @Action(actionTypeJediCreateInit) startLoading(state) { return { ...state, loading: true, } } @Action(actionTypeJediCreateSuccess) addNewJedi(state, action) { return { loading: false, data: [...state.data, action.payload], error: undefined, } } @Action(actionTypeJediCreateError) error(state, action) { return { ...state, loading: false, error: action.payload, } } }</span></span></code> </pre> <br><p>  Jetzt, da wir sehen, wo wir hin wollen, können wir es Schritt für Schritt tun. </p><br><h3 id="step-1-action-decorator">  Schritt 1. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">Aktionsdekorateur</a> . </h3><br><p>  Was wir hier tun möchten, ist, eine beliebige Anzahl von Aktionstypen zu akzeptieren und diese als Metainformationen für die Methode einer Klasse zu speichern, die später verwendet werden soll.  Zu diesem Zweck könnten wir die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Reflect</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">-Metadaten-</a> Polyfüllung verwenden, die dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Reflect-</a> Objekt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Metadatenfunktionalität</a> verleiht.  Danach würde dieser Dekorateur seine Argumente (Aktionstypen) einfach als Metadaten an eine Methode anhängen. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> METADATA_KEY_ACTION = <span class="hljs-string"><span class="hljs-string">'reducer-class-action-metadata'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Action = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">...actionTypes</span></span></span><span class="hljs-function">) =&gt;</span></span> (target, propertyKey, descriptor) =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">Reflect</span></span>.defineMetadata(METADATA_KEY_ACTION, actionTypes, target, propertyKey) }</code> </pre> <br><h3 id="step-2-creating-a-reducer-function-out-of-a-reducer-class">  Schritt 2. Erstellen einer Reduzierungsfunktion aus einer Reduzierklasse </h3><br><p>  Wie wir wissen, ist jeder Reduzierer eine reine Funktion, die einen Zustand und eine Aktion akzeptiert und einen neuen Zustand zurückgibt.  Nun, Klasse ist auch eine Funktion, aber ES6-Klassen können nicht ohne <code>new</code> aufgerufen werden, und wir müssen ohnehin mit ein paar Methoden einen tatsächlichen Reduzierer aus einer Klasse machen.  Also müssen wir es irgendwie transformieren. </p><br><p>  Wir brauchen eine Funktion, die unsere Klasse übernimmt, jede Methode durchläuft, Metadaten mit Aktionstypen sammelt, eine Reduzierungskarte erstellt und aus dieser Reduzierungskarte einen endgültigen Reduzierer erstellt. </p><br><p>  Hier erfahren Sie, wie Sie jede Methode einer Klasse untersuchen können. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> getReducerClassMethodsWthActionTypes = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">instance</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Get method names from class' prototype const proto = Object.getPrototypeOf(instance) const methodNames = Object.getOwnPropertyNames(proto).filter( (name) =&gt; name !== 'constructor', ) // We want to get back a collection with action types and corresponding reducers const res = [] methodNames.forEach((methodName) =&gt; { const actionTypes = Reflect.getMetadata( METADATA_KEY_ACTION, instance, methodName, ) // We want to bind each method to class' instance not to lose `this` context const method = instance[methodName].bind(instance) // We might have many action types associated with a reducer actionTypes.forEach((actionType) =&gt; res.push({ actionType, method, }), ) }) return res }</span></span></code> </pre> <br><p>  Jetzt wollen wir die empfangene Sammlung in eine Reduzierungskarte verarbeiten. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> getReducerMap = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">methodsWithActionTypes</span></span></span><span class="hljs-function">) =&gt;</span></span> methodsWithActionTypes.reduce(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">reducerMap, { method, actionType }</span></span></span><span class="hljs-function">) =&gt;</span></span> { reducerMap[actionType] = method <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> reducerMap }, {})</code> </pre> <br><p>  Die endgültige Funktion könnte also ungefähr so ​​aussehen. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createReducer } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-create-reducer'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> createClassReducer = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ReducerClass</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerClass = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ReducerClass() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> methodsWithActionTypes = getReducerClassMethodsWthActionTypes( reducerClass, ) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerMap = getReducerMap(methodsWithActionTypes) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = reducerClass.initialState <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducer = createReducer(initialState, reducerMap) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> reducer }</code> </pre> <br><p>  Und wir könnten es so auf unsere <code>ReducerJedi</code> Klasse anwenden. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerJedi = createClassReducer(ReducerJedi)</code> </pre> <br><h3 id="step-3-merging-it-all-together">  Schritt 3. Alles zusammenführen. </h3><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// We move that generic code to a dedicated module import { Action, createClassReducer } from 'utils/reducer-class' const actionTypeJediCreateInit = 'jedi-app/jedi-create-init' const actionTypeJediCreateSuccess = 'jedi-app/jedi-create-success' const actionTypeJediCreateError = 'jedi-app/jedi-create-error' class ReducerJedi { // Take a look at "Class field delcaratrions" proposal, which is now at Stage 3. // https://github.com/tc39/proposal-class-fields initialState = { loading: false, data: [], error: undefined, } @Action(actionTypeJediCreateInit) startLoading(state) { return { ...state, loading: true, } } @Action(actionTypeJediCreateSuccess) addNewJedi(state, action) { return { loading: false, data: [...state.data, action.payload], error: undefined, } } @Action(actionTypeJediCreateError) error(state, action) { return { ...state, loading: false, error: action.payload, } } } export const reducerJedi = createClassReducer(ReducerJedi)</span></span></code> </pre> <br><h2 id="next-steps">  Nächste Schritte </h2><br><p>  Folgendes haben wir verpasst: </p><br><ul><li>  Was ist, wenn dieselbe Aktion mehreren Methoden entspricht?  Die aktuelle Logik behandelt dies nicht. </li><li>  Können wir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">immer</a> hinzufügen? </li><li>  Was ist, wenn ich klassenbasierte Aktionen verwende?  Wie kann ich einen Aktionsersteller übergeben, keinen Aktionstyp? </li></ul><br><p>  All dies mit zusätzlichen Codebeispielen und Beispielen wird in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Reduziererklasse behandelt</a> . </p><br><p>  Ich muss sagen, dass die Verwendung von Klassen für Reduzierungen kein origineller Gedanke ist.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">@amcdnl hat vor einiger Zeit</a> großartige <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ngrx-Aktionen</a> entwickelt, aber es scheint, als ob er sich jetzt auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">NGXS</a> konzentriert, ganz zu schweigen davon, dass ich eine strengere Eingabe und Entkopplung von der Angular-spezifischen Logik wollte.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hier ist eine Liste der wichtigsten Unterschiede zwischen Reducer-Class- und Ngrx-Aktionen.</a> </p><br><blockquote>  Wenn Ihnen die Idee gefällt, Klassen für Ihre Reduzierungen zu verwenden, möchten Sie dies möglicherweise auch für Ihre Aktionsersteller tun.  Schauen Sie sich die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Flux-Action-Klasse an</a> . </blockquote><p>  Hoffentlich haben Sie etwas Nützliches für Ihr Projekt gefunden.  Zögern Sie nicht, mir Ihr Feedback mitzuteilen!  Ich freue mich über Kritik und Fragen. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de439914/">https://habr.com/ru/post/de439914/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de439902/index.html">Erklärung der physikalischen Natur des Phänomens der „Auftriebskraft des Flügels“ ohne Verwendung der Bernoulli-Gleichung. Teil 2</a></li>
<li><a href="../de439906/index.html">Kritische Sicherheitsanfälligkeit in Zemana Antivirus-Produkten und mehr</a></li>
<li><a href="../de439908/index.html">Kohl, verdammt noch mal ... Koaxial</a></li>
<li><a href="../de439910/index.html">Das Digital Rights Center lädt zum Privacy Day 2019 ein</a></li>
<li><a href="../de439912/index.html">Ungelöstes Geheimnis des Sehens</a></li>
<li><a href="../de439916/index.html">Auspacken: Dridex Bootloader</a></li>
<li><a href="../de439918/index.html">Auf dem Berg steht Spring Boot ...</a></li>
<li><a href="../de439920/index.html">Automatische Bereitstellung von Funktionen ohne Server von Git</a></li>
<li><a href="../de439922/index.html">IP-Besteuerung in Kasachstan: Wie kann man freiberuflich tätig sein?</a></li>
<li><a href="../de439924/index.html">Das Paketvolumen aus ausländischen Online-Shops stieg um 25%</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>