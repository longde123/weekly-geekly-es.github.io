<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦖 🔧 🤲🏽 Cómo PVS-Studio resultó ser más atento que tres programadores y medio 🤴🏽 ☹️ 🏓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="PVS-Studio, como otros analizadores de código estático, a menudo produce falsos positivos. Pero no se apresure a considerar falsas respuestas extrañas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cómo PVS-Studio resultó ser más atento que tres programadores y medio</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/427309/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8e1/207/92e/8e120792e15aa808598ab23995db53ab.png" alt="Cómo PVS-Studio resultó ser más atento que tres programadores y medio"></div><br>  PVS-Studio, como otros analizadores de código estático, a menudo produce falsos positivos.  Pero no se apresure a considerar falsas respuestas extrañas.  Esta es una historia corta sobre cómo PVS-Studio volvió a estar más atento a varias personas. <br><br>  El usuario escribió en apoyo de nosotros, alegando que el analizador produce inmediatamente cuatro falsos positivos por línea de código.  La carta, escrita en apoyo, inicialmente llegó a Yevgeny Ryzhkov, quien, después de leerla con fluidez y sin notar comentarios anómalos, la envió de inmediato al desarrollador principal Svyatoslav Razmyslov.  Eugene no se asomó al código, por lo que sería justo contarlo solo para la mitad del programador :). <br><a name="habracut"></a><br><br>  Svyatoslav leyó la carta y dudó de que el analizador pudiera estar tan equivocado.  Por lo tanto, vino a mí para una consulta.  Svyatoslav tenía la esperanza de que mi mirada estuviera fija y notaré algo que me diga por qué el analizador emitió todos estos mensajes extraños.  Desafortunadamente, solo confirme que los mensajes son realmente muy extraños y no deberían serlo.  Sin embargo, cuál fue la razón de su aparición, no pude notarlo.  Se decidió abrir la tarea en el rastreador de errores y comenzar a comprender lo que estaba mal. <br><br>  Y solo cuando Svyatoslav comenzó a hacer ejemplos sintéticos para describir en detalle el problema en el rastreador de errores, se le ocurrió una idea.  Veamos ahora si puede encontrar rápidamente la razón por la cual el analizador muestra 4 mensajes. <br><br>  Aquí está el texto de la carta, publicado con permiso del autor.  Y una imagen explicativa adjunta a la carta. <br><br>  Las advertencias de V560 aquí son todas falsas.  Se ejecuta con la versión más reciente de PVS-Studio para uso personal.  Básicamente, la declaración "SI" es correcta.  La externa se hace por velocidad; las internas todavía son necesarias y las no siempre son verdaderas o falsas. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e83/c09/3d7/e83c093d7e29c109f3ecd693c7941a5d.png" alt="Una carta"></div><br><br>  Ahora, querido lector, ¡es hora de ponerte a prueba!  ¿Ves el error? <br><br>  Tu tiempo para estar atento.  Y el unicornio esperará un poco. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fbc/493/aec/fbc493aec04fd30214afa75a79e6f388.png" alt="Unicornio esperando"></div><br><br>  Después de la parte introductoria del artículo, lo más probable es que muchos hayan encontrado un error.  Cuando se configura para encontrar un error, se encuentra.  Es mucho más difícil notar un error después de leer la carta, donde se llama "falsos positivos" :). <br><br>  Ahora una explicación para aquellos que son demasiado flojos para buscar un error.  Considere la condición nuevamente: <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!((ch &gt;= <span class="hljs-number"><span class="hljs-number">0x0FF10</span></span>) &amp;&amp; (ch &lt;= <span class="hljs-number"><span class="hljs-number">0x0FF19</span></span>)) || ((ch &gt;= <span class="hljs-number"><span class="hljs-number">0x0FF21</span></span>) &amp;&amp; (ch &lt;= <span class="hljs-number"><span class="hljs-number">0x0FF3A</span></span>)) || ((ch &gt;= <span class="hljs-number"><span class="hljs-number">0x0FF41</span></span>) &amp;&amp; (ch &lt;= <span class="hljs-number"><span class="hljs-number">0x0FF5A</span></span>)))</code> </pre> <br>  El autor del código planeó verificar que el personaje no se encuentre en ninguno de los tres rangos. <br><br>  El error es que el operador lógico NOT (!) Se aplica solo a la primera subexpresión. <br><br>  Si se cumple la condición: <br><br><pre> <code class="cpp hljs">!((ch &gt;= <span class="hljs-number"><span class="hljs-number">0x0FF10</span></span>) &amp;&amp; (ch &lt;= <span class="hljs-number"><span class="hljs-number">0x0FF19</span></span>))</code> </pre> <br>  entonces la evaluación de expresión se interrumpe de acuerdo con la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">evaluación de cortocircuito</a> .  Si no se cumple la condición, el valor de la variable <i>ch se</i> encuentra en el rango [0xFF10..0xFF19].  En consecuencia, otras cuatro comparaciones no tienen sentido.  Todos serán falsos o verdaderos. <br><br>  Una vez mas  Vea, si <i>ch se</i> encuentra en el rango <i>[0xFF10..0xFF19]</i> y el cálculo continúa, entonces: <br><br><ul><li>  ch&gt; = 0x0FF21 - siempre falso </li><li>  ch &lt;= 0x0FF3A - siempre cierto </li><li>  ch&gt; = 0x0FF41 - siempre falso </li><li>  ch &lt;= 0x0FF5A - siempre cierto </li></ul><br>  Esto es lo que advierte el analizador PVS-Studio. <br><br>  Entonces, el analizador estático resultó ser más atento que el usuario y dos programadores y medio de nuestro equipo. <br><br>  Para solucionar la situación, debe agregar corchetes adicionales: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(((ch &gt;= <span class="hljs-number"><span class="hljs-number">0x0FF10</span></span>) &amp;&amp; (ch &lt;= <span class="hljs-number"><span class="hljs-number">0x0FF19</span></span>)) || ((ch &gt;= <span class="hljs-number"><span class="hljs-number">0x0FF21</span></span>) &amp;&amp; (ch &lt;= <span class="hljs-number"><span class="hljs-number">0x0FF3A</span></span>)) || ((ch &gt;= <span class="hljs-number"><span class="hljs-number">0x0FF41</span></span>) &amp;&amp; (ch &lt;= <span class="hljs-number"><span class="hljs-number">0x0FF5A</span></span>))))</code> </pre> <br>  O reescribe la condición: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((ch &lt; <span class="hljs-number"><span class="hljs-number">0x0FF10</span></span>) || (ch &gt; <span class="hljs-number"><span class="hljs-number">0x0FF19</span></span>)) &amp;&amp; ((ch &lt; <span class="hljs-number"><span class="hljs-number">0x0FF21</span></span>) || (ch &gt; <span class="hljs-number"><span class="hljs-number">0x0FF3A</span></span>)) &amp;&amp; ((ch &lt; <span class="hljs-number"><span class="hljs-number">0x0FF41</span></span>) || (ch &gt; <span class="hljs-number"><span class="hljs-number">0x0FF5A</span></span>)))</code> </pre> <br>  Sin embargo, no puedo recomendar el uso de ninguna de estas opciones.  Escribiría esto para simplificar la lectura del código: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> isLetterOrDigit = (ch &gt;= <span class="hljs-number"><span class="hljs-number">0x0FF10</span></span> &amp;&amp; ch &lt;= <span class="hljs-number"><span class="hljs-number">0x0FF19</span></span>) <span class="hljs-comment"><span class="hljs-comment">// 0..9 || (ch &gt;= 0x0FF21 &amp;&amp; ch &lt;= 0x0FF3A) // A..Z || (ch &gt;= 0x0FF41 &amp;&amp; ch &lt;= 0x0FF5A); // a..z if (!isLetterOrDigit)</span></span></code> </pre> <br>  Tenga en cuenta que eliminé algunos de los corchetes.  Como acabamos de ver, una gran cantidad de paréntesis no ayudó a evitar un error en absoluto.  Los corchetes deberían facilitar la lectura del código, no más complicado.  Los programadores recuerdan bien que la prioridad de las comparaciones = &lt;, =&gt; es mayor que la del operador &amp;&amp;.  Por lo tanto, los corchetes no son necesarios aquí.  Pero si pregunta qué prioridad es &amp;&amp; o ||, muchos se confundirán.  Por lo tanto, para especificar la secuencia de cálculos &amp;&amp;, ||  los corchetes son mejores para poner. <br><br>  ¿Por qué es mejor escribir ||  Al principio describí en el artículo " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El tema principal de la programación, refactorización y todo eso</a> " (ver capítulo: Alinear el mismo tipo de código con una "tabla"). <br><br>  Gracias a todos por su atención.  Descargue y comience a usar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PVS-Studio</a> .  Ayudará a identificar muchos errores y vulnerabilidades potenciales en las primeras etapas. <br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/ts/z9/km/tsz9kmyjtteajhd4x1au60rsrvq.png" align="left"></a> </p><br><br>  Si desea compartir este artículo con una audiencia de habla inglesa, utilice el enlace a la traducción: Andrey Karpov.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cómo PVS-Studio demostró ser más atento que tres programadores y medio</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es427309/">https://habr.com/ru/post/es427309/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es427297/index.html">Apache Ignite + Apache Spark Data Frames: juntos más divertido</a></li>
<li><a href="../es427299/index.html">¿Vamos a buscar algo más para coleccionar? Constructor 3 en 1 "Flota Lunar"</a></li>
<li><a href="../es427301/index.html">Base de datos de bloqueo de GitHub</a></li>
<li><a href="../es427303/index.html">Retrasando Windows Parte 2: Creando Procesos</a></li>
<li><a href="../es427307/index.html">Práctica de prueba de backend de Java + Rest-Assured</a></li>
<li><a href="../es427311/index.html">Cómo convertirse en un centro de datos si tiene más de 40 años y no es un programador</a></li>
<li><a href="../es427313/index.html">Cómo SoftBank invierte $ 50 mil millones al año en nuevas empresas y por qué desconcierta a los inversores</a></li>
<li><a href="../es427315/index.html">Sala de lectura de Izba o una selección de literatura profesional.</a></li>
<li><a href="../es427317/index.html">Para tener éxito en el campo de TI o lo que mata a IT'shnikov?</a></li>
<li><a href="../es427319/index.html">Programador de reclutamiento de caballeros UE4, parte 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>