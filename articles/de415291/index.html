<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔒 🥟 ✌️ Radio: UKW-Radio basierend auf Atmega328-P und RDA5807M 👨‍👨‍👦‍👦 👩🏾‍💼 ✒️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Guten Tag, lieber Harazhiteli! 

 Mein Name ist Mikhail Matveev und ich möchte Sie auf ein Projekt eines modernen „Radio-Designers“ aufmerksam machen,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Radio: UKW-Radio basierend auf Atmega328-P und RDA5807M</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415291/"> Guten Tag, lieber Harazhiteli! <br><br>  Mein Name ist Mikhail Matveev und ich möchte Sie auf ein Projekt eines modernen „Radio-Designers“ aufmerksam machen, der auf Atmega328 MK und RDA5807M-Chip basiert. <br><br><h2>  Hintergrund </h2><br>  Ich denke, viele von Ihnen haben nicht nur gehört, sondern sind auch direkt auf eine Plattform wie Arduino gestoßen.  Und wie meine persönlichen Statistiken zeigen, gehen nur sehr wenige weiter als blinkende LEDs.  Als ich Arduino zum ersten Mal traf, wurde ich von der Tatsache gestoppt, dass es keine Ideen gab, wie genau ich alle Funktionen derselben UNO in „vollem Umfang“ nutzen könnte.  Genug, um nur einen einfachen Roboter auf zwei Rädern und einen Alarm zu montieren.  Ich wollte jedoch etwas gründlicheres tun. <a name="habracut"></a><br><br>  Dann erinnerte ich mich an meine Kindheit, in der es sogenannte "Radiodesigner" gab.  Ein hartes sowjetisches DIY-Kit, das bei ordnungsgemäßer Montage und ordnungsgemäßem Löten sogar zu funktionieren begann und Radiosender in verschiedenen Bereichen abfing: Jugend, Electron-M und andere. <br><br><img src="https://habrastorage.org/webt/g2/is/hc/g2ishchig43dyihdouakzc4kspq.jpeg"><br><br>  Keiner dieser Kit'ov habe ich nicht bekommen, aber ECON-1 bekommen: <br><br><img src="https://habrastorage.org/webt/3r/nu/k3/3rnuk3lqxypldc7utz_exr3mlas.jpeg"><br><br>  Der wichtigste „Trick“ dieses Designers war, dass es mit seiner Hilfe möglich war, schnell und einfach eine große Anzahl verschiedener Geräte zusammenzubauen, von einfachen „Hochtönern“ bis zu einem vollwertigen Funkempfänger. <br>  ECON-1 ist einer der vielen Gründe, warum ich im IT-Bereich gelandet bin.  Und mir kam der Gedanke, dass es schön wäre, eine moderne Version eines solchen Designers zu erstellen, damit jeder das Gerät genießen kann, das gerade mit seinen eigenen Händen zusammengebaut wurde. <br><br><h2>  Prototyp auf Leiterplatte </h2><br>  Mein Freund, ein talentierter Ingenieur, Konstantin Tomarevsky, unterstützte die Idee, und wir begannen darüber nachzudenken, wie der erste Prototyp hergestellt werden sollte. <br><br>  Die Idee war, einen FM-Empfänger zu schaffen, der über MK gesteuert werden kann. <br>  Der erste Prototyp wurde am Installationsort zusammengebaut und es wurde klar, dass es funktioniert :) <br><br><img src="https://habrastorage.org/webt/mx/37/d_/mx37d_ip32bxh5iskl8we4fvsd8.jpeg"><br><br>  Für die allererste Version wurden folgende Komponenten ausgewählt: <br><br>  1. MK Atmega328P-PU <br>  2. RDA5807M <br>  3. Nokia 5110 Display <br><br>  Ein solcher Mikrocontroller wird in Arduino UNO verwendet, unser Gerät ist auf Hardwareebene mit UNO kompatibel. <br><br>  RDA5807M ist das „Herz“ unseres Designers.  Dieser Tuner verfügt über folgende Funktionen: <br><br>  - CMOS-Technologie <br>  - Monolithisches Gehäuse, erfordert keine externen Komponenten (fast) <br>  - Frequenzband: 50-115 MHz <br>  - Schritt zwischen den Kanälen - von 200 bis 25 kHz <br>  - RDS / RBDS <br>  - ADC und eingebauter Frequenzsynthesizer <br>  - Adaptive Rauschunterdrückung <br>  - Digitale Schnittstelle (I2C) <br>  - Signalstärke (RSSI) <br>  - Verstärker <br>  - Lautstärkeregelung <br><br>  Das Display von Nokia ist schwarzweiß (84 x 48 Pixel).  Es ist sehr einfach zu verbinden und zu verwalten. <br><br>  Nach dem Löten auf der Leiterplatte stellte sich Folgendes heraus: <br><br><img src="https://habrastorage.org/webt/xh/2z/iq/xh2ziqa5kbwdzrczgj0d_buxc3q.jpeg"><br><br>  Es wurde beschlossen, den Bootloader von Arduino zu verwenden. Dadurch konnten wir die Kompatibilität mit allen zahlreichen Bibliotheken aufrechterhalten und die Eintrittsschwelle für diejenigen, die bereits Erfahrung mit der Plattform hatten, erheblich senken. <br>  Die Benutzerinteraktionsschnittstelle ist wie folgt implementiert.  Drei Tasten, die über Widerstände mit dem Analogeingang des MK verbunden sind, dienen zum Umschalten des Modus und zur Steuerung des Empfängers.  Eine weitere Taste dient zum Neustart des MK.  Der Bildschirm zeigt dementsprechend Informationen zu Lautstärke, Sender usw. an. <br><br><h2>  LUT, Fotolack und Debugging </h2><br>  Nach erfolgreichen Tests auf der Leiterplatte haben wir beschlossen, mehrere weitere Prototypen mit der LUT-Methode (und in Zukunft mit Fotolack) zu erstellen.  Wir haben uns auch entschlossen, den Receiver zu verbessern, indem wir dort einen weiteren Klangverstärker hinzufügen, um nicht nur Kopfhörer, sondern auch einen externen Lautsprecher anzuschließen.  Die Wahl fiel auf den PAM8403, einen einfachen und kostengünstigen Verstärker, der 5 V benötigt. <br><br>  Der erste nach der LUT-Methode hergestellte Prototyp sah wie folgt aus: <br><br><img src="https://habrastorage.org/webt/fn/ji/jo/fnjijodeszqegs5iffb6egidcmo.jpeg"><br><br>  LUT ist eine gute Sache für relativ schnelles Prototyping zu Hause, aber wenn es um doppelseitige Boards geht, beginnen die Schwierigkeiten.  Die Anzahl der Komponenten auf der Platine hat zugenommen. Beispielsweise haben wir beschlossen, einen Anschluss für den Programmierer auf der Platine zu platzieren, damit der MK nicht jedes Mal zum Blinken entfernt werden muss.  So wurde der nachfolgende Prototyp zweiseitig, wurde nach der Fotolackmethode hergestellt und sah viel schöner aus: <br><br><img src="https://habrastorage.org/webt/5f/wf/dk/5fwfdkhw4vfrv85qfcldmzgtx8i.jpeg"><br><br>  In der Montage: <br><br><img src="https://habrastorage.org/webt/li/zw/yt/lizwytnutcsp25hppt4ekhlvik0.jpeg"><br><br>  Der nächste Schritt war die Ablehnung der „schwenkbaren“ Komponenten, die wir mit einreihigen PINs auf der Platine platziert haben.  Daher wurde beschlossen, den Verstärker durch einen LM386N zu ersetzen und einen CD4050BE-Pegelwandler zu installieren.  All dies komplizierte das Design, aber das Gerät sah viel besser aus. <br><br>  Der endgültige Prototyp, den wir zu Hause hergestellt haben, sah folgendermaßen aus: <br><br><img src="https://habrastorage.org/webt/ba/0k/bv/ba0kbvebxojxd2jhnatgbhetrhs.jpeg"><br><br><h2>  Leiterplattenbestellung </h2><br>  In China können Sie Leiterplatten bestellen, die auf industrielle Weise hergestellt wurden.  Die Kosten sind selbst bei kleinen Auflagen relativ gering und die Wartezeit (einschließlich Lieferung) beträgt in der Regel nicht mehr als 2-3 Wochen. <br><br>  Die erste "Charge" von Karten, die auf PCBWay bestellt wurden.  Also sah sie: <br><br><img src="https://habrastorage.org/webt/kd/uk/bw/kdukbwgr9upfot-ygn61o0r860c.jpeg"><br><br>  Eines der Probleme, die wir durch Unerfahrenheit hatten: Die Metallisierung „frisst“ einen erheblichen Teil der Größe des Lochs selbst, sodass einige Komponenten kaum in die gewünschten Löcher „passen“.  Beim Entwurf einer Schaltung muss dieser Punkt berücksichtigt werden. <br><br>  Basierend auf den Testergebnissen haben wir das Design weiter verfeinert, indem wir mehrere Kondensatoren für einen stabileren Betrieb des Geräts hinzugefügt haben.  Wir haben einen weiteren Prototyp gesammelt: <br><br><img src="https://habrastorage.org/webt/8s/-h/3y/8s-h3y55bje7nttvkmj_z_zyvjk.jpeg"><br><br>  Über den USB-Anschluss wird der Empfänger mit Strom versorgt.  Die Stromversorgung erfolgt auch, wenn der Programmierer angeschlossen ist. <br><br>  Alles arbeitet! <br><br><h2>  Firmware </h2><br>  Wir sollten uns auch mit der Firmware befassen.  Es ist in C ++ geschrieben und wir vertreiben es unter der GPLv3-Lizenz: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://github.com/xtremespb/fm_receiver.</a> Ich habe praktisch nicht in C / C ++ entwickelt, daher ist der Code (wahrscheinlich) alles andere als ideal und kann Fehler enthalten, aber die GPL und die GPL, damit sie von der Community weiterentwickelt werden kann :) <br><br>  Zu den aktuellen Firmware-Funktionen gehören: <br><br>  - Manuelle und automatische Abstimmung von Sendern <br>  - RDS <br>  - Lautstärkeregler <br>  - Aktivieren des erweiterten Bassmodus <br>  - Schalten Sie die Hintergrundbeleuchtung des Displays ein oder aus <br>  - Anzeige und dynamische Visualisierung des Signalpegels <br><br>  In der nächsten, vierten Revision werden wir einige nützlichere „Chips“ herstellen: Wir werden den linken und den rechten Kanal mit den analogen Eingängen des MK verbinden, um das eingehende Audiosignal zu „visualisieren“. <br><br>  Die Funktionen des Geräts sind übrigens nicht auf das Radio beschränkt!  Niemand stört sich zum Beispiel daran, ein Spiel (aus Gründen des Interesses habe ich das gute alte Arkanoid gemacht) oder ein anderes Programm zu schreiben, das die Fähigkeiten des Bretts nutzt. <br><br><h2>  Produktion </h2><br>  Die Entwicklung des Geräts von der Idee bis zur Implementierung dauerte ungefähr 6 Monate, was bei fast vollständigem Mangel an Erfahrung auf diesem Gebiet nicht so schlimm ist. <br><br>  Im Moment haben wir ungefähr 10 fertig montierte Kits, die alles enthalten, was Sie zum Bau Ihres eigenen Geräts benötigen: <br><br>  - MK Atmega328P-PU <br>  - Pegelwandler CD4050BE <br>  - Zeigen Sie das Nokia 5110 an <br>  - Empfänger RDA5807M <br>  - USBasp-Programmierer <br>  - Operationsverstärker LM386N <br>  - Anschlüsse für MK und Programmierer <br>  - USB B, Audio-Buchse 3.5, drei Tasten, Kabel, einreihige Anschlüsse <br>  - 11 Widerstände und 12 Kondensatoren, 4 Induktivitäten, Quarz, eine Zenerdiode und eine LED <br>  - Lautsprecher <br>  - Leiterplatte <br><br>  Für die Montage benötigen Sie Lötmittel, Flussmittel und einen Lötkolben, sonst wird nichts benötigt. <br>  Alle Komponenten sind in einer kleinen Schachtel „Bastelkarton“ verpackt: <br><br><img src="https://habrastorage.org/webt/mr/b3/5c/mrb35cyc1fyt3lgxmrh1zdykqxs.jpeg"><br><br>  Firmware-Quellen wurden bereits auf Github veröffentlicht.  Die Gerber-Datei, das schematische Diagramm und die Montageanleitung werden ebenfalls später veröffentlicht. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de415291/">https://habr.com/ru/post/de415291/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de415279/index.html">Warum mit einem Mikroskop Nägel einschlagen, wenn Sie Alpine Linux haben?</a></li>
<li><a href="../de415283/index.html">OWASP TOP 10 Projekt: Einführung</a></li>
<li><a href="../de415285/index.html">MBLT DEV 2018: Erstredner und neueste Frühbuchertickets</a></li>
<li><a href="../de415287/index.html">Klassifikation der Eigenschaften von Raum-Zeit-Volumina (Luftverteidigung)</a></li>
<li><a href="../de415289/index.html">Crowd-Tests oder Wo Sie Erfahrungen für die erste Testarbeit sammeln können</a></li>
<li><a href="../de415293/index.html">Dunkle Solitonen, Frequenzkämme, Mikrokavitäten und 80 km Glasfaserkabel</a></li>
<li><a href="../de415297/index.html">Xbox Underground. Jung und nachlässig</a></li>
<li><a href="../de415299/index.html">Zabbix Moscow Meetup 2018 bei Badoo: Rückblick und Materialien</a></li>
<li><a href="../de415301/index.html">Code-Grundlagen: Kostenlose Tutorials für Anfänger</a></li>
<li><a href="../de415303/index.html">Die Sprache der Rolling Stones: Wie zeichnet man ein Logo für alle Zeiten? Interview mit dem Schöpfer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>