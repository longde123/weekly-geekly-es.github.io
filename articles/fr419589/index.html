<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§≤üèΩ ‚õπüèæ ü§∏üèª Nous utilisons AMP comme une biblioth√®que polyvalente pour cr√©er des sites dynamiques rapides üò¨ üôåüèª üïò</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Changer la premi√®re impression est tr√®s difficile. Et je ne parle pas seulement des gens. Les technologies deviennent aussi souvent des otages de la p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous utilisons AMP comme une biblioth√®que polyvalente pour cr√©er des sites dynamiques rapides</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/google/blog/419589/"><p>  Changer la premi√®re impression est tr√®s difficile.  Et je ne parle pas seulement des gens.  Les technologies deviennent aussi souvent des otages de la premi√®re impression - leur premi√®re version.  Et puis, malgr√© des ann√©es de d√©veloppement, de nouvelles opportunit√©s et l'√©limination des anciennes lacunes, dans la conscience de masse, la technologie reste tr√®s imparfaite, sa premi√®re version.  Ceux qui n'essaient pas de faire face √† ce type de biais cognitifs ne peuvent que regarder les succ√®s de concurrents utilisant des technologies famili√®res dans de nouveaux sc√©narios, avec une question stupide: ¬´Qu'est-ce qui aurait pu arriver!?¬ª. </p><br><p><img src="https://habrastorage.org/webt/e_/vr/6w/e_vr6w51_va8sq7tshdt8ue6dha.jpeg"></p><br><p>  AMP - Accelerated Mobile Pages est l'exemple le plus frappant d'une technologie qui a pris une longueur d'avance par rapport √† ce qu'elle √©tait au tout d√©but.  De nombreux d√©veloppeurs per√ßoivent AMP comme un moyen de mettre le contenu statique de leur site (articles, actualit√©s, notes, etc.) dans le cache Google, de sorte que lorsqu'ils s'ouvrent √† partir de la recherche, ce contenu se charge instantan√©ment (l'ic√¥ne de foudre dans les r√©sultats de la recherche indique une vitesse de chargement √©lev√©e des pages AMP: )).  Naturellement, si vous avez besoin d'obtenir un tel r√©sultat, alors avec AMP, ce sera tr√®s facile √† faire.  Mais AMP est bien plus qu'une technologie pour travailler avec du contenu statique ou le cache de Google.  AMP a longtemps √©t√© utilis√© comme une biblioth√®que polyvalente bas√©e sur des composants Web pour cr√©er des pages dynamiques rapides et m√™me des sites Web entiers que les utilisateurs obtiennent √† la fois de la recherche et d'autres sources, y compris les visites directes.  De ce point de vue, l'AMP peut √™tre mis sur un pied d'√©galit√© avec Polymer, React ou Angular.  Naturellement, en tenant compte du fait que AMP est con√ßu pour des sites simples (quoi que cela signifie) o√π l'accent est mis sur le contenu et le composant dynamique est limit√©. </p><br><p><img src="https://habrastorage.org/webt/id/l2/sr/idl2srdzomaaloufat7nsnsinbu.gif"></p><a name="habracut"></a><br><p>  Je voudrais √©galement noter que malgr√© le nom Accelerated Mobile Pages, AMP peut √™tre utilis√© pour cr√©er des sites, √† la fois de bureau et mobiles.  Le site Web du projet - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ampproject.org</a> est un excellent exemple de ce que AMP peut faire pour le bureau. </p><br><p>  Dans cet article, nous examinerons la technologie AMP elle-m√™me, parlerons de ses capacit√©s et de ses limites, et ferons √©galement le choix d'AMP pour une boutique en ligne avec la prise en charge du chargement, de l'affichage, du filtrage et de la recherche de produits.  Cet exemple n'a pas √©t√© choisi par hasard, car le commerce √©lectronique est le deuxi√®me domaine le plus populaire apr√®s les sites d'actualit√©s o√π AMP est le plus utilis√©. </p><br><p>  Vous pouvez voir la page de destination termin√©e dans le GIF ci-dessus. </p><br><p> AMP est consacr√© √† de nombreux articles, parmi lesquels vous pouvez trouver tr√®s critique.  La plupart de ces articles se concentrent sur un c√¥t√© de la technologie AMP, √† savoir le cache.  Apr√®s tout, si la page du site est mise en cache, puis, lorsque vous cliquez sur une recherche, elles ne sont pas ouvertes directement, cela impose in√©vitablement des restrictions.  Les utilisateurs semblent faire le tour de votre site.  Une question sacramentelle se pose: qui en profite?  Il peut √™tre plus rentable de toujours donner du contenu directement?  √Ä en juger par le fait que l'AMP est activement utilis√© par les √©diteurs de contenu, la plupart d'entre eux sont certainement rentables pour utiliser le cache - leurs sites de recherche s'ouvrent instantan√©ment.  Le principal probl√®me avec le cache est que dans la barre d'adresse du navigateur, l'utilisateur ne voit pas l'adresse du site lui-m√™me, qui h√©berge les pages AMP, par exemple <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.vedomosti.ru</a></em> , mais l'adresse dans le cache, dans ce cas, ce sera comme ceci: <em><a href="">www.google.com/ amp / s / www.vedomosti.ru</a></em> . </p><br><p>  Ce comportement n'est pas un moyen malveillant de retirer les utilisateurs de votre site.  Il s'agit plut√¥t d'un probl√®me technique qui n'a pu √™tre r√©solu autrement.  Les d√©veloppeurs AMP travaillent activement sur une solution √† ce probl√®me.  La nouvelle norme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Web Packaging</a> aidera.  Gr√¢ce √† lui, lors du chargement dans le cache, les donn√©es sont sign√©es par le certificat du domaine source, et par cons√©quent, lors de l'affichage des pages AMP du cache, le domaine d'origine, et non l'adresse du cache, sera affich√© dans la barre d'adresse. </p><br><p>  D'un autre c√¥t√©, le probl√®me du cache, s'il est pertinent, concerne principalement les √©diteurs de contenu.  Si l'actif principal est des articles ou des nouvelles, alors pour tout √©diteur, il est important de savoir comment et √† qui ils sont diffus√©s.  Et le fait que les √©diteurs se m√©fiaient initialement de l'AMP est compr√©hensible.  D'o√π beaucoup de controverse sur ce sujet.  D'un autre c√¥t√©, le commerce √©lectronique est un sc√©nario compl√®tement diff√©rent.  Pour le propri√©taire d'une boutique en ligne, d'un site de vente de billets pour des concerts, d'une banque acceptant des demandes de cartes de cr√©dit ou d'un salon de beaut√© qui enregistre des clients, il est primordial que les clients viennent acheter.  La conversion est importante.  Et s'il existe une technologie qui permettra d'acc√©l√©rer les sites, augmentant ainsi la conversion, alors l'utilisation de cette technologie sera, bien s√ªr, b√©n√©fique. </p><br><h1>  Ampli </h1><br><p>  Qu'est-ce qui rend les sites Web rapides?  Vous les rendez rapides, d√©veloppeurs!  Il n'y a pas de magie, les sites rapides sont rapides parce que leurs d√©veloppeurs se soucient des performances et travaillent dessus pour am√©liorer les sites.  Il existe un ensemble de meilleures pratiques et astuces pour cr√©er des sites qui se chargent rapidement et fonctionnent rapidement.  Par exemple, il est pr√©f√©rable de charger des images lourdes uniquement au moment o√π l'utilisateur les fait d√©filer, et pas imm√©diatement lors de l'ouverture de la page.  Il convient √©galement de limiter le nombre total de ressources t√©l√©charg√©es, en utilisant des scripts asynchrones, etc.  Le seul probl√®me est que toutes ces pratiques doivent √™tre m√©moris√©es, gard√©es √† l'esprit, ainsi que de surveiller constamment leur application.  C'est compliqu√©.  Il y a toujours la tentation de faire quelque chose qui ne sera pas conforme aux meilleures pratiques, mais qui sera plus facile √† mettre en ≈ìuvre. </p><br><p>  AMP est une technologie avec laquelle il est facile de faire la bonne chose (et finalement d'obtenir un site rapide).  Et rendre un site utilisant AMP lent est difficile.  Ceci est r√©alis√© √† travers un ensemble de contraintes, ainsi qu'un validateur qui v√©rifie ces contraintes.  Si la page est valid√©e, elle peut √™tre mise en cache.  Autrement dit, AMP vous restreint d√©lib√©r√©ment - et c'est l'id√©e principale de cette technologie, mais en retour, vous gagnez la confiance que vous utilisez les meilleures pratiques.  Vous n'avez pas besoin d'√™tre un expert en optimisation pour obtenir un bon r√©sultat en utilisant AMP.  Les meilleures pratiques sont utilis√©es par d√©faut et le potentiel d'erreurs est minimis√©. </p><br><p>  Dans le m√™me temps, AMP n'est pas un autre type de HTML, c'est une biblioth√®que ordinaire dans laquelle il n'y a rien qui ne serait pas accessible aux cr√©ateurs d'autres biblioth√®ques.  Avec AMP, vous utilisez le balisage HTML r√©gulier ainsi que les styles CSS.  Vous pouvez cr√©er un site entier sur AMP s'il est assez simple (un exemple typique est toutes sortes de pages de destination), et si les capacit√©s AMP deviennent insuffisantes, vous pouvez toujours ajouter des pages non AMP. </p><br><p>  D'un autre c√¥t√©, les optimisations utilis√©es dans AMP peuvent se faire sans AMP, mais cela demandera beaucoup d'efforts et de temps.  Dans tous les cas, m√™me si pour une raison quelconque vous d√©cidez de ne pas utiliser AMP, il est logique d'√©tudier au moins le fonctionnement de cette biblioth√®que et ce qu'elle fait pour appliquer ces approches √† vos sites.  Il peut sembler que la promotion d'AMP est la promotion d'une biblioth√®que particuli√®re, et non la performance de sites en tant que tels.  Mais ce n'est pas le cas: avoir un site Web productif est beaucoup plus important que d'utiliser l'une ou l'autre biblioth√®que ou framework. </p><br><p>  Encore une fois, je voudrais noter que toutes les restrictions impos√©es par AMP ne sont pas de nature id√©ologique, mais sont caus√©es par des consid√©rations utilitaires - elles vous permettent de cr√©er des sites rapides.  Le point.  Si, √† l'avenir, il existe un moyen, sans sacrifier les performances, de supprimer l'une ou l'autre limitation, elle sera bien s√ªr lev√©e. </p><br><p>  Quelles sont les limites de l'AMP?  La limitation la plus importante est que les pages ne peuvent pas contenir de code JavaScript arbitraire.  La seule chose pour laquelle vous pouvez utiliser un JavaScript limit√© est la liaison de donn√©es.  De plus, vous ne pouvez pas connecter de fichiers JavaScript et CSS externes.  Il existe des exceptions: il s'agit de la biblioth√®que AMP elle-m√™me, ainsi que d'une liste de composants approuv√©s (vous pouvez participer au d√©veloppement d'AMP et cr√©er vos propres composants).  Tous les CSS doivent √™tre sur la page elle-m√™me et son volume est limit√© √† 50 kilo-octets.  De plus, vous ne pouvez pas utiliser une partie des balises HTML, telles que &lt;img /&gt;; √† la place, elles utilisent les composants Web inclus dans le package AMP.  Par exemple, le composant &lt;amp-img /&gt; est utilis√© √† la place de &lt;img /&gt;.  Cela est n√©cessaire pour qu'AMP puisse contr√¥ler le chargement des ressources.  Il existe √©galement de l√©g√®res restrictions CSS caus√©es par des consid√©rations de performances (vous ne pouvez pas utiliser le modificateur! Important et les animations non acc√©l√©r√©es par le GPU).  En fait, c'est tout.  AMP fournit un riche ensemble de composants, ce qui √©limine en partie l'impossibilit√© d'√©crire du code JavaScript arbitraire.  L'ensemble des composants comprend, par exemple, <strong>amp-date-picker</strong> , <strong>amp-sidebar</strong> , <strong>amp-user-notification</strong> , <strong>amp-facebook-like</strong> , <strong>amp-access</strong> , avec lequel vous pouvez impl√©menter la prise en charge de l'authentification, et bien d'autres.  Et dans des cas tr√®s extr√™mes, quand il n'y a pas d'autre issue, vous pouvez utiliser des iframes avec du contenu non AMP. </p><br><p>  Avant de commencer √† travailler avec AMP, je vous recommande d'√©tudier la documentation sur le site Web du projet - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ampproject.org</a> .  De plus, il est utile de consulter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ampbyexample.com</a> , qui contient d'excellents exemples, dont la plupart peuvent √™tre utilis√©s pratiquement sans modification de projets r√©els.  Si vous avez besoin de mod√®les pr√™ts √† l'emploi, ils sont disponibles sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ampstart.com</a> . </p><br><p><img src="https://habrastorage.org/webt/lv/cp/n3/lvcpn3hhaqefftseopfyp3ko90m.jpeg"></p><br><h1>  Cr√©ation d'AMP Landing </h1><br><p>  Cr√©ons une page de destination pour un magasin de v√©los en ligne avec une liste de produits, le filtrage et la recherche.  Nos produits se chargeront dynamiquement.  √Ä des fins de formation, nous n'utiliserons pas de mod√®les pr√™ts √† l'emploi, mais nous ferons tout √† partir de z√©ro.  Le code du projet peut √™tre trouv√© sur GitHub: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://github.com/spugachev/amp-article</a> </p><br><p>  Le r√©f√©rentiel contient un backend sur Node.js, ainsi que des pages AMP situ√©es dans le dossier public.  Pour d√©marrer le projet, vous devez cloner le r√©f√©rentiel et ex√©cuter les commandes suivantes dans le dossier du projet (Node.js doit √™tre install√©). </p><br><pre><code class="bash hljs">&gt;&gt; npm install &gt;&gt; npm start</code> </pre> <br><h2>  Mod√®le de page </h2><br><p>  Cr√©ez une page AMP minimale.  Son code est pr√©sent√© ci-dessous.  Dans le projet que vous avez t√©l√©charg√© depuis GitHub, la page principale public / index.html est intentionnellement laiss√©e vierge, et nous l'utiliserons pour √©crire du code. </p><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!doctype html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amp</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">async</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://cdn.ampproject.org/v0.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"canonical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://amp-bike-shop.com/index.html"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewport"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width=device-width,minimum-scale=1,initial-scale=1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amp-boilerplate</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">body</span></span></span><span class="css">{</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-webkit-animation</span></span></span><span class="css">:-amp-start </span><span class="hljs-number"><span class="css"><span class="hljs-number">8s</span></span></span><span class="css"> </span><span class="hljs-built_in"><span class="css"><span class="hljs-built_in">steps</span></span></span><span class="css">(1,end) </span><span class="hljs-number"><span class="css"><span class="hljs-number">0s</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">1</span></span></span><span class="css"> normal both;</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-moz-animation</span></span></span><span class="css">:-amp-start </span><span class="hljs-number"><span class="css"><span class="hljs-number">8s</span></span></span><span class="css"> </span><span class="hljs-built_in"><span class="css"><span class="hljs-built_in">steps</span></span></span><span class="css">(1,end) </span><span class="hljs-number"><span class="css"><span class="hljs-number">0s</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">1</span></span></span><span class="css"> normal both;</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-ms-animation</span></span></span><span class="css">:-amp-start </span><span class="hljs-number"><span class="css"><span class="hljs-number">8s</span></span></span><span class="css"> </span><span class="hljs-built_in"><span class="css"><span class="hljs-built_in">steps</span></span></span><span class="css">(1,end) </span><span class="hljs-number"><span class="css"><span class="hljs-number">0s</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">1</span></span></span><span class="css"> normal both;</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">animation</span></span></span><span class="css">:-amp-start </span><span class="hljs-number"><span class="css"><span class="hljs-number">8s</span></span></span><span class="css"> </span><span class="hljs-built_in"><span class="css"><span class="hljs-built_in">steps</span></span></span><span class="css">(1,end) </span><span class="hljs-number"><span class="css"><span class="hljs-number">0s</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">1</span></span></span><span class="css"> normal both}@-</span><span class="hljs-keyword"><span class="css"><span class="hljs-keyword">webkit</span></span></span><span class="css">-</span><span class="hljs-keyword"><span class="css"><span class="hljs-keyword">keyframes</span></span></span><span class="css"> -amp-start{</span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">from</span></span></span><span class="css">{</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">visibility</span></span></span><span class="css">:hidden}</span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">to</span></span></span><span class="css">{</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">visibility</span></span></span><span class="css">:visible}}@-</span><span class="hljs-keyword"><span class="css"><span class="hljs-keyword">moz</span></span></span><span class="css">-</span><span class="hljs-keyword"><span class="css"><span class="hljs-keyword">keyframes</span></span></span><span class="css"> -amp-start{</span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">from</span></span></span><span class="css">{</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">visibility</span></span></span><span class="css">:hidden}</span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">to</span></span></span><span class="css">{</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">visibility</span></span></span><span class="css">:visible}}@-</span><span class="hljs-keyword"><span class="css"><span class="hljs-keyword">ms</span></span></span><span class="css">-</span><span class="hljs-keyword"><span class="css"><span class="hljs-keyword">keyframes</span></span></span><span class="css"> -amp-start{</span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">from</span></span></span><span class="css">{</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">visibility</span></span></span><span class="css">:hidden}</span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">to</span></span></span><span class="css">{</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">visibility</span></span></span><span class="css">:visible}}@-</span><span class="hljs-keyword"><span class="css"><span class="hljs-keyword">o</span></span></span><span class="css">-</span><span class="hljs-keyword"><span class="css"><span class="hljs-keyword">keyframes</span></span></span><span class="css"> -amp-start{</span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">from</span></span></span><span class="css">{</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">visibility</span></span></span><span class="css">:hidden}</span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">to</span></span></span><span class="css">{</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">visibility</span></span></span><span class="css">:visible}}@</span><span class="hljs-keyword"><span class="css"><span class="hljs-keyword">keyframes</span></span></span><span class="css"> -amp-start{</span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">from</span></span></span><span class="css">{</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">visibility</span></span></span><span class="css">:hidden}</span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">to</span></span></span><span class="css">{</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">visibility</span></span></span><span class="css">:visible}}</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">noscript</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amp-boilerplate</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">body</span></span></span><span class="css">{</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-webkit-animation</span></span></span><span class="css">:none;</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-moz-animation</span></span></span><span class="css">:none;</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">-ms-animation</span></span></span><span class="css">:none;</span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">animation</span></span></span><span class="css">:none}</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">noscript</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amp-custom</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css"> </span><span class="hljs-comment"><span class="css"><span class="hljs-comment">/*     */</span></span></span><span class="css"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>   AMP  !<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  La premi√®re chose qui attire votre attention dans l'exemple ci-dessus - le balisage HTML contient une indication explicite qu'il s'agit d'une page AMP.  Ceci est r√©alis√© soit en ajoutant un symbole de foudre √† la balise html (malheureusement le symbole Habr coupe un symbole de foudre), soit en y ajoutant le mot "amp".  Sans une telle indication, la page ne sera pas valid√©e et ne sera pas ajout√©e au cache Google lors de l'indexation. </p><br><p>  Ensuite, vous devez connecter la biblioth√®que JavaScript AMP: </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">async</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://cdn.ampproject.org/v0.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Vous devez √©galement sp√©cifier l'adresse canonique de la page.  S'il existe une version non AMP de la page, son adresse est indiqu√©e.  Sinon, l'adresse de la page AMP elle-m√™me est indiqu√©e. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"canonical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://amp-bike-shop.com/index.html"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  De plus, vous devez ajouter une balise META pour la mise √† l'√©chelle, ainsi que des styles CSS de mod√®le.  Ces styles ne peuvent pas √™tre modifi√©s.  Ils sont n√©cessaires pour que lors du chargement de la page, mais avant de charger la biblioth√®que JavaScript AMP, le contenu non stylis√© ne clignote pas √† l'√©cran.  Si pour une raison quelconque la biblioth√®que ne se charge pas, le contenu sera en tout cas affich√© apr√®s huit secondes. </p><br><p>  Placez l'image √† l'aide du composant amp-image en haut de la page.  En d√©finissant layout = "responsive", l'image sera √©tir√©e sur toute la largeur du conteneur. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hero-img"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"img/hero.jpg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"320"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"213"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">layout</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"responsive"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-img</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Ci-apr√®s, je ne donnerai pas de styles CSS, et ils peuvent √™tre trouv√©s dans le r√©f√©rentiel de projet sur GitHub.  Alors ... </p><br><p>  Ex√©cutez le projet et ouvrez la page principale dans un navigateur.  Si le param√®tre # development = 1 est ajout√© √† l'adresse de la page, la page sera automatiquement valid√©e et des informations √† ce sujet seront affich√©es sur la console du navigateur.  Dans le m√™me but, vous pouvez utiliser l'extension Chrome appel√©e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AMP Validator</a> . </p><br><p>  Par exemple, si au lieu de &lt;amp-img /&gt; une balise &lt;img /&gt; r√©guli√®re √©tait utilis√©e, une telle page ne passerait pas la validation, ce qui serait indiqu√© par un message correspondant. </p><br><p><img src="https://habrastorage.org/webt/zo/zx/hb/zozxhbb-dfjujwhqpkg2gbhmkb8.jpeg"></p><br><h2>  Chargement et affichage des donn√©es </h2><br><p>  Nous avons maintenant une page AMP de base avec une image pour attirer l'attention et le nom du magasin.  Il est maintenant temps de t√©l√©charger la liste des produits depuis le serveur et de l'afficher sur la page.  Le projet Backed comprend d√©j√† un service qui renvoie une liste de marchandises (dans ce cas, des v√©los) au format JSON. </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> /api/bikes [ { "id":<span class="hljs-number"><span class="hljs-number">1</span></span>, "img":"img/01.jpg", "title":" ", "price":"28500", "available":<span class="hljs-keyword"><span class="hljs-keyword">false</span></span> }, { "id":<span class="hljs-number"><span class="hljs-number">2</span></span>, "img":"img/02.jpg", "title":" ", "price":"14750", "available":<span class="hljs-keyword"><span class="hljs-keyword">true</span></span> }, { "id":<span class="hljs-number"><span class="hljs-number">3</span></span>, "img":"img/03.jpg", "title":" ", "price":"31200", "available":<span class="hljs-keyword"><span class="hljs-keyword">true</span></span> }, ‚Ä¶ ]</code> </pre> <br><p>  Comme AMP ne vous permet pas d'√©crire du code JavaScript arbitraire, toutes les actions, y compris le chargement des donn√©es, sont d√©finies dans un style d√©claratif.  Nous devons connecter plusieurs composants √† la page qui chargera et affichera les donn√©es, et nous permettra √©galement d'utiliser des mod√®les.  √âtant donn√© qu'il s'agira de composants AMP standard, nous sommes autoris√©s √† les connecter.  Nous aurons besoin des composants: </p><br><ul><li>  <strong>amp-bind</strong> pour prendre en charge la liaison de donn√©es, </li><li>  <strong>amp-moustache</strong> pour travailler avec des mod√®les au format moustache </li><li>  ainsi qu'une <strong>liste</strong> d' <strong>amplis</strong> pour travailler avec une liste qui chargera et affichera les donn√©es. <br>  Connectez les fichiers n√©cessaires dans l'en-t√™te de page: </li></ul><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">async</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">custom-element</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"amp-bind"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://cdn.ampproject.org/v0/amp-bind-0.1.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">async</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">custom-template</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"amp-mustache"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://cdn.ampproject.org/v0/amp-mustache-0.2.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">async</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">custom-element</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"amp-list"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://cdn.ampproject.org/v0/amp-list-0.1.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Ajoutez le composant de liste √† la page: </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-list</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"offers"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3720"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">layout</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fixed-height"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"//localhost:3000/api/bikes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">items</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"."</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">&gt;</span></span>...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fallback</span></span></span><span class="hljs-tag">&gt;</span></span>  .<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"amp-mustache"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"card"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"height: 340px;"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"200"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">layout</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fixed-height"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{img}}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{title}}-{{price}}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-img</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hr</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>{{title}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> {{#available}}<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>{{/available}} {{^available}}<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>{{/available}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>{{price}} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-list</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  La propri√©t√© src est d√©finie pour le composant, qui d√©termine d'o√π proviendront les donn√©es (dans notre cas, une demande GET sera ex√©cut√©e dans ¬´// localhost: 3000 / api / bikes¬ª), ainsi que la propri√©t√© items, qui vous permet de rechercher un tableau d'√©l√©ments pour la liste dans la r√©ponse JSON du serveur.  Puisque la r√©ponse elle-m√™me est un tableau, la valeur de la propri√©t√© items indique la racine de la r√©ponse. </p><br><p>  Ensuite, nous d√©finissons un stub qui sera affich√© lors du chargement des donn√©es, ainsi qu'un stub en cas d'erreur.  Mais le plus int√©ressant est, bien s√ªr, le mod√®le d'√©l√©ment de liste.  Le format du mod√®le est tr√®s simple, je pense que la syntaxe des mod√®les de moustache ne n√©cessite pas d'explication suppl√©mentaire. </p><br><p>  Ajoutez le code ci-dessus, actualisez la page et consultez la liste des produits affich√©s sur la page.  Avec un balisage simple et sans √©crire de code JavaScript, nous avons charg√© les donn√©es et affich√© les donn√©es sur la page (√† l'aide d'une liste et d'un mod√®le). </p><br><h2>  Filtrage des donn√©es </h2><br><p>  Chaque page AMP a un √©tat.  Il peut √™tre consid√©r√© comme un objet avec une hi√©rarchie de propri√©t√©s.  L'√©tat de la page peut √™tre modifi√© dans les gestionnaires d'√©v√©nements √† l'aide de la fonction AMP.setState. </p><br><p>  Ajoutez un filtre qui vous permet d'afficher uniquement les v√©los disponibles.  Pour ce faire, nous allons placer une case √† cocher sur la page, en cliquant dessus, nous allons changer l'√©tat de la page en affectant √† la seule variable Disponible la valeur (selon que la case √† cocher est coch√©e ou non).  Le nom de la variable est arbitraire, elle pourrait s'appeler n'importe quoi.  Veuillez noter que AMP impl√©mente sa propre fa√ßon de g√©rer les √©v√©nements.  Vous pouvez g√©rer plusieurs √©v√©nements √† la fois et pour chaque √©v√©nement, vous pouvez avoir plusieurs actions. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"checkbox"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">on</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"change:AMP.setState({ onlyAvailable: event.checked })"</span></span></span><span class="hljs-tag">/&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Le m√©canisme de liaison de donn√©es vous permet de lier des variables d'√©tat de page avec des valeurs de propri√©t√© dans le balisage HTML.  Pour que la biblioth√®que AMP effectue une telle liaison, le nom de la propri√©t√© qui doit recevoir la valeur doit √™tre pris entre crochets - [].  Par exemple, nous ajouterons ou supprimerons la classe CSS ¬´active¬ª (il s'agit d'une classe non standard et elle est d√©finie par nous) en fonction de la valeur de la variable onlyAvailable. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"onlyAvailable? 'active' : ''"</span></span></span><span class="hljs-tag"> &gt;</span></span></code> </pre> <br><p>  En mode d√©veloppement (# development = 1), l'√©tat de la page peut √™tre affich√© sur la console du navigateur √† l'aide de la fonction AMP.printState (); </p><br><p><img src="https://habrastorage.org/webt/mz/2_/4u/mz2_4uea5ywl0uixwmu3fz669sa.jpeg"></p><br><p>  Ajoutez maintenant la liste des produits √† l'√©tat de la page.  Pour ce faire, nous utilisons un composant d' <strong>√©tat d'ampli</strong> distinct.  Le composant t√©l√©chargera les donn√©es de la m√™me source que la <strong>liste d'amplis</strong> , mais il ne se rechargera pas, car AMP contr√¥le le chargement des donn√©es et √©vite les demandes inutiles.  De plus, nous ajoutons une macro qui, lors de la modification de la valeur de la variable onlyAvailable, filtrera la liste des produits. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-state</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bikes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"//localhost:3000/api/bikes"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-state</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-bind-macro</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"filteredBikes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">expression</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bikes.filter(bike =&gt; onlyAvailable ? bike.available : true)"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-bind-macro</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Nous allons maintenant utiliser la liste filtr√©e comme source de donn√©es pour le composant <strong>amp-list</strong> .  Pour ce faire, nous associons la propri√©t√© src du composant √† la macro filterBikes.  Et connectez √©galement la propri√©t√© de la hauteur du composant avec le nombre d'√©l√©ments.  Cela est n√©cessaire, car la hauteur du composant <strong>amp-list</strong> ne sera pas automatiquement ajust√©e au nombre d'√©l√©ments.  Dans cet exemple, le nombre 340 est la hauteur de la carte du produit et 16 est l'indentation au-dessus et en dessous. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-list</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"offers"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3720"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">layout</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fixed-height"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"//localhost:3000/api/bikes"</span></span></span><span class="hljs-tag"> [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"filteredBikes()"</span></span></span><span class="hljs-tag"> [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"(340 + (16*2)) * filteredBikes().length"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">items</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"."</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Veuillez noter que le chargement explicite des donn√©es en d√©finissant la propri√©t√© src = "// localhost: 3000 / api / bikes" reste.  Vous ne pouvez pas le supprimer.  Lors du chargement d'une page AMP pour des raisons de performances, la liaison de donn√©es n'est pas effectu√©e automatiquement.  Il ne sera ex√©cut√© qu'apr√®s les actions de l'utilisateur, comme cliquer sur la case √† cocher. </p><br><p>  Ouvrez la page r√©sultante et v√©rifiez que le filtrage fonctionne correctement. </p><br><h2>  Chercher </h2><br><p>  L'impl√©mentation de recherche est similaire √† l'impl√©mentation de filtrage.  Ajoutez un champ de texte et lors de la saisie du test, nous attribuerons √† l'√©tat de requ√™te variable de la page la valeur entr√©e dans le champ. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"query"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autocomplete</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"off"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">on</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-debounced: AMP.setState({ query: event.value })"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br><p>  Le backend de notre projet prend en charge la recherche.  Pour rechercher des produits, vous devez ajouter le param√®tre ¬´q¬ª √† la demande GET que nous connaissons d√©j√†.  Nous ne nous attarderons pas sur l'impl√©mentation du c√¥t√© serveur, mais verrons comment effectuer une nouvelle demande au serveur lorsque l'√©tat de la page change. </p><br><p>  Nous effectuons la liaison de donn√©es pour le param√®tre src du composant <strong>amp-state</strong> , que nous avons d√©j√† utilis√© pour obtenir les donn√©es initiales pour le filtrage.  Lorsque vous modifiez l'√©tat de la page de variable de requ√™te, une nouvelle requ√™te de recherche sera ex√©cut√©e. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-state</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bikes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"//localhost:3000/api/bikes"</span></span></span><span class="hljs-tag"> [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"query ? '//localhost:3000/api/bikes?q=' + query : '//localhost:3000/api/bikes'"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-state</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Voil√†, maintenant la recherche fonctionne sur la page.  De plus, une nouvelle requ√™te de recherche sera une source de donn√©es pour le filtrage, qui continuera √©galement √† fonctionner correctement.  Le code complet du corps de la page est pr√©sent√© ci-dessous. </p><br><p><img src="https://habrastorage.org/webt/-d/hd/5u/-dhd5usb9dywdquq83yoaxctpgq.jpeg"></p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hero-img"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"img/hero.jpg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"320"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"213"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">layout</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"responsive"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-img</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"content"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>   AMP  !<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-state</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bikes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"//localhost:3000/api/bikes"</span></span></span><span class="hljs-tag"> [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">]= </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"query ? '//localhost:3000/api/bikes?q=' + query : '//localhost:3000/api/bikes'"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-state</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-bind-macro</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"filteredBikes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">expression</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bikes.filter(bike =&gt; onlyAvailable ? bike.available : true)"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-bind-macro</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"query"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autocomplete</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"off"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">on</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-debounced: AMP.setState({ query: event.value })"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"onlyAvailable? 'active' : ''"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"checkbox"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">on</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"change:AMP.setState({ onlyAvailable: event.checked })"</span></span></span><span class="hljs-tag"> /&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-list</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"offers"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3720"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">layout</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fixed-height"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"//localhost:3000/api/bikes"</span></span></span><span class="hljs-tag"> [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"filteredBikes()"</span></span></span><span class="hljs-tag"> [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"(340 + (16*2)) * filteredBikes().length"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">items</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"."</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">&gt;</span></span>...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fallback</span></span></span><span class="hljs-tag">&gt;</span></span>  .<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"amp-mustache"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"card"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"200"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">layout</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fixed-height"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{img}}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{title}}-{{price}}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-img</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hr</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>{{title}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> {{#available}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>{{/available}} {{^available}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>{{/available}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>{{price}} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Conclusion: nous avons cr√©√© une page AMP interactive avec prise en charge du chargement et de la liaison des donn√©es.  Nous avons termin√© l'installation et modifi√© l'√©tat de la page, appris √† travailler avec des mod√®les et r√©pondu √©galement aux commentaires des utilisateurs.  Comme vous pouvez le voir, AMP facilite le d√©veloppement de pages dynamiques interactives, malgr√© les s√©rieuses limites de l'utilisation de JavaScript.  Essayez maintenant de dire que l'AMP est pour la statique;).  Nous savons que l'AMP peut faire bien plus! </p><br><h1>  Bo√Æte √† outils AMP </h1><br><p>  Lors du chargement des pages AMP dans le cache et de leur envoi depuis le cache, Google effectue de nombreuses optimisations.  Lorsque vous donnez directement des pages AMP √† partir de votre site, alors, bien s√ªr, aucune optimisation suppl√©mentaire n'est effectu√©e.  Si vous souhaitez acc√©l√©rer le retour direct des pages AMP, utilisez la biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AMP Toolbox</a> .  Il fournit un middleware pour Express, donc g√©n√©ralement l'utilisation de l'AMP Toolbox avec Node.js consiste √† ajouter quelques lignes de code.  Dans le m√™me temps, la vitesse de chargement des pages augmente! </p><br><h1>  Etapes suppl√©mentaires </h1><br><h2>  Analytique </h2><br><p>  Si vous ne collectez pas de statistiques sur l'utilisation de votre site, cela n'a aucun sens de faire des changements - vous n'aurez pas une id√©e claire si les changements ont √©t√© positifs, n√©gatifs ou neutres.  Comment savoir si l'exp√©rience utilisateur s'est am√©lior√©e avec la mise en ≈ìuvre d'AMP, si vous ne disposez d'aucune information sur l'exp√©rience utilisateur?  Par cons√©quent, l'introduction de l'analyse est vitale. </p><br><p>  AMP prend en charge deux composants principaux pour la collecte de donn√©es: <strong>amp-pixel</strong> pour d√©finir un pixel simple et <strong>amp-analytics</strong> pour des solutions d'analyse plus complexes.  Le composant <strong>amp-experiment</strong> vous permet √©galement d'effectuer des tests A / B sur les pages AMP. </p><br><p>  En utilisant <strong>amp-analytics,</strong> vous pouvez connecter Google Analytics, Yandex Metrics et d'autres fournisseurs (par exemple, Baidu Analytics). </p><br><p>  Ajouter des analyses √† une page est tr√®s simple.  Vous devez d'abord connecter la biblioth√®que appropri√©e au composant <strong>amp-analytics</strong> . </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">async</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">custom-element</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"amp-analytics"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://cdn.ampproject.org/v0/amp-analytics-0.1.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Ensuite, placez le composant sur la page et configurez les param√®tres.  Pour Google Analytics, cela ressemblera √† ceci. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-analytics</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"googleanalytics"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"application/json"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> { </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"vars"</span></span></span><span class="actionscript">: { </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"account"</span></span></span><span class="actionscript">: </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"UA-XXXXX-Y"</span></span></span><span class="actionscript"> }, </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"triggers"</span></span></span><span class="actionscript">: { </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"trackPageview"</span></span></span><span class="actionscript">: { </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"on"</span></span></span><span class="actionscript">: </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"visible"</span></span></span><span class="actionscript">, </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"request"</span></span></span><span class="actionscript">: </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"pageview"</span></span></span><span class="actionscript"> } } } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-analytics</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Pour Yandex Metrics, le code est tr√®s similaire. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-analytics</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"metrika"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"application/json"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> { </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"vars"</span></span></span><span class="actionscript">: { </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"counterId"</span></span></span><span class="actionscript">: </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"XXXXXX"</span></span></span><span class="actionscript"> } } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-analytics</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Naturellement, ce sont les param√®tres les plus minimaux.  Pour toute solution analytique, vous devez sp√©cifier dans les param√®tres les donn√©es que vous souhaitez collecter. </p><br><p>  Lors de l'utilisation du composant <strong>amp-analytics</strong> , il y a un probl√®me avec le suivi des utilisateurs sur les pages AMP et non AMP.  Je veux que l'identifiant de l'utilisateur soit le m√™me partout.  Pour qu'un utilisateur qui t√©l√©charge votre page √† partir du cache de Google, puis clique sur les liens vers votre site directement, du point de vue de l'analyse, soit consid√©r√© comme le m√™me utilisateur.  Pour ce faire, utilisez l'API Client ID.  En savoir plus sur les param√®tres que vous devez d√©finir dans l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">aide de Google Analytics</a> . </p><br><h2>  Travailleurs des services et PWA (Progressive Web Apps) </h2><br><p>  Dans le cas de sites assez complexes, ainsi que de sites existants, il sera difficile d'√©crire ou m√™me de tout r√©√©crire sur AMP.  Par cons√©quent, g√©n√©ralement les pages que les utilisateurs obtiennent de sources externes (pages de connexion) cr√©ent des pages AMP.  Ils s'ouvriront rapidement √† partir du cache et directement.  Mais ensuite, lorsque l'utilisateur clique sur le lien de la page AMP, il sera redirig√© vers votre site principal.  Et ici, il est important que le site principal lors du chargement √† partir de la page AMP soit charg√© instantan√©ment.  Ceci est r√©alis√© par le m√©canisme des travailleurs de service.  Lorsque vous ouvrez la page AMP, il doit installer le service de travail pour le site principal, et le service de travail, √† son tour, t√©l√©chargera et mettra en cache les fichiers n√©cessaires.  Gr√¢ce √† cela, les liens vers la page AMP s'ouvriront instantan√©ment, car tout ou presque tout ce qui est n√©cessaire pour ouvrir les pages suivantes sera d√©j√† dans le cache. </p><br><p>  Pour installer le service worker, utilisez le composant <strong>amp-</strong> install <strong>-</strong> serviceworker.  Il se connecte de la m√™me mani√®re que tous les autres composants AMP. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">async</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">custom-element</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"amp-install-serviceworker"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://cdn.ampproject.org/v0/amp-install-serviceworker-0.1.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Un exemple de son utilisation est pr√©sent√© ci-dessous. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-install-serviceworker</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/sw.js"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-iframe-src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://mydomain.com/sw.html"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">layout</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nodisplay"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-install-serviceworker</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Si un utilisateur visite directement votre site, le composant installera le service worker sp√©cifi√© par le param√®tre src.  Mais dans le cas du chargement de la page AMP √† partir du cache, il ne pourra pas le faire, car l'installation de service workers pour d'autres domaines est interdite.  Par cons√©quent, vous devez cr√©er une page sur le site sur lequel le code d'installation du technicien de service sera situ√©.  Lors du chargement √† partir du cache, <strong>amp-install-serviceworker</strong> ouvrira la page dans un iframe et le <strong>technicien de</strong> service sera install√©. </p><br><p>  PWA (Progressive Web Apps) est une approche de la fa√ßon de cr√©er des applications Web modernes qui s'approchent des applications natives en fonction de l'exp√©rience utilisateur.  Le c≈ìur de la PWA est le personnel de service.  On peut penser que AMP et PWA sont dans une certaine mesure des concurrents.  En fait, ils se compl√®tent.  PWA se concentre sur des interactions r√©guli√®res √† long terme et chaque fois que possible avec les utilisateurs.  Dans le m√™me temps, AMP se concentre sur la premi√®re interaction lorsque l'utilisateur vient de l'ext√©rieur.  PWA n'am√©liore pas exactement cet aspect - la premi√®re interaction.  Par cons√©quent, de nombreux projets utilisent AMP comme point d'entr√©e qui transf√®re l'utilisateur √† PWA.  Et c'est tr√®s raisonnable.  Si vous n'√™tes pas cens√© avoir des interactions utilisateur r√©guli√®res, longues ou complexes, vous pouvez vous en tirer avec un seul AMP. </p><br><h1>  Conclusion </h1><br><p>  Dans cet article, nous avons examin√© une application d'AMP, bien qu'il existe en r√©alit√© de nombreux sc√©narios plus int√©ressants.  Par exemple, les annonces AMPHTML sont un excellent moyen de cr√©er des annonces qui se chargent rapidement.  Apr√®s tout, si des banni√®res √† chargement lent sont plac√©es sur des pages AMP qui s'ouvrent instantan√©ment, les utilisateurs ne verront probablement pas ces publicit√©s.  Oui, et sur les pages r√©guli√®res - les publicit√©s √† chargement lent ennuient les utilisateurs.  Par cons√©quent, il est logique de faire la publicit√© elle-m√™me (cr√©ations publicitaires) en utilisant AMP. </p><br><p>  Les utilisateurs utilisent le contenu diff√©remment sur les ordinateurs de bureau et les appareils mobiles.  Par exemple, lors de la lecture √† partir d'un t√©l√©phone, les utilisateurs arr√™tent de lire un long article beaucoup plus t√¥t que lorsqu'ils lisent √† partir du bureau (et avez-vous lu jusqu'√† ce point? :)).  Le format des histoires (histoires) est r√©cemment devenu de plus en plus populaire sur les appareils mobiles, et les histoires AMP sont juste le moyen de faire de telles histoires rapidement et sans effort suppl√©mentaire. </p><br><p>  De plus, une version d'AMP pour le courrier √©lectronique (AMPHTML pour le courrier √©lectronique) est en cours de d√©veloppement, ce qui vous permettra de cr√©er de magnifiques courriers √©lectroniques interactifs √† l'aide d'AMP. </p><br><p>  N'oubliez pas √©galement que l'AMP peut √™tre utilis√© simplement comme format pour ins√©rer du contenu sur votre site Web.  Par exemple, si vous devez afficher des actualit√©s, des articles ou des fiches produits dans une application React ou Angular, vous pouvez les stocker au format AMP, les pr√©charger, puis les afficher instantan√©ment dans une application Web (ou m√™me dans une application native).  Vous n'avez pas besoin d'utiliser AMP pour la page enti√®re - le contenu AMP peut √©galement √™tre de petits morceaux de contenu. </p><br><p>  En utilisant AMP, vous pouvez cr√©er des sites entiers ainsi que des pages individuelles, des banni√®res, des histoires et utiliser AMP comme format rapide et compact pour ins√©rer du contenu. </p><br><p>  Sergey Pugachev, expert d√©veloppeur Google <br>  <em>PS.</em>  <em>L'article est un regard personnel sur AMP et peut ne pas co√Øncider avec l'opinion de Google ou de l'employeur de l'auteur;)</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr419589/">https://habr.com/ru/post/fr419589/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr419579/index.html">Impl√©mentation de l'op√©rateur in en C ++</a></li>
<li><a href="../fr419581/index.html">Quels projets √† but non lucratif sont int√©ressants pour Y Combinator</a></li>
<li><a href="../fr419583/index.html">Comment la Russie a rat√© l'apog√©e du DVD, mais rattrap√© l'Occident avec l'av√®nement de l'Internet haut d√©bit</a></li>
<li><a href="../fr419585/index.html">PWA est facile. Bonjour habr</a></li>
<li><a href="../fr419587/index.html">Des comp√©titions qui changent le monde. 1567 - 2035</a></li>
<li><a href="../fr419591/index.html">Comment faire des e-mails et ne pas g√¢cher: conseils pratiques</a></li>
<li><a href="../fr419593/index.html">Lunettes daltoniennes: comment √ßa marche et quelles sont les difficult√©s de s√©lection</a></li>
<li><a href="../fr419599/index.html">Java REST √† HeadHunter School of Programmers</a></li>
<li><a href="../fr419601/index.html">Un exemple de conception d'un appareil num√©rique "sur les doigts"</a></li>
<li><a href="../fr419603/index.html">Contexte: les entreprises qui produisent des robots</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>