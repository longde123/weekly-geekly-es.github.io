<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👎🏾 🤹🏽 🅿️ Bonsai Family Wiki Engine: 2019 Ergebnisse 👵🏻 👩🏾‍🤝‍👨🏽 🕶️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Anfang letzten Jahres sprach ich über das Bonsai- Projekt, eine Engine zum Erstellen eines Familien-Wikis und eines Open-Source-Fotoalbums. Seitdem ha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bonsai Family Wiki Engine: 2019 Ergebnisse</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/481600/">  Anfang letzten Jahres sprach ich über das <a href="https://habr.com/ru/post/438622/">Bonsai-</a> Projekt, eine Engine zum Erstellen eines Familien-Wikis und eines Open-Source-Fotoalbums.  Seitdem hat sich das Projekt stetig weiterentwickelt.  Im Laufe des Jahres wurden mehrere Funktionen entwickelt, dank derer der Motor jetzt viel einfacher selbst zu testen und später angenehmer zu bedienen ist. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/425/0d5/55a/4250d555a35d58e5d0db8e2e03492d94.jpg" width="400"></div><br><br>  Unter den Schnittdetails Pläne für die Zukunft und ein wenig Kopfgeld. <a name="habracut"></a><br><br><h3>  Docker-Bild </h3><br>  Die Installation der ersten Version von Bonsai war aufgrund der Vielzahl von Abhängigkeiten sehr mühsam: Sie erfordert die Laufzeit von .NET Core, PostgreSQL und Elasticsearch (dh Java Runtime und ein Plug-in zur Unterstützung der russischen Morphologie), die Assembly benötigt außerdem das .NET Core SDK und NodeJS Die Front zu bauen ... Selbst vor dem Hintergrund der globalen Komplexität der modernen Webentwicklung war es eine Aufgabe nur für die willensstarken und viele anfangs interessierte Benutzer warf es auf die Hälfte. <br><br>  Hör auf! <br><br>  Jetzt steigt Bonsai in drei Elementaraktionen pro Minute auf: <br><br><ol><li>  Laden Sie <a href="">docker-compose.yml herunter</a> . </li><li> Geben <code>@@YOUR_EMAIL@@</code> <code>@@YOUR_IP@@</code> erforderlichen Werte <code>@@YOUR_EMAIL@@</code> und <code>@@YOUR_IP@@</code> . </li><li>  Führen Sie <code>docker-compose up -d</code> </li></ol><br><h3>  Passwortautorisierung </h3><br>  In der ersten Version wurde nur eine Art von Autorisierung verwendet - über soziale Netzwerke.  Dafür gab es viele Gründe: <br><br><ul><li>  Melden Sie sich mit einem Klick an </li><li>  Standardmäßig erhalten Sie 2FA, Passwortwiederherstellung und andere Sicherheitsprüfungen </li><li>  Einfach im Bonsai-Code pflegen </li><li>  Einige der Daten können Sie bei der Registrierung aus dem Profil abrufen </li></ul><br>  Leider verursachte dies eine Reihe von Problemen: <br><br><ul><li>  Besonders kniffliger Schritt bei der Erstinstallation </li><li>  Sie können einer Person ohne soziale Netzwerke (z. B. einem älteren Verwandten) keinen Zugriff gewähren. <br></li><li>  Für einige Daten (Geschlecht, Alter) erfordern soziale Netzwerke eine manuelle Überprüfung Ihrer Bewerbung </li></ul><br>  Aus diesem Grund wurde eine zweite Art der Autorisierung hinzugefügt - per Login und Passwort, die standardmäßig aktiviert ist. <br><br>  Jetzt können Sie den Schritt zum Erstellen eines Autorisierungsantrags im sozialen Netzwerk überspringen.  Nach dem Start bietet Bonsai die Registrierung eines Administratorkontos an, in dem Sie das gewünschte Passwort eingeben müssen - und das funktioniert. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c62/57a/a33/c6257aa33f3232de3aa2ddcbbb4e47af.png" width="600"></div><br>  Sie können im Admin-Bereich ein neues Konto mit einem Kennwort erstellen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b2/643/b8a/2b2643b8a5ff1eb6c39de7838c766175.png" width="600"></div><br>  Bei der Verwendung der Kennwortauthentifizierung sind verschiedene Dinge zu beachten: <br><br><ul><li>  Der Benutzer kann sein eigenes Passwort nicht wiederherstellen - dies kann nur der Administrator.  Wenn es nur einen Administrator gibt, wird er mit einem Kennwort autorisiert und hat dieses Kennwort vergessen. Zum Zurücksetzen müssen Sie ein <a href="https://github.com/impworks/bonsai/issues/108">Skript verwenden</a> , das direkt in der Datenbank ausgeführt werden muss. </li><li>  Nach 10 erfolglosen Versuchen hintereinander wird das Konto ebenfalls gesperrt.  Zum Entsperren müssen Sie das Passwort ändern.  Zusätzlich zu Ihren eigenen Aktionen können böswillige Crawler-Bots Ihr Passwort automatisch blockieren. </li><li>  Ein Konto kann jeweils nur eine Berechtigungsart haben.  Sie können zunächst kein Konto mit einem Passwort erstellen und dieses dann über soziale Netzwerke mit einem zusätzlichen Login versehen oder es mit normalen Mitteln überhaupt nicht ersetzen - nur durch manuelle Manipulationen mit der Datenbank. </li></ul><br><h3>  Server-seitiges Family Tree Rendering </h3><br>  Das automatische Erstellen von Stammbäumen ist eines der wichtigsten Merkmale von Bonsai, aber auch das schwierigste. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bef/291/791/bef29179101157b26aad9e9c66d91e74.png" width="600"></div><br>  Wie bereits in einem früheren Artikel erwähnt, ist es eine sehr schwierige Aufgabe, Blöcke automatisch optimal anzuordnen.  Die Leute schreiben wissenschaftliche Artikel darüber, investieren Tausende von Arbeitsstunden und verkaufen handelsübliche Komponenten für verrücktes Geld.  Zum Glück konnte ich eine kostenlose Bibliothek <a href="https://github.com/OpenKieler/elkjs">ELK.js finden</a> , die recht anständige Ergebnisse liefert. <br><br>  Das Problem mit ELK.js war, dass es sehr lange für eine Client-Bibliothek funktioniert.  Sie können das Ergebnis über die <code>thoroughness</code> anpassen. <code>thoroughness</code> größer der Wert, desto besser der Zeitplan, desto länger dauert er jedoch.  Um einen verständlichen Baum für 50 Personen zu erstellen, musste ich 30-40 Sekunden auf jede Seite warten, die mit einem Baum geöffnet wurde! <br><br>  Das Rendern erfolgt nun nicht mehr bei jedem Öffnen des Clients, sondern bei jeder Änderung auf dem Server.  Das erste Mal nach dem Aktualisieren des Inhalts muss wie zuvor gewartet werden, aber dann werden die Seiten sofort geöffnet. <br><br>  Aus technischer Sicht verursachte die Übertragung von Berechnungen vom Client zum Server mehrere Schwierigkeiten.  Wie führe ich JS-Code in .NET Core aus?  <a href="https://habr.com/ru/users/taritsyn/" class="user_link">Mein</a> erster Gedanke war, die wunderbare <a href="https://github.com/Taritsyn/JavaScriptEngineSwitcher">Javascript Engine Switcher-</a> Bibliothek von <a href="https://habr.com/ru/users/taritsyn/" class="user_link">Taritsyn zu verwenden</a> .  Leider passte es nicht zu meiner Aufgabe: Keiner der vorhandenen Motoren konnte ELK.js verdauen.  Stattdessen wurde der eingebaute <code>NodeServices</code> Mechanismus verwendet, bei dem sofort alles wie eine Uhr funktionierte. <br><br>  Ja, jetzt benötigt Bonsai zwei Laufzeiten, aber dank des Dockers ist es nicht so beängstigend.  Ja, <code>NodeServices</code> wird in einer der nächsten Versionen von ASP.NET Core <a href="https://github.com/aspnet/AspNetCore/issues/12890">in den Ruhestand</a> versetzt, aber die Community wird dies unterstützen.  Und wohin soll es gehen?  Die moderne Webentwicklung besteht ausschließlich aus solchen Kompromissen.  Die Hauptsache ist, dass dies ein Ergebnis ergibt. <br><br><h3>  Dokumente herunterladen </h3><br>  Bonsai unterstützt jetzt neben Fotos und Videos auch den Download von PDF-Dateien.  Dies kann für Dokumente nützlich sein - insbesondere für Geburts-, Heirats- oder Sterbeurkunden. <br><br>  Ursprünglich sollte eine kleine Vorschau für Dokumente erstellt werden.  Leider stieß diese Idee auf die harten Klippen der Realität: Keine der vorhandenen Bibliotheken entsprach dem einen oder anderen Kriterium.  Wurden untersucht: <br><br><ul><li>  <a href="https://github.com/itext/itext7-dotnet">iText7</a> - Lizenzinkompatibilität mit MIT </li><li>  <a href="">PDF.js</a> - eine Vielzahl von Abhängigkeiten, der Container verdoppelt </li><li>  GhostScript-Wrapper sind ebenfalls Lizenzprobleme, und fast alle werden aufgegeben und unterstützen .NET Core nicht </li></ul><br>  Wenn ich etwas verpasst habe und der heilige Gral, PDF in Bild umzuwandeln, immer noch da ist - bitte schreibe in die Kommentare! <br><br><h3>  Nachrichten auf der Hauptleitung </h3><br>  Auf der Hauptseite unter dem Kalender werden jetzt die zuletzt geänderten Seiten und heruntergeladenen Mediendateien angezeigt: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f89/9bd/203/f899bd203cf087f48b2ffe96565f91e3.png" width="600"></div><br><br><h3>  Obligatorischer Haftungsausschluss </h3><br>  Das Projekt ist gemeinnützig und wird „wie besehen“ zur Verfügung gestellt.  Es sind Fehler drin.  Einmal, durch ein banales Versehen im Master, verschwand ein Code, der die Datenbank <i>beinahe</i> löschte.  Wenn Sie die Daten, die Sie in Bonsai eingeben, als wertvoll einstufen, dann in regelmäßigen Abständen und <i>insbesondere</i> bei jedem Update: <br><br>  Machen Sie Backups. <br>  BACKUP MACHEN! <br>  D E L A T E B E K A P S!  !  ! <br><br><h3>  Was weiter? </h3><br>  Es gibt noch viele interessante Aufgaben, die ich im nächsten Jahr erledigen möchte: <br><br><ul><li>  <i>Seitenrang</i> : Eine einzelne automatische Metrik, mit der Sie Seiten nach der Vollständigkeit ihrer Daten sortieren können.  Auf diese Weise können Sie auf einfache Weise die Fragen beantworten, "welche Seiten als Standard angezeigt werden können" und umgekehrt "welche noch bearbeitet werden müssen". </li><li>  <i>Neugestaltung der Hauptseite des Admin-Panels</i> : Die Änderungen werden in ähnlicher Form wie im "News-Feed" in sozialen Netzwerken angezeigt. </li><li>  <i>Technische Aufgaben</i> : Umstieg auf .NET Core 3, diverse Refactoring </li></ul><br>  Es gibt auch Aufgaben, die ich gerne erledigen würde, für die ich jedoch nicht genügend Zeit und Kompetenzen habe.  Ich hoffe auf die Hilfe der Community - wenn nicht umsonst, dann zumindest auf eine symbolische Belohnung.  Wenn Sie sich Ihrer Fähigkeiten sicher sind und daran teilnehmen möchten, schreiben Sie mir bitte in einem Telegramm und diskutieren Sie. <br><br><ul><li>  <i>Kalenderkomponente</i> : Standard wird verwendet, ist aber ein wenig schief und unterstützt keine ungenauen Werte ( <code>2019.??.??</code> ): Sie müssen eine vollwertige schreiben. </li><li>  <i>Suchverbesserung</i> : Die Suche in ElasticSearch führt manchmal zu <a href="https://github.com/impworks/bonsai/issues/104">seltsamen</a> Ergebnissen.  Höchstwahrscheinlich weiß ich einfach nicht, wie man das <a href="">Gummiband benutzt</a> - Sie müssen die <a href="">infernalischen Konfigurationen</a> mit Kenntnis der Materie umschreiben. </li><li>  <i>Gesichtserkennung</i> : Es wäre schön, Gesichter auf hochgeladenen Fotos automatisch zu erkennen und auf Seiten zu fangen.  Ich habe noch keine Lösungen für .NET Core gefunden, die sowohl offen als auch vernünftig sind. </li></ul><br>  Das Projektarchiv finden Sie unter: <br><br>  <b><a href="https://github.com/impworks/bonsai">https://github.com/impworks/bonsai</a></b> . <br><br>  Wenn Sie Bonsai verwenden, teilen Sie uns dies bitte in den Kommentaren mit.  Über Kritik und Anregungen würde ich mich freuen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de481600/">https://habr.com/ru/post/de481600/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de481588/index.html">Die Übungen zur Isolierung von Runet begannen. Überwachen wir?</a></li>
<li><a href="../de481592/index.html">Sechs Neujahrs-Geschenkoptionen für einen Autofahrer mit einem guten Rabatt</a></li>
<li><a href="../de481594/index.html">Entwicklung eines „einfachen Spannungsgenerators“ nach GOST R IEC 61508 (IEC 61508)</a></li>
<li><a href="../de481596/index.html">Analysieren der ELK 7.5-Einstellungen für die Mikrotik-Protokollanalyse</a></li>
<li><a href="../de481598/index.html">Ein kleiner Beitrag zum Kampf gegen die Avalonia UI-Zoo-Plattformen</a></li>
<li><a href="../de481604/index.html">Wie hart Tscheljabinsk Entwickler Spiele für Google Play und soziale Netzwerke machen</a></li>
<li><a href="../de481606/index.html">Statisches Abonnement unter Verwendung der Observer-Vorlage unter Verwendung von C ++ und des Cortex M4-Mikrocontrollers</a></li>
<li><a href="../de481610/index.html">PostgreSQL Antipatterns: Aktualisierung einer großen Tabelle unter Last</a></li>
<li><a href="../de481612/index.html">Unser kleiner Beitrag zum Kampf der Avalonia-Benutzeroberfläche für weniger Plattformen</a></li>
<li><a href="../de481616/index.html">Geodätische Kuppel. Über das Gerät und meine Erfahrungen mit Berechnungen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>