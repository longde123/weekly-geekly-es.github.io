<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§¶ ‚òØÔ∏è üíáüèº Desenvolvimento de diagramas de √°rvore din√¢micos usando SVG e Vue.js üç± üëè üë©üèΩ‚Äçü§ù‚Äçüë®üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O material, cuja tradu√ß√£o publicamos hoje, √© dedicado ao processo de desenvolvimento de um sistema de visualiza√ß√£o para diagramas de √°rvores din√¢micos...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desenvolvimento de diagramas de √°rvore din√¢micos usando SVG e Vue.js</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/463329/">  O material, cuja tradu√ß√£o publicamos hoje, √© dedicado ao processo de desenvolvimento de um sistema de visualiza√ß√£o para diagramas de √°rvores din√¢micos.  Para desenhar curvas c√∫bicas de Bezier, a tecnologia SVG (Scalable Vector Graphics, gr√°ficos vetoriais escal√°veis) √© usada aqui.  O trabalho reativo com dados √© organizado por Vue.js. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui est√° uma</a> vers√£o demo do sistema com o qual voc√™ pode experimentar. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/917/18f/9bb/91718f9bbe30a79beeeb537f7b49b07e.png"></div><br>  <i><font color="#999999">√Årvore interativa</font></i> <br><a name="habracut"></a><br>  A combina√ß√£o dos poderosos recursos do SVG e da estrutura Vue.js. nos permitiu criar um sistema para criar diagramas baseados em dados, interativos e personaliz√°veis. <br><br>  Um diagrama √© uma cole√ß√£o de curvas c√∫bicas de Bezier come√ßando em um ponto.  As curvas terminam em pontos diferentes eq√ºidistantes entre si.  Sua posi√ß√£o final depende dos dados inseridos pelo usu√°rio.  Como resultado, o gr√°fico √© capaz de reagir reativamente √†s altera√ß√µes de dados. <br><br>  Primeiro, falaremos sobre como as curvas c√∫bicas de Bezier s√£o formadas, depois descobriremos como represent√°-las no sistema de coordenadas do elemento <code>&lt;svg&gt;</code> e falaremos sobre a cria√ß√£o de m√°scaras para imagens. <br><br>  A autora do material diz que ela preparou muitas ilustra√ß√µes para ele, tentando torn√°-lo compreens√≠vel e interessante.  O objetivo do material √© ajudar todos a adquirir o conhecimento e as habilidades necess√°rias para desenvolver seus pr√≥prios sistemas de diagrama√ß√£o. <br><br><h2>  <font color="#3AC1EF">Svg</font> </h2><br><h3>  <font color="#3AC1EF">‚ñç Como s√£o formadas as curvas c√∫bicas de Bezier?</font> </h3><br>  As curvas usadas neste projeto s√£o chamadas de Curva C√∫bica de Bezier.  A figura a seguir mostra os principais elementos dessas curvas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6f5/36f/6b1/6f536f6b1bf9ce9198e78640a17e49e6.png"></div><br>  <i><font color="#999999">Elementos-chave de uma curva c√∫bica de Bezier</font></i> <br><br>  A curva √© descrita por quatro pares de coordenadas.  O primeiro par <code>(x0, y0)</code> √© o ponto de ancoragem inicial da curva.  O √∫ltimo par de coordenadas <code>(x3, y3)</code> √© o ponto de refer√™ncia final. <br><br>  Entre esses pontos, voc√™ pode ver os chamados pontos de controle.  Este √© o ponto <code>(x1, y1)</code> e o ponto <code>(x2, y2)</code> . <br><br>  A localiza√ß√£o dos pontos de controle em rela√ß√£o aos pontos de controle determina o formato da curva.  Se a curva fosse definida apenas pelos pontos inicial e final, pelas coordenadas <code>(x0, y0)</code> e <code>(x3, y3)</code> , essa curva pareceria um segmento reto localizado na diagonal. <br><br>  Agora, usaremos as coordenadas dos quatro pontos descritos acima para plotar a curva usando o elemento SVG <code>&lt;path&gt;</code> .  Aqui est√° a sintaxe usada no elemento <code>&lt;path&gt;</code> para construir curvas c√∫bicas de Bezier: <br><br><pre> <code class="javascript hljs">&lt;path D=<span class="hljs-string"><span class="hljs-string">"M x0,y0 C x1,y1 x2,y2 x3,y3"</span></span> /&gt;</code> </pre> <br>  A letra <code></code> , que pode ser vista no c√≥digo, √© uma abrevia√ß√£o de Cubic Bezier Curve.  Letra min√∫scula ( <code>c</code> ) significa o uso de valores relativos, mai√∫scula ( <code>C</code> ) significa o uso de valores absolutos.  Eu uso valores absolutos para construir o diagrama, isso √© indicado pela letra mai√∫scula usada no exemplo. <br><br><h3>  <font color="#3AC1EF">Criando um diagrama sim√©trico</font> </h3><br>  A simetria √© um aspecto essencial deste projeto.  Para construir um diagrama sim√©trico, usei apenas uma vari√°vel, recebendo em sua base valores como altura, largura ou coordenadas do centro de um determinado objeto. <br><br>  Vamos nomear esse <code>size</code> vari√°vel.  Como o gr√°fico √© orientado horizontalmente - a vari√°vel de <code>size</code> pode ser considerada como todo o espa√ßo horizontal dispon√≠vel para o gr√°fico. <br><br>  Atribua a esta vari√°vel um valor realista.  Usaremos esse valor para calcular as coordenadas dos elementos do gr√°fico. <br><br><pre> <code class="javascript hljs">size = <span class="hljs-number"><span class="hljs-number">1000</span></span></code> </pre> <br><h2>  <font color="#3AC1EF">Localizando as coordenadas dos elementos do gr√°fico</font> </h2><br>  Antes de encontrarmos as coordenadas necess√°rias para construir o diagrama, precisamos lidar com o sistema de coordenadas SVG. <br><br><h3>  <font color="#3AC1EF">‚ñçCoordenar sistema e viewBox</font> </h3><br>  O atributo do elemento <code>&lt;svg&gt; viewBox</code> muito importante em nosso projeto.  O fato √© que ele descreve o sistema de coordenadas do usu√°rio da imagem SVG.  Simplificando, o <code>viewBox</code> determina a posi√ß√£o e o tamanho do espa√ßo em que a imagem SVG vis√≠vel na tela ser√° criada. <br><br>  O atributo <code>viewBox</code> consiste em quatro n√∫meros que especificam os par√¢metros do sistema de coordenadas e os seguintes nesta ordem: <code>min-x</code> , <code>min-y</code> , <code>width</code> , <code>height</code> .  Os par√¢metros <code>min-x</code> e <code>min-y</code> definem a origem do sistema de coordenadas do usu√°rio, os par√¢metros de <code>width</code> e <code>height</code> definem a largura e a altura da imagem exibida.  Aqui est√° a <code>viewBox</code> atributo <code>viewBox</code> : <br><br><pre> <code class="javascript hljs">&lt;svg viewBox=<span class="hljs-string"><span class="hljs-string">"min-x min-y width height"</span></span>&gt;...&lt;<span class="hljs-regexp"><span class="hljs-regexp">/svg&gt;</span></span></code> </pre> <br>  A vari√°vel de <code>size</code> que descrevemos acima ser√° usada para controlar os par√¢metros de <code>width</code> e <code>height</code> deste sistema de coordenadas. <br><br>  Posteriormente, na se√ß√£o Vue.js, vincularemos o <code>viewBox</code> a uma propriedade computada para especificar os valores de <code>width</code> e <code>height</code> .  Al√©m disso, em nosso projeto, as propriedades <code>min-x</code> e <code>min-y</code> sempre ser√£o definidas como 0. <br><br>  Observe que n√£o usamos os atributos <code>height</code> e <code>width</code> do pr√≥prio elemento <code>&lt;svg&gt;</code> .  Vamos configur√°-los para <code>width: 100%</code> e <code>height: 100%</code> usando CSS.  Isso nos permitir√° criar uma imagem SVG que se ajusta de maneira flex√≠vel ao tamanho da p√°gina. <br><br>  Agora que o sistema de coordenadas do usu√°rio est√° pronto para desenhar um gr√°fico, vamos falar sobre o uso da vari√°vel <code>size</code> para calcular as coordenadas dos elementos do gr√°fico. <br><br><h3>  <font color="#3AC1EF">‚ñç Coordenadas invari√°veis ‚Äã‚Äãe din√¢micas</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/efc/a82/d19/efca82d1952a08d5c3582acf7fcab49e.png"></div><br>  <i><font color="#999999">Conceito gr√°fico</font></i> <br><br>  O c√≠rculo em que o desenho √© exibido faz parte do diagrama.  √â por isso que √© importante inclu√≠-lo nos c√°lculos desde o in√≠cio.  Vamos, com base na ilustra√ß√£o acima, descobrir as coordenadas do c√≠rculo e de uma curva experimental. <br><br>  A altura do gr√°fico √© dividida em duas partes.  Estes s√£o <code>topHeight</code> (20% do <code>size</code> ) e <code>bottomHeight</code> (os 80% restantes do <code>size</code> ).  A largura total do diagrama √© dividida em 2 partes - o comprimento de cada uma delas √© de 50% do <code>size</code> . <br><br>  Isso faz com que a conclus√£o dos par√¢metros do c√≠rculo n√£o exija explica√ß√µes especiais (aqui os indicadores <code>topHeight</code> e <code>topHeight</code> s√£o usados).  O par√¢metro <code>radius</code> est√° definido como metade do valor de <code>topHeight</code> .  Gra√ßas a isso, o c√≠rculo se encaixa perfeitamente no espa√ßo dispon√≠vel. <br><br>  Agora vamos dar uma olhada nas coordenadas das curvas. <br><br><ul><li>  As coordenadas <code>(x0, y0)</code> definem o ponto de refer√™ncia inicial da curva.  Essas coordenadas permanecem constantes o tempo todo.  A coordenada <code>x0</code> √© o centro do gr√°fico (metade do <code>size</code> ) e <code>y0</code> √© a coordenada na qual a parte inferior do c√≠rculo termina.  Portanto, na f√≥rmula para calcular essa coordenada, o raio do c√≠rculo √© usado.  Como resultado, as coordenadas deste ponto podem ser encontradas pela seguinte f√≥rmula <code>: (50% size, 20% size + radius)</code> . </li><li>  As coordenadas <code>(x1, y1)</code> s√£o o primeiro ponto de controle da curva.  Tamb√©m permanece inalterado para todas as curvas.  Se n√£o esquecermos que as curvas devem ser sim√©tricas, verifica-se que os valores de <code>x1</code> e <code>y1</code> sempre s√£o iguais √† metade do valor do <code>size</code> .  Da√≠ a f√≥rmula para o seu c√°lculo: <code>(50% size, 50% size)</code> . </li><li>  As coordenadas <code>(x2, y2)</code> representam o segundo ponto de controle da curva de Bezier.  Aqui <code>x2</code> indica qual deve ser a forma da curva.  Este indicador √© calculado dinamicamente para cada curva.  E o indicador <code>y2</code> , como antes, ter√° metade do <code>size</code> .  Da√≠ a seguinte f√≥rmula para calcular essas coordenadas: <code>(x2, 50% size)</code> . </li><li>  As coordenadas <code>(x3, y3)</code> s√£o o ponto de refer√™ncia final da curva.  Essa coordenada indica onde voc√™ deseja concluir o desenho da linha.  Aqui, o valor de <code>x3</code> , como <code>x2</code> , √© calculado dinamicamente.  E <code>y3</code> assume um valor igual a 80% do <code>size</code> .  Como resultado, obtemos a seguinte f√≥rmula: <code>(x3, 80% size)</code> . </li></ul><br>  Reescrevemos, em termos gerais, o c√≥digo do elemento <code>&lt;path&gt;</code> , levando em considera√ß√£o as f√≥rmulas que acabamos de derivar.  As porcentagens usadas acima s√£o apresentadas aqui dividindo-as por 100. <br><br><pre> <code class="javascript hljs">&lt;path d=<span class="hljs-string"><span class="hljs-string">"M size*0.5, (size*0.2) + radius          C size*0.5, size*0.5           x2,    size*0.5           x3,    size*0.8"</span></span> &gt;</code> </pre> <br>  Observe que, √† primeira vista, o uso de porcentagens em nossas f√≥rmulas pode parecer opcional, com base apenas em minha pr√≥pria opini√£o.  No entanto, esses valores n√£o s√£o aplicados por capricho, mas porque seu uso ajuda a obter simetria e as propor√ß√µes corretas do diagrama.  Depois de sentir seu papel no gr√°fico, voc√™ pode tentar seus pr√≥prios valores percentuais e examinar os resultados obtidos aplicando-os. <br><br>  Agora vamos falar sobre como procuraremos as coordenadas <code>x2</code> e <code>x3</code> .  Eles permitem criar dinamicamente muitas curvas com base no <code>index</code> elementos na matriz correspondente. <br><br>  A divis√£o do espa√ßo horizontal dispon√≠vel do gr√°fico em partes iguais √© baseada no n√∫mero de elementos na matriz.  Como resultado, cada parte recebe o mesmo espa√ßo ao longo do eixo x. <br><br>  A f√≥rmula que derivamos deve funcionar posteriormente com qualquer n√∫mero de elementos.  Mas aqui vamos experimentar uma matriz contendo 5 elementos: <code>[0,1,2,3,4]</code> .  A visualiza√ß√£o de uma matriz desse tipo significa que √© necess√°rio desenhar 5 curvas. <br><br><h3>  <font color="#3AC1EF">IndingEncontrando coordenadas din√¢micas (x2 e x3)</font> </h3><br>  Primeiro, eu dividi o <code>size</code> pelo n√∫mero de elementos, ou seja, pelo comprimento da matriz.  Eu chamei essa <code>distance</code> vari√°vel.  Representa a dist√¢ncia entre dois elementos. <br><br><pre> <code class="javascript hljs">distance = size/arrayLength <span class="hljs-comment"><span class="hljs-comment">// distance = 1000/5 = 200</span></span></code> </pre> <br>  Ent√£o eu andei pela matriz e multipliquei o √≠ndice de cada um de seus elementos ( <code>index</code> ) pela <code>distance</code> .  Por uma quest√£o de simplicidade, chamo simplesmente <code>x</code> par√¢metro <code>x2</code> e <code>x3</code> . <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  x2  x3 x = index * distance</span></span></code> </pre> <br>  Se voc√™ aplicar os valores obtidos ao criar o diagrama, ou seja, usar o valor <code>x</code> calculado acima para <code>x2</code> e <code>x3</code> , isso parecer√° um pouco estranho. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/311/f53/1c6/311f531c60f80f01f519f0a128cfc164.png"></div><br>  <i><font color="#999999">O diagrama √© assim√©trico</font></i> <br><br>  Como voc√™ pode ver, os elementos est√£o localizados na √°rea em que deveriam estar, mas o diagrama acabou sendo assim√©trico.  Parece que na parte esquerda h√° mais elementos do que na direita. <br><br>  Agora, preciso fazer com que o valor <code>x3</code> esteja no centro dos segmentos correspondentes, cujo comprimento √© definido usando a vari√°vel <code>distance</code> . <br><br>  Para trazer o diagrama para o formul√°rio necess√°rio, simplesmente adicionei <code>x</code> metade do valor da <code>distance</code> . <br><br><pre> <code class="javascript hljs">x = index * distance + (distance * <span class="hljs-number"><span class="hljs-number">0.5</span></span>)</code> </pre> <br>  Como resultado, encontrei o centro do segmento de <code>distance</code> e coloquei a coordenada <code>x3</code> nele.  Al√©m disso, trouxe para o formul√°rio que precisamos da coordenada <code>x2</code> para a curva n ¬∞ 2. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e80/f69/f9d/e80f69f9d18b790c7634a9b12b2afc53.png"></div><br>  <i><font color="#999999">Diagrama sim√©trico</font></i> <br><br>  A adi√ß√£o de metade do valor da <code>distance</code> √†s coordenadas <code>x2</code> e <code>x3</code> tornou a f√≥rmula de c√°lculo adequada para a visualiza√ß√£o de matrizes contendo um n√∫mero par e √≠mpar de elementos. <br><br><h3>  <font color="#3AC1EF">‚ñç M√°scara de imagem</font> </h3><br>  Precisamos que uma determinada imagem seja exibida na parte superior do diagrama, dentro do c√≠rculo.  Para resolver esse problema, criei uma m√°scara de recorte contendo um c√≠rculo. <br><br><pre> <code class="javascript hljs">&lt;defs&gt;  <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">mask</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"svg-mask"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">     </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">circle</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:r</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"radius"</span></span></span></span><span class="xml"><span class="hljs-tag">             </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:cx</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"halfSize"</span></span></span></span><span class="xml"><span class="hljs-tag">             </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:cy</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"topHeight"</span></span></span></span><span class="xml"><span class="hljs-tag">             </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">fill</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"white"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml">  </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">mask</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">defs</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Em seguida, usando a tag <code>&lt;image&gt;</code> do elemento <code>&lt;image&gt;</code> <code>&lt;svg&gt;</code> <code>&lt;image&gt;</code> para exibir a imagem, vinculei a imagem ao elemento <code>&lt;mask&gt;</code> criado acima, usando o atributo <code>mask</code> do elemento <code>&lt;image&gt;</code> . <br><br><pre> <code class="javascript hljs">&lt;image mask=<span class="hljs-string"><span class="hljs-string">"url(#svg-mask)"</span></span>      :x=<span class="hljs-string"><span class="hljs-string">"(halfSize-radius)"</span></span>      :y=<span class="hljs-string"><span class="hljs-string">"(topHeight-radius)"</span></span> ... &gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">image</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Como estamos tentando ajustar uma imagem quadrada em uma ‚Äújanela‚Äù redonda, ajustei a posi√ß√£o do elemento subtraindo o par√¢metro <code>radius</code> par√¢metros correspondentes.  Como resultado, a imagem √© vis√≠vel atrav√©s de uma m√°scara feita na forma de um c√≠rculo. <br><br>  Vamos coletar tudo o que falamos em um desenho.  Isso nos ajudar√° a ver o quadro geral do progresso do trabalho. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/38b/27e/37f/38b27e37ff2a7da017e0f67b7ac68b7e.png"></div><br>  <i><font color="#999999">Dados usados ‚Äã‚Äãno c√°lculo dos par√¢metros do gr√°fico</font></i> <br><br><h2>  <font color="#3AC1EF">Criando uma imagem SVG din√¢mica usando o Vue.js</font> </h2><br>  Nesse ponto, descobrimos as curvas c√∫bicas de Bezier e realizamos os c√°lculos necess√°rios para formar o diagrama.  Como resultado, agora podemos criar diagramas est√°ticos de SVG.  Se combinarmos os recursos do SVG e do Vue.js, podemos criar diagramas controlados por dados.  Os gr√°ficos est√°ticos se tornar√£o din√¢micos. <br><br>  Nesta se√ß√£o, revisamos o diagrama SVG, apresentando-o como um conjunto de componentes do Vue.  Tamb√©m anexaremos atributos SVG √†s propriedades computadas e faremos com que o gr√°fico responda √†s altera√ß√µes de dados. <br><br>  Al√©m disso, no final do projeto, criaremos um componente que √© um painel de configura√ß√£o.  Este componente ser√° usado para inserir dados que ser√£o transmitidos ao gr√°fico. <br><br><h3>  <font color="#3AC1EF">Data Vinculando dados aos par√¢metros do viewBox</font> </h3><br>  Vamos come√ßar ajustando o sistema de coordenadas.  Sem fazer isso, n√£o conseguiremos desenhar imagens SVG.  A propriedade <code>viewbox</code> computada retornar√° o que precisamos usando a vari√°vel <code>size</code> .  Haver√° quatro valores separados por espa√ßos.  Tudo isso se tornar√° o valor do atributo <code>viewBox</code> do elemento <code>&lt;svg&gt;</code> . <br><br><pre> <code class="javascript hljs">viewbox() {   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"0 0 "</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.size + <span class="hljs-string"><span class="hljs-string">" "</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.size; }</code> </pre> <br>  No SVG, o nome do atributo <code>viewBox</code> j√° foi gravado usando o estilo camel. <br><br><pre> <code class="javascript hljs">&lt;svg viewBox=<span class="hljs-string"><span class="hljs-string">"0 0 1000 1000"</span></span>&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">svg</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Portanto, para vincular corretamente esse atributo √† propriedade calculada, anotei o nome do atributo no estilo kebab e coloquei o modificador <code>.camel</code> depois dele.  Com essa abordagem, √© poss√≠vel "enganar" o HTML e implementar corretamente a liga√ß√£o de atributo. <br><br><pre> <code class="javascript hljs">&lt;svg :view-box.camel=<span class="hljs-string"><span class="hljs-string">"viewbox"</span></span>&gt;   ... &lt;<span class="hljs-regexp"><span class="hljs-regexp">/svg&gt;</span></span></code> </pre> <br>  Agora, ao alterar o <code>size</code> gr√°fico √© reconfigurado independentemente.  N√£o precisamos alterar manualmente o layout. <br><br><h3>  <font color="#3AC1EF">‚ñçC√°lculo dos par√¢metros da curva</font> </h3><br>  Como a maioria dos valores necess√°rios para construir as curvas √© calculada com base em uma √∫nica vari√°vel ( <code>size</code> ), eu costumava encontrar todas as coordenadas fixas pelas propriedades calculadas.  O que chamamos aqui de "coordenadas fixas" √© calculado com base no <code>size</code> , e depois disso n√£o muda e n√£o depende de quantas curvas o diagrama incluir√°. <br><br>  Se voc√™ alterar o <code>size</code> - "coordenadas fixas" ser√£o recontadas.  Depois disso, eles n√£o ser√£o alterados at√© a pr√≥xima altera√ß√£o de <code>size</code> .  Dado o exposto, aqui est√£o cinco valores que precisamos desenhar curvas de Bezier: <br><br><ul><li> <code>topHeight ‚Äî size * 0.2</code> </li> <li> <code>bottomHeight ‚Äî size * 0.8</code> </li> <li> <code>width ‚Äî size</code> </li> <li> <code>halfSize ‚Äî size * 0.5</code> </li> <li> <code>distance ‚Äî size/arrayLength</code> </li> </ul><br>  Agora, temos apenas dois valores desconhecidos - <code>x2</code> e <code>x3</code> .  A f√≥rmula para calcul√°-los j√° derivamos: <br><br><pre> <code class="javascript hljs">x = index * distance + (distance * <span class="hljs-number"><span class="hljs-number">0.5</span></span>)</code> </pre> <br>  Para encontrar valores espec√≠ficos, precisamos substituir os √≠ndices dos elementos da matriz nesta f√≥rmula. <br><br>  Agora vamos nos perguntar se a propriedade computada √© correta para encontrarmos <code>x</code> .  Responda brevemente a essa pergunta, ent√£o - n√£o, n√£o ser√°. <br><br>  A propriedade calculada n√£o pode receber par√¢metros.  O fato √© que isso √© uma propriedade, n√£o uma fun√ß√£o.  Al√©m disso, a necessidade de usar um par√¢metro para calcular algo significa que n√£o h√° vantagem tang√≠vel de usar propriedades calculadas em termos de armazenamento em cache. <br><br>  Observe que h√° uma exce√ß√£o em rela√ß√£o ao princ√≠pio acima.  √â sobre Vuex.  Se voc√™ usar getters Vuex que retornam fun√ß√µes, poder√° passar par√¢metros para eles. <br><br>  Nesse caso, n√£o usamos o Vuex.  Mas mesmo nesta situa√ß√£o, temos algumas maneiras de resolver esse problema. <br><br><h3>  <font color="#3AC1EF">‚ñç Op√ß√£o n√∫mero 1</font> </h3><br>  Voc√™ pode declarar uma fun√ß√£o para a qual o <code>index</code> passado como argumento e retorna o resultado que precisamos.  Essa abordagem parece mais clara se vamos usar o valor retornado por uma fun√ß√£o semelhante em v√°rios locais do modelo. <br><br><pre> <code class="javascript hljs">&lt;g v-<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>=<span class="hljs-string"><span class="hljs-string">"(item, i) in itemArray"</span></span>&gt;  <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">path</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:d</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"'M' + halfSize + ','     + (topHeight+r) +' '+            'C' + halfSize + ','     + halfSize +' '+                     calculateXPos(i) + ',' + halfSize +' '+                  calculateXPos(i) + ',' + bottomHeight"</span></span></span></span><span class="xml"><span class="hljs-tag">  /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">g</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  O m√©todo <code>calculateXPos()</code> realizar√° c√°lculos sempre que for chamado.  Este m√©todo toma como argumento o √≠ndice do elemento - <code>i</code> . <br><br><pre> <code class="javascript hljs">&lt;script&gt;  methods: {    calculateXPos (i)    {      <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> distance * i + (distance * <span class="hljs-number"><span class="hljs-number">0.5</span></span>)    }  } &lt;<span class="hljs-regexp"><span class="hljs-regexp">/script&gt;</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui est√°</a> um exemplo no CodePen que usa esta solu√ß√£o. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/28e/dd6/b8c/28edd6b8cb97d3352108946cfb50a9cd.png"></div><br>  <i><font color="#999999">Tela para a primeira variante de aplicativo</font></i> <br><br><h3>  <font color="#3AC1EF">‚ñç Op√ß√£o n√∫mero 2</font> </h3><br>  Esta op√ß√£o √© melhor que a primeira.  Podemos extrair a pequena marca√ß√£o SVG necess√°ria para criar a curva em um componente filho pequeno separado e passar o <code>index</code> para ela como uma das propriedades. <br><br>  Com essa abordagem, voc√™ pode usar a propriedade computada para encontrar <code>x2</code> e <code>x3</code> . <br><br><pre> <code class="javascript hljs">&lt;g v-<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>=<span class="hljs-string"><span class="hljs-string">"(item, i) in items"</span></span>&gt;    <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">cubic-bezier</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:index</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"i"</span></span></span></span><span class="xml"><span class="hljs-tag">                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:half-size</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"halfSize"</span></span></span></span><span class="xml"><span class="hljs-tag">                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:top-height</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"topHeight"</span></span></span></span><span class="xml"><span class="hljs-tag">                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:bottom-height</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"bottomHeight"</span></span></span></span><span class="xml"><span class="hljs-tag">                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:r</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"radius"</span></span></span></span><span class="xml"><span class="hljs-tag">                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:d</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"distance"</span></span></span></span><span class="xml"><span class="hljs-tag">     &gt;</span></span></span><span class="xml">     </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">cubic-bezier</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">g</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Esta op√ß√£o nos d√° a oportunidade de organizar melhor o c√≥digo.  Por exemplo, podemos criar outro componente filho para a m√°scara: <br><br><pre> <code class="javascript hljs">&lt;clip-mask :title=<span class="hljs-string"><span class="hljs-string">"title"</span></span>           :half-size=<span class="hljs-string"><span class="hljs-string">"halfSize"</span></span>           :top-height=<span class="hljs-string"><span class="hljs-string">"topHeight"</span></span>                               :r=<span class="hljs-string"><span class="hljs-string">"radius"</span></span>&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">clip-mask</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><h3>  <font color="#3AC1EF">Panel Painel de configura√ß√£o</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d04/7e6/54f/d047e654fc2c1cda88bb618db3668fda.png"></div><br>  <i><font color="#999999">Painel de configura√ß√£o</font></i> <br><br>  Voc√™ provavelmente j√° viu o painel de configura√ß√£o, chamado pelo bot√£o localizado no canto superior esquerdo da tela do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">exemplo</a> acima.  Esse painel facilita a adi√ß√£o de elementos √† matriz e a remo√ß√£o deles.  Seguindo as id√©ias discutidas na se√ß√£o "Op√ß√£o n¬∫ 2", criei um componente filho para o painel de configura√ß√£o.  Gra√ßas a isso, o componente de n√≠vel superior √© limpo e bem leg√≠vel.  Como resultado, nossa pequena e agrad√°vel √°rvore de componentes Vue se parece com a abaixo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5af/fe8/172/5affe817227430e34e81425910a2b525.png"></div><br>  <i><font color="#999999">√Årvore de componentes do projeto</font></i> <br><br>  Deseja dar uma olhada no c√≥digo que implementa esta vers√£o do projeto?  Se assim for, d√™ uma olhada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e4e/f1a/18b/e4ef1a18b00c15730adfc48077994608.png"></div><br>  <i><font color="#999999">Tela para a segunda variante de aplicativo</font></i> <br><br><h2>  <font color="#3AC1EF">Reposit√≥rio do projeto</font> </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui est√°</a> o reposit√≥rio GitHub do projeto ("Op√ß√£o 2" √© implementada aqui).  Eu acredito que ser√° √∫til que voc√™ olhe antes de passar para a pr√≥xima se√ß√£o. <br><br><h2>  <font color="#3AC1EF">Li√ß√£o de casa</font> </h2><br>  Tente criar o mesmo diagrama que descrevemos aqui, mas fa√ßa-o orientado verticalmente.  Aproveite as id√©ias descritas neste artigo. <br><br>  Se voc√™ acha que essa √© uma tarefa f√°cil, que para construir um diagrama como esse √© suficiente para trocar as coordenadas <code>y</code> , voc√™ est√° certo.  Considerando que o projeto considerado aqui n√£o foi criado como universal, depois de alterar as coordenadas onde voc√™ precisar, tamb√©m ser√° necess√°rio editar o c√≥digo renomeando algumas vari√°veis ‚Äã‚Äãe m√©todos. <br><br>  Gra√ßas ao Vue.js, nosso gr√°fico simples pode ser equipado com recursos adicionais.  Por exemplo, o seguinte: <br><br><ul><li>  Voc√™ pode criar um mecanismo que permita alternar entre os modos de gr√°fico horizontal e vertical. </li><li>  As curvas podem tentar animar.  Por exemplo, usando GSAP. </li><li>  Voc√™ pode ajustar as propriedades das curvas (digamos - cor e largura da linha) no painel de configura√ß√£o. </li><li>  Voc√™ pode usar uma biblioteca externa para organizar o salvamento de diagramas em qualquer formato gr√°fico ou como um arquivo PDF.  √â poss√≠vel fazer o download desses materiais para aqueles que trabalham com o gr√°fico. </li></ul><br>  Tente esta li√ß√£o de casa.  E se voc√™ tiver algum problema - abaixo ser√° dado um link para sua solu√ß√£o. <br><br><h2>  <font color="#3AC1EF">Sum√°rio</font> </h2><br>  O elemento <code>&lt;path&gt;</code> √© um dos recursos avan√ßados do SVG.  Este elemento permite criar v√°rias imagens com alta precis√£o.  Aqui n√≥s descobrimos como as curvas de Bezier s√£o estruturadas e como coloc√°-las em pr√°tica para criar seus pr√≥prios diagramas. <br><br>       ,  ,   JavaScript-.  Vue.js     .  ,   ,         , ,    DOM.        ,  ‚Äî        . <br><br> ,    ,   ,  ,   ,      Vue.js  SVG.      ‚Äî   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> ,      Vue.js.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> ‚Äî   . <br><br>   ,       - ,   ,        ,   ‚Äî . <br><br>  <b>Caros leitores!</b>      ? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt463329/">https://habr.com/ru/post/pt463329/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt463313/index.html">Uma abordagem alternativa para se inscrever em eventos ou o EventObject √© realmente necess√°rio?</a></li>
<li><a href="../pt463317/index.html">Detalhes t√©cnicos de hackers Capital One bank na AWS</a></li>
<li><a href="../pt463321/index.html">Cestas e caixas de usabilidade: an√°lise das 20 principais lojas online de nichos russos</a></li>
<li><a href="../pt463325/index.html">Reflex√£o do Game Designer: personagens de um jogo que n√£o foi lan√ßado</a></li>
<li><a href="../pt463327/index.html">Vue.js: 3 anti-padr√µes</a></li>
<li><a href="../pt463331/index.html">Cliente Apollo. Agora com ganchos React</a></li>
<li><a href="../pt463333/index.html">Escolhendo um sistema de gerenciamento de testes em 2019</a></li>
<li><a href="../pt463335/index.html">Usando o analisador est√°tico PVS-Studio no desenvolvimento de sistemas embarcados em C e C ++</a></li>
<li><a href="../pt463337/index.html">Usando o Immer para gerenciar o status do aplicativo React</a></li>
<li><a href="../pt463347/index.html">Abriu um conjunto de cursos de forma√ß√£o conjunta do Grupo-IB e Belkasoft em computa√ß√£o forense</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>