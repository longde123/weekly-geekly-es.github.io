<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëâ üè• ‚ùóÔ∏è Arbeiten Sie mit der KOMPAS-3D-API ‚Üí Lektion 14 ‚Üí Mehrzeiliger Text ü§≥üèΩ üöß üï†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In der vorherigen Lektion haben wir uns angesehen, wie mehrzeiliger Text mithilfe eines Absatzes angezeigt wird. Das beschriebene Verfahren erfordert ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Arbeiten Sie mit der KOMPAS-3D-API ‚Üí Lektion 14 ‚Üí Mehrzeiliger Text</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ascon/blog/434576/">  In der vorherigen Lektion haben wir uns angesehen, wie mehrzeiliger Text mithilfe eines Absatzes angezeigt wird.  Das beschriebene Verfahren erfordert das manuelle Durchlaufen des Arrays von Ausgabezeichenfolgen.  In dieser Lektion werden wir einen alternativen Weg ohne diesen Nachteil betrachten.  Es basiert auf der <b>ksTextParam-</b> Schnittstelle und der <b>ksTextEx-</b> Methode. <br><br><img src="https://habrastorage.org/webt/mk/4e/80/mk4e80xlw1xxnrdvu_ur3squcxy.png"><br><a name="habracut"></a><br><blockquote><h4>  Der Inhalt der Unterrichtsreihe ‚ÄûArbeiten mit der KOMPAS-3D-API‚Äú </h4><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Grundlagen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zeichnungsentwurf</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Richtige Verbindung zu KOMPAS</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hauptinschrift</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Grafische Grundelemente</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Speichern eines Dokuments in verschiedenen Formaten</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Einstellungen kennenlernen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anspruchsvollere Schreibmethoden im Schriftfeld</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beschriftungszellen lesen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sonderzeichen einschlie√ülich einer Zeichenfolge</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Einfache Textbeschriftungen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zusammengesetzte Zeichenfolgen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abs√§tze</a> </li><li>  <b>Mehrzeiliger Text</b> </li></ol></blockquote><br><h2>  <font color="#00B2FF"><b>Textoptionen</b> ( <b>ksTextParam</b> )</font> </h2><br>  Die <b>ksTextParam-</b> Schnittstelle ist ein Add-On zur <b>ksParagraphParam-</b> Schnittstelle und ein Array von Ausgabezeichenfolgen.  Um es zu erhalten, m√ºssen Sie die <b>GetParamStruct-</b> Methode der <b>KompasObject-</b> Schnittstelle mit der Konstante <i>ko_TextParam aufrufen</i> . <br>  Die <b>ksTextParam-</b> Schnittstelle <b>verf√ºgt</b> nicht √ºber <b>Eigenschaften</b> , daher werden die Methoden sofort ber√ºcksichtigt. <br>  <b>GetParagraphParam ()</b> - <b>Gibt</b> die Parameterschnittstelle des ksParagraphParam-Absatzes zur√ºck.  Es hat keine Eingabeparameter. <br>  <b>GetTextLineArr ()</b> - gibt ein dynamisches Array von ksDynamicArray von Ausgabezeilen zur√ºck.  Es hat keine Eingabeparameter. <br>  <b>Init ()</b> - setzt die Textparameter zur√ºck.  Es hat keine Eingabeparameter.  Wenn erfolgreich, wird true zur√ºckgegeben. <br>  <b>SetParagraphParam</b> - <b>Legt Absatzparameter fest</b> .  Als einziger Parameter akzeptiert es die <b>ksParagraphParam-</b> Schnittstelle, die die einstellbaren Parameter enth√§lt.  Bei Erfolg wird <i>true</i> und im Fehlerfall <i>false zur√ºckgegeben</i> . <br>  <b>SetTextLineArr</b> - Legt ein Array von Ausgabezeichenfolgen fest.  Als einziger Parameter wird die <b>ksDynamicArray-</b> Schnittstelle verwendet, die die Ausgabezeilen enth√§lt.  Bei Erfolg wird <i>true</i> und im Fehlerfall <i>false zur√ºckgegeben</i> . <br>  Das von der <b>GetTextLineArr ()</b> -Methode zur√ºckgegebene und von der <b>SetTextLineArr-</b> Methode festgelegte dynamische Array ist vom Typ <b>TEXT_LINE_ARR</b> .  Dies bedeutet, dass die Elemente des Arrays die <b>ksTextLineParam-</b> Schnittstellen sind. <br><br><h2>  <font color="#00B2FF"><b>KsTextEx-</b> Methode</font> </h2><br>  Verwenden <b>Sie</b> zum Anzeigen von mehrzeiligem Text die <b>ksTextEx-</b> Methode der <b>ksDocument2D-</b> Schnittstelle.  Unten ist ein Prototyp davon: <br><br><pre><code class="plaintext hljs">long ksTextEx ( LPDISPATCH txtParam, //  ksTextParam long align //   );</code> </pre> <br>  Die folgende Tabelle zeigt die g√ºltigen Ausrichtungsparameterwerte. <br><br><img src="https://habrastorage.org/webt/m-/83/xg/m-83xg9wbuyzpa_nca7v1eohkgo.png"><br><br>  Bei Erfolg gibt die <b>ksTextEx-</b> Methode einen ganzzahligen Zeiger auf den generierten Text zur√ºck.  Und im Fehlerfall - <i>Null</i> . <br><br><h2>  <font color="#00B2FF">Beispiel</font> </h2><br><div class="spoiler">  <b class="spoiler_title">Das Folgende ist ein Ausschnitt eines Programms, das die mehrzeilige Textausgabe mit der ksTextEx-Methode demonstriert.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//  DynamicArrayPtr items; items = static_cast&lt;DynamicArrayPtr&gt;(kompas-&gt;GetDynamicArray(TEXT_ITEM_ARR)); items-&gt;ksClearArray(); DynamicArrayPtr lines; lines = static_cast&lt;DynamicArrayPtr&gt;(kompas-&gt;GetDynamicArray(TEXT_LINE_ARR)); lines-&gt;ksClearArray(); //   TextLineParamPtr lineParam; lineParam = static_cast&lt;TextLineParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextLineParam)); lineParam-&gt;Init(); TextItemParamPtr itemParam; itemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); itemParam-&gt;Init(); TextItemFontPtr itemFont = static_cast&lt;TextItemFontPtr&gt;(itemParam-&gt;GetItemFont()); //   BSTR str = SysAllocString(OLESTR(" ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); lineParam-&gt;SetTextItemArr(items); lines-&gt;ksAddArrayItem(-1, lineParam); lineParam-&gt;Init(); SysFreeString(str); str = NULL; itemFont-&gt;set_bitVector(NEW_LINE | ITALIC_OFF); str = SysAllocString(OLESTR("  ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); lineParam-&gt;SetTextItemArr(items); lines-&gt;ksAddArrayItem(-1, lineParam); lineParam-&gt;Init(); SysFreeString(str); str = NULL; itemFont-&gt;set_bitVector(NEW_LINE | ITALIC_ON | BOLD_ON); str = SysAllocString(OLESTR(" ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); lineParam-&gt;SetTextItemArr(items); lines-&gt;ksAddArrayItem(-1, lineParam); lineParam-&gt;Init(); SysFreeString(str); str = NULL; itemFont-&gt;set_bitVector(NEW_LINE | BOLD_OFF | UNDERLINE_ON); str = SysAllocString(OLESTR(" ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); lineParam-&gt;SetTextItemArr(items); lines-&gt;ksAddArrayItem(-1, lineParam); lineParam-&gt;Init(); SysFreeString(str); str = NULL; itemParam.Unbind(); lineParam.Unbind(); itemFont.Unbind(); items.Unbind(); //    ParagraphParamPtr paragraphParam; paragraphParam= static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); paragraphParam-&gt;set_width(60.0); paragraphParam-&gt;set_hFormat(2); //    TextParamPtr textParam = static_cast&lt;TextParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextParam)); textParam-&gt;SetParagraphParam(paragraphParam); textParam-&gt;SetTextLineArr(lines); //  Document2D-&gt;ksTextEx(textParam, 1); lines-&gt;ksDeleteArray(); lines.Unbind(); paragraphParam.Unbind(); textParam.Unbind(); //   kompas-&gt;set_Visible(true); kompas.Unbind();</code> </pre><br></div></div><br>  In diesem Beispiel umgehen wir das Array nicht, sondern rufen die gew√ºnschte Methode einmal auf.  Er findet die <i>NEW_LINE-</i> Flags und interpretiert sie richtig.  Bitte beachten Sie: Jede neue Zeile mit diesem Flag wird in einer separaten <b>ksTextLineParam-</b> Schnittstelle ausgegeben.  Wenn Sie sie in einem <b>ksTextLineParam platzieren</b> , ignoriert <i>COMPAS</i> das <i>NEW_LINE-</i> Flag.  Die folgende Abbildung zeigt das Ergebnis dieses Programms. <br><br> <a href=""><img src="https://habrastorage.org/webt/p-/gc/sy/p-gcsy8wpi5wz8gxaa69q55uut4.png"></a> <br><br>  <b>Fazit</b> <br><br>  In dieser Lektion haben wir uns eine alternative M√∂glichkeit angesehen, mehrzeiligen Text anzuzeigen.  Es ist etwas komplizierter als das, was wir zuvor untersucht haben, erfordert jedoch kein manuelles Durchlaufen eines Arrays von Zeichenfolgen.  Welches Sie verwenden m√∂chten, liegt bei Ihnen. <br><br>  In der n√§chsten Lektion kehren wir zum Thema zusammengesetzte Linien zur√ºck und betrachten die dokumentierte Methode, um sie mithilfe von Abs√§tzen zu erstellen. <br><br>  <b>Um fortzufahren, folgen Sie den Nachrichten des Blogs.</b> <br><br> <a href=""><img src="https://habrastorage.org/web/595/eee/f27/595eeef271b24830b3578751fcb52716.png"></a>  Sergey Norseev, Ph.D., Autor des Buches "Anwendungsentwicklung f√ºr COMPAS in Delphi". </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de434576/">https://habr.com/ru/post/de434576/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de434564/index.html">Das Zeichnen macht 10% der Arbeit des UX-Designers aus</a></li>
<li><a href="../de434566/index.html">Forbes: Mark Zuckerberg wurde 2018 zu einem gro√üen Verlierer unter den Milliard√§ren. Er verlor fast 19 Milliarden Dollar.</a></li>
<li><a href="../de434568/index.html">Ergebnisse von 2018: Welche Prognosen haben sich im Zahlungsverkehr erf√ºllt?</a></li>
<li><a href="../de434570/index.html">Minimalistischer Online-Simulator f√ºr lineare DC- und AC-Schaltkreise</a></li>
<li><a href="../de434574/index.html">Reine CSS-Link-Unterstreichungsanimation</a></li>
<li><a href="../de434578/index.html">Digitale Hygiene: Die Spielregeln</a></li>
<li><a href="../de434580/index.html">2018 Toaster Statistik</a></li>
<li><a href="../de434582/index.html">Architekturl√∂sungen f√ºr ein Handyspiel. Teil 1: Modell</a></li>
<li><a href="../de434584/index.html">Die Daten sind lustig (und hier sind einige Beispiele)</a></li>
<li><a href="../de434586/index.html">Pers√∂nliches Flugzeug. Verstehe und warte</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>