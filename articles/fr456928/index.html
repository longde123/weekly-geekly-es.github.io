<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ”½ ğŸ–ğŸ¿ ğŸ© JMeter - Swiss Tester Knife (Partie 1) ğŸ§ğŸ½ â›¹ï¸ ğŸ‘©â€âœˆï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tu parles de JMeter? TrÃ¨s probablement, si vous Ãªtes dans le sujet, vous avez dÃ©jÃ  tout lu sur cet outil pour les tests de stress. Mais j'ai quelque c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>JMeter - Swiss Tester Knife (Partie 1)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456928/">  Tu parles de JMeter?  TrÃ¨s probablement, si vous Ãªtes dans le sujet, vous avez dÃ©jÃ  tout lu sur cet outil pour les tests de stress.  Mais j'ai quelque chose pour vous surprendre.  Pendant trois ans chez QA, j'ai rÃ©alisÃ© que JMeter est trÃ¨s polyvalent et peut Ãªtre utilisÃ© Ã  diverses fins.  Par exemple, pour: <br><br><ul><li>  rechercher un bug insaisissable avec la chute du site pour certains utilisateurs; </li><li>  rÃ©chauffement rapide du cache sur des milliers de pages produits; </li><li>  tester le backend d'une application mobile; </li><li>  crÃ©ation de 2000 enregistrements avec des donnÃ©es utilisateur dans la base de donnÃ©es d'application en peu de temps. </li></ul><br>  Si vous Ãªtes intÃ©ressÃ©, bienvenue au chat.  Il s'est avÃ©rÃ© volumineux, donc je vais diviser l'article en deux parties. <br><a name="habracut"></a><br><blockquote> <i><b>Avertissement:</b> Pour des raisons Ã©videntes, je n'insÃ¨re pas de captures d'Ã©cran de projets rÃ©els dans l'article (ni n'en extrait toutes les informations importantes).</i>  <i>Les illustrations sont fournies Ã  des fins de recherche et d'enseignement uniquement.</i> </blockquote><br><h2>  Application JMeter classique </h2><br>  JMeter - applet Java avec interface graphique.  Pour les tests, il dÃ©marre sans interface graphique.  Et pour Ã©crire des scripts de test, il a un panneau dans lequel vous pouvez faire n'importe quoi. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8d8/ac5/d62/8d8ac5d625f266f640fe6d65dce8e994.png" alt="CrÃ©ation d'un script sur JMeter"></div>  <font color="#999999"><i>Voici Ã  quoi ressemble le processus de crÃ©ation du script (ici mÃªme le mot "Ã©criture" ne convient pas)</i></font> <br><br>  Un plan de test commun est crÃ©Ã©, dans lequel le groupe de threads se jette avec les principaux Ã©lÃ©ments du test: les contrÃ´leurs de processus et les requÃªtes (HTTP, FTP, etc.). <br><br>  De plus, il existe des Ã©lÃ©ments supplÃ©mentaires pour dÃ©finir les paramÃ¨tres.  Par exemple, HTTP Request Defaults vous permet de spÃ©cifier le serveur principal, les en-tÃªtes et d'activer / dÃ©sactiver le tÃ©lÃ©chargement d'actifs supplÃ©mentaires (images, styles, polices, etc.).  C'est facile Ã  comprendre.  Et vous pouvez immÃ©diatement exÃ©cuter un test Ã  partir de cette interface et consulter les rÃ©sultats. <br><br>  JMeter peut enregistrer de tels cas de test.  Il s'exÃ©cute en tant que proxy sur la machine locale et, si vous configurez un navigateur (ou une application), gÃ©nÃ©rez du trafic via ce proxy, JMeter enregistrera toutes les demandes et rÃ©ponses.  Et Ã  partir de cet ensemble, vous pouvez concocter un script de test qui va rÃ©pÃ©ter les actions de l'utilisateur, et l'exÃ©cuter oÃ¹ et quand vous le souhaitez: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qy/z7/lq/qyz7lqjkh8y-e9ul3mqi76qceam.png" alt="Ã‰criture d'un script dans JMeter en fonction des actions de l'utilisateur"></div><br><br>  Le problÃ¨me principal est le tas de mÃ©moire de Java lui-mÃªme.  Il repose sur le plafond et peut tomber avec 50 fils de tests simultanÃ©s, mÃªme sur des machines haut de gamme. <br>  Si la machine n'a pas assez de puissance pour un test Ã  pleine charge, contactez une organisation tierce.  Ils ont dÃ©ployÃ© une infrastructure qui est un ensemble de serveurs.  Ils ont obtenu le mÃªme JMeter.  Moyennant des frais, ces gars exÃ©cuteront votre script sur n'importe quelle charge.  Nous avons demandÃ© ces services chez Octoperf et Blazemeter. <br><br><h2>  C'est le football, bÃ©bÃ©: comment nous avons attrapÃ© un bug avec un crash partiel du serveur </h2><br>  Nous sommes engagÃ©s dans le dÃ©veloppement Web depuis 18 ans (cheers - maintenant vous pouvez fumer, vous marier et regarder John Wick).  Il y a eu de nombreux clients au cours de leur vie, mais les plus importants sont apparus rÃ©cemment.  Par exemple, nous avons crÃ©Ã© un site sur <b>Sitecore</b> pour l'un des clubs de football de la Premier League anglaise avec le paradigme SPW (site Web Ã  page unique: toutes les pages s'ouvrent sans recharger la page du navigateur elle-mÃªme).  Sous le capot se trouve le panneau d'administration pour gÃ©rer une page de match en direct.  Il s'agit d'une diffusion textuelle en ligne du jeu: les principaux Ã©vÃ©nements (buts, suppressions, coups francs) sont chargÃ©s automatiquement Ã  partir du systÃ¨me Opta, et les photos, commentaires et reposts des fans de Twitter et Instagram sont publiÃ©s par des personnes en direct - gestionnaires de contenu de club de football. <br><br>  Je note avec fiertÃ©: aprÃ¨s la sortie, les mÃ©dias britanniques ont publiÃ© des articles sous les titres Â«Enfin, lâ€™hÃ©gÃ©monie des anciens sites des clubs de football est terminÃ©e.  A cette Ã©poque, la plupart des clubs avaient dÃ©jÃ  des sites.  Mais ils semblaient avoir Ã©tÃ© dÃ©veloppÃ©s au dÃ©but des annÃ©es 2000 et n'ont pas changÃ© depuis - avec le design et l'UX correspondants. <br><br>  Avant le lancement, nous avons effectuÃ© un test de pleine charge et nous nous sommes assurÃ©s que tout fonctionne comme il se doit.  La structure du serveur ressemblait Ã  ceci: <br><br><ol><li>  la demande du client va au serveur d'Ã©quilibrage de charge â†’ </li><li>  le serveur d'Ã©quilibrage de charge vÃ©rifie l'Ã©tat de huit serveurs <abbr title="Content Delivery, serveur de diffusion de contenu">CD</abbr> â†’ </li><li>  le serveur d'Ã©quilibrage de charge envoie une demande au serveur de CD le moins chargÃ© â†’ </li><li>  Le serveur de CD rÃ©pond au client. </li></ol><br>  Un an aprÃ¨s le lancement, lors d'un afflux important d'utilisateurs sur le site, le client a appelÃ© et dÃ©clarÃ© que le site Ã©tait en panne: <br><br>  - Notre site ne fonctionne pas!  Ã‡a ne marche pas du tout!  Juste un Ã©cran blanc et une inscription du navigateur que le site est en panne!  - dit le client. <br>  Nous sommes dans une panique ouvrant le site, et avec lui tout va bien: <br>  Â«Cela fonctionne toujoursÂ», rÃ©pondons-nous. <br>  Le client ouvre le site depuis le tÃ©lÃ©phone et l'ordinateur et ... tout va bien aussi! <br>  - Vraiment, dÃ©solÃ©.  Apparemment, les utilisateurs ont des problÃ¨mes. <br><br>  Ces messages n'apparaissent pas Ã  partir de zÃ©ro, nous avons donc menÃ© une Ã©tude: nous avons lancÃ© un utilitaire de surveillance de l'Ã©tat des serveurs Server Density et regardÃ© ce qui leur arrivait lors d'un afflux d'utilisateurs sur le site: <br><br><img src="https://habrastorage.org/webt/o8/m9/rd/o8m9rd9amg7mcl_vlf8ky2ce1wu.png" alt="Afficher l'historique de chargement du serveur dans Server Density"><br>  <font color="#999999"><i>Il y a une charge, mais tous les serveurs de CD se ressemblent et mÃªme</i></font> <br><br>  BientÃ´t, l'histoire s'est rÃ©pÃ©tÃ©e - certains utilisateurs ont signalÃ© un site complÃ¨tement cassÃ©.  Ce n'Ã©tait pas une erreur ou une page introuvable - le serveur n'a tout simplement pas rÃ©pondu Ã  la demande.  Il a Ã©tÃ© possible de rattraper la situation avec l'aide de JMeter. <br><br>  L'objectif Ã©tait simple: charger les huit serveurs et voir ce qui se passe.  Un test de rÃ©sistance a Ã©tÃ© effectuÃ© Ã  l'aube Ã  Tcheliabinsk, et Ã  Londres, la nuit a Ã©tÃ© profonde.  Nous avons utilisÃ© plusieurs machines en mode non-interface (cela vous permet d'exÃ©cuter beaucoup plus de threads en mÃªme temps).  Le script a sans cesse ouvert la page d'accueil, et c'Ã©tait notre principale erreur. <br><br><img src="https://habrastorage.org/webt/g_/fu/c-/g_fuc-c3uungpae4vrrhn2q-c94.png" alt="Le script de test de charge le plus simple dans JMeter pour demander une page dans une boucle"><br><br>  Nous avons tÃ©lÃ©chargÃ© les mÃªmes actifs qui Ã©taient dÃ©jÃ  mis en cache cent fois.  Par consÃ©quent, la charge est sortie insignifiante.  Puis l'idÃ©e est venue: sur le site - un chariot et un petit panier de pages avec des nouvelles pour certaines dates.  Si vous avancez quelques variables et les substituez dans l'URL, nous aurons toujours une page alÃ©atoire (par exemple - ... url / news / 2016/08/23 /? Page = 4). <br><br>  Du coup, nous avons rÃ©alisÃ© que Server Density avait un certain Â«lissageÂ» intÃ©grÃ© dans les graphiques de la charge du serveur au cours des pÃ©riodes passÃ©es.  Si, en cinq minutes, la charge sur le serveur atteint 100%, puis tombe Ã  0%, et aprÃ¨s 20-30 secondes a augmentÃ© Ã  90%, il affichera la valeur moyenne pour cette pÃ©riode - environ 80-90%.  Par consÃ©quent, nous n'avons pas vu de vÃ©ritable panne de serveur. <br><br>  AprÃ¨s avoir examinÃ© les journaux en dÃ©tail lors des tests de rÃ©sistance, nous avons dÃ©couvert que l'un des serveurs de CD s'est redÃ©marrÃ© Ã  100% et n'en a parlÃ© Ã  personne (il est tellement introverti). <br><br><img src="https://habrastorage.org/webt/i5/ie/n6/i5ien6w5zjrwwm1lk23crcj9vn8.png"><br><br>  L'Ã©quilibreur de charge n'a examinÃ© que l'utilisation du processeur de tous les serveurs.  Il a vu que l'un d'entre eux Ã©tait chargÃ© Ã  20% et le reste Ã  90% et a envoyÃ© l'utilisateur au premier.  Et il Ã©tait en train de redÃ©marrer et a donnÃ© un Ã©cran blanc.  De plus, le serveur de distribution a exposÃ© l'utilisateur Ã  un cookie et l'a liÃ© Ã©troitement au serveur inactif.  Par consÃ©quent, mÃªme aprÃ¨s la mise Ã  jour, le site n'Ã©tait pas disponible.  Les 7 autres utilisateurs sur 8 en mÃªme temps ont apprÃ©ciÃ© la vie et ont dit que tout fonctionnait. <br><br><h4>  <font color="#cc0000">Conclusion:</font> </h4><br>  nous avons constatÃ© que JMeter peut Ãªtre utilisÃ© pour les tests de rÃ©sistance et en mÃªme temps analyser l'Ã©tat des serveurs lors des tests avec d'autres outils.  Nous avons rÃ©ussi Ã  Â«attraperÂ» le problÃ¨me de la chute du site chez certains utilisateurs et Ã  le rÃ©soudre en corrigeant la logique de rÃ©partition de la charge et en ajoutant un contrÃ´le d'Ã©tat. <br><br>  Dans la partie suivante, je vais vous expliquer comment, avec l'aide de JMeter, nous avons mis en place le processus de mise en cache des pages produits, testÃ© le fonctionnement d'une application mobile sans l'application elle-mÃªme et crÃ©Ã© 2000 utilisateurs dans le systÃ¨me sans accÃ¨s Ã  la base de donnÃ©es. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr456928/">https://habr.com/ru/post/fr456928/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr456910/index.html">Internet project security.txt - apprendre Ã  connaÃ®tre un autre fichier bien connu</a></li>
<li><a href="../fr456912/index.html">Comment crÃ©er des sites en 2019</a></li>
<li><a href="../fr456920/index.html">Sony Xperia 1 en Russie - prix et bonus de prÃ©commande</a></li>
<li><a href="../fr456922/index.html">Comment les processeurs sont conÃ§us et fabriquÃ©s: les bases de l'architecture informatique</a></li>
<li><a href="../fr456926/index.html">Comment nous faisons Sportmaster</a></li>
<li><a href="../fr456930/index.html">Amener l'IoT Ã  la masse: rÃ©sultats du premier hackathon IoT de GeekBrains et Rostelecom</a></li>
<li><a href="../fr456932/index.html">OpenGL ultramoderne. Partie 1</a></li>
<li><a href="../fr456936/index.html">Cartes animÃ©es sur SwiftUI</a></li>
<li><a href="../fr456938/index.html">Lancement d'une application de taxi-toiling Ã  Tokyo: comment Sony le fait-il avec S. Ride?</a></li>
<li><a href="../fr456942/index.html">Le dieu aux multiples armes de l'Ã©chÃ©ance ou l'utilisation gÃ©nÃ©ralisÃ©e de l'analyse</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>