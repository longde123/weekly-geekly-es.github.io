<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🤝‍👩🏼 🧑🏾 🤙🏻 Codegenerierung in Dart. Teil 2. Anmerkungen, source_gen und build_runner 🚌 🕸️ 🙏🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Im ersten Teil haben wir herausgefunden, warum Codegenerierung erforderlich ist, und die erforderlichen Tools für die Codegenerierung in Dart aufgelis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Codegenerierung in Dart. Teil 2. Anmerkungen, source_gen und build_runner</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446264/"><p>  Im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ersten Teil haben</a> wir herausgefunden, warum Codegenerierung erforderlich ist, und die erforderlichen Tools für die Codegenerierung in Dart aufgelistet.  Im zweiten Teil erfahren Sie, wie Sie Anmerkungen in Dart erstellen und verwenden sowie wie Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">source_gen</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">build_runner verwenden</a> , um die Codegenerierung zu starten. </p><br><p><img src="https://habrastorage.org/webt/ol/eq/iu/oleqiu6qqryyv2otgwkcpwadrms.png"></p><a name="habracut"></a><br><h1 id="annotacii-v-dart">  Dart-Anmerkungen </h1><br><p> Anmerkungen sind syntaktische Metadaten, die dem Code hinzugefügt werden können.  Mit anderen Worten, es besteht die Möglichkeit, jeder Komponente des Codes zusätzliche Informationen hinzuzufügen, z. B. einer Klasse oder Methode.  Anmerkungen werden im Dart-Code häufig verwendet: Wir verwenden <code>@required</code> um anzuzeigen, dass ein benannter Parameter erforderlich ist, und unser Code wird nicht kompiliert, wenn der mit Anmerkungen versehene Parameter nicht angegeben wird.  Wir verwenden <code>@override</code> auch, um <code>@override</code> , dass eine bestimmte in einer übergeordneten Klasse definierte API in einer <code>@override</code> Klasse implementiert ist.  Anmerkungen beginnen immer mit dem <code>@</code> -Symbol. </p><br><h3 id="kak-sozdat-svoyu-annotaciyu">  Wie erstelle ich eine eigene Anmerkung? </h3><br><p>  Obwohl die Idee, dem Code Metadaten hinzuzufügen, etwas exotisch und kompliziert klingt, sind Anmerkungen eines der einfachsten Dinge in der Dart-Sprache.  Es wurde bereits gesagt, dass <em>Anmerkungen lediglich zusätzliche Informationen enthalten</em> .  Sie ähneln <strong>PODO</strong> (Plain Old Dart Objects).  Und <em>jede Klasse kann als Annotation dienen, wenn darin ein <code>const</code> Konstruktor definiert ist</em> : </p><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String name; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String todoUrl; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Todo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.name, {</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.todoUrl})</span></span></span><span class="hljs-function"> : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name != </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">null</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Todo</span></span>(<span class="hljs-string"><span class="hljs-string">'hello first annotation'</span></span>, todoUrl: <span class="hljs-string"><span class="hljs-string">'https://www.google.com'</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HelloAnnotations</span></span></span><span class="hljs-class"> </span></span>{}</code> </pre> <br><p>  Wie Sie sehen können, sind Anmerkungen sehr einfach.  Und was zählt, ist, was wir mit diesen Anmerkungen machen werden.  Dies wird uns helfen, <code>source_gen</code> und <code>build_runner</code> . </p><br><h3 id="kak-ispolzovat-build_runner">  Wie benutzt man build_runner? </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>build_runner</code></a> ist ein Dart-Paket, mit dem wir Dateien mit Dart-Code generieren können.  Wir werden <code>Builder</code> Dateien mit <code>build.yaml</code> .  Wenn es konfiguriert ist, wird <code>Builder</code> bei jedem <code>build</code> Befehl aufgerufen oder wenn die Datei geändert wird.  Wir haben auch die Möglichkeit, Code zu analysieren, der geändert wurde oder bestimmte Kriterien erfüllt. </p><br><h3 id="source_gen-dlya-ponimaniya-dart-koda">  source_gen zum Verständnis von Dartcode </h3><br><p>  In gewisser <code>build_runner</code> ist <code>build_runner</code> ein Mechanismus, der die Frage " <strong>Wann</strong> muss ich Code generieren?" Beantwortet.  Gleichzeitig beantwortet <code>source_gen</code> die Frage „ <strong>Welcher</strong> Code soll generiert werden?“.  <code>source_gen</code> bietet ein Framework zum Erstellen von <em>Buildern,</em> damit <code>build_runner</code> funktioniert.  Außerdem bietet <code>source_gen</code> eine praktische API zum Parsen und Generieren von Code. </p><br><h1 id="sobiraem-vse-vmeste-todo-report">  Alles zusammen: TODO-Bericht </h1><br><p>  Im Rest dieses Artikels werden wir <strong>das</strong> Projekt <strong>todo_reporter.dart zerlegen</strong> , das <a href="">hier</a> zu finden <a href="">ist</a> . </p><br><p>  Es gibt eine ungeschriebene Regel, der alle Projekte folgen, die die Codegenerierung verwenden: Sie müssen ein <strong>Paket mit Anmerkungen</strong> und ein <strong>separates Paket für den Generator</strong> erstellen, der diese Anmerkungen verwendet.  Informationen zum Erstellen einer Paketbibliothek in Dart / Flutter finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . </p><br><p>  Zuerst müssen Sie das Verzeichnis <code>todo_reporter.dart</code> erstellen.  In diesem Verzeichnis müssen Sie das Verzeichnis <code>todo_reporter</code> erstellen, das die Anmerkung enthält, das Verzeichnis <code>todo_reporter_generator</code> , um die Anmerkung zu verarbeiten, und schließlich das <code>example</code> das eine Demonstration der Funktionen der zu erstellenden Bibliothek enthält. </p><br><p>  Das Suffix <code>.dart</code> aus Gründen der Übersichtlichkeit zum Stammverzeichnisnamen hinzugefügt.  Dies ist natürlich nicht erforderlich, aber ich befolge diese Regel gerne, um genau anzuzeigen, dass dieses Paket in jedem Dart-Projekt verwendet werden kann.  Im Gegenteil, wenn ich angeben wollte, dass dieses Paket nur für Flutter ist (wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ozzie.flutter</a> ), würde ich ein anderes Suffix verwenden.  Dies ist nicht notwendig, es ist nur eine Namenskonvention, die ich einzuhalten versuche. </p><br><h3 id="sozdanie-todo_reporter-nashego-prostogo-paketa-s-annotaciey">  Erstellen Sie todo_reporter, unser einfaches Anmerkungspaket </h3><br><p>  Wir werden <code>todo_reporter</code> in <code>todo_reporter.dart</code> erstellen.  Erstellen Sie dazu die Datei <code>pubspec.yaml</code> und das Verzeichnis <code>lib</code> . </p><br><p>  <code>pubspec.yaml</code> sehr einfach: </p><br><pre> <code class="plaintext hljs">name: todo_reporter description: Keep track of all your TODOs. version: 1.0.0 author: Jorge Coca &lt;jcocaramos@gmail.com&gt; homepage: https://github.com/jorgecoca/todo_reporter.dart environment: sdk: "&gt;=2.0.0 &lt;3.0.0" dependencies: dev_dependencies: test: 1.3.4</code> </pre> <br><p>  Es gibt keine Abhängigkeiten außer dem im Entwicklungsprozess verwendeten Testpaket. </p><br><p>  <code>lib</code> im <code>lib</code> Verzeichnis wie folgt vor: </p><br><ul><li>  Sie müssen die Datei <code>todo_reporter.dart</code> erstellen, in der beim <code>export</code> alle Klassen mit einer öffentlichen API angegeben werden.  Dies ist eine gute Vorgehensweise, da jede Klasse in unserem Paket mit <code>import 'package:todo_reporter/todo_reporter.dart';</code> importiert werden kann <code>import 'package:todo_reporter/todo_reporter.dart';</code>  .  Sie können diese Klasse <a href="">hier sehen</a> . </li><li>  Innerhalb des <code>lib</code> Verzeichnisses erstellen wir das <code>src</code> Verzeichnis, das den gesamten Code enthält - öffentlich und nicht öffentlich. </li></ul><br><p>  In unserem Fall müssen wir lediglich eine Anmerkung hinzufügen.  Erstellen wir eine <code>todo.dart</code> Datei mit unserer Anmerkung: </p><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Todo</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String name; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String todoUrl; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Todo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.name, {</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.todoUrl})</span></span></span><span class="hljs-function"> : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name != </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">null</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; }</code> </pre> <br><p>  Das ist alles, was Sie zum Kommentieren benötigen.  Ich sagte, dass es einfach sein wird.  Das ist aber noch nicht alles.  Fügen wir dem Testverzeichnis Unit-Tests hinzu: </p><br><div class="spoiler">  <b class="spoiler_title">todo_test.dart</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:test/test.dart'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:todo_reporter/todo_reporter.dart'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ group(<span class="hljs-string"><span class="hljs-string">'Todo annotation'</span></span>, () { test(<span class="hljs-string"><span class="hljs-string">'must have a non-null name'</span></span>, () { expect(() =&gt; Todo(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>), throwsA(TypeMatcher&lt;AssertionError&gt;())); }); test(<span class="hljs-string"><span class="hljs-string">'does not need to have a todoUrl'</span></span>, () { <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> todo = Todo(<span class="hljs-string"><span class="hljs-string">'name'</span></span>); expect(todo.todoUrl, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); }); test(<span class="hljs-string"><span class="hljs-string">'if it is a given a todoUrl, it will be part of the model'</span></span>, () { <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> givenUrl = <span class="hljs-string"><span class="hljs-string">'http://url.com'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> todo = Todo(<span class="hljs-string"><span class="hljs-string">'name'</span></span>, todoUrl: givenUrl); expect(todo.todoUrl, givenUrl); }); }); }</code> </pre> </div></div><br><p>  Dies ist alles, was wir zum Erstellen der Anmerkung benötigen.  Den Code finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .  Jetzt können wir zum Generator gehen. </p><br><h3 id="delaem-klassnuyu-rabotu-todo_reporter_generator">  Einen coolen Job machen: todo_reporter_generator </h3><br><p>  <code>todo_reporter_generator</code> wir nun wissen, wie Pakete erstellt werden, erstellen <code>todo_reporter_generator</code> Paket <code>todo_reporter_generator</code> .  In diesem Paket sollten sich die <code>build.yaml</code> <code>pubspec.yaml</code> und <code>build.yaml</code> sowie ein <code>lib</code> Verzeichnis befinden.  Das <code>lib</code> Verzeichnis muss das <code>src</code> Verzeichnis und die Datei <code>builder.dart</code> enthalten.  Unser <code>todo_reporter_generator</code> wird als separates Paket betrachtet, das als <code>dev_dependency</code> zu anderen Projekten hinzugefügt wird.  Dies liegt daran, dass die Codegenerierung nur in der Entwicklungsphase erforderlich ist und nicht zur fertigen Anwendung hinzugefügt werden muss. </p><br><p>  <code>pubspec.yaml</code> wie folgt: </p><br><pre> <code class="plaintext hljs">name: todo_reporter_generator description: An annotation processor for @Todo annotations. version: 1.0.0 author: Jorge Coca &lt;jcocaramos@gmail.com&gt; homepage: https://github.com/jorgecoca/todo_reporter.dart environment: sdk: "&gt;=2.0.0 &lt;3.0.0" dependencies: build: '&gt;=0.12.0 &lt;2.0.0' source_gen: ^0.9.0 todo_reporter: path: ../todo_reporter/ dev_dependencies: build_test: ^0.10.0 build_runner: '&gt;=0.9.0 &lt;0.11.0' test: ^1.0.0</code> </pre> <br><p>  Jetzt erstellen <code>build.yaml</code> .  Diese Datei enthält die für unsere <em>Builder</em> erforderliche Konfiguration.  Weitere Details finden Sie <a href="">hier</a> .  <code>build.yaml</code> wie folgt: </p><br><pre> <code class="plaintext hljs">targets: $default: builders: todo_reporter_generator|todo_reporter: enabled: true builders: todo_reporter: target: ":todo_reporter_generator" import: "package:todo_reporter_generator/builder.dart" builder_factories: ["todoReporter"] build_extensions: {".dart": [".todo_reporter.g.part"]} auto_apply: dependents build_to: cache applies_builders: ["source_gen|combining_builder"]</code> </pre> <br><p>  Die <code>import</code> Eigenschaft verweist auf die Datei, die den <code>Builder</code> enthält, und die Eigenschaft <code>builder_factories</code> verweist auf die Methoden, mit denen der Code generiert wird. </p><br><p>  Jetzt können wir die Datei <code>builder.dart</code> im <code>lib</code> Verzeichnis erstellen: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:build/build.dart'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:source_gen/source_gen.dart'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:todo_reporter_generator/src/todo_reporter_generator.dart'</span></span>; <span class="hljs-function"><span class="hljs-function">Builder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">todoReporter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(BuilderOptions options)</span></span></span><span class="hljs-function"> </span></span>=&gt; SharedPartBuilder([TodoReporterGenerator()], <span class="hljs-string"><span class="hljs-string">'todo_reporter'</span></span>);</code> </pre> <br><p>  Und die Datei <code>todo_reporter_generator.dart</code> im Verzeichnis <code>src</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'dart:async'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:analyzer/dart/element/element.dart'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:build/src/builder/build_step.dart'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:source_gen/source_gen.dart'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:todo_reporter/todo_reporter.dart'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TodoReporterGenerator</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GeneratorForAnnotation</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Todo</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@override</span></span> <span class="hljs-function"><span class="hljs-function">FutureOr&lt;String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateForAnnotatedElement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( Element element, ConstantReader annotation, BuildStep buildStep)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"// Hey! Annotation found!"</span></span>; } }</code> </pre> <br><p>  Wie Sie sehen können, <code>builder.dart</code> wir in der Datei <code>todoReporter</code> die vom <code>Builder</code> erstellte Methode <code>builder.dart</code> definiert.  <code>Builder</code> wird mit dem <code>SharedPartBuilder</code> , der unseren <code>TodoReporterGenerator</code> .  <code>build_runner</code> und <code>source_gen</code> arbeiten also zusammen. </p><br><p>  Unser <code>TodoReporterGenerator</code> ist eine Unterklasse von <code>GeneratorForAnnotation</code> , daher wird die <code>generateForAnnotatedElement</code> Methode nur ausgeführt, wenn diese Annotation (in unserem Fall <code>@Todo</code> ) im Code gefunden wird. </p><br><p>  Die <code>generateForAnnotatedElement</code> Methode gibt eine Zeichenfolge zurück, die unseren generierten Code enthält.  <strong>Wenn der generierte Code nicht kompiliert wird, schlägt die gesamte Erstellungsphase fehl</strong> .  Dies ist sehr nützlich, da es Fehler in der Zukunft vermeidet. </p><br><p>  Daher erstellt unser <code>todo_repoter_generator</code> bei jeder Codegenerierung eine <code>todo_repoter_generator</code> mit dem Kommentar <code>// Hey! Annotation found!</code> <code>// Hey! Annotation found!</code>  Im nächsten Artikel erfahren Sie, wie Sie Anmerkungen verarbeiten. </p><br><h1 id="sobiraem-vse-vmeste-ispolzovanie-todo_reporter">  Alles zusammen: mit todo_reporter </h1><br><p>  Jetzt können Sie zeigen, wie <code>todo_reporter.dart</code> .  Es wird empfohlen, ein <code>example</code> hinzuzufügen, wenn Sie mit Paketen arbeiten.  So können andere Entwickler sehen, wie die API in einem realen Projekt verwendet werden kann. </p><br><p>  Lassen Sie uns ein Projekt erstellen und die erforderlichen Abhängigkeiten zu <code>pubspec.yaml</code> .  In unserem Fall erstellen wir ein Flutter-Projekt im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>example</code></a> und fügen die Abhängigkeiten hinzu: </p><br><pre> <code class="plaintext hljs">dependencies: flutter: sdk: flutter todo_reporter: path: ../todo_reporter/ dev_dependencies: build_runner: 1.0.0 flutter_test: sdk: flutter todo_reporter_generator: path: ../todo_reporter_generator/</code> </pre> <br><p>  Nach Erhalt der Pakete ( <code>flutter packages get</code> ) können wir unsere Anmerkung verwenden: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:todo_reporter/todo_reporter.dart'</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Todo</span></span>(<span class="hljs-string"><span class="hljs-string">'Complete implementation of TestClass'</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestClass</span></span></span><span class="hljs-class"> </span></span>{}</code> </pre> <br><p>  Nachdem alles vorhanden ist, lassen Sie unseren Generator laufen: </p><br><pre> <code class="bash hljs">$ flutter packages pub run build_runner build</code> </pre> <br><p>  Nachdem der Befehl ausgeführt wurde, werden Sie eine neue Datei in unserem Projekt <code>todo.g.dart</code> : <code>todo.g.dart</code> .  Es wird Folgendes enthalten: </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// GENERATED CODE - DO NOT MODIFY BY HAND part of 'todo.dart'; // ***************************************************************** // TodoReporterGenerator // ******************************************************************** // Hey! Annotation found!</span></span></code> </pre> <br><p>  Wir haben erreicht, was wir wollten!  Jetzt können wir die richtige Dart-Datei für jede <code>@Todo</code> Annotation in unserem Code generieren.  Versuchen Sie, so viele zu erstellen, wie Sie benötigen. </p><br><h1 id="v-sleduyuschey-state">  Im nächsten Artikel </h1><br><p>  Jetzt haben wir die richtigen Einstellungen zum Generieren von Dateien.  Im nächsten Artikel erfahren Sie, wie Sie Anmerkungen verwenden, damit der generierte Code wirklich coole Dinge bewirken kann.  Schließlich macht der Code, der jetzt generiert wird, wenig Sinn. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de446264/">https://habr.com/ru/post/de446264/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de446244/index.html">Chrome-Erweiterungen für die Webentwicklung und die Arbeit mit GitHub</a></li>
<li><a href="../de446248/index.html">Ankündigung eines FunTech QA-Automation-Meetups</a></li>
<li><a href="../de446252/index.html">Speichern einer Partition in Debian, wenn ein Fehler aufgetreten ist</a></li>
<li><a href="../de446254/index.html">So steigern Sie schnell Ihr drahtloses Netzwerk</a></li>
<li><a href="../de446258/index.html">Jedi-Entwicklertechniken für Mobilgeräte: Wie kann die App 2019 monetarisiert werden?</a></li>
<li><a href="../de446272/index.html">Wie viel kostet OpenSource?</a></li>
<li><a href="../de446276/index.html">Die Chang'e-4-Mission ist der vierte Mondtag für den Lander und den Yutu-2-Rover. Über Kameras und Controller auf Geräten</a></li>
<li><a href="../de446278/index.html">Die Rolle des IGF-1-Systems bei der Langlebigkeitsmodulation: Widersprüche und ein neues Verständnis aus der Sicht der Hundertjährigen</a></li>
<li><a href="../de446280/index.html">Wissenschaftsabteilung bei DUMP: Erweitern Sie Ihren Horizont</a></li>
<li><a href="../de446282/index.html">Wie kann HotSpot schnell mit den Anforderungen der Gesetze der Russischen Föderation bereitgestellt werden?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>