<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗒️ 🐉 🐗 RecyclerView dengan kecepatan maksimum: parsing libraries 💅🏻 🥂 👨‍🚀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ilya Nekrasov, Mahtalitet , android-developer KODE 
 Selama dua setengah tahun dalam pengembangan android, saya berhasil mengerjakan proyek yang sanga...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>RecyclerView dengan kecepatan maksimum: parsing libraries</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redmadrobot/blog/428525/"><p><img src="https://habrastorage.org/webt/02/i_/cl/02i_cl7q71uldgrkijpim0a0agk.jpeg"></p><br><p><img src="https://habrastorage.org/webt/np/kh/rc/npkhrc7elthbz0riiye9ri5zu1g.png" align="left">  <strong>Ilya Nekrasov, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">Mahtalitet</a> , android-developer KODE</strong> <br>  <em>Selama dua setengah tahun dalam pengembangan android, saya berhasil mengerjakan proyek yang sangat berbeda: dari jaringan sosial untuk pengendara dan bank Latvia ke sistem bonus federal dan maskapai ketiga untuk transportasi.</em>  <em>Lagi pula, di masing-masing proyek ini, saya menemukan tugas yang membutuhkan pencarian solusi non-klasik saat menerapkan daftar menggunakan kelas RecyclerView.</em> <em><br></em>  <em>Artikel ini - buah dari persiapan untuk pertunjukan di DevFest Kaliningrad'18, serta berkomunikasi dengan kolega - akan sangat berguna bagi pengembang pemula dan mereka yang hanya menggunakan salah satu perpustakaan yang ada.</em> </p><br><p>  Untuk mulai dengan, kami menggali sedikit ke dalam esensi masalah dan sumber rasa sakit, yaitu, pertumbuhan fungsionalitas dalam pengembangan aplikasi dan kompleksitas daftar yang digunakan. </p><a name="habracut"></a><br><h2 id="glava-pervaya-v-kotoroy-zakazchik-mechtaet-o-prilozhenii-a-my--o-chetkih-trebovaniyah">  Bab satu, di mana pelanggan memimpikan aplikasi, dan kami - tentang persyaratan yang jelas </h2><br><p><img src="https://habrastorage.org/webt/fi/wb/vs/fiwbvsaeyquagqloswybveolmaq.gif" align="right">  Mari kita bayangkan sebuah situasi ketika seorang pelanggan menghubungi sebuah studio yang menginginkan aplikasi mobile untuk toko bebek karet. </p><br><p>  Proyek ini berkembang pesat, ide-ide baru muncul secara teratur dan tidak dibingkai dalam peta jalan jangka panjang. </p><br><p>  Pertama, pelanggan meminta kami untuk menampilkan daftar barang yang ada dan, ketika diklik, mengisi permintaan pengiriman.  Anda tidak perlu melangkah jauh untuk solusi: kami menggunakan set klasik dari <strong>RecyclerView</strong> , adaptor yang ditulis sendiri sederhana untuk itu dan <strong>Activity</strong> . </p><br><p>  Untuk adaptor, kami menggunakan data homogen, satu <strong>ViewHolder</strong> dan logika pengikat sederhana. </p><br><div class="spoiler">  <b class="spoiler_title">Adaptor dengan bebek</b> <div class="spoiler_text"><pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DucksClassicAdapter</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>: List&lt;Duck&gt;, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> onDuckClickAction: (Duck) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> ) : RecyclerView.Adapter&lt;DucksClassicAdapter.ViewHolder&gt;() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(parent: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewGroup</span></span></span></span><span class="hljs-function"><span class="hljs-params">, viewType: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: ViewHolder { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> rubberDuckView = LayoutInflater.from(parent.context).inflate(R.layout.item_rubber_duck, parent, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ViewHolder(rubberDuckView) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> duck = <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>[position] holder.divider.isVisible = position != <span class="hljs-number"><span class="hljs-number">0</span></span> holder.rubberDuckImage.apply { Picasso.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>() .load(duck.icon) .config(Bitmap.Config.ARGB_4444) .fit() .centerCrop() .noFade() .placeholder(R.drawable.duck_stub) .into(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) } holder.clicksHolder.setOnClickListener { onDuckClickAction.invoke(duck) } } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getItemCount</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> = <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.count() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewHolder</span></span></span></span>(view: View) : RecyclerView.ViewHolder(view) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> rubberDuckImage: ImageView = view.findViewById(R.id.rubberDuckImage) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> clicksHolder: View = view.findViewById(R.id.clicksHolder) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> divider: View = view.findViewById(R.id.divider) } }</code> </pre> </div></div><br><p><br><br><img src="https://habrastorage.org/webt/kh/bn/x3/khbnx3_a59poubdcheopd3e5ax4.gif" align="left">  Seiring waktu, pelanggan memiliki ide untuk menambahkan kategori barang lain ke bebek karet, yang berarti bahwa ia harus menambahkan model data baru dan tata letak baru.  Tetapi yang paling penting, <strong>ViewType</strong> lain akan muncul di adaptor, yang dengannya Anda dapat menentukan ViewHolder mana yang akan digunakan untuk item daftar tertentu. </p><br><p>  Setelah itu, tajuk ditambahkan ke kategori, yang menurutnya setiap kategori dapat diciutkan dan diperluas untuk menyederhanakan orientasi pengguna di toko.  Ini ditambah <strong>ViewType</strong> lain dan <strong>ViewHolder</strong> untuk header.  Selain itu, Anda harus menyulitkan adaptor, karena Anda perlu menyimpan daftar grup terbuka dan menggunakannya untuk memeriksa kebutuhan untuk menyembunyikan dan menampilkan elemen ini atau itu dengan mengklik pada header. </p><br><div class="spoiler">  <b class="spoiler_title">Adaptor dengan segalanya</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DucksClassicAdapter</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> onDuckClickAction: (Pair&lt;Duck, <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>&gt;) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> onSlipperClickAction: (Duck) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> onAdvertClickAction: (Advert) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> ) : RecyclerView.Adapter&lt;RecyclerView.ViewHolder&gt;() { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>: List&lt;Duck&gt; = emptyList() <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(value) { field = value internalData = <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.groupBy { it.javaClass.kotlin } .flatMap { groupedDucks -&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> titleRes = <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (groupedDucks.key) { DuckSlipper::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">R</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">slippers</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RubberDuck</span></span></span><span class="hljs-class">:</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">:class -&gt; R.string.rubber_ducks else -&gt; R.string.mixed_ducks } groupedDucks.value.let { listOf</span></span></span></span>(FakeDuck(titleRes, it)).plus(it) } } .toMutableList() duckCountsAdapters = internalData.map { duck -&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> rubberDuck = (duck <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? RubberDuck) DucksCountAdapter( <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> = (<span class="hljs-number"><span class="hljs-number">1</span></span>..(rubberDuck?.count ?: <span class="hljs-number"><span class="hljs-number">1</span></span>)).map { count -&gt; duck to count }, onCountClickAction = { onDuckClickAction.invoke(it) } ) } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> advert = DuckMockData.adverts.orEmpty().shuffled().first() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> internalData: MutableList&lt;Duck&gt; = mutableListOf() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> duckCountsAdapters: List&lt;DucksCountAdapter&gt; = emptyList() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> collapsedHeaders: MutableSet&lt;Duck&gt; = hashSetOf() <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(parent: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewGroup</span></span></span></span><span class="hljs-function"><span class="hljs-params">, viewType: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: RecyclerView.ViewHolder { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (viewType) { VIEW_TYPE_RUBBER_DUCK -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> view = parent.context.inflate(R.layout.item_rubber_duck, parent) DuckViewHolder(view) } VIEW_TYPE_SLIPPER_DUCK -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> view = parent.context.inflate(R.layout.item_duck_slipper, parent) SlipperViewHolder(view) } VIEW_TYPE_HEADER -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> view = parent.context.inflate(R.layout.item_header, parent) HeaderViewHolder(view) } VIEW_TYPE_ADVERT -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> view = parent.context.inflate(R.layout.item_advert, parent) AdvertViewHolder(view) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> UnsupportedOperationException(<span class="hljs-string"><span class="hljs-string">"view type </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$viewType</span></span></span><span class="hljs-string"> without ViewHolder"</span></span>) } } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">RecyclerView</span></span></span></span><span class="hljs-function"><span class="hljs-params">.</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (holder) { <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> HeaderViewHolder -&gt; bindHeaderViewHolder(holder, position) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> DuckViewHolder -&gt; bindDuckViewHolder(holder, position) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> SlipperViewHolder -&gt; bindSlipperViewHolder(holder, position) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> AdvertViewHolder -&gt; bindAdvertViewHolder(holder) } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bindAdvertViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">AdvertViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { holder.advertImage.showIcon(advert.icon) holder.advertTagline.text = advert.tagline holder.itemView.setOnClickListener { onAdvertClickAction.invoke(advert) } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bindHeaderViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">HeaderViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> item = getItem(position) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> FakeDuck holder.clicksHolder.setOnClickListener { changeCollapseState(item, position) } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> arrowRes = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (collapsedHeaders.contains(item)) R.drawable.ic_keyboard_arrow_up_black_24dp <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> R.drawable.ic_keyboard_arrow_down_black_24dp holder.arrow.setImageResource(arrowRes) holder.title.setText(item.titleRes) } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">changeCollapseState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(item: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">FakeDuck</span></span></span></span><span class="hljs-function"><span class="hljs-params">, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isCollapsed = collapsedHeaders.contains(item) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isCollapsed) { collapsedHeaders.remove(item) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { collapsedHeaders.add(item) } <span class="hljs-comment"><span class="hljs-comment">// 1 to add items after header val startPosition = position + 1 if (isCollapsed) { internalData.addAll(startPosition - ADVERTS_COUNT, item.items) notifyItemRangeInserted(startPosition, item.items.count()) } else { internalData.removeAll(item.items) notifyItemRangeRemoved(startPosition, item.items.count()) } notifyItemChanged(position) } @SuppressLint("SetTextI18n") private fun bindSlipperViewHolder(holder: SlipperViewHolder, position: Int) { val slipper = getItem(position) as DuckSlipper holder.duckSlipperImage.showIcon(slipper.icon) holder.duckSlipperSize.text = ": ${slipper.size}" holder.clicksHolder.setOnClickListener { onSlipperClickAction.invoke(slipper) } } private fun bindDuckViewHolder(holder: DuckViewHolder, position: Int) { val duck = getItem(position) as RubberDuck holder.rubberDuckImage.showIcon(duck.icon) holder.rubberDuckCounts.adapter = duckCountsAdapters[position - ADVERTS_COUNT] val context = holder.itemView.context holder.rubberDuckCounts.layoutManager = LinearLayoutManager(context, HORIZONTAL, false) } override fun getItemViewType(position: Int): Int { if (position == 0) return VIEW_TYPE_ADVERT return when (getItem(position)) { is FakeDuck -&gt; VIEW_TYPE_HEADER is RubberDuck -&gt; VIEW_TYPE_RUBBER_DUCK is DuckSlipper -&gt; VIEW_TYPE_SLIPPER_DUCK else -&gt; throw UnsupportedOperationException("unknown type for $position position") } } private fun getItem(position: Int) = internalData[position - ADVERTS_COUNT] override fun getItemCount() = internalData.count() + ADVERTS_COUNT class DuckViewHolder(view: View) : RecyclerView.ViewHolder(view) { val rubberDuckImage: ImageView = view.findViewById(R.id.rubberDuckImage) val rubberDuckCounts: RecyclerView = view.findViewById(R.id.rubberDuckCounts) } class SlipperViewHolder(view: View) : RecyclerView.ViewHolder(view) { val duckSlipperImage: ImageView = view.findViewById(R.id.duckSlipperImage) val duckSlipperSize: TextView = view.findViewById(R.id.duckSlipperSize) val clicksHolder: View = view.findViewById(R.id.clicksHolder) } class HeaderViewHolder(view: View) : RecyclerView.ViewHolder(view) { val title: TextView = view.findViewById(R.id.headerTitle) val arrow: ImageView = view.findViewById(R.id.headerArrow) val clicksHolder: View = view.findViewById(R.id.clicksHolder) } class AdvertViewHolder(view: View) : RecyclerView.ViewHolder(view) { val advertTagline: TextView = view.findViewById(R.id.advertTagline) val advertImage: ImageView = view.findViewById(R.id.advertImage) } } private class FakeDuck( val titleRes: Int, val items: List&lt;Duck&gt; ) : Duck private fun ImageView.showIcon(icon: String, placeHolderRes: Int = R.drawable.duck_stub) { Picasso.get() .load(icon) .config(Bitmap.Config.ARGB_4444) .fit() .centerCrop() .noFade() .placeholder(placeHolderRes) .into(this) } private class DucksCountAdapter( private val data: List&lt;Pair&lt;Duck, Int&gt;&gt;, private val onCountClickAction: (Pair&lt;Duck, Int&gt;) -&gt; Unit ) : RecyclerView.Adapter&lt;RecyclerView.ViewHolder&gt;() { override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): RecyclerView.ViewHolder { val view = parent.context.inflate(R.layout.item_duck_count, parent) return CountViewHolder(view) } override fun getItemCount() = data.count() override fun onBindViewHolder(holder: RecyclerView.ViewHolder, position: Int) { (holder as CountViewHolder).count.apply { val item = data[position] text = item.second.toString() setOnClickListener { onCountClickAction.invoke(item) } } } class CountViewHolder(view: View) : RecyclerView.ViewHolder(view) { val count: TextView = view.findViewById(R.id.count) } }</span></span></code> </pre> </div></div><br><p>  Saya pikir Anda menangkap intinya - tumpukan kecil menyerupai perkembangan yang sehat.  Dan di depan ada semakin banyak persyaratan dari pelanggan: untuk memperbaiki spanduk iklan di bagian atas daftar, untuk menyadari kemungkinan memilih jumlah bebek yang dipesan.  Hanya tugas-tugas ini yang pada akhirnya akan berubah menjadi adaptor biasa, yang lagi-lagi harus ditulis dari awal. </p><br><blockquote>  Proses pengembangan adaptor klasik dalam sejarah <a href="">github</a> </blockquote><br><h3 id="itogi">  Ringkasan </h3><br><p>  Bahkan, gambarannya sama sekali tidak menggembirakan: adaptor individu harus diasah untuk kasus-kasus tertentu.  Kita semua mengerti bahwa dalam aplikasi nyata ada puluhan atau bahkan ratusan layar daftar seperti itu.  Dan mereka tidak mengandung informasi tentang bebek, tetapi data yang lebih kompleks.  Ya, dan desain mereka jauh lebih rumit. </p><br><h3 id="chto-ne-tak-s-nashimi-adapterami">  Apa yang salah dengan adaptor kami? </h3><br><ul><li>  jelas, mereka sulit untuk digunakan kembali; </li><li>  di dalam logika bisnis muncul dan seiring waktu menjadi lebih dan lebih; </li><li>  sulit dipertahankan dan dikembangkan; </li><li>  risiko kesalahan tinggi saat memperbarui data; </li><li>  desain tidak jelas. </li></ul><br><h2 id="glava-vtoraya-v-kotoroy-vse-moglo-byt-inache">  Bab Dua, di mana Semuanya Bisa Berbeda </h2><br><p>  Tidak realistis dan tidak masuk akal untuk membayangkan perkembangan aplikasi untuk tahun-tahun mendatang.  Setelah beberapa tarian seperti itu dengan rebana seperti pada bab terakhir dan menulis lusinan adaptor, siapa pun akan memiliki pertanyaan "Mungkin ada solusi lain?". </p><br><p><img src="https://habrastorage.org/webt/ct/6d/fx/ct6dfxsshhko-jfqycyqekpoqdu.jpeg"></p><br><p>  Setelah menyelesaikan Github, kami menemukan bahwa perpustakaan <strong>AdapterDelegates</strong> pertama <strong>kali</strong> muncul pada tahun 2015, dan setahun kemudian <strong>Groupie</strong> dan <strong>Epoxy</strong> ditambahkan ke gudang pengembang - mereka semua membantu membuat hidup lebih mudah, tetapi masing-masing memiliki spesifik dan perangkap tersendiri. </p><br><blockquote>  Ada beberapa pustaka yang serupa (misalnya, FastAdapter), tetapi baik saya maupun rekan saya tidak menggunakannya, jadi kami tidak akan mempertimbangkannya di artikel. </blockquote><p>  Sebelum membandingkan perpustakaan, kami menganalisis secara singkat kasus yang dijelaskan di atas dengan toko online dengan syarat menggunakan <strong>AdapterDelegates</strong> - dari perpustakaan yang dibongkar, ini adalah yang paling sederhana dari sudut pandang implementasi internal dan penggunaan (namun, itu tidak maju dalam segala hal, jadi Anda harus menambahkan banyak hal dengan tangan). </p><br><p>  Perpustakaan tidak akan sepenuhnya menyelamatkan kita dari adaptor, tetapi perpustakaan itu akan dibentuk dari blok (batu bata), yang dapat dengan aman kita tambahkan atau hapus dari daftar dan tukarkan. </p><br><div class="spoiler">  <b class="spoiler_title">Blok adaptor</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DucksDelegatesAdapter</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ListDelegationAdapter</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">List&lt;DisplayableItem</span></span></span><span class="hljs-class">&gt;&gt;</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">init</span></span> { delegatesManager.addDelegate(RubberDuckDelegate()) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(items: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">List</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">DisplayableItem</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.items = items notifyDataSetChanged() } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RubberDuckDelegate</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AbsListItemAdapterDelegate</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">RubberDuckItem, DisplayableItem, RubberDuckDelegate.ViewHolder</span></span></span><span class="hljs-class">&gt;</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isForViewType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(item: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">DisplayableItem</span></span></span></span><span class="hljs-function"><span class="hljs-params">, items: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">List</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">DisplayableItem</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;, position: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> RubberDuckItem } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(parent: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewGroup</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: ViewHolder { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> item = parent.context.inflate(R.layout.item_rubber_duck, parent, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ViewHolder(item) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(item: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">RubberDuckItem</span></span></span></span><span class="hljs-function"><span class="hljs-params">, viewHolder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">, payloads: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">List</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;)</span></span></span></span> { viewHolder.apply { rubberDuckImage.showIcon(item.icon) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewHolder</span></span></span></span>(itemView: View) : RecyclerView.ViewHolder(itemView) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> rubberDuckImage: ImageView = itemView.findViewById(R.id.rubberDuckImage) } }</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Menggunakan Adaptor Aktivitas</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DucksDelegatesActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AppCompatActivity</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ducksList: RecyclerView <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) setContentView(R.layout.activity_ducks_delegates) ducksList = findViewById(R.id.duckList) ducksList.apply { layoutManager = LinearLayoutManager(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span><span class="hljs-symbol"><span class="hljs-symbol">@DucksDelegatesActivity</span></span>) adapter = createAdapter().apply { showData() } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createAdapter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: DucksDelegatesAdapter { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> DucksDelegatesAdapter() } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> DucksDelegatesAdapter.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { setData(getRubberDucks()) } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRubberDucks</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: List&lt;DisplayableItem&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> DuckMockData.ducks.orEmpty().map { RubberDuckItem(it.icon) } } }</code> </pre> </div></div><br><p>  Dari tugas pertama, kita melihat perbedaannya: kita memiliki kelas adaptor yang diwarisi dari perpustakaan.  Dan selain itu - batu bata yang sama, yang disebut <strong>delegate</strong> dan dari mana kita juga mewarisi dan mengimplementasikan bagian dari logika yang kita butuhkan.  Selanjutnya kita menambahkan delegasi ke <strong>manajer</strong> - ini juga kelas perpustakaan.  Dan hal terakhir yang Anda butuhkan adalah membuat adaptor dan mengisinya dengan data </p><br><p>  Untuk mengimplementasikan kategori kedua toko dan header, kami akan menulis beberapa delegasi lagi, dan animasi muncul berkat kelas <strong>DiffUtil</strong> . </p><br><p>  Di sini saya akan menunjukkan kesimpulan singkat tetapi pasti: penggunaan bahkan perpustakaan ini memecahkan semua masalah yang tercantum yang muncul ketika kita mempersulit aplikasi dalam kasus dengan toko online, tetapi tanpa minus, di tempat lain. </p><br><blockquote>  Proses pengembangan adaptor dengan AdapterDelegate dalam riwayat <a href="">github</a> </blockquote><br><h2 id="glava-tretya-v-kotoroy-razrabotchik-snimaet-rozovye-ochki-sravniv-biblioteki">  Bab Tiga, di mana pengembang menghapus kacamata merah muda dengan membandingkan perpustakaan </h2><br><p>  Kami akan menyelami lebih detail fungsi dan operasi masing-masing perpustakaan.  Dengan satu atau lain cara saya menggunakan ketiga pustaka pada proyek kami, tergantung pada tugas dan kompleksitas aplikasi. </p><br><h3 id="adapterdelegateshttpsgithubcomsockeqweadapterdelegates">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Delegasi Adaptor</a> </h3><br><p><img src="https://habrastorage.org/webt/u9/9q/up/u99quph_ecf1su3ggudei9au6eg.gif" align="left">  Kami menggunakan perpustakaan ini dalam aplikasi salah satu maskapai penerbangan Rusia terbesar.  Kami perlu mengganti daftar pembayaran sederhana dengan daftar dengan grup dan sejumlah besar parameter berbeda. </p><br><p>  Skema kerja perpustakaan yang disederhanakan terlihat seperti ini: <img src="https://habrastorage.org/webt/w6/mw/4s/w6mw4shsbgr6ndkpbwvhsyuvayo.jpeg"></p><br><p>  Kelas utama adalah <strong>DelegateAdapter</strong> , berbagai "batu bata" adalah "delegasi" yang bertanggung jawab untuk menampilkan tipe data tertentu dan, tentu saja, daftar itu sendiri. </p><br><h4 id="plyusy">  Pro: </h4><br><ul><li>  kesederhanaan pencelupan; </li><li>  adaptor yang mudah digunakan kembali; </li><li>  beberapa metode dan kelas; </li><li>  tidak ada refleksi, pembuatan kode, dan penyatuan data. </li></ul><br><h4 id="minusy">  Cons: </h4><br><ul><li>  Anda perlu mengimplementasikan logika sendiri, misalnya <del>  memperbarui item melalui DiffUti </del>  l (sejak versi 3.1.0, Anda dapat menggunakan adaptor AsyncListDifferDelegationAdapter); </li><li>  kode mubazir. </li></ul><br><blockquote>  Secara umum, perpustakaan ini menyelesaikan semua kesulitan utama dalam memperluas fungsionalitas aplikasi dan cocok untuk mereka yang belum pernah menggunakan perpustakaan sebelumnya.  Tetapi untuk berhenti hanya di atasnya, saya tidak menyarankan. </blockquote><br><h3 id="groupiehttpsgithubcomlisawraygroupie">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Groupie</a> </h3><br><p><img src="https://habrastorage.org/webt/wm/ke/5w/wmke5wd9rsxtqknnr_jsdhn6m_s.gif" align="left">  Kami sering menggunakan <strong>Groupie</strong> , dibuat beberapa tahun lalu oleh <strong>Lisa Wray</strong> , termasuk menulis aplikasi untuk satu bank Latvia sepenuhnya menggunakannya. </p><br><p>  Untuk menggunakan perpustakaan ini, pertama-tama, Anda harus <strong>berurusan dengan dependensi</strong> .  Selain yang utama, Anda dapat menggunakan beberapa opsi untuk dipilih: </p><br><ul><li>  ekstensi untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kotlin Android Extensions</a> ; </li><li>  ekstensi untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengikatan Data Android</a> ; </li><li>  baik itu, dan yang lainnya. </li></ul><br><p>  Kami memikirkan satu hal dan menentukan ketergantungan yang diperlukan. </p><br><p>  Menggunakan contoh toko online dengan bebek, kita perlu membuat <strong>Item yang</strong> diwarisi dari kelas perpustakaan, menentukan tata letak dan menerapkan pengikatan melalui sintaksis Kotlin.  Dibandingkan dengan jumlah kode yang harus saya tulis dengan <strong>AdapterDelegates</strong> , itu hanya surga dan bumi. </p><br><p>  Yang tersisa hanyalah mengatur RecyclerView <strong>GroupieAdapter</strong> sebagai adaptor, dan memasukkan item yang diolok-olok ke dalamnya. </p><br><p><img src="https://habrastorage.org/webt/3z/q9/wi/3zq9wiax9tufogfr6fx9cwipobe.jpeg"></p><br><p>  Dapat dilihat bahwa skema kerjanya lebih besar dan lebih kompleks.  Di sini, selain item sederhana, Anda dapat menggunakan seluruh bagian - grup item dan kelas lainnya. </p><br><h4 id="plyusy-1">  Pro: </h4><br><ul><li>  antarmuka intuitif, meskipun api membuat Anda berpikir; </li><li>  adanya solusi kotak; </li><li>  pengelompokan menjadi kelompok elemen; </li><li>  pilihan antara opsi biasa, Kotlin Extensions dan DataBinding; </li><li>  embed ItemDecoration dan animasi. </li></ul><br><h4 id="minusy-1">  Cons: </h4><br><ul><li>  wiki tidak lengkap; </li><li>  dukungan yang buruk oleh pengelola dan masyarakat; </li><li>  bug kecil yang harus dielakkan di versi pertama; </li><li>  diffing di utas utama (untuk saat ini); </li><li>  tidak ada dukungan untuk AndroidX (saat ini, tetapi Anda perlu melacak repositori). </li></ul><br><p>  Adalah penting bahwa <strong>Groupie,</strong> dengan semua kekurangannya, dapat dengan mudah mengganti <strong>AdaptorDelegasi</strong> , terutama jika Anda berencana untuk membuat daftar lipat tingkat pertama, dan tidak ingin menulis banyak boilerplate. </p><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Menerapkan</a> Daftar Bebek bersama Groupie </blockquote><br><h3 id="epoxyhttpsgithubcomairbnbepoxy">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Epoksi</a> </h3><br><p><img src="https://habrastorage.org/webt/te/fg/tt/tefgttnpx4qijjlckdpxtuqpucq.gif" align="left">  Perpustakaan terakhir yang kami mulai gunakan relatif baru-baru ini adalah <strong>Epoxy</strong> , dikembangkan oleh orang-orang <strong>Airbnb</strong> .  Perpustakaan itu kompleks, tetapi memungkinkan Anda untuk menyelesaikan berbagai tugas.  Programmer Airbnb sendiri menggunakannya untuk membuat layar langsung dari server.  <strong>Epoxy</strong> berguna pada salah satu proyek terbaru kami - aplikasi untuk bank di Yekaterinburg. </p><br><p>  Untuk mengembangkan layar, kami harus bekerja dengan berbagai jenis data, sejumlah besar daftar.  Dan salah satu layar benar-benar tidak ada habisnya.  Dan <strong>Epoxy</strong> membantu kita semua menghadapi ini. </p><br><p>  Prinsip pustaka secara keseluruhan mirip dengan dua yang sebelumnya, kecuali bahwa alih-alih adaptor, EpoxyController digunakan untuk membangun daftar, yang memungkinkan Anda untuk menentukan secara deklaratif menentukan struktur adaptor. </p><br><p><img src="https://habrastorage.org/webt/im/rk/rl/imrkrl2d6nnnoolqijk-_ubvkmg.jpeg"></p><br><p>  Untuk mencapai hal ini, perpustakaan dibangun berdasarkan pembuatan kode.  Cara kerjanya - dengan semua nuansa yang dijelaskan dengan baik di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">wiki</a> dan tercermin dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sampel</a> . </p><br><h4 id="plyusy-2">  Pro: </h4><br><ul><li>  model untuk daftar, dihasilkan dari Tampilan biasa, dengan kemungkinan digunakan kembali di layar sederhana; </li><li>  deskripsi deklaratif layar; </li><li>  Pengikatan Data dengan kecepatan maksimum - menghasilkan model langsung dari file tata letak; </li><li>  cukup tampilkan tidak hanya daftar dari blok, tetapi juga layar yang rumit; </li><li>  ViewPool berbagi tentang Aktivitas; </li><li>  asynchronous diffing out of the box (AsyncEpoxyController); </li><li>  tidak perlu dikukus dengan daftar horisontal. </li></ul><br><h4 id="minusy-2">  Cons: </h4><br><ul><li>  banyak kelas, prosesor, anotasi; </li><li>  sulit menyelam dari awal; </li><li>  menggunakan plugin ButterKnife untuk menghasilkan file R2 dalam modul; </li><li>  sangat sulit untuk memahami cara bekerja dengan benar dengan Callback (kami sendiri belum mengerti); </li><li>  Ada masalah yang perlu dielakkan: misalnya, kerusakan dengan id yang sama. </li></ul><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Menerapkan</a> Daftar Bebek dengan Epoxy </blockquote><br><h2 id="itogi-1">  Ringkasan </h2><br><p>  Hal utama yang ingin saya sampaikan adalah: jangan tahan dengan kerumitan yang muncul ketika Anda perlu membuat daftar yang rumit dan terus-menerus harus mengulanginya.  Dan ini sangat sering terjadi.  Dan pada prinsipnya, ketika mereka diterapkan, jika proyek baru saja dimulai, atau Anda terlibat dalam refactoring-nya. </p><br><p>  Kenyataannya adalah bahwa tidak perlu mempersulit logika sekali lagi, berpikir bahwa beberapa jenis abstraksi kita sendiri sudah cukup.  Mereka cukup pendek Dan bekerja dengan mereka bukan hanya bukan kesenangan, tetapi ada juga godaan untuk mentransfer bagian dari logika ke bagian UI, yang seharusnya tidak ada di sana.  Ada alat yang dapat membantu Anda menghindari sebagian besar masalah, dan Anda harus menggunakannya. </p><br><blockquote>  Saya mengerti bahwa bagi banyak pengembang berpengalaman (dan tidak hanya) ini jelas atau mereka mungkin tidak setuju dengan saya.  Tetapi saya menganggap penting untuk menekankan ini lagi. </blockquote><br><h2 id="tak-a-chto-vybrat-to">  Jadi, apa yang harus dipilih? </h2><br><p>  Memberi saran untuk tetap di satu perpustakaan cukup sulit, karena pilihannya tergantung pada banyak faktor: dari preferensi pribadi hingga ideologi pada proyek. </p><br><p>  Saya akan melakukan hal berikut: </p><br><ol><li>  Jika Anda baru memulai jalan Anda dalam pengembangan, coba mulai <strong>pada proyek kecil</strong> dengan <strong>AdapterDelegates</strong> - ini adalah perpustakaan paling sederhana - tidak diperlukan pengetahuan khusus.  Anda akan memahami cara bekerja dengannya dan mengapa lebih nyaman daripada menulis adaptor sendiri. </li><li>  <strong>Groupie</strong> cocok untuk mereka yang sudah cukup banyak bermain dengan AdapterDelegates dan sudah lelah menulis banyak boilerplate, atau untuk <strong>semua orang</strong> yang ingin segera memulai dengan jalan tengah.  Dan jangan lupa tentang keberadaan <strong>kelompok lipat di luar kotak</strong> - ini juga argumen yang bagus untuknya. </li><li>  Nah, dan <strong>Epoxy</strong> - bagi mereka yang dihadapkan dengan proyek yang benar-benar kompleks, dengan sejumlah besar data, sehingga kompleksitas dengan perpustakaan yang gemuk akan menjadi masalah yang lebih kecil.  Pada awalnya akan sulit, tetapi kemudian implementasi daftar akan tampak seperti hal sepele.  Argumen penting yang mendukung Epoxy mungkin adalah kehadiran <strong>DataBinding</strong> dan <strong>MVVM</strong> pada proyek - itu secara harfiah dibuat untuk ini, mengingat kemungkinan menghasilkan model dari tata letak yang sesuai. </li></ol><br><p>  Jika Anda masih memiliki pertanyaan, Anda dapat melihat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tautan</a> untuk sekali lagi melihat kode aplikasi kami dengan detailnya. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id428525/">https://habr.com/ru/post/id428525/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id428513/index.html">500 laser pointer di satu tempat</a></li>
<li><a href="../id428515/index.html">Toko 3D Top: bagaimana kami berubah sepanjang tahun - hasil 2018</a></li>
<li><a href="../id428517/index.html">GraphQL - API dengan cara baru</a></li>
<li><a href="../id428521/index.html">Kenapa tidak ada teman di GitHub. Tentang Robbie Barrath, Obvious, dan Copyright</a></li>
<li><a href="../id428523/index.html">ShadowCloud - klien cloud universal</a></li>
<li><a href="../id428526/index.html">Pajak Google: 180 ° berbelok</a></li>
<li><a href="../id428528/index.html">Mengapa kaum revolusioner suka makanan pedas, atau Bagaimana cabai sampai di Cina</a></li>
<li><a href="../id428530/index.html">Hasil penyelidikan kecelakaan "Union MS-10"</a></li>
<li><a href="../id428532/index.html">HyperloopTT berencana untuk meluncurkan cabang Hyperloop pertama di Q3 2019</a></li>
<li><a href="../id428534/index.html">Mesin bor printer 3D dan konverter kartu bor PCAD ke G-Code</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>