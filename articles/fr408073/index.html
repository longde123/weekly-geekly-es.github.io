<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôç üëü üë®üèæ‚Äçüöí Comment nous avons d√©velopp√© la plateforme de bijoux √©lectroniques ü¶â ‚ÑπÔ∏è üïµÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'id√©e de croiser l'√©lectronique et les bijoux est tr√®s ancienne. Par cons√©quent, lorsque nous nous sommes souvenus d'elle, la recherche a produit un ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment nous avons d√©velopp√© la plateforme de bijoux √©lectroniques</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/408073/"> L'id√©e de croiser l'√©lectronique et les bijoux est tr√®s ancienne.  Par cons√©quent, lorsque nous nous sommes souvenus d'elle, la recherche a produit un grand nombre d'ouvrages sur ce sujet.  Certes, souvent, les bijoux √©lectroniques signifiaient des bijoux en √©lectronique - des morceaux de planche habill√©s d'√©poxy, des √©l√©ments, des pendentifs-microcircuits.  Nous voulions faire des d√©corations LED.  Pas comme dans les jouets chinois qui sont vendus √† chaque coin, car tout est plut√¥t inint√©ressant en eux - il existe plusieurs programmes clignotants qui peuvent √™tre commut√©s par un bouton, mais quelque chose de plus compliqu√© et int√©ressant.  Par exemple, les feux qui r√©agissent √† la lumi√®re ambiante br√ªlent plus fort dans l'obscurit√© et s'assombrissent √† la lumi√®re.  Ou scintillement au rythme de la musique environnante.  Ou changer de couleur en fonction de la temp√©rature ambiante.  Ou montrant la fr√©quence cardiaque du porteur.  En d'autres termes, nous voulions une sorte de r√©action active.  Je dois dire tout de suite - il s'est av√©r√© quelque chose comme ceci: <br><br><img src="https://habrastorage.org/webt/uz/qz/rx/uzqzrxdscialsafiiwgbicm2rqu.jpeg"><br><a name="habracut"></a><br>  <i>Avertissement: cet article a √©t√© √©crit principalement pour des sp√©cialistes non techniques, par cons√©quent, il contient des simplifications qui peuvent entra√Æner la d√©sapprobation des ing√©nieurs.</i>  <i>N'h√©sitez pas √† les exprimer.</i> <br><br>  Ainsi, les exigences pour la partie √©lectronique ont √©t√© form√©es: <br><br><ul><li>  il devrait y avoir plusieurs LED contr√¥l√©es (contr√¥l√©es - cela signifie que nous pouvons non seulement allumer et √©teindre leur √©clat, mais √©galement contr√¥ler leur luminosit√© et, surtout, leur couleur); </li><li>  au moins un capteur est requis - un capteur de lumi√®re, un capteur de temp√©rature ou un microphone.  Les capteurs de fr√©quence cardiaque ont √©t√© report√©s jusqu'√† pr√©sent - ils n√©cessitent une approche directe du corps (par cons√©quent, votre bracelet de fitness est inutile √† cet √©gard si vous le mettez sur le haut de la chemise); </li><li>  la commande doit √™tre programmable.  Cela signifie que nous pouvons √† tout moment changer la logique de contr√¥le des LED en une plus appropri√©e pour l'environnement de la d√©coration finie, par exemple, si des couleurs froides pr√©valent dans la d√©coration, alors rendre l'√©clat appropri√©; </li><li>  l'appareil doit √™tre compact et l√©ger, car les objets lourds limitent consid√©rablement les possibilit√©s de leur utilisation; </li><li>  le circuit doit √™tre aliment√© par des piles ou des piles qui peuvent √™tre achet√©es √† n'importe quel coin, pour la commodit√© du consommateur. </li></ul><br>  Apr√®s avoir fix√© ces exigences, nous avons commenc√© √† r√©fl√©chir s√©rieusement.  Comme toute t√¢che technique, celle-ci avait de nombreuses solutions. <br><br>  Par exemple, nous pourrions prendre un constructeur standard comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">LiliPad</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Adafruit GEMMA</a> , cr√©√© juste √† ces fins.  Si vous regardez des exemples GEMMA, vous pouvez voir un grand nombre de projets similaires avec des LED, il y a m√™me des boucles d'oreilles.  Malheureusement, le concepteur est tr√®s bien adapt√© au stade du prototype, lorsque l'appareil doit √™tre assembl√© √† partir de salet√©s et de b√¢tons pour v√©rifier s'il fonctionne, mais, h√©las, il ne convient absolument pas √† une petite s√©rie - des connecteurs, des connexions suppl√©mentaires et la construction dans son ensemble interf√®rent .  Eh bien, le co√ªt du concepteur et des pi√®ces d√©tach√©es (et nous nous souvenons que nous avons encore besoin de LED et de capteurs) joue √©galement de mani√®re d√©sagr√©able sur le co√ªt du produit final, pas dans la direction la plus int√©ressante pour l'acheteur.  Les concepteurs sont donc une bonne option, mais ils soul√®vent un grand nombre de questions. <br><br>  Une alternative est de d√©velopper la partie √©lectronique dans son ensemble et de mani√®re ind√©pendante.  Ce chemin est √† la fois plus simple (car nous ne pouvons laisser que ce qui est n√©cessaire) et difficile (car la cr√©ation d'un appareil programmable, m√™me pour notre t√¢che apparemment simple, a beaucoup d'emb√ªches et de solutions de compromis).  Bien s√ªr, en voyant une si merveilleuse occasion d'√©tirer certaines parties du corps, nous ne pouvions pas passer. <br><br>  Ici, probablement, il vaut la peine de faire une petite excursion dans la fabrication de l'√©lectronique et comment cela se produit. <br><br><div class="spoiler">  <b class="spoiler_title">Comment faire de l'√©lectronique sur vos doigts</b> <div class="spoiler_text">  Tout d'abord, l'id√©e et les exigences de l'appareil sont form√©es (enfin, ce que nous avons d√©j√† fait).  Ces exigences sont ensuite discut√©es avec des sp√©cialistes de l'√©lectronique et clarifi√©es conjointement - le projet est envahi de d√©tails et de nuances. <br><br>  Un diagramme sch√©matique de l'appareil est dessin√© - comment les composants √©lectroniques doivent √™tre connect√©s les uns aux autres pour fonctionner ensemble.  Le sch√©ma est v√©rifi√© dans la pratique - √† partir des moyens disponibles et le premier appareil est assembl√© sur le c√¢blage.  Si cela fonctionne, cela signifie que le sch√©ma d'origine √©tait correct et vous pouvez continuer. <br><br>  Apr√®s avoir un sch√©ma de circuit √©prouv√© de l'appareil, la partie la plus int√©ressante commence - la disposition des PCB, c'est-√†-dire  un tel morceau de PCB avec des pistes sur lesquelles des composants √©lectroniques sont soud√©s.  Vous pouvez, bien s√ªr, tout faire sur le c√¢blage, mais ce sera lent, ennuyeux et extr√™mement peu fiable.  De plus, la technologie moderne a atteint une telle prolif√©ration qu'il est possible de produire une carte de circuit imprim√© de qualit√© industrielle pour tr√®s peu d'argent.  Cependant, nous le verrons toujours.  Concevoir une carte de circuit imprim√©, c'est montrer comment nous allons organiser les √©l√©ments et comment ils seront interconnect√©s.  Ou, tout simplement, nous devons redessiner le sch√©ma de circuit magnifiquement et en tenant compte des dimensions physiques r√©elles des pi√®ces. <br><br>  Il ne suffit pas de concevoir une carte de circuit imprim√© (dans le jargon professionnel - ¬´diluer¬ª), vous devez toujours la pr√©parer pour la production, c'est-√†-dire  g√©n√©rer l'ensemble de documents correct, qui comprend l'apparence du r√©sultat, le sch√©ma des pistes conductrices, le sch√©ma de per√ßage et de m√©tallisation.  Habituellement, m√™me les ing√©nieurs exp√©riment√©s ne l‚Äôobtiennent pas tout de suite, surtout lorsque l‚Äôappareil n‚Äôest pas simple.  Ces fichiers (au format Gerber) sont transf√©r√©s en production.  Alors que la carte de circuit imprim√© est lib√©r√©e, il y a un achat d'√©l√©ments qui seront soud√©s √† elle.  Dans une langue professionnelle, la liste de ces √©l√©ments est appel√©e BoM (de l'anglais Bill of Materials - une liste de composants). <br><br>  Apr√®s avoir re√ßu la carte de circuit imprim√© et achet√© tous les composants n√©cessaires, les √©l√©ments sont mont√©s sur la carte, qui peut √™tre manuelle (g√©n√©ralement utilis√©e pour de petites s√©ries allant jusqu'√† mille exemplaires) ou automatique (avec des machines sp√©ciales pour les gros lots).  L'installation manuelle ressemble √† un ing√©nieur avec un fer √† souder, qui soude simplement les √©l√©ments √† la carte selon le sch√©ma qui lui est fourni. <br><br>  Une fois l'installation termin√©e, l'appareil est programm√© (s'il contient des micropuces qui le permettent) et est test√©, c'est-√†-dire  Son op√©rabilit√© et sa r√©sistance √† diverses influences externes sont v√©rifi√©es.  Si l'appareil a pass√© tous les tests, il est reconnu comme op√©rationnel et transf√©r√© plus loin dans l'emballage (c'est-√†-dire le placement dans une bo√Æte) ou pour un traitement ult√©rieur (comme dans notre cas).  Sinon, ils en diagnostiquent les causes, les r√©parent, les retestent et les rejettent d√©finitivement ou les transmettent. <br><br>  En g√©n√©ral, le processus de fabrication de l'√©lectronique n'est pas le plus simple et le plus trivial.  Si vous √™tes d√©termin√© √† suivre cette voie, nous vous recommandons fortement de faire appel √† des ing√©nieurs qualifi√©s dans ce domaine, de pr√©f√©rence ayant une exp√©rience dans ce domaine. <br></div></div><br>  Donc, nous avons une id√©e et il y a des exigences.  Reste √† les incarner "dans la glande". <br><br>  Les r√©flexions sur la question ont suscit√© de nombreux doutes: <br><br><ul><li>  Les LED sont des √©l√©ments assez ¬´gourmands¬ª, car ce sont des sources lumineuses.  Les LED contr√¥l√©es ont trois fois ¬´faim¬ª, car il s'agit essentiellement de trois LED diff√©rentes combin√©es dans un seul bo√Ætier (composants de couleur rouge, verte et bleue).  Et, comme nous nous en souvenons, nous voulions un appareil compact, c'est-√†-dire  pour une grosse batterie, nous n'avons tout simplement pas d'espace; </li><li>  la batterie et l'alimentation sont le goulot d'√©tranglement du projet dans son ensemble.  Permettez-moi de vous rappeler que, selon le plan, en plus des LED, il devrait y avoir des capteurs et un circuit de contr√¥le de la lueur qui consomment √©galement de l'√©nergie √©lectrique.  Et il est peu probable que l'acheteur soit satisfait si ses bijoux fonctionnent pendant plusieurs minutes et n√©cessitent ensuite un changement de piles; </li><li>  l'appareil doit √™tre programmable - c.-√†-d.  nous devons √™tre capables de contr√¥ler la lueur au niveau du programme.  Ce qui n√©cessite automatiquement un microprocesseur appel√© microcontr√¥leur.  Il s'agit d'une puce √† laquelle vous pouvez connecter √† la fois des LED et des capteurs.  √Ä l'int√©rieur, il y a un simple microprocesseur et une m√©moire, qui vous permet d'y √©crire un programme pour contr√¥ler tous les appareils connect√©s.  Et ce microcontr√¥leur, comme il ressort des paragraphes pr√©c√©dents, devrait consommer tr√®s peu d'√©nergie √©lectrique, afin de ne pas condamner l'utilisateur √† un changement constant de batteries; </li><li>  comme il y a tellement de capteurs diff√©rents, il a √©t√© d√©cid√© de se concentrer sur un seul d'entre eux - le capteur de lumi√®re.  Une photor√©sistance est utilis√©e comme un tel capteur, qui fonctionne selon ce principe - si la lumi√®re tombe dessus, alors sa r√©sistance diminue, si elle est dans l'obscurit√©, elle augmente.  Il s'agit d'un simple capteur, le reliant √† l'entr√©e du microcontr√¥leur, nous obtenons un appareil de mesure de l'√©clairage.  Pour l'avenir, je dirai qu'il existe des capteurs de temp√©rature et de bruit qui fonctionnent selon les m√™mes principes et peuvent remplacer la photor√©sistance sans apporter de modifications importantes au circuit final; </li><li>  la carte de circuit imprim√© sur laquelle l'installation doit √™tre effectu√©e doit √™tre ronde ou avec des coins biseaut√©s - encore une fois, pour des raisons esth√©tiques, il n'y a pas tellement de d√©corations rectangulaires et carr√©es. </li></ul><br>  Donc, nous creusons dans la recherche, trions les combinaisons et en cons√©quence nous obtenons une telle solution qui nous satisfait: <br><br><ol><li>  puissance - une pile CR2032 standard, c'est aussi une "tablette", de la taille d'une pi√®ce de dix roubles.  Fournit 3 volts, est stock√© pendant une longue p√©riode, fonctionne dans une large gamme de temp√©ratures, bon march√©, est vendu dans n'importe quel supermarch√©.  Le support pour une telle batterie est terriblement simple et aussi tr√®s peu co√ªteux; </li><li>  microcontr√¥leur - Atmel Attiny85, compact, faible puissance, facilement programmable, pas cher.  Un avantage suppl√©mentaire est que cette puce a une entr√©e analogique (c'est-√†-dire que vous pouvez y connecter un capteur sans circuits suppl√©mentaires) et un petit nombre de pieds (ce qui dans notre d√©sir de compacit√© est un tr√®s gros avantage); </li><li>  Les LED sont SK6812 mini, qui mesurent 3,5 mm sur 3,5 mm.  Il nous a sembl√© que les LED ordinaires de cinq millim√®tres seront tr√®s globales et tr√®s gourmandes pour ce circuit.  De plus, ils sont g√©n√©ralement aliment√©s avec une tension de 5 volts, et notre batterie ne fournit que 3 volts, soit  pour travailler, vous auriez besoin d'utiliser un convertisseur, ce que je ne voulais pas; </li><li>  une photor√©sistance, il est un capteur de lumi√®re - un capteur traditionnel, qui est utilis√© dans les cam√©ras et les interphones pour d√©terminer le d√©but de la nuit. </li></ol><br>  Apr√®s avoir choisi les composants, t√©l√©chargez la documentation du contr√¥leur et des LED et plongez dans l'√©tude.  Des nuances apparaissent - les LED sont connect√©es en s√©rie, ¬´par train¬ª et contr√¥l√©es par un fil, dans lequel le contr√¥leur doit former un signal d'une mani√®re sp√©ciale, grosso modo - envoyer une certaine s√©quence de chiffres, chacun signifiant avec quelle intensit√© chacune des LED int√©gr√©es est allum√©e (et nous rappelez-vous que dans un cas, nous en avons trois - rouge, vert et bleu).  C'est-√†-dire  nous devons envoyer s√©quentiellement la luminosit√© du rouge, du vert et du bleu pour la premi√®re LED, puis pour la seconde, puis pour la troisi√®me et ainsi de suite, selon le nombre d'entre elles allum√©es en s√©rie.  Si vous avez vu des bandes LED dans les magasins de construction scintiller avec tous les rayons de l'arc-en-ciel, sachez qu'elles fonctionnent selon le m√™me principe. <br><br>  En plus de contr√¥ler ces LED, une protection contre les interf√©rences est requise, ce qui n√©cessitera un condensateur pour chaque LED.  De plus, le m√™me condensateur d'interf√©rence est requis pour le microcontr√¥leur. <br><br>  De plus, les LED, m√™me dans une conception aussi compacte, sont toujours gourmandes en √©nergie.  Par cons√©quent, leur cupidit√© doit √™tre limit√©e, et nous avons un limiteur - la r√©sistance.  C'est-√†-dire  Chaque LED n√©cessite une r√©sistance de limitation de courant suppl√©mentaire.  C'est dr√¥le que pendant le d√©veloppement du produit, il s'est av√©r√© que ces r√©sistances n'aident pas beaucoup, mais combien elles nuisent - avec le nombre de LED plus de quatre, il y avait un manque de courant et j'ai d√ª les changer √† z√©ro ohm, c'est-√†-dire  cavaliers courants pour que les LED fonctionnent correctement.  Dans les versions ult√©rieures du sch√©ma, nous les avons compl√®tement supprim√©s. <br><br>  La photor√©sistance n√©cessitait √©galement une r√©sistance suppl√©mentaire faisant office de diviseur de tension.  Vous pouvez trouver des exemples complets de sch√©mas de connexion si vous conduisez dans le moteur de recherche "connexion arduino d'une photor√©sistance". <br><br>  S√©par√©ment, il convient de mentionner pour la programmation du microcontr√¥leur - afin de t√©l√©charger le firmware (code de programme sous forme binaire) dans Attiny85, un appareil sp√©cial est n√©cessaire - un "programmeur".  Heureusement, il est assembl√© sur la base du concepteur √©lectronique Arduino (qui comprend son fr√®re a√Æn√©, √©galement un microcontr√¥leur Atmel, mais plus s√©rieux), qui peut √™tre achet√© dans n'importe quel magasin √©lectronique ou en Chine pour peu d'argent. <br><br>  Et enfin, le commutateur - nous ne voulons pas que l'utilisateur ins√®re et retire constamment la batterie. <br><br>  Cependant, malgr√© tout ce qui pr√©c√®de, le sch√©ma de circuit s'est av√©r√© simple par rapport √† la plupart des appareils domestiques (tr√®s probablement, votre flux thermique est plus compliqu√© en √©lectronique que notre circuit): <br><br><img src="https://habrastorage.org/webt/hg/ts/p7/hgtsp7br6z-gthfvr0cbgyeonzy.png"><br><br>  En cons√©quence, nous avons obtenu un appareil dont les dimensions sont l√©g√®rement plus grandes qu'une batterie de tablette ordinaire.  En fait, la batterie et l'interrupteur sont plac√©s d'un c√¥t√©, les LED, le microcontr√¥leur et le capteur de lumi√®re de l'autre.  √âtant donn√© que les LED peuvent √©galement affecter le capteur de lumi√®re situ√© √† proximit√© (par exemple, allumez-le de sorte qu'il suppose que le cercle est clair, bien qu'il puisse y avoir toujours cette obscurit√©), il a √©t√© d√©cid√© de le monter avec la possibilit√© de le plier dans un plan perpendiculaire √† la direction lueur. <br><br>  √Ä la suite du c√¢blage, nous avons obtenu une carte de circuit imprim√© assez simple.  Avant de c√¢bler, nous avons v√©rifi√© le circuit et il s'est av√©r√© √™tre fonctionnel, mais avec une mise en garde - nous l'avons test√© sur une source d'alimentation constante, pas sur une batterie, de sorte que les craintes qu'une si petite batterie ait dur√© pendant une courte p√©riode sont rest√©es jusqu'au moment o√π nous avons soud√© les premiers appareils. <br><br>  Donc, le circuit est fait, la carte est divorc√©e.  Et puis le premier compromis - le fait est que les microcontr√¥leurs Attiny85 sont disponibles dans deux types de bo√Ætiers - DIP (ce sont des microcircuits classiques avec des broches que vous avez probablement vus √† l'aube de la propagation de l'√©lectronique et dans des appareils simples) et SO (ce sont des microcircuits plans, petit et compact, ne n√©cessitant pas de trous suppl√©mentaires pour le soudage et mont√© sur le dessus de la carte par soudage).  Au moment de la conception, le composant SO de notre fournisseur √©tait plus cher et, surtout, il n'√©tait pas disponible.  Par cons√©quent, nous avons pris la version DIP, mais avec l'espoir de la programmer d'abord, puis de mordre doucement les jambes et de la souder comme SO, directement sur la carte.  Cela a introduit un risque technologique suppl√©mentaire - changer le firmware de cette option apr√®s avoir soud√© le microcontr√¥leur sur la carte ne serait pas une t√¢che tr√®s triviale, mais lequel d'entre nous n'aime pas les difficult√©s?! <br><br><img src="https://habrastorage.org/webt/fl/6a/xf/fl6axfi3kxuermcoedmtb-l6o4u.jpeg" alt="Attiny85 DIP / SO"><br><br>  Nous avons command√© des cartes en Chine, ce processus a √©t√© d√©bogu√© et nous avons commenc√© √† assembler les composants.  Les LED et les supports de piles ont √©galement √©t√© command√©s en Chine, soit ils n'√©taient pas sur le march√© local, soit ils co√ªtaient de l'argent ind√©cent.  Le reste a √©t√© achet√© au supermarch√© √©lectronique le plus proche.  Des microcontr√¥leurs pourraient √©galement √™tre command√©s en Chine, mais un grand nombre de commentaires n√©gatifs et notre propre triste exp√©rience (lorsque les composants envoy√©s ne fournissaient pas une qualit√© suffisamment bonne) nous ont emp√™ch√© une telle √©tape.  Par cons√©quent, au moment o√π nous avons re√ßu les cartes de circuits imprim√©s finies, l'ensemble de la BoM √©tait entre nos mains.  Il reste m√™me du temps pour souder lentement le programmateur des microcontr√¥leurs. <br><br><img src="https://habrastorage.org/webt/ni/go/qo/nigoqohjskm-xouftocvfrydfwa.jpeg"><br><br>  Apr√®s avoir re√ßu les cartes, nous avons soud√© un appareil de test.  √âtant donn√© que le programme du microcontr√¥leur a √©t√© report√© jusqu'√† ce que l'appareil fini soit re√ßu (et c'√©tait correct, j'expliquerai pourquoi un peu plus tard), nous n'avons pas soud√© le microcontr√¥leur "pour de bon", mais nous avons fabriqu√© un tampon de transition dans lequel le microcircuit peut √™tre ins√©r√© dans la cartouche comme ampoule.  Comme pr√©vu, l'appareil n'a pas fonctionn√©.  En regardant attentivement l'appareil (pendant quelques heures), nous avons trouv√© une erreur - les LED n'√©taient pas correctement soud√©es.  Le fait est que lors de l'installation de micropuces et d'√©l√©ments avec un grand nombre de pieds, il est tr√®s important de ne pas confondre ces pieds et de mettre l'√©l√©ment correctement.  Pour ce faire, les ing√©nieurs sur le marquage sur la carte de circuit imprim√© utilisent une cl√© - une image d'un point qui doit co√Øncider avec la m√™me chose sur le corps de la puce.  En cons√©quence, le processus de soudage d'un tel √©l√©ment ressemble √† ceci - nous combinons les cl√©s, soudons une jambe et soudons toutes les autres.  Confondre la cl√© est g√©n√©ralement lourd de cons√©quences n√©gatives - l'auteur de ces lignes a en quelque sorte pouss√© le microcontr√¥leur dans le programmateur du mauvais c√¥t√© - apr√®s cinq secondes, il sentait frit dans l'air, et le doigt qui a touch√© la puce a re√ßu une br√ªlure nette sous la forme du bo√Ætier.  Heureusement, personne d'autre n'a √©t√© bless√© et apr√®s refroidissement, le microcontr√¥leur a √©galement continu√© de fonctionner. <br><br>  Ainsi, lors de la conception de notre carte, nous avons appliqu√© une description self-made pour les LED (les SK6812 de trois millim√®tres sont assez rares que les WS2812) et il a √©t√© confondu avec une cl√© en toute s√©curit√©.  Par cons√©quent, lors de l'installation, la cl√© LED doit √™tre de l'autre c√¥t√© par rapport √† la cl√© marqu√©e sur la carte.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le panneau d'essai est all√© en toute s√©curit√© √† la ferraille. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le deuxi√®me √©chantillon de test a d√©j√† √©t√© construit en tenant compte de cette erreur. </font><font style="vertical-align: inherit;">Maintenant, nous √©tions s√ªrs que notre circuit √©tait op√©rationnel et nous nous sommes mis √† programmer le firmware. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cela ressemblait √† ceci:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la puce du microcontr√¥leur a √©t√© ins√©r√©e dans le programmateur; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> le firmware y a √©t√© vers√©; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la puce a √©t√© retir√©e et ins√©r√©e dans l'appareil; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> l'alimentation a √©t√© mise sous tension et l'op√©rabilit√© a √©t√© v√©rifi√©e; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tout a √©t√© r√©p√©t√© au d√©but. </font></font></li></ul><br><img src="https://habrastorage.org/webt/bi/ng/bd/bingbd5ygulzpskw2ej_qcfjlxu.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je constate que parfois au cours de la journ√©e, cette op√©ration devait √™tre r√©p√©t√©e plusieurs dizaines de fois. </font><font style="vertical-align: inherit;">Il √©tait possible de souder le programmateur directement sur la puce de la carte, mais, comme vous vous en souvenez, nous ne cherchons pas de moyens faciles. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au stade de la programmation √©galement, de nombreuses choses int√©ressantes ont √©t√© r√©v√©l√©es.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tout a commenc√© avec le fait qu'aucune des biblioth√®ques standard pour travailler avec des LED contr√¥l√©es ne fonctionnait. La raison n'√©tait pas au m√™me endroit, mais √† deux. Premi√®rement, les intervalles de temps pour coder les signaux de commande √©taient destin√©s √† d'autres types de LED et ne co√Øncidaient pas l√©g√®rement avec ceux indiqu√©s dans la documentation pour la n√¥tre. Deuxi√®mement, il s'est av√©r√© que le microcontr√¥leur dans le cas de la batterie fonctionne √† une fr√©quence plus basse et par d√©faut peut la r√©duire encore plus pour √©conomiser de l'√©nergie (ce qui se produit lorsqu'il est sur la batterie), ce qui conduit √† nouveau √† une modification des intervalles de temps pour contr√¥ler les LED. Quelques heures dans une √©treinte avec un oscilloscope ont aid√© √† affiner la biblioth√®que aux intervalles souhait√©s, et une demi-heure et quelques exp√©riences nous ont permis de trouver une commande interdisant au microcontr√¥leur de changer la fr√©quence de travail.√Ä la suite d'une bataille de moyenne √† longue dur√©e, nous avons pu contr√¥ler normalement les LED, en les √©clairant avec les couleurs dont nous avions besoin, et pas dans un ordre compl√®tement al√©atoire.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La deuxi√®me surprise a pr√©sent√© un capteur de lumi√®re. Apr√®s l'avoir programm√©, nous ne pouvions pas comprendre pendant longtemps pourquoi il n'y avait aucune r√©action √† le fermer avec un doigt (c.-√†-d. Compl√®tement obscurci) du mot ¬´compl√®tement¬ª. La r√©ponse est venue apr√®s quelques jours de regarder de pr√®s des exemples de travail avec de tels capteurs. Il s'est av√©r√© que lors de la configuration du port analogique auquel le capteur devait √™tre connect√©, il √©tait n√©cessaire d'utiliser une num√©rotation et lors de la lecture des lectures - une autre (oui, je me souvenais aussi de la blague "Wow, il y a une erreur √† un chiffre, mais quelle diff√©rence!")) . Apr√®s cette prise de conscience, tout a fonctionn√© comme il se doit. Le firmware a √©t√© √©crit. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme on nous a envoy√© non pas une, et pas deux cartes de circuits imprim√©s, mais dix √† la fois (une, comme nous nous en souvenons, a √©t√© √©limin√©e), nous avons soudainement soud√© toutes les autres.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il s'est av√©r√© que la loi des grands nombres fonctionne √©galement en petits lots - des d√©fauts de production sont apparus sur deux cartes sur dix - nos coll√®gues chinois n'ont pas fait suffisamment de connexions √©lectriques entre les couches avant et arri√®re de la carte, et en cons√©quence, rien n'a fonctionn√© en raison d'un manque de puissance. Heureusement, cela est facilement √©limin√© en soudant les trous intercouches avec le conducteur. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les appareils sont assembl√©s, test√©s et transf√©r√©s pour un traitement ult√©rieur afin de donner l'apparence d'une d√©coration finie. En fait, nous n'avons pas pass√© plus d'une semaine sur l'ensemble du d√©veloppement, mais en raison de distractions pour d'autres t√¢ches et attentes (temps libre, composants, circuits imprim√©s), l'ensemble de ce processus s'est √©tal√© sur un intervalle de temps de six mois. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si quelqu'un est int√©ress√© - le code source et le mat√©riel du projet sont publi√©s sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'histoire ne s'arr√™te pas l√†. Apr√®s la premi√®re exp√©rience instructive, nous avons fait plusieurs autres versions de la planche. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La deuxi√®me version √©tait en deux versions - avec six LED dans un cercle et quatre (une au centre) et diff√©rait en ce que nous avons utilis√© ici le codage SO de la puce. Mais ici, il y a eu quelques exc√®s - lors du c√¢blage de la carte en raison d'une confusion dans les noms, la mauvaise zone de contact a √©t√© choisie et, par cons√©quent, les pattes de la puce pour l'installation ont d√ª √™tre pouss√©es sous le bo√Ætier. De plus, ils ont sorti les contacts pour le firmware et les trois "power-signal-ground" sur des sites s√©par√©s, pour pouvoir ajouter plus de LED comme √©l√©ment externe.</font></font><br><br><img src="https://habrastorage.org/webt/r9/lj/lc/r9ljlchh7gttw_jiyfdhzhcylq4.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus, un autre inconv√©nient d√©sagr√©able a √©t√© r√©v√©l√© - le ma√Ætre m'a demand√© de rendre la planche parfaitement ronde (dans notre version, elle ressemblait plus √† un rectangle aux coins arrondis). Ils l'ont fait en v√©rifiant simultan√©ment l'industrie chinoise pour la production de circuits imprim√©s d'une √©paisseur inf√©rieure √† un millim√®tre. Le r√©sultat a √©t√© compl√®tement satisfait - en rempla√ßant les supports par ceux con√ßus pour les piles CR2016, nous avons obtenu une plate-forme encore plus l√©g√®re, √† partir de laquelle vous pouvez d√©j√† fabriquer, par exemple, des boucles d'oreilles. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour le firmware de ces appareils, le programmeur √† la "ferme collective" a √©t√© utilis√© sur la broche pogo. Il s'est av√©r√© que la proc√©dure de chargement du firmware n'√©tait toujours pas anodine - il √©tait n√©cessaire d'appuyer fermement la carte sur les broches, ce qui n'√©tait pas imm√©diatement possible la premi√®re fois.</font></font><br><br><img src="https://habrastorage.org/webt/dv/vd/u6/dvvdu6vhiegubulmejwyl220wec.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'apoth√©ose du d√©veloppement de cette branche de la plateforme √©tait la troisi√®me et derni√®re version. </font><font style="vertical-align: inherit;">Dans ce document, les contacts pour le firmware ont √©t√© affich√©s sur un c√¢ble flexible s√©par√©, une carte suppl√©mentaire pour le programmeur a √©t√© command√©e. </font><font style="vertical-align: inherit;">Lors de cette it√©ration, nous avons √©valu√© le service Seeedstudio PCBA, qui nous a fabriqu√© des cartes de circuits imprim√©s - l'industrie chinoise est venue avec les cartes install√©es avec la plupart des √©l√©ments, nous avons soud√© le connecteur de contact pour le programmateur, le support de batterie, la photor√©sistance et les LED en place - ils n'ont pas √©t√© trouv√©s (sauf pour la photor√©sistance) dans composants disponibles pour l'installation. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le r√©sultat ressemble √† ceci: </font></font><br><br><img src="https://habrastorage.org/webt/c8/fq/gj/c8fqgjh5buzgycilsgtg2l2lwxq.jpeg"><br><br><img src="https://habrastorage.org/webt/hh/xb/gz/hhxbgz7hpzidjydb0mskpxyrjl4.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En g√©n√©ral, le projet s'est av√©r√© int√©ressant. </font><font style="vertical-align: inherit;">Il s'est av√©r√© que m√™me des choses apparemment simples peuvent cacher des nuances assez complexes √† l'int√©rieur, ce qui a √©t√© clairement montr√©.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr408073/">https://habr.com/ru/post/fr408073/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr408061/index.html">Fuite de son dans les casques √† conduction osseuse avec Aftershokz Trekz Titanium comme exemple</a></li>
<li><a href="../fr408063/index.html">Revue Honor 6A: l'employ√© du budget est diff√©rent</a></li>
<li><a href="../fr408065/index.html">Les m√©decins allemands ont d√©velopp√© une peau transg√©nique pour 80% du corps d'un enfant</a></li>
<li><a href="../fr408067/index.html">De SimCity √† Real Girlfriend: une histoire de jeux de simulation, partie 1</a></li>
<li><a href="../fr408071/index.html">D√©j√† 2500 boutiques en ligne exploitent les ordinateurs des visiteurs</a></li>
<li><a href="../fr408075/index.html">10 startups scientifiques prometteuses de 2017 selon C&EN</a></li>
<li><a href="../fr408077/index.html">Pourquoi l'iPhone 8 est meilleur que l'iPhone X</a></li>
<li><a href="../fr408079/index.html">Une nouvelle version du moteur Merlin pour Falcon 9 a explos√© pendant les tests</a></li>
<li><a href="../fr408081/index.html">Parfois √ßa ne marche pas</a></li>
<li><a href="../fr408083/index.html">Observation d√©pendante des satellites dans l'aviation civile</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>