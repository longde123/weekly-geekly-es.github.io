<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê£ üåè üè∏ Histoire d'Holivarny sur Linter üôç ‚ôÄÔ∏è üë©‚Äçüëß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous √©crivons tous du code. Beaucoup de code. Bien s√ªr, il y a des erreurs. Parfois, c'est juste un code tordu, et parfois le prix d'une erreur est un...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Histoire d'Holivarny sur Linter</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/433480/">  Nous √©crivons tous du code.  Beaucoup de code.  Bien s√ªr, il y a des erreurs.  Parfois, c'est juste un code tordu, et parfois le prix d'une erreur est un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vaisseau spatial</a> √©clat√©.  Bien s√ªr, personne ne fait des jambages intentionnels, tout le monde essaie de surveiller la qualit√© au mieux de ses capacit√©s, mais sans outils d'analyse statique, il est √† peine possible d'√™tre s√ªr que tout est parfait. <br><br>  Les linters aident √† apporter du code √† un seul style et √† √©viter les erreurs.  Certes, seulement si vous √™tes pr√™t √† souffrir, et ne rejetez pas finalement ¬´pylint: disable¬ª, seulement pour le retarder.  Ce qui devrait √™tre un linter et pourquoi Pylint ne peut pas le faire, conna√Æt Nikita <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Sobolevn</a> , qui comprend et aime tellement les linters qu'il a m√™me nomm√© son entreprise pour ne pas les contrarier - wemake.services. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/56f/5cb/946/56f5cb9466bea0d6fd71b319f5165c2a.png" alt="image"><br><br>  Vous trouverez ci-dessous la version texte du rapport sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Moscou Python Conf ++</a> sur les linters, comment les faire correctement et comment ne pas le faire.  La pr√©sentation a eu beaucoup d'interactivit√©, en ligne et de communication avec le public.  L'orateur, en cours de route, a men√© des sondages et tent√© de convaincre le public: il a regard√© la tendance, et comme dans le d√©bat, il a essay√© d'√©galiser le rapport et de changer l'opinion publique.  Une partie des sondages est tomb√©e dans le d√©cryptage, mais pas tous, donc une vid√©o est jointe pour compl√©ter l'image. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/7IVCOzL41Lk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h2>  Pourquoi avons-nous besoin de linters? <br></h2><br>  La t√¢che la plus importante de linter consiste <strong>√† uniformiser le code</strong> .  Il existe de nombreuses options pour √©crire la m√™me chose en Python: mettez une virgule ici ou l√†, oubliez de fermer les crochets ou n‚Äôoubliez pas.  Lorsque les gens √©crivent du code depuis longtemps, cela devient comme une courtepointe patchwork de pi√®ces disparates cousues √† diff√©rents moments.  C'est d√©sagr√©able de travailler avec une telle couverture, cela d√©courage la lecture du code, ce qui est tr√®s mauvais. <br><br>  <strong>Les linters facilitent la vie lors d'un examen</strong> .  J'en viens √† la r√©vision du code et je pense: ¬´Je ne veux pas faire √ßa!  Maintenant, il y aura des espaces suppl√©mentaires et d'autres b√™tises! ¬ª  J'aimerais que quelqu'un d'autre pr√©pare un bon code, et apr√®s cela j'appr√©cierai les grandes choses conceptuelles. <br><br>  Parfois, je regarde le code et je pense que tout va bien, puis je vois dans certaines fonctions trop de variables ou une erreur √† laquelle je n'ai pas fait attention.  L'automatisation trouverait cette erreur, mais j'ai regard√©.  Afin de ne pas tomber dans de telles situations - j'utilise le <strong>linter</strong> - il <strong>trouve tout ce qui est cach√© et difficile √† trouver.</strong> <br><br><h2>  Que sont les linters? </h2><br>  <strong>Les plus simples ne v√©rifient que le style</strong> , par exemple <strong>Flake8</strong> .  Dans une certaine mesure, √©galement noir, mais c'est plut√¥t un autoformeur-linter.  <strong>Les linters testent la s√©mantique plus difficile</strong> , et pas seulement la stylistique: ce que vous faites, pourquoi et vous frappent sur les mains si vous √©crivez avec des erreurs.  Un bon exemple est <strong>Pylint</strong> , que nous connaissons, utilisons et aimons tous.  J'appelle ces linters - <strong>Meilleures pratiques</strong> .  Le troisi√®me type est la <strong>v√©rification de type</strong> , ces linter sont un peu sur le c√¥t√©.  La v√©rification de type en Python est nouvelle, elle est maintenant effectu√©e par deux plates-formes concurrentes: <strong>Mypy</strong> et <strong>Pyre</strong> . <br><br><h2>  Comment utiliser linter? </h2><br>  Je ne pr√©tends pas que le linter est une panac√©e et un remplacement pour tout.  Ce n'est pas le cas.  Linter - la premi√®re √©tape de la pyramide, par laquelle le code entre en production. <br><br>  Il y a trois √©tapes dans la pyramide: <br><br><ul><li>  <strong>Lancez linter</strong> .  Il est tr√®s rapide et n'a besoin que du code source - pas d'infrastructure, pas de param√®tres.  V√©rifiez: le premier <strong>bilan de sant√© est</strong> pass√© - tout va bien, nous y travaillons. </li><li>  <strong>√âtape de test</strong> .  Ce processus est plus compliqu√© et plus long en raison d'erreurs non cod√©es.  Nous aurons d√©j√† besoin d'une configuration correcte et compl√®te de l'ensemble de l'application. </li><li>  <strong>Revue d'√©tape</strong> . </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/77c/f40/e1c/77cf40e1cbfb54f312e98c7af63ac9d0.png"><br><br>  <b>Ce sont les √©tapes n√©cessaires</b> pour que le code entre en production.  Si vous n'avez pas franchi une √©tape, oubli√© quelque chose ou que le critique a dit que cela ne fonctionnerait pas, vous verrez l'inscription: √©chou√© - le mauvais code ne se met pas en production. <br><br><h3>  Utilisez-vous un linter au travail? </h3><br>  Si vous demandez aux d√©veloppeurs d'une entreprise difficile, dans laquelle ils travaillent 7 jours par semaine, s'ils utilisent un linter, alors il s'av√®re qu'au moins un tiers d'entre eux utilisent des linters tr√®s strictement: <strong>les baisses de CI, les contr√¥les sont s√©v√®res</strong> .  Les autres appliquent √† peu pr√®s √©galement le linter <strong>au style de test</strong> , <strong>jamais</strong> et en tant que <strong>syst√®me de rapport</strong> : ils d√©marrent le linter, g√©n√®rent un rapport et voient √† quel point tout est mauvais.  Les linters sont utilis√©s, et c'est bien.  Dans notre entreprise, tout a √©t√© construit tr√®s durement: liens durs, beaucoup de contr√¥les, double revue de code. <br><br><h3>  Examen du code <br></h3><br>  Des probl√®mes surviennent juste √† ce stade.  Il s'agit de l'√©tape la plus difficile et la plus difficile de la pyramide: la r√©vision du code ne peut pas √™tre automatis√©e et, si possible, elle conduira √† l'automatisation de l'√©criture du code.  Ensuite, les programmeurs ne seront pas n√©cessaires. <br><br>  Le processus standard ressemble √† ceci: le code vient pour un examen, je trouve des erreurs et je ne veux plus les faire.  Par exemple, j'ai vu que le d√©veloppeur a attrap√© BaseException: ¬´Ne faites pas √ßa.  Veuillez ne pas attraper! "  Apr√®s 10 jours, la m√™me chose.  Je vous rappelle encore: <br><br>  - <em>Nous n'attrapons pas BaseException.</em> <br>  " <em>Bien, je comprends."</em> <br><br>  Une ann√©e passe - la m√™me erreur.  Un nouvel homme arrive - la m√™me erreur.  Je pense - comment pouvons-nous tout automatiser pour que la situation ne se reproduise plus et ne nous vienne √† l'esprit: ¬´ <strong>Entaillons notre linter?</strong>  ¬ªCr√©ons un package ouvert, y mettons toutes les r√®gles que nous utilisons dans le travail et automatisons le contr√¥le des r√®gles afin que chaque fois que nous n'√©crivions pas √† la main.  Nous automatisons tout bien et tout de suite! <br><br>  Naturellement, vous pouvez dire: ¬´Les <strong>linters pr√™ts √† l'emploi existent d√©j√†,</strong> ils fonctionnent, tout le monde les utilise - pourquoi faire les leurs?¬ª, Et vous aurez tout √† fait raison, car il y a vraiment des linters.  Voyons lesquels et ce qu'ils font. <br><br><h3>  Pylint <br></h3><br>  Sur la rubrique " <strong>Pourquoi pas Pylint?"</strong>  "J'ai entendu cette question √† plusieurs reprises.  Je vais lui r√©pondre plus doucement.  Pylint est un excellent outil de rock star pour le code Python, mais il a des fonctionnalit√©s que je ne veux pas voir dans mon linter. <br><br>  <strong>Il m√©lange tout ensemble: v√©rifications stylistiques, meilleures pratiques et v√©rification de type</strong> .  La v√©rification de type Pylint est sous-d√©velopp√©e car il n'y a pas d'informations sur le type: elle essaie de l'afficher d'une mani√®re ou d'une autre, mais cela ne fonctionne pas tr√®s bien.  Par cons√©quent, souvent lorsque j'√©cris <code>model_name.some_property</code> sur Django, je peux voir l'erreur: "D√©sol√©, il n'y a pas une telle propri√©t√© - vous ne pouvez pas l'utiliser!"  Je me souviens qu'il y a un plugin, je l'installe, puis j'utilise Celery, cela commence aussi une sorte de probl√®me, j'installe le plugin pour Celery, j'utilise une autre biblioth√®que magique, et en cons√©quence, j'√©cris partout: "pylint: disable" ... Ce n'est pas √ßa ce que je veux obtenir de linter. <br><br>  Une autre fonctionnalit√© cach√©e √† l'utilisateur est <strong>que Pylint a sa propre impl√©mentation de l'arbre de syntaxe abstraite en Python</strong> .  Voici √† quoi ressemble le code lorsque vous l'analysez et obtenez des informations sur l'arborescence des n≈ìuds qui composent le code.  Je ne fais pas vraiment confiance √† mes propres impl√©mentations, car elles ont toujours tort. <br><br>  En plus de Pylint, il existe d'autres linters qui font √©galement leur travail. <br><br><h3>  Sonarquube <br></h3><br>  Un outil merveilleux, mais distinct, qui vit quelque part pr√®s de votre projet. <br><br><ul><li>  <strong>SonarQube ne pourra pas fonctionner souvent</strong> : il doit √™tre d√©ploy√© quelque part, regarder, surveiller, configurer. </li><li>  Il est <strong>√©crit en Java</strong> .  Si vous souhaitez corriger votre linter pour Python, vous √©crirez du code en Java.  Je pense que conceptuellement, c'est faux - un d√©veloppeur qui peut √©crire en Python devrait √™tre capable d'√©crire du code pour tester Python. </li></ul><br>  La soci√©t√© qui d√©veloppe SonarQube se penche sp√©cifiquement sur le concept de d√©veloppement de produits.  Cela peut √™tre un probl√®me. <br><br>  L'avantage de SonarQube est qu'il a des contr√¥les tr√®s sympas qui montrent la complexit√©, les erreurs cach√©es possibles et les bogues.  J'aime les ch√®ques, je les quitterais et changerais de plateforme. <br><br><h3>  Flake8 <br></h3><br>  Un merveilleux linter est tr√®s simple, mais avec un probl√®me: <strong>il y a peu de r√®gles</strong> par lesquelles il v√©rifie la qualit√© de l'√©criture du code.  Dans le m√™me temps, Flake8 a beaucoup de plugins tr√®s simples: le plugin minimum est 2 m√©thodes qui doivent √™tre impl√©ment√©es.  J'ai pens√© - prenons Flake8 comme base et √©crivons des plugins, mais avec notre compr√©hension des avantages pour l'entreprise.  Et nous l'avons fait. <br><br><h3>  Le linter le plus rigoureux au monde <br></h3><br>  Nous avons cr√©√© un outil dans lequel nous avons collect√© tout ce que nous pensons √™tre bon pour Python et appel√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><strong>wemake-python-styleguide</strong></a> .  Le plugin a √©t√© publi√© publiquement, car je pense que l' <strong>Open Source par d√©faut est une bonne pratique</strong> .  Je suis profond√©ment convaincu que de nombreux outils b√©n√©ficieront s'ils sont t√©l√©charg√©s sur Open Source.  Pour notre instrument, nous avons trouv√© le slogan: <strong>"Le linter le plus rigoureux du monde!"</strong> <br><br><blockquote>  Le mot cl√© dans notre linter est strict, ce qui signifie douleur et souffrance. </blockquote><br>  Si vous utilisez le linter, et cela ne vous fait pas souffrir, vous vous agrippez la t√™te: "Pourquoi ne l'aimez-vous pas, maudit", alors c'est un mauvais linter.  Il ignore les erreurs, ne surveille pas suffisamment la qualit√© du code et nous n'en avons pas besoin.  Nous avons besoin des plus strictes au monde, ce qui v√©rifie beaucoup.  Nous avons maintenant environ <strong>250 tests diff√©rents dans les deux cat√©gories</strong> : stylistique et meilleures pratiques, mais sans v√©rification de type.  Mypy s'y est engag√©, nous ne le concernons en aucune fa√ßon. <br><br>  Notre linter n'a <strong>aucun compromis</strong> .  Nous n'avons pas de r√®gles de la cat√©gorie "Je ne voudrais pas faire √ßa, mais si tu le veux vraiment, alors tu peux."  Non, nous parlons toujours durement - nous ne le faisons pas, parce que c'est mauvais.  Ensuite, les gens viennent et disent: "Il y a 2,5 cas d'utilisation o√π cela est possible en principe!".  S'il y a de tels cas, √©crivez clairement que cette ligne est autoris√©e pour que le linter l'ignore, mais expliquez pourquoi.  Ce devrait √™tre un commentaire sur pourquoi vous avez autoris√© une pratique √©trange et pourquoi vous le faites.  Cette approche est √©galement utile pour documenter du code. <br><br>  Le linter le plus strict <strong>ne n√©cessite pas de param√®tres (WIP)</strong> .  Nous avons encore des param√®tres, mais nous voulons nous en d√©barrasser: en toute libert√©, l'utilisateur va s√ªrement configurer pour que le linter ne fonctionne pas correctement. <br><br><blockquote>  Un bon outil n'a pas besoin de param√®tres - il a de bonnes valeurs par d√©faut. </blockquote><br>  Avec cette approche, le code sera coh√©rent et fonctionnera de la m√™me mani√®re pour tout le monde, du moins en th√©orie.  Nous y travaillons toujours, et bien qu'il existe des param√®tres, vous pouvez utiliser notre outil et le personnaliser par vous-m√™me. <br><br><h2>  De qui d√©pendons-nous? </h2><br>  √Ä partir d'un grand nombre d'outils. <br><br><ul><li>  <strong>Flake8</strong> . </li><li>  <strong>Eradicate</strong> est un plugin sympa qui trouve des fragments comment√©s dans le code et vous fait les supprimer, car stocker du code mort dans un projet est mauvais.  Nous n'y sommes pas autoris√©s. </li><li>  <strong>Isort</strong> est un outil qui vous oblige √† trier correctement les importations: dans l'ordre, en retrait, de belles citations. </li><li>  <strong>Bandit</strong> est un excellent outil pour v√©rifier statiquement la s√©curit√© du code.  Il trouve des mots de passe c√¢bl√©s, une utilisation maladroite d' <code>assert</code> dans le code, appelle <code>Popen</code> , <code>sys.exit</code> et dit que tout cela ne peut pas √™tre utilis√©, mais si vous le souhaitez, il vous demande d'√©crire la raison. </li><li>  Et plus de <strong>20 plugins</strong> qui v√©rifient les crochets, les guillemets et les virgules. </li></ul><br><h2>  Que v√©rifions-nous? </h2><br>  Nous utilisons et appliquons quatre groupes de r√®gles. <br><br>  <strong>La complexit√©</strong> est le plus gros probl√®me.  Nous ne savons pas ce qu'est la complexit√© et nous ne la voyons pas dans le code.  Nous regardons le code avec lequel nous travaillons tous les jours et il semble que ce ne soit pas compliqu√© - prenez-le, lisez-le, tout fonctionne.  Ce n'est pas le cas.  Le code simple est un code familier.  La complexit√© a des crit√®res clairs que nous testons.  √Ä propos des crit√®res eux-m√™mes - plus tard.  Si le code viole les crit√®res, alors nous disons: "Le code est complexe, r√©√©crivez!" <br><br>  <strong>Les noms</strong> des variables sont un probl√®me de programmation non r√©solu.  Qui lira quand et dans quel contexte n'est pas clair.  Nous essayons de rendre les noms aussi coh√©rents et compr√©hensibles que possible, mais bien que nous essayions, le probl√®me n'est pas encore compl√®tement r√©solu. <br><br>  Par <strong>souci de coh√©rence</strong> , nous avons une r√®gle simple - √©crivez la m√™me partout.  S'il existe une approche approuv√©e, utilisez-la partout.  Peu importe que cela vous plaise ou non, la coh√©rence est plus importante. <br><br>  Nous essayons d'utiliser uniquement les <strong>meilleures pratiques.</strong>  Si nous savons que certaines pratiques ne sont pas tr√®s bonnes, nous interdisons leur utilisation.  Si le d√©veloppeur veut utiliser une pratique interdite, nous attendons de lui des arguments: pourquoi et pourquoi appliquer.  Peut-√™tre, au cours du processus de description, une compr√©hension viendra de pourquoi elle est mauvaise. <br><br><h3>  Qu'est-ce que la complexit√©? <br></h3><br>  La complexit√© a des mesures sp√©cifiques que vous pouvez consulter et dire si elles sont difficiles ou non.  Il y en a beaucoup. <br><br>  <strong>Complexit√© cyclomatique</strong> - la complexit√© cyclomatique pr√©f√©r√©e de tous.  Il trouve dans le code un grand nombre de structures imbriqu√©es <code>if</code> , <code>for</code> , d'autres, et indique trop de branchement du code et des difficult√©s de lecture.  Avec le code embarqu√©, tout va mal: vous lisez, lisez, lisez - revenez en arri√®re, lisez, lisez, lisez - sautez, puis passez √† un autre cycle.  Il est impossible de passer un tel code en toute s√©curit√© de haut en bas. <br><br>  <strong>Arguments, instructions et retours.</strong>  Il s'agit de m√©triques quantitatives: combien d'arguments se trouvent dans la fonction ou dans la m√©thode, combien se trouvent dans le corps de cette fonction ou dans la m√©thode des instructions et des retours. <br><br>  <strong>La coh√©sion et le couplage</strong> sont des m√©triques de POO populaires.  <strong>La coh√©sion</strong> montre la connectivit√© de la classe √† l'int√©rieur.  Par exemple, il y a une classe, et √† l'int√©rieur vous utilisez toutes les m√©thodes et propri√©t√©s - tout ce que vous avez d√©clar√©.  C'est une bonne classe avec une connectivit√© √©lev√©e √† l'int√©rieur.  <strong>Le couplage</strong> est la mesure dans laquelle les diff√©rentes parties du syst√®me sont connect√©es: modules et classes.  Nous voulons atteindre une connectivit√© maximale au sein de la classe et une connectivit√© minimale √† l'ext√©rieur.  Ensuite, le syst√®me est facilement entretenu et fonctionne bien. <br><br>  <strong>Jones Complexity</strong> - J'ai emprunt√© cette m√©trique, mais seulement parce que c'est une bombe!  La complexit√© de Jones d√©termine la complexit√© d'une ligne - plus la ligne est complexe, plus elle est difficile √† comprendre, car la m√©moire humaine √† court terme ne peut pas traiter plus de 5 √† 9 objets √† la fois.  Ceci est le soi-disant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">portefeuille de Miller</a> . <br><br>  Nous examinons ces m√©triques importantes et quelques autres, qui sont beaucoup plus grandes, et d√©terminons si le code est appropri√© ou non.  √Ä notre avis, la <strong>complexit√© est une cascade</strong> . <br><br><h3>  Difficult√© de la cascade <br></h3><br>  La difficult√© commence par le fait que nous avons √©crit la ligne, et c'est toujours bon.  Mais ensuite, l'entreprise vient et dit que les prix ont doubl√©, et nous multiplions par 2. √Ä ce stade, Jones Complexity devient fou et rapporte que maintenant la ligne est trop compliqu√©e - il y a trop de logique. <br><br>  Eh bien, nous commen√ßons une nouvelle variable, et l'analyseur de complexit√© de la fonction dit: <br><br>  - <em>Non, ce n'est pas le cas - maintenant il y a trop de variables √† l'int√©rieur de la fonction.</em> <br><br>  Je vais cr√©er une nouvelle <strong>m√©thode</strong> et je vais lui passer des arguments.  Maintenant, v√©rifier le nombre d'arguments de fonction, ou le nombre de m√©thodes √† l'int√©rieur de la <strong>classe,</strong> dit que cela est √©galement impossible - la classe est trop complexe et doit √™tre divis√©e en deux parties.  Crashed en mettant en √©vidence une autre classe.  Maintenant, il y a plus de classes et tout va bien, mais v√©rifier la complexit√© du <strong>module</strong> signale que le module est maintenant trop complexe et doit √™tre refactoris√©.  Pourquoi?! <br><br>  C'est ce qu'on appelle la souffrance.  C'est pourquoi je dis qu'un linter devrait vous faire souffrir.  Nous avons commenc√© par multiplier par 2 sur une seule ligne et nous avons fini par <strong>refactoriser l'ensemble du syst√®me</strong> .  L'ajout d'un petit morceau de code conduit √† la refactorisation de modules entiers, car la complexit√© se d√©ploie comme une cascade et couvre tout ce qui est possible. <br><br>  <strong>"Besoin de refactoriser"</strong> - cette chose vous fait refactoriser le code.  Vous ne pouvez pas vous contenter de vous asseoir: "Je ne touche pas √† ce code, il semble fonctionner."  Non, un jour vous changerez le code ailleurs, et une cascade de complexit√© inondera le module que vous n'avez pas touch√© et vous devrez le refactoriser.  Je pense que le refactoring est bon, et plus il l'est, plus votre syst√®me est stable et performant.  <strong>Et tout le reste est subjectif!</strong> <br><br>  Parlons maintenant des go√ªts.  Ceci est une partie holistique et interactive! <br><br><h2>  Holivar <br></h2><br>  Supportons, les commentaires sont ouverts.  Tout d'abord, permettez-moi de vous rappeler que les noms sont un probl√®me complexe et non r√©solu.  Vous pouvez vous battre pour nommer une variable, mais nous avons quelques approches qui aident au moins √† ne pas faire d'erreurs √©videntes. <br><br><h3>  Noms <br></h3><br>  Comment aimez-vous: <strong>var, value, item, obj, data, result</strong> ?  Qu'est-ce que les <strong>donn√©es</strong> ?  Quelques donn√©es.  Quel est le <strong>r√©sultat</strong> ?  Une sorte de r√©sultat.  Souvent, je vois la variable de <strong>r√©sultat</strong> et un appel √† une m√©thode infernale dans une classe incompr√©hensible - et je pense: ¬´Quel est ce r√©sultat?  Pourquoi est-il ici? " <br><br>  De nombreux d√©veloppeurs sont en d√©saccord avec moi et disent que la <strong>valeur</strong> est un nom de variable parfaitement normal: <br><br>  - <em>J'utilise toujours la cl√© et la valeur!</em> <br>  - <em>Pourquoi ne pas utiliser la cl√© et la valeur, mais dire que la cl√© est le nom et la valeur est le nom de famille?</em>  <em>Pourquoi il est impossible de nommer pr√©nom et nom - maintenant il y a un contexte.</em> <br><br>  Habituellement, les gens sont d'accord, mais ils se disputent quand m√™me.  C'est une chose tr√®s holistique: au moins 3 personnes ont pass√© une heure de leur vie sur moi pour en discuter avec moi. <br><br><h3>  Est-il correct de nommer les variables avec une seule lettre? <br></h3><br>  Par exemple, <strong>q</strong> ?  Nous connaissons tous le cas classique: <code>for i in some_iterable:</code>  Qu'est-ce que <strong>je suis</strong> ?  En C, c'est une pratique standard, et tout en d√©coule.  Mais en Python, les collections et les it√©rateurs.  Les collections contiennent des √©l√©ments qui ont des noms - appelons-les diff√©remment. <br><br><blockquote>  La moiti√© des d√©veloppeurs pensent que l'appel des variables i, x, y, z est normal. </blockquote><br>  Je crois que vous ne pouvez pas nommer de noms avec une seule lettre.  Je veux plus de contexte et c'est bien que la seconde moiti√© des d√©veloppeurs soit d'accord avec moi.  Si en C, cela est toujours permis en raison de l'h√©ritage historique, alors en Python c'est un tr√®s gros probl√®me et vous n'avez pas besoin de le faire. <br><br><h3>  Coh√©rence <br></h3><br>  Choisissons simplement un moyen parmi tant d'autres et disons: ¬´Faisons-le.¬ª  Qu'elle soit bonne ou mauvaise - cela n'a plus d'importance - est tout simplement coh√©rent. <br><br>  Nous ne parlons que de Python 3, Legacy n'est pas du tout pris en compte. <br><br>  J'ai un argument: quand nous h√©ritons de quelque chose, nous devons savoir de quoi - ce serait bien de voir le nom du parent.  Le plus dr√¥le, c'est qu'en g√©n√©ral, nous voyons le nom du parent, sauf lorsqu'il s'agit d'un <strong>objet</strong> .  Par cons√©quent, j'ai formul√© une r√®gle pour moi-m√™me: lorsque j'√©cris une classe, j'h√©rite de quelque chose - j'√©cris toujours le nom du parent.  Peu importe ce que ce sera - Mod√®le, objet ou autre chose. <br><br>  S'il y a le choix d'√©crire la <code>Class Some(object)</code> ou la <code>class Some</code> , alors je choisirai la premi√®re.  D'une part, cela montre que nous √©crivons clairement toujours ce dont nous h√©ritons.  Par contre, il n'y a pas de <strong>verbosit√©</strong> particuli√®re: on ne perd rien de quelques frappes suppl√©mentaires. <br><br>  Les deux tiers des d√©veloppeurs connaissent mieux la deuxi√®me option, et je sais m√™me pourquoi.  Mon hypoth√®se: tout cela parce que nous avons depuis longtemps migr√© de la deuxi√®me version de Python vers la troisi√®me, et maintenant nous montrons que nous √©crivons dans le troisi√®me Python.  Je ne sais pas comment l'hypoth√®se est correcte, mais il me semble que c'est le cas. <br><br><h3>  Les lignes F sont terribles? <br></h3><br>  Options de r√©ponse: <br><br><ul><li>  Oui: ils perdent leur contexte, mettent de la logique dans le mod√®le et ne peluchent pas (38%). </li><li>  Non!  Ils sont un miracle!  - (62%). </li></ul><br>  Il existe une hypoth√®se selon laquelle les lignes f sont terribles.  Ils poussent n'importe quoi en eux!  les lignes f ne sont pas les m√™mes que <code>.format</code> , les diff√©rences sont dramatiques.  Lorsque nous d√©clarons un mod√®le, puis le formater, nous effectuons deux actions s√©par√©ment: d'abord nous d√©finissons le mod√®le, puis le formater.  Lorsque nous d√©clarons une ligne f, nous effectuons deux actions simultan√©ment: nous d√©clarons imm√©diatement le mod√®le et le formatons au m√™me moment. <br><br>  Il y a deux probl√®mes avec les lignes f.  Nous avons d√©clar√© un mod√®le pour la f-line et tout fonctionne.  Et puis nous d√©cidons de d√©placer le mod√®le 2 lignes vers le haut ou de le d√©placer vers une autre fonction - et tout se casse.  <strong>D√©sormais, aucun contexte ne nous a permis de formater des cha√Ænes</strong> et nous ne pouvons pas les traiter correctement.  Le deuxi√®me gros probl√®me avec les lignes f: elles vous permettent de faire la chose terrible - <strong>coller la logique dans le mod√®le</strong> .  Supposons qu'il y ait une ligne dans laquelle nous ins√©rons simplement le nom d'utilisateur et le mot "Bonjour" - c'est normal.  Il n'y a rien de particuli√®rement effrayant, mais ensuite nous voyons que le nom d'utilisateur vient en majuscules, nous d√©cidons de le traduire dans une casse de titre et d'√©crire directement dans le mod√®le <code>username.title()</code> .  Ensuite, les conditions, les cycles, les importations apparaissent dans le mod√®le.  Et toutes les autres parties de php. <br><br>  Tous ces probl√®mes me font dire que les <strong>lignes f sont un mauvais sujet</strong> , nous ne les utilisons pas.  Le plus dr√¥le, c'est que nous n'avons pas de bo√Ætier dans lequel seules les lignes f nous conviennent.  Habituellement, tout formatage convient, mais nous avons choisi <code>.format</code> - tout le reste est impossible - ni <code>%</code> , ni f-lines.  Le travail de <code>.format</code> √©galement pelucheux, car √† l'int√©rieur, vous pouvez mettre des guillemets boucl√©s et √©crire le nom de la variable ou son ordre. <br><br><blockquote>  Au cours du rapport, le nombre d'adversaires de la ligne f est pass√© de 33 √† 38% - c'est une petite mais une victoire. </blockquote><br><h3>  Les chiffres <br></h3><br>  Aimez-vous les nombres comme celui-ci: <code>final_score = 69 * previous result / 3.14</code> .  Cela ressemble √† une ligne de code standard, mais qu'est-ce que 69?  De telles questions se posent souvent lorsque je regarde le code que j'ai √©crit il y a quelque temps, et le gestionnaire √† ce moment-l√† dit: <br><br>  - <em>Veuillez multiplier par 147.</em> <br>  - <em>Pourquoi √† 147?</em> <br>  - <em>Nous avons une telle tarification.</em> <br><br>  J'ai multipli√© et oubli√©, ou pendant longtemps j'ai pris une certaine valeur du coefficient pour que tout fonctionne - puis j'ai oubli√© comment je l'ai ramass√© et pourquoi.  Il s'av√®re que d'importants travaux de recherche sont rest√©s cach√©s derri√®re un nombre sans titre.  Je ne sais m√™me pas ce qu'est ce num√©ro, mais je ne peux que le trouver, le rappeler et le restaurer d'une mani√®re ou d'une autre en m'engageant plus tard. <br><br>  Pourquoi ne pas le faire diff√©remment - mettez tous les nombres complexes dans votre propre variable avec le nom et la documentation?  Par exemple, pour le nombre 69, √©crivez qu'il s'agit de l'indicateur moyen sur le march√©, et maintenant la constante a un nom et un contexte.  J'√©crirai un commentaire que j'ai pris la constante sur le site d'une telle √©tude.  Si la recherche change √† l'avenir, je viendrai mettre √† jour les donn√©es. <br><br>  Ainsi, nous garantissons qu'aucun chiffre magique ne traversera notre code et ne le compliquera de l'int√©rieur.  Ils font leur chemin en v√©rifiant la complexit√© de chaque ligne et disent: "Voici le num√©ro 4766. Qu'est-ce que c'est, je ne sais pas, triez-le vous-m√™me!"  Ce fut une grande d√©couverte pour moi. <br><br><blockquote>  En cons√©quence, nous avons r√©alis√© que nous devons suivre cela, et nous ne manquons aucun chiffre magique dans le code.  Il est bon que pr√®s de 100% de nos coll√®gues soient d'accord avec nous, et ils n'utilisent pas non plus ces chiffres. </blockquote><br>  Mais il y a des exceptions - ce sont des nombres de -10 √† 10, des nombres 100, 1000 et similaires, simplement parce qu'ils sont souvent trouv√©s et sans eux est difficile.  <strong>Nous sommes durs, mais pas sadiques</strong> et r√©fl√©chissons un peu. <br><br><h3>  Utilisez-vous '@staticmethod'? <br></h3><br>  R√©fl√©chissons √† ce qu'est la <strong>m√©thode statique</strong> .  Vous √™tes-vous d√©j√† demand√© pourquoi il se trouve en Python?  Non.  J'avais un beau Pylint qui disait: <br><br>  - <em>√âcoutez, vous n'utilisez pas vous-</em> <code>self</code> , <code>cls</code> - <em>faites une m√©thode statique!</em> <br>  - <em>D'accord, Pylint, je vais faire une m√©thode statique.</em> <br><br>  Ensuite, j'ai enseign√© Python aux d√©butants, et ils ont demand√© ce qu'est la m√©thode statique et pourquoi elle est n√©cessaire.  Je ne connaissais pas la r√©ponse et je me demandais s'il √©tait possible d'√©crire la m√™me chose avec une fonction, ou de ne pas utiliser <code>self</code> dans une fonction r√©guli√®re, simplement parce que c'est une telle classe et que quelque chose se passe.  Pourquoi avons-nous besoin d'une construction de m√©thode statique? <br><br>  J'ai googl√© la question, et elle s'est av√©r√©e √™tre aussi profonde qu'un trou de lapin.  Il existe de nombreux autres langages de programmation dans lesquels la m√©thode statique n'est pas non plus appr√©ci√©e.  Et bien raisonn√© - staticmethod casse le mod√®le objet.  En cons√©quence, je me suis rendu compte - la <strong>m√©thode statique n'est pas ici</strong> , et nous l'avons vu.  Maintenant, si nous utilisons le d√©corateur de m√©thode statique, le linter dira: "Non, d√©sol√©, refactoriser!" <br><br>  La plupart des d√©veloppeurs ne sont pas d'accord avec moi, mais environ la moiti√© pense toujours qu'il vaut mieux √©crire des m√©thodes r√©guli√®res ou des fonctions r√©guli√®res au lieu d'une m√©thode statique. <br><br><h3>  Logique dans __init __. Ru - bon ou mauvais? <br></h3><br>  Ceci est mon sujet pr√©f√©r√©.  S√ªrement, quand vous cr√©ez un nouveau paquet et que vous l'appelez d'une mani√®re ou d'une autre - cela cr√©e __init __. Ru et vous vous demandez quoi y mettre?  Que mettre dans __init __. Ru, et quoi - dans les fichiers c√¥te √† c√¥te?  Pour moi, c'√©tait une question non triviale, et j'√©tais toujours perdu: probablement quelque chose de plus important?  Alors j'ai pens√© - non, au contraire, je mettrai le plus important dans le contexte le plus compr√©hensible.  Si vous mettez quelque chose dans __init __. Ru, puis importez le tout, il s'av√®re que les importations cycliques sont √©galement mauvaises. <br><br>  J'ai regard√© diverses biblioth√®ques populaires, j'ai grimp√© leur __init __. Ru, et j'ai remarqu√© qu'il y avait essentiellement des ordures ou une compatibilit√© descendante.  Pour moi, cette question s'est pos√©e brusquement lorsque j'ai commenc√© √† cr√©er de gros packages avec de nombreux sous-packages - vous vous perdez.           ,   .    Python,  ,   ,   __init__.  ,  90%     . <br><br>   ‚Äî ,   API,  ,   -  ,  ,   ? ,  ,      .      API   .   ,    __init__.   - : ,  ,   . <br><br>   ,   <code>I_CONTROL_CODE</code> ‚Äî   .   ,   .    ,  ,  __init__.   ‚Äî  .     ,    ,    , - ,       . <br><br><h3>  hasattr   ? <br></h3><br>     <strong>hasattr</strong> ?  ,   ,    Python   ‚Äî .  hasattr  ,         (). <br><br>   ,  ,   hasattr  ,     ,   .       ,   hasattr,   ,      . - ,  Python   -, hasattr      .       ,        .    <strong>getattr</strong>   ¬´  ,  ¬ª.          hasattr ‚Äî  getattr,  <strong>exception</strong> . <br><br>     50  50 ‚Äî ,        ,        . <br><br><h2>        <br></h2><br>     ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><strong>layer-linter</strong></a> .   ?      :   ,   ,     ,    .     ,     -    .         - .  Je le recommande vivement. <br><br>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><strong>cohesion</strong></a> .       ,    . Cohesion ,     .      False Positive       ,       ‚Äî ,   ,  . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><strong>vulture</strong></a>      Python    . - ,  Python   ,    .      ohesion. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><strong>Radon</strong></a>      ,   : <strong>Halstead</strong> , <strong>Maintainability Index</strong> ,  . ,       ‚Äî  . <br><br><h2> Final type <br></h2><br>   <strong>Final-</strong>  Python.     Typing Extensions,        ,    .  ,     - ,      ‚Äî  ,      .   ,   -  - ,  ?  .  .  -  ‚Äî  ,  , , . <br><br><h2> Gratis <br></h2><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>     ,     . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b90/e6c/e5d/b90e6ce5dc2ef3c00c83e73fa162447e.png"><br><br>       ,     . <br><br>      ,     .   ,   .      ,    Python-   ,   . <br><br><blockquote> ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Moscow Python Conf++</a> ,      .    ,        ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>         Python-. </blockquote><br>       .       .   ,      ,   ,      . <br><br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/2fd/ed2/6fa/2fded26fa11ac61fb98e0b729b6bd0c6.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/01e/18a/d2d/01e18ad2d4184a42079552671a8957d8.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f87/653/af3/f87653af3f7b6c6baca449b3c81b564f.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d1e/5a8/576/d1e5a8576f1a724683a57f2c2861950e.png"><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr433480/">https://habr.com/ru/post/fr433480/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr433466/index.html">Comparez les pages. Plugin simple pour Atlassian Confluence</a></li>
<li><a href="../fr433472/index.html">Unity 2018.3 est sorti</a></li>
<li><a href="../fr433474/index.html">Pylint de l'int√©rieur vers l'ext√©rieur. Comment fait-il</a></li>
<li><a href="../fr433476/index.html">50 nuances de c√©leri</a></li>
<li><a href="../fr433478/index.html">Pourquoi Django est choisi dans Tinkoff Magazine</a></li>
<li><a href="../fr433482/index.html">Django sous microscope</a></li>
<li><a href="../fr433486/index.html">Quoi encore? Le renouveau des cartes de d√©bit non bancaires</a></li>
<li><a href="../fr433488/index.html">Christmas Scrum Meetup UPD Broadcast mitap</a></li>
<li><a href="../fr433490/index.html">Critique de l'imprimante 3D Creality CR-X</a></li>
<li><a href="../fr433494/index.html">10 idiomes anglais que vous ne conna√Ætrez jamais</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>