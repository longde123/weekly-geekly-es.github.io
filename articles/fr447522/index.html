<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò§ üí∂ üëàüèº Quelles choses utiles peuvent √™tre extraites des journaux d'un poste de travail Windows üè™ üì∏ üî®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le poste de travail utilisateur est l'infrastructure la plus vuln√©rable en termes de s√©curit√© de l'information. Les utilisateurs peuvent recevoir une ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Quelles choses utiles peuvent √™tre extraites des journaux d'un poste de travail Windows</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/galssoftware/blog/447522/"> Le poste de travail utilisateur est l'infrastructure la plus vuln√©rable en termes de s√©curit√© de l'information.  Les utilisateurs peuvent recevoir une lettre de leur courrier √©lectronique qui semble provenir d'une source s√ªre, mais avec un lien vers le site infect√©.  Peut-√™tre que quelqu'un va t√©l√©charger un utilitaire utile pour travailler √† partir d'un endroit inconnu.  Oui, vous pouvez trouver plus d'une douzaine de cas, comment les utilisateurs de logiciels malveillants peuvent s'infiltrer dans les ressources internes de l'entreprise.  Par cons√©quent, les postes de travail n√©cessitent une attention accrue et, dans l'article, nous vous indiquerons o√π et quels √©v√©nements prendre pour suivre les attaques. <br><br><img src="https://habrastorage.org/webt/n1/5h/lf/n15hlfq8b3n3ka64c-ahfco6ktm.png"><br><a name="habracut"></a><br>  Il existe trois sources d'√©v√©nements utiles pour d√©tecter une attaque √† un stade pr√©coce dans Windows: un journal des √©v√©nements de s√©curit√©, un journal de surveillance du syst√®me et des journaux Power Shell. <br><br><h2>  Journal de s√©curit√© </h2><br>  Il s'agit de l'emplacement de stockage principal pour les journaux de s√©curit√© du syst√®me.  Cela inclut les √©v√©nements de connexion / d√©connexion des utilisateurs, l'acc√®s aux objets, les changements de politiques et d'autres activit√©s li√©es √† la s√©curit√©.  Bien s√ªr, si la strat√©gie appropri√©e est configur√©e. <br><br><img src="https://habrastorage.org/webt/_9/eg/ys/_9egysaz3btzcitbobp2gofmcu0.png"><br><br>  <b>D√©nombrement des utilisateurs et des groupes (√©v√©nements 4798 et 4799).</b>  Un logiciel malveillant au tout d√©but d'une attaque passe souvent par des comptes d'utilisateurs locaux et des groupes locaux sur un poste de travail pour trouver des informations d'identification pour ses affaires sombres.  Ces √©v√©nements aideront √† d√©tecter le code malveillant avant qu'il ne progresse et, en utilisant les donn√©es collect√©es, se propageront √† d'autres syst√®mes. <br><br>  <b>Cr√©ation d'un compte local et modification des groupes locaux (√©v√©nements 4720, 4722‚Äì4726, 4738, 4740, 4767, 4780, 4781, 4794, 5376 et 5377).</b>  Une attaque peut √©galement commencer, par exemple, en ajoutant un nouvel utilisateur √† un groupe d'administrateurs locaux. <br><br>  <b>Tente de se connecter avec un compte local (√©v√©nement 4624).</b>  Les bons utilisateurs se connectent avec un compte de domaine et l'identification d'une entr√©e sous un compte local peut indiquer le d√©but d'une attaque.  L'√©v√©nement 4624 inclut √©galement des connexions sous un compte de domaine. Par cons√©quent, lors du traitement des √©v√©nements, vous devez filtrer les √©v√©nements dans lesquels le domaine est diff√©rent du nom du poste de travail. <br><br>  <b>Tentative de connexion avec un compte donn√© (√©v√©nement 4648).</b>  Cela se produit lorsque le processus s'ex√©cute en mode ¬´Ex√©cuter en tant que¬ª.  Dans le fonctionnement normal des syst√®mes, cela ne devrait pas √™tre, par cons√©quent, de tels √©v√©nements devraient √™tre contr√¥l√©s. <br><br>  <b>Verrouillage / d√©verrouillage du poste de travail (√©v√©nements 4800-4803).</b>  Les √©v√©nements suspects incluent toutes les actions qui se sont produites sur un poste de travail verrouill√©. <br><br>  <b>Modifications de la configuration du pare-feu (√©v√©nements 4944-4958).</b>  De toute √©vidence, lors de l'installation d'un nouveau logiciel, les param√®tres de configuration du pare-feu peuvent changer, ce qui entra√Ænera des faux positifs.  Dans la plupart des cas, il n'est pas n√©cessaire de contr√¥ler de tels changements, mais il ne sera pas superflu de les conna√Ætre. <br><br>  <b>Connexion de p√©riph√©riques Plug'n'play (√©v√©nement 6416 et uniquement pour WIndows 10).</b>  Il est important de surveiller cela, si les utilisateurs ne connectent g√©n√©ralement pas de nouveaux appareils √† la station de travail, puis tout d'un coup, ils l'ont connect√©. <br><br>  Windows comprend 9 cat√©gories d'audit et 50 sous-cat√©gories pour un r√©glage fin.  L'ensemble minimal de sous-cat√©gories qui doit √™tre inclus dans les param√®tres: <br><br>  <b>Ouverture / fermeture de session</b> <br><br><ul><li>  Ouverture de session; </li><li>  D√©connexion; </li><li>  Verrouillage du compte; </li><li>  Autres √©v√©nements d'ouverture / fermeture de session. </li></ul><br>  <b>Gestion de compte</b> <br><br><ul><li>  Gestion des comptes d'utilisateurs; </li><li>  Gestion des groupes de s√©curit√©. </li></ul><br>  <b>Changement de politique</b> <br><br><ul><li>  Modification de la politique d'audit </li><li>  Changement de politique d'authentification; </li><li>  Modification de la politique d'autorisation. </li></ul><br><h2>  Moniteur syst√®me (Sysmon) </h2><br>  Sysmon est un utilitaire int√©gr√© dans Windows qui peut √©crire des √©v√©nements dans le journal syst√®me.  Il est g√©n√©ralement n√©cessaire de l'installer s√©par√©ment. <br><br><img src="https://habrastorage.org/webt/zt/e6/jg/zte6jgkrmzj6evy8vyojwcpo_fy.png"><br><br>  Les m√™mes √©v√©nements peuvent en principe √™tre trouv√©s dans le journal de s√©curit√© (en incluant la politique d'audit souhait√©e), mais Sysmon fournit plus de d√©tails.  Quels √©v√©nements peuvent √™tre retir√©s de Sysmon? <br><br>  <b>Cr√©ation d'un processus (ID d'√©v√©nement 1).</b>  Le journal des √©v√©nements syst√®me des √©v√©nements de s√©curit√© peut √©galement indiquer quand certains * .exe ont d√©marr√© et m√™me afficher son nom et son chemin de d√©marrage.  Mais contrairement √† Sysmon, il ne pourra pas montrer le hachage de l'application.  Un logiciel malveillant peut m√™me √™tre appel√© notepad.exe inoffensif, mais c'est le hachage qui le mettra dans l'eau claire. <br><br>  <b>Connexions r√©seau (ID d'√©v√©nement 3).</b>  De toute √©vidence, il existe de nombreuses connexions r√©seau et vous ne pouvez pas suivre tout le monde.  Mais il est important de consid√©rer que Sysmon, contrairement au journal de s√©curit√©, peut lier une connexion r√©seau aux champs ProcessID et ProcessGUID, affiche le port et les adresses IP de la source et du r√©cepteur. <br><br>  <b>Modifications dans le registre (ID d'√©v√©nement 12-14).</b>  Le moyen le plus simple de vous ajouter au d√©marrage est de vous inscrire dans le registre.  Le journal de s√©curit√© peut le faire, mais Sysmon indique qui a effectu√© les modifications, quand, o√π, l'ID de processus et la valeur de cl√© pr√©c√©dente. <br><br>  <b>Cr√©ation de fichier (ID d'√©v√©nement 11).</b>  Sysmon, contrairement au journal de s√©curit√©, affichera non seulement l'emplacement du fichier, mais aussi son nom.  Il est clair que vous ne pouvez pas tout suivre, mais vous pouvez √©galement auditer certains r√©pertoires. <br><br>  Et maintenant, ce que les politiques du journal de s√©curit√© n'ont pas, mais sont dans Sysmon: <br><br>  <b>Modifier l'heure de cr√©ation du fichier (ID d'√©v√©nement 2).</b>  Certains logiciels malveillants peuvent remplacer la date de cr√©ation du fichier pour le masquer des rapports contenant des fichiers r√©cemment cr√©√©s. <br><br>  <b>T√©l√©chargez les pilotes et les biblioth√®ques dynamiques (ID d'√©v√©nement 6-7).</b>  Suivi du chargement des DLL et des pilotes de p√©riph√©riques en m√©moire, v√©rification de la signature num√©rique et de sa validit√©. <br><br>  <b>Cr√©ation d'un thread dans un processus en cours (ID d'√©v√©nement 8).</b>  Un type d'attaque que vous devez √©galement surveiller. <br><br>  <b>√âv√©nements RawAccessRead (ID d'√©v√©nement 9).</b>  Lire les op√©rations √† partir du disque en utilisant ¬´\\. \¬ª.  Dans la grande majorit√© des cas, une telle activit√© doit √™tre consid√©r√©e comme anormale. <br><br>  <b>Cr√©ation d'un flux de fichiers nomm√© (ID d'√©v√©nement 15).</b>  Un √©v√©nement est enregistr√© lorsqu'un flux de fichiers nomm√© est g√©n√©r√© et g√©n√®re des √©v√©nements avec un hachage du contenu du fichier. <br><br>  <b>Cr√©ation d'un canal nomm√© et d'une connexion (ID d'√©v√©nement 17-18).</b>  Suivi du code malveillant qui communique avec d'autres composants via un canal nomm√©. <br><br>  <b>Activit√© WMI (ID d'√©v√©nement 19).</b>  Enregistrement des √©v√©nements g√©n√©r√©s lors de l'acc√®s au syst√®me via le protocole WMI. <br><br>  Pour prot√©ger Sysmon lui-m√™me, vous devez suivre les √©v√©nements avec l'ID 4 (arr√™ter et d√©marrer Sysmon) et l'ID 16 (modifier la configuration Sysmon). <br><br><h2>  Magazines Power Shell </h2><br>  Power Shell est un outil puissant pour g√©rer l'infrastructure Windows, il y a donc de fortes chances que l'attaquant le choisisse.  Vous pouvez utiliser deux sources pour obtenir des informations sur les √©v√©nements Power Shell: le journal Windows PowerShell et le journal Microsoft-WindowsPowerShell / Operational. <br><br><h4>  Journal Windows PowerShell </h4><br><img src="https://habrastorage.org/webt/ao/zu/r3/aozur3ankpoqqckwf-x2af-ywza.png"><br><br>  <b>Fournisseur de donn√©es charg√© (ID d'√©v√©nement 600).</b>  Les fournisseurs PowerShell sont des programmes qui servent de source de donn√©es √† PowerShell pour les afficher et les g√©rer.  Par exemple, les fournisseurs int√©gr√©s peuvent √™tre des variables d'environnement Windows ou le registre.  L'√©mergence de nouveaux fournisseurs doit √™tre surveill√©e afin d'identifier √† temps les activit√©s malveillantes.  Par exemple, si vous voyez WSMan appara√Ætre parmi les fournisseurs, une session PowerShell distante a √©t√© d√©marr√©e. <br><br><h4>  Microsoft-WindowsPowerShell / journal op√©rationnel (ou MicrosoftWindows-PowerShellCore / op√©rationnel dans PowerShell 6) </h4><br><img src="https://habrastorage.org/webt/de/ga/ci/degaci8kfzznwue4ywft7w2zwk8.png"><br><br>  <b>Journalisation du module (ID d'√©v√©nement 4103).</b>  Les √©v√©nements stockent des informations sur chaque commande ex√©cut√©e et les param√®tres avec lesquels elle a √©t√© appel√©e. <br><br>  <b>Journalisation du verrouillage de script (ID d'√©v√©nement 4104).</b>  La journalisation du verrouillage de script montre chaque bloc de code PowerShell ex√©cut√©.  M√™me si un attaquant tente de masquer la commande, ce type d'√©v√©nement affichera la commande PowerShell r√©ellement ex√©cut√©e.  M√™me dans ce type d'√©v√©nement, certains appels d'API de bas niveau peuvent √™tre enregistr√©s, ces √©v√©nements sont g√©n√©ralement √©crits comme verbeux, mais si une commande ou un script suspect est utilis√© dans un bloc de code, il sera enregistr√© comme avertissement avec criticit√©. <br><br>  Veuillez noter qu'apr√®s avoir configur√© l'outil de collecte et d'analyse de ces √©v√©nements, un temps de d√©bogage suppl√©mentaire sera n√©cessaire pour r√©duire le nombre de faux positifs. <br><br>  Dites-nous dans les commentaires quels journaux vous collectez pour l'audit de s√©curit√© des informations et quels outils vous utilisez pour cela.  L'un de nos domaines concerne les solutions d'audit des √©v√©nements de s√©curit√© de l'information.  Pour r√©soudre le probl√®me de la collecte et de l'analyse des journaux, nous pouvons offrir un examen plus approfondi de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Quest InTrust</a> , qui peut compresser les donn√©es stock√©es avec un rapport de 20: 1, et une instance install√©e est capable de traiter jusqu'√† 60000 √©v√©nements par seconde √† partir de 10000 sources. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr447522/">https://habr.com/ru/post/fr447522/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr447510/index.html">GeekUniversity ouvre ses inscriptions au d√©partement Design</a></li>
<li><a href="../fr447512/index.html">Et qui a fait √ßa? Automatisez l'audit de la s√©curit√© des informations</a></li>
<li><a href="../fr447514/index.html">7 startups int√©ressantes dans l'IoT</a></li>
<li><a href="../fr447516/index.html">Comment nous avons overclock√© CAD COMPASS-3D ‚Üí Partie 2</a></li>
<li><a href="../fr447520/index.html">Fonctionnalit√©s de hi√©rarchisation automatique dans le stockage Qsan XCubeSAN</a></li>
<li><a href="../fr447526/index.html">Propre v√©lo pour synchroniser MariaDB et Sphinx</a></li>
<li><a href="../fr447528/index.html">Qui est responsable de la qualit√©?</a></li>
<li><a href="../fr447530/index.html">OceanLotus: mise √† jour Malvari pour macOS</a></li>
<li><a href="../fr447532/index.html">Splunk Universal Forwarder dans le Docker en tant que rassembleur de journaux syst√®me</a></li>
<li><a href="../fr447534/index.html">Le cosmonaute Aleksandr Laveykin sur le meilleur film spatial, la force G de 20g et l'atterrissage en douceur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>