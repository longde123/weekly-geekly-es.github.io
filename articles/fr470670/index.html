<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💛 🎐 🏇🏻 Comment créer un vélo électrique intelligent 👩🏿‍🚀 🙅🏾 🥨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sur Habré, écrivez souvent sur le transport électrique. Et sur les vélos. Et aussi sur l'IA. Cloud4Y a décidé de combiner ces trois sujets, en parlant...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment créer un vélo électrique intelligent</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/cloud4y/blog/470670/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/vi/wq/b5/viwqb5acudpgwwum-rhdmpb7jva.jpeg"></div><br>  <i>Sur Habré, écrivez souvent sur le transport électrique.</i>  <i>Et sur les vélos.</i>  <i>Et aussi sur l'IA.</i>  <i>Cloud4Y a décidé de combiner ces trois sujets, en parlant du vélo électrique «intelligent», qui est toujours en ligne.</i>  <i>Il s'agira du modèle Greyp G6.</i> <i><br><br></i>  <i>Pour le rendre plus intéressant, nous avons divisé l'article en deux parties.</i>  <i>Le premier est consacré au processus de création de l'appareil, de la plateforme et des protocoles de communication.</i>  <i>Le second est les spécifications techniques, une description du remplissage et les capacités de la moto.</i> <a name="habracut"></a><br><br><h2>  Première partie, backend </h2><br>  Greyp Bikes est un fabricant croate de vélos électriques haut de gamme appartenant au fabricant de supercar exotique local Rimac.  L'entreprise crée des vélos vraiment intéressants.  Ce qui n'est que le modèle précédent, le G12S à deux suspensions.  C'était quelque chose entre un vélo électrique et une moto électrique, car l'appareil pouvait accélérer à 70 km / h, avait un moteur puissant et parcourait 120 km avec une seule charge. <br><br>  Le G6 s'est avéré plus élégant et tout-terrain, mais sa principale caractéristique est la «connectivité».  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Greyp Bikes a</a> franchi une étape importante vers le développement de l'IoT en proposant un vélo toujours «en ligne».  Mais parlons d'abord de la création d'un vélo électrique «intelligent». <br><br>  <b>La naissance d'une idée</b> <br><br>  Un grand nombre d'appareils différents sont connectés à Internet.  Pourquoi les vélos sont-ils pires?  Ainsi, dans Greyp Bikes, une idée est apparue qui s'est transformée en G6.  À tout moment, ce vélo maintient une connexion au <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">serveur cloud</a> .  L'opérateur mobile assure la communication et l'eSIM est cousu directement dans le vélo.  Et cela ouvre de nombreuses opportunités intéressantes pour les athlètes et les amateurs de cyclisme ordinaires. <br><br>  <b>Plateforme</b> <br><br>  Lors de la création d'une plate-forme pour un produit innovant, vous devez prendre en compte de nombreuses nuances.  Par conséquent, le choix d'une plate-forme cloud pour l'hébergement et le lancement de tous les services nécessaires à un vélo électrique moderne était un problème très important.  L'entreprise a opté pour Amazon Web Services (AWS).  Cela était dû en partie au fait que Greyp Bikes avait déjà de l'expérience avec le service.  En partie - en raison de sa popularité, de sa large distribution parmi les développeurs du monde entier et de sa bonne attitude envers Java / JVM (oui, ils sont activement utilisés dans les vélos Greyp). <br><br>  AWS avait un bon courtier IoT MQTT ( <i>Cloud4Y a écrit sur les protocoles <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">plus tôt</a></i> ), idéal pour échanger facilement des données avec un vélo.  Certes, il fallait en quelque sorte établir une connexion avec l'application pour smartphone.  Il y a eu des tentatives pour l'implémenter par eux-mêmes à l'aide de Websockets, mais plus tard, la société a décidé de ne pas réinventer la roue et est passée à la plateforme Google Firebase, qui est largement utilisée par les développeurs mobiles.  Depuis le début du développement, l'architecture du système a subi de nombreuses améliorations et changements.  Il ressemble à ceci maintenant: <br><br><img src="https://habrastorage.org/webt/4m/ry/8u/4mry8uxmij5-zc2n3o2x0mfqmzc.png"><br>  <i>Pile technique</i> <br><br>  <b>Implémentation</b> <br><br>  La société a fourni deux façons d'accéder au système.  Chacun d'eux est mis en œuvre séparément, avec différentes technologies pour son cas d'utilisation. <br><br>  <b>Du vélo au smartphone</b> <br><br>  La première chose à considérer lors de la création d'un point d'entrée dans le système est le protocole de communication à utiliser.  Comme déjà mentionné, l'entreprise a choisi MQTT en raison de son «caractère» léger.  Le protocole est bon en termes de bande passante, fonctionne très bien avec des connexions potentiellement non fiables et économise l'énergie de la batterie, ce qui est particulièrement important pour un vélo électrique de Greyp. <br><br>  Le courtier MQTT utilisé est requis pour télécharger toutes les données provenant du vélo.  À l'intérieur du réseau AWS se trouve Lambda, qui lit les données binaires fournies par le courtier MQTT, les analyse et les livre à Apache Kafka pour un traitement ultérieur. <br><br>  Apache Kafka est le fondement du système.  Toutes les données doivent y transiter pour atteindre la destination finale.  Actuellement, le noyau du système a plusieurs agents.  Le plus important d'entre eux est celui qui collecte les données et les transfère vers le «stockage à froid» InfluxDB.  Un autre transfère les données vers la base de données Firebase Realtime, les rendant disponibles pour les applications de smartphone.  C'est là qu'Apache Kafka est vraiment nécessaire - un stockage à froid (InfluxDB) stocke toutes les données reçues du vélo, et Firebase peut recevoir des informations pertinentes (par exemple, des mesures en temps réel - la vitesse actuelle). <br><br>  Kafka vous permet de recevoir des messages à différentes vitesses et de les livrer presque immédiatement à Firebase (pour les afficher dans l'application sur votre smartphone) et finalement de les transférer vers InfluxDB (pour l'analyse des données, les statistiques, la surveillance). <br><br>  L'utilisation de Kafka vous permet également d'utiliser une mise à l'échelle horizontale avec une charge croissante, ainsi que de connecter d'autres agents qui peuvent traiter les données entrantes à leur propre rythme et pour leur propre cas d'utilisation (par exemple, lors de la concurrence entre un groupe de vélos).  Autrement dit, la solution permet aux cyclistes de rivaliser entre eux pour une variété de caractéristiques.  Par exemple, vitesse maximale, saut maximal, performances maximales, etc. <br><br>  Tous les services (appelés "GVC" - Greyp Vehicle Cloud) sont principalement implémentés sur la base de Spring Boot et Java, bien que d'autres langages soient également utilisés.  Chaque assemblage est conditionné dans une image Docker hébergée sur un référentiel ECR, et est lancé et hébergé par Amazon ECS.  Bien que NoSQL soit assez pratique et populaire pour un certain nombre de cas, Firebase ne peut pas toujours satisfaire tous les besoins de Greyp, et par conséquent, la société utilise également MySQL (dans RDS) pour des requêtes spéciales (Firebase utilise l'arborescence JSON, qui est plus efficace dans certains cas) et le stockage de données spécifiques.  Une autre installation de stockage utilisée est Amazon S3, qui garantit la sécurité des données collectées. <br><br>  <b>Du smartphone au vélo</b> <br><br>  Comme nous l'avons déjà dit, la communication avec les smartphones est établie via Firebase.  La plateforme est utilisée pour authentifier les utilisateurs de l'application et leur partie de la base de données en temps réel.  En fait, Firebase est une combinaison de deux choses: l'une est une base de données pour le stockage permanent des données, et l'autre est pour fournir des données en temps réel aux smartphones via une connexion à Websocket.  Une option idéale pour ce type de connexion est d'émettre des commandes sur le vélo lorsque les appareils ne sont pas proches les uns des autres (il n'y a pas de connexion BT / Wi-Fi disponible). <br><br>  Dans ce cas, Greyp a développé son propre mécanisme de traitement des commandes, qui reçoit les messages d'un smartphone via une base de données en mode temps réel.  Ce mécanisme fait partie des services d'application de base (GVC), dont la tâche est de convertir les commandes du smartphone en messages MQTT transmis au vélo via le courtier IoT.  Lorsque le vélo reçoit une commande, il la traite, exécute l'action correspondante et renvoie une réponse à Firebase (smartphone). <br><br>  <b>Suivi</b> <br><br><img src="https://habrastorage.org/webt/rl/cw/cs/rlcwcsn-yj2vez3k1aa8x8zyfls.png"><br>  <i>Contrôle des paramètres</i> <br><br>  Presque tous les développeurs d'arrière-plan aiment dormir la nuit sans vérifier les serveurs toutes les 10 minutes.  Et cela signifie que vous devez implémenter des solutions de surveillance et d'alertes automatisées dans le système.  Cette règle s'applique également à l'écosystème cyclable Greyp.  Il existe également des connaisseurs du sommeil nocturne normal, de sorte que la société utilise deux solutions cloud: Amazon CloudWatch et jmxtrans. <br><br>  CloudWatch est un service de surveillance et de surveillance qui collecte des données de surveillance et opérationnelles sous la forme de journaux, de métriques et d'événements, permettant d'obtenir une vue unique des applications, services et ressources AWS s'exécutant sur la plate-forme AWS ainsi que dans l'environnement local.  Avec CloudWatch, il est pratique de détecter les comportements anormaux dans vos environnements, de configurer des alertes, de créer des représentations visuelles générales des journaux et des métriques, d'effectuer des actions automatisées, de résoudre les problèmes et d'apprendre des informations utiles qui aident à assurer le bon fonctionnement des applications. <br><br>  CloudWatch collecte des métriques personnalisées et les transmet au tableau de bord.  Là, ils se combinent avec des données provenant d'autres ressources gérées par Amazon.  La machine virtuelle Java reçoit des métriques via le point de terminaison JMX à l'aide d'un «connecteur» appelé jmxtrans (également situé en tant que conteneur Docker dans ECS). <br><br><h2>  Deuxième partie, Caractéristiques </h2><br><img src="https://habrastorage.org/webt/vn/eb/ts/vnebtsm6o1c7_10tmh8l3wjorvk.jpeg"><br><br>  Alors, quel a été le résultat du vélo électrique?  Le vélo de montagne électrique Greyp G6 est équipé d'une batterie lithium-ion 36 V, 700 Wh alimentée par des cellules LG.  Au lieu de cacher la batterie, comme le font de nombreux fabricants de vélos électriques, Greyp dispose d'une batterie amovible au centre du cadre.  Le G6 est équipé d'un moteur MPF d'une puissance nominale de 250 watts (et il existe également une option avec 450 watts). <br><br>  Le Greyp G6 est un VTT équipé d'une suspension arrière Rockhox, niché près du tube supérieur et laissant suffisamment de place pour une batterie amovible entre les genoux du conducteur.  Le cadre est réalisé dans le style "enduro" et offre une course de 150 mm grâce à la suspension.  Il manque des câbles et des conduites de frein à l'intérieur du cadre.  De ce fait, un aspect esthétique est assuré et le risque d'accrochage sur les branches est réduit. <br><br>  Le cadre 100% fibre de carbone a été spécialement développé chez Greyp en utilisant l'expérience acquise lors de la création de l'hypercar électrique Concept One. <br><br>  Le kit électronique du Greyp G6 est contrôlé par un module intelligent central (CIM) en stock.  Il comprend un écran couleur, WiFi, Bluetooth, connexion 4G, un gyroscope, un connecteur USB C, une caméra avant et une interface avec une caméra arrière sous la selle.  À propos, la caméra arrière <a href="">est entourée de 4 LED</a> .  Les caméras grand angle (1080p 30 ips) sont principalement conçues pour filmer des vidéos en voyage. <br><br><div class="spoiler">  <b class="spoiler_title">Exemples de photos</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/gv/uj/-a/gvuj-atwmrvkqpvafqsyi0vjksg.jpeg"><br><br><img src="https://habrastorage.org/webt/ek/dk/xm/ekdkxm3a3_2kom1bhpoqjxen0mo.jpeg"><br><br><img src="https://habrastorage.org/webt/8x/if/wa/8xifwahsarm9ygozdcayctvhmtm.jpeg"><br></div></div><br>  L'entreprise accorde une attention particulière à la solution eSTEM. <br><br><blockquote>  «Greyp eSTEM est un module intelligent central pour un vélo qui contrôle deux caméras (avant et arrière), contrôle la fréquence cardiaque du conducteur, a un gyroscope intégré, un système de navigation et eSIM, qui vous permet de le connecter à tout moment.  Le système de vélo électrique utilise le smartphone comme interface utilisateur, et l'application mobile crée une interface utilisateur unique grâce à diverses nouvelles options, telles qu'un interrupteur à distance pour vélo, prendre des photos, envoyer du texte au vélo et une limitation de puissance. » </blockquote><br>  Il y a un bouton spécial «Partager» sur le guidon du vélo.  Si quelque chose d'intéressant ou d'excitant se produit pendant le voyage, vous pouvez cliquer sur le bouton et enregistrer automatiquement les 15-30 dernières secondes de la vidéo en la téléchargeant sur le compte de réseau social de votre cycliste.  De plus, des données supplémentaires peuvent être superposées à la vidéo.  Par exemple, la consommation d'énergie du vélo, la vitesse, le temps de trajet, etc. <br><br>  Avec le téléphone monté sur le vélo en mode tableau de bord, le Greyp G6 peut fournir une multitude d'informations, pas seulement afficher la vitesse actuelle ou le niveau de la batterie.  Ainsi, le cycliste peut sélectionner n'importe quel point sur la carte (par exemple, une haute colline), et l'ordinateur calculera s'il y a suffisamment de batterie pour arriver au sommet.  Ou il calculera le point de non-retour, si du coup vous ne voulez pas pédaler le long du chemin du retour.  Bien que les pédales soient tout à fait possibles à vriller.  Le constructeur affirme que le vélo n'est pas lourd (bien que ce soit à quoi il ressemble, son poids est de 25 kg). <br><br><img src="https://habrastorage.org/webt/wb/ym/xt/wbymxtgmvoknnaxf1kltrgqfgqq.jpeg"><br>  <i>Greyp G6 est tout à fait possible d'augmenter</i> <br><br>  Le Greyp G6 dispose d'un système antivol similaire au <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mode Sentry</a> de Tesla.  Autrement dit, si vous touchez un vélo garé, il en informera le propriétaire et lui donnera accès à la caméra pour savoir qui tourne autour du vélo électrique.  Le conducteur peut alors choisir de déconnecter le vélo à distance pour empêcher l'attaquant de partir.  Et, étant donné que ces systèmes ont été développés chez Greyp depuis de nombreuses années, il est probable qu'ils aient vraiment développé ce système avant son introduction par Tesla. <br><br>  En vente, il existe plusieurs modèles de cette série: G6.1, G6.2, G6.3.  Le G6.1 accélère à 25 km / h (15,5 mph) et coûte 6499 euros.  Le G6.3 a une vitesse de pointe de 45 km / h (28 mph) et coûte 7499 euros.  Quelle est la différence entre le modèle G6.2 n'est pas clair, mais il coûte 6 999 euros. <br><br>  <b>Quoi d'autre est utile de lire sur le blog <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cloud4Y</a></b> <br><br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le chemin de l'intelligence artificielle d'une idée fantastique à l'industrie scientifique</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4 façons d'économiser sur les sauvegardes dans le cloud</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Configurer top dans GNU / Linux</a> <br>  → L' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">été est presque terminé.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Presque aucune donnée n'a été divulguée</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">IoT, brouillard et nuages: parler de technologie?</a> <br><br>  Abonnez-vous à notre chaîne <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Telegram</a> pour ne pas manquer un autre article!  Nous écrivons pas plus de deux fois par semaine et uniquement pour affaires. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr470670/">https://habr.com/ru/post/fr470670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr470658/index.html">3. Scénario de déploiement typique de Check Point Maestro</a></li>
<li><a href="../fr470660/index.html">Quel code doit être montré lors de l'entretien</a></li>
<li><a href="../fr470662/index.html">Canon imagePRESS C910: les bêtes de somme peuvent désormais en faire plus</a></li>
<li><a href="../fr470664/index.html">Intel a présenté une nouvelle gamme de processeurs Xeon. Ils sont moins chers que les modèles précédents, mais toujours à 14 nm</a></li>
<li><a href="../fr470666/index.html">IT-Poudlard: École de programmeurs hh.ru</a></li>
<li><a href="../fr470672/index.html">Implémentation de Service Desk et CRM. 13 principales causes d'échec et comment les éviter?</a></li>
<li><a href="../fr470674/index.html">À l'intérieur du JeMalloc. Structures de données de base: association de tas et d'arborescence bitmap</a></li>
<li><a href="../fr470676/index.html">Résoudre des problèmes algorithmiques: la possibilité de réserver un hôtel</a></li>
<li><a href="../fr470680/index.html">Meilleures langues pour la localisation de jeux</a></li>
<li><a href="../fr470684/index.html">Quoi écrire dans le CV s'il n'y a pas d'expérience de travail</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>