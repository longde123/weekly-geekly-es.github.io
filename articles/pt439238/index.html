<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë® üôáüèø üë©‚Äçüíª A Play Store agora aceita aplicativos da web progressivos (PWA) üàöÔ∏è üë®üèæ‚Äç‚úàÔ∏è üë¥üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Isen√ß√£o de responsabilidade: eu n√£o sou afiliado ao Google Play, Chrome ou qualquer outra empresa mencionada. Esta n√£o √© uma declara√ß√£o oficial. O log...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>A Play Store agora aceita aplicativos da web progressivos (PWA)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439238/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/abc/fb9/445/abcfb9445e58d62d216cdf938abaffca.png"></div><br>  <sup>Isen√ß√£o de responsabilidade: eu n√£o sou afiliado ao Google Play, Chrome ou qualquer outra empresa mencionada.</sup>  <sup>Esta n√£o √© uma declara√ß√£o oficial.</sup>  <sup>O logotipo e os nomes s√£o usados ‚Äã‚Äãapenas para fins ilustrativos.</sup> <br><br>  O Chrome 72 para Android possui o t√£o esperado recurso Atividade Confi√°vel na Web.  Isso significa que agora podemos distribuir o PWA pelo diret√≥rio do Google Play e executar o Chrome sem uma interface do usu√°rio offline para pacotes nativos!  Eu brinquei com essa fun√ß√£o por um tempo, investigando a API, mas aqui vou lhe dizer sobre o que √©, o que esperar e o que est√° dispon√≠vel hoje. <br><a name="habracut"></a><br><h1>  PWA no cat√°logo da Play Store </h1><br>  O Chrome 72 para Android j√° est√° dispon√≠vel para todos os usu√°rios e a Atividade na Web Confi√°vel (TWA) √© implementada nesta vers√£o.  Em resumo, o Chrome √© iniciado offline (sem barra de ferramentas e interface do usu√°rio) para pacotes Android nativos. <br><br>  Para come√ßar, publicar em um diret√≥rio n√£o √© um procedimento t√£o simples como deveria ser (por exemplo, inserir um URL no Google Play - e o aplicativo ser√° iniciado).  Al√©m disso, voc√™ n√£o pode usar o WebAPK dispon√≠vel e publicar o aplicativo em um diret√≥rio.  Ele usa a API Java, que interage com o Chrome por meio de servi√ßos e parece estar em um est√°gio inicial de desenvolvimento.  Portanto, h√° muito o que fazer manualmente. <br><br>  Eu vejo isso como um primeiro passo.  Certamente, o melhor kit de ferramentas ser√° exibido em breve (possivelmente da comunidade) com suporte para todas as APIs dispon√≠veis e o lan√ßamento com um clique.  Mas na API atual, voc√™ pode public√°-la no diret√≥rio do iniciador do PWA.  Vou compartilhar minha experi√™ncia sobre como fazer isso. <br><br>  Por algum motivo, esse recurso ainda n√£o apareceu no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">status da plataforma Chrome</a> e a documenta√ß√£o ainda n√£o foi atualizada (ela n√£o foi atualizada por mais de 15 meses). <br><br>  <b>Atualiza√ß√£o de 5 de fevereiro</b> .  O blog Chromium publicou uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">breve nota</a> sobre o suporte da TWA e alguns dos detalhes t√©cnicos mencionados neste artigo. <br><br>  <b>Atualiza√ß√£o de 1¬∫ de fevereiro</b> .  Paul Kinlan, desenvolvedor l√≠der do Chrome no Google, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">confirmou o</a> lan√ßamento do recurso TWA e a documenta√ß√£o est√° atrasada: o motivo do atraso √© que a permiss√£o para o novo recurso Chrome 72 foi aceita no √∫ltimo minuto. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/TCgT8dzSiU8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <i><font color="gray">V√≠deo de um ano de idade de Pete Le Page explicando a TWA</font></i> <br><br><h3>  Por que publicar o PWA em um diret√≥rio? </h3><br>  Esta √© uma plataforma web, Karl!  Por que usar um diret√≥rio? <br><br>  Bem, essa √© uma conversa longa, mas eu aconselho empresas grandes e pequenas por muitos anos e, quando consideramos o desenvolvimento do PWA, o cat√°logo de aplicativos √© constantemente mencionado: "Nossos usu√°rios procurar√£o por um aplicativo l√°", "N√≥s j√° temos nosso pr√≥prio aplicativo e n√£o queremos perder usu√°rios "," Precisamos acessar nossa pr√≥pria API "ou" Quero gerar receita com o PWA ". <br><br>  A partir de agora, tornou-se poss√≠vel publicar o PWA no diret√≥rio, al√©m de trabalhar no navegador.  Obviamente, esta √© uma opera√ß√£o separada.  A Play Store n√£o emula a Microsoft Store: seu PWA n√£o aparecer√° na loja, a menos que voc√™ compile o APK e o publique. <br><br><h3>  Vantagens sobre o PWA padr√£o </h3><br>  Al√©m do novo mecanismo de distribui√ß√£o e dos novos usu√°rios do cat√°logo (e at√© de uma pesquisa no Google na se√ß√£o "Aplicativos"), outras vantagens aparecem: <br><br><ul><li>  A capacidade de colocar o widget na tela principal. <br></li><li>  Atalhos de aplicativos (com uma press√£o longa no √≠cone do aplicativo) e outra profunda integra√ß√£o com o sistema operacional. <br></li><li>  Trabalhe com um "companheiro" em dispositivos port√°teis ou com a extens√£o Android Auto. <br></li><li>  Reinstalar ap√≥s uma reinicializa√ß√£o total ou backup em um novo telefone. <br></li><li>  Servi√ßos em segundo plano que acessam suas pr√≥prias fun√ß√µes (a comunica√ß√£o com o PWA ainda √© limitada - mais detalhes abaixo). <br></li><li>  Monetiza√ß√£o (limitado at√© o momento, mais detalhes abaixo). <br></li><li>  Algumas telas nativas misturadas ao conte√∫do do PWA. <br></li><li>  Distribui√ß√£o de mais de um √≠cone do PWA no iniciador e / ou na tela inicial, apontando para URLs diferentes (dentro do mesmo host). <br></li><li>  Melhor suporte √† internacionaliza√ß√£o. </li></ul><br><h3>  Qual √© a inova√ß√£o? </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/06c/a7c/a1d/06ca7ca1d01be0f5174e371c774c6360.png"><br>  <i><font color="gray">J√° havia alguns PWAs no cat√°logo, mas agora eles s√£o muito mais f√°ceis de preparar e publicar.</font></i> <br><br>  J√° existem alguns PWAs na Google Play Store, como Google Maps Go, Instagram Lite e Twitter Lite.  O primeiro aplicativo usa alguma vers√£o privada do pr√©-TWA, e os dois √∫ltimos usam o WebView, que n√£o era o ideal, mas a √∫nica maneira de fazer algo assim antes do TWA.  Os aplicativos t√™m muito c√≥digo nativo para algumas coisas, como notifica√ß√µes.  Queremos publicar PWAs como desenvolvedores da Web e n√£o queremos escrever muito c√≥digo Java. <br><br>  O TWA √© um modo especial baseado em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">guias personalizadas do Chrome</a> , que a partir da vers√£o do Chrome 45 permitem iniciar o navegador embutido no aplicativo. <br><br><h3>  A TWA √© uma estrutura h√≠brida semelhante √† Cordova? </h3><br>  N√£o.  Com o Cordova e outras solu√ß√µes h√≠bridas, voc√™ geralmente fornece recursos (HTML, JS, CSS etc.).  no pacote APK.  <b>Al√©m disso, o mecanismo √© diferente l√°, √© isolado do navegador do usu√°rio e, portanto, n√£o suporta sess√µes ou compartilhamento de cache.</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8c8/1a6/feb/8c81a6feb0b4e06520eac4d39ace8f66.png"></div><br>  <i><font color="gray">Aqui est√° a apar√™ncia do PWA com a Atividade na Web confi√°vel.</font></i>  <i><font color="gray">Ainda n√£o vejo a implementa√ß√£o de esquemas de cores</font></i> <br><br>  Usando o Trusted Web Activity, voc√™ n√£o precisa compactar arquivos de recursos (apenas componentes nativos, se necess√°rio);  Todos os recursos s√£o baixados e atualizados em tempo real atrav√©s de um t√©cnico de servi√ßo.  Seu PWA √© sempre renderizado pela vers√£o instalada do Chrome, com armazenamento, cache e sess√µes.  Portanto, se um usu√°rio abrir uma sess√£o em um site e instalar o aplicativo na Play Store, ele j√° estar√° conectado ao sistema. <br><br><h3>  Requisitos da Play Store </h3><br>  O URL usado para uma opera√ß√£o da web confi√°vel deve atender aos seguintes requisitos: <br><br><ul><li>  Transfer√™ncia de crit√©rios do PWA (HTTPS, trabalhador de servi√ßo com manipulador de eventos de busca, manifesto de aplicativo da web com √≠cone de 512 px, background_color e um conjunto b√°sico de outras propriedades). <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Classifica√ß√£o de</a> desempenho m√≠nima de 80/100 do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">farol</a> (dispon√≠vel nas Ferramentas do desenvolvedor do Chrome ou na NPM CLI). <br></li><li>  Todas as regras atuais da Play Store. </li></ul><br>  De acordo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">com uma postagem no blog Chromium</a> , "Os aplicativos que n√£o estiverem em conformidade com os requisitos de qualidade da TWA ou com as <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pol√≠ticas da</a> Play Store podem ter sua entrada recusada ou podem ser exclu√≠dos". <br><br>  Ainda n√£o tenho certeza de que a equipe de controle de qualidade da Play Store verifique todos esses requisitos ao publicar o aplicativo. <br><br><h3>  Modelo de seguran√ßa PWA na Play Store </h3><br>  Seu PWA obedecer√° ao modelo de seguran√ßa do navegador, n√£o ao aplicativo nativo, at√© voc√™ adicionar o c√≥digo nativo diretamente ao APK.  Como tudo est√° sob o controle do navegador, o usu√°rio deve saber que, mesmo que tenha acabado de instalar o aplicativo, ele ter√° dados da sess√£o, armazenamento local e permiss√µes j√° definidas para esse host no navegador.  √â por isso que, quando voc√™ o inicia pela primeira vez, √© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">exibida uma mini mensagem "Funciona no Chrome"</a> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5ff/8d9/1df/5ff8d91df535b119b0da91c92aca2a2b.jpg"><br><br>  Al√©m disso, quando o usu√°rio desinstalar o aplicativo, ele receber√° um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aviso de</a> que o estado e os dados do aplicativo ainda est√£o dispon√≠veis no Chrome; portanto, se necess√°rio, limpe o cache.  Entre esses rastreamentos, por exemplo, a permiss√£o Web Push: mesmo que o usu√°rio desinstale o aplicativo, ele continuar√° recebendo notifica√ß√µes por push.  A mensagem foi notada por Henry Lim: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/547/90a/3bc/54790a3bceb7834fd83b7301866f118e.jpg"><br><br>  A necessidade dessas notifica√ß√µes foi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">informada por</a> Paul Kinlan, da equipe do Chrome. <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: absolute; visibility: hidden; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="1092075825065873416"></twitter-widget><blockquote class="twitter-tweet" data-lang="en_US" data-twitter-extracted-i1583607253448124386="true"><p lang="en" dir="ltr">  O armazenamento da sess√£o √© proveniente da sess√£o do navegador. Temos que indicar isso para usu√°rios de aplicativos Android que n√£o esperam esse tipo de experi√™ncia. </p>  - Paul Kinlan (@Paul_Kinlan) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3 de fevereiro de 2019</a> </blockquote><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br><h1>  M√©todos de desenvolvimento </h1><br>  Para criar um pacote com o TWA, voc√™ precisa primeiro do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Android Studio</a> .  At√© o momento, todas as op√ß√µes s√£o experimentais e descritas apenas por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">exemplos de c√≥digo</a> no reposit√≥rio do Chrome no GitHub. <br><br>  Op√ß√µes de desenvolvimento de aplicativos com o TWA: <br><br><ul><li>  <b>Usando a Biblioteca de Suporte Java de alto n√≠vel</b> da equipe do Chrome: nesse caso, voc√™ n√£o precisa escrever seu pr√≥prio c√≥digo Java ou Kotlin.  Crie um projeto do Android Studio (ou clone um exemplo), configure alguns metadados no AndroidManifest.xml a partir do manifesto do aplicativo Web - e pronto. <br><br>  A estrutura fornecer√° uma conex√£o com a TWA e recursos adicionais para criar um registro de configura√ß√µes em um dispositivo Android, al√©m de disponibilizar notifica√ß√µes por push.  Agora a biblioteca est√° no reposit√≥rio tempor√°rio do Jitpack.  Eu acho que no futuro ela vai se mudar para outro lugar. <br></li><li>  <b>Gerenciando atividade confi√°vel da Web manualmente</b> .  Se voc√™ tiver experi√™ncia no desenvolvimento de aplicativos Android em Java ou Kotlin, basta conectar manualmente o PWA.  Portanto, voc√™ pode deixar algumas a√ß√µes nativas, abrindo a Atividade na Web confi√°vel apenas no momento certo.  Nesse caso, proponho estudar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">a biblioteca de suporte</a> e entender como se conectar ao Chrome a partir do projeto. </li></ul><br>  <b>Atualiza√ß√£o de 5 de fevereiro</b> : a documenta√ß√£o do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">TrustedWebUtils</a> , o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">auxiliar</a> da TWA, j√° est√° dispon√≠vel no site do Android. <br><br><h3>  Distribui√ß√£o de manifesto </h3><br>  O PWA na App Store n√£o aceitar√° o manifesto do aplicativo da web;  Voc√™ deve copiar manualmente alguns valores.  Os √≠cones s√£o retirados da pasta "res", como em qualquer aplicativo Android nativo, o bloqueio de orienta√ß√£o deve ser definido no registro de atividade AndroidManifest, etc. <br><br>  Ao usar a biblioteca de suporte, uma tela inicial √© criada automaticamente, mas outras propriedades do manifesto n√£o ser√£o usadas.  De fato, em meus testes, n√£o pude aplicar o tema de cores quando o PWA foi aberto na tela. <br><br><h3>  Valida√ß√£o de URL </h3><br>  O TWA funcionar√° somente ap√≥s um handshake de dom√≠nio digital com o aplicativo.  O mecanismo √© conhecido como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Links de ativos digitais</a> .  Ele cria uma rela√ß√£o de confian√ßa entre o host e o APK, provando que voc√™ possui o PWA e n√£o publica aplicativos na Play Store que n√£o possui.  Ele tamb√©m estabelece um canal digital entre o site e o aplicativo nativo, o que teoricamente poderia permitir que eles trocassem dados privados (mas isso n√£o parece poss√≠vel com a API TWA de hoje). <br><br>  Com os Links de ativos digitais, voc√™ deve fazer o upload do arquivo <i>&lt;seudominio&gt; /.well-known/assetlinks.json</i> no seu dom√≠nio.  Este arquivo JSON cont√©m informa√ß√µes sobre o pacote Android (por exemplo, o identificador do pacote) e um hash do certificado do seu aplicativo, que voc√™ pode descobrir pelo comando no console.  O pacote do Android ter√° um duplo no URL do host.  Existe um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">validador online</a> para verificar se tudo est√° em ordem. <br><br>  Se voc√™ n√£o apertou as m√£os, o TWA n√£o ser√° ativado, e seu aplicativo usar√° apenas Guias Personalizadas do Chrome regulares com uma interface m√≠nima do Chrome, como se <i>exibisse: ui m√≠nima</i> inclu√≠da no PWA.  N√£o tenho muita certeza, mas provavelmente a Play Store pode rejeitar aplicativos que simplesmente apontam para guias regulares sem valida√ß√£o da TWA.  N√£o sei exatamente em que momento o Chrome realiza a verifica√ß√£o do Digital Asset Link;  se toda vez que voc√™ acessar o aplicativo, ele poder√° se tornar um problema de desempenho.  Eu acho que o cache √© poss√≠vel, assim como a Play Store pode fazer uma verifica√ß√£o antes de aprovar o aplicativo enquanto √© aceita no cat√°logo.  Vamos ver o que ser√° escrito na documenta√ß√£o. <br><br>  <b>Existe um mecanismo (n√£o t√£o simples) para burlar o processo de certifica√ß√£o Digital Asset Link para fins de desenvolvimento, descrito abaixo.</b> <br><br><h1>  Publicar Aplicativo </h1><br>  Para publicar um r√≥tulo PWA usando o TWA, voc√™ deve seguir todas as regras da Play Store.  Consulte o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Developer Policy Center para</a> obter mais informa√ß√µes.  Voc√™ tamb√©m precisar√° criar uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">conta de editor</a> com uma taxa √∫nica de US $ 25, metadados, capturas de tela e materiais de marketing para o aplicativo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ab9/348/32a/ab934832ad79351548be8cd22bfb9026.png"><br><br><h3>  Implantar </h3><br>  Quando voc√™ terminar o desenvolvimento no Android Studio e tiver uma conta para o console do desenvolvedor, precisar√° criar um APK para produ√ß√£o e assin√°-lo com a chave criada no Android Studio.  Voc√™ pode consultar o servi√ßo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">assinatura</a> do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aplicativo pelo Google Play</a> para simplificar o processo no futuro. <br><br><h3>  Console do Google Play </h3><br>  N√£o h√° regras ou processos espec√≠ficos para o download desses aplicativos, mas o departamento de Revis√£o pode detectar que voc√™ est√° usando a TWA e verificar se: 1) O Digital Assets Link est√° funcionando;  2) O URL passa os crit√©rios do PWA (principalmente para o manipulador de eventos de busca no operador de servi√ßo). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/365/83a/921/36583a921bd38dda3ce6af9b5103bb0f.png"><br>  <i><font color="gray">Para publicar na Play Store, voc√™ precisar√° especificar muitos metadados e recursos gr√°ficos.</font></i> <br><br><h3>  Atualiza√ß√£o de aplicativo </h3><br>  Se voc√™ alterar o conte√∫do, n√£o precisar√° fazer o download do aplicativo novamente, a menos que o mude completamente (de acordo com as regras do cat√°logo).  Continue a atualiz√°-lo por meio de t√©cnicos de servi√ßo e atualiza√ß√µes no servidor.  O novo APK precisar√° ser baixado apenas se voc√™ quiser alterar metadados, c√≥digo nativo ou √≠cones. <br><br><h1>  Limita√ß√µes </h1><br>  Agora a plataforma tem certas limita√ß√µes, mas este √© apenas o come√ßo.  Espero que eles sejam removidos ao longo do tempo. <br><br><h3>  PWA em subpastas </h3><br>  Se voc√™ publicar seu PWA em uma subpasta host, h√° v√°rios problemas. <br><br><ul><li>  O Digital Asset Link conecta todo o dom√≠nio, n√£o apenas a pasta. <br></li><li>  A biblioteca de suporte atual parece manipular o host inteiro como uma inten√ß√£o (captura de link), mesmo se o PWA estiver em uma subpasta. </li></ul><br><h3>  Sem aplicativos internos </h3><br>  Essa √© uma limita√ß√£o da pr√≥pria Play Store (voc√™ n√£o pode publicar aplicativos para a rede local ou aplicativos destinados apenas a voc√™ e sua empresa).  Voc√™ pode usar o TWA e criar um apk que ser√° implantado fora da loja. <br><br>  O Digital Asset Link funciona apenas com URLs p√∫blicos, pois o Chrome precisa verificar se somos propriet√°rios do dom√≠nio, o que n√£o √© poss√≠vel com URLs internos. <br><br><h3>  Primeira inicializa√ß√£o </h3><br>  Quando voc√™ abre um aplicativo instalado recentemente pela primeira vez, ainda n√£o existem arquivos de aplicativo no dispositivo (o Service Worker ainda n√£o foi registrado se o usu√°rio n√£o tiver aberto o PWA antes); portanto, no modo offline, o usu√°rio ver√° uma tela branca em branco.  Acho que em vers√µes futuras seria √∫til implementar algum tipo de troca pelo Chrome ap√≥s a instala√ß√£o do aplicativo.  Se voc√™ usar a API da TWA em vez da biblioteca de suporte, encontrar√° essa situa√ß√£o e informar√° corretamente o usu√°rio por meio das APIs nativas. <br><br><h3>  Chamando c√≥digo nativo </h3><br>  J√° existe um canal bidirecional entre o servidor TWA (Chrome) e o cliente TWA (nosso APK).  Atualmente, este canal √© usado apenas para enviar notifica√ß√µes por push e exibi-las no aplicativo nativo, e n√£o no Chrome. <br><br>  Existe algum potencial para simplesmente conectar c√≥digo nativo e JavaScript, fornecendo acesso ao PWA ao c√≥digo nativo, semelhante ao mecanismo APPX / PWA na Microsoft Store. <br><br>  Talvez no futuro seja poss√≠vel registrar classes Java / Kotlin no cliente TWA, para que possamos cham√°-las usando a API JavaScript quando nosso PWA for renderizado no modo TWA. <br><br>  Hoje, a √∫nica maneira de executar c√≥digo nativo √© usar o Intents para abrir outras a√ß√µes nativas e reabrir o TWA, enviando e recebendo argumentos por meio de par√¢metros URI. <br><br>  Al√©m disso, voc√™ pode criar algum tipo de servidor Web ou servidor WebSocket no c√≥digo nativo e enviar o PWA a ele, mas isso √© estranho, complicado e, possivelmente, consumir√° muito a bateria.  Mas temos um novo mundo de oportunidades.  Vamos ver o que a comunidade cria! <br><br><h3>  Monetiza√ß√£o da Play Store </h3><br>  Se voc√™ tiver um aplicativo pago, n√£o poder√° verificar facilmente se o usu√°rio realmente pagou por ele (afinal, o conte√∫do √© apenas um URL).  Al√©m disso, se voc√™ deseja vender recursos ou assinaturas digitais usando a carteira da Play Store, √© dif√≠cil implementar esse esquema sem uma ponte real com um c√≥digo nativo. <br><br><h3>  Depura√ß√£o </h3><br>  N√£o tenho certeza se isso √© um bug ou algum tipo de problema com o meu IDE, mas a depura√ß√£o remota dos funcion√°rios de servi√ßo da TWA n√£o funciona.  Posso verificar o contexto da janela, mas n√£o o trabalhador do servi√ßo. <br><br><h3>  Outros motores </h3><br>  Atualmente, a TWA funciona apenas no Chrome, mas, no futuro, outros navegadores podem clonar a API: por exemplo, Samsung Internet, Edge ou Firefox. <br><br>  <b>Atualiza√ß√£o de 4 de fevereiro</b> : o TWA √© executado no protocolo Android Custom Tab, que outros navegadores est√£o implementando no momento.  Portanto, se outro navegador padr√£o estiver instalado no sistema, ele poder√° abrir o TWA com o conte√∫do do PWA.  No entanto, testes adicionais s√£o necess√°rios para entender como isso funciona. <br><br>  O que acontece se o usu√°rio tiver uma vers√£o mais antiga do Chrome e instalar o aplicativo na Play Store?  Nesse caso, o PWA aparecer√° como uma guia personalizada do Chrome, e n√£o no modo totalmente offline. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7c6/a0e/7e4/7c6a0e7e4cfb1be1f72cd71a30a45b7c.png"><br>  <i><font color="gray">O Google Maps Go na Play Store j√° usava algo semelhante ao TWA, e o Chrome √© listado como um pr√©-requisito para o trabalho</font></i> <br><br>  O que acontece se um usu√°rio n√£o possui o Chrome?  At√© o momento, ao usar a biblioteca de suporte, o aplicativo n√£o funcionar√° (se n√£o houver outro navegador com suporte para o protocolo de guias personalizadas).  Se voc√™ usar a API da TWA no c√≥digo Java / Kotlin nativo, poder√° verificar a disponibilidade do navegador e baixar uma solu√ß√£o alternativa, como o WebView, ou abrir o navegador. <br><br>  Embora os dispositivos Android sem o Chrome sejam raros, em alguns casos n√£o √© instalado por padr√£o, inclusive <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">em todos os novos dispositivos na Europa</a> . <br><br><h3>  Outras plataformas </h3><br>  O PWA n√£o funciona no SO (rel√≥gios), mas n√£o tenho certeza do que est√° acontecendo em outras plataformas Android.  Provavelmente ainda n√£o h√° suporte, mas verifique isso.  Estou falando de Android TV ou Chromebooks da Play Store.  Se voc√™ n√£o testou essas plataformas, faz sentido desabilit√°-las na lista de diret√≥rios. <br><br><h3>  Conflito com o WebAPK </h3><br>  Se voc√™ instalou o PWA no Chrome, j√° tem um APK para este URL assinado pela Play Store, mas o diret√≥rio ainda deixar√° o aplicativo na lista e permitir√° que o usu√°rio o instale tamb√©m.  E vice-versa: a instala√ß√£o do aplicativo a partir do diret√≥rio n√£o impedir√° o Chrome de solicitar que o usu√°rio o adicione no navegador.  Acho que isso pode ser evitado se o WebAPK tamb√©m receber o Digital Asset Link ou se, de alguma forma, correspondermos ao identificador do aplicativo WebAPK, mas √© improv√°vel que isso aconte√ßa no futuro pr√≥ximo.  Vamos ver <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9c1/1fe/3a2/9c11fe3a28681544babba34025589479.png"></div><br>  <i><font color="gray">Dois aplicativos Starbucks em execu√ß√£o simultaneamente: WebAPK e nosso pr√≥prio APK</font></i> <br><br>  Voc√™ pode bloquear a oferta do Chrome para instalar o WebAPK e, em vez disso, mostrar seu aplicativo a partir do diret√≥rio usando <i>o</i> atributo <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">related_applications</a></i> e o atributo selected_related_applications do manifesto de aplicativo da web.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A API Get Apps Related Install</a> pode ajudar a resolver esse conflito no futuro. <br><br><h1>  Criando o primeiro PWApk </h1><br>  Eu sei que acabei de inventar a palavra PWApk, mas isso soa bem, certo? <br><br>  Alguns anos atr√°s, fiz um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">curso em v√≠deo sobre aplicativos da Web nativos para Android</a> .  Embora isso n√£o seja totalmente verdade no PWA, ajuda a entender o ecossistema do Android. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/737/af5/77f/737af577f5decf195a80d62670f783f2.png"></div><br>  <i><font color="gray">A maneira mais f√°cil de criar APKs baseados em TWA √© clonar a amostra do reposit√≥rio SVGOMG do reposit√≥rio ChromeLabs no GitHub</font></i> <br><br>  Voc√™ pode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">clonar o reposit√≥rio git</a> ou iniciar um novo projeto.  No nosso caso, iniciamos um novo projeto apenas para entender melhor o t√≥pico. <br><br>  Crie um novo projeto no Android Studio e selecione <i>Nenhuma Atividade</i> : usaremos apenas Atividade da Web Confi√°vel na biblioteca de suporte. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f3/ed6/3a6/5f3ed63a6ff8edc7a331955cfc85bd9e.png"><br>  <i><font color="gray">Vamos come√ßar com um projeto vazio</font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preencha os dados, selecione o nome do projeto (mudaremos mais tarde) e o nome do pacote: este ser√° o identificador de nosso aplicativo no Android, bem como no cat√°logo. Eu recomendo usar o nome do host na ordem inversa e um nome arbitr√°rio no final. Por exemplo, se voc√™ tiver o host </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mypwa.com/calculator</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o pacote poder√° ser chamado </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com.mypwa.calculator</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como base, a API 19 (Android 4.4) √© adequada. Parece que em breve ser√° a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vers√£o m√≠nima necess√°ria para o Chrome</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Algumas fun√ß√µes do TWA funcionar√£o apenas com a API 23 (Android 6.0), mas a biblioteca de suporte cuidar√° disso. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atualiza√ß√£o de 5 de fevereiro</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: O Chrome anunciou oficialmente que a TWA funciona apenas com o Android 4.4 KitKat. </font><font style="vertical-align: inherit;">Portanto, essa fun√ß√£o n√£o est√° dispon√≠vel para aproximadamente 5% dos usu√°rios ativos do Android: eles ser√£o revertidos para a vers√£o com uma guia e barra de endere√ßo personalizadas. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2d3/66a/8fb/2d366a8fbf19b050af01bc9e35ed5093.png"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A escolha de um n√≠vel m√≠nimo de API limitar√° a lista de dispositivos para os quais o PWA ser√° oferecido no diret√≥rio Play Store</font></font></font></i> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Adicionar depend√™ncia </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A pr√≥xima etapa √© adicionar a biblioteca de suporte da TWA como uma depend√™ncia; portanto, abra dois arquivos chamados </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build.gradle</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5fa/f6c/f11/5faf6cf11d05e2df8ed6c8eab783a8c4.png"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dois arquivos de configura√ß√£o: para o projeto e o aplicativo Android</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vamos come√ßar com o arquivo do projeto. </font><font style="vertical-align: inherit;">Inclua a </font><font style="vertical-align: inherit;">seguinte linha </font><font style="vertical-align: inherit;">na se√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allprojects&gt; repositories</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><pre><code class="java hljs">maven { url <span class="hljs-string"><span class="hljs-string">"https://jitpack.io"</span></span> }</code> </pre> <br>  Na pr√≥xima etapa, abrimos o m√≥dulo <i>build.gradle</i> e o adicionamos dependendo: <br><br><pre> <code class="java hljs">implementation <span class="hljs-string"><span class="hljs-string">'com.github.GoogleChrome:custom-tabs-client:e446d08014'</span></span></code> </pre> <br><h3>  Configura√ß√£o TWA </h3><br>  A pr√≥xima etapa √© definir os par√¢metros do PWA para Atividade da Web confi√°vel no arquivo do m√≥dulo, adicione a se√ß√£o <i>defaultConfig</i> : <br><br><pre> <code class="java hljs">manifestPlaceholders = [ hostName: <span class="hljs-string"><span class="hljs-string">"app.starbucks.com"</span></span>, defaultUrl: <span class="hljs-string"><span class="hljs-string">"https://app.starbucks.com"</span></span>, launcherName: <span class="hljs-string"><span class="hljs-string">"Starbucks"</span></span>, assetStatements: <span class="hljs-string"><span class="hljs-string">'[{ "relation": ["delegate_permission/common.handle_all_urls"], '</span></span> + <span class="hljs-string"><span class="hljs-string">'"target": {"namespace": "web", "site": "https://app.starbucks.com"}}]'</span></span> ]</code> </pre> <br>  Aqui, como exemplo, usarei o Starbucks PWA.  As informa√ß√µes do processo Digital Asset Link ser√£o necess√°rias pela chave assetStatements.  Iremos pular esta parte por enquanto.  A propriedade chamada <i>launcherName</i> deve corresponder ao <i>short_name</i> no manifesto do aplicativo da web. <br><br><h3>  Configura√ß√£o do manifesto </h3><br>  Os aplicativos Android t√™m seu pr√≥prio manifesto, eles n√£o aceitar√£o o manifesto do aplicativo da web.  O arquivo desejado est√° localizado na se√ß√£o <i>app&gt; manifestos</i> e √© chamado AndroidManifest.xml.  L√° voc√™ encontrar√° um elemento XML de aplicativo com fechamento autom√°tico. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/65d/486/38c/65d48638cd9d76411f8fc935d6e3fff4.png"><br>  <i><font color="gray">Arquivo de manifesto padr√£o do Android</font></i> <br><br>  L√°, alteramos o valor do android: label para <b>$ {launcherName}</b> , que definimos anteriormente nos metadados, para que tenhamos a √∫nica fonte de verdade para o nome do aplicativo. <br><br>  A pr√≥xima etapa √© configurar esse arquivo, come√ßando com a tag &lt;application&gt;, para adicionar elementos filhos a ele, que ser√° semelhante a este: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asset_statements"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${assetStatements}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.support.customtabs.trusted.LauncherActivity"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${launcherName}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.support.customtabs.trusted.DEFAULT_URL"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${defaultUrl}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.VIEW"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.DEFAULT"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.BROWSABLE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:scheme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:host</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${hostName}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  O c√≥digo abaixo configurar√° o TWA usando a biblioteca de suporte e o Filtro de Inten√ß√£o para que o aplicativo receba links para o PWA e o Digital Asset Link.  Vou pular os detalhes do que est√° acontecendo em termos de aplicativo para Android. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5b0/45f/bd2/5b045fbd2c03c263490b96905f79aac6.png"><br>  <i><font color="gray">Est√° na hora de sincronizar</font></i> <br><br>  Neste ponto, voc√™ precisa comandar o Android Studio para aceitar todas as suas altera√ß√µes clicando em <i>Sincronizar agora</i> .  Se tudo for feito corretamente, nenhum erro ser√° exibido. <br><br><h3>  Substitui√ß√£o de √≠cone </h3><br>  No momento, o aplicativo usa apenas o √≠cone padr√£o do Android; portanto, √© necess√°rio substituir todos os arquivos em <i>app&gt; res&gt; mipmap</i> em diferentes subpastas para diferentes densidades de pixel.  Existem duas vers√µes: √≠cones quadrados e arredondados.  Arredondado apareceu no Android 7.1 e, se voc√™ quiser ignor√°-los, exclua o link <i>android: roundIcon</i> no AndroidManifest.xml. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/626/7c7/baf/6267c7bafb790307f16bf2c0bb8a037a.png"><br>  <i><font color="gray">Voc√™ precisa pegar os √≠cones do manifesto e copi√°-los para as subpastas mipmap com os nomes correspondentes</font></i> <br><br><h3>  Configura√ß√£o do tema </h3><br>  Por fim, abra <i>app / res / values ‚Äã‚Äã/ styles.xml</i> e fa√ßa algumas altera√ß√µes no tema para que ele se pare√ßa com o PWA: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AppTheme"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">parent</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Theme.AppCompat.Light.NoActionBar"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"colorPrimary"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/colorPrimary</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"colorPrimaryDark"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/colorPrimaryDark</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"colorAccent"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/colorAccent</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"android:windowNoTitle"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">true</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"android:backgroundDimEnabled"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">false</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Voc√™ pode alterar as cores em <i>app / res / values ‚Äã‚Äã/ colors.xml</i> , mas ainda n√£o vi esse trabalho no TWA. <br><br>  Se voc√™ restringir a orienta√ß√£o no manifesto, poder√° adicionar essa restri√ß√£o ao elemento &lt;atividade&gt; no AndroidManifest.xml. <br><br><h1>  Pronto para testar? </h1><br>  Estamos prontos para testar nosso PWApk, mas antes disso precisamos configurar o modo de desenvolvimento TWA para o Chrome em um dispositivo de teste Android ou em um emulador (com o Chrome 72+). <br><br><h3>  Configura√ß√£o do Chrome </h3><br>  Certifique-se de ter a vers√£o est√°vel do Chrome 72 e abrir <i>sinalizadores chrome: //</i> .  Localize a op√ß√£o <i>Ativar linha de comando em dispositivos n√£o-rooteados</i> e <i>marque a caixa</i> .  Reinicie seu navegador. <br><br>  Em seguida, precisamos configurar o Chrome para ignorar o Digital Asset Link do host que queremos testar, em nosso exemplo √© <b>app.starbucks.com</b> . <br><br>  Para alterar as op√ß√µes de linha de comando do Chrome para Android, voc√™ precisa gravar um arquivo de texto no sistema de arquivos do Android.  A maneira mais f√°cil de fazer isso √© atrav√©s do <b>adb</b> (ponte de depura√ß√£o do android), que deve ser registrado no caminho (google, se houver), e execute o comando: <br><br><pre> <code class="bash hljs">adb shell cat /data/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/tmp/chrome-command-line _ - <span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-digital-asset-link-verification-for-url=<span class="hljs-string"><span class="hljs-string">"https://app.starbucks.com"</span></span></code> </pre> <br>  Voc√™ pode usar um <a href="">script bash simples</a> do Google. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bb1/285/bec/bb1285becd4651597032df751d86abcf.png"><br>  <i><font color="gray">Voc√™ precisa parar o Chrome para que ele aceite novas configura√ß√µes na inicializa√ß√£o</font></i> <br><br>  E reinicie o Chrome.  Mas n√£o basta remover o aplicativo da lista de tarefas, mas das configura√ß√µes para for√ßar o processo completo (For√ßar parada).  Eu tive que fazer isso algumas vezes antes de funcionar. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/590/e38/84b/590e3884b2f60cb751eb746eb24e69f1.png"><br>  <i><font color="gray">Aviso de que a bandeira est√° ligada e tudo correu bem</font></i> <br><br>  Se tudo estiver pronto, sempre que voc√™ abrir o Chrome, voc√™ ver√° um aviso sobre um sinalizador n√£o suportado.  Se voc√™ executar o aplicativo no Android Studio, seu PWA finalmente iniciar√° e funcionar√° offline com o √≠cone e o nome do seu APK. <br><br><h1>  Conclus√£o </h1><br>  A capacidade de publicar o PWA no diret√≥rio do Google Play realmente muda as regras do jogo.  Parece que agora temos uma vers√£o muito antiga da API e definitivamente precisamos de algum trabalho.  Eu realmente quero poder inserir o URL do nosso PWA e obter o arquivo APK dele.  Isso n√£o √© muito simples devido ao sistema de verifica√ß√£o do Digital Asset Link.  Somente a Play Store pode fazer isso usando o mesmo WebAPK que eles geram. <br><br>  Eu costumava me perguntar se o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Google aprova os aplicativos PWA ou est√° em guerra com eles</a> .  Mas agora eles removeram suas suspeitas, pelo menos no que diz respeito √† TWA. <br><br>  Espero que a TWA no Chrome 72 seja o primeiro passo de uma longa jornada! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt439238/">https://habr.com/ru/post/pt439238/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt439224/index.html">Novamente sobre os diagramas de Voronoi</a></li>
<li><a href="../pt439226/index.html">Scala + MXNet = Microsservi√ßo com neur√¥nio em prod</a></li>
<li><a href="../pt439232/index.html">JAMstack: Como criar seu pr√≥prio blog usando Gatsby + Contentful + Netlify</a></li>
<li><a href="../pt439234/index.html">Vida do desenvolvedor de c√≥digo aberto em GIFs</a></li>
<li><a href="../pt439236/index.html">xenvman: ambientes flex√≠veis de teste de microsservi√ßos (e mais)</a></li>
<li><a href="../pt439240/index.html">Joomla Digest para janeiro de 2019</a></li>
<li><a href="../pt439242/index.html">Em torno da vers√£o beta em 260 dias: como aprendemos a ouvir os usu√°rios</a></li>
<li><a href="../pt439244/index.html">A FAS recomenda fortemente a pr√©-instala√ß√£o de software russo em smartphones e laptops vendidos na Federa√ß√£o Russa</a></li>
<li><a href="../pt439248/index.html">Alan Kay: "Os romanos antigos poderiam construir um computador?"</a></li>
<li><a href="../pt439252/index.html">6 raz√µes para desenvolver uma carreira em TI na Arm√™nia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>