<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💂 💋 🎰 Cara mengetik memeriksa 4 juta baris kode Python. Bagian 3 👲🏿 👋🏻 🛏️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kami sampaikan kepada Anda, bagian ketiga dari terjemahan materi di jalur yang telah dilakukan Dropbox, memperkenalkan sistem untuk memeriksa jenis-je...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara mengetik memeriksa 4 juta baris kode Python. Bagian 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/468237/">  Kami sampaikan kepada Anda, bagian ketiga dari terjemahan materi di jalur yang telah dilakukan Dropbox, memperkenalkan sistem untuk memeriksa jenis-jenis kode Python. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/jl/mz/yu/jlmzyu7qhqkzvqcq-k_qznbk65s.jpeg"></a> <br><br>  → Bagian sebelumnya: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pertama</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kedua</a> <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Mencapai 4 juta baris kode yang diketik</font> </h2><br>  Tugas penting lainnya (ini adalah masalah terpopuler kedua yang mengkhawatirkan mereka yang berpartisipasi dalam jajak pendapat internal) adalah meningkatkan jumlah kode di Dropbox yang dicakup dengan pemeriksaan jenis.  Kami mencoba beberapa pendekatan untuk mengatasi masalah ini - dari pertumbuhan alami volume basis kode yang diketik hingga fokus upaya tim mypy pada inferensi tipe otomatis statis dan dinamis.  Akibatnya, tampaknya tidak ada strategi kemenangan yang sederhana, tetapi kami dapat mencapai pertumbuhan cepat dalam volume kode beranotasi dengan menggabungkan banyak pendekatan. <br><br>  Akibatnya, dalam repositori Python terbesar kami (dengan kode backend), jumlah baris kode beranotasi telah mencapai hampir 4 juta.  Pekerjaan pengetikan kode secara statis dilakukan dalam waktu sekitar tiga tahun.  Mypy sekarang mendukung berbagai jenis laporan cakupan kode yang membuatnya lebih mudah untuk memantau kemajuan pengetikan.  Secara khusus, kami dapat membuat laporan tentang kode dengan ketidakpastian jenis, seperti, misalnya, penggunaan eksplisit dari jenis apa pun dalam anotasi yang tidak dapat diverifikasi, atau dengan mengimpor perpustakaan pihak ketiga yang tidak memiliki anotasi jenis.  Sebagai bagian dari proyek untuk meningkatkan akurasi pengecekan tipe di Dropbox, kami telah berkontribusi untuk meningkatkan definisi tipe (yang disebut file rintisan) untuk beberapa pustaka sumber terbuka populer di repositori Python terpusat yang diketik. <br><br>  Kami telah menerapkan (dan standar dalam PEP berikutnya) fitur baru dari sistem tipe, yang memungkinkan kami untuk menggunakan tipe yang lebih tepat untuk beberapa pola Python tertentu.  Contoh penting dari ini adalah <code>TypeDict</code> , yang menyediakan jenis untuk kamus seperti JSON yang memiliki seperangkat kunci string yang tetap, masing-masing memiliki nilai jenisnya sendiri.  Kami akan terus memperluas sistem tipe.  Mungkin langkah kita selanjutnya adalah meningkatkan dukungan bagi kemampuan Python untuk bekerja dengan angka. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/91a/311/364/91a3113642c30b04ee935cc424016d17.png"></div><br>  <i><font color="#999999">Jumlah baris kode beranotasi: server</font></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/606/b7c/251/606b7c251a21e1acd55f6bf8efc41d9a.png"></div><br>  <i><font color="#999999">Jumlah baris kode beranotasi: klien</font></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/af0/149/f38/af0149f383cd8ff599b6e6d590ac1f29.png"></div><br>  <i><font color="#999999">Jumlah total baris kode beranotasi</font></i> <br><br>  Berikut adalah ikhtisar fitur utama dari tindakan yang kami lakukan untuk meningkatkan volume kode beranotasi di Dropbox: <br><br>  Kerasnya anotasi.  Kami secara bertahap meningkatkan persyaratan kerasnya anotasi kode baru.  Kami mulai dengan kiat linter yang menyarankan menambahkan anotasi ke file yang sudah memiliki beberapa anotasi.  Sekarang kita memerlukan anotasi jenis dalam file Python baru dan di sebagian besar file yang ada. <br><br>  Mengetik laporan.  Kami mengirimkan laporan mingguan ke tim tentang tingkat pengetikan kode mereka dan memberikan kiat mengenai apa yang seharusnya dijelaskan. <br><br>  Mempopulerkan mypy.  Kami berbicara tentang mypy di berbagai acara dan berkomunikasi dengan tim untuk membantu mereka mulai menggunakan anotasi jenis. <br><br>  Polling.  Kami melakukan survei pengguna secara berkala untuk mengidentifikasi masalah utama.  Kami siap melangkah cukup jauh untuk menyelesaikan masalah ini (hingga menciptakan bahasa baru demi mempercepat mypy!). <br><br>  Performa.  Kami telah sangat meningkatkan kinerja mypy melalui penggunaan daemon dan mypyc.  Ini dilakukan untuk memuluskan ketidaknyamanan yang muncul selama proses anotasi, dan agar dapat bekerja dengan sejumlah besar kode. <br><br>  Integrasi dengan editor.  Kami telah menciptakan alat untuk mendukung peluncuran mypy di editor yang populer di Dropbox.  Ini termasuk PyCharm, Vim, dan VS Code.  Ini sangat menyederhanakan proses anotasi kode dan memverifikasi kinerjanya.  Tindakan seperti itu biasanya khas ketika membubuhi keterangan kode yang ada. <br><br>  Analisis Statis  Kami membuat alat untuk mengeluarkan tanda tangan fungsi menggunakan alat analisis statis.  Alat ini hanya dapat bekerja dalam situasi yang relatif sederhana, tetapi telah membantu kami meningkatkan cakupan jenis dengan sedikit usaha. <br><br>  Dukungan untuk perpustakaan pihak ketiga.  Banyak proyek kami menggunakan toolkit SQLAlchemy.  Ia menggunakan kemampuan dinamis Python, yang jenis PEP 484 tidak dapat memodelkan secara langsung.  Menurut PEP 561, kami membuat file rintisan yang sesuai dan menulis sebuah plugin untuk mypy ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">open source</a> ) yang meningkatkan dukungan SQLAlchemy. <br><br><h2>  <font color="#3AC1EF">Kesulitan yang kami temui</font> </h2><br>  Jalur menuju 4 juta baris kode yang diketik tidak selalu mudah bagi kami.  Dalam perjalanan ini kami bertemu banyak lubang dan membuat beberapa kesalahan.  Berikut adalah beberapa masalah yang kami temui.  Kami berharap kisah tentang mereka akan membantu orang lain menghindari masalah seperti itu. <br><br>  File yang dilewati.  Kami mulai dengan memeriksa hanya sejumlah kecil file.  Segala sesuatu yang tidak termasuk dalam jumlah file-file ini tidak diperiksa.  File ditambahkan ke daftar periksa ketika anotasi pertama muncul di dalamnya.  Jika ada sesuatu yang diimpor dari modul yang terletak di luar lingkup pemeriksaan, maka kami berbicara tentang bekerja dengan nilai-nilai tipe <code>Any</code> , yang tidak diperiksa sama sekali.  Hal ini menyebabkan hilangnya akurasi pengetikan yang signifikan, terutama pada tahap awal migrasi.  Pendekatan ini sejauh ini telah bekerja dengan sangat baik, meskipun itu khas bahwa menambahkan file ke area pemindaian akan mengungkapkan masalah di bagian lain dari basis kode.  Dalam skenario terburuk, ketika dua area kode yang terisolasi digabungkan, di mana, terlepas dari satu sama lain, jenis sudah diperiksa, ternyata jenis area ini tidak kompatibel satu sama lain.  Ini membuatnya perlu untuk membuat banyak perubahan pada anotasi.  Sekarang, melihat ke belakang, kami memahami bahwa kami harus menambahkan modul perpustakaan dasar ke area pemeriksaan tipe mypy sedini mungkin.  Ini akan membuat pekerjaan kami jauh lebih mudah diprediksi. <br><br>  Membubuhi keterangan kode lama.  Ketika kami mulai, kami memiliki sekitar 4 juta baris kode Python yang ada.  Jelas bahwa menjelaskan semua kode ini bukanlah tugas yang mudah.  Kami membuat alat yang disebut PyAnnotate, yang dapat mengumpulkan informasi jenis selama pelaksanaan pengujian dan dapat menambahkan anotasi jenis ke kode berdasarkan informasi yang dikumpulkan.  Namun, kami tidak melihat pengenalan yang luas dari alat ini.  Mengetik informasi tentang tipe lambat, anotasi yang dibuat secara otomatis sering membutuhkan banyak pengeditan manual.  Kami berpikir untuk meluncurkan alat ini secara otomatis setiap kali Anda memeriksa kode, atau tentang mengumpulkan informasi jenis berdasarkan analisis dari sejumlah kecil permintaan jaringan nyata, tetapi memutuskan untuk tidak melakukannya, karena salah satu dari pendekatan ini terlalu berisiko. <br><br>  Akibatnya, dapat dicatat bahwa sebagian besar kode dianotasi secara manual oleh pemiliknya.  Untuk mengarahkan proses ini ke arah yang benar, kami menyiapkan laporan tentang modul dan fungsi penting yang perlu dijelaskan.  Misalnya, penting untuk menyediakan anotasi jenis dengan modul perpustakaan yang digunakan di ratusan tempat.  Tetapi layanan lama, yang digantikan oleh yang baru, annotating tidak lagi begitu penting.  Kami juga bereksperimen menggunakan analisis statis untuk menghasilkan anotasi jenis untuk kode lama. <br><br>  Impor lingkaran.  Sebelumnya, saya berbicara tentang impor siklik ("kusut dependensi"), keberadaannya yang mempersulit percepatan mypy.  Selain itu, kami harus bekerja keras untuk menyediakan mypy dengan dukungan untuk semua jenis idiom yang disebabkan oleh impor siklik ini.  Kami baru-baru ini menyelesaikan proyek perancangan ulang sistem utama yang memperbaiki sebagian besar masalah impor siklik impor.  Masalah-masalah ini, pada kenyataannya, muncul dari hari-hari awal proyek, kembali dari Alore, bahasa pendidikan yang mypy awalnya berorientasi.  Sintaks lain membuatnya mudah untuk memecahkan masalah perintah impor siklik.  Mypy modern telah mewarisi beberapa batasan dari implementasi awal yang cerdas (yang bekerja sangat baik untuk Alore).  Python membuatnya sulit untuk bekerja dengan impor melingkar, terutama karena ambiguitas ekspresi.  Misalnya, selama operasi penugasan, jenis alias sebenarnya dapat ditentukan.  Mypy tidak selalu dapat mendeteksi hal-hal seperti itu sampai sebagian besar siklus impor telah diproses.  Alore tidak memiliki ambiguitas seperti itu.  Keputusan yang gagal dibuat pada tahap awal pengembangan sistem dapat memberikan kejutan yang tidak menyenangkan bagi seorang programmer setelah bertahun-tahun. <br><br><h2>  <font color="#3AC1EF">Ringkasan: Jalur menuju 5 juta baris kode dan cakrawala baru</font> </h2><br>  Proyek mypy telah berjalan jauh - dari prototipe awal ke sistem yang mengontrol jenis kode produksi dengan volume 4 juta baris.  Saat mypy berkembang, tip petunjuk distandarkan dalam Python.  Ekosistem yang kuat telah berkembang sekitar mengetik kode Python hari ini.  Itu menemukan tempat untuk mendukung perpustakaan, itu berisi alat bantu untuk IDE dan editor, ia memiliki beberapa jenis sistem kontrol, yang masing-masing memiliki pro dan kontra. <br><br>  Terlepas dari kenyataan bahwa pengecekan tipe sudah diterima begitu saja di Dropbox, saya yakin bahwa kita masih hidup pada awal mengetik kode Python.  Saya pikir teknologi pengecekan tipe akan terus berkembang dan meningkat. <br><br>  Jika Anda belum pernah menggunakan pemeriksaan jenis dalam proyek Python skala besar, maka Anda harus tahu bahwa sekarang adalah waktu yang tepat untuk memulai transisi ke pengetikan statis.  Saya berbicara dengan mereka yang melakukan transisi serupa.  Tidak ada yang menyesal.  Kontrol tipe mengubah Python menjadi bahasa yang jauh lebih baik daripada "Python normal" untuk mengembangkan proyek besar. <br><br>  <b>Pembaca yang budiman!</b>  Apakah Anda menggunakan kontrol tipe dalam proyek Python Anda? <br><br><div style="text-align:center;"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/it/t5/3p/itt53pns2iucwylb3bwn1fmmtnu.png"></a> </div><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id468237/">https://habr.com/ru/post/id468237/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id468227/index.html">Akselerasi instagram.com. Bagian 1</a></li>
<li><a href="../id468229/index.html">Catatan kosong pada JavaScript dan TypeScript</a></li>
<li><a href="../id468231/index.html">Apakah keamanan dalam AEM platform atau masalah implementasi?</a></li>
<li><a href="../id468233/index.html">Cara mengetik memeriksa 4 juta baris kode Python. Bagian 1</a></li>
<li><a href="../id468235/index.html">Cara mengetik memeriksa 4 juta baris kode Python. Bagian 2</a></li>
<li><a href="../id468239/index.html">Memilih struktur data yang tepat di Swift</a></li>
<li><a href="../id468245/index.html">Kami tidak perlu koreksi terjemahan: penerjemah kami lebih tahu bagaimana ini harus diterjemahkan</a></li>
<li><a href="../id468251/index.html">Tidak ada masa depan</a></li>
<li><a href="../id468253/index.html">Slider gambar sederhana dalam CSS dan Javascript</a></li>
<li><a href="../id468259/index.html">Lima highlights dari KTT Helm 2019 di Amsterdam</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>