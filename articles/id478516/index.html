<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨â€ğŸ‘§â€ğŸ‘¦ ğŸ‘¤ ğŸ–¨ï¸ Jalan prosedural di Houdini dan Unity ğŸ¤¸ ğŸ‘©â€ğŸ¨ ğŸ–ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Untuk permainan Frameshift pasca-apokaliptik saya , saya perlu mengisi dunia terbuka yang sangat besar dengan beragam kota. Tim kami hanya memiliki 3 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Jalan prosedural di Houdini dan Unity</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/478516/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/568/18c/687/56818c687d0b46587a12baae541c25aa.jpg" alt="gambar"></div><br>  Untuk permainan <a href="http://www.frameshiftgame.com/">Frameshift</a> pasca-apokaliptik saya <a href="http://www.frameshiftgame.com/">,</a> saya perlu mengisi dunia terbuka yang sangat besar dengan beragam kota.  Tim kami hanya memiliki 3 orang, jadi saya, tentu saja, menggunakan kekuatan prosedural Houdini! <br><br>  Sebelumnya, ketika saya tidak tahu tentang Houdini, saya menulis di C # alat saya sendiri untuk pembuatan mesh prosedural untuk Unity.  Menambahkan fitur baru adalah proses yang sangat panjang, dan ketika saya pernah mendengar bahwa Houdini dirancang untuk tugas-tugas seperti itu, saya segera beralih ke sana.  Saya bereksperimen dengan berbagai cara menghasilkan kota dan jalan, dan dalam artikel ini saya akan berbicara secara singkat tentang teknik yang akhirnya saya gunakan untuk permainan. <br><br>  Pertama, saya membuat alat untuk menghasilkan jaringan jalan yang bisa digunakan di kota.  Keputusan saya didasarkan pada konsep yang disajikan di <a href="https://martindevans.me/game-development/2015/12/11/Procedural-Generation-For-Dummies-Roads/">sini</a> , serta pada artikel yang digunakan sebagai referensi.  Ada banyak pembicaraan tentang medan tensor dan vektor eigen, dan semuanya ditulis dengan sangat teknis, tetapi secara singkat dapat dijelaskan sebagai berikut: untuk kasus saya (membuat jaringan jalan pada relief) saya perlu membuat garis kontur lega, serta garis yang tegak lurus terhadapnya. <br><a name="habracut"></a><br>  Saya mulai dengan bantuan, dan berkat sedikit bantuan dari contoh Houdini Gubbins, saya menghasilkan vektor di setiap titik bantuan yang diarahkan ke jalur, dan garis gradien menggunakan VEX: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dee/217/deb/dee217deb59d8113034a63982c548bec.jpg" alt="gambar"></div><br>  Vektor kuning menunjukkan garis kontur. <br><br>  Maka kita perlu membuat kisi-kisi jalan-jalan kota dan mencampur vektor-vektornya dengan vektor-vektor yang mengulangi kurva alami dari relief.  Jadi kita akan menciptakan area yang menyerupai jaringan jalan-jalan kota, berpadu dengan baik dengan reliefnya.  Di sini kita meletakkan grid pada relief, kemudian polyframing sehingga normals berbaris di sepanjang garis grid, menambahkan falloff untuk smooth blending dan akhirnya menetapkan path vektor baru, yang merupakan campuran dari dua vektor: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fe2/714/b7a/fe2714b7a36cfe05f10bbd7f40026c48.jpg" alt="gambar"></div><br>  Pada gambar di atas, Anda dapat melihat bahwa di dalam batas-batas persegi panjang, garis kontur lebih seperti sebuah kisi.  Saya juga melakukan proses serupa untuk menambahkan pengaruh jalan yang dibuat secara manual ke permainan.  Saya memperkenalkan slider di Unity HDA sehingga pengaruhnya dapat diubah dengan membuat jalan yang lebih alami atau lebih "persegi" dalam batas kota. <br><br>  Selanjutnya, saya akan mengonversi bidang vektor ke VDB sehingga Anda dapat mengambil sampel dari mereka untuk membuat jalan yang sudah jadi.  Dengan pelacakan volume SOP Anda bisa mendapatkan visualisasi yang indah: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/caa/e3f/a80/caae3fa80d45d81547bd39f517cf7aa8.jpg" alt="gambar"></div><br>  Itu sudah mulai terlihat seperti jaringan jalan!  Mereka terlalu dekat satu sama lain, tetapi secara umum sudah ada bentuk.  Kemudian kami melakukan banyak operasi pengambilan sampel dari kecepatan VDB dan banyak gangguan untuk membuat garis jalan yang sudah jadi.  Kode gangguan pada dasarnya mengatur jalan ke jarak yang tepat dan mengakhirinya jika terlalu dekat dengan jalan lain atau terlalu panjang: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ca4/134/e49/ca4134e492093e6d009c242a3a0b9bbf.jpg" alt="gambar"></div><br>  Lalu kami melakukan post-processing untuk menghaluskan semuanya, menghapus bagian-bagian kecil, memperpanjang jalan buntu untuk membuat persimpangan yang realistis, dan meletakkan jalan di medan.  Hasil akhirnya terlihat seperti ini: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f63/5f0/676/f635f06766464e3972bd2f5bdef9fe8a.jpg" alt="gambar"></div><br>  Masih ada beberapa bagian yang tidak realistis, tetapi sedikit pembersihan manual di Unity dapat diterima, mengingat berapa banyak waktu yang kami hemat dalam hal ini. <br><br>  Jadi, kami secara prosedural menghasilkan jaringan jalan kota, tetapi hasilnya hanya sekelompok kurva di Houdini.  Sekarang saya akan menunjukkan kepada Anda bagaimana menghasilkan geometri jalan untuk masing-masing kurva ini untuk membuat jerat yang dapat Anda gunakan di Unity.  Ini adalah hasil kami sebelumnya yang diport ke Unity: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/07f/f2b/f41/07ff2bf4179457571247eaa324dfab76.jpg" alt="gambar"></div><br>  Pertama, Anda perlu memberi tahu bagaimana transfer data antara Houdini dan Unity dilakukan.  Dalam kasus jalan, saya menulis ke file JSON urutan titik, lebar jalan, dan preset permukaan jalan.  Di Unity, saya membuat alat editor untuk mengedit jalan secara manual menggunakan kurva Bezier: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/427/4dc/dc2/4274dcdc22ad6ad06a14720a26db71dc.jpg" alt="gambar"></div><br>  Anda dapat menemukan banyak tutorial di mesin pencari tentang membuat editor kurva Bezier di Unity.  Untuk mentransfer data kembali ke Houdini, saya menggunakan simpul Python untuk membaca file JSON: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d31/1d9/3d6/d311d93d6179adbcf9e56c923a0ceb76.jpg" alt="gambar"></div><br>  Di sini Anda melihat hasil membuat jaringan jalan perkotaan, yang diperoleh di atas, tapi kali ini dibaca dari file JSON, karena sekarang diperoleh dari Unity dengan perubahan manual. <br><br>  Saya juga mengimpor bantuan dari Unity, membaca data mentahnya.  Mungkin hari ini dapat dilakukan secara native dengan bantuan HDA, karena Mesin Houdini telah meningkatkan dukungan untuk medan Persatuan, tetapi ketika saya melakukan pekerjaan ini, itu masih tidak begitu baik. <br><br>  Lalu kita buat persimpangan.  Pekerjaan utama di sini dilakukan oleh SOP Stitch Persimpangan, tapi saya juga menggunakan VEX untuk memperpanjang jalan sedikit jika mereka tidak berpotongan sepenuhnya, dan menghapus ujung pendek sehingga persimpangan T dibuat dengan benar. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a89/a67/6ba/a89a676bab14b697eae4bad76b7e0596.jpg" alt="gambar"></div><br>  Selanjutnya, saya membuat grup persimpangan dengan menggunakan falloff dari persimpangan, di mana jarak atenuasi sama dengan terluas di persimpangan jalan.  Lalu saya memperluas kelompok tepi ini dalam kasus-kasus di mana sudut antara dua jalan kurang dari 45 derajat sehingga ada ruang yang cukup antara kedua ujung persimpangan untuk membuat mesh dengan lebar yang diinginkan: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9d8/746/6ab/9d87466abdd52316e033d330e014e91a.jpg" alt="gambar"></div><br>  Perhitungan dalam simpul VEX menemukan sisi miring dari segitiga siku-siku (kita dapat mengasumsikan bahwa setiap bagian individu dari persimpangan terdiri dari dua segitiga siku-siku): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/46b/bd7/54e/46bbd754e96f47cb9c0a1900479d4d8f.jpg" alt="gambar"></div><br>  Karena kita tahu berapa lebar jalan dari kelompok persimpangan seharusnya (ditunjukkan pada gambar di atas sebagai A) dan mengetahui sudut a, kita dapat menghitung C untuk menemukan jarak dimana kita perlu memperluas grup persimpangan untuk membaginya dengan lebar yang diinginkan. <br><br>  Lalu kami membuat kelompok jembatan, menyoroti bagian jalan yang berada di atas jarak tertentu di atas tanah.  Ini dilakukan dengan menggunakan Ray SOP dengan "jarak titik persimpangan" dihidupkan dan "titik transformasi" dimatikan.  Selanjutnya, untuk membuat kurva siap pakai untuk geometri penutupan, kami menggunakan Polycut untuk memotong persimpangan dan grup jembatan sehingga hanya jalan biasa yang tersisa. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ba6/f23/20e/ba6f2320ee5ef2d21ea175ffd165745d.jpg" alt="gambar"></div><br>  Dan sekarang kita akhirnya mulai membuat jerat nyata.  Subnet yang membuat persimpangan persimpangan adalah versi modifikasi dari tutorial <a href="https://www.youtube.com/watch%3Fv%3DbTlY9ahThdQ">Solving Intersections</a> .  Subnet yang menciptakan geometri jalan juga menutup garis dan menciptakan UV.  Ada <a href="https://www.youtube.com/watch%3Fv%3DPhz3BTwFWRg">tutorial hebat</a> lainnya yang dibuat oleh HoudiniSimon.  Ini memberitahu Anda cara menghasilkan UV untuk menekuk kurva tertutup, tetapi bagian pertama dari tutorial ini dapat diterapkan untuk membuka kurva. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9de/e86/dc7/9dee86dc7cebd4307bc8f1fb36788729.jpg" alt="gambar"></div><br>  Lalu saya baru saja membuat beberapa grup untuk menerapkan materi untuk menggunakan atribut roadPreset yang diambil dari kurva saya di Unity. <br><br>  Selanjutnya kita buat geometri jembatan.  Jaringan yang ditunjukkan di bawah ini secara iteratif melewati semua kelompok jembatan yang sebelumnya dibuat dan, tergantung pada ketinggian di atas tanah, panjang dan tortuositas, menyisipkan jembatan massal atau melengkung.  Saya akan melihat cara membuat jembatan lengkung dalam tutorial terpisah, dan jembatan massal menggunakan SOP Gamedev Sweep Geometry yang sangat baik dengan kelompok mulai dan akhir yang disertakan untuk menutup geometri jembatan yang sebelumnya dibuat di sepanjang kurva jembatan. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ecb/3a9/a4a/ecb3a9a4a4adc5850a5c9cd034e5a53d.jpg" alt="gambar"></div><br>  Hasil: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ba/97d/2a2/3ba97d2a271417b4c9cc04770b582e82.jpg" alt="gambar"></div><br>  Jaring jembatan ini terdiri dari bagian awal / akhir / tengah yang dimodelkan secara manual, dapat dideformasi dan diduplikasi sepanjang kurva menggunakan Gamedev Sweep Geometry SOP.  Seperti apa bentuk geometri dan grup yang dibuat secara manual: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/374/c63/31a/374c6331ab3ede724c1ee021e764b4af.jpg" alt="gambar"></div><br>  Grup pusat dipilih, dan ujung-ujungnya berada di bridgeStart dan kelompok bridgeEnd, yang digunakan oleh simpul penutupan geometri. <br><br>  Kami menyelesaikan jembatan dengan mengekstruksinya sedikit untuk membuat tanggul jalan di mana tekstur kerikil akan diterapkan;  Beberapa variabel Boolean juga ditetapkan untuk persimpangan jenis jalan tertentu.  Misalnya, jika jalan tanah bersilangan dengan jalan raya, maka jalan itu terpotong. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/757/b56/51f/757b5651fb3f61f8fdc2c599681f889a.jpg" alt="gambar"></div><br>  Pada akhirnya, kami menyimpan semua geometri untuk digunakan di Unity dan di alat Houdini tambahan.  Kami membagi jerat jalan menjadi fragmen yang lebih kecil dan mengekspornya sebagai FBX, dan juga menyimpan data dalam file .bgeo sehingga dapat digunakan nanti. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c14/25f/e51/c1425fe512c31cfd32bea68d374a9b08.jpg" alt="gambar"></div><br>  Dalam Unity: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b17/1ce/5b5/b171ce5b56dd71d8d3f548443516c6b6.jpg" alt="gambar"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ef/78f/21d/2ef78f21d1d1fd203549938d5e855cad.jpg" alt="gambar"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/568/18c/687/56818c687d0b46587a12baae541c25aa.jpg" alt="gambar"></div><br>  Saya harap Anda menikmati deskripsi singkat ini tentang proses pembuatan geometri jalan Houdini kami.  Pada posting berikutnya saya akan berbicara tentang membuat marka jalan dan meratakan medan sehingga lebih cocok dengan jalan. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id478516/">https://habr.com/ru/post/id478516/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id478500/index.html">Mengapa ada begitu sedikit konferensi di musim panas?</a></li>
<li><a href="../id478502/index.html">Teknologi pintar untuk semua orang</a></li>
<li><a href="../id478504/index.html">Bagaimana tempat kerja berubah dengan evolusi laptop</a></li>
<li><a href="../id478510/index.html">Kami mengundang Anda ke DINS QA EVENING 12/12/19: kami membuat Jenkins Pipeline dan belajar cara memparalelkan peluncuran tes dengan bantuan mereka</a></li>
<li><a href="../id478514/index.html">Menggunakan data terenkripsi untuk pembelajaran mesin tanpa mendekripsi</a></li>
<li><a href="../id478518/index.html">Pengalaman menggunakan infrastruktur kantor di Zextras / Zimbra OSE</a></li>
<li><a href="../id478522/index.html">Akui saja, Watson, apakah Anda benar-benar bingung?</a></li>
<li><a href="../id478526/index.html">Banyak OpenVPN di Windows Server dan Mikrotik dengan migrasi barang ini ke Linux</a></li>
<li><a href="../id478528/index.html">Kesayangan (kisah fantastis)</a></li>
<li><a href="../id478530/index.html">TechnoText-2019: siapa yang menang pada akhirnya dan untuk apa mereka</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>