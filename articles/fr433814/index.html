<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìÉ üë©üèº‚Äçü§ù‚Äçüë®üèΩ üëµüèø Comment faire √©voluer des bases de donn√©es dans Yandex. Cloud sans temps d'arr√™t. Exemple de trois h√¥tes üññüèº ‚öñÔ∏è üòô</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le message a √©t√© pr√©par√© par les membres de l'√©quipe Yandex.Cloud: Ivan Vetkasov - architecte, Leonid Klyuyev - √©diteur 


 R√©cemment, nous avons parl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment faire √©voluer des bases de donn√©es dans Yandex. Cloud sans temps d'arr√™t. Exemple de trois h√¥tes</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/433814/"><h5>  <sub><sup><i>Le message a √©t√© pr√©par√© par les membres de l'√©quipe Yandex.Cloud: Ivan Vetkasov - architecte, Leonid Klyuyev - √©diteur</i></sup></sub> </h5><br><p><img src="https://habrastorage.org/webt/2e/4l/kn/2e4lkn7th9ia7axxyt1gjbb32qg.png" align="right" width="400">  R√©cemment, nous avons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">parl√©</a> de l'architecture de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Yandex.Cloud</a> .  Passons maintenant de la th√©orie √† la pratique.  Il existe plusieurs services dans le cloud pour le contr√¥le automatis√© du SGBD: le service g√©r√© pour ClickHouse, le service g√©r√© pour PostgreSQL et le service g√©r√© pour MongoDB.  Tous sont bas√©s sur une plate-forme et vous permettent de vous concentrer sur la t√¢che de stockage des donn√©es, et non sur l'administration de l'infrastructure.  Mais parfois, il est √©galement important de contr√¥ler les machines virtuelles du cluster.  Par exemple, une t√¢che de mise √† l'√©chelle peut survenir en r√©ponse √† une augmentation ou une diminution de la charge.  Habituellement, ce sc√©nario est l'un des plus longs d'un point de vue pratique.  Aujourd'hui, nous expliquerons comment Yandex.Cloud vous permet d'automatiser des t√¢ches de mise √† l'√©chelle complexes et de vous assurer que la base de donn√©es reste disponible dans le processus de redimensionnement du cluster. </p><br><p><a name="habracut"></a></p><h4>  √ânonc√© du probl√®me </h4><br>  Lors de la cr√©ation d'un cluster de chaque service, l'utilisateur peut d√©terminer le nombre d'h√¥tes de cluster et la zone de disponibilit√© (AZ), qui correspond au centre de donn√©es physique.  Maintenant, Yandex.Cloud utilise trois centres de donn√©es Yandex situ√©s dans la r√©gion centrale de la Russie.  Par cons√©quent, la configuration recommand√©e est le cluster SGBD avec trois h√¥tes - comme √©tant le plus coh√©rent avec les principes de construction d'une architecture √† s√©curit√© int√©gr√©e et r√©sistante aux catastrophes. <br><br>  Imaginez donc une situation o√π la charge sur le cluster SGBD d√©passe les capacit√©s de la base de donn√©es et il est temps d'ajouter des ressources informatiques.  Cela peut √™tre fait √† la fois horizontalement - en ajoutant des h√¥tes au cluster et verticalement - en ajoutant des ressources √† chaque machine du cluster.  Consid√©rez la deuxi√®me option, comme la plus longue et la plus risqu√©e d'erreurs.  Pourquoi cette option est-elle laborieuse?  Parce que dans le cas g√©n√©ral, la proc√©dure d'ajout de ressources ressemblera √† ceci: changez le r√¥le de l'h√¥te;  si n√©cessaire, arr√™tez le SGBD;  √©teignez la machine virtuelle;  changer sa configuration;  nous commen√ßons;  changer les param√®tres du SGBD;  nous d√©marrons un SGBD;  Nous attendons la synchronisation des modifications des donn√©es accumul√©es.  Et donc pour les trois h√¥tes √† tour de r√¥le.  De nombreuses √©tapes - le risque d'erreurs est √©lev√©.  Vous pouvez automatiser ce processus - uniquement avant de d√©marrer, la solution d'automatisation s√©lectionn√©e doit √™tre test√©e.  Habituellement, il n'y a pas assez de temps pour les tests, mais dans Yandex.Cloud, il s'ex√©cute rapidement et sans actions inutiles de votre part.  Commen√ßons. <br><br><h4>  √âtapes pr√©liminaires et processus de test </h4><br><p>  Pour la pr√©paration, nous aurons besoin de: </p><br><ul><li>  Acc√®s √† la plateforme.  D√©sormais, tout le monde peut mettre en place une p√©riode d'essai sur le site Web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur le site Web Yandex.Cloud</a> . </li><li>  Un r√©seau cloud (je l'appellerai testvpc dans mon exemple) et trois sous-r√©seaux situ√©s dans diff√©rents AZ.  Les plages d'adresses de sous-r√©seau dans ce cas ne sont pas importantes. </li><li> H√¥te du bastion.  Malgr√© le fait que dans Yandex.Cloud, vous pouvez ouvrir un acc√®s externe au SGBD via IP publique, la publication d'un SGBD dans le domaine public n'est pas la bonne d√©cision.  Par cons√©quent, nous ajoutons un h√¥te bastion au sch√©ma, √† partir duquel nous ouvrirons des connexions aux h√¥tes.  En tant qu'h√¥te, vous pouvez utiliser une machine avec une utilisation partielle (5%) du noyau.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Clickhouse-client</a> doit √™tre install√© sur la machine virtuelle.  De plus, selon les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">instructions de connexion</a> au service, vous devez t√©l√©charger un certificat SSL. </li><li>  CLI  Nous travaillerons avec Yandex.Cloud non pas via la console, mais via l'utilitaire de ligne de commande, qui doit √©galement √™tre install√© et lanc√© conform√©ment √† la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> . </li></ul><br><p>  Le sc√©nario de test sera simple: ouvrir trois sessions connectant l'h√¥te bastion √† chaque h√¥te du cluster de base de donn√©es, ex√©cuter une requ√™te SQL dans un cycle avec une p√©riode de, disons, 1 seconde, apr√®s quoi nous envoyons une commande pour mettre √† l'√©chelle le cluster et examiner le comportement du syst√®me. </p><br><h4>  Moment de v√©rit√© </h4><br><p>  Choisissez un SGBD pour d√©montrer la mise √† l'√©chelle.  Dans PostgreSQL, les h√¥tes se voient attribuer des r√¥les, mais le service n'a pas encore leur commutation transparente lors de la mise √† l'√©chelle - cette fonctionnalit√© est dans nos plans.  Dans le cas contraire, les m√©canismes d'augmentation et de diminution du cluster sont approximativement les m√™mes dans le cas des trois SGBD, par exemple, prenez ClickHouse. </p><br><p> Cr√©ons un objet d'exp√©rience - un cluster compos√© de trois h√¥tes situ√©s sur diff√©rents sous-r√©seaux virtuels.  Pour ce faire, entrez la commande <br>  <code>yc managed-clickhouse cluster create</code> avec les arguments n√©cessaires.  L'ordre des arguments correspond √† leur liste dans la sortie de ¬´yc --help¬ª.  L'essence de la commande est simple: nous cr√©ons un cluster ch-to-resize dans un environnement de production avec testvpc situ√© sur le r√©seau virtuel, d√©finissons un nom et un mot de passe, 10 gigaoctets d'espace disque et la classe minimale s1.nano.  Les caract√©ristiques suivantes correspondent √† cette classe: 1 CPU, 4 Go de RAM.  √Ä l'avenir, pour la mise √† l'√©chelle, nous passerons √† la classe s1.micro, de sorte que le nombre de CPU et de RAM double.  Pour savoir quelles autres classes d'h√¥tes vous pouvez attribuer, entrez simplement la commande <br>  <code>yc managed-clickhouse resource-preset list</code> . </p><br><p>  Ainsi, la commande pour cr√©er le cluster doit √™tre la suivante: </p><br><pre> <code class="plaintext hljs">yc managed-clickhouse cluster create --name ch-to-resize --environment production --network-name testvpc --host zone-id=ru-central1-a,subnet-id=e9bfnjacigdo9p6j7j2s,assign-public-ip=false,type=clickhouse --host zone-id=ru-central1-b,subnet-id=e2l8iamol3b9mrtskb8q,assign-public-ip=false,type=clickhouse --host zone-id=ru-central1-c,subnet-id=b0c6qit7u9e8r0egedvj,assign-public-ip=false,type=clickhouse --user name=test,password=test123123 --database name=testdb --clickhouse-disk-size 10 --clickhouse-resource-preset s1.nano --clickhouse-disk-type network-nvme ‚Äìasync</code> </pre> <br><p>  En r√©ponse, nous obtenons l'ID du cluster et une liste des noms d'h√¥tes de ses h√¥tes: </p><br><pre> <code class="plaintext hljs">yc managed-clickhouse cluster list +----------------------+--------------+-----------------------------+--------+---------+ | ID | NAME | CREATED AT | HEALTH | STATUS | +----------------------+--------------+-----------------------------+--------+---------+ | c9q7cr4ji2fe462qej8p | ch-to-resize | 2018-12-10T08:59:09.100272Z | ALIVE | RUNNING | +----------------------+--------------+-----------------------------+--------+---------+ yc managed-clickhouse host list --cluster-id c9q7cr4ji2fe462qej8p +-------------------------------------------+----------------------+---------+---------------+ | NAME | CLUSTER ID | HEALTH | ZONE ID | +-------------------------------------------+----------------------+---------+---------------+ | rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | ALIVE | ru-central1-a | | rc1a-sgxazra54xv6lhni.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | UNKNOWN | ru-central1-a | | rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | ALIVE | ru-central1-b | | rc1b-j1rtvsuz6t8x6ev2.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | UNKNOWN | ru-central1-b | | rc1c-emo0f2990povj7ie.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | UNKNOWN | ru-central1-c | | rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | ALIVE | ru-central1-c | +-------------------------------------------+----------------------+---------+---------------+</code> </pre> <br><p>  Ouvrons une connexion √† chaque h√¥te et ex√©cutons une requ√™te sur la base de donn√©es: </p><br><pre> <code class="plaintext hljs">clickhouse-client --host rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net --secure --user test --password test123123 --database testdb --port 9440 -q "select concat(host_name, ' is alive\!') from system.clusters where replica_num = 1" clickhouse-client --host rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net --secure --user test --password test123123 --database testdb --port 9440 -q "select concat(host_name, ' is alive!') from system.clusters where replica_num = 2" clickhouse-client --host rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net --secure --user test --password test123123 --database testdb --port 9440 -q "select concat(host_name, ' is alive\!') from system.clusters where replica_num = 3"</code> </pre> <br><p>  Enfin, envoyez une demande pour augmenter le cluster: </p><br><pre> <code class="plaintext hljs">yc managed-clickhouse cluster update --id c9q7cr4ji2fe462qej8p --clickhouse-resource-preset s1.micro -‚Äìasync</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Explication de la r√©duction de cluster</b> <div class="spoiler_text"><p>  Si nous voulons r√©duire, plut√¥t que d'augmenter la quantit√© de ressources, nous devons sp√©cifier une classe plus petite, en se r√©f√©rant √† la sortie <br>  <code>yc managed-clickhouse resource-preset list</code> - par exemple, s1.nano.  Dans le m√™me temps, la structure de l'√©quipe elle-m√™me reste la m√™me. </p></div></div><br><p>  J'ai redirig√© la sortie de la requ√™te vers un fichier.  Voici une liste abr√©g√©e: </p><br><pre> <code class="plaintext hljs">rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net Mon Dec 10 12:47:35 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:47:36 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:47:37 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:47:38 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:47:39 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:47:40 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.7:9440: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:47:51 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.7:9440: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:02 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.7:9440: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:11 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:12 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:13 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:14 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:15 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:16 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:17 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:18 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:48:19 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:48:20 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net: Mon Dec 10 12:50:58 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! Mon Dec 10 12:50:59 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! Mon Dec 10 12:51:00 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! Mon Dec 10 12:51:01 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.6:9440: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:12 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.6:9440: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:23 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.6:9440: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:34 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.6:9440: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:35 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:36 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:37 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:38 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:39 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:40 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:41 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:42 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:43 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:44 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! Mon Dec 10 12:51:45 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! Mon Dec 10 12:51:46 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net: Mon Dec 10 12:49:15 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:49:16 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:49:17 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:49:18 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:49:19 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.8:9440: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:30 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.8:9440: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:41 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.8:9440: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:52 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.8:9440: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:56 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:57 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:58 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:59 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:50:00 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:50:01 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:50:03 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:50:04 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:50:05 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:50:06 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:50:07 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive!</code> </pre> <br><p>  La liste affiche les moments o√π chaque h√¥te du cluster est d√©sactiv√© (lorsque le d√©lai de connexion commence), les moments o√π l'h√¥te est activ√© et ClickHouse commence √† se charger (lorsque la connexion est refus√©e), ainsi que les moments o√π l'h√¥te redevient op√©rationnel.  La chose la plus importante est la s√©paration des p√©riodes o√π les h√¥tes n'√©taient pas disponibles.  Pendant la mise √† l'√©chelle, au moins deux h√¥tes √©taient disponibles pour l'ex√©cution des requ√™tes.  Cela peut √™tre vu dans le graphique: </p><br><p><img src="https://habrastorage.org/webt/xg/u4/un/xgu4unmb8rsxd5sa2qhkr8ozy4s.png" alt="image"></p><br><h4>  Conclusions et meilleures pratiques </h4><br><p>  √Ä premi√®re vue, le d√©veloppement de projets avec des bases de donn√©es comprend une grande quantit√© de travail de routine.  La base de donn√©es doit √™tre maintenue, c'est-√†-dire pour cr√©er des copies de sauvegarde, pour √©tablir le processus de mises √† jour r√©guli√®res du SGBD, etc.  Cependant, dans un environnement de production r√©el, il est utile que les syst√®mes soient non seulement g√©rables du point de vue du service, mais √©galement flexibles - sensibles aux charges montantes et descendantes.  Nous avons expliqu√© comment augmenter les performances de la base de donn√©es dans Yandex.Cloud, tout en maintenant la capacit√© de travail du projet pour les utilisateurs.  Si la base de donn√©es est configur√©e correctement, l'augmentation du trafic entra√Æne une augmentation de la quantit√© de ressources disponibles et une r√©cession - une diminution multiple, ce qui r√©duit √©galement vos co√ªts. </p><br><hr><br><p>  <em>Quelles approches, outils ou technologies bas√©s sur le cloud aimeriez-vous d√©couvrir?</em>  <em>Sugg√©rez des sujets dans les commentaires pour les articles Yandex.Cloud suivants.</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr433814/">https://habr.com/ru/post/fr433814/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr433802/index.html">Comment et pourquoi nous avons remport√© la piste Big Data au Urban Tech Challenge Hackathon</a></li>
<li><a href="../fr433804/index.html">R√©seaux de densit√© de m√©lange</a></li>
<li><a href="../fr433806/index.html">Quand l'archive en ligne oublie</a></li>
<li><a href="../fr433808/index.html">5 erreurs les plus courantes commises par les programmeurs lors de l'entretien</a></li>
<li><a href="../fr433810/index.html">Une approche orient√©e probl√®me des projets de marketing Internet</a></li>
<li><a href="../fr433816/index.html">O√π publier l'application mobile</a></li>
<li><a href="../fr433818/index.html">Compiler et ex√©cuter C # et Blazor dans un navigateur</a></li>
<li><a href="../fr433820/index.html">Proposition ECMAScript: Array.prototype. {Flat, flatMap}</a></li>
<li><a href="../fr433822/index.html">Guide CMake complet. Troisi√®me partie: essais et emballage</a></li>
<li><a href="../fr433824/index.html">Habro suicide. Pourquoi les programmeurs 1C sauveront le monde</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>