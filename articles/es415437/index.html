<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>游깮 游놋游낕 游땕 C칩mo lanzar ML en prod: seis rastrillos que pisamos 游둟游낖 游깱 游뱝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="M치s recientemente, buscamos un cient칤fico de datos en el equipo (y encontramos: 춰hola, nik_son y Arseny!). Mientras hablamos con los candidatos, nos d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C칩mo lanzar ML en prod: seis rastrillos que pisamos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hh/blog/415437/">  M치s recientemente, buscamos un cient칤fico de datos en el equipo (y encontramos: 춰hola, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">nik_son</a> y Arseny!).  Mientras hablamos con los candidatos, nos dimos cuenta de que muchas personas quieren cambiar sus trabajos porque est치n haciendo algo "en la mesa". <br><br>  Por ejemplo, asumen el pron칩stico complejo que propuso el jefe, pero el proyecto se detiene porque la empresa no comprende qu칠 y c칩mo incluir en la producci칩n, c칩mo obtener ganancias, c칩mo "recuperar" los recursos gastados en el nuevo modelo. <br><br><img src="https://habrastorage.org/webt/ok/et/et/oketet2tebg0tlbjkbrqimzn92g.jpeg"><br><br>  HeadHunter no tiene una gran potencia inform치tica, como Yandex o Google.  Entendemos lo dif칤cil que es poner ML complejo en producci칩n.  Por lo tanto, muchas compa침칤as piensan en el hecho de que los modelos lineales m치s simples se est치n introduciendo en la producci칩n. <br><br>  En el proceso de la pr칩xima implementaci칩n de ML en el sistema de recomendaci칩n y en la b칰squeda de vacantes, encontramos una serie de "rastrillos" cl치sicos.  Preste atenci칩n a ellos si tiene la intenci칩n de implementar ML en casa: tal vez esta lista lo ayudar치 a no seguirlos <s>y encontrar su propio rastrillo personal</s> . <br><a name="habracut"></a><br><h2>  Rastrillo No. 1: Cient칤fico de datos - Artista libre </h2><br>  En cada empresa que comienza a introducir el aprendizaje autom치tico, incluidas las redes neuronales, en su trabajo, existe una brecha entre lo que el cient칤fico de datos quiere hacer y lo que beneficia a la producci칩n.  Incluso porque el negocio no siempre puede explicar qu칠 beneficio es y c칩mo puede ayudar. <br><br>  Nos ocupamos de esto de la siguiente manera: discutimos todas las ideas emergentes, pero solo implementamos lo que beneficiar치 a la empresa, ahora o en el futuro.  No investigamos en el vac칤o. <br><br>  Despu칠s de cada implementaci칩n o experimento, consideramos la calidad, los recursos y los efectos econ칩micos y actualizamos nuestros planes. <br><br><h2>  Rastrillo n칰mero 2: actualizaci칩n de bibliotecas </h2><br>  Este problema ocurre en muchos.  Aparecen muchas bibliotecas nuevas y convenientes de las que nadie hab칤a o칤do hablar hace un par de a침os, o ninguna.  Me gustar칤a usar las 칰ltimas bibliotecas, porque son m치s convenientes. <br><br>  Pero hay varios obst치culos: <br><br>  1. Si el producto usa, por ejemplo, el decimocuarto Ubuntu, lo m치s probable es que simplemente no haya nuevas bibliotecas en 칠l.  La soluci칩n es transferir el servicio a Docker e instalar las bibliotecas de Python usando pip (en lugar de paquetes deb). <br><br>  2. Si se utiliza un formato dependiente del c칩digo para el almacenamiento de datos (como pickle), esto congela las bibliotecas utilizadas.  Es decir, cuando el modelo de aprendizaje autom치tico se obtuvo utilizando la biblioteca scikit-learn versi칩n 15 y se guard칩 en formato pickle, entonces para la recuperaci칩n correcta del modelo, se necesitar치 la biblioteca de quince versiones scikit-learn.  No puede actualizar a la 칰ltima versi칩n, y esta es una trampa mucho m치s insidiosa que la descrita en el p치rrafo 1. <br><br>  Hay dos formas de salir de esto: <br><br><ul><li>  Utilice un formato independiente del c칩digo para almacenar modelos. </li><li>  Siempre podr치 volver a entrenar cualquier modelo.  Luego, al actualizar la biblioteca, ser치 necesario entrenar todos los modelos y guardarlos con la nueva versi칩n de la biblioteca. </li></ul><br>  Hemos elegido el segundo camino. <br><br><h2>  Rastrillo n칰mero 3: trabajar con modelos antiguos </h2><br>  Hacer algo nuevo en un modelo antiguo y aprendido es menos 칰til que hacer algo simple en uno nuevo.  A menudo, al final resulta que la introducci칩n de modelos m치s simples pero m치s frescos es m치s 칰til, y la cantidad de esfuerzo es menor.  Es importante recordar esto y siempre tener en cuenta la cantidad de esfuerzos comunes en la b칰squeda de patrones. <br><br><h2>  Rastrillo n칰mero 4: solo experimentos locales </h2><br>  A muchos expertos en ciencia de datos les gusta experimentar localmente en sus servidores de aprendizaje autom치tico.  Solo los productos no tienen tanta flexibilidad: como resultado, se revelan muchas razones por las cuales es imposible arrastrar estos experimentos a la producci칩n. <br><br>  Es importante configurar la comunicaci칩n entre el especialista de DS y los ingenieros de ventas para una comprensi칩n com칰n: c칩mo funcionar치 este o aquel modelo en la producci칩n, si existe la potencia y la capacidad f칤sica necesarias para implementarlo.  Adem치s, cuanto m치s complejos son los modelos y los factores, m치s dif칤cil es hacerlos confiables y poder capacitarlos nuevamente en cualquier momento.  A diferencia de las competencias de Kaggle, en la producci칩n a menudo es mejor sacrificar diez mil칠simas en m칠tricas locales e incluso un peque침o KPI en l칤nea, pero implementar la versi칩n de modelos es mucho m치s simple, estable en resultados y f치cil en recursos inform치ticos. <br><br>  La copropiedad del c칩digo (los desarrolladores y los cient칤ficos de datos saben c칩mo funciona el c칩digo escrito por otros desarrolladores), la reutilizaci칩n de signos y metaatributos en varios modelos tanto en el proceso de aprendizaje como cuando se trabaja en productos (nos ayuda us framework), unit-and autotests, que manejamos muy a menudo, integraci칩n de c칩digo con retesting.  Ponemos los modelos finales en repositorios git y tambi칠n los usamos en producci칩n. <br><br><h2>  Rastrillo n칰mero 5: prueba solo prod </h2><br>  Cada uno de nuestros desarrolladores y cient칤ficos de datos tiene su propio banco de pruebas, a veces no uno.  Los componentes principales de la producci칩n HH se implementan en 칠l.  Es costoso, pero paga por la calidad y la velocidad de desarrollo.  Es necesario, pero no suficiente.  No solo cargamos los modelos que ya est치n en producci칩n, sino tambi칠n los que estar치n all칤 pronto.  Esto ayuda a comprender a tiempo que los modelos que funcionan perfectamente en m치quinas locales, bancos de prueba o en producci칩n para el 5% de los usuarios, y cuando se encienden al 100%, son demasiado pesados. <br><br>  Usamos varias etapas de prueba.  Verificamos el c칩digo muy r치pidamente (este es el punto clave): al agregar o cambiar componentes en el repositorio, el c칩digo se recopila, la unidad y las pruebas autom치ticas se ejecutan en los componentes correspondientes, si es necesario, tambi칠n los volvemos a probar manualmente, y si algo est치 mal, responda "El tuyo est치 roto, decide." <br><br><h2>  Rastrillo n칰mero 6: c치lculos largos y p칠rdida de enfoque </h2><br>  Si un modelo requiere, por ejemplo, una semana para entrenar, es f치cil perder la concentraci칩n en la tarea debido al cambio a otro proyecto.  Intentamos no dar a los desarrolladores y cient칤ficos de datos m치s de dos tareas en una mano.  Y no m치s de uno urgente para que pueda cambiar a 칠l tan pronto como se completen los c치lculos o experimentos A / B.  Esta regla es necesaria para no perder el enfoque y por temor a que algunas de estas tareas generalmente corran el riesgo de perderse, y otra parte que se implementa mucho m치s tarde de lo necesario. <br><br><h2>  Pisamos un rastrillo pero no nos rendimos </h2><br>  Recientemente completamos un experimento sobre la introducci칩n de redes neuronales en un sistema de recomendaci칩n.  Comenz칩 con el hecho de que en dos d칤as el hackathon interno escribi칩 un modelo para pronosticar las respuestas por curr칤culum, lo que facilit칩 enormemente la b칰squeda de vacantes adecuadas. <br><br>  Pero m치s tarde aprendimos: para ponerlo en producci칩n, debe actualizar casi todo, por ejemplo, transferir el sistema de doble uso, que considera signos y ense침a modelos, a Docker, as칤 como actualizar las bibliotecas de aprendizaje autom치tico. <br><br><h3>  Como fue </h3><br>  Utilizamos el modelo DSSM con una red neuronal de una sola capa.  En el art칤culo original de Microsoft, se utiliz칩 una red neuronal de tres capas, pero no observamos mejoras de calidad con un aumento en el n칰mero de capas, por lo que nos decidimos por una capa. <br><br><img src="https://habrastorage.org/webt/ti/au/qj/tiauqjuapnwvgews3dvymzhqir8.jpeg"><br><br>  En resumen: <br><br><ol><li>  El texto de la consulta y el encabezado de la vacante se convierten en dos vectores trigrama de s칤mbolos.  Usamos 20,000 trigramas de caracteres. </li><li>  El vector trigrama se alimenta a la entrada de una red neuronal de capa 칰nica.  En la entrada de la capa de red neuronal, hay 20,000 n칰meros, en la salida, 64. Esencialmente, la red neuronal es una matriz de 20,000 x 64 por la cual se multiplica el vector trigrama de entrada de dimensi칩n 1 x 20 000. Se agrega un vector constante de dimensi칩n 1 x 64 al resultado de multiplicaci칩n. La salida de dicha red neuronal corresponde a la solicitud (o el t칤tulo de la vacante). </li><li>  Se calcula el producto escalar del vector dssm de consulta y el vector dssm del encabezado de vacante.  La funci칩n sigmoidea se aplica al trabajo.  El resultado final es el meta-signo dssm. </li></ol><br>  Cuando intentamos incluir este modelo por primera vez, las m칠tricas locales mejoraron, pero cuando intentamos incluirlo en la prueba A / B, vimos que no hab칤a ninguna mejora. <br><br>  Despu칠s de eso, tratamos de aumentar la segunda capa de neuronas a 256, desplegada por el 5% de los usuarios: result칩 que el sistema de recomendaci칩n y la b칰squeda mejoraron, pero cuando activ칩 el modelo al 100%, de repente result칩 que era demasiado pesado. <br><br>  Analizamos por qu칠 el modelo es tan pesado, eliminamos la derivaci칩n y volvimos a experimentar con esta red neuronal.  Y solo despu칠s de eso, habiendo recorrido todo el camino nuevamente, descubrieron que el modelo es 칰til: el n칰mero de respuestas en el sistema de recomendaciones aument칩 en 700 por d칤a, y en la b칰squeda, despu칠s de todos los recuentos, en 4200. <br><br>  La introducci칩n de una red neuronal tan poco compleja permite a nuestros clientes contratar a varias docenas de empleados adicionales todos los d칤as a trav칠s de hh.ru, y durante la implementaci칩n hemos derrotado a una parte importante de los grandes problemas.  Por lo tanto, planeamos desarrollar nuestras redes neuronales a칰n m치s.  Los planes son intentar la derivaci칩n general, la lematizaci칩n adicional, procesar los textos completos de la vacante y reanudar, realizar experimentos con la topolog칤a (capas ocultas y, posiblemente, RNN / LSTM). <br><br>  Lo m치s importante que hemos hecho con este modelo: <br><br><ul><li>  No deje caer el experimento en el medio. </li><li>  Calculamos los indicadores de aumento de la respuesta y descubrimos que el trabajo en este modelo vali칩 la pena.  Es muy importante comprender cu치nto beneficio aporta cada implementaci칩n. </li></ul><br>  Curiosamente, el modelo que hicimos y finalmente agregamos al producto es muy similar al m칠todo del componente principal (PCA) aplicado a la matriz [texto de la consulta, t칤tulo del documento, si hubo un clic].  Es decir, a una matriz en la que una fila corresponde a una consulta 칰nica, una columna a un encabezado de vacante 칰nico;  el valor en la celda es 1 si despu칠s de esta solicitud el usuario hizo clic en una vacante con este encabezado y 0 si no hubo clic. <br><br>  Los resultados de la aplicaci칩n de este modelo a las solicitudes de scala, java, C #, "abogado", "abogado" se encuentran en la tabla a continuaci칩n.  Los pares de consultas de significado similar se resaltan en la oscuridad, a diferencia de la luz.  Se puede ver que el modelo comprende la conexi칩n entre diferentes lenguajes de programaci칩n, hay una fuerte conexi칩n entre la solicitud "abogado" y "abogado".  Pero entre el "abogado" y cualquier lenguaje de programaci칩n, la conexi칩n es muy d칠bil. <br><img src="https://habrastorage.org/webt/wi/xl/bq/wixlbqi7eg_kdq5zirst9grmi7u.png"><br>  En alg칰n momento, realmente quiero rendirme: los experimentos contin칰an, pero no se est치n "encendiendo".  En este punto, un cient칤fico de datos puede encontrar 칰til apoyar al equipo y una vez m치s calcular los beneficios: puede valer la pena "enterrar a la azafata" y no tratar de "montar el caballo muerto", esto no es un fracaso, sino un experimento exitoso con un resultado negativo.  O, despu칠s de sopesar los pros y los contras, realizar치 otro experimento que "disparar치".  Entonces nos pas칩 a nosotros. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es415437/">https://habr.com/ru/post/es415437/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es415427/index.html">Toda la verdad sobre RTOS de Colin Walls. Art칤culo # 4. Tareas, cambio de contexto e interrupciones</a></li>
<li><a href="../es415429/index.html">Toda la verdad sobre RTOS de Colin Walls. Art칤culo # 5. Interacci칩n de tareas y sincronizaci칩n</a></li>
<li><a href="../es415431/index.html">Anuncio de Hackathon SmartMail Hack 2: Llamada de datos</a></li>
<li><a href="../es415433/index.html">Gesti칩n de lanzamientos de viviendas y servicios comunitarios de SIG: compartimos experiencia y luchamos con intuici칩n</a></li>
<li><a href="../es415435/index.html">Desarrollo de tarjetas de interfaz en Soil Xilinx Zynq 7000 para grabaci칩n de voz en formato anal칩gico y digital</a></li>
<li><a href="../es415439/index.html">쯃a comunicaci칩n corporativa te obliga a abandonar o arrastrarte a un proyecto como un juego?</a></li>
<li><a href="../es415441/index.html">Los ataques de ransomware contra agencias gubernamentales est치n creciendo en los EE. UU.</a></li>
<li><a href="../es415443/index.html">MDG e ITMO University invitan a la Escuela de Verano de Machine Learning</a></li>
<li><a href="../es415445/index.html">El resumen de eventos para profesionales de recursos humanos en el campo de TI para julio de 2018</a></li>
<li><a href="../es415447/index.html">El lanzamiento del token de utilidad es un callej칩n sin salida</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>