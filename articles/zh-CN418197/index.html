<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💳 👨‍✈️ 😨 麻省理工学院的课程“计算机系统安全”。 讲座4：“共享特权”，第2部分 🏀 💀 🍛</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="麻省理工学院。 讲座课程＃6.858。 “计算机系统的安全性。” Nikolai Zeldovich，James Mickens。 2014年 
 计算机系统安全是一门有关开发和实施安全计算机系统的课程。 讲座涵盖了威胁模型，危害安全性的攻击以及基于最新科学研究的安全技术。 主题包括操作系统（OS）...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>麻省理工学院的课程“计算机系统安全”。 讲座4：“共享特权”，第2部分</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/418197/"><h3> 麻省理工学院。 讲座课程＃6.858。  “计算机系统的安全性。”  Nikolai Zeldovich，James Mickens。  2014年 </h3><br> 计算机系统安全是一门有关开发和实施安全计算机系统的课程。 讲座涵盖了威胁模型，危害安全性的攻击以及基于最新科学研究的安全技术。 主题包括操作系统（OS）安全性，功能，信息流管理，语言安全性，网络协议，硬件安全性和Web应用程序安全性。 <br><br> 第1课：“简介：威胁模型” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第3部分</a> <br> 第2课：“控制黑客攻击”， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第3部分</a> <br> 第3讲：“缓冲区溢出：漏洞利用和保护” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第3部分</a> <br> 讲座4：“特权分离”， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第3部分</a> <a name="habracut"></a><br><br> 那么，这个清单上还有什么呢？ 流程。 记忆是与过程同时发生的事情。 因此，如果您不在此过程中，则无法访问其内存。 虚拟内存为我们完美地增强了这种隔离。 此外，如果您具有相同的用户ID，则调试机制可让您“弹出”另一个进程的内存 <br><br> 接下来，我们有了网络。  <b>Unix中的</b>网络与上述模型不太对应，部分原因是首先开发了<b>Unix</b>操作系统，然后出现了网络，这一网络很快流行起来。 它的规则集略有不同。 因此，如果您管理网络，我们真正需要注意的操作就是将某人连接到网络，或者如果您充当服务器，则要侦听某个端口。 您可能需要在此连接上读取或写入数据，或者发送和接收<b>原始</b>数据包。 <br><br><img src="https://habrastorage.org/webt/dw/gn/zv/dwgnzva6txwuj_esllvdnx3uexg.jpeg"><br><br> 因此， <b>Unix</b>上的网络大多与<b>userid</b>无关。 规则是，任何人都可以始终连接到任何计算机或IP地址或打开连接。 如果要在端口上侦听，则在这种情况下有一个区别，那就是大多数用户都被禁止侦听小于“魔术值” 1024的数字的端口。原则上，您可以侦听此类端口，但是在这种情况下，您应该成为特殊用户，称为<b>uid = 0的</b> <b>“超级用户”</b> 。 <br><br> 通常，在Unix中存在管理员或超级用户的概念，由标识符uid = 0表示，它可以绕过几乎所有这些检查，因此如果使用root权限，则可以读写文件，更改对它们的访问权限。 操作系统将允许您执行此操作，因为它认为您应该拥有所有特权。 而且，您真的需要这样的特权才能监听编号小于1024的端口。您如何看待这种奇怪的限制？ <br><br>  <b>受众群体：</b>它标识特定连接的特定端口号，例如端口80上的<b>http</b> 。 <br><br>  <b>教授：</b>是的，默认情况下， <b>HTTP协议</b>使用端口80。另一方面，其他服务可以使用端口号大于1024的端口，为什么需要此限制？ 这里有什么用？ <br><br>  <b>受众：</b>因为您不希望任何人无意间听到您的<b>HTTP</b> 。 <br><br>  <b>教授：</b>是的。 我认为这样做的原因是您曾经在同一台计算机上有许多用户。 他们使用登录名登录并启动了他们的应用程序，因此您想确保某些随机用户登录到计算机后将无法控制在其上运行的Web服务器。 因为从外部连接的用户不知道该端口上的用户，他们只是连接到端口80。如果我要进入此计算机并启动自己的Web服务器，则只需将所有Web服务器流量传输到这辆车。 这可能不是一个很好的计划，但这是Unix网络子系统阻止随机用户控制在这些低端口号上运行的已知服务的方式。 这就是这种限制的理由。 <br><br><img src="https://habrastorage.org/webt/ba/0o/qn/ba0oqn2qgabud4-_hmizsks086s.jpeg"><br><br> 另外，从读取和写入连接数据的角度来看，如果您有用于特定套接字的描述符文件，那么<b>Unix</b>将允许您在此<b>TCP</b>或<b>uTP连接中</b>读取和写入任何数据。 在发送<b>原始</b>数据包时， <b>Unix</b>表现得像一个偏执狂，因此它不会让您通过网络发送任意数据包。 这应该在特殊连接的范围内，除非您拥有<b>root（即</b>权利），并且您可以做任何您想做的事情。 <br><br> 因此，您可能要问的一个有趣的问题是所有这些<b>用户ID</b>都来自哪里？ <br><br> 我们正在谈论具有<b>userid</b>或<b>groupid的</b>进程。 在计算机上启动<b>PS</b>时，您肯定会看到一系列具有不同<b>uid</b>值的进程。 他们来自哪里？ <br><br> 我们需要某种机制来加载所有这些<b>用户ID</b>值。  <b>Unix</b>有几个为此设计的系统调用。 因此，要引导这些标识符值，有一个名为<b>setuid（uid）</b>的函数，因此您可以将一些当前进程的<b>uid</b>号分配给该值。 与<b>Unix</b>传统中的所有其他方法一样，这实际上是一种危险的操作，因为只有在<b>uid = 0的情况下</b>才能执行此操作。 无论如何，应该是这样。 <br><br> 因此，如果您是具有root用户权限且<b>uid = 0的用户</b> ，则可以调用<b>setuid（uid）</b>并将用户切换到任何进程。 还有两个其他类似的系统调用，用于初始化与进程相关的<b>gid</b> ： <b>setgid</b>和<b>setgroups</b> 。 因此，这些系统调用使您可以配置进程特权。 <br><br><img src="https://habrastorage.org/webt/qs/6m/bk/qs6mbkc520bn-n_vlpznivx1z0q.jpeg"><br><br> 当您登录<b>Unix</b>机器时，您的进程将获得正确的访问权限这一事实不会发生，因为您与进程具有相同的<b>ID</b> ，因为系统尚不知道您是谁。 相反，在<b>Unix上，</b>当<b>SSH</b>安全Shell <b>协议</b>为连接到计算机并尝试对用户进行身份验证的任何人启动该过程时<b>，</b>会有某种登录过程。 <br><br> 因此，对于具有root用户权限的用户，此登录过程最初以<b>uid = 0</b>开始，然后，当他收到特定的用户名和密码时，他在自己的帐户数据库中对其进行检查。 通常，在<b>Unix上，</b>此数据存储在两个文件中： <b>/ etc / password</b> （出于历史原因，密码不再存储在此文件中）和<b>/ etc / shadow</b>文件中，其中存储了密码。 但是， <b>/ etc / password</b>文件中有一个表，该表将系统中的每个用户名显示为整数值。 <br><br> 因此，您的用户名映射到该<b>/ etc / password</b>文件中的特定整数，然后登录过程根据此文件检查您的密码是否正确。 如果找到整数<b>uid</b> ，则将<b>setuid</b>函数设置为该<b>uid</b>值，并使用<b>exec</b>命令<b>（/ bin / sh）</b>启动shell。 现在您可以与外壳进行交互，但是它可以在您的<b>uid</b>下工作，因此您将不会对本机造成意外损坏。 <br><br><img src="https://habrastorage.org/webt/oa/vi/t8/oavit8bjjn_skjz8-n1k5dhc6co.jpeg"><br><br>  <b>受众：</b>如果您的<b>uid</b>并非真正<b>为0，</b>是否可以使用<b>uid = 0</b>启动新进程？ <br><br>  <b>教授：</b>如果您具有root特权，则可以将自己限制为另一个<b>uid</b> ，降低您的权限，但是在任何情况下，您都可以创建一个仅具有与您相同的<b>uid</b>的进程。 但是由于种种原因，您可能想增加特权。 假设您需要安装一个需要<b>root</b>特权的软件包。 <br><br> 在<b>Unix</b>上有两种设置特权的方法。 我们已经提到的一个是文件描述符。 因此，如果您确实想增加特权，则可以与具有root权限的工作人员交谈，并请他为您打开此文件。 或者，您需要安装一些新界面，然后此助手会为您打开一个文件，并使用<b>fd</b> transfer向您返回文件描述符。 这是增加特权的一种方法，但是它不方便，因为在某些情况下，有些进程运行着大量特权。 为此， <b>Unix</b>具有一种聪明但同时存在问题的机制，称为<b>“ setuid二进制文件”</b> 。 该机制是<b>Unix</b>文件系统上的常规可执行文件，但在<b>setuid</b>二进制文件上运行<b>exec</b>时除外，例如，大多数计算机上的<b>/ bin / su</b>或启动时的<b>sudo</b> 。 <br><br> 典型的<b>Unix</b>系统具有一堆<b>setuid</b>二进制文件。 区别在于，当您执行这些二进制文件之一时，实际上会将进程的<b>用户标识</b>切换为该二进制文件的所有者。 当您第一次看到该机制时，它似乎很奇怪。 通常，使用它的方式是该“二进制”很可能具有所有者<b>uid为</b> 0，因为您确实要还原许多特权。 <br><br><img src="https://habrastorage.org/webt/zt/s5/8d/zts58db83nchnbo1a6qqobpbpuw.jpeg"><br><br> 您想要恢复超级用户权限，以便可以运行此<b>su</b>命令，并且内核在执行此二进制文件时会将进程<b>uid</b>切换为0，以便该程序现在可以执行某些特权操作。 <br><br>  <b>受众：</b>如果您的<b>uid = 0，</b>并且<b>将</b>所有这些<b>setuid</b>二进制文件的<b>uid</b>更改为0以外的值，可以恢复特权吗？ <br><br>  <b>教授：</b>不，降低访问级别时，许多进程将无法还原特权，因此您可能会陷入困境。 该机制不依赖于<b>uid = 0</b> 。 像<b>Unix</b>系统的任何用户一样，您可以创建任何二进制文件，构建程序，对其进行编译，并将此<b>setuid</b>位设置为程序本身。 它属于您，用户，您的用户ID。 这意味着任何运行您的程序的人都将使用您的用户ID运行此代码。 这有什么问题吗？ 需要做什么？ <br><br>  <b>听众：</b>也就是说，如果您的应用程序有错误，有人可以以您的特权行事吗？ <br><br>  <b>教授：</b>是的，如果我的应用程序是“越野车”，或者它允许您运行所需的一切，它就会发生。 假设我可以复制系统外壳并为我设置它<b>setuid</b> ，但是任何人都可以使用我的帐户运行该外壳。 这可能不是最佳的行动计划。 但是这种机制不会产生问题，因为唯一可以在二进制文件上设置<b>setuid</b>位的人就是该文件的所有者。 您作为文件的所有者，具有<b>uid</b>特权，因此您可以将您的帐户转让给其他人，但是该其他人将无法使用您的<b>userid</b>创建<b>setuid</b>二进制文件。 <br><br> 这个setuid位存储在这些权限位的旁边，也就是说，在每个<b>inode</b>中还存在一个<b>setuid</b>位，该位指示该可执行文件是否应该执行，或者在执行过程中程序是否切换到所有者<b>uid</b> 。 <br><br><img src="https://habrastorage.org/webt/4d/o0/cf/4do0cfauri7y6g94omunnrdyv14.jpeg"><br><br> 事实证明，如果正确使用这是一种非常棘手的机制，而且由于它，内核可以正确地实现程序。 实际上，这很容易做到，因为只执行了一次检查：如果存在此<b>setuid</b>位，则过程切换到<b>uid</b> 。 这很简单。 <br><br> 但是安全地使用它是非常困难的，因为如前所述，如果该程序包含错误或发生意外情况，则您可以在<b>uid = 0</b>或任何其他<b>uid</b>下执行任意操作。 在<b>Unix上，</b>当您运行程序时，您将从父进程继承很多东西。 <br><br> 例如，您可以将环境变量传递给<b>setuid</b>二进制文件。 事实是，在<b>Unix上，</b>您可以通过设置环境变量来指定要用于该进程的共享库，而<b>setuid</b>二进制文件并不关心过滤这些环境变量。 <br><br> 例如，您可以运行<b>bin / su</b> ，但将共享库用于<b>printf</b>函数，因此，当<b>bin / su</b>打印某些内容时， <b>printf</b>将启动，并且可以运行Shell而不是<b>printf</b> 。 <br><br> 关于程序对用户输入数据的不信任，您必须正确理解许多细微之处。 因为您通常信任用户输入，所以<b>setuid</b>从来不是整个<b>Unix</b>系统中最安全的部分。 对这个有疑问吗？ <br><br>  <b>受众：</b> <b>setuid是否</b>也适用于组或仅适用于用户？ <br><br>  <b>教授：</b>有一个与<b>setuid</b>位对称的<b>setgid</b>位，您也可以设置。 如果文件具有特定的<b>gid，</b>并且在程序启动时此<b>setgid</b>位置1，则将得到它。 <br><br>  <b>Setgid</b>并不是特别使用，但是在您要提供非常特定的特权的情况下很有用。 例如， <b>bin / su</b>可能需要很多特权，但是也许有些程序需要一些额外的特权，例如，将某些内容写入特殊的日志文件。 因此，您可能想为她提供一个特定的组，并为该组创建一个可写的日志文件。 因此，即使程序“越野车”，除了该组外，您也不会丢失任何东西。 这是一种有用的机制，由于某种原因它不经常使用，因为人们毕竟应该更多地使用根权限。 <br><br>  <b>受众：</b>谁可以更改访问权限是否受到限制？ <br><br>  <b>教授：</b>是的。 不同的<b>Unix</b>实现对此有不同的检查。 一般规则是，只有root用户才能更改文件的所有者，因为您不想创建将属于其他人的文件，当然您也不想使用其他人的文件。 因此，如果您的<b>uid</b>不为0，则说明您被卡住了。 您不能更改任何文件的所有权。 如果您的<b>uid = 0</b> ，则您具有root特权，可以将所有者更改为任何人。 如果您使用的是二进制<b>setuid，</b>并且从一个<b>uid</b>切换到另一个<b>uid</b> ，则会有些复杂，这非常棘手，但是，如果您没有root特权，则基本上不能更改文件所有者。 <br><br> 从所有人的角度来看，这是一个过时的系统。 您可能会想到许多简化上述过程的方法，但是实际上，大多数高级系统都是这样，因为它们会随着时间的推移而发展。 但是您可以完美地将这些机制用作“沙盒”。 <br><br> 这些只是<b>Unix的</b>某种基本原理，几乎出现在每个类似Unix的操作系统中： <b>Mac OS X</b> ， <b>Linux</b> ， <b>FreeBSD</b> ， <b>Solaris</b> ，如果有人使用它，等等。 但是，每个系统都有更复杂的机制可供您使用。 例如，在<b>Linux上</b>有一个“沙盒” <b>设置COMP</b> ， <b>Mac OS X</b>使用了“沙盒” <b>Seatbelt</b> 。 下周，我将为您提供每个基于<b>Unix</b>的系统上可用的沙箱示例。 <br><br> 因此，在进入<b>OKWS</b>之前我们将考虑的最后一种机制，解释了如何处理<b>setuid</b>二进制文件，并说明了如何保护自己免受现有安全漏洞的影响。 问题是，您的系统上不可避免地会有一些<b>setuid</b>二进制文件，例如<b>/ bin / su</b>或<b>sudo</b>或其他东西，并且您的程序可能会出错。 因此，某人将能够执行<b>setuid</b>二进制文件，并且该进程将能够获得您不希望允许的<b>root用户</b>访问权限。 <br><br><img src="https://habrastorage.org/webt/gy/nt/aa/gyntaadl0kgyfcku6ncq8v334kg.jpeg"><br><br>  <b>Unix</b>机制通常用于防止使用<b>setuid</b>二进制文件执行潜在的恶意进程，该机制是使用文件系统名称空间通过<b>chroot</b>系统调用（即更改根目录的操作）对其进行更改。  <b>OKWS</b>作为专门用于创建快速和安全的Web服务的Web服务器，已经广泛使用了它。 <br><br><img src="https://habrastorage.org/webt/m3/x1/xr/m3x1xrg_tmht2b2l8rwd8kzzy7s.jpeg"><br><br> 因此，在<b>Unix上，</b>您可以在特定目录中执行<b>chroot</b> ，因此也许也可以执行<b>chroot（“ / foo”）</b> 。 <br><br>  <b>chroot的</b>作用有2种解释。 第一个是直观的，这意味着在运行<b>chroot之后</b> ，根目录或位于斜杠后面的目录基本上与调用<b>chroot</b>之前<b>使用的/ foo</b>等效。 似乎将名称空间限制在<b>/ foo</b>下面。 因此，如果您有一个以前称为<b>/ foo / x的文件</b> ，则在调用<b>chroot之后，</b>只需打开<b>/ x</b>就可以得到此文件。 因此，仅将您的名称空间限制为一个子目录。 这是直观的版本。 <br><br><img src="https://habrastorage.org/webt/2w/58/wf/2w58wflgecku62k-urraxwggxcc.jpeg"><br><br> 当然，在安全性上，不是直观的版本很重要，但是内核对该系统调用的作用是什么？ 它基本上做了两件事。 首先，它会更改此斜杠的值，因此，每当您访问或以斜杠开头的目录名时，内核都会包含<b>chroot</b>操作提供的任何文件。 在我们的示例中，这是在您调用<b>chroot</b>之前的文件<b>/ foo</b> ，即，我们得到了<b>/ = / foo</b> 。 <br><br><img src="https://habrastorage.org/webt/gn/yx/-t/gnyx-tksd5brn4avys0dhppaw6c.jpeg"><br><br> 内核将尝试做的下一件事情是保护您，使其能够从<b>/中</b> “逃脱”。 因为在<b>Unix上，</b>我可能会要求您给我，例如<b>/../etc/password</b> 。 因此，如果我只是这样补充这一行： <b>/foo/../</b> <b>etc/password</b> ，那将不是很好，因为我可以退出<b>/ foo</b>并继续获取<b>/ etc / password</b> 。 <br><br> 内核对<b>Unix</b>系统调用所做的第二件事是，当您为该特定进程调用<b>chroot</b>时，它将更改<b>/../</b>在此目录中求值的方式。 因此，它修改<b>/../，</b>以便<b>/ foo</b>指向自身。 因此，这不允许您“退出”，并且此更改仅适用于此过程，不会影响其余过程。 您对如何使用<b>chroot</b>环境“逃脱”有什么想法？ <br><br> 有趣的是，内核仅监视一个<b>chroot</b>目录，因此您可能会执行<b>chroot =（/ foo）</b>操作，但是您会被困在这个地方。 所以您想获取<b>/ etc / password</b> ，但是该怎么做呢？ 您可以通过键入<b>open（* / *）</b>立即打开根目录。 这将为您提供描述<b>/ foo是</b>什么的文件描述符。 然后，您可以再次调用<b>chroot</b>并执行<b>chroot（`/ bar）</b> 。 <br><br><img src="https://habrastorage.org/webt/er/ce/o6/erceo6xadygvj95nuy8fj-zn1bi.jpeg"><br><br> ,    : <b>root</b>   <b>/foo</b> ,  <b>/foo/bar</b>   <b>/../</b>     <b>/foo / bar/..</b> <br><br><img src="https://habrastorage.org/webt/gi/vb/zy/givbzygict7u1xirzzwneycl3sw.jpeg"><br><br>  ,          <b>/foo</b> .            <b>fchdir (fd)</b>     <b>(*/*)</b> ,      <b>chdir (..)</b> . <br><br><img src="https://habrastorage.org/webt/lb/qz/mx/lbqzmxnz8308avfwfyaxxprq7d8.jpeg"><br><br><img src="https://habrastorage.org/webt/gu/cn/kd/gucnkdez6q9ntda3zwtotnc4igg.jpeg"><br><br>       <b>/foo</b> ,     <b>/../</b> .     <b>/foo</b>        ,       <b>root</b> ,       . <br><br> ,    ,       .       .   <b>Unix</b>    root-   <b>chroot</b> ,  <b>chroot</b>     .  ,  <b>Unix</b>    <b>uid = 0</b>  ,      <b>chroot</b> .   .           ,         ,    <b>chroot</b> ,   <b>userid</b>   .   ,     <b>Unix</b> ,     ,    <b>root</b> ,    . <br><br>       ,  , ,     .      <b>chroot</b>       —      .    . <br><br> <b>:</b>  ,       <b>inod</b> ,      ? <br><br> <b>:</b>    !              ,  , , : «   <b>inode</b>  23»,      -        <b>hroot</b> .  ,  <b>Unix</b>     <b>inode</b>   <b>inode</b> ,  , ,   root-. <br><br>  ,      ,  ,   <b>OKWS</b> .  ,      <b>OKWS</b> . <br><br>  ,     -,   ,      -  ,      .          , , <b>httpd</b> , ,  <b>Apache</b> . <br><br>        <b>userid</b>   <b>www</b>  <b>/etc/password</b> .     ,   ,     <b>SSL</b> ,      <b>PHP</b>   ,        .   ,       , , <b>MySQL</b> ,           .    <b>MySQL</b>     .      <b>MySQL</b> , , ,      . <br><br><img src="https://habrastorage.org/webt/sx/tx/gd/sxtxgdpf7q9jr3q_tfxyzi6zgdc.jpeg"><br><br> ,  ,    ,    <b>MySQL</b>    ,        ,             . <br><br>         ,       ,  ,         ,   .    ,      , ,     <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSL</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或应用程序代码或</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解释器</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">并且由于存在错误，因此您可以使用它们来获取应用程序的全部内容。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">52:30分钟</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">继续：</font></font><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">麻省理工学院的课程“计算机系统安全”。</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">讲座4：“共享特权”，第2部分</font></font></a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/dNl22h1kW1k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该课程的完整版本可</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此处获得</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br> 感谢您与我们在一起。 你喜欢我们的文章吗？ 想看更多有趣的资料吗？ 通过下订单或将其推荐给您的朋友来支持我们，为我们为您开发<b>的入门级​​服务器的独特模拟，为Habr用户</b>提供<b>30％的折扣：</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">关于VPS（KVM）E5-2650 v4（6核）的全部真相10GB DDR4 240GB SSD 1Gbps从$ 20还是如何划分服务器？</a>  （RAID1和RAID10提供选件，最多24个内核和最大40GB DDR4）。 <br><br>  <b>戴尔R730xd便宜2倍？</b> 仅<b>在荷兰和美国，</b>我们有<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">2台Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100电视（249美元起）</a> ！</b> 阅读有关<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">如何构建基础架构大厦的信息。</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">使用价格为9000欧元的Dell R730xd E5-2650 v4服务器的上等课程？</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN418197/">https://habr.com/ru/post/zh-CN418197/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN418187/index.html">在美国，他们建议使用Amazon集线器替换所有库。 公众很愤慨</a></li>
<li><a href="../zh-CN418189/index.html">宙斯的继承人：为什么IcedID木马对银行客户有害</a></li>
<li><a href="../zh-CN418191/index.html">Python和JavaScript中的类似物。 第三部分</a></li>
<li><a href="../zh-CN418193/index.html">在2017年为Game Boy制作游戏的感觉如何</a></li>
<li><a href="../zh-CN418195/index.html">麻省理工学院的课程“计算机系统安全”。 讲座4：“共享特权”，第1部分</a></li>
<li><a href="../zh-CN418199/index.html">如何做一个简单的技术任务而又不浪费金钱和神经</a></li>
<li><a href="../zh-CN418201/index.html">我们可以复兴鸭亨特吗？</a></li>
<li><a href="../zh-CN418203/index.html">转到GraphQL API（CRUD）</a></li>
<li><a href="../zh-CN418205/index.html">太空语言第二卷：欢迎，GJ273b</a></li>
<li><a href="../zh-CN418207/index.html">回顾游戏笔记本电脑ASUS ROG Strix GL504GS SCAR II和ASUS ROG Strix GL504GM HERO II</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>