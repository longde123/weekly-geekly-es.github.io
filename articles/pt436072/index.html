<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì¶ üö∑ üõµ Limpe, marque: como ensinamos o chatbot a distinguir problemas do cliente üòÉ üë®üèæ‚Äçüåæ üå∂Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Anton Chaynikov, desenvolvedor de ci√™ncia de dados, Redmadrobot 
 Ol√° Habr! Hoje vou falar sobre as dificuldades no caminho para o chatbot, o que faci...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Limpe, marque: como ensinamos o chatbot a distinguir problemas do cliente</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redmadrobot/blog/436072/"><p><img src="https://habrastorage.org/webt/k4/rl/pc/k4rlpcs5lwl2dsvt97pez6qhfgw.png"></p><br><p><img src="https://habrastorage.org/webt/mp/4c/kh/mp4ckhvyt2k9kydafhv3vxa0its.png" align="left">  <strong>Anton Chaynikov, desenvolvedor de ci√™ncia de dados, Redmadrobot</strong> <br>  <em>Ol√° Habr!</em>  <em>Hoje vou falar sobre as dificuldades no caminho para o chatbot, o que facilita o trabalho dos operadores de chat da companhia de seguros.</em>  <em>Mais precisamente, como ensinamos o bot a distinguir solicita√ß√µes um do outro usando o aprendizado de m√°quina.</em>  <em>Quais modelos foram experimentados e quais obtiveram os resultados.</em>  <em>Como quatro abordagens para limpar e enriquecer dados de qualidade decente e cinco tentativas para limpar dados de qualidade "indecentes".</em> <a name="habracut"></a></p><br><h3 id="zadacha">  Desafio </h3><br><p>  O bate-papo da companhia de seguros recebe +100500 chamadas de clientes por dia.  A maioria das perguntas √© simples e repetitiva, mas os operadores n√£o s√£o mais f√°ceis e os clientes ainda precisam esperar de cinco a dez minutos.  Como melhorar a qualidade do servi√ßo e otimizar os custos de m√£o-de-obra para que os operadores tenham menos rotina e os usu√°rios tenham sensa√ß√µes mais agrad√°veis ‚Äã‚Äãao resolver rapidamente seus problemas? </p><br><p>  E n√≥s vamos fazer um chatbot.  Deixe-o ler as mensagens do usu√°rio, dar instru√ß√µes para casos simples e fazer perguntas padr√£o para casos complexos, a fim de obter as informa√ß√µes de que o operador precisa.  Um operador ativo possui uma √°rvore de scripts - um script (ou fluxograma) que diz quais perguntas os usu√°rios podem fazer e como responder a elas.  Adotar√≠amos esse esquema e o colocar√≠amos em um chatbot, mas √© uma m√° sorte - o chatbot n√£o entende humanamente e n√£o sabe como relacionar a pergunta do usu√°rio ao ramo de script. </p><br><p>  Ent√£o, vamos ensin√°-lo com a ajuda do bom e velho aprendizado de m√°quina.  Mas voc√™ n√£o pode simplesmente pegar um dado gerado pelos usu√°rios e ensinar a ele um modelo de qualidade decente.  Para fazer isso, voc√™ precisa experimentar a arquitetura do modelo, dados - para limpar e, √†s vezes, coletar novamente. </p><br><p>  <strong>Como ensinar um bot:</strong> </p><br><ul><li>  Considere as op√ß√µes do modelo: como o tamanho do conjunto de dados, os detalhes da vetoriza√ß√£o dos textos, a redu√ß√£o da dimens√£o, o classificador e a precis√£o final s√£o combinados. </li><li>  Vamos limpar dados decentes: encontraremos classes que podem ser jogadas fora com seguran√ßa;  descobriremos por que os √∫ltimos seis meses de marca√ß√£o s√£o melhores que os tr√™s anteriores;  determine onde est√° o modelo e onde est√° a marca√ß√£o;  Descubra como erros de digita√ß√£o podem ser √∫teis. </li><li>  Limparemos os dados "indecentes": descobriremos em que casos o agrupamento √© √∫til e in√∫til, pois os usu√°rios e operadores conversam quando √© hora de parar de sofrer e coletar a marca√ß√£o. </li></ul><br><h3 id="faktura">  Textura </h3><br><p>  T√≠nhamos dois clientes - companhias de seguros com bate-papos on-line - e projetos de treinamento de chatbot (n√£o vamos cham√°-los, isso n√£o √© importante), com qualidade de dados muito diferente.  Bem, se metade dos problemas do segundo projeto pudesse ser resolvida com manipula√ß√µes do primeiro.  Os detalhes est√£o abaixo. </p><br><p>  Do ponto de vista t√©cnico, nossa tarefa √© classificar os textos.  Isso √© feito em duas etapas: primeiro os textos s√£o vetorizados (usando tf-idf, doc2vec etc.), depois o modelo de classifica√ß√£o √© treinado nos vetores (e classes) obtidos - floresta aleat√≥ria, SVM, rede neural etc.  e assim por diante. </p><br><p>  De onde v√™m os dados: </p><br><ul><li> Sql-upload de hist√≥rico de chat.  Campos de upload relevantes: texto da mensagem;  autor (cliente ou operador);  agrupar mensagens em di√°logos;  timestamp;  categoria de contato do cliente (perguntas sobre seguro obrigat√≥rio de responsabilidade civil, seguro de casco, seguro m√©dico volunt√°rio; perguntas sobre o site; perguntas sobre programas de fidelidade; perguntas sobre altera√ß√µes nas condi√ß√µes de seguro, etc.). </li><li>  Uma √°rvore de scripts ou sequ√™ncias de perguntas e respostas de operadores para clientes com solicita√ß√µes diferentes. </li></ul><br><p>  Sem valida√ß√£o, √© claro, em lugar nenhum.  Todos os modelos foram treinados em 70% dos dados e avaliados de acordo com os resultados dos 30% restantes. </p><br><p>  M√©tricas de qualidade para os modelos que usamos: </p><br><ul><li>  Em treinamento: logloss, por diferenciabilidade; </li><li>  Ao escrever relat√≥rios: precis√£o de classifica√ß√£o em uma amostra de teste, por simplicidade e clareza (inclusive para o cliente); </li><li>  Ao escolher a dire√ß√£o para outras a√ß√µes: a intui√ß√£o de um cientista de dados que olha atentamente para os resultados. </li></ul><br><h3 id="eksperimenty-s-modelyami">  Experi√™ncias modelo </h3><br><p>  √â raro quando a tarefa deixa claro imediatamente qual modelo fornecer√° os melhores resultados.  Ent√£o aqui: sem experimenta√ß√£o, em lugar nenhum. </p><br><p>  Vamos tentar as op√ß√µes de vetoriza√ß√£o: </p><br><ul><li>  tf-idf em palavras √∫nicas; </li><li>  tf-idf em triplos caracteres (a seguir: 3 gramas); </li><li>  tf-idf em 2-, 3-, 4-, 5 gramas separadamente; </li><li>  tf-idf em 2-, 3-, 4-, 5 gramas tomados em conjunto; </li><li>  Tudo acima + redu√ß√£o de palavras no texto de origem para um formul√°rio de dicion√°rio; </li><li>  Todas as op√ß√µes acima + diminuem de dimens√£o pelo m√©todo SVD truncado; </li><li>  Com o n√∫mero de medi√ß√µes: 10, 30, 100, 300; </li><li>  doc2vec, treinado no corpo dos textos da tarefa. </li></ul><br><p>  As op√ß√µes de classifica√ß√£o nesse cen√°rio parecem bastante ruins: SVM, XGBoost, LSTM, florestas aleat√≥rias, bayes ing√™nuos, florestas aleat√≥rias sobre as previs√µes de SVM e XGB. </p><br><p>  E embora tenhamos verificado a reprodutibilidade dos resultados em tr√™s conjuntos de dados montados independentemente e seus fragmentos, podemos apenas garantir a ampla aplicabilidade. </p><br><p>  <strong>Os resultados dos experimentos:</strong> </p><br><ul><li>  Na cadeia ‚Äúpr√©-processamento-vetoriza√ß√£o-redu√ß√£o de dimens√£o-classifica√ß√£o‚Äù, o efeito da escolha em cada etapa √© quase independente das outras etapas.  O que √© muito conveniente, voc√™ n√£o pode passar por uma d√∫zia de op√ß√µes com cada nova id√©ia e usar a op√ß√£o mais conhecida a cada passo. </li><li>  tf-idf em palavras perde para 3 gramas (precis√£o 0,72 vs 0,78).  2-, 4-, 5 gramas perdem para 3 gramas (0,75-0,76 vs 0,78).  {2; 5} -grams todos juntos superam um pouco 3 gramas.  Dado o aumento acentuado na mem√≥ria necess√°ria, decidimos negligenciar o treinamento com um ganho de precis√£o de 0,4%. </li><li>  Comparado ao tf-idf de todas as variedades, o doc2vec estava indefeso (precis√£o de 0,4 e abaixo).  Valeria a pena tentar trein√°-lo n√£o no corpo da tarefa (~ 250.000 textos), mas em um n√∫mero muito maior (2,5‚Äì25 milh√µes de textos), mas at√© agora, infelizmente, suas m√£os ainda n√£o chegaram. </li><li>  SVD truncado n√£o ajudou.  A precis√£o aumenta monotonicamente com o aumento da medi√ß√£o, atingindo suavemente a precis√£o sem TSVD. </li><li>  Entre os classificadores, o XGBoost vence por uma margem percept√≠vel (+ 5‚Äì10%).  Os concorrentes mais pr√≥ximos s√£o SVM e florestas aleat√≥rias.  Naive Bayes n√£o √© concorrente nem mesmo em florestas aleat√≥rias. </li><li>  O sucesso do LSTM depende muito do tamanho do conjunto de dados: em uma amostra de 100.000 objetos, ele √© capaz de competir com o XGB.  Em uma amostra de 6000 - no atraso junto com Bayes. </li><li>  Uma floresta aleat√≥ria no topo do SVM e do XGB sempre concorda com o XGB ou se engana mais.  Isso √© muito triste, esperamos que o SVM encontre nos dados pelo menos alguns padr√µes que n√£o est√£o dispon√≠veis para o XGB, mas infelizmente. </li><li>  O XGBoost √© complicado com estabilidade.  Por exemplo, sua atualiza√ß√£o da vers√£o 0.72 para 0.80 inexplicavelmente reduziu a precis√£o dos modelos treinados em 5 a 10%.  E mais uma coisa: o XGBoost suporta a altera√ß√£o de par√¢metros de treinamento durante o treinamento e a compatibilidade com a API padr√£o do scikit-learn, mas estritamente separadamente.  Voc√™ n√£o pode fazer as duas coisas juntos.  Tinha que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">consertar isso.</a> </li><li>  Se voc√™ trouxer palavras para um formul√°rio de dicion√°rio, isso melhora um pouco a qualidade, em combina√ß√£o com tf-idf, mas √© in√∫til em todos os outros casos.  No final, a desativamos para economizar tempo. </li></ul><br><h3 id="opyt-1-chistka-dannyh-ili-chto-delat-s-razmetkoy">  Experi√™ncia 1. Limpeza de dados ou o que fazer com a marca√ß√£o </h3><br><p>  Operadores de bate-papo s√£o apenas pessoas.  Ao definir as categorias de consultas do usu√°rio, eles geralmente s√£o confundidos e t√™m diferentes interpreta√ß√µes dos limites entre as categorias.  Portanto, os dados de origem devem ser limpos de forma implac√°vel e intensa. </p><br><p>  Nossos dados sobre o treinamento do modelo no primeiro projeto: </p><br><ul><li>  Um hist√≥rico de mensagens de bate-papo on-line ao longo de v√°rios anos.  S√£o 250.000 postagens em 60.000 conversas.  No final do di√°logo, o operador selecionou a categoria √† qual a chamada do usu√°rio pertence.  Existem cerca de 50 categorias neste conjunto de dados. </li><li>  √Årvore de scripts.  No nosso caso, os operadores n√£o tinham scripts de trabalho. </li></ul><br><p>  O que exatamente os dados s√£o ruins, formulamos como hip√≥teses, depois verificamos e, sempre que poss√≠vel, corrigimos.  Aqui est√° o que aconteceu: </p><br><p>  <strong>A primeira abordagem.</strong>  De toda a enorme lista de aulas, voc√™ pode sair com seguran√ßa de 5 a 10. <br>  Descartamos classes pequenas (&lt;1% da amostra): poucos dados + pequeno impacto.  Unimos classes dif√≠ceis de distinguir, √†s quais os operadores ainda reagem da mesma maneira.  Por exemplo: <br>  'dms' + 'como marcar uma consulta com um m√©dico' + 'pergunta sobre o preenchimento do programa' <br>  'cancelamento' + 'status de cancelamento' + 'cancelamento de pol√≠tica paga' <br>  'pergunta de renova√ß√£o' + 'como renovar a pol√≠tica?' </p><br><p>  Em seguida, lan√ßamos classes como ‚Äúother‚Äù, ‚Äúother‚Äù e similares: para um chatbot, elas s√£o in√∫teis (redirecionando para um operador de qualquer maneira) e, ao mesmo tempo, danificam bastante a precis√£o, pois 20% das solicita√ß√µes (30, 50, 90) s√£o classificadas pelos operadores de maneira inadequada e aqui  Agora jogamos fora a classe com a qual o chatbot ainda n√£o pode trabalhar. </p><br><p>  Resultado: em um caso, crescimento de uma precis√£o de 0,40 a 0,69, em outro, de 0,66 a 0,77. </p><br><p>  <strong>A segunda abordagem.</strong>  No in√≠cio do bate-papo, os pr√≥prios operadores entendem mal como escolher uma classe para o usu√°rio entrar em contato, para que haja muitos "ru√≠dos" e erros nos dados. </p><br><p>  Experi√™ncia: tomamos apenas os √∫ltimos dois (tr√™s, seis, ...) meses de di√°logos e treinamos o modelo em <br>  eles. </p><br><p>  Resultado: em um caso not√°vel, a precis√£o aumentou de 0,40 para 0,60, em outro - de 0,69 para 0,78. </p><br><p>  <strong>A terceira abordagem.</strong>  √Äs vezes, uma precis√£o de 0,70 n√£o significa "o modelo est√° errado em 30% dos casos", mas "em 30% dos casos a marca√ß√£o est√° incorreta e o modelo a corrige de maneira bastante razo√°vel". </p><br><p>  Por m√©tricas como precis√£o ou perda de log, essa hip√≥tese n√£o pode ser verificada.  Para os prop√≥sitos do experimento, nos limitamos ao olhar de um cientista de dados, mas, no caso ideal, √© necess√°rio reorganizar qualitativamente o conjunto de dados, sem esquecer a valida√ß√£o cruzada. </p><br><p>  Para trabalhar com essas amostras, criamos o processo de "enriquecimento iterativo": </p><br><ol><li>  Divida o conjunto de dados em 3-4 fragmentos. </li><li>  Treine o modelo no primeiro fragmento. </li><li>  Preveja as classes da segunda pelo modelo treinado. </li><li>  Observe atentamente as classes previstas e o grau de confian√ßa do modelo; escolha o valor limite da confian√ßa. </li><li>  Remova os textos (objetos) previstos com confian√ßa abaixo do limite do segundo fragmento, treine o modelo nisso. </li><li>  Repita at√© que os fragmentos se cansem ou acabem. </li></ol><br><p>  Por um lado, os resultados s√£o excelentes: o primeiro modelo de itera√ß√£o possui uma precis√£o de 70%, o segundo - 95%, o terceiro - 99 +%.  Uma an√°lise atenta dos resultados das previs√µes confirma totalmente essa precis√£o. </p><br><p>  Por outro lado, como se pode verificar sistematicamente nesse processo que os modelos subsequentes n√£o aprendem os erros dos anteriores?  Existe uma id√©ia para testar o processo em um conjunto de dados "barulhento" manualmente com marca√ß√£o inicial de alta qualidade, como MNIST.  Mas, infelizmente, n√£o havia tempo suficiente para isso.  E sem verifica√ß√£o, n√£o ousamos lan√ßar o enriquecimento iterativo e os modelos resultantes na produ√ß√£o. </p><br><p>  <strong>A quarta abordagem.</strong>  O conjunto de dados pode ser expandido - aumentando a precis√£o e reduzindo a reciclagem, adicionando muitos erros de digita√ß√£o aos textos existentes. <br>  Os erros de digita√ß√£o s√£o erros de digita√ß√£o - dobrando uma letra, pulando uma letra, reorganizando as letras vizinhas em alguns lugares, substituindo uma letra por uma letra adjacente no teclado. </p><br><p>  Experi√™ncia: a propor√ß√£o de p letras em que ocorrer√° um erro de digita√ß√£o: 2%, 4%, 6%, 8%, 10%, 12%.  Aumento do conjunto de dados: geralmente at√© 60.000 r√©plicas.  Dependendo do tamanho inicial (depois dos filtros), isso significava um aumento de 3 a 30 vezes. </p><br><p>  Resultado: depende do conjunto de dados.  Em um pequeno conjunto de dados (~ 300 r√©plicas), 4-6% dos erros de digita√ß√£o fornecem um aumento est√°vel e significativo na precis√£o (0,40 ‚Üí 0,60).  Em grandes conjuntos de dados, tudo √© pior.  Com uma propor√ß√£o de erros de digita√ß√£o de 8% ou mais, os textos se tornam absurdos e a precis√£o diminui.  Com uma taxa de erro de 2 a 8%, a precis√£o varia na faixa de alguns por cento, muito raramente excede a precis√£o sem erros de digita√ß√£o e, como parece, n√£o h√° necessidade de aumentar o tempo de treinamento v√°rias vezes. </p><br><p>  Como resultado, obtemos um modelo que distingue 5 classes de chamadas com uma precis√£o de 0,86.  Coordenamos com o cliente os textos das perguntas e respostas de cada um dos cinco garfos, fixamos os textos no chatbot e os enviamos ao controle de qualidade. </p><br><h3 id="opyt-2-po-koleno-v-dannyh-ili-chto-delat-bez-razmetki">  Experi√™ncia 2. Dados detalhados ou o que fazer sem marca√ß√£o </h3><br><p>  Tendo obtido bons resultados no primeiro projeto, abordamos o segundo com toda confian√ßa.  Mas, felizmente, n√£o esquecemos como ser surpreendidos. </p><br><p>  O que encontramos: </p><br><ul><li>  Uma √°rvore de scripts de cinco ramos concordou com o cliente h√° cerca de um ano. </li><li>  Uma amostra marcada de 500 mensagens e 11 classes de origem desconhecida. </li><li>  Marcados por operadores de bate-papo a partir de 220.000 mensagens, 21.000 conversas e 50 outras classes. </li><li>  O modelo SVM, treinado na primeira amostra, com uma precis√£o de 0,69, herdado da equipe anterior de cientistas de dados.  Por que o SVM, a hist√≥ria √© silenciosa. </li></ul><br><p>  Primeiramente, examinamos as classes: na √°rvore de scripts, na amostra do modelo SVM, na amostra principal.  E aqui est√° o que vemos: </p><br><ul><li>  As classes do modelo SVM correspondem aproximadamente √†s ramifica√ß√µes dos scripts, mas de nenhuma maneira correspondem √†s classes de uma amostra grande. </li><li>  A √°rvore de scripts foi escrita em processos de neg√≥cios h√° um ano e est√° desatualizada quase in√∫til.  O modelo SVM foi descontinuado. </li><li>  As duas maiores classes da grande amostra s√£o Vendas (50%) e Outras (45%). </li><li>  Das cinco maiores turmas, tr√™s s√£o t√£o gerais quanto as vendas. </li><li>  As 45 classes restantes cont√™m menos de 30 caixas de di√°logo cada.  I.e.  n√£o temos uma √°rvore de scripts, n√£o h√° lista de classes nem marca√ß√£o. </li></ul><br><p>  O que fazer nesses casos?  Arrega√ßamos as mangas e fomos por conta pr√≥pria obter classes e marca√ß√£o a partir dos dados. </p><br><p>  <strong>A primeira tentativa.</strong>  Vamos tentar agrupar perguntas do usu√°rio, ou seja,  As primeiras mensagens do di√°logo, exceto as sauda√ß√µes. </p><br><p>  N√≥s verificamos.  Vetorizamos r√©plicas contando 3 gramas.  Abaixamos a dimens√£o para as dez primeiras medidas do TSVD.  Agrupamos por agrupamento aglomerativo com a dist√¢ncia euclidiana e a fun√ß√£o Ward alvo.  Abaixe a dimens√£o novamente usando t-SNE (at√© duas medi√ß√µes para que voc√™ possa ver os resultados com os olhos).  Desenhamos pontos de r√©plica no avi√£o, pintando nas cores dos aglomerados. </p><br><p>  Resultado: medo e horror.  Sane clusters, podemos assumir que n√£o h√°: </p><br><img src="https://habrastorage.org/webt/cl/rm/-s/clrm-sda0crxfeyq8ynskurotkk.png"><br><p>  Quase n√£o - h√° uma laranja √† esquerda, porque todas as mensagens nela cont√™m o "@" de 3 gramas.  Esses 3 gramas s√£o um artefato de pr√©-processamento.  Em algum lugar no processo de filtragem de sinais de pontua√ß√£o, "@" n√£o s√≥ n√£o foi filtrado, mas tamb√©m cheio de espa√ßos.  Mas o artefato √© √∫til.  Este cluster inclui usu√°rios que primeiro escrevem seus emails.  Infelizmente, somente pela disponibilidade de e-mail, n√£o √© totalmente claro qual √© a solicita√ß√£o do usu√°rio.  N√≥s seguimos em frente. </p><br><p>  <strong>A segunda tentativa.</strong>  E se os operadores frequentemente responderem com mais ou menos links padr√£o? <br>  N√≥s verificamos.  Extra√≠mos substrings semelhantes a links das mensagens do operador, editamos levemente os links, com ortografia diferente, mas com o mesmo significado (http / https, / search? City =% city%), considere as frequ√™ncias do link. </p><br><p>  Resultado: pouco promissor.  Primeiro, os operadores respondem apenas a uma pequena fra√ß√£o das solicita√ß√µes (&lt;10%) com links.  Em segundo lugar, mesmo ap√≥s a limpeza e filtragem manual dos links que ocorreram uma vez, existem mais de trinta deles.  Em terceiro lugar, no comportamento dos usu√°rios que encerram o di√°logo com um link, n√£o h√° semelhan√ßa espec√≠fica. </p><br><p>  <strong>A terceira tentativa.</strong>  Vamos procurar as respostas padr√£o dos operadores - e se eles forem indicadores de qualquer classifica√ß√£o de mensagens? </p><br><p>  N√≥s verificamos.  Em cada di√°logo, pegamos a √∫ltima r√©plica do operador (al√©m das despedidas: "Eu posso ajudar outra coisa", etc.) e consideramos a frequ√™ncia das r√©plicas exclusivas. </p><br><p>  Resultado: promissor, mas inconveniente.  50% das respostas do operador s√£o √∫nicas, outros 10 a 20% s√£o encontrados duas vezes, os 30 a 40% restantes s√£o cobertos por um n√∫mero relativamente pequeno de modelos populares.  Relativamente pequeno - cerca de trezentos.  Um exame mais atento desses modelos revela que muitos deles s√£o variantes da mesma resposta em termos de significado - diferem onde por uma letra, onde por uma palavra, onde por um par√°grafo.  Eu gostaria de agrupar essas respostas que t√™m significado pr√≥ximo. </p><br><p>  <strong>A quarta tentativa.</strong>  Agrupando as r√©plicas mais recentes de instru√ß√µes.  Estes s√£o agrupados muito melhor: </p><br><img src="https://habrastorage.org/webt/cb/to/xh/cbtoxhphxhmfo-94bpelgw1dalq.png"><br><p>  Voc√™ j√° pode trabalhar com isso. </p><br><p>  Agrupamos e desenhamos r√©plicas no plano, como na primeira tentativa, determinamos manualmente os clusters mais claramente separados, os removemos do conjunto de dados e agrupamos novamente.  Depois de separar cerca da metade do conjunto de dados, os clusters claros terminam e come√ßamos a pensar em quais classes atribuir a eles.  N√≥s dispersamos os clusters de acordo com as cinco classes originais - a amostra √© "inclinada" e tr√™s das cinco classes originais n√£o recebem um √∫nico cluster.  Que pena.  N√≥s dispersamos os clusters em cinco classes, que designamos aleatoriamente: "ligar", "vir", "esperar um dia por uma resposta", "problemas com captcha", "outros".  A inclina√ß√£o √© menor, mas a precis√£o √© de apenas 0,4-0,5.  Ruim de novo.  Atribua a cada um dos mais de 30 clusters sua pr√≥pria classe.  A amostra √© novamente inclinada e a precis√£o √© novamente 0,5, embora cerca de cinco classes selecionadas tenham precis√£o e integridade decentes (0,8 e superior).  Mas o resultado ainda n√£o √© impressionante. </p><br><p>  <strong>A quinta tentativa.</strong>  Precisamos de todos os meandros do cluster.  Recuperamos o dendrograma de cluster completo em vez dos trinta principais clusters.  N√≥s o salvamos em um formato acess√≠vel aos analistas de clientes e os ajudamos a fazer a marca√ß√£o - esbo√ßamos a lista de classes. </p><br><p>  Para cada mensagem, calculamos uma cadeia de clusters, que inclui cada mensagem, come√ßando pela raiz.  Constru√≠mos uma tabela com colunas: texto, identifica√ß√£o do primeiro cluster da cadeia, identifica√ß√£o do segundo cluster da cadeia, ..., identifica√ß√£o do cluster correspondente ao texto.  Salvamos a tabela em csv / xls.  Al√©m disso, voc√™ pode trabalhar com ferramentas de escrit√≥rio. </p><br><p>  Fornecemos os dados e um esbo√ßo da lista de classes para marca√ß√£o ao cliente.  Os analistas de clientes remarcaram ~ 10.000 primeiras mensagens do usu√°rio.  N√≥s, j√° ensinados por experi√™ncia, pedimos para marcar cada mensagem pelo menos duas vezes.  E n√£o em v√£o - 4.000 desses 10.000 precisam ser jogados fora, porque os dois analistas se diferenciaram.  Nos 6.000 restantes, repetimos rapidamente os sucessos do primeiro projeto: </p><br><ul><li>  Linha de base: sem filtragem - precis√£o 0,66. </li><li>  Combinamos as classes iguais do ponto de vista do operador.  Temos uma precis√£o de 0,73. </li><li>  Removemos a classe "Outros" - a precis√£o aumenta para 0,79. </li></ul><br><p>  O modelo est√° pronto, agora voc√™ precisa desenhar uma √°rvore de scripts.  Por motivos que n√£o podemos explicar, n√£o tivemos acesso a scripts para respostas do operador.  N√£o ficamos surpresos, fingimos ser usu√°rios e, por algumas horas em campo, coletamos modelos de resposta e esclarecemos perguntas do operador para todas as ocasi√µes.  Eles os decoraram em uma √°rvore, os embalaram em um bot e foram testar.  Aprovado pelo cliente. </p><br><h3 id="vyvody-ili-chto-pokazal-opyt">  Conclus√µes ou que experi√™ncia demonstrou: </h3><br><ul><li>  Voc√™ pode experimentar partes do modelo (pr√©-processamento, vetoriza√ß√£o, classifica√ß√£o etc.) individualmente. </li><li>  O XGBoost ainda domina a bola, embora, se voc√™ precisar de algo incomum, tenha problemas. </li><li>  O usu√°rio √© um dispositivo perif√©rico de entrada ca√≥tica, portanto, voc√™ precisa limpar os dados do usu√°rio. </li><li>  O enriquecimento iterativo √© legal, embora perigoso. </li><li>  √Äs vezes, vale a pena devolver os dados ao cliente para marca√ß√£o.  Mas n√£o se esque√ßa de ajud√°-lo a obter um resultado de qualidade. </li></ul><br><p>  A ser conclu√≠do. <cut></cut></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt436072/">https://habr.com/ru/post/pt436072/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt436062/index.html">Sistema de arbitragem para iniciantes, parte 1</a></li>
<li><a href="../pt436064/index.html">Intelig√™ncia artificial para todos</a></li>
<li><a href="../pt436066/index.html">Matem√°tica do Apocalipse: Teoria dos Jogos e a Crise Nuclear do Caribe</a></li>
<li><a href="../pt436068/index.html">Confer√™ncia C ++ R√∫ssia 2019</a></li>
<li><a href="../pt436070/index.html">Como lidar com testes inadequados na comunidade de c√≥digo-fonte aberto</a></li>
<li><a href="../pt436076/index.html">An√°lise do ataque de Cowrie Hanipot</a></li>
<li><a href="../pt436080/index.html">Semana de Seguran√ßa 03: 2019 - Ano de Privacidade</a></li>
<li><a href="../pt436082/index.html">Como a UEBA ajuda a melhorar a seguran√ßa cibern√©tica</a></li>
<li><a href="../pt436086/index.html">Vis√£o geral da atualiza√ß√£o 4 do Veeam Cloud Connect</a></li>
<li><a href="../pt436088/index.html">O editor gr√°fico GANpaint desenha objetos e demonstra os recursos GAN</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>