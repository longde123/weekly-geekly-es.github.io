<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‰ ğŸšŸ ğŸ’· Spark Streamingå’ŒKafkaçš„é›†æˆ ğŸ”´ ğŸ• ğŸ‘©ğŸ¼â€ğŸ’»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¤§å®¶å¥½ï¼ æˆ‘ä»¬æé†’æ‚¨ï¼Œä¸ä¹…å‰æˆ‘ä»¬å‡ºç‰ˆäº†ä¸€æœ¬æœ‰å…³Sparkçš„ä¹¦ ï¼Œè€Œç°åœ¨ä¸€æœ¬æœ‰å…³Kafkaçš„ä¹¦æ­£åœ¨æ¥å—æœ€æ–°çš„æ ¡å¯¹ã€‚ 


 æˆ‘ä»¬å¸Œæœ›è¿™äº›ä¹¦èƒ½å¤Ÿå–å¾—æˆåŠŸï¼Œè¶³ä»¥ç»§ç»­è¯¥ä¸»é¢˜-ä¾‹å¦‚ï¼Œæœ‰å…³Spark Streamingçš„æ–‡çŒ®çš„ç¿»è¯‘å’Œå‡ºç‰ˆã€‚ æˆ‘ä»¬ä»Šå¤©æƒ³ä¸ºæ‚¨æä¾›æœ‰å…³å°†è¯¥æŠ€æœ¯ä¸Kafkaé›†æˆçš„ç¿»è¯‘ã€‚ 

 1.ç†ç”± ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Spark Streamingå’ŒKafkaçš„é›†æˆ</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/417123/"> å¤§å®¶å¥½ï¼ æˆ‘ä»¬æé†’æ‚¨ï¼Œä¸ä¹…å‰æˆ‘ä»¬å‡ºç‰ˆäº†ä¸€<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœ¬æœ‰å…³Spark</a>çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¹¦</a> ï¼Œè€Œç°åœ¨ä¸€<a href="">æœ¬æœ‰å…³Kafka</a>çš„<a href="">ä¹¦</a>æ­£åœ¨æ¥å—æœ€æ–°çš„æ ¡å¯¹ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/it/cf/nj/itcfnjaffoo8apwikyd7_yfym5s.jpeg"></div><br> æˆ‘ä»¬å¸Œæœ›è¿™äº›ä¹¦èƒ½å¤Ÿå–å¾—æˆåŠŸï¼Œè¶³ä»¥ç»§ç»­è¯¥ä¸»é¢˜-ä¾‹å¦‚ï¼Œæœ‰å…³Spark Streamingçš„æ–‡çŒ®çš„ç¿»è¯‘å’Œå‡ºç‰ˆã€‚ æˆ‘ä»¬ä»Šå¤©æƒ³ä¸ºæ‚¨æä¾›æœ‰å…³å°†è¯¥æŠ€æœ¯ä¸Kafkaé›†æˆçš„ç¿»è¯‘ã€‚ <br><a name="habracut"></a><br>  <b>1.ç†ç”±</b> <br><br>  Apache Kafka + Spark Streamingæ˜¯åˆ›å»ºå®æ—¶åº”ç”¨ç¨‹åºçš„æœ€ä½³ç»„åˆä¹‹ä¸€ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è¯¦ç»†è®¨è®ºè¿™ç§é›†æˆçš„ç»†èŠ‚ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬å°†ä»¥Spark Streaming-Kafkaä¸ºä¾‹ã€‚ ç„¶åï¼Œæˆ‘ä»¬è®¨è®ºâ€œæ¥æ”¶æ–¹æ–¹æ³•â€ä»¥åŠKafkaå’ŒSpark Streamingç›´æ¥é›†æˆçš„é€‰é¡¹ã€‚ å› æ­¤ï¼Œè®©æˆ‘ä»¬å¼€å§‹é›†æˆKafkaå’ŒSpark Streamingã€‚ <br><br><img src="https://habrastorage.org/webt/8x/jl/cp/8xjlcpzhwdwi4w2g87iifbquvr0.jpeg"><br><br>  <b>2. Kafkaå’ŒSpark Streamingçš„é›†æˆ</b> <br><br> åœ¨é›†æˆApache Kafkaå’ŒSpark Streamingæ—¶ï¼Œæœ‰ä¸¤ç§å¯èƒ½çš„æ–¹æ³•æ¥é…ç½®Spark Streamingä»¥ä»Kafkaæ¥æ”¶æ•°æ®-å³ æ•´åˆKafkaå’ŒSpark Streamingçš„ä¸¤ç§æ–¹æ³•ã€‚ é¦–å…ˆï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ”¶ä»¶äººå’Œé«˜çº§Kafka APIã€‚ ç¬¬äºŒç§ï¼ˆè¾ƒæ–°çš„ï¼‰æ–¹æ³•æ˜¯æ²¡æœ‰æ”¶ä»¶äººçš„å·¥ä½œã€‚ ä¸¤ç§æ–¹æ³•éƒ½æœ‰ä¸åŒçš„ç¼–ç¨‹æ¨¡å‹ï¼Œä¾‹å¦‚åœ¨æ€§èƒ½å’Œè¯­ä¹‰ä¿è¯æ–¹é¢æœ‰æ‰€ä¸åŒã€‚ <br><br><img src="https://habrastorage.org/webt/91/mn/sk/91mnsklu_81q0nx9aadnjgya4fc.png"><br><br> è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°è€ƒè™‘è¿™äº›æ–¹æ³•ã€‚ <br><br>  <i><b>ä¸€ä¸ª</b></i>  <i><b>åŸºäºæ”¶ä»¶äººçš„æ–¹æ³•</b></i> <br><br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•°æ®çš„æ¥æ”¶æ˜¯ç”±æ”¶ä»¶äººæä¾›çš„ã€‚ å› æ­¤ï¼Œä½¿ç”¨Kafkaæä¾›çš„é«˜çº§æ¶ˆè´¹APIï¼Œæˆ‘ä»¬å®ç°äº†æ”¶ä»¶äººã€‚ æ­¤å¤–ï¼Œæ¥æ”¶åˆ°çš„æ•°æ®å­˜å‚¨åœ¨Spark Artistsä¸­ã€‚ ç„¶åï¼Œåœ¨Kafka-Spark Streamingä¸­å¯åŠ¨ä½œä¸šï¼Œåœ¨å…¶ä¸­å¤„ç†æ•°æ®ã€‚ <br><br> ä½†æ˜¯ï¼Œä½¿ç”¨è¿™ç§æ–¹æ³•æ—¶ï¼Œåœ¨å‘ç”Ÿæ•…éšœï¼ˆä½¿ç”¨é»˜è®¤é…ç½®ï¼‰çš„æƒ…å†µä¸‹ä»ç„¶å­˜åœ¨æ•°æ®ä¸¢å¤±çš„é£é™©ã€‚ å› æ­¤ï¼Œæœ‰å¿…è¦åœ¨Kafka-Spark Streamingä¸­å¦å¤–åŒ…å«ä¸€ä¸ªé¢„å†™æ—¥å¿—ï¼Œä»¥æ¶ˆé™¤æ•°æ®ä¸¢å¤±ã€‚ å› æ­¤ï¼Œä»Kafkaæ¥æ”¶çš„æ‰€æœ‰æ•°æ®éƒ½åŒæ­¥å­˜å‚¨åœ¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­çš„é¢„å†™æ—¥å¿—ä¸­ã€‚ å› æ­¤ï¼Œå³ä½¿åœ¨ç³»ç»Ÿå‡ºç°æ•…éšœåï¼Œä¹Ÿå¯ä»¥è¿˜åŸæ‰€æœ‰æ•°æ®ã€‚ <br><br> æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ç ”ç©¶å¦‚ä½•åœ¨å…·æœ‰Kafka-Spark Streamingçš„åº”ç”¨ç¨‹åºä¸­å¯¹æ”¶ä»¶äººä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚ <br><br>  <i>æˆ‘</i>  <i>è£…è®¢</i> <br><br> ç°åœ¨ï¼Œæˆ‘ä»¬å°†æµåº”ç”¨ç¨‹åºä¸ä»¥ä¸‹é’ˆå¯¹Scala / Javaåº”ç”¨ç¨‹åºçš„å·¥ä»¶ç›¸è¿ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨SBT / Mavençš„é¡¹ç›®å®šä¹‰ã€‚ <br><br><pre><code class="java hljs">groupId = org.apache.spark artifactId = spark-streaming-kafka-<span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">8_2.11</span></span> version = <span class="hljs-number"><span class="hljs-number">2.2</span></span>.0</code> </pre> <br> ä½†æ˜¯ï¼Œåœ¨éƒ¨ç½²æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸æ·»åŠ ä¸Šè¿°åº“åŠå…¶ä¾èµ–é¡¹ï¼ŒPythonåº”ç”¨ç¨‹åºå°†éœ€è¦æ­¤åº“ã€‚ <br><br>  <i>iiã€‚</i>  <i>ç¨‹å¼è®¾è®¡</i> <br><br> æ¥ä¸‹æ¥ï¼Œé€šè¿‡å°†<code>KafkaUtils</code>å¯¼å…¥åˆ°æµåº”ç”¨ç¨‹åºä»£ç ä¸­æ¥åˆ›å»º<code>DStream</code>è¾“å…¥æµï¼š <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.streaming.kafka._ val kafkaStream = KafkaUtils.createStream(streamingContext, [ZK quorum], [consumer group id], [per-topic number of Kafka partitions to consume])</code> </pre> <br> æ­¤å¤–ï¼Œä½¿ç”¨createStreamé€‰é¡¹ï¼Œå¯ä»¥æŒ‡å®šé”®ç±»å’Œå€¼ç±»ï¼Œä»¥åŠç”¨äºè§£ç çš„ç›¸åº”ç±»ã€‚ <br><br>  <i>iiiã€‚</i>  <i>éƒ¨ç½²æ–¹å¼</i> <br><br> ä¸ä»»ä½•Sparkåº”ç”¨ç¨‹åºä¸€æ ·ï¼Œspark-submitå‘½ä»¤ç”¨äºå¯åŠ¨ã€‚ ä½†æ˜¯ï¼Œç»†èŠ‚åœ¨Scala / Javaåº”ç”¨ç¨‹åºå’ŒPythonåº”ç”¨ç¨‹åºä¸­ç•¥æœ‰ä¸åŒã€‚ <br><br> æ­¤å¤–ï¼Œä½¿ç”¨<code>â€“packages</code>æ‚¨å¯ä»¥å°†<code>spark-streaming-Kafka-0-8_2.11</code>åŠå…¶ä¾èµ–é¡¹ç›´æ¥æ·»åŠ åˆ°<code>spark-submit</code> ï¼Œè¿™å¯¹äºæ— æ³•ä½¿ç”¨SBT / Mavenç®¡ç†é¡¹ç›®çš„Pythonåº”ç”¨ç¨‹åºå¾ˆæœ‰ç”¨ã€‚ <br><br><pre> <code class="java hljs">./bin/spark-submit --packages org.apache.spark:spark-streaming-kafka-<span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">8_2.11</span></span>:<span class="hljs-number"><span class="hljs-number">2.2</span></span>.0 ...</code> </pre> <br> æ‚¨è¿˜å¯ä»¥ä»Mavenå­˜å‚¨åº“ä¸‹è½½Mavenå·¥ä»¶<code>spark-streaming-Kafka-0-8-assembly</code>çš„JARå­˜æ¡£ã€‚ ç„¶åå°†å…¶æ·»åŠ åˆ°å¸¦æœ‰<code>jars</code> <code>spark-submit</code> ã€‚ <br><br>  <i>bã€‚</i>  <i>ç›´æ¥æ–¹å¼ï¼ˆæ— æ”¶ä»¶äººï¼‰</i> <br><br> åœ¨ä½¿ç”¨æ¥æ”¶è€…çš„æ–¹æ³•ä¹‹åï¼Œå¼€å‘äº†ä¸€ç§è¾ƒæ–°çš„æ–¹æ³•-â€œç›´æ¥â€æ–¹æ³•ã€‚ å®ƒæä¾›å¯é çš„ç«¯åˆ°ç«¯ä¿ä¿®ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šå®šæœŸå‘Kafkaè¯¢é—®æ¯ä¸ªä¸»é¢˜/éƒ¨åˆ†çš„åç§»é‡åç§»é‡ï¼Œè€Œä¸å®‰æ’é€šè¿‡æ¥æ”¶è€…ä¼ é€æ•°æ®ã€‚ å¦å¤–ï¼Œç¡®å®šè¯»å–çš„ç‰‡æ®µçš„å¤§å°ï¼Œè¿™å¯¹äºæ­£ç¡®å¤„ç†æ¯ä¸ªåˆ†ç»„æ˜¯å¿…éœ€çš„ã€‚ æœ€åï¼Œä¸€ä¸ªç®€å•çš„æ¶ˆè€—æ€§APIç”¨äºä»å…·æœ‰æŒ‡å®šåç§»é‡çš„Kafkaæ•°æ®è¯»å–èŒƒå›´ï¼Œå°¤å…¶æ˜¯åœ¨å¯åŠ¨æ•°æ®å¤„ç†ä½œä¸šæ—¶ã€‚ æ•´ä¸ªè¿‡ç¨‹å°±åƒä»æ–‡ä»¶ç³»ç»Ÿè¯»å–æ–‡ä»¶ã€‚ <br><br> æ³¨æ„ï¼šæ­¤åŠŸèƒ½å‡ºç°åœ¨Scalaå’ŒJava APIçš„Spark 1.3ä¸­ï¼Œä»¥åŠPython APIçš„Spark 1.4ä¸­ã€‚ <br><br> ç°åœ¨è®©æˆ‘ä»¬è®¨è®ºå¦‚ä½•åœ¨æˆ‘ä»¬çš„æµåº”ç”¨ç¨‹åºä¸­åº”ç”¨è¿™ç§æ–¹æ³•ã€‚ <br> æ¶ˆè´¹è€…APIåœ¨ä»¥ä¸‹é“¾æ¥ä¸­æœ‰æ›´è¯¦ç»†çš„æè¿°ï¼š <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Apache Kafkaä½¿ç”¨è€…|</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¡å¤«å¡æ¶ˆè´¹è€…çš„ä¾‹å­</a> <br><br> æˆ‘ è£…è®¢ <br><br> æ˜¯çš„ï¼Œä»…Scala / Javaåº”ç”¨ç¨‹åºæ”¯æŒæ­¤æ–¹æ³•ã€‚ ä½¿ç”¨ä»¥ä¸‹å·¥ä»¶ï¼Œæ„å»ºSBT / Mavené¡¹ç›®ã€‚ <br><br><pre> <code class="java hljs">groupId = org.apache.spark artifactId = spark-streaming-kafka-<span class="hljs-number"><span class="hljs-number">0</span></span>-<span class="hljs-number"><span class="hljs-number">8_2.11</span></span> version = <span class="hljs-number"><span class="hljs-number">2.2</span></span>.0</code> </pre> <br>  <i>iiã€‚</i>  <i>ç¨‹å¼è®¾è®¡</i> <br><br> æ¥ä¸‹æ¥ï¼Œå¯¼å…¥KafkaUtilså¹¶åœ¨æµåº”ç”¨ç¨‹åºä»£ç ä¸­åˆ›å»ºä¸€ä¸ªè¾“å…¥<code>DStream</code> ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.streaming.kafka._ val directKafkaStream = KafkaUtils.createDirectStream[ [key <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">], [</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">], [</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">key</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">decoder</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">], [</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">decoder</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">] ]( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">streamingContext</span></span></span><span class="hljs-class">, [</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">map</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">of</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Kafka</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parameters</span></span></span><span class="hljs-class">], [</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">set</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">of</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">topics</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">consume</span></span></span><span class="hljs-class">])</span></span></code> </pre> <br> åœ¨Kafkaå‚æ•°ä¸­ï¼Œæ‚¨å°†éœ€è¦æŒ‡å®š<code>metadata.broker.list</code>æˆ–<code>bootstrap.servers</code> ã€‚ å› æ­¤ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»Kafkaçš„æ¯ä¸ªéƒ¨åˆ†ä¸­çš„æœ€åä¸€ä¸ªåç§»é‡å¼€å§‹çš„æ•°æ®ã€‚ ä½†æ˜¯ï¼Œå¦‚æœè¦ä»æœ€å°çš„ç‰‡æ®µå¼€å§‹è¯»å–ï¼Œåˆ™éœ€è¦åœ¨Kafkaå‚æ•°ä¸­è®¾ç½®é…ç½®é€‰é¡¹<code>auto.offset.reset</code> ã€‚ <br><br> æ­¤å¤–ï¼Œä½¿ç”¨é€‰é¡¹<code>KafkaUtils.createDirectStream</code> ï¼Œæ‚¨å¯ä»¥ä»ä»»æ„åç§»é‡å¼€å§‹è¯»å–ã€‚ ç„¶åï¼Œæˆ‘ä»¬å°†æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œè¿™å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿè®¿é—®æ¯ä¸ªåŒ…ä¸­æ¶ˆè€—çš„Kafkaç‰‡æ®µã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//      ,        var offsetRanges = Array.empty[OffsetRange] directKafkaStream.transform { rdd =&gt; offsetRanges = rdd.asInstanceOf[HasOffsetRanges].offsetRanges rdd }.map { ... }.foreachRDD { rdd =&gt; for (o &lt;- offsetRanges) { println(s"${o.topic} ${o.partition} ${o.fromOffset} ${o.untilOffset}") } ... }</span></span></code> </pre> <br> å¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨ç‰¹æ®Šå·¥å…·åœ¨Zookeeperçš„åŸºç¡€ä¸Šç»„ç»‡å¯¹Kafkaçš„ç›‘è§†ï¼Œå¯ä»¥åœ¨å…¶å¸®åŠ©ä¸‹è‡ªè¡Œæ›´æ–°Zookeeperã€‚ <br><br>  <i>iiiã€‚</i>  <i>éƒ¨ç½²æ–¹å¼</i> <br><br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéƒ¨ç½²è¿‡ç¨‹ä¸æ¥æ”¶æ–¹çš„å˜ä½“ä¸­çš„éƒ¨ç½²è¿‡ç¨‹ç±»ä¼¼ã€‚ <br><br>  <b>3.ç›´æ¥æ–¹æ³•çš„å¥½å¤„</b> <br><br> ç”±äºä»¥ä¸‹åŸå› ï¼Œå°†Spark Streamingä¸Kafkaé›†æˆçš„ç¬¬äºŒç§æ–¹æ³•ä¼˜äºç¬¬ä¸€ç§ï¼š <br><br>  <b><i>ä¸€ä¸ª</i></b>  <b><i>ç®€åŒ–å¹¶å‘</i></b> <br><br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨æ— éœ€åˆ›å»ºè®¸å¤šKafkaè¾“å…¥æµå¹¶å°†å…¶ç»„åˆã€‚ ä½†æ˜¯ï¼ŒKafka-Spark Streamingå°†åˆ›å»ºä¸å°†è¦ä½¿ç”¨çš„Kafkaåˆ†æ®µä¸€æ ·å¤šçš„RDDåˆ†æ®µã€‚ æ‰€æœ‰è¿™äº›Kafkaæ•°æ®éƒ½å°†å¹¶è¡Œè¯»å–ã€‚ å› æ­¤ï¼Œå¯ä»¥è¯´æˆ‘ä»¬å°†åœ¨Kafkaå’ŒRDDæ®µä¹‹é—´å»ºç«‹ä¸€ä¸€å¯¹åº”çš„å…³ç³»ï¼Œè¿™æ ·çš„æ¨¡å‹æ›´æ˜“äºç†è§£ä¸”æ˜“äºé…ç½®ã€‚ <br><br>  <i><b>bã€‚</b></i>  <i><b>å®æ•ˆ</b></i> <br><br> ä¸ºäº†å®Œå…¨æ¶ˆé™¤ç¬¬ä¸€ç§æ–¹æ³•æœŸé—´çš„æ•°æ®ä¸¢å¤±ï¼Œéœ€è¦å°†ä¿¡æ¯å­˜å‚¨åœ¨ä¸»è¦è®°å½•çš„æ—¥å¿—ä¸­ï¼Œç„¶åå†è¿›è¡Œå¤åˆ¶ã€‚ å®é™…ä¸Šï¼Œè¿™æ˜¯ä½æ•ˆçš„ï¼Œå› ä¸ºæ•°æ®è¢«å¤åˆ¶äº†ä¸¤æ¬¡ï¼šç¬¬ä¸€æ¬¡æ˜¯ç”±Kafkaæœ¬èº«å¤åˆ¶ï¼Œç¬¬äºŒæ¬¡æ˜¯é€šè¿‡é¢„å†™æ—¥å¿—å¤åˆ¶ã€‚ åœ¨ç¬¬äºŒç§æ–¹æ³•ä¸­ï¼Œç”±äºæ²¡æœ‰æ¥æ”¶è€…ï¼Œå› æ­¤æ¶ˆé™¤äº†æ­¤é—®é¢˜ï¼Œå› æ­¤ä¸éœ€è¦å¼•å¯¼å†™æ—¥è®°å¸ã€‚ å¦‚æœæˆ‘ä»¬åœ¨Kafkaä¸­æœ‰è¶³å¤Ÿé•¿çš„æ•°æ®å­˜å‚¨ç©ºé—´ï¼Œåˆ™å¯ä»¥ç›´æ¥ä»Kafkaæ¢å¤æ¶ˆæ¯ã€‚ <br><br>  <b><i>s</i></b>  <b><i>ä¸€æ¬¡ç²¾ç¡®è¯­ä¹‰</i></b> <br><br> åŸºæœ¬ä¸Šï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€ç§æ–¹æ³•ä¸­ä½¿ç”¨äº†é«˜çº§Kafka APIå°†æ¶ˆè€—çš„è¯»å–ç‰‡æ®µå­˜å‚¨åœ¨Zookeeperä¸­ã€‚ ä½†æ˜¯ï¼Œè¿™æ˜¯ä½¿ç”¨æ¥è‡ªKafkaçš„æ•°æ®çš„ä¹ æƒ¯ã€‚ å°½ç®¡å¯ä»¥å¯é åœ°æ¶ˆé™¤æ•°æ®ä¸¢å¤±ï¼Œä½†æ˜¯åœ¨æŸäº›æ•…éšœä¸­ï¼Œä¸ªåˆ«è®°å½•å¯èƒ½ä¼šè¢«æ¶ˆè€—ä¸¤æ¬¡ã€‚ é‡ç‚¹æ˜¯Kafka-Spark Streamingä¸­å¯é çš„æ•°æ®ä¼ è¾“æœºåˆ¶ä¸Zookeeperä¸­å‘ç”Ÿçš„ç‰‡æ®µè¯»å–ä¹‹é—´çš„ä¸ä¸€è‡´ã€‚ å› æ­¤ï¼Œåœ¨ç¬¬äºŒç§æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ç®€å•çš„Kafka APIï¼Œå®ƒä¸éœ€è¦æ±‚åŠ©äºZookeeperã€‚ åœ¨è¿™é‡Œï¼Œåœ¨Kafka-Spark Streamingä¸­è·Ÿè¸ªè¯»å–çš„ç‰‡æ®µï¼Œä¸ºæ­¤ï¼Œä½¿ç”¨äº†æ§åˆ¶ç‚¹ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒSpark Streamingå’ŒZookeeper / Kafkaä¹‹é—´çš„ä¸ä¸€è‡´å°†è¢«æ¶ˆé™¤ã€‚ <br><br> å› æ­¤ï¼Œå³ä½¿å‘ç”Ÿæ•…éšœï¼ŒSpark Streamingä¹Ÿä»…ä¸¥æ ¼æ¥æ”¶ä¸€æ¬¡æ¯ä¸ªè®°å½•ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿å°†æ•°æ®å­˜å‚¨åœ¨å¤–éƒ¨å­˜å‚¨ä¸­çš„è¾“å‡ºæ“ä½œæ˜¯å¹‚ç­‰çš„æˆ–åŸå­äº‹åŠ¡ï¼Œåœ¨å…¶ä¸­å­˜å‚¨ç»“æœå’Œåç§»é‡ã€‚ è¿™å°±æ˜¯åœ¨æˆ‘ä»¬çš„ç»“æœæ¨å¯¼ä¸­å®ç°ä¸€æ¬¡ç²¾ç¡®è¯­ä¹‰çš„æ–¹å¼ã€‚ <br><br> è™½ç„¶æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼šZookeeperä¸­çš„åç§»é‡ä¸ä¼šæ›´æ–°ã€‚ å› æ­¤ï¼ŒåŸºäºZookeeperçš„Kafkaç›‘è§†å·¥å…·ä¸å…è®¸æ‚¨è·Ÿè¸ªè¿›åº¦ã€‚ <br> ä½†æ˜¯ï¼Œå¦‚æœå¤„ç†æ˜¯ä»¥è¿™ç§æ–¹å¼å®‰æ’çš„ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥å¼•ç”¨åç§»é‡-æˆ‘ä»¬è½¬å‘æ¯ä¸ªç¨‹åºåŒ…å¹¶è‡ªè¡Œæ›´æ–°Zookeeperã€‚ <br><br> è¿™å°±æ˜¯æˆ‘ä»¬æƒ³è¦è®¨è®ºçš„æœ‰å…³é›†æˆApache Kafkaå’ŒSpark Streamingçš„å…¨éƒ¨å†…å®¹ã€‚ å¸Œæœ›æ‚¨å–œæ¬¢ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN417123/">https://habr.com/ru/post/zh-CN417123/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN417111/index.html">åœ¨çº¿ä¼šè®®ï¼šæµåª’ä½“vsç½‘ç»œç ”è®¨ä¼š</a></li>
<li><a href="../zh-CN417113/index.html">ä¿„ç½—æ–¯çš„3Dæ„å¤§åˆ©æ‰“å°æœºï¼šRaise3D N1 Dual-å»ºæ¨¡å’ŒåŸå‹åˆ¶ä½œ</a></li>
<li><a href="../zh-CN417115/index.html">è¦åŸ‹è‘¬æˆ–ç‡ƒçƒ§Flutter.ioï¼Ÿ</a></li>
<li><a href="../zh-CN417117/index.html">GameCubeæ¸¸æˆä¸­NESæ¨¡æ‹Ÿå™¨çš„é€†å‘å·¥ç¨‹</a></li>
<li><a href="../zh-CN417119/index.html">Vue.jsä¸­çš„åˆ†é¡µ</a></li>
<li><a href="../zh-CN417125/index.html">RTC Meetup .Netï¼šé‚€è¯·å‚åŠ ç¬¬ä¸€æ¬¡ä¼šè®®</a></li>
<li><a href="../zh-CN417127/index.html">ç‰¹æ–¯æ‹‰ç­¾ç½²åè®®åœ¨ä¸­å›½å»ºé€ Gigafactory 3</a></li>
<li><a href="../zh-CN417129/index.html">å¿ƒçµçš„å®‡å®™</a></li>
<li><a href="../zh-CN417131/index.html">ç°åœ¨å¦‚ä½•åœ¨MongoDBä¸­æ„Ÿå—äº¤æ˜“</a></li>
<li><a href="../zh-CN417135/index.html">Unity3Dï¼šå¦‚ä½•æ‰¾å‡ºåœºæ™¯ä¸­æŸä¸ªç‚¹çš„è¦†ç›–ç¨‹åº¦ï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>