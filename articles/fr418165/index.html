<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ë üóëÔ∏è ‚öíÔ∏è Quasar, Sobaken et Vermin: r√©v√©ler les d√©tails de la campagne de cyberespionnage en cours ‚è© ü§ûüèæ üôçüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="√Ä l'aide d'outils d'acc√®s √† distance, Quasar, Sobaken et Vermin, les cybercriminels surveillent les agences gouvernementales ukrainiennes et volent de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Quasar, Sobaken et Vermin: r√©v√©ler les d√©tails de la campagne de cyberespionnage en cours</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/418165/">  √Ä l'aide d'outils d'acc√®s √† distance, Quasar, Sobaken et Vermin, les cybercriminels surveillent les agences gouvernementales ukrainiennes et volent des donn√©es de leurs syst√®mes.  Ce cybergroupe a √©t√© mentionn√© pour la premi√®re fois dans un rapport en janvier 2018, a attir√© l'attention d'ESET √† la mi-2017 et continue aujourd'hui de d√©velopper son logiciel. <br><br>  Dans ce rapport, nous r√©v√©lons les d√©tails de la campagne en cours, fournissons des informations sur les logiciels malveillants et d√©crivons les m√©thodes utilis√©es par les attaquants pour propager, cibler et √©chapper √† la d√©tection. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/um/d7/91/umd791-uddub2r4pyn_fl32ttkm.jpeg"></div><a name="habracut"></a><br><h2>  Profil des attaquants </h2><br>  Ce groupe ne semble pas avoir une connaissance technique exceptionnelle ni un acc√®s aux vuln√©rabilit√©s zero-day.  Cependant, elle a appliqu√© avec succ√®s l'ing√©nierie sociale pour diffuser le travail malvari et secret pendant longtemps. <br><br>  Nous avons r√©ussi √† suivre son travail jusqu'en octobre 2015, mais il est possible que le groupe ait commenc√© ses activit√©s beaucoup plus t√¥t. <br><br>  Les attaquants utilisent trois modifications du .NET malvari: Quasar RAT (Remote Administration Tool), Sobaken (un d√©riv√© de RAT de Quasar) et RAT Vermin personnalis√©.  Les outils ont √©t√© utilis√©s simultan√©ment sur les m√™mes cibles, ils partagent partiellement l'infrastructure et se connectent aux m√™mes serveurs C&amp;C.  Une explication possible de l'utilisation de trois modifications parall√®les est le fait qu'elles ont √©t√© d√©velopp√©es ind√©pendamment les unes des autres. <br><br><h2>  Les victimes </h2><br>  Des logiciels malveillants sont utilis√©s dans les attaques contre les agences gouvernementales ukrainiennes.  Selon la t√©l√©m√©trie ESET, des centaines de victimes dans diverses organisations et plusieurs centaines de fichiers ex√©cutables li√©s √† cette campagne ont √©t√© enregistr√©s. <br><br><h2>  Chronologie </h2><br>  La figure 1 montre les principaux √©v√©nements de la campagne par ordre chronologique. <br><br><img src="https://habrastorage.org/webt/8w/9p/4_/8w9p4_dn72fqyzbhonm9xqqvrbq.jpeg"><br>  <i>Figure 1. Chronologie de la campagne</i> <br><br><h2>  Distribution </h2><br>  Selon nos donn√©es de t√©l√©m√©trie, les attaquants utilisent le courrier √©lectronique comme principal canal de distribution pour trois RAT.  Ils utilisent l'ing√©nierie sociale pour convaincre les victimes de t√©l√©charger et d'ex√©cuter le logiciel malveillant. <br><br>  Dans la plupart des cas, les noms des fichiers sont √©crits en ukrainien et sont li√©s au travail des victimes.  Voici des exemples de tels fichiers: <br><br><ul><li>  "INSTRUCTIONS pour l'organisation de la protection du service militaire d'Ukraine et de ce membre de la famille" ("Ordonnance garantissant la s√©curit√© du personnel militaire de l'arm√©e ukrainienne et des membres de leur famille") </li><li>  ¬´Je punirai le nouveau projet, la d√©signation de la r√©vision de la Viluchennya¬ª (¬´Le nouveau projet de l'ordonnance de contr√¥le du retrait¬ª) </li><li>  ¬´Donning OVK Zb—ñlshennya limitu¬ª (¬´Division des achats Don HVAC. Augmentation de la limite de cr√©dit¬ª) </li></ul><br>  En plus des techniques de base de l'ing√©nierie sociale (attirant l'attention sur l'investissement), les attaquants utilisent trois m√©thodes techniques.  Cela est susceptible d'am√©liorer encore les performances de la campagne. <br><br>  <b>M√©thode n ¬∞ 1</b> : les applications de messagerie utilisent le caract√®re <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">de substitution</a> Unicode de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">droite √† gauche</a> , qui modifie le sens de lecture des caract√®res, pour masquer la v√©ritable extension.  En fait, il s'agit de fichiers ex√©cutables utilisant des ic√¥nes Word, Excel, PowerPoint ou Acrobat Reader, afin de ne pas cr√©er de suspicion. <br><br>  Un exemple de nom de fichier: comme le montre la figure 2, ¬´D√©placer du bois de chauffage solide (bois de chauffage) pour une combustion non prot√©g√©e _ &lt;&gt; xcod scr¬ª (¬´Transport du bois de chauffage pour le chauffage¬ª) ressemblera √† un fichier .DOCX pour les utilisateurs distraits. <br><br><img src="https://habrastorage.org/webt/ec/y9/nm/ecy9nmj2acupweqnnlwm4pzlha4.png"><br>  <i>Figure 2. Un fichier ex√©cutable d√©guis√© en document Word</i> <br><br>  <b>M√©thode 2</b> : applications de messagerie se faisant passer pour des archives auto-extractibles RAR. <br><br>  Exemple: un e-mail avec l'application ¬´Punishment_MOU_Dodatka_do_Instrucii_440_ost.rar¬ª (¬´Ordre du minist√®re de la D√©fense, pi√®ces jointes √† l'instruction n ¬∞ 440¬ª), comme le montre la figure 3. √Ä l'int√©rieur des archives RAR, il y a un fichier ex√©cutable appel√© ¬´Punishment_MOU_Dodatki_do_Instruciiii_440_ost.exe¬ª. <br><br>  Vraisemblablement, les victimes ex√©cutent ce fichier, en attendant de d√©compresser davantage le contenu de l'archive auto-extractible, mais lancent ainsi involontairement un fichier ex√©cutable malveillant. <br><br>  <b>M√©thode n ¬∞ 3</b> : document Word + exploit CVE-2017-0199.  Cette vuln√©rabilit√© est appliqu√©e lorsqu'une victime ouvre un document Word sp√©cialement con√ßu.  Le processus Word envoie une demande HTTP √† un fichier HTA contenant un script malveillant situ√© sur un serveur distant.  Ensuite, le script malveillant est lanc√© par <code>mshta.exe</code> .  Les premi√®res informations publiques sur cette vuln√©rabilit√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sont apparues en avril 2017</a> et Microsoft les a ferm√©es en publiant une mise √† jour de s√©curit√© pour toutes les versions de Windows et Office. <br><br>  Selon la t√©l√©m√©trie ESET, ces attaquants ont commenc√© √† utiliser cette m√©thode en mai 2017.  Les attaquants ont utilis√© hxxp: // chip-tuning lg [] ua / pour fournir les fichiers HTA et la charge utile finale. <br><br><img src="https://habrastorage.org/webt/fl/3d/ie/fl3diek7ndvyatqlnf0skmg3zs8.png"><br>  <i>Figure 3. Fichier d√©guis√© en archive RAR auto-extractible.</i>  <i>Les donn√©es de version et les droits d'auteur sugg√®rent qu'il s'agit d'un faux</i> <br><br><h2>  Installation et persistance </h2><br>  La proc√©dure d'installation est la m√™me pour les trois modifications du malvari utilis√©es par ce groupe.  Le compte-gouttes vide les fichiers de charge utile (Vermin, Quasar ou Sobaken) dans le dossier <code>%APPDATA%</code> , dans un sous-dossier portant le nom de la soci√©t√© l√©gitime (g√©n√©ralement Adobe, Intel ou Microsoft).  Puis, comme illustr√© √† la figure 4, il cr√©e une t√¢che dans le planificateur pour ex√©cuter le composant toutes les 10 minutes pour garantir la persistance.  Certaines versions utilisent √©galement la m√©thode d'utilisation de la fonctionnalit√© de raccourci <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">du Panneau de configuration de Windows</a> pour rendre leurs dossiers inaccessibles √† partir de l'Explorateur Windows.  Ces dossiers ne s'ouvriront pas lorsque vous cliquez dessus dans l'Explorateur Windows, mais la page "Toutes les t√¢ches" s'ouvre. <br><br><img src="https://habrastorage.org/webt/r_/f8/ag/r_f8agiayao-ya99saiesftwzvq.png"><br>  <i>Figure 4. Une t√¢che qui lance un composant malveillant toutes les 10 minutes</i> <br><br>  Exemples: <br><br> <code>C:\Users\Admin\AppData\Roaming\Microsoft\Proof\Settings.{ED7BA470-8E54-465E-825C- 99712043E01C}\TransactionBroker32.exe <br> C:\Users\Admin\AppData\Roaming\Adobe\SLStore\Setting.{ED7BA470-8E54-465E-825C- 99712043E01C}\AdobeSLService.exe</code> <br> <br><h2>  Ciblage </h2><br>  Les attaquants utilisent de nombreuses astuces pour que le malware ne fonctionne que sur les machines cibles.  Ils sont particuli√®rement attentifs √† √©viter les syst√®mes d'analyse automatis√©s et les bacs √† sable. <br><br>  <b>M√©thode n ¬∞ 1</b> : v√©rifier la disposition du clavier dans Windows <br>  Malvar v√©rifie si la disposition du clavier russe ou ukrainien est install√©e.  Sinon, son travail s'arr√™te imm√©diatement. <br><br>  <b>M√©thode n ¬∞ 2</b> : v√©rifier l'adresse IP <br>  Malvar obtient l'adresse IP d'un ordinateur infect√© via une demande √† un service l√©gitime <br>  Ipinfo.io/json.  Le travail sera termin√© si l'adresse IP n'est pas trouv√©e en Ukraine ou en Russie, ou si elle est enregistr√©e chez l'un des fournisseurs de services cloud ou d√©veloppeurs de logiciels antivirus s√©lectionn√©s.  Le code qui effectue la v√©rification est indiqu√© dans les r√©sultats de d√©montage des figures 5 et 6. <br><br><img src="https://habrastorage.org/webt/ca/um/ji/caumjikfr3j6dxoyr2vt3ujlin4.jpeg"><br>  <i>Figure 5. Code v√©rifiant la g√©olocalisation de l'adresse IP de la machine infect√©e</i> <br><br><img src="https://habrastorage.org/webt/x4/qv/6l/x4qv6loy2wy9nsy39mbdxauswsi.jpeg"><br>  <i>Figure 6. Code correspondant √† l'adresse IP avec une liste de fournisseurs de services cloud et de fournisseurs d'antivirus</i> <br><br>  <b>M√©thode 3</b> : tester l'√©mulation du r√©seau <br>  Les syst√®mes d'analyse automatis√©s utilisent souvent des outils tels que Fakenet-NG, o√π la communication DNS / HTTP r√©ussit et produit n'importe quel r√©sultat.  Les auteurs malvari essaient d'identifier de tels syst√®mes en g√©n√©rant un nom / URL de site al√©atoire et v√©rifient qu'il n'y a pas de connexion √† cette URL (sur la figure 7), comme ce serait le cas sur un syst√®me r√©el. <br><br><img src="https://habrastorage.org/webt/2i/gd/ht/2igdhtw18kvmfdggtpjlmrzhjio.png"><br>  <i>Figure 7. Code g√©n√©rant une URL al√©atoire et d√©marrant le t√©l√©chargement</i> <br><br>  <b>M√©thode 4</b> : v√©rification d'un nom d'utilisateur sp√©cifique <br>  Les logiciels malveillants ne d√©marrent pas sous un compte avec un nom d'utilisateur typique des syst√®mes d'analyse de logiciels malveillants automatis√©s, comme le montre la figure 8. <br><br><img src="https://habrastorage.org/webt/ta/7f/xu/ta7fxutvbu2rh5oouavpnlyrwio.jpeg"><br>  <i>Figure 8. R√©conciliation du nom d'utilisateur actuel avec une liste de syst√®mes d'analyse de logiciels malveillants connus</i> <br><br><h2>  Application de st√©ganographie </h2><br>  Depuis la mi-2017, les attaquants utilisent la st√©ganographie, cachant des composants malveillants dans les images des sites d'h√©bergement gratuits saveshot.net et ibb.co. <br><br>  La st√©ganographie est une science qui vous permet de masquer des donn√©es ¬´en plein √©cran¬ª, √† l'int√©rieur d'autres informations non classifi√©es.  Dans notre cas, le fichier EXE malveillant a √©t√© chiffr√© et cach√© dans un fichier JPEG, comme dans la figure 9. Malvar t√©l√©charge et d√©code JPEG, extrait les donn√©es cach√©es, d√©crypte le fichier EXE √† partir de ces donn√©es et le lance. <br><br><img src="https://habrastorage.org/webt/__/pv/dq/__pvdqrrbokglop1ehh9alsv2ng.png"><br>  <i>Figure 9. Exemple d'image JPEG utilis√©e pour masquer le composant malveillant livr√© (redimensionn√© et supprim√©)</i> <br><br>  Le processus de d√©cryptage est assez compliqu√© et peut √™tre d√©crit comme suit: <br><br>  1. T√©l√©chargement d'un fichier JPEG √† partir d'une URL cod√©e en dur dans un fichier binaire. <br><br>  2. La force brute d'un mot de passe √† huit chiffres en calculant son hachage et en le r√©conciliant avec un hachage cod√© en dur dans le fichier binaire t√©l√©charg√©.  Cette √©tape utilise intensivement le processeur; il faut plus de 10 minutes pour le terminer sur un ordinateur ordinaire.  Il s'agit tr√®s probablement d'une autre mesure pour contrer les syst√®mes automatis√©s d'analyse des logiciels malveillants. <br><br>  3. Traitement du fichier JPEG et extraction des donn√©es qui y sont cach√©es, comme le montre le code d√©sassembl√© des figures 10 et 11. L'algorithme utilis√© par le malware est tr√®s similaire √† celui utilis√© dans JSteg, l'un des algorithmes de st√©ganographie les plus anciens et les plus simples pour les fichiers JPEG.  Il masque les donn√©es en LSB (le bit le moins significatif) des coefficients de transform√©e en cosinus discrets d'un fichier JPEG.  Ces donn√©es cach√©es n'affectent g√©n√©ralement pas l'image visible √† l'≈ìil nu, mais des algorithmes sp√©cialis√©s peuvent facilement d√©tecter sa pr√©sence.  Cependant, cet algorithme de st√©ganographie est tr√®s facile √† mettre en ≈ìuvre, ce qui a probablement √©t√© la raison de son choix par les auteurs du malvari. <br><br>  4. Extraction et d√©compression des donn√©es √† l'aide de GZip. <br><br>  5. D√©chiffrement des donn√©es d√©compress√©es sur AES avec le mot de passe obtenu √† l'√©tape n ¬∞ 2. <br><br>  6. D√©codage des donn√©es d√©chiffr√©es en base64. <br><br>  7. √âcriture du fichier EXE sur le disque et ex√©cution. <br><br>  En cons√©quence, les auteurs de cette menace ont abandonn√© l'id√©e d'utiliser la st√©ganographie et ont commenc√© √† utiliser hxxp: // chip-tuning lg [] ua pour transf√©rer des fichiers ex√©cutables non chiffr√©s. <br><br><img src="https://habrastorage.org/webt/5s/ch/zx/5schzxd_4v0gsywse4wwbanoxj4.png"><br>  <i>Figure 10. Code de st√©ganographie √† l'int√©rieur d'un d√©codeur JPEG</i> <br><br><img src="https://habrastorage.org/webt/1v/ll/w2/1vllw2olpntevix4tebamq3iuye.jpeg"><br>  <i>Figure 11. Code de st√©ganographie √† l'int√©rieur d'un d√©codeur JPEG</i> <br><br><h2>  Mods Malvari </h2><br>  Ces attaquants utilisent trois modifications du malvari dans leurs attaques.  Ci-dessous, nous donnons un bref aper√ßu de chacun et nous concentrons sur la description des caract√©ristiques. <br><br><h3>  Quasar </h3><br>  Quasar est un RAT open source disponible sur GitHub.  Nous avons vu plusieurs campagnes dans lesquelles ce cyber-groupe utilisait des fichiers binaires Quasar RAT.  La premi√®re campagne connue a dur√© d'octobre 2015 √† avril 2016.  Le prochain a eu lieu en f√©vrier 2017.  Les artefacts de compilation indiquent le chemin d'acc√®s √† PDB <code>n:\projects\Viral\baybak_files_only\QRClient\QuasarRAT-master\Library\obj\ Release\Library.pdb</code> <br><br>  Une autre campagne avec Quasar RAT, utilisant les serveurs de commande de ces attaquants (mailukr.net), a √©t√© mise en ≈ìuvre en juillet-septembre 2017.  Les attaquants ont utilis√© une ancienne version de Quasar RAT appel√©e "xRAT 2.0 RELEASE3".  Les artefacts du compilateur dans le dropper montrent le chemin vers la PDB <code>N:\shtorm\WinRARArchive\ obj\Release\WinRAR.pdb</code> <br><br><h3>  Sobaken </h3><br>  Sobaken est une version consid√©rablement modifi√©e de Quasar RAT.  Si vous comparez la structure des programmes Quasar et Sobaken, vous pouvez observer beaucoup de choses en commun - voir Figure 12. <br><br>  Les auteurs de Sobaken ont r√©duit la fonctionnalit√© du malware, de sorte que le fichier ex√©cutable est devenu plus petit et plus facile √† masquer.  Ils ont √©galement ajout√© des astuces pour contourner le bac √† sable et d'autres d√©crits ci-dessus. <br><br><img src="https://habrastorage.org/webt/y9/ld/aa/y9ldaavl3hyytmazu3mxftcgnku.png"><br>  <i>Figure 12. √âvolution de Sobaken.</i>  <i>Quasar RAT v1.3 gauche, au milieu et √† droite - deux versions de Sobaken</i> <br><br><h3>  La vermine </h3><br>  Vermin est une porte d√©rob√©e personnalis√©e que seul ce cybergroupe utilise.  Pour la premi√®re fois, le malware a √©t√© document√© dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le rapport Palo Alto Networks de</a> janvier 2018.  La porte d√©rob√©e est apparue mi-2016 et est toujours utilis√©e.  Comme Quasar avec Sobaken, il est √©crit en .NET.  Pour rendre l'analyse difficile, le code est prot√©g√© √† l'aide du syst√®me de protection de code commercial .NET Reactor ou du protecteur open source ConfuserEx. <br><br>  De plus, comme Sobaken, il utilise Vitevic Assembly Embedder, un logiciel gratuit pour incorporer les DLL n√©cessaires dans le fichier ex√©cutable principal, qui est disponible sur Visual Studio Marketplace. <br><br><h4>  Fonctionnel </h4><br>  Vermin est une porte d√©rob√©e compl√®te avec plusieurs composants optionnels.  La derni√®re version connue au moment de la r√©daction (Vermin 2.0) prend en charge les commandes suivantes, dont l'essence peut √™tre comprise par les noms: <br>  - StartCaptureScreen <br>  - StopCaptureScreen <br>  - ReadDirectory <br>  - UploadFile <br>  - DownloadFile <br>  - CancelUploadFile <br>  - CancelDownloadFile <br>  - GetMonitors <br>  - DeleteFiles <br>  - ShellExec <br>  - getprocesses <br>  - KillProcess <br>  - CheckIfProcessIsRunning <br>  - CheckIfTaskIsRunning <br>  - RunKeyLogger <br>  - CreateFolder <br>  - RenameFolder <br>  - DeleteFolder <br>  - UpdateBot <br>  - RenameFile <br>  - ArchiveAndSplit <br>  - StartAudioCapture <br>  - StopAudioCapture <br>  - SetMicVolume <br><br>  La plupart des commandes sont impl√©ment√©es dans la charge utile principale.  Seulement quelques commandes et fonctions suppl√©mentaires - via des composants optionnels charg√©s par des attaquants sur la machine de la victime.  Parmi les composants optionnels: <br>  - enregistrement audio <br>  - enregistreur de frappe <br>  - Vol de mot de passe <br>  - Vol d'un fichier sur USB (voleur de fichiers USB) <br><br><h4>  Outil d'enregistrement audio (AudioManager) </h4><br>  Un composant Vermin √† part enti√®re qui peut enregistrer le son du microphone de l'ordinateur de la victime.  Il accepte trois commandes Vermin: StartAudioCapture, StopAudioCapture et SetMicVolume.  Les donn√©es re√ßues sont compress√©es √† l'aide des codecs Speex et t√©l√©charg√©es au format SOAP sur les serveurs Vermin C&amp;C. <br><br><h4>  Enregistreur de frappe (KeyboardHookLib) </h4><br>  Keylogger dans Vermin est un simple fichier ex√©cutable s√©par√© qui intercepte toutes les frappes et les √©crit dans le fichier sous forme crypt√©e.  Il √©crit √©galement le contenu du tampon et les noms des fen√™tres actives.  L'enregistreur de frappe lui-m√™me ne peut pas communiquer avec les serveurs Vermin C&amp;C;  La porte d√©rob√©e principale est utilis√©e pour transmettre les informations collect√©es. <br><br>  Le chemin d'acc√®s √† la PDB dans le keylogger confirme la connexion avec le malware Vermin: <br> <code>Z:\Projects\Vermin\KeyboardHookLib\obj\Release\AdobePrintLib.pdb</code> <br> <br><h4>  Outil de vol de mot de passe (PwdFetcher) </h4><br>  Un composant de vol de mot de passe Vermin distinct est utilis√© pour extraire les mots de passe enregistr√©s des navigateurs (Chrome, Opera).  La partie principale du code semble √™tre copi√©e d'un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article de Habr</a> .  Certains exemples contiennent √©galement du code pour extraire des informations du navigateur Firefox, mais il ne semble pas √™tre utilis√©.  Comme le montre la figure 13, ce composant contient √©galement des chemins PDB similaires au composant keylogger, qui confirme la connexion avec Vermin. <br><br><img src="https://habrastorage.org/webt/yg/fu/go/ygfugop0kr3ev9ddu34gwnq0nm4.png"><br>  <i>Figure 13. Artefacts de compilation qui vous permettent d'associer un composant de vol de mot de passe √† Vermin</i> <br><br><h4>  Outil de vol de fichiers USB (UsbGuard) </h4><br>  <code>UsbGuard.exe</code> est un composant facultatif utilis√© √† la fois par Sobaken et Vermin.  Il s'agit d'un petit programme distinct qui surveille les lecteurs USB connect√©s √† l'ordinateur et copie tous les fichiers qui correspondent au filtre configur√© par les attaquants.  Les fichiers vol√©s sont ensuite transf√©r√©s √† l'aide du module principal de porte d√©rob√©e.  De nombreuses voies diff√©rentes vers la PDB ont √©t√© trouv√©es dans l'√©chantillon de ce composant, qui le lie clairement √† la vermine. <br><br>  Depuis avril 2018, le composant de vol de fichiers est utilis√© comme un outil distinct.  Il copie des fichiers et les t√©l√©charge imm√©diatement sur un serveur contr√¥l√© par l'attaquant. <br><br>  Dans les √©chantillons analys√©s, les attaquants ont recherch√© des fichiers avec les extensions suivantes: <br>  - doc <br>  - docx <br>  - xls <br>  - xlsx <br>  - zip <br>  - rar <br>  - 7z <br>  - docm <br>  - txt <br>  - rtf <br>  - xlsm <br>  - pdf <br>  - jpg <br>  - jpeg <br>  - tif <br>  - odt <br>  - ods <br><br><h2>  Conclusion </h2><br>  Parmi les nombreuses attaques avec utilisation de logiciels malveillants visant des cibles de haut rang en Ukraine, cette campagne n'a pas re√ßu beaucoup d'attention.  Cela est peut-√™tre d√ª √† l'utilisation de code provenant de sources ouvertes.  Cependant, le groupe est d√©j√† pass√© au d√©veloppement de ses propres outils. <br><br>  L'utilisation de plusieurs familles de logiciels malveillants et de m√©canismes d'infection, y compris l'ing√©nierie sociale et la st√©ganographie, au cours des trois derni√®res ann√©es peut √™tre due au fait que les attaquants exp√©rimentent des m√©thodes ou travaillent en plusieurs groupes. <br><br>  L'application r√©ussie de techniques triviales (par exemple, l'envoi de RAR et EXE par e-mail) souligne l'importance de la protection contre le facteur humain. <br><br><h2>  Indicateurs de compromis (IoC) </h2><br><h3>  Serveurs C et C </h3><br><h4>  Sobaken C&amp;C </h4><br> <code>akamaicdn.ru <br> akamainet021.info <br> cdnakamai.ru <br> windowsupdate.kiev.ua <br> akamainet022.info <br> akamainet066.info <br> akamainet067.info <br> notifymail.ru <br> mailukr.net <br> 188.227.16.73 <br> 212.116.121.46 <br> 206.54.179.160</code> <br> <br><h4>  Quasar C&amp;C </h4><br> <code>188.227.75.189 <br> mailukr.net <br> cdnakamai.ru <br> notifymail.ru</code> <br> <br><h4>  Vermin C&amp;C </h4><br> <code>185.158.153.222 <br> 188.227.17.68 <br> 195.78.105.23 <br> tech-adobe.dyndns.biz <br> notifymail.ru <br> akamainet023.info <br> mailukr.net <br> 185.125.46.24 <br> akamainet024.info <br> 206.54.179.196</code> <br> <br><h3>  Transfert de composants, exfiltration de donn√©es </h3><br> <code>chip-tuning.lg.ua <br> www.chip-tuning.lg.ua <br> olx.website <br> news24ua.info <br> rst.website <br> 1ua.eu <br> novaposhta.website</code> <br> <br><h3>  SHA1 </h3><br><h4>  La vermine </h4><br> <code>028EBDBEBAC7239B41A1F4CE8D2CC61B1E09983B <br> 07E1AF6D3F7B42D2E26DF12A217DEBACEDB8B1B9 <br> 09457ACB28C754AA419AB6A7E8B1940201EF3FFE <br> 0EEE92EC2723ED9623F84082DAD962778F4CF776 <br> 10128AB8770FBDECD81B8894208A760A3C266D78 <br> 131F99A2E18A358B60F09FD61EE312E74B02C07C <br> 14F69C7BFAF1DF16E755CCF754017089238B0E7B <br> 1509F85DE302BE83A47D5AFAD9BEE2542BA317FC <br> 170CEE6523B6620124F52201D943D7D9CA7B95E5 <br> 191159F855A0E580290871C945245E3597A5F25C <br> 1F12C32A41D82E978DE333CD4E93FDAA1396BE94 <br> 22B17966B597568DB46B94B253CD37CBCF561321 <br> 2C7332D8247376842BD1B1BD5298844307649C99 <br> 2E08BA5DF30C0718C1733A7836B5F4D98D84905E <br> 2EDF808F8252A4CBCB92F47A0AEDC1AAAE79A777 <br> 360F54B33AC960EE29CA0557A28F6BB8417EF409 <br> 431FCE6A47D0A48A57F699AA084C9FF175A9D15F <br> 45438834FDC5C690DA3BC1F60722BE86B871280D <br> 4A8A8188E3A7A137651B24780DF37CB6F610CC19 <br> 4C1E4E136B7922F9E28D1B38E9760E28929E4F0B <br> 5B6EA57FFC09593C3B65D903368EA5F7FAA2EB68 <br> 61D366939FE36861B2FECB38A4DFF6D86C925A00 <br> 6A72366D8AE09F72F0466FB59E8ED372F8B460D7 <br> 6FECA622B0FB282064F7DE42BA472A8EC908D0D6 <br> 70A772485C5ED330C6876FA901BA722CD44CA05E <br> 70D97367A3DBD5D45482B6AF8C78C58B64D3F3B3 <br> 7803FD9753930522705F2B6B4E73622887892C28 <br> 7B11A84B18DC4B5F1F2826E7925F0B2DC1B936AE <br> 889FD0BEB3197DDD6C88F5C40D6B8E4D74A892CE <br> 9B6FBABFA2A77FA633F7A2EB352979D5C68CEBC6 <br> A451291F17489E3A59F440A1B693D691B053C531 <br> A53D77E55A06CF131D670339BACEC5AC0F0C6D66 <br> A925D0AFB5D4F5FAC65543C993BE4172F1DBF329 <br> B5F81C804E47B76C74C38DF03A5CBE8A4FE69A9A <br> B99DE55043099E9506B304660B8E1374787AB195 <br> C00C104FC3E9F5977D11C67EF0C8C671D4DFC412 <br> CA0296FA9F48E83EA3F26988401B3F4C4E655F7A <br> D4C6540E789BD3839D65E7EDA5CCA8832493649E <br> D5EDE1BBB9A12757E24BE283AFC8D746ADC4A0D4 <br> DEFBFD98C74BEFF839EEB189F0F6C385AD6BA19B <br> ECF152EB6417A069573F2C7D9A35B9CC31EC8F56 <br> EE2D40825C77C8DFEF67999F0C521919E6672A10 <br> EF09AC6BA08A116F2C4080CBEE8CEF9523E21265 <br> F414C49CF502D1B6CC46E08F3AC97D7846B30732</code> <br> <br><h4>  Sobaken </h4><br> <code>087F77998004207BCCFFBF3030B6789648930FA5 <br> 0A4A2BCB3EF4E19973D5C4BE4E141B665CC0BFE0 <br> 1CEEF0813C0F096E6DA5461DC4B3BF901C500C56 <br> 293DBFF0230DAB3C4C21428F90C8EF06E9F35608 <br> 37E2947BFB5FC0839087C5BCE194EC193F824C85 <br> 39525CBCA591F2A10946BA62A56E4C3382CD4FC0 <br> 3CE0A18E9A8A2B95827008DBFF16364B6FEDF361 <br> 3E869038080DAE006FF6B20DF9B0CD9CB3A5E1A1 <br> 400830AB6DD46789B00D081ADF0F82623472FB13 <br> 43F382A330A454FF83F4F35FB571ECF587A4694A <br> 4449FBE2B28A81B760B284880ADBED43462C2030 <br> 4712AF28168FD728A13EFD520E0665FFD076B6FB <br> 4F504D7B35660943B206D6034752C686365EA58D <br> 53239A62E09BB0B4E49B7954D533258FEF3342C4 <br> 540292753FA0CC4ACB49E5F11FEDEA4B7DEF11D8 <br> 5589E8018DC7F934A8FDAB62670C9140AF31CAB6 <br> 57BBA7D8786D3B0C5F93BC20AB505DF3F69C72D4 <br> 630FE59D60F6882A0B9E35ED606BF06AD4BA048C <br> 63EA7C844D86882F491812813AAAD746738A6BE9 <br> 64121FA2FD2E38AC85A911A9F7ADD8CA1E1A9820 <br> 64DBA711FDD52FECF534CAC0C6FE8848FE36F196 <br> 650AB5E674FEF431EBC8CF98141506DDC80C5E64 <br> 6EF13E9D5B0B6FCB5EB2A7439AAD7B21EA7FB7AC <br> 7177F64362A504F3DF8AA815CEF7136D5A819C04 <br> 9B91EC03A09C4CF6DBEC637B3551BDCA11F04A9B <br> A26764AFB1DAC34CAA2123F7BF3543D385147024 <br> A55319D3DBD7B9A587F5156CF201C327C803FBC9 <br> A841FF1EE379269F00261337A043448D3D72E6FD <br> AAB5BAAAE8A2577E1036769F0D349F553E4D129B <br> ACB989B3401780999474C5B1D7F9198ECA11549A <br> B65372E41E7761A68AEF87001BBB698D8D8D5EC6 <br> BDB5E0B6CA0AA03E0BECA23B46A8420473091DFF <br> C4421084C19423D311A94D7BB6CB0169C44CBECD <br> C7E76993BB419DC755BD0C04255AB88E6C77B294 <br> CF5238C467EBE2704528EED18AB4259BFDC604E3 <br> D2334E161A1720E2DF048E4366150729B9395144 <br> D35FB6E031720876482E728A40532703EF02A305 <br> D82DF2903AA4BC5FD4274B5D1BFAF9E081771628 <br> E4B3CBCA9A53B7B93177A270C2A76F981D157C34 <br> E585AA2C5BFB9D42D2E58DB3833330D056713B9A <br> F4A485696FC871307C22906701CBBB3FA522499B <br> F5C75450108440D0BC9E7B210F072EF25A196D20</code> <br> <br><h4>  Quasar </h4><br> <code>0A4915B81D9A9ACF4E19181DEEEBBE244430C16B <br> 323160C88A254127D9ADB2848AE044AFFF376A4D <br> 395166835495B418773C9690227779D592F94F71 <br> 3EE410DD50FC64F39DFF0C4EE8CC676F0F7D5A74 <br> 5B665152F6596D4412267F9C490878455BA235F9 <br> 5FE8558EB8A3C244BE2DA8BE750221B9A9EE8539 <br> 61CB5E535F0AC90A1F904EC9937298F50E2B4974 <br> 6A1CD05F07B1024287CEA400237E1EA9D2FE1678 <br> 7676AFF05A3550E5BBFF78CF4D10C9E094447D72 <br> 86165F464EC1912A43445D80559D65C165E2CF76 <br> AB3CD05BE6B0BA8567B84D10EDE28ABF87E115AC <br> BFD7158E1C2F6BA525E24F85ED8CCF8EF40FD370 <br> CFEBEFC92DCDF1687FD0BC1B50457EBDEA8672A2 <br> D21B8514990B0CEAC5EAE687DEAA60B447139B9D</code> <br> <br><h4>  St√©ganographie </h4><br> <code>04DA3E81684E4963ABEC4C0F6D56DF9F00D2EF26 <br> 3C618A0C4BF4D3D24C9F2A84D191FC296ED22FA4 <br> 746155881D5AB2635566399ACC89E43F6F3DA91A <br> CADBC40A4EFB10F4E9BD8F4EC3742FA8C37F4231 <br> E22CE72406B14EF32A469569FBE77839B56F2D69</code> <br> <br><h4>  Fichiers Hta </h4><br> <code>39F5B17471FD839CC6108266826A4AD8F6ECD6A3 <br> 751FBD034D63A5E0A3CA64F55045AE24E575384A <br> 76433D1D13DF60EC0461ED6D8007A95C7A163FF9 <br> 89DF6A7551B00969E22DC1CAE7147447ACA10988 <br> D6D148050F03F5B14681A1BBF457572B9401B664</code> <br> <br><h4>  Outil d'enregistrement audio </h4><br> <code>1F49946CA2CE51DC51615000BAA63F6C5A9961F1 <br> 98F62C2E6045D5A15D33C8383ADACF9232E5FBE3 <br> E7C4A69EBD7B41A6AF914DD3D3F64E1AA1ABE9B4 <br> F233A0F2997BB554D4F1A4B7AC77DAE4180850FA</code> <br> <br><h4>  Enregistreur de frappe </h4><br> <code>21921864D2F1AB2761C36031A2E1D2C00C9B304A <br> 3C2D0615BEF6F88FED6E308D4F45B6133080C74F <br> 91E8346910E0E6783ACFC4F2B9A745C81BD7573A</code> <br> <br><h4>  Outil de vol de mot de passe </h4><br> <code>2A5C9D4DAE5E53B2962FBE2B7FA8798A127BC9A6 <br> 9B1586766AF9885EF960F05F8606D1230B36AC15 <br> A2F0D5AF81D93752CFF1CF1E8BB9E6CAEE6D1B5E <br> CE18467B33161E39C36FC6C5B52F68D49ABCFC2A</code> <br> <br><h4>  Outil de vol de fichiers USB </h4><br> <code>050EB7D20EE8EF1E1DAEE2F421E5BF648FB645DF <br> 069A919B3BC8070BB2D71D3E1AD9F7642D8ECF0F <br> 0D265E0BDA9DF83815759ABCA64938EC0FF65733 <br> 0D7DF910D0FB7B100F084BFB8DFA0A9F2371171A <br> 2FF3F5DA2960BE95E50B751680F450896AD1ED67 <br> 3200ECC7503F184F72AB9DA1DC3E1F8D43DDFD48 <br> 46D256EF277328E803D2B15CA7C188267059949D <br> 524EE1B7269D02F725E55254A015200BB472463A <br> 53A0EFD3D448DA8E32CFDDA5848312D3CF802B06 <br> 6FC150A9CAFA75813E7473C687935E7E4A5DCE24 <br> 70559245303F99630A27CB47B328C20C9666F0BB <br> 7D8044A5CBEFE3B016F2132A5750C30BB647E599 <br> 8FD919D531A7A80615517E1AC13C2D0F050AF20D <br> 9D22421DA9696B535C708178C72323F64D31FC80 <br> BFD2DFA3D6AF31DF4B9CC2F6B31B239ADF1CECA1 <br> C08A6222B59A187F3CF27A7BAE4CACFACC97DDEE <br> C2F6A65E14605828880927B9BA3C386507BD8161 <br> C562006D2FA53B15052A4B80C94B86355CCA7427 <br> CB43058D9EBB517832DF7058641AEDF6B303E736 <br> CC8A9C28E884FDA0E1B3F6CEAB12805FEA17D3C1 <br> D3CC27CA772E30C6260C5A3B6309D27F08A295CD <br> E7A2DE3776BA7D939711E620C7D6AB25946C9881 <br> EE6EFA7A6A85A1B2FA6351787A1612F060086320 <br> EF0ABB3A0CD1E65B33C0F109DD18F156FC0F0CDE <br> F63BE193C8A0FBB430F3B88CC8194D755BAD9CD1</code> <br> <br><h3>  D√©tection ESET </h3><br>  La plupart des fichiers ont √©t√© automatiquement reconnus par ESET sur la base d'un principe de similitude de malware.  Les d√©couvertes sont directement li√©es √† la plupart des fichiers de la campagne: <br> <code>MSIL/Agent AWB <br> MSIL/Agent AZG <br> MSIL/Agent AZJ <br> MSIL/Agent AZX <br> MSIL/Agent BCH <br> MSIL/Agent BCV <br> MSIL/Agent BCY <br> MSIL/Agent BFT <br> MSIL/Agent BGB <br> MSIL/Agent BGC <br> MSIL/Agent BGE <br> MSIL/Agent BGM <br> MSIL/Agent BJU <br> MSIL/Agent SCM <br> MSIL/Spy Agent BBB <br> MSIL/Spy Agent BIF <br> MSIL/TrojanDownloader Agent DYV <br> MSIL/TrojanDownloader Small BBM <br> MSIL/TrojanDropper Agent DBE <br> MSIL/TrojanDropper Agent DJQ <br> MSIL/TrojanDropper Agent DJR <br></code> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr418165/">https://habr.com/ru/post/fr418165/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr418155/index.html">Diode LED Diode Zener</a></li>
<li><a href="../fr418157/index.html">Le livre "Objets √©l√©gants. √âdition Java ¬ª</a></li>
<li><a href="../fr418159/index.html">O√π aller chez le designer: prestigieux prix de la Russie, de l'Europe de l'Est et des pays de la CEI</a></li>
<li><a href="../fr418161/index.html">√Ä Stanford, des batteries de streaming √† temp√©rature ambiante ont √©t√© d√©velopp√©es</a></li>
<li><a href="../fr418163/index.html">Tests de production: Netflix Chaos Automation Platform</a></li>
<li><a href="../fr418167/index.html">ScadaPy: ajouter le protocole IEC 60870-5-104</a></li>
<li><a href="../fr418169/index.html">Quoi de neuf dans Veeam Availability Console 2.0 Update 1?</a></li>
<li><a href="../fr418171/index.html">Sur quelles mesures s'appuyer si les utilisateurs effectuent peu de conversions sur le site?</a></li>
<li><a href="../fr418173/index.html">Aller-retour pour les r√©seaux de neurones, ou un examen de l'utilisation des auto-encodeurs dans l'analyse de texte</a></li>
<li><a href="../fr418177/index.html">√âdition d'images .heic sans perte de couleur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>