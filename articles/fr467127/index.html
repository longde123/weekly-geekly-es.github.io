<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê≤ üîñ ‚ÜîÔ∏è Test des API √† l'aide de Postman et Excel ü§üüèΩ ‚úãüèª üçÖ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous, je suis le chef du d√©partement des tests, et r√©cemment une t√¢che pour tester l'API est apparue. Pour le r√©soudre, j'ai ma√Ætris√© le nou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Test des API √† l'aide de Postman et Excel</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467127/">  Bonjour √† tous, je suis le chef du d√©partement des tests, et r√©cemment une t√¢che pour tester l'API est apparue.  Pour le r√©soudre, j'ai ma√Ætris√© le nouvel outil Postman et JavaScript pour moi. <br><br>  Au d√©part, pour chaque API, j'ai √©crit mes collections et pr√©par√© des donn√©es de test au format JSON.  C'est assez pratique, mais avec un grand nombre de tests et de collections, il devient peu rentable de le maintenir.  Et il n'est pas pratique de valider des donn√©es en JSON. <br><br>  Pour r√©soudre ces probl√®mes, j'ai √©crit une macro pour Excel et une collection dans Postman.  Maintenant, dans Postman, j'ai une collection pour toutes les API et un ensemble standard de fonctions pour traiter les donn√©es entrantes et valider les r√©sultats renvoy√©s.  J'ai r√©ussi √† transf√©rer la gestion des donn√©es de test et la s√©quence d'ex√©cution des requ√™tes vers Excel. <br><br><h4>  Quel √©tait </h4><br>  1. JSON avec donn√©es <br><br><img src="https://habrastorage.org/webt/be/l-/78/bel-78hyknqwqra9c8qovryx9fm.png"><br>  <i>Auparavant, le kit de test √©tait stock√© sous cette forme</i> <br><a name="habracut"></a><br>  2. 2. La s√©quence d'ex√©cution des requ√™tes avec les gestionnaires JS a √©t√© stock√©e dans les collections Postman. <br><br><img src="https://habrastorage.org/webt/gi/tw/4j/gitw4j_h_todey0pzbyvou9sinc.png"><br><br><h4>  Qu'est devenu </h4><br>  1. Suite de tests d√©plac√©e vers Excel <br><br><img src="https://habrastorage.org/webt/j5/0e/fv/j50efvyvp-dspfoobtcpjgjbemg.png"><br><br>  Toutes les donn√©es sont saisies dans Excel (caract√®res cl√©s de contr√¥le: R, H, I, etc. je vais √©crire ci-dessous) puis, √† l'aide d'une macro, elles sont transf√©r√©es au format json: <br><br><img src="https://habrastorage.org/webt/y9/dp/5q/y9dp5q9c_fdj7_zbxun6-ebl1tk.png"><br><br>  2. Dans Postman <br><br><img src="https://habrastorage.org/webt/ry/mq/jl/rymqjl-zkqsqakx6fxuqkxpy110.png"><br><br>  L'exp√©rience a √©t√© men√©e sur un ensemble standard d'op√©rations CRUD, qui peuvent √™tre d√©velopp√©es davantage. <br><br>  √âtant donn√© que dans Postman, toutes les op√©rations sont effectu√©es uniquement dans le cadre de la demande, j'ai d√ª saisir une demande get vide √† la fin de laquelle la prochaine demande de la s√©quence est d√©termin√©e.  Ex√©cutez le code JS avant la demande et d√©terminez la premi√®re demande sans √©chec vide. <br><br>  Dans toutes les demandes, le script de pr√©-demande et les sections de test sont vides, tout le code est unifi√© pour les demandes et est stock√© dans les sections g√©n√©rales du script de pr√©-demande et du test du dossier Collection d'API. <br><br><img src="https://habrastorage.org/webt/dz/jc/ao/dzjcaoa2elumolbw2wbp_d1dhe0.png"><br><br>  Dans toutes les requ√™tes, il est important de faire attention √† l'url et √† la section Body dans les requ√™tes POST et PUT, leurs valeurs sont d√©termin√©es par des variables, dont les valeurs sont entr√©es depuis le JSON avec les donn√©es. <br><br><img src="https://habrastorage.org/webt/gj/yu/y0/gjyuy08umwwocw2aayfgd0legtm.png"><br><br><h4>  Maintenant sur les tests eux-m√™mes </h4><br><img src="https://habrastorage.org/webt/zg/as/ah/zgasahcnnfy4uv3w2cijha956kq.png"><br><br>  <b>Comment lire Excel</b> .  La premi√®re ligne non vide est le num√©ro du cas de test, c'est-√†-dire que le cas de test est stock√© verticalement et sur cette page il y a 9 cas de test.  Dans l'ensemble actuel, dans chaque cas de test, une demande POST sera ex√©cut√©e en premier, puis Supprimer. <br><br>  <b>Comment d√©marrer la g√©n√©ration Json √† partir d'Excel</b> .  Dans Excel, appuyez sur F11 et allez dans "EtaBook", lancez-y la macro. <br><br><h4>  Mots clefs </h4><br>  <b>R</b> - demande, signifie le d√©but d'une nouvelle demande, dans la deuxi√®me cellule de la ligne le type de demande est stock√©, dans la troisi√®me est l'adresse √† laquelle vous devez contacter.  Veuillez noter qu'en url vous pouvez sp√©cifier des variables Postman <br><br><img src="https://habrastorage.org/webt/9o/ex/nq/9oexnqprk9duapwq6zcxoe5hsae.png"><br>  <i>La valeur de la variable sera extraite</i> <br><br>  <b>H</b> - Donn√©es √† v√©rifier dans l'en-t√™te, jusqu'√† pr√©sent, seul le code de r√©ponse a √©t√© entr√©, Postman ne les v√©rifie que dans le facteur.  Il est important que dans Excel le nom soit le m√™me "code de r√©ponse", ou corrig√© dans Postman <br><br><img src="https://habrastorage.org/webt/74/26/if/7426ifzzmp0fljuy6t0tgzww5oo.png"><br><br>  <b>I, I2 ...</b> - La section des donn√©es d'entr√©e prend en charge le stockage des mod√®les de donn√©es de toute imbrication, la figure √† droite de I est responsable du niveau d'imbrication.  L'ensemble de donn√©es suivant est envelopp√© dans JSON comme ceci.  Si la variable qui stocke les donn√©es est vide, elle ne sera pas ajout√©e.  Autrement dit, s'il n'y a pas de valeur dans la variable inn, elle ne sera pas ajout√©e et la variable principale sera ajout√©e, car elle stocke le mod√®le.  De plus, si le mod√®le entier est vide, il ne sera pas ajout√© non plus. <br><br><img src="https://habrastorage.org/webt/x-/ku/bg/x-kubguayoz-z57pewwztbltnsq.png"><br>  <i>Les donn√©es de cette section seront soumises dans le corps de la demande</i> <br><br><img src="https://habrastorage.org/webt/mu/og/ne/muognet9_l6pj_l5gbc9ugici6q.png"><br><br>  <b>O, O2 ...</b> - Section des param√®tres de sortie, ils seront compar√©s √† ceux retourn√©s par r√©ponse.  Comme la section Input, il prend en charge le stockage de mod√®les. <br><br><img src="https://habrastorage.org/webt/i8/yz/xm/i8yzxm_jo-3bd5fgdvyfraz_g_u.png"><br>  <i>Lors de la comparaison, les donn√©es sont converties en cha√Æne, j'ai √©galement limit√© le niveau de r√©cursivit√©, cela peut √™tre supprim√©</i> <br><br>  <b>PO</b> - Postman Output, les valeurs de cette section seront extraites du corps de r√©ponse de la demande par le nom de la variable et √©crites dans la variable Postman. <br><br><img src="https://habrastorage.org/webt/vx/ho/fz/vxhofzpxvogjohpodrnu0zl9vvc.png"><br>  <i>Dans Excel, il suffit de mettre n'importe quel caract√®re, la valeur de la r√©ponse, pas Excel, est √©crite dans la variable</i> <br><br><img src="https://habrastorage.org/webt/-j/e9/qg/-je9qgf4r93uv3nhj69fksobm0c.png"><br>  <i>Cette section est n√©cessaire pour stocker des donn√©es entre des scripts, par exemple, pour supprimer un objet avec l'ID qui a √©t√© cr√©√© dans la demande pr√©c√©dente</i> <br><br>  <b>PC</b> - Commande Postman, introduite une seule commande ¬´terminate¬ª, elle est utilis√©e pour forcer la terminaison apr√®s l'ex√©cution de la requ√™te en cours.  Utile pour un test n√©gatif, afin de ne pas provoquer de suppression de l'objet cr√©√©. <br><br><img src="https://habrastorage.org/webt/b4/c-/a-/b4c-a-z_r2b4t_icmwb2fpsaerq.png"><br>  <i>La saisie de cette commande a permis de stocker les tests positifs et n√©gatifs sur une seule feuille</i> <br><br><img src="https://habrastorage.org/webt/18/w3/o-/18w3o-70cys7nv7dulrifg5ja7s.png"><br><br>  <b>PI</b> - Entr√©e Postman, les valeurs de cette section seront √©crites dans les variables Postman avant la d√©finition de l'URL <br><br><img src="https://habrastorage.org/webt/kh/rc/vz/khrcvzvphiglyotfonirlen-hr8.png"><br>  Cela peut √™tre utile si vous devez remplacer les variables sp√©cifi√©es dans l'URL de la demande. <br><br>  Soit dit en passant, vous pouvez utiliser les donn√©es des variables Postman dans les donn√©es fournies, pour cela, vous devez utiliser une conception sp√©ciale <br><br><img src="https://habrastorage.org/webt/v6/bv/8r/v6bv8r4dsxo3sslgpfnmqjk7cuy.png"><br><br>  Dans le cas 1, nous avons entr√© la valeur obtenue dans une variable, dans le cas 2, nous l'avons utilis√©e.  Il peut √™tre utilis√© non seulement dans le cas suivant, mais aussi dans le cas actuel √† la prochaine demande.  Par exemple, cela peut √™tre n√©cessaire si la d√©finition de l'objet de la modification ne suit pas l'URL, mais en fonction de la valeur de la variable dans la demande. <br><br><h4>  Pr√©paration √† la course </h4><br>  Et maintenant, ex√©cutez, ex√©cutez le coureur Postman, s√©lectionnez-y la collection souhait√©e et t√©l√©chargez le fichier avec les donn√©es de test: <br><br><img src="https://habrastorage.org/webt/qz/j7/v7/qzj7v7qfatkjb5qs9uanx8pj1gg.png"><br><br>  Nous servirons l'ensemble suivant: <br><br><img src="https://habrastorage.org/webt/yr/rl/e0/yrrle0uje4xycw_yfhtnkuel9io.png"><br><br>  15 tests sont d√©crits ici, les √©tapes 1-11, 13, 15 √©tant positives avec un r√©sultat de 200 pour une demande POST et les √©tapes 12, 14 sont n√©gatives avec un r√©sultat de 400. Les informations ne seront pas entr√©es dans la base de donn√©es et par cons√©quent la section Sortie est vide et la commande est indiqu√©e mettre fin.  Cette commande interrompra l'ex√©cution de la s√©quence et la demande de suppression de ¬´Supprimer¬ª ne sera pas envoy√©e. <br><br>  Apr√®s les cas 1-11, 13, 15, nous nous souvenons de l'ID qui a √©t√© attribu√© au nouvel objet, puis nous le supprimons. <br><br><h4>  Nous lan√ßons </h4><br><img src="https://habrastorage.org/webt/lv/i-/lp/lvi-lpm3jj-12nmimyar_tulyxu.png"><br>  <i>Les 15 tests ont r√©ussi, l'image montre le test 14, dans lequel la suppression n'est pas appel√©e apr√®s le POST</i> <br><br>  Dans les tests 1-11,13,15 apr√®s POST, la suppression de l'objet cr√©√© est appel√©e: <br><br><img src="https://habrastorage.org/webt/vz/i9/e3/vzi9e3bm7n2xyadpllytq-s1czm.png"><br><br><h4>  R√©sum√© </h4><br><ul><li>  La s√©quence de demandes de test de l'API est effectu√©e dans Excel et trait√©e dans Postman. </li><li>  Toutes les donn√©es de test sont √©galement rendues dans Excel, il est pratique de les g√©rer et de les valider.  Au moins plus pratique qu'au format JSON. </li><li>  La collection Postman est standardis√©e et n'a pas besoin d'√™tre am√©lior√©e lors du test d'API similaires. </li></ul><br><h4>  Les r√©f√©rences </h4><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">D√©p√¥t GitHub, il y a Excel et la collection Postman</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">En cours de d√©veloppement, un outil VBA-JSON cr√©√© par Tim Hall a √©t√© utilis√©</a> </li></ol><br><br>  <b>Mise √† jour du 15/10/2019</b> <br><br>  1. Am√©lioration de la possibilit√© de g√©n√©rer des fichiers json sans ex√©cuter Excel, placez-le dans le git GenerateAll.cmd, qui ex√©cute le script vb GenerateJsonFiles.vbs.  Le script appel√© passera par le dossier courant et tous les sous-dossiers et g√©n√©rera des fichiers json <br>  2. RunAll.cmd s'ex√©cute pour ex√©cuter tous les fichiers de donn√©es json g√©n√©r√©s, ainsi que le dossier actuel et tous les sous-dossiers.  √Ä c√¥t√© de chacun d'eux sera mis output-report.log avec les r√©sultats de l'ex√©cution. <br><br>  Maintenant, le vissage sur CI ne devrait pas √™tre un probl√®me.  Vous pouvez √©galement acc√©l√©rer la g√©n√©ration json pour git deploy et comparer les donn√©es dans excel pour les changements dans les fichiers json. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr467127/">https://habr.com/ru/post/fr467127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr467113/index.html">Comment garder l'utilisateur sur le site? Secrets d'utilisation</a></li>
<li><a href="../fr467115/index.html">¬´Ls¬ª atypique - √âdition Habr</a></li>
<li><a href="../fr467117/index.html">Les manuscrits ne br√ªlent pas: le secret de la long√©vit√© des rouleaux de la mer Morte remontant √† 250 av.</a></li>
<li><a href="../fr467119/index.html">Jouez √† IT-Alias ‚Äã‚Äãavec Badoo Engineers</a></li>
<li><a href="../fr467125/index.html">Jeu NES moderne √©crit dans un langage de type Lisp</a></li>
<li><a href="../fr467129/index.html">Redressement cognitif 2: apprentissage des illusions et des distorsions</a></li>
<li><a href="../fr467131/index.html">CLRium # 6: Rapport de paire sur Lock-Free, beaucoup de th√©orie et de connaissances pratiques</a></li>
<li><a href="../fr467135/index.html">P√©dale USB pour basculer entre les ordinateurs</a></li>
<li><a href="../fr467137/index.html">Assurer un fonctionnement fiable de l'√©quipe Zextras dans des r√©seaux d'entreprise complexes</a></li>
<li><a href="../fr467141/index.html">Mitapa Saint TeamLead Conf pour un sujet plus profond</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>