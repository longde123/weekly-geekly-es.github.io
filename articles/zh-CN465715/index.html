<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏝️ 🤞🏻 💆🏻 Openstack负载平衡（第2部分） 🎣 🌿 🧑🏿‍🤝‍🧑🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在上一篇文章中，我们讨论了如何尝试使用Watcher并提出了测试报告。 我们会定期进行此类测试，以平衡大型公司或运营商云的功能以及其他关键功能。 

 要解决的问题的高度复杂性可能需要几篇文章来描述我们的项目。 今天，我们发布了有关平衡云中虚拟机的系列文章的第二篇。 

 一些术语 
 VmWare...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Openstack负载平衡（第2部分）</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rostelecom/blog/465715/"> 在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">上一篇文章中，</a>我们讨论了如何尝试使用Watcher并提出了测试报告。 我们会定期进行此类测试，以平衡大型公司或运营商云的功能以及其他关键功能。 <br><br> 要解决的问题的高度复杂性可能需要几篇文章来描述我们的项目。 今天，我们发布了有关平衡云中虚拟机的系列文章的第二篇。 <br><br><h3> 一些术语 </h3><br>  VmWare引入了DRS（分布式资源调度程序）实用程序，以平衡其虚拟化环境的负载。 <br><br> 如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">searchvmware.techtarget.com/definition/VMware-DRS</a>所写 <br>  <i>“ VMware DRS（分布式资源调度程序）是一种实用程序，可在虚拟环境中平衡计算负载与可用资源。</i>  <i>该实用程序是称为VMware Infrastructure的虚拟化程序包的一部分。</i> <i><br><br></i>  <i>用户使用VMware DRS定义在虚拟机（VM）之间分配物理资源的规则。</i>  <i>可以将该实用程序配置为手动或自动控制。</i>  <i>可以轻松地添加，删除或重组VMware资源池。</i>  <i>如果需要，可以在不同业务部门之间隔离资源池。</i>  <i>如果一个或多个虚拟机的工作负荷发生巨大变化，则VMware DRS会在物理服务器之间重新分配虚拟机。</i>  <i>如果减少了总体工作量，则某些物理服务器可能会暂时关闭并且工作量会得到合并。”</i> <br><br><h3> 为什么需要平衡？ </h3><br><a name="habracut"></a><br> 我们认为，DRS是云不可或缺的功能，尽管这并不意味着DRS应该随时随地使用。 根据云的用途和需求，对DRS和平衡方法可能会有不同的要求。 也许在某些情况下根本不需要平衡。 甚至有害。 <br><br> 为了更好地了解DRS客户的需求和需求，并考虑其目标。 云可以分为公共云和私有云。 这是这些云与客户目标之间的主要区别。 <br><br><div class="scrollable-table"><table><tbody><tr><td></td><td> 私有云/大型企业客户 </td><td> 公有云/中小企业，人 </td></tr><tr><td> 运营商的主要标准和目标 </td><td> 提供可靠的服务或产品 </td><td> 在竞争激烈的市场中降低服务成本 </td></tr><tr><td> 服务要求 </td><td> 系统各个层面和所有要素的可靠性 <br><br> 保证性能 <br><br> 将虚拟机划分为几类 <br><br> 信息和物理数据安全 <br><br>  SLA和24/7支持 </td><td> 最大程度的服务便利 <br><br> 相对简单的服务 <br><br> 客户对数据负责 <br><br> 不需要VM优先级 <br><br> 标准服务级别的信息安全，客户责任 <br><br> 可能有故障 <br><br> 没有SLA，质量无法保证 <br><br> 邮件支持 <br><br> 备份是可选的 </td></tr><tr><td> 客户特征 </td><td> 应用范围非常广泛。 <br><br> 公司中继承的旧版应用程序。 <br><br> 每个客户端的复杂自定义体系结构。 <br><br> 相似性规则。 <br><br> 软件无需停止在7x24模式下即可工作。 <br><br> 即时备份工具。 <br><br> 可预测的客户循环负载。 </td><td>典型应用-网络平衡，Apache，WEB，VPN，SQL <br><br> 可以暂时停止应用程序 <br><br> 允许在云中任意分发VM <br><br> 客户端备份 <br><br> 统计上的平均负载可为大量客户预测。 </td></tr><tr><td> 对建筑的启示 </td><td> 土工聚类 <br><br> 集中式或分布式存储 <br><br> 保留的IBS </td><td> 计算节点上的本地数据存储 </td></tr><tr><td> 平衡目标 </td><td> 负载均衡 <br><br> 最大的应用响应速度 <br><br> 最小平衡延迟时间 <br><br> 仅在明确需要时进行平衡 <br><br> 得出预防性维护设备的结论 </td><td> 降低服务成本和运营商成本 <br><br> 在低负载的情况下禁用一些资源 <br><br> 节约能源 <br><br> 降低员工成本 </td></tr></tbody></table></div><br><br><h3> 我们为自己得出以下结论： </h3><br>  <b>对于</b>提供给大型企业客户的<b>私有云</b> ，可以在以下限制条件下应用DRS： <br><br><ul><li> 信息安全和计费相似性规则，以实现平衡； </li><li> 发生事故时是否有足够的资源； </li><li> 虚拟机数据驻留在集中式或分布式存储系统上； </li><li> 管理，备份和平衡程序的时间多样性； </li><li> 仅在客户端主机的总数之内进行平衡； </li><li> 仅在严重失衡之间进行平衡，才能最有效，最安全地迁移VM（毕竟迁移可能会失败）； </li><li> 平衡相对“安静”的虚拟机（“嘈杂”虚拟机的迁移可能需要很长时间）； </li><li> 考虑“成本”的平衡-存储系统和网络上的负载（具有针对大型客户的自定义体系结构）； </li><li> 平衡考虑到每个VM的个人行为； </li><li> 下班后（晚上，周末，节假日）保持平衡是可取的。 </li></ul><br>  <b>对于</b>为小型客户提供服务的<b>公共云</b> ，可以使用具有高级功能的DRS进行更多使用： <br><br><ul><li> 缺乏信息安全限制和相似性规则； </li><li> 云内的平衡； </li><li> 在任何合理时间保持平衡； </li><li> 平衡任何虚拟机； </li><li> 平衡“嘈杂的”虚拟机（以免干扰其余虚拟机）； </li><li> 虚拟机数据通常位于本地驱动器上； </li><li> 考虑平均存储和网络性能（云架构是统一的）； </li><li> 根据通用规则和数据中心行为的可用统计信息进行平衡。 </li></ul><br><h2> 问题复杂度 </h2><br> 平衡的困难在于DRS必须在许多不确定因素下工作： <br><br><ul><li> 每个客户信息系统的用户行为； </li><li> 信息系统服务器运行的算法； </li><li>  DBMS服务器行为 </li><li> 加载计算资源，存储，网络； </li><li> 彼此之间在争夺云资源方面的服务器交互。 </li></ul><br> 随着时间的流逝，大量虚拟应用程序服务器和数据库在云资源上的负载不断增加，其后果可能会发生，并且在不可预测的时间之后会产生不可预测的影响。 即使是用于控制相对简单的过程（例如，用于控制发动机，家用热水系统），自动控制系统也需要使用复杂的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">比例积分微分</a>反馈算法。 <br><br><img src="https://habrastorage.org/webt/82/5j/7x/825j7x1s3unwoacrnswrm4j9r_m.png"><br><br> 我们的任务要复杂许多数量级，并且存在即使没有发生用户外部影响的情况，系统也无法在合理的时间内将负载平衡到既定值的风险。 <br><br><img src="https://habrastorage.org/webt/4c/b9/a7/4cb9a70sso1h2dz_tlb4gzzuegg.gif"><br><br><h2> 我们发展的历史 </h2><br> 为了解决这个问题，我们决定不从头开始，而是以现有经验为基础，并开始与该领域的专家进行互动。 幸运的是，我们对问题的理解是完全吻合的。 <br><br><h3> 第一阶段 </h3><br> 我们使用了基于神经网络技术的系统，并尝试在此基础上优化我们的资源。 <br><br> 这个阶段的兴趣是测试新技术，其重要性是应用非标准方法来解决问题，而在其他条件相同的情况下，标准方法实际上已经用尽了。 <br><br> 我们启动了系统，然后我们真正达到了平衡。 云的规模无法让我们获得开发人员宣布的乐观结果，但是很明显，平衡是可行的。 <br><br> 而且，我们有相当严重的局限性： <br><br><ul><li> 要训​​练神经网络，虚拟机需要运行数周或数月而无需进行重大更改。 </li><li> 该算法被设计为基于对早期“历史”数据的分析进行优化。 </li><li> 为了训练神经网络，需要足够大量的数据和计算资源。 </li><li> 优化和平衡很少能完成-每隔几个小时一次，这显然是不够的。 </li></ul><br><h3> 第二阶段 </h3><br> 由于我们对事务状态不满意，因此我们决定修改系统，以回答<b>主要问题</b> -我们是为谁做的？ <br><br> 首先是企业客户。 因此，我们需要一个高效运行的系统，并具有那些只能简化实施的公司限制。 <br><br>  <b>第二个问题</b>是“运营”一词的含义是什么？ 经过短暂的辩论，我们认为可以在5-10分钟的响应时间基础上进行构建，以使短期跳跃不会使系统引起共振。 <br><br>  <b>第三个问题</b>是要选择平衡服务器数量的多少？ <br> 这个问题是由自己决定的。 通常，客户端不会使服务器聚合变得很大，这与本文中将聚合限制为30至40台服务器的建议是一致的。 <br><br> 另外，通过分割服务器池，我们简化了平衡算法的任务。 <br><br>  <b>第四个问题</b>是，神经网络在长期的学习过程和难得的平衡中适合我们多少？ 我们决定放弃它，转而使用更简单的运算算法，以便在几秒钟内获得结果。 <br><br><img src="https://habrastorage.org/webt/-9/vj/wy/-9vjwyj2x4a__iiszz7l9clhopq.png"><br><br> 在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此</a>可以找到使用这种算法的系统描述及其缺点<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">。</a> <br><br> 我们实施并启动了该系统，并获得了令人鼓舞的结果-现在，它可以定期分析云负载并就移动虚拟机提出建议，这些建议在很大程度上是正确的。 即使到现在，我们仍然可以通过提高现有虚拟机的质量来实现为新虚拟机释放10-15％的资源。 <br><br> <a href=""><img src="https://habrastorage.org/webt/ie/ky/wa/iekywainupnidp_73j55hc1dbnw.png"></a> <br><br> 当RAM或CPU检测到不平衡时，系统会向Tionics调度程序发出命令以执行所需虚拟机的实时迁移。 从监视系统可以看出，虚拟机从一个（上）主机移至另一（下）主机，并释放了上层主机上的内存（以黄色圆圈突出显示），分别占用了下层主机上的内存（以白色圆圈突出显示）。 <br><br> 现在，我们试图更准确地评估当前算法的有效性，并试图找出其中可能存在的错误。 <br><br><h3> 第三阶段 </h3><br> 您似乎可以对此保持冷静，等待有效的证明并结束本主题。 <br> 但是以下明显的优化机会正在推动我们迈入新的阶段。 <br><br><ol><li> 例如， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处的</a>统计数据表明，两处理器和四处理器系统的性能明显低于单处理器的系统。 这意味着与单处理器处理器相比，所有用户从多处理器系统中购买的CPU，RAM，SSD，LAN，FC所获得的收益要低得多。 </li><li> 资源规划人员自己可以处理严重的错误， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这是</a>有关此主题<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的文章之一</a> 。 </li><li> 英特尔和AMD提供的用于监视RAM和缓存的技术使您能够研究虚拟机的行为，并将其放置为使嘈杂的邻居不会干扰安静的虚拟机。 </li><li> 扩展参数集（网络，存储，虚拟机优先级，迁移成本，迁移准备情况）。 </li></ol><br><h2> 合计 </h2><br> 我们改进平衡算法的工作结果是一个明确的结论，即由于采用了现代算法，可以实现数据中心资源（25-30％）的显着优化并提高客户服务质量。 <br><br> 当然，基于神经网络的算法是一个有趣的解决方案，需要进一步开发，并且由于存在限制，因此不适用于解决私有云的体积特征问题。 同时，在较大规模的公共云中，该算法显示了良好的结果。 <br><br> 在以下文章中，我们将告诉您有关处理器，调度程序和高级平衡功能的更多信息。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN465715/">https://habr.com/ru/post/zh-CN465715/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN465691/index.html">在Python的ENM Ericsson中使用REST</a></li>
<li><a href="../zh-CN465703/index.html">如何通过交易所获得公司的额外收入：结构产品投资</a></li>
<li><a href="../zh-CN465709/index.html">JustCode-适用于Windows上的廉价计算机和平板电脑的高速浏览器</a></li>
<li><a href="../zh-CN465711/index.html">GDPR如何导致个人数据泄漏</a></li>
<li><a href="../zh-CN465713/index.html">给项目经理的内容：有关人事管理，软技能和DevOps的书籍</a></li>
<li><a href="../zh-CN465719/index.html">为什么在Android的3CX VoIP客户端中未收到PUSH通知</a></li>
<li><a href="../zh-CN465721/index.html">现有技术的可完全重用的航空航天系统</a></li>
<li><a href="../zh-CN465723/index.html">正算术：克服自己领域中的浮点数。 第一部分</a></li>
<li><a href="../zh-CN465725/index.html">培训Cisco 200-125 CCNA v3.0。 第28天。深入研究ACL</a></li>
<li><a href="../zh-CN465727/index.html">成为扎克伯格或童年程序员</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>