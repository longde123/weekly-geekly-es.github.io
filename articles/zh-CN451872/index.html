<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘… ğŸª ğŸ§¤ Pythonæ˜¯å¯»æ‰¾å–œæ¬¢æ—…è¡Œçš„äººçš„å»‰ä»·èˆªç­çš„åŠ©æ‰‹ ğŸ¥„ ğŸ¦ ğŸ‘„</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="è¿™ç¯‡æ–‡ç« çš„ä½œè€…ï¼ˆæˆ‘ä»¬ä»Šå¤©è¦ç¿»è¯‘çš„è¯‘æœ¬ï¼‰è¯´ï¼Œå¥¹çš„ç›®æ ‡æ˜¯è°ˆè®ºä½¿ç”¨Seleniumå¼€å‘Pythonç½‘ç»œæŠ“å–å·¥å…·ï¼Œè¯¥å·¥å…·æœç´¢æœºç¥¨ä»·æ ¼ã€‚ æœç´¢ç¥¨è¯æ—¶ï¼Œä½¿ç”¨çµæ´»çš„æ—¥æœŸï¼ˆç›¸å¯¹äºæŒ‡å®šæ—¥æœŸä¸º+-3å¤©ï¼‰ã€‚ Scraperå°†æœç´¢ç»“æœä¿å­˜åœ¨Excelæ–‡ä»¶ä¸­ï¼Œå¹¶å‘å¯åŠ¨å®ƒçš„äººå‘é€ä¸€å°ç”µå­é‚®ä»¶ï¼Œå…¶ä¸­åŒ…å«æœ‰å…³ä»–è®¾æ³•æ‰¾åˆ°çš„å†…å®¹çš„ä¸€èˆ¬...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pythonæ˜¯å¯»æ‰¾å–œæ¬¢æ—…è¡Œçš„äººçš„å»‰ä»·èˆªç­çš„åŠ©æ‰‹</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/451872/"> è¿™ç¯‡æ–‡ç« çš„ä½œè€…ï¼ˆæˆ‘ä»¬ä»Šå¤©è¦ç¿»è¯‘çš„è¯‘æœ¬ï¼‰è¯´ï¼Œå¥¹çš„ç›®æ ‡æ˜¯è°ˆè®ºä½¿ç”¨Seleniumå¼€å‘Pythonç½‘ç»œæŠ“å–å·¥å…·ï¼Œè¯¥å·¥å…·æœç´¢æœºç¥¨ä»·æ ¼ã€‚ æœç´¢ç¥¨è¯æ—¶ï¼Œä½¿ç”¨çµæ´»çš„æ—¥æœŸï¼ˆç›¸å¯¹äºæŒ‡å®šæ—¥æœŸä¸º+-3å¤©ï¼‰ã€‚  Scraperå°†æœç´¢ç»“æœä¿å­˜åœ¨Excelæ–‡ä»¶ä¸­ï¼Œå¹¶å‘å¯åŠ¨å®ƒçš„äººå‘é€ä¸€å°ç”µå­é‚®ä»¶ï¼Œå…¶ä¸­åŒ…å«æœ‰å…³ä»–è®¾æ³•æ‰¾åˆ°çš„å†…å®¹çš„ä¸€èˆ¬ä¿¡æ¯ã€‚ è¯¥é¡¹ç›®çš„ç›®çš„æ˜¯å¸®åŠ©æ—…è¡Œè€…æ‰¾åˆ°æœ€ä¼˜æƒ çš„ä»·æ ¼ã€‚ <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/xl/jo/rr/xljorr2xue-q63wegfrfyt5uxu4.jpeg"></a> <br><br> å¦‚æœæ‚¨åœ¨å¤„ç†ææ–™æ—¶æ„Ÿåˆ°è¿·å¤±ï¼Œè¯·é˜…è¯»æœ¬æ–‡ã€‚ <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">æˆ‘ä»¬åœ¨æ‰¾ä»€ä¹ˆï¼Ÿ</font> </h2><br> æ‚¨å¯ä»¥éšæ„ä½¿ç”¨æ­¤å¤„æè¿°çš„ç³»ç»Ÿã€‚ ä¾‹å¦‚ï¼Œæˆ‘ç”¨å®ƒæ¥æœç´¢å‘¨æœ«æ—…è¡Œå’Œæˆ‘çš„å®¶ä¹¡çš„é—¨ç¥¨ã€‚ å¦‚æœæ‚¨çœŸçš„æƒ³å¯»æ‰¾æœ‰åˆ©å¯å›¾çš„é—¨ç¥¨ï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œè„šæœ¬ï¼ˆä¸€ä¸ªç®€å•çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœåŠ¡å™¨</a> ï¼Œæ¯æœˆ130å¢å¸ƒï¼Œéå¸¸é€‚åˆæ­¤æ“ä½œï¼‰ï¼Œå¹¶ä½¿å…¶æ¯å¤©è¿è¡Œä¸€æ¬¡æˆ–ä¸¤æ¬¡ã€‚ æœç´¢ç»“æœå°†é€šè¿‡ç”µå­é‚®ä»¶å‘é€ç»™æ‚¨ã€‚ æ­¤å¤–ï¼Œæˆ‘å»ºè®®æ‚¨è¿›è¡Œæ‰€æœ‰é…ç½®ï¼Œä»¥ä¾¿è„šæœ¬å°†æœç´¢ç»“æœä¿å­˜åˆ°Excelæ–‡ä»¶ä¸­ï¼Œå¹¶å°†å…¶ä¿å­˜åœ¨Dropboxæ–‡ä»¶å¤¹ä¸­ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥éšæ—¶éšåœ°æŸ¥çœ‹æ­¤ç±»æ–‡ä»¶ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d39/b7b/f3b/d39b7bf3b4f8c11fa9617ae308f01247.png"></div><br>  <i><font color="#999999">æˆ‘å°šæœªå‘ç°é”™è¯¯çš„å…³ç¨ï¼Œä½†æˆ‘ç›¸ä¿¡è¿™æ˜¯å¯èƒ½çš„</font></i> <br><br> å¦‚å‰æ‰€è¿°ï¼Œåœ¨æœç´¢æ—¶ä½¿ç”¨â€œçµæ´»æ—¥æœŸâ€ï¼Œè„šæœ¬ä¼šæŸ¥æ‰¾è·ç»™å®šæ—¥æœŸä¸‰å¤©å†…çš„æŠ¥ä»·ã€‚ å°½ç®¡å¯åŠ¨è„šæœ¬æ—¶ï¼Œå®ƒä»…åœ¨ä¸€ä¸ªæ–¹å‘ä¸Šæœç´¢å•†å“ï¼Œä½†æ˜¯å¾ˆå®¹æ˜“å¯¹å…¶è¿›è¡Œä¼˜åŒ–ï¼Œä»¥ä½¿å…¶å¯ä»¥åœ¨å¤šä¸ªé£è¡Œæ–¹å‘ä¸Šæ”¶é›†æ•°æ®ã€‚ æœ‰äº†å®ƒçš„å¸®åŠ©ï¼Œæ‚¨ç”šè‡³å¯ä»¥æœç´¢é”™è¯¯çš„å…³ç¨ï¼Œè¿™æ ·çš„å‘ç°å¯èƒ½éå¸¸æœ‰è¶£ã€‚ <br><br><h2>  <font color="#3AC1EF">ä¸ºä»€ä¹ˆéœ€è¦å¦ä¸€ä¸ªåˆ®æ¿æœºï¼Ÿ</font> </h2><br> è€å®è¯´ï¼Œå½“æˆ‘ç¬¬ä¸€æ¬¡å¼€å§‹æŠ“å–ç½‘é¡µæ—¶ï¼Œå®ƒå¹¶ä¸æ˜¯ç‰¹åˆ«æœ‰è¶£ã€‚ æˆ‘æƒ³åœ¨é¢„æµ‹å»ºæ¨¡ï¼Œè´¢åŠ¡åˆ†æä»¥åŠå¯èƒ½çš„æ–‡æœ¬æƒ…æ„Ÿè‰²å½©åˆ†æé¢†åŸŸä¸­è¿›è¡Œæ›´å¤šçš„é¡¹ç›®ã€‚ ä½†æ˜¯äº‹å®è¯æ˜ï¼Œè¿™å¾ˆæœ‰è¶£-å¼„æ¸…æ¥šå¦‚ä½•åˆ›å»ºä¸€ä¸ªç¨‹åºæ¥æ”¶é›†ç½‘ç«™æ•°æ®ã€‚ å½“æˆ‘ç ”ç©¶è¿™ä¸ªä¸»é¢˜æ—¶ï¼Œæˆ‘æ„è¯†åˆ°WebæŠ“å–æ˜¯Internetçš„â€œå¼•æ“â€ã€‚ <br><br> æ‚¨å¯èƒ½ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå¤§èƒ†çš„å£°æ˜ã€‚ ä½†æ˜¯ï¼Œè¯·è€ƒè™‘ä¸€ä¸‹Googleå¦‚ä½•å¼€å§‹ä½¿ç”¨Larry Pageä½¿ç”¨Javaå’ŒPythonåˆ›å»ºçš„WebæŠ“å–å·¥å…·ã€‚  Googlebotä¸€ç›´åœ¨ç ”ç©¶å’Œæ¢ç´¢äº’è”ç½‘ï¼Œè¯•å›¾ä¸ºä»–ä»¬çš„ç”¨æˆ·æä¾›æœ€ä½³çš„ç­”æ¡ˆã€‚  WebæŠ“å–å…·æœ‰æ— é™æ•°é‡çš„åº”ç”¨ç¨‹åºï¼Œå³ä½¿æ‚¨åœ¨æ•°æ®ç§‘å­¦é¢†åŸŸå¯¹å…¶ä»–äº‹æƒ…æ„Ÿå…´è¶£ï¼Œé‚£ä¹ˆä¸ºäº†è·å–æ•°æ®è¿›è¡Œåˆ†æï¼Œæ‚¨ä¹Ÿå°†éœ€è¦ä¸€äº›æŠ“å–æŠ€èƒ½ã€‚ <br><br> æˆ‘åœ¨æœ€è¿‘è·å¾—çš„æœ‰å…³ç½‘ç»œæŠ“å–çš„ç²¾å½©<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¹¦ç±ä¸­</a>æ‰¾åˆ°äº†è¿™é‡Œä½¿ç”¨çš„ä¸€äº›æŠ€å·§ã€‚ åœ¨å…¶ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°è®¸å¤šå…³äºè¢«ç ”ç©¶è€…çš„å®é™…åº”ç”¨çš„ç®€å•ç¤ºä¾‹å’Œæƒ³æ³•ã€‚ æ­¤å¤–ï¼Œè¿˜æœ‰å…³äºreCaptchaæµ‹è¯•æ—è·¯çš„éå¸¸æœ‰è¶£çš„ä¸€ç« ã€‚ å¯¹æˆ‘æ¥è¯´ï¼Œè¿™æ˜¯ä¸ªæ–°é—»ï¼Œå› ä¸ºæˆ‘ä¸çŸ¥é“æœ‰è§£å†³è¿™äº›é—®é¢˜çš„ä¸“ç”¨å·¥å…·ç”šè‡³æ•´ä¸ªæœåŠ¡ã€‚ <br><br><h2>  <font color="#3AC1EF">ä½ å–œæ¬¢æ—…è¡Œå—ï¼Ÿ</font> </h2><br> å¯¹äºæœ¬èŠ‚æ ‡é¢˜ä¸­çš„ä¸€ä¸ªç®€å•ä¸”æ— å®³çš„é—®é¢˜ï¼Œäººä»¬ç»å¸¸ä¼šå¬åˆ°ä¸€ä¸ªè‚¯å®šçš„ç­”æ¡ˆï¼Œå…¶ä¸­æä¾›äº†å‡ ä¸ªä¸è¢«é—®åˆ°çš„äººæœ‰å…³çš„æ—…è¡Œæ•…äº‹ã€‚ æˆ‘ä»¬å¤§å¤šæ•°äººéƒ½ä¼šåŒæ„ï¼Œæ—…è¡Œæ˜¯æ·±å…¥æ–°çš„æ–‡åŒ–ç¯å¢ƒå¹¶æ‰©å¤§è§†é‡çš„ç»ä½³é€”å¾„ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæ‚¨é—®æŸäººæœ‰å…³ä»–æ˜¯å¦æƒ³è´­ä¹°æœºç¥¨çš„é—®é¢˜ï¼Œæˆ‘æ•¢è‚¯å®šï¼Œç­”æ¡ˆè¿œéå¦‚æ­¤è‚¯å®šã€‚ å®é™…ä¸Šï¼ŒPythonæ¥äº†ã€‚ <br><br> åœ¨åˆ›å»ºæœºç¥¨ä¿¡æ¯æœç´¢ç³»ç»Ÿçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è§£å†³çš„ç¬¬ä¸€ä¸ªä»»åŠ¡æ˜¯é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„å¹³å°æ¥è·å–ä¿¡æ¯ã€‚ å¯¹äºæˆ‘æ¥è¯´ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜å¹¶ä¸å®¹æ˜“ï¼Œä½†æ˜¯æœ€ç»ˆæˆ‘é€‰æ‹©äº†KayakæœåŠ¡ã€‚ æˆ‘å°è¯•äº†Momondoï¼ŒSkyscannerï¼ŒExpediaç­‰æœåŠ¡ï¼Œä½†æ˜¯é’ˆå¯¹è¿™äº›èµ„æºä¸Šçš„æœºå™¨äººçš„ä¿æŠ¤æœºåˆ¶æ˜¯ä¸å¯æ¸—é€çš„ã€‚ ç»è¿‡å¤šæ¬¡å°è¯•ï¼Œåœ¨æ­¤æœŸé—´ï¼Œä¸ºäº†è¯´æœæˆ‘è‡ªå·±æ˜¯äººç±»ï¼Œæˆ‘ä¸å¾—ä¸åº”å¯¹äº¤é€šä¿¡å·ç¯ï¼Œäººè¡Œæ¨ªé“å’Œè‡ªè¡Œè½¦ï¼Œæˆ‘å†³å®šè®©çš®è‰‡æœ€é€‚åˆæˆ‘ï¼Œå³ä½¿åœ¨è¿™é‡Œï¼Œå¦‚æœåœ¨çŸ­æ—¶é—´å†…åŠ è½½å¤ªå¤šé¡µé¢ï¼Œæ£€æŸ¥ä¹Ÿä¼šå¼€å§‹ã€‚ æˆ‘è®¾æ³•ä½¿æ¼«æ¸¸å™¨æ¯éš”4åˆ°6ä¸ªå°æ—¶å°±å°†è¯·æ±‚å‘é€åˆ°è¯¥ç«™ç‚¹ï¼Œå¹¶ä¸”ä¸€åˆ‡æ­£å¸¸ã€‚ ä½¿ç”¨Kayakæ—¶ï¼Œæœ‰æ—¶ä¼šé‡åˆ°å›°éš¾ï¼Œä½†æ˜¯å¦‚æœæ‚¨å¼€å§‹å—åˆ°æ£€æŸ¥çš„å›°æ‰°ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨å¤„ç†å®ƒä»¬ï¼Œç„¶åå¯åŠ¨æ¼«æ¸¸å™¨ï¼Œæˆ–è€…ç­‰å¾…å‡ ä¸ªå°æ—¶ï¼Œæ£€æŸ¥åº”è¯¥åœæ­¢ã€‚ å¦‚æœ‰å¿…è¦ï¼Œæ‚¨å¯ä»¥å¾ˆå¥½åœ°å°†ä»£ç æ”¹ç¼–ä¸ºå¦ä¸€ä¸ªå¹³å°ï¼Œå¦‚æœè¿™æ ·åšï¼Œåˆ™å¯ä»¥åœ¨æ³¨é‡Šä¸­æŠ¥å‘Šå®ƒã€‚ <br><br> å¦‚æœæ‚¨åªæ˜¯åˆšå¼€å§‹è¿›è¡Œç½‘é¡µæŠ“å–ï¼Œå¹¶ä¸”ä¸çŸ¥é“ä¸ºä»€ä¹ˆæœ‰äº›ç½‘ç«™ä¸ºæ­¤æ„Ÿåˆ°æŒ£æ‰ï¼Œé‚£ä¹ˆåœ¨å¼€å§‹è¯¥é¢†åŸŸçš„ç¬¬ä¸€ä¸ªé¡¹ç›®ä¹‹å‰ï¼Œè¯·å¸®ä¸ªå¿™ï¼Œå¹¶åœ¨Googleä¸­æœç´¢å•è¯â€œç½‘é¡µæŠ“å–ç¤¼èŠ‚â€ã€‚ å¦‚æœæ‚¨ä¸åˆç†åœ°è¿›è¡Œç½‘é¡µæŠ“å–ï¼Œåˆ™å®éªŒå¯èƒ½æ¯”æ‚¨æƒ³è±¡çš„è¦æ—©ç»“æŸã€‚ <br><br><h2>  <font color="#3AC1EF">å¼€å§‹ä½¿ç”¨</font> </h2><br> ä»¥ä¸‹æ˜¯æœ‰å…³æˆ‘ä»¬çš„ç½‘ç»œæŠ“å–å·¥å…·ä»£ç ä¸­å‘ç”Ÿçš„æƒ…å†µçš„ä¸€èˆ¬æ¦‚è¿°ï¼š <br><br><ul><li> å¯¼å…¥æ‰€éœ€çš„åº“ã€‚ </li><li> æ‰“å¼€Googâ€‹â€‹le Chromeæµè§ˆå™¨æ ‡ç­¾ã€‚ </li><li> è°ƒç”¨å¯åŠ¨æœºå™¨äººçš„å‡½æ•°ï¼Œå¹¶å‘å…¶ä¼ é€’åŸå¸‚å’Œæ—¥æœŸï¼Œè¿™å°†åœ¨æœç´¢ç¥¨è¯æ—¶ä½¿ç”¨ã€‚ </li><li> æ­¤åŠŸèƒ½æ¥æ”¶æŒ‰ç…§æœ€æœ‰å¸å¼•åŠ›ï¼ˆæœ€ä½³ï¼‰çš„æ¡ä»¶æ’åºçš„ç¬¬ä¸€ä¸ªæœç´¢ç»“æœï¼Œç„¶åæŒ‰æŒ‰é’®åŠ è½½å…¶ä»–ç»“æœã€‚ </li><li> å¦ä¸€ä¸ªå‡½æ•°ä»æ•´ä¸ªé¡µé¢æ”¶é›†æ•°æ®å¹¶è¿”å›ä¸€ä¸ªæ•°æ®å¸§ã€‚ </li><li> å‰é¢çš„ä¸¤ä¸ªæ­¥éª¤æ˜¯ä½¿ç”¨æŒ‰æœºç¥¨ä»·æ ¼ï¼ˆä¾¿å®œï¼‰å’Œé£è¡Œé€Ÿåº¦ï¼ˆæœ€å¿«ï¼‰çš„åˆ†ç±»ç±»å‹æ‰§è¡Œçš„ã€‚ </li><li> å°†å‘ç”µå­é‚®ä»¶ç”¨æˆ·å‘é€ä¸€å°ç”µå­é‚®ä»¶ï¼Œå…¶ä¸­åŒ…å«æœºç¥¨ä»·æ ¼çš„ç®€è¦æ‘˜è¦ï¼ˆæœ€ä¾¿å®œçš„æœºç¥¨å’Œå¹³å‡ä»·æ ¼ï¼‰ï¼Œå¹¶ä¸”å…·æœ‰æŒ‰ä¸Šè¿°ä¸‰ä¸ªæŒ‡æ ‡æ’åºçš„ä¿¡æ¯çš„æ•°æ®æ¡†è¢«ä¿å­˜ä¸ºExcelæ–‡ä»¶ã€‚ </li><li> æ‰€æœ‰ä¸Šè¿°æ“ä½œåœ¨æŒ‡å®šçš„æ—¶é—´æ®µåå¾ªç¯æ‰§è¡Œã€‚ </li></ul><br> åº”å½“æ³¨æ„ï¼Œæ¯ä¸ªSeleniumé¡¹ç›®éƒ½ä»¥Webé©±åŠ¨ç¨‹åºå¼€å¤´ã€‚ æˆ‘ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Chromedriver</a> ï¼Œå¯ä¸Google Chromeä¸€èµ·ä½¿ç”¨ï¼Œä½†è¿˜æœ‰å…¶ä»–é€‰æ‹©ã€‚  PhantomJSå’ŒFirefoxä¹Ÿå¾ˆå—æ¬¢è¿ã€‚ åŠ è½½é©±åŠ¨ç¨‹åºåï¼Œéœ€è¦å°†å…¶æ”¾ç½®åœ¨é€‚å½“çš„æ–‡ä»¶å¤¹ä¸­ï¼Œä»¥å®Œæˆå…¶ä½¿ç”¨çš„å‡†å¤‡å·¥ä½œã€‚ è„šæœ¬çš„ç¬¬ä¸€è¡Œæ‰“å¼€ä¸€ä¸ªæ–°çš„Chromeæ ‡ç­¾ã€‚ <br><br> è¯·è®°ä½ï¼Œåœ¨æˆ‘çš„æ•…äº‹ä¸­ï¼Œæˆ‘å¹¶æ²¡æœ‰å°è¯•å¼€è¾Ÿæ–°çš„è§†é‡æ¥å¯»æ‰¾æœºç¥¨çš„æœ‰åˆ©å¯å›¾ã€‚ æœ‰å¾ˆå¤šæ›´å…ˆè¿›çš„æŠ€æœ¯å¯ä»¥æ‰¾åˆ°è¿™æ ·çš„æŠ¥ä»·ã€‚ æˆ‘åªæ˜¯æƒ³ä¸ºè¯»è€…æä¾›ä¸€ç§ç®€å•è€Œå®ç”¨çš„æ–¹æ³•æ¥è§£å†³æ­¤é—®é¢˜ã€‚ <br><br> è¿™æ˜¯æˆ‘ä»¬ä¸Šé¢è®¨è®ºçš„ä»£ç ã€‚ <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sleep, strftime <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> randint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> selenium <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> webdriver <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> selenium.webdriver.common.keys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Keys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> smtplib <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> email.mime.multipart <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MIMEMultipart <span class="hljs-comment"><span class="hljs-comment">#      chromedriver! chromedriver_path = 'C:/{YOUR PATH HERE}/chromedriver_win32/chromedriver.exe' driver = webdriver.Chrome(executable_path=chromedriver_path) #     Chrome sleep(2)</span></span></code> </pre> <br> åœ¨ä»£ç çš„å¼€å¤´ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æ•´ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨çš„åŒ…å¯¼å…¥å‘½ä»¤ã€‚ å› æ­¤ï¼Œä½¿ç”¨<code>randint</code>ä»¥ä¾¿è¯¥æœºå™¨äººåœ¨å¼€å§‹æ–°çš„æœç´¢æ“ä½œä¹‹å‰ä¼šâ€œç¡ç€â€å‡ ç§’é’Ÿã€‚ é€šå¸¸æ²¡æœ‰ä¸€ä¸ªæœºå™¨äººå°±ä¸èƒ½æ²¡æœ‰å®ƒã€‚ å¦‚æœæ‚¨è¿è¡Œä¸Šè¿°ä»£ç ï¼Œåˆ™ä¼šæ‰“å¼€ä¸€ä¸ªChromeçª—å£ï¼Œè¯¥æ¼«æ¸¸å™¨å°†ä½¿ç”¨è¯¥çª—å£æ¥å¤„ç†ç½‘ç«™ã€‚ <br><br> è®©æˆ‘ä»¬åšä¸€ä¸ªå°å®éªŒï¼Œåœ¨å•ç‹¬çš„çª—å£ä¸­æ‰“å¼€kayak.comç½‘ç«™ã€‚ é€‰æ‹©æˆ‘ä»¬è¦é£å¾€çš„åŸå¸‚ï¼Œè¦åˆ°è¾¾çš„åŸå¸‚ä»¥åŠèˆªç­æ—¥æœŸã€‚ é€‰æ‹©æ—¥æœŸæ—¶ï¼Œæˆ‘ä»¬å°†éªŒè¯èŒƒå›´ä¸º+ -3å¤©ã€‚ æˆ‘åœ¨ç¼–å†™ä»£ç æ—¶è€ƒè™‘åˆ°äº†ç½‘ç«™æ ¹æ®æ­¤ç±»è¯·æ±‚ç”Ÿæˆçš„å†…å®¹ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨åªéœ€è¦æœç´¢ç»™å®šæ—¥æœŸçš„ç¥¨è¯ï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½å¿…é¡»ä¿®æ”¹æœºå™¨äººä»£ç ã€‚ åœ¨è®¨è®ºä»£ç æ—¶ï¼Œæˆ‘ä¼šåšå‡ºé€‚å½“çš„è§£é‡Šï¼Œä½†æ˜¯å¦‚æœæ‚¨æ„Ÿåˆ°å›°æƒ‘ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚ <br><br> ç°åœ¨ï¼Œå•å‡»æœç´¢å¼€å§‹æŒ‰é’®ï¼Œç„¶åæŸ¥çœ‹åœ°å€æ ä¸­çš„é“¾æ¥ã€‚ å®ƒçœ‹èµ·æ¥åƒæˆ‘åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ä½¿ç”¨çš„é“¾æ¥ï¼Œå…¶ä¸­å£°æ˜äº†å­˜å‚¨URLçš„<code>kayak</code>å˜é‡ï¼Œå¹¶ä½¿ç”¨äº†Webé©±åŠ¨ç¨‹åºçš„<code>get</code>æ–¹æ³•ã€‚ å•å‡»æœç´¢æŒ‰é’®åï¼Œç»“æœåº”æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ae6/ac7/1f7/ae6ac71f71c92c6ff76d5dd6a8fcfa25.png"></div><br> å½“æˆ‘åœ¨å‡ åˆ†é’Ÿå†…å¤šæ¬¡ä½¿ç”¨<code>get</code>å‘½ä»¤ä¸¤æ¬¡è‡³ä¸‰æ¬¡æ—¶ï¼Œè¦æ±‚æˆ‘é€šè¿‡reCaptchaé€šè¿‡æµ‹è¯•ã€‚ æ‚¨å¯ä»¥æ‰‹åŠ¨è¿›è¡Œæ­¤æ£€æŸ¥ï¼Œç„¶åç»§ç»­è¿›è¡Œå®éªŒï¼Œç›´åˆ°ç³»ç»Ÿå†³å®šå®‰æ’æ–°çš„æ£€æŸ¥ä¸ºæ­¢ã€‚ å½“æˆ‘æµ‹è¯•è„šæœ¬æ—¶ï¼Œæˆ‘è§‰å¾—ç¬¬ä¸€ä¸ªæœç´¢ä¼šè¯æ€»æ˜¯æ²¡æœ‰é—®é¢˜ï¼Œå› æ­¤ï¼Œå¦‚æœæ‚¨è¦å°è¯•ä½¿ç”¨è¯¥ä»£ç ï¼Œåˆ™åªéœ€å®šæœŸæ‰‹åŠ¨å¯¹å…¶è¿›è¡Œæ£€æŸ¥ï¼Œå¹¶ä½¿ä»£ç åœ¨æœç´¢ä¼šè¯ä¹‹é—´ä½¿ç”¨è¾ƒé•¿çš„æ—¶é—´é—´éš”å³å¯æ‰§è¡Œã€‚ æ˜¯çš„ï¼Œå¦‚æœæ‚¨è€ƒè™‘ä¸€ä¸‹ï¼Œä¸€ä¸ªäººä¸å¤ªå¯èƒ½éœ€è¦åœ¨æœç´¢æ“ä½œä¹‹é—´é—´éš”10åˆ†é’Ÿæ‰èƒ½è·å¾—çš„æœºç¥¨ä»·æ ¼ä¿¡æ¯ã€‚ <br><br><h2>  <font color="#3AC1EF">ä½¿ç”¨XPathå¤„ç†é¡µé¢</font> </h2><br> å› æ­¤ï¼Œæˆ‘ä»¬æ‰“å¼€äº†çª—å£å¹¶åŠ è½½äº†ç½‘ç«™ã€‚ è¦è·å–ä»·æ ¼å’Œå…¶ä»–ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨XPathæŠ€æœ¯æˆ–CSSé€‰æ‹©å™¨ã€‚ æˆ‘å†³å®šåœç•™åœ¨XPathä¸Šï¼Œå¹¶ä¸”ä¸è§‰å¾—éœ€è¦ä½¿ç”¨CSSé€‰æ‹©å™¨ï¼Œä½†æ˜¯è¿™æ ·åšå¾ˆæœ‰å¯èƒ½ã€‚ ä½¿ç”¨XPathåœ¨é¡µé¢ä¸Šç§»åŠ¨å¯èƒ½æ˜¯ä¸€é¡¹è‰°å·¨çš„ä»»åŠ¡ï¼Œå³ä½¿ä½¿ç”¨æœ¬æ–‡ä¸­ä»‹ç»çš„æ–¹æ³•ï¼ˆè¯¥æ–¹æ³•ä½¿ç”¨äº†ä»é¡µé¢ä»£ç ä¸­å¤åˆ¶ç›¸åº”çš„æ ‡è¯†ç¬¦ï¼‰ï¼Œæˆ‘ä¹Ÿæ„è¯†åˆ°ï¼Œè¿™å®é™…ä¸Šå¹¶ä¸æ˜¯æœ€ä½³çš„è®¿é—®æ–¹å¼å¿…è¦çš„å…ƒç´ ã€‚ é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œåœ¨æœ¬ä¹¦ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°æœ‰å…³ä½¿ç”¨XPathå’ŒCSSé€‰æ‹©å™¨å¤„ç†é¡µé¢çš„åŸºç¡€çŸ¥è¯†çš„å‡ºè‰²è¯´æ˜ã€‚ è¿™æ˜¯ç›¸åº”çš„Webé©±åŠ¨ç¨‹åºæ–¹æ³•çš„å¤–è§‚ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fa6/5c0/5c0/fa65c05c0385c658a4eee0c08a6274ff.png"></div><br> å› æ­¤ï¼Œæˆ‘ä»¬å°†ç»§ç»­è‡´åŠ›äºè¯¥æœºå™¨äººã€‚ åˆ©ç”¨è¯¥ç¨‹åºé€‰æ‹©æœ€ä¾¿å®œçš„è½¦ç¥¨ã€‚ åœ¨ä¸‹å›¾ä¸­ï¼ŒXPathé€‰æ‹©å™¨ä»£ç ä»¥çº¢è‰²çªå‡ºæ˜¾ç¤ºã€‚ ä¸ºäº†æŸ¥çœ‹ä»£ç ï¼Œæ‚¨éœ€è¦å³é”®å•å‡»æ„Ÿå…´è¶£çš„é¡µé¢å…ƒç´ ï¼Œç„¶ååœ¨å‡ºç°çš„èœå•ä¸­é€‰æ‹©â€œæ£€æŸ¥â€å‘½ä»¤ã€‚ å¯ä»¥é’ˆå¯¹ä¸åŒçš„é¡µé¢å…ƒç´ è°ƒç”¨æ­¤å‘½ä»¤ï¼Œå…¶é¡µé¢ä»£ç å°†åœ¨ä»£ç æŸ¥çœ‹çª—å£ä¸­æ˜¾ç¤ºå¹¶çªå‡ºæ˜¾ç¤ºã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2c4/eee/9dc/2c4eee9dc28a8ef0ff540e1c01d3eda5.png"></div><br>  <i><font color="#999999">æŸ¥çœ‹é¡µé¢ä»£ç </font></i> <br><br> ä¸ºäº†ç¡®è®¤æˆ‘å¯¹ä»ä»£ç ä¸­å¤åˆ¶é€‰æ‹©å™¨çš„ç¼ºç‚¹çš„æ¨ç†ï¼Œè¯·æ³¨æ„ä»¥ä¸‹åŠŸèƒ½ã€‚ <br><br> è¿™æ˜¯å¤åˆ¶ä»£ç æ—¶å¾—åˆ°çš„ï¼š <br><br><pre> <code class="python hljs">//*[@id=<span class="hljs-string"><span class="hljs-string">"wtKI-price_aTab"</span></span>]/div[<span class="hljs-number"><span class="hljs-number">1</span></span>]/div/div/div[<span class="hljs-number"><span class="hljs-number">1</span></span>]/div/span/span</code> </pre> <br> ä¸ºäº†å¤åˆ¶ç±»ä¼¼å†…å®¹ï¼Œæ‚¨éœ€è¦å³é”®å•å‡»æ‚¨æ„Ÿå…´è¶£çš„ä»£ç éƒ¨åˆ†ï¼Œç„¶åä»å‡ºç°çš„èœå•ä¸­é€‰æ‹©â€œå¤åˆ¶â€&gt;â€œå¤åˆ¶XPathâ€ã€‚ <br><br> è¿™æ˜¯æˆ‘ç”¨æ¥å®šä¹‰â€œæœ€ä¾¿å®œâ€æŒ‰é’®çš„å†…å®¹ï¼š <br><br><pre> <code class="python hljs">cheap_results = <span class="hljs-string"><span class="hljs-string">'//a[@data-code = "price"]'</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9c9/4e3/8a4/9c94e38a436fa588ade8a2f92d97aa2d.png"></div><br>  <i><font color="#999999">å¤åˆ¶&gt;å¤åˆ¶XPathå‘½ä»¤</font></i> <br><br> å¾ˆæ˜æ˜¾ï¼Œç¬¬äºŒç§é€‰æ‹©çœ‹èµ·æ¥ç®€å•å¾—å¤šã€‚ ä½¿ç”¨å®ƒæ—¶ï¼Œå®ƒå°†æœç´¢å…ƒç´ aï¼Œè¯¥å…ƒç´ çš„<code>data-code</code>å±æ€§ç­‰äº<code>price</code> ã€‚ ä½¿ç”¨ç¬¬ä¸€ä¸ªé€‰é¡¹ï¼Œå°†æœç´¢ä¸€ä¸ª<code>id</code>å…ƒç´ ï¼Œå…¶ä¸º<code>wtKI-price_aTab</code> ï¼Œå¹¶ä¸”è¯¥å…ƒç´ çš„XPathè·¯å¾„ç±»ä¼¼äº<code>/div[1]/div/div/div[1]/div/span/span</code> ã€‚ å¯¹é¡µé¢çš„ç±»ä¼¼XPathè¯·æ±‚å°†å®Œæˆæ­¤æ“ä½œï¼Œä½†ä»…æ‰§è¡Œä¸€æ¬¡ã€‚ æˆ‘ç°åœ¨å¯ä»¥è¯´ï¼Œä¸‹æ¬¡åŠ è½½é¡µé¢æ—¶<code>id</code>ä¼šæ›´æ”¹ã€‚ æ¯æ¬¡åŠ è½½é¡µé¢æ—¶ï¼Œ <code>wtKI</code>å­—ç¬¦<code>wtKI</code>éƒ½ä¼šåŠ¨æ€å˜åŒ–ï¼Œå› æ­¤ï¼Œåœ¨ä¸‹ä¸€é¡µé‡æ–°åŠ è½½åï¼Œä½¿ç”¨å®ƒçš„ä»£ç å°†æ— ç”¨ã€‚ å› æ­¤ï¼ŒèŠ±ä¸€äº›æ—¶é—´å¼„æ¸…æ¥šXPathã€‚ è¿™äº›çŸ¥è¯†å°†å¾ˆå¥½åœ°ä¸ºæ‚¨æœåŠ¡ã€‚ <br><br> ä½†æ˜¯ï¼Œåº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨éå¸¸ç®€å•çš„ç«™ç‚¹æ—¶ï¼Œå¤åˆ¶XPathé€‰æ‹©å™¨å¯èƒ½ä¼šæ´¾ä¸Šç”¨åœºï¼Œå¦‚æœé€‚åˆæ‚¨çš„è¯ï¼Œé‚£æ²¡æœ‰ä»€ä¹ˆé”™ã€‚ <br><br> ç°åœ¨ï¼Œè®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹å¦‚æœéœ€è¦åœ¨åˆ—è¡¨å†…çš„å¤šè¡Œä¸­è·å–æ‰€æœ‰æœç´¢ç»“æœè¯¥æ€ä¹ˆåŠã€‚ å¾ˆç®€å• æ¯ä¸ªç»“æœéƒ½åœ¨å¸¦æœ‰<code>resultWrapper</code>ç±»çš„å¯¹è±¡å†…ã€‚ ä¸‹è½½æ‰€æœ‰ç»“æœçš„è¿‡ç¨‹å¯ä»¥ç±»ä¼¼äºä¸‹é¢æ‰€ç¤ºçš„å¾ªç¯è¿›è¡Œã€‚ <br><br> åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ‚¨äº†è§£ä¸Šè¿°å†…å®¹ï¼Œé‚£ä¹ˆæ‚¨åº”è¯¥å¾ˆå®¹æ˜“ç†è§£æˆ‘ä»¬å°†è§£æçš„å¤§å¤šæ•°ä»£ç ã€‚ åœ¨ç¼–å†™æ­¤ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æŸç§æœºåˆ¶æ¥æŒ‡ç¤ºè·¯å¾„ï¼ˆXPathï¼‰ï¼Œä»¥è½¬åˆ°æ‰€éœ€çš„å†…å®¹ï¼ˆå®é™…ä¸Šï¼Œè¿™æ˜¯åŒ…è£…ç»“æœçš„å…ƒç´ ï¼‰ã€‚ è¿™æ ·åšæ˜¯ä¸ºäº†è·å–å…ƒç´ çš„æ–‡æœ¬å¹¶å°†å…¶æ”¾ç½®åœ¨å¯ä»¥ä»ä¸­è¯»å–æ•°æ®çš„å¯¹è±¡ä¸­ï¼ˆé¦–å…ˆä½¿ç”¨<code>flight_containers</code> ï¼Œç„¶åä½¿ç”¨<code>flights_list</code> ï¼‰ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0b2/3fc/b7f/0b23fcb7f32738fd6012541c40f68b97.png"></div><br> æ˜¾ç¤ºå‰ä¸‰è¡Œï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°æˆ‘ä»¬éœ€è¦çš„æ‰€æœ‰å†…å®¹ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬æœ‰æ›´å¤šæœ‰è¶£çš„æ–¹å¼æ¥è·å–ä¿¡æ¯ã€‚ æˆ‘ä»¬éœ€è¦åˆ†åˆ«ä»æ¯ä¸ªå…ƒç´ ä¸­è·å–æ•°æ®ã€‚ <br><br><h2>  <font color="#3AC1EF">ä¸Šç­ï¼</font> </h2><br> ç¼–å†™å‡½æ•°ä»¥åŠ è½½å…¶ä»–ç»“æœæ˜¯æœ€ç®€å•çš„ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å¼€å§‹å§ã€‚ æˆ‘æƒ³æœ€å¤§ç¨‹åº¦åœ°å¢åŠ ç¨‹åºæ¥æ”¶æœ‰å…³èˆªç­çš„èˆªç­æ•°é‡ï¼ŒåŒæ—¶åˆä¸ä¼šå¼•èµ·æœåŠ¡ä¸­å¯¼è‡´éªŒè¯çš„æ€€ç–‘ï¼Œå› æ­¤ï¼Œæ¯æ¬¡æ˜¾ç¤ºè¯¥é¡µé¢æ—¶ï¼Œæˆ‘éƒ½ä¼šå•å‡»â€œåŠ è½½æ›´å¤šç»“æœâ€æŒ‰é’®ã€‚ åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæ‚¨åº”æ³¨æ„<code>try</code>å—ï¼Œç”±äºæœ‰æ—¶æŒ‰é’®æ— æ³•æ­£å¸¸åŠ è½½ï¼Œæˆ‘æ·»åŠ äº†<code>try</code>å—ã€‚ å¦‚æœæ‚¨ä¹Ÿé‡åˆ°è¿™ç§æƒ…å†µï¼Œè¯·åœ¨<code>start_kayak</code>å‡½æ•°çš„ä»£ç ä¸­<code>start_kayak</code>å‡½æ•°çš„è°ƒç”¨ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢è®¨è®ºã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      ,      def load_more():   try:       more_results = '//a[@class = "moreButton"]'       driver.find_element_by_xpath(more_results).click()       #            ,          print('sleeping.....')       sleep(randint(45,60))   except:       pass</span></span></code> </pre> <br> ç°åœ¨ï¼Œåœ¨å¯¹æ­¤åŠŸèƒ½è¿›è¡Œäº†é•¿æ—¶é—´åˆ†æä¹‹åï¼ˆæœ‰æ—¶æˆ‘å¯èƒ½ä¼šè¢«è¿·ä½ï¼‰ï¼Œæˆ‘ä»¬å‡†å¤‡å£°æ˜ä¸€ä¸ªå°†å¤„ç†é¡µé¢æŠ“å–çš„åŠŸèƒ½ã€‚ <br><br> æˆ‘å·²ç»æ”¶é›†äº†ç§°ä¸º<code>page_scrape</code>çš„ä¸‹ä¸€ä¸ªå‡½æ•°ä¸­çš„å¤§éƒ¨åˆ†åŠŸèƒ½ã€‚ æœ‰æ—¶è¿”å›çš„æœ‰å…³è·¯å¾„å„é˜¶æ®µçš„æ•°æ®è¢«åˆå¹¶åœ¨ä¸€èµ·ï¼Œå¯¹äºå®ƒä»¬çš„åˆ†ç¦»ï¼Œæˆ‘ä½¿ç”¨ä¸€ç§ç®€å•çš„æ–¹æ³•ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ç¬¬ä¸€æ¬¡ä½¿ç”¨å˜é‡<code>section_a_list</code>å’Œ<code>section_b_list</code> ã€‚ æˆ‘ä»¬çš„å‡½æ•°è¿”å›æ•°æ®å¸§<code>flights_df</code> ï¼Œè¿™ä½¿æˆ‘ä»¬å¯ä»¥åˆ†ç¦»ä½¿ç”¨ä¸åŒæ•°æ®æ’åºæ–¹æ³•è·å¾—çš„ç»“æœï¼Œç„¶åå°†å®ƒä»¬ç»„åˆèµ·æ¥ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">page_scrape</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span>   <span class="hljs-string"><span class="hljs-string">"""This function takes care of the scraping part"""</span></span>     xp_sections = <span class="hljs-string"><span class="hljs-string">'//*[@class="section duration"]'</span></span>   sections = driver.find_elements_by_xpath(xp_sections)   sections_list = [value.text <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> value <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sections]   section_a_list = sections_list[::<span class="hljs-number"><span class="hljs-number">2</span></span>] <span class="hljs-comment"><span class="hljs-comment">#          section_b_list = sections_list[1::2]     #     reCaptcha,    - .   #  ,  -   ,     ,       #   if        -   #    ,           #    SystemExit           if section_a_list == []:       raise SystemExit     #     A     B     a_duration = []   a_section_names = []   for n in section_a_list:       #         a_section_names.append(''.join(n.split()[2:5]))       a_duration.append(''.join(n.split()[0:2]))   b_duration = []   b_section_names = []   for n in section_b_list:       #         b_section_names.append(''.join(n.split()[2:5]))       b_duration.append(''.join(n.split()[0:2]))   xp_dates = '//div[@class="section date"]'   dates = driver.find_elements_by_xpath(xp_dates)   dates_list = [value.text for value in dates]   a_date_list = dates_list[::2]   b_date_list = dates_list[1::2]   #      a_day = [value.split()[0] for value in a_date_list]   a_weekday = [value.split()[1] for value in a_date_list]   b_day = [value.split()[0] for value in b_date_list]   b_weekday = [value.split()[1] for value in b_date_list]     #     xp_prices = '//a[@class="booking-link"]/span[@class="price option-text"]'   prices = driver.find_elements_by_xpath(xp_prices)   prices_list = [price.text.replace('$','') for price in prices if price.text != '']   prices_list = list(map(int, prices_list))   # stops -   ,         ,   -     xp_stops = '//div[@class="section stops"]/div[1]'   stops = driver.find_elements_by_xpath(xp_stops)   stops_list = [stop.text[0].replace('n','0') for stop in stops]   a_stop_list = stops_list[::2]   b_stop_list = stops_list[1::2]   xp_stops_cities = '//div[@class="section stops"]/div[2]'   stops_cities = driver.find_elements_by_xpath(xp_stops_cities)   stops_cities_list = [stop.text for stop in stops_cities]   a_stop_name_list = stops_cities_list[::2]   b_stop_name_list = stops_cities_list[1::2]     #   -,          xp_schedule = '//div[@class="section times"]'   schedules = driver.find_elements_by_xpath(xp_schedule)   hours_list = []   carrier_list = []   for schedule in schedules:       hours_list.append(schedule.text.split('\n')[0])       carrier_list.append(schedule.text.split('\n')[1])   #          a  b   a_hours = hours_list[::2]   a_carrier = carrier_list[1::2]   b_hours = hours_list[::2]   b_carrier = carrier_list[1::2]     cols = (['Out Day', 'Out Time', 'Out Weekday', 'Out Airline', 'Out Cities', 'Out Duration', 'Out Stops', 'Out Stop Cities',           'Return Day', 'Return Time', 'Return Weekday', 'Return Airline', 'Return Cities', 'Return Duration', 'Return Stops', 'Return Stop Cities',           'Price'])   flights_df = pd.DataFrame({'Out Day': a_day,                              'Out Weekday': a_weekday,                              'Out Duration': a_duration,                              'Out Cities': a_section_names,                              'Return Day': b_day,                              'Return Weekday': b_weekday,                              'Return Duration': b_duration,                              'Return Cities': b_section_names,                              'Out Stops': a_stop_list,                              'Out Stop Cities': a_stop_name_list,                              'Return Stops': b_stop_list,                              'Return Stop Cities': b_stop_name_list,                              'Out Time': a_hours,                              'Out Airline': a_carrier,                              'Return Time': b_hours,                              'Return Airline': b_carrier,                                                     'Price': prices_list})[cols]     flights_df['timestamp'] = strftime("%Y%m%d-%H%M") #      return flights_df</span></span></code> </pre> <br> æˆ‘è¯•å›¾å‘½åå˜é‡ï¼Œä»¥ä¾¿ä»£ç æ¸…æ™°ã€‚ è¯·è®°ä½ï¼Œä»¥<code>a</code>å¼€å¤´çš„å˜é‡æ˜¯è·¯å¾„çš„ç¬¬ä¸€æ­¥ï¼Œè€Œ<code>b</code>æ˜¯ç¬¬äºŒæ­¥ã€‚ è½¬åˆ°ä¸‹ä¸€ä¸ªåŠŸèƒ½ã€‚ <br><br><h2>  <font color="#3AC1EF">è¾…åŠ©æœºåˆ¶</font> </h2><br> ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªåŠŸèƒ½ï¼Œå¯è®©æ‚¨åŠ è½½å…¶ä»–æœç´¢ç»“æœï¼Œå¹¶å…·æœ‰å¤„ç†è¿™äº›ç»“æœçš„åŠŸèƒ½ã€‚ æœ¬æ–‡å¯ä»¥åœ¨æ­¤å®Œæˆï¼Œå› ä¸ºè¿™ä¸¤ä¸ªåŠŸèƒ½æä¾›äº†å¯ç‹¬ç«‹æ‰“å¼€çš„æŠ“å–é¡µé¢æ‰€éœ€çš„ä¸€åˆ‡ã€‚ ä½†æ˜¯æˆ‘ä»¬å°šæœªè€ƒè™‘ä¸Šé¢è®¨è®ºçš„ä¸€äº›è¾…åŠ©æœºåˆ¶ã€‚ ä¾‹å¦‚ï¼Œè¿™æ˜¯ç”¨äºå‘é€ç”µå­é‚®ä»¶å’Œå…¶ä»–å†…å®¹çš„ä»£ç ã€‚ æ‰€æœ‰è¿™äº›éƒ½å¯ä»¥åœ¨æˆ‘ä»¬ç°åœ¨è€ƒè™‘çš„<code>start_kayak</code>å‡½æ•°ä¸­æ‰¾åˆ°ã€‚ <br><br> è¦ä½¿ç”¨æ­¤åŠŸèƒ½ï¼Œæ‚¨éœ€è¦æœ‰å…³åŸå¸‚å’Œæ—¥æœŸçš„ä¿¡æ¯ã€‚ å¥¹åˆ©ç”¨è¿™äº›ä¿¡æ¯åœ¨<code>kayak</code>å˜é‡ä¸­å½¢æˆä¸€ä¸ªé“¾æ¥ï¼Œè¯¥é“¾æ¥ç”¨äºè½¬åˆ°ä¸€ä¸ªé¡µé¢ï¼Œè¯¥é¡µé¢å°†åŒ…å«æŒ‰å…¶æœ€ä½³åŒ¹é…æ’åºçš„æœç´¢ç»“æœã€‚ åœ¨ç¬¬ä¸€æ¬¡æŠ“å–ä¼šè¯ä¹‹åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨é¡µé¢é¡¶éƒ¨è¡¨ä¸­çš„ä»·æ ¼ã€‚ å³ï¼Œæˆ‘ä»¬æ‰¾åˆ°æœ€ä½ç¥¨ä»·å’Œå¹³å‡ä»·æ ¼ã€‚ æ‰€æœ‰è¿™äº›ä»¥åŠç«™ç‚¹å‘å¸ƒçš„é¢„æµ‹å°†é€šè¿‡ç”µå­é‚®ä»¶å‘é€ã€‚ åœ¨é¡µé¢ä¸Šï¼Œç›¸åº”çš„è¡¨æ ¼åº”ä½äºå·¦ä¸Šè§’ã€‚ é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œä½¿ç”¨æ­¤è¡¨è¿›è¡Œæ“ä½œå¯èƒ½ä¼šåœ¨ä½¿ç”¨ç¡®åˆ‡æ—¥æœŸè¿›è¡Œæœç´¢æ—¶å¯¼è‡´é”™è¯¯ï¼Œå› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥è¡¨æœªæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start_kayak</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(city_from, city_to, date_start, date_end)</span></span></span><span class="hljs-function">:</span></span>   <span class="hljs-string"><span class="hljs-string">"""City codes - it's the IATA codes!   Date format -  YYYY-MM-DD"""</span></span>     kayak = (<span class="hljs-string"><span class="hljs-string">'https://www.kayak.com/flights/'</span></span> + city_from + <span class="hljs-string"><span class="hljs-string">'-'</span></span> + city_to +            <span class="hljs-string"><span class="hljs-string">'/'</span></span> + date_start + <span class="hljs-string"><span class="hljs-string">'-flexible/'</span></span> + date_end + <span class="hljs-string"><span class="hljs-string">'-flexible?sort=bestflight_a'</span></span>)   driver.get(kayak)   sleep(randint(<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>))     <span class="hljs-comment"><span class="hljs-comment">#    ,           try   try:       xp_popup_close = '//button[contains(@id,"dialog-close") and contains(@class,"Button-No-Standard-Style close ")]'       driver.find_elements_by_xpath(xp_popup_close)[5].click()   except Exception as e:       pass   sleep(randint(60,95))   print('loading more.....')  #     load_more()     print('starting first scrape.....')   df_flights_best = page_scrape()   df_flights_best['sort'] = 'best'   sleep(randint(60,80))     #      ,        matrix = driver.find_elements_by_xpath('//*[contains(@id,"FlexMatrixCell")]')   matrix_prices = [price.text.replace('$','') for price in matrix]   matrix_prices = list(map(int, matrix_prices))   matrix_min = min(matrix_prices)   matrix_avg = sum(matrix_prices)/len(matrix_prices)     print('switching to cheapest results.....')   cheap_results = '//a[@data-code = "price"]'   driver.find_element_by_xpath(cheap_results).click()   sleep(randint(60,90))   print('loading more.....')  #     load_more()     print('starting second scrape.....')   df_flights_cheap = page_scrape()   df_flights_cheap['sort'] = 'cheap'   sleep(randint(60,80))     print('switching to quickest results.....')   quick_results = '//a[@data-code = "duration"]'   driver.find_element_by_xpath(quick_results).click()    sleep(randint(60,90))   print('loading more.....')  #     load_more()     print('starting third scrape.....')   df_flights_fast = page_scrape()   df_flights_fast['sort'] = 'fast'   sleep(randint(60,80))     #     Excel-,         final_df = df_flights_cheap.append(df_flights_best).append(df_flights_fast)   final_df.to_excel('search_backups//{}_flights_{}-{}_from_{}_to_{}.xlsx'.format(strftime("%Y%m%d-%H%M"),                                                                                  city_from, city_to,                                                                                  date_start, date_end), index=False)   print('saved df.....')     #    ,  ,  ,      xp_loading = '//div[contains(@id,"advice")]'   loading = driver.find_element_by_xpath(xp_loading).text   xp_prediction = '//span[@class="info-text"]'   prediction = driver.find_element_by_xpath(xp_prediction).text   print(loading+'\n'+prediction)     #    loading   , , ,        #    -    "Not Sure"   weird = 'Â¯\\_(ãƒ„)_/Â¯'   if loading == weird:       loading = 'Not sure'     username = 'YOUREMAIL@hotmail.com'   password = 'YOUR PASSWORD'   server = smtplib.SMTP('smtp.outlook.com', 587)   server.ehlo()   server.starttls()   server.login(username, password)   msg = ('Subject: Flight Scraper\n\n\ Cheapest Flight: {}\nAverage Price: {}\n\nRecommendation: {}\n\nEnd of message'.format(matrix_min, matrix_avg, (loading+'\n'+prediction)))   message = MIMEMultipart()   message['From'] = 'YOUREMAIL@hotmail.com'   message['to'] = 'YOUROTHEREMAIL@domain.com'   server.sendmail('YOUREMAIL@hotmail.com', 'YOUROTHEREMAIL@domain.com', msg)   print('sent email.....')</span></span></code> </pre> <br> æˆ‘ä½¿ç”¨Outlookå¸æˆ·ï¼ˆhotmail.comï¼‰æµ‹è¯•äº†æ­¤è„šæœ¬ã€‚ æˆ‘æ²¡æœ‰æ£€æŸ¥å®ƒæ˜¯å¦å¯ä»¥æ­£ç¡®è¿è¡ŒGmailå¸æˆ·ï¼Œè¯¥é‚®ä»¶ç³»ç»Ÿéå¸¸æµè¡Œï¼Œä½†æ˜¯æœ‰å¾ˆå¤šå¯èƒ½çš„é€‰æ‹©ã€‚ å¦‚æœæ‚¨ä½¿ç”¨Hotmailå¸æˆ·ï¼Œåˆ™ä¸ºäº†ä½¿æ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œï¼Œæ‚¨åªéœ€è¦åœ¨ä»£ç ä¸­è¾“å…¥æ•°æ®å³å¯ã€‚ <br><br> å¦‚æœæ‚¨æƒ³äº†è§£åœ¨æ­¤å‡½æ•°ä»£ç çš„ä¸åŒéƒ¨åˆ†ä¸­ç©¶ç«Ÿæ‰§è¡Œäº†ä»€ä¹ˆæ“ä½œï¼Œåˆ™å¯ä»¥å¤åˆ¶å®ƒä»¬å¹¶è¿›è¡Œè¯•éªŒã€‚ ä»£ç å®éªŒæ˜¯ç†è§£å®ƒçš„å”¯ä¸€æ–¹æ³•ã€‚ <br><br><h2>  <font color="#3AC1EF">å‡†å¤‡ç³»ç»Ÿ</font> </h2><br> ç°åœ¨ï¼Œæˆ‘ä»¬è®¨è®ºçš„æ‰€æœ‰å†…å®¹éƒ½å·²å®Œæˆï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç®€å•çš„å¾ªç¯ï¼Œåœ¨å…¶ä¸­è°ƒç”¨æˆ‘ä»¬çš„å‡½æ•°ã€‚ è¯¥è„šæœ¬è¦æ±‚ç”¨æˆ·æä¾›æœ‰å…³åŸå¸‚å’Œæ—¥æœŸçš„æ•°æ®ã€‚ åœ¨ä¸æ–­é‡å¯è„šæœ¬çš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•æ—¶ï¼Œæ‚¨ä¸å¤ªå¸Œæœ›æ¯æ¬¡éƒ½æ‰‹åŠ¨è¾“å…¥æ­¤æ•°æ®ï¼Œå› æ­¤å¯ä»¥åœ¨æµ‹è¯•æœŸé—´é€šè¿‡æ³¨é‡Šæ‰ä¸‹é¢çš„ä¸¥æ ¼æ³¨é‡Šäº†è„šæœ¬æ‰€éœ€æ•°æ®çš„è¡Œæ¥æ³¨é‡Šæ‰å¯¹åº”çš„è¡Œã€‚ <br><br><pre> <code class="python hljs">city_from = input(<span class="hljs-string"><span class="hljs-string">'From which city? '</span></span>) city_to = input(<span class="hljs-string"><span class="hljs-string">'Where to? '</span></span>) date_start = input(<span class="hljs-string"><span class="hljs-string">'Search around which departure date? Please use YYYY-MM-DD format only '</span></span>) date_end = input(<span class="hljs-string"><span class="hljs-string">'Return when? Please use YYYY-MM-DD format only '</span></span>) <span class="hljs-comment"><span class="hljs-comment"># city_from = 'LIS' # city_to = 'SIN' # date_start = '2019-08-21' # date_end = '2019-09-07' for n in range(0,5):   start_kayak(city_from, city_to, date_start, date_end)   print('iteration {} was complete @ {}'.format(n, strftime("%Y%m%d-%H%M")))     #  4    sleep(60*60*4)   print('sleep finished.....')</span></span></code> </pre> <br> è¿™æ˜¯è„šæœ¬çš„æµ‹è¯•è¿è¡Œã€‚ <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/44c/305/023/44c305023996a98a3dec745493dce7a7.png"></div><br>  <i><font color="#999999">æµ‹è¯•è¿è¡Œè„šæœ¬</font></i> <br><br><h2>  <font color="#3AC1EF">æ€»ç»“</font> </h2><br> å¦‚æœæ‚¨åˆ°äº†è¿™ä¸€æ­¥ï¼Œæ­å–œï¼ ç°åœ¨ï¼Œæ‚¨å·²ç»å¯ä»¥ä½¿ç”¨ç½‘ç»œåˆ®æ¿ï¼Œå°½ç®¡æˆ‘å·²ç»å‘ç°äº†è®¸å¤šæ”¹è¿›æ–¹æ³•ã€‚ ä¾‹å¦‚ï¼Œå®ƒå¯ä»¥ä¸Twilioé›†æˆåœ¨ä¸€èµ·ï¼Œä»¥ä¾¿å‘é€ç”µå­é‚®ä»¶è€Œä¸æ˜¯ç”µå­é‚®ä»¶ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨VPNæˆ–å…¶ä»–æ–¹å¼åŒæ—¶ä»å¤šä¸ªæœåŠ¡å™¨æ¥æ”¶ç»“æœã€‚ æ£€æŸ¥ç«™ç‚¹ç”¨æˆ·æ˜¯å¦ä¸ºäººä¹Ÿæ˜¯ä¸€ä¸ªåå¤å‡ºç°çš„é—®é¢˜ï¼Œä½†æ˜¯è¿™ä¸ªé—®é¢˜ä¹Ÿå¯ä»¥è§£å†³ã€‚ æ— è®ºå¦‚ä½•ï¼Œç°åœ¨æ‚¨æœ‰äº†ä¸€ä¸ªå¯ä»¥æ‰©å±•çš„åŸºç¡€ã€‚ ä¾‹å¦‚ï¼Œç¡®ä¿å°†Excelæ–‡ä»¶ä½œä¸ºç”µå­é‚®ä»¶çš„é™„ä»¶å‘é€ç»™ç”¨æˆ·ã€‚ <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN451872/">https://habr.com/ru/post/zh-CN451872/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN451860/index.html">æ•°å­¦å®¶å‘ç°ä¹˜æ•°çš„å®Œç¾æ–¹æ³•</a></li>
<li><a href="../zh-CN451862/index.html">ä¹”Â·è¿ªæ™®é‡Œå§†ï¼ˆJoe Diprimï¼‰çš„ã€ŠéŸ³ä¹é—ªç”µã€‹ï¼šè‡ªå­¦æˆæ‰çš„å·¥ç¨‹å¸ˆåˆ¶ä½œç‰¹æ–¯æ‹‰çº¿åœˆè¿›è¡Œå¨±ä¹å’Œèµšé’±</a></li>
<li><a href="../zh-CN451864/index.html">åœ¨Windows OSä¸­æ£€æµ‹åˆ°EternalBlueçº§åˆ«çš„ä¸¥é‡RCEæ¼æ´</a></li>
<li><a href="../zh-CN451866/index.html">é€‰æ‹©ç½‘ç»œä¸­æœ€è¿‘çš„èŠ‚ç‚¹</a></li>
<li><a href="../zh-CN451870/index.html">æ‰€æœ‰ç¨‹åºå‘˜éƒ½éœ€è¦äº†è§£çš„ç°ä»£C ++åŠŸèƒ½</a></li>
<li><a href="../zh-CN451874/index.html">Googleçš„çƒ­é—¨SEOè¶‹åŠ¿</a></li>
<li><a href="../zh-CN451876/index.html">æ³•å…°å…‹ç¦æ•°æ®ä¸­å¿ƒï¼šTelehouseæ•°æ®ä¸­å¿ƒ</a></li>
<li><a href="../zh-CN451878/index.html">å°†ç«‹ä½“å£°è§†é¢‘å®æ—¶æµä¼ è¾“åˆ°VRçœ¼é•œï¼ˆOculus Goï¼‰</a></li>
<li><a href="../zh-CN451880/index.html">DevPRO'19ï¼šä»Wrikeå±•ä½è§‚çœ‹</a></li>
<li><a href="../zh-CN451884/index.html">ä»äº‹å¼€å‘äººå‘˜ä¸ƒå¹´ï¼šæˆ‘å­¦åˆ°äº†ä»€ä¹ˆ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>