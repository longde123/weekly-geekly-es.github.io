<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥚 🗑️ 🍣 Membangun RDP Thin Client berbasis Raspberry Pi 🦋 🏩 👌🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dengan semakin populernya mini-PC seperti Raspberry Pi, dan klon serupa, ada banyak kasus untuk digunakan dalam infrastruktur TI perusahaan, rumah pin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Membangun RDP Thin Client berbasis Raspberry Pi</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479504/">  Dengan semakin populernya mini-PC seperti Raspberry Pi, dan klon serupa, ada banyak kasus untuk digunakan dalam infrastruktur TI perusahaan, rumah pintar / pondok / garasi, dan dalam aplikasi lainnya. <br><br>  Salah satu kasus yang mudah dan diinginkan adalah penggunaan RPi sebagai thin client yang terhubung melalui RDP ke sistem berbasis Windows. <br><br>  Jika Anda tertarik cara mengatur tempat seperti itu berdasarkan Raspberry Pi, dan sedemikian rupa untuk "mengatur dan melupakan" - selamat datang di kucing.  Ada gambar yang sudah jadi untuk yang benar-benar malas (lihat bagian 6.B). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3v/mj/zp/3vmjzprnt4v33dvnqnr6rwlikb8.png" alt="Gambar untuk menarik perhatian"></div><br><a name="habracut"></a><br>  Khususnya, dalam pengalaman saya (spesialis otomatisasi akuntansi / manajemen), saya sering harus mengatur tempat kerja yang tujuan utamanya adalah mengakses program (kebanyakan berwarna kuning), suite kantor, Internet, dan surat.  Terkadang - bekerja dengan flash drive.  Server, pada saat yang sama, sudah ada di perusahaan. <br><br>  Pada saat yang sama, stasiun itu membutuhkan kebisingan, kekompakan, dan keandalan yang rendah.  Atau, mari kita jujur, murah.  Terutama jika pertanyaannya adalah tentang ritel, di mana semuanya harus "dipaku." <br><br>  Pada saat yang sama, di masa lalu, banyak solusi dicoba dalam bentuk klien tipis "besi" khusus, tetapi karena sejumlah alasan mereka ternyata tidak nyaman.  Di suatu tempat, tugas terkait yang spesifik diperlukan, seperti meneruskan printer ke server, yang tidak dapat mereka atasi.  Di suatu tempat, meja perlahan muncul, yang membuat penggunanya gila.  Di suatu tempat klien kurus hanya bekerja melalui satu tempat, dan tidak mungkin untuk memahami mengapa.  Di suatu tempat beban jaringan berubah-ubah tidak berfungsi, atau parameter tidak ditransfer melalui DHCP. <br><br>  Oleh karena itu, entah bagaimana dengan cara alami, semuanya sampai pada kesimpulan bahwa lebih mudah untuk membeli nettop sampah dan mengenakannya set minimal perangkat lunak daripada menebak permainan dengan besi yang tidak jelas, ditambah dengan biaya Anda sendiri, karena di mana dan apa yang tidak bekerja tidak diketahui sebelumnya. , tetapi diketahui pasti bahwa semuanya seharusnya baik-baik saja, dan tidak memakan banyak waktu. <br><br>  Artikel itu agak terlambat dengan relevansinya.  Jika Anda kembali ke program kuning yang sama, maka dalam beberapa tahun terakhir platform telah berkembang, ia memiliki klien tipis sendiri, dan relevansi penerapannya dalam mode desktop jarak jauh telah menurun. <br><br>  Tetapi ada sejumlah tugas lain di mana workstation yang tenang dan andal yang terhubung melalui RDP akan sesuai.  Dan dalam beberapa tahun terakhir, biaya PC mini telah melonjak sejauh ini, dan komputer standar dan nettop, telah menjadi lebih menguntungkan (biaya perangkat keras, satu jam kerja spesialis, ditambah lisensi CAL / TCAL untuk Windows Server) untuk membangun solusi seperti itu. <br><br><h2>  Pernyataan masalah </h2><br>  Jadi, berdasarkan Raspberry Pi kita <b>perlu</b> menggunakan klien RDP yang tipis, "memakukan" ke server tertentu, plus menyediakan koneksi ulang jika terjadi kegagalan. <br><br>  Interaksi pengguna dengan perangkat itu sendiri harus dikecualikan.  Dengan demikian, tidak ada perintah desktop dan konsol lokal.  Kata sandi dimasukkan hanya untuk sesi RDP. <br><br>  Sebagai bonus, - atur USB-drive yang dapat dipasang secara otomatis dan dilepas. <br><br>  <b>Diberikan:</b> <br><br><ul><li>  Raspberry Pi 3 Model B 1Gb murni, atau 4 Model B 1 Gb </li><li>  5v 2A adaptor daya, </li><li>  Kabel HDMI </li><li>  adaptor dengan HDMI ke monitor (jika monitor tidak memiliki port HDMI built-in), </li><li>  Kabel Ethernet (atau keberadaan jaringan WiFi), </li><li>  Kartu memori MicroSD dengan 8 GB atau lebih (4 GB sudah cukup objektif, tetapi menurut saya Anda dapat membeli kartu 4 GB hanya di museum). </li><li>  monitor, keyboard, mouse untuk Raspberry. </li></ul><br>  Pada saat instalasi - komputer (laptop) dengan Windows atau Linux, adaptor kartu microSD untuk itu. <br><br>  Diasumsikan bahwa pembaca memiliki keterampilan dasar mengelola sistem Linux, dan pertanyaan "membuat dan mengedit file, menyalin teks dari artikel ini ke dalamnya" atau "terhubung melalui SSH" tidak akan menyebabkan kesulitan.  Namun, kadang-kadang saya membiarkan diri saya melakukan perjalanan yang lebih dalam, bagi mereka yang mungkin tidak pernah bertemu secara khusus dengan Raspbian. <br><br>  Logika umum: mengkonfigurasi sistem dasar, menginstal klien RDP, mengkonfigurasi login otomatis, menguji, memperbaiki masalah. <br><br>  Ini juga akan menjelaskan cara mengkloning perakitan jadi ke Raspberry lain. <br><br>  Tata letak perangkat lunak itu sendiri tidak rumit, lahir dalam satu atau lain bentuk sekitar 9 tahun yang lalu - seperti yang saya ingat sekarang, saya melakukannya di bawah Debian Etch.  Sejak itu, itu telah sedikit berubah dari versi perangkat lunak dan perangkat keras ke versi, dan sekarang saatnya untuk port ke Raspberry. <br><br>  Konsumsi waktu yang direncanakan sekitar 30 menit. <br><br><h2>  1. Menyiapkan sistem dasar </h2><br><h4>  1.1 Unduh gambar sistem </h4><br>  Kami akan memilih Raspbian sebagai sistem. <br><br>  Pada saat penulisan, <a href="https://www.raspberrypi.org/downloads/raspbian/" rel="nofollow">ini dapat dilakukan di sini</a> .  Versi saat ini adalah Buster. <br><br>  Pilih Gambar Minimal Berdasarkan Debian Buster. <br><br><img src="https://habrastorage.org/webt/iy/eb/jv/iyebjvlxbebhaqflevjeihob5fa.png"><br><br>  Unduh arsip ZIP untuk mendapatkan satu-satunya file .img. <br><br><img src="https://habrastorage.org/webt/vp/qo/5w/vpqo5wlbndwf9n2ntw5stuylso0.png"><br><br><h4>  1.2 Menuliskannya ke kartu flash </h4><br>  <b>a) Di bawah Windows</b> <br><br>  Unduh program <b>Rufus</b> dari <a href="https://rufus.ie/" rel="nofollow">situs resmi</a> .  Versi portabel sudah cukup. <br><br>  Jalankan program, pilih SD-card dan gambar ditarik keluar dari arsip di paragraf 1.1. <br><br><img src="https://habrastorage.org/webt/yx/9o/3f/yx9o3ftepbvxw5qytwiu5__d_fi.png"><br><br>  Tekan tombol "MULAI", konfirmasikan penghancuran data pada kartu SD, tunggu prosesnya selesai (sekitar 5 menit). <br><br>  Keluarkan kartu dengan aman. <br><br>  <b>b) di Linux</b> <br><br>  Jalankan perintah: <br><br><pre><code class="plaintext hljs"># dd if=2019-09-26-raspbian-buster-lite.img of=/dev/&lt; SD-&gt; bs=4M</code> </pre> <br>  Tunggu selesainya proses, tarik keluar kartu. <br><br><h4>  1.3 Menyebarkan sistem ke RPI </h4><br>  Kami mengatur ulang kartu ke perangkat target.  Kami menghubungkan mini-PC dengan monitor, keyboard, mouse, dan menerapkan daya ke sana. <br><br>  Setelah beberapa waktu, tanpa mengajukan pertanyaan tambahan, mini-PC akan reboot ke sistem yang baru digunakan, dan akan mengundang Anda untuk memasukkan login dan kata sandi Anda. <br>  Secara default, ini <b>pi: raspberry.</b> <br><br><img src="https://habrastorage.org/webt/7p/ej/p6/7pejp6fntkhztb-4tkbhdlcmdq8.jpeg"><br><br><h4>  1.4 Masuk dan ubah kata sandi Anda </h4><br><pre> <code class="plaintext hljs"># passwd pi</code> </pre> <br>  atau <br><br><pre> <code class="plaintext hljs">$ sudo passwd pi</code> </pre> <br>  (Saya sengaja menjalankan passwd untuk pi pengguna sebagai root sehingga Raspbian tidak mengganggu kami dengan persyaratan keamanan untuk kata sandi, tetapi menerimanya dan menerimanya) <br><br>  Anda tidak dapat langsung masuk sebagai root kecuali Anda secara eksplisit mengatur kata sandi untuk itu.  Secara umum, ini tidak buruk.  Maka semua perintah yang harus dijalankan di bawah superuser harus dieksekusi dari pengguna pi dengan perintah awalan sudo.  Seperti di Ubuntu. <br><br>  Misalnya ( <b><u>lelucon terkenal, jangan lari!</u></b> ) <br><br><pre> <code class="plaintext hljs">$ sudo rm -rf --no-preserve-root</code> </pre> <br>  Namun, karena saya malas secara patologis, kemudian, masuk ke Raspbian, atau di Ubuntu yang sama, saya mengetik: <br><br><pre> <code class="plaintext hljs">$ sudo bash</code> </pre> <br>  Dan saya mendapatkan undangan #, sudah dengan hak tinggi.  Jadi saya bekerja. <br>  Sebenarnya, melakukan itu tidak baik, tetapi pada tahap pengaturan awal sistem ini menghemat banyak waktu. <br><br>  Selanjutnya, jika perintah di atas didahului oleh #, maka mereka harus dieksekusi di bawah superuser.  Jika dengan $, maka di bawah pengguna (biasanya ditunjukkan di atas di mana). <br><br><h2>  2. Menginstal perangkat lunak yang diperlukan "minimal", menguji koneksi </h2><br><h4>  2.1 Mengkonfigurasi Jaringan </h4><br>  Untuk melakukan ini, jalankan utilitas administratif dengan menjalankan perintah: <br><br><pre> <code class="plaintext hljs"># raspi-config</code> </pre> <br><img src="https://habrastorage.org/webt/cl/ds/fb/cldsfbbpwcg-xln0ezbmc54refm.png"><br><br>  (Navigasi dilakukan dengan panah, tabulasi, Enter - choice, ESC - return) <br>  Buka <b>Opsi Jaringan</b> . <br><br>  Tetapkan nama komputer (titik <b>N1 Hostname</b> ), misalnya <b>TERM1</b> . <br><br>  Jika komputer terhubung ke jaringan dengan kabel Ethernet dan menerima alamat DHCP, maka tidak ada lagi yang perlu dilakukan. <br><br>  Jika Anda perlu mengkonfigurasi jaringan WiFi, maka lakukan (titik <b>N2 Wi-Fi</b> ).  Pilih negara Anda.  <b>Nama jaringan</b> harus dimasukkan secara manual, tidak ada ikhtisar yang disediakan.  Kami menentukan <b>kata sandi</b> . <br><br>  Kemudian <b>Selesai -&gt; Selesai</b> . <br><br>  Reboot berdasarkan permintaan, atau dengan perintah: <br><br><pre> <code class="plaintext hljs"># reboot</code> </pre> <br>  Setelah masuk kembali, pastikan Anda memiliki akses Internet. <br><br><pre> <code class="plaintext hljs"># ping 8.8.8.8</code> </pre> <br><h4>  2.2 Sistem pembaruan </h4><br>  Perbarui informasi tentang paket yang tersedia. <br><br><pre> <code class="plaintext hljs"># apt-get update</code> </pre> <br>  Sekarang perbarui sistem (Opsional, tetapi sangat diinginkan. Dapat dilakukan nanti.) <br><br><pre> <code class="plaintext hljs"># apt-get upgrade</code> </pre> <br>  Tahap ini bisa memakan waktu lama (saya punya sekitar 15 menit), karena RPi bootloader biner diperbarui, yang membongkar banyak file kecil ke kartu SD. <br><blockquote>  Harap dicatat bahwa segera setelah unduhan selesai dan pembongkaran dimulai, beberapa paket jahat akan meminta Anda untuk menekan "q", menghentikan proses.  Anda harus mengklik sebelum Anda terganggu oleh hal-hal lain untuk menunggu. <br></blockquote>  Di akhir pembaruan, Anda harus reboot <br><br><pre> <code class="plaintext hljs"># reboot</code> </pre><br><h4>  2.3 Pasang lokal dan tata letak Rusia </h4><br>  Lagi dalam utilitas administrasi: <br><br><pre> <code class="plaintext hljs"># raspi-config</code> </pre> <br>  Ikuti <b>Opsi Pelokalan</b> , di sana: <br><br><ol><li>  <b>Ubah Lokal</b> , hapus * dari <b>en-GB.UTF-8</b> dan instal berlawanan <b>ru-RU.UTF-8</b> .  Kami mengkonfirmasi, dan di jendela berikutnya kami memilihnya sebagai yang utama. </li><li>  <b>Ubah Zona Waktu</b> , dan pilih zona waktu negara dan kota Anda. </li><li>  <b>Ubah Tata Letak Keyboard</b> , ada <b>Generik 105-key (Intl) PC</b> → <b>Lainnya</b> → <b>Rusia</b> → <b>Rusia</b> → <b>Control + Shift</b> (atau Alt + Shift, jika diinginkan, untuk beralih tata letak) → <b>Tidak ada switcher sementara</b> → <b>Alt Kanan (AltGr)</b> → <b>Tidak ada tombol penulisan</b> . </li></ol><br>  Konfirmasikan dan keluar - <b>Selesai</b> → <b>Selesai</b> . <br><br>  Kami meninggalkan utilitas administrasi, jalankan perintah: <br><br><pre> <code class="plaintext hljs"># dpkg-reconfigure console-setup</code> </pre> <br>  pilih <b>UTF-8</b> → <b>Tebak set karakter optimal</b> → <b>Biarkan sistem memilih ...</b> (bawah) → <b>8x16</b> . <br><br>  Font kemudian menjadi lebih tipis secara visual, tetapi yang utama adalah mereka sekarang mendukung alfabet Cyrillic. <br><br>  Kami reboot, masuk, menguji tata letak bahasa Inggris, beralih dan tata letak Rusia. <br><br><h4>  2.4 Ditentukan dengan perangkat lunak tambahan dan editor </h4><br>  Untuk bekerja dengan file, menavigasi struktur folder dan mengedit file, saya sangat suka <b>Midnight Commander</b> , oleh karena itu: <br><br><pre> <code class="plaintext hljs"># apt-get install mc</code> </pre><br>  Saya meluncurkannya di bawah hak root, dan pertama kali saya menggunakan editor (tombol F4 pada beberapa file) saya memilih <b>mcedit</b> (poin 2). <br><br>  Tentu saja, Anda dapat mengedit file menggunakan alat pilihan Anda.  Misalnya, menggunakan nano, atau bahkan VIM. <br><br><h4>  2.5 Pasang server ssh </h4><br><pre> <code class="plaintext hljs"># apt-get install ssh</code> </pre> <br>  Mengedit / etc / ssh / sshd_config.  Batalkan komentar pada baris: <br><br><pre> <code class="plaintext hljs">ListenAddress 0.0.0.0</code> </pre> <br>  Buka kunci muat otomatis <br><br><pre> <code class="plaintext hljs"># systemctl enable ssh.service</code> </pre> <br>  Mulai ulang layanan <br><br><pre> <code class="plaintext hljs"># systemctl restart ssh.service</code> </pre> <br>  Kami menemukan alamat IP dengan perintah <br><br><pre> <code class="plaintext hljs"># ifconfig</code> </pre> <br>  Dan sekarang kita dapat terhubung ke perangkat dari jarak jauh dari komputer sumber melalui SSH (di bawah Windows saya pribadi suka <b>PuTTY</b> SSH client) untuk mengkonfigurasi dari workstation yang nyaman dan dapat menyalin dan menempelkan teks dari artikel ini ke konfigurasi.  Saya mengingatkan Anda bahwa login adalah <b>pi</b> , bukan root. <br><br><img src="https://habrastorage.org/webt/n7/rf/dp/n7rfdpupnveaxml-qs16hyjmmnw.png"><br><br>  Tindakan lebih lanjut saya sarankan melakukan persis melalui SSH, kecuali dinyatakan sebaliknya. <br><br><h4>  2.6 Memindahkan partisi yang mudah menguap ke disk virtual </h4><br>  Misalnya, <b>/ tmp</b> dan <b>/ var / log</b> , untuk: <br><br><ol><li>  sistem tidak mempertajam kartu SD, </li><li>  ada sedikit kemungkinan bahwa sistem file root akan berantakan selama pemadaman listrik, </li><li>  sehingga di masa depan yang jauh, log tidak memblokir ruang kosong di peta. </li></ol><br>  Untuk melakukan ini, tambahkan baris ke <b>/ etc / fstab</b> : <br><br><pre> <code class="plaintext hljs">tmpfs /var/log tmpfs defaults,noatime,nosuid,mode=0755,size=100m 0 0 tmpfs /tmp tmpfs defaults,noatime,nosuid,size=100m 0 0</code> </pre><br>  Jangan lupa untuk membuat satu baris di akhir file. <br><br>  Di sini, bagian <b>/ var / log</b> dan <b>/ tmp masing</b> -masing dialokasikan 100 mb memori (hanya akan digunakan saat penuh).  Gigabyte Pi, yang hanya digunakan untuk RDP, pengeluaran ini tidak akan menghalangi apa pun. <br><br>  Reboot sistem, dan kemudian jalankan perintah: <br><br><pre> <code class="plaintext hljs"># df</code> </pre> <br>  dan pastikan partisi sudah dipasang di tmpfs (3 dan 4 kolom mungkin berbeda): <br><br><pre> <code class="plaintext hljs">tmpfs 102400 8 102392 1% /tmp tmpfs 102400 224 102176 1% /var/log</code> </pre><br><h4>  2.7 Kami akan mendapatkan pengguna di bawah siapa kami akan, kemudian, secara otomatis meluncurkan shell grafis </h4><br>  Jalankan perintah: <br><br><pre> <code class="plaintext hljs"># adduser user</code> </pre> <br>  Tetapkan kata sandi yang sewenang-wenang.  Segala macam nama dan telepon dapat dilewati.  Konfirmasi <br><br><h4>  2.8 Instal X-server dalam versi minimal </h4><br>  Jalankan perintah: <br><br><pre> <code class="plaintext hljs"># apt-get install xserver-xorg xinit xterm x11-xserver-utils</code> </pre> <br>  Ini mungkin memakan waktu sekitar 5 menit. <br><br>  Sekarang Anda harus <u>duduk di terminal fisik</u> (dalam arti monitor, keyboard dan mouse yang terhubung langsung ke Pi), masuk sebagai pengguna pengguna dan jalankan perintah: <br><br><pre> <code class="plaintext hljs">$ startx</code> </pre> <br>  Gambar berikut ini akan muncul di layar, yang berarti x-server telah berhasil diinstal, dan Anda dapat melanjutkan. <br><br><img src="https://habrastorage.org/webt/c1/na/qb/c1naqbmygzqagi02s3dm5exinn0.png"><br><br>  Kami mengarahkan kursor ke atas (itu penting, karena tidak ada jendela yang membentuk bingkai dan judul jendela, dan jendela itu tidak akan menerima teks tanpa fokus eksplisit) dan ketik <br><br><pre> <code class="plaintext hljs">$ exit</code> </pre> <br>  untuk kembali. <br><br><h4>  2.9 Instal perangkat lunak untuk bekerja dengan desktop jarak jauh </h4><br>  Saya pribadi suka <b>rdesktop</b> .  Ini, tentu saja, bukan tanpa nuansa (lihat bagian "Ekstraksi Rake").  Ada beberapa alternatif seperti <b>xfreerdp</b> , <b>remmina</b> , dll., Meskipun mereka juga mengeluhkannya. <br><br>  Saya akan memberikan contoh untuk yang pertama. <br><br><pre> <code class="plaintext hljs"># apt-get install rdesktop</code> </pre> <br>  Buat skrip yang menjalankan rdesktop di layar penuh.  Di direktori <b>/ home / pengguna,</b> buat file <b>runrdp</b> (lebih disukai sebagai pengguna): <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash rdesktop &lt;  IP  &gt; -u &lt;   &gt; -f -z</span></span></code> </pre><br>  Jika Anda telah memilih klien RDP lain, maka tulis baris perintah untuk itu di sini, atau gunakan massa parameter tambahan yang dimiliki rdesktop.  Anda bahkan dapat membuat hardcode kata sandi untuk masuk secara otomatis. <br><br>  Anda harus meletakkan hak untuk berjalan di skrip ini, dan jika Anda membuatnya sebagai root, maka pemiliknya adalah pengguna. <br><br><pre> <code class="plaintext hljs"># chmod 755 /home/user/runrdp # chown user:user /home/user/runrdp</code> </pre><br>  Sekarang, mari kita pergi ke konsol fisik di bawah pengguna, mulai startx, di terminal grafik yang terbuka (lihat gambar di atas), ketik: <br><br><pre> <code class="plaintext hljs">$ ./runrdp</code> </pre> <br>  Jendela untuk menghubungkan ke desktop jarak jauh akan muncul di layar. <br><br><img src="https://habrastorage.org/webt/av/mt/y8/avmty8dt4vclbpt5yrkw-3mmmlc.png"><br><br>  Jika: <br><br>  a) konsol menampilkan sesuatu tentang kesalahan CredSSP, <br>  b) mode layar penuh dalam FullHD meninggalkan tepi gelap (seperti pada gambar-foto No. 4 dalam artikel ini, meskipun ada mode konsol, tetapi Anda dapat melihat ujungnya) <br>  kemudian lihat bagian Ekstraksi Rake. <br><br>  Dan jika semuanya OK, maka batalkan login sistem (Esc, atau item menu "Nonaktifkan"), drop out ke terminal x, ketik keluar, kembali ke konsol. <br><br><h2>  3. Otomatisasi sesi pengangkatan </h2><br>  Jika semua langkah sebelumnya berhasil, maka inilah saatnya menyatukan semuanya. <br><br>  Untuk melakukan ini, kita akan membuatnya sehingga ketika sistem dimulai, pengguna secara otomatis login ke terminal, memulai server X dan terhubung ke RDP di bawahnya.  Dengan demikian, kata sandi hanya akan diminta untuk sesi RDP, yang akan menyelamatkan pikiran pengguna yang belum matang dari keterampilan menjinakkan Linux yang tidak perlu. <br><br><h4>  3.1 RDP tak terbatas </h4><br>  Mari kita membuat skrip yang, ketika memulai x-server, akan tanpa henti mencoba membuka sesi RDP. <br>  Untuk melakukan ini, di direktori <b>/ rumah / pengguna</b> membuat file autorun di awal sesi-X <b>.xinitrc</b> , konten berikut: <br><pre> <code class="bash hljs">setxkbmap -option terminate:ctrl_alt_bksp <span class="hljs-comment"><span class="hljs-comment">#    Ctrl-Alt-BkSpace setterm -blank 0 -cursor off #   xsetroot -solid gray #      while /bin/true; do ./runrdp done</span></span></code> </pre> <br><h4>  3,2 Infinite X server </h4><br>  Kami akan memperbaiki skrip yang menentukan mulai otomatis dari program dan pengaturan profil selama login konsol sehingga sesi-x dimulai secara otomatis, tetapi hanya ketika pengguna masuk ke terminal 1. <br><br><blockquote>  Terima kasih kepada <a href="https://habr.com/ru/users/gecube/">gecube</a> untuk mengingatkan saya untuk menonaktifkan screensaver.  Secara default, ini adalah layar hitam, yang, bagi kebanyakan monitor modern, agak berbahaya. </blockquote><br><br>  <b>Mari kita edit / home / pengguna / profil</b> , <u><b>tambahkan</b></u> baris berikut di sana: <br><br><pre> <code class="bash hljs">… <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ -z <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$DISPLAY</span></span></span><span class="hljs-string">"</span></span> ] &amp;&amp; [ $(tty) = <span class="hljs-string"><span class="hljs-string">"/dev/tty1"</span></span> ]; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> startx clear <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">" 5    "</span></span> sleep 5 <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span></code> </pre><br><h4>  3.3. Sedang menguji banyak </h4><br>  Kami reboot Pi, duduk di terminal, masuk sebagai pengguna.  Kami mendapatkan jendela awal sesi di layar, seperti pada gambar di atas. <br><br>  Kami mencoba menolak untuk memasukkan kata sandi (esc, atau tergantung pada versi Windows) - kami mendapatkan jendela yang sama untuk awal sesi (mis. Skrip kami dari 3.1 selalu terhubung kembali). <br><br>  Kami menunggu sekitar satu menit (tergantung pada server) tanpa menyentuh keyboard dan mouse - jendela untuk memulai sesi harus segera dimatikan (sesi RDP pada tahap entri kata sandi tanpa aktivitas berakhir dalam batas waktu).  Itu, tentu saja, karena klausa 3.1, akan terhubung kembali. <br><br>  Sekarang tekan <b>Ctrl + Alt + BkSp</b> .  Sesi X harus dihentikan, sebuah tulisan tentang menunggu 5 detik akan ditampilkan, setelah itu sesi konsol juga akan berakhir.  Layar akan meminta Anda untuk memasuki terminal dengan nama pengguna dan kata sandi. <br><br>  Jika semuanya begitu - sangat baik. <br><br>  Kami hanya perlu login otomatis ke terminal. <br><br><h4>  3.4 Autologin berulang <s>oranye yang sangat lezat</s> di tty1 </h4><br>  Untuk melakukan ini, dari root, buat file <b>/etc/systemd/system/getty@tty1.service.d/autologin.conf</b> dengan konten berikut: <br><br><pre> <code class="plaintext hljs">[Service] ExecStart= ExecStart=-/sbin/agetty --autologin user --noclear %I 38400 linux</code> </pre><br>  Lalu: <br><br><pre> <code class="plaintext hljs">#systemctl enable getty@tty1.service</code> </pre> <br>  Kami reboot, pastikan bahwa konsol fisik secara otomatis login sebagai pengguna, X server dimulai dan sesi RDP terbuka, dan kemudian semuanya seperti pada 3.3. <br>  Tekan Ctrl + Alt + BkSp, tunggu koneksi ulang. <br><br>  Kami memasuki sistem, uji switching, pekerjaan tata letak.  Jika ada sesuatu yang salah, lihat bagian 4. <br><br>  <b>Ini menyelesaikan pengaturan.</b> <br><br>  Pengguna harus diinstruksikan bahwa jika terjadi kesalahan (layar menjadi kosong, sesuatu membeku, dll.), Mereka pertama-tama menekan Ctrl + Alt + BkSp dan menunggu reaksi. <br><br>  Lihat juga bagian 5 tentang pemasangan otomatis USB. <br><br><h2>  4. Ekstraksi penggaruk </h2><br>  Karena ini adalah OpenSource, ekstraksi rake adalah proses putus asa dan berkelanjutan.  Saya akan mencoba untuk menguraikan kemungkinan utama menyapu, tetapi siapa yang tahu apa yang menunggu kita.  Saya, secara pribadi, tidak pernah beruntung, dan tidak ada satu instruksi pun yang bekerja untuk saya tanpa perlu pencarian tambahan. <br><br><h4>  4.1 Masalah dengan penggunaan resolusi layar yang tidak lengkap </h4><br>  Gejala: Dalam hal beberapa peralatan (adaptor HDMI-DSUB, beberapa monitor) raspbian tidak menggunakan semua resolusi yang tersedia dari monitor Full-HD.  Bidang gelap tetap berada di antara informasi yang relevan dan tepi fisik layar. <br><br>  Diatasi sebagai berikut: <br><br>  Edit / <b>boot / config.txt</b> , cari baris <br><br><pre> <code class="plaintext hljs"># disable_overscan = 1</code> </pre> <br>  dan batalkan komentar itu. <br><br>  Mulai ulang. <br><br>  Sekarang bidang gelap dari tepi layar harus dihilangkan dalam mode konsol dan grafis. <br><br><h4>  4.2 Masalah dengan kursor mouse saat menghubungkan rdesktop ke server RDP modern </h4><br>  Ini terutama menyangkut Windows 2012, 2016, Windows 10, di mana tema kursor disertakan. <br><br>  Gejala: kursor menghilang, tidak dapat ditarik dengan baik, setelah beralih ke non-standar (jam pasir, simbol I, panah pelebaran jendela, dll.) Lupa untuk beralih ke panah biasa. <br><br>  Solusi: Sebagai pengguna server yang Anda sambungkan, buka properti mouse melalui panel kontrol, setel ulang tema menjadi "Tidak" dan matikan bayangan di bawah penunjuk. <br><br><img src="https://habrastorage.org/webt/ek/na/rc/eknarc92omul5c37i4ta4lfenmc.png"><br><br>  Kursor harus patuh. <br><br><h4>  4.3.  Masalah enkode dengan rdesktop </h4><br>  Gejala: dalam beberapa kasus, melalui koneksi RDP, karakter khusus salah ketik pada sistem jarak jauh: tildes, garis miring, tanda kutip, titik, tongkat vertikal.  Terutama mulai membuat marah poin, karena mereka sering mengetik. <br><br>  Solusi: <br><br>  Di <b>/ usr / share / rdesktop / keymaps</b> buat file <b>mentah</b> dan isi dengan konten berikut: <br><br><pre> <code class="plaintext hljs">include common map 0x419 grave 0x29 asciicircum 0x07 shift backslash 0x2b bar 0x2b shift apostrophe 0x28 greater 0x34 shift less 0x33 shift</code> </pre><br>  Tambahkan argumen <b>mentah -k</b> ke prompt perintah rdesktop di skrip <b>/ home / user / runrdp</b> .  Sebagai contoh: <br><br><pre> <code class="bash hljs">rdesktop 10.0.0.1 -u user -k raw</code> </pre> <br>  Mulai ulang sesi di terminal dengan Ctrl + Alt + BkSp atau secara umum restart Pi. <br><br>  Masukkan RDP, uji semua karakter khusus, termasuk  dengan Shift pada garis angka keyboard dan tombol samping ke kiri dan kanan bagian surat, dengan Shift dan tanpa (tanda kutip, titik dua, tanda baca, stik, dll.).  Semuanya harus bekerja. <br><br><h4>  4.4.  Ketika Anda mencoba memulai rdesktop, sesi tidak terbuka, kesalahan CredSSP ditampilkan di konsol </h4><br><pre> <code class="bash hljs">CredSSP: Initialize failed, <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> you have correct kerberos tgt initialized ? Failed to connect, CredSSP required by server.</code> </pre><br>  Sistem target memerlukan algoritma otentikasi klien modern, yang biasanya tidak dapat dilakukan rdesktop. <br><br>  Opsi Solusi: <br><br><ol><li>  Nonaktifkan otentikasi server dengan menurunkan pengaturan keamanan.  Pada dasarnya, di lingkungan di mana Pi mencoba menggunakan RDP sebagai klien, ini seharusnya tidak terlalu menjadi masalah keamanan. </li><li>  Gunakan klien lain, misalnya freerdp, remmina, menggantikan konten skrip runrdp dengan baris peluncuran klien ini. </li><li>  Instal dan konfigurasikan klien kerberos, tapi bagaimanapun semuanya rumit di sana.  Jika Anda ingin mencoba, <a href="https://github.com/rdesktop/rdesktop/issues/71" rel="nofollow">mulailah dari sini</a> . </li></ol><br><h4>  4.5.  Menghidupkan dan mematikan perangkat </h4><br>  Raspberry Pi tidak memiliki tombol mematikan.  Ini buruk.  Ternyata tidak ada cara yang efektif untuk menyalakan dan mematikannya.  Banyak yang telah ditulis tentang ini, saya akan mencoba untuk meringkas secara singkat: <br><br><ol><li>  Di satu sisi, kita tidak bisa mematikan perangkat sama sekali, hanya mematikan monitor.  Sebenarnya, di mana saya meletakkan RPi, semuanya sudah selesai.  Secara umum, perangkat hampir tidak panas, tidak mengkonsumsi listrik, tidak membuat suara.  Monitor, sebelum pergi, pengguna akan mati. </li><li>  Anda dapat mengkonfigurasi night off dengan Cron, tetapi kemudian untuk menghidupkan RPi di pagi hari, pengguna harus menyulap kabel, atau catu daya. </li><li>  Anda dapat mengatasi masalah ini dengan membeli kabel suplai USB dengan tombol terbuka (untuk mengaktifkan RPi, Anda hanya perlu membuka rangkaian sebentar dengan tombol).  120 rubel menyenangkan.  Tapi di sini, pengguna akan memiliki fungsi shutdown otomatis dengan cara yang sama seperti perangkat akan crash.  Karena kami telah memindahkan partisi yang mudah menguap ke tmpfs, kemungkinan tidak akan ada masalah, tetapi masih tidak ada yang aman bahwa pengguna tidak akan masuk di pagi hari karena runtuhnya rootfs.  Itu tidak berhasil, sehingga untuk mengatakan, solusi "dipaku". </li><li>  Ada solusi dengan tombol tambahan yang termasuk dalam port GPIO dan menyalakan / mematikan perangkat dengan lembut (dengan cara yang benar).  Tapi pertanian kolektif ke gedung - itu menghabiskan berjam-jam dan meningkatkan biaya produksi. </li><li>  Namun, untuk RPi bahkan ada case dengan tombol built-in (Cina punya segalanya).  Tapi saya pribadi belum mencobanya. </li><li>  Saya berpikir untuk menyalakan perangkat melalui pemutus kabel USB, dan mematikannya dengan hot key (seperti Ctrl + Alt + Shift + P), yang dipantau oleh layanan sistem, tetapi tidak mungkin untuk bekerja melalui solusi ini. </li></ol><br><h4>  4.6 Beberapa koneksi ulang ke server RDP </h4><br>  Dalam skema saat ini, perangkat klien akan terhubung ke server menggunakan protokol RDP, menampilkan jendela login dan input kata sandi, dan jika pengguna tidak memasukkan apa pun, maka setelah beberapa waktu sesi akan diatur ulang dan klien RDP akan mulai lagi, dan begitu juga dengan infinitum iklan. <br><br><blockquote>  Dalam komentar tersebut, pengguna <a href="https://habr.com/ru/users/Mnemonik/">Mnemonik</a> <a href="https://habr.com/ru/post/479504/">mengatakan</a> bahwa dengan beberapa <a href="https://habr.com/ru/users/Mnemonik/">koneksi</a> ulang permanen, Windows Server kehabisan memori, dan memberikan contoh bagaimana menyelesaikan masalah. <br></blockquote><br>  Saya akan membawa milik saya.  Kami akan memodifikasi skrip .xinitrc sehingga setelah proses rdesktop berikutnya selesai, dialog modal muncul di layar yang mencegahnya tidak dimulai kembali sebelum mengklik OK. <br><br>  Untuk melakukan ini, Anda dapat menggunakan xmessage biasa yang termasuk dalam paket xorg, tetapi windows yang dibuatnya sangat jelek sehingga monitor saya retak.  Selain itu, aplikasi ini tidak ramah dengan bahasa Rusia, dan menyalakannya adalah tugas lain. <br><br>  Saya terkesan dengan gxmessage, tanpa kekurangan ini, tetapi ia menarik GTK dan 25 megabita dependensi lainnya, yang juga tidak saya sukai.  Baiklah, mari kita pilih kejahatan yang lebih rendah: <br><pre> <code class="plaintext hljs">apt-get install gxmessage</code> </pre> <br>  Ubah skrip .xinitrc: <br><pre> <code class="bash hljs">setxkbmap -option terminate:ctrl_alt_bksp <span class="hljs-comment"><span class="hljs-comment">#    Ctrl-Alt-BkSpace setterm -blank 0 -cursor off #   xsetroot -solid gray #      while /bin/true; do ./runrdp gxmessage --center " OK      RDP" done</span></span></code> </pre> <br>  Sekarang, di antara upaya rdesktop untuk terhubung ke server, pesan yang sesuai akan ditampilkan di layar kita, dan tidak akan ada "pemboman" server yang konstan. <br><br>  Setelah menyelesaikan skrip dengan mudah, Anda dapat memeriksa ulang ketersediaan jaringan server dan menampilkan pesan tentang menghubungkan kembali karena kurangnya komunikasi. <br><br><h4>  4.7 Mengkonfigurasi NTP </h4><br><blockquote>  Terima kasih kepada <a href="https://habr.com/ru/users/gecube/">gecube</a> untuk mengingatkan saya tentang momen ini.  Secara teoritis, waktu pada perangkat dapat "melayang" dari waktu ke waktu, yang dapat menyebabkan kesulitan dengan otentikasi, dan mungkin masalah lainnya. <br></blockquote>  Untuk memperbaiki masalah kecil ini, Anda harus menginstal program ntpdate dan mendaftar di cron tugas untuk memperbarui waktu setiap jam (perangkat akan membutuhkan akses Internet): <br><br><pre> <code class="plaintext hljs"># apt-get install ntpdate # echo "0 * * * * root ntpdate pool.ntp.org" &gt; /etc/cron.d/ntp</code> </pre><br>  Jika Anda memiliki server NTP lokal di jaringan Anda, ganti nama host dengan milik Anda. <br><h2>  5 Opsional: menghubungkan, memutuskan koneksi dan meneruskan perangkat USB </h2><br>  Sebenarnya, bagian ini mencakup dua tahap penting.  Pertama, mengelola perangkat USB untuk memastikan pemasangan otomatis dan setidaknya pelepasan yang dikontrol pengguna.  Dan kedua, teruskan perangkat yang terhubung ke terminal sehingga mereka dapat diakses melalui jaringan. <br><br><h4>  5.1.  Pengaturan Otomatis </h4><br>  Perangkat USB plug-in dengan sistem file akan dipasang di subdirektori dari direktori / media.  Kami kemudian akan meneruskan direktori yang sama ke rdesktop. <br><br>  Kami akan membutuhkan paket pmount. <br><br><pre> <code class="plaintext hljs"># apt-get install pmount.</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kita juga perlu membuat aturan untuk udev yang akan menangkap perangkat yang terhubung dan memasangnya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/udev/rules.d</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> buat file </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">80-usbstick.rules</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan konten berikut:</font></font><br><br><pre> <code class="plaintext hljs">ACTION=="add", KERNEL=="sd[az][0-9]", TAG+="systemd", ENV{SYSTEMD_WANTS}="usbstick-handler@%k"</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang buat layanan untuk systemd. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ lib / systemd / system,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> buat file </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usbstick-handler @ .service</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan konten berikut:</font></font><br><br><pre> <code class="plaintext hljs">[Unit] Description=Mount USB sticks BindsTo=dev-%i.device After=dev-%i.device [Service] Type=oneshot RemainAfterExit=yes ExecStart=/usr/bin/pmount --umask 000 --noatime -w --sync /dev/%i /media/%i ExecStop=/usr/bin/pumount /dev/%i</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ usr / local / bin,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> buat file </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unmount-devices</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan konten berikut:</font></font><br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash for folder in /media/*; do pumount $folder echo "Unmounted $folder" done</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Beri dia hak untuk lari. </font></font><br><br><pre> <code class="plaintext hljs">#chmod 755 unmount-devices</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tambahkan pengguna pengguna ke grup plugdev sehingga ia dapat menggunakan skrip ini (pumount memungkinkan anggota grup ini untuk memasang dan melepas perangkat) </font></font><br><br><pre> <code class="plaintext hljs"># adduser user plugdev</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mulai ulang. Jika semuanya dilakukan dengan benar, maka ketika memasukkan flash drive ke port USB mini-PC, setelah beberapa detik, folder sda1, dll., Akan muncul di direktori / media, di mana flash drive akan dipasang untuk membaca dan menulis. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perangkat dipasang dengan flag –sync, oleh karena itu, secara teori, jika Anda menarik perangkat ketika operasi penulisan selesai, seharusnya tidak ada masalah dengan keamanan data, namun, flag ekstraksi yang tidak aman akan tetap ada di perangkat. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami akan menguji titik ini (masukkan USB flash drive, lepaskan USB flash drive, kemudian masukkan perangkat ke PC Windows dan perbaiki kesalahan yang mungkin terjadi). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang masukkan perangkat ke Pi lagi, pastikan folder / media / sda1 muncul lagi.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jalankan unmount-perangkat dari bawah pengguna pengguna. </font><font style="vertical-align: inherit;">sda1 dari / media harus hilang, dan perangkat harus dilepas dengan aman, dan tidak memberikan kesalahan saat dimasukkan ke PC Windows.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 5.2 Teruskan direktori / media oleh RDP dan sediakan perangkat pemasangan otomatis </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ home / user / runrdp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kami menambahkan argumen tambahan ke baris perintah rdesktop:</font></font><br><br><pre> <code class="bash hljs">rdesktop …... -r disk:USB=/media/</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang edit </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/home/user/.profile</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tambahkan panggilan ke unmount-devices.</font></font><br><br><pre> <code class="bash hljs">... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ -z <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$DISPLAY</span></span></span><span class="hljs-string">"</span></span> ] &amp;&amp; [ $(tty) = <span class="hljs-string"><span class="hljs-string">"/dev/tty1"</span></span> ]; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> startx clear unmount-devices <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">" 5    "</span></span> sleep 5 <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mulai ulang. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang, jika kita bekerja dalam sesi RDP, dan kita perlu menghubungkan disk USB ke Pi, kita cukup memasukkannya dan pergi ke komputer saya, di mana kita melihat kira-kira gambar berikut. </font></font><br><br><img src="https://habrastorage.org/webt/vu/l_/qu/vul_quyi50ig54vjbewcwgpa83w.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kita dapat dengan bebas menggunakan perangkat ini, mereka akan muncul sebagai folder (sda1-xx, sdb1-xx, dll.) </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika kita perlu menghapus perangkat, cukup tekan Ctrl + Alt + BkSp. Sesi akan terputus (dengan demikian, setiap penyalinan ke perangkat harus terputus, bahkan jika itu dilakukan), konsol akan menampilkan pelepasan perangkat (saat ini </font><font style="vertical-align: inherit;">mereka </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">semua</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dihapus dengan aman) dan pesan menunggu 5 detik sebelum menyambung kembali ke RDP.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kemudian, setelah menyambung kembali, Anda dapat memasukkan kata sandi dan terus bekerja dari titik yang sama, tetapi perangkat yang terhubung sebelumnya akan dilepas. </font><font style="vertical-align: inherit;">Pada titik ini, mereka dapat dihilangkan secara fisik. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini menyelesaikan langkah konfigurasi.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6. Mengkloning sistem ke Rpi lain </font></font></h2><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6.A Jika dikonfigurasi secara independen </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika semua rake dilepas, perangkat berfungsi dengan baik, maka Anda dapat memperpanjang perakitan ke perangkat lain. </font><font style="vertical-align: inherit;">Jika mereka dari jenis yang sama, maka tidak perlu mengulangi proses dari awal. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masukkan kartu SD (saya menemukan 16 gigabyte) ke dalam kartu adaptor, dan memasukkannya ke port USB Raspberry. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda telah mengkonfigurasi pemasangan otomatis dari bagian terakhir, jalankan skrip</font></font><br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># unmount-devices</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sehingga dia melepas mount kartu SD yang baru terhubung, yang, tentu saja, segera dipasang di / media / sdxx. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang jalankan perintah lsblk dan lihat daftar perangkat:</font></font><br><br><pre> <code class="plaintext hljs">sda 8:0 1 14.6G 0 disk └─sda1 8:1 1 14.6G 0 part mmcblk0 179:0 0 7.4G 0 disk ├─mmcblk0p1 179:1 0 256M 0 part /boot └─mmcblk0p2 179:2 0 7.2G 0 part /</code> </pre><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sda</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jelas kartu baru kami, dan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mmcblk0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah </font><font style="vertical-align: inherit;">kartu </font><font style="vertical-align: inherit;">sistem. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jalankan:</font></font><br><br><pre> <code class="plaintext hljs">dd if=/dev/mmcblk0 of=/dev/sda bs=4M</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan tunggu hasilnya, yang diperkirakan sekitar setengah jam (untuk kartu 8GB). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setelah itu, masukkan ke Raspberry lain, ubah nama host, nama pengguna dalam skrip runrdp, dan ulangi seperlunya.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6.B Unduh gambar yang sudah jadi </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika, tentu saja, Anda mempercayai saya, Anda dapat menggunakan gambar yang disiapkan oleh saya dengan sedikit mengkonfigurasi ulang. Bookmark, alat telemetri, dll. - Saya tidak menambahkan, ini bukan Windows 10, tapi saya bukan Microsoft, dan saya juga tidak percaya pada prospek ekonomi dari penambangan bitcoin tersembunyi di RPi. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar dikompilasi sesuai dengan instruksi, dan dipadatkan untuk digunakan pada kartu SD dengan ukuran minimum 2 GB Cina (tidak jujur) (1977614336 bytes). Selain itu, bagian yang terisi dari gambar umumnya menempati byte pertama 1966080000, yang harus pas bahkan di kartu SD Cina yang paling. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk melakukan ini: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1) Unduh arsip </font></font><a href="https://dropmefiles.com/ljUGS" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di tautan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (MD5: 0B5033A9CA12BA8299340BC482111998) dan unzip file gambar.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2) Salin ke kartu SD, menggunakan, dengan analogi, instruksi dari paragraf 1.2. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3) Boot sistem, tunggu layar grafis muncul dan tekan Ctrl + Alt + F2 untuk pergi ke konsol. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masuk sebagai pengguna pi, kata sandi 111. Jalankan:</font></font><br><br><pre> <code class="plaintext hljs">$ sudo bash</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4) Ikuti langkah 1.4, 2.1, pastikan Internet berfungsi (perintah ping, misalnya). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5) Jalankan raspi-config, buka Opsi Lanjutan, pilih Perluas Filesystem (untuk memperluas gambar sistem ke semua ruang yang tersedia pada kartu SD) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6) Edit / home / user / runrdp, ganti nama host server dengan nama atau IP alamat server Anda, dan nama pengguna "pengguna" ke nama pengguna yang harus terhubung oleh operator ke server. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7) Nyalakan kembali dan periksa operasi.</font></font><br><br><h2>  Kesimpulan </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekian, terima kasih atas perhatiannya. </font><font style="vertical-align: inherit;">Semoga informasi ini bermanfaat bagi seseorang. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sayangnya, mencakup semuanya dalam satu artikel sangat sulit. </font><font style="vertical-align: inherit;">Jika ada umpan balik positif, saya akan menulis bagaimana nyamannya untuk meneruskan printer dari unit ini. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS 12/11/2019. </font><font style="vertical-align: inherit;">Terima kasih kepada kolega (gecube, Mnemonik, mkovalevskyi, SannX) untuk tips dan suntingannya. </font><font style="vertical-align: inherit;">Melakukan perubahan:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menambahkan perintah shutdown screensaver; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menambahkan konfigurasi NTP; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengenai konsumsi memori pada server dengan beberapa koneksi yang tidak lengkap dari klien RDP - menambahkan kotak pesan ke skrip dengan jeda. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selain itu, saya baru saja menguji kartu yang dikeluarkan dari RPi3 dengan memasukkannya ke dalam RPi4 Model B 1Gb yang baru dibongkar. </font><font style="vertical-align: inherit;">Semuanya berfungsi dengan baik tanpa perbaikan. </font><font style="vertical-align: inherit;">Dengan demikian, instruksi ini juga cocok untuk RPi 4, dan mungkin cocok untuk modifikasi lainnya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk kegembiraan seperti itu, saya menambahkan gambar yang dapat diunduh (lihat bagian 6.B), yang dapat Anda unduh dan tiru tanpa mengikuti seluruh instruksi.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id479504/">https://habr.com/ru/post/id479504/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id479488/index.html">Dari laptop - server rumah dengan daya redundan ke router Mikrotik</a></li>
<li><a href="../id479492/index.html">Komputasi tanpa server berdasarkan OpenWhisk, bagian 3</a></li>
<li><a href="../id479496/index.html">Parsing Tugas WTF dalam JavaScript</a></li>
<li><a href="../id479498/index.html">Bagaimana waktu linear berubah menjadi Windows dalam O (n²)</a></li>
<li><a href="../id479502/index.html">Bagaimana cara bertahan hidup di zaman es paling parah dalam sejarah Bumi?</a></li>
<li><a href="../id479508/index.html">Antipatterns PostgreSQL: GABUNGAN dan OR berbahaya</a></li>
<li><a href="../id479510/index.html">Ulasan PocketBook X - pembaca 10,3 inci yang besar dengan layar E Ink Carta Mobius dan casing logam</a></li>
<li><a href="../id479512/index.html">MVCC dalam PostgreSQL-4. Jepretan</a></li>
<li><a href="../id479514/index.html">Privasi berdasarkan desain dan privasi secara default (perlindungan data yang dirancang dan privasi default oleh GDPR)</a></li>
<li><a href="../id479516/index.html">Apa itu entropi dalam perangkat lunak dan bagaimana cara mengelolanya?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>