<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèª‚Äçüé® üíß üé∫ PowerShell, Dump meiner Erfahrung üè¶ ‚¨úÔ∏è üìì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einf√ºhrung 


 Dieser Artikel richtet sich an diejenigen, die sich bereits mit den Grundlagen von PowerShell vertraut gemacht haben, einige Skripte mi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PowerShell, Dump meiner Erfahrung</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443256/"><h2 id="vvedenie">  Einf√ºhrung </h2><br><p>  Dieser Artikel richtet sich an diejenigen, die sich bereits mit den Grundlagen von PowerShell vertraut gemacht haben, einige Skripte mit Stackexchange ausf√ºhren und wahrscheinlich √ºber eine eigene Textdatei mit verschiedenen Snippets verf√ºgen, um die t√§gliche Arbeit zu erleichtern.  Der Zweck des Schreibens besteht darin, die Entropie zu verringern, die Lesbarkeit und Wartbarkeit des in Ihrem Unternehmen verwendeten PowerShell-Codes zu verbessern und infolgedessen die Produktivit√§t des Administrators zu steigern, der damit arbeitet. </p><br><p><img src="https://habrastorage.org/webt/go/9u/yw/go9uywfoytxpgrxmggcvf2bfi8e.png" alt="kdpv"></p><br><p>  An meinem fr√ºheren Arbeitsplatz habe ich aufgrund der Besonderheiten der Aufgaben und der Unvollkommenheit der Welt die F√§higkeit, mit PowerShell zu arbeiten, erheblich gesteigert.  Nach dem Wechsel der Arbeit nahmen die Belastungen dieser Art erheblich ab und alles, was sich um die Fingerspitzen befand, begann unter der Erfahrung, neue Probleme mit neuen Technologien zu l√∂sen, immer tiefer zu sinken.  Aus diesem Grund behauptet dieser Artikel, nur das zu sein, was er selbst deklariert, und enth√ºllt eine Liste von Themen, die meiner Meinung nach vor etwa 7 Jahren, als meine Bekanntschaft mit diesem Tool gerade erst begann, f√ºr mich selbst n√ºtzlich sein w√ºrden. </p><a name="habracut"></a><br><p>  Wenn Sie nicht verstehen, warum PowerShell eine objektorientierte Shell ist, aus welchen Boni sie stammen und warum sie √ºberhaupt erforderlich sind, empfehle ich Ihnen trotz der Hasser ein gutes Buch, das die Essenz dieser Umgebung schnell einf√ºhrt - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Andrey Vladimirovich Popov, Einf√ºhrung in Windows PowerShell</a> .  Ja, es geht um die alte Version von PS, ja, die Sprache hat einige Erweiterungen und Verbesserungen erhalten, aber dieses Buch ist gut, weil es bei der Beschreibung des fr√ºhen Entwicklungsstadiums dieser Umgebung unwissentlich nur grundlegende Dinge hervorhebt.  Ich denke, der syntaktische Zucker, mit dem die Umwelt √ºberwachsen ist, wird schnell wahrgenommen, ohne zu verstehen, wie das Konzept funktioniert.  Das Lesen dieses Buches dauert nur ein paar Abende. Kommen Sie nach dem Lesen zur√ºck. </p><br><p><img src="https://habrastorage.org/webt/g9/ea/h9/g9eah9nfoao7gukeochjqasi2ne.jpeg" alt="popov"></p><br><p>  Das Buch ist auch auf der Website des Autors verf√ºgbar, obwohl ich nicht sicher bin, wie lizenziert diese Verwendung ist: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://andpop.ru/courses/winscript/books/posh_popov.pdf</a> </p><br><h2 id="stayl-gaydy">  Styleguides </h2><br><p>  Das Entwerfen von Skripten nach Styleguides ist in allen F√§llen eine gute Praxis. Es kann kaum zwei Meinungen geben.  Einige √ñkosysteme haben sich auf der Ebene der nativen Abstimmung darum gek√ºmmert, pep8 in der Python-Community und go fmt in Golang sind offensichtlich.  Dies sind unsch√§tzbare zeitsparende Tools, die im Standard-PowerShell-Paket leider nicht vorhanden sind und daher das Problem auf unseren Kopf √ºbertragen.  Derzeit besteht die einzige M√∂glichkeit, das Problem der einheitlichen Code-Formatierung zu l√∂sen, darin, Reflexe zu entwickeln, indem wiederholt Code geschrieben wird, der den Stilrichtlinien entspricht (tats√§chlich nein). </p><br><p>  Styleguides wurden aufgrund der fehlenden offiziellen Genehmigung und detaillierten Beschreibung durch Microsoft in der Community w√§hrend der Zeit von PowerShell v3 geboren und haben sich seitdem in offener Form auf dem Github entwickelt: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PowerShellPracticeAndStyle</a> .  Dies ist ein bemerkenswertes Repository f√ºr alle, die jemals die Schaltfl√§che "Speichern" in PowerShell ise verwendet haben. </p><br><p>  Wenn Sie versuchen, einen Druck auszu√ºben, wird dies wahrscheinlich auf die folgenden Punkte zur√ºckzuf√ºhren sein: </p><br><ul><li>  PowerShell verwendet PascalCase, um Variablen, Cmdlets, Modulnamen und so ziemlich alles au√üer Operatoren zu benennen. </li><li> <code>-match</code> wie <code>if</code> , <code>switch</code> , <code>break</code> , <code>process</code> , <code>-match</code> werden in sehr kleinen Buchstaben geschrieben. </li><li>  Geschweifte Klammern werden auf die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einzig wahre Weise platziert</a> , die auch als Stil von Kernigan und Richie bezeichnet wird und seine Geschichte aus dem Buch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">The C Programming Language</a> leitet. </li><li>  Verwenden Sie keine anderen Aliase als eine interaktive Konsolensitzung. Schreiben Sie keine <code>ps | ? processname -eq firefox | %{$ws=0}{$ws+=$_.workingset}{$ws/1MB}</code> Skriptdatei <code>ps | ? processname -eq firefox | %{$ws=0}{$ws+=$_.workingset}{$ws/1MB}</code> <code>ps | ? processname -eq firefox | %{$ws=0}{$ws+=$_.workingset}{$ws/1MB}</code>  <code>ps | ? processname -eq firefox | %{$ws=0}{$ws+=$_.workingset}{$ws/1MB}</code> ; </li><li>  Geben Sie explizite Parameternamen an, das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Verhalten der Cmdlets und ihre Signatur k√∂nnen sich √§ndern.</a> Au√üerdem wird einer Person, die mit einem bestimmten Cmdlet nicht vertraut ist, ein Kontext hinzugef√ºgt. </li><li>  Entwerfen Sie die Parameter zum Aufrufen von Skripten und schreiben Sie keine Funktion in das Skript. In der letzten Zeile wird diese Funktion aufgerufen, wobei die Werte globaler Variablen ge√§ndert werden m√ºssen, anstatt Parameter anzugeben. </li><li>  Geben Sie [CmdletBinding ()] an - dies gibt Ihrem Cmdlet <code>-Verbose</code> und <code>-Debug</code> Flags und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vielen anderen n√ºtzlichen Funktionen</a> .  Trotz der festen Position einiger Puristen in der Community bin ich kein Bef√ºrworter der Angabe dieses Attributs in einfachen Inline-Funktionen und Filtern, die aus mehreren Zeilen bestehen. </li><li>  Schreiben Sie eine kommentarbasierte Hilfe: ein Satz, Ticketlink, Anrufbeispiel; </li><li>  Geben Sie die erforderliche Version von PowerShell im Abschnitt <code>#requires</code> . </li><li>  Verwenden Sie <code>Set-StrictMode -Version Latest</code> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">um die unten beschriebenen Probleme zu vermeiden</a> . </li><li>  Fehler behandeln; </li><li>  Beeilen Sie sich nicht, alles in PowerShell neu zu schreiben.  PowerShell ist in erster Linie eine Shell und das Aufrufen von Bin√§rdateien ist seine direkte Aufgabe.  Es ist nichts Falsches daran, Robocopy in einem Skript zu verwenden. Nat√ºrlich ist es nicht rsync, aber es ist auch sehr gut. </li></ul><br><h2 id="comment-based-help">  Kommentarbasierte Hilfe </h2><br><p>  Unten finden Sie ein Beispiel, wie Sie ein Hilfeskript erhalten.  Das Skript rahmt das Bild ein, bringt es auf ein Quadrat und f√ºhrt eine Gr√∂√üen√§nderung durch. Ich denke, Sie haben die Aufgabe, Avatare f√ºr Benutzer zu erstellen (au√üer vielleicht die Drehung gem√§√ü Exif-Daten).  <code>.EXAMPLE</code> Abschnitt <code>.EXAMPLE</code> finden Sie ein Verwendungsbeispiel. <code>.EXAMPLE</code> es aus.  Aufgrund der Tatsache, dass PowerShell wie andere Dotnet-Sprachen von der Common Language Runtime ausgef√ºhrt wird, kann es die volle Leistung von Dotnet-Bibliotheken nutzen: </p><br><pre> <code class="plaintext hljs">&lt;# .SYNOPSIS Resize-Image resizes an image file .DESCRIPTION This function uses the native .NET API to crop a square and resize an image file .PARAMETER InputFile Specify the path to the image .PARAMETER OutputFile Specify the path to the resized image .PARAMETER SquareHeight Define the size of the side of the square of the cropped image. .PARAMETER Quality Jpeg compression ratio .EXAMPLE Resize the image to a specific size: .\Resize-Image.ps1 -InputFile "C:\userpic.jpg" -OutputFile "C:\userpic-400.jpg"-SquareHeight 400 #&gt; # requires -version 3 [CmdletBinding()] Param( [Parameter( Mandatory )] [string]$InputFile, [Parameter( Mandatory )] [string]$OutputFile, [Parameter( Mandatory )] [int32]$SquareHeight, [ValidateRange( 1, 100 )] [int]$Quality = 85 ) # Add System.Drawing assembly Add-Type -AssemblyName System.Drawing # Open image file $Image = [System.Drawing.Image]::FromFile( $InputFile ) # Calculate the offset for centering the image $SquareSide = if ( $Image.Height -lt $Image.Width ) { $Image.Height $Offset = 0 } else { $Image.Width $Offset = ( $Image.Height - $Image.Width ) / 2 } # Create empty square canvas for the new image $SquareImage = New-Object System.Drawing.Bitmap( $SquareSide, $SquareSide ) $SquareImage.SetResolution( $Image.HorizontalResolution, $Image.VerticalResolution ) # Draw new image on the empty canvas $Canvas = [System.Drawing.Graphics]::FromImage( $SquareImage ) $Canvas.DrawImage( $Image, 0, -$Offset ) # Resize image $ResultImage = New-Object System.Drawing.Bitmap( $SquareHeight, $SquareHeight ) $Canvas = [System.Drawing.Graphics]::FromImage( $ResultImage ) $Canvas.DrawImage( $SquareImage, 0, 0, $SquareHeight, $SquareHeight ) $ImageCodecInfo = [System.Drawing.Imaging.ImageCodecInfo]::GetImageEncoders() | Where-Object MimeType -eq 'image/jpeg' # https://msdn.microsoft.com/ru-ru/library/hwkztaft(v=vs.110).aspx $EncoderQuality = [System.Drawing.Imaging.Encoder]::Quality $EncoderParameters = New-Object System.Drawing.Imaging.EncoderParameters( 1 ) $EncoderParameters.Param[0] = New-Object System.Drawing.Imaging.EncoderParameter( $EncoderQuality, $Quality ) # Save the image $ResultImage.Save( $OutputFile, $ImageCodecInfo, $EncoderParameters )</code> </pre> <br><p>  Das obige Skript beginnt mit einem mehrzeiligen Kommentar <code>&lt;# ... #&gt;</code> . Wenn dieser Kommentar an erster Stelle steht und bestimmte Schl√ºsselw√∂rter enth√§lt, erstellt PowerShell automatisch eine Hilfe f√ºr das Skript.  Diese Art von Hilfe wird w√∂rtlich genannt - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hilfe basierend auf dem Kommentar</a> : </p><br><p><img src="https://habrastorage.org/webt/9y/tw/d3/9ytwd3hlr6yb5nsobqqor_bjshw.png" alt="Hilfe"></p><br><p>  Wenn das Skript aufgerufen wird, funktionieren au√üerdem die QuickInfos f√ºr die Parameter, unabh√§ngig davon, ob es sich um die PowerShell-Konsole oder den Code-Editor handelt: </p><br><p><img src="https://habrastorage.org/webt/tr/ha/qg/trhaqga49fwvjphbl6i_cporowa.png" alt="Inline-Hilfe"></p><br><p>  Ich mache noch einmal darauf aufmerksam, dass sie nicht zu vernachl√§ssigen ist.  Wenn Sie nicht wissen, was Sie dort schreiben sollen, schreiben Sie etwas, gehen Sie zum K√ºhler und nach Ihrer R√ºckkehr haben Sie definitiv ein Verst√§ndnis daf√ºr, was in der Schrift ge√§ndert werden muss.  Es funktioniert.  Es lohnt sich nicht, alle Schl√ºsselw√∂rter fanatisch auszuf√ºllen. PowerShell ist so konzipiert, dass es sich selbst dokumentiert. Wenn Sie den Parametern aussagekr√§ftige und vollst√§ndige Namen gegeben haben, reicht ein kurzer Satz im Abschnitt <code>.SYNOPIS</code> und ein Beispiel v√∂llig aus. </p><br><h2 id="strict-mode">  Strenger Modus </h2><br><p>  PowerShell verf√ºgt wie viele andere Skriptsprachen √ºber eine dynamische Typisierung.  Diese Art des Schreibens hat viele Bef√ºrworter: Das Schreiben einer einfachen, aber leistungsstarken Logik auf hoher Ebene dauert nur wenige Minuten. Wenn Ihre Entscheidung jedoch tausend Zeilen umfasst, werden Sie mit Sicherheit auf die Fragilit√§t dieses Ansatzes sto√üen. </p><br><p>  Die automatische Ausgabe von Typen in der Testphase, die an der Stelle, an der Sie immer eine Reihe von Elementen erhalten haben, ein Array bildete, wird definitiv ein Schwein setzen, falls Sie ein Element erhalten, und in der folgenden Bedingung erhalten Sie, anstatt die Anzahl der Elemente zu √ºberpr√ºfen, die Anzahl der Zeichen oder ein anderes Attribut, abh√§ngig von Art des Artikels.  Die Logik des Skripts bricht ab und die Laufzeit gibt vor, dass alles in Ordnung ist. </p><br><p>  Das Festlegen des strengen Modus hilft, einige dieser Probleme zu vermeiden, erfordert jedoch auch etwas mehr Code von Ihnen, z. B. das Initialisieren von Variablen und das explizite Casting. </p><br><p>  Dieser Modus wird durch das <code>Set-StrictMode -Version Latest</code> aktiviert. Obwohl es andere Optionen f√ºr "Rigor" gibt, habe ich die Wahl, letzteres zu verwenden. </p><br><p>  Im folgenden Beispiel ruft der strikte Modus eine nicht vorhandene Eigenschaft auf.  Da sich nur ein Element im Ordner befindet, lautet der Typ der Variablen <code>$Input</code> als Ergebnis der Ausf√ºhrung <code>FileInfo</code> und nicht das erwartete Array der entsprechenden Elemente: </p><br><p><img src="https://habrastorage.org/webt/fk/q-/jk/fkq-jkrdldogwcwyiwkwspskseq.png" alt="streng"></p><br><p>  Um ein solches Problem zu vermeiden, sollten Sie das Ergebnis des Cmdlets explizit in ein Array umwandeln: </p><br><pre> <code class="plaintext hljs">$Items = @( Get-ChildItem C:\Users\snd3r\Nextcloud )</code> </pre> <br><p>  Machen Sie es sich zur Regel, immer den strengen Modus festzulegen. Auf diese Weise k√∂nnen Sie unerwartete Ergebnisse beim Ausf√ºhren Ihrer Skripte vermeiden. </p><br><h2 id="obrabotka-oshibok">  Fehlerbehandlung </h2><br><h3 id="erroractionpreference">  ErrorActionPreference </h3><br><p>  Wenn ich mir die Skripte anderer Leute anschaue, zum Beispiel auf einem Github, sehe ich oft, dass entweder der Fehlerbehandlungsmechanismus vollst√§ndig ignoriert wird oder der stille Fortsetzungsmodus im Fehlerfall explizit aktiviert wird.  Das Problem der Fehlerbehandlung ist sicherlich nicht das am einfachsten zu programmierende im Allgemeinen und in Skripten im Besonderen, aber es verdient definitiv nicht, ignoriert zu werden.  Standardm√§√üig zeigt PowerShell im Fehlerfall diesen an und funktioniert weiter (ich habe das Konzept etwas vereinfacht, aber unten finden Sie einen Link zu einem Git-Buch zu diesem Thema).  Dies ist praktisch, wenn Sie das Update eines in der Dom√§ne weit verbreiteten Programms dringend an alle Computer verteilen m√ºssen, ohne zu warten, bis es sich auf alle sccm-Bereitstellungspunkte oder auf eine andere von Ihnen verwendete Weise ausbreitet.  Es ist unangenehm, den Prozess zu unterbrechen und neu zu starten, wenn eine der Maschinen ausgeschaltet ist. Dies ist wahr. </p><br><p>  Wenn Sie andererseits eine komplexe Sicherung eines Systems erstellen, das aus mehr als einer Datendatei von mehr als einem Teil des Informationssystems besteht, m√ºssen Sie sicherstellen, dass Ihre Sicherung konsistent ist und dass alle erforderlichen Datens√§tze fehlerfrei kopiert wurden. </p><br><p>  Um das Verhalten von Cmdlets im Fehlerfall zu √§ndern, gibt es eine globale Variable <code>$ErrorActionPreference</code> mit der folgenden Liste m√∂glicher Werte: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Stop, Inquire, Continue, Suspend, SilentlyContinue</a> . </p><br><p>  Ich empfehle, dass Sie immer den <code>Stop</code> Wert verwenden, wenn die Anzahl der Skripte oder deren Komplexit√§t nicht mehr auf dem Stapel in Ihrem Kopf gespeichert ist. Es ist besser sicherzustellen, dass das Skript in einer unvorhergesehenen Situation seine Arbeit stoppt und das Brennholz nicht ‚Äûleise‚Äú bricht und die Ausf√ºhrung ‚Äûerfolgreich‚Äú abschlie√üt. </p><br><p>  Neben dem Stoppen des Skripts f√ºr den Fall, dass etwas schief geht, gibt es eine weitere Voraussetzung f√ºr seine Verwendung - den Umgang mit Ausnahmesituationen.  Hierf√ºr gibt es ein <code>try/catch</code> Konstrukt, das jedoch nur funktioniert, wenn der Fehler dazu f√ºhrt, dass die Ausf√ºhrung gestoppt wird.  Es ist nicht erforderlich, dass der Stopp auf der Ebene des gesamten Skripts <code>ErrorAction</code> ist. <code>ErrorAction</code> kann <code>ErrorAction</code> auf der Cmdlet-Ebene mit dem folgenden Parameter festgelegt werden: </p><br><pre> <code class="plaintext hljs">Get-ChildItem 'C:\System Volume Information\' -ErrorAction 'Stop'</code> </pre> <br><p>  Tats√§chlich definiert diese M√∂glichkeit zwei logische Strategien: <code>ErrorAction</code> alle Fehler "standardm√§√üig" und legen Sie <code>ErrorAction</code> nur f√ºr kritische Stellen fest, an denen sie behandelt werden sollen.  Aktivieren Sie entweder auf der Ebene des gesamten Skripts, indem Sie den Wert der globalen Variablen <code>-ErrorAction 'Continue'</code> und <code>-ErrorAction 'Continue'</code> f√ºr nicht kritische Vorg√§nge <code>-ErrorAction 'Continue'</code> .  Ich w√§hle immer die zweite Option. Ich habe es nicht eilig, sie Ihnen aufzuzwingen. Ich empfehle nur einmal, dieses Problem zu verstehen und dieses n√ºtzliche Tool zu verwenden. </p><br><h3 id="trycatch">  versuchen / fangen </h3><br><p>  In der Fehlerbehandlungsroutine k√∂nnen Sie nach Art der Ausnahme √ºbereinstimmen und mit einem Ausf√ºhrungsthread arbeiten oder beispielsweise ein wenig mehr Informationen hinzuf√ºgen.  Trotz der Tatsache, dass Sie mit den Operatoren <code>try/catch/throw/trap</code> den gesamten Ablauf der Skriptausf√ºhrung erstellen k√∂nnen, sollten Sie dies kategorisch vermeiden, da eine solche Methode des Betriebs mit Ausf√ºhrung nicht nur als extremer Antipater aus der Kategorie "goto-noodle" angesehen wird verringert auch die Leistung drastisch. </p><br><pre> <code class="plaintext hljs">#requires -version 3 $ErrorActionPreference = 'Stop' #   ,    , #          $Logger = Get-Logger "$PSScriptRoot\Log.txt" #    trap { $Logger.AddErrorRecord( $_ ) exit 1 } #    $count = 1; while ( $true ) { try { #   $StorageServers = @( Get-ADGroupMember -Identity StorageServers | Select-Object -Expand Name ) } catch [System.Management.Automation.CommandNotFoundException] { #      ,         throw " Get-ADGroupMember ,    Active Directory module for PowerShell; $( $_.Exception.Message )" } catch [System.TimeoutException] { #             if ( $count -le 3 ) { $count++; Start-Sleep -S 10; continue } #             throw "     -   ,   $count ; $( $_.Exception.Message )" } #         break }</code> </pre> <br><p>  Es ist erw√§hnenswert, dass der <code>trap</code> Operator eine globale Fehlerfalle ist.  Es f√§ngt alles ab, was nicht auf niedrigeren Ebenen verarbeitet wurde oder aus dem Ausnahmebehandler geworfen wird, da es unm√∂glich ist, die Situation unabh√§ngig zu korrigieren. </p><br><p>  Neben dem oben beschriebenen objektorientierten Ansatz von Ausnahmen bietet PowerShell auch bekanntere Konzepte, die mit anderen "klassischen" Shells kompatibel sind, z. B. Fehlerstr√∂me, R√ºckkehrcodes und Variablen zur Fehlerakkumulation.  All dies ist sicherlich praktisch, manchmal ohne Alternative, geht aber √ºber den Rahmen dieses Gesamt√ºbersichtsthemas hinaus.  Zum Gl√ºck gibt es ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gutes offenes Buch √ºber Github</a> zu diesem Thema. </p><br><p>  Der Code des Loggers, den ich verwende, wenn es keine Gewissheit gibt, dass das System √ºber PowerShell 5 verf√ºgt (wo Sie die Logger-Klasse bequemer beschreiben k√∂nnen). Probieren Sie ihn aus. Er kann Ihnen aufgrund seiner Einfachheit und K√ºrze n√ºtzlich sein. Sie werden sicher ohne Schwierigkeiten zus√§tzliche Methoden hinzuf√ºgen. :: </p><br><pre> <code class="plaintext hljs">#   " ",   PowerShell v3 function Get-Logger { [CmdletBinding()] param ( [Parameter( Mandatory = $true )] [string] $LogPath, [string] $TimeFormat = 'yyyy-MM-dd HH:mm:ss' ) $LogsDir = [System.IO.Path]::GetDirectoryName( $LogPath ) New-Item $LogsDir -ItemType Directory -Force | Out-Null New-Item $LogPath -ItemType File -Force | Out-Null $Logger = [PSCustomObject]@{ LogPath = $LogPath TimeFormat = $TimeFormat } Add-Member -InputObject $Logger -MemberType ScriptMethod AddErrorRecord -Value { param( [Parameter( Mandatory = $true )] [string]$String ) "$( Get-Date -Format 'yyyy-MM-dd HH:mm:ss' ) [Error] $String" | Out-File $this.LogPath -Append } return $Logger }</code> </pre> <br><p>  Ich wiederhole die Idee - ignoriere die Fehlerbehandlung nicht.  Dies spart Ihnen auf lange Sicht Zeit und Nerven. <br>  Denken Sie nicht, dass das Ausf√ºhren des Skripts, egal was gut ist.  Gut - es ist Zeit zu fallen, ohne Brennholz zu zerbrechen. </p><br><h2 id="instrumenty">  Die Werkzeuge </h2><br><p>  Es lohnt sich, die Tools f√ºr die Arbeit mit PowerShell √ºber den Konsolenemulator zu verbessern.  Ich habe oft von Anh√§ngern alternativer Wespen geh√∂rt, dass die Konsole in Windows schlecht ist und dass dies √ºberhaupt keine Konsole ist, sondern dos und so weiter.  Nur wenige konnten ihre Behauptungen zu diesem Thema angemessen formulieren, aber wenn es jemandem gelang, stellte sich in Wirklichkeit heraus, dass alle Probleme gel√∂st werden konnten.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Es</a> gab bereits mehr Informationen √ºber die Terminals und die neue Konsole in Windows am Hub, dort ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">alles mehr als in Ordnung</a> . </p><br><p>  Der erste Schritt ist die Installation von Conemu oder seiner Cmder-Baugruppe, was nicht besonders wichtig ist, da es meiner Meinung nach ohnehin einen Durchlauf der Einstellungen wert ist.  Normalerweise w√§hle ich cmder in der Minimalkonfiguration ohne Gita und andere Bin√§rdateien, die ich selbst festgelegt habe, obwohl ich meine Konfiguration mehrere Jahre lang auf reines Conemu abgestimmt habe.  Dies ist wirklich der beste Terminalemulator f√ºr Windows, mit dem Sie den Bildschirm (f√ºr tmux- / Bildschirmliebhaber) teilen, Registerkarten erstellen und den Konsolenmodus im Bebenstil aktivieren k√∂nnen: </p><br><h3 id="conemu">  Conemu </h3><br><p><img src="https://habrastorage.org/webt/ag/2w/hy/ag2whyp2okkhyroygpuzjkdamis.png" alt="cmder"></p><br><p>  Im n√§chsten Schritt empfehle ich, die Module zu platzieren: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">oh-my-posh</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">posh-git</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PSReadLine</a> .  Die ersten beiden machen den Abschlussball angenehmer, indem sie Informationen √ºber die aktuelle Sitzung, den Status des zuletzt ausgef√ºhrten Befehls, die Berechtigungsanzeige und den Status des Git-Repositorys am aktuellen Speicherort hinzuf√ºgen.  PSReadLine steigert die Promt erheblich und f√ºgt beispielsweise eine Suche nach dem Verlauf eingegebener Befehle (CRTL + R) und praktische Tipps f√ºr Cmdlets in CRTL + Space hinzu: </p><br><p><img src="https://habrastorage.org/webt/eg/w6/f2/egw6f2sa43hgi3dhwn_hhgxbesa.gif" alt="readline"></p><br><p>  Und ja, jetzt kann die Konsole mit STRG + L gel√∂scht werden und <code>cls</code> vergessen. </p><br><h3 id="visual-studio-code">  Visual Studio Code </h3><br><p>  Der Herausgeber.  Das Schlimmste, was ich √ºber PowerShell sagen kann, ist reine PowerShell ISE. Diejenigen, die die erste Version mit drei Panels gesehen haben, werden diese Erfahrung wahrscheinlich nicht vergessen.  Die unterschiedliche Codierung des Terminals, das Fehlen grundlegender Editorfunktionen wie automatisches Einr√ºcken, automatisch schlie√üende Klammern, Codeformatierung und eine ganze Reihe von Antimustern, √ºber die ich Ihnen (nur f√ºr den Fall) nichts erz√§hlen werde - hier geht es nur um ISE. </p><br><p>  Verwenden Sie es nicht, verwenden Sie Visual Studio Code mit der PowerShell-Erweiterung - es gibt alles, was Sie nicht m√∂chten (nat√ºrlich in angemessenen Grenzen).  Und vergessen Sie nicht, dass in PoweShell bis zur sechsten Version (PowerShell Core 6.0) die Codierung f√ºr Skripte UTF8-St√ºckliste ist, da sonst die russische Sprache besch√§digt wird. </p><br><p><img src="https://habrastorage.org/webt/dd/c0/pa/ddc0paj-xbx5tysllsrmzlxnugi.png" alt="vscode"></p><br><p>  Zus√§tzlich zur Hervorhebung der Syntax, QuickInfos und Funktionen zum Debuggen von Skripten installiert das Plugin einen Linter, mit dem Sie die in der Community etablierten Praktiken befolgen k√∂nnen, z. B. Verkn√ºpfungen mit einem Klick erweitern (auf die Gl√ºhbirne).  Tats√§chlich ist dies ein regul√§res Modul, das unabh√§ngig <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">installiert werden</a> kann. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">F√ºgen</a> Sie es beispielsweise Ihren Pipeline-Signaturskripten hinzu: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PSScriptAnalyzer</a> </p><br><p><img src="https://habrastorage.org/webt/mj/x7/ov/mjx7ovrtephqcdctuiptdu_tff4.png" alt="PSScriptAnalyzer"></p><br><p>  Sie k√∂nnen die Code-Formatierungsparameter in den Erweiterungseinstellungen festlegen. F√ºr alle Einstellungen (sowohl den Editor als auch die Erweiterungen) wird gesucht: <code>File - Preferences - Settings</code> : </p><br><p><img src="https://habrastorage.org/webt/ia/xr/km/iaxrkmgjcpcf4wck1ocb7kfp9ym.png" alt="Otbs"></p><br><p>  Um eine neue leere Konsole zu erhalten, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sollten</a> Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das Flag in den Einstellungen setzen</a> . Sp√§ter ist dieser Rat wahrscheinlich irrelevant. </p><br><p>  Es ist zu beachten, dass jede Aktion in VS Code vom Kontrollzentrum aus ausgef√ºhrt werden kann, das mit STRG + Umschalt + P aufgerufen wird. Formatieren Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einen aus dem Chat eingef√ºgten</a> Code, sortieren Sie ihn alphabetisch, √§ndern Sie den Einzug von Leerzeichen in Tabulatoren usw. im Kontrollzentrum. </p><br><p>  Schalten Sie beispielsweise den Vollbildmodus ein und zentrieren Sie den Editor: </p><br><p><img src="https://habrastorage.org/webt/3z/w9/-a/3zw9-avzniwjgooxfa1dvzi9kfc.png" alt="Layout"></p><br><h3 id="source-control-git-svn">  Quellcodeverwaltung  Git, SVN </h3><br><p>  Windows-Systemadministratoren haben h√§ufig eine Phobie der Konfliktl√∂sung in Versionskontrollsystemen, wahrscheinlich weil, wenn ein Vertreter dieses Satzes Git verwendet, h√§ufig keine derartigen Probleme auftreten.  Mit vscode wird die Konfliktl√∂sung auf einen Mausklick auf die Teile des Codes reduziert, die verlassen oder ersetzt werden m√ºssen. </p><br><p><img src="https://habrastorage.org/webt/ft/fd/8f/ftfd8f1ylxofsckzu6v1uujok1e.png" alt="zusammenf√ºhren"></p><br><p>  Diese Beschriftungen zwischen den Zeilen 303 und 304 k√∂nnen angeklickt werden. Es lohnt sich, im Konfliktfall auf alle im Dokument angezeigten Beschriftungen zu klicken, die √Ñnderungen festzuschreiben und die √Ñnderungen an den Server zu senden.  U - Bequemlichkeit. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Informationen</a> zur Arbeit mit Versionskontrollsystemen finden Sie unter und mit Bildern <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">, die im vscode-Dock geschrieben sind</a> , gehen Sie dort kurz und gut √ºber Ihre Augen. </p><br><h3 id="snippets">  Schnipsel </h3><br><p>  <a href="">Snippets</a> sind eine Art Makro / Vorlage, mit der Sie das Schreiben von Code beschleunigen k√∂nnen.  Auf jeden Fall ein Muss. </p><br><p>  Schnelle Objekterstellung: </p><br><p><img src="https://habrastorage.org/webt/yi/wp/om/yiwpomlohxird5oovnutj4hc7ec.gif" alt="benutzerdefiniertes Objekt"></p><br><p>  Fisch f√ºr kommentarbasierte Hilfe: </p><br><p><img src="https://habrastorage.org/webt/ol/jn/37/oljn37jxzabxa9h4yqquuh98s9i.gif" alt="Hilfe"></p><br><p>  Wenn das Cmdlet eine gro√üe Anzahl von Parametern √ºbergeben muss, ist es sinnvoll, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Splatting</a> zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">verwenden</a> . <br>  Hier ist ein Ausschnitt f√ºr ihn: </p><br><p><img src="https://habrastorage.org/webt/lx/y_/ek/lxy_ekyxsjsuiad66yzqqfoxzta.gif" alt="splatting"></p><br><p>  Alle verf√ºgbaren Schnipsel anzeigen, die mit Strg + Alt + J verf√ºgbar sind: </p><br><p><img src="https://habrastorage.org/webt/0p/jm/k_/0pjmk_nms2ejlugtcsxvp1vjhea.gif" alt="Schnipsel"></p><br><p>  Wenn Sie danach den Wunsch hatten, Ihre Umgebung weiter zu verbessern, aber noch nichts von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wespenbl√§ttern geh√∂rt haben, dann sind Sie hier</a> .  Wenn Sie beim Schreiben von PowerShell-Skripten √ºber eigene Erweiterungen verf√ºgen, die f√ºr Sie n√ºtzlich sind, freue ich mich √ºber deren Liste in den Kommentaren. </p><br><h2 id="proizvoditelnost">  Leistung </h2><br><p>  Das Thema Performance ist nicht so einfach, wie es auf den ersten Blick erscheinen mag.  Einerseits k√∂nnen vorzeitige Optimierungen die Lesbarkeit und Wartbarkeit des Codes erheblich beeintr√§chtigen und 300 ms Skriptausf√ºhrungszeit einsparen, deren √ºbliche Laufzeit zehn Minuten betragen kann. Ihre Verwendung ist in diesem Fall definitiv destruktiv.  Auf der anderen Seite gibt es einige ziemlich einfache Tricks, die sowohl die Lesbarkeit des Codes als auch seine Geschwindigkeit verbessern und f√ºr die fortlaufende Verwendung durchaus geeignet sind.  Im Folgenden werde ich auf einige davon eingehen. Wenn die Leistung alles f√ºr Sie ist und die Lesbarkeit aufgrund der strengen Fristen f√ºr Ausfallzeiten w√§hrend der Wartung auf der Strecke bleibt, empfehle ich Ihnen, sich auf die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">entsprechende</a> Literatur zu beziehen. </p><br><h3 id="pipeline-i-foreach">  Pipeline und foreach </h3><br><p>  Der einfachste und stets funktionierende Weg zur Steigerung der Produktivit√§t besteht darin, die Verwendung von Rohren zu vermeiden.  Aus Gr√ºnden der Sicherheit und Bequemlichkeit des Typs umh√ºllt PowerShell Elemente, die durch ein Rohr gef√ºhrt werden, jedes Element in ein Objekt.  In Dotnet-Sprachen wird dieses Verhalten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">als Boxen bezeichnet</a> .  Boxen ist gut, es garantiert Sicherheit, aber es hat seinen eigenen Preis, was manchmal keinen Sinn macht, zu zahlen. </p><br><p>  Der erste Schritt besteht darin, die Leistung zu steigern und meiner Meinung nach die Lesbarkeit zu verbessern, indem alle Anwendungen des <code>Foreach-Object</code> und durch die foreach-Anweisung ersetzt werden.  Es mag Ihnen peinlich sein, dass dies tats√§chlich zwei verschiedene Entit√§ten sind, da <code>foreach</code> ein Alias ‚Äã‚Äãf√ºr <code>Foreach-Object</code> In der Praxis besteht der Hauptunterschied darin, dass <code>foreach</code> keine Werte aus einer Pipeline akzeptiert, aber erfahrungsgem√§√ü bis zu dreimal schneller arbeitet. </p><br><p>  Stellen Sie sich das Problem vor: Wir m√ºssen ein gro√ües Protokoll verarbeiten, um eine Ableitung davon zu bilden. W√§hlen Sie beispielsweise eine Reihe von Eintr√§gen aus und bringen Sie sie in ein anderes Format: </p><br><pre> <code class="plaintext hljs">Get-Content D:\temp\SomeHeavy.log | Select-String '328117'</code> </pre> <br><p>        ‚Äî       ,      .         ‚Äî ,        ,    <code>Get-Content</code> .                  <code>string</code>  ,    ,            .    ‚Äî      ,         : </p><br><blockquote> When reading from and writing to binary files, use the AsByteStream parameter and a value of 0 for the ReadCount parameter. A ReadCount value of 0 reads the entire file in a single read operation. The default ReadCount value, 1, reads one byte in each read operation and converts each byte into a separate object, which causes errors when you use the Set-Content cmdlet to write the bytes to a file unless you use AsByteStream <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-content</a> </blockquote><br><pre> <code class="plaintext hljs">Get-Content D:\temp\SomeHeavy.log -ReadCount 0 | Select-String '328117'</code> </pre> <br><p>                : </p><br><p><img src="https://habrastorage.org/webt/t2/bg/hw/t2bghwyeop1gofgu_tapyqimp3o.png" alt="readcount"></p><br><p>        ,          .    <code>Select-String</code>          ‚Äî       .                ,          <code>Select-String</code> .      ,      <code>Select-String</code>       ,        ,             : </p><br><pre> <code class="plaintext hljs">foreach ( $line in ( Get-Content D:\temp\SomeHeavy.log -ReadCount 0 )) { if ( $line -match '328117' ) { $line } }</code> </pre> <br><p>        30 , -   30%,           ,         ,        , - ,   (     ;-).      ,     .         ,    <code>-match</code> ;   ‚Äî     .                ,      ‚Äî               ‚Äî   -   ,    . </p><br><p>   ‚Äî -   ,   " "              : </p><br><pre> <code class="plaintext hljs">foreach ( $line in ( Get-Content D:\temp\SomeHeavy.log -ReadCount 0 )) { if ( $line -match '328117' ) { "$( Get-Date -UFormat '%d.%m.%Y %H:%M:%S') $line" | Out-File D:\temp\Result.log -Append } }</code> </pre> <br><p>     <code>Measure-Command</code> : </p><br><pre> <code class="plaintext hljs">Hours : 2 Minutes : 20 Seconds : 9 Milliseconds : 101</code> </pre> <br><p>   .   ,           ,          ,      .    ,    PowerShell           ,    ,       ‚Äî        .         ,    ,            ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">StringBuilder</a> .                 ,            ,           .          ,                     . </p><br><pre> <code class="plaintext hljs">$StringBuilder = New-Object System.Text.StringBuilder foreach ( $line in ( Get-Content D:\temp\SomeHeavy.log -ReadCount 0 )) { if ( $line -match '328117' ) { $null = $StringBuilder.AppendLine( "$( Get-Date -UFormat '%d.%m.%Y %H:%M:%S') $line" ) } } Out-File -InputObject $StringBuilder.ToString() -FilePath D:\temp\Result.log -Append -Encoding UTF8</code> </pre> <br><p>      5 ,      : </p><br><pre> <code class="plaintext hljs">Hours : 0 Minutes : 5 Seconds : 37 Milliseconds : 150</code> </pre> <br><p>    <code>Out-File -InputObject</code> ,    ,       .          ‚Äî        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   </a>    .              ‚Äî  <code>Get-Help</code>     <code>-Full</code> ,         <code>Accept pipeline input? true (ByValue)</code> : </p><br><pre> <code class="plaintext hljs">-InputObject &lt;psobject&gt; Required? false Position? Named Accept pipeline input? true (ByValue) Parameter set name (All) Aliases None Dynamic? false</code> </pre> <br><p>    PowerShell     : </p><br><p><img src="https://habrastorage.org/webt/8d/zl/r-/8dzlr-yjpt13avpi_wjibzdpnxs.png" alt="taskmgr"></p><br><p>    <code>StringBuilder</code>                           : </p><br><p><img src="https://habrastorage.org/webt/lc/4j/1c/lc4j1c3-um9jozjohlauurwzo3a.png" alt="stringbuilder alloc"></p><br><p>    ,    ,  3  3.        dotnet-      ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">StreamReader</a> . </p><br><pre> <code class="plaintext hljs">$StringBuilder = New-Object System.Text.StringBuilder $StreamReader = New-Object System.IO.StreamReader 'D:\temp\SomeHeavy.log' while ( $line = $StreamReader.ReadLine()) { if ( $line -match '328117' ) { $null = $StringBuilder.AppendLine( "$( Get-Date -UFormat '%d.%m.%Y %H:%M:%S') $line" ) } } $StreamReader.Dispose() Out-File -InputObject $StringBuilder.ToString() -FilePath C:\temp\Result.log -Append -Encoding UTF8</code> </pre> <br><pre> <code class="plaintext hljs">Hours : 0 Minutes : 5 Seconds : 33 Milliseconds : 657</code> </pre> <br><p>      ,       .               ,     ,       ,    ,          2.        ,          : </p><br><p><img src="https://habrastorage.org/webt/wr/ka/_w/wrka_wcvj1idodxx_37ka8wnhmm.png" alt="streamreader"></p><br><p>        ‚Äî      "",   ‚Äî  <code>StringBuilder</code> ‚Äî ""       .   ,      (  100)           .       ‚Äî       90%    (        ,     ): </p><br><pre> <code class="plaintext hljs">$BufferSize = 104857600 $StringBuilder = New-Object System.Text.StringBuilder $BufferSize $StreamReader = New-Object System.IO.StreamReader 'C:\temp\SomeHeavy.log' while ( $line = $StreamReader.ReadLine()) { if ( $line -match '1443' ) { #      if ( $StringBuilder.Length -gt ( $BufferSize - ( $BufferSize * 0.1 ))) { Out-File -InputObject $StringBuilder.ToString() -FilePath C:\temp\Result.log -Append -Encoding UTF8 $StringBuilder.Clear() } $null = $StringBuilder.AppendLine( "$( Get-Date -UFormat '%d.%m.%Y %H:%M:%S') $line" ) } } Out-File -InputObject $StringBuilder.ToString() -FilePath C:\temp\Result.log -Append -Encoding UTF8 $StreamReader.Dispose()</code> </pre> <br><pre> <code class="plaintext hljs">Hours : 0 Minutes : 5 Seconds : 53 Milliseconds : 417</code> </pre> <br><p>     1      : </p><br><p><img src="https://habrastorage.org/webt/rg/ro/f6/rgrof6lxdcrx96urvmxuflcbdbc.png" alt="streamreader with dump"></p><br><p>              ,                 .     ,      ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">StreamWriter</a> ,   ,   ;-)      ,        ,    . </p><br><p> -     ‚Äî     ,        .    ,     ‚Äî  .  <code>Select-String</code>  <code>Out-File</code>    ,        <code>OutOfMemoryException</code> ,    ‚Äî    . </p><br><h3 id="nativnye-binarniki">   </h3><br><p> ,      PowerShell         ,         ‚Äî ,  : PowerShell ‚Äî          ,     . </p><br><p>  ,       <code>StringBuilder</code>     <code>dir</code> ‚Äî          (  ).          : </p><br><pre> <code class="plaintext hljs">$CurrentPath = ( Get-Location ).Path + '\' $StringBuilder = New-Object System.Text.StringBuilder foreach ( $Line in ( &amp;cmd /c dir /b /s /ad )) { $null = $StringBuilder.AppendLine( $Line.Replace( $CurrentPath, '.' )) } $StringBuilder.ToString()</code> </pre> <br><pre> <code class="plaintext hljs">Hours : 0 Minutes : 0 Seconds : 3 Milliseconds : 9</code> </pre> <br><pre> <code class="plaintext hljs">$StringBuilder = New-Object System.Text.StringBuilder foreach ( $Line in ( Get-ChildItem -File -Recurse | Resolve-Path -Relative )) { $null = $StringBuilder.AppendLine( $Line ) } $StringBuilder.ToString()</code> </pre> <br><pre> <code class="plaintext hljs">Hours : 0 Minutes : 0 Seconds : 16 Milliseconds : 337</code> </pre> <br><p>     $null ‚Äî     .  ,    ‚Äî    <code>Out-Null</code> ;  ,    (   <code>$null</code> )     ,   . </p><br><pre> <code class="plaintext hljs"># : $null = $StringBuilder.AppendLine( $Line ) # : $StringBuilder.AppendLine( $Line ) | Out-Null</code> </pre> <br><p>           ,          ,  .      <code>Compare-Object</code> ,      ,      ,       .            robocopy.exe,      (   PowerShell 5),      : </p><br><pre> <code class="plaintext hljs">class Robocopy { [String]$RobocopyPath Robocopy () { $this.RobocopyPath = Join-Path $env:SystemRoot 'System32\Robocopy.exe' if ( -not ( Test-Path $this.RobocopyPath -PathType Leaf )) { throw '    ' } } [void]CopyFile ( [String]$SourceFile, [String]$DestinationFolder ) { $this.CopyFile( $SourceFile, $DestinationFolder, $false ) } [void]CopyFile ( [String]$SourceFile, [String]$DestinationFolder, [bool]$Archive ) { $FileName = [IO.Path]::GetFileName( $SourceFile ) $FolderName = [IO.Path]::GetDirectoryName( $SourceFile ) $Arguments = @( '/R:0', '/NP', '/NC', '/NS', '/NJH', '/NJS', '/NDL' ) if ( $Archive ) { $Arguments += $( '/A+:a' ) } $ErrorFlag = $false &amp;$this.RobocopyPath $FolderName $DestinationFolder $FileName $Arguments | Foreach-Object { if ( $ErrorFlag ) { $ErrorFlag = $false throw "$_ $ErrorString" } else { if ( $_ -match '(?&lt;=\(0x[\da-f]{8}\))(?&lt;text&gt;(.+$))' ) { $ErrorFlag = $true $ErrorString = $matches.text } else { $Logger.AddRecord( $_.Trim()) } } } if ( $LASTEXITCODE -eq 8 ) { throw 'Some files or directories could not be copied' } if ( $LASTEXITCODE -eq 16 ) { throw 'Robocopy did not copy any files. Check the command line parameters and verify that Robocopy has enough rights to write to the destination folder.' } } [void]SyncFolders ( [String]$SourceFolder, [String]$DestinationFolder ) { $this.SyncFolders( $SourceFolder, $DestinationFolder, '*.*', '', $false ) } [void]SyncFolders ( [String]$SourceFolder, [String]$DestinationFolder, [Bool]$Archive ) { $this.SyncFolders( $SourceFolder, $DestinationFolder, '*.*', '', $Archive ) } [void]SyncFolders ( [String]$SourceFolder, [String]$DestinationFolder, [String]$Include ) { $this.SyncFolders( $SourceFolder, $DestinationFolder, $Include, '', $false ) } [void]SyncFolders ( [String]$SourceFolder, [String]$DestinationFolder, [String]$Include, [Bool]$Archive ) { $this.SyncFolders( $SourceFolder, $DestinationFolder, $Include, '', $Archive ) } [void]SyncFolders ( [String]$SourceFolder, [String]$DestinationFolder, [String]$Include, [String]$Exclude ) { $this.SyncFolders( $SourceFolder, $DestinationFolder, $Include, $Exclude, $false ) } [void]SyncFolders ( [String]$SourceFolder, [String]$DestinationFolder, [String]$Include, [String]$Exclude, [Bool]$Archive ) { $Arguments = @( '/MIR', '/R:0', '/NP', '/NC', '/NS', '/NJH', '/NJS', '/NDL' ) if ( $Exclude ) { $Arguments += $( '/XF' ) $Arguments += $Exclude.Split(' ') } if ( $Archive ) { $Arguments += $( '/A+:a' ) } $ErrorFlag = $false &amp;$this.RobocopyPath $SourceFolder $DestinationFolder $Include $Arguments | Foreach-Object { if ( $ErrorFlag ) { $ErrorFlag = $false throw "$_ $ErrorString" } else { if ( $_ -match '(?&lt;=\(0x[\da-f]{8}\))(?&lt;text&gt;(.+$))' ) { $ErrorFlag = $true $ErrorString = $matches.text } else { $Logger.AddRecord( $_.Trim()) } } } if ( $LASTEXITCODE -eq 8 ) { throw 'Some files or directories could not be copied' } if ( $LASTEXITCODE -eq 16 ) { throw 'Robocopy did not copy any files. Check the command line parameters and verify that Robocopy has enough rights to write to the destination folder.' } } }</code> </pre> <br><p>                ,             (      ),         ‚Äî    . </p><br><p>   ,   :        <code>Foreach-Object</code> !?  ,             :    <code>foreach</code> ,  <code>Foreach-Object</code>          ‚Äî   ,   , ,   ,      .       . </p><br><p>       ,     : </p><br><pre> <code class="plaintext hljs">$Robocopy = New-Object Robocopy #    $Robocopy.CopyFile( $Source, $Dest ) #   $Robocopy.SyncFolders( $SourceDir, $DestDir ) #    .xml     $Robocopy.SyncFolders( $SourceDir, $DestDir , '*.xml', $true ) #     *.zip *.tmp *.log     $Robocopy.SyncFolders( $SourceDir, $DestDir, '*.*', '*.zip *.tmp *.log', $true )</code> </pre> <br><h3 id="poslevkusie">  Nachgeschmack </h3><br><p>        ‚Äî           ,       ,            ;   ,        ,   ,     : </p><br><ul><li><p>   <code>foreach</code>   <code>Foreach-Object</code>  ; </p><br></li><li><p>   ; </p><br></li><li><p> /  ,   ; </p><br></li><li><p>  <code>StringBuilder</code>    ; </p><br></li><li><p>      ,   - ; </p><br></li><li><p>      ( ""    ); </p><br></li></ul><br><p>     :    -   ,     . </p><br><h2 id="jobs"> Jobs </h2><br><p>  ,     ,        ,    ,      ,        ,     .            .      ,      IO,               . </p><br><div class="spoiler"> <b class="spoiler_title">    ssd</b> <div class="spoiler_text"><p>       Windows Server 2019  Hyper-V  ssd (    hdd): </p><br><p><img src="https://habrastorage.org/webt/mo/eu/jf/moeujfnupkxphhi7uso_hjbzsys.jpeg" alt="2019ssd"></p></div></div><br><p>    PowerShell       ( <code>Get-Command *-Job</code> ),    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> . </p><br><p>      ,  ,  ,     : </p><br><pre> <code class="plaintext hljs">$Job = Start-Job -ScriptBlock { Write-Output 'Good night' Start-Sleep -S 10 Write-Output 'Good morning' } $Job | Wait-Job | Receive-Job Remove-Job $Job</code> </pre> <br><p>          ,         ‚Äî       ,    .             <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">     </a> . </p><br><p>      ,      : </p><br><p><img src="https://habrastorage.org/webt/gc/um/r-/gcumr-9xsk2fh5c5m7epk1eozqg.png" alt="jobs"><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://xaegr.wordpress.com/2011/07/12/threadping/</a> </p><br><p> ,      ,   ‚Äî     ,                 .  , ,     (50  ‚Äî  50 ): </p><br><p><img src="https://habrastorage.org/webt/3f/pg/xg/3fpgxg51u9augjj9iua05wm6fgi.png" alt="job dies"></p><br><p>           .    ,  ‚Äî            ,        .     ‚Äî           ,    . </p><br><p>   ,           , ,              - . </p><br><h2 id="runspaces"> Runspaces </h2><br><p>                  ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beginning Use of PowerShell Runspaces: Part 1</a> . ,  ‚Äî    PowerShell        ,        .             (,    PowerShell ),       :      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">       (  )</a>       .        ,            . </p><br><p>          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WPF </a> ,              PowerShell,     .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> ‚Äî      ,   .    ‚Äî            ,         "" .     . </p><br><p>       ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">           </a> . </p><br><p><img src="https://habrastorage.org/webt/cx/pp/7v/cxpp7vozkcxdsl_ibdyva0_z3wi.gif" alt="wpf"></p><br><pre> <code class="plaintext hljs">#     $GUISyncHash = [hashtable]::Synchronized(@{}) &lt;# WPF  #&gt; $GUISyncHash.FormXAML = [xml](@" &lt;Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Title="Sample WPF Form" Height="510" Width="410" ResizeMode="NoResize"&gt; &lt;Grid&gt; &lt;Label Content=" " HorizontalAlignment="Left" Margin="10,10,0,0" VerticalAlignment="Top" Height="37" Width="374" FontSize="18"/&gt; &lt;Label Content="" HorizontalAlignment="Left" Margin="16,64,0,0" VerticalAlignment="Top" Height="26" Width="48"/&gt; &lt;TextBox x:Name="BackupPath" HorizontalAlignment="Left" Height="23" Margin="69,68,0,0" TextWrapping="Wrap" Text="" VerticalAlignment="Top" Width="300"/&gt; &lt;Label Content="" HorizontalAlignment="Left" Margin="16,103,0,0" VerticalAlignment="Top" Height="26" Width="35"/&gt; &lt;TextBox x:Name="RestorePath" HorizontalAlignment="Left" Height="23" Margin="69,107,0,0" TextWrapping="Wrap" Text="" VerticalAlignment="Top" Width="300"/&gt; &lt;Button x:Name="FirstButton" Content="‚àö" HorizontalAlignment="Left" Margin="357,68,0,0" VerticalAlignment="Top" Width="23" Height="23"/&gt; &lt;Button x:Name="SecondButton" Content="‚àö" HorizontalAlignment="Left" Margin="357,107,0,0" VerticalAlignment="Top" Width="23" Height="23"/&gt; &lt;CheckBox x:Name="Check" Content="  " HorizontalAlignment="Left" Margin="16,146,0,0" VerticalAlignment="Top" RenderTransformOrigin="-0.113,-0.267" Width="172"/&gt; &lt;Button x:Name="Go" Content="Go" HorizontalAlignment="Left" Margin="298,173,0,0" VerticalAlignment="Top" Width="82" Height="26"/&gt; &lt;ComboBox x:Name="Droplist" HorizontalAlignment="Left" Margin="16,173,0,0" VerticalAlignment="Top" Width="172" Height="26"/&gt; &lt;ListBox x:Name="ListBox" HorizontalAlignment="Left" Height="250" Margin="16,210,0,0" VerticalAlignment="Top" Width="364"/&gt; &lt;/Grid&gt; &lt;/Window&gt; "@) &lt;#   #&gt; $GUISyncHash.GUIThread = { $GUISyncHash.Window = [Windows.Markup.XamlReader]::Load(( New-Object System.Xml.XmlNodeReader $GUISyncHash.FormXAML )) $GUISyncHash.Check = $GUISyncHash.Window.FindName( "Check" ) $GUISyncHash.GO = $GUISyncHash.Window.FindName( "Go" ) $GUISyncHash.ListBox = $GUISyncHash.Window.FindName( "ListBox" ) $GUISyncHash.BackupPath = $GUISyncHash.Window.FindName( "BackupPath" ) $GUISyncHash.RestorePath = $GUISyncHash.Window.FindName( "RestorePath" ) $GUISyncHash.FirstButton = $GUISyncHash.Window.FindName( "FirstButton" ) $GUISyncHash.SecondButton = $GUISyncHash.Window.FindName( "SecondButton" ) $GUISyncHash.Droplist = $GUISyncHash.Window.FindName( "Droplist" ) $GUISyncHash.Window.Add_SourceInitialized({ $GUISyncHash.GO.IsEnabled = $true }) $GUISyncHash.FirstButton.Add_Click( { $GUISyncHash.ListBox.Items.Add( 'Click FirstButton' ) }) $GUISyncHash.SecondButton.Add_Click( { $GUISyncHash.ListBox.Items.Add( 'Click SecondButton' ) }) $GUISyncHash.GO.Add_Click( { $GUISyncHash.ListBox.Items.Add( 'Click GO' ) }) $GUISyncHash.Window.Add_Closed( { Stop-Process -Id $PID -Force }) $null = $GUISyncHash.Window.ShowDialog() } $Runspace = @{} $Runspace.Runspace = [RunspaceFactory]::CreateRunspace() $Runspace.Runspace.ApartmentState = "STA" $Runspace.Runspace.ThreadOptions = "ReuseThread" $Runspace.Runspace.Open() $Runspace.psCmd = { Add-Type -AssemblyName PresentationCore, PresentationFramework, WindowsBase }.GetPowerShell() $Runspace.Runspace.SessionStateProxy.SetVariable( 'GUISyncHash', $GUISyncHash ) $Runspace.psCmd.Runspace = $Runspace.Runspace $Runspace.Handle = $Runspace.psCmd.AddScript( $GUISyncHash.GUIThread ).BeginInvoke() Start-Sleep -S 1 $GUISyncHash.ListBox.Dispatcher.Invoke( "Normal", [action] { $GUISyncHash.ListBox.Items.Add( '' ) }) $GUISyncHash.ListBox.Dispatcher.Invoke( "Normal", [action] { $GUISyncHash.ListBox.Items.Add( '  ' ) }) foreach ( $item in 1..5 ) { $GUISyncHash.Droplist.Dispatcher.Invoke( "Normal", [action] { $GUISyncHash.Droplist.Items.Add( $item ) $GUISyncHash.Droplist.SelectedIndex = 0 }) } $GUISyncHash.ListBox.Dispatcher.Invoke( "Normal", [action] { $GUISyncHash.ListBox.Items.Add( 'While ( $true ) { Start-Sleep -S 10 }' ) }) while ( $true ) { Start-Sleep -S 10 }</code> </pre> <br><p>      WPF       github,       ,       smart : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://github.com/snd3r/GetDiskSmart/</a> .          ,    MVVM: </p><br><p><img src="https://habrastorage.org/webt/ke/-1/mb/ke-1mbcf2zuyg6crqt70zx4aoqw.png" alt="binging"></p><br><p>        Visual Studio,            Community Edition                 ,          xaml-  wpf ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://github.com/punker76/kaxaml</a> </p><br><p><img src="https://habrastorage.org/webt/wf/wd/j1/wfwdj1mhk_f8bml8clv3n6sv02a.png" alt="kaxaml"></p><br><h2 id="vmesto-zaklyucheniya">  Anstelle einer Schlussfolgerung </h2><br><p> PowerShell ‚Äî        Windows-.   ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  </a> ,           ,            . </p><br><p>      ,                ,   "PowerShell,  ",   .           ,        ‚Äî     ,      .                 .          ,  -    , -                . </p><br><p>          ‚Äî    . </p><br><p><img src="https://habrastorage.org/webt/fd/qg/_1/fdqg_1uamuh8rc66ahep2utydeo.png" alt="calm"></p><br><p> PS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">Boomburum</a> ,    2019   powershell ‚Äî  . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de443256/">https://habr.com/ru/post/de443256/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de443244/index.html">Nachbesprechungsaufgaben. Beanpoisk_1</a></li>
<li><a href="../de443246/index.html">Wie wir Askozia IP PBX neu erfunden haben, nachdem das Projekt vom Entwickler verkauft und geschlossen wurde</a></li>
<li><a href="../de443248/index.html">Protokolle zur nahtlosen Reservierung von PRP und HSR</a></li>
<li><a href="../de443252/index.html">Modulare Ant Bots mit Speicher</a></li>
<li><a href="../de443254/index.html">Triton ist das t√∂dlichste Virus</a></li>
<li><a href="../de443258/index.html">Gotify - ein Open Source-Projekt zum √úbermitteln von Benachrichtigungen und zum Senden von Nachrichten an den Server</a></li>
<li><a href="../de443260/index.html">Migrieren Sie nach Zimbra, ohne das Gesch√§ft mit einer gemeinsamen Domain zu riskieren</a></li>
<li><a href="../de443262/index.html">Schlechter Rat: Wie schreibe ich technische Dokumentation? Teil drei und zuletzt</a></li>
<li><a href="../de443264/index.html">Er spricht und zeigt: Ist die Rhetorik popul√§rer ukrainischer Politiker anders?</a></li>
<li><a href="../de443266/index.html">Wie wir dazu beigetragen haben, die Arbeit des Rechnungswesens in einem gro√üen Energieunternehmen zu ver√§ndern</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>