<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧓🏻 🧛🏼 🌖 Panduan Antrian Sederhana di Mikrotik 🤞🏽 🚰 🚵</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ada banyak artikel di Internet yang ditujukan untuk pembatasan kecepatan dan berbagi lalu lintas pada peralatan MikroTik, tetapi hampir semua mengangg...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Panduan Antrian Sederhana di Mikrotik</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420117/"><p>  Ada banyak artikel di Internet yang ditujukan untuk pembatasan kecepatan dan berbagi lalu lintas pada peralatan MikroTik, tetapi hampir semua menganggap hanya Pohon Antrian, yang membutuhkan pemahaman mendalam dan berlebihan dalam banyak tugas dan dapat digantikan oleh Antrian Sederhana. </p><a name="habracut"></a><br><p>  Antrian yang disederhanakan - mekanisme untuk membagi kapasitas saluran dan memprioritaskan lalu lintas yang terkait dengan target tertentu.  Lalu lintas masuk dan keluar dihitung relatif terhadap target. </p><br><p>  Ada tiga opsi untuk sasaran: ip, subnet, antarmuka.  Anda dapat menambahkan beberapa target untuk satu aturan. </p><br><h3 id="teoreticheskaya-chast">  Bagian teoretis </h3><br><h4 id="sheypery-planirovschiki-i-ocheredi">  Pembentuk, Perencana, dan Antrian </h4><br><p>  Kecepatan data diukur dalam kaitannya dengan informasi yang ditransmisikan dalam bit per detik waktu - bit / detik.  Unit bit kecil, sehingga mereka menggunakan awalan kilo (kbit / detik), mega (Mbit / detik), pertunjukan (Gbit / detik). </p><br><p>  Kecepatan pengiriman paket melalui jaringan komunikasi selalu sama dengan kecepatan transmisi medium (misalnya, 100Mbit / detik untuk Ethernet 100BASE-TX).  Jika perlu untuk mengurangi kecepatan ini, perangkat perantara, seperti router, menerima paket dari satu antarmuka pada kecepatan maksimum mengirimkannya dari yang lain dengan penundaan tertentu, jika paket melebihi batas kecepatan yang ditetapkan, mereka disimpan dalam antrian dan dikirim sesuai dengan Masuk Pertama, Keluar Pertama ( FIFO), jika antrian penuh (ukuran hilang atau nol), router membuang paket. </p><br><p>  <strong>Limit</strong> - batas kecepatan administratif untuk lalu lintas yang datang dari antarmuka. <br>  <strong>Shaper (Shaper)</strong> - algoritma perangkat lunak yang menunda dan membuang paket berlebih. <br>  <strong>Penjadwal (Sheduler)</strong> - suatu algoritma yang memutuskan bagaimana menyimpan dan mengirim paket yang melampaui batas. <br>  <strong>Antrian</strong> - algoritma penyimpanan dan penentuan prioritas untuk lalu lintas yang lewat. </p><br><p>  Contoh grafis dari karya pembentuk dan penjadwal. </p><br><p>  Menggunakan Shaper Out of Line </p><br><p><img src="https://habrastorage.org/webt/rk/60/8_/rk608_lhdbfv_zstsgrk0t_6rpq.png"></p><br><p>  Menggunakan Pembentuk dengan Penjadwal </p><br><p><img src="https://habrastorage.org/webt/ln/ry/im/lnryimsagc89acaf3pgjy9qollk.png"></p><br><h4 id="simple-queues-na-packet-flow">  Antrian Sederhana pada Aliran Paket </h4><br><p>  Antrian Sederhana muncul setelah Antrian Pohon, kadang-kadang antrian sederhana digunakan untuk dengan cepat membatasi lalu lintas ke satu (atau beberapa) pengguna, tanpa mengganggu Pohon Antrian. </p><br><div class="spoiler">  <b class="spoiler_title">Aliran Paket Sederhana untuk mereka yang tertarik</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/9k/yk/vr/9kykvrkaxqkpncv_hjsqc3i9ssg.png"></p></div></div><br><h4 id="mehanika-raboty-ocheredey-none-pfifo-pcq">  Mekanika antrian: tidak ada, pfifo, pcq </h4><br><p>  <strong>tidak ada</strong> - tidak ada antrian, jika batas terlampaui, semua paket baru dibuang. </p><br><p>  <strong>pfifo</strong> adalah algoritma fifo berorientasi paket.  Menyimpan jumlah paket yang ditentukan dalam pengaturan.  Digunakan secara default di Antrian Sederhana. </p><br><p><img src="https://habrastorage.org/webt/o-/af/gv/o-afgv9hsemh5ekrhrloakgatnm.png"></p><br><p>  <strong>pcq (Per Koneksi Antrian)</strong> - semua lalu lintas dibagi menjadi sub-antrian tergantung pada serangkaian kondisi.  Dari setiap sub-antrian, sebagian dari lalu lintas dikirim secara bergantian.  Ruang kosong ditempati oleh lalu lintas yang baru tiba.  Jika tempat di sub-antrian habis, maka paket yang ditujukan untuk itu akan dibuang. </p><br><p><img src="https://habrastorage.org/webt/0j/ya/2i/0jya2iixjm_adtvot6x5cuoa00u.png"></p><br><p>  Pertimbangkan sebagian kecil pengaturan: <br>  <strong>Nilai</strong> : batas kecepatan untuk masing-masing sub-antrian. <br>  <strong>Batas</strong> : Ukuran antrian dalam kilobyte. <br>  <strong>Batas total</strong> : ukuran total semua sub-antrian dalam kilobyte. <br>  <em>Batas rasio / batas Total dipilih berdasarkan situasi.</em>  <em>Secara default, 40 antrian (2000/50), tunduk pada pengisian lalu lintas maksimum.</em> <br>  <strong>Burst</strong> : tentang dia akan lebih rendah. <br>  <strong>Pengklasifikasi</strong> : berdasarkan pada apa yang membagi lalu lintas ke dalam antrian. <br>  Pengklasifikasi mengambil bergantian koneksi yang berbeda, jika Anda pergi [IP] -&gt; [Firewall] -&gt; [Koneksi], maka dapat dicatat bahwa sebagian besar koneksi berisi alamat dan port pengirim (alamat src., Port src.) Dan penerima ( alamat dst, port dst). </p><br><p>  Kami membahas antrian sederhana, jadi untuk kesederhanaan kami akan mempertimbangkan bahwa kami hanya menyaring lalu lintas yang datang dari antarmuka, dalam hal ini, relatif terhadap target, lalu lintas keluar (unggah) akan diklasifikasikan oleh src.  alamat, dan masuk (unduh) oleh dst.  alamat </p><br><p>  Klasifikasi berdasarkan port akan membantu menghindari situasi menyumbat antrian dengan lalu lintas dari satu aplikasi, jika satu aplikasi menghasilkan banyak koneksi keluar (misalnya, torrent atau web. Browser dengan banyak tab), maka src mereka akan berbeda.  pelabuhan dan lalu lintas juga akan dibagi menjadi antrian. </p><br><h4 id="dinamicheskiy-sheyping-sredstvami-pcq">  Pembentukan dinamis menggunakan PCQ </h4><br><p>  Jika Nilai ditetapkan secara ketat, maka setiap sub-aliran akan memiliki kecepatan yang diberikan dan tidak akan dapat melampauinya hingga kecepatan total semua sub-aliran melebihi batas yang lebih tinggi (dalam Antrian Sederhana ini adalah Batas Total), dalam hal ini kecepatan semua sub-aliran akan berkurang secara proporsional. </p><br><p><img src="https://habrastorage.org/webt/k8/z4/rb/k8z4rbxttud1n5yzgb0iapcpvom.png"></p><br><p>  Jika Nilai diatur ke 0, maka batasan yang lebih tinggi akan dibagi di antara semua sub-aliran.  Sebenarnya, ini adalah pembentukan dinamis. </p><br><p><img src="https://habrastorage.org/webt/g-/ig/rm/g-igrm9quokfmrvbmot1fh5_g5e.png"></p><br><p>  Jika Nilai diatur ke 0 dan Batas Total untuk Antrian Sederhana tidak ditentukan, maka kecepatan antara sub-utas akan dibagi berdasarkan batas yang lebih tinggi, jika antrian tidak disarangkan, ini adalah batasan antarmuka fisik.  Jika rencana tarif Anda lebih rendah, maka sebagian dari lalu lintas akan terbunuh pada peralatan penyedia dan tidak akan ada manfaat dari antrian. </p><br><p><img src="https://habrastorage.org/webt/0k/um/i7/0kumi7g7yykezh0v0jlkcp3dd8u.png"></p><br><p>  <em>Jenis antrian yang tersisa (SFQ, RED) memiliki karakteristik dan aplikasi mereka sendiri dan dapat digunakan untuk Antrian Sederhana juga, tetapi sekarang mereka tidak menarik bagi kami.</em> </p><br><h4 id="markirovka-paketov">  Pelabelan Paket </h4><br><p>  Ya, dalam antrian sederhana Anda dapat menggunakan lalu lintas berlabel.  Ini bukan prasyarat (tidak seperti Antrian Pohon), tetapi memungkinkan Anda untuk menjauh dari keterbatasan target. </p><br><p> Pelabelan lalu lintas terjadi di [IP] -&gt; [Firewall] -&gt; [Mangle], secara total ada tiga jenis label: Koneksi, Paket, Rute.  Setiap paket dapat berisi satu label dari setiap jenis.  Setelah di mangle, paket melewati satu per satu sesuai dengan semua aturan, jika ada dua label set yang meleleh, aturan yang lebih rendah akan menimpa label dari yang atas.  Untuk mencegah overwriting, Anda bisa menonaktifkan jalannya paket ke rantai di aturan pertama ( <code>passtrought=no</code> ). </p><br><p>  Saat mengatur antrian, Anda hanya dapat menggunakan label paket ( <code>action=mark-packet</code> ).  Tetapi untuk meningkatkan kinerja (label koneksi diperiksa lebih cepat daripada memeriksa kondisi di setiap paket), disarankan untuk menandai koneksi ( <code>action=mark-connection</code> ) terlebih dahulu, dan kemudian paket dalam koneksi ini ( <code>action=mark-package</code> ).  <em>Aturan dengan koneksi pra-penandaan tidak selalu benar, tetapi jika Anda sampai pada pemahaman ini ketika membangun antrian, maka Anda harus menggunakan Pohon Antrian.</em> </p><br><p>  Anda dapat menandai lalu lintas transit di salah satu rantai Packet Flow, tetapi dalam kebanyakan kasus saya lebih suka menggunakan forward, karena  Pada tahap ini, alamat penerima dengan pengirim dan nama-nama antarmuka masuk dan keluar dikenal. </p><br><div class="spoiler">  <b class="spoiler_title">Contoh Pelabelan Lalu Lintas</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/4p/fk/kk/4pfkkkzdf7nrl0eew8x7ckapnas.png"></p><br><pre> <code class="plaintext hljs">/ip firewall mangle add action=mark-connection chain=forward connection-state=new dst-port=5060,10000-20000 new-connection-mark=output-sip-and-rtp passthrough=yes protocol=udp src-address=192.168.100.0/24 add action=mark-packet chain=forward connection-mark=output-sip-and-rtp new-packet-mark=output-packet-sip-and-rtp passthrough=no</code> </pre> </div></div><br><h4 id="chto-takoe-burst">  Apa yang meledak </h4><br><p>  Biasanya, batas kecepatan dipahami sebagai nilai statis tertentu dari batas per detik setelah mencapai paket mana yang dibuang atau diantrekan.  Burst beroperasi dengan nilai rata-rata per satuan waktu, ini memungkinkan untuk menggunakan kecepatan (puncak) yang lebih tinggi dalam waktu singkat dan membatasi kecepatan dengan beban konstan pada saluran. </p><br><p>  <strong>Batas Maks</strong> adalah batasan utama. <br>  <strong>Burst Limit</strong> - kecepatan puncak, mengambil prioritas di atas Batas Maks saat mengamati kecepatan rata-rata yang ditentukan. <br>  <strong>Burst Threshold</strong> - kecepatan batas. <br>  <strong>Burst Time</strong> - waktu. </p><br><p>  Target mendapatkan kecepatan dari Burst Limit, tetapi setiap detik kecepatan rata-rata untuk waktu Burst akan dihitung.  Jika kecepatan rata-rata untuk waktu tertentu melebihi Burst Threshold, maka pengguna akan dibatasi hingga Batas Maks, jika kecepatan rata-rata kembali ke normal, maka target akan kembali menerima Batas Burst. </p><br><div class="spoiler">  <b class="spoiler_title">Studi Kasus Burst</b> <div class="spoiler_text"><p>  Aturan Burst: </p><br><p><img src="https://habrastorage.org/webt/x8/e6/kr/x8e6krcahevnrpazzw3eo1rlrv8.png"></p><br><p>  Diagram alir menunjukkan perubahan kecepatan target: </p><br><p><img src="https://habrastorage.org/webt/ss/u8/_i/ssu8_i_b8z-kbg9etldtnkzu9ga.png"></p><br><p>  Dan seperti apa perubahan kecepatan target terlihat: </p><br><p><img src="https://habrastorage.org/webt/av/kz/jb/avkzjbsh7wfduzsflatk8fqutqc.png"></p></div></div><br><p>  <em>Jika Anda tertarik dengan tema Burst, saya sarankan membaca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">informasi di wiki</a> , ada grafik dan tabel berdasarkan yang mana akan menjadi lebih baik untuk memahami bagaimana Nilai Ambang dan Waktu mempengaruhi batas kecepatan.</em> </p><br><h4 id="razlichie-limit-at-i-max-limit">  Batas Perbedaan pada dan Batas Maks </h4><br><p><img src="https://habrastorage.org/webt/ii/n7/jh/iin7jhchctr21e2n5i1jenft-my.png"></p><br><p>  <strong>Batasi pada</strong> - kecepatan dijamin untuk aturan.  Sangat diinginkan bahwa jumlah semua Batas di tidak melebihi bandwidth saluran.  Selalu kurang dari maksimal. <br>  <strong>Batas Maks</strong> - kecepatan maksimum untuk aturan.  Jika "anggaran" antrian memungkinkan, maka bandwidth maksimum akan dialokasikan. </p><br><p>  Biasanya hanya Batas Maksimum yang ditunjukkan dalam antrian yang disederhanakan dan ini berfungsi dengan baik, tetapi dalam konfigurasi antrian bertingkat, kedua batas harus ditentukan. </p><br><h3 id="prakticheskaya-chast">  Bagian praktis </h3><br><p>  Antrian sederhana dikonfigurasikan dalam [Antrian] -&gt; [Antrian Sederhana]. <br>  Aturan diproses secara bergantian dari atas ke bawah, aturan pertama yang cocok diterapkan pada paket yang lewat.  Bahkan, pengecualian dapat dibuat dari aturan apa pun dengan menempatkan aturan yang lebih spesifik di atas. </p><br><h4 id="ogranichenie-skorosti-dlya-konkretnogo-hostapodsetiinterfeysa">  Batas Kecepatan Host / Subnet / Antarmuka </h4><br><p>  Biasanya digunakan ketika perlu untuk membunuh kecepatan pengguna tertentu. <br>  Nama: nama apa saja <br>  Target: alamat, subnet, atau antarmuka. <br>  Unggahan Target: batas kecepatan keluar. <br>  Targer Download: batas kecepatan masuk. </p><br><p>  Batas kecepatan hingga 1Mbit / detik: </p><br><p><img src="https://habrastorage.org/webt/rj/0l/dy/rj0ldymsyrl-ulstludlvz6uhty.png"></p><br><pre> <code class="plaintext hljs">/queue simple add max-limit=1M/1M name=Limit-For-100.200 queue=default/default target=192.168.100.200/32</code> </pre> <br><p>  Dalam Statistik, Anda dapat melihat kecepatan saat ini untuk target, jumlah paket dalam antrian, dan jumlah paket yang dijatuhkan. </p><br><h4 id="ogranichenie-skorosti-dlya-udalennogo-resursa">  Batas kecepatan untuk sumber daya jarak jauh </h4><br><p>  Opsi tanpa label paket. </p><br><p>  Di bidang dst, mirip dengan target dapat ditentukan: ip, subnet, antarmuka.  Dalam kondisi Internet modern ini tidak cukup, tetapi dapat bermanfaat bagi perusahaan kecil dan batas kecepatan antar kantor. </p><br><p><img src="https://habrastorage.org/webt/jo/fi/te/jofiteubgejsubajjte9e26smj0.png"></p><br><pre> <code class="plaintext hljs">/queue simple add dst=192.168.200.10/32 max-limit=10M/10M name=Limit-For-Fileserver target=192.168.100.0/24</code> </pre> <br><h4 id="ravnocennoe-delenie-kanala-mezhdu-uchastnikami-podseti-pcq">  Pembagian saluran yang sama antara peserta subnet (pcq) </h4><br><p>  Satu aturan yang akan menyelamatkan subnet rumah atau kantor Anda dari tangkapan saluran eksklusif (dalam contoh 50Mb / detik, sesuaikan dengan saluran Anda) oleh satu pengguna. </p><br><p><img src="https://habrastorage.org/webt/w_/nl/mg/w_nlmgmsen5nlddzajhh1jm3v0y.png"></p><br><p>  Antrian pcq yang ditentukan hadir dalam konfigurasi dasar, tetapi saya lampirkan tangkapan layar jika terjadi perubahan. </p><br><p><img src="https://habrastorage.org/webt/ki/xk/-s/kixk-svzxxq8i3c7ekpzj_tynyc.png"></p><br><pre> <code class="plaintext hljs"># /queue type add kind=pcq name=pcq-upload-default pcq-burst-rate=0 pcq-burst-threshold=0 pcq-burst-time=10s pcq-classifier=src-address pcq-dst-address-mask=32 pcq-dst-address6-mask=128 pcq-limit=50KiB pcq-rate=0 pcq-src-address-mask=32 pcq-src-address6-mask=128 pcq-total-limit=2000KiB add kind=pcq name=pcq-download-default pcq-burst-rate=0 pcq-burst-threshold=0 pcq-burst-time=10s pcq-classifier=dst-address pcq-dst-address-mask=32 pcq-dst-address6-mask=128 pcq-limit=50KiB pcq-rate=0 pcq-src-address-mask=32 pcq-src-address6-mask=128 pcq-total-limit=2000KiB # Simple queues /queue simple add max-limit=50M/50M name=Limit-Equivalent queue=pcq-upload-default/pcq-download-default target=192.168.100.0/24</code> </pre> <br><p>  Pada tab Statistik, Anda dapat melihat berapa banyak utas pcq saat ini dalam antrian. </p><br><p><img src="https://habrastorage.org/webt/yz/8s/vf/yz8svfgkm1oz-veqdsihxt0t_lq.png"></p><br><h4 id="markirovannyy-trafik">  Lalu lintas yang ditandai </h4><br><p>  Opsi pertama sangat terbatas dan jika Anda ingin menggunakan nama domain atau daftar alamat, Anda harus menggunakan penandaan lalu lintas.  Sebagai contoh, kami akan menghapus batasan untuk domain yandex.ru (ya, banyak cdn'ok terhubung di sana dan hal-hal lain, dan untuk operasi normal, Anda perlu menambahkannya). </p><br><p>  Dalam versi terbaru, menjadi mungkin untuk menambahkan nama domain ke daftar alamat, mikrotik akan secara otomatis menyelesaikannya dan menambahkan entri dinamis. </p><br><p><img src="https://habrastorage.org/webt/sq/3h/zt/sq3hztxzt1qzmwfjeejb4seuzog.png"></p><br><p>  Menandai lalu lintas http / https (koneksi dan paket dalam koneksi) untuk alamat yang ditentukan: </p><br><p><img src="https://habrastorage.org/webt/xv/9e/8i/xv9e8ijrdum_l0owpnkri2mehs8.png"></p><br><p><img src="https://habrastorage.org/webt/nj/hh/xx/njhhxx9sgajhbqk2qixgosht3oi.png"></p><br><p><img src="https://habrastorage.org/webt/z_/hn/xi/z_hnxipzr3mhe3khsehfnb7l_gc.png"></p><br><p>  Aturan dalam Antrian Sederhana: </p><br><p><img src="https://habrastorage.org/webt/pk/2p/jx/pk2pjxppbsgbxgcpblnvppzuv7k.png"></p><br><pre> <code class="plaintext hljs">#   /ip firewall address-list add address=yandex.ru list=ForQueues add address=yastatic.net list=ForQueues #    /ip firewall mangle add action=mark-connection chain=forward connection-state=new dst-address-list=ForQueues dst-port=80,443 new-connection-mark=Mark-ForQueues passthrough=yes protocol=tcp src-address=192.168.100.0/24 add action=mark-packet chain=forward connection-mark=Mark-ForQueues new-packet-mark=Mark-Packet-ForQueues passthrough=no #  Simple Queue /queue simple add max-limit=1M/1M name=Limit-For-Yandex packet-marks=Mark-Packet-ForQueues target=192.168.100.0/24</code> </pre> <br><h4 id="kaskadnye-ocheredi">  Antrian Cascading </h4><br><p>  Semua yang dikatakan di atas mengacu pada membatasi dan membagi kecepatan antara peserta jaringan, saatnya menyentuh topik tentang prioritas lalu lintas.  Biasanya diperlukan untuk lalu lintas interaktif (voip, vcs, ssh, rdp, ...) di saluran terbatas dan sibuk. </p><br><p>  Untuk antrian cascading, parameter Parent bertanggung jawab, yang mengacu pada antrian "induk".  Agar berfungsi, semua lalu lintas dari antrian "anak" harus ditangkap oleh orang tua. </p><br><p>  Parameter Prioritas bertanggung jawab atas lalu lintas apa yang akan ditambahkan ke antrian sebelumnya, hanya berfungsi dalam antrian anak (atau dalam "induk" jika mereka tidak memiliki "anak"), dapat mengambil nilai dari 1 (prioritas tertinggi) ke 8 dan tidak memiliki apa-apa umum dengan tag QoS (DSCP; TOS). </p><br><p>  Pra-penandaan lalu lintas: </p><br><p><img src="https://habrastorage.org/webt/3q/aj/wj/3qajwjqsgfsk2rjyttjox_puw_q.png"></p><br><pre> <code class="plaintext hljs">/ip firewall mangle add action=mark-connection chain=forward connection-state=related,new dst-port=5060,10000-20000 in-interface=br-lan new-connection-mark=mark-conn-voip passthrough=yes protocol=udp add action=mark-packet chain=forward connection-mark=mark-conn-voip new-packet-mark=mark-pkg-voip passthrough=no add action=mark-connection chain=forward connection-state=new dst-port=80,443 in-interface=br-lan new-connection-mark=mark-conn-web passthrough=yes protocol=tcp</code> </pre> <br><p>  Antrian di SimpleQueue: </p><br><p><img src="https://habrastorage.org/webt/__/np/f0/__npf0bat-c1n1qzxtthgufnwnw.png"></p><br><p><img src="https://habrastorage.org/webt/z6/1h/kt/z61hktl_myep7moyk_l4tl4umji.png"></p><br><p><img src="https://habrastorage.org/webt/pu/uu/os/puuuosqryi6zu8_userqrvlse50.png"></p><br><p><img src="https://habrastorage.org/webt/ot/rc/dv/otrcdvd-qjwvsk7gettmlv-1qma.png"></p><br><p><img src="https://habrastorage.org/webt/0t/gg/ga/0tgggaclbuc1ar18coyvqkffplg.png"></p><br><pre> <code class="plaintext hljs">/queue simple add limit-at=24M/24M max-limit=25M/25M name=main target=10.10.10.0/24 add limit-at=5M/5M max-limit=8M/8M name=voip packet-marks=mark-pkg-voip parent=main priority=1/1 queue=pcq-upload-default/pcq-download-default target="" add limit-at=10M/10M max-limit=20M/20M name=web packet-marks=mark-pkg-web parent=main priority=2/2 queue=pcq-upload-default/pcq-download-default target="" add limit-at=10M/10M max-limit=20M/20M name=other packet-marks=mark-pkg-other parent=main priority=3/3 queue=pcq-upload-default/pcq-download-default target=""</code> </pre> <br><p>  Sekarang, jika Anda perlu membuat batasan untuk satu IP, cukup taruh aturan di depan riam antrian. </p><br><h3 id="posleslovie">  Kata penutup </h3><br><p>  Antrian Sederhana adalah alat yang agak menarik dan fungsional untuk konfigurasi rumah dan SOHO, dengan satu aturan (tanpa menggunakan label lalu lintas) Anda dapat memecahkan masalah penangkapan saluran oleh satu perangkat.  Tapi, jika Anda menggunakan FastTrack, lupakan antrian - lalu lintas akan melewati mereka. </p><br><p>  Untuk konfigurasi yang lebih kompleks, ada pohon Antrian (HTB tree). </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id420117/">https://habr.com/ru/post/id420117/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id420107/index.html">Typegram - Platform Blog Zen</a></li>
<li><a href="../id420109/index.html">Elon Musk mengatakan perusahaan itu dapat dijual kepada investor swasta. Mereka ternyata adalah dana Saudi</a></li>
<li><a href="../id420111/index.html">Dari nol hingga pahlawan “Tindakan di Google”: kode Anda</a></li>
<li><a href="../id420113/index.html">Legenda Kerangka Kekuasaan</a></li>
<li><a href="../id420115/index.html">UE4 | Peralatan untuk Multiplayer # 4 | Membuat dan menghubungkan wadah</a></li>
<li><a href="../id420119/index.html">10 kerangka kerja web Python layak untuk digunakan pada tahun 2018</a></li>
<li><a href="../id420121/index.html">Uji Kekuatan: Rayap LT450, LXI</a></li>
<li><a href="../id420123/index.html">Apa sebenarnya Node.js?</a></li>
<li><a href="../id420125/index.html">Otomasi dalam keuangan: karyawan bank dapat dibiarkan tanpa pekerjaan karena robot</a></li>
<li><a href="../id420129/index.html">Pola asyncio coroutine: menunggu di luar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>