<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👐🏼 🐫 ⛄️ GHIDRA, executables Playstation 1, tanda tangan FLIRT, dan PsyQ 🏺 🔧 🐻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya 





 Saya tidak tahu tentang Anda, tetapi saya selalu ingin membalikkan game konsol lama, juga memiliki dekompiler. Dan sekarang, saat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>GHIDRA, executables Playstation 1, tanda tangan FLIRT, dan PsyQ</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448098/"><p>  Halo semuanya </p><br><p><img src="https://habrastorage.org/webt/er/4d/30/er4d30mv0sfltitbawtcyvprbsq.jpeg"></p><br><p> Saya tidak tahu tentang Anda, tetapi saya selalu ingin membalikkan game konsol lama, juga memiliki dekompiler.  Dan sekarang, saat yang menggembirakan dalam hidup saya telah tiba - <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">GHIDRA telah</a></strong> keluar.  Saya tidak akan menulis tentang apa itu, Anda dapat dengan mudah google itu.  Dan, ulasannya sangat berbeda (terutama dari tingkat retrograde) sehingga akan sulit bagi pendatang baru untuk bahkan memutuskan untuk meluncurkan keajaiban ini ... Ini contoh untuk Anda: " <em>Saya bekerja untuk ide selama 20 tahun, dan saya melihat Hydra Anda dengan penuh rasa tidak percaya, karena NSA. Tetapi ketika- Saya akan menjalankannya dan memeriksanya dalam praktik</em> . " <a name="habracut"></a></p><br><p>  Singkatnya - menjalankan Hydra tidak menakutkan.  Dan apa yang kami dapatkan setelah peluncuran akan memblokir semua rasa takut Anda akan bookmark dan backdoors dari NSA di mana-mana. </p><br><p>  Jadi, apa yang saya bicarakan ... Ada awalan seperti itu: <em>Sony Playstation 1</em> ( <em>PS1</em> , <em>PSX</em> , <em>Curling iron</em> ).  Banyak game keren diciptakan untuk itu, sekelompok waralaba muncul yang masih populer.  Dan suatu hari saya ingin mengetahui cara kerjanya: format data apa yang ada di sana, apakah kompresi sumber daya digunakan, mencoba menerjemahkan sesuatu ke dalam bahasa Rusia (saya akan mengatakan segera bahwa saya belum menerjemahkan permainan apa pun). </p><br><p> Saya mulai dengan menulis utilitas keren untuk bekerja dengan format <code>TIM</code> dengan seorang teman di <code>Delphi</code> (ini seperti <code>BMP</code> dari dunia Playstation): <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tim2View</a></strong> .  Pada suatu waktu, menikmati kesuksesan (dan mungkin sekarang menikmati).  Lalu saya ingin masuk lebih dalam ke kompresi. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/95a/82d/ad5/95a82dad5e8cf1770315215ac1cb138e.png" alt="gambar"></p><br><p>  Dan kemudian masalah dimulai.  Saya tidak terbiasa dengan <code>MIPS</code> saat itu.  Butuh belajar.  Saya juga tidak terbiasa dengan <code>IDA Pro</code> (saya datang untuk membalik game di <code>Sega Mega Drive</code> lambat dari <code>Playstation</code> ).  Tetapi, berkat Internet, saya mengetahui bahwa <code>IDA Pro</code> mendukung pengunduhan dan analisis <strong>file yang dapat dieksekusi</strong> <code>PS1</code> : <strong>PS-X EXE</strong> .  Saya mencoba mengunggah file game (sepertinya <strong>Lemmings</strong> ) dengan nama dan ekstensi yang aneh, seperti <code>SLUS_123.45</code> di Ida, saya mendapat banyak baris kode assembler (untungnya, saya sudah memiliki ide tentang apa itu, berkat driver Windows exe di bawah x86), dan mulai mengerti. </p><br><p><img src="https://habrastorage.org/webt/d8/d5/81/d8d581oddbuzq95aw7nyebedpzw.png"></p><br><p>  Tempat sulit pertama yang harus dipahami adalah jalur perakitan.  Misalnya, Anda melihat panggilan ke beberapa fungsi, dan segera setelah itu memuat ke register parameter yang harus digunakan dalam fungsi ini.  Singkatnya, sebelum ada lompatan dan fungsi panggilan, instruksi mengikuti lompatan / panggilan pertama kali dieksekusi, dan hanya kemudian panggilan atau melompat itu sendiri. </p><br><p>  Setelah semua kesulitan yang saya lalui, saya berhasil menulis beberapa paket / pembongkar sumber daya game.  Tapi saya belum pernah benar-benar mempelajari kode.  Mengapa  Ya, semuanya biasa-biasa saja: ada banyak kode, akses ke BIOS dan fungsi yang hampir mustahil untuk dipahami (mereka adalah perpustakaan, dan saya tidak punya SDK untuk pengeritingan), instruksi yang bekerja dengan tiga register pada saat yang sama, kurangnya dekompiler. </p><br><p>  Jadi, setelah bertahun-tahun, <code>GHIDRA</code> .  Di antara platform yang didukung oleh decompiler adalah <code>MIPS</code> .  Oh sukacita!  Mari kita coba mendekompilasi sesuatu segera!  Tapi ... saya sedang menunggu mengecewakan.  <code>PS-X EXE</code> tidak didukung oleh Hydra.  Itu bukan masalah, kami akan menulis sendiri! </p><br><h2 id="sobstvenno-kod">  Sebenarnya kode </h2><br><p>  Cukup penyimpangan liris, mari kita menulis kode.  Bagaimana cara membuat pengunduh saya sendiri untuk <code>Ghidra</code> , saya sudah punya ide tentang apa yang saya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tulis sebelumnya</a> .  Oleh karena itu, tetap hanya menemukan <em>Peta Memori dari</em> curling iron pertama, alamat register dan, Anda dapat mengumpulkan dan memuat binari.  Tidak lebih cepat dikatakan daripada dilakukan. </p><br><p>  Kode sudah siap, register dan wilayah ditambahkan dan dikenali, tetapi masih ada tempat kosong besar di tempat-tempat di mana fungsi perpustakaan dan fungsi BIOS dipanggil.  Dan, sayangnya, Hydra tidak memiliki dukungan <code>FLIRT</code> .  Jika tidak, mari kita tambahkan. </p><br><p>  Format tanda tangan <code>FLIRT</code> diketahui dan dijelaskan dalam file <code>pat.txt</code> , yang dapat ditemukan di Ida SDK.  Ida juga memiliki utilitas untuk membuat tanda tangan ini secara khusus dari file perpustakaan <code>Playstation</code> , dan disebut: <code>ppsx</code> .  Saya mengunduh SDK untuk <code>PsyQ Playstation Development Kit</code> bernama <code>PsyQ Playstation Development Kit</code> , menemukan file <code>lib</code> sana dan mencoba membuat setidaknya beberapa tanda tangan dari mereka - berhasil.  Ternyata teks kecil di mana setiap baris memiliki format tertentu.  Tetap menulis kode yang akan menguraikan baris-baris ini, dan menerapkannya pada kode. </p><br><p><img src="https://habrastorage.org/webt/kw/0a/kc/kw0akcnlzbiwjctarj1h4axq8ri.png"></p><br><h3 id="patparser">  Patparser </h3><br><p>  Karena setiap baris memiliki format tertentu, akan logis untuk menulis ekspresi reguler.  Ternyata seperti ini: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Pattern linePat = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"^((?:[0-9A-F\\.]{2})+) ([0-9A-F]{2}) ([0-9A-F]{4}) ([0-9A-F]{4}) ((?:[:\\^][0-9A-F]{4}@? [\\.\\w]+ )+)((?:[0-9A-F\\.]{2})+)?$"</span></span>);</code> </pre> <br><p>  Nah, untuk menyorot kemudian dalam daftar modul secara terpisah offset, jenis, dan nama fungsi, kami menulis regexp terpisah: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Pattern modulePat = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"([:\\^][0-9A-F]{4}@?) ([\\.\\w]+) "</span></span>);</code> </pre> <br><p>  Sekarang mari kita lihat komponen masing-masing tanda tangan secara terpisah: </p><br><ol><li>  Pertama adalah urutan hex byte ( <em>0-9A-F</em> ), di mana beberapa dari mereka bisa berupa apa saja (karakter titik ".").  Oleh karena itu, kami membuat kelas yang akan menyimpan urutan seperti itu.  Saya menyebutnya <code>MaskedBytes</code> : </li></ol><br><div class="spoiler">  <b class="spoiler_title">MaskedBytes.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> pat; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MaskedBytes</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] bytes, masks; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getBytes() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> bytes; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getMasks() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> masks; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getLength</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> bytes.length; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MaskedBytes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] bytes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] masks)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bytes = bytes; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.masks = masks; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> MaskedBytes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">extend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MaskedBytes src, MaskedBytes add)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> extend(src, add.getBytes(), add.getMasks()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> MaskedBytes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">extend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MaskedBytes src, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] addBytes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] addMasks)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length = src.getBytes().length; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] tmpBytes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[length + addBytes.length]; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] tmpMasks = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[length + addMasks.length]; System.arraycopy(src.getBytes(), <span class="hljs-number"><span class="hljs-number">0</span></span>, tmpBytes, <span class="hljs-number"><span class="hljs-number">0</span></span>, length); System.arraycopy(addBytes, <span class="hljs-number"><span class="hljs-number">0</span></span>, tmpBytes, length, addBytes.length); System.arraycopy(src.getMasks(), <span class="hljs-number"><span class="hljs-number">0</span></span>, tmpMasks, <span class="hljs-number"><span class="hljs-number">0</span></span>, length); System.arraycopy(addMasks, <span class="hljs-number"><span class="hljs-number">0</span></span>, tmpMasks, length, addMasks.length); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MaskedBytes(tmpBytes, tmpMasks); } }</code> </pre> </div></div><br><ol><li>  Panjang blok tempat <code>CRC16</code> dihitung. </li><li>  <code>CRC16</code> , yang menggunakan polinomialnya sendiri ( <code>0x8408</code> ): </li></ol><br><div class="spoiler">  <b class="spoiler_title">Hitung Kode CRC16</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkCrc16</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] bytes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> resCrc)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( bytes.length == <span class="hljs-number"><span class="hljs-number">0</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> crc = <span class="hljs-number"><span class="hljs-number">0xFFFF</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; bytes.length; ++i) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a = bytes[i]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; ++x) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((crc ^ a) &amp; <span class="hljs-number"><span class="hljs-number">1</span></span>) != <span class="hljs-number"><span class="hljs-number">0</span></span>) { crc = (crc &gt;&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) ^ <span class="hljs-number"><span class="hljs-number">0x8408</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { crc &gt;&gt;= <span class="hljs-number"><span class="hljs-number">1</span></span>; } a &gt;&gt;= <span class="hljs-number"><span class="hljs-number">1</span></span>; } } crc = ~crc; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = crc; crc = (crc &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) | ((x &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>); crc &amp;= <span class="hljs-number"><span class="hljs-number">0xFFFF</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">short</span></span>)crc == resCrc; }</code> </pre> </div></div><br><ol><li>  Total panjang "modul" dalam byte. </li><li>  Daftar nama global (apa yang kita butuhkan). </li><li>  Daftar tautan ke nama lain (juga diperlukan). </li><li>  Byte ekor. </li></ol><br><p>  Setiap nama dalam modul memiliki tipe tertentu dan offset relatif terhadap awal.  Jenis dapat ditunjukkan oleh salah satu karakter ::, ^, @, tergantung pada jenis: </p><br><ul><li>  " <strong>: NAME</strong> ": nama global.  Demi nama-nama seperti itulah saya memulai semuanya; </li><li>  " <strong>: NAME @</strong> ": nama / label lokal.  Mungkin tidak diindikasikan, tetapi biarkan; </li><li>  " <strong>^ NAME</strong> ": tautan ke nama. </li></ul><br><p>  Di satu sisi, semuanya sederhana, tetapi tautan dapat dengan mudah bukan merupakan referensi ke suatu fungsi (dan, karenanya, lompatan akan relatif), tetapi ke variabel global.  Apa, katamu, masalahnya?  Dan di PSX Anda tidak dapat mendorong seluruh <code>DWORD</code> ke dalam register dengan satu instruksi.  Untuk melakukan ini, unduh dalam bentuk setengah.  Faktanya adalah, dalam <code>MIPS</code> ukuran instruksi dibatasi hingga empat byte.  Dan, tampaknya, Anda hanya perlu mendapatkan setengah dari satu instruksi, dan kemudian membongkar yang berikutnya - dan mendapatkan setengah kedua.  Tapi tidak sesederhana itu.  Babak pertama dapat memuat kembali instruksi 5, dan tautan dalam modul hanya akan diberikan setelah memuat bagian kedua.  Saya harus menulis parser yang canggih (mungkin bisa dimodifikasi). </p><br><p>  Sebagai hasilnya, kami membuat <code>enum</code> untuk tiga jenis nama: </p><br><div class="spoiler">  <b class="spoiler_title">ModuleType.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> pat; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> ModuleType { GLOBAL_NAME, LOCAL_NAME, REF_NAME; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isGlobal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == GLOBAL_NAME; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isLocal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == LOCAL_NAME; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isReference</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == REF_NAME; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isGlobal()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Global"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isLocal()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Local"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Reference"</span></span>; } } }</code> </pre> </div></div><br><p>  Mari kita menulis kode yang mengubah urutan dan titik heksadesimal teks untuk mengetik <code>MaskedBytes</code> : </p><br><div class="spoiler">  <b class="spoiler_title">hexStringToMaskedBytesArray ()</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> MaskedBytes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hexStringToMaskedBytesArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span><span class="hljs-function"> </span></span>{ MaskedBytes res = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (s != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> len = s.length(); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] bytes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[len / <span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] masks = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[len / <span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; len; i += <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> c1 = s.charAt(i); <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> c2 = s.charAt(i + <span class="hljs-number"><span class="hljs-number">1</span></span>); masks[i / <span class="hljs-number"><span class="hljs-number">2</span></span>] = (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>) ( (((c1 == <span class="hljs-string"><span class="hljs-string">'.'</span></span>) ? <span class="hljs-number"><span class="hljs-number">0x0</span></span> : <span class="hljs-number"><span class="hljs-number">0xF</span></span>) &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) | (((c2 == <span class="hljs-string"><span class="hljs-string">'.'</span></span>) ? <span class="hljs-number"><span class="hljs-number">0x0</span></span> : <span class="hljs-number"><span class="hljs-number">0xF</span></span>) &lt;&lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) ); bytes[i / <span class="hljs-number"><span class="hljs-number">2</span></span>] = (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>) ( (((c1 == <span class="hljs-string"><span class="hljs-string">'.'</span></span>) ? <span class="hljs-number"><span class="hljs-number">0x0</span></span> : Character.digit(c1, <span class="hljs-number"><span class="hljs-number">16</span></span>)) &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) | (((c2 == <span class="hljs-string"><span class="hljs-string">'.'</span></span>) ? <span class="hljs-number"><span class="hljs-number">0x0</span></span> : Character.digit(c2, <span class="hljs-number"><span class="hljs-number">16</span></span>)) &lt;&lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) ); } res = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MaskedBytes(bytes, masks); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; }</code> </pre> </div></div><br><p>  Anda sudah dapat memikirkan kelas yang akan menyimpan informasi tentang masing-masing fungsi individu: nama fungsi, offset dalam modul, dan ketik: </p><br><div class="spoiler">  <b class="spoiler_title">ModuleData.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> pat; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ModuleData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> offset; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String name; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> ModuleType type; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ModuleData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset, String name, ModuleType type)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.offset = offset; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.type = type; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOffset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> offset; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> name; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> ModuleType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> type; } }</code> </pre> </div></div><br><p>  Dan, terakhir: kelas yang akan menyimpan segala sesuatu yang ditunjukkan pada setiap baris file <code>pat</code> , yaitu: byte, crc, daftar nama dengan offset: </p><br><div class="spoiler">  <b class="spoiler_title">SignatureData.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> pat; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Arrays; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SignatureData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> MaskedBytes templateBytes, tailBytes; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> MaskedBytes fullBytes; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> crc16Length; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> crc16; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> moduleLength; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> List&lt;ModuleData&gt; modules; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SignatureData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MaskedBytes templateBytes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> crc16Length, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> crc16, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> moduleLength, List&lt;ModuleData&gt; modules, MaskedBytes tailBytes)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.templateBytes = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fullBytes = templateBytes; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.crc16Length = crc16Length; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.crc16 = crc16; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.moduleLength = moduleLength; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.modules = modules; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tailBytes = tailBytes; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tailBytes != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> addLength = moduleLength - templateBytes.getLength() - tailBytes.getLength(); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] addBytes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[addLength]; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] addMasks = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[addLength]; Arrays.fill(addBytes, (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">0x00</span></span>); Arrays.fill(addMasks, (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">0x00</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fullBytes = MaskedBytes.extend(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.templateBytes, addBytes, addMasks); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fullBytes = MaskedBytes.extend(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fullBytes, tailBytes); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> MaskedBytes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTemplateBytes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> templateBytes; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> MaskedBytes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTailBytes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tailBytes; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> MaskedBytes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFullBytes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fullBytes; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCrc16Length</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> crc16Length; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCrc16</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> crc16; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getModuleLength</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> moduleLength; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;ModuleData&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getModules</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> modules; } }</code> </pre> </div></div><br><p>  Sekarang yang utama: kita menulis kode untuk membuat semua kelas ini: </p><br><div class="spoiler">  <b class="spoiler_title">Mem-parsing satu baris file tepuk yang diambil</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> List&lt;ModuleData&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parseModuleData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span><span class="hljs-function"> </span></span>{ List&lt;ModuleData&gt; res = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;ModuleData&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (s != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { Matcher m = modulePat.matcher(s); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (m.find()) { String __offset = m.group(<span class="hljs-number"><span class="hljs-number">1</span></span>); ModuleType type = __offset.startsWith(<span class="hljs-string"><span class="hljs-string">":"</span></span>) ? ModuleType.GLOBAL_NAME : ModuleType.REF_NAME; type = (type == ModuleType.GLOBAL_NAME &amp;&amp; __offset.endsWith(<span class="hljs-string"><span class="hljs-string">"@"</span></span>)) ? ModuleType.LOCAL_NAME : type; String _offset = __offset.replaceAll(<span class="hljs-string"><span class="hljs-string">"[:^@]"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> offset = Integer.parseInt(_offset, <span class="hljs-number"><span class="hljs-number">16</span></span>); String name = m.group(<span class="hljs-number"><span class="hljs-number">2</span></span>); res.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ModuleData(offset, name, type)); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; }</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Parsing semua baris file tepuk</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;String&gt; lines)</span></span></span><span class="hljs-function"> </span></span>{ modulesCount = <span class="hljs-number"><span class="hljs-number">0L</span></span>; signatures = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;SignatureData&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> linesCount = lines.size(); monitor.initialize(linesCount); monitor.setMessage(<span class="hljs-string"><span class="hljs-string">"Reading signatures..."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; linesCount; ++i) { String line = lines.get(i); Matcher m = linePat.matcher(line); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m.matches()) { MaskedBytes pp = hexStringToMaskedBytesArray(m.group(<span class="hljs-number"><span class="hljs-number">1</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ll = Integer.parseInt(m.group(<span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> ssss = (<span class="hljs-keyword"><span class="hljs-keyword">short</span></span>)Integer.parseInt(m.group(<span class="hljs-number"><span class="hljs-number">3</span></span>), <span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> llll = Integer.parseInt(m.group(<span class="hljs-number"><span class="hljs-number">4</span></span>), <span class="hljs-number"><span class="hljs-number">16</span></span>); List&lt;ModuleData&gt; modules = parseModuleData(m.group(<span class="hljs-number"><span class="hljs-number">5</span></span>)); MaskedBytes tail = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m.group(<span class="hljs-number"><span class="hljs-number">6</span></span>) != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { tail = hexStringToMaskedBytesArray(m.group(<span class="hljs-number"><span class="hljs-number">6</span></span>)); } signatures.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SignatureData(pp, ll, ssss, llll, modules, tail)); modulesCount += modules.size(); } monitor.incrementProgress(<span class="hljs-number"><span class="hljs-number">1</span></span>); } }</code> </pre> </div></div><br><p>  Kode untuk membuat fungsi tempat salah satu tanda tangan dikenali: </p><br><div class="spoiler">  <b class="spoiler_title">Penciptaan Fungsi</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">disasmInstruction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, Address address)</span></span></span><span class="hljs-function"> </span></span>{ DisassembleCommand cmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DisassembleCommand(address, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); cmd.applyTo(program, TaskMonitor.DUMMY); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setFunction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, FlatProgramAPI fpa, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> isFunction, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> isEntryPoint, MessageLog log)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fpa.getInstructionAt(address) == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) disasmInstruction(program, address); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isFunction) { fpa.createFunction(address, name); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isEntryPoint) { fpa.addEntryPoint(address); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isFunction &amp;&amp; program.getSymbolTable().hasSymbol(address)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { log.appendException(e); } }</code> </pre> </div></div><br><p>  Tempat yang paling sulit, seperti yang disebutkan sebelumnya, adalah menghitung tautan ke nama / variabel lain (mungkin kode perlu ditingkatkan): </p><br><div class="spoiler">  <b class="spoiler_title">Jumlah Tautan</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setInstrRefName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, FlatProgramAPI fpa, PseudoDisassembler ps, Address address, String name, MessageLog log)</span></span></span><span class="hljs-function"> </span></span>{ ReferenceManager refsMgr = program.getReferenceManager(); Reference[] refs = refsMgr.getReferencesFrom(address); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (refs.length == <span class="hljs-number"><span class="hljs-number">0</span></span>) { disasmInstruction(program, address); refs = refsMgr.getReferencesFrom(address); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (refs.length == <span class="hljs-number"><span class="hljs-number">0</span></span>) { refs = refsMgr.getReferencesFrom(address.add(<span class="hljs-number"><span class="hljs-number">4</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (refs.length == <span class="hljs-number"><span class="hljs-number">0</span></span>) { refs = refsMgr.getFlowReferencesFrom(address.add(<span class="hljs-number"><span class="hljs-number">4</span></span>)); Instruction instr = program.getListing().getInstructionAt(address.add(<span class="hljs-number"><span class="hljs-number">4</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (instr == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { disasmInstruction(program, address.add(<span class="hljs-number"><span class="hljs-number">4</span></span>)); instr = program.getListing().getInstructionAt(address.add(<span class="hljs-number"><span class="hljs-number">4</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (instr == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } } FlowType flowType = instr.getFlowType(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (refs.length == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; !(flowType.isJump() || flowType.isCall() || flowType.isTerminal())) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } refs = refsMgr.getReferencesFrom(address.add(<span class="hljs-number"><span class="hljs-number">8</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (refs.length == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } } } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(refs[<span class="hljs-number"><span class="hljs-number">0</span></span>].getToAddress(), name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { log.appendException(e); } }</code> </pre> </div></div><br><p>  Dan, sentuhan terakhir - terapkan tanda tangan: </p><br><div class="spoiler">  <b class="spoiler_title">applySignatures ()</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">applySignatures</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ByteProvider provider, Program program, Address imageBase, Address startAddr, Address endAddr, MessageLog log)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); PseudoDisassembler ps = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PseudoDisassembler(program); FlatProgramAPI fpa = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FlatProgramAPI(program); monitor.initialize(getAllModulesCount()); monitor.setMessage(<span class="hljs-string"><span class="hljs-string">"Applying signatures..."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (SignatureData sig : signatures) { MaskedBytes fullBytes = sig.getFullBytes(); MaskedBytes tmpl = sig.getTemplateBytes(); Address addr = program.getMemory().findBytes(startAddr, endAddr, fullBytes.getBytes(), fullBytes.getMasks(), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, TaskMonitor.DUMMY); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (addr == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { monitor.incrementProgress(sig.getModules().size()); <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } addr = addr.subtract(imageBase.getOffset()); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] nextBytes = reader.readByteArray(addr.getOffset() + tmpl.getLength(), sig.getCrc16Length()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!PatParser.checkCrc16(nextBytes, sig.getCrc16())) { monitor.incrementProgress(sig.getModules().size()); <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } addr = addr.add(imageBase.getOffset()); List&lt;ModuleData&gt; modules = sig.getModules(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (ModuleData data : modules) { Address _addr = addr.add(data.getOffset()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.getType().isGlobal()) { setFunction(program, fpa, _addr, data.getName(), data.getType().isGlobal(), <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, log); } monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s function %s at 0x%08X"</span></span>, data.getType(), data.getName(), _addr.getOffset())); monitor.incrementProgress(<span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (ModuleData data : modules) { Address _addr = addr.add(data.getOffset()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.getType().isReference()) { setInstrRefName(program, fpa, ps, _addr, data.getName(), log); } monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s function %s at 0x%08X"</span></span>, data.getType(), data.getName(), _addr.getOffset())); monitor.incrementProgress(<span class="hljs-number"><span class="hljs-number">1</span></span>); } } }</code> </pre> </div></div><br><p>  Di sini Anda dapat berbicara tentang satu fungsi menarik: <code>findBytes()</code> .  Dengannya, Anda dapat mencari urutan byte tertentu, dengan masker bit yang ditentukan untuk setiap byte.  Metode ini disebut seperti ini: </p><br><pre> <code class="java hljs">Address addr = program.getMemory().findBytes(startAddr, endAddr, bytes, masks, forward, TaskMonitor.DUMMY);</code> </pre> <br><p>  Akibatnya, alamat dari mana byte dimulai dikembalikan, atau <code>null</code> . </p><br><h2 id="pishem-analizator">  Menulis sebuah analisa </h2><br><p>  Mari kita lakukan dengan indah, dan kita tidak akan menggunakan tanda tangan jika kita tidak mau, tetapi biarkan pengguna memilih langkah ini.  Untuk melakukan ini, Anda harus menulis penganalisa kode Anda sendiri (Anda bisa melihat yang ada di daftar ini - itu saja, ya): </p><br><p><img src="https://habrastorage.org/webt/1o/wv/je/1owvjea6nuytmkwksxrhy9anyak.png"></p><br><p>  Jadi, untuk masuk ke dalam daftar ini, Anda harus mewarisi dari kelas <code>AbstractAnalyzer</code> dan mengganti beberapa metode: </p><br><ol><li>  Konstruktor.  Itu harus memanggil konstruktor dari kelas dasar dengan nama, deskripsi penganalisa, dan jenisnya (lebih lanjut tentang itu nanti).  Ini terlihat seperti ini bagi saya: </li></ol><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PsxAnalyzer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(<span class="hljs-string"><span class="hljs-string">"PSYQ Signatures"</span></span>, <span class="hljs-string"><span class="hljs-string">"PSX signatures applier"</span></span>, AnalyzerType.INSTRUCTION_ANALYZER); }</code> </pre> <br><ol><li>  <code>getDefaultEnablement()</code> .  Menentukan apakah penganalisis kami selalu tersedia, atau hanya jika kondisi tertentu terpenuhi (misalnya, jika loader kami digunakan). </li><li>  <code>canAnalyze()</code> .  Apakah mungkin menggunakan penganalisis ini sama sekali pada file biner yang dapat diunduh? <br>  Paragraf 2 dan 3 pada prinsipnya dapat diverifikasi oleh satu fungsi tunggal: </li></ol><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isPsxLoader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> program.getExecutableFormat().equalsIgnoreCase(PsxLoader.PSX_LOADER); }</code> </pre> <br><p>  Di mana <code>PsxLoader.PSX_LOADER</code> menyimpan nama bootloader, dan didefinisikan sebelumnya di dalamnya. </p><br><p>  Total, kami memiliki: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDefaultEnablement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> isPsxLoader(program); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">canAnalyze</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> isPsxLoader(program); }</code> </pre> <br><ol><li>  <code>registerOptions()</code> .  Sama sekali tidak perlu mendefinisikan ulang metode ini, tetapi jika kita perlu menanyakan sesuatu kepada pengguna, misalnya path ke file pat sebelum analisis, maka yang terbaik adalah melakukan ini dalam metode ini.  Kami mendapatkan: </li></ol><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String OPTION_NAME = <span class="hljs-string"><span class="hljs-string">"PSYQ PAT-File Path"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> File file = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">registerOptions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Options options, Program program)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { file = Application.getModuleDataFile(<span class="hljs-string"><span class="hljs-string">"psyq4_7.pat"</span></span>).getFile(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (FileNotFoundException e) { } options.registerOption(OPTION_NAME, OptionType.FILE_TYPE, file, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"PAT-File (FLAIR) created from PSYQ library files"</span></span>); }</code> </pre> <br><p>  Di sini perlu diklarifikasi.  Metode statis <code>getModuleDataFile()</code> dari kelas <code>Application</code> mengembalikan path lengkap ke file di direktori <code>data</code> , yang ada di pohon modul kami, dan dapat menyimpan file yang diperlukan yang ingin kita lihat nanti. </p><br><p>  Nah, metode <code>registerOption()</code> opsi dengan nama yang ditentukan dalam <code>OPTION_NAME</code> , jenis <code>File</code> (yaitu, pengguna akan dapat memilih file melalui kotak dialog biasa), nilai dan deskripsi default. </p><br><p>  Selanjutnya  Karena  kami tidak akan memiliki kesempatan normal untuk merujuk ke opsi yang terdaftar nanti, kami akan perlu mendefinisikan kembali metode <code>optionsChanged()</code> : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">optionsChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Options options, Program program)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.optionsChanged(options, program); file = options.getFile(OPTION_NAME, file); }</code> </pre> <br><p>  Di sini kita cukup memperbarui variabel global sesuai dengan nilai baru. </p><br><p>  Metode yang <code>added()</code> .  Sekarang yang utama: metode yang akan dipanggil ketika penganalisis dimulai.  Di dalamnya kita akan menerima daftar alamat yang tersedia untuk analisis, tetapi kita hanya perlu yang berisi kode.  Karena itu, Anda perlu memfilter.  Kode terakhir: </p><br><div class="spoiler">  <b class="spoiler_title">Menambahkan metode ()</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">added</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, AddressSetView set, TaskMonitor monitor, MessageLog log)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> CancelledException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (file == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } Memory memory = program.getMemory(); AddressRangeIterator it = memory.getLoadedAndInitializedAddressSet().getAddressRanges(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!monitor.isCancelled() &amp;&amp; it.hasNext()) { AddressRange range = it.next(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { MemoryBlock block = program.getMemory().getBlock(range.getMinAddress()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (block.isInitialized() &amp;&amp; block.isExecute() &amp;&amp; block.isLoaded()) { PatParser pat = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PatParser(file, monitor); RandomAccessByteProvider provider = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RandomAccessByteProvider(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(program.getExecutablePath())); pat.applySignatures(provider, program, block.getStart(), block.getStart(), block.getEnd(), log); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { log.appendException(e); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; }</code> </pre> </div></div><br><p>  Di sini kita melihat daftar alamat yang dapat dieksekusi, dan mencoba menerapkan tanda tangan di sana. </p><br><p><img src="https://habrastorage.org/webt/-b/ro/8_/-bro8_sgvplezfb3qhiu5dfjyzm.png"></p><br><h2 id="vyvody-i-finalochka">  Kesimpulan dan penutupnya </h2><br><p>  Suka semuanya.  Sebenarnya, tidak ada yang super rumit di sini.  Ada beberapa contoh, komunitasnya ramai, Anda dapat dengan aman bertanya tentang apa yang tidak jelas saat menulis kode.  Intinya: bootloader dan penganalisis yang berfungsi untuk file yang dapat dieksekusi <code>Playstation 1</code> . </p><br><p><img src="https://habrastorage.org/webt/c_/uw/ej/c_uwejjyu5edynkxyzlr6wboezw.png"></p><br><p>  Semua kode sumber tersedia di sini: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ghidra_psx_ldr</a> <br>  Rilis di sini: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Rilis</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id448098/">https://habr.com/ru/post/id448098/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id448084/index.html">Foto lubang hitam - apakah bisa digunakan?</a></li>
<li><a href="../id448088/index.html">Produksi mesin plasma di Rusia</a></li>
<li><a href="../id448090/index.html">Frontend Weekly Digest (8 - 14 Apr 2019)</a></li>
<li><a href="../id448094/index.html">Docker: cara menggunakan aplikasi tumpukan penuh dan tidak berubah menjadi abu-abu</a></li>
<li><a href="../id448096/index.html">Julia dalam lateks</a></li>
<li><a href="../id448100/index.html">Intisari bahan-bahan segar dari dunia front-end untuk minggu terakhir No. 360 (7-14 April, 2019)</a></li>
<li><a href="../id448102/index.html">Tim impian dari nol: mempekerjakan profesional TI</a></li>
<li><a href="../id448106/index.html">Pelatihan pengembang 1C-Bitrix: bagikan pendekatan kami pada "pertumbuhan" personel</a></li>
<li><a href="../id448108/index.html">Cara Mengatur Server VPN Anda Sendiri dalam 15 Menit</a></li>
<li><a href="../id448110/index.html">Solusi perangkat keras keamanan informasi USB melalui IP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>