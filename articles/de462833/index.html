<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏼‍🤝‍🧑🏼 🚵🏼 🤰🏽 Das Buch "Predictive Modeling in der Praxis" 👩🏾‍🎨 👰🏾 🐌</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo habrozhiteli! „Vorhersagemodellierung in der Praxis“ deckt alle Aspekte der Prognose ab, beginnend mit den Schlüsselphasen der Datenvorverarbeit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Das Buch "Predictive Modeling in der Praxis"</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/462833/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/6z/8t/vz/6z8tvzrupg6sctybnofbe97w9ks.jpeg" align="left" alt="Bild"></a>  Hallo habrozhiteli!  „Vorhersagemodellierung in der Praxis“ deckt alle Aspekte der Prognose ab, beginnend mit den Schlüsselphasen der Datenvorverarbeitung, Datenaufteilung und den Grundprinzipien der Modelloptimierung.  Alle Phasen der Modellierung werden anhand praktischer Beispiele aus dem wirklichen Leben betrachtet. In jedem Kapitel wird ein detaillierter Code in R-Sprache angegeben. <br><br>  Dieses Buch kann als Einführung in Vorhersagemodelle und als Leitfaden für deren Anwendung verwendet werden.  Leser ohne mathematische Ausbildung werden die intuitiven Erklärungen bestimmter Methoden zu schätzen wissen, und die Aufmerksamkeit, die der Lösung tatsächlicher Probleme mit realen Daten gewidmet wird, wird Fachleuten helfen, die ihre Fähigkeiten verbessern möchten. <br><br>  Die Autoren versuchten, komplexe Formeln zu vermeiden. Das Verständnis der grundlegenden statistischen Konzepte wie Korrelation und lineare Regressionsanalyse reicht aus, um das Grundmaterial zu beherrschen. Für das Studium fortgeschrittener Themen ist jedoch eine mathematische Ausbildung erforderlich. <br><a name="habracut"></a><br><h3>  Auszug.  7.5.  Berechnungen </h3><br>  In diesem Abschnitt werden Funktionen aus den Paketen R caret, earth, kernlab und nnet verwendet. <br><br>  R hat viele Pakete und Funktionen zum Erstellen neuronaler Netze.  Dazu gehören nnet-, neuronale und RSNNS-Pakete.  Das Hauptaugenmerk liegt auf dem nnet-Paket, das grundlegende Modelle neuronaler Netze mit einer Ebene versteckter Variablen, der Gewichtsreduzierung, unterstützt und sich durch eine relativ einfache Syntax auszeichnet.  RSNNS unterstützt eine Vielzahl von neuronalen Netzen.  Beachten Sie, dass Bergmeir und Benitez (2012) eine kurze Beschreibung der verschiedenen neuronalen Netzwerkpakete in R haben. Dort wird auch das RSNNS-Tutorial bereitgestellt. <br><br><h3>  Neuronale Netze </h3><br>  Um das Regressionsmodell zu approximieren, kann die nnet-Funktion sowohl die Formel des Modells als auch die Matrixschnittstelle empfangen.  Für die Regression wird die lineare Beziehung zwischen versteckten Variablen und der Prognose mit dem Parameter linout = TRUE verwendet.  Der einfachste Aufruf der neuronalen Netzwerkfunktion sieht folgendermaßen aus: <br><br><pre><code class="javascript hljs">&gt; nnetFit &lt;- nnet(predictors, outcome, + size = <span class="hljs-number"><span class="hljs-number">5</span></span>, + decay = <span class="hljs-number"><span class="hljs-number">0.01</span></span>, + linout = TRUE, + ##   + trace = FALSE, + ##      + ##  .. + maxit = <span class="hljs-number"><span class="hljs-number">500</span></span>, + ##   ,   + MaxNWts = <span class="hljs-number"><span class="hljs-number">5</span></span> * (ncol(predictors) + <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">5</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  Dieser Aufruf erstellt ein Modell mit fünf versteckten Variablen.  Es wird angenommen, dass die Daten in den Prädiktoren auf einer einzigen Skala standardisiert wurden. <br><br>  Um die Modelle zu mitteln, wird die avNNet-Funktion aus dem Caret-Paket verwendet, die dieselbe Syntax hat: <br><br><pre> <code class="javascript hljs">&gt; nnetAvg &lt;- avNNet(predictors, outcome, + size = <span class="hljs-number"><span class="hljs-number">5</span></span>, + decay = <span class="hljs-number"><span class="hljs-number">0.01</span></span>, + ##    + repeats = <span class="hljs-number"><span class="hljs-number">5</span></span>, + linout = TRUE, + ##   + trace = FALSE, + ##    + ##    .. + maxit = <span class="hljs-number"><span class="hljs-number">500</span></span>, + ##   ,   + MaxNWts = <span class="hljs-number"><span class="hljs-number">5</span></span> * (ncol(predictors) + <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">5</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  Neue Datenpunkte werden vom Befehl verarbeitet <br><br><pre> <code class="javascript hljs">&gt; predict(nnetFit, newData) &gt; ##  &gt; predict(nnetAvg, newData)</code> </pre> <br>  Um die zuvor vorgestellte Methode zur Auswahl der Anzahl versteckter Variablen und des Ausmaßes der Gewichtsreduzierung durch wiederholtes Abtasten zu reproduzieren, wenden wir die Zugfunktion mit dem Parameter method = "nnet" oder method = "avNNet" an und entfernen zuerst die Prädiktoren (damit die maximale absolute Paarkorrelation zwischen den Prädiktoren nicht überschritten wird 0,75): <br><br><pre> <code class="javascript hljs">&gt; ## findCorrelation      &gt; ##  ,       &gt; ##       &gt; tooHigh &lt;- findCorrelation(cor(solTrainXtrans), cutoff = <span class="hljs-number"><span class="hljs-number">.75</span></span>) &gt; trainXnnet &lt;- solTrainXtrans[, -tooHigh] &gt; testXnnet &lt;- solTestXtrans[, -tooHigh] &gt; ##   -  : &gt; nnetGrid &lt;- expand.grid(.decay = c(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.01</span></span>, <span class="hljs-number"><span class="hljs-number">.1</span></span>), + .size = c(<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span>), + ##   —   + ## (.  )   + ##  . + .bag = FALSE) &gt; set.seed(<span class="hljs-number"><span class="hljs-number">100</span></span>) &gt; nnetTune &lt;- train(solTrainXtrans, solTrainY, + method = <span class="hljs-string"><span class="hljs-string">"avNNet"</span></span>, + tuneGrid = nnetGrid, + trControl = ctrl, + ##    + ##     + preProc = c(<span class="hljs-string"><span class="hljs-string">"center"</span></span>, <span class="hljs-string"><span class="hljs-string">"scale"</span></span>), + linout = TRUE, + trace = FALSE, + MaxNWts = <span class="hljs-number"><span class="hljs-number">10</span></span> * (ncol(trainXnnet) + <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">10</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>, + maxit = <span class="hljs-number"><span class="hljs-number">500</span></span>)</code> </pre> <br><h3>  Mehrdimensionale adaptive Regressionssplines </h3><br>  MARS-Modelle sind in mehreren Paketen enthalten, die umfangreichste Implementierung befindet sich jedoch im Earth-Paket.  Ein MARS-Modell, das die nominelle Phase des direkten Durchlaufs und Abschneidens verwendet, kann wie folgt aufgerufen werden: <br><br><pre> <code class="javascript hljs">&gt; marsFit &lt;- earth(solTrainXtrans, solTrainY) &gt; marsFit Selected <span class="hljs-number"><span class="hljs-number">38</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">47</span></span> terms, and <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">228</span></span> predictors Importance: NumNonHAtoms, MolWeight, SurfaceArea2, SurfaceArea1, FP142, ... Number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> terms at each degree <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> interaction: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">37</span></span> (additive model) GCV <span class="hljs-number"><span class="hljs-number">0.3877448</span></span> RSS <span class="hljs-number"><span class="hljs-number">312.877</span></span> GRSq <span class="hljs-number"><span class="hljs-number">0.907529</span></span> RSq <span class="hljs-number"><span class="hljs-number">0.9213739</span></span></code> </pre> <br>  Da dieses Modell in der internen Implementierung die GCV-Methode zur Auswahl eines Modells verwendet, unterscheidet sich seine Struktur etwas von dem zuvor in diesem Kapitel beschriebenen Modell.  Die Zusammenfassungsmethode generiert eine umfangreichere Ausgabe: <br><br><pre> <code class="javascript hljs">&gt; summary(marsFit) Call: earth(x=solTrainXtrans, y=solTrainY) coefficients (Intercept) <span class="hljs-number"><span class="hljs-number">-3.223749</span></span> FP002 <span class="hljs-number"><span class="hljs-number">0.517848</span></span> FP003 <span class="hljs-number"><span class="hljs-number">-0.228759</span></span> FP059 <span class="hljs-number"><span class="hljs-number">-0.582140</span></span> FP065 <span class="hljs-number"><span class="hljs-number">-0.273844</span></span> FP075 <span class="hljs-number"><span class="hljs-number">0.285520</span></span> FP083 <span class="hljs-number"><span class="hljs-number">-0.629746</span></span> FP085 <span class="hljs-number"><span class="hljs-number">-0.235622</span></span> FP099 <span class="hljs-number"><span class="hljs-number">0.325018</span></span> FP111 <span class="hljs-number"><span class="hljs-number">-0.403920</span></span> FP135 <span class="hljs-number"><span class="hljs-number">0.394901</span></span> FP142 <span class="hljs-number"><span class="hljs-number">0.407264</span></span> FP154 <span class="hljs-number"><span class="hljs-number">-0.620757</span></span> FP172 <span class="hljs-number"><span class="hljs-number">-0.514016</span></span> FP176 <span class="hljs-number"><span class="hljs-number">0.308482</span></span> FP188 <span class="hljs-number"><span class="hljs-number">0.425123</span></span> FP202 <span class="hljs-number"><span class="hljs-number">0.302688</span></span> FP204 <span class="hljs-number"><span class="hljs-number">-0.311739</span></span> FP207 <span class="hljs-number"><span class="hljs-number">0.457080</span></span> h(MolWeight<span class="hljs-number"><span class="hljs-number">-5.77508</span></span>) <span class="hljs-number"><span class="hljs-number">-1.801853</span></span> h(<span class="hljs-number"><span class="hljs-number">5.94516</span></span>-MolWeight) <span class="hljs-number"><span class="hljs-number">0.813322</span></span> h(NumNonHAtoms<span class="hljs-number"><span class="hljs-number">-2.99573</span></span>) <span class="hljs-number"><span class="hljs-number">-3.247622</span></span> h(<span class="hljs-number"><span class="hljs-number">2.99573</span></span>-NumNonHAtoms) <span class="hljs-number"><span class="hljs-number">2.520305</span></span> h(<span class="hljs-number"><span class="hljs-number">2.57858</span></span>-NumNonHBonds) <span class="hljs-number"><span class="hljs-number">-0.564690</span></span> h(NumMultBonds<span class="hljs-number"><span class="hljs-number">-1.85275</span></span>) <span class="hljs-number"><span class="hljs-number">-0.370480</span></span> h(NumRotBonds<span class="hljs-number"><span class="hljs-number">-2.19722</span></span>) <span class="hljs-number"><span class="hljs-number">-2.753687</span></span> h(<span class="hljs-number"><span class="hljs-number">2.19722</span></span>-NumRotBonds) <span class="hljs-number"><span class="hljs-number">0.123978</span></span> h(NumAromaticBonds<span class="hljs-number"><span class="hljs-number">-2.48491</span></span>) <span class="hljs-number"><span class="hljs-number">-1.453716</span></span> h(NumNitrogen<span class="hljs-number"><span class="hljs-number">-0.584815</span></span>) <span class="hljs-number"><span class="hljs-number">8.239716</span></span> h(<span class="hljs-number"><span class="hljs-number">0.584815</span></span>-NumNitrogen) <span class="hljs-number"><span class="hljs-number">-1.542868</span></span> h(NumOxygen<span class="hljs-number"><span class="hljs-number">-1.38629</span></span>) <span class="hljs-number"><span class="hljs-number">3.304643</span></span> h(<span class="hljs-number"><span class="hljs-number">1.38629</span></span>-NumOxygen) <span class="hljs-number"><span class="hljs-number">-0.620413</span></span> h(NumChlorine<span class="hljs-number"><span class="hljs-number">-0.46875</span></span>) <span class="hljs-number"><span class="hljs-number">-50.431489</span></span> h(HydrophilicFactor- <span class="hljs-number"><span class="hljs-number">-0.816625</span></span>) <span class="hljs-number"><span class="hljs-number">0.237565</span></span> h(<span class="hljs-number"><span class="hljs-number">-0.816625</span></span>-HydrophilicFactor) <span class="hljs-number"><span class="hljs-number">-0.370998</span></span> h(SurfaceArea1<span class="hljs-number"><span class="hljs-number">-1.9554</span></span>) <span class="hljs-number"><span class="hljs-number">0.149166</span></span> h(SurfaceArea2<span class="hljs-number"><span class="hljs-number">-4.66178</span></span>) <span class="hljs-number"><span class="hljs-number">-0.169960</span></span> h(<span class="hljs-number"><span class="hljs-number">4.66178</span></span>-SurfaceArea2) <span class="hljs-number"><span class="hljs-number">-0.157970</span></span> Selected <span class="hljs-number"><span class="hljs-number">38</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">47</span></span> terms, and <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">228</span></span> predictors Importance: NumNonHAtoms, MolWeight, SurfaceArea2, SurfaceArea1, FP142, ... Number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> terms at each degree <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> interaction: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">37</span></span> (additive model) GCV <span class="hljs-number"><span class="hljs-number">0.3877448</span></span> RSS <span class="hljs-number"><span class="hljs-number">312.877</span></span> GRSq <span class="hljs-number"><span class="hljs-number">0.907529</span></span> RSq <span class="hljs-number"><span class="hljs-number">0.9213739</span></span></code> </pre> <br>  Bei dieser Ableitung ist h (·) die Scharnierfunktion.  In den vorgestellten Ergebnissen ist die Komponente h (MolWeight-5.77508) bei einem Molekulargewicht von weniger als 5.77508 gleich Null (wie im oberen Teil von Abb. 7.3).  Die reflektierte Scharnierfunktion hat die Form h (5.77508 - MolWeight). <br><br>  Mit der Plotmo-Funktion aus dem Erdpaket können Diagramme erstellt werden, die den in Abb. 1 gezeigten ähnlich sind.  7.5.  Sie können train verwenden, um das Modell mithilfe eines externen Resamplings zu konfigurieren.  Der folgende Code gibt die in Abb. 1 gezeigten Ergebnisse wieder.  7.4: <br><br><pre> <code class="javascript hljs">&gt; #  -   &gt; marsGrid &lt;- expand.grid(.degree = <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>, .nprune = <span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">38</span></span>) &gt; #      &gt; set.seed(<span class="hljs-number"><span class="hljs-number">100</span></span>) &gt; marsTuned &lt;- train(solTrainXtrans, solTrainY, + method = <span class="hljs-string"><span class="hljs-string">"earth"</span></span>, + #   -   + tuneGrid = marsGrid, + trControl = trainControl(method = <span class="hljs-string"><span class="hljs-string">"cv"</span></span>)) &gt; marsTuned <span class="hljs-number"><span class="hljs-number">951</span></span> samples <span class="hljs-number"><span class="hljs-number">228</span></span> predictors No pre-processing Resampling: Cross-Validation (<span class="hljs-number"><span class="hljs-number">10</span></span>-fold) Summary <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> sample sizes: <span class="hljs-number"><span class="hljs-number">856</span></span>, <span class="hljs-number"><span class="hljs-number">857</span></span>, <span class="hljs-number"><span class="hljs-number">855</span></span>, <span class="hljs-number"><span class="hljs-number">856</span></span>, <span class="hljs-number"><span class="hljs-number">856</span></span>, <span class="hljs-number"><span class="hljs-number">855</span></span>, ... Resampling results across tuning parameters: degree nprune RMSE Rsquared RMSE SD Rsquared SD <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1.54</span></span> <span class="hljs-number"><span class="hljs-number">0.438</span></span> <span class="hljs-number"><span class="hljs-number">0.128</span></span> <span class="hljs-number"><span class="hljs-number">0.0802</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">1.12</span></span> <span class="hljs-number"><span class="hljs-number">0.7</span></span> <span class="hljs-number"><span class="hljs-number">0.0968</span></span> <span class="hljs-number"><span class="hljs-number">0.0647</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">1.06</span></span> <span class="hljs-number"><span class="hljs-number">0.73</span></span> <span class="hljs-number"><span class="hljs-number">0.0849</span></span> <span class="hljs-number"><span class="hljs-number">0.0594</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">1.02</span></span> <span class="hljs-number"><span class="hljs-number">0.75</span></span> <span class="hljs-number"><span class="hljs-number">0.102</span></span> <span class="hljs-number"><span class="hljs-number">0.0551</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0.984</span></span> <span class="hljs-number"><span class="hljs-number">0.768</span></span> <span class="hljs-number"><span class="hljs-number">0.0733</span></span> <span class="hljs-number"><span class="hljs-number">0.042</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">0.919</span></span> <span class="hljs-number"><span class="hljs-number">0.796</span></span> <span class="hljs-number"><span class="hljs-number">0.0657</span></span> <span class="hljs-number"><span class="hljs-number">0.0432</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">0.862</span></span> <span class="hljs-number"><span class="hljs-number">0.821</span></span> <span class="hljs-number"><span class="hljs-number">0.0418</span></span> <span class="hljs-number"><span class="hljs-number">0.0237</span></span> : : : : : : <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span> <span class="hljs-number"><span class="hljs-number">0.701</span></span> <span class="hljs-number"><span class="hljs-number">0.883</span></span> <span class="hljs-number"><span class="hljs-number">0.068</span></span> <span class="hljs-number"><span class="hljs-number">0.0307</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">34</span></span> <span class="hljs-number"><span class="hljs-number">0.702</span></span> <span class="hljs-number"><span class="hljs-number">0.883</span></span> <span class="hljs-number"><span class="hljs-number">0.0699</span></span> <span class="hljs-number"><span class="hljs-number">0.0307</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">35</span></span> <span class="hljs-number"><span class="hljs-number">0.696</span></span> <span class="hljs-number"><span class="hljs-number">0.885</span></span> <span class="hljs-number"><span class="hljs-number">0.0746</span></span> <span class="hljs-number"><span class="hljs-number">0.0315</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">36</span></span> <span class="hljs-number"><span class="hljs-number">0.687</span></span> <span class="hljs-number"><span class="hljs-number">0.887</span></span> <span class="hljs-number"><span class="hljs-number">0.0604</span></span> <span class="hljs-number"><span class="hljs-number">0.0281</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">37</span></span> <span class="hljs-number"><span class="hljs-number">0.696</span></span> <span class="hljs-number"><span class="hljs-number">0.885</span></span> <span class="hljs-number"><span class="hljs-number">0.0689</span></span> <span class="hljs-number"><span class="hljs-number">0.0291</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">38</span></span> <span class="hljs-number"><span class="hljs-number">0.686</span></span> <span class="hljs-number"><span class="hljs-number">0.887</span></span> <span class="hljs-number"><span class="hljs-number">0.0626</span></span> <span class="hljs-number"><span class="hljs-number">0.029</span></span> RMSE was used to select the optimal model using the smallest value. The final values used <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the model were degree = <span class="hljs-number"><span class="hljs-number">1</span></span> and nprune = <span class="hljs-number"><span class="hljs-number">38.</span></span> &gt; head(predict(marsTuned, solTestXtrans)) [<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-number"><span class="hljs-number">0.3677522</span></span> <span class="hljs-number"><span class="hljs-number">-0.1503220</span></span> <span class="hljs-number"><span class="hljs-number">-0.5051844</span></span> <span class="hljs-number"><span class="hljs-number">0.5398116</span></span> <span class="hljs-number"><span class="hljs-number">-0.4792718</span></span> <span class="hljs-number"><span class="hljs-number">0.7377222</span></span></code> </pre> <br>  Zwei Funktionen werden verwendet, um die Wichtigkeit jedes Prädiktors im MARS-Modell zu bewerten: evimp aus dem Erdpaket und varImp aus dem Caret-Paket (der zweite nennt den ersten): <br><br><pre> <code class="javascript hljs">&gt; varImp(marsTuned) earth variable importance only <span class="hljs-number"><span class="hljs-number">20</span></span> most important variables shown (out <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">228</span></span>) Overall MolWeight <span class="hljs-number"><span class="hljs-number">100.00</span></span> NumNonHAtoms <span class="hljs-number"><span class="hljs-number">89.96</span></span> SurfaceArea2 <span class="hljs-number"><span class="hljs-number">89.51</span></span> SurfaceArea1 <span class="hljs-number"><span class="hljs-number">57.34</span></span> FP142 <span class="hljs-number"><span class="hljs-number">44.31</span></span> FP002 <span class="hljs-number"><span class="hljs-number">39.23</span></span> NumMultBond s <span class="hljs-number"><span class="hljs-number">39.23</span></span> FP204 <span class="hljs-number"><span class="hljs-number">37.10</span></span> FP172 <span class="hljs-number"><span class="hljs-number">34.96</span></span> NumOxygen <span class="hljs-number"><span class="hljs-number">30.70</span></span> NumNitrogen <span class="hljs-number"><span class="hljs-number">29.12</span></span> FP083 <span class="hljs-number"><span class="hljs-number">28.21</span></span> NumNonHBonds <span class="hljs-number"><span class="hljs-number">26.58</span></span> FP059 <span class="hljs-number"><span class="hljs-number">24.76</span></span> FP135 <span class="hljs-number"><span class="hljs-number">23.51</span></span> FP154 <span class="hljs-number"><span class="hljs-number">21.20</span></span> FP207 <span class="hljs-number"><span class="hljs-number">19.05</span></span> FP202 <span class="hljs-number"><span class="hljs-number">17.92</span></span> NumRotBonds <span class="hljs-number"><span class="hljs-number">16.94</span></span> FP085 <span class="hljs-number"><span class="hljs-number">16.02</span></span></code> </pre> <br>  Diese Ergebnisse sind im Bereich von 0 bis 100 skaliert und unterscheiden sich von den in der Tabelle angegebenen.  7.1 (das in Tabelle 7.1 dargestellte Modell hat nicht den gesamten Prozess des Wachstums und der Verkürzung durchlaufen).  Beachten Sie, dass die Variablen, die auf die ersten folgen, für das Modell weniger wichtig sind. <br><br><h3>  SVM, Support-Vektor-Methode </h3><br>  Implementierungen von SVM-Modellen sind in mehreren R.-Paketen enthalten. Chang und Lin (Chang und Lin, 2011) verwenden die svm-Funktion aus dem e1071-Paket, um die Schnittstelle zur LIBSVM-Bibliothek für die Regression zu verwenden.  Eine vollständigere Implementierung von SVM-Modellen für die Karatsogl-Regression (Karatzoglou et al., 2004) ist im Kernlab-Paket enthalten, das die ksvm-Funktion für Regressionsmodelle und eine große Anzahl von Kernfunktionen enthält.  Standardmäßig wird die radiale Basisfunktion verwendet.  Wenn die Werte der Kosten und der Kernparameter bekannt sind, kann die Approximation des Modells wie folgt durchgeführt werden: <br><br><pre> <code class="javascript hljs">&gt; svmFit &lt;- ksvm(x = solTrainXtrans, y = solTrainY, + kernel =<span class="hljs-string"><span class="hljs-string">"rbfdot"</span></span>, kpar = <span class="hljs-string"><span class="hljs-string">"automatic"</span></span>, + C = <span class="hljs-number"><span class="hljs-number">1</span></span>, epsilon = <span class="hljs-number"><span class="hljs-number">0.1</span></span>)</code> </pre> <br>  Zur Schätzung von σ wurde eine automatisierte Analyse verwendet.  Da y ein numerischer Vektor ist, approximiert die Funktion offensichtlich das Regressionsmodell (anstelle des Klassifizierungsmodells).  Sie können andere Kernelfunktionen verwenden, einschließlich Polynom (Kernel = "Polydot") und Linear (Kernel = "Vanilladot"). <br><br>  Wenn die Werte unbekannt sind, können sie durch erneutes Abtasten geschätzt werden.  Im Zug wählen die Werte "svmRadial", "svmLinear" oder "svmPoly" des Methodenparameters verschiedene Kernelfunktionen aus: <br><br><pre> <code class="javascript hljs">&gt; svmRTuned &lt;- train(solTrainXtrans, solTrainY, + method = <span class="hljs-string"><span class="hljs-string">"svmRadial"</span></span>, + preProc = c(<span class="hljs-string"><span class="hljs-string">"center"</span></span>, <span class="hljs-string"><span class="hljs-string">"scale"</span></span>), + tuneLength = <span class="hljs-number"><span class="hljs-number">14</span></span>, + trControl = trainControl(method = <span class="hljs-string"><span class="hljs-string">"cv"</span></span>))</code> </pre> <br>  Das Argument tuneLength verwendet 14 Standardwerte. <img src="https://habrastorage.org/webt/tj/ey/rh/tjeyrh-jsrh2bavjcscm784t7d0.png" alt="Bild"><br><img src="https://habrastorage.org/webt/8a/67/hy/8a67hygcgz4_re1ru2xxpg_a0io.png" alt="Bild">  Eine Standardschätzung von σ wird durch automatische Analyse durchgeführt. <br><br><pre> <code class="javascript hljs">&gt; svmRTuned <span class="hljs-number"><span class="hljs-number">951</span></span> samples <span class="hljs-number"><span class="hljs-number">228</span></span> predictors Pre-processing: centered, scaled Resampling: Cross-Validation (<span class="hljs-number"><span class="hljs-number">10</span></span>-fold) Summary <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> sample sizes: <span class="hljs-number"><span class="hljs-number">855</span></span>, <span class="hljs-number"><span class="hljs-number">858</span></span>, <span class="hljs-number"><span class="hljs-number">856</span></span>, <span class="hljs-number"><span class="hljs-number">855</span></span>, <span class="hljs-number"><span class="hljs-number">855</span></span>, <span class="hljs-number"><span class="hljs-number">856</span></span>, ... Resampling results across tuning parameters: C RMSE Rsquared RMSE SD Rsquared SD <span class="hljs-number"><span class="hljs-number">0.25</span></span> <span class="hljs-number"><span class="hljs-number">0.793</span></span> <span class="hljs-number"><span class="hljs-number">0.87</span></span> <span class="hljs-number"><span class="hljs-number">0.105</span></span> <span class="hljs-number"><span class="hljs-number">0.0396</span></span> <span class="hljs-number"><span class="hljs-number">0.5</span></span> <span class="hljs-number"><span class="hljs-number">0.708</span></span> <span class="hljs-number"><span class="hljs-number">0.889</span></span> <span class="hljs-number"><span class="hljs-number">0.0936</span></span> <span class="hljs-number"><span class="hljs-number">0.0345</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0.664</span></span> <span class="hljs-number"><span class="hljs-number">0.898</span></span> <span class="hljs-number"><span class="hljs-number">0.0834</span></span> <span class="hljs-number"><span class="hljs-number">0.0306</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0.642</span></span> <span class="hljs-number"><span class="hljs-number">0.903</span></span> <span class="hljs-number"><span class="hljs-number">0.0725</span></span> <span class="hljs-number"><span class="hljs-number">0.0277</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">0.629</span></span> <span class="hljs-number"><span class="hljs-number">0.906</span></span> <span class="hljs-number"><span class="hljs-number">0.067</span></span> <span class="hljs-number"><span class="hljs-number">0.0253</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">0.621</span></span> <span class="hljs-number"><span class="hljs-number">0.908</span></span> <span class="hljs-number"><span class="hljs-number">0.0634</span></span> <span class="hljs-number"><span class="hljs-number">0.0238</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">0.617</span></span> <span class="hljs-number"><span class="hljs-number">0.909</span></span> <span class="hljs-number"><span class="hljs-number">0.0602</span></span> <span class="hljs-number"><span class="hljs-number">0.0232</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> <span class="hljs-number"><span class="hljs-number">0.613</span></span> <span class="hljs-number"><span class="hljs-number">0.91</span></span> <span class="hljs-number"><span class="hljs-number">0.06</span></span> <span class="hljs-number"><span class="hljs-number">0.0234</span></span> <span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-number"><span class="hljs-number">0.611</span></span> <span class="hljs-number"><span class="hljs-number">0.911</span></span> <span class="hljs-number"><span class="hljs-number">0.0586</span></span> <span class="hljs-number"><span class="hljs-number">0.0231</span></span> <span class="hljs-number"><span class="hljs-number">128</span></span> <span class="hljs-number"><span class="hljs-number">0.609</span></span> <span class="hljs-number"><span class="hljs-number">0.911</span></span> <span class="hljs-number"><span class="hljs-number">0.0561</span></span> <span class="hljs-number"><span class="hljs-number">0.0223</span></span> <span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-number"><span class="hljs-number">0.609</span></span> <span class="hljs-number"><span class="hljs-number">0.911</span></span> <span class="hljs-number"><span class="hljs-number">0.056</span></span> <span class="hljs-number"><span class="hljs-number">0.0224</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span> <span class="hljs-number"><span class="hljs-number">0.61</span></span> <span class="hljs-number"><span class="hljs-number">0.911</span></span> <span class="hljs-number"><span class="hljs-number">0.0563</span></span> <span class="hljs-number"><span class="hljs-number">0.0226</span></span> <span class="hljs-number"><span class="hljs-number">1020</span></span> <span class="hljs-number"><span class="hljs-number">0.613</span></span> <span class="hljs-number"><span class="hljs-number">0.91</span></span> <span class="hljs-number"><span class="hljs-number">0.0563</span></span> <span class="hljs-number"><span class="hljs-number">0.023</span></span> <span class="hljs-number"><span class="hljs-number">2050</span></span> <span class="hljs-number"><span class="hljs-number">0.618</span></span> <span class="hljs-number"><span class="hljs-number">0.909</span></span> <span class="hljs-number"><span class="hljs-number">0.0541</span></span> <span class="hljs-number"><span class="hljs-number">0.023</span></span> Tuning parameter <span class="hljs-string"><span class="hljs-string">'sigma'</span></span> was held constant at a value <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">0.00387</span></span> RMSE was used to select the optimal model using the smallest value. The final values used <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the model were C = <span class="hljs-number"><span class="hljs-number">256</span></span> and sigma = <span class="hljs-number"><span class="hljs-number">0.00387</span></span>.</code> </pre> <br>  Das Unterobjekt finalModel enthält das von der Funktion ksvm erstellte Modell: <br><br><pre> <code class="javascript hljs">&gt; svmRTuned$finalModel Support Vector Machine object <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ksvm</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SV</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eps</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">svr</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">regression</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parameter</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">epsilon</span></span></span><span class="hljs-class"> </span></span>= <span class="hljs-number"><span class="hljs-number">0.1</span></span> cost C = <span class="hljs-number"><span class="hljs-number">256</span></span> Gaussian Radial Basis kernel <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">. </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Hyperparameter</span></span></span><span class="hljs-function"> : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sigma</span></span></span><span class="hljs-function"> = 0.00387037424967707 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Number</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">of</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Support</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Vectors</span></span></span><span class="hljs-function"> : 625 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Objective</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Value</span></span></span><span class="hljs-function"> : -1020.558 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Training</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-function"> : 0.009163</span></span></code> </pre> <br>  Als Referenzvektoren verwendet das Modell 625 Datenpunkte des Trainingssatzes (d. H. 66% des Trainingssatzes). <br><br>  Das Kernlab-Paket enthält eine Implementierung des RVM-Modells für die Regression in der rvm-Funktion.  Die Syntax ist der im Beispiel für ksvm dargestellten sehr ähnlich. <br><br><h3>  KNN-Methode </h3><br>  Das Caren-Paket knnreg nähert sich dem KNN-Regressionsmodell an;  Die Zugfunktion setzt das Modell auf K: <br><br><pre> <code class="javascript hljs">&gt; #      . &gt; knnDescr &lt;- solTrainXtrans[, -nearZeroVar(solTrainXtrans)] &gt; set.seed(<span class="hljs-number"><span class="hljs-number">100</span></span>) &gt; knnTune &lt;- train(knnDescr, + solTrainY, + method = <span class="hljs-string"><span class="hljs-string">"knn"</span></span>, + #      + #    + preProc = c(<span class="hljs-string"><span class="hljs-string">"center"</span></span>, <span class="hljs-string"><span class="hljs-string">"scale"</span></span>), + tuneGrid = data.frame(.k = <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">20</span></span>), + trControl = trainControl(method = <span class="hljs-string"><span class="hljs-string">"cv"</span></span>))</code> </pre> <br><br><h3>  Über die Autoren: </h3><br>  <b>Max Kun</b> ist Leiter der Abteilung für statistische nichtklinische Forschung und Entwicklung von Pfizer Global  Er arbeitet seit über 15 Jahren mit Vorhersagemodellen und ist Autor mehrerer Spezialpakete für die R-Sprache. Die Vorhersagemodellierung in der Praxis deckt alle Aspekte der Vorhersage ab, beginnend mit den Schlüsselphasen der Datenvorverarbeitung, Datenaufteilung und Grundprinzipien <br>  Modelleinstellungen.  Alle Phasen der Modellierung werden anhand praktischer Beispiele betrachtet. <br>  Aus dem wirklichen Leben enthält jedes Kapitel einen detaillierten Code in R. <br><br>  <b>Kjell Johnson</b> ist seit mehr als zehn Jahren auf dem Gebiet der Statistik und Vorhersagemodellierung für die pharmazeutische Forschung tätig.  Mitbegründer von Arbor Analytics, einem Unternehmen, das sich auf Vorhersagemodelle spezialisiert hat;  Zuvor leitete er die Abteilung für statistische Forschung und Entwicklung bei Pfizer Global.  Seine wissenschaftliche Arbeit widmet sich der Anwendung und Entwicklung statistischer Methoden und Lernalgorithmen. <br><br>  »Weitere Informationen zum Buch finden Sie auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der Website des Herausgebers</a> <br>  » <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Inhalt</a> <br>  » <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Auszug</a> <br><br>  25% Rabatt auf den Gutschein für Händler - <b>Angewandte prädiktive Modellierung</b> <br>  Nach Bezahlung der Papierversion des Buches wird ein elektronisches Buch per E-Mail verschickt. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de462833/">https://habr.com/ru/post/de462833/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de462819/index.html">Mängel im Sprachunterricht in der GUS: eine polyglotte Sichtweise</a></li>
<li><a href="../de462821/index.html">So bewerten Sie Computer, die noch nicht vorhanden sind</a></li>
<li><a href="../de462825/index.html">Videoberichte vom Summer Droid Meetup</a></li>
<li><a href="../de462827/index.html">Leben und Erfolg von Larry Ellison, Gründer von Oracle</a></li>
<li><a href="../de462831/index.html">Fahren Sie mit der Web 3.0 Wave</a></li>
<li><a href="../de462835/index.html">Unity Auto-Layout und Stile: Unsere neue Pipeline und Tools für die Benutzeroberfläche</a></li>
<li><a href="../de462837/index.html">Black-Box-Test</a></li>
<li><a href="../de462843/index.html">Einschränkungen von 8-Bit-Spielen und deren genaue Wiederherstellung in Unity</a></li>
<li><a href="../de462845/index.html">Massage für Ihr Gehirn: Sprechen Sie über ASMR</a></li>
<li><a href="../de462847/index.html">Hewlett Packard Enterprise-Webinare von August bis Oktober 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>