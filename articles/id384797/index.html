<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ’‡ğŸ¿ ğŸ›ï¸ ğŸ‘¨ğŸ»â€âœˆï¸ NKRO ke USB. Masalah dan kruk dalam solusi mereka ğŸ’ª âŒšï¸ ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo GT. Dalam salah satu posting saya sebelumnya (khususnya, tentang keyboard SteelSeries Apex M800) monah_tukmengajukan pertanyaan menarik di koment...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>NKRO ke USB. Masalah dan kruk dalam solusi mereka</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ulmart/blog/384797/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo GT. </font><font style="vertical-align: inherit;">Dalam salah satu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">posting</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> saya sebelumnya </font><font style="vertical-align: inherit;">(khususnya, tentang keyboard SteelSeries Apex M800)  </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">monah_tuk</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengajukan pertanyaan menarik di komentar: bagaimana NKRO (rollover n-key, penjepitan simultan dari beberapa tombol) diimplementasikan pada keyboard USB. </font><font style="vertical-align: inherit;">Pertanyaan ini menarik minat saya, dan ketika saya menggali sedikit lebih dalam ... Secara umum, ada kandang Augean sehingga ada informasi yang cukup untuk seluruh posting, walaupun sedikit. </font><font style="vertical-align: inherit;">
Tampaknya USB 2.0, bahkan dalam mode kecepatan rendah, menyediakan transmisi hingga 1500 Kbps (sekitar 185 KB / s), apa masalah transmisi penekanan tombol? </font><font style="vertical-align: inherit;">Tapi tidak sesederhana itu.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/files/880/ae3/53b/880ae353bc054764b5b00e78560f2c91.jpg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mencari tahu masalah apa yang dimiliki koneksi USB, kita harus mempelajari sejarah, dan sedikit ke dalam desain keyboard. </font></font><br>
<br>
<h2><font color="#e40136"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah Rollover: ghosting</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Katakanlah Anda memiliki keyboard dengan tombol standar 104/105. Dalam kasus ideal, untuk mendapatkan informasi akurat 100% tentang kunci mana yang dijepit, Anda akan membutuhkan 1 "kabel" lebih banyak daripada tombol: 104/105 kabel dari tombol, dan satu "ground" yang umum. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja, kabel seperti itu akan sulit dan mahal, begitu banyak keyboard murah digunakan di dalam apa yang disebut. "Matrix" - satu set kontak horizontal dan vertikal berpotongan. Pengontrol memindai setiap kolom, mendeteksi sinyal, mulai memindai "baris" dan menghitung tombol yang ditekan.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/8a9/db0/9a9/8a9db09a960c7e2381df3ba06addc245.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda menekan, katakanlah, S dan G dan ingin menambahkan beberapa kunci ketiga berturut-turut yang berbeda, controller tidak bisa lagi mengatakan yang mana dari garis ditutup: di terbaik itu akan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mendeteksi salah satu dari tiga, paling buruk - dari untuk fitur pengkabelan, saya akan menggambar keempat lagi yang tidak Anda klik. Ini disebut ghosting. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perilaku ini diperlakukan dengan berbagai trik di bidang perkabelan: kombinasi yang paling populer digantung pada "garis" yang berbeda, garis fungsi, yang sering merupakan elemen hotkey, diberi baris terpisah. Tata letak tetap cukup sederhana, tetapi </font><font style="vertical-align: inherit;">keyboard </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mahal jarang 5 + KRO - biasanya terbatas pada 3-4 saat tombol ditekan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain itu, pengontrol dapat memblokir "tetangga" di blok untuk menghapus operasi "ekstra". Artinya, secara formal keyboard dapat mendukung 6KRO, dan jujur â€‹â€‹membiarkan CTRL + AWFBNM ditekan pada saat yang sama, tetapi tidak membiarkan AWSD bertahan, terbatas untuk memicu tipe WAS atau WDS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat memeriksa keyboard Anda dengan semacam ini </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hal</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ini memiliki beberapa keterbatasan, tetapi mereka disebabkan oleh kenyataan bahwa sistem akan mencegat penekanan tombol lebih awal dari browser. Misalnya, Print Screen atau Alt + Tab akan berfungsi sebelum halaman dapat "menangkap" mereka.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang, sistem â€œmurahâ€ yang mengerikan (dari sudut pandang pekerjaan) ini hampir sepenuhnya digantikan oleh matriks â€œterbukaâ€ yang sedikit lebih kompleks, namun demikian, masih ada contoh, terutama sering di semua jenis keyboard lengkap â€œsatu dolarâ€ yang pergi ke komputer â€œdari luarâ€ kotak. " </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lebih mahal (seringkali gaming atau keyboard bisnis) menggunakan sirkuit yang lebih kompleks, beberapa pengendali, koneksi individual, papan sirkuit tercetak berlapis-lapis, secara umum, berbagai pendekatan yang mengurangi atau sepenuhnya menghilangkan ghosting, tetapi mengarah pada peningkatan harga perangkat. </font><font style="vertical-align: inherit;">Kami menemukan potensi masalah perangkat keras NKRO, kami beralih ke masalah perangkat lunak.</font></font><br>
<br>
<h2><font color="#e40136"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keyboard hingga USB</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Konektor umum utama untuk menghubungkan keyboard dan mouse ke USB adalah PS / 2. Inilah yang rapi: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/f5b/7a6/e90/f5b7a6e905986a83ea8ad3fac4e5b6b2.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pesonanya adalah bahwa, tunduk pada semua standar, dimungkinkan untuk bekerja dengan mouse dan keyboard dari satu konektor dan splitter, dan perangkat input itu sendiri menghasilkan interupsi dan mengirim informasi tentang tombol yang ditekan / gerakan kursor. Di sana, setidaknya putar wajah Anda pada keyboard, jika semuanya dipisahkan dengan benar, dan rollover tidak bertumpu pada kemampuan perangkat keras keyboard - keyboard akan mengirimkan segala sesuatu yang "dibaca" oleh pengontrol.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sayangnya, PS / 2 memiliki beberapa kelemahan (seperti masalah dengan Plug'n'Play dan konektor yang tidak nyaman), dan keberadaan USB menyebabkan fakta bahwa periferal PS / 2 hampir sepenuhnya didorong keluar dari pasar. </font><font style="vertical-align: inherit;">Namun demikian, ada motherboard yang cukup modern dengan USB 3.0 dan dua (!) PS / 2: </font></font><br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/110/db6/de3/110db6de3dee099c328da97f5ced88cb.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gabungan port, omong-omong, karena fitur pinout (catu daya umum, pin berbeda untuk data + / data- di mouse dan keyboard), juga memungkinkan Anda untuk terhubung kedua perangkat melalui satu port menggunakan adaptor:</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/dbd/c58/009/dbdc5800929686000cda4c2b39a268ed.jpg"><br>
<br>
<h2><font color="#e40136"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah NKRO USB: USB HID yang harus disalahkan </font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agar keyboard USB berfungsi sebelum memuat sistem (yaitu, di BIOS / UEFI), driver HID standar digunakan, yang dikembangkan untuk dukungan seluas mungkin untuk keyboard dan host USB. Kelas USB HID menjelaskan perangkat sehingga implementasi standar dari host USB dan perangkat USB dapat berkomunikasi tanpa menginstal driver khusus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Keyboard standar (dirancang dengan dukungan untuk standar USB HID) menggunakan aliran data output (output dari host USB) (titik akhir tumpukan USB) untuk mendapatkan informasi tentang status indikator (Jumlah / Caps / Tombol Gulir), dan aliran input (berasal dari keyboard, "Masuk" untuk host USB) untuk mengirim informasi tentang tombol yang ditekan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda mengikuti spesifikasi USB HID v1.11 yang paling ketat, yang mendukung mode Boot USB (dan memungkinkan Anda menggunakan keyboard USB untuk masuk ke BIOS dan bekerja di dalamnya), keyboard akan mengirim gangguan ke CPU setiap kali host USB melakukan polling. , terlepas dari apakah kondisinya telah berubah atau belum. Dengan demikian, karya keyboard PS / 2 "ditiru" dengan overhead yang minimal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam hal ini, keyboard berfungsi sesuai dengan standar USB 1.1 (kadang-kadang 2.0) Kecepatan rendah, dan kecepatan polling port adalah 100 Hz. Dalam mode ini, panjang paket maksimum pada USB adalah 8 byte, dan dikirim setiap 10 ms. Salah satu byte dicadangkan, sehingga 7 byte tetap agar keyboard berfungsi, mis. jumlahnya cukup untuk menyandikan pers tombol pengubah apa pun dan enam lainnya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ternyata siapa keyboard bekerja dalam mode 6-KRO, dan itu standar untuk sebagian besar keyboard USB. </font><font style="vertical-align: inherit;">Untuk melakukan lebih sedikit adalah mungkin (kadang-kadang secara sadar, kadang tidak, karena ghosting dan kemacetan kunci), lebih - hanya melanggar spesifikasi USB HID. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah memuat, sistem dapat meningkatkan frekuensi polling port USB, memuat driver khusus yang memungkinkan, misalnya, tombol multimedia dan makro.</font></font><br>
<br>
<h2><font color="#e40136"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementasi NKRO USB</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pembatasan bypass USB HID, pada kenyataannya, ada dua jenis. </font><font style="vertical-align: inherit;">Dalam kasus pertama, keyboard terdeteksi oleh perangkat lunak berpemilik, ditransfer ke beberapa mode khusus dan mengirimkan data dari pengontrol langsung ke driver, dan itu sudah berkomunikasi dengan sistem. </font><font style="vertical-align: inherit;">The minus dari keputusan seperti itu adalah peningkatan yang disebut </font><font style="vertical-align: inherit;">input lag: input lag. </font><font style="vertical-align: inherit;">Wawancara kenalan, saya hanya menemukan satu keyboard yang memungkinkan saya untuk menekan 10 tombol ketika terhubung melalui USB: kata benda Cina terry dengan zakos di bawah "gaming". </font><font style="vertical-align: inherit;">Pemiliknya sudah tinggal di Irkutsk, jadi tidak mengherankan bahwa dia hanya menemukan hal seperti itu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solusi kedua menawan dengan kesederhanaan dan kecerdikannya, tetapi sebenarnya itu adalah penopang: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/244/ecd/20d/244ecd20d056e4d0475d82b8a9a9bc68.png"><br>
<sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terima kasih atas tangkapan layar  </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketakutan saya</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, hal seperti itu diperhatikan untuk Logitech G710 +</font></font></sup><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Keyboard hanya disajikan ke sistem oleh beberapa perangkat HID, yang masing-masing memiliki 6KRO sendiri. </font><font style="vertical-align: inherit;">Survei cepat dari kenalan yang meminta mereka menentukan model keyboard dan mengirim tangkapan layar seperti itu menunjukkan bahwa </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Logitech</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A4tech</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cougar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SteelSeries</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menggunakan peretasan ini </font><font style="vertical-align: inherit;">- secara umum, semua orang yang menemukan NKRO dalam deskripsi keyboard USB. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhatian! </font><font style="vertical-align: inherit;">Sebelum memeriksa keyboard Anda, pastikan Anda tidak memiliki mouse USB multi-tombol canggih yang terhubung (bahkan secara nirkabel). </font><font style="vertical-align: inherit;">Karena semua keindahan multi-tombol dengan cara yang sama dapat berpura-pura menjadi keyboard "ekstra".</font></font><br>
<br>
<h2><font color="#e40136"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebenarnya, itu saja. </font><font style="vertical-align: inherit;">Hampir semua produsen telah memilih metode "penopang", tetapi yang berfungsi dan tidak menciptakan masalah khusus bagi pengguna, dan NKRO yang jujur â€‹â€‹(well, relatif jujur) pada USB dapat dicapai.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id384797/">https://habr.com/ru/post/id384797/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id384783/index.html">Perusahaan Swedia secara bertahap pindah ke hari kerja 6 jam</a></li>
<li><a href="../id384785/index.html">Cara memprogram ulang kanker</a></li>
<li><a href="../id384789/index.html">Snowden lupa mematikan pemberitahuan Twitter dan menerima 47 GB email</a></li>
<li><a href="../id384791/index.html">Yang seru untuk dilihat di Igromir 2015</a></li>
<li><a href="../id384793/index.html">Ini hanya ruang, sayang: New Horizons mengirim foto-foto hi-res Charon</a></li>
<li><a href="../id384799/index.html">Cipherpunk Legacy: The Evolution of Ideas</a></li>
<li><a href="../id384801/index.html">Hari terakhir Pompeii: Ilmuwan Italia memindai sisa-sisa korban bencana</a></li>
<li><a href="../id384803/index.html">Paul Graham: Gagasan untuk Startup Organik</a></li>
<li><a href="../id384805/index.html">Spesialis IFixit menghancurkan AppleTV, dan Apple mencopot pemasangan aplikasi iFixit dari AppStore</a></li>
<li><a href="../id384809/index.html">Kertas atau "angka"? Keduanya: ulasan tentang pena NeoLAB Convergence Neo smartpen N2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>