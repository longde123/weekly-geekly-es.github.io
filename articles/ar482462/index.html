<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐โ๐จ ๐๐ฟ ๐๐พ ุชุนูู Metaflow ูู 10 ุฏูุงุฆู ๐ฉ๐พโโ๏ธ ๐ฒ ๐ง๐ผ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Metaflow ูู ุฅุทุงุฑ ุนูู Python ุชู ุฅูุดุงุคู ูู Netflix ููุฑูุฒ ุนูู ูุฌุงู ุนููู ุงูุจูุงูุงุช. ููู ูุตููุฉ ูุฅูุดุงุก ูุดุงุฑูุน ุชูุฏู ุฅูู ุงูุนูู ูุน ุงูุจูุงูุงุช ุ ูุฅุฏุงุฑุฉ ูุฐู ุงููุดุงุฑู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชุนูู Metaflow ูู 10 ุฏูุงุฆู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/482462/" style=";text-align:right;direction:rtl">  Metaflow ูู ุฅุทุงุฑ ุนูู Python ุชู ุฅูุดุงุคู ูู Netflix ููุฑูุฒ ุนูู ูุฌุงู ุนููู ุงูุจูุงูุงุช.  ููู ูุตููุฉ ูุฅูุดุงุก ูุดุงุฑูุน ุชูุฏู ุฅูู ุงูุนูู ูุน ุงูุจูุงูุงุช ุ ูุฅุฏุงุฑุฉ ูุฐู ุงููุดุงุฑูุน.  ูู ุงูุขููุฉ ุงูุฃุฎูุฑุฉ ุ ูููุชูุง ุงูุดุฑูุฉ ุฅูู ูุฆุฉ ุงููุตุงุฏุฑ ุงูููุชูุญุฉ.  ุชู ุงุณุชุฎุฏุงู ุฅุทุงุฑ Metaflow ุนูู ูุทุงู ูุงุณุน ุฏุงุฎู Netflix ูู ุงูุนุงููู ุงููุงุถููู.  ุนูู ูุฌู ุงูุฎุตูุต ุ ุณูุญ ูุฎูุถ ูุจูุฑ ูู ุงูููุช ุงููุงุฒู ูุฅูุฌุงุฒ ุงููุดุงุฑูุน ูู ุงูุฅูุชุงุฌ. <br><br> <a href="https://habr.com/ru/company/ruvds/blog/482462/"><img src="https://habrastorage.org/webt/yd/2j/7p/yd2j7p_dpzkyrjeef9us6a7pgs4.png"></a> <br><br>  ุงูููุงุฏ ุงูุชู ูุชุฑุฌููุง ุงูููู ูู ุฏููู ุณุฑูุน ุฅูู Metaflow. <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ูุง ูู Metaflowุ</font> </h2><br>  ููุฌุฏ ุฃุฏูุงู ุฑุณู ุจูุงูู ููุถุญ ุชูููุฐ ุฅุทุงุฑ ุนูู Metaflow ูู Netflix. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/6bd/bb8/297/6bdbb82972a098b8fd241f42d7f55b51.png"></div><br>  <i><font color="#999999">ุชูููุฐ Metaflow ูู Netflix</font></i> <br><br>  ูู ููููุจุฑ 2018 ุ ุชู ุงุณุชุฎุฏุงู ูุฐุง ุงูุฅุทุงุฑ ูู 134 ูุดุฑูุนูุง ููุดุฑูุฉ. <br><br>  Metaflow ูู ุฅุทุงุฑ ูุฅูุดุงุก ูุชูููุฐ ููุงู ุณูุฑ ุนูู ุนูู ุงูุจูุงูุงุช.  ููุชููุฒ ุงูููุฒุงุช ุงูุชุงููุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุฏุงุฑุฉ ุงูููุงุฑุฏ ุงูุญุงุณูุจูุฉ. </li><li style=";text-align:right;direction:rtl">  ูููุฉ ุฅุทูุงู ุงูุญุงููุงุช. </li><li style=";text-align:right;direction:rtl">  ุฅุฏุงุฑุฉ ุงูุชุจุนูุงุช ุงูุฎุงุฑุฌูุฉ. </li><li style=";text-align:right;direction:rtl">  ุงูุฅุตุฏุงุฑ ุ ุฅุนุงุฏุฉ ุชูููุฐ ุงูููุงู ุ ุงุณุชูุฑุงุฑ ุชูููุฐ ุงูููุงู ุงููุนููุฉ. </li><li style=";text-align:right;direction:rtl">  ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ุงูุนููู ููุญุต ูุชุงุฆุฌ ุงูููุงู ุงูุชู ูููู ุงุณุชุฎุฏุงููุง ูู ุจูุฆุฉ Jupyter Notebook. </li><li style=";text-align:right;direction:rtl">  ุฏุนู ูุญูู (ุนูู ุณุจูู ุงููุซุงู ุ ุนูู ููุจููุชุฑ ูุญููู) ูุชูููุฐ ุงููููุฉ ุนู ุจูุนุฏ (ูู ุงูุณุญุงุจุฉ).  ุงููุฏุฑุฉ ุนูู ุงูุชุจุฏูู ุจูู ูุฐู ุงูุฃูุถุงุน. </li></ul><br>  <a href="https://news.ycombinator.com/item%3Fid%3D21698711">ูุชุจ</a> ุงููุณุชุฎุฏู vtuulos ุนูู Ycombinator ุฃู Metaflow ููููู ุชููุงุฆููุง ุฅูุดุงุก ููุทุงุช (ููุทุงุช) ูู ุงูููุฏ ูุงูุจูุงูุงุช ูุงูุชุจุนูุงุช.  ูุชู ูุถุน ูู ูุฐุง ูู ูุณุชูุฏุน ูุน ุนูููุฉ ุญุณุจ ุงููุญุชูู ุ ูุงูุชู ุชุนุชูุฏ ุนุงุฏุฉู ุนูู S3 ุ ุนูู ุงูุฑุบู ูู ุฃู ูุธุงู ุงููููุงุช ุงููุญูู ูุฏุนูู ุฃูุถูุง.  ูุชูุญ ูู ุฐูู ููุงุตูุฉ ุฃุฏุงุก ุงูููุงู ุงูุชู ุชู ุฅููุงููุง ูุฅุนุงุฏุฉ ุฅูุชุงุฌ ุงููุชุงุฆุฌ ุงูุชู ุชู ุงูุญุตูู ุนูููุง ูุณุจููุง ูุงุณุชูุดุงู ูู ูุง ูุชุนูู ุจุงูููุงู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู Jupyter Notebook. <br><br>  ุจุดูู ุนุงู ุ ูููููุง ุงูููู ุฃู Metaflow ููุฏู ุฅูู ุฒูุงุฏุฉ ุฅูุชุงุฌูุฉ ุนููุงุก ุงูุจูุงูุงุช.  ูุชู ุฐูู ูุธุฑูุง ูุญูููุฉ ุฃู ุงูุฅุทุงุฑ ูุณูุญ ููู ุจุงููุดุงุฑูุฉ ุญุตุฑููุง ูู ุงูุนูู ูุน ุงูุจูุงูุงุช ุ ุฏูู ุฃู ูุตุฑู ุงูุชุจุงููู ุนู ุทุฑูู ุญู ุงูููุงู ุฐุงุช ุงูุตูุฉ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชุณุฑุน Metaflow ูู ุณุญุจ ุงููุดุงุฑูุน ุจูุงุกู ุนูููุง ูู ุงูุฅูุชุงุฌ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/d16/311/176/d1631117682028c779664c90bef2a885.png"></div><br>  <i><font color="#999999">ุงุญุชูุงุฌุงุช ุนุงูู ุงูุจูุงูุงุช ูููุง ูุชุนูู ุจูุณุคูููุงุชู ุงููุจุงุดุฑุฉ ูุญู ุงูููุงู ุงููุณุงุนุฏุฉ ุงููุชุนููุฉ ุจุงูุจููุฉ ุงูุชุญุชูุฉ ุงูุชู ูุชู ุฅุฌุฑุงุก ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ุนูููุง</font></i> <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ุณููุงุฑูููุงุช ุณูุฑ ุงูุนูู ูุน Metaflow</font> </h2><br>  ูููุง ููู ุจุนุถ ุณููุงุฑูููุงุช ุณูุฑ ุงูุนูู ุงูุชู ููููู ุชูุธูููุง ุจุงุณุชุฎุฏุงู Metaflow: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>ุงูุชุนุงูู.</b>  ูุฑูุฏ ุฃุญุฏ ุนููุงุก ุงูุจูุงูุงุช ูุณุงุนุฏุฉ ุขุฎุฑ ูู ุงูุนุซูุฑ ุนูู ูุตุฏุฑ ุงูุฎุทุฃ.  ูู ููุณ ุงูููุช ุ ูุฑุบุจ ุงููุณุงุนุฏ ูู ุชูุฒูู ุงูุจูุฆุฉ ุจุงููุงูู ุงูุชู ุชุนูู ุจูุง ุงููููุฉ ุงูุชู ุชุญุทูุช ุนูู ุฌูุงุฒ ุงูููุจููุชุฑ ุงูุฎุงุต ุจู. </li><li style=";text-align:right;direction:rtl">  <b>ุงุณุชูุฑุงุฑ ุงูููุงู ุงููุชูููุฉ ูู ุงูููุงู ุงูุฐู ุชูููุช ููู.</b>  ุชู ุฅููุงู ุจุนุถ ุงูููุงู ุจุณุจุจ ูุฌูุฏ ุฎุทุฃ (ุฃู ุชู ุฅููุงููุง ุนู ูุตุฏ).  ุชู ุชุตุญูุญ ุงูุฎุทุฃ (ุฃู ุชู ุชุญุฑูุฑ ุงูููุฏ).  ูู ุงูุถุฑูุฑู ุฅุนุงุฏุฉ ุชุดุบูู ุงููููุฉ ุญุชู ูุณุชูุฑ ุนูููุง ูู ุงูููุงู ุงูุฐู ูุดูุช ููู (ุฃู ุชู ุฅููุงูู). </li><li style=";text-align:right;direction:rtl">  <b>ุชูููุฐ ุงููููุฉ ุงููุฎุชูุทุฉ.</b>  ุชุญุชุงุฌ ุฅูู ุชูููุฐ ุฎุทูุฉ ูุนููุฉ ูู ุณูุฑ ุงูุนูู ูุญูููุง (ุฑุจูุง ูุฐู ูู ุฎุทูุฉ ุชูุฒูู ุงูุจูุงูุงุช ูู ููู ูุฎุฒูู ูู ูุฌูุฏ ุนูู ุงูููุจููุชุฑ) ุ ููุฌุจ ุชูููุฐ ุฎุทูุฉ ุฃุฎุฑู ุชุชุทูุจ ููุงุฑุฏ ุญุณุงุจูุฉ ูุจูุฑุฉ (ุฑุจูุง ูุฐุง ูู ุชุฏุฑูุจ ุงููููุฐุฌ) ูู ุงูุณุญุงุจุฉ. </li><li style=";text-align:right;direction:rtl">  <b>ูุญุต ุงูุจูุงูุงุช ุงููุตููุฉ ุงูุชู ุชู ุงูุญุตูู ุนูููุง ุจุนุฏ ุงูุงูุชูุงุก ูู ุงููููุฉ</b>  ุซูุงุซุฉ ุนููุงุก ูุดุงุฑููู ูู ุงุฎุชูุงุฑ ุงููุนููุงุช ุงููุงุฆูุฉ ูููููุฐุฌ ููุณู ุ ูู ูุญุงููุฉ ูุชุญุณูู ุฏูุฉ ูุฐุง ุงููููุฐุฌ.  ุจุนุฏ ุฐูู ุ ุชุญุชุงุฌ ุฅูู ุชุญููู ูุชุงุฆุฌ ููุงู ุชุฏุฑูุจ ุงููููุฐุฌ ูุงุฎุชูุงุฑ ูุฌููุนุฉ ูู ุงููุนููุงุช ุงููุงุฆูุฉ ุงูุชู ุฃุธูุฑุช ุฃููุง ุงูุฃูุถู. </li><li style=";text-align:right;direction:rtl">  <b>ุจุงุณุชุฎุฏุงู ุฅุตุฏุงุฑุงุช ูุชุนุฏุฏุฉ ูู ููุณ ุงูุญุฒูุฉ.</b>  ุชุญุชุงุฌ ูู ุงููุดุฑูุน ุฅูู ุงุณุชุฎุฏุงู ุฅุตุฏุงุฑุงุช ูุฎุชููุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ููุชุจุงุช sklearn.  ุฃุซูุงุก ุงููุนุงูุฌุฉ ุงููุณุจูุฉ ุ ูููู ุฅุตุฏุงุฑูุง 0.20 ูุทููุจูุง ุ ูุฎูุงู ุงููุณุฎ ุ ูููู ุงูุฅุตุฏุงุฑ 0.22 ูุทููุจูุง. </li></ul><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ุณูุฑ ุนูู Metaflow ุงููููุฐุฌู</font> </h2><br>  ุงููุธุฑ ูู ุณูุฑ ุนูู Metaflow ูููุฐุฌู ูู ููุธูุฑ ุงูููุงูููู ูุงูุจุฑูุฌุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">on ุงููุธุฑุฉ ุงููุธุฑูุฉ ูู ุณูุฑ ุนูู Metaflow</font> </h3><br>  ูู ูุฌูุฉ ูุธุฑ ููุงููููุฉ ุ ูุชู ุชูุซูู ุณูุฑ ุนูู Metaflow (ุณูุงุณู ุงูููุงู) ุจุฑุณูู <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D1%2580%25D0%25B8%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B0%25D1%2586%25D0%25B8%25D0%25BA%25D0%25BB%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25B3%25D1%2580%25D0%25B0%25D1%2584">ุจูุงููุฉ</a> ุญุงุฏุฉ <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D1%2580%25D0%25B8%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B0%25D1%2586%25D0%25B8%25D0%25BA%25D0%25BB%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25B3%25D1%2580%25D0%25B0%25D1%2584">ููุฌูุฉ</a> (DAGs).  ุณุชุณุงุนุฏู ุงูุฑุณูู ุงูุชูุถูุญูุฉ ุฃุฏูุงู ุนูู ููู ูุฐู ุงูููุฑุฉ ุจุดูู ุฃูุถู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/584/53d/52e/58453d52e9dfbd50dcc5b974ffae11e1.png"></div><br>  <i><font color="#999999">ุงูุฎุทูุฉ ุงูุญูููุฉ ุงูุฑุณู ุงูุจูุงูู</font></i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/3d7/a8d/810/3d7a8d81017d4112913a5c081c70b9a8.png"></div><br>  <i><font color="#999999">ุงูุฑุณู ุงูุจูุงูู ุงูุญูููุฉ ูุน ูุณุงุฑุงุช "ูุชูุงุฒูุฉ"</font></i> <br><br>  ุชูุซู ูู ุนูุฏุฉ ูู ุงูุฑุณู ุงูุจูุงูู ุฎุทูุฉ ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูู ุณูุฑ ุงูุนูู. <br><br>  ูู ูู ุฎุทูุฉ ูู ุณูุณูุฉ ุงูููุงู ุ ูููุฐ Metaflow ููุฏ Python ุงูุนุงุฏู ุฏูู ุฃู ุชุบููุฑุงุช ุฎุงุตุฉ.  ูุชู ุชูููุฐ ุงูููุฏ ูู ุญุงููุงุช ูููุตูุฉ ูุชู ูููุง ุชุนุจุฆุฉ ุงูููุฏ ูุน ุชุจุนูุงุชู. <br><br>  ูุชูุซู ุฃุญุฏ ุงูุฌูุงูุจ ุงูุฑุฆูุณูุฉ ูู ููุฏุณุฉ Metaflow ูู ุญูููุฉ ุฃูู ูุชูุญ ูู ุชูููุฐ ุฃู ููุชุจุงุช ุฎุงุฑุฌูุฉ ุชูุฑูุจูุง ูู ูุธุงู conda ุงูุจูุฆู ุฅูู ูุดุงุฑูุน ุชุนุชูุฏ ุนูููุง ุฏูู ุงุณุชุฎุฏุงู ุงูููููุงุช ุงูุฅุถุงููุฉ.  ูุฐุง ูููุฒ Metaflow ุนู ุญููู ุฃุฎุฑู ููุฃุบุฑุงุถ ุงูุนุงูุฉ ููุงุซูุฉ.  ุนูู ุณุจูู ุงููุซุงู - ูู Airflow. <br><br><h3 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">work ุณูุฑ ุนูู Metaflow ูู ุญูุซ ุงูุจุฑูุฌุฉ</font> </h3><br>  ูููู ุชูุซูู ูู ุณูุณูุฉ ููุงู (ุฏูู) ููุฆุฉ Python ููุงุณูุฉ (ุนุงุฏุฉู ูุง ุชุญุชูู ุฃุณูุงุก ูุฐู ุงููุฆุงุช ุนูู ูููุฉ <code>Flow</code> ) ุฅุฐุง ูุงูุช ุชูู ุจุงููุชุทูุจุงุช ุงูุฏููุง ุงูุชุงููุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงููุฆุฉ ูู ุณููู ูุฆุฉ <code>FlowSpec</code> . </li><li style=";text-align:right;direction:rtl">  ูู ูุธููุฉ ุชูุซู ุฎุทูุฉ ูู ุณูุณูุฉ ุงูููุงู ููุง <code>@step</code> ุงูุฏูููุฑ <code>@step</code> . </li><li style=";text-align:right;direction:rtl">  ูู ููุงูุฉ ูู ูุธููุฉ <code>@step</code> ุ ูุฌุจ ุฃู ูููู ููุงู ุฅุดุงุฑุฉ ุฅูู ูุธููุฉ ููุงุซูุฉ ุชุชุจุนูุง.  ูููู ุงูููุงู ุจุฐูู ุจุงุณุชุฎุฏุงู ุจููุฉ ูู ูุฐุง ุงูููุน: <code>self.next(self.function_name_here)</code> . </li><li style=";text-align:right;direction:rtl">  ูููุฐ ุงููุตู ูุธุงุฆู <code>start</code> <code>end</code> . </li></ul><br>  ุงููุธุฑ ูู ูุซุงู ุนูู ุณูุณูุฉ ูู ุงูููุงู ุงูุญุฏ ุงูุฃุฏูู ุชุชููู ูู ุซูุงุซ ููุงุท. <br><br>  ูุฎุทุทูุง ูุดุจู ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">start โ process_message โ end</code> </pre> <br>  ููุง ููุฏูุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> metaflow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FlowSpec, step <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LinearFlow</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(FlowSpec)</span></span></span><span class="hljs-class">:</span></span>         <span class="hljs-string"><span class="hljs-string">"""     ,      Metaflow.    """</span></span>       <span class="hljs-comment"><span class="hljs-comment">#         @step    def start(self):        self.message = 'Thanks for reading.'        self.next(self.process_message)    @step    def process_message(self):        print('the message is: %s' % self.message)        self.next(self.end)    @step    def end(self):        print('the message is still: %s' % self.message) if __name__ == '__main__':    LinearFlow()</span></span></code> </pre> <br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ุชุนูููุงุช ุชุฑููุจ Metaflow</font> </h2><br><h3 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">and ุงูุชุซุจูุช ูุงูุชุดุบูู ุงูุชุฌุฑูุจู</font> </h3><br>  ูููุง ููู ุชุณูุณู ุงูุฎุทูุงุช ุงูุชู ุชุญุชุงุฌ ุฅูู ุฅููุงููุง ูุชุซุจูุช Metaflow ูุชุดุบูููุง ูุฃูู ูุฑุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุซุจูุช Metaflow (ุจูุซูู 3 ูุณุชุญุณู): <code>pip3 install metaflow</code> . </li><li style=";text-align:right;direction:rtl">  ุถุน ุฌุฒุก ุงูุดูุฑุฉ ุฃุนูุงู ( <a href="https://gist.github.com/Viveckh/95a3348309b158adba062fa031b753a1">ููุง</a> ุนูู GitHub) ูู ููู <code>linear_flow.py</code> . </li><li style=";text-align:right;direction:rtl">  ูุฅููุงุก ูุธุฑุฉ ุนูู ุจููุฉ ุณูุณูุฉ ุงูููุงู ุงูุชู ุชููุฐูุง ูุฐู ุงูุดูุฑุฉ ุ ุงุณุชุฎุฏู ุฃูุฑ <code>python3 linear_flow.py show</code> . </li><li style=";text-align:right;direction:rtl">  ูุจุฏุก ุงูุฏูู ุ <code>python3 linear_flow.py run</code> . </li></ul><br>  ูุฌุจ ุฃู ุชุญุตู ุนูู ุดูุก ูุดุงุจู ููุง ูู ููุถุญ ุฃุฏูุงู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/281/5af/ec5/2815afec51573d8a01db3cd8b4ae19e0.png"></div><br>  <i><font color="#999999">ุงููุงุฌุญุฉ Metaflow ุงูุตุญุฉ ุชุญูู</font></i> <br><br>  ููุง ูุฌุฏุฑ ุงูุงูุชุจุงู ุฅูู ุจุนุถ ุงูุฃุดูุงุก.  ููุดุฆ ุฅุทุงุฑ ุนูู <code>.metaflow</code> ุจูุงูุงุช ูุญูู <code>.metaflow</code> .  ููุงู ุ ูููู ุจุชุฎุฒูู ุฌููุน ุงูุจูุงูุงุช ุงููุตููุฉ ุงููุชุนููุฉ ุจุชูููุฐ ุงูููุงู ูุงูููุทุงุช ุงููุฑุชุจุทุฉ ุจุฌูุณุงุช ุชูููุฐ ุงููููุฉ.  ุฅุฐุง ููุช ุจุชูููู ุฅุนุฏุงุฏุงุช Metaflow ุงููุชุนููุฉ ุจุงูุชุฎุฒูู ุงูุณุญุงุจู ุ ูุณูุชู ุชุฎุฒูู ุงูููุทุงุช ูู AWS S3 Bucket ุ ูุณุชุฐูุจ ุงูุจูุงูุงุช ุงููุตููุฉ ุงููุชุนููุฉ ุจุฅุทูุงู ุงูููุงู ุฅูู ุฎุฏูุฉ Metadata ุ ุงุณุชูุงุฏูุง ุฅูู RDS (ูุฎุฒู ุงูุจูุงูุงุช Relational ุ ููุฎุฒู ุงูุจูุงูุงุช ุงูุงุฑุชุจุงุทู).  ุณูุชุญุฏุซ ูุงุญููุง ุนู ููููุฉ ุงุณุชูุดุงู ูุฐู ุงูุจูุงูุงุช ุงูุชุนุฑูููุฉ ุจุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ุงูุนููู.  ุชุงูู ุขุฎุฑ ุ ุนูู ุงูุฑุบู ูู ุฃูููุชู ุ ูุงูุฐู ูุณุชุญู ุงูุงูุชูุงู ุจู ุ ูู ุฃู ูุนุฑูุงุช ุงูุนูููุฉ (ูุนุฑู ุงูููุชุฌ ุ ูุนุฑูุงุช ุงูุนูููุฉ) ุงููุฑุชุจุทุฉ ุจุงูุฎุทูุงุช ุงููุฎุชููุฉ ุชุฎุชูู.  ุชุฐูุฑ - ูููุง ุฃุนูุงู ุฃู Metaflow ุชููู ุจุดูู ูุณุชูู ุจุชุนุจุฆุฉ ูู ุฎุทูุฉ ูู ุณูุณูุฉ ุงูููุงู ูุชููุฐ ูู ุฎุทูุฉ ูู ุจูุฆุชูุง ุงูุฎุงุตุฉ (ุชูุฑูุฑ ุงูุจูุงูุงุช ููุท ุจูู ุงูุฎุทูุงุช). <br><br><h3 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">and ุชุซุจูุช ูุชูููู conda (ุฅุฐุง ููุช ุชุฎุทุท ูุชูููุฐ ุงูุชุจุนูุงุช)</font> </h3><br>  ุงุชุจุน ูุฐู ุงูุฎุทูุงุช ูุชุซุจูุช conda: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://docs.conda.io/en/latest/miniconda.html">ูู ุจุชูุฒูู</a> ูุชุซุจูุช Miniconda. </li><li style=";text-align:right;direction:rtl">  ุฅุถุงูุฉ <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/concepts/channels.html">ููุงุฉ</a> <code>conda config --add channels conda-forge</code> <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/concepts/channels.html">ูุน</a> ุงูุฃูุฑ <code>conda config --add channels conda-forge</code> . </li></ul><br>  ุฃูุช ุงูุขู ุฌุงูุฒ ูุชุถููู ุชุจุนูุงุช ูููุฏุง ูู ุณูุงุณู ุงูููุงู ุงูุฎุงุตุฉ ุจู.  ุณุชุชู ููุงูุดุฉ ุชูุงุตูู ูุฐู ุงูุนูููุฉ ุฃุฏูุงู. <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ูุซุงู ูุณูุฑ ุงูุนูู ุงููุงูุนู</font> </h2><br>  ุฃุนูุงู ุ ุชุญุฏุซูุง ุนู ููููุฉ ุชุซุจูุช Metaflow ุ ูููููุฉ ุงูุชุฃูุฏ ูู ุชุดุบูู ุงููุธุงู.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุงูุดูุง ุฃุณุงุณูุงุช ููุฏุณุฉ ุณูุฑ ุงูุนูู ููุธุฑูุง ุฅูู ูุซุงู ุจุณูุท.  ููุง ูููู ูุธุฑุฉ ุนูู ูุซุงู ุฃูุซุฑ ุชุนููุฏูุง ุ ุจูููุง ููุดู ุนู ุจุนุถ ููุงููู Metaflow. <br><br><h3 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">โZadanie</font> </h3><br>  ูู ุจุฅูุดุงุก ุณูุฑ ุนูู ุจุงุณุชุฎุฏุงู Metaflow ุงูุฐู ูููู ุจุชูููุฐ ุงููุธุงุฆู ุงูุชุงููุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุญููู ุจูุงูุงุช ูููู CSV ูู ุฅุทุงุฑ ุจูุงูุงุช Pandas. </li><li style=";text-align:right;direction:rtl">  ุญุณุงุจ ููุงุฒ ููุฑุจุงุนูุงุช ููุฃููุงุน. </li><li style=";text-align:right;direction:rtl">  ุญูุธ ุงููุงููุณ ูุน ูุชุงุฆุฌ ุงูุนูููุงุช ุงูุญุณุงุจูุฉ. </li></ul><br><h3 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">โ ุณูุณูุฉ ุงูููุงู</font> </h3><br>  ูุธูุฑ ุงููููู ุงูุนุธูู ูููุฆุฉ <code>GenreStatsFlow</code> .  ุจุนุฏ ุชุญููููุง ุ ุณุชููู ุฌููุฑ ุงูููุฌ ุงููุทุจู ููุง ูุญู ูุดููุชูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> metaflow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FlowSpec, step, catch, retry, IncludeFile, Parameter <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GenreStatsFlow</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(FlowSpec)</span></span></span><span class="hljs-class">:</span></span>  <span class="hljs-string"><span class="hljs-string">"""    ,  ,   .         :    1)  CSV-   Pandas.    2)     .    3)     .  """</span></span>   @step  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span>    <span class="hljs-string"><span class="hljs-string">"""         :        1)      Pandas.        2)    .        3)        .    """</span></span>       <span class="hljs-comment"><span class="hljs-comment"># </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment">  CSV         self.genres = []    self.next(self.compute_statistics, foreach='genres') #  1     @catch(var='compute_failed') #  2  @retry(times=1) #  3  @step  def compute_statistics(self):    """    .   ."""    self.genre = self.input #  4    # </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment">        self.next(self.join)     @step  def join(self, inputs):    """       ."""    # </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment">      self.next(self.end)     @step  def end(self):      """End the flow."""      pass   if __name__ == '__main__':  GenreStatsFlow()</span></span></code> </pre> <br>  ุงููุธุฑ ูู ุจุนุถ ุฃุฌุฒุงุก ูููุฉ ูู ูุฐุง ุงููุซุงู.  ุชุญุชูู ุงูููุฏ ุนูู ุชุนูููุงุช ุนูู ุงููููุฐุฌ <code>#  n</code> ุ ูุงูุฐู ุณูุดูุฑ ุฅููู ุฃุฏูุงู. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู <code> 1</code> ุ ูู ุฎุทูุฉ <code>start</code> ุ ุงูุชุจู ุฅูู ุงููุนููุฉ <code>foreach</code> .  ุจูุถูู ุ ูุชู <code>compute_statistics</code> ูุณุฎ ูู ุฎุทูุงุช <code>compute_statistics</code> <code>for each</code> ุญููุฉ <code>for each</code> ุฅุฏุฎุงู ูู ูุงุฆูุฉ <code>genres</code> . </li><li style=";text-align:right;direction:rtl">  ูู <code> 2</code> <code>@catch(var='compute_failed')</code> ูุตูู <code>@catch(var='compute_failed')</code> ุจุงููุจุถ ุนูู ุฃู ุงุณุชุซูุงุก <code>compute_statistics</code> ุฎุทูุฉ <code>compute_statistics</code> ุฅูู ุงููุชุบูุฑ <code>compute_failed</code> (ูููู ูุฑุงุกุชู ูู ุงูุฎุทูุฉ ุงูุชุงููุฉ). </li><li style=";text-align:right;direction:rtl">  ูู <code> 3</code> ูุตูู ุงูุฏูููุฑ <code>@retry(times=1)</code> ุจูุง ูููุญ ุงุณูู ุจุงูุถุจุท.  ููู ุนูุฏูุง ุชุญุฏุซ ุงูุฃุฎุทุงุก ุ ููุฑุฑ ูุฐู ุงูุฎุทูุฉ. </li><li style=";text-align:right;direction:rtl">  ูู ุฃูู ุฌุงุก <code> 4</code> ุ ูู <code>compute_statistics</code> ุ ูู <code>self.input</code> ุ  ุงูุดูุก ุ ูู <code>input</code> ูุชุบูุฑ ูุฆุฉ ุงูููุฏูุฉ ูู Metaflow.  ุฃูู ูุญุชูู ุนูู ุจูุงูุงุช ูุงุจูุฉ ููุชุทุจูู ุนูู ูุซูู ูุนูู ูู <code>compute_statistics</code> (ุนูุฏูุง ูููู ููุงู ูุณุฎ ูุชุนุฏุฏุฉ ูู ูุธููุฉ ุชููุฐ ุจุงูุชูุงุฒู).  ุชุชู ุฅุถุงูุฉ ูุฐุง ุงููุชุบูุฑ ุจูุงุณุทุฉ Metaflow ููุท ุนูุฏูุง ูุชู ุชูุซูู ุงูุนูุฏ ุจุนุฏุฉ ุนูููุงุช ูุชูุงุฒูุฉ ุ ุฃู ุนูุฏูุง ูุชู ุฏูุฌ ุนุฏุฉ ุนูุฏ. </li><li style=";text-align:right;direction:rtl">  ูููุง ููู ูุซุงู ุนูู ุชุดุบูู ููุณ ุงููุธููุฉ ุจุงูุชูุงุฒู - <code>compute_statistics</code> .  ููู ุ ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ููููู ุชุดุบูู ูุธุงุฆู ูุฎุชููุฉ ุชูุงููุง ูุง ุชุฑุชุจุท ุจุจุนุถูุง ุงูุจุนุถ.  ููููุงู ุจุฐูู ุ ูู ุจุชุบููุฑ ูุง ูุธูุฑ ูู <code> 1</code> ุฅูู ุดูุก ูุซู <code>self.next(self.func1, self.function2, self.function3)</code> .  ุจุงูุทุจุน ุ ูุน ูุฐุง ุงูููุฌ ุ ุณูููู ูู ุงูุถุฑูุฑู ุฅุนุงุฏุฉ ูุชุงุจุฉ ุฎุทูุฉ <code>join</code> ุฃูุถูุง ุ ููุง ูุชูุญ ูุนุงูุฌุฉ ูุชุงุฆุฌ ุงููุธุงุฆู ุงููุฎุชููุฉ ุนููู. </li></ul><br>  ุฅููู ููููุฉ ุชุฎูู ูุฆุฉ ุงููููู ุงูุนุธูู ุฃุนูุงู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/7af/b4b/d00/7afb4bd00f2cea2df0ebf9fff780b8d2.png"></div><br>  <i><font color="#999999">ุงูุชูุซูู ุงููุฑุฆู ูููุฆุฉ GenreStatsFlow</font></i> <br><br><h3 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">file ูุฑุงุกุฉ ููู ุงูุจูุงูุงุช ูููู ุงููุนููุงุช</font> </h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุจุชูุฒูู ููู ุงููููู CSV <a href="https://www.mediafire.com/file/g9vfu4xxqbs4h2o/movies.csv/file">ูุฐุง</a> . </li><li style=";text-align:right;direction:rtl">  ุฃูุช ุงูุขู ุจุญุงุฌุฉ ุฅูู ุชุฒููุฏ ุงูุจุฑูุงูุฌ ุจุฏุนู ูุฅููุงููุฉ ููู ุงููุณุงุฑ ุฅูู ููู <code>max_genres</code> ููููุฉ <code>max_genres</code> ุฅูู <code>max_genres</code> .  ุขููุฉ ุงูุญุฌุฌ ุงูุฎุงุฑุฌูุฉ ุณุชุณุงุนุฏูุง ูู ูุฐุง.  ูุชูุญ ูู Metaflow ุชูุฑูุฑ ุงููุณุงุฆุท ุฅูู ุงูุจุฑูุงูุฌ ุจุงุณุชุฎุฏุงู ุฅุดุงุฑุงุช ุฅุถุงููุฉ ูู ุฃูุฑ ุจุฏุก ุณูุฑ ุงูุนูู.  ุนูู ุณุจูู ุงููุซุงู ุ ูุฏ ูุจุฏู ูุงูุชุงูู: <code>python3 tutorial_flow.py run --movie_data=path/to/movies.csv --max_genres=5</code> . </li><li style=";text-align:right;direction:rtl">  ูููุญ Metaflow ูุทูุฑ IncludeFile ู <code>Parameter</code> ูููุงุฆูุงุช ุงูุชู ุชุชูุญ ูู ูุฑุงุกุฉ ุงูุฅุฏุฎุงู ูู ุฑูุฒ ุณูุฑ ุงูุนูู.  ูุดูุฑ ุฅูู ุงููุณุงุฆุท ุงูุชู ุชู ุชูุฑูุฑูุง ุนู ุทุฑูู ุชุนููู ูุงุฆูุงุช <code>IncludeFile</code> ู <code>Parameter</code> ููุชุบูุฑุงุช ุงููุฆุฉ.  ูุนุชูุฏ ุงูุฃูุฑ ุนูู ูุง ูุฑูุฏ ุฃู ููุฑุฃู ุจุงูุถุจุท - ุงูููู ุ ุฃู ุงููููุฉ ุงููุนุชุงุฏุฉ. </li></ul><br>  ุฅููู ููู ูุจุฏู ุงูุฑูุฒ ูู ูุฑุงุกุฉ ุงููุนููุงุช ุงูุชู ุชู ุชูุฑูุฑูุง ุฅูู ุงูุจุฑูุงูุฌ ุนูุฏูุง ุชู ุฅุทูุงูู ูู ุณุทุฑ ุงูุฃูุงูุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">    movie_data = IncludeFile(<span class="hljs-string"><span class="hljs-string">"movie_data"</span></span>,                             help=<span class="hljs-string"><span class="hljs-string">"The path to a movie metadata file."</span></span>,                             default = <span class="hljs-string"><span class="hljs-string">'movies.csv'</span></span>)                               max_genres = Parameter(<span class="hljs-string"><span class="hljs-string">'max_genres'</span></span>,                help=<span class="hljs-string"><span class="hljs-string">"The max number of genres to return statistics for"</span></span>,                default=<span class="hljs-number"><span class="hljs-number">5</span></span>)</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">cond ุฅุฏุฑุงุฌ ูููุฏุง ูู ุณูุณูุฉ ุงูููุงู</font> </h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูู ุชูู ูุฏ ููุช ุจุชุซุจูุช conda ุจุนุฏ ุ ูุฑุงุฌุน ุงููุณู ุงูุฎุงุต ุจุชุซุจูุช ูุชูููู conda ูู ูุฐู ุงูููุงูุฉ. </li><li style=";text-align:right;direction:rtl">  ุฃุถู <code>GenreStatsFlow</code> decorator ุงูููุฏูุฉ ูู Metaflow ุฅูู ูุฆุฉ GenreStatsFlow.  ูุชููุน ุฃู ูุญุตู ูุฐุง ุงูุฏูููุฑ ุนูู ุฅุตุฏุงุฑ ุงูุซุนุจุงู.  ูููู ุถุจุทู ุฅูุง ูู ุงูููุฏ ุ ุฃู ุงูุญุตูู ุนููู ุจุงุณุชุฎุฏุงู ูุธููุฉ ูุณุงุนุฏุฉ.  ุฃุฏูุงู ูู ุงูุฑูุฒ ุงูุฐู ููุถุญ ุงุณุชุฎุฏุงู ุงูุฏูููุฑ ููุธูุฑ ูุธููุฉ ุงููุณุงุนุฏ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">def get_python_version():    """     ,    python,       .         conda        python.    """    import platform    versions = {'2' : '2.7.15',                '3' : '3.7.4'}    return versions[platform.python_version_tuple()[0]] #       python. @conda_base(python=get_python_version()) class GenreStatsFlow(FlowSpec):</code> </pre> </li><li style=";text-align:right;direction:rtl">  ููููู ุงูุขู ุฅุถุงูุฉ <code>@conda</code> ุฅูู ุฃู ุฎุทูุฉ ูู ุณูุณูุฉ ุงูููุงู.  ุชุชููุน ูุงุฆููุง ุจุชุจุนูุงุช ูุชู ุชูุฑูุฑู ุฅููู ูู ุฎูุงู ูุนููุฉ <code>libraries</code> .  ุณูุชููู Metaflow ุ ูุจู ุจุฏุก ุงูุฎุทูุฉ ุ ูููุฉ ุฅุนุฏุงุฏ ุงูุญุงููุฉ ุจุงุณุชุฎุฏุงู ุงูุชุจุนูุงุช ุงููุญุฏุฏุฉ.  ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ููููู ุงุณุชุฎุฏุงู ุฅุตุฏุงุฑุงุช ูุฎุชููุฉ ูู ุงูุญุฒู ุจุฃูุงู ูู ุฎุทูุงุช ูุฎุชููุฉ ุ ุญูุซ ูููู Metaflow ุจุชุดุบูู ูู ุฎุทูุฉ ูู ุญุงููุฉ ูููุตูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">    @conda(libraries={'pandas' : '0.24.2'})    @step    def start(self):</span></span></code> </pre> </li><li style=";text-align:right;direction:rtl">  ุงูุขู ูู ุจุชูููุฐ ุงูุฃูุฑ ุงูุชุงูู: <code>python3 tutorial_flow.py --environment=conda run</code> . </li></ul><br><h3 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">implementationStep ุจุฏุงูุฉ ุงูุชูููุฐ</font> </h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@conda(libraries={'pandas' : '0.24.2'})    @step    def start(self):    """         :        1)      Pandas.        2)    .        3)        .    """        import pandas        from io import StringIO        #      Pandas.        self.dataframe = pandas.read_csv(StringIO(self.movie_data))        #   'genres'      .         #   .        self.genres = {genre for genres \                       in self.dataframe['genres'] \                       for genre in genres.split('|')}        self.genres = list(self.genres)        #        .        #  'foreach'             #          self.next(self.compute_statistics, foreach='genres')</span></span></code> </pre> <br>  ุงููุธุฑ ูู ุจุนุถ ุงูููุฒุงุช ูู ูุฐุง ุงูุฑูุฒ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุงุญุธ ุฃู ุชุนุจูุฑ ุงุณุชูุฑุงุฏ ุงูุจุงูุฏุง ููุฌูุฏ ุฏุงุฎู ุงููุธููุฉ ุงูุชู ุชุตู ุงูุฎุทูุฉ.  ูุงูุญูููุฉ ูู ุฃู ูุฐุง ุงูุงุนุชูุงุฏ ูุชู ุชูุฏููู ุจูุงุณุทุฉ conda ููุท ูู ูุทุงู ูุฐู ุงูุฎุทูุฉ. </li><li style=";text-align:right;direction:rtl">  ููู ุงููุชุบูุฑุงุช ุงููุนููุฉ ููุง ( <code>dataframe</code> <code>genres</code> ) ูุชููุฑุฉ ุญุชู ูู ุฑูุฒ ุงูุฎุทูุงุช ุงูููุฌุฒุฉ ุจุนุฏ ูุฐู ุงูุฎุทูุฉ.  ุงูููุทุฉ ุงููููุฉ ูู ุฃู Metaflow ุชุนูู ุนูู ุฃุณุงุณ ูุจุงุฏุฆ ูุตู ุจูุฆุงุช ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ูููููุง ุชุชูุญ ููู ุงูุจูุงูุงุช ุจุดูู ุทุจูุนู ุจูู ุฎุทูุงุช ุณูุณูุฉ ุงูููุงู. </li></ul><br><h3 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">โ ุชูููุฐ ุฎุทูุฉ ุงูุญูุณุจุฉ ุงูุฅุญุตุงุฆูุฉ</font> </h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@catch(var='compute_failed')    @retry    @conda(libraries={'pandas' : '0.25.3'})    @step    def compute_statistics(self):        """            .        """        #             # 'input'.        self.genre = self.input        print("Computing statistics for %s" % self.genre)        #         ,         #        .        selector = self.dataframe['genres'].\                   apply(lambda row: self.genre in row)        self.dataframe = self.dataframe[selector]        self.dataframe = self.dataframe[['movie_title', 'genres', 'gross']]        #     gross   .        points = [.25, .5, .75]        self.quartiles = self.dataframe['gross'].quantile(points).values        #  ,    .        self.next(self.join)</span></span></code> </pre> <br>  ูุฑุฌู ููุงุญุธุฉ ุฃููุง ูู ูุฐู ุงูุฎุทูุฉ ูุดูุฑ ุฅูู ูุชุบูุฑ <code>dataframe</code> ุงูุฐู ุชู ุฅุนูุงูู ูู ุฎุทูุฉ <code>start</code> ุงูุณุงุจูุฉ.  ูุญู ูููู ุจุชุนุฏูู ูุฐุง ุงููุชุบูุฑ.  ุนูุฏ ุงูุงูุชูุงู ุฅูู ุงูุฎุทูุงุช ุงูุชุงููุฉ ุ ูุชูุญ ูู ูุฐุง ุงูููุฌ ุ ุงูุฐู ูุชุถูู ุงุณุชุฎุฏุงู ูุงุฆู <code>dataframe</code> ุฌุฏูุฏ ูุนุฏูู ุ ุชูุธูู ุงูุนูู ุงููุนุงู ูุน ุงูุจูุงูุงุช. <br><br><h3 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">โ ุชุทุจูู ุฎุทูุฉ ุงูุฑุจุท</font> </h3><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@conda(libraries={'pandas' : '0.25.3'})    @step    def join(self, inputs):        """               .        """        inputs = inputs[0:self.max_genres]        #   ,    .        self.genre_stats = {inp.genre.lower(): \                            {'quartiles': inp.quartiles,                             'dataframe': inp.dataframe} \                            for inp in inputs}        self.next(self.end)</span></span></code> </pre> <br>  ููุง ูุณุชุญู ุชุณููุท ุงูุถูุก ุนูู ุจุถุน ููุงุท: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ูุฐู ุงูุฎุทูุฉ ุ ูุณุชุฎุฏู ุฅุตุฏุงุฑูุง ูุฎุชูููุง ุชูุงููุง ูู ููุชุจุฉ ุงูุจุงูุฏุง. </li><li style=";text-align:right;direction:rtl">  ูู ุนูุตุฑ ูู ุตููู <code>inputs</code> ูู ูุณุฎุฉ ูู <code>compute_statistics</code> ุงููููุฐุฉ ุณุงุจููุง.  ุฃูู ูุญุชูู ุนูู ุญุงูุฉ ุชุดุบูู ุงูุฏุงูุฉ ุงูููุงุจูุฉ ุ ุฃู ููู ุงููุชุบูุฑุงุช ุงููุฎุชููุฉ.  ูุฐูู ุ ูููู ุฃู ุชุญุชูู <code>input[0].quartiles</code> ุนูู <code>input[0].quartiles</code> ูููุน <code>comedy</code> ุ ููููู ุฃู ุชุญุชูู <code>input[1].quartiles</code> <code>input[0].quartiles</code> ุนูู ุฑุจุงุนูุงุช ูููุน <code>sci-fi</code> . </li></ul><br><h3 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">draft ูุณูุฏุฉ ุฌุงูุฒุฉ</font> </h3><br>  ูููู ุงูุนุซูุฑ ุนูู ุฑูุฒ ุงููุดุฑูุน ุงููุงูู ุงูุฐู ุงุณุชุนุฑุถูุงู ููุชู <a href="https://github.com/Viveckh/metaflow_crash_course_prep/blob/master/tutorial_flow.py">ููุง</a> . <br><br>  ูู ุฃุฌู ุฅููุงุก ูุธุฑุฉ ุนูู ููููุฉ ุณูุฑ ุงูุนูู ุงูููุถุญ ูู ููู <code>tutorial_flow.py</code> ุ ุชุญุชุงุฌ ุฅูู ุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">python3 tutorial_flow.py --environment=conda show</code> </pre> <br>  ุงุณุชุฎุฏู ุงูุฃูุฑ ุงูุชุงูู ูุจุฏุก ุณูุฑ ุงูุนูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">python3 tutorial_flow.py --environment=conda run --movie_data=path/to/movies.csv --max_genres=<span class="hljs-number"><span class="hljs-number">7</span></span></code> </pre> <br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ูุญุต ูุชุงุฆุฌ ุชุดุบูู ุณูุฑ ุงูุนูู ุจุงุณุชุฎุฏุงู API ุงูุนููู</font> </h2><br>  ูู ุฃุฌู ูุญุต ููุทุงุช ุงูุจูุงูุงุช ูุญุงูุฉ ุนูููุงุช ุงูุฅุทูุงู ุงูุณุงุจูุฉ ูุณูุฑ ุงูุนูู ุ ููููู ุงุณุชุฎุฏุงู <a href="https://docs.metaflow.org/metaflow/client">ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช</a> ุงูุนููู ุงูููุฏูุฉ ูู Metaflow.  ุชุนุฏ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุฐู ูุซุงููุฉ ูุงุณุชูุดุงู ุชูุงุตูู ุงูุชุฌุงุฑุจ ุงูุชู ุฃุฌุฑูุช ูู ุจูุฆุฉ Jupyter Notebook. <br><br>  ูููุง ููู ูุซุงู ุจุณูุท ูุฅุฎุฑุงุฌ ุงููุชุบูุฑ <code>genre_stats</code> ุ ูุฃุฎูุฐ ูู ุจูุงูุงุช ุขุฎุฑ ุฅุทูุงู ูุงุฌุญ ูู <code>GenreStatsFlow</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> metaflow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Flow, get_metadata <span class="hljs-comment"><span class="hljs-comment">#      print("Using metadata provider: %s" % get_metadata()) #     MovieStatsFlow. run = Flow('GenreStatsFlow').latest_successful_run print("Using analysis from '%s'" % str(run)) genre_stats = run.data.genre_stats print(genre_stats)</span></span></code> </pre> <br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ุชุดุบูู ุณูุฑ ุงูุนูู ูู ุงูุณุญุงุจุฉ</font> </h2><br>  ุจุนุฏ ููุงูู ุจุฅูุดุงุก ุณูุฑ ุงูุนูู ูุงุฎุชุจุงุฑู ุนูู ุฌูุงุฒ ููุจููุชุฑ ุนุงุฏู ุ ูู ุงููุญุชูู ุฃูู ุชุฑูุฏ ุชุดุบูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู ุงูุณุญุงุจุฉ ูุชุณุฑูุน ุงูุนูู. <br><br>  ุญุงูููุง ุ ูุฏุนู Metaflow ุงูุชูุงูู ูุน AWS ููุท.  ูู ุงูุตูุฑุฉ ุงูุชุงููุฉ ุ ููููู ุฑุคูุฉ ููุงุธุฑุฉ ููููุงุฑุฏ ุงูุณุญุงุจูุฉ ุงููุญููุฉ ูุงููุณุชุฎุฏูุฉ ุจูุงุณุทุฉ Metaflow. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/08a/acc/458/08aacc458fc3202ec08624422bef0cb4.png"></div><br>  <i><font color="#999999">Metaflow ูุงูุชูุงูู AWS</font></i> <br><br>  ูุชูุตูู Metaflow ุจู AWS ุ ูุฌุจ ุนููู ุฅููุงู ุงูุฎุทูุงุช ุงูุชุงููุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุญุชุงุฌ ุฃููุงู ุฅูู ุงูููุงู ุจุฅุนุฏุงุฏ AWS ููุฑุฉ ูุงุญุฏุฉ ุนู ุทุฑูู ุฅูุดุงุก ููุงุฑุฏ ูููู ุฃู ูุนูู ูุนูุง Metaflow.  ูููู ุงุณุชุฎุฏุงู ููุณ ุงูููุงุฑุฏ ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู ูุจู ุฃุนุถุงุก ูุฑูู ุงูุนูู ุงูุฐูู ููุถุญูู ูุจุนุถูู ุงูุจุนุถ ูุชุงุฆุฌ ุณูุฑ ุงูุนูู.  <a href="https://docs.metaflow.org/metaflow-on-aws/deploy-to-aws">ููููู</a> ุงูุนุซูุฑ ุนูู ุงูุชุนูููุงุช ุฐุงุช ุงูุตูุฉ ููุง.  ุงูุฅุนุฏุงุฏุงุช ุณุฑูุนุฉ ุจูุง ูููู ุ ูุฃู Metaflow ูุญุชูู ุนูู ูุงูุจ ุฅุนุฏุงุฏุงุช CloudFormation. </li><li style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ุนูู ุงูููุจููุชุฑ ุงููุญูู ุ ุชุญุชุงุฌ ุฅูู ุชุดุบูู <code>metaflow configure aws</code> ูุฅุฏุฎุงู ุฅุฌุงุจุงุช ุนูู ุฃุณุฆูุฉ ุงููุธุงู.  ุจุงุณุชุฎุฏุงู ูุฐู ุงูุจูุงูุงุช ุ ุณูุชููู Metaflow ูู ุงุณุชุฎุฏุงู ูุณุชูุฏุนุงุช ุงูุจูุงูุงุช ุงููุณุชูุฏุฉ ุฅูู ูุฌููุนุฉ ุงููุธุฑุงุก. </li><li style=";text-align:right;direction:rtl">  ุงูุขู ุ ูุจุฏุก ุณูุฑ ุงูุนูู ุงููุญูู ูู ุงูุณุญุงุจุฉ ุ ูุง ุนููู ุณูู ุฅุถุงูุฉ ููุชุงุญ <code>--with batch</code> ุฅูู <code>--with batch</code> ุจุฏุก ุณูุฑ ุงูุนูู.  ุนูู ุณุจูู ุงููุซุงู ุ ูุฏ ูุจุฏู ูุงูุชุงูู: <code>python3 sample_flow.py run --with batch</code> . </li><li style=";text-align:right;direction:rtl">  ูู ุฃุฌู ุงูููุงู ุจุฅุทูุงู ูุฎุชูุท ูุณูุฑ ุงูุนูู ุ ุฃู ุงูููุงู ุจุจุนุถ ุงูุฎุทูุงุช ูุญูููุง ุ ูุจุนุถูุง ูู ุงูุณุญุงุจุฉ ุ ุชุญุชุงุฌ ุฅูู ุฅุถุงูุฉ <code>@batch</code> decorator ุฅูู ุชูู ุงูุฎุทูุงุช ุงูุชู ููุฒู ุชูููุฐูุง ูู ุงูุณุญุงุจุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุซู ูุฐุง: <code>@batch(cpu=1, memory=500)</code> . </li></ul><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ุงููุชุงุฆุฌ</font> </h2><br>  ููุง ุ ุฃูุฏ ุฃู ุฃุดูุฑ ุฅูู ุจุนุถ ููุฒุงุช Metaflow ุงูุชู ูููู ุงุนุชุจุงุฑูุง ูุฒุงูุง ูุนููุจ ูุฐุง ุงูุฅุทุงุฑ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชู ุฏูุฌ Metaflow ุจุฅุญูุงู ูุน AWS.  ูููู ูู ุฎุทุท ุชุทููุฑ ุงูุฅุทุงุฑ ุ ููุฌุฏ ุฏุนู ูุนุฏุฏ ุฃูุจุฑ ูู ูููุฑู ุงูุฎุฏูุงุช ุงูุณุญุงุจูุฉ. </li><li style=";text-align:right;direction:rtl">  Metaflow ูู ุฃุฏุงุฉ ุชุฏุนู ูุงุฌูุฉ ุณุทุฑ ุงูุฃูุงูุฑ ููุท.  ูุง ูุญุชูู ุนูู ูุงุฌูุฉ ุฑุณูููุฉ (ุนูู ุนูุณ ุงูุฃุทุฑ ุงูุนุงูููุฉ ุงูุฃุฎุฑู ูุชูุธูู ุนูููุงุช ุงูุนูู ุ ูุซู Airflow). </li></ul><br>  <b>ุฃุนุฒุงุฆู ุงููุฑุงุก!</b>  ูู ุชุฎุทุท ูุงุณุชุฎุฏุงู Metaflowุ <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar482462/">https://habr.com/ru/post/ar482462/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar482450/index.html">ููุช MVP ูุชุตุจุญ ููุชุฌูุง ุฃู ุชุฌุฑุจุชู ูุน MVP ูู ุนุงู 2019</a></li>
<li><a href="../ar482452/index.html">ุงููุธุงู ุงูุจุฑุงุฒููู ููุณ ุฎุฑุงูุฉ. ููููุฉ ุงุณุชุฎุฏุงููุง ูู ุชูููููุฌูุง ุงููุนูููุงุชุ</a></li>
<li><a href="../ar482456/index.html">FunCode ูุฏููุง ุ ุฃู ููู ุนูุฏูุง ูุณุงุจูุฉ ููุทูุฑู iOS</a></li>
<li><a href="../ar482458/index.html">5 ููุฒุงุช ุจูุซูู ูู ุฃูู ุฃุนุฑููุง - ูููู ุฏูู ุฌุฏูู</a></li>
<li><a href="../ar482460/index.html">SQL HowTo: ุฑุณู ุฃููุงุท ูุงุชุฑุฉ ูู SQL</a></li>
<li><a href="../ar482464/index.html">ูุง ูู * args ู ** kwargs ูู ุจูุซููุ</a></li>
<li><a href="../ar482466/index.html">5 ุฃุดูุงุก ููููู ุงูููุงู ุจูุง ููุชุญุถูุฑ ูู Vue 3.0</a></li>
<li><a href="../ar482468/index.html">5 ุงูุชุฏุงุฏุงุช ูุณูุงุช ูู VS Code ูููููุง ุชุบููุฑ ุญูุงุฉ ูุทูุฑ ุงููุงุฌูุฉ ุงูุฃูุงููุฉ</a></li>
<li><a href="../ar482472/index.html">ูุง ูู ุฌุงูุง ุณูุฑูุจุช ูุตููุนุฉ ููุ</a></li>
<li><a href="../ar482476/index.html">ActivityLifecycleCallbacks - ููุทุฉ ุนููุงุก ูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูุนุงูุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>