<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>โฌ๏ธ ๐ง๐พ ๐ง๐ฝ Keras ุงููุธูููุฉ API ูู TensorFlow ๐ฉ๐ผโ๐พ ๐๐ฟ ๐ผ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุญุชูู Keras ุนูู ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (APIs) ูุจูุงุก ุจููุฉ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุจุณุฑุนุฉ ูุชุชุงุจุนุฉ ููุธูููุฉ. ุฅุฐุง ูุงู ุงูุฃูู ูุณูุญ ูู ุจุจูุงุก ุฃุจููุฉ ูุชุณูุณูุฉ ููุท ููุดุจูุงุช ุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Keras ุงููุธูููุฉ API ูู TensorFlow</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483664/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/w1/zr/n8/w1zrn8ydafoxahso_ig7vx1stfg.png"><br><br>  ูุญุชูู Keras ุนูู ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (APIs) ูุจูุงุก ุจููุฉ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุจุณุฑุนุฉ ูุชุชุงุจุนุฉ ููุธูููุฉ.  ุฅุฐุง ูุงู ุงูุฃูู ูุณูุญ ูู ุจุจูุงุก ุฃุจููุฉ ูุชุณูุณูุฉ ููุท ููุดุจูุงุช ุงูุนุตุจูุฉ ุ ูุนูุฏุฆุฐู ุจุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงููุธูููุฉ ุ ููููู ุชุญุฏูุฏ ุดุจูุฉ ุนุตุจูุฉ ูู ุดูู ุฑุณู ุจูุงูู ุชุนุณูู ููุฌู ุ ูุงูุฐู ูููุฑ ูุฑุตูุง ุฃูุจุฑ ุจูุซูุฑ ูุจูุงุก ููุงุฐุฌ ูุนูุฏุฉ.  ูุฐู ุงูููุงูุฉ ูู ุชุฑุฌูุฉ ูุฏููู ูุธุงุฆู API ุงููุธูููุฉ ูู ูููุน TensorFlow. <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ููุฏูุฉ </h2><br>  ุชุชูุญ ูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงููุธูููุฉ ุฅูุดุงุก ููุงุฐุฌ ุจูุฑููุฉ ุฃูุซุฑ ูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Sequential ุ ุญูุซ ูููููุง ูุนุงูุฌุฉ ุงูููุงุฐุฌ ุจุงุณุชุฎุฏุงู ุทูุจูููุฌูุง ุบูุฑ ุฎุทูุฉ ุ ูููุงุฐุฌ ุฐุงุช ุทุจูุงุช ุดุงุฆุนุฉ ุ ูููุงุฐุฌ ุฐุงุช ูุฏุฎูุงุช ุฃู ูุฎุฑุฌุงุช ูุชุนุฏุฏุฉ. <br><br>  ูุนุชูุฏ ุฐูู ุนูู ุญูููุฉ ุฃู ูููุฐุฌ ุงูุชุนูู ุงูุนููู ูู ุนุงุฏุฉ ุฑุณู ุจูุงูู ููุฌู (DAG) ูู ุงูุทุจูุงุช <br><br>  API ุงููุธูููุฉ ูู ูุฌููุนุฉ ูู ุงูุฃุฏูุงุช <b>ูุฑุณู ุงูุทุจูุงุช</b> . <br><br>  ุงููุธุฑ ูู ุงููููุฐุฌ ุงูุชุงูู: <br><br><blockquote style=";text-align:right;direction:rtl">  (ุงููุฏุฎูุงุช: 784 ูุงููุงุช ุงูุฃุจุนุงุฏ) <br>  โง <br>  [ุทุจูุฉ ูุซููุฉ (64 ุนูุตุฑูุง ุ ุชูุดูุท relu)] <br>  โง <br>  [ุทุจูุฉ ูุซููุฉ (64 ุนูุตุฑูุง ุ ุชูุดูุท relu)] <br>  โง <br>  [ุทุจูุฉ ูุซููุฉ (10 ุนูุงุตุฑ ุ ุชูุนูู softmax)] <br>  โง <br>  (ุงูุฅุฎุฑุงุฌ: ุชูุฒูุน ุงูุงุญุชูุงูุงุช ุนูู 10 ูุตูู) </blockquote>  ูุฐุง ุฑุณู ุจูุงูู ุจุณูุท ูููู ูู 3 ุทุจูุงุช. <br><br>  ูุฅูุดุงุก ูุฐุง ุงููููุฐุฌ ุจุงุณุชุฎุฏุงู API Functional ุ ูุฌุจ ุฃู ุชุจุฏุฃ ุจุฅูุดุงุก ุนูุฏุฉ ุฅุฏุฎุงู: <br><br><pre style=";text-align:right;direction:rtl"><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> keras inputs = keras.Input(shape=(<span class="hljs-number"><span class="hljs-number">784</span></span>,))</code> </pre> <br>  ูุญู ููุง ูุดูุฑ ุจุจุณุงุทุฉ ุฅูู ุฃุจุนุงุฏ ุจูุงูุงุชูุง: ูุงููุงุช ุงูุฃุจุนุงุฏ 784.  ูุฑุฌู ููุงุญุธุฉ ุฃู ูููุฉ ุงูุจูุงูุงุช ูุชู ุญุฐููุง ุฏุงุฆููุง ุ ููุดูุฑ ููุท ุฅูู ุจูุนุฏ ูู ุนูุตุฑ.  ูุฅุฏุฎุงู ุงูุญุฌู ุงููุฎุตุต ููุตูุฑ `(32 ุ 32 ุ 3)` ุ ูุณุชุฎุฏู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">img_inputs = keras.Input(shape=(<span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>))</code> </pre> <br>  ุชุญุชูู <code>inputs</code> ุนูู ูุนูููุงุช ุญูู ุญุฌู ูููุน ุงูุจูุงูุงุช ุงูุชู ุชุฎุทุท ูููููุง ุฅูู ุงููููุฐุฌ ุงูุฎุงุต ุจู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">inputs.shape</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">TensorShape([<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-number"><span class="hljs-number">784</span></span>])</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">inputs.dtype</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">tf.float32</code> </pre> <br>  ููููู ุฅูุดุงุก ุนูุฏุฉ ุฌุฏูุฏุฉ ูู ุงูุฑุณู ุงูุจูุงูู ููุทุจูุฉ ุนู ุทุฑูู ุงุณุชุฏุนุงุก ุงูุทุจูุฉ ุนูู ูุงุฆู <code>inputs</code> ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tensorflow.keras <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> layers dense = layers.Dense(<span class="hljs-number"><span class="hljs-number">64</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>) x = dense(inputs)</code> </pre> <br>  ูุดุจู "ุงุณุชุฏุนุงุก ุทุจูุฉ" ุฑุณู ุณูู ูู "ุงูุฅุฏุฎุงู" ูู ุงูุทุจูุฉ ุงูุชู ุฃูุดุฃูุงูุง.  ูุญู "ููุฑุฑ" ุงููุฏุฎูุงุช ุฅูู ุงูุทุจูุฉ <code>dense</code> ุ ููุญุตู ุนูู <code>x</code> . <br><br>  ุฏุนูุง ูุถูู ุจุนุถ ุงูุทุจูุงุช ุฅูู ุงูุฑุณู ุงูุจูุงูู ููุทุจูุฉ ูุฏููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">x = layers.Dense(<span class="hljs-number"><span class="hljs-number">64</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) outputs = layers.Dense(<span class="hljs-number"><span class="hljs-number">10</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'softmax'</span></span>)(x)</code> </pre> <br>  ุงูุขู ูููููุง ุฅูุดุงุก <code>Model</code> ุชุญุฏูุฏ ูุฏุฎูุงุชู ููุฎุฑุฌุงุชู ูู ุงูุฑุณู ุงูุจูุงูู ููุทุจูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model = keras.Model(inputs=inputs, outputs=outputs)</code> </pre> <br>  ุฏุนูุง ููุธุฑ ูุฑุฉ ุฃุฎุฑู ุฅูู ุนูููุฉ ุชุนุฑูู ุงููููุฐุฌ ุงููุงููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">inputs = keras.Input(shape=(<span class="hljs-number"><span class="hljs-number">784</span></span>,), name=<span class="hljs-string"><span class="hljs-string">'img'</span></span>) x = layers.Dense(<span class="hljs-number"><span class="hljs-number">64</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(inputs) x = layers.Dense(<span class="hljs-number"><span class="hljs-number">64</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) outputs = layers.Dense(<span class="hljs-number"><span class="hljs-number">10</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'softmax'</span></span>)(x) model = keras.Model(inputs=inputs, outputs=outputs, name=<span class="hljs-string"><span class="hljs-string">'mnist_model'</span></span>)</code> </pre> <br>  ููุฑู ููู ูุจุฏู ููุฎุต ุงููููุฐุฌ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model.summary()</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">Model: <span class="hljs-string"><span class="hljs-string">"mnist_model"</span></span> _________________________________________________________________ Layer (type) Output Shape Param <span class="hljs-comment"><span class="hljs-comment"># ================================================================= img (InputLayer) [(None, 784)] 0 _________________________________________________________________ dense_3 (Dense) (None, 64) 50240 _________________________________________________________________ dense_4 (Dense) (None, 64) 4160 _________________________________________________________________ dense_5 (Dense) (None, 10) 650 ================================================================= Total params: 55,050 Trainable params: 55,050 Non-trainable params: 0 _________________________________________________________________</span></span></code> </pre> <br>  ูููููุง ุฃูุถูุง ุฑุณู ุงููููุฐุฌ ูุฑุณู ุจูุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">keras.utils.plot_model(model, <span class="hljs-string"><span class="hljs-string">'my_first_model.png'</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/oq/4o/vl/oq4ovlxewr3hxczaldchmbeyfua.png" alt="ุตูุฑุฉ"><br><br>  ูุงุฎุชูุงุฑููุง ุงุดุชูุงู ุฃุจุนุงุฏ ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช ููู ุทุจูุฉ ุนูู ุงูุฑุณู ุงูุจูุงูู ุงููุจูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">keras.utils.plot_model(model, <span class="hljs-string"><span class="hljs-string">'my_first_model_with_shape_info.png'</span></span>, show_shapes=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/fn/rm/hc/fnrmhcqknnsjdcgmqp9w6dpong8.png" alt="ุตูุฑุฉ"><br><br>  ูุฐู ุงูุตูุฑุฉ ูุงูุฑูุฒ ุงูุฐู ูุชุจูุงู ูุชุทุงุจูุงู.  ูู ุฅุตุฏุงุฑ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ูุชู ุงุณุชุจุฏุงู ุฃุณูู ุงูุฑุจุท ุจุจุณุงุทุฉ ุนู ุทุฑูู ุนูููุงุช ุงูุงุชุตุงู. <br><br>  "ุงูุฑุณู ุงูุจูุงูู ููุทุจูุฉ" ูู ุตูุฑุฉ ุฐูููุฉ ุจุฏูููุฉ ููุบุงูุฉ ููููุฐุฌ ุงูุชุนูู ุงูุนููู ุ ููุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงููุธูููุฉ ูู ุทุฑููุฉ ูุฅูุดุงุก ููุงุฐุฌ ุชุนูุณ ูุฐู ุงูุตูุฑุฉ ุงูุฐูููุฉ ุนู ูุซุจ. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุชุฏุฑูุจ ูุงูุชูููู ูุงูุงุณุชูุชุงุฌ </h2><br>  ุชุนูู ุงูุนูู ูุชููููู ูุงุณุชุฎูุงุตู ููููุงุฐุฌ ุงููุตููุฉ ุจุงุณุชุฎุฏุงู API ุงููุธูููุฉ ุชูุงููุง ููุง ูู ุงูููุงุฐุฌ ุงูุชุณูุณููุฉ. <br><br>  ุงููุธุฑ ูู ุนุฑุถ ุณุฑูุน. <br><br>  ูุญู ููุง ูููู ุจุชุญููู ูุฌููุนุฉ ุจูุงูุงุช ุงูุตูุฑ MNIST ุ ููุญูููุง ุฅูู ูุชุฌูุงุช ุ ููููู ุจุชุฏุฑูุจ ุงููููุฐุฌ ุนูู ุงูุจูุงูุงุช (ูุน ูุฑุงูุจุฉ ุฌูุฏุฉ ุงูุนูู ูู ุนููุฉ ุงูุงุฎุชุจุงุฑ) ุ ูุฃุฎูุฑุงู ูููู ุจุชูููู ูููุฐุฌูุง ุนูู ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">(x_train, y_train), (x_test, y_test) = keras.datasets.mnist.load_data() x_train = x_train.reshape(<span class="hljs-number"><span class="hljs-number">60000</span></span>, <span class="hljs-number"><span class="hljs-number">784</span></span>).astype(<span class="hljs-string"><span class="hljs-string">'float32'</span></span>) / <span class="hljs-number"><span class="hljs-number">255</span></span> x_test = x_test.reshape(<span class="hljs-number"><span class="hljs-number">10000</span></span>, <span class="hljs-number"><span class="hljs-number">784</span></span>).astype(<span class="hljs-string"><span class="hljs-string">'float32'</span></span>) / <span class="hljs-number"><span class="hljs-number">255</span></span> model.compile(loss=<span class="hljs-string"><span class="hljs-string">'sparse_categorical_crossentropy'</span></span>, optimizer=keras.optimizers.RMSprop(), metrics=[<span class="hljs-string"><span class="hljs-string">'accuracy'</span></span>]) history = model.fit(x_train, y_train, batch_size=<span class="hljs-number"><span class="hljs-number">64</span></span>, epochs=<span class="hljs-number"><span class="hljs-number">5</span></span>, validation_split=<span class="hljs-number"><span class="hljs-number">0.2</span></span>) test_scores = model.evaluate(x_test, y_test, verbose=<span class="hljs-number"><span class="hljs-number">2</span></span>) print(<span class="hljs-string"><span class="hljs-string">'Test loss:'</span></span>, test_scores[<span class="hljs-number"><span class="hljs-number">0</span></span>]) print(<span class="hljs-string"><span class="hljs-string">'Test accuracy:'</span></span>, test_scores[<span class="hljs-number"><span class="hljs-number">1</span></span>])</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  ุงูุงุฏุฎุงุฑ ูุงูุชุณูุณู </h2><br>  ูุนูู ุญูุธ ุงูููุงุฐุฌ ุงููุชุณูุณูุฉ ุจุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงููุธูููุฉ ูุชุณูุณููุง ุชูุงููุง ููุง ูู ุงูุญุงู ูุน ุงูููุงุฐุฌ ุงูุชุณูุณููุฉ. <br><br>  ุชุชูุซู ุงูุทุฑููุฉ ุงูููุงุณูุฉ ูุญูุธ ุงููููุฐุฌ ุงููุธููู ูู ุงุณุชุฏุนุงุก <code>model.save(</code> ) ุ ูุงูุฐู ูุณูุญ ูู ุจุญูุธ ุงููููุฐุฌ ุจุฃูููู ูู ููู ูุงุญุฏ. <br><br>  ููููู ูููุง ุจุนุฏ ุงุณุชุนุงุฏุฉ ููุณ ุงููููุฐุฌ ูู ูุฐุง ุงูููู ุ ุญุชู ุฅุฐุง ูู ูุนุฏ ุจุฅููุงูู ุงููุตูู ุฅูู ุงูููุฏ ุงูุฐู ุฃูุดุฃ ุงููููุฐุฌ. <br><br>  ูุชุถูู ูุฐุง ุงูููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุนูุงุฑุฉ ุงููููุฐุฌูุฉ </li><li style=";text-align:right;direction:rtl">  ุงูุฃูุฒุงู ุงููููุฐุฌูุฉ (ุงูุชู ุชู ุงูุญุตูู ุนูููุง ุฃุซูุงุก ุงูุชุฏุฑูุจ) </li><li style=";text-align:right;direction:rtl">  ุงูุชูููู ุงูุชุฏุฑูุจ ุงููููุฐุฌู (ูุง ูุฑุช ูู <code>compile</code> ) </li><li style=";text-align:right;direction:rtl">  ุงูููุญุณูู ูุญุงูุชู ุ ุฅุฐุง ูุงู (ูุฐุง ูุณูุญ ูู ุจุงุณุชุฆูุงู ุงูุชุฏุฑูุจ ูู ุญูุซ ุชูููุช) </li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model.save(<span class="hljs-string"><span class="hljs-string">'path_to_my_model.h5'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">del</span></span> model <span class="hljs-comment"><span class="hljs-comment"># Recreate the exact same model purely from the file: model = keras.models.load_model('path_to_my_model.h5')</span></span></code> </pre><br><h2 style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏุงู ููุณ ุทุจูุฉ ุงูุฑุณู ุงูุจูุงูู ูุชุนุฑูู ููุงุฐุฌ ูุชุนุฏุฏุฉ </h2><br>  ูู API ุงููุธูููุฉ ุ ูุชู ุฅูุดุงุก ุงูููุงุฐุฌ ุนู ุทุฑูู ุชุญุฏูุฏ ุจูุงูุงุช ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช ูู ุฑุณู ุจูุงูู ููุทุจูุฉ.  ูุฐุง ูุนูู ุฃูู ูููู ุงุณุชุฎุฏุงู ุฑุณู ุจูุงูู ูุทุจูุฉ ูุงุญุฏุฉ ูุฅูุดุงุก ุนุฏุฉ ููุงุฐุฌ. <br><br>  ูู ุงููุซุงู ุฃุฏูุงู ุ ูุณุชุฎุฏู ููุณ ุฑุตุฉ ุงูุทุจูุฉ ูุฅูุดุงุก ูููุฐุฌูู: <br>  ูููุฐุฌ <code> (encoder)</code> ูุญูู ุงูุตูุฑ ุงููุฏุฎูุฉ ุฅูู ูุชุฌูุงุช 16-ุงูุฃุจุนุงุฏ ุ ููููุฐุฌ <code> (autoencoder)</code> ููุชุฏุฑูุจ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">encoder_input = keras.Input(shape=(<span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), name=<span class="hljs-string"><span class="hljs-string">'img'</span></span>) x = layers.Conv2D(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(encoder_input) x = layers.Conv2D(<span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) x = layers.MaxPooling2D(<span class="hljs-number"><span class="hljs-number">3</span></span>)(x) x = layers.Conv2D(<span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) x = layers.Conv2D(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) encoder_output = layers.GlobalMaxPooling2D()(x) encoder = keras.Model(encoder_input, encoder_output, name=<span class="hljs-string"><span class="hljs-string">'encoder'</span></span>) encoder.summary() x = layers.Reshape((<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>))(encoder_output) x = layers.Conv2DTranspose(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) x = layers.Conv2DTranspose(<span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) x = layers.UpSampling2D(<span class="hljs-number"><span class="hljs-number">3</span></span>)(x) x = layers.Conv2DTranspose(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) decoder_output = layers.Conv2DTranspose(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) autoencoder = keras.Model(encoder_input, decoder_output, name=<span class="hljs-string"><span class="hljs-string">'autoencoder'</span></span>) autoencoder.summary()</code> </pre><br>  ูุฑุฌู ููุงุญุธุฉ ุฃููุง ูุฌุนู ุจููุฉ ูู ุงูุชุดููุฑ ูุชูุงุซูุฉ ุชูุงููุง ูุน ุจููุฉ ุงูุชุฑููุฒ ุ ุญุชู ูุญุตู ุนูู ุจูุนุฏ ุจูุงูุงุช ุงููุฎุฑุฌุงุช ูุซู ุจูุงูุงุช ุงูุฅุฏุฎุงู <code>(28, 28, 1)</code> .  ุชููู ุทุจูุฉ <code>Conv2D</code> ุฅูู ุทุจูุฉ <code>Conv2D</code> ุ <code>MaxPooling2D</code> ุทุจูุฉ <code>MaxPooling2D</code> ูู ุงูุฌุฒุก ุงูุฎููู ูุทุจูุฉ <code>MaxPooling2D</code> . <br><br><h2 style=";text-align:right;direction:rtl">  ูููู ุงุณุชุฏุนุงุก ุงูููุงุฐุฌ ูุทุจูุงุช </h2><br>  ููููู ุงุณุชุฎุฏุงู ุฃู ูููุฐุฌ ููุง ูู ูุงู ุทุจูุฉ ุ ุฃู <code>Input</code> ุนูู <code>Input</code> ุฃู ุนูู ุฅุฎุฑุงุฌ ุทุจูุฉ ุฃุฎุฑู. <br><br>  ูุงุญุธ ุฃูู ูู ุฎูุงู ุงุณุชุฏุนุงุก ูููุฐุฌ ุ ูุฃูุช ูุง ุชุนูุฏ ุงุณุชุฎุฏุงู ุจููุชู ูุญุณุจ ุ ุจู ุชุนูุฏ ุฃูุถูุง ุงุณุชุฎุฏุงู ุฃูุฒุงูู.  ุฏุนููุง ูุฑู ุฐูู ูู ุงูุนูู.  ูููุง ููู ูุธุฑุฉ ุฃุฎุฑู ุนูู ูุซุงู ููุดููุฑ ุชููุงุฆู ุ ุนูุฏ ุฅูุดุงุก ูููุฐุฌ ูุดูุฑ ุ ูุชู ุฅูุดุงุก ูููุฐุฌ ูุญุฏุฉ ูู ุชุฑููุฒ ุ ููุชู ุชูุตููููุง ูู ููุงููุชูู ููุญุตูู ุนูู ุทุฑุงุฒ ูุดูุฑ ุชููุงุฆู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">encoder_input = keras.Input(shape=(<span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), name=<span class="hljs-string"><span class="hljs-string">'original_img'</span></span>) x = layers.Conv2D(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(encoder_input) x = layers.Conv2D(<span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) x = layers.MaxPooling2D(<span class="hljs-number"><span class="hljs-number">3</span></span>)(x) x = layers.Conv2D(<span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) x = layers.Conv2D(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) encoder_output = layers.GlobalMaxPooling2D()(x) encoder = keras.Model(encoder_input, encoder_output, name=<span class="hljs-string"><span class="hljs-string">'encoder'</span></span>) encoder.summary() decoder_input = keras.Input(shape=(<span class="hljs-number"><span class="hljs-number">16</span></span>,), name=<span class="hljs-string"><span class="hljs-string">'encoded_img'</span></span>) x = layers.Reshape((<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>))(decoder_input) x = layers.Conv2DTranspose(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) x = layers.Conv2DTranspose(<span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) x = layers.UpSampling2D(<span class="hljs-number"><span class="hljs-number">3</span></span>)(x) x = layers.Conv2DTranspose(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) decoder_output = layers.Conv2DTranspose(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) decoder = keras.Model(decoder_input, decoder_output, name=<span class="hljs-string"><span class="hljs-string">'decoder'</span></span>) decoder.summary() autoencoder_input = keras.Input(shape=(<span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), name=<span class="hljs-string"><span class="hljs-string">'img'</span></span>) encoded_img = encoder(autoencoder_input) decoded_img = decoder(encoded_img) autoencoder = keras.Model(autoencoder_input, decoded_img, name=<span class="hljs-string"><span class="hljs-string">'autoencoder'</span></span>) autoencoder.summary()</code> </pre> <br>  ููุง ุชุฑูู ุ ูููู ุชุฏุงุฎู ูููุฐุฌ: ูููู ุฃู ูุญุชูู ุงููููุฐุฌ ุนูู ูููุฐุฌ ูุฑุนู (ุญูุซ ูููู ุงุนุชุจุงุฑ ุงููููุฐุฌ ุทุจูุฉ). <br><br>  ูููุงู ุญุงูุฉ ุงูุงุณุชุฎุฏุงู ุงููุดุชุฑู ูููุงุฐุฌ ุงูุชุนุดูุด ูู <i>ุชุฌููุน</i> . <br><br>  ุนูู ุณุจูู ุงููุซุงู ุ ูููุง ููู ููููุฉ ุงูุฌูุน ุจูู ูุฌููุนุฉ ูู ุงูููุงุฐุฌ ูู ูููุฐุฌ ูุงุญุฏ ูุชูุณุท โโุชููุนุงุชูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_model</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> inputs = keras.Input(shape=(<span class="hljs-number"><span class="hljs-number">128</span></span>,)) outputs = layers.Dense(<span class="hljs-number"><span class="hljs-number">1</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'sigmoid'</span></span>)(inputs) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> keras.Model(inputs, outputs) model1 = get_model() model2 = get_model() model3 = get_model() inputs = keras.Input(shape=(<span class="hljs-number"><span class="hljs-number">128</span></span>,)) y1 = model1(inputs) y2 = model2(inputs) y3 = model3(inputs) outputs = layers.average([y1, y2, y3]) ensemble_model = keras.Model(inputs=inputs, outputs=outputs)</code> </pre> <br><br><h2 style=";text-align:right;direction:rtl">  ูุนุงูุฌุฉ ุทุจูููุฌูุง ุงูุฑุณู ุงูุจูุงูู ุงููุนูุฏุฉ </h2><br><h3 style=";text-align:right;direction:rtl">  ููุงุฐุฌ ูุชุนุฏุฏุฉ ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช </h3><br>  ุชุนูู API ุงููุธูููุฉ ุนูู ุชุจุณูุท ูุนุงูุฌุฉ ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช ุงููุชุนุฏุฏุฉ.  ูุง ูููู ุงูููุงู ุจุฐูู ุจุงุณุชุฎุฏุงู API Sequential. <br><br>  ููุง ูุซุงู ุจุณูุท. <br><br>  ุงูุชุฑุถ ุฃูู ุชููู ุจุฅูุดุงุก ูุธุงู ูุชุตููู ุทูุจุงุช ุงูุนููุงุก ุญุณุจ ุงูุฃููููุฉ ูุฅุฑุณุงููุง ุฅูู ุงููุณู ุงูููุงุณุจ. <br><br>  ุณูุชุถูู ุงููููุฐุฌ ุงูุฎุงุต ุจู 3 ูุฏุฎูุงุช: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฑุฃุณ ุงูุชุทุจูู (ุฅุฏุฎุงู ุงููุต) </li><li style=";text-align:right;direction:rtl">  ูุญุชูู ุงููุต ููุชุทุจูู (ุฅุฏุฎุงู ุงููุต) </li><li style=";text-align:right;direction:rtl">  ุฃู ุนูุงูุงุช ุชูุช ุฅุถุงูุชูุง ุจูุงุณุทุฉ ุงููุณุชุฎุฏู (ุงูุฅุฏุฎุงู ุงููุงุทุน) </li></ul><br>  ุณูููู ููุฐุง ุงููููุฐุฌ 2 ูุฎุฑุฌุงุช: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฏุฑุฌุฉ ุงูุฃููููุฉ ุจูู 0 ู 1 (ุฅุฎุฑุงุฌ ุงูุณููู ุงูุณููู) </li><li style=";text-align:right;direction:rtl">  ุงููุณู ุงูุฐู ูุฌุจ ุฃู ูุนุงูุฌ ุงูุชุทุจูู (ุฅุฎุฑุงุฌ softmax ูููุง ูุชุนูู ุจุงูุนุฏูุฏ ูู ุงูุฃูุณุงู) </li></ul><br>  ุฏุนููุง ูุจูู ูููุฐุฌูุง ูู ุนุฏุฉ ุฃุณุทุฑ ุจุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงููุธูููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">num_tags = <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-comment"><span class="hljs-comment">#     num_words = 10000 #         num_departments = 4 #     title_input = keras.Input(shape=(None,), name='title') #      body_input = keras.Input(shape=(None,), name='body') #      tags_input = keras.Input(shape=(num_tags,), name='tags') #    `num_tags` #      64-  title_features = layers.Embedding(num_words, 64)(title_input) #      64-  body_features = layers.Embedding(num_words, 64)(body_input) #        128-  title_features = layers.LSTM(128)(title_features) #        32-  body_features = layers.LSTM(32)(body_features) #          x = layers.concatenate([title_features, body_features, tags_input]) #         priority_pred = layers.Dense(1, activation='sigmoid', name='priority')(x) #       department_pred = layers.Dense(num_departments, activation='softmax', name='department')(x) #   ,     model = keras.Model(inputs=[title_input, body_input, tags_input], outputs=[priority_pred, department_pred])</span></span></code> </pre> <br>  ููุฑุณู ุฑุณู ุจูุงูู ูููุฐุฌู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">keras.utils.plot_model(model, <span class="hljs-string"><span class="hljs-string">'multi_input_and_output_model.png'</span></span>, show_shapes=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/gc/hk/uw/gchkuwc_zgefnaf4tx0ercck8bc.png"><br><br>  ุนูุฏ ุชุฌููุน ูุฐุง ุงููููุฐุฌ ุ ูููููุง ุชุฎุตูุต ูุธุงุฆู ุฎุณุงุฑุฉ ูุฎุชููุฉ ููู ูุฎุฑุฌุงุช. <br><br>  ููููู ุญุชู ุชุนููู ุฃูุฒุงู ูุฎุชููุฉ ููู ุฏุงูุฉ ุฎุณุงุฑุฉ ูุชุบููุฑ ูุณุงููุชูุง ูู ุฏุงูุฉ ููุฏุงู ุงูุชุนูู ุงูุฅุฌูุงููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model.compile(optimizer=keras.optimizers.RMSprop(<span class="hljs-number"><span class="hljs-number">1e-3</span></span>), loss=[<span class="hljs-string"><span class="hljs-string">'binary_crossentropy'</span></span>, <span class="hljs-string"><span class="hljs-string">'categorical_crossentropy'</span></span>], loss_weights=[<span class="hljs-number"><span class="hljs-number">1.</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>])</code> </pre> <br>  ูุธุฑูุง ูุฃููุง ูุฏููุง โโุฃุณูุงุก ูุทุจูุงุช ุงูุฅุฎุฑุงุฌ ูุฏููุง ุ ูููููุง ุฃูุถูุง ุชุญุฏูุฏ ูุธุงุฆู ุงูุฎุณุงุฑุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model.compile(optimizer=keras.optimizers.RMSprop(<span class="hljs-number"><span class="hljs-number">1e-3</span></span>), loss={<span class="hljs-string"><span class="hljs-string">'priority'</span></span>: <span class="hljs-string"><span class="hljs-string">'binary_crossentropy'</span></span>, <span class="hljs-string"><span class="hljs-string">'department'</span></span>: <span class="hljs-string"><span class="hljs-string">'categorical_crossentropy'</span></span>}, loss_weights=[<span class="hljs-number"><span class="hljs-number">1.</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>])</code> </pre> <br>  ูููููุง ุชุฏุฑูุจ ุงููููุฐุฌ ูู ุฎูุงู ุชูุฑูุฑ ููุงุฆู ุตูุงุฆู Numpy ูุจูุงูุงุช ุงูุฅุฏุฎุงู ูุงูุชุณููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-comment"><span class="hljs-comment"># Dummy input data title_data = np.random.randint(num_words, size=(1280, 10)) body_data = np.random.randint(num_words, size=(1280, 100)) tags_data = np.random.randint(2, size=(1280, num_tags)).astype('float32') # Dummy target data priority_targets = np.random.random(size=(1280, 1)) dept_targets = np.random.randint(2, size=(1280, num_departments)) model.fit({'title': title_data, 'body': body_data, 'tags': tags_data}, {'priority': priority_targets, 'department': dept_targets}, epochs=2, batch_size=32)</span></span></code> </pre><br>  ุนูุฏ ุงูุงุชุตุงู ุจูุง ูุชูุงุณุจ ูุน ูุงุฆู <code>Dataset</code> ุ ุฅูุง ุฃู ูุชู ุฅุฑุฌุงุน ูุฌููุนุฉ ูู ุงูููุงุฆู ูุซู <code>([title_data, body_data, tags_data], [priority_targets, dept_targets])</code> ุ ุฃู tuple ูู ุงูููุงููุณ <code>({'title': title_data, 'body': body_data, 'tags': tags_data}, {'priority': priority_targets, 'department': dept_targets})</code> ูุฌุจ ุฃู <code>({'title': title_data, 'body': body_data, 'tags': tags_data}, {'priority': priority_targets, 'department': dept_targets})</code> . <br><br><h3 style=";text-align:right;direction:rtl">  ูููุฐุฌ ุงูุชุฏุฑูุจ resnet </h3><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุงูููุงุฐุฌ ุฐุงุช ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช ุงููุชุนุฏุฏุฉ ุ ุชุนูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงููุธูููุฉ (API) ุงููุธูููุฉ ุนูู ุชุจุณูุท ูุนุงูุฌุฉ ุงูุทุจูููุฌูุง ูู ุฎูุงู ุงูุชูุตูู ุบูุฑ ุงูุฎุทู ุ ุฃู ุงูููุงุฐุฌ ุงูุชู ูุง ูุชู ูููุง ุชูุตูู ุงูุทุจูุงุช ูู ุณูุณูุฉ.  ูุง ูููู ุชุทุจูู ูุฐู ุงูููุงุฐุฌ ุฃูุถูุง ุจุงุณุชุฎุฏุงู API Sequential (ููุง ููุญู ุงูุงุณู). <br><br>  ุญุงูุฉ ุงูุงุณุชุฎุฏุงู ุงูุดุงุฆุนุฉ ููุฐุง ูู ุงูุงุชุตุงูุงุช ุงููุชุจููุฉ. <br><br>  ุฏุนููุง ูุจูู ูููุฐุฌ ุชุฏุฑูุจ ResNet ูู CIFAR10 ูุฅุธูุงุฑ ุฐูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">inputs = keras.Input(shape=(<span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), name=<span class="hljs-string"><span class="hljs-string">'img'</span></span>) x = layers.Conv2D(<span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(inputs) x = layers.Conv2D(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) block_1_output = layers.MaxPooling2D(<span class="hljs-number"><span class="hljs-number">3</span></span>)(x) x = layers.Conv2D(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>, padding=<span class="hljs-string"><span class="hljs-string">'same'</span></span>)(block_1_output) x = layers.Conv2D(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>, padding=<span class="hljs-string"><span class="hljs-string">'same'</span></span>)(x) block_2_output = layers.add([x, block_1_output]) x = layers.Conv2D(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>, padding=<span class="hljs-string"><span class="hljs-string">'same'</span></span>)(block_2_output) x = layers.Conv2D(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>, padding=<span class="hljs-string"><span class="hljs-string">'same'</span></span>)(x) block_3_output = layers.add([x, block_2_output]) x = layers.Conv2D(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(block_3_output) x = layers.GlobalAveragePooling2D()(x) x = layers.Dense(<span class="hljs-number"><span class="hljs-number">256</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(x) x = layers.Dropout(<span class="hljs-number"><span class="hljs-number">0.5</span></span>)(x) outputs = layers.Dense(<span class="hljs-number"><span class="hljs-number">10</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'softmax'</span></span>)(x) model = keras.Model(inputs, outputs, name=<span class="hljs-string"><span class="hljs-string">'toy_resnet'</span></span>) model.summary()</code> </pre> <br>  ููุฑุณู ุฑุณู ุจูุงูู ูููุฐุฌู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">keras.utils.plot_model(model, <span class="hljs-string"><span class="hljs-string">'mini_resnet.png'</span></span>, show_shapes=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/qj/vi/bk/qjvibkpx9zrbp09rcfhj_drtlzc.png"><br><br>  ูุนูููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">(x_train, y_train), (x_test, y_test) = keras.datasets.cifar10.load_data() x_train = x_train.astype(<span class="hljs-string"><span class="hljs-string">'float32'</span></span>) / <span class="hljs-number"><span class="hljs-number">255.</span></span> x_test = x_test.astype(<span class="hljs-string"><span class="hljs-string">'float32'</span></span>) / <span class="hljs-number"><span class="hljs-number">255.</span></span> y_train = keras.utils.to_categorical(y_train, <span class="hljs-number"><span class="hljs-number">10</span></span>) y_test = keras.utils.to_categorical(y_test, <span class="hljs-number"><span class="hljs-number">10</span></span>) model.compile(optimizer=keras.optimizers.RMSprop(<span class="hljs-number"><span class="hljs-number">1e-3</span></span>), loss=<span class="hljs-string"><span class="hljs-string">'categorical_crossentropy'</span></span>, metrics=[<span class="hljs-string"><span class="hljs-string">'acc'</span></span>]) model.fit(x_train, y_train, batch_size=<span class="hljs-number"><span class="hljs-number">64</span></span>, epochs=<span class="hljs-number"><span class="hljs-number">1</span></span>, validation_split=<span class="hljs-number"><span class="hljs-number">0.2</span></span>)</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  ุชูุงุณู ุทุจูุฉ </h2><br>  ุงูุงุณุชุฎุฏุงู ุงูุฌูุฏ ุงูุขุฎุฑ ููุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงููุธูููุฉ ูู ุงูููุงุฐุฌ ุงูุชู ุชุณุชุฎุฏู ุทุจูุงุช ุดุงุฆุนุฉ.  ุงูุทุจูุงุช ุงูุดุงุฆุนุฉ ูู ูุซููุงุช ุงูุทุจูุงุช ุงูุชู ูุชู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงููุง ูู ููุณ ุงููููุฐุฌ: ููู ุชุฏุฑุณ ุงูููุฒุงุช ุงูุชู ุชุฑุชุจุท ุจุนุฏุฉ ูุณุงุฑุงุช ูู ุงูุฑุณู ุงูุจูุงูู ููุทุจูุฉ. <br><br>  ุบุงูุจูุง ูุง ูุชู ุงุณุชุฎุฏุงู ุงูุทุจูุงุช ุงูุดุงุฆุนุฉ ูุชุดููุฑ ุจูุงูุงุช ุงูุฅุฏุฎุงู ุงูุชู ุชุฃุชู ูู ููุณ ุงููุณุงูุงุช (ุนูู ุณุจูู ุงููุซุงู ุ ูู ูุตูู ูุฎุชูููู ูููุง ููุณ ุงููุงููุณ) ุ ุญูุซ ุฃูููุง ูููุฑุงู ุชุจุงุฏู ุงููุนูููุงุช ุจูู ูุฐู ุงูุจูุงูุงุช ุงููุฎุชููุฉ ุ ููุง ูุณูุญ ุจุชุฏุฑูุจ ูุฐู ุงูููุงุฐุฌ ุนูู ุจูุงูุงุช ุฃูู.  ุฅุฐุง ุธูุฑุช ูููุฉ ูุนููุฉ ุนูู ุฃุญุฏ ุงููุฏุฎูุงุช ุ ูุณูุณูู ุฐูู ูุนุงูุฌุชูุง ุนูู ุฌููุน ุงููุฏุฎูุงุช ุงูุชู ุชูุฑ ุนุจุฑ ุงููุณุชูู ุงูุนุงู. <br><br>  ููุดุงุฑูุฉ ุทุจูุฉ ูู API ุงููุธูููุฉ ุ ูุง ุนููู ุณูู ุงูุงุชุตุงู ุจููุณ ูุซูู ุงูุทุจูุฉ ุนุฏุฉ ูุฑุงุช.  ุนูู ุณุจูู ุงููุซุงู ุ ุชุชู ูุดุงุฑูุฉ ุทุจูุฉ <code>Embedding</code> ููุง ุนูู <code>Embedding</code> ูููุต: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   1000    128-  shared_embedding = layers.Embedding(1000, 128) #     text_input_a = keras.Input(shape=(None,), dtype='int32') #     text_input_b = keras.Input(shape=(None,), dtype='int32') #           encoded_input_a = shared_embedding(text_input_a) encoded_input_b = shared_embedding(text_input_b)</span></span></code> </pre> <br><h2 style=";text-align:right;direction:rtl">  ุงุณุชุฑุฏุงุฏ ูุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงูุนูุฏ ูู ุฑุณู ุจูุงูู ุทุจูุฉ </h2><br>  ูุธุฑูุง ูุฃู ุงูุฑุณู ุงูุจูุงูู ููุทุจูุฉ ุงูุฐู ุชุชุนุงูู ูุนู ูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงููุธูููุฉ ูู ุจููุฉ ุจูุงูุงุช ุซุงุจุชุฉ ุ ููููู ุงููุตูู ุฅููู ูุงูุชุญูู ููู.  ูุฐู ูู ุงูุทุฑููุฉ ุงูุชู ูุจูู ุงูููุงุฐุฌ ุงููุธูููุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู ุดูู ุตูุฑ. <br><br>  ููุฐุง ูุนูู ุฃูุถูุง ุฃูู ูููููุง ุงููุตูู ุฅูู ุชูุดูุท ุงูุทุจูุงุช ุงููุณูุทุฉ ("ุงูุนูุฏ" ูู ุงูุฑุณู ุงูุจูุงูู) ูุงุณุชุฎุฏุงููุง ูู ุฃูุงูู ุฃุฎุฑู.  ูุฐุง ูููุฏ ููุบุงูุฉ ูุงุณุชุฎุฑุงุฌ ุงูุณูุงุช ุ ุนูู ุณุจูู ุงููุซุงู! <br><br>  ุฏุนูุง ูุฑู ูุซุงูุง.  ูุฐุง ูููุฐุฌ VGG19 ูุน ุฌุฏุงูู ุชู ุชุฏุฑูุจูุง ูุณุจููุง ุนูู ImageNet: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tensorflow.keras.applications <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> VGG19 vgg19 = VGG19()</code> </pre> <br>  ููุฐู ูู ุนูููุงุช ุงูุชูุดูุท ุงููููุฐุฌูุฉ ุงูุชู ุชู ุงูุญุตูู ุนูููุง ุนู ุทุฑูู ุงูุงุณุชุนูุงู ุนู ุจููุฉ ุจูุงูุงุช ุงูุฑุณู ุงูุจูุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">features_list = [layer.output <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> layer <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> vgg19.layers]</code> </pre> <br>  ูููููุง ุงุณุชุฎุฏุงู ูุฐู ุงูููุฒุงุช ูุฅูุดุงุก ูููุฐุฌ ุฌุฏูุฏ ูุงุณุชุฎุฑุงุฌ ุงููุนุงูู ููุฑุฌุน ููู ุงูุชูุดูุท ุงููุชูุณุทุฉ ุงููุณุชูู - ููููููุง ุฃู ููุนู ูู ุฐูู ูู 3 ุฃุณุทุฑ <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">feat_extraction_model = keras.Model(inputs=vgg19.input, outputs=features_list) img = np.random.random((<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">224</span></span>, <span class="hljs-number"><span class="hljs-number">224</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>)).astype(<span class="hljs-string"><span class="hljs-string">'float32'</span></span>) extracted_features = feat_extraction_model(img)</code> </pre> <br>  ูุฐุง ููุงุณุจ ุนูุฏ ุชูููุฐ ููู ุงูููุท ุงูุนุตุจู ุ ููุง ูู ุงูุญุงูุงุช ุงูุฃุฎุฑู. <br><br><h2 style=";text-align:right;direction:rtl">  ุชูุฏูุฏ API ุนู ุทุฑูู ูุชุงุจุฉ ุทุจูุงุช ูุฎุตุตุฉ </h2><br>  <code>tf.keras</code> ูุฏููุง ูุฌููุนุฉ ูุงุณุนุฉ ูู ุงูุทุจูุงุช ุงููุฏูุฌุฉ.  ูููุง ููู ุจุนุถ ุงูุฃูุซูุฉ: <br><br>  ุงูุทุจูุงุช ุงูุชูุงููููุฉ: <code>Conv1D</code> ุ <code>Conv2D</code> ุ <code>Conv3D</code> ุ <code>Conv2DTranspose</code> ุ ุฅูุฎ. <br>  ุทุจูุงุช <code>MaxPooling1D</code> : <code>MaxPooling1D</code> ุ ู <code>MaxPooling2D</code> ุ ู <code>MaxPooling3D</code> ุ ู <code>AveragePooling1D</code> ุ ุฅูุฎ. <br>  ุทุจูุงุช RNN: <code>GRU</code> ุ <code>LSTM</code> ุ <code>ConvLSTM2D</code> ุ ุฅูุฎ. <br>  <code>BatchNormalization</code> ุ <code>Dropout</code> ุ <code>Embedding</code> ุ ุฅูุฎ. <br><br>  ุฅุฐุง ูู ุชุฌุฏ ูุง ุชุญุชุงุฌ ุฅููู ุ ููู ุงูุณูู ุชูุฏูุฏ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูู ุฎูุงู ุฅูุดุงุก ุงูุทุจูุฉ ุงูุฎุงุตุฉ ุจู. <br><br>  ุฌููุน ุงูุทุจูุงุช ูุฆุฉ ูุฑุนูุฉ <code>Layer</code> ูุชูููุฐ: <br><br>  ุทุฑููุฉ <code>call</code> ุงูุชู ุชุญุฏุฏ ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ุงูุชู ุชููู ุจูุง ุงูุทุจูุฉ. <br>  ุทุฑููุฉ ุงูุฅูุดุงุก ุงูุชู ุชูุดุฆ ุฃูุฒุงู ุงูุทุจูุฉ (ูุงุญุธ ุฃู ูุฐุง ูุฌุฑุฏ ุงุตุทูุงุญ ููุท ุ ููููู ุฃูุถูุง ุฅูุดุงุก ุฃูุฒุงู ูู <code>__init__</code> ). <br><br>  ูููุง ููู ุชุทุจูู ุจุณูุท ููุทุจูุฉ <code>Dense</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomDense</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(layers.Layer)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, units=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">32</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> super(CustomDense, self).__init__() self.units = units <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, input_shape)</span></span></span><span class="hljs-function">:</span></span> self.w = self.add_weight(shape=(input_shape[<span class="hljs-number"><span class="hljs-number">-1</span></span>], self.units), initializer=<span class="hljs-string"><span class="hljs-string">'random_normal'</span></span>, trainable=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) self.b = self.add_weight(shape=(self.units,), initializer=<span class="hljs-string"><span class="hljs-string">'random_normal'</span></span>, trainable=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, inputs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tf.matmul(inputs, self.w) + self.b inputs = keras.Input((<span class="hljs-number"><span class="hljs-number">4</span></span>,)) outputs = CustomDense(<span class="hljs-number"><span class="hljs-number">10</span></span>)(inputs) model = keras.Model(inputs, outputs)</code> </pre> <br>  ุฅุฐุง ููุช ุชุฑูุฏ ุฃู ุชุฏุนู ุงูุทุจูุฉ ุงููุฎุตุตุฉ ุงูุชุณูุณู ุ ููุฌุจ ุนููู ุฃูุถูุง ุชุญุฏูุฏ ุทุฑููุฉ <code>get_config</code> ุงูุชู ุชูุฑุฌุน ูุณูุทุงุช ูููุดุฆ ูุซูู ุงูุทุจูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomDense</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(layers.Layer)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, units=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">32</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> super(CustomDense, self).__init__() self.units = units <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, input_shape)</span></span></span><span class="hljs-function">:</span></span> self.w = self.add_weight(shape=(input_shape[<span class="hljs-number"><span class="hljs-number">-1</span></span>], self.units), initializer=<span class="hljs-string"><span class="hljs-string">'random_normal'</span></span>, trainable=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) self.b = self.add_weight(shape=(self.units,), initializer=<span class="hljs-string"><span class="hljs-string">'random_normal'</span></span>, trainable=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, inputs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tf.matmul(inputs, self.w) + self.b <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_config</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-string"><span class="hljs-string">'units'</span></span>: self.units} inputs = keras.Input((<span class="hljs-number"><span class="hljs-number">4</span></span>,)) outputs = CustomDense(<span class="hljs-number"><span class="hljs-number">10</span></span>)(inputs) model = keras.Model(inputs, outputs) config = model.get_config() new_model = keras.Model.from_config( config, custom_objects={<span class="hljs-string"><span class="hljs-string">'CustomDense'</span></span>: CustomDense})</code> </pre> <br>  ุงุฎุชูุงุฑููุง ุ ููููู ุฃูุถูุง ุชุทุจูู ุทุฑููุฉ ุงููุฆุฉ <code>from_config (cls, config)</code> ุ ุงููุณุคููุฉ ุนู ุฅุนุงุฏุฉ ุฅูุดุงุก ูุซูู ุงูุทุจูุฉ ุ ุจุงููุธุฑ ุฅูู ูุงููุณ ุงูุชูููู ุงูุฎุงุต ุจูุง.  ูุจุฏู <code>from_config</code> ุงูุงูุชุฑุงุถู <code>from_config</code> ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">from_config</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls, config)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cls(**config)</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  ูุชู ุชุณุชุฎุฏู API ุงููุธูููุฉ </h2><br>  ููููุฉ ุชุญุฏูุฏ ูุชู ูููู ูู ุงูุฃูุถู ุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงููุธูููุฉ ูุฅูุดุงุก ูููุฐุฌ ุฌุฏูุฏ ุ ุฃู ุจุจุณุงุทุฉ <code>Model</code> ูุฆุฉ ูุฑุนูุฉ ูุจุงุดุฑุฉุ <br><br>  ุจุดูู ุนุงู ุ ุชุนุฏ API ุงููุธูููุฉ ุฃูุซุฑ ูุณุชูู ูุณูููุฉ ูู ุงูุงุณุชุฎุฏุงู ุ ููู ุชุญุชูู ุนูู ุนุฏุฏ ูู ุงููุธุงุฆู ุงูุชู ูุง ุชุฏุนููุง ุงูุทุฑุฒ ุงููุฑุนูุฉ. <br><br>  ููุน ุฐูู ุ ูุฅู ุงููุฆุฉ ุงููุฑุนูุฉ ูููููุฐุฌ ุชููุญู ูุฑููุฉ ูุจูุฑุฉ ุนูุฏ ุฅูุดุงุก ููุงุฐุฌ ูุง ูููู ูุตููุง ุจุณูููุฉ ุนูู ุฃููุง ุฑุณู ุจูุงูู acyclic ููุฌู ููุทุจูุงุช (ุนูู ุณุจูู ุงููุซุงู ุ ูุง ููููู ุชุทุจูู Tree-RNN ูุน API ุงููุธููู ุ ุชุญุชุงุฌ ุฅูู ูุฆุฉ ูุฑุนูุฉ <code>Model</code> ูุจุงุดุฑุฉ). <br><br><h3 style=";text-align:right;direction:rtl">  ููุงุท ุงูููุฉ ูู API ุงููุธูููุฉ: </h3><br>  ุงูุฎุตุงุฆุต ุงููุฐููุฑุฉ ุฃุฏูุงู ุฌููุนูุง ุตุญูุญุฉ ุจุงููุณุจุฉ ููุทุฑุฒ ุงูุชุณูุณููุฉ (ูุงูุชู ูู ุฃูุถูุง ููุงูู ุจูุงูุงุช) ุ ููููุง ุตุญูุญุฉ ุจุงููุณุจุฉ ููุทุฑุฒ ุงููุฑุนูุฉ (ุงูุชู ูู ุฑูุฒ ุจูุซูู ุ ูููุณ ููุงูู ุงูุจูุงูุงุช). <br><br><h4 style=";text-align:right;direction:rtl">  API ุงููุธูููุฉ ุชูุชุฌ ุฑูุฒ ุฃูุตุฑ. </h4><br>  ูุง ููุฌุฏ <code>super(MyClass, self).__init__(...)</code> ุ ุจุฏูู <code>def call(self, ...):</code> ุฅูุฎ. <br><br>  ูุงุฑู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">inputs = keras.Input(shape=(<span class="hljs-number"><span class="hljs-number">32</span></span>,)) x = layers.Dense(<span class="hljs-number"><span class="hljs-number">64</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>)(inputs) outputs = layers.Dense(<span class="hljs-number"><span class="hljs-number">10</span></span>)(x) mlp = keras.Model(inputs, outputs)</code> </pre> <br>  ูุน ุฅุตุฏุงุฑ ูุฆุฉ ูุฑุนูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MLP</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(keras.Model)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, **kwargs)</span></span></span><span class="hljs-function">:</span></span> super(MLP, self).__init__(**kwargs) self.dense_1 = layers.Dense(<span class="hljs-number"><span class="hljs-number">64</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>) self.dense_2 = layers.Dense(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, inputs)</span></span></span><span class="hljs-function">:</span></span> x = self.dense_1(inputs) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.dense_2(x) <span class="hljs-comment"><span class="hljs-comment">#   . mlp = MLP() #    . #            . _ = mlp(tf.zeros((1, 32)))</span></span></code> </pre> <br><h4 style=";text-align:right;direction:rtl">  ูุชู ุงูุชุญูู ูู ุตุญุฉ ุงููููุฐุฌ ุงูุฎุงุต ุจู ููุง ูู ููุชูุจ. </h4><br>  ูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงููุธูููุฉ ุ ูุชู ุฅูุดุงุก ููุงุตูุงุช ุงูุฅุฏุฎุงู (ุงูุดูู ูุงูููุน) ููุฏููุง (ุนุจุฑ "ุงูุฅุฏุฎุงู") ุ ููู ูู ูุฑุฉ ุชุชุตู ุจุงูุทุจูุฉ ุ ุชุชุญูู ุงูุทุจูุฉ ูู ุฃู ุงูููุงุตูุงุช ุงูุชู ุชู ุชูุฑูุฑูุง ุฅูููุง ุชุชูุงูู ูุน ุงูุชุฑุงุถุงุชูุง ุ ูุฅุฐุง ูู ุชูู ูุฐู ูู ุงูุญุงูุฉ ุ ูุณุชุชููู ุฑุณุงูุฉ ุฎุทุฃ ูููุฏุฉ . <br><br>  ูุฐุง ูุถูู ุฃู ุฃู ูููุฐุฌ ุชููู ุจุฅูุดุงุฆู ุจุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงููุธูููุฉ ูุจุฏุฃ.  ุณุชุญุฏุซ ุฌููุน ุนูููุงุช ุงูุชุตุญูุญ (ุบูุฑ ุงููุชุนููุฉ ุจุชุตุญูุญ ุงูุชูุงุฑุจ) ุจุดูู ุซุงุจุช ุฃุซูุงุก ุฅูุดุงุก ุงููููุฐุฌ ุ ูููุณ ูู ููุช ุงูุชุดุบูู.  ูุฐุง ูุดุงุจู ูููุน ุงูุชุฏููู ูู ุงููุญูู ุงูุจุฑูุฌู. <br><br><h4 style=";text-align:right;direction:rtl">  ูููู ุชูุซูู ุงููููุฐุฌ ุงููุธููู ุงูุฎุงุต ุจู ุจูุงููุงู ุ ููุง ุฃูู ูุงุจู ููุงุฎุชุจุงุฑ. </h4><br>  ููููู ุฑุณู ุงููููุฐุฌ ูู ุดูู ุฑุณู ุจูุงูู ุ ูููููู ุจุณูููุฉ ุงููุตูู ุฅูู ุงูุนูุฏ ุงููุชูุณุทุฉ ููุฑุณู ุงูุจูุงูู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุงุณุชุฎุฑุงุฌ ูุฅุนุงุฏุฉ ุชูุดูุท ุชูุดูุท ุงูุทุจูุงุช ุงููุณูุทุฉ ุ ููุง ุฑุฃููุง ูู ุงููุซุงู ุงูุณุงุจู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">features_list = [layer.output for layer in vgg19.layers] feat_extraction_model = keras.Model(inputs=vgg19.input, outputs=features_list)</code> </pre> <br>  ูุธุฑูุง ูุฃู ุงููููุฐุฌ ุงููุธููู ุฃูุซุฑ ูู ุจููุฉ ุจูุงูุงุช ุฃูุซุฑ ูู ูููู ุฌุฒุกูุง ูู ุงูููุฏ ุ ูุฅูู ูููู ุชุณูุณูู ุจุฃูุงู ููููู ุญูุธู ูููู ูุงุญุฏ ูุชูุญ ูู ุฅุนุงุฏุฉ ุฅูุดุงุก ููุณ ุงููููุฐุฌ ุชูุงููุง ุฏูู ุงููุตูู ุฅูู ุงูููุฏ ุงููุตุฏุฑ. <br><br><h3 style=";text-align:right;direction:rtl">  ููุงุท ุถุนู API ุงููุธูููุฉ </h3><br><h4 style=";text-align:right;direction:rtl">  ูุง ูุฏุนู ุงูุจูู ุงูุฏููุงููููุฉ. </h4><br>  ุชููู API ุงููุธูููุฉ ุจูุนุงูุฌุฉ ุงูููุงุฐุฌ ูุทุจูุงุช DAG.  ูุฐุง ุตุญูุญ ุจุงููุณุจุฉ ููุนุธู ุฃุจููุฉ ุงูุชุนูู ุงูุนูููุฉ ุ ูููู ููุณ ููุฌููุน: ุนูู ุณุจูู ุงููุซุงู ุ ูุง ุชูู ุงูุดุจูุงุช ุงูุนูุฏูุฉ ุฃู Tree RNNs ุจูุฐุง ุงูุงูุชุฑุงุถ ููุง ูููู ุชูููุฐูุง ูู API ุงููุธูููุฉ. <br><br><h4 style=";text-align:right;direction:rtl">  ูู ุจุนุถ ุงูุฃุญูุงู ุชุญุชุงุฌ ููุท ุฅูู ูุชุงุจุฉ ูู ุดูุก ูู ุงูุตูุฑ. </h4><br>  ุนูุฏ ูุชุงุจุฉ ุชุตูููุงุช ูุชูุฏูุฉ ุ ูุฏ ุชุฑุบุจ ูู ุงูููุงู ุจุดูุก ูุชุฌุงูุฒ "ุชุญุฏูุฏ ุทุจูุงุช DAG": ุนูู ุณุจูู ุงููุซุงู ุ ููููู ุงุณุชุฎุฏุงู ุงูุนุฏูุฏ ูู ุฃุณุงููุจ ุงูุชุฏุฑูุจ ูุงูุฅุฎุฑุงุฌ ุงููุฎุตุตุฉ ุนูู ูุซูู ูู ุงููููุฐุฌ ุงูุฎุงุต ุจู.  ููุฐุง ูุชุทูุจ ูุฆุฉ ูุฑุนูุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฌูุน ุจูู ูุฎุชูู ุฃุณุงููุจ API ูุงูุฌูุน ุจูููุง </h2><br>  ูู ุงูููู ููุงุญุธุฉ ุฃู ุงูุงุฎุชูุงุฑ ุจูู API ุงููุธูููุฉ ุฃู ุงูุชุตููู ุงููุฑุนู ูููููุฐุฌ ููุณ ุญูุงู ุซูุงุฆูุงู ูุญุฏู ูู ูุฆุฉ ูุงุญุฏุฉ ูู ุงูุทุฑุฒ.    API tf.keras     ,   Sequential , Functional    Models/Layers,   . <br><br>     Functional   Sequential     Model/Layer: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">units = <span class="hljs-number"><span class="hljs-number">32</span></span> timesteps = <span class="hljs-number"><span class="hljs-number">10</span></span> input_dim = <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-comment"><span class="hljs-comment"># Define a Functional model inputs = keras.Input((None, units)) x = layers.GlobalAveragePooling1D()(inputs) outputs = layers.Dense(1, activation='sigmoid')(x) model = keras.Model(inputs, outputs) class CustomRNN(layers.Layer): def __init__(self): super(CustomRNN, self).__init__() self.units = units self.projection_1 = layers.Dense(units=units, activation='tanh') self.projection_2 = layers.Dense(units=units, activation='tanh') # Our previously-defined Functional model self.classifier = model def call(self, inputs): outputs = [] state = tf.zeros(shape=(inputs.shape[0], self.units)) for t in range(inputs.shape[1]): x = inputs[:, t, :] h = self.projection_1(x) y = h + self.projection_2(state) state = y outputs.append(y) features = tf.stack(outputs, axis=1) print(features.shape) return self.classifier(features) rnn_model = CustomRNN() _ = rnn_model(tf.zeros((1, timesteps, input_dim)))</span></span></code> </pre><br> ,      Layer  Model  Functional API       <code>call</code>      : <br><br> <code>call(self, inputs, **kwargs)</code>  <code>inputs</code>       (.  ),   <code>**kwargs</code>    (  ). <br> <code>call(self, inputs, training=None, **kwargs)</code>  <code>training</code>           ,   . <br> <code>call(self, inputs, mask=None, **kwargs)</code>  <code>mask</code>     (  RNN, ). <br> <code>call(self, inputs, training=None, mask=None, **kwargs)</code> โ          . <br><br>  ,     `get_config`    Layer  Model, Functional          . <br><br>         RNN    Functional : <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">units = <span class="hljs-number"><span class="hljs-number">32</span></span> timesteps = <span class="hljs-number"><span class="hljs-number">10</span></span> input_dim = <span class="hljs-number"><span class="hljs-number">5</span></span> batch_size = <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomRNN</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(layers.Layer)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> super(CustomRNN, self).__init__() self.units = units self.projection_1 = layers.Dense(units=units, activation=<span class="hljs-string"><span class="hljs-string">'tanh'</span></span>) self.projection_2 = layers.Dense(units=units, activation=<span class="hljs-string"><span class="hljs-string">'tanh'</span></span>) self.classifier = layers.Dense(<span class="hljs-number"><span class="hljs-number">1</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'sigmoid'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, inputs)</span></span></span><span class="hljs-function">:</span></span> outputs = [] state = tf.zeros(shape=(inputs.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>], self.units)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(inputs.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>]): x = inputs[:, t, :] h = self.projection_1(x) y = h + self.projection_2(state) state = y outputs.append(y) features = tf.stack(outputs, axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.classifier(features) <span class="hljs-comment"><span class="hljs-comment">#           #  `batch_shape`,     `CustomRNN`  #    (     `state`). inputs = keras.Input(batch_shape=(batch_size, timesteps, input_dim)) x = layers.Conv1D(32, 3)(inputs) outputs = CustomRNN()(x) model = keras.Model(inputs, outputs) rnn_model = CustomRNN() _ = rnn_model(tf.zeros((1, 10, 5)))</span></span></code> </pre><br>      Functional API! <br><br>             . <br><br>  <i>ุจุนุฏ ุงูุชุญูู ุ ุณุชุธูุฑ ุงูุชุฑุฌูุฉ ุฃูุถูุง ุนูู Tensorflow.org.</i>  <i>ุฅุฐุง ููุช ุชุฑุบุจ ูู ุงููุดุงุฑูุฉ ูู ุชุฑุฌูุฉ ูุซุงุฆู ูููุน Tensorflow.org ุฅูู ุงููุบุฉ ุงูุฑูุณูุฉ ุ ูุฑุฌู ุงูุงุชุตุงู ูู ุฑุณุงูุฉ ุดุฎุตูุฉ ุฃู ุชุนูููุงุช.</i>  <i>ูู ููุถุน ุชูุฏูุฑ ุฃู ุชุตุญูุญุงุช ุฃู ุชุนูููุงุช.</i> <i>      GoogLeNet,      .</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar483664/">https://habr.com/ru/post/ar483664/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar483652/index.html">ูุฐุจ ุนูู ุฅุฐุง ุงุณุชุทุนุช: ููุงูุญ ุฅุฌุฑุงุก pentest ุงุฌุชูุงุนู</a></li>
<li><a href="../ar483654/index.html">ุฑุฏูุฏ ุงููุนู ูู ุงูุชุฌูุนุงุช ุ ูุงุญุฏ ุนูู ูุงุญุฏ ุ ููุงุฐุง ูุฏ ูุง ุชุนูู ูููููุฉ ูุญุงููุฉ ุญููุงุ</a></li>
<li><a href="../ar483656/index.html">ููุญุฉ ูู ุชุฌุงุฑุฉ ุงูุชุฌุฒุฆุฉ ุ ุญูุงุ</a></li>
<li><a href="../ar483660/index.html">Telegram-bot ูุฅุฏุงุฑุฉ ุงูุจููุฉ ุงูุชุญุชูุฉ</a></li>
<li><a href="../ar483662/index.html">ุชูุงูู ุงุณุชุฌุงุจุฉ ุงูุชูุฏูุฏุงุช ูู Cisco ู Cisco Stealthwatch Enterprise</a></li>
<li><a href="../ar483666/index.html">ุญูู ููููุฏูุง ู ุงููุนุงูุฌ ุจุงูุฃูุฒูู</a></li>
<li><a href="../ar483668/index.html">ููุฎุต ุงูููุงุฏ ุงูุทุงุฒุฌุฉ ูู ุนุงูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ููุฃุณุจูุน ุงููุงุถู ุฑูู 397 (ูู 6 ุฅูู 12 ููุงูุฑ 2020)</a></li>
<li><a href="../ar483670/index.html">ูู ูุง ุชุฑูุฏ ูุนุฑูุชู ุนู ุนููุงู MAC</a></li>
<li><a href="../ar483674/index.html">ููู ุชุนูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุซูุงุฆูุฉ ุ ูููุงุฐุง ุณุชููู ุดุนุจูุฉ ูู ุนุงู 2020</a></li>
<li><a href="../ar483676/index.html">ุชูููู ูุนุงููุฉ ูุชูููุฉ ุชูููุฐ ูุธุงู ุชุญูููุงุช ุงูุชุณููู ุงูุดุงููุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>