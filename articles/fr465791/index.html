<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõ¥ üéÖüèº üõ∑ Vuln√©rabilit√©s des d√©taillants - trois cas o√π OTP a pu √™tre obtenu dans la demande üë®üèæ‚Äçüè´ üí¢ ü§ΩüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lors de la saisie des comptes personnels de divers services, pour des raisons de s√©curit√©, 2FA est souvent utilis√© - en plus du nom d'utilisateur et d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vuln√©rabilit√©s des d√©taillants - trois cas o√π OTP a pu √™tre obtenu dans la demande</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465791/">  Lors de la saisie des comptes personnels de divers services, pour des raisons de s√©curit√©, 2FA est souvent utilis√© - en plus du nom d'utilisateur et du mot de passe, vous devez entrer un code unique. <br><br>  Mais il s'est av√©r√© que tout n'est pas si s√ªr, m√™me avec une authentification √† deux facteurs - au cours de la derni√®re ann√©e, j'ai trouv√© trois (!) Services, lorsqu'un code de connexion unique, qui est envoy√© au client par SMS, pouvait √™tre consult√© dans la demande elle-m√™me. <br><br>  Plus bri√®vement sur ce qu'il a menac√© d'exemples sp√©cifiques. <br><br>  <b>1. Un r√©seau populaire de stations-service, plus de 500 000 clients enregistr√©s.</b> <br><br><div class="spoiler">  <b class="spoiler_title">Une demande lors de la saisie de la version web de votre compte personnel:</b> <div class="spoiler_text"><pre><code class="plaintext hljs">POST https://someazs.ua/ua/profile/auth/ Accept: application/json, text/javascript, */*; q=0.01 Accept-Encoding: gzip, deflate, br Accept-Language: ru,en-US;q=0.9,en;q=0.8,uk;q=0.7 Connection: keep-alive Content-Length: 408 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Cookie: PHPSESSID=6n3l2o90hfb020u9ag020u8ha1; usersomeazs_popupcoupons=1;... Host: someazs.ua Origin: https://someazs.ua Referer: https://someazs.ua/ua/login/ User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36 X-Compress: null X-Requested-With: XMLHttpRequest data[phone_mask]: 951234567 data[phone]: 0951234567</code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/64/gw/li/64gwlig4jbxmmjgyarfwpk1_lxa.png"><br><br>  R√©ponse: <code>{"Status":0,"Code":"7038","status":true,"step2":true}</code> <br><br>  Le code de SMS - 7038 - est visible simplement dans la r√©ponse du serveur. <br><a name="habracut"></a><br>  C'est-√†-dire que, sur le site, lors de la saisie du compte personnel, la r√©ponse contenait un code de connexion unique, qui est envoy√© au client par SMS - vous pouvez vous connecter au compte de quelqu'un d'autre en sp√©cifiant uniquement le num√©ro de t√©l√©phone du client et regarder l'OTP dans la demande elle-m√™me. <br><br>  Dans votre compte personnel sont disponibles: num√©ro de carte de fid√©lit√©, nom, solde (bonus en UAH, litre, caf√©), historique des transactions, dans les param√®tres - date de naissance, e-mail du client, etc. <br><br><img src="https://habrastorage.org/webt/cy/g1/fc/cyg1fca8yzihzbxvru6nuybbuvi.png"><br><br>  Avec l'aide d'autres actions de nature non technique (par exemple, la sonnerie du client), avec une bonne chance, on pourrait utiliser l'argent / litres / caf√© du client.  Pourquoi est-ce que j'√©cris ¬´avec bonne chance¬ª?  Lorsque j'ai parl√© du probl√®me, j'ai √©t√© inform√© que les r√®glements par les bonus d'autres personnes ne sont pas si faciles √† effectuer, m√™me si vous avez acc√®s au compte, car il y a des contr√¥les suppl√©mentaires.  Mais ... <br><br>  L'erreur a √©t√© corrig√©e rapidement, merci. <br><br><hr><br>  <b>2. Un r√©seau de magasins sociaux (similaire √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Fix-Price</a> ), une application mobile (plus de 100 000 t√©l√©chargements)</b> <br><br><img src="https://habrastorage.org/webt/wx/ps/ib/wxpsibh9vr7yeouxqlrsk65xyy8.png"><br><br>  Lors du suivi des demandes via Fiddler, j'ai remarqu√© ce qui suit.  Lors de la saisie de l'application mobile, apr√®s saisie du num√©ro de t√©l√©phone et de la carte de fid√©lit√©, un code unique est envoy√© au client. <br><br>  Le probl√®me est qu'il ex√©cute une requ√™te GET du formulaire: <br><pre> <code class="xml hljs">https://bulk.somesmssender.com/?sending_method=sms&amp;from=someretailes&amp;user=onviber4821&amp;txt=%D0%9A%D0%BE%D0%B4+%D0%BF%D0%BE%D0%B4%D1%82%D0%B2%D0%B5%D1%80%D0%B6%D0%B4%D0%B5%D0%BD%D0%B8%D1%8F%3A+1234&amp;phone=380987654321&amp;sign=42f66957a03090eb90556b0ef7fed2e1</code> </pre> <br><br>  Le code √† usage unique lui-m√™me est visible directement dans cette demande: le texte du SMS envoy√© est <pre> <code class="xml hljs">%D0%9A%D0%BE%D0%B4+%D0%BF%D0%BE%D0%B4%D1%82%D0%B2%D0%B5%D1%80%D0%B6%D0%B4%D0%B5%D0%BD%D0%B8%D1%8F%3A+1234&amp;</code> </pre> <br><br>  Un simple rapport de conversion: Code + confirmation: +1234 <br><br><img src="https://habrastorage.org/webt/dx/vk/iw/dxvkiw2myayp4dj-yys1bqlilka.png"><br><br>  C'est-√†-dire  dans l'application elle-m√™me, vous pouvez voir quel code sera envoy√©.  Ici, vous pouvez √©galement entrer dans les comptes d'autres personnes, d√©j√† sans deuxi√®me facteur. <br><br>  Pour une raison quelconque, les clients de ce r√©seau sont les moins prot√©g√©s contre la fraude, j'ai donc essay√© √† plusieurs reprises de transmettre des informations √† l'entreprise.  J'ai √©crit trois fois en ao√ªt √† l'adresse indiqu√©e sur la page de candidature sur le Play Market - je n'ai re√ßu aucune r√©ponse, m√™me automatique. <br><br>  Plus tard, j'ai √©crit √† une entreprise dont ils utilisent le service de distribution SMS.  Ils m'ont r√©pondu qu'il √©tait n√©cessaire de contacter le propri√©taire de l'application mobile, car eux, ne peuvent pas influencer le d√©veloppement et le transfert d'informations de cette soci√©t√©. <br><br>  C'est vrai, mais j'ai suppos√© que le service de messagerie pouvait les affecter en tant que partenaire / client.  De plus, la raison pour laquelle j'ai √©crit au service de messagerie est que la demande GET que j'ai sp√©cifi√©e est pr√©cis√©ment leur d√©veloppement, et la m√™me situation peut tr√®s probablement √™tre v√©cue par leurs autres clients.  J'ai sugg√©r√© qu'il serait souhaitable que le service corrige la logique de distribution - de ne pas transmettre √† la fois les num√©ros de t√©l√©phone des clients et le code √† usage unique dans la demande - ils ne m'ont pas r√©pondu. <br><br><div class="spoiler">  <b class="spoiler_title">Un peu sur la fa√ßon dont j'ai essay√© de transmettre le probl√®me autrement</b> <div class="spoiler_text">  Ensuite, sur le site Web du magasin, j'ai √©crit √† l'e-mail de contact, j'ai attendu - et encore rien.  Mais comme je suis t√™tu, j'ai trouv√© sur le m√™me site tous les contacts possibles (bo√Ætes mail g√©n√©rales et adresses personnelles) et je leur ai √©crit - comme vous le savez, personne n'a r√©pondu non plus. <br>  Par cons√©quent, plus tard, je me suis tourn√© vers le chat et directement dans le chat, j'ai demand√© s'ils avaient re√ßu mes lettres.  Au d√©but, ils ont r√©pondu qu'ils ne voyaient pas, puis ils ont trouv√© et promis qu'ils le donneraient. <br></div></div><br>  Fait int√©ressant, en plus de l'absence de r√©action √† l'e-mail √† l'adresse principale de l'application, apr√®s avoir bavard√©, j'ai re√ßu des lettres.  Dans l'un d'eux, j'ai vu comment ils m'ont amen√© dans le syst√®me: "Homme intelligent" <br><br><img src="https://habrastorage.org/webt/jo/ro/fp/jorofpagidbbwkbn96uoo9itapc.png"><br><br>  Attitude moyenne envers le client. <br><br>  Lors de ma derni√®re v√©rification, il n'y avait aucun correctif d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Avrora</a> . <br>  Il n'y a pas eu non plus de corrections de la part du service de distribution, mais ici la situation est plus grave, donc je n'indique pas directement le nom du service. <br><br><hr><br>  <b>3. Une application mobile pour stocker des cartes de r√©duction et effectuer des paiements mobiles (plus de 130 000 clients)</b> <br><br>  √Ä l'entr√©e, vous devez saisir uniquement l'e-mail et le code.  Dans ce cas, la requ√™te est ex√©cut√©e: <br><br><pre> <code class="plaintext hljs">POST http://api.somewallet.com/mobileclient.svc/getRegistrationCode HTTP/1.1 Content-Type: application/json; charset=UTF-8 Content-Length: 100 Host: api.somewallet.com Connection: Keep-Alive Accept-Encoding: gzip User-Agent: okhttp/3.12.3 {"request":{"Culture":"ru_RU","DeviceIdentifier":"4514825570005447","Identifier":"some@email"}}</code> </pre> <br>  Voici la r√©ponse: <br><br><pre> <code class="plaintext hljs">{"GetRegistrationCodeResult":{"ErrorMessage":{"Code":0,"LogReferenceId":0,"Message":"SUCCESS"},"Data":{"Code":"044912"}}}</code> </pre> <br><br>  Ici, la r√©ponse indique √©galement le code √† saisir (044912). <br><br>  Une fois connect√©, j'ai eu acc√®s aux fonctions suivantes: <br><br><ul><li>  afficher les cartes de fid√©lit√© et les bonus sur celles-ci, </li><li>  des coupons pour certains magasins, </li><li>  coordonn√©es du client (num√©ros de t√©l√©phone et e-mail, date de naissance et nom) </li><li>  d√©finition, modification et suppression d'un code d'acc√®s √† 4 chiffres, </li><li>  voir les cartes de paiement </li><li>  recevoir un jeton de paiement (similaire au jeton de mon article pr√©c√©dent <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment conduire un taxi aux frais de quelqu'un d'autre</a> ). </li></ul><br>  Ainsi, toutes les fonctions de l'application pourraient √™tre accessibles √† toute personne qui indique simplement l'adresse e-mail de l'utilisateur de cette application - vous n'avez pas besoin de trouver un code unique de l'utilisateur, car il est visible imm√©diatement lors de l'entr√©e.  Le probl√®me est identique aux deux autres. <br><br>  Ils ont r√©pondu √† mon message, corrig√© la vuln√©rabilit√© et les ont remerci√©s financi√®rement. <br><br><hr><br>  Nous pouvons dire que parfois, dans les services, vous pouvez contourner l'authentification √† deux facteurs simplement en examinant les demandes d'autorisation.  Et cela affecte √† la fois les sites Web et les applications mobiles.  Donc, la prochaine fois que vous d√©veloppez ou testez des services avec un compte personnel, faites attention √† cela. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr465791/">https://habr.com/ru/post/fr465791/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr465779/index.html">Provisionnement automatique Yealink T19 + Carnet d'adresses dynamique</a></li>
<li><a href="../fr465781/index.html">Comment j'ai fait un disjoncteur Okhttp personnalis√© √† travers les coroutines de Kotlin</a></li>
<li><a href="../fr465783/index.html">Jeu russe dev, vide de sens et impitoyable</a></li>
<li><a href="../fr465787/index.html">Aime la ch√®vre</a></li>
<li><a href="../fr465789/index.html">Formation Cisco 200-125 CCNA v3.0. Jour 29. PAT et NAT</a></li>
<li><a href="../fr465793/index.html">Frontend Weekly Digest (26 ao√ªt - 1er septembre 2019)</a></li>
<li><a href="../fr465795/index.html">Le condens√© de mati√®res fra√Æches du monde du front-end de la derni√®re semaine n ¬∞ 378 (26 ao√ªt - 1er septembre 2019)</a></li>
<li><a href="../fr465797/index.html">Algorithmes g√©n√©tiques (ou le client est toujours roi - et souvent un idiot)</a></li>
<li><a href="../fr465801/index.html">Food Design Digest, ao√ªt 2019</a></li>
<li><a href="../fr465803/index.html">Maven-way pour construire des projets Go</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>