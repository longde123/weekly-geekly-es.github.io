<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🎨 🚩 👏🏾 Autonomes Fahren auf dem Bürgersteig mit OpenCV und Tensorflow 🉐 🗣️ 🕞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die Schaffung autonomer Autos ist mittlerweile ein beliebtes Thema, und hier auf Amateurebene passieren viele interessante Dinge. 

 Der älteste und b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Autonomes Fahren auf dem Bürgersteig mit OpenCV und Tensorflow</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439928/">  Die Schaffung autonomer Autos ist mittlerweile ein beliebtes Thema, und hier auf Amateurebene passieren viele interessante Dinge. <br><br>  Der älteste und bekannteste Kurs war ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Online-Abschluss von Udacity</a> . <br><br>  In autonomen Maschinen gibt es also einen sehr modischen Ansatz - das Klonen von Verhalten, dessen Kern darin besteht, dass der Computer lernt, sich wie eine Person (am Steuer) zu verhalten, wobei er sich nur auf aufgezeichnete Eingabe- und Ausgabedaten stützt.  Grob gesagt gibt es eine Basis von Bildern von der Kamera und den entsprechenden Lenkwinkel. <br><a name="habracut"></a><br>  Nachdem wir ein neuronales Netzwerk auf diese Daten trainiert haben, können wir es theoretisch eine Maschine antreiben lassen. <br>  Dieser Ansatz basiert auf einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel von Nvidia</a> . <br><br>  Es gibt viele Implementierungen, die hauptsächlich von Udacity-Studenten durchgeführt werden: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zeiten</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zwei</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Drei</a> </li></ul><br>  Noch interessanter ist die Anwendung in realen Projekten.  Zum Beispiel wird das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Donkey Car</a> von einem speziell trainierten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">neuronalen Netzwerk</a> gesteuert. <br><br>  Eine solch gesättigte Infosphäre treibt die Aktion direkt voran, zumal mein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Robotertank</a> seit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">letzten Artikel</a> eine Sackgasse in seiner Entwicklung erreicht hat und dringend neue Ideen brauchte.  Es gab einen kühnen Traum - mit seinem Panzer im Park spazieren zu gehen, was im Allgemeinen nicht schlimmer ist als ein Haushund.  Der Punkt ist klein - um dem Panzer beizubringen, auf dem Bürgersteig im Park zu fahren. <br><br>  Was ist ein Bürgersteig in Bezug auf einen Computer? <br><br>  Einige Bereiche im Bild unterscheiden sich farblich von anderen Bereichen. <br><br>  So kam es, dass sich in den für mich zugänglichen Parks der Bürgersteig als das graueste Objekt auf dem Bild herausstellte. <br><br>  (Die graueste bezieht sich auf die minimale Differenz zwischen den RGB-Werten).  Dies ist eine graue Eigenschaft und wird für die Erkennung von Gehwegen von entscheidender Bedeutung sein. <br><br>  Ein weiterer wichtiger Parameter von Grau ist die Helligkeit.  Herbstfotos bestehen etwas weniger als vollständig aus Grau, so dass die Unterschiede zwischen Straße und Bordstein nur in Schattierungen bestehen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bm/ms/-r/bmms-r_lkka2o98ijtar60bcabu.jpeg" alt="Panzer in einem Park"></div><br>  Einige der naheliegendsten Ansätze sind die Vorkalibrierung - positionieren Sie den Roboter so, dass die Straße den größten Teil des Bildschirms einnimmt und <br><br><ul><li>  durchschnittliche Helligkeit nehmen (im HSV-Format) </li><li>  oder ein durchschnittliches RGB-Stück, das garantiert aus Straße besteht (in diesem Fall ist es die untere linke Ecke). </li></ul><br>  Nachdem wir solche Kriterien für die Erkennung des Bürgersteigs festgelegt haben, laufen wir durch das Bild und erhalten eine Form der Straße. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2l/ee/zp/2leezpaaxpxj2itjjzkosogz7js.jpeg"></div><br>  Der nächste Schritt besteht darin, den grellen Punkt in Aktion zu versetzen - gehen Sie geradeaus oder biegen Sie rechts oder links ab. <br><br>  Wir fahren geradeaus, wenn die rechte Kante sichtbar ist und der Winkel weniger als 45 Grad zur Vertikalen beträgt. <br><br>  Wir biegen nach links ab, wenn der rechte Rand sichtbar ist und der Winkel von der Vertikalen nach unten abweicht. <br>  Biegen Sie rechts ab, wenn wir den rechten Rand nicht sehen. <br><br>  Der rechte Rand des grellen Flecks - die Verwendung von Geometrie zur Lösung dieses Problems ist ziemlich freudlos.  Besser, wenn der künstliche Verstand nach Neigungsmustern in diesen Fetzen sucht. <br><br>  Hier kommen die neuronalen Netze zur Rettung. <br><br>  Originalbilder werden ausgewaschen, zusammengedrückt und beschnitten, wir erkennen den grauen Bürgersteig und erhalten Schwarz-Weiß-Masken 64x64. <br><br>  Wir zerlegen diese Masken in drei Gruppen - Links, Rechts, Gerade und trainieren den Klassifikator für das neuronale Netzwerk darauf. <br><br>  Das Sammeln und Aufbereiten von Daten ist eine mühsame Aufgabe, die einige Monate gedauert hat. <br><br>  Hier sind Beispielmasken: <br><br>  Links: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uk/hb/he/ukhbhes851fdxkdam0nz6zlelwk.png"></div><br>  Rechts: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/80/wg/0c/80wg0c8krzbnnaenh-dfe_tjgvg.png"></div><br>  Gerade: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qc/4q/2_/qc4q2_fu1j9loatpljcoqbtzmng.png"></div><br>  Um mit einem neuronalen Netzwerk zu arbeiten, habe ich Keras + Tensorflow verwendet. <br><br>  Anfangs gab es die Idee, die Struktur des neuronalen Netzwerks von Nvidia zu übernehmen, aber offensichtlich ist es für mehrere andere Aufgaben ausgelegt und kommt mit der Klassifizierung nicht sehr gut zurecht.  Als Ergebnis stellte sich heraus, dass das einfachste neuronale Netzwerk aus einem Tutorial zur Klassifizierung mehrerer Kategorien durchaus akzeptable Ergebnisse liefert. <br><br><pre><code class="python hljs">model = Sequential() activation = <span class="hljs-string"><span class="hljs-string">"relu"</span></span> model.add(Conv2D(<span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, padding=<span class="hljs-string"><span class="hljs-string">"same"</span></span>, input_shape=input_shape)) model.add(Activation(activation)) model.add(MaxPooling2D(pool_size=(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), strides=(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>))) model.add(Conv2D(<span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, padding=<span class="hljs-string"><span class="hljs-string">"same"</span></span>)) model.add(Activation(activation)) model.add(MaxPooling2D(pool_size=(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), strides=(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>))) model.add(Flatten()) model.add(Dense(<span class="hljs-number"><span class="hljs-number">500</span></span>)) model.add(Activation(activation)) model.add(Dense(cls_n)) opt = SGD(lr=<span class="hljs-number"><span class="hljs-number">0.01</span></span>) model.add(Activation(<span class="hljs-string"><span class="hljs-string">"softmax"</span></span>)) model.compile(loss=<span class="hljs-string"><span class="hljs-string">"categorical_crossentropy"</span></span>, optimizer=opt, metrics=[<span class="hljs-string"><span class="hljs-string">"accuracy"</span></span>])</code> </pre> <br>  Nachdem ich die erste Version des Netzwerks trainiert hatte, stieß ich auf dessen Inkompatibilität mit dem Raspberry Pi.  Vorher habe ich Tensorflow Version 1.1 verwendet und Schamanismus verwendet, der von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einer sehr klugen Person</a> gesammelt wurde. <br><br>  Leider ist diese Version veraltet und konnte keine Modelle von Keras lesen. <br><br>  Vor kurzem sind Google-Leute jedoch endlich heruntergekommen und haben TF unter dem Raspberry Pi gesammelt, allerdings unter der neuen Version von Raspbian - Stretch.  Stretch war gut für alle, aber vor einem Jahr hatte ich kein OpenCV dafür, also ging der Tank an Jessie. <br><br>  Jetzt musste ich unter dem Druck der Veränderung zu Stretch wechseln.  Tensorflow stand problemlos auf (obwohl es mehrere Stunden dauerte).  OpenCV stand auch ein Jahr lang nicht still und Version 4.0 wurde bereits veröffentlicht.  Also schaffte sie es, es unter Stretch zu sammeln, so dass es keine Hindernisse für die Migration gab. <br><br>  Es gab Zweifel, wie Raspberry ein Monster wie Tensorflow in Echtzeit ziehen würde, aber alles stellte sich als allgemein akzeptabel heraus - trotz der anfänglichen Belastung des Netzwerks für einige Sekunden kann die Klassifizierung selbst mehrmals pro Sekunde ohne signifikanten Speicher- und CPU-Verbrauch funktionieren. <br><br>  Infolgedessen treten die meisten Probleme und Fehler genau in der Phase der Erkennung der Straße auf. <br>  Das neuronale Netzwerk fehlt trotz der Einfachheit der Struktur sehr selten. <br><br>  Mit aktualisierter Firmware schneidet der Tank durch den Park. <br><br>  Aufgrund der erlittenen Verletzungen bläst der Roboter ständig nach rechts, so dass er ohne künstliche Intelligenz schnell zum Rasen aufbricht. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tg/lq/8g/tglq8g0ignz9dcq6cex5jiekjzu.gif"></div><br>  Sie können ihn jetzt morgens begleiten und entgegenkommende Hunde erkennen. <br><br>  Referenzen: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Nvidia-Artikel über Deep Learning für autonome Maschinen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Autopilot Training für Eselauto</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Repo mit Tank Firmware</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Repo mit kompiliertem OpenCV für Raspbian</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Repo mit einem Skript und Daten zum Trainieren eines neuronalen Netzwerks</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de439928/">https://habr.com/ru/post/de439928/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de439916/index.html">Auspacken: Dridex Bootloader</a></li>
<li><a href="../de439918/index.html">Auf dem Berg steht Spring Boot ...</a></li>
<li><a href="../de439920/index.html">Automatische Bereitstellung von Funktionen ohne Server von Git</a></li>
<li><a href="../de439922/index.html">IP-Besteuerung in Kasachstan: Wie kann man freiberuflich tätig sein?</a></li>
<li><a href="../de439924/index.html">Das Paketvolumen aus ausländischen Online-Shops stieg um 25%</a></li>
<li><a href="../de439932/index.html">Wie wir Entwicklungsbüros eröffnet haben</a></li>
<li><a href="../de439934/index.html">Geschäftsprozesse. Extrahieren Sie ein BPMN-Modell aus einem Dokument. Teil 1</a></li>
<li><a href="../de439936/index.html">3D-Technologie für die Gießerei: So erstellen Sie in einer Woche eine Form für einen Guss</a></li>
<li><a href="../de439938/index.html">Was zu nennen ist: Datenschutzrichtlinie und Datenschutzrichtlinie</a></li>
<li><a href="../de439940/index.html">Teamlead Conf Msk 2019: Ergebnisse der Anwendungskampagne, Berichte, Überlegungen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>