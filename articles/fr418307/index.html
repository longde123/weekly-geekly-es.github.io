<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíê üòï üö¥üèæ Outils d'apprentissage automatique Apple ü§∂üèº üë®üèΩ‚Äç‚öñÔ∏è üèµÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Au cours des derni√®res ann√©es, le sujet de l'intelligence artificielle et de l'apprentissage automatique a cess√© d'√™tre quelque chose pour les gens du...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Outils d'apprentissage automatique Apple</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redmadrobot/blog/418307/"><p><img src="https://habrastorage.org/webt/si/by/p7/sibyp7evcy3vtvyh7jthlpqh68m.png"></p><br><p>  Au cours des derni√®res ann√©es, le sujet de l'intelligence artificielle et de l'apprentissage automatique a cess√© d'√™tre quelque chose pour les gens du domaine de la fiction et est fermement entr√© dans la vie quotidienne.  Les r√©seaux sociaux proposent d'assister √† des √©v√©nements qui nous int√©ressent, les voitures sur les routes ont appris √† se d√©placer sans chauffeur, et un assistant vocal au t√©l√©phone indique quand il vaut mieux quitter la maison pour √©viter les embouteillages et s'il faut prendre un parapluie avec vous. </p><br><p>  Dans cet article, nous examinerons les outils d'apprentissage automatique propos√©s par les d√©veloppeurs Apple, analyserons ce que l'entreprise a montr√© de nouveau dans ce domaine lors de la WWDC18, et essayer de comprendre comment mettre tout cela en pratique. </p><a name="habracut"></a><br><h2 id="mashinnoe-obuchenie">  Apprentissage automatique </h2><br><p>  Ainsi, l'apprentissage automatique est un processus au cours duquel un syst√®me, utilisant certains algorithmes d'analyse de donn√©es et traitant un grand nombre d'exemples, identifie des mod√®les et les utilise pour pr√©dire les caract√©ristiques de nouvelles donn√©es. </p><br><p>  L'apprentissage automatique est n√© de la th√©orie selon laquelle les ordinateurs peuvent apprendre par eux-m√™mes, pas encore programm√©s pour effectuer certaines actions.  En d'autres termes, contrairement aux programmes conventionnels avec des instructions pr√©d√©finies pour r√©soudre des probl√®mes sp√©cifiques, l'apprentissage automatique permet au syst√®me d'apprendre √† reconna√Ætre ind√©pendamment les mod√®les et √† faire des pr√©dictions. </p><br><h2 id="bnns-i-cnn">  BNNS et CNN </h2><br><p>  Apple utilise la technologie d'apprentissage automatique sur ses appareils depuis un certain temps: Mail identifie les spams, Siri vous aide √† trouver rapidement des r√©ponses √† vos questions, Photos reconna√Æt les visages sur les images. </p><br><p> Lors de la WWDC16, la soci√©t√© a introduit deux API bas√©es sur un r√©seau de neurones - les sous-programmes de r√©seau de neurones de base (BNNS) et les r√©seaux de neurones √† convolution (CNN).  BNNS fait partie du syst√®me Accelerate, qui est la base pour effectuer des calculs rapides sur le CPU, et CNN est la biblioth√®que Metal Performance Shaders qui utilise le GPU.  Vous pouvez en savoir plus sur ces technologies, par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </p><br><h2 id="core-ml-i-turi-create">  Core ML et Turi Create </h2><br><p>  L'ann√©e derni√®re, Apple a annonc√© un cadre qui facilite grandement le travail avec les technologies d'apprentissage automatique - Core ML.  Il est bas√© sur l'id√©e de prendre un mod√®le de donn√©es pr√©-form√© et de l'int√©grer dans votre application en quelques lignes de code. </p><br><p><img src="https://habrastorage.org/webt/eg/dl/rz/egdlrzk40ao2z5a_eijvug8dhbc.png"></p><br><p>  En utilisant Core ML, vous pouvez impl√©menter de nombreuses fonctions: </p><br><ul><li>  d√©finition d'objets dans une photo et une vid√©o; </li><li>  saisie de texte pr√©dictive; </li><li>  suivi et reconnaissance des visages; </li><li>  analyse de mouvement; </li><li>  d√©finition de code √† barres; </li><li>  compr√©hension et reconnaissance du texte; </li><li>  reconnaissance d'image en temps r√©el; </li><li>  stylisation d'image; </li><li>  et bien plus. </li></ul><br><p>  Core ML, quant √† lui, utilise de bas niveau Metal, Accelerate et BNNS, et donc les r√©sultats des calculs sont tr√®s rapides. </p><br><p>  Le noyau prend en charge les r√©seaux de neurones, les mod√®les lin√©aires g√©n√©ralis√©s, l'ing√©nierie des fonctionnalit√©s, les algorithmes de prise de d√©cision bas√©s sur des arbres (ensembles d'arbres), la m√©thode des machines √† vecteurs de support, les mod√®les de pipeline. </p><br><p>  Mais Apple n'a pas initialement montr√© ses propres technologies pour cr√©er et former des mod√®les, mais a seulement fait un convertisseur pour d'autres cadres populaires: Caffe, Keras, scikit-learn, XGBoost, LIBSVM. </p><br><p>  L'utilisation d'outils tiers n'√©tait souvent pas la t√¢che la plus facile, les mod√®les form√©s √©taient assez volumineux et la formation elle-m√™me prenait beaucoup de temps. </p><br><p>  √Ä la fin de l'ann√©e, la soci√©t√© a pr√©sent√© Turi Create - un cadre pour les mod√®les de formation, dont l'id√©e principale √©tait la facilit√© d'utilisation et la prise en charge d'un grand nombre de sc√©narios - classification d'images, d√©finition d'objets, syst√®mes de recommandation, et bien d'autres.  Mais Turi Create, malgr√© sa relative facilit√© d'utilisation, ne supportait que Python. </p><br><h2 id="create-ml">  Cr√©er ML </h2><br><p>  Et cette ann√©e, Apple, en plus de Core ML 2, a enfin montr√© son propre outil de formation pour les mod√®les - le framework Create ML utilisant les technologies natives d'Apple - Xcode et Swift. </p><br><p>  Cela fonctionne rapidement et la cr√©ation de mod√®les de mod√®les avec Create ML est vraiment facile. </p><br><p>  √Ä la WWDC, les performances impressionnantes de Create ML et Core ML 2 ont √©t√© annonc√©es en utilisant l'exemple de l'application Memrise.  Si auparavant, il fallait 24 heures pour former un mod√®le en utilisant 20 000 images, alors Create ML r√©duit ce temps √† 48 minutes sur le MacBook Pro et jusqu'√† 18 minutes sur l'iMac Pro.  La taille du mod√®le entra√Æn√© est pass√©e de 90 Mo √† 3 Mo. </p><br><p>  Create ML vous permet d'utiliser des images, des textes et des objets structur√©s comme des tableaux, par exemple, comme donn√©es source. </p><br><p><img src="https://habrastorage.org/webt/uk/di/2e/ukdi2ewm3e2ax6bbr3ceu_fymlu.png"></p><br><h2 id="klassifikaciya-izobrazheniy">  Classification d'image </h2><br><p>  Voyons d'abord comment fonctionne la classification des images.  Pour former le mod√®le, nous avons besoin d'un premier ensemble de donn√©es: nous prenons trois groupes de photos d'animaux: chiens, chats et oiseaux et les distribuons dans des dossiers avec les noms correspondants, qui deviendront les noms des cat√©gories du mod√®le.  Chaque groupe contient 100 images avec une r√©solution allant jusqu'√† 1920 √ó 1080 pixels et une taille allant jusqu'√† 1 Mo.  Les photographies doivent √™tre aussi diff√©rentes que possible afin que le mod√®le form√© ne se fonde pas sur des signes tels que la couleur de l'image ou l'espace environnant. </p><br><p><img src="https://habrastorage.org/webt/w8/oz/_9/w8oz_9t_3_0fyz86xusotsdp9zi.png"></p><br><p>  De plus, pour v√©rifier dans quelle mesure un mod√®le form√© g√®re la reconnaissance d'objets, vous avez besoin d'un ensemble de donn√©es de test - des images qui ne figurent pas dans l'ensemble de donn√©es d'origine. </p><br><p>  Apple propose deux fa√ßons d'interagir avec Create ML: en utilisant l'interface utilisateur sur le Maccode Playground Xcode et par programme en utilisant CreateMLUI.framework et CreateML.framework.  En utilisant la premi√®re m√©thode, il suffit d'√©crire quelques lignes de code, de transf√©rer les images s√©lectionn√©es vers la zone sp√©cifi√©e et d'attendre que le mod√®le apprenne. </p><br><p><img src="https://habrastorage.org/webt/b6/zb/w_/b6zbw_ihfbmt2lx0ovib4nmkfsk.gif"></p><br><p>  Sur le Macbook Pro 2017 dans la configuration maximale, la formation a dur√© 29 secondes pendant 10 it√©rations et la taille du mod√®le form√© √©tait de 33 Ko.  C'est impressionnant. </p><br><p>  Essayons de comprendre comment nous avons r√©ussi √† atteindre ces indicateurs et ce qui est ¬´sous le capot¬ª. <br>  La classification des images est l'une des utilisations les plus populaires des r√©seaux de neurones convolutifs.  Tout d'abord, cela vaut la peine d'expliquer ce qu'ils sont. </p><br><p>  Une personne, voyant une image d'un animal, peut rapidement l'attribuer √† une certaine classe sur la base de toute caract√©ristique distinctive.  Un r√©seau de neurones agit de mani√®re similaire en recherchant des caract√©ristiques de base.  Prenant le tableau initial de pixels comme entr√©e, il transmet s√©quentiellement des informations √† travers des groupes de couches convolutives et construit des abstractions de plus en plus complexes.  Sur chaque calque suivant, elle apprend √† mettre en √©vidence certaines caract√©ristiques - ce sont d'abord des lignes, puis des ensembles de lignes, des formes g√©om√©triques, des parties du corps, etc.  Sur la derni√®re couche, nous obtenons la conclusion d'une classe ou d'un groupe de classes probables. </p><br><p>  Dans le cas de Create ML, l'entra√Ænement du r√©seau neuronal n'est pas effectu√© √† partir de z√©ro.  Le cadre utilise un r√©seau de neurones pr√©alablement form√© sur un √©norme ensemble de donn√©es, qui comprend d√©j√† un grand nombre de couches et a une grande pr√©cision. </p><br><p><img src="https://habrastorage.org/webt/go/qu/el/goquell4agcijc9duege4cg1ydw.png"></p><br><p>  Cette technologie est appel√©e apprentissage par transfert.  Avec lui, vous pouvez changer l'architecture d'un r√©seau pr√©-form√© afin qu'il soit adapt√© √† la r√©solution d'un nouveau probl√®me.  Le r√©seau modifi√© est ensuite form√© sur un nouvel ensemble de donn√©es. </p><br><p>  Cr√©ez ML pendant l'entra√Ænement des extraits de la photo d'environ 1000 caract√©ristiques distinctives.  Cela peut √™tre la forme des objets, la couleur des textures, l'emplacement des yeux, les tailles et bien d'autres. <br>  Il convient de noter que l'ensemble de donn√©es initial sur lequel le r√©seau de neurones utilis√© est form√©, comme le n√¥tre, peut contenir des photographies de chats, de chiens et d'oiseaux, mais ces cat√©gories ne sont pas sp√©cifiquement attribu√©es.  Toutes les cat√©gories forment une hi√©rarchie.  Par cons√©quent, il est tout simplement impossible d'appliquer ce r√©seau dans sa forme pure - il est n√©cessaire de le recycler sur nos donn√©es. </p><br><p>  √Ä la fin du processus, nous voyons avec quelle pr√©cision notre mod√®le a √©t√© form√© et test√© apr√®s plusieurs it√©rations.  Pour am√©liorer les r√©sultats, nous pouvons augmenter le nombre d'images dans le jeu de donn√©es d'origine ou modifier le nombre d'it√©rations. </p><br><p><img src="https://habrastorage.org/webt/k1/rz/to/k1rzto4lzngwwfo46taxa9vnbms.png"></p><br><p>  Ensuite, nous pouvons tester le mod√®le nous-m√™mes sur un ensemble de donn√©es de test.  Les images qu'il contient doivent √™tre uniques, c'est-√†-dire  N'entrez pas dans l'ensemble source. </p><br><p><img src="https://habrastorage.org/webt/lw/u8/el/lwu8eld5v8q6jwqyeaygwkyzvwi.png"></p><br><p>  Pour chaque image, un indicateur de <em>confiance</em> est affich√© - avec quelle pr√©cision √† l'aide de notre mod√®le la cat√©gorie a √©t√© reconnue. </p><br><p>  Pour presque toutes les photos, √† de rares exceptions pr√®s, ce chiffre √©tait de 100%.  J'ai sp√©cifiquement ajout√© l'image que vous voyez ci-dessus √† l'ensemble de donn√©es de test et, comme vous pouvez le voir, Create ML a reconnu 86% du chien et 13% de l'oiseau. </p><br><p>  La formation sur les mod√®les est termin√©e et il ne nous reste plus qu'√† enregistrer le fichier * .mlmodel et √† l'ajouter √† votre projet. </p><br><p><img src="https://habrastorage.org/webt/vd/ey/xb/vdeyxbibcdbgd3f2jb6ozsrpa_u.png"></p><br><p>  Pour tester le mod√®le, j'ai √©crit une application simple utilisant le framework Vision.  Il vous permet de travailler avec des mod√®les Core ML et de r√©soudre des probl√®mes en les utilisant, tels que la classification d'images ou la d√©tection d'objets. </p><br><p>  Notre application reconna√Ætra l'image de la cam√©ra de l'appareil et affichera la cat√©gorie et le pourcentage de confiance dans la classification. </p><br><p>  Nous initialisons le mod√®le Core ML pour travailler avec Vision et configurons la requ√™te: </p><br><pre><code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupVision</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> visionModel = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">VNCoreMLModel</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: <span class="hljs-type"><span class="hljs-type">AnimalsClassifier</span></span>().model) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">fatalError</span></span>(<span class="hljs-string"><span class="hljs-string">"Can't load VisionML model"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> request = <span class="hljs-type"><span class="hljs-type">VNCoreMLRequest</span></span>(model: visionModel) { (request, error) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> results = request.results <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.handleRequestResults(results) } requests = [request] }</code> </pre> <br><p>  Ajoutez une m√©thode qui traitera les r√©sultats de VNCoreMLRequest.  Nous ne montrons que ceux avec un indicateur de confiance sup√©rieur √† 70%: </p><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleRequestResults</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> results: [</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">])</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> categoryText: <span class="hljs-type"><span class="hljs-type">String?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> { <span class="hljs-type"><span class="hljs-type">DispatchQueue</span></span>.main.async { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.categoryLabel.text = categoryText } } <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> foundObject = results .compactMap({ $<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">VNClassificationObservation</span></span> }) .first(<span class="hljs-keyword"><span class="hljs-keyword">where</span></span>: { $<span class="hljs-number"><span class="hljs-number">0</span></span>.confidence &gt; <span class="hljs-number"><span class="hljs-number">0.7</span></span> }) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { categoryText = <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> category = categoryTitle(identifier: foundObject.identifier) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> confidence = <span class="hljs-string"><span class="hljs-string">"\(round(foundObject.confidence * 100 * 100) / 100)%"</span></span> categoryText = <span class="hljs-string"><span class="hljs-string">"\(category) \(confidence)"</span></span> }</code> </pre><br><p>  Et le dernier - nous ajouterons la m√©thode d√©l√©gu√©e AVCaptureVideoDataOutputSampleBufferDelegate, qui sera appel√©e avec chaque nouvelle image de la cam√©ra et ex√©cutera la demande: </p><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">captureOutput</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> output: AVCaptureOutput, didOutput sampleBuffer: CMSampleBuffer, from connection: AVCaptureConnection)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pixelBuffer = <span class="hljs-type"><span class="hljs-type">CMSampleBufferGetImageBuffer</span></span>(sampleBuffer) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> requestOptions: [<span class="hljs-type"><span class="hljs-type">VNImageOption</span></span>: <span class="hljs-type"><span class="hljs-type">Any</span></span>] = [:] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cameraIntrinsicData = <span class="hljs-type"><span class="hljs-type">CMGetAttachment</span></span>( sampleBuffer, key: kCMSampleBufferAttachmentKey_CameraIntrinsicMatrix, attachmentModeOut: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { requestOptions = [.cameraIntrinsics:cameraIntrinsicData] } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> imageRequestHandler = <span class="hljs-type"><span class="hljs-type">VNImageRequestHandler</span></span>( cvPixelBuffer: pixelBuffer, options: requestOptions) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> imageRequestHandler.perform(requests) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(error) } }</code> </pre> <br><p>  V√©rifions dans quelle mesure le mod√®le fait face √† sa t√¢che: </p><br><p><img src="https://habrastorage.org/webt/fy/5k/fl/fy5kflqc3p02w0mo0dwgaar3vle.gif"></p><br><p>  La cat√©gorie est d√©termin√©e avec une pr√©cision assez √©lev√©e, ce qui est particuli√®rement surprenant lorsque l'on consid√®re la rapidit√© de la formation et la petite taille du jeu de donn√©es d'origine.  P√©riodiquement, sur un fond sombre, le mod√®le r√©v√®le des oiseaux, mais je pense que cela peut √™tre facilement r√©solu en augmentant le nombre d'images dans l'ensemble de donn√©es d'origine ou en augmentant le niveau de confiance minimum acceptable. </p><br><p>  Si nous voulons recycler le mod√®le pour classer une autre cat√©gorie, ajoutez simplement un nouveau groupe d'images et r√©p√©tez le processus - cela prendra quelques minutes. </p><br><p>  √Ä titre exp√©rimental, j'ai r√©alis√© un autre ensemble de donn√©es, dans lequel j'ai chang√© toutes les photos de chats sur la photo d'un chat sous diff√©rents angles, mais sur le m√™me fond et dans le m√™me environnement.  Dans ce cas, le mod√®le a presque toujours commis des erreurs et reconnu la cat√©gorie dans une pi√®ce vide, en s'appuyant apparemment sur la couleur comme caract√©ristique cl√©. </p><br><p>  Une autre fonctionnalit√© int√©ressante introduite dans Vision cette ann√©e seulement est la possibilit√© de reconna√Ætre des objets dans l'image en temps r√©el.  Il est repr√©sent√© par la classe VNRecognizedObjectObservation, qui vous permet d'obtenir la cat√©gorie d'un objet et son emplacement - boundingBox. </p><br><p><img src="https://habrastorage.org/webt/fo/96/cb/fo96cbqh0flkktb9umjrfxxofu4.jpeg"></p><br><p>  Maintenant, Create ML ne permet pas de cr√©er des mod√®les pour impl√©menter cette fonctionnalit√©.  Apple sugg√®re d'utiliser Turi Create dans ce cas.  Le processus n'est pas beaucoup plus compliqu√© que ci-dessus: vous devez pr√©parer des dossiers de cat√©gorie avec des photos et un fichier dans lequel pour chaque image les coordonn√©es du rectangle o√π se trouve l'objet seront indiqu√©es. </p><br><h2 id="natural-language-processing">  Traitement du langage naturel </h2><br><p>  La prochaine fonction Create ML consiste √† former des mod√®les pour classer les textes en langage naturel - par exemple, pour d√©terminer la coloration √©motionnelle des phrases ou d√©tecter le spam. </p><br><p><img src="https://habrastorage.org/webt/xv/fq/48/xvfq489qejhdwl_uitxcc-2yyii.png"></p><br><p>  Pour cr√©er un mod√®le, nous devons collecter un tableau avec l'ensemble de donn√©es d'origine - phrases ou textes entiers affect√©s √† une certaine cat√©gorie, et former le mod√®le √† l'aide de l'objet MLTextClassifier: </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> data = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">try</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MLDataTable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">contentsOf: URL(fileURLWithPath: </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"/Users/CreateMLTest/texts.json"</span></span></span></span></span><span class="hljs-function">)) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">let</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">trainingData, testingData</span></span></span><span class="hljs-function">)</span></span> = data.randomSplit(<span class="hljs-keyword"><span class="hljs-keyword">by</span></span>: <span class="hljs-number"><span class="hljs-number">0.8</span></span>, seed: <span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> textClassifier = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">try</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MLTextClassifier</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">trainingData: trainingData, textColumn: </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"text"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, labelColumn: </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"label"</span></span></span></span></span><span class="hljs-function">) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">try</span></span></span><span class="hljs-function"> textClassifier.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">to: URL(fileURLWithPath: </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"/Users/CreateMLTest/TextClassifier.mlmodel"</span></span></span></span></span><span class="hljs-function">))</span></span></code> </pre> <br><p>  Dans ce cas, le mod√®le entra√Æn√© est de type Classificateur de texte: </p><br><p><img src="https://habrastorage.org/webt/kg/j1/ws/kgj1wst4121ojpwfk73yehmte_m.png"></p><br><h2 id="tablichnye-dannye">  Donn√©es tabulaires </h2><br><p>  Examinons de plus pr√®s une autre caract√©ristique de Create ML - la formation d'un mod√®le √† l'aide de donn√©es structur√©es (tableaux). </p><br><p>  Nous allons √©crire une application de test qui pr√©dit le prix d'un appartement en fonction de son emplacement sur la carte et d'autres param√®tres sp√©cifi√©s. </p><br><p>  Nous avons donc un tableau avec des donn√©es abstraites sur les appartements √† Moscou sous forme de fichier csv: la superficie de chaque appartement, l'√©tage, le nombre de chambres et les coordonn√©es (latitude et longitude) sont connus.  De plus, le co√ªt de chaque appartement est connu.  Plus le centre est proche ou plus la zone est grande, plus le prix est √©lev√©. </p><br><p><img src="https://habrastorage.org/webt/hd/-w/77/hd-w77qhysj80_kapqbqddwdhyi.png"></p><br><p>  La t√¢che de Create ML sera de construire un mod√®le capable de pr√©dire le prix d'un appartement en fonction de ces caract√©ristiques.  Une telle t√¢che dans l'apprentissage automatique est appel√©e t√¢che de r√©gression et est un exemple classique d'apprentissage avec un enseignant. </p><br><p>  Create ML prend en charge de nombreux mod√®les - r√©gression lin√©aire, r√©gression d'arbre de d√©cision, classificateur d'arbre, r√©gression logistique, classificateur de for√™t al√©atoire, r√©gression d'arbres boost√©s, etc. </p><br><p>  Nous utiliserons l'objet MLRegressor, qui s√©lectionnera la meilleure option en fonction des donn√©es d'entr√©e. <br>  Tout d'abord, initialisez l'objet MLDataTable avec le contenu de notre fichier csv: </p><br><pre> <code class="hljs lisp">let trainingFile = URL(<span class="hljs-name"><span class="hljs-name">fileURLWithPath</span></span>: <span class="hljs-string"><span class="hljs-string">"/Users/CreateMLTest/Apartments.csv"</span></span>) let apartmentsData = try MLDataTable(<span class="hljs-name"><span class="hljs-name">contentsOf</span></span>: trainingFile)</code> </pre> <br><p>  Nous divisons l'ensemble de donn√©es initial en donn√©es pour la formation et les tests du mod√®le dans un pourcentage de 80/20: </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> (trainingData, testData) = apartmentsData.randomSplit(<span class="hljs-keyword"><span class="hljs-keyword">by</span></span>: <span class="hljs-number"><span class="hljs-number">0.8</span></span>, seed: <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br><p>  Nous cr√©ons le mod√®le MLRegressor, indiquant les donn√©es pour la formation et le nom de la colonne dont nous voulons pr√©dire les valeurs.  Le type de r√©gresseur sp√©cifique √† la t√¢che (lin√©aire, arbre de d√©cision, arbre boost√© ou for√™t al√©atoire) sera automatiquement s√©lectionn√© en fonction de l'√©tude des donn√©es d'entr√©e.  Nous pouvons √©galement sp√©cifier des colonnes d'entit√©s - des colonnes de param√®tres sp√©cifiques pour l'analyse, mais dans cet exemple, cela n'est pas n√©cessaire, nous utiliserons tous les param√®tres.  √Ä la fin, enregistrez le mod√®le form√© et ajoutez-le au projet: </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> model = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> <span class="hljs-type"><span class="hljs-type">MLRegressor</span></span>(trainingData: apartmentsData, targetColumn: <span class="hljs-string"><span class="hljs-string">"Price"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> modelPath = <span class="hljs-type"><span class="hljs-type">URL</span></span>(fileURLWithPath: <span class="hljs-string"><span class="hljs-string">"/Users/CreateMLTest/ApartmentsPricer.mlmodel"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> model.write(to: modelPath, metadata: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)</code> </pre> <br><p><img src="https://habrastorage.org/webt/xv/ci/-e/xvci-e7bhoxwfpvwtjdmwqwwhv0.png"></p><br><p>  Dans cet exemple, nous voyons que le type de mod√®le est d√©j√† Pipeline Regressor, et le champ Description contient le type de r√©gresseur s√©lectionn√© automatiquement - Boosted Tree Regression Model.  Les param√®tres Entr√©es et Sorties correspondent aux colonnes du tableau, mais leur type de donn√©es est devenu Double. </p><br><p>  V√©rifiez maintenant le r√©sultat. <br>  Initialisez l'objet mod√®le: </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> model = <span class="hljs-type"><span class="hljs-type">ApartmentsPricer</span></span>()</code> </pre> <br><p>  Nous appelons la m√©thode de pr√©diction, en lui passant les param√®tres sp√©cifi√©s: </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> area = Double(areaSlider.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> floor = Double(floorSlider.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rooms = Double(roomsSlider.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> latitude = annotation.coordinate.latitude <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> longitude = annotation.coordinate.longitude <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> prediction = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? model.prediction( area: area, floor: floor, rooms: rooms, latitude: latitude, longitude: longitude)</code> </pre><br><p>  Nous affichons la valeur pr√©dite du co√ªt: </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> price = prediction?.price priceLabel.text = formattedPrice(price)</code> </pre> <br><p>  En modifiant un point sur la carte ou les valeurs des param√®tres, nous obtenons le prix de l'appartement assez proche de nos donn√©es de test: </p><br><p><img src="https://habrastorage.org/webt/pu/j-/v1/puj-v1m8x0ghkxrh1fwogdejxfu.png"></p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Le framework Create ML est d√©sormais l'un des moyens les plus simples de travailler avec les technologies d'apprentissage automatique.  Il ne permet pas encore de cr√©er des mod√®les pour r√©soudre certains probl√®mes: reconnaissance d'objets dans une image, stylisation d'une photo, d√©termination d'images similaires, reconnaissance d'actions physiques bas√©es sur les donn√©es d'un acc√©l√©rom√®tre ou d'un gyroscope, que Turi Create, par exemple, g√®re. </p><br><p>  Mais il convient de noter qu'Apple a r√©alis√© des progr√®s assez importants dans ce domaine au cours de l'ann√©e √©coul√©e et, √† coup s√ªr, nous verrons bient√¥t le d√©veloppement des technologies d√©crites. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr418307/">https://habr.com/ru/post/fr418307/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr418295/index.html">Presque tout ce que vous vouliez savoir sur la virgule flottante dans ARM, mais aviez peur de demander</a></li>
<li><a href="../fr418297/index.html">Courte critique du smartphone Neffos N1</a></li>
<li><a href="../fr418301/index.html">La grande confrontation de Mars en 2018: comment observer et √† quoi s'attendre</a></li>
<li><a href="../fr418303/index.html">Vanessa-Automation - un outil pour tester des solutions applicatives sur la plateforme 1C: Enterprise</a></li>
<li><a href="../fr418305/index.html">Combien d'objets Python √©met-il lors de l'ex√©cution de scripts?</a></li>
<li><a href="../fr418309/index.html">Comment le satellite astronomique de Planck a chang√© pour toujours notre perception de l'univers</a></li>
<li><a href="../fr418311/index.html">Courte critique du PC portable Dell Latitude 7390: super-h√©ros d'entreprise</a></li>
<li><a href="../fr418313/index.html">Les 10 meilleurs outils de test d'API</a></li>
<li><a href="../fr418315/index.html">Sans un seul ¬´oops¬ª: les 10 meilleurs rapports de DevOops 2017</a></li>
<li><a href="../fr418317/index.html">2048 est interdit. Pas RosKomNadzor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>