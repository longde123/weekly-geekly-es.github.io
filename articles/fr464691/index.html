<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè∏ üë®üèº‚Äçüîß ü§± Les r√©sultats de la cyber-bataille Standoff, ou comment le centre de s√©curit√© PT Expert a suivi les attaquants üë∂üèø üë©üèæ üêøÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La comp√©tition Standoff s'est tenue pour la quatri√®me fois lors des Positive Hack Days: c'est une cyber bataille entre des √©quipes d'attaquants, de d√©...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Les r√©sultats de la cyber-bataille Standoff, ou comment le centre de s√©curit√© PT Expert a suivi les attaquants</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/464691/"><img src="https://habrastorage.org/webt/z4/9o/zq/z49ozqdn__t4k3ukmmrmnkbryyu.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La</a> comp√©tition <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Standoff</a> s'est tenue pour la quatri√®me fois lors des Positive Hack Days: c'est une cyber bataille entre des √©quipes d'attaquants, de d√©fenseurs et de centres de s√©curit√© experts (SOC) pour le contr√¥le de l'infrastructure de la ville virtuelle F. <br><br>  Les attaquants avaient les m√™mes objectifs que les cybercriminels aspirent habituellement √†: voler de l'argent √† la banque, voler des donn√©es confidentielles, organiser un accident technologique.  Ils ont essay√© de terminer les t√¢ches et les √©quipes de d√©fenseurs, avec les √©quipes SOC, ont assur√© la s√©curit√© de leurs entreprises et √©taient pr√™tes √† repousser rapidement les attaques ennemies.  Cette ann√©e √©galement, des √©quipes de d√©veloppement ont rejoint la comp√©tition: un hackathon a eu lieu dans le cadre de The Standoff, nous en avions d√©j√† parl√© dans un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pr√©c√©dent article</a> . <br><br>  Le bras de fer a √©t√© surveill√© par le Positive Technologies <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Security Center</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PT Expert Security Center</a> ).  Nos sp√©cialistes ont analys√© les √©v√©nements enregistr√©s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">par les outils de protection de Positive Technologies</a> - MaxPatrol SIEM, PT Network Attack Discovery, PT Application Firewall, PT MultiScanner, PT ISIM.  Avec leur aide, l'image compl√®te de la confrontation a √©t√© restaur√©e.  Dans cet article, nous parlerons de ce qui s'est pass√© sur le site et de la fa√ßon dont les √©quipes ont agi lors des attaques contre diverses entreprises et sur l'infrastructure de la ville.  Pour ceux qui sont trop paresseux pour lire les longues lectures, il existe une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">version abr√©g√©e du rapport</a> sur Anti-Malware. <a name="habracut"></a><br><br><h2>  Infrastructure de la ville F </h2><br>  La ville F est devenue beaucoup plus grande qu'auparavant.  Selon l'intrigue, c'√©tait une m√©tropole num√©rique moderne.  Les principales entreprises industrielles de la ville sont les centrales thermiques, les raffineries de p√©trole et les usines chimiques, qui √©taient g√©r√©es par la holding Big Bro Group.  Tous les processus de production √©taient contr√¥l√©s par des syst√®mes de contr√¥le de processus modernes. <br><br>  Dans la ville F, un a√©roport, un port maritime et une voie ferr√©e sont exploit√©s.  Il abritait √©galement le bureau de Hedgehog Airlines et le si√®ge de la compagnie maritime Heavy Ship Logistics.  L'infrastructure de la ville comprenait de nombreux bureaux: Future IT IT Company, Behealthy Insurance Company, City-F Media Group Media Holding et m√™me Voshod Football Club.  La circulation √©tait dense dans les rues et les feux de circulation et l'√©clairage des routes √©taient enti√®rement automatis√©s. <br><br>  La ville √©tait habit√©e par une grande population: les gens travaillaient dans les bureaux et dans la production, vivaient dans des maisons modernes et b√©n√©ficiaient de tous les avantages de la technologie num√©rique - les services de la banque de pi√®ces de monnaie √©lectronique et les services d'acc√®s cellulaire et Internet de l'op√©rateur national de t√©l√©communications Future TeleCom. <br><br>  L'ensemble de l'infrastructure de la ville a √©t√© pr√©sent√©e sous la forme d'un grand agencement sur le lieu de l'√©v√©nement.  La zone d'implantation √©tait d'environ 17 m√®tres carr√©s.  Pour le cr√©er, plus de 3000 arbres artificiels, 467 figures diff√©rentes, 153 m√®tres de rails miniatures et plus de 300 m√®tres de c√¢bles ont √©t√© utilis√©s. <br><br><img src="https://habrastorage.org/webt/kf/9a/dl/kf9adlfrwevsjlyfiqfeh-wtths.jpeg"><br><br><h2>  R√©sultats de la confrontation </h2><br>  La comp√©tition a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">r√©uni</a> 18 √©quipes d'attaque, six √©quipes de d√©fenseurs et trois √©quipes SOC.  Les attaquants ont effectu√© des t√¢ches, pour r√©ussir, ils ont re√ßu de la monnaie virtuelle - le public.  Les d√©fenseurs ont assur√© la s√©curit√© des bureaux qui leur √©taient confi√©s et ont repouss√© les attaques des assaillants.  Les √©quipes SOC ont surveill√© ce qui se passait dans la ville et ont aid√© les √©quipes de d√©fenseurs - elles ont fourni des services pour surveiller l'activit√© du r√©seau, d√©tecter et enqu√™ter sur les incidents. <br><br>  Cinq bureaux ayant la m√™me configuration initiale (le bureau d'une compagnie d'assurance, d'une compagnie a√©rienne, d'un club de football, d'une soci√©t√© de m√©dias et d'une soci√©t√© informatique) √©taient sous la supervision d'avocats qui devaient v√©rifier √† l'avance les vuln√©rabilit√©s des syst√®mes, prendre des mesures pour √©liminer les lacunes identifi√©es et √©tablir leurs propres recours.  Une √©quipe distincte de d√©fenseurs a assur√© la s√©curit√© de la E-Coin Bank, mais n'a pas particip√© au classement g√©n√©ral.  Les segments restants de l'infrastructure de jeu n'ont pas √©t√© prot√©g√©s (comme c'est parfois le cas dans la vie). <br><br>  L'√©quipe True0x3A a √©t√© la premi√®re √† s'emparer du bureau de la holding Big Bro Group et l'a longtemps gard√© sous son contr√¥le.  Cependant, plus tard, l'√©quipe a re√ßu l'acc√®s au bureau.  Les attaquants ont tent√© de prendre le contr√¥le de l'infrastructure les uns des autres et, en cons√©quence, ont conserv√© leur pr√©sence sur des n≈ìuds distincts du domaine et ont pu effectuer des t√¢ches en parall√®le. <br><br>  Ces deux √©quipes ont pu perturber les processus de production du segment ACS.  Les participants du "CARK" ont organis√© une panne dans l'installation de stockage de p√©trole, acc√©dant au SCADA, d'o√π il √©tait possible de contr√¥ler les pompes pour l'approvisionnement en p√©trole.  True0x3A a √©galement eu acc√®s √† la gestion du p√©trole, d√©clenchant presque une urgence, et a √©teint l'√©clairage dans les rues de la ville. <br><br>  Future TeleCom, un op√©rateur t√©l√©com, a √©galement souffert de cyberattaques: certaines √©quipes ont r√©ussi √† se connecter √† un plan tarifaire rentable, dans le cadre duquel les abonn√©s b√©n√©ficiaient d'une qualit√© de communication am√©lior√©e m√™me avec une charge excessive sur le r√©seau mobile. <br><br>  Les participants savaient √† l'avance que l'infrastructure allait changer pendant le jeu: les organisateurs ont pr√©par√© plusieurs surprises qui ont influenc√© les relations entre les entreprises de la ville F et permis aux √©quipes de gagner des points suppl√©mentaires.  Par exemple, le soir du premier jour, il est devenu connu que le groupe Big Bro avait acquis la holding m√©dia City-F Media, et il est donc devenu possible de se d√©placer entre les deux domaines. <br><br>  Vers la fin du jeu, il y a eu une fuite de donn√©es importante: selon l'id√©e des organisateurs, les comptes de domaine dans chacun des segments prot√©g√©s ont √©t√© compromis.  Quatre √©quipes de d√©fenseurs ont rapidement r√©agi aux assaillants, mais l'√©quipe, qui a √©t√© affect√©e au bureau de la compagnie d'assurance Behealthy, n'a pas √©t√© aussi rapide.  Les attaquants sont entr√©s dans le r√©seau sans que les d√©fenseurs les remarquent et ont trouv√© un serveur sur le r√©seau pour lequel les mises √† jour de MS17-010 n'√©taient pas install√©es. <br><br>  Tout au long du jeu, les √©quipes True0x3A et TsARKA √©taient en t√™te avec une large marge par rapport au reste des participants; elles ont r√©alis√© le plus grand nombre de t√¢ches.  Le vainqueur cette ann√©e √©tait l'√©quipe True0x3A (3 023 264 points), et TsARKA (1 261 019 points) a pris la deuxi√®me place.  Parmi les d√©fenseurs, l'√©quipe Jet Security (44 040 600) a marqu√© le plus de points, qui √©tait responsable de la s√©curit√© du bureau de la compagnie de transport Heavy Ship Logistics et n'a pas permis aux assaillants de p√©n√©trer dans son infrastructure.  R√©sultats d√©taill√©s dans le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">classement final</a> . <br><br><h2>  Caract√©ristiques d'attaque </h2><br>  Nous avons examin√© toutes les actions des attaquants selon le mod√®le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MITRE ATT &amp; CK</a> .  Ce mod√®le a √©t√© cr√©√© √† l'origine pour structurer des informations sur les techniques et m√©thodes auxquelles les groupes APT ont recours dans la vie r√©elle.  Ce mod√®le nous permet de d√©montrer des statistiques g√©n√©rales sur les attaques que les √©quipes ont utilis√©es et de montrer clairement lesquelles des techniques ont √©t√© utilis√©es le plus souvent et √† quelles √©tapes.  Sur la carte thermique ci-dessous sont les 100 meilleures techniques qui ont √©t√© utilis√©es par les participants.  Les attaquants ont activement explor√© l'infrastructure, de sorte que les faits de l'analyse des services r√©seau (Network Service Scanning) ont √©t√© le plus souvent r√©v√©l√©s naturellement.  De plus, des tentatives d'exploiter les vuln√©rabilit√©s des services accessibles (exploiter les applications publiques) et des informations d'identification (Brute Force) ont souvent √©t√© enregistr√©es.  Parmi les actions courantes apr√®s avoir p√©n√©tr√© dans les bureaux des entreprises, les participants ont utilis√© des scripts (techniques de script et Powershell), qui sont d√©j√† devenus des m√©thodes classiques pour extraire les informations d'identification et se d√©placer √† travers le r√©seau (Credential Dumping et Pass-the-Hash). <br><br>  Le top 100 comprend des techniques qui sont g√©n√©ralement appliqu√©es au stade de la consolidation dans le r√©seau, par exemple la manipulation de compte, la planification locale des travaux, Web Shell.  Le Standoff ne ressemble pas √† un CTF typique, et la t√¢che des hackers est beaucoup plus compliqu√©e qu'une simple capture de drapeau: les participants attaquent les entreprises de la ville F et prennent le contr√¥le des syst√®mes, il est important pour eux de maintenir leurs positions.  Cette ann√©e, les participants ont particuli√®rement abord√© la consolidation de l'infrastructure pirat√©e et la protection des √©quipes concurrentes.  Tout cela est similaire aux actions des attaquants lors d'un v√©ritable APT. <br><br> <a href=""><img src="https://habrastorage.org/webt/ju/e2/fx/jue2fxg717aq6wxqzbfsljdvqby.png"></a> <br><br>  Pendant le jeu, nos experts ont vu de nombreuses fa√ßons d'organiser l'acc√®s √† distance aux syst√®mes attaqu√©s.  Les participants ont t√©l√©charg√© des shells Web sur les n≈ìuds attaqu√©s, √©tabli des connexions r√©seau √† l'aide de bash, SSH, netcat, Python et Redis-server.  Lors d'attaques sur des n≈ìuds situ√©s dans des bureaux DMZ, les √©quipes attaquantes ont d√ª utiliser des services externes.  Ainsi, en moyenne, les √©quipes disposaient de trois serveurs VPS externes, qu'ils utilisaient pour configurer des connexions inverses et stocker les exploits.  De plus, les services Pastebin ont √©t√© utilis√©s pour stocker des shells et transfer.sh pour t√©l√©charger des fichiers vers un stockage externe.  Bien s√ªr, une m√©thode d'acc√®s populaire consistait √† se connecter aux n≈ìuds √† l'aide du protocole RDP.  Les √©quipes ont √©galement utilis√© des outils d'administration √† distance, en particulier TeamViewer et RAdmin. <br><br>  Un fichier ex√©cutable suspect a √©t√© cr√©√©.  Comme vous pouvez le voir sur la capture d'√©cran de PT MultiScanner, cette application est RAdmin. <br><br><img src="https://habrastorage.org/webt/gj/wb/ck/gjwbck4tw06mky1oddisegh2ydc.png"><br><br>  <i>T√©l√©charger RAdmin</i> <br><br>  Certains participants ont recouru √† la cr√©ation de tunnels VPN.  Par exemple, apr√®s avoir d√©tourn√© un domaine du Big Bro Group, l'√©quipe attaquante a d√©cid√© d'√©tablir une connexion r√©seau directe √† l'int√©rieur de cette infrastructure.  Tout d'abord, il a r√©v√©l√© le t√©l√©chargement et l'installation de l'application OpenVPN au nom du compte administrateur sur le contr√¥leur de domaine principal, et un peu plus tard sur la sauvegarde.  Pour y acc√©der, il a fallu configurer le routage.  Les attaquants ont ajout√© toutes les routes n√©cessaires, apr√®s quoi ils se sont connect√©s avec succ√®s au contr√¥leur de domaine √† l'aide du protocole RDP, mais √† partir du r√©seau VPN. <br><br>  Le routage n'est pas facile, surtout lorsqu'il y en a beaucoup, il est divers et chaotique.  Par cons√©quent, m√™me les ma√Ætres les plus avanc√©s ne parviennent pas toujours √† enregistrer correctement les itin√©raires.  Dans les captures d'√©cran, vous pouvez voir comment les attaquants suppriment les itin√©raires inutiles et en ajoutent de nouveaux. <br><br><img src="https://habrastorage.org/webt/n3/mh/a5/n3mha5thl6p_orf3ipzu--qykq4.png"><br><br><img src="https://habrastorage.org/webt/pi/1f/8a/pi1f8atiee4meji1fyvmtsoj8ha.png"><br><br>  <i>Configuration du routage</i> <br><br>  De fa√ßon inhabituelle, l'√©quipe Another Team a √©t√© not√©e.  Lors d'une attaque contre un service de Hedgehog Airlines, ils ont utilis√© leur outil de langue Go interne pour ancrer.  Les attaquants ont t√©l√©charg√© un script √† partir d'un serveur externe qui ajoute un fichier ex√©cutable au r√©pertoire d'ex√©cution automatique.  Ce fichier cr√©e un tunnel VPN avec un serveur distant et attend qu'un client se connecte au m√™me serveur. <br><br><img src="https://habrastorage.org/webt/gd/_7/ex/gd_7exugwpctne95b3c6ovi4rc0.png"><br><br><img src="https://habrastorage.org/webt/pp/j2/gh/ppj2gh_uuqkidmd0ev3fcsj-giq.png"><br><br>  <i>Ajout d'un fichier ex√©cutable √† l'ex√©cution automatique</i> <br><br>  De plus, nous notons l'utilisation de l'utilitaire 3proxy pour se connecter aux n≈ìuds internes du segment DMZ, ainsi que les utilitaires Responder et Inveigh, qui ont √©t√© utilis√©s pour effectuer des attaques par relais. <br><br>  Nous vous montrons quelles autres techniques d'ancrage les √©quipes ont utilis√©es, √† titre d'exemple d'une attaque contre le Big Bro Group.  Comme nous l'avons dit, le bureau de cette entreprise n'a pas √©t√© d√©fendu, il a donc √©t√© pirat√© tr√®s rapidement.  L'√©quipe True0x3A a √©t√© la premi√®re √† d√©couvrir la vuln√©rabilit√© MS17-010 sur le serveur Remote Desktop Gateway (RDG) sur lequel Windows 2012 R2 a √©t√© install√© et √† l'exploiter imm√©diatement. <br><br>  Pour emp√™cher d'autres √©quipes d'exploiter la m√™me vuln√©rabilit√© et de prendre le contr√¥le de l'infrastructure, les attaquants ont ferm√© le port SMB.  √Ä l'aide de l'utilitaire netsh Windows int√©gr√©, ils ont ajout√© des r√®gles de blocage √† la strat√©gie de pare-feu local, d√©sactivant ainsi l'acc√®s √† l'h√¥te via les protocoles SMB et RPC.  Ils ont √©galement d√©sactiv√© les services du serveur d'acc√®s au terminal, cela √©tait √©vident √† partir des changements dans les valeurs des cl√©s de registre correspondantes.  Quelques minutes plus tard, √† l'aide de l'utilitaire netsh, l'acc√®s aux ports TCP 80 et 443 a √©t√© ferm√©. <br><br><img src="https://habrastorage.org/webt/8u/lg/gb/8ulggbyw7rhnqz3kavpdciuesye.png"><br><br>  <i>Fermeture des ports TCP</i> <br><br>  Les propri√©taires de l'infrastructure du Big Bro Group ont d√©cid√© d'installer les derni√®res mises √† jour du syst√®me d'exploitation afin que les autres membres ne puissent rien casser.  Ils ont lanc√© le service Windows Update sur de nombreux n≈ìuds de domaine, y compris le contr√¥leur de domaine de sauvegarde. <br><br><img src="https://habrastorage.org/webt/mg/kh/3d/mgkh3drvlwfy5y1sz7tsnlaeluu.png"><br><br><img src="https://habrastorage.org/webt/fw/wp/ca/fwwpca1utyzfeyhagq210ki9hwm.png"><br><br>  <i>Installer les mises √† jour du syst√®me d'exploitation</i> <br><br>  Les attaquants ont cr√©√© plusieurs comptes privil√©gi√©s.  √âtant donn√© que l'exploitation de la vuln√©rabilit√© MS17-010 donne √† un attaquant la possibilit√© d'ex√©cuter du code arbitraire avec les privil√®ges du compte SYSTEM, cela lui a permis de cr√©er un nouvel utilisateur et de l'ajouter √† un groupe de s√©curit√© local privil√©gi√©.  Certains nouveaux utilisateurs ont √©t√© ajout√©s au groupe de s√©curit√© du domaine Admins du domaine.  Les privil√®ges accord√©s aux autres utilisateurs ont √©galement √©t√© sp√©cifiquement augment√©s. <br><br><img src="https://habrastorage.org/webt/fx/bs/iy/fxbsiy1cslwmnlzn0qc6zwceoqg.png"><br><br>  <i>Ajout d'un nouveau compte privil√©gi√©</i> <br><br>  L'une des principales fa√ßons d'obtenir des informations d'identification d'utilisateur est de vider le processus lsass et de l'analyser.  En particulier, un tel module est impl√©ment√© dans l'utilitaire mimikatz, utilis√© par les joueurs.  Les tentatives d'extraction des informations d'identification via le module mimikatz ont probablement r√©ussi - le mot de passe de l'administrateur de l'utilisateur du domaine a √©t√© re√ßu.  Cela a √©t√© suivi d'une connexion RDP r√©ussie du serveur RDG au contr√¥leur de domaine. <br><br><img src="https://habrastorage.org/webt/el/lg/5y/ellg5yzh4jugnhbh6tgebni5eps.png"><br><br>  <i>Tentative de r√©cup√©ration des informations d'identification de la m√©moire du syst√®me d'exploitation</i> <br><br>  Pendant la comp√©tition, les organisateurs ont apport√© des modifications √† l'infrastructure de jeu et ouvert de nouvelles opportunit√©s pour gagner des points.  Apr√®s avoir appris qu'il y avait de la crypto-monnaie dans la ville, les attaquants ont rapidement t√©l√©charg√© et install√© des agents mineurs sur l'ensemble de l'infrastructure captur√©e du Big Bro Group.  Le soir du premier jour, les organisateurs ont publi√© la nouvelle de la fusion du groupe Big Bro avec City-F Media.  Conscients de la confiance entre les domaines, les attaquants sont pass√©s au domaine CF-Media.  Appliquant constamment des techniques pour extraire les hachages de mot de passe de la m√©moire du syst√®me d'exploitation et de Pass-the-Hash, ils ont pu obtenir un contr√¥le total sur ce bureau.  Comme dans l'infrastructure pr√©c√©dente du Big Bro Group, les mineurs de crypto-monnaie √©taient distribu√©s de mani√®re centralis√©e et install√©s dans le domaine CF-Media. <br><br>  Le premier jour, un autre √©v√©nement int√©ressant a eu lieu dans les bureaux de Big Bro Group - une confrontation entre les √©quipes True0x3A et TsARKA.  L'√©quipe CARKA a √©galement pu acc√©der √† l'infrastructure de bureau en exploitant la vuln√©rabilit√© CVE-2018-12613 dans phpMyAdmin. <br><br><img src="https://habrastorage.org/webt/61/tc/6d/61tc6dt1vcncp5dk2l3hvvlladu.png"><br><br>  <i>Exploiter la vuln√©rabilit√© CVE-2018-12613 dans phpMyAdmin</i> <br><br>  Un nouveau fichier ex√©cutable a √©t√© ajout√© au r√©pertoire de l'application Web CARKA, qui a cr√©√© une connexion √† un serveur externe 109.233.110.31 situ√© au Kazakhstan.  Puis a commenc√© une analyse du r√©seau de l'infrastructure interne du segment BigBroGroup, et l'analyse a √©t√© lanc√©e par le m√™me fichier ex√©cutable. <br><br> <a href=""><img src="https://habrastorage.org/webt/ij/3v/35/ij3v35eyxbthp3mi-ffnlw3up5a.png"></a> <br><br>  <i>Graphique des connexions r√©seau avec un serveur externe</i> <br><br>  ¬´TSARKA¬ª a rapidement obtenu le maximum de privil√®ges dans le domaine et a essay√© d'en forcer les concurrents en changeant le mot de passe de l'administrateur du domaine.  L'√©quipe True0x3A l'a remarqu√© imm√©diatement et apr√®s quelques minutes, ayant encore plusieurs utilisateurs privil√©gi√©s, elle a elle-m√™me chang√© le mot de passe de l'administrateur de domaine principal et d'autres comptes strat√©giquement importants.  Les manipulations des deux √©quipes avec des mots de passe pour cette courte p√©riode sont partiellement refl√©t√©es dans la figure ci-dessous. <br><br><img src="https://habrastorage.org/webt/e1/n0/9l/e1n09lwnrvnxy0rkxrm8xotsz2c.png"><br><br>  <i>Modifications du mot de passe du compte</i> <br><br>  De plus, pour cr√©er un acc√®s r√©seau alternatif au contr√¥leur de domaine, l'√©quipe True0x3A a configur√© la redirection de port TCP vers leur serveur externe. <br><br><img src="https://habrastorage.org/webt/tb/-b/bi/tb-bbiwpogdfxrshzcv5k8ydkgg.png"><br><br>  <i>Configurer la redirection de port TCP</i> <br><br>  Ce n'est pas pour rien que nous avons remarqu√© que les participants √† True0x3A ont abord√© la phase de consolidation de mani√®re responsable: le fait qu'ils disposaient de comptes privil√©gi√©s et d'un grand nombre de canaux d'acc√®s au r√©seau alternatifs √† l'int√©rieur de l'infrastructure leur a permis de garder le contr√¥le sur certains n≈ìuds du r√©seau et de d√©sactiver le contr√¥leur de domaine.  Finalement, les deux √©quipes (TsARKA et True0x3A) ont continu√© √† travailler sur des n≈ìuds distincts dans le domaine. <br><br><img src="https://habrastorage.org/webt/xs/2q/7j/xs2q7jnoxa-n0y6fmbkqav6yw_q.png"><br><br>  <i>D√©sactiver un contr√¥leur de domaine</i> <br><br>  Les deux m√™mes √©quipes ont pu intervenir dans le processus d'approvisionnement en p√©trole et provoquer une d√©faillance du stockage de p√©trole.  CARKA a trouv√© des postes de travail vuln√©rables √† EternalBlue dans le segment ICS, a acc√©d√© aux syst√®mes SCADA WinCC et Citect, et True0x3A connect√© √† la gestion du contr√¥leur Allen-Bradley CompactLogix. <br><br><img src="https://habrastorage.org/webt/zz/vk/wn/zzvkwnvkl87wjx36xtn_568u8f4.png"><br><br>  <i>Topologie du r√©seau ICS</i> <br><br>  L'√©quipe True0x3A a √©galement √©teint l'√©clairage dans les rues de la ville: les attaquants ont d√©couvert le contr√¥leur Modicon M340 dans le r√©seau ICS, apr√®s quoi ils ont utilis√© le module Metasploit pr√™t √† l'emploi pour l'arr√™ter. <br><br><img src="https://habrastorage.org/webt/oz/uc/cr/ozuccrefwbewfcfwc9l2vyw48q4.png"><br><br>  <i>Cha√Æne d'attaque du contr√¥leur Modicon M340</i> <br><br>  Une heure avant la fin du jeu, les organisateurs ont signal√© un nouvel incident dans la ville: les informations d'identification des utilisateurs du domaine dans chacun des bureaux prot√©g√©s ont √©t√© compromises.  Les attaquants ont imm√©diatement profit√© des informations re√ßues et tent√© de se connecter aux r√©seaux via VPN, mais les d√©fenseurs ont imm√©diatement bloqu√© les connexions suspectes, puis chang√© les mots de passe des comptes compromis.  Ce n'est que dans le bureau de la compagnie d'assurance Behealthy que l'invasion est pass√©e inaper√ßue.  L'√©quipe True0x3A a rapidement effectu√© des reconnaissances au sein du r√©seau et a d√©couvert un serveur Exchange vuln√©rable: lors de la pr√©paration de la comp√©tition, les d√©fenseurs n'ont pas install√© la mise √† jour MS17-010. <br><br><img src="https://habrastorage.org/webt/br/ed/fw/bredfwizzfp62woqvkztq4xtfqi.jpeg"><br><br>  <i>Exploiter la vuln√©rabilit√© CVE-2017-0146 sur un serveur Behealthy</i> <br><br>  Sur le m√™me serveur, les attaquants ont re√ßu un hachage du mot de passe de l'administrateur de domaine et se sont connect√©s avec celui-ci au contr√¥leur de domaine √† l'aide de PsExec. <br><br><img src="https://habrastorage.org/webt/zu/xh/vg/zuxhvg1wef9obwrssafjktwcdgo.png"><br><br>  <i>Se connecter √† un contr√¥leur de domaine Behealthy</i> <br><br>  L'attaque enti√®re contre le bureau Behealthy a pris 7 minutes.  Les experts SOC qui ont collabor√© avec les d√©fenseurs ont constat√© une activit√© anormale, mais n'ont pas r√©ussi √† aider l'√©quipe √† r√©pondre √† l'incident √† temps. <br><br><h2>  Conclusion </h2><br>  L'infrastructure de la ville virtuelle F est la plus proche possible de l'infrastructure d'une ville r√©elle.  Les syst√®mes utilis√©s pour cr√©er divers segments - bureaux d'organisations commerciales, banque, op√©rateur de t√©l√©communications et entreprises industrielles - sont largement utilis√©s dans la pratique, et les vuln√©rabilit√©s et la protection qui leur sont inh√©rentes se retrouvent dans presque tous les r√©seaux r√©els.  Cela distingue The Standoff des autres comp√©titions similaires dans le monde de la s√©curit√© de l'information. <br><br>  Pour contrer les cybercriminels modernes, vous devez conna√Ætre les m√©thodes d'attaque les plus pertinentes et am√©liorer r√©guli√®rement vos comp√©tences.  La concurrence entre les attaquants et les d√©fenseurs dans un environnement de jeu s√ªr est une bonne occasion d'apprendre de nouveaux sc√©narios d'attaque et de trouver des m√©thodes de contre-attaque efficaces.   The Standoff         :     - ,      .                ,   ,       .     SOC             . <br><br>     ?           ,    ,      ,   .       ,         (  True0xA3 ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1 </a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2 </a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3 </a> ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Jet Security Team</a> , Jet Antifraud Team  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Jet CSIRT</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>  You Shall Not Pass).     , PT Expert Security Center       ,               . ,  ,   .           .        ,          . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr464691/">https://habr.com/ru/post/fr464691/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr464677/index.html">Investissements en bourse et co√ªts associ√©s: combien co√ªtent les services d'une soci√©t√© de bourse</a></li>
<li><a href="../fr464679/index.html">Voxgun - un service pour cr√©er du contenu vid√©o professionnel sans effort suppl√©mentaire</a></li>
<li><a href="../fr464685/index.html">T√©l√©graphe optique, r√©seau micro-ondes et tour Tesla: tours de communication inhabituelles</a></li>
<li><a href="../fr464687/index.html">Si vous voulez sauver le monde, le v√©ganisme n'est pas une option</a></li>
<li><a href="../fr464689/index.html">Contenu de Panda Frontend Meetup # 22: plugins, donn√©es sophistiqu√©es, tests, d√©claration angulaire</a></li>
<li><a href="../fr464695/index.html">Mod√®le d'apprentissage automatique interpr√©t√©. Partie 1</a></li>
<li><a href="../fr464701/index.html">Site de d√©marrage efficace: comment les clients, les partenaires et les investisseurs aiment un site</a></li>
<li><a href="../fr464705/index.html">√âcriture d'une API en Python (avec Flask et RapidAPI)</a></li>
<li><a href="../fr464709/index.html">Vivant et vivant: les virus ran√ßongiciels en 2019</a></li>
<li><a href="../fr464711/index.html">La f√©e des dents ne fonctionne pas ici: la structure en √©mail des dents des crocodiles et de leurs anc√™tres pr√©historiques</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>