<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ÅâÔ∏è üöº üö≠ BASS: un marco para la s√≠ntesis autom√°tica de firmas antivirus üì´ ü•ä üèÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos Quedan menos de diez d√≠as para el comienzo del curso de "Ingenier√≠a inversa" . En este sentido, queremos compartir otra traducci√≥n intere...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>BASS: un marco para la s√≠ntesis autom√°tica de firmas antivirus</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/456426/">  Hola a todos  Quedan menos de diez d√≠as para el comienzo del curso de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Ingenier√≠a inversa"</a> . En este sentido, queremos compartir otra traducci√≥n interesante sobre el tema.  Vamos! <br><br><img src="https://habrastorage.org/webt/ff/sk/na/ffsknagvtnwxc02g9xpjlu-0p1i.png"><br><br><h2>  Breve rese√±a </h2><br><img src="https://habrastorage.org/webt/hi/fs/gs/hifsgsy2jdczl7lk9n3zj1luisy.png"><br><br>  La imagen de las amenazas est√° cambiando r√°pidamente: constantemente aparecen nuevos ciberataques y los antiguos se vuelven m√°s sofisticados.  En estas circunstancias, los profesionales de seguridad enfrentan desaf√≠os cada vez m√°s complejos.  Todos los d√≠as, tienen que procesar y analizar millones de muestras de malware previamente desconocido y completamente nuevo, desarrollar firmas antivirus efectivas para describir familias enteras de malware y proporcionar escalabilidad de herramientas a medida que aumenta el n√∫mero de muestras para an√°lisis.  Al mismo tiempo, es necesario tener en cuenta los recursos limitados para las herramientas de automatizaci√≥n de an√°lisis de malware.  Para ayudar a los profesionales de TI a manejar estos diversos desaf√≠os, Talos ofrece una nueva plataforma de c√≥digo abierto llamada BASS. <a name="habracut"></a><br><br>  BASS (le√≠do como "bajo") es un marco para generar autom√°ticamente firmas antivirus basadas en muestras de grupos de c√≥digo malicioso formados previamente.  Su objetivo es reducir el consumo de recursos por el n√∫cleo ClamAV al aumentar la proporci√≥n de firmas basadas en plantillas en relaci√≥n con las firmas hash, y simplificar el trabajo de los analistas que desarrollan firmas basadas en plantillas.  Con el soporte de contenedores Docker, el marco escala bien. <br><br>  Vale la pena se√±alar que hasta ahora solo la versi√≥n alfa de BASS est√° disponible y queda mucho por finalizar.  Este proyecto tiene un c√≥digo fuente abierto, y estamos trabajando activamente en √©l, por lo que estaremos encantados de recibir cualquier comentario de la comunidad y recomendaciones para su mejora.  El c√≥digo fuente de BASS est√° disponible <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br>  El proyecto BASS se anunci√≥ en 2017 en la conferencia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">REcon</a> en Montreal, Canad√°. <br><br><h2>  Relevancia </h2><br>  Los especialistas de Talos reciben m√°s de 1.5 millones de muestras √∫nicas diariamente.  En su mayor parte, se relacionan con amenazas conocidas y son eliminadas inmediatamente por un esc√°ner de malware (ClamAV).  Sin embargo, despu√©s del escaneo, hay muchos archivos que a√∫n necesitan un an√°lisis m√°s detallado.  Los ejecutamos en el sandbox y realizamos an√°lisis din√°micos, lo que nos permite separarlos en otros maliciosos y seguros.  Procesamos las muestras de malware seleccionadas en esta etapa para crear firmas de ClamAV basadas en ellas, lo que ayudar√° a filtrar a√∫n m√°s estas amenazas en una etapa anterior, durante el escaneo. <br><br><img src="https://habrastorage.org/webt/5f/oh/6o/5foh6op04xmtrj7-7wuhy0ifkfm.jpeg"><br><br>  Durante tres meses, de febrero a abril de 2017, se agregaron 560,000 nuevas firmas a la base de datos ClamAV, es decir, un aumento de 9,500 firmas por d√≠a.  Una parte importante de ellos los recibimos autom√°ticamente en forma de firmas hash.  Dichas firmas tienen un inconveniente significativo en comparaci√≥n con las firmas de plantilla o bytecode (estos son otros dos tipos compatibles con el n√∫cleo ClamAV): una firma hash corresponde a un solo archivo.  Adem√°s, un aumento en el n√∫mero de firmas hash conduce al hecho de que la base de datos ClamAV ocupa m√°s memoria.  Es por eso que preferimos las firmas basadas en patrones.  Son mucho m√°s simples y r√°pidos de administrar que el c√≥digo de bytes, y al mismo tiempo le permiten describir grupos completos de archivos. <br><br><h2>  Bajo </h2><br>  El marco BASS est√° dise√±ado para facilitar la creaci√≥n de plantillas basadas en firmas ClamAV.  Los genera autom√°ticamente, procesando segmentos de c√≥digo binario ejecutable. <br><br><img src="https://habrastorage.org/webt/ce/jt/ew/cejtew2tpxdzibmmqztxp88tija.jpeg"><br><br>  BASS toma como base grupos de c√≥digos maliciosos, pero no incluye los medios para crearlos.  Debido a esto, la tecnolog√≠a sigue siendo conveniente y flexible.  Intencionalmente hicimos que la interfaz de entrada fuera universal para que fuera f√°cil adaptarse a las nuevas fuentes de cl√∫steres.  Ahora usamos varias de esas fuentes, incluidos los cl√∫steres basados ‚Äã‚Äãen indicadores de compromiso (IoC) de nuestro entorno limitado, hashing estructural (cuando tenemos un archivo ejecutable intencionalmente malicioso y estamos buscando muestras adicionales que tengan una estructura similar) y malware recibido de campa√±as de spam. <br><br>  En la primera etapa, las instancias maliciosas pasan a trav√©s de los desempaquetadores del n√∫cleo ClamAV.  Puede descomprimir archivos de varios formatos y archivos ejecutables comprimidos (por ejemplo, UPX), y tambi√©n extraer objetos incrustados (como archivos EXE dentro de documentos de Word).  Los artefactos recibidos se analizan cuidadosamente, se recopila informaci√≥n.  Ahora para la siguiente etapa, el filtrado, usamos sus tama√±os y la cadena m√°gica UNIX. <br><br>  Luego se filtra el cl√∫ster de c√≥digo malicioso.  Si los archivos no cumplen con los requisitos de BASS (mientras que la plataforma funciona solo con archivos ejecutables de PE, pero no es dif√≠cil agregar soporte para los archivos binarios ELF y MACH-O), se eliminan del cl√∫ster o, si quedan muy pocos objetos, el cl√∫ster se rechaza por completo. <br><br>  El cl√∫ster filtrado pasa a la fase de generaci√≥n de firma.  Primero, los archivos binarios se desmontan.  Para hacer esto, utilizamos IDA Pro, pero se puede reemplazar f√°cilmente con otro desensamblador con capacidades similares, por ejemplo, radare2. <br><br><img src="https://habrastorage.org/webt/cz/ah/gl/czahglwn1x_oflib8pokrduqeso.jpeg"><br><br>  Despu√©s del desmontaje, es necesario identificar un c√≥digo com√∫n en las muestras para generar firmas sobre la base.  Este paso es importante por dos razones.  Primero, el algoritmo de generaci√≥n de firma requiere recursos computacionales significativos y funciona mejor con segmentos de c√≥digo cortos.  En segundo lugar, es preferible obtener firmas de muestras de c√≥digo que sean similares no solo sint√°cticamente, sino tambi√©n sem√°nticamente.  Para comparar el c√≥digo, utilizamos la utilidad BinDiff.  Una vez m√°s, tambi√©n es f√°cil de reemplazar, y en el futuro podremos integrar otras utilidades en el marco para comparar. <br><br>  Si el cl√∫ster es peque√±o, BinDiff compara cada ejecutable con todos los dem√°s.  De lo contrario, el alcance de la comparaci√≥n se reduce, de lo contrario, el proceso puede ser demasiado largo.  En base a los resultados obtenidos, se construye un gr√°fico donde los v√©rtices denotan las funciones y los bordes indican su similitud.  Para encontrar una buena funci√≥n general, es suficiente encontrar un subgrafo conectado con un alto √≠ndice de similitud general. <br><br><img src="https://habrastorage.org/webt/uz/tk/nt/uztkntwexposekzfrzoskpmfotq.jpeg"><br><br>  El subgrafo ∆í1, ∆í2, ∆í4, ∆í6 con altos indicadores de similitud de v√©rtices (ver la figura anterior) es un excelente candidato para el papel de una funci√≥n com√∫n. <br><br>  Tan pronto como se reclutan varios de estos candidatos, los comparamos con la lista blanca para evitar crear firmas basadas en las funciones ordinarias de las bibliotecas asociadas est√°ticamente con la muestra.  Para hacer esto, las funciones se env√≠an a la instancia de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Kam1n0</a> , cuya base de datos hemos llenado previamente con funciones de muestras obviamente puras.  Si se detecta un clon de cualquier funci√≥n, el procedimiento de selecci√≥n de subgrafo se repite para seleccionar el m√°s adecuado de los restantes.  Si la verificaci√≥n no revela nada, el conjunto de funciones se pasa a la siguiente etapa. <br><br>  Entonces la generaci√≥n de la firma comienza directamente.  Las firmas ClamAV basadas en plantillas est√°n dise√±adas para detectar subsecuencias en datos binarios.  Por lo tanto, aplicamos a todas las funciones extra√≠das el algoritmo de b√∫squeda para la subsecuencia com√∫n m√°s grande (LCS, la subsecuencia com√∫n m√°s larga). <br><br>  Desde el punto de vista computacional, este algoritmo es bastante costoso incluso para dos muestras y es notablemente m√°s dif√≠cil para varias, por lo que utilizamos su variedad heur√≠stica, descrita por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Christian Blichmann</a> .  El resultado podr√≠a verse m√°s o menos as√≠: <br><br><img src="https://habrastorage.org/webt/zb/9_/il/zb9_ilfd2g0rcqw1nw1h5iblsi4.jpeg"><br><br>  Finalmente, debe probarlo antes de publicar la firma.  Verificamos autom√°ticamente la firma utilizando nuestro conjunto de pruebas para detectar falsos positivos.  Para una mayor confiabilidad, utilizamos Sigalyzer, una nueva caracter√≠stica de nuestro complemento <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CASC IDA Pro ClamAV para generar y analizar firmas</a> (se actualizar√° m√°s adelante).  Sigalyzer marca secciones del binario que coinciden con la firma ClamAV que funcion√≥ para √©l.  Por lo tanto, se forma una representaci√≥n visual visual de la firma. <br><br><h2>  Arquitectura </h2><br>  BASS se implementa como un grupo de contenedores Docker.  El marco est√° escrito en Python e interact√∫a con todas las herramientas necesarias a trav√©s de los servicios web.  La arquitectura fue creada por analog√≠a con el proyecto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">VxClass</a> , que tambi√©n gener√≥ firmas ClamAV usando IDA Pro y BinDiff, pero luego se cerrar√≠a y, a diferencia de BASS, no ser√≠a accesible al p√∫blico en general. <br><br><img src="https://habrastorage.org/webt/wg/ma/x2/wgmax2n6nevnscpmjx_lijw9kmq.jpeg"><br><br><h2>  Limitaciones </h2><br>  BASS funciona exclusivamente con ejecutables binarios, ya que la firma se genera a partir del c√≥digo de muestra.  Adem√°s, solo analiza ejecutables x86 y x86_64.  El soporte para otras arquitecturas puede aparecer en el futuro. <br><br>  Hasta ahora, BASS no se adapta bien a los virus de archivos, que incrustan fragmentos de c√≥digo peque√±os y muy diferentes en objetos infectados, y con puertas traseras, que consisten principalmente en c√≥digo binario inofensivo (a menudo robado), que se complementa con funciones maliciosas.  Estamos luchando con estas deficiencias trabajando para optimizar la fase de agrupamiento. <br><br>  Y una vez m√°s, queremos recordarle que BASS se encuentra en la etapa de prueba alfa, y hasta ahora no todo funciona sin problemas.  Pero esperamos beneficiar a la comunidad al desarrollar este marco como un proyecto de c√≥digo abierto, y estaremos encantados de cualquier idea y cr√≠tica. <br><br><h2>  App </h2><br>  <i>La diferencia entre la subcadena com√∫n m√°s grande y la subsecuencia com√∫n m√°s grande</i> <br><br>  La siguiente ilustraci√≥n muestra la diferencia entre la subcadena com√∫n m√°s grande y la subsecuencia com√∫n m√°s grande.  La subsecuencia com√∫n m√°s grande se indica en nuestra publicaci√≥n con el acr√≥nimo ingl√©s LCS. <br><br><img src="https://habrastorage.org/webt/ul/ww/a8/ulwwa8nqjhgoblgtzgq_kkaygfc.jpeg"><br><br>  Eso es todo.  Y ya el 20 de junio ser√° posible familiarizarse en detalle con el programa del curso en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">la jornada de puertas abiertas</a> , que se llevar√° a cabo en el modo de seminario web. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/456426/">https://habr.com/ru/post/456426/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../456414/index.html">Protecci√≥n contra incendios en centros de datos o c√≥mo se almacenan los datos.</a></li>
<li><a href="../456416/index.html">Libro √°gil para todos</a></li>
<li><a href="../456418/index.html">Una breve historia del enga√±o de videojuegos</a></li>
<li><a href="../456422/index.html">Anuncio de una nueva versi√≥n de Styled Components v5: Animal Grin</a></li>
<li><a href="../456424/index.html">Utreexo: comprimiendo una gran cantidad de UTXO Bitcoin</a></li>
<li><a href="../456428/index.html">C√≥mo implementar un enfoque de BI para el an√°lisis de datos: recomendaciones pr√°cticas</a></li>
<li><a href="../456430/index.html">La eterna cuesti√≥n de la deuda t√©cnica.</a></li>
<li><a href="../456432/index.html">Semana de la seguridad 25: vulnerabilidad de Evernote y cientos de tiendas en l√≠nea pirateadas</a></li>
<li><a href="../456434/index.html">Profesiones del futuro: "¬øCon qui√©n trabajar√°s en Marte?"</a></li>
<li><a href="../456436/index.html">Tarea corta de JS para el lunes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>