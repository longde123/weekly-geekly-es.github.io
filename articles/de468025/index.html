<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖕🏼 👨🏿‍🎓 🎍 Wie konfiguriere ich SNI in Zimbra OSE? ✊ 💪🏾 💤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Zu Beginn des 21. Jahrhunderts steht eine Ressource wie IPv4-Adressen kurz vor der Erschöpfung. Bereits 2011 hat die IANA die letzten fünf verbleibend...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie konfiguriere ich SNI in Zimbra OSE?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/zimbra/blog/468025/">  Zu Beginn des 21. Jahrhunderts steht eine Ressource wie IPv4-Adressen kurz vor der Erschöpfung.  Bereits 2011 hat die IANA die letzten fünf verbleibenden Blöcke / 8 aus ihrem Adressraum regionalen Internet-Registraren zugewiesen und bereits 2017 ihre Adressen beendet.  Die Antwort auf den katastrophalen Mangel an IPv4-Adressen war nicht nur das Aufkommen von IPv6, sondern auch die SNI-Technologie, die es ermöglichte, eine große Anzahl von Websites unter einer IPv4-Adresse zu hosten.  Das Wesentliche von SNI ist, dass diese Erweiterung es Clients ermöglicht, dem Server den Namen der Site mitzuteilen, mit der sie während eines Handshakes eine Verbindung herstellen möchten.  Auf diese Weise kann der Server mehrere Zertifikate speichern. Dies bedeutet, dass mehrere Domänen mit derselben IP-Adresse arbeiten können.  Die SNI-Technologie ist besonders beliebt bei SaaS-Anbietern für Unternehmen, die die Möglichkeit haben, eine nahezu unbegrenzte Anzahl von Domains zu hosten, ohne Rücksicht auf die Anzahl der dafür erforderlichen IPv4-Adressen.  Lassen Sie uns herausfinden, wie Sie die SNI-Unterstützung in der Open-Source-Edition der Zimbra Collaboration Suite implementieren können. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e98/93d/7d9/e9893d7d9f995c2a24dce02df7fa5d51.png" alt="Bild"><a name="habracut"></a><br><br>  SNI funktioniert in allen aktuellen und unterstützten Versionen von Zimbra OSE.  Für den Fall, dass Ihr Zimbra Open-Source auf einer Multi-Server-Infrastruktur ausgeführt wird, müssen Sie alle folgenden Aktionen auf dem Knoten ausführen, auf dem der Zimbra Proxy-Server installiert ist.  Darüber hinaus benötigen Sie übereinstimmende Zertifikat + Schlüssel-Paare sowie vertrauenswürdige Zertifikatketten Ihrer Zertifizierungsstelle für jede der Domänen, die Sie auf Ihrer IPv4-Adresse platzieren möchten.  Bitte beachten Sie, dass der Grund für die überwiegende Mehrheit der Fehler bei der Konfiguration von SNI in Zimbra OSE genau in falschen Zertifikatdateien liegt.  Wir empfehlen Ihnen daher, alles sorgfältig zu prüfen, bevor Sie es direkt installieren. <br><br>  Damit SNI normal funktioniert, müssen Sie zunächst den Befehl <b>zmprov mcf zimbraReverseProxySNIEnabled TRUE</b> auf dem Knoten mit dem Zimbra-Proxyserver <b>eingeben</b> und anschließend den Proxy-Dienst mit dem Befehl <b>zmproxyctl restart neu starten</b> . <br><br>  Wir beginnen mit der Erstellung eines Domainnamens.  Zum Beispiel nehmen wir die Domäne <b>company.ru</b> und bestimmen, nachdem die Domäne bereits erstellt wurde, den Namen des virtuellen Zimbra-Hosts und die virtuelle IP-Adresse.  Bitte beachten Sie, dass der Name des virtuellen Zimbra-Hosts dem Namen entsprechen muss, den der Benutzer in die Browserzeile eingeben muss, um Zugriff auf die Domain zu erhalten, und auch mit dem im Zertifikat angegebenen Namen übereinstimmen muss.  Nehmen Sie als Beispiel Zimbra <b>mail.company.ru</b> als virtuellen Hostnamen und verwenden Sie <b>1.2.3.4</b> als virtuelle IPv4-Adresse. <br><br>  <b>Geben Sie danach</b> einfach den Befehl <b>zmprov md company.ru zimbraVirtualHostName mail.company.ru zimbraVirtualIPAddress 1.2.3.4 ein</b> , um den virtuellen Zimbra-Host an die virtuelle IP-Adresse zu binden.  Wir weisen Sie darauf hin, dass Sie sicherstellen müssen, dass alle Anforderungen an die Domäne an die an sie gebundene externe IP-Adresse und nicht an die Adresse im lokalen Netzwerk gesendet werden, wenn sich der Server hinter einem NAT oder einer Firewall befindet. <br><br>  Nachdem alles erledigt ist, müssen nur noch die Domänenzertifikate für die Installation überprüft und vorbereitet und anschließend installiert werden. <br><br>  Wenn das Zertifikat für die Domain korrekt ausgestellt wurde, sollten Sie drei Dateien mit Zertifikaten zur Hand haben: Zwei davon sind Zertifikatsketten Ihrer Zertifizierungsstelle und eines ist ein direktes Zertifikat für die Domain.  Außerdem sollten Sie eine Datei mit dem Schlüssel haben, mit dem Sie das Zertifikat erhalten haben.  Erstellen Sie einen separaten Ordner <b>/tmp/company.ru</b> und legen Sie dort alle verfügbaren Dateien mit Schlüsseln und Zertifikaten ab.  Das Ergebnis sollte ungefähr so ​​aussehen: <br><br><pre><code class="bash hljs">ls /tmp/company.ru company.ru.key  company.ru.crt  company.ru.root.crt  company.ru.intermediate.crt</code> </pre> <br>  Kombinieren Sie anschließend die Zertifikatketten mit dem Befehl <b>cat company.ru.root.crt company.ru.intermediate.crt &gt;&gt; company.ru_ca.crt</b> zu einer Datei und stellen Sie mit dem Befehl <b>/ opt /</b> sicher, dass mit den Zertifikaten alles in Ordnung ist <b>zimbra / bin / zmcertmgr verifycrt comm /tmp/company.ru/company.ru.key /tmp/company.ru/company.ru.crt /tmp/company.ru/company.ru_ca.crt</b> .  Nachdem die Zertifikate überprüft wurden und der Schlüssel erfolgreich ist, können Sie mit der Installation fortfahren. <br><br>  Um die Installation zu starten, werden zunächst das Domänenzertifikat und die vertrauenswürdigen Ketten der Zertifizierungsstellen in einer Datei zusammengefasst.  Dies erfolgt auch mit einem Befehl der Form <b>cat company.ru.crt company.ru_ca.crt &gt;&gt; company.ru.bundle</b> .  Danach müssen Sie den Befehl ausführen, um alle Zertifikate und den Schlüssel in LDAP zu schreiben: <b>/ opt / zimbra / libexec / zmdomaincertmgr savecrt company.ru company.ru.bundle company.ru.key</b> , und dann die Zertifikate mit dem Befehl <b>/ opt /</b> installieren <b>zimbra / libexec / zmdomaincertmgr deploycrts</b> .  Nach der Installation werden die Zertifikate und der Schlüssel für die Domäne <b>company.ru im</b> Ordner <b>/opt/zimbra/conf/domaincerts/company.ru</b> gespeichert. <br><br>  Durch Wiederholen dieser Schritte unter Verwendung verschiedener Domänennamen, jedoch mit derselben IP-Adresse, können Sie den Standort von mehreren hundert Domänen auf derselben IPv4-Adresse ermitteln.  Gleichzeitig können Sie problemlos Zertifikate aus verschiedenen Ausstellungszentren verwenden.  Sie können die Richtigkeit aller in jedem Browser ausgeführten Aktionen überprüfen, wobei für jeden virtuellen Hostnamen das SSL-Zertifikat angezeigt werden soll. <br><br>  Bei allen Fragen zur Zextras Suite können Sie sich per E-Mail an katerina@zextras.com an die Vertreterin von Zextras, Ekaterina Triandafilidi, wenden </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de468025/">https://habr.com/ru/post/de468025/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de468015/index.html">Was ist derzeit über ITIL 4 bekannt und wer nutzt die neue Bibliothek bereits?</a></li>
<li><a href="../de468017/index.html">Die Vielleicht-Monade über Async / Warten in C # (ohne Aufgabe ov!)</a></li>
<li><a href="../de468019/index.html">Website-Entwicklung in WebAssembly mit NetCore 3 und Blazor</a></li>
<li><a href="../de468021/index.html">PHP, wie viel Abstraktion für die Menschen?</a></li>
<li><a href="../de468023/index.html">Künstliche Intelligenz im Kampfspiel Shadow Fight 3</a></li>
<li><a href="../de468027/index.html">Codeoptimierungsmethoden für Redd. Teil 2: Nicht zwischenspeicherbarer Speicher und paralleler Busbetrieb</a></li>
<li><a href="../de468031/index.html">Wir portieren ein Multiplayer-Spiel von C ++ mit Cheerp, WebRTC und Firebase ins Web</a></li>
<li><a href="../de468035/index.html">Laden Sie die Presse mit einem Gamecontroller oder 8 ungewöhnlichen Patenten für Eingabegeräte herunter</a></li>
<li><a href="../de468039/index.html">Moskau Kubernetes Meetup # 6 bei Acronis (Fiztehpark) 10/03/2019</a></li>
<li><a href="../de468041/index.html">Ankündigung der Kubernetes Web View-Weboberfläche (und eine kurze Übersicht über andere Web-Benutzeroberflächen für Kubernetes)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>