<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖕🏾 🕵️ 🍵 Trucs et astuces de ma chaîne Telegram @pythonetc, avril 2019 👨🏾‍🚒 🥃 💯</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="C'est une nouvelle sélection de trucs et astuces sur Python et la programmation de mon canal Telegram @pythonetc. 

 Publications précédentes . 


 Le...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Trucs et astuces de ma chaîne Telegram @pythonetc, avril 2019</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/450864/"><img src="https://habrastorage.org/getpro/habr/post_images/469/cfe/430/469cfe43068ff61bcd8eb6f3737c8bb7.png"><br><br>  C'est une nouvelle sélection de trucs et astuces sur Python et la programmation de mon canal Telegram @pythonetc. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Publications précédentes</a> . <br><a name="habracut"></a><br><hr><br>  Le stockage et l'envoi d'objets via le réseau sous forme d'octets est un sujet très important.  Discutons de quelques outils qui sont généralement utilisés pour cela en Python et de leurs avantages et inconvénients. <br><br>  À titre d'exemple, je vais essayer de sérialiser l'objet Cities qui contient certains objets City ainsi que leur ordre.  Voici quatre méthodes que vous pouvez utiliser: <br><br>  1. JSON.  Il est lisible par l'homme, facile à utiliser, mais consomme beaucoup de mémoire.  Il en va de même pour d'autres formats comme YAML ou XML. <br><br><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">City</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">to_dict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dict( name=self._name, country=self._country, lon=self._lon, lat=self._lat, ) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cities</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, cities)</span></span></span><span class="hljs-function">:</span></span> self._cities = cities <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">to_json</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json.dumps([ c.to_dict() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self._cities ]).encode(<span class="hljs-string"><span class="hljs-string">'utf8'</span></span>)</code> </pre> <br>  2. Pickle.  Pickle est natif pour Python, peut être personnalisé et consomme moins de mémoire que JSON.  L'inconvénient est que vous devez utiliser Python pour décompresser les données. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cities</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pickle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> pickle.dumps(self)</code> </pre> <br>  3. Protobuf (et autres sérialiseurs binaires tels que msgpack).  Consomme encore moins de mémoire, peut être utilisé à partir de tout autre langage de programmation, mais nécessite un schéma personnalisé: <br><br><pre> <code class="python hljs">syntax = <span class="hljs-string"><span class="hljs-string">"proto2"</span></span>; message City { required string name = <span class="hljs-number"><span class="hljs-number">1</span></span>; required string country = <span class="hljs-number"><span class="hljs-number">2</span></span>; required float lon = <span class="hljs-number"><span class="hljs-number">3</span></span>; required float lat = <span class="hljs-number"><span class="hljs-number">4</span></span>; } message Cities { repeated City cities = <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">City</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">to_protobuf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> result = city_pb2.City() result.name = self._name result.country = self._country result.lon = self._lon result.lat = self._lat <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cities</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">to_protobuf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> result = city_pb2.Cities() result.cities.extend([ c.to_protobuf() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self._cities ]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result</code> </pre> <br>  4. Manuel.  Vous pouvez emballer et décompresser manuellement les données avec le module struct.  Il vous permet de consommer la quantité minimale absolue de mémoire, mais protobuf peut toujours être un meilleur choix car il prend en charge la gestion des versions et les schémas explicites. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">City</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">to_bytes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> name_encoded = self._name.encode(<span class="hljs-string"><span class="hljs-string">'utf8'</span></span>) name_length = len(name_encoded) country_encoded = self._country.encode(<span class="hljs-string"><span class="hljs-string">'utf8'</span></span>) country_length = len(country_encoded) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> struct.pack( <span class="hljs-string"><span class="hljs-string">'BsBsff'</span></span>, name_length, name_encoded, country_length, country_encoded, self._lon, self._lat, <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cities</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">to_bytes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">b''</span></span>.join( c.to_bytes() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self._cities )</code> </pre><br><hr><br>  Si un argument de fonction a la valeur par défaut <code>None</code> et est annoté comme <code>T</code> , <code>mypy</code> le traite automatiquement comme <code>Optional[T]</code> (en d'autres termes, <code>Union[T, None]</code> ). <br><br>  Cela ne fonctionne pas avec d'autres types, vous ne pouvez donc pas avoir quelque chose comme <code>f(x: A = B())</code> .  Cela ne fonctionne pas non plus avec une affectation de variable: <code>a: A = None</code> provoquera une erreur. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x: int = None)</span></span></span><span class="hljs-function">:</span></span> reveal_type(x) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">g</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(y: int = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'x'</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> reveal_type(y) z: int = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> reveal_type(z) $ mypy test.py test.py:<span class="hljs-number"><span class="hljs-number">2</span></span>: error: Revealed type <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-string"><span class="hljs-string">'Union[builtins.int, None]'</span></span> test.py:<span class="hljs-number"><span class="hljs-number">4</span></span>: error: Incompatible default <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> argument <span class="hljs-string"><span class="hljs-string">"y"</span></span> (default has type <span class="hljs-string"><span class="hljs-string">"str"</span></span>, argument has type <span class="hljs-string"><span class="hljs-string">"int"</span></span>) test.py:<span class="hljs-number"><span class="hljs-number">5</span></span>: error: Revealed type <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-string"><span class="hljs-string">'builtins.int'</span></span> test.py:<span class="hljs-number"><span class="hljs-number">7</span></span>: error: Incompatible types <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> assignment (expression has type <span class="hljs-string"><span class="hljs-string">"None"</span></span>, variable has type <span class="hljs-string"><span class="hljs-string">"int"</span></span>) test.py:<span class="hljs-number"><span class="hljs-number">8</span></span>: error: Revealed type <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-string"><span class="hljs-string">'builtins.int'</span></span></code> </pre> <br><hr><br>  Dans Python 3, une fois que le bloc <code>except</code> est fermé, les variables qui stockent les exceptions interceptées sont supprimées de <code>locals()</code> même si elles existaient auparavant: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>e = <span class="hljs-number"><span class="hljs-number">2</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: ... <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e: ... <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> ... &gt;&gt;&gt; e Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; NameError: name <span class="hljs-string"><span class="hljs-string">'e'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> defined</code> </pre> <br>  Si vous souhaitez enregistrer une référence à l'exception, vous devez utiliser une autre variable: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>error = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: ... <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e: ... error = e ... &gt;&gt;&gt; error ZeroDivisionError(<span class="hljs-string"><span class="hljs-string">'division by zero'</span></span>,)</code> </pre> <br>  Ce n'est pas vrai pour Python 2. <br><br><hr><br>  Vous pouvez avoir votre propre référentiel <code>pypi</code> .  Il vous permet de publier des packages dans votre projet et de les installer avec pip comme s'il s'agissait de packages standard. <br><br>  Il est remarquable que vous n'ayez pas à installer de logiciel spécifique, mais que vous pouvez utiliser un serveur http normal à la place.  Voici comment cela fonctionne pour moi, par exemple. <br><br>  Ayons un paquet trivial nommé <code>pythonetc</code> . <br><br><pre> <code class="python hljs">setup.py: <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> setuptools <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> setup, find_packages setup( name=<span class="hljs-string"><span class="hljs-string">'pythonetc'</span></span>, version=<span class="hljs-string"><span class="hljs-string">'1.0'</span></span>, packages=find_packages(), ) pythonetc.py: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ping</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'pong'</span></span></code> </pre> <br>  Libérons-le dans le répertoire ~ / pypi: <br><br><pre> <code class="python hljs">$ python setup.py sdist bdist_wheel … $ mv dist ~/pypi/pythonetc</code> </pre> <br>  Maintenant, <code>pypi.pushtaev.ru</code> le sur le domaine <code>pypi.pushtaev.ru</code> avec nginx: <br><br><pre> <code class="python hljs">$ cat /etc/nginx/sites-enabled/pypi server { listen <span class="hljs-number"><span class="hljs-number">80</span></span>; server_name pypi.pushtaev.ru; root /home/vadim/pypi; index index.html index.htm index.nginx-debian.html; location / { autoindex on; try_files $uri $uri/ =<span class="hljs-number"><span class="hljs-number">404</span></span>; } }</code> </pre> <br>  Il peut maintenant être installé: <br><br><pre> <code class="python hljs">$ pip install -i http://pypi.pushtaev.ru --trusted-host pypi.pushtaev.ru pythonetc … Collecting pythonetc Downloading http://pypi.pushtaev.ru/pythonetc/pythonetc<span class="hljs-number"><span class="hljs-number">-1.0</span></span>-py3-none-any.whl Installing collected packages: pythonetc Successfully installed pythonetc<span class="hljs-number"><span class="hljs-number">-1.0</span></span> $ python Python <span class="hljs-number"><span class="hljs-number">3.7</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>+ (heads/<span class="hljs-number"><span class="hljs-number">3.7</span></span>:<span class="hljs-number"><span class="hljs-number">0964</span></span>aac, Mar <span class="hljs-number"><span class="hljs-number">29</span></span> <span class="hljs-number"><span class="hljs-number">2019</span></span>, <span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">40</span></span>:<span class="hljs-number"><span class="hljs-number">55</span></span>) [GCC <span class="hljs-number"><span class="hljs-number">4.9</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>] on linux Type <span class="hljs-string"><span class="hljs-string">"help"</span></span>, <span class="hljs-string"><span class="hljs-string">"copyright"</span></span>, <span class="hljs-string"><span class="hljs-string">"credits"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">"license"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> more information. &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pythonetc &gt;&gt;&gt; pythonetc.ping() <span class="hljs-string"><span class="hljs-string">'pong'</span></span></code> </pre> <br><hr><br>  C'est assez souvent lorsque vous devez déclarer un dictionnaire avec toutes les clés égales aux variables locales du même nom.  Quelque chose comme ça: <br><br><pre> <code class="python hljs">dict( context=context, mode=mode, action_type=action_type, )</code> </pre><br>  ECMAScript a même la forme spéciale de littéral d'objet pour de tels cas (il est appelé raccourci de valeur de propriété de littéral d'objet): <br><br><pre> <code class="python hljs">&gt; var a = <span class="hljs-number"><span class="hljs-number">1</span></span>; &lt; undefined &gt; var b = <span class="hljs-number"><span class="hljs-number">2</span></span>; &lt; undefined &gt; {a, b} &lt; {a: <span class="hljs-number"><span class="hljs-number">1</span></span>, b: <span class="hljs-number"><span class="hljs-number">2</span></span>}</code> </pre> <br>  Il est possible de créer un assistant similaire en Python (hélas, il n'est même pas aussi bon que la notation ECMAScript): <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shorthand_dict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(lcls, names)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {k: lcls[k] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> k <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> names} context = dict(user_id=<span class="hljs-number"><span class="hljs-number">42</span></span>, user_ip=<span class="hljs-string"><span class="hljs-string">'1.2.3.4'</span></span>) mode = <span class="hljs-string"><span class="hljs-string">'force'</span></span> action_type = <span class="hljs-number"><span class="hljs-number">7</span></span> shorthand_dict(locals(), [ <span class="hljs-string"><span class="hljs-string">'context'</span></span>, <span class="hljs-string"><span class="hljs-string">'mode'</span></span>, <span class="hljs-string"><span class="hljs-string">'action_type'</span></span>, ])</code> </pre> <br>  Vous vous demandez peut-être pourquoi nous devons passer <code>locals()</code> comme paramètre dans l'exemple précédent.  Est-il possible d'obtenir les <code>locals</code> de l'appelant dans l'appelé?  En effet, mais vous devez jouer avec le module <code>inpsect</code> : <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> inspect <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shorthand_dict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(names)</span></span></span><span class="hljs-function">:</span></span> lcls = inspect.currentframe().f_back.f_locals <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {k: lcls[k] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> k <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> names} context = dict(user_id=<span class="hljs-number"><span class="hljs-number">42</span></span>, user_ip=<span class="hljs-string"><span class="hljs-string">'1.2.3.4'</span></span>) mode = <span class="hljs-string"><span class="hljs-string">'force'</span></span> action_type = <span class="hljs-number"><span class="hljs-number">7</span></span> shorthand_dict([ <span class="hljs-string"><span class="hljs-string">'context'</span></span>, <span class="hljs-string"><span class="hljs-string">'mode'</span></span>, <span class="hljs-string"><span class="hljs-string">'action_type'</span></span>, ])</code> </pre> <br>  Vous pouvez aller encore plus loin et utiliser quelque chose comme ça - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://github.com/alexmojaki/sorcery</a> : <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sorcery <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dict_of dict_of(context, mode, action_type)</code> </pre></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr450864/">https://habr.com/ru/post/fr450864/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr450850/index.html">Vers un avenir meilleur pour les compilateurs intelligents</a></li>
<li><a href="../fr450854/index.html">Expérience dans le développement d'un atout Unity pour trouver un chemin dans l'espace 3D</a></li>
<li><a href="../fr450858/index.html">Réunion de réseautage Open Source - maintenant dans Yandex.Cloud # 3.2019</a></li>
<li><a href="../fr450860/index.html">Prise intelligente REDMOND SkyPort 100S</a></li>
<li><a href="../fr450862/index.html">@Pythonetc avril 2019</a></li>
<li><a href="../fr450868/index.html">Rapports vidéo de la rencontre FunTech QA-automation</a></li>
<li><a href="../fr450870/index.html">Comment Netflix utilise Python</a></li>
<li><a href="../fr450872/index.html">Guide d'annotation TestNG pour Selenium WebDriver</a></li>
<li><a href="../fr450874/index.html">Mon test numérique de l'hypothèse des taux absolus</a></li>
<li><a href="../fr450878/index.html">Attrape-moi si tu peux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>