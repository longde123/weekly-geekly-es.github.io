<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äç‚ù§Ô∏è‚Äçüë® üöï üö£ Pens√©e fonctionnelle. Partie 11: Finale üòè üöé üéæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, nous terminons notre s√©rie d'articles sur la programmation fonctionnelle. Il s'est av√©r√© 11 parties. Je pense que c'est une r√©ussite. Dan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pens√©e fonctionnelle. Partie 11: Finale</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/microsoft/blog/433412/"><p>  Aujourd'hui, nous terminons notre s√©rie d'articles sur la programmation fonctionnelle.  Il s'est av√©r√© 11 parties.  Je pense que c'est une r√©ussite.  Dans cet article, nous impl√©mentons une simple calculatrice de pile (√©galement connue sous le nom de ¬´notation polonaise invers√©e¬ª).  L'impl√©mentation est presque enti√®rement bas√©e sur des fonctions, avec un seul type sp√©cial, et g√©n√©ralement sans comparaison avec l'√©chantillon, c'est donc un excellent terrain d'essai pour les concepts couverts dans notre s√©rie. </p><br><p><img src="https://habrastorage.org/webt/7j/cd/7x/7jcd7xzdvnhpyxuebjvbzb1uiqs.jpeg"></p><br><p>  Je tiens √† remercier <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><em>@kleidemos</em></a> s√©par√©ment.  C'est lui qui a √©t√© le principal traducteur et gestionnaire de toute la s√©rie d'articles.  Je vous remercie! </p><br><ul><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Premi√®re partie</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Deuxi√®me partie</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Troisi√®me partie</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Quatri√®me partie</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cinqui√®me partie</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sixi√®me partie</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Septi√®me partie</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Huiti√®me partie</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Neuvi√®me partie</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dixi√®me</a></strong> <a name="habracut"></a></li></ul><br><hr><br><p>  Si vous n'√™tes pas familier avec une telle calculatrice, cela fonctionne comme suit: les nombres sont pouss√©s dans la pile et les op√©rations, telles que l'addition et la multiplication, choisissent des nombres en haut de la pile, puis remettent le r√©sultat de l'op√©ration. </p><br><p>  Sch√©ma de calcul simple sur la pile: </p><br><br><p>  Avant de concevoir un tel syst√®me, vous devez vous demander comment il sera utilis√©.  En suivant une syntaxe semblable √† Forth, nous donnerons √† chaque action une √©tiquette appropri√©e afin que dans l'exemple ci-dessus, vous puissiez √©crire quelque chose comme: </p><br><pre><code class="plaintext hljs">EMPTY ONE THREE ADD TWO MUL SHOW</code> </pre> <br><p>  Il est peut-√™tre impossible d'obtenir exactement cette syntaxe, mais essayons de nous rapprocher le plus possible de cela. </p><br><h2>  Type de donn√©es de pile </h2><br><p>  Tout d'abord, vous devez d√©finir la structure de donn√©es de la pile.  Pour plus de simplicit√©, vous pouvez utiliser une liste de nombres √† virgule flottante. </p><br><pre> <code class="plaintext hljs">type Stack = float list</code> </pre> <br><p>  Mais il vaut mieux l'encapsuler dans un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">seul type d'union</a> pour rendre le type plus visuel, comme ceci: </p><br><pre> <code class="plaintext hljs">type Stack = StackContents of float list</code> </pre> <br><p>  Pourquoi est-il pr√©f√©rable de faire exactement cela, vous pouvez lire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </p><br><p>  Cr√©ez maintenant une nouvelle pile en utilisant <code>StackContents</code> comme constructeur: </p><br><pre> <code class="plaintext hljs">let newStack = StackContents [1.0;2.0;3.0]</code> </pre> <br><p>  Pour extraire le contenu d'une pile existante, utilisez le mod√®le correspondant √† <code>StackContents</code> : </p><br><pre> <code class="plaintext hljs">let (StackContents contents) = newStack //  "contents"   // float list = [1.0; 2.0; 3.0]</code> </pre> <br><h2>  Fonction push </h2><br><p>  Ensuite, nous avons besoin d'un moyen de mettre des nombres sur cette pile.  Pour ce faire, ajoutez simplement une nouvelle valeur en haut de la liste en utilisant " <code>::</code> ". </p><br><p>  Exemple de fonction: </p><br><pre> <code class="plaintext hljs">let push x aStack = let (StackContents contents) = aStack let newContents = x::contents StackContents newContents</code> </pre> <br><p>  Cette fonctionnalit√© a un certain nombre de fonctionnalit√©s qui m√©ritent d'√™tre discut√©es. </p><br><p>  Tout d'abord, vous devez faire attention au fait que la structure de la <code>list</code> est immuable, ce qui signifie que la fonction doit prendre une pile existante et en retourner une nouvelle.  Ce n'est pas seulement un changement dans une pile existante.  En fait, toutes les fonctions de cet exemple auront un format similaire: </p><br><pre> <code class="plaintext hljs">Input: Stack   -  Output:  Stack</code> </pre> <br><p>  Deuxi√®mement, pourquoi les param√®tres vont-ils dans cet ordre?  Pourquoi la pile devrait-elle commencer ou durer?  Dans la section sur la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">conception de fonctions avec application partielle,</a> il a √©t√© dit que le param√®tre le plus fr√©quemment modifi√© devait durer en dernier.  Il sera bient√¥t possible de v√©rifier que ces recommandations sont suivies. </p><br><p>  Enfin, la fonction peut √™tre rendue plus concise en faisant correspondre le motif dans le param√®tre de fonction lui-m√™me, au lieu de la <code>let</code> dans le corps de la fonction. </p><br><p>  La version r√©√©crite: </p><br><pre> <code class="plaintext hljs">let push x (StackContents contents) = StackContents (x::contents)</code> </pre> <br><p>  Bien mieux! </p><br><p>  Au fait, regardez sa signature gracieuse: </p><br><pre> <code class="plaintext hljs">val push : float -&gt; Stack -&gt; Stack</code> </pre> <br><p>  Comme mentionn√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pr√©c√©demment</a> , la signature nous en dit long. <br>  Dans ce cas, je pourrais deviner ce que fait cette fonction, uniquement par sa signature, sans m√™me savoir qu'elle s'appelle "push". <br>  C'est une autre raison pour laquelle il √©tait judicieux d'avoir des noms de type explicites.  Si la pile n'√©tait qu'une liste de nombres √† virgule flottante, la fonction ne serait pas si auto-document√©e. </p><br><p>  D'une mani√®re ou d'une autre, v√©rifiez: </p><br><pre> <code class="plaintext hljs">let emptyStack = StackContents [] let stackWith1 = push 1.0 emptyStack let stackWith2 = push 2.0 stackWith1</code> </pre> <br><p>  Fonctionne tr√®s bien! </p><br><h2>  Stack top exposant utilisant push </h2><br><p>  Avec cette fonction simple, vous pouvez facilement d√©finir une op√©ration qui pousse un nombre sp√©cifique sur la pile. </p><br><pre> <code class="plaintext hljs">let ONE stack = push 1.0 stack let TWO stack = push 2.0 stack</code> </pre> <br><p>  Mais attendez une minute!  Vous voyez que le param√®tre de <code>stack</code> est mentionn√© des deux c√¥t√©s de l'expression?  En fait, il n'est pas n√©cessaire de le mentionner deux fois.  Au lieu de cela, vous pouvez omettre le param√®tre et √©crire une fonction avec une application partielle: </p><br><pre> <code class="plaintext hljs">let ONE = push 1.0 let TWO = push 2.0 let THREE = push 3.0 let FOUR = push 4.0 let FIVE = push 5.0</code> </pre> <br><p>  Maintenant, il est √©vident que si la fonction <code>push</code> avait un ordre de param√®tres diff√©rent, la <code>stack</code> devrait √™tre mentionn√©e deux fois. </p><br><p>  Il convient √©galement de d√©finir une fonction qui cr√©e une pile vide: </p><br><pre> <code class="plaintext hljs">let EMPTY = StackContents []</code> </pre> <br><p>  V√©rifiez les fonctions re√ßues: </p><br><pre> <code class="plaintext hljs">let stackWith1 = ONE EMPTY let stackWith2 = TWO stackWith1 let stackWith3 = THREE stackWith2</code> </pre> <br><p>  Ces piles interm√©diaires sont-elles ennuyeuses?  Est-il possible de s'en d√©barrasser?  Bien s√ªr!  Notez que les fonctions ONE, TWO et THREE ont la m√™me signature: </p><br><pre> <code class="plaintext hljs">Stack -&gt; Stack</code> </pre> <br><p>  Ainsi, ils sont parfaitement connect√©s entre eux!  La sortie d'une fonction peut √™tre entr√©e dans les √©l√©ments suivants: </p><br><pre> <code class="plaintext hljs">let result123 = EMPTY |&gt; ONE |&gt; TWO |&gt; THREE let result312 = EMPTY |&gt; THREE |&gt; ONE |&gt; TWO</code> </pre> <br><h2>  Sauter hors de la pile </h2><br><p>  Avec l'ajout √† la pile compris, mais qu'en est-il de la fonction <code>pop</code> ? </p><br><p>  Lors de la r√©cup√©ration de la pile, il est √©videmment n√©cessaire de retourner le haut de la pile, mais est-ce juste cela? </p><br><p>  Dans un style orient√© objet, la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">r√©ponse est oui</a> .  Mais dans le cas de la POO, la pile serait modifi√©e dans les coulisses, de sorte que l'√©l√©ment sup√©rieur serait supprim√©. </p><br><p>  Cependant, dans un style fonctionnel, la pile est immuable.  Il n'y a qu'une seule fa√ßon de supprimer l'√©l√©ment sup√©rieur - cr√©er une <em>nouvelle pile</em> sans cet √©l√©ment.  Pour que l'appelant ait acc√®s √† la nouvelle pile r√©duite, elle doit √™tre renvoy√©e avec l'√©l√©ment sup√©rieur. </p><br><p>  En d'autres termes, la fonction <code>pop</code> doit renvoyer <em>deux</em> valeurs, l'√©l√©ment sup√©rieur et la nouvelle pile.  La fa√ßon la plus simple de le faire en F # est simplement d'utiliser un tuple. </p><br><p>  R√©alisation: </p><br><pre> <code class="plaintext hljs">///     ///          let pop (StackContents contents) = match contents with | top::rest -&gt; let newStack = StackContents rest (top,newStack)</code> </pre> <br><p>  La fonction r√©sultante est √©galement tr√®s simple. </p><br><p>  Comme pr√©c√©demment, le <code>contents</code> extrait directement du param√®tre. </p><br><p>  Ensuite, le contenu du <code>contents</code> v√©rifi√© √† l'aide de l'expression <code>match..with</code> . </p><br><p>  Ensuite, l'√©l√©ment sup√©rieur est s√©par√© du reste de la liste, une nouvelle pile est cr√©√©e sur la base des √©l√©ments restants, et finalement tout cela est retourn√© sous la forme d'une paire de tuple. </p><br><p>  Essayez d'ex√©cuter ce code et voyez ce qui se passe.  Vous obtiendrez une erreur de compilation! <br>  Le compilateur a d√©tect√© un cas qui n'a pas √©t√© r√©solu - que se passe-t-il si la pile est vide? </p><br><p>  Vous devez d√©cider comment le g√©rer. </p><br><ul><li>  Option 1: renvoyer le statut sp√©cial "Succ√®s" ou "Erreur", comme cela a √©t√© fait dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">publication de la s√©rie "pourquoi utiliser F #?"</a>  . </li><li>  Option 2: l√®ve une exception. </li></ul><br><p>  Je pr√©f√®re g√©n√©ralement utiliser un √©tat sp√©cial pour l'erreur, mais dans ce cas particulier, j'ai pr√©f√©r√© lever une exception.  Version fixe de <code>pop</code> avec gestion des cas vides: </p><br><pre> <code class="plaintext hljs">let pop (StackContents contents) = match contents with | top::rest -&gt; let newStack = StackContents rest (top,newStack) | [] -&gt; failwith "Stack underflow"</code> </pre> <br><p>  V√©rifier: </p><br><pre> <code class="plaintext hljs">let initialStack = EMPTY |&gt; ONE |&gt; TWO let popped1, poppedStack = pop initialStack let popped2, poppedStack2 = pop poppedStack</code> </pre> <br><p>  et test d'exception: </p><br><pre> <code class="plaintext hljs">let _ = pop EMPTY</code> </pre> <br><h2>  Fonctions arithm√©tiques </h2><br><p>  Maintenant que l'ajout et la suppression sont en place, vous pouvez commencer √† travailler avec les fonctions "ajouter" et "multiplier": </p><br><pre> <code class="plaintext hljs">let ADD stack = let x,s = pop stack //   let y,s2 = pop s //    let result = x + y //   push result s2 //     let MUL stack = let x,s = pop stack //   let y,s2 = pop s //    let result = x * y //   push result s2 //    </code> </pre> <br><p>  Test en ligne: </p><br><pre> <code class="plaintext hljs">let add1and2 = EMPTY |&gt; ONE |&gt; TWO |&gt; ADD let add2and3 = EMPTY |&gt; TWO |&gt; THREE |&gt; ADD let mult2and3 = EMPTY |&gt; TWO |&gt; THREE |&gt; MUL</code> </pre> <br><p>  √áa marche! </p><br><h3>  Refactoring du temps ... </h3><br><p>  De toute √©vidence, une quantit√© importante de code est dupliqu√©e dans ces deux fonctions.  Comment pouvons-nous r√©soudre ce probl√®me? </p><br><p>  Les deux fonctions extraient deux valeurs de la pile, leur appliquent une certaine fonction binaire, puis repoussent le r√©sultat sur la pile.  Vous pouvez sortir le code g√©n√©ral dans la fonction binaire, qui prend une fonction math√©matique avec deux param√®tres: </p><br><pre> <code class="plaintext hljs">let binary mathFn stack = //    let y,stack' = pop stack //     let x,stack'' = pop stack' //  let z = mathFn xy //      push z stack''</code> </pre> <br><p>  <em>Notez que dans cette impl√©mentation, diff√©rentes versions du ¬´m√™me¬ª objet sont marqu√©es avec un nombre diff√©rent de guillemets.</em>  <em>En effet, les suffixes num√©riques peuvent facilement pr√™ter √† confusion.</em> </p><br><p>  Question: pourquoi les param√®tres ont-ils exactement cet ordre, au lieu que <code>mathFn</code> vienne apr√®s la <code>stack</code> ? </p><br><p>  Maintenant que vous avez une fonction <code>binary</code> , il est beaucoup plus facile de d√©finir ADD et d'autres fonctions: </p><br><p>  Premi√®re tentative d'impl√©mentation d'ADD √† l'aide du <code>binary</code> : </p><br><pre> <code class="plaintext hljs">let ADD aStack = binary (fun xy -&gt; x + y) aStack</code> </pre> <br><p>  Mais vous pouvez vous d√©barrasser de lambda, car  il repr√©sente la d√©finition <em>exacte</em> de la fonction int√©gr√©e <code>+</code> : </p><br><pre> <code class="plaintext hljs">let ADD aStack = binary (+) aStack</code> </pre> <br><p>  Encore une fois, une application partielle peut √™tre utilis√©e pour masquer le param√®tre de pile.  D√©finition finale: </p><br><pre> <code class="plaintext hljs">let ADD = binary (+)</code> </pre> <br><p>  D√©finition d'autres fonctions math√©matiques: </p><br><pre> <code class="plaintext hljs">let SUB = binary (-) let MUL = binary (*) let DIV = binary (../)</code> </pre> <br><p>  Essayez-le en ligne: </p><br><pre> <code class="plaintext hljs">let div2by3 = EMPTY |&gt; THREE|&gt; TWO |&gt; DIV let sub2from5 = EMPTY |&gt; TWO |&gt; FIVE |&gt; SUB let add1and2thenSub3 = EMPTY |&gt; ONE |&gt; TWO |&gt; ADD |&gt; THREE |&gt; SUB</code> </pre> <br><p>  De m√™me, vous pouvez cr√©er une fonction auxiliaire pour les op√©rations unaires </p><br><pre> <code class="plaintext hljs">let unary f stack = let x,stack' = pop stack push (fx) stack'</code> </pre> <br><p>  Et d√©finissez quelques fonctions unaires: </p><br><pre> <code class="plaintext hljs">let NEG = unary (fun x -&gt; -x) let SQUARE = unary (fun x -&gt; x * x)</code> </pre> <br><p>  Mode interactif: </p><br><pre> <code class="plaintext hljs">let neg3 = EMPTY |&gt; THREE|&gt; NEG let square2 = EMPTY |&gt; TWO |&gt; SQUARE</code> </pre> <br><h2>  Mettre tout cela ensemble |  Tout mettre ensemble </h2><br><p>  Dans les exigences initiales, il a √©t√© mentionn√© que nous aimerions pouvoir afficher les r√©sultats, il convient donc de d√©finir la fonction SHOW. </p><br><pre> <code class="plaintext hljs">let SHOW stack = let x,_ = pop stack printfn "The answer is %f" x stack //      </code> </pre> <br><p>  Veuillez noter que dans ce cas, la nouvelle version de la pile re√ßue via <code>pop</code> est ignor√©e.  Le r√©sultat final est la pile d'origine, comme si elle n'avait jamais chang√©. </p><br><p>  Enfin, vous pouvez √©crire l'exemple suivant √† partir des exigences d'origine </p><br><pre> <code class="plaintext hljs">EMPTY |&gt; ONE |&gt; THREE |&gt; ADD |&gt; TWO |&gt; MUL |&gt; SHOW</code> </pre> <br><h3>  Continuez </h3><br><p>  C'est amusant, mais que pouvez-vous faire d'autre? </p><br><p>  Vous pouvez d√©finir plusieurs fonctions suppl√©mentaires: </p><br><pre> <code class="plaintext hljs">///      let DUP stack = //    let x,_ = pop stack //      push x stack ///      let SWAP stack = let x,s = pop stack let y,s' = pop s push y (push x s') ///    let START = EMPTY</code> </pre> <br><p>  En utilisant ces fonctions suppl√©mentaires, vous pouvez √©crire quelques exemples √©l√©gants: </p><br><pre> <code class="plaintext hljs">START |&gt; ONE |&gt; TWO |&gt; SHOW START |&gt; ONE |&gt; TWO |&gt; ADD |&gt; SHOW |&gt; THREE |&gt; ADD |&gt; SHOW START |&gt; THREE |&gt; DUP |&gt; DUP |&gt; MUL |&gt; MUL // 27 START |&gt; ONE |&gt; TWO |&gt; ADD |&gt; SHOW // 3 |&gt; THREE |&gt; MUL |&gt; SHOW // 9 |&gt; TWO |&gt; SWAP |&gt; DIV |&gt; SHOW // 9 div 2 = 4.5</code> </pre> <br><h2>  Utiliser la composition au lieu du pipelining </h2><br><p>  Mais ce n'est pas tout.  En fait, il existe une autre fa√ßon int√©ressante de repr√©senter ces fonctions. </p><br><p>  Comme indiqu√© pr√©c√©demment, ils ont tous la m√™me signature: </p><br><pre> <code class="plaintext hljs">Stack -&gt; Stack</code> </pre> <br><p>  √âtant donn√© que l'entr√©e et la sortie sont du m√™me type, ces fonctions peuvent √©galement √™tre combin√©es √† l'aide de l'op√©rateur de composition <code>&gt;&gt;</code> , et pas seulement via des op√©rateurs pipelin√©s. </p><br><p>  Quelques exemples: </p><br><pre> <code class="plaintext hljs">//    let ONE_TWO_ADD = ONE &gt;&gt; TWO &gt;&gt; ADD START |&gt; ONE_TWO_ADD |&gt; SHOW //    let SQUARE = DUP &gt;&gt; MUL START |&gt; TWO |&gt; SQUARE |&gt; SHOW //     let CUBE = DUP &gt;&gt; DUP &gt;&gt; MUL &gt;&gt; MUL START |&gt; THREE |&gt; CUBE |&gt; SHOW //   let SUM_NUMBERS_UPTO = DUP // n &gt;&gt; ONE &gt;&gt; ADD // n+1 &gt;&gt; MUL // n(n+1) &gt;&gt; TWO &gt;&gt; SWAP &gt;&gt; DIV // n(n+1) / 2 START |&gt; THREE |&gt; SQUARE |&gt; SUM_NUMBERS_UPTO |&gt; SHOW</code> </pre> <br><p>  Dans chacun de ces exemples, une nouvelle fonction est d√©finie √† l'aide d'une composition d'autres fonctions.  C'est un bon exemple d'une approche ¬´combinatoire¬ª de la fonctionnalit√© de construction. </p><br><h2>  Convoyeurs vs composition </h2><br><p>  Nous avons vu deux fa√ßons diff√©rentes d'utiliser notre mod√®le;  utilisant des convoyeurs et une composition.  Mais quelle est la diff√©rence?  Et pourquoi pr√©f√©rer l'un √† l'autre? </p><br><p>  La diff√©rence est que les pipelines sont, en un sens, une op√©ration de ¬´transformation en temps r√©el¬ª.  Au moment de l'utilisation du pipeline, les op√©rations sont effectu√©es imm√©diatement, via le transfert d'une pile sp√©cifique. </p><br><p>  D'un autre c√¥t√©, la composition est quelque chose comme un ¬´plan¬ª que nous voulons impl√©menter, cr√©ant des fonctions √† partir d'un ensemble de composants sans application directe. </p><br><p>  Par exemple, vous pouvez cr√©er un ¬´plan¬ª pour calculer le carr√© d'un nombre gr√¢ce √† une combinaison de petites op√©rations: </p><br><pre> <code class="plaintext hljs">let COMPOSED_SQUARE = DUP &gt;&gt; MUL</code> </pre> <br><p>  Je ne peux pas donner l'√©quivalent bas√© sur les pipelines. </p><br><pre> <code class="plaintext hljs">let PIPED_SQUARE = DUP |&gt; MUL</code> </pre> <br><p>  Cela entra√Ænera une erreur de compilation.  J'ai besoin d'une instance de pile sp√©cifique pour que l'expression fonctionne: </p><br><pre> <code class="plaintext hljs">let stackWith2 = EMPTY |&gt; TWO let twoSquared = stackWith2 |&gt; DUP |&gt; MUL</code> </pre> <br><p>  Et m√™me dans ce cas, je peux obtenir une r√©ponse uniquement pour cette entr√©e particuli√®re, et non un plan de calcul g√©n√©ralis√© bas√© sur une entr√©e, comme dans l'exemple avec <code>COMPOSED_SQUARE</code> . </p><br><p>  Une autre fa√ßon de cr√©er un ¬´plan¬ª consiste √† passer explicitement le lambda √† des fonctions plus primitives: </p><br><pre> <code class="plaintext hljs">let LAMBDA_SQUARE = unary (fun x -&gt; x * x)</code> </pre> <br><p>  C'est une mani√®re plus explicite (et probablement plus rapide), mais tous les avantages et la clart√© de l'approche compositionnelle sont perdus. </p><br><p>  En g√©n√©ral, si possible, vous devez vous efforcer d'adopter une approche compositionnelle! </p><br><h2>  Code complet </h2><br><p>  Code complet pour tous les exemples ci-dessus: </p><br><pre> <code class="plaintext hljs">// ============================================== //  // ============================================== type Stack = StackContents of float list // ============================================== //   // ============================================== ///     let push x (StackContents contents) = StackContents (x::contents) ///        ///       let pop (StackContents contents) = match contents with | top::rest -&gt; let newStack = StackContents rest (top,newStack) | [] -&gt; failwith "Stack underflow" // ============================================== //  () // ============================================== //     //      //     let binary mathFn stack = let y,stack' = pop stack let x,stack'' = pop stack' let z = mathFn xy push z stack'' //    //      //     let unary f stack = let x,stack' = pop stack push (fx) stack' // ============================================== //  () // ============================================== ///      let SHOW stack = let x,_ = pop stack printfn "The answer is %f" x stack //      ///    let DUP stack = let x,s = pop stack push x (push xs) ///      let SWAP stack = let x,s = pop stack let y,s' = pop s push y (push x s') ///    let DROP stack = let _,s = pop stack //   s //   // ============================================== // ,    // ============================================== //  // ------------------------------- let EMPTY = StackContents [] let START = EMPTY //  // ------------------------------- let ONE = push 1.0 let TWO = push 2.0 let THREE = push 3.0 let FOUR = push 4.0 let FIVE = push 5.0 //   // ------------------------------- let ADD = binary (+) let SUB = binary (-) let MUL = binary (*) let DIV = binary (../) let NEG = unary (fun x -&gt; -x) // ============================================== // ,     // ============================================== let SQUARE = DUP &gt;&gt; MUL let CUBE = DUP &gt;&gt; DUP &gt;&gt; MUL &gt;&gt; MUL let SUM_NUMBERS_UPTO = DUP // n &gt;&gt; ONE &gt;&gt; ADD // n+1 &gt;&gt; MUL // n(n+1) &gt;&gt; TWO &gt;&gt; SWAP &gt;&gt; DIV // n(n+1) / 2</code> </pre> <br><h2>  Conclusion </h2><br><p>  Nous avons une simple calculatrice bas√©e sur la pile.  Nous avons vu comment, en commen√ßant par quelques op√©rations primitives ( <code>push</code> , <code>pop</code> , <code>binary</code> , <code>unary</code> ) et d'autres, vous pouvez cr√©er une DSL √† part enti√®re, facile √† impl√©menter et √† utiliser. </p><br><p>  Comme vous pouvez le deviner, cet exemple √©tait √† peu pr√®s bas√© sur la langue Forth.  Je recommande fortement le livre gratuit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Thinking Forth"</a> , qui parle non seulement du langage Forth, mais aussi d'autres m√©thodes ( <em>non</em> orient√©es objet!) Pour d√©composer des t√¢ches qui sont √©galement applicables √† la programmation fonctionnelle en g√©n√©ral. </p><br><p>  J'ai eu l'id√©e de cet article sur le magnifique blog d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ashley Feniello</a> .  Si vous souhaitez approfondir l'√©mulation d'un langage bas√© sur la pile bas√© sur F #, commencez par celui-ci.  <em>Amuse toi bien!</em> </p><br><h1>  Ressources suppl√©mentaires </h1><br><p>  Il existe de nombreux didacticiels pour F #, y compris des documents pour ceux qui viennent avec une exp√©rience C # ou Java.  Les liens suivants peuvent √™tre utiles pour approfondir F #: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Guide F #</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">F # pour le plaisir et le profit</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">F # Wiki</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Apprenez X en Y minutes: F #</a> </li></ul><br><p>  Plusieurs autres fa√ßons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">de commencer √† apprendre le F # sont</a> √©galement d√©crites. </p><br><p>  Enfin, la communaut√© F # est tr√®s conviviale pour les d√©butants.  Il y a un chat tr√®s actif chez Slack, soutenu par la F # Software Foundation, avec des salles pour d√©butants que vous <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pouvez rejoindre librement</a> .  Nous vous recommandons fortement de le faire! </p><br><p>  N'oubliez pas de visiter le site de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">communaut√© russophone F #</a> !  Si vous avez des questions sur l'apprentissage d'une langue, nous serons heureux d'en discuter dans les salles de chat: </p><br><ul><li>  room <code>#ru_general</code> dans le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Slack Chat de</a> la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">F # Software Foundation</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">chat dans Telegram</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">discuter avec gitter</a> </li><li>  room #en_general dans le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Slack Chat de</a> la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">F # Software Foundation</a> </li></ul><br><h2>  √Ä propos des auteurs de traduction </h2><br><p>  Traduit par <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><em>@kleidemos</em></a> <br><img src="https://habrastorage.org/getpro/habr/post_images/f95/c6d/92c/f95c6d92c5b1126b093792a43955aa43.png" width="56" height="56">  La traduction et les modifications √©ditoriales ont √©t√© apport√©es par les efforts de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">communaut√© russophone des d√©veloppeurs F #</a> .  Nous remercions √©galement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><em>@schvepsss</em></a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><em>@shwars d'</em></a> avoir pr√©par√© cet article pour publication. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr433412/">https://habr.com/ru/post/fr433412/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr433402/index.html">Pens√©e fonctionnelle. Partie 8</a></li>
<li><a href="../fr433404/index.html">Tutoriel React, partie 3: fichiers de composants, structure du projet</a></li>
<li><a href="../fr433406/index.html">Pens√©e fonctionnelle. Partie 9</a></li>
<li><a href="../fr433408/index.html">Gestion efficace de la m√©moire dans Node.js</a></li>
<li><a href="../fr433410/index.html">Pens√©e fonctionnelle. Partie 10</a></li>
<li><a href="../fr433414/index.html">Test du moniteur r√©seau PRTG et comparaison avec Zabbix</a></li>
<li><a href="../fr433420/index.html">R√©sultats ZeroNights 2018</a></li>
<li><a href="../fr433424/index.html">Est-il possible de charger un niveau infranchissable dans Super Mario Maker?</a></li>
<li><a href="../fr433428/index.html">D'o√π vient la cr√©ativit√©: analyse de l'activit√© des ondes alpha c√©r√©brales lors des tests RAT</a></li>
<li><a href="../fr433430/index.html">Bo√Æte Android Mecool KM9 sur le nouveau SoC Amlogic S905X2 avec 4 Go de RAM et Android TV 8.1 - comprendre et pardonner</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>