<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüåæ üëã üë©üèª‚Äçüéì SwayWM - UnixPorn voc√™ mesmo üßë üëÜüèø üßñüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° pessoal. Neste artigo, descreverei minha experi√™ncia em configurar e usar o sway, um gerenciador de janelas lado a lado para Linux. 
 O que √© e po...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SwayWM - UnixPorn voc√™ mesmo</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484378/"><p>  Ol√° pessoal.  Neste artigo, descreverei minha experi√™ncia em configurar e usar o sway, um gerenciador de janelas lado a lado para Linux. <a name="habracut"></a></p><br><h1 id="chto-eto-takoe-i-zachem-ono-nuzhno">  O que √© e por que √© necess√°rio? </h1><br><p>  Oficialmente, o sway √© um gerenciador de janelas lado a lado, um substituto transparente para o i3wm, trabalhando em cima do Wayland. </p><br><blockquote>  Weiland, tamb√©m conhecido como W√∂lund, etc.  - Um personagem da mitologia alem√£ antiga e n√≥rdica antiga, um livro sobre o qual uma vez foi escrito pela folclorista inglesa Jessie Weston.  Agora voc√™ sabe. </blockquote><p>  No entanto, na minha opini√£o, a principal caracter√≠stica do balan√ßo √© que ele √© um construtor, com todas as vantagens e desvantagens dessa abordagem.  Se voc√™ gosta do Vim (a semelhan√ßa com ele √© agravada pela orienta√ß√£o sobre o uso do teclado), do Archlinux e de projetos similares, aconselho que voc√™ d√™ uma olhada mais de perto na influ√™ncia.  Minha opini√£o pessoal √© que, quando voc√™ gastar um pouco mais de tempo para configur√°-lo, ter√° um ambiente muito est√°vel e conveniente para voc√™, pessoalmente, no qual nada inesperado acontecer√°. </p><br><p>  Se as falhas de oscila√ß√£o e Wayland (como a falta de suporte para os drivers particulares da NVidia e a necessidade de procurar an√°logos para muitos programas familiares) parecerem fatais para voc√™, aconselho que voc√™ preste aten√ß√£o no x3 i3wm.  As partes construtoras ser√£o completamente diferentes, voc√™ ter√° que instalar o xinit, configurar v√°rias .Xauthority, √© poss√≠vel lidar com o rasgo, mas a l√≥gica geral do sistema √© exatamente a mesma. </p><br><h1 id="ustanovka">  Instala√ß√£o </h1><br><p> O Sway provavelmente est√° nos reposit√≥rios da sua distribui√ß√£o.  No entanto, se voc√™ deseja instalar uma vers√£o mais recente, √© muito simples.  A p√°gina do projeto <a href="https://github.com/swaywm/sway">github</a> tem uma lista escassa de suas depend√™ncias.  Instale-os, clone o reposit√≥rio, clone <code>wlroots</code> na pasta de <code>subprojects</code> : </p><br><pre> <code class="plaintext hljs">hub clone swaywm/sway hub clone swaywm/wlroots sway/subprojects/wlroots</code> </pre><br><p>  (aqui eu uso um <a href="https://github.com/github/hub">hub</a> . Uma ferramenta n√£o-padr√£o, mas muito conveniente).  Depois disso, voc√™ pode configurar e criar: </p><br><pre> <code class="plaintext hljs">meson setup ./sway-build ./sway --buildtype=minsize ninja -C ./sway-build doas ninja -C ./sway-build install</code> </pre> <br><blockquote>  doas √© um substituto leve do sudo para desenvolvedores do OpenBSD.  O Linux geralmente usa seu fork do <a href="https://github.com/Duncaen/OpenDoas">OpenDoas.</a> </blockquote><br><h1 id="zapusk">  Lan√ßamento </h1><br><p>  Se voc√™ deseja controlar a partir da linha de comando sem usar gerentes como o SDDM, a √∫nica maneira correta de fazer isso √© </p><br><pre> <code class="plaintext hljs">$ exec sway</code> </pre> <br><p>  Se voc√™ executar o balan√ßo sem o <code>exec</code> , bloquear a tela com o bloqueio e a queda do balan√ßo, voc√™ ser√° jogado de volta √† linha de comando.  A fechadura ser√° in√∫til. </p><br><blockquote>  Nota para os f√£s do systemd: o sway n√£o requer nem systemd-logind nem elogind.  √â verdade que, nesse caso, voc√™ ter√° que definir o suid bit ou configurar os recursos.  Veja o <a href="https://github.com/swaywm/sway/wiki/Running-Sway-without-systemd">wiki</a> . </blockquote><br><h2 id="peremennye-okruzheniya">  Vari√°veis ‚Äã‚Äãde ambiente </h2><br><p>  Existem v√°rios lugares onde eu os prescrevo. </p><br><p>  Script de shell em <code>~/.local/bin/sway</code> - para vari√°veis ‚Äã‚Äãespec√≠ficas ao sway.  Por exemplo, quero que os aplicativos Qt n√£o mostrem o cen√°rio e usem o tema de <code>qt5ct</code> : </p><br><pre> <code class="plaintext hljs">#!/bin/bash QT_QPA_PLATFORMTHEME=qt5ct \ QT_WAYLAND_DISABLE_WINDOWDECORATION=1 \ /usr/bin/sway</code> </pre> <br><p>  <code>~/.pam_environment</code> - para vari√°veis ‚Äã‚Äãque eu quero disponibilizar imediatamente na sess√£o do usu√°rio systemd.  Um exemplo: </p><br><pre> <code class="plaintext hljs">SSH_AUTH_SOCK DEFAULT="${XDG_RUNTIME_DIR}/gnupg/S.gpg-agent.ssh"</code> </pre> <br><p>  No entanto, altere este arquivo com cuidado, especialmente se voc√™ usar outros ambientes.  Por exemplo, o KDE Plasma n√£o gostar√° muito se detectar <code>$WAYLAND_DISPLAY</code> (ironicamente, o m√≥dulo <code>pam_env</code> que <code>pam_env</code> este arquivo foi criado h√° N anos atr√°s, principalmente para definir a vari√°vel <code>$DISPLAY</code> ). </p><br><p>  <code>~/.bashrc</code> - para todos os outros casos. </p><br><h1 id="nastroyka-sway">  Configura√ß√£o do balan√ßo </h1><br><h2 id="vvod">  Entrar </h2><br><p>  Tudo √© bem simples no meu sistema: instalamos layouts em russo e ingl√™s e alternamos entre eles com <code>Alt+Shift</code> .  Na configura√ß√£o do balan√ßo, fica assim: </p><br><pre> <code class="plaintext hljs">input * { xkb_layout us,ru xkb_options grp:alt_shift_toggle }</code> </pre> <br><p>  O Sway usa a biblioteca <code>libinput</code> para entrada, o mesmo que o KDE e o Gnome.  Portanto, temos muitas op√ß√µes dispon√≠veis.  Configura√ß√µes do touchpad, rolagem natural, acelera√ß√£o do ponteiro do mouse etc.  etc.  A lista de op√ß√µes pode ser examinada em <code>man sway-input</code> e a lista de dispositivos de entrada na sa√≠da do comando </p><br><pre> <code class="plaintext hljs">swaymsg -t get_inputs</code> </pre> <br><p>  No entanto, gostaria de chamar a aten√ß√£o para uma oportunidade interessante.  Se voc√™ estiver saindo de um ambiente X, basta transferir as configura√ß√µes do teclado a partir da√≠.  Execute o comando neste ambiente </p><br><pre> <code class="plaintext hljs">$ xkbcomp $DISPLAY /path/to/keymap.xkb</code> </pre> <br><p>  e no registro de configura√ß√£o do balan√ßo </p><br><pre> <code class="plaintext hljs">input * { xkb_file /path/to/keymap.xkb }</code> </pre> <br><h2 id="hotkei">  Teclas de atalho </h2><br><p>  As teclas de atalho, como todo o resto, s√£o definidas na configura√ß√£o.  Existem 3 comandos para defini-los: </p><br><ol><li>  <code>bindswitch</code> .  √â realizada ao abrir / fechar a tampa do laptop, ao modo tablet, etc. </li><li>  <code>bindcode</code> .  √â executado quando uma tecla com o c√≥digo especificado √© pressionada.  N√£o depende do layout atual, especialmente √∫til para teclas multim√≠dia. </li><li>  <code>bindsym</code> .  O caractere atual inserido depende do layout.  No entanto, se voc√™ adicionar o par√¢metro <code>--to-code</code> , esse caractere ser√° implicitamente convertido no c√≥digo correspondente para o primeiro layout do <code>xkb_layout</code> (consulte as configura√ß√µes de entrada). </li></ol><br><p>  Por exemplo, uma tecla de atalho superar√° a janela atual, independentemente do layout: </p><br><pre> <code class="plaintext hljs">bindsym --to-code $mod+Shift+q kill</code> </pre> <br><p>  Voc√™ pode ler mais sobre esses par√¢metros em mana: <code>man 5 sway</code> . </p><br><p>  Para determinar facilmente o que foi pressionado, o autor do sway escreveu um <a href="https://git.sr.ht/~sircmpwn/wshowkeys">keylogger</a> especial (ele precisa de direitos de root para funcionar, portanto, n√£o h√° necessidade de se preocupar com seguran√ßa). </p><br><h2 id="vyvod">  Conclus√£o </h2><br><p>  Uma lista de dispositivos de sa√≠da dispon√≠veis pode ser obtida com o comando </p><br><pre> <code class="plaintext hljs">swaymsg -t get_outputs</code> </pre> <br><p>  Na configura√ß√£o de cada um deles, voc√™ pode definir o modo de v√≠deo, dimensionamento (incluindo fracion√°rio), imagem, rota√ß√£o etc.  A configura√ß√£o mais simples √© assim: </p><br><pre> <code class="plaintext hljs">output HDMI-A-1 mode 1920x1080@60Hz output * bg /path/to/wallpaper.jpg fill</code> </pre> <br><p>  Uma lista completa de op√ß√µes pode ser encontrada no mana <code>man sway-output</code> . <br>  Existe tamb√©m um programa <a href="https://github.com/emersion/wlr-randr">wlr-randr</a> no qual tudo isso pode ser definido na linha de comando (ou seja, √© um an√°logo do XRandr para Wayland). </p><br><h2 id="swaybar">  Swaybar </h2><br><p>  Barra estabilizadora - um painel no qual as informa√ß√µes de status s√£o exibidas.  Data, hora, bandeja do sistema etc.  etc.  Normalmente, os ventiladores i3 e os osciladores passam mais tempo configurando esse painel espec√≠fico (ou pain√©is, pode haver v√°rios).  Pessoalmente, eu tenho o suficiente disso, perto da configura√ß√£o m√≠nima: </p><br><pre> <code class="plaintext hljs">bar { position top colors { statusline #ffffff background #282828E6 inactive_workspace #282936BF #282936BF #5c5c5c } font Hack 11 status_command i3blocks }</code> </pre> <br><p>  Existem muitas op√ß√µes para ajustar posi√ß√£o, cores, fontes, bandeja, etc.  Voc√™ pode <code>man 5 sway-bar</code> sobre eles em mana - <code>man 5 sway-bar</code> . </p><br><p>  O Swaybar est√° comprometido em ler e analisar o json no formato i3bar, produzido pelo <code>status_command</code> .  Existem muitos programas que podem ser usados ‚Äã‚Äãaqui.  <a href="https://i3wm.org/i3status/">i3status</a> , <a href="https://github.com/Alexays/Waybar">waybar</a> , <a href="https://github.com/greshake/i3status-rust">i3status-rs</a> e muitos outros projetos.  Pessoalmente, prefiro <a href="https://github.com/vivien/i3blocks">i3blocks</a> devido √† simplicidade da configura√ß√£o e √† facilidade de adicionar blocos personalizados. </p><br><h1 id="nastroyka-prikladnyh-programm">  Configura√ß√£o do aplicativo </h1><br><h2 id="uvedomleniya">  Notifica√ß√µes </h2><br><p>  Isso pode ser <a href="https://github.com/emersion/mako">feito pelo</a> daemon <a href="https://github.com/emersion/mako">mako</a> (provavelmente existe na sua distribui√ß√£o).  L√° voc√™ tamb√©m pode ajustar cores, etc., mas tudo isso √© opcional.  Basta execut√°-lo e ele funcionar√°. </p><br><p>  O Mako implementa a especifica√ß√£o de Notifica√ß√µes de √°rea de trabalho XDG baseada em dbus.  √â suportado por muitos programas, incluindo Chromium, Firefox e Telegram. </p><br><h2 id="emulyator-terminala">  Emulador de terminal </h2><br><p>  Em ambientes como o KDE, o Plasma normalmente usa emuladores embutidos que exibem menus, guias e muitos outros elementos de design.  Mas por que tudo isso influencia?  Eu prefiro o <a href="https://github.com/alacritty/alacritty">Alacritty</a> - muito r√°pido, gra√ßas ao uso do emulador de GPU, a prop√≥sito, escrito em Rust.  Adicionei essas teclas de atalho √† se√ß√£o key_bindings em sua configura√ß√£o ( <code>~/.config/alacritty/alacritty.yml</code> ): </p><br><pre> <code class="plaintext hljs">- { key: T, mods: Control|Shift, action: SpawnNewInstance }</code> </pre> <br><p>  abra uma nova janela com o diret√≥rio atual.  Um √≥timo substituto para as guias e o balan√ßo cuidar√° do layout. </p><br><pre> <code class="plaintext hljs">- { key: Up, mods: Control|Shift, action: ScrollLineUp, mode: ~Alt } - { key: Down, mods: Control|Shift, action: ScrollLineDown, mode: ~Alt }</code> </pre> <br><p>  role para cima / baixo uma linha. </p><br><p>  Escrevemos na configura√ß√£o do balan√ßo </p><br><pre> <code class="plaintext hljs">set $term alacritty bindsym $mod+Return exec $term</code> </pre> <br><p>  O Alacritty n√£o suporta ligaduras, pois elas afetam a velocidade de renderiza√ß√£o.  Se voc√™ ainda precisar deles, preste aten√ß√£o ao <a href="https://sw.kovidgoyal.net/kitty/">gatinho</a> - este emulador tamb√©m √© muito r√°pido e h√° apenas uma quantidade assustadora de recursos e configura√ß√µes sob o cap√¥. </p><br><h2 id="zapusk-prilozheniy">  Iniciar aplicativos </h2><br><p>  Os aplicativos influenciados geralmente s√£o iniciados usando o menu de teclas de atalho.  Na configura√ß√£o, eles escrevem algo como </p><br><pre> <code class="plaintext hljs">set $menu ... bindsym --to-code $mod+d exec $menu</code> </pre> <br><p>  Existem muitos programas para exibir o menu.  Alguns, como <a href="https://tools.suckless.org/dmenu/">dmenu</a> ou <a href="https://github.com/davatorium/rofi">rofi</a> , precisam do XWayland.  Entre os que trabalham no Wayland, podemos distinguir <a href="https://github.com/Cloudef/bemenu">bemenu</a> e at√© krunner (o que aparece no KDE pelo <code>Alt+F2</code> . Sim, este √© um programa independente). </p><br><p>  No entanto, prefiro uma solu√ß√£o mais universal, ou seja, o <a href="https://github.com/Biont/sway-launcher-desktop">sway-launcher-desktop</a> .  Apesar do nome, ele n√£o depende de influ√™ncia e, em geral, n√£o √© um programa da GUI, mas um pequeno script de shell que funciona no console.  Este script forma um menu a partir de programas em <code>$PATH</code> , arquivos da √°rea de trabalho instalados (de acordo com a especifica√ß√£o XDG Desktop Entry) e, possivelmente, fontes adicionais (configuradas na configura√ß√£o).  O maravilhoso utilit√°rio <code>fzf</code> √© usado para exibir e pesquisar no menu - preste aten√ß√£o nele. </p><br><p>  Assim, para exibir o menu, precisamos abrir uma janela de terminal com este programa.  Com alacritty, isso √© feito assim: </p><br><pre> <code class="plaintext hljs">set $menu exec alacritty -e sway-launcher-desktop bindsym --to-code $mod+d exec $menu</code> </pre> <br><p>  Voc√™ pode fazer essa janela flutuar por padr√£o.  No i3 e no sway, essas regras s√£o configuradas na configura√ß√£o usando a diretiva <code>for_window</code> .  Para mapear a regra para a janela <code>sway-launcher-desktop</code> , ela precisa receber uma classe exclusiva, para mim √© apenas o <code>Launcher</code> .  Lembre-se de que, devido ao uso de Wayland, os crit√©rios listados no <a href="https://i3wm.org/docs/userguide.html">manual i3</a> n√£o s√£o adequados para oscila√ß√£o.  Os corretos podem ser encontrados no <code>man 5 sway</code> , se√ß√£o <code>CRITERIA</code> .  Nesse caso, <code>app_id</code> √© bastante adequado, e a configura√ß√£o final √© assim: </p><br><pre> <code class="plaintext hljs">set $menu exec alacritty --class Launcher -e sway-launcher-desktop for_window [app_id="Launcher"] floating enable, border pixel 10, sticky enable bindsym --to-code $mod+d exec $menu</code> </pre> <br><h2 id="avtozapusk-prilozheniy">  Iniciar aplicativos automaticamente </h2><br><p>  Em princ√≠pio, para iniciar automaticamente um programa, voc√™ pode simplesmente escrever </p><br><pre> <code class="plaintext hljs">exec /path/to/program</code> </pre> <br><p>  na configura√ß√£o de oscila√ß√£o ou at√© mesmo criar uma unidade systemd personalizada.  No entanto, neste artigo, usarei a especifica√ß√£o de inicializa√ß√£o autom√°tica do XDG adotada pelo KDE e Gnome. </p><br><p>  A especifica√ß√£o √© para executar arquivos da √°rea de trabalho localizados nos diret√≥rios <code>/etc/xdg/autostart</code> e <code>~/.config/autostart</code> .  Como regra, esses arquivos v√™m em pacotes com programas, mas s√£o f√°ceis de criar voc√™ mesmo. </p><br><p>  √â aqui que a ess√™ncia modular do balan√ßo se manifesta.  O Sway em si n√£o sabe nada sobre o XDG Autostart, nem sobre o XDG Desktop Entry.  Al√©m disso, seus desenvolvedores n√£o gostam ativamente dessas e de todas as especifica√ß√µes semelhantes.  No entanto, o utilit√°rio <a href="https://github.com/jceb/dex">dex</a> console pode gerenci√°-los (provavelmente, ele est√° no reposit√≥rio da sua distribui√ß√£o). </p><br><p>  Para verificar o que haver√° na execu√ß√£o autom√°tica, digite o comando </p><br><pre> <code class="plaintext hljs">$ dex -ade Sway</code> </pre> <br><p>  <code>a</code> significa in√≠cio autom√°tico, <code>d</code> - "funcionamento a seco", <code>-e Sway</code> define o nome do ambiente (pode ser qualquer) e √© usado para filtrar. </p><br><p>  Provavelmente, a lista resultante n√£o ser√° adequada para voc√™.  Por exemplo, eu tenho o <code>kgpg</code> .  Procedemos da seguinte maneira: copie o arquivo da √°rea de trabalho correspondente de <code>/etc/xdg/autostart</code> para <code>~/.config/autostart</code> , adicione a linha l√° </p><br><pre> <code class="plaintext hljs">NotShowIn=Sway</code> </pre> <br><p>  e verifique a execu√ß√£o autom√°tica novamente.  Muitos programas (especialmente aqueles escritos em Electron) podem n√£o gostar de rodar em Wayland.  N√≥s fazemos o mesmo com eles.  Copiamos o arquivo da √°rea de trabalho e alteramos a linha de lan√ßamento l√°.  Foi: </p><br><pre> <code class="plaintext hljs">Exec=/usr/bin/skypeforlinux</code> </pre> <br><p>  tornou-se: </p><br><pre> <code class="plaintext hljs">Exec=env GDK_BACKEND=x11 /usr/bin/skypeforlinux</code> </pre> <br><p>  a mesma t√©cnica pode ser aplicada ao sway-launcher-desktop do par√°grafo anterior.  Quando todos os problemas forem resolvidos, adicione a linha √† configura√ß√£o de oscila√ß√£o </p><br><pre> <code class="plaintext hljs">exec dex -ae Sway</code> </pre> <br><p>  Ou voc√™ pode fazer o oposto: copie os arquivos da √°rea de trabalho desejados para algum diret√≥rio n√£o padr√£o e defina o dex nele com o comando </p><br><pre> <code class="plaintext hljs">exec dex -as /path/to/your/dir</code> </pre> <br><h2 id="skrinshoty">  Screenshots </h2><br><p>  Dois caix√µes nos ajudar√£o nisso.  <a href="https://github.com/emersion/slurp">O slurp</a> permite selecionar uma √°rea retangular arbitr√°ria na tela e o <a href="https://github.com/emersion/grim">sombrio</a> faz uma captura de tela dela.  Na minha configura√ß√£o, fica assim: </p><br><pre> <code class="plaintext hljs">bindsym Print exec grim ~/Pictures/screen-"$(date +%s)".png bindsym $mod+Print exec grim -g "$(slurp)" ~/Pictures/screen-"$(date +%s)".png</code> </pre> <br><p>  <code>$mod+PrintScreen</code> - captura de tela de uma √°rea arbitr√°ria, <code>PrintScreen</code> - captura de tela de toda a tela. </p><br><h2 id="skrinkasty">  Screencasts </h2><br><p>  Se voc√™ precisar gravar um screencast em um arquivo ou transmiti-lo para um fluxo RTMP (por exemplo, no Twitch), o <a href="https://github.com/ammen99/wf-recorder">wf-recorder</a> ajudar√° nisso (tamb√©m suporta slurp). </p><br><p>  Se voc√™ deseja usar o OBS Studio, existe o plugin <a href="https://hg.sr.ht/~scoopta/wlrobs">wlrobs</a> para isso. </p><br><p>  No entanto, a solu√ß√£o mais universal suportada, por um lado, no KDE e no Gnome e, por outro, em particular nos navegadores Chrome e Firefox, √© usar o Pipewire e a especifica√ß√£o do XDG Desktop Portal.  Por outro lado, existe a camada necess√°ria <a href="https://github.com/emersion/xdg-desktop-portal-wlr">xdg-desktop-portal-wlr</a> , embora eu n√£o tenha verificado seu desempenho. </p><br><h2 id="nochnoy-rezhim">  Modo noturno </h2><br><p>  O modo noturno consiste em substituir as cores do monitor por cores mais quentes no escuro.  Os cientistas duvidam de qu√£o √∫til isso realmente seja, e os desenvolvedores de Wayland decidiram que padronizar o protocolo de corre√ß√£o gama era in√∫til por raz√µes t√©cnicas. </p><br><p>  No entanto, eu gosto desse recurso, e tamb√©m est√° l√°.  Para o modo noturno, precisamos desta <a href="https://github.com/minus7/redshift">bifurca√ß√£o do redshift</a> com suporte para o protocolo espec√≠fico de oscila√ß√£o. </p><br><p>  N√≥s o instalamos de qualquer maneira, na configura√ß√£o <code>~/.config/redshift/redshift.conf</code> , selecione o protocolo desejado e especifique a longitude e latitude. </p><br><pre> <code class="plaintext hljs">[redshift] location-provider=manual adjustment-method=wayland [manual] lat=xx.xx lon=yy.yy</code> </pre> <br><h2 id="blokirovka-i-otklyuchenie-ekrana">  Bloqueio e tela desativada </h2><br><p>  Dois de outro caix√£o v√™m em socorro aqui.  <code>swayidle</code> executa os comandos fornecidos em timeout se n√£o houver atividade (ou vice-versa, sua apar√™ncia) e o <code>swaylock</code> bloqueia a tela e requer uma senha.  Voc√™ pode desligar a tela (ou todas as telas, se houver v√°rias) </p><br><pre> <code class="plaintext hljs">swaymsg "output * dpms off"</code> </pre> <br><p>  Aqui est√° a apar√™ncia do daemon, bloqueando a tela ap√≥s 300 segundos de inatividade e desativando-a ap√≥s 600: </p><br><pre> <code class="plaintext hljs">swayidle -w \ timeout 300 'swaylock -f -c 000000' \ timeout 600 'swaymsg "output * dpms off"' \ resume 'swaymsg "output * dpms on"' \ before-sleep 'swaylock -f -c 000000'</code> </pre> <br><p>  Execute-o de qualquer maneira. </p><br><h2 id="i3blocks">  i3blocks </h2><br><p>  Blocos prontos com calend√°rio, rede, status do disco etc.  etc.  pode ser emprestado do reposit√≥rio <a href="https://github.com/vivien/i3blocks-contrib">i3blocks-contrib</a> .  Nos i3blocks, eles s√£o adicionados na configura√ß√£o em <code>~/.config/i3blocks/config</code> .  Por exemplo, um bloco com atualiza√ß√µes a cada 5 segundos pelo dia da semana, data e hora: </p><br><pre> <code class="plaintext hljs">[time] command=date +"%a %d/%m %H:%M" interval=5</code> </pre> <br><p>  Mas este era um exemplo muito simples.  De fato, os entusiastas do i3 e do sway t√™m um santo graal: exibir a barra de t√≠tulo da janela atual na barra superior.  Vamos descobrir como conseguir isso. </p><br><p>  Primeiro de tudo, come√ßamos a ler <code>man sway-ipc</code> e descobrimos que voc√™ pode se inscrever em eventos l√°.  O necess√°rio possui o c√≥digo <code>0x80000003. WINDOW</code>  <code>0x80000003. WINDOW</code> e retorna objetos json dessa estrutura: </p><br><pre> <code class="plaintext hljs">{ "change" : "focus | title | ...", "container": { focused: true | false, name: "...", ... } }</code> </pre> <br><p>  De fato, ou a pr√≥pria janela pode mudar seu t√≠tulo ( <code>change == title</code> ), ou podemos mover o foco para outra janela ( <code>change == focus</code> ).  No entanto, a janela pode alterar o t√≠tulo e ficar fora de foco.  Para filtrar esses eventos, devemos verificar a propriedade <code>container.focused</code> . </p><br><p>  Voc√™ pode descrever toda essa l√≥gica no Python ou no Go, mas existe uma maneira melhor.  <code>swaymsg</code> facilita a inscri√ß√£o nos eventos desejados e a sa√≠da deles para o stdout: </p><br><pre> <code class="plaintext hljs">$ swaymsg -m -t SUBSCRIBE "['window']"</code> </pre> <br><p>  e processaremos o json resultante em <code>jq</code> .  Sem entrar nas sutilezas da sintaxe de consulta deste maravilhoso utilit√°rio, eis o resultado: </p><br><pre> <code class="bash hljs">$ query=<span class="hljs-string"><span class="hljs-string">'select(.change == "focus" or (.change == "title" and .container.focused)) | .container.name'</span></span> $ swaymsg -m -t SUBSCRIBE <span class="hljs-string"><span class="hljs-string">"['window']"</span></span> | jq --unbuffered -r <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$query</span></span></span><span class="hljs-string">"</span></span></code> </pre> <br><p>  Um script de duas linhas no bash, e n√£o mais c√≥digo!  O sinalizador <code>--unbuffered</code> necess√°rio; caso contr√°rio, o i3blocks n√£o receber√° novas linhas imediatamente, mas somente quando o buffer for limpo. </p><br><p>  Por fim, adicione o seguinte bloco √† configura√ß√£o do i3blocks: </p><br><pre> <code class="plaintext hljs">[active_window] command=/path/to/our/script.sh interval=persist</code> </pre> <br><p>  Li√ß√£o de casa: ensine sombrio a tirar uma captura de tela da janela atual.  Eles dizem que essas coisas s√£o imposs√≠veis em Wayland, mas os homens duvidam disso. </p><br><p>  Trabalho de casa 2: Ensine os i3blocks a exibir o layout atual do teclado como uma bandeira.  Existem alguns blocos no i3blocks-contrib, mas eles mostram texto em vez de uma bandeira e n√£o funcionam em Wayland. </p><br><h2 id="prochie-programmy">  Outros programas </h2><br><p>  <a href="https://github.com/bugaevc/wl-clipboard">O wl-clipboard</a> permite que voc√™ trabalhe com a √°rea de transfer√™ncia do terminal, ou seja, ela substitui o xclip e o xsel.  √â especialmente √∫til para usu√°rios do vim, nos quais copiar / colar come√ßa a usar <code>"+y</code> / <code>"+p</code> (basta instalar este pacote, nenhuma configura√ß√£o adicional √© necess√°ria). </p><br><p>  <a href="https://github.com/ReimuNotMoe/ydotool">ydotool</a> - substitui√ß√£o do xdotool. </p><br><p>  <a href="https://gitlab.freedesktop.org/mstoeckl/waypipe/">waypipe</a> - proxy para a transpar√™ncia da rede.  Para ser sincero, n√£o me lembro da √∫ltima vez que algu√©m fez uma pergunta relacionada a esse recurso em f√≥runs especializados.  Talvez eles n√£o usem nada?  Eu - definitivamente n√£o. </p><br><p>  KDE Connect  Adicione o arquivo <code>org.kde.kdeconnect.nonplasma.desktop</code> √† <code>org.kde.kdeconnect.nonplasma.desktop</code> (consulte as se√ß√µes anteriores), instale o KDE Connect no seu smartphone e configure sua conex√£o - e voc√™ pode controlar a reprodu√ß√£o de m√∫sica e v√≠deo do seu smartphone em um navegador com o plug <a href="https://addons.mozilla.org/ru/firefox/addon/plasma-integration/">-</a> in de <a href="https://addons.mozilla.org/ru/firefox/addon/plasma-integration/">integra√ß√£o de plasma</a> , no vlc , no cantata, no mpv com <a href="https://github.com/hoyon/mpv-mpris">o plug-in mpv-mpris</a> e tamb√©m receba notifica√ß√µes no mako.  Meu respeito pelo projeto KDE pelo desenvolvimento de programas que n√£o foram acertados em seus ecossistemas. </p><br><h1 id="zaklyuchenie">  Conclus√£o </h1><br><p>  Voc√™ pode escrever sobre como configurar tudo isso (especialmente o painel i3blocks) sem parar, mas √© melhor parar por aqui.  Aqui est√° o que eu tenho: </p><br><p> <a href=""><img src="https://habrastorage.org/webt/s9/qy/q0/s9qyq0rrpk9rzv4bamj1qsooceq.png"></a> </p><br><p>  <a href="https://www.reddit.com/r/unixporn/">Acesse</a> tamb√©m o subreddit <a href="https://www.reddit.com/r/unixporn/">/ r / unixporn</a> e maravilhe-se com o que as pessoas est√£o fazendo.  (no entanto, 95% de tudo o que √© apresentado l√° parece bonito, mas categoricamente n√£o √© adequado para o trabalho di√°rio :)). </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt484378/">https://habr.com/ru/post/pt484378/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt484368/index.html">Como eu fiz um mecanismo de pesquisa para o Telegram</a></li>
<li><a href="../pt484370/index.html">Slurm SRE - aprenda a garantir a felicidade do usu√°rio</a></li>
<li><a href="../pt484372/index.html">Casa inteligente com Xiaomi no exemplo de uma sauna</a></li>
<li><a href="../pt484374/index.html">Viagem ao centro ... imagem do docker. Ou como baixar uma imagem do registro sem janela de encaixe</a></li>
<li><a href="../pt484376/index.html">Samsung Moscow Center for Artificial Intelligence nas hist√≥rias de funcion√°rios</a></li>
<li><a href="../pt484382/index.html">Algoritmo de Bellman-Ford</a></li>
<li><a href="../pt484386/index.html">Meetup sobre AWS_Ru em Raiffeisenbank</a></li>
<li><a href="../pt484388/index.html">VVVVVV ??? VVVVVV !!! :)</a></li>
<li><a href="../pt484390/index.html">Glean Insights sobre as 18 melhores estruturas Java a serem usadas em 2020</a></li>
<li><a href="../pt484392/index.html">Convuls√µes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>