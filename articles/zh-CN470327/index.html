<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👢 🧙🏻 👨🏾‍🍳 InSys JSC制造的设备在MATLAB / Simulink中的应用 ⁉️ 🚺 🏺</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="一个重要的实际任务是将Matlab / Simulink与实际设备一起使用，这将使您能够接收来自真实世界的信号。 这对于调试算法非常有用。 本文介绍了将InSys JSC制造的ADC器件连接到Simulink的技术。 DLL用于连接，在Simulink中作为sm_adc组件可见。 使用单独的控制台程...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>InSys JSC制造的设备在MATLAB / Simulink中的应用</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470327/"> 一个重要的实际任务是将Matlab / Simulink与实际设备一起使用，这将使您能够接收来自真实世界的信号。 这对于调试算法非常有用。 本文介绍了将InSys JSC制造的ADC器件连接到Simulink的技术。  DLL用于连接，在Simulink中作为sm_adc组件可见。 使用单独的控制台程序来操作设备。 与DLL的通信是通过共享内存进行的。 根据该技术，可以连接InSys JSC的任何负载模块上的任何ADC。 该作品介绍了一个由A7_DAC发生器和FMC128E / FM412x500M采集模块组成的系统。 <br><br> 在2018年3月27日至28日举行的“复杂技术系统的开发和调试技术”会议上演示了此工作。 <br><br><img src="https://habrastorage.org/webt/2q/2y/7a/2q2y7ajg2jcoezpe6x1ptohzjia.png"><br><br><a name="habracut"></a><br><br>  <b>问题陈述</b> <br><br> 它需要从信号发生器和ADC开发系统，以产生具有给定参数的信号并将其数字化。 接收到的数据必须传输到Simulink进行处理。 <br><br>  <b>配套设备</b> <br><br> 为了工作，从ADC模块和发电机组装了一个支架。 作为ADC，使用FM412x500M子模块，其中有四个ADC通道，采样频率为500 MHz。 子模块安装在FMC128E载体模块上，其中有Artix 7 FPGA和USB 3.0接口。 两个设备都连接到运行Simulink的笔记本电脑。 为了监视性能，当然要使用示波器。 <br><br>  <b>展台外观：</b> <br><br><img src="https://habrastorage.org/webt/i_/tg/pt/i_tgptlp8qd0txtxts7qlwlnjls.jpeg"><br><br>  <b>展台结构图：</b> <br><br><img src="https://habrastorage.org/webt/bf/_x/n4/bf_xn4xf3dirqyym-6pugnunsqo.png"><br><br>  <b>信号产生：</b> <br><br><img src="https://habrastorage.org/webt/r7/ww/rr/r7wwrrzr0ce7s6ba9iavxqzarlu.png"><br><br>  <b>展位的算法：</b> <br><br><ol><li>  Simulink准备启动ADC和发生器 </li><li>  Simulink指示发电机启动 </li><li> 发生器形成一个选通信号（黄色信号）和实际信号（蓝色） </li><li> 门前的ADC开始收集数据 </li><li>  ADC收集阵列并将其传递给Simulink </li><li>  Simulink显示从ADC接收的信号 </li></ol><br><br> 这是经典的一次性收集模式。 它的独特之处恰恰是单一性。 沿信号前端的设备收集给定的数据阵列。 数据收集阶段发生在“硬实时”模式下，但是处理方法是如何获取它。 采集速率取决于所选通道的数量和采样率。 对于四个ADC通道和500 MHz的采样频率，数据速率为4 GB / s。 以这种速度，可以将数据写入FMC128E的SODIMM。 也就是说，可以保存4 GB的样本。 <br><br> 此外，数据应传输到计算机。  FMC128E模块通过USB 3.0接口连接到计算机。 数据传输速率为300 MB / s。 <br><br>  Simulink接收数据数组并将其传递以进行进一步处理。 该处理的时间已经由模型的复杂性确定。 在此示例中，该阵列仅显示在示波器面板上。 <br><br> 在某个时候，Simulink决定有必要执行下一个循环，然后一切重复。 再次发送USB命令以准备ADC，启动发生器并收集数据。 <br><br> 此模式对于调试硬件和算法非常方便。 您不能在任何地方着急。 收集数据数组。 您可以冷静地看一眼，将其刻录到光盘上，然后喝咖啡。 但是，当一切都解决了之后，就可以切换到连续收集模式了。 <br><br>  <b>DLL连接</b> <br><br>  Matlab允许您连接在外部DLL中实现的功能。  Simulink还具有连接外部DLL的能力，同时增加了一些要求。 在Simulink内部，外部DLL看起来像一个S功能块。 <br><br><img src="https://habrastorage.org/webt/vi/ln/ov/vilnovzdl8eg7r3kqxbwgwcgh5a.png"><br><br>  MATLAB提供了大量示例，包括创建外部DLL。 但是，MATLAB提供的方法不是很方便。 有一个开源的<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">easyLink</a></b>项目。 该项目开发了一个用于连接Simulink的类库。 <br><br> 要创建组件，您需要创建一个从BaseBlock派生的类并声明端口： <br><br><img src="https://habrastorage.org/webt/_m/p-/rb/_mp-rbn7ntlkvgxwf3xnoibmhlm.png"><br><br><img src="https://habrastorage.org/webt/qn/94/th/qn94tho2jxf3nlnhaarxwosshxq.png"><br><br>  <b>DLL连接问题</b> <br><br> 外部DLL允许很多，但是使用它们时有很多问题。 对我个人而言，最重要的是： <br><br><ol><li>  DLL调试困难 </li><li> 观看printf（）输出很尴尬 </li><li> 重新编译DLL需要退出MATLAB </li></ol><br> 调试程序时，需要分步调试。 对于DLL，可以连接到已加载到内存中的DLL，在其中分配断点，并进行调试会话。 但是有必要抓住通过Simulink加载DLL的时刻，以某种方式延迟了工作的开始。 所有这些都可以完成，但是不方便。 <br><br> 在此过程中，我真的很想看到作为标准stdout流形成的调试输出。 在DLL的情况下，可以某种方式截获此线程，但我没有成功。 <br><br> 最后，最重要的不便是重新编译DLL时需要退出MATLAB。 否则，您将无法编写新文件。 退出和随后启动MATLAB需要很多时间。 <br><br> 为了解决这些问题，有一种构建复杂软件系统的经典方法。 这是程序之间通过共享内存进行的交互。 <br><br>  <b>共享内存连接</b> <br><br>  Windows和Linux都可以使用现代操作系统来组织内存的公共区域。 这使您可以创建可靠的程序。 例如，一个程序可以包含图形界面并与操作员进行交互，而另一个程序可以与设备进行交互。 在这种情况下，冻结与设备交互的程序不会导致冻结与操作员交互的程序。 在Simulink的情况下，此方法还提供了一些优点。 与设备一起使用的程序将启动一次，它将准备设备并等待通过共享内存发出的命令。 每次在仿真上运行Simulink时，DLL将加载。 由于DLL不能直接与硬件一起使用，因此启动会很快。 <br><br> 为此支架开发了两个程序和两个DLL： <br><br><ol><li>  simulink_a7dac-发电机控制程序 </li><li>  simulink_adc-ADC控制程序 </li><li>  sm_ctrl-生成器控件DLL </li><li>  sm_adc-ADC控制DLL </li></ol><br><br> 框图如下图所示： <br><br><img src="https://habrastorage.org/webt/1u/vq/ec/1uvqecetd2an7yzazp2z2p2idma.png"><br><br>  simulink_adc程序基于Bardy库。 该程序使您可以使用InSys JSC制造的任何ADC。 通过初始化文件完成对特定ADC和载波模块的调整。 <br><br>  <b>Simulink中的方案视图</b> <br><br> 最后，Simulink内部的外观是： <br><br><img src="https://habrastorage.org/webt/mb/w8/aq/mbw8aq0g8ddsb2wnkbk9p6dhr8c.png"><br><br> 一切看起来都与Simulink相同。 一台用于ADC控制的单元。 第二块控制发电机。 许多参数可用于控制发电机。 对于ADC，一切都通过初始化文件完成。 如有必要，还可以在块级别显示许多ADC参数。 <br><br> 注意两个主振荡器。 在模型时间方面，它们指定数据收集的开始时间和时刻。 这些要点非常重要。 他们实际上设置了模型与现实世界之间的联系。 起始信号进入ADC模块，并在DLL中进行处理。 通过共享内存，他进入了ADC程序。 然后，将其转换为对寄存器的一系列写入命令，然后通过USB进入FPGA。 在FPGA内部，启动信号的搜索前沿被锁定。 并且只有在机器朝相反方向翘起之后，确认才经过同一链。 当确认到达Simulink时，start_out信号将出现在sm_adc块的输出处，该信号将传递到sm_ctrl块。 这将是在建模时间的同一时刻。 在sm_ctrl块中，沿着同一链，信号将被传输到生成器的FPGA，并形成信号。  ADC将在其存储器中捕获此信号。 将从第二主振荡器产生数据采集信号。 以同样的方式，数据进入Simulink，并进入sm_adc块的数据输出。 目前，正在返回一个16384个计数的块。 接收到的块显示在示波器上。 <br><br><img src="https://habrastorage.org/webt/ov/u3/uk/ovu3uklgq_xzvvjpkfcpoopqzec.png"><br><br>  <b>结果</b> <br><br> 事实证明，通过共享内存进行工作是有效的。  ADC管理程序使您可以使用我们的任何ADC。 同时，仍然存在通过配置文件配置参数的便捷方法。 该程序被设计为控制台应用程序，而所有调试输出均可见。 有可操作性的迹象。  SM_CTRL组件允许您连接各种外部应用程序以控制设备。 调试ADC控制程序不会造成任何困难。 这是一个通用程序，您可以在其中设置断点并进行调试。 使用相同的技术，可以开发用于Matlab / Simulink与外界交互的其他程序。 <br><br> 该工作发表在网站<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">hub.exponenta.ru上</a> ; <br><br> 参考文献： <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SIMULINK_SM项目-程序源代码：https://github.com/dsmv/simulink_sm</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">EasyLink项目：https://sourcesup.renater.fr/frs/?group_id=1500</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">载体模块FMC128E http://insys.ru/fmc/fmc128e</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">子模块FM412x500M http://insys.ru/mezzanine/fm412x500m</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">电报频道InSys Research</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN470327/">https://habr.com/ru/post/zh-CN470327/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN470311/index.html">木制玩具，第七部分-1993年</a></li>
<li><a href="../zh-CN470313/index.html">木制玩具，第八部分-1994年</a></li>
<li><a href="../zh-CN470317/index.html">C ++缩写备忘单等。 第2部分：“不仅如此”</a></li>
<li><a href="../zh-CN470321/index.html">木制玩具，第九部分-1995</a></li>
<li><a href="../zh-CN470323/index.html">DIY DeepFake [部分1]</a></li>
<li><a href="../zh-CN470331/index.html">如何识别索引的ISI，Scopus或Scimago日志？</a></li>
<li><a href="../zh-CN470333/index.html">程序员，经理，MVC和验收标准</a></li>
<li><a href="../zh-CN470337/index.html">我如何在Y. Market工作3个月并退出</a></li>
<li><a href="../zh-CN470349/index.html">使用用于SBT和Scala的WSDL导入自动化SOAP客户端自动生成例程</a></li>
<li><a href="../zh-CN470355/index.html">C＃中的动态：用法配方</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>