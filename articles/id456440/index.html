<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌒 🧖🏼 😫 Petualangan Malvari yang Elusif, Bagian I ⏩ 👵🏾 🏗️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dengan artikel ini, kami memulai serangkaian publikasi tentang malvari yang sulit dipahami. Program peretasan yang tidak meninggalkan jejak serangan, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Petualangan Malvari yang Elusif, Bagian I</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/varonis/blog/456440/"><img src="https://habrastorage.org/webt/t5/7j/ep/t57jepsiopn5j3zbxlikd2ago-e.jpeg"><br><br>  Dengan artikel ini, kami memulai serangkaian publikasi tentang malvari yang sulit dipahami.  Program peretasan yang tidak meninggalkan jejak serangan, juga dikenal sebagai fileless, biasanya menggunakan PowerShell pada sistem Windows untuk secara rahasia menjalankan perintah untuk mencari dan mengekstrak konten yang berharga.  Mendeteksi aktivitas peretas tanpa file jahat adalah tugas yang sulit, karena  antivirus dan banyak sistem deteksi lainnya bekerja berdasarkan analisis tanda tangan.  Tetapi kabar baiknya adalah bahwa perangkat lunak tersebut memang ada.  Misalnya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sistem UBA</a> yang dapat mendeteksi aktivitas berbahaya dalam sistem file. <br><a name="habracut"></a><br>  Ketika saya mulai mempelajari topik tentang peretas keren yang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tidak menggunakan metode infeksi tradisional</a> , tetapi hanya alat dan perangkat lunak yang tersedia di komputer korban, saya tidak menduga bahwa ini akan segera menjadi metode serangan yang populer.  Para profesional keamanan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mengatakan</a> ini menjadi tren, dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">judul artikel yang menakutkan</a> adalah buktinya.  Karena itu, saya memutuskan untuk membuat serangkaian publikasi tentang topik ini. <br><br><h2>  PowerShell Hebat dan Mengerikan </h2><br>  Saya menulis tentang beberapa ide ini sebelumnya dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">seri kebingungan PowerShell</a> , tetapi lebih pada teori.  Kemudian saya menemukan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">situs untuk analisis hibrida</a> , di mana Anda dapat menemukan sampel malvari, "tertangkap" di alam liar.  Saya memutuskan untuk mencoba menggunakan situs ini untuk mencari sampel malware tanpa fil.  Dan saya berhasil.  Ngomong-ngomong, jika Anda ingin melanjutkan ekspedisi sendiri untuk mencari malware, Anda harus melalui pemeriksaan di situs ini sehingga mereka tahu bahwa Anda melakukan pekerjaan sebagai spesialis topi putih.  Sebagai seorang blogger yang menulis tentang keamanan, saya menjalaninya tanpa pertanyaan.  Saya yakin Anda juga bisa. <br><br>  Selain sampel itu sendiri, Anda dapat melihat di situs apa program ini lakukan.  Analisis hibrid meluncurkan malware di kotak pasirnya sendiri dan melacak panggilan sistem, menjalankan proses dan tindakan di jaringan, dan juga mengekstrak string teks yang mencurigakan.  Untuk file biner dan file executable lainnya, mis.  Di mana Anda bahkan tidak dapat melihat kode tingkat tinggi yang sebenarnya, analisis hibrida memutuskan apakah perangkat lunak tersebut berbahaya atau hanya mencurigakan berdasarkan aktivitasnya saat runtime.  Dan setelah itu sampel sudah dievaluasi. <br><br>  Dalam kasus PowerShell dan skrip sampel lainnya (Visual Basic, JavaScript, dll.), Saya dapat melihat kode itu sendiri.  Sebagai contoh, saya menemukan contoh PowerShell: <br><br><img src="https://habrastorage.org/webt/6l/vo/9a/6lvo9a-5fjn2damwm8vivmh2goc.jpeg"><br><br><p>  <i>Anda juga dapat menjalankan PowerShell yang disandikan base64 untuk menghindari deteksi.</i>  <i>Perhatikan penggunaan parameter Noninteraktif dan Tersembunyi.</i> </p><br>  Jika Anda membaca entri kebingungan saya, maka Anda tahu bahwa opsi -e menunjukkan bahwa konten dikodekan dalam base64.  Ngomong-ngomong, analisis hibrida juga membantu dengan ini, menguraikan semuanya kembali.  Jika Anda ingin mencoba mendekode base64 PowerShell (selanjutnya - PS) sendiri, Anda perlu menjalankan perintah ini: <br><br><pre><code class="plaintext hljs">[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($EncodedText))</code> </pre> <br><h2>  Pergi lebih dalam </h2><br>  Saya mendekodekan PS-script kami menggunakan metode ini, teks dari program disajikan di bawah ini, meskipun sedikit dimodifikasi oleh saya: <br><br><img src="https://habrastorage.org/webt/ro/ef/zi/roefzis_uwim8flbumkfqsvrvlu.jpeg"><br><p>  <i>Perhatikan bahwa derit terikat pada tanggal 4 September 2017 dan melewati cookie sesi.</i> </p><br>  Saya menulis tentang gaya serangan ini dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">seri kebingungan PS</a> , di mana skrip base64 yang dikodekan itu sendiri mengunduh malware yang <i>hilang</i> dari situs lain, menggunakan objek WebClient dari pustaka .Net Framework untuk melakukan semua kerja keras. <br><br>  Untuk apa ini? <br><br>  Untuk perangkat lunak keamanan yang memindai log peristiwa atau firewall Windows, pengkodean base64 mencegah deteksi string WebClient dengan pola teks sederhana untuk melindungi terhadap permintaan web tersebut.  Dan karena semua malware "jahat" kemudian diunduh dan ditransfer ke PowerShell kami, pendekatan ini memungkinkan Anda untuk sepenuhnya menghindari deteksi.  Sebaliknya, saya pikir begitu pada awalnya. <br><br>  Ternyata dengan dimasukkannya pencatatan lanjutan log Windows PowerShell (lihat artikel saya), Anda dapat melihat baris yang dimuat di log peristiwa.  Saya (seperti <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">orang lain</a> ) percaya bahwa Microsoft harus mengaktifkan tingkat logging ini secara default.  Oleh karena itu, ketika pencatatan diperpanjang dinyalakan, kita akan melihat di log peristiwa Windows permintaan lengkap untuk memuat dari skrip PS sesuai dengan contoh yang kami periksa di atas.  Karena itu, masuk akal untuk mengaktifkannya, setuju? <br><br><h2>  Tambahkan skrip tambahan </h2><br>  Peretas dengan cekatan menyembunyikan serangan PowerShell di makro Microsoft Office yang ditulis dalam Visual Basic dan bahasa scripting lainnya.  Idenya adalah bahwa korban menerima pesan, misalnya, dari layanan pengiriman, dengan laporan terlampir dalam format .doc.  Anda membuka dokumen ini, yang berisi makro, dan akhirnya meluncurkan PowerShell jahat itu sendiri. <br><br>  Seringkali, skrip Visual Basic itu sendiri dikaburkan sehingga secara bebas menghindari antivirus dan pemindai malware lainnya.  Dalam semangat di atas, saya memutuskan sebagai latihan untuk menyandikan PowerShell di atas dalam JavaScript.  Di bawah ini adalah hasil pekerjaan saya: <br><br><img src="https://habrastorage.org/webt/z6/4f/ek/z64fekt9zmny-mmfxihe8qgyfy8.jpeg"><br><p>  <i>JavaScript yang dikaburkan menyembunyikan PowerShell kami.</i>  <i>Peretas sebenarnya melakukannya sekali atau dua kali.</i> </p><br>  Ini adalah salah satu teknik yang saya temui di internet: menggunakan Wscript.Shell untuk menjalankan PowerShell yang disandikan.  Ngomong-ngomong, JavaScript itu sendiri adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sarana</a> pengiriman malware.  Banyak versi Windows memiliki <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Host Script Windows bawaan</a> , yang dengan sendirinya dapat menjalankan JS. <br>  Dalam kasus kami, skrip JS jahat dilampirkan sebagai file dengan ekstensi .doc.js.  Windows biasanya hanya memperlihatkan akhiran pertama, sehingga akan ditampilkan kepada korban sebagai dokumen Word. <br><br><img src="https://habrastorage.org/webt/ge/jy/pt/gejyptu4-xcxc87lweigj9yckqq.jpeg"><br><p>  <i>Ikon JS hanya ditampilkan di ikon gulir.</i>  <i>Tidak mengherankan bahwa banyak orang akan membuka lampiran ini, berpikir itu adalah dokumen Word.</i> </p><br>  Dalam contoh saya, saya memodifikasi PowerShell di atas untuk mengunduh skrip dari situs web saya.  Skrip PS jarak jauh hanya mencetak Malware Jahat.  Seperti yang Anda lihat, dia sama sekali tidak jahat.  Tentu saja, peretas sebenarnya tertarik untuk mendapatkan akses ke laptop atau server, katakanlah, melalui shell perintah.  Pada artikel selanjutnya saya akan menunjukkan cara melakukan ini menggunakan PowerShell Empire. <br><br>  Saya berharap bahwa untuk artikel pengantar pertama kami tidak membahas topik ini terlalu dalam.  Sekarang saya akan membiarkan Anda mengambil napas, dan lain kali kami akan mulai menganalisis contoh nyata serangan menggunakan maleless-fileless tanpa kata-kata dan persiapan tambahan. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id456440/">https://habr.com/ru/post/id456440/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id456428/index.html">Bagaimana menerapkan pendekatan BI untuk analisis data: rekomendasi praktis</a></li>
<li><a href="../id456430/index.html">Masalah abadi utang teknis</a></li>
<li><a href="../id456432/index.html">Minggu Keamanan 25: Evernote kerentanan dan ratusan toko online yang diretas</a></li>
<li><a href="../id456434/index.html">Profesi Masa Depan: "Siapa yang Akan Anda Kerjakan di Mars?"</a></li>
<li><a href="../id456436/index.html">Tugas JS pendek untuk hari Senin</a></li>
<li><a href="../id456442/index.html">Masuk ke program sarjana St. Petersburg State University dengan dukungan Yandex dan JetBrains</a></li>
<li><a href="../id456446/index.html">Ceph - dari "di lutut" ke "produksi"</a></li>
<li><a href="../id456448/index.html">Aturan untuk memilih kerangka kerja JS</a></li>
<li><a href="../id456450/index.html">DO-RA.Avia untuk memantau radiasi kosmik dalam penerbangan</a></li>
<li><a href="../id456452/index.html">Contoh kode C ++ sebelum dan sesudah Rentang</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>