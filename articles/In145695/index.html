<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>тШ║я╕П ЁЯЪЖ ЁЯЫдя╕П рд╡рд╕рдВрдд рд╕реБрд░рдХреНрд╖рд╛ рдореЗрдВ рдПрдХреАрдХрд░рдг рдХреЗ рд╕рд╛рде рд╕рд╛рдорд╛рдЬрд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдПрдкреАрдЖрдИ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рд╛рдЗрдЯ рдкрд░ рдкреНрд░рд╛рдзрд┐рдХрд░рдг ЁЯТЕЁЯП╜ ЁЯСйтАНЁЯПн уА░я╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдореИрдВрдиреЗ рд╕реЛрд╢рд▓ рдиреЗрдЯрд╡рд░реНрдХреНрд╕ REST API рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рдХрд╕рд┐рдд рдкреЛрд░реНрдЯрд▓ рдкрд░ рдкреНрд░рд╛рдзрд┐рдХрд░рдг (рдкрдВрдЬреАрдХрд░рдг) рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╣рдЪрд╛рди рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛ - рд╡рд┐рд╖рдп рдЕрднрд┐рдирд╡, рд╕рдХреН...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд╡рд╕рдВрдд рд╕реБрд░рдХреНрд╖рд╛ рдореЗрдВ рдПрдХреАрдХрд░рдг рдХреЗ рд╕рд╛рде рд╕рд╛рдорд╛рдЬрд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдПрдкреАрдЖрдИ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рд╛рдЗрдЯ рдкрд░ рдкреНрд░рд╛рдзрд┐рдХрд░рдг</h1><div class="post__text post__text-html js-mediator-article" id="post-content-body" data-io-article-url="https://habr.com/ru/post/145695/">  рдореИрдВрдиреЗ рд╕реЛрд╢рд▓ рдиреЗрдЯрд╡рд░реНрдХреНрд╕ REST API рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рдХрд╕рд┐рдд рдкреЛрд░реНрдЯрд▓ рдкрд░ рдкреНрд░рд╛рдзрд┐рдХрд░рдг (рдкрдВрдЬреАрдХрд░рдг) рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╣рдЪрд╛рди рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛ - рд╡рд┐рд╖рдп рдЕрднрд┐рдирд╡, рд╕рдХреНрд░рд┐рдп рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИред  рдореИрдВ рдЕрдкрдиреА рд╕рд╛рдЗрдЯреЛрдВ рдкрд░ рдЗрд╕ рддрд░рд╣ рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рднреА рдЙрдкрдпреБрдХреНрддрддрд╛рдУрдВ рдФрд░ рд▓рд╛рднреЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдирд╣реАрдВ рдХрд░рдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реВрдВ, рд▓реЗрдХрд┐рди рдореИрдВ рдпрд╣ рдзреНрдпрд╛рди рд░рдЦреВрдВрдЧрд╛ рдХрд┐ рдореИрдВ рдкреНрд░рддреНрдпреЗрдХ рд╕рд╛рдЗрдЯ рдХреЗ рд▓рд┐рдП рдкрд╛рд╕рд╡рд░реНрдб рдпрд╛рдж рдирд╣реАрдВ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЦреБрд╢ рд╣реВрдВ (рднрд▓реЗ рд╣реА рдореЗрд░реЗ рдкрд╛рд╕ рдХреБрдЫ рдорд╛рдирдХ рд╣реИрдВ), рдореЗрд▓ рдЕрдЧреНрд░реЗрд╖рдг рдХреЗ рд╕рд╛рде рдЯреЗрдб рдкрдВрдЬреАрдХрд░рдг рдореЗрдВ рднрд╛рдЧ рд▓реЗрдиреЗ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВред рдФрд░ рдкреБрд╖реНрдЯрд┐рдХрд░рдг, рд╕рд╛рде рд╣реА рд╕рд╛рде рдПрдХ рдмрд╛рд░ рдлрд┐рд░ рдХреИрдкреНрдЪрд╛ рдХрд╛ рд╕рд╛рдордирд╛ рдирд╣реАрдВ рдХрд░рдирд╛ рдкрдбрд╝реЗрдЧрд╛ред <br><a name="habracut"></a><br>  рдПрдкреАрдЖрдИ рдбреЗрдЯрд╛ рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛рдлреА рдЖрджрд┐рдо рд╣реИ, рддрдХрдиреАрдХ рд╕рд░рд▓ рд╣реИ, рдФрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХрд╛рдлреА рд╕рдорд╛рди рдФрд░ рд╕рд░рд▓ рд╣реИред  рд▓реЗрдХрд┐рди рдЬрдм рдЖрдк рддрдХрдиреАрдХ рд╕реЗ рдкрд░рд┐рдЪрд┐рдд рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╕рд╛рдорд╛рдЬрд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдкреНрд░рд▓реЗрдЦрди рдФрд░ рдПрдкреАрдЖрдИ рдЙрджрд╛рд╣рд░рдг рдкрд░реНрдпрд╛рдкреНрдд рдирд╣реАрдВ рд╣реИрдВред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЬреИрд╕рд╛ рдХрд┐ рд╡рд┐рд╖рдп рдХрд╣рддрд╛ рд╣реИ, рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рднрд╛рд╖рд╛ рдЬрд╛рд╡рд╛ рд╣реИ, рдЬреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧреА рдЬрд╛рдирдХрд╛рд░реА рдХреА рдорд╛рддреНрд░рд╛ рдХреЛ рдХрдо рдХрд░рддреА рд╣реИред  рдФрд░ RuNet рдореЗрдВ рд╡рд░реНрдгрди рдЗрддрдиреЗ рд╕рд╛рд░реЗ рдирд╣реАрдВ рд╣реИрдВред  рдЖрдк рдХрдо рд╕реЗ рдХрдо рдкреНрд░рддрд┐рд░реЛрдз рдХрд╛ рд░рд╛рд╕реНрддрд╛ рдЕрдкрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рд░реИрд╕реНрдЯрдлреБрд▓ рдЙрддреНрдкрд╛рджреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдХ) рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдкреВрд░реА рд╕рдордЭ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ;  рдмреА) рдЖрд╡рд╢реНрдпрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╕реНрд╡рд┐рдЪрд┐рдВрдЧ рдЧреБрдгреЛрдВ рдХреЛ рдХрдо рдХрд░рддрд╛ рд╣реИ;  рдЧ) рдЕрдХреНрд╕рд░ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдЙрддреНрдкрд╛рдж рдкрд░ рд╢реЛрдз рдХрд░рдирд╛ рдЗрд╕рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЛ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рдХрдард┐рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЗрд╕ рддрд░рд╣ рдХреЗ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдЙрддреНрдкрд╛рдж рдХреА рдЙрдкрдпреЛрдЧрд┐рддрд╛ рд╡рд┐рдХрд╛рд╕ рдХреЛ рдмрд╣реБрдд рдЖрд╕рд╛рди рдХрд░ рд╕рдХрддреА рд╣реИред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЗрд╕ рд╕рдореАрдХреНрд╖рд╛ рдореЗрдВ, рдореИрдВрдиреЗ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ рд╕рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдЕрдзрд┐рдХрддрдо рд░реВрдк рд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдкрд░ рдЬреЛрд░ рджрд┐рдпрд╛ рд╣реИ, рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХрддрд╛ (рд╣рдо "рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рд╛рдЗрдЯ рдкрд░" рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ "рдЬрдХрдбрд╝ рд▓реЗрддреЗ рд╣реИрдВ, рдФрд░ рдХреБрдЫ рд╣реА рдЗрд╕реЗ рдПрдХ рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рдЙрддреНрдкрд╛рдж" рд╕рднреА рдЕрд╡рд╕рд░реЛрдВ рдХреЗ рд▓рд┐рдП "рдмрдирд╛рддреЗ рд╣реИрдВ)ред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдореБрдЭреЗ рди рдХреЗрд╡рд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдкреА рд╣реИ, рдмрд▓реНрдХрд┐ рд╡рд╕рдВрдд рд╕реБрд░рдХреНрд╖рд╛ 3 рдврд╛рдВрдЪреЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рдгрд╛рд▓реА рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдореЗрдВ рднреА рд╣реИред <br><br>  рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдореЛрдВ рдФрд░ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╕реЗрдЯ: <em>рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреЛрд░ 3.1</em> , <em>рд╕реНрдкреНрд░рд┐рдВрдЧ рдПрдорд╡реАрд╕реА 3.1</em> , <em>рд╕реНрдкреНрд░рд┐рдВрдЧ рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА 3.1</em> , <em>рд╣рд╛рдЗрдмрд░рдиреЗрдЯ 4.1</em> ред  рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╡рд┐рджреЗрд╢реА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рд╕рд╛рдорд╛рдЬрд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рд╕реЗрдЯ "рдЙрдирдХреЗ рд▓рд┐рдП" рдорд╛рдирдХ рд╣реИ - <em>рдлреЗрд╕рдмреБрдХ</em> , <em>рдЯреНрд╡рд┐рдЯрд░</em> , <em>Google+</em> , <em>рд▓рд┐рдВрдХреНрдбрдЗрди</em> ред <br><br>  рдореИрдВ рдпрд╣ рдиреЛрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ рдХрд┐ рд╕реНрдкреНрд░рд┐рдВрдЧ рдкреИрдХреЗрдЬ рдореЗрдВ "рдмреЙрдХреНрд╕ рд╕реЗ рдмрд╛рд╣рд░" рддреИрдпрд╛рд░ рдПрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╣реИ - <em>рд╕реНрдкреНрд░рд┐рдВрдЧ рд╕реЛрд╢рд▓</em> (рдЖрдЬ рд░рд┐рд▓реАрдЬ 1.0.2), рдЬреЛ рдЙрддреНрдкрд╛рдж рдХреЗ рд╕реНрдкреНрд░рд┐рдВрдЧ рдлреНрд░реЗрдорд╡рд░реНрдХ рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦрдиреАрдп рд░реВрдк рд╕реЗ рд╕рдордЭрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдЕрдиреНрдп рд╕реНрдкреНрд░рд┐рдВрдЧ рдЙрддреНрдкрд╛рджреЛрдВ рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдпрд╣ рдПрдХ рдкреЗрд╢реЗрд╡рд░ рд╕рдорд╛рдзрд╛рди рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди рд╣рдорд╛рд░рд╛ рдХрд╛рдо рд╣рд░ рдЪреАрдЬ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдирд╛ рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рдЙрддрдирд╛ рдкрд╛рд░рджрд░реНрд╢реА рдмрдирд╛рдирд╛ рд╣реИред  рдФрд░ рд╕рд╛рдорд╛рдЬрд┐рдХ рдХреЗ рд╕рд╛рде, рд╕рдм рдХреБрдЫ рдЗрддрдирд╛ рд╕рд╣рдЬ рдирд╣реАрдВ рд╣реИред <br><br><h4>  1. рдореЙрдбрд▓ред </h4><br>  рдореИрдВрдиреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ <em>POJO</em> , <em>UserDetails</em> рдФрд░ <em>Entity рдХреЗ</em> рд╕рдВрдпреЛрдЬрди рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдЬреЛрдЦрд┐рдо рднрд░рд╛ рдФрд░ рд╡рд┐рд░реЛрдзрд╛рднрд╛рд╕реА рдкрде рд▓рд┐рдпрд╛ред  рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ рдпрд╣ рдЧрд▓рдд рд╣реИ, рд▓реЗрдХрд┐рди рдХ) рдпрд╣ рдмрд╣реБрдд рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ;  рдФрд░ b) рдпрд╣ рдХрдИ рдкрд░рддреЛрдВ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЛ рдмрдЪрд╛рддрд╛ рд╣реИ, рд╣рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ POJO + Entity, рдЕрд▓рдЧ-рдЕрд▓рдЧ UserDetails рдФрд░ рдЕрд▓рдЧ рд╕реЗ DTO рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдЪрд╛рддрд╛ рд╣реИ, рдЬреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕рд╛рдордЧреНрд░реА рдХреА рдирдХрд▓ рдХрд░рддрд╛ рд╣реИред <br><br>  рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдореЙрдбрд▓ рдирд┐рд░реНрдорд╛рдг рдпреЛрдЬрдирд╛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ: <br><img src="https://habrastorage.org/getpro/geektimes/post_images/799/678/17d/79967817de8f230538f8cc639b9272ee.png" alt="рдЫрд╡рд┐"><br>  рдореИрдВрдиреЗ рджреЛ рд▓реЗрдпрд░реНрд╕ (AuthUser рдФрд░ DataUser) рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рддрд╛рдХрд┐ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рддрд░реНрдХ рдФрд░ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рддрд░реНрдХ рдХреЗ рд╕рд╛рде рд╣рд╕реНрддрдХреНрд╖реЗрдк рди рдХрд░реЗрдВ: рдЖрдЧрдВрддреБрдХ, рдкреНрд░рд╢рд╛рд╕рдХ рдФрд░ рдЬреЛ рдХреЛрдИ рднреА рдЙрд╕реА рддрд░рд╣ рд▓реЙрдЧ рдЗрди рд╣реЛ, рд▓реЗрдХрд┐рди рдЧреБрдгреЛрдВ рдХрд╛ рдЕрдкрдирд╛ рд╕реЗрдЯ рд╣реЛред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдореЗрд░реЗ рдкрд╛рд╕ рдореЗрд░реА рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рдЬреЙрдмрд╕реЗрдХрд░реНрд╕ рдФрд░ рдирд┐рдпреЛрдХреНрддрд╛ рд╣реИрдВ, рд╡реЗ рдЙрд╕реА рддрд░рд╣ рд╕рд╛рдЗрдЯ рдкрд░ рдЬрд╛рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдПрдХ рдореЙрдбрд▓ рд╕рдВрд░рдЪрдирд╛ рд╣реИред <br><br>  рдкрд░рддреЛрдВ рдХреЗ рднреАрддрд░ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рдкреГрдердХреНрдХрд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реИ - рдлреЗрд╕рдмреБрдХ, рдЯреНрд╡рд┐рдЯрд░, рдЖрджрд┐ рдФрд░ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдорд╛рдирдХ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рдкреНрдд рдХреНрд╖реЗрддреНрд░реЛрдВ рдХрд╛ рд╕реЗрдЯ, рдЗрддрдирд╛ рдЕрд▓рдЧ рд╣реИ рдХрд┐ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ рд╕рдм рдХреБрдЫ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрд╣реБрдд рд╣реА рдлреИрд▓рд╛ рд╣реБрдЖ рд╕рдВрд░рдЪрдирд╛ рдмрдирд╛рдирд╛ - рдЬрд░реВрд░рдд рд╕реЗ рдЬреНрдпрд╛рджрд╛ред  рд╕реНрдХреЗрд▓реЗрдмрд┐рд▓рд┐рдЯреА рдХреЗ рд▓рд┐рдП, рдЬрдм рдПрдХ рдирдП рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдХреЛ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рддреЛ рдРрд╕реА рд╕рдВрд░рдЪрдирд╛ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛ рдмреЗрд╣рдж рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реЛрдЧрд╛ред <br><br>  рдХреБрдЫ рд╕реВрдЪреАрдмрджреНрдз рд╡рд╕реНрддреБрдУрдВ рдХреА рд╕реВрдЪреА, рд╕рд╛рде рд╣реА рд╕рд╛рде рдЗрд╕реНрддреЗрдорд╛рд▓ рдХреА рдЧрдИ рдПрдирдо рдХрдХреНрд╖рд╛рдПрдВред <br><br><h6>  AuthUser.java: </h6><br><pre><code class="java hljs">@ Entity @ Table(name = <span class="hljs-string"><span class="hljs-string">"auth_user"</span></span>) @ Inheritance(strategy = InheritanceType.JOINED) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthUser</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serializable</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserDetails</span></span></span><span class="hljs-class"> </span></span>{ @ Id @ Column(name = <span class="hljs-string"><span class="hljs-string">"id"</span></span>) @ GeneratedValue(strategy = GenerationType.AUTO) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Long id; @ Column(name = <span class="hljs-string"><span class="hljs-string">"identification_name"</span></span>, length = <span class="hljs-number"><span class="hljs-number">64</span></span>, nullable = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String identificationName; @ Enumerated(EnumType.STRING) @ Column(name = <span class="hljs-string"><span class="hljs-string">"type"</span></span>, nullable = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AuthorityType type; @ Column(name = <span class="hljs-string"><span class="hljs-string">"binary_authorities"</span></span>, nullable = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Long binaryAuthorities; @ Column(name = <span class="hljs-string"><span class="hljs-string">"enabled"</span></span>, nullable = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, columnDefinition = <span class="hljs-string"><span class="hljs-string">"tinyint"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Boolean enabled; @ Transient <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Set&lt;Authority&gt; authorities; @ OneToOne(fetch = FetchType.LAZY, orphanRemoval = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) @ Cascade({CascadeType.ALL}) @ JoinColumn(name=<span class="hljs-string"><span class="hljs-string">"user_id"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> User user; @ Override <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Collection&lt;? extends GrantedAuthority&gt; getAuthorities() { authorities = EnumSet.noneOf(Authority.class); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Authority authority : Authority.values()) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((binaryAuthorities &amp; (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; authority.ordinal())) != <span class="hljs-number"><span class="hljs-number">0</span></span>) authorities.add(authority); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> authorities; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setAuthority</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Set&lt;Authority&gt; authorities)</span></span></span><span class="hljs-function"> </span></span>{ binaryAuthorities = <span class="hljs-number"><span class="hljs-number">0L</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Authority authority : authorities) binaryAuthorities |= <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; authority.ordinal(); } @ <span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPassword</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> type.name(); } @ <span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUsername</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> identificationName; } @ <span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isAccountNonExpired</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } @ <span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isAccountNonLocked</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } @ <span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isCredentialsNonExpired</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-comment"><span class="hljs-comment">//getters/setters }</span></span></code> </pre> <br><h6>  AuthorityType.java: </h6><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> AuthorityType implements Serializable { SIMPLE, FACEBOOK, TWITTER, GOOGLE, LINKEDIN; }</code> </pre> <br><h6>  Authority.java: </h6><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Authority implements GrantedAuthority { NEW_CUSTOMER, CUSTOMER, ADMINISTRATOR; @ <span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAuthority</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> toString(); } }</code> </pre> <br><h6>  FacebookAuthUser.java: </h6><br><pre> <code class="java hljs">@ Entity @ Table(name = <span class="hljs-string"><span class="hljs-string">"facebook_auth_user"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FacebookAuthUser</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthUser</span></span></span><span class="hljs-class"> </span></span>{ @ Column(name = <span class="hljs-string"><span class="hljs-string">"first_name"</span></span>, length = <span class="hljs-number"><span class="hljs-number">32</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String firstName; @ Column(name = <span class="hljs-string"><span class="hljs-string">"last_name"</span></span>, length = <span class="hljs-number"><span class="hljs-number">32</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String lastName; @ Column(name = <span class="hljs-string"><span class="hljs-string">"email"</span></span>, length = <span class="hljs-number"><span class="hljs-number">64</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String email; @ Column(name = <span class="hljs-string"><span class="hljs-string">"token"</span></span>, length = <span class="hljs-number"><span class="hljs-number">128</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String token; <span class="hljs-comment"><span class="hljs-comment">//any number of available properties //getters/setters }</span></span></code> </pre> <br><h6>  TwitterAuthUser.java: </h6><br><pre> <code class="java hljs">@ Entity @ Table(name = <span class="hljs-string"><span class="hljs-string">"twitter_auth_user"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TwitterAuthUser</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthUser</span></span></span><span class="hljs-class"> </span></span>{ @ Column(name = <span class="hljs-string"><span class="hljs-string">"screen_name"</span></span>, length = <span class="hljs-number"><span class="hljs-number">64</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String screenName; @ Column(name = <span class="hljs-string"><span class="hljs-string">"oauth_token"</span></span>, length = <span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String oauthToken; @ Column(name = <span class="hljs-string"><span class="hljs-string">"oauth_token_secret"</span></span>, length = <span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String oauthTokenSecret; <span class="hljs-comment"><span class="hljs-comment">//any number of available properties //getters/setters }</span></span></code> </pre> <br><h6>  SimpleAuthUser.java: </h6><br><pre> <code class="java hljs">@ Entity @ Table(name = <span class="hljs-string"><span class="hljs-string">"simple_auth_user"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SimpleAuthUser</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthUser</span></span></span><span class="hljs-class"> </span></span>{ @ Column(name = <span class="hljs-string"><span class="hljs-string">"password"</span></span>, length = <span class="hljs-number"><span class="hljs-number">40</span></span>, nullable = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String password; @ Column(name = <span class="hljs-string"><span class="hljs-string">"uuid"</span></span>, length = <span class="hljs-number"><span class="hljs-number">36</span></span>, nullable = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String uuid; @ <span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPassword</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> password; } <span class="hljs-comment"><span class="hljs-comment">//getters/setters }</span></span></code> </pre> <br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ "рд░рд╕рд╛рдпрди рд╡рд┐рдЬреНрдЮрд╛рди" рдХреЗ рдмрд┐рдирд╛ рдирд╣реАрдВ рдерд╛: <br><ul><li>  рдореИрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рднреВрдорд┐рдХрд╛рдУрдВ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рд╕рдВрд░рдЪрдирд╛ (рддрд╛рд▓рд┐рдХрд╛) рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛, рдФрд░ рдЦреБрдж рдХреЛ рднреВрдорд┐рдХрд╛рдУрдВ рдХреЗ рд╕реЗрдЯ рдХреЛ рдмрджрд▓рдХрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдХрдИ рднреВрдорд┐рдХрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдмрдВрдж рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╕реЗ рд╡рдВрдЪрд┐рдд рдХрд░рдирд╛ рдореВрд░реНрдЦрддрд╛рдкреВрд░реНрдг рд╣реИред  рдЗрд╕рд▓рд┐рдП, рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдореИрдВ рднреВрдорд┐рдХрд╛рдУрдВ рдХреЗ рд╕реЗрдЯ рдХреЗ рдмрд╛рдЗрдирд░реА рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реВрдВ, рдФрд░ рд╕реНрдкреНрд░рд┐рдВрдЧ рд╕реБрд░рдХреНрд╖рд╛ рд╕реЗрдЯ рдХреЛ рдЦрд┐рд▓рд╛рддреА рд╣реИред  рдЖрдзрд╛рд░ рд╕реЗ рдкрдврд╝рддреЗ рд╕рдордп рдпрд╛рдж рд░рдЦрдиреЗ рд╡рд╛рд▓реА рдореБрдЦреНрдп рдмрд╛рдд рдПрдХ рдкрд░рд┐рд╡рд░реНрддрди рдХрд░рдирд╛ рд╣реИред  Ideologically, рдЕрдиреБрд╡рд╛рдж рддрдВрддреНрд░ POJO рдореЗрдВ рд░рдЦрдирд╛ рдЧрд▓рдд рд╣реИ, рдЖрдкрдХреЛ рдЗрд╕реЗ рдирд┐рдпрдВрддреНрд░рдХ рдпрд╛ DAO рдореЗрдВ рдЫреЛрдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдо рдЗрд╕реЗ рдкреНрд░рдХрд╛рд╢рди рд▓рд╛рдЧрдд рдорд╛рдиреЗрдВрдЧреЗред </li><li>  рдлрд╝реАрд▓реНрдб рдкреНрд░рдХрд╛рд░ (рдПрдирдо рдЕрдереЙрд░рд┐рдЯреА рдЯрд╛рдЗрдк) - рдпрд╣ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдбреЗрдЯрд╛ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рд╕рд╣рди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рдЗрд╕рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдПрдХ рд╡рд░реНрдЧ рдХреА рд╕рджрд╕реНрдпрддрд╛ рдХреА рдЦреЛрдЬ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ <em>user.getType ()</em> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реИ - <em>рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдВрд╕реНрдЯреЗрдВрдЯрдСрдлрд╝ TwitterAuthUser</em> , рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рдкреВрд░реА рддрд░рд╣ рд╕реЗ <em>рдЕрдкреНрд░рдХрд╛рд╢рд┐рдд</em> рд╣реИред </li><li>  UserDetails рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рддрд░реАрдХреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, <em>IdentName</em> (рдФрд░ <em>getUsername ()</em> ) рд╡рд╣ рдХреНрд╖реЗрддреНрд░ рд╣реИ рдЬрд╣рд╛рдВ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВ: рдлреЗрд╕рдмреБрдХ рдХреЗ рд▓рд┐рдП рдпрд╣ <em>FacebookID рд╣реИ</em> , рдЯреНрд╡рд┐рдЯрд░ рдХреЗ рд▓рд┐рдП рдпрд╣ <em>TwitterID рд╣реИ</em> , рдорд╛рдирдХ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рд▓рд┐рдП рдпрд╣ рдЙрдкрдирд╛рдо рдпрд╛ рдИрдореЗрд▓ рд╣реИред  рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ <em>getPassword ()</em> рд╡рд┐рдзрд┐ рдПрдХ рд╣реА рдкреНрд░рдХрд╛рд░ рд▓реМрдЯрд╛рддреА рд╣реИ, рдлрд┐рд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реНрдкреНрд░рд┐рдВрдЧ рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рджреНрд╡рд╛рд░рд╛ <em>рдпрд╛рдж рд░рдЦрдиреЗ рд╡рд╛рд▓реЗ</em> рддрдВрддреНрд░ рдореЗрдВ рдХреБрдХреАрдЬрд╝ рдХреЗ рд▓рд┐рдП рд╣реИрд╢ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдкреНрд░рддреНрдпреЗрдХ рдХрдХреНрд╖рд╛ рдореЗрдВ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реБрд░рдХреНрд╖рд╛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рдбреЗрдЯрд╛ рдмрддрд╛рдХрд░ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВрдиреЗ <em>SimpleAuthUser</em> рд╡рд░реНрдЧ рдореЗрдВ рдХрд┐рдпрд╛ рдерд╛ред  рджреВрд╕рд░реЛрдВ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдЯреЛрдХрди рдпрд╛ рдЧреБрдкреНрдд рдЯреЛрдХрди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  рддрд░реАрдХреЛрдВ рдХреЗ рд╕рд╛рде рдЖрдЧреЗ рдХреНрдпрд╛ рдХрд░рдирд╛ рд╣реИ рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЧреБрдг <em>isAccountNonExpired</em> , <em>isAccountNonLocked</em> , <em>isCredentialsNonExpired рд╣реИ</em> - рдЗрд╕ рддрд░рд╣ рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рдЖрд╡рд╢реНрдпрдХрддрд╛рдиреБрд╕рд╛рд░ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓реЗрдВ, рдЗрд╕ рд╕рдореАрдХреНрд╖рд╛ рдореЗрдВ рдореИрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддрд╛, <em>рд╕рд╣реА рд╡рд╛рдкрд╕</em> рдбреВрдмрдирд╛ред <br></li></ul><br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдЖрд░реЗрдЦ рдФрд░ рдХреЛрдб рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдореИрдВрдиреЗ рд╡рд┐рднрд┐рдиреНрди рдкрд░рддреЛрдВ рдХреА рд╡рд╕реНрддреБрдУрдВ рдХреЗ рдмреАрдЪ рдПрдХ <em>рдЖрд▓рд╕реА</em> рд╕рдВрдмрдВрдз рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛, рднрд▓реЗ рд╣реА рд╡реЗ рдПрдХ-рд╕реЗ-рдПрдХ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрдВред  рджреЛ рд▓рдХреНрд╖реНрдп рд╣реИрдВ: 1) рд▓реЗрдЦрдХ рдЕрдХреНрд╕рд░ рдирд┐рдпрдВрддреНрд░рдХ рдФрд░ рджреГрд╢реНрдп рдореЗрдВ рд░реВрдкрд░реЗрдЦрд╛ рдХреЛ рдЭрдЯрдХреЗ рджреЗрддрд╛ рд╣реИ, рдФрд░ рдЗрд╕рдХреЗ рдкреАрдЫреЗ рдирд┐рд░реНрднрд░ рд╕рдВрд░рдЪрдирд╛ рдХреЛ рд╣рд░ рдЬрдЧрд╣ рдЦреАрдВрдЪрдиреЗ рдХреА рдмрд╣реБрдд рдЗрдЪреНрдЫрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рдЦрд╛рд╕рдХрд░ рдЬрдм рд╕реЗ рдпрд╣ рдмрд╣реБрдд рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдФрд░ рдмрдбрд╝реЗ рдкреИрдорд╛рдиреЗ рдкрд░ рд╣реЛ рд╕рдХрддреА рд╣реИ (рдЬреЛрдмрд╕реЗрдХрд░ рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдореЗрд░реА рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рдИрдПрдЬреАрдЖрд░ рдЯреБрдХрдбрд╝реЛрдВ рдХреА рдирд┐рд░реНрднрд░рддрд╛ 5- 6, LAZY рдХреА рдЧрд┐рдирддреА рдирд╣реАрдВ - рдпреЗ рджреЛрдиреЛрдВ рдЯреЗрд▓реАрдлреЛрди, рдФрд░ рдкрддреЗ, рдФрд░ рд╡реНрдпрд╡рд╕рд╛рдпреЛрдВ, рдФрд░ рдЕрдиреНрдп) рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП, рдореЗрд░реА рд░рд╛рдп рдореЗрдВ, рдкреБрдирд░реНрдмреАрдорд╛ рдХреЛ рдЪреЛрдЯ рдирд╣реАрдВ рдкрд╣реБрдВрдЪрддреА рд╣реИред  2) рд╣рдореЗрдВ рдпрд╣ рдирд╣реАрдВ рднреВрд▓рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдпреЗ рдкрд░рддреЗрдВ рддрд░реНрдХ рдХреА рд╡рд┐рднрд┐рдиреНрди рдкрд░рддреЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВ: AuthUser рд╕реНрдкреНрд░рд┐рдВрдЧ рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдлреНрд░реЗрдорд╡рд░реНрдХ рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝ рд░рд╣рд╛ рд╣реИ, рдФрд░ рд╕рд╛рде рд╣реА, DataUser рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдореИрдВ рд▓рдЧрд╛рддрд╛рд░ рдирд┐рдЧрд░рд╛рдиреА рдФрд░ рдЕрджреНрдпрддрди рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ред  рдореИрдВ рдорд╛рдирддрд╛ рд╣реВрдВ рдХрд┐ рдпрд╣ рдирд┐рд░реНрдгрдп рд╡рд┐рд╡рд╛рджрд╛рд╕реНрдкрдж рд╣реИ, рдФрд░ рдЕрдВрддрд┐рдо рд╣реЛрдиреЗ рдХрд╛ рдирд╛рдЯрдХ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред  рд╢рд╛рдпрдж рдЖрдкрдХреЛ рджреВрд╕рд░реЗ рддрд░реАрдХреЗ рд╕реЗ рдЬреБрдбрд╝рдиреЗ рдХреА рдЬрд╝рд░реВрд░рдд рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдФрд░ рдЖрдк рд╣рдореЗрд╢рд╛ рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рддрд░реНрдХ рд╕реЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдмреАрди рдЦреАрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВред  рдпрд╣ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЗ рд╡рд┐рд╡реЗрдХ рдкрд░ рдмрдирд╛ рд╣реБрдЖ рд╣реИред <br><br>  DataUser рд╡рд░реНрдЧ рдФрд░ рдЖрд╢реНрд░рд┐рддреЛрдВ рдХреЗ рд▓рд┐рдП, рдпреЗ рд╕рд░рд▓ POJO рд╡рд░реНрдЧ рд╣реИрдВ, рд╕реАрдзреЗ DataUser рдореЗрдВ рд╕рднреА рдХреЗ рд▓рд┐рдП рдЧреБрдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВ (рдЬреИрд╕реЗ, рдЖрдИрдбреА, рдлрд░реНрд╕реНрдЯрдирд╛рдо, рд▓рд╛рд╕реНрдЯрдиреЗрдо, рдИрдореЗрд▓, рд▓реЛрдХреЗрд╢рди), рдФрд░ рд╢реЗрд╖ рдЗрд╕реЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реЗ рдЬреЛрдбрд╝рдХрд░ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ (рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рдЕрд╡реНрдпрд╡рд╣рд╛рд░рд┐рдХ рд╣реИ) ред <br><br><h4>  2. рдирд┐рдпрдВрддреНрд░рдХред </h4><br>  рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, <em>рдкреНрд░рдорд╛рдгреАрдХрд░рдг</em> рдФрд░ <em>рдкреНрд░рд╛рдзрд┐рдХрд░рдг</em> рдХреА рд╢рдмреНрджрд╛рд╡рд▓реА рдореЗрдВ рдмрд╣реБрдд рдЕрдВрддрд░ рдирд╣реАрдВ рд╣реИ - рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкреНрд░рд╛рдзрд┐рдХрд░рдг рд╣реИ, рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЕрд▓рдЧ-рдЕрд▓рдЧ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рджрд╛рддрд╛ рдЗрди рд╢рд░реНрддреЛрдВ рдХреЛ рдЕрдкрдиреЗ рддрд░реАрдХреЗ рд╕реЗ рд░реЗрдЦрд╛рдВрдХрд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдореЗрд░реА рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ рдореИрдВ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ 2 рдЕрд╡рдзрд╛рд░рдгрд╛рдУрдВ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХрд░рддрд╛ рд╣реВрдВ - рдкрдВрдЬреАрдХрд░рдг рдФрд░ рдкреНрд░рддреНрдпрдХреНрд╖ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдпрд╛ рд▓реЙрдЧрд┐рди (рджреЛрдиреЛрдВ рдПрдХ рд╕рд╛рдорд╛рдЬрд┐рдХ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рд╕реЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИрдВ)ред  рдХрд╣рддреЗ рд╣реИрдВ, рдЬрдм рдПрдХ рдордВрдЪ рдореЗрдВ рднрд╛рдЧ рд▓реЗрддреЗ рд╣реИрдВ, рдпрд╛ рдПрдХ рдЯрд┐рдкреНрдкрдгреА рд╕рдмрдорд┐рдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдмрд╕ рд▓реЙрдЧ рдЗрди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ - рдЪрд╛рд╣реЗ рд╡рд╣ рдкрд╣рд▓реА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдореЗрдВ рд╣реЛ, рдпрд╛ рд╕реМрд╡реЗрдВ рдореЗрдВ рд╣реЛред  рдореИрдВ рдкрдВрдЬреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдЖрд╡реЗрджрди рдХрд░рддреЗ рд╕рдордп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдореЙрдбрд▓ рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рджреНрд╡рд╛рд░рд╛ рдкрдВрдЬреАрдХрд░рдг рдФрд░ рд╕рд░рд▓ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рдЕрд▓рдЧрд╛рд╡ рдХрд╛ рдкреАрдЫрд╛ рдХрд░рддрд╛ рд╣реВрдВред  рдФрд░ рдпрджреНрдпрдкрд┐ рдпрд╣ рдЖрд╕рд╛рди рддрд░реАрдХреЗ рд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ - рдкреНрд░рд╡реЗрд╢ рджреНрд╡рд╛рд░ рдкрд░ рд╣рдо рдЬрд╛рдВрдЪрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдРрд╕рд╛ рд╡реНрдпрдХреНрддрд┐ рд╣реИ рдпрд╛ рдирд╣реАрдВ - рдФрд░ рдкрд╣рд▓реЗ рд▓реЙрдЧрд┐рди рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрд░рдЪрдирд╛ рдмрдирд╛рдПрдВред  рд▓реЗрдХрд┐рди рдПрдХ) рдПрдХ рдорд╛рдирдХ рдкрдВрдЬреАрдХрд░рдг рд╣реИ рдФрд░ рдПрдХ рджреГрд╢реНрдп рдкреГрдердХреНрдХрд░рдг рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рддрд╛рд░реНрдХрд┐рдХ рд╣реИ "рдпрд╣рд╛рдВ рдПрдХ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣рд╛рдВ рджреВрд╕рд░рд╛ рд╣реИ" (рдХреБрдЦреНрдпрд╛рдд <em>рдкреНрд░рдпреЛрдЬреНрдп</em> );  рдЦ) рдХреЛрдИ рдмрд╛рдд рдирд╣реАрдВ рдХрд┐рддрдиреА рдЕрдкрдорд╛рдирдЬрдирдХ рд╣реИ, рд▓реЗрдХрд┐рди рд╕реЛрд╢рд▓ рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рдПрдкреАрдЖрдИ рдЕрдкрдиреЗ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдореЗрдВ рдПрдХрдордд рдирд╣реАрдВ рд╣реИрдВ - рдХрд╣рддреЗ рд╣реИрдВ, <em>рдлреЗрд╕рдмреБрдХ рдПрдкреАрдЖрдИ</em> рдПрдХ рдИрдореЗрд▓, рдкрд╣рд▓рд╛ рдирд╛рдо, рдЕрдВрддрд┐рдо рдирд╛рдо, рд▓рд┐рдВрдЧ, рд╕реНрдерд╛рди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ;  <em>Twitter API</em> - screen_name рджреЗрддрд╛ рд╣реИ, рдЬреЛ "рдкрд╣рд▓реЗ рдирд╛рдо рдЕрдВрддрд┐рдо рдирд╛рдо" рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдИрдореЗрд▓ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ (рдЙрдирдХреЗ рдкрд╛рд╕ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдФрд░ рдЖрднрд╛рд╕реА рдХреЗ рдмреАрдЪ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЕрдВрддрд░ рдХрд░рдиреЗ рдХреА рд╕реНрдерд┐рддрд┐ рд╣реИ);  <em>Google+ API</em> рдкрд╣рд▓реЗ рдирд╛рдо, рдЕрдВрддрд┐рдо рдирд╛рдо, рдИрдореЗрд▓ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╕реНрдерд╛рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рднреА рдирд╣реАрдВ;  <em>рд▓рд┐рдВрдХреНрдбрдЗрди рдПрдкреАрдЖрдИ</em> - рдирд╛рдо, рдЙрдкрдирд╛рдо, рд▓рд┐рдВрдЧ, рд╕реНрдерд╛рди, рд▓реЗрдХрд┐рди рдИрдореЗрд▓ рдирд╣реАрдВ рднреЗрдЬрддрд╛ рд╣реИред  рдЪреВрдВрдХрд┐ рдореЗрд░рд╛ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдЖрдЧрдВрддреБрдХ рдХреЗ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдбреЗрдЯрд╛ (рдПрдХ рднрд░реНрддреА рдХрдВрдкрдиреА рдХреЗ рд▓рд┐рдП рдПрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛) рдХреЗ рд╕рд╛рде рдмрд╣реБрдд рдирд┐рдХрдЯрддрд╛ рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рд╣реИ, рдкрдВрдЬреАрдХрд░рдг рдХреЗ рд╕рд╛рде-рд╕рд╛рде, рдореБрдЭреЗ рдХреБрдЫ рдлрд╝реАрд▓реНрдб рднрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХрд╛ рд╕рдВрдХреЗрдд рдорд┐рд▓рддрд╛ рд╣реИ (рд╢реБрд░реБрдЖрдд рдореЗрдВ, рдлреЗрд╕рдмреБрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕рднреА рдХреЛ рдХрдо рд╕реЗ рдХрдо рдХреБрдЫ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдирд╛ рдерд╛, рдЕрдм рдпрд╣ рд╕рд░рд▓ рд╣реИ рдФрд░ рдХреЗрд╡рд▓ рдЗрд╕ рддрд░рд╣ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдореМрдЬреВрдж рд╣реИ) рдЯреНрд╡рд┐рдЯрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдореИрдВ рдПрдХ рдкреВрд░реНрдг рдЗрдирдХрд╛рд░ рдХреЛ рдмрд╛рд╣рд░ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реВрдВ, рдФрд░ рдЬрдм рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рддреЛ рдЦреЗрддреЛрдВ рдореЗрдВ рднрд░рдирд╛ - рдХрд╣рддреЗ рд╣реИрдВ, "рдЬрд╝реЛрди" рдкрд░ рдЬрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╕рдордп, рдЬрд╣рд╛рдВ рдРрд╕реА рдЬрд╛рдирдХрд╛рд░реА рдмрд╕ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдЧреА)ред  рдЗрд╕рд▓рд┐рдП, рдореЗрд░рд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреБрдЫ рд╣рдж рддрдХ рдлреБрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рдХреЗрд╡рд▓ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рддрдВрддреНрд░ рдХреЛ рдЕрдзрд┐рдХ рд╕рдордЭрдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред <br><br>  рдореИрдВ рдЖрдкрдХреЛ рдпрд╛рдж рджрд┐рд▓рд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ рдХрд┐ рдХрд╛рдо (рдпрд╛ рдкрд░реАрдХреНрд╖рдг) рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдкреНрд░рддреНрдпреЗрдХ рд╕рд╛рдорд╛рдЬрд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдмрдирд╛рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ, рдФрд░ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХреА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред  Facebook рдХреЗ рд▓рд┐рдП, рдпрд╣ <a href="https://developers.facebook.com/apps">Developers.facebook.com/apps</a> , Twitter рдХреЗ рд▓рд┐рдП - <a href="https://dev.twitter.com/apps">dev.twitter.com/apps</a> , Google+ рдХреЗ рд▓рд┐рдП - <a href="https://code.google.com/apis/console">code.google.com/apis/console</a> , рд▓рд┐рдВрдХреНрдбрдЗрди рдХреЗ рд▓рд┐рдП - <a href="https://www.linkedin.com/secure/developer">www.linkedin.com/secure/developer рд╣реИ</a> ред  рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдмрдирд╛рддреЗ рд╕рдордп, 3 рдкреИрд░рд╛рдореАрдЯрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдВ рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рджрд╛рддрд╛ рдХреЗ рдкрд╛рд╕ рд╣реИ: рдПрдХ рдХреБрдВрдЬреА (рдпрд╛ рдПрдкреАрдЖрдИ рдХреБрдВрдЬреА, рдЙрдкрднреЛрдХреНрддрд╛ рдХреБрдВрдЬреА, рдХреНрд▓рд╛рдЗрдВрдЯ рдЖрдИрдбреА), рдПрдХ рдЧреБрдкреНрдд рдХреБрдВрдЬреА (рдРрдк рдЧреБрдкреНрдд, рдЙрдкрднреЛрдХреНрддрд╛ рд░рд╣рд╕реНрдп, рдЧреНрд░рд╛рд╣рдХ рд░рд╣рд╕реНрдп, рдЧреБрдкреНрдд рдХреБрдВрдЬреА) рдФрд░ рдПрдХ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдкрддрд╛ (рд╡реЗ рдХрд╣рддреЗ рд╣реИрдВ, рд╣рд╛рд▓ рд╣реА рдореЗрдВ рддрдХ рдкреНрд░рджрд╛рддрд╛рдУрдВ рдореЗрдВ рд╕реЗ рдХреБрдЫ рдХреЛ рд▓реЛрдХрд▓рд╣реЛрд╕реНрдЯ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдЬ рдпрд╣ рд╕рддреНрдпрд╛рдкрд┐рдд рд╣реИ рдХрд┐ рд╣рд░ рдХреЛрдИ <a href="http://localhost/">http: // localhost: 8080 / myproject</a> ) рдЬреИрд╕реЗ рдкрддреЗ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред  рдЖрдк рд╡рд╣рд╛рдВ рдЕрдиреНрдп рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рднреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд▓реЛрдЧреЛ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рд▓рд┐рдВрдХреНрдбрдЗрди рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рдЫрд╡рд┐ рдХрд╛ рд▓рд┐рдВрдХ рдПрд╕рдПрд╕рдПрд▓ (рдЕрддреБрд▓рдиреАрдп рдЗрдЪреНрдЫрд╛) рд╣реЛред <br><br>  рдлреЗрд╕рдмреБрдХ рдФрд░ Google+ рд▓рдВрдмреЗ рд╕рдордп рд╕реЗ рдирдП <em>OAuth 2</em> рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, Twitter рдФрд░ рд▓рд┐рдВрдХреНрдбрдЗрди рдЕрднреА рднреА рдкреБрд░рд╛рдиреЗ <em>OAuth</em> рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ (Google+ рдиреЗ 20 рдЕрдкреНрд░реИрд▓ 2012 рддрдХ OAuth рдХреЗ рдкрд╣рд▓реЗ рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рд╕рдорд░реНрдерди рдХрд┐рдпрд╛)ред  рдореЗрд░реЗ рд╡рд┐рд╡реЗрдХ рдкрд░ (рд╣рд╛рд▓рд╛рдВрдХрд┐ рдореИрдВ рд╕реЛрдЪ рдирд╣реАрдВ рд╕рдХрддрд╛ рдХрд┐ рдПрдХ рдЕрд▓рдЧ рд░рд╛рдп рдереА), OAuth 2 рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛ рдЕрддреБрд▓рдиреАрдп рд░реВрдк рд╕реЗ рд╕рд░рд▓ рдФрд░ рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕ рддрдереНрдп рдХреЗ рдмрд╛рд╡рдЬреВрдж рдХрд┐ рдпрд╣ рдХрд╛рдлреА рд▓реЛрдХрдкреНрд░рд┐рдп рд╣реИ, рдпрд╣ рдЕрднреА рднреА рдорд╛рдирдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЕрдиреБрдореЛрджрд┐рдд рдирд╣реАрдВ рд╣реИред  рдСрдкрд░реЗрд╢рди рдХрд╛ рд╕рд┐рджреНрдзрд╛рдВрдд рдХрд╛рдлреА рдЖрджрд┐рдо рд╣реИ (рд╕рдмрд╕реЗ рд▓реЛрдХрдкреНрд░рд┐рдп рдпреЛрдЬрдирд╛): <br><img src="http://img535.imageshack.us/img535/2254/pic2k.png" alt="рдЫрд╡рд┐"><br>  рдЗрд╕рд▓рд┐рдП, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╡реЗрдм рдкреЗрдЬ рдкрд░ рдкрдВрдЬреАрдХрд░рдг рдмрдЯрди рдореЗрдВ рд╕реЗ рдПрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рддрд╛ рд╣реИ: <br><img src="http://img41.imageshack.us/img41/321/pic3yd.png" alt="рдЫрд╡рд┐"><br>  (рдФрд░ рдореИрдВ рдкреГрд╖реНрда рдкрд░ рдХрд┐рд╕реА рднреА "рдЕрддрд┐рд░рд┐рдХреНрдд" рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рдирд╣реАрдВ рдЫреЛрдбрд╝рддрд╛, рдХреЗрд╡рд▓ рдПрдХ рдкрддреЗ рдЬреИрд╕реЗ <a href="http://www.myproject.com/registration/facebook">www.myproject.com/registration/facebook</a> , рдЖрджрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рдмрдЯрди), рдЕрдиреБрд░реЛрдз рдирд┐рдпрдВрддреНрд░рдХ (рдлреЗрд╕рдмреБрдХ рдХреЗ рд▓рд┐рдП) рдкрд░ рдЬрд╛рддрд╛ рд╣реИ: <br><pre> <code class="java hljs">@ RequestMapping(value = <span class="hljs-string"><span class="hljs-string">"/registrate/facebook"</span></span>, method = RequestMethod.POST) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ModelAndView </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">facebookRegistration</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ModelAndView(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RedirectView(FACEBOOK_URL + <span class="hljs-string"><span class="hljs-string">"?client_id="</span></span> + FACEBOOK_API_KEY + + <span class="hljs-string"><span class="hljs-string">"&amp;redirect_uri="</span></span> + FACEBOOK_URL_CALLBACK_REGISTRATION + + <span class="hljs-string"><span class="hljs-string">"&amp;scope=email,user_location&amp;state=registration"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)); }</code> </pre> <br>  рд╕реНрдХреЛрдк рдХреЗ рд▓рд┐рдП рдкреИрд░рд╛рдореАрдЯрд░ <a href="http://developers.facebook.com/docs/authentication/permissions">рдбреЗрд╡рд▓рдкрд░.</a> <a href="https://dev.twitter.com/docs/platform-objects/users">facebook.com/docs/authentication/permissions</a> (рдЯреНрд╡рд┐рдЯрд░ рдХреЗ рд▓рд┐рдП - <a href="https://dev.twitter.com/docs/platform-objects/users">dev.twitter.com/docs/platform-objects/users</a> , Google+) - <a href="https://developers.google.com/accounts/docs/OAuth2Login">Developers.google.com/accounts/Oocs/OAuth2Login# рдкрд░</a> <a href="https://dev.twitter.com/docs/platform-objects/users">рджреЗрдЦреЗ</a> рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред <a href="https://developers.google.com/accounts/docs/OAuth2Login">userinfocall</a> , LinkedIn - <a href="https://developer.linkedin.com/documents/profile-fields">developer.linkedin.com/documents/profile-fields</a> ), рдореИрдВ рдЕрднреА рдпрд╣рд╛рдВ рдПрдХ рдпреБрдЧрд▓ рд▓рд╛рдпрд╛ рд╣реВрдВред  рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ_рдпреВрд░реА рдбреЛрдореЗрди рдХреЛ рдЖрд╡реЗрджрди рдХреЗ рдкрдВрдЬреАрдХреГрдд рдкрддреЗ рд╕реЗ рдореЗрд▓ рдЦрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рд░рд╛рдЬреНрдп рдПрдХ "рдореБрдХреНрдд" рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИ, рдореИрдВ рдЗрд╕реЗ рдЖрдЧреЗ рдХреА рдХрд╛рд░реНрд░рд╡рд╛рдЗрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реЗрдорд╛рдлреЛрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реВрдВ - рдкрдВрдЬреАрдХрд░рдг, рд╕рд╛рдЗрдирдЗрди, рдСрдЯреЛрд╕рд┐рдЧреНрдирд┐рдиред <br><br>  рддрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рдлреЗрд╕рдмреБрдХ рд▓реЙрдЧрд┐рди рдкреЗрдЬ рдкрд░ "рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ" рдХрд░рддрд╛ рд╣реИ, рдЬрд╣рд╛рдВ рд╡рд╣ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛, рдФрд░ рдпрджрд┐ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдореВрд▓ рдЕрдиреБрдорддрд┐рдпреЛрдВ рд╕реЗ рдкрд░реЗ рд╣реИрдВ, рддреЛ рдЙрдиреНрд╣реЗрдВ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рд╡рд┐рдВрдбреЛ рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред <br><br>  рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рдмрд╛рдж, <em>FACEBOOK_IRL_CALLBACK_REGISTRATION</em> рдХреЛ рдореИрдк рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд╣рдорд╛рд░рд╛ рдХрдВрдЯреНрд░реЛрд▓рд░ рдХреЙрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ (рдХреНрд▓рд╛рдЗрдВрдЯ рджреНрд╡рд╛рд░рд╛ рдХрд┐рд╕реА рднреА рдирд┐рд░реНрдгрдп рдкрд░ - рд▓реЙрдЧ рдЗрди, рдХреИрдВрд╕рд┐рд▓, рд░рд┐рдЯрд░реНрди)ред  рд╕реНрдкреНрд░рд┐рдВрдЧ MVC рд╣рдореЗрдВ рдореИрдкрд┐рдВрдЧ рдХрд░рдХреЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдореЗрд░реА рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреА рдореИрдкрд┐рдВрдЧ рджреА рдЧрдИ рд╣реИ): <br><pre> <code class="java hljs">@ RequestMapping(value = <span class="hljs-string"><span class="hljs-string">"/callback/facebook"</span></span>, method = RequestMethod.GET) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FacebookController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ExternalController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Constants</span></span></span><span class="hljs-class"> </span></span>{ @ RequestMapping(value = <span class="hljs-string"><span class="hljs-string">"/registration"</span></span>, params = <span class="hljs-string"><span class="hljs-string">"code"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ModelAndView </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">registrationAccessCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@ RequestParam(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"code"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String code, HttpServletRequest request) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ String authRequest = Utils.sendHttpRequest(<span class="hljs-string"><span class="hljs-string">"GET"</span></span>, FACEBOOK_URL_ACCESS_TOKEN, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"client_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"redirect_uri"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_secret"</span></span>, <span class="hljs-string"><span class="hljs-string">"code"</span></span>}, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{FACEBOOK_API_KEY, FACEBOOK_URL_CALLBACK_REGISTRATION, FACEBOOK_API_SECRET, code}); String token = Utils.parseURLQuery(authRequest).get(<span class="hljs-string"><span class="hljs-string">"access_token"</span></span>); String tokenRequest = Utils.sendHttpRequest(<span class="hljs-string"><span class="hljs-string">"GET"</span></span>, FACEBOOK_URL_ME, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"access_token"</span></span>}, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{token}) Map&lt;String, Json&gt; userInfoResponse = Json.read(tokenRequest).asJsonMap(); String email = userInfoResponse.get(<span class="hljs-string"><span class="hljs-string">"email"</span></span>).asString().toLowerCase(); String id = userInfoResponse.get(<span class="hljs-string"><span class="hljs-string">"id"</span></span>).asString(); <span class="hljs-comment"><span class="hljs-comment">//verifying ... is new? is email in DB? //creating objects Customer customer = new Customer(); customer.setEmail(email); //... customerer = (Customerer) userDAO.put(customer); FacebookAuthUser user = new FacebookAuthUser(); user.setFirstName(firstName); //... user.setIdentificationName(id); user.setToken(token); user.setType(AuthenticationType.FACEBOOK); user.setEnabled(true); user.setAuthority(EnumSet.of(Authority.CUSTOMER)); user.setUser(customer); authenticationDAO.put(user); return new ModelAndView(new RedirectView("/registrate.complete", true, true, false)); } @ RequestMapping(value = "/registration", params = "error_reason") public ModelAndView registrationError(@ RequestParam("error_description") String errorDescription, HttpServletRequest request, HttpServletResponse response) { //return client to registration page with errorDescription return new ModelAndView(new RedirectView("/registrate", true, true, false)); } //will signin and signinError }</span></span></code> </pre> <br>  рд╕реБрд╡рд┐рдзрд╛ рдФрд░ рдПрдХрд╛рддреНрдордХ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП, рдЗрд╕ рд╕реВрдЪреА рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдпреВрдЯрд┐рд▓реНрд╕ рд╡рд░реНрдЧ рдХреЗ рдХреБрдЫ рд╕реНрдерд┐рд░ рддрд░реАрдХреЗ: <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendHttpRequest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String methodName, String url, String[] names, String[] values)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> HttpException, IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (names.length != values.length) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!methodName.equalsIgnoreCase(<span class="hljs-string"><span class="hljs-string">"GET"</span></span>) &amp;&amp; !methodName.equalsIgnoreCase(<span class="hljs-string"><span class="hljs-string">"POST"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; HttpMethod method; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (methodName.equalsIgnoreCase(<span class="hljs-string"><span class="hljs-string">"GET"</span></span>)) { String[] parameters = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[names.length]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; names.length; i++) parameters[i] = names[i] + <span class="hljs-string"><span class="hljs-string">"="</span></span> + values[i]; method = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GetMethod(url + <span class="hljs-string"><span class="hljs-string">"?"</span></span> + StringUtils.join(parameters, <span class="hljs-string"><span class="hljs-string">"&amp;"</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { method = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PostMethod(url); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; names.length; i++) ((PostMethod) method).addParameter(names[i], values[i]); method.setRequestHeader(<span class="hljs-string"><span class="hljs-string">"Content-Type"</span></span>, <span class="hljs-string"><span class="hljs-string">"application/x-www-form-urlencoded"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpClient().executeMethod(method); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getStringFromStream(method.getResponseBodyAsStream()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Map&lt;String, String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parseURLQuery</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String query)</span></span></span><span class="hljs-function"> </span></span>{ Map&lt;String, String&gt; result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;String,String&gt;(); String params[] = query.split(<span class="hljs-string"><span class="hljs-string">"&amp;"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (String param : params) { String temp[] = param.split(<span class="hljs-string"><span class="hljs-string">"="</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { result.put(temp[<span class="hljs-number"><span class="hljs-number">0</span></span>], URLDecoder.decode(temp[<span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (UnsupportedEncodingException exception) { exception.printStackTrace(); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br>  рд╕реНрдерд┐рд░рд╛рдВрдХ: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String FACEBOOK_API_KEY = <span class="hljs-string"><span class="hljs-string">"XXXXXXXXXXXXXXXX"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String FACEBOOK_API_SECRET = <span class="hljs-string"><span class="hljs-string">"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String FACEBOOK_URL = <span class="hljs-string"><span class="hljs-string">"https://www.facebook.com/dialog/oauth"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String FACEBOOK_URL_ACCESS_TOKEN = <span class="hljs-string"><span class="hljs-string">"https://graph.facebook.com/oauth/access_token"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String FACEBOOK_URL_ME = <span class="hljs-string"><span class="hljs-string">"https://graph.facebook.com/me"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String FACEBOOK_URL_CALLBACK_REGISTRATION = SITE_ADDRESS + <span class="hljs-string"><span class="hljs-string">"/callback/facebook/registration"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String FACEBOOK_URL_CALLBACK_SIGNIN = SITE_ADDRESS + <span class="hljs-string"><span class="hljs-string">"/callback/facebook/signin"</span></span>;</code> </pre> <br>  рд╣рд░ рдХреЛрдИ рдЕрдкрдиреЗ рд╡рд┐рд╡реЗрдХ рд╕реЗ <em>JSON</em> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдореИрдВрдиреЗ mjson рд▓рд╛рдЗрдмреНрд░реЗрд░реА ( <a href="http://sharegov.blogspot.com/2011/06/json-library.html">http://sharegov.blogspot.com/2011/06/json-library.html</a> ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рд╣реИ - рдЫреЛрдЯреЗ, рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдФрд░ рдмрд┐рдирд╛ рдХреНрд░рдорд╛рдВрдХрди рдХреЗред <br><br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рд░рд▓ рд╣реИ рдФрд░ рд╡рд┐рд╢реЗрд╖ рдкреНрд░рд╢реНрдиреЛрдВ рдХрд╛ рдХрд╛рд░рдг рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдореИрдВ рдпрд╣ рднреА рдзреНрдпрд╛рди рд░рдЦрдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ рдХрд┐ рдлреЗрд╕рдмреБрдХ рд╕реНрдерд╛рди рдкреИрд░рд╛рдореАрдЯрд░ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рди рдореВрд▓реНрдпреЛрдВ рд╕реЗ рдЖрдк <em>Google рдореИрдкреНрд╕ рдПрдкреАрдЖрдИ</em> ( <a href="http://maps.googleapis.com/maps/api/geocode/json">http://maps.googleapis.com/maps/api/geocode/json рдкрд░</a> ) "рдкрд░реНрдЪреА" рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдПрдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд░реВрдк рдореЗрдВ рдЬрд┐рдпреЛрд▓реЛрдХреЗрд╢рди рдХреЛ рдЦреАрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ (рдорд╛рдирдХреЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░) рдЧреВрдЧрд▓ рдореИрдкреНрд╕)ред  рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реИ рдХрд┐ рдпрд╣ рддрднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рдЧреНрд░рд╛рд╣рдХ рдиреЗ рдЕрдкрдиреЗ рдлреЗрд╕рдмреБрдХ рдЕрдХрд╛рдЙрдВрдЯ рдореЗрдВ рди рдХреЗрд╡рд▓ рджреЗрд╢ рдХрд╛ рд╕реНрдерд╛рди рджрд░реНрд╢рд╛рдпрд╛ рд╣реЛред <br><br>  Google+ рдХреЗ рд▓рд┐рдП рд╕рд╛рдЗрди рдЕрдк рдПрдХ рд╕рдорд╛рди рддрд░реАрдХреЗ рд╕реЗ рд╣реЛрддрд╛ рд╣реИ, рдПрдХрдорд╛рддреНрд░ рдЕрдВрддрд░ рдпрд╣ рд╣реИ рдХрд┐ рдЙрдирдХреЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ <em>рдХреЙрд▓рдмреИрдХ URL</em> рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдПрдХ рд╕реЗ рдореЗрд▓ рдЦрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╕рднреА рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХреЗрд╡рд▓ рдПрдХ рдорд╛рдирдЪрд┐рддреНрд░рдг рдкрд░ рдЧрд┐рд░реЗрдВрдЧреЗред  рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд▓реМрдЯреЗ <em>рд░рд╛рдЬреНрдп</em> рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ: <br><pre> <code class="java hljs">@ RequestMapping(value = <span class="hljs-string"><span class="hljs-string">"/callback/google"</span></span>, method = RequestMethod.GET) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GoogleController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ExternalController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Constants</span></span></span><span class="hljs-class"> </span></span>{ @ RequestMapping(value = {<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>}, params = <span class="hljs-string"><span class="hljs-string">"code"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ModelAndView </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">googleProxy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@ RequestParam(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"code"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String code, @ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"state"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String state, HttpServletRequest request, HttpServletResponse response) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ ... } @ RequestMapping(value = {<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>}, params = <span class="hljs-string"><span class="hljs-string">"error"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ModelAndView </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">googleErrorProxy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@RequestParam(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"error"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String error, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"state"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String state, HttpServletRequest request) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ ... } }</code> </pre> <br>  рдкрддреЗ рдФрд░ рд╡рд╛рдкрд╕реА рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рдЕрдкрд╡рд╛рдж рдХреЗ рд╕рд╛рде рд╢реЗрд╖ рдХреНрд░рд┐рдпрд╛рдПрдВ, рд╕рдорд╛рди рд╣реИрдВред <br><br>  <em>OAuth</em> рдкреНрд░рдорд╛рдгреАрдХрд░рдг (Twitter рдФрд░ LinkedIn) рдХреЗ рд╕рд╛рде рд╕реНрдерд┐рддрд┐ рдЕрд▓рдЧ рд╣реИред  рдореИрдВ рд╕рдВрдкреВрд░реНрдг рдкреНрд░рд╛рдзрд┐рдХрд░рдг рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдЯреЛрдХрди рдХреЗ рд╕рд╛рде рдЕрдиреБрд░реЛрдз рдХреЗ рдЧрдарди рдХреЗ рдХрд╛рд░рдг рдпрд╣ рдмрд╣реБрдд рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ - рдЙрдиреНрд╣реЗрдВ рдПрдХ рд╡рд┐рд╢реЗрд╖ рддрд░реАрдХреЗ рд╕реЗ "рд╕рд░реЗрд╕ рд╕реЗ рдЬреЛрдбрд╝рд╛ рд╣реБрдЖ" рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдмреЗрд╕ 64 рдкреИрдХ рдХрд░реЗрдВ, рд╕рдордп рдХреЗ рд╕рд╛рде рдкреИрд░рд╛рдореАрдЯрд░ рдФрд░ рдЕрдиреНрдп рдЬреЛрдбрд╝рддреЛрдбрд╝ рдЬреЛрдбрд╝реЗрдВред  рдФрд░ рдЬреЛ рд╕рдмрд╕реЗ рдЖрд╢реНрдЪрд░реНрдпрдЬрдирдХ рд╣реИ - рдЗрди рд╕рд╛рдорд╛рдЬрд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдЕрдиреБрднрд╛рдЧ рдЗрди рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред  рдпрджреНрдпрдкрд┐ рдпрд╣ рдПрдХ рдорд╛рдирдХ рд╣реИ, рдЗрд╕рд▓рд┐рдП, рдЧрдгрдирд╛ рдПрдХ рдорд╛рдирдХ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рд▓рд┐рдП рдЬрд╛рддреА рд╣реИред  рдХрд┐рд╕реА рднреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ, "рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ" рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреНрд░рд╛рдзрд┐рдХрд░рдг, рдЖрдкрдХреЗ рдЖрд╡реЗрджрди рдХреЛ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рджрд┐рд▓рдЪрд╕реНрдкреА рдирд╣реАрдВ рд╣реИред  рдореИрдВ рддреГрддреАрдп-рдкрдХреНрд╖ рдореБрдХреНрдд рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕рд▓рд╛рд╣ рджреЗрддрд╛ рд╣реВрдВ рдЬреЛ рдЗрд╕реЗ рдЖрд╕рд╛рди рдмрдирд╛рддреЗ рд╣реИрдВред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЯреНрд╡рд┐рдЯрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рд╣реИ - <em>twitter4j.jar</em> ред  рдореИрдВрдиреЗ <em>рдореБрдВрд╢реА-рдЬрд╛рд╡рд╛</em> рд▓рд╛рдЗрдмреНрд░реЗрд░реА ( <a href="http://github.com/fernandezpablo85/scribe-java">http://github.com/fernandezpablo85/scribe-java</a> ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛, рдЬреЛ <em>рдПрдордЖрдИрдЯреА рд▓рд╛рдЗрд╕реЗрдВрд╕</em> рдХреЗ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рддрд╣рдд рд╡рд┐рддрд░рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИред  рдкреИрдХреЗрдЬ рдореЗрдВ <em>Digg API</em> , <em>Facebook API</em> , <em>Flickr API</em> , <em>Freelancer API</em> , <em>Google API</em> , <em>LinkedIn API</em> , <em>Skyrock API</em> , <em>Tumblr API</em> , <em>Twitter API</em> , <em>Vkontakte API</em> , <em>Yahoo API</em> рдФрд░ рдПрдХ рджрд░реНрдЬрди 2 рдЕрдиреНрдп рд╢рд╛рдорд┐рд▓ рд╣реИрдВред <br><br>  <em>рдореБрдВрд╢реА</em> рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдЯреНрд╡рд┐рдЯрд░ рдХреЗ рд▓рд┐рдП рдкрдВрдЬреАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрд╛рдИ рджреЗрдЧреАред  рдкрдВрдЬреАрдХрд░рдг рдкреГрд╖реНрда рд╕реЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рд▓рд┐рдП рдЧреНрд░рд╛рд╣рдХ рдЕрдиреБрд░реЛрдз рдирд┐рдпрдВрддреНрд░рдХ: <br><pre> <code class="java hljs">@ RequestMapping(value = <span class="hljs-string"><span class="hljs-string">"/registrate/twitter"</span></span>, params = <span class="hljs-string"><span class="hljs-string">"action"</span></span>, method = RequestMethod.POST) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ModelAndView </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">twitterRegistrationJobseeker</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HttpServletRequest request)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ OAuthService service = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ServiceBuilder().provider(TwitterApi.class) .apiKey(TWITTER_CONSUMER_KEY).apiSecret(TWITTER_CONSUMER_SECRET) .callback(TWITTER_URL_CALLBACK_REGISTRATION).build(); Token requestToken = service.getRequestToken(); request.getSession().setAttribute(<span class="hljs-string"><span class="hljs-string">"twitter"</span></span>, service); request.getSession().setAttribute(<span class="hljs-string"><span class="hljs-string">"request_token"</span></span>, requestToken); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ModelAndView(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RedirectView(service.getAuthorizationUrl(requestToken), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)); }</code> </pre> <br>  рдЯреНрд╡рд┐рдЯрд░ рдХреЙрд▓рдмреИрдХ рдХрдВрдЯреНрд░реЛрд▓рд░: <br><pre> <code class="java hljs">@ RequestMapping(value = <span class="hljs-string"><span class="hljs-string">"/callback/twitter"</span></span>, method = RequestMethod.GET) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TwitterController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ExternalController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Constants</span></span></span><span class="hljs-class"> </span></span>{ @ RequestMapping(value = <span class="hljs-string"><span class="hljs-string">"/registration"</span></span>, params = <span class="hljs-string"><span class="hljs-string">"oauth_verifier"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ModelAndView </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">registrationAccessCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@ RequestParam(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"oauth_verifier"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String verifier, HttpServletRequest request, HttpServletResponse response) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ OAuthService service = (OAuthService) request.getSession().getAttribute(<span class="hljs-string"><span class="hljs-string">"twitter"</span></span>); Token accessToken = service.getAccessToken((Token) request.getSession().getAttribute(<span class="hljs-string"><span class="hljs-string">"request_token"</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Verifier(verifier)); OAuthRequest oauthRequest = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OAuthRequest(Verb.GET, TWITTER_URL_CREDENTIALS); service.signRequest(accessToken, oauthRequest); Map&lt;String, Json&gt; userInfoResponse = Json.read(oauthRequest.send().getBody()).asJsonMap(); String twitterId = userInfoResponse.get(<span class="hljs-string"><span class="hljs-string">"id"</span></span>).asString(); <span class="hljs-comment"><span class="hljs-comment">//verifying ... Customer customer = new Customer(); customer.setFirstName((String) request.getSession().getAttribute("pageValueFirstName")); //... customer = (Customer) userDAO.put(customer); TwitterAuthUser user = new TwitterAuthUser(); user.setAuthority(EnumSet.of(Authority.CUSTOMER)); user.setIdentificationName(twitterId); //... user.setOauthToken(accessToken.getToken()); user.setOauthTokenSecret(accessToken.getSecret()); user.setType(AuthenticationType.TWITTER); user.setUser(customer); authenticationDAO.put(user); return new ModelAndView(new RedirectView("/registrate.complete", true, true, false)); } @ RequestMapping(value = "/registration", params = "denied") public ModelAndView registrationError(HttpServletRequest request) { //response does not contain the error text return new ModelAndView(new RedirectView("/registrate", true, true, false)); } //will signin and signinError }</span></span></code> </pre> <br>  рдлрд┐рд░, рд╕рдм рдХреБрдЫ рдмрд╣реБрдд рд╕рд░рд▓ рдФрд░ рд╕рд╕реНрддреА рд╣реИред  рд▓рд┐рдВрдХреНрдбрдЗрди рдПрдкреАрдЖрдИ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрдВрдЬреАрдХрд░рдг рдмрд┐рд▓реНрдХреБрд▓ рдЙрд╕реА рддрд░рд╣ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдЕрдВрддрд┐рдо - рдПрдХ рдорд╛рдирдХ рддрд░реАрдХреЗ рд╕реЗ рдкрдВрдЬреАрдХрд░рдгред  рдорд╛рдирдХ - рдпрд╣реА рдХрд╛рд░рдг рд╣реИ рдХрд┐ рдпрд╣ рдорд╛рдирдХ рд╣реИ, рдореИрдВрдиреЗ рдХреЛрдб рдирд╣реАрдВ рджрд┐рдпрд╛ рд╣реИ, рдореИрдВ рд╕рд┐рд░реНрдл рдпрд╣ рд╕реНрдкрд╖реНрдЯ рдХрд░реВрдВрдЧрд╛ рдХрд┐ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рд╣рдо рдПрдХ рд╕рд░рд▓ рдкреНрд░рдХрд╛рд░ рдХреА рд╡рд╕реНрддреБ рдмрдирд╛рддреЗ рд╣реИрдВ, рдЬреЛ рдкреНрд░рдорд╛рдгрд┐рдХрддрд╛ рд╕реЗ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рдорд┐рд▓реА рд╣реИ <br><pre> <code class="java hljs"> SimpleAuthUser user = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleAuthUser(); user.setAuthority(EnumSet.of(Authority.NEW_CUSTOMER)); user.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); user.setIdentificationName(email); user.setPassword(passwordEncoder.encodePassword(password, email)); user.setType(AuthenticationType.SIMPLE); user.setUser(customer); user.setUuid(uuid); authenticationDAO.put(user);</code> </pre> <br>  рдЗрд╕ рдорд╛рдорд▓реЗ рдХреЗ рд▓рд┐рдП, рдкреНрд░рд╛рдзрд┐рдХрд░рдг <em>NEW_CUSTOMER рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереА</em> - рдПрдХ рдкрдВрдЬреАрдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкрдВрдЬреАрдХрд░рдг (рдорд╛рдирдХ рдЕрднреНрдпрд╛рд╕) рдХреА рдкреБрд╖реНрдЯрд┐ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ рдЗрд╕рд▓рд┐рдП) рдПрдХ рдЕрд▓рдЧ рднреВрдорд┐рдХрд╛ рд╣реИ;  рдЦ) рдЗрд╕реЗ рд╕реНрдкреНрд░рд┐рдВрдЧ рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдХреЛ рдЕрдзрд┐рдХреГрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ (рд╕рдХреНрд╖рдо = рдЧрд▓рдд)ред <br><br><h4>  рд╕рд╛рдЗрдЯ рдкрд░ рдкреНрд░рд╛рдзрд┐рдХрд░рдг </h4><br>  рдПрдХ рд╕рд╛рдзрд╛рд░рдг рд╡рд╕рдВрдд <em>рдЖрд╡реЗрджрди-рд╕рдВрджрд░реНрдн-рд╕реБрд░рдХреНрд╖рд╛.рдПрдХреНрд╕рдПрдордПрд▓</em> : <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security:global-method-security</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">secured-annotations</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"enabled"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">jsr250-annotations</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"enabled"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pre-post-annotations</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"enabled"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">proxy-target-class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security:http</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">auto-config</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">use-expressions</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security:intercept-url</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pattern</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/**"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">access</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"permitAll"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security:form-login</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">login-page</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/signin"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security:logout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">invalidate-session</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">logout-success-url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">logout-url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/signout"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security:remember-me</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">services-ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"rememberMeService"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"someRememberMeKey"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security:http</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security:authentication-manager</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"authenticationManager"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security:authentication-provider</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"authenticationProvider"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security:authentication-manager</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"authenticationProvider"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myproject.security.CustomAuthenticationProvider"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"rememberMeService"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myproject.security.RememberMeService"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"key"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"someRememberMeKey"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"userDetailsService"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"userDetailsService"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"userDetailsService"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myproject.security.CustomUserDetailsManager"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"passwordEncoder"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"org.springframework.security.authentication.encoding.ShaPasswordEncoder"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br><h6>  CustomUserDetailsManager.java: </h6><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomUserDetailsManager</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserDetailsService</span></span></span><span class="hljs-class"> </span></span>{ @ Resource <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AuthenticationDAO authenticationDAO; @ <span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> UserDetails </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadUserByUsername</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String username)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> UsernameNotFoundException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> authenticationDAO.findAuthUser(username); } }</code> </pre> <br><h6>  CustomUserAuthentication.java: </h6><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomUserAuthentication</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Authentication</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Object details; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> UserDetails user; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> authenticated; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Collection&lt;? extends GrantedAuthority&gt; authorities; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CustomUserAuthentication</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(UserDetails user, Object details)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = user.getUsername(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.details = details; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.user = user; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.authorities = user.getAuthorities(); authenticated = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } @ <span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> name; } @ Override <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Collection&lt;? extends GrantedAuthority&gt; getAuthorities() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> authorities; } @ <span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCredentials</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> user.getPassword(); } @ <span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDetails</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> details; } @ <span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPrincipal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> user; } @ <span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isAuthenticated</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> authenticated; } @ <span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setAuthenticated</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> authenticated)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IllegalArgumentException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.authenticated = authenticated; } }</code> </pre> <br><h6>  CustomAuthenticationProvider.java </h6>  (рд╡рд░реНрдЧ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдмреЗрд╡рдХреВрдл рд╣реИ, рд▓реЗрдХрд┐рди рд╕реНрдкреНрд░рд┐рдВрдЧ рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдХреЛ <em>рдСрдереЗрдВрдЯрд┐рдХреЗрд╢рдирдкреЙрдЗрдбрд░</em> рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рдЙрддреНрддрд░рд╛рдзрд┐рдХрд╛рд░реА рдХреЛ рдЦрд┐рд▓рд╛рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ, рд▓реЗрдХрд┐рди рдЕрд░реНрде рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдирд┐рдХрдЯрддрдо <em>PreAuthenticatedAuthenticationProvider</em> рдЙрдкрдпреБрдХреНрдд рдирд╣реАрдВ рд╣реИ) <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomAuthenticationProvider</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthenticationProvider</span></span></span><span class="hljs-class"> </span></span>{ @ <span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Authentication </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">authenticate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Authentication authentication)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> AuthenticationException </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   .  return authentication; } @ Override public boolean supports(Class&lt;?&gt; authentication) { return PreAuthenticatedAuthenticationToken.class.isAssignableFrom(authentication); } public Authentication trust(UserDetails user) { Authentication authentication = SecurityContextHolder.getContext().getAuthentication(); Authentication trustedAuthentication = new CustomUserAuthentication(user, authentication.getDetails()); authentication = authenticate(trustedAuthentication); SecurityContextHolder.getContext().setAuthentication(authentication); return authentication; } }</span></span></code> </pre> <br>  рдФрд░ рд╢рд╛рдпрдж рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ "рдЕрдбрд╝рдЪрди" рдЬрдЧрд╣ рд╣реИ <em>рд╕реНрдорд░рдг</em> рддрдВрддреНрд░ рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрдиред  рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рд╕рдм рдХреБрдЫ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╡реНрдпрд╡рд╕реНрдерд┐рдд рд╣реИ рддрд╛рдХрд┐ <em>рд░рд┐рдореЗрдореНрдмрд░</em> рд╕реЗрд╡рд╛ рдХрд╛ рд╕рдВрдЪрд╛рд▓рди рдкреВрд░реА рддрд░рд╣ рд╕реЗ <em>рдЯреЛрдХрдирдмреЗрдбрд░реИрдорд░реЗрдореЗрдореЗрд░реНрд╕ рд╕рд░реНрд╡рд┐рд╕реЗрдЬ рдХреЗ</em> рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рд╕рд╛рде рд╣реЛ, рдПрдХ рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рдХреЗ рд╕рд╛рде: рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХреНрд▓рд╛рдЗрдВрдЯ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рд▓рд┐рдП рд╕рднреА рдбреЗрдЯрд╛ рд╣рдорд╛рд░реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдРрд╕реА рд╕реНрдерд┐рддрд┐ рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрдм рдХреЛрдИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рд╛рдЗрдЯ рдкрд░ рд▓реЙрдЧ рдСрди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЦрд╛рддрд╛ рд╣рдЯрд╛ рджреЗрддрд╛ рд╣реИред рд╕рд╛рдорд╛рдЬрд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ред<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рдпрд╣ рдПрдХ рд╕рдВрдШрд░реНрд╖ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИ - рд╣рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдзрд┐рдХреГрдд рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╡рд╣ рд╡рд╣рд╛рдВ рдирд╣реАрдВ рд╣реИ, рдЕрд░реНрдерд╛рдд, рддреГрддреАрдп-рдкрдХреНрд╖ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рдореБрдЦреНрдп рд╕рд┐рджреНрдзрд╛рдВрддреЛрдВ рдХрд╛ рдЙрд▓реНрд▓рдВрдШрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣реА рд╣реИ, рдЬрдм рдпрд╛рдж рд░рдЦреЗрдВ рддрдВрддреНрд░ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдореЗрдВ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдЧреНрд░рд╛рд╣рдХ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред рдкреНрд░рддреНрдпреЗрдХ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рджрд╛рддрд╛ рдХреЗ рдПрдкреАрдЖрдИ рдореЗрдВ рдРрд╕реЗ рддрдВрддреНрд░ рд╣реЛрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рд╕рд╣реА рд╕реНрдЯреЗрдЬ рдкрд░ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреЗ рд░рд┐рдореЗрдореЗ рдХреЗ рдХрд╛рдо рдореЗрдВ "рд╡реЗрдЬ" рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рдпрд╣ рдПрдХ рд╡рд░реНрдЧ рдХреЛ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ ( </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AbstractRememberMeServices рд╣рдорд╛рд░реЗ рдкрд╛рд╕ </font></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдВрддрд┐рдо рд░реВрдк</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╡рд┐рдзрд┐ рд╣реИ </font><font style="vertical-align: inherit;">), рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╡рд░реНрдЧ рдХреЛ рдлрд┐рд░ рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдореЗрд░реА рд╡рд┐рдзрд┐ рдЕрдзрд┐рдХ рдмреЛрдЭрд┐рд▓ рд╣реИ, рдореИрдВ рдЕрдВрдд рд╕реЗ рдЪрд▓рд╛ рдЧрдпрд╛, рдФрд░ рд╕рд╛рдорд╛рдиреНрдп рдорд╛рдирд╡ рдЖрд▓рд╕реНрдп рдореБрдЭреЗ рдПрдХ рд╕рд░рд▓ рд╡рд┐рдХрд▓реНрдк рдкрд░ рдлрд┐рд░ рд╕реЗ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИред рдореИрдВрдиреЗ </font><em><font style="vertical-align: inherit;">AbstractRememberMeServices</font></em><font style="vertical-align: inherit;"> рд╡рд░реНрдЧ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдлрд┐рд░ рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛</font></font><em><font style="vertical-align: inherit;"></font></em>     <em>TokenBasedRememberMeServices</em> ,      <em>public Authentication autoLogin(HttpServletRequest request, HttpServletResponse response)</em> тАУ     ,         ┬л┬╗ : <br><pre> <code class="java hljs">Class&lt;? extends ExternalController&gt; controller = externalControllers.get(user.getPassword()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (controller != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; !controller.newInstance().checkAccount(user)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>;</code> </pre> <br>  ,     : <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Map&lt;String, Class&lt;? extends ExternalController&gt;&gt; externalControllers; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CustomRememberMeService</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ externalControllers = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;String, Class&lt;? extends ExternalController&gt;&gt;(){{ put(AuthenticationType.FACEBOOK.name(), FacebookController.class); put(AuthenticationType.TWITTER.name(), TwitterController.class); put(AuthenticationType.GOOGLE.name(), GoogleController.class); put(AuthenticationType.LINKEDIN.name(), LinkedinController.class); }}; }</code> </pre> <br> (        RememberMe   ). <br><br>        <a href="http://static.springsource.org/spring-security/site/docs/3.1.x/reference/ns-config.html">REMEMBER_ME_FILTER</a>  ,          autoLogin,    .          , ,    .     тАУ   ,  ,   ,   ┬л┬╗. <br><br>       <em>ExternalController</em>   <em>checkAccount(user)</em> .   callback-   <em>ExternalController</em> : <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ExternalController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkAccount</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(UserDetails user)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception</span></span>; }</code> </pre> <br>       .  ,  Facebook : <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> heckAccount(UserDetails user) <span class="hljs-keyword"><span class="hljs-keyword">throws</span></span> Exception { FacebookAuthUser facebookUser = (FacebookAuthUser) user; String authRequest = Utils.sendHttpRequest(<span class="hljs-string"><span class="hljs-string">"GET"</span></span>, FACEBOOK_URL_ME, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"access_token"</span></span>}, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{facebookUser.getToken()}); Map&lt;String, Json&gt; tokenInfoResponse = Json.read(authRequest).asJsonMap(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tokenInfoResponse.get(<span class="hljs-string"><span class="hljs-string">"error"</span></span>) == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; tokenInfoResponse.get(<span class="hljs-string"><span class="hljs-string">"id"</span></span>).asString().equalsIgnoreCase(facebookUser.getIdentificationName()); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ рдЯреНрд╡рд┐рдЯрд░ рдХреЗ рд▓рд┐рдП: </font></font><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkAccount</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(UserDetails user)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ TwitterAuthUser twitterUser = (TwitterAuthUser) user; OAuthService service = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ServiceBuilder().provider(TwitterApi.class).apiKey(TWITTER_CONSUMER_KEY).apiSecret(TWITTER_CONSUMER_SECRET).build(); OAuthRequest oauthRequest = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OAuthRequest(Verb.GET, TWITTER_URL_CREDENTIALS); service.signRequest(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Token(twitterUser.getOauthToken(), twitterUser.getOauthTokenSecret()), oauthRequest); String response = oauthRequest.send().getBody(); Map&lt;String, Json&gt; info = Json.read(request).asJsonMap(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> info.get(<span class="hljs-string"><span class="hljs-string">"id"</span></span>).asString().equalsIgnoreCase(twitterUser.getIdentificationName()); }</code> </pre> <br>  рдЖрджрд┐ <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реАрдзреЗ рд╕рд╛рдЗрдЯ рдкрд░ рд╣реА рдкреНрд░рд╛рдзрд┐рдХрд░рдг (рд▓реЙрдЧрд┐рди, рд╕рд╛рдЗрди рдЗрди) рдкрдВрдЬреАрдХрд░рдг рдХреЗ рд╕рдорд╛рди рд╣реИред </font><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреГрд╖реНрда рдкрд░ рдЬрд╛рддрд╛ рд╣реИ, "рд▓реЙрдЧрд┐рди" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрд╕реЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдореЗрдВ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рднреА рдХрд░рддрд╛ рд╣реИ: </font></font><br><img src="http://img43.imageshack.us/img43/5977/pic4x.png" alt="рдЫрд╡рд┐"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд░реНрд╡рд░ рдХреЛ рднреЗрдЬрдиреЗ рд╡рд╛рд▓реА рдПрдХрдорд╛рддреНрд░ рдЪреАрдЬ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИ - "рд╕рд╛рдЗрдирдЗрди" рдпрд╛ "рдСрдЯреЛрд╕рд┐рдЧреНрдирд┐рди", рдЗрд╕рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХрд┐ "рд╕рд╛рдЗрди рдЗрди рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ" рдЪреЗрдХрдмреЙрдХреНрд╕ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕рдм рдХреБрдЫ рдкрдВрдЬреАрдХрд░рдг рдХреЗ рд╕рдорд╛рди рдкрд░рд┐рджреГрд╢реНрдп рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╣реЛрддрд╛ рд╣реИ, рдХреЗрд╡рд▓ рдкреИрд░рд╛рдореАрдЯрд░ рдмрджрд▓рддрд╛ рд╣реИ, </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЙрд▓рдмреИрдХ URL</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ рд╕рднреА </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреБрдВрдЬрд╛рдЗрд╢</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛ </font><em><font style="vertical-align: inherit;">рдЕрдиреБрдорддрд┐ рдХреЛ</font></em><font style="vertical-align: inherit;"> рд╣рдЯрд╛ рджреЗрдВ</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдХреНрд▓рд╛рдЗрдВрдЯ рдЖрдИрдбреА рдФрд░ рдЙрд╕рдХреЗ рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдирд┐рдпрдВрддреНрд░рдХ рд╡рд┐рдзрд┐рдпреЛрдВ рдореЗрдВ рдЙрдкрдпреБрдХреНрдд рдЬрд╛рдВрдЪ рдХреЗ рдмрд╛рдж, рдореИрдВ рдЖрдкрдХреЛ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдЯреЛрдХрди рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░рдиреЗ рдХреА рд╕рд▓рд╛рд╣ рджреЗрддрд╛ рд╣реВрдВред рдФрд░ рдпрджреНрдпрдкрд┐, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдлреЗрд╕рдмреБрдХ рдиреЗ рдореЗрд░реЗ рдкрд░реАрдХреНрд╖рдгреЛрдВ рдХреЗ рджреМрд░рд╛рди рдЧреНрд░рд╛рд╣рдХ рдЯреЛрдХрди рдХреЛ рдирд╣реАрдВ рдмрджрд▓рд╛, рд▓реЗрдХрд┐рди Google+ рд╣рд░ рдмрд╛рд░ рдРрд╕рд╛ рдХрд░рддрд╛ рд╣реИред рдореБрдЭреЗ рдирд╣реАрдВ рдкрддрд╛ рдХрд┐ рдХрд┐рддрдиреА рдмрд╛рд░ "рдкрд░рд┐рд╡рд░реНрддрди" рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдореИрдВ рдЗрд╕реЗ рдкреНрд░рддреНрдпреЗрдХ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">access_token</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдкреНрд░рджрд╛рддрд╛ рджреНрд╡рд╛рд░рд╛ рд╣рд░ рдЧреИрд░-рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдореЗрдВ) рдХреЗ </font><font style="vertical-align: inherit;">рдмрд╛рдж рдлрд┐рд░ рд╕реЗ </font><em><font style="vertical-align: inherit;">рд▓рд┐рдЦрддрд╛ рд╣реВрдВ</font></em><font style="vertical-align: inherit;"> ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдВрджреБ рд╡рд╕рдВрдд рд╕реБрд░рдХреНрд╖рд╛ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдкреНрд░рддреНрдпрдХреНрд╖ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдлреЗрд╕рдмреБрдХ рдХреА рдирд┐рдпрдВрддреНрд░рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрдкрд╛рд▓рди рдФрд░ рдкреНрд░рджрд╛рддрд╛ рдХреЗ рдПрдкреАрдЖрдИ рд╕реЗ рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП), рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ:</font></font><br><pre> <code class="java hljs">@ RequestMapping(value = <span class="hljs-string"><span class="hljs-string">"/signin"</span></span>, params = <span class="hljs-string"><span class="hljs-string">"code"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ModelAndView </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">signInAccessCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@ RequestParam(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"code"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String code, @ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequestParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"state"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String state, HttpServletRequest request, HttpServletResponse response) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ String accessRequest = Utils.sendHttpRequest(<span class="hljs-string"><span class="hljs-string">"GET"</span></span>, FACEBOOK_URL_ACCESS_TOKEN, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"client_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"redirect_uri"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_secret"</span></span>, <span class="hljs-string"><span class="hljs-string">"code"</span></span>}, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{FACEBOOK_API_KEY, FACEBOOK_URL_CALLBACK_SIGNIN, FACEBOOK_API_SECRET, code}); String token = Utils.parseURLQuery(accessRequest).get(<span class="hljs-string"><span class="hljs-string">"access_token"</span></span>); Map&lt;String, Json&gt; userInfoResponse = Json.read(Utils.sendHttpRequest(<span class="hljs-string"><span class="hljs-string">"GET"</span></span>, FACEBOOK_URL_ME, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"access_token"</span></span>}, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{token})).asJsonMap(); FacebookAuthUser user = (FacebookAuthUser) authenticationDAO.findAuthUser(userInfoResponse.get(<span class="hljs-string"><span class="hljs-string">"id"</span></span>).asString(), AuthenticationType.FACEBOOK); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (user == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//-    ... return new ModelAndView(new RedirectView("/signin", true, true, false)); } else { if (!token.equals(user.getToken())) { user.setToken(token); user = (FacebookAuthUser) authenticationDAO.put(user); } Authentication authentication = customAuthenticationProvider.trust(user); if (state.equalsIgnoreCase("autosignin")) customRememberMeService.onLoginSuccess(request, response, authentication); else customRememberMeService.logout(request, response, authentication); //  RememberMe return new ModelAndView(new RedirectView("/signin.complete", true, true, false)); } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдм, рдСрдЯреЛ-рд▓реЙрдЧрд┐рди рдЪреЗрдХрдмреЙрдХреНрд╕ рдЪрдпрдирд┐рдд рд╣реЛрдиреЗ рдХреЗ рд╕рд╛рде, рдЧреНрд░рд╛рд╣рдХ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд▓реЙрдЧ рдЗрди рд╣реЛ рдЬрд╛рдПрдЧрд╛ред рддрджрдиреБрд╕рд╛рд░, рдЕрдЧрд░ рдХреЛрдИ рдЪреЗрдХрдорд╛рд░реНрдХ рдирд╣реАрдВ рд╣реИ, рддреЛ </font><em><font style="vertical-align: inherit;">рдпрд╛рдж рд░рдЦреЗрдВ</font></em><font style="vertical-align: inherit;"> рд╕реЗрд╡рд╛ </font><font style="vertical-align: inherit;">рдХреА </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЙрдЧрдЖрдЙрдЯ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рдзрд┐ </font><font style="vertical-align: inherit;">рдХреЗ </font><font style="vertical-align: inherit;">рд▓рд┐рдП рдПрдХ рдХреЙрд▓ </font><font style="vertical-align: inherit;">рдХреБрдХреАрдЬрд╝ рдХреЛ рдорд┐рдЯрд╛ рджреЗрдЧрд╛ (рдпрд╣ рдФрд░ рдХреБрдЫ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ)ред рд╡реИрд╕реЗ, "/ рд▓реЙрдЧрдЖрдЙрдЯ" рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рд╕реЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдХреБрдХреАрдЬрд╝ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕рд╛рдлрд╝ рд╣реЛ рдЬрд╛рддреА рд╣реИрдВред рдпрд╣ рдКрдкрд░ рд╕реНрдкреНрд░рд┐рдВрдЧ рд╕реБрд░рдХреНрд╖рд╛ рдХреЙрдиреНрдлрд┐рдЧрд░ рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рд▓рд╛рдЗрди рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдорд╛рдирдХ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рд▓рд┐рдП "рдЦрд░рд╛рдм" рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: рдЪреЗрдХ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж (рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЦреЛрдЬрдиреЗ, рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢, рдЖрджрд┐ рдХреЛ рд╕рдореЗрдЯрддреЗ рд╣реБрдП), рд╣рдо рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдЗрд╕реЗ рдЕрдзрд┐рдХреГрдд рдХрд░рддреЗ рд╣реИрдВ:</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><pre> <code class="java hljs">Authentication authentication = customAuthenticationProvider.trust(user); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (autosignin) customRememberMeService.onLoginSuccess(request, response, authentication); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> customRememberMeService.logout(request, response, authentication);</code> </pre> <br>     . ,  , тАУ  ,     RememberMe     , ,      TokenBasedRememberMeServices. <br><br>        Spring Security,    ,     <em>@Secured(┬лCUSTOM_ROLE┬╗)</em> ,      (     ,     ).   Spring Security    тАУ     <em>@PreAuthorize</em> , <em>@PostFilter</em> : <em>@PreAuthorize(┬лhasRole('ADMINISTRATOR')┬╗), @PreAuthorize(┬лhasRole({'CUSTOMER', 'ADMINISTRATOR'})┬╗)</em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдпрд╣ рдХреЗрд╡рд▓ рд╕реБрд░рдХреНрд╖рд╛ рдореЗрдВ рд╕реНрдкреНрд░рд┐рдВрдЧ рд╕реБрд░рдХреНрд╖рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рдЗрд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: рд╡реИрд╢реНрд╡рд┐рдХ-рд╡рд┐рдзрд┐-рд╕реБрд░рдХреНрд╖рд╛</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреИрд░рд╛рдореАрдЯрд░ </font><font style="vertical-align: inherit;">ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕реА рддрд░рд╣, рдЖрдк рдПрдХ рджреГрд╢реНрдп рдореЗрдВ ( </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSP рдореЗрдВ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">рд╕реНрдкреНрд░рд┐рдВрдЧ рд╕реБрд░рдХреНрд╖рд╛ рдХреА рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдФрд░ рдХреНрд╖рдорддрд╛рдУрдВ рдХрд╛ рд▓рд╛рдн рдЙрдард╛ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред</font></font> рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">taglib</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prefix</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"core"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uri</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://java.sun.com/jsp/jstl/core"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">taglib</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prefix</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sec"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uri</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.springframework.org/security/tags"</span></span></span><span class="hljs-tag"> %&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sec:authorize</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">access</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"isAuthenticated()"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"userBox"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>Welcome, <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sec:authentication</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">property</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"principal.user.firstName"</span></span></span><span class="hljs-tag">/&gt;</span></span>!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sec:authorize</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>          ,        (      ). <br><br>    <em>jsp-</em>  jsp- (      ,   -  ┬л тАУ ,  тАФ ┬╗,   ,   /  тАУ ;    ,       ,    тАУ , , ,   ): <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">page</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">import</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"org.springframework.security.core.context.SecurityContextHolder"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">page</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">import</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myproject.auth.AuthUser"</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Object</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">principal</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">SecurityContextHolder.getContext().getAuthentication().getPrincipal();</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AuthUser</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">authUser</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">null;</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span><span class="hljs-tag"> (!(</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">principal</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">instanceof</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">String</span></span></span><span class="hljs-tag">)) </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">authUser</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">(AuthUser)</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">principal</span></span></span><span class="hljs-tag">; %&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> &lt;%= </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">authUser</span></span></span><span class="hljs-tag"> == </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">null</span></span></span><span class="hljs-tag"> ? "" </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:</span></span></span><span class="hljs-tag"> "</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">disabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">\</span></span></span><span class="hljs-tag">"</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">disabled</span></span></span><span class="hljs-tag">\"" %&gt;</span></span> name="your_name" value="<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">authUser</span></span></span><span class="hljs-tag"> == </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">null</span></span></span><span class="hljs-tag"> ? "" </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">authUser.getUser</span></span></span><span class="hljs-tag">()</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">.getFirstName</span></span></span><span class="hljs-tag">()%&gt;</span></span>"/&gt; ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span><span class="hljs-tag"> (</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">authUser</span></span></span><span class="hljs-tag"> == </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">null)</span></span></span><span class="hljs-tag"> { %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"recaptcha_widget"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"recaptchaContainer"</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%</span></span></span><span class="hljs-tag"> } %&gt;</span></span></code> </pre> <br>         ,     -   . <br><br>     ┬л┬╗ ,          (-):          Runtime Exception,    user (  getUser())        ,   null.   <em>OpenSessionInView</em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрд╢реНрд░рд┐рдд рд╡рд╕реНрддреБ рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд рд▓реЛрдб рдХреЗ рдмрд┐рдирд╛, рдпрд╣ рдорджрдж рдирд╣реАрдВ рдХрд░реЗрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣рд╛рдВ HTTP рд╕рддреНрд░ рдЕрд▓рдЧ рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, рдЖрдкрдХреЛ рд▓реЛрдбрд┐рдВрдЧ рдкрд░ рддреБрд░рдВрдд рдирд┐рд░реНрднрд░ рд╡рд╕реНрддреБ рдХреЛ рд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЛ рд╡рд┐рд░реЛрдзрд╛рднрд╛рд╕реА рдмрдирд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рдХрд╛рд░рдг рдЖрд▓рд╕реА рдХрдиреЗрдХреНрд╢рди рдЕрд╕рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ - рдСрдмреНрдЬреЗрдХреНрдЯ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдирд┐рд░реНрднрд░ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рд▓реЛрдб рдХрд┐рдП рдЧрдП рдЕрдкрдбреЗрдЯ рдирд╣реАрдВ рдХрд░реЗрдЧрд╛, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдИрдПрдЬреАрдИрдЖрд░ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реИред рдореИрдВрдиреЗ </font><font style="vertical-align: inherit;">рдПрдХ рдирдП рд╕рддреНрд░ рдХреЗ рдЙрджреНрдШрд╛рдЯрди рдХреЗ рд╕рд╛рде </font><font style="vertical-align: inherit;">рдЖрдорддреМрд░ рдкрд░ рдЗрд╕реНрддреЗрдорд╛рд▓ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд┐рдП</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ </font><em><font style="vertical-align: inherit;">рд╕рддреНрд░рдлреИрдХреНрдЯрд░реА.рдЧреЗрдЯрд╕рд░реНрдХрд┐рдЯ рд╕реЗрд╢рди () рдХреА</font></em><font style="vertical-align: inherit;"> рдЬрдЧрд╣ рд▓реЗрддреЗ рд╣реБрдП </font><em><font style="vertical-align: inherit;">рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрд╢рдирдбреАрдПрдУ</font></em><font style="vertical-align: inherit;"> рдореЗрдВ рдпрд╣ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛ </font><font style="vertical-align: inherit;">: </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЗрд╢рдирдлреИрдХреНрдЯрд░реА рдпреВрдЯрд┐рд▓реНрд╕.рдУрдкрдирд╕реЗрд╢рди (рд╕реЗрд╢рдирдлреИрдХреНрдЯрд░реА)</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд╢рд╛рдпрдж рдпрд╣ рд╕реНрдореГрддрд┐ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд╕рдмрд╕реЗ рдХрд┐рдлрд╛рдпрддреА рд╕рдорд╛рдзрд╛рди рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдореИрдВрдиреЗ рдЕрднреА рддрдХ рдЗрд╕ рд╕рд╡рд╛рд▓ рдХреЛ рдирд╣реАрдВ рдкреВрдЫрд╛ рд╣реИ рдФрд░ рдЗрд╕ рд╡рд┐рд╖рдп рдкрд░ рдзреНрдпрд╛рди рдирд╣реАрдВ рджрд┐рдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╡рд░реНрддрдорд╛рди рд╕рддреНрд░ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП рдЪреЗрдХ рд╕реЗрдЯ рдХрд░рдХреЗ, рдЖрдк рдлрд╝рд┐рд▓реНрдЯрд░ рдпрд╛ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenSessionInView</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯрд░ рдХреЛ рдордирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЗрд╕рдХреЗ рдХрд╛рдо рдХреА рдЬрдЧрд╣ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рда рдЖрд╡рд╢реНрдпрдХ рд╕реЗ рдЕрдзрд┐рдХ рдирд┐рдХрд▓рд╛, рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рд╡рд┐рд╡рд╛рджрд╛рд╕реНрдкрдж рдпрд╛ рдЧрд▓рдд рдХреНрд╖рдг рднреА рд╣реИрдВ, рд▓реЗрдХрд┐рди рдореИрдВрдиреЗ рдЙрди рдХрдард┐рдирд╛рдЗрдпреЛрдВ рдХреЗ рд╕рдорд╛рдзрд╛рди рдХреЛ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА, рдЬреЛ рдореИрдВрдиреЗ рд╕реНрд╡рдпрдВ рдкрд░рд┐рдХрд▓реНрдкрд┐рдд рддрдВрддреНрд░ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдореЗрдВ рд╕рд╛рдордирд╛ рдХрд┐рдпрд╛ рдерд╛ред</font></font></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/In145695/">https://habr.com/ru/post/In145695/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../In145688/index.html">рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк: рджреВрд╕рд░реЛрдВ рдХреА рдЧрд▓рддрд┐рдпреЛрдВ рд╕реЗ рдЖрдкрдХреЛ рдХреНрдпрд╛ рдХрд░рдиреЗ рдпрд╛ рд╕реАрдЦрдиреЗ рдХреА рдЬрд░реВрд░рдд рдирд╣реАрдВ рд╣реИ</a></li>
<li><a href="../In145689/index.html">рдбрд░реНрдЯреА рд╕реНрдЯреНрд░реЗрд╕ рдЯреЗрд╕реНрдЯ рдирдЧреНрдиреЗрдХреНрд╕ рдмрдирд╛рдо рдЕрдкрд╛рдЪреЗ</a></li>
<li><a href="../In145690/index.html">рдЯреНрд╡рд┐рдЯрд░ рдиреЗ рдкреНрд░рд╡реГрддреНрддрд┐ рд╡реИрдпрдХреНрддрд┐рдХрд░рдг рдХрд╛ рдкрд░рд┐рдЪрдп рджрд┐рдпрд╛</a></li>
<li><a href="../In145693/index.html">рдЯреА (рдИрдерд░) рд╡рд╛рд╕реНрддрд╡рд┐рдХ рджреБрдирд┐рдпрд╛ рдореЗрдВ рдЖрднрд╛рд╕реА рд╡рд╕реНрддреБрдУрдВ рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ</a></li>
<li><a href="../In145694/index.html">JSON рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Icecast2 рдХреЗ рд▓рд┐рдП рдЕрдм рдмрдЬрдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреБрднрд╛рдЧ рдХрд╛ рдПрдХ рд╕рд░рд▓ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди</a></li>
<li><a href="../In145697/index.html">Unity3dstudent.com рд╕реЗ рджреВрд╕рд░рд╛ рдЕрднреНрдпрд╛рд╕ рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ</a></li>
<li><a href="../In145699/index.html">рдирдпрд╛ HTTP рд╕реЗрдВрд╕рд░рд╢рд┐рдк рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рд╣реИ</a></li>
<li><a href="../In145700/index.html">OVH рдиреЗ рдЕрдореЗрд░рд┐рдХрд╛ рдореЗрдВ рдПрдХ рдмрдбрд╝рд╛ рдбреЗрдЯрд╛ рд╕реЗрдВрдЯрд░ рдЦреЛрд▓рд╛</a></li>
<li><a href="../In145701/index.html">рдХреИрд╕реЗ рд░реЗрдХреЙрд░реНрдб рдХрд┐рдпрд╛ рдЬрд╛рдП</a></li>
<li><a href="../In145702/index.html">рдиреНрдпреВ рдЬрд┐рдВрдЧрд╛ рдСрдлрд┐рд╕</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>