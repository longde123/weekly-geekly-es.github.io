<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÉüèΩ üöò üé≠ Nach Highload ++ Siberia 2019 - 8 Oracle-Aufgaben üë®üèº‚Äçüíª üíáüèæ ‚ô£Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo! 

 Vom 24. bis 25. Juni fand in Nowosibirsk die Konferenz Highload ++ Siberia 2019 statt. Unsere Mitarbeiter waren auch beim Bericht ‚ÄûOracle Co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nach Highload ++ Siberia 2019 - 8 Oracle-Aufgaben</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sportmaster_lab/blog/459680/">  Hallo! <br><br>  Vom 24. bis 25. Juni fand in Nowosibirsk die Konferenz Highload ++ Siberia 2019 statt. Unsere Mitarbeiter waren auch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">beim Bericht</a> ‚ÄûOracle Container Bases (CDB / PDB) und ihre praktische Verwendung f√ºr die Softwareentwicklung‚Äú dabei. Wir werden etwas sp√§ter eine Textversion ver√∂ffentlichen.  Es war cool, danke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">olegbunin</a> f√ºr die Organisation sowie allen, die gekommen sind. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-7/k4/u1/-7k4u1btcjxquu515qeoyxnxigu.jpeg" width="350"></div><br>  In diesem Beitrag m√∂chten wir Ihnen die Aufgaben an unserem Stand mitteilen, damit Sie Ihr Wissen in Oracle testen k√∂nnen.  Beantworten Sie unter den 8 Aufgaben die Optionen und Erkl√§rungen. <br><a name="habracut"></a><br><h3>  Was ist der Maximalwert der Sequenz, die wir als Ergebnis des folgenden Skripts sehen werden? </h3><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> s <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> s.currval, s.nextval, s.currval, s.nextval, s.currval <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> dual <span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> &lt;= <span class="hljs-number"><span class="hljs-number">5</span></span>;</code> </pre> <br><ul><li>  1 </li><li>  5 </li><li>  10 </li><li>  25 </li><li>  Nein, es wird einen Fehler geben </li></ul><br><div class="spoiler">  <b class="spoiler_title">Die Antwort</b> <div class="spoiler_text">  Gem√§√ü Oracle-Dokumentation (zitiert aus 8.1.6): <br>  Innerhalb einer einzelnen SQL-Anweisung erh√∂ht Oracle die Sequenz nur einmal pro Zeile.  Wenn eine Anweisung mehr als einen Verweis auf NEXTVAL f√ºr eine Sequenz enth√§lt, erh√∂ht Oracle die Sequenz einmal und gibt f√ºr alle Vorkommen von NEXTVAL denselben Wert zur√ºck.  Wenn eine Anweisung Verweise auf CURRVAL und NEXTVAL enth√§lt, erh√∂ht Oracle die Sequenz und gibt unabh√§ngig von ihrer Reihenfolge innerhalb der Anweisung denselben Wert f√ºr CURRVAL und NEXTVAL zur√ºck. <br><br>  Somit entspricht der <b>Maximalwert der Anzahl der Zeilen, d</b> . <b>H. 5</b> . <br></div></div><br><h3>  Wie viele Zeilen enth√§lt das folgende Skript in der Tabelle? </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> t(i <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> (i &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">procedure</span></span> p(p_from <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span>, p_to <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> p_from .. p_to <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (i); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; / exec p(1, 3); exec p(4, 6); exec p(7, 9);</code> </pre> <br><ul><li>  0 </li><li>  3 </li><li>  4 </li><li>  5 </li><li>  6 </li><li>  9 </li></ul><br><div class="spoiler">  <b class="spoiler_title">Die Antwort</b> <div class="spoiler_text">  Laut Oracle-Dokumentation (zitiert aus 11.2): <br><br>  Vor dem Ausf√ºhren einer SQL-Anweisung markiert Oracle einen impliziten Sicherungspunkt (der Ihnen nicht zur Verf√ºgung steht).  Wenn die Anweisung fehlschl√§gt, setzt Oracle sie automatisch zur√ºck und gibt den entsprechenden Fehlercode an SQLCODE in der SQLCA zur√ºck.  Wenn beispielsweise eine INSERT-Anweisung einen Fehler verursacht, indem versucht wird, einen doppelten Wert in einen eindeutigen Index einzuf√ºgen, wird die Anweisung zur√ºckgesetzt. <br><br>  Ein Anruf vom Kunden wird ebenfalls als einzelne Anweisung betrachtet und verarbeitet.  Somit wird der erste Aufruf von HP erfolgreich abgeschlossen, indem drei Datens√§tze eingef√ºgt werden.  Der zweite Aufruf von HP endet mit einem Fehler und setzt den vierten Datensatz zur√ºck, den ich einf√ºgen konnte.  Der dritte Aufruf schl√§gt fehl <b>und drei Eintr√§ge werden in der Tabelle angezeigt</b> . <br></div></div><br><h3>  Wie viele Zeilen enth√§lt das folgende Skript in der Tabelle? </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> t(i <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> i_ch <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> (i &lt; <span class="hljs-number"><span class="hljs-number">3</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-number"><span class="hljs-number">5</span></span>); exception when others then dbms_output.put_line('Oops!'); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; /</code> </pre> <br><ul><li>  1 </li><li>  2 </li><li>  3 </li><li>  4 </li><li>  5 </li><li>  6 </li><li>  7 </li></ul><br><div class="spoiler">  <b class="spoiler_title">Die Antwort</b> <div class="spoiler_text">  Laut Oracle-Dokumentation (zitiert aus 11.2): <br><br>  Mit einer Pr√ºfbedingung k√∂nnen Sie eine Bedingung angeben, die jede Zeile in der Tabelle erf√ºllen muss.  Um die Einschr√§nkung zu erf√ºllen, muss jede Zeile in der Tabelle die Bedingung entweder WAHR oder unbekannt machen (aufgrund einer Null).  Wenn Oracle eine Pr√ºfbedingung f√ºr eine bestimmte Zeile auswertet, beziehen sich alle Spaltennamen in der Bedingung auf die Spaltenwerte in dieser Zeile. <br><br>  Somit besteht der Nullwert den Test und der anonyme Block wird erfolgreich ausgef√ºhrt, bis versucht wird, den Wert 3 einzuf√ºgen. Danach l√∂st der Fehlerbehandlungsblock eine Ausnahme aus, es erfolgt kein Rollback, und <b>die Tabelle enth√§lt vier Zeilen</b> mit den Werten 1, null, 2 und null. <br></div></div><br><h3>  Welche Wertepaare belegen den gleichen Platz im Block? </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> t ( a <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), b <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), c <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), i <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>(<span class="hljs-number"><span class="hljs-number">4</span></span>), j <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>(<span class="hljs-number"><span class="hljs-number">14</span></span>), k <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>(<span class="hljs-number"><span class="hljs-number">24</span></span>), x varchar2(<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), y varchar2(<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), z varchar2(<span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t (a, b, i, j, x, y) <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-string"><span class="hljs-string">'Y'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>);</code> </pre><br><ul><li>  A und X. </li><li>  B und Y. </li><li>  C und K. </li><li>  C und Z. </li><li>  K und Z. </li><li>  Ich und J. </li><li>  J und X. </li><li>  Alle aufgelistet </li></ul><br><div class="spoiler">  <b class="spoiler_title">Die Antwort</b> <div class="spoiler_text">  Hier finden Sie Ausz√ºge aus der Dokumentation (12.1.0.2) zum Speichern verschiedener Datentypen in Oracle. <br><br>  <b>Char Datentyp</b> <br>  Der Datentyp CHAR gibt eine Zeichenfolge fester L√§nge im Datenbankzeichensatz an.  Sie geben den Datenbankzeichensatz an, wenn Sie Ihre Datenbank erstellen.  Oracle stellt sicher, dass alle in einer CHAR-Spalte gespeicherten Werte die L√§nge haben, die in der ausgew√§hlten L√§ngensemantik durch die Gr√∂√üe angegeben ist.  Wenn Sie einen Wert einf√ºgen, der k√ºrzer als die Spaltenl√§nge ist, f√ºllt Oracle den Wert mit der Spaltenl√§nge auf. <br><br>  <b>Datentyp VARCHAR2</b> <br>  Der Datentyp VARCHAR2 gibt eine Zeichenfolge variabler L√§nge im Datenbankzeichensatz an.  Sie geben den Datenbankzeichensatz an, wenn Sie Ihre Datenbank erstellen.  Oracle speichert einen Zeichenwert in einer VARCHAR2-Spalte genau so, wie Sie ihn angegeben haben, ohne Leerzeichen, sofern der Wert die L√§nge der Spalte nicht √ºberschreitet. <br><br>  <b>NUMBER Datentyp</b> <br>  Der Datentyp NUMBER speichert null sowie positive und negative feste Zahlen mit absoluten Werten von 1,0 x 10-130 bis 1,0 x 10126. Wenn Sie einen arithmetischen Ausdruck angeben, dessen Wert einen absoluten Wert gr√∂√üer oder gleich 1,0 x hat 10126, dann gibt Oracle einen Fehler zur√ºck.  Jeder NUMBER-Wert ben√∂tigt 1 bis 22 Bytes.  Unter Ber√ºcksichtigung dessen kann die Spaltengr√∂√üe in Bytes f√ºr einen bestimmten numerischen Datenwert NUMBER (p), wobei p die Genauigkeit eines gegebenen Werts ist, unter Verwendung der folgenden Formel berechnet werden: <i>ROUND ((L√§nge (p) + s) / 2)) + 1</i> wobei s gleich Null ist, wenn die Zahl positiv ist, und s gleich 1 ist, wenn die Zahl negativ ist. <br><br>  Au√üerdem nehmen wir einen Auszug aus der Dokumentation zum Speichern von Nullwerten. <br><br>  Eine Null ist das Fehlen eines Wertes in einer Spalte.  Nullen zeigen fehlende, unbekannte oder nicht anwendbare Daten an.  Nullen werden in der Datenbank gespeichert, wenn sie zwischen Spalten mit Datenwerten liegen.  In diesen F√§llen ben√∂tigen sie 1 Byte, um die L√§nge der Spalte (Null) zu speichern.  Nachgestellte Nullen in einer Zeile erfordern keinen Speicherplatz, da ein neuer Zeilenkopf signalisiert, dass die verbleibenden Spalten in der vorherigen Zeile null sind.  Wenn beispielsweise die letzten drei Spalten einer Tabelle null sind, werden f√ºr diese Spalten keine Daten gespeichert. <br><br>  Basierend auf diesen Daten bauen wir Argumente auf.  Wir glauben, dass die Datenbank die Codierung AL32UTF8 verwendet.  In dieser Codierung belegen russische Buchstaben 2 Bytes. <br><br>  1) A und X, der Wert des Feldes a 'Y' ist 1 Byte, der Wert des Feldes x 'D' ist 2 Bytes <br>  2) B und Y, 'Vasya' im b-Wert wird durch Leerzeichen mit bis zu 10 Zeichen erg√§nzt und belegt 14 Bytes, 'Vasya' in d - ben√∂tigt 8 Bytes. <br>  3) C und K. Beide Felder sind NULL, danach gibt es signifikante Felder, sodass sie 1 Byte belegen. <br>  4) C und Z. Beide Felder sind NULL, aber das Z-Feld ist das letzte in der Tabelle, sodass es keinen Speicherplatz belegt (0 Byte).  Feld C nimmt 1 Byte ein. <br>  5) K und Z. √Ñhnlich wie im vorherigen Fall.  Der Wert im K-Feld betr√§gt 1 Byte in Z - 0. <br>  6) I und J. Gem√§√ü der Dokumentation ben√∂tigen beide Werte jeweils 2 Byte.  Wir betrachten die L√§nge gem√§√ü der Formel aus der Dokumentation: rund ((1 + 0) / 2) +1 = 1 + 1 = 2. <br>  7) J und X. Der Wert im Feld J ben√∂tigt 2 Bytes, der Wert im Feld X 2 Bytes. <br><br>  <b>Insgesamt sind die richtigen Optionen: C und K, I und J, J und X.</b> <br></div></div><br><br><h3>  Wie hoch wird der Clustering-Faktor des T_I-Index ungef√§hr sein? </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> t (i <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rownum</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> dual <span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> &lt;= <span class="hljs-number"><span class="hljs-number">10000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> t_i <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> t(i);</code> </pre><br><ul><li>  √úber Dutzende </li><li>  √úber Hunderte </li><li>  In der Gr√∂√üenordnung von Tausenden </li><li>  In der Gr√∂√üenordnung von Zehntausenden </li></ul><br><div class="spoiler">  <b class="spoiler_title">Die Antwort</b> <div class="spoiler_text">  Laut Oracle-Dokumentation (zitiert aus 12.1): <br><br>  Bei einem B-Tree-Index misst der Index-Clustering-Faktor die physische Gruppierung von Zeilen in Bezug auf einen Indexwert. <br><br>  Der Index-Clustering-Faktor hilft dem Optimierer bei der Entscheidung, ob ein Index-Scan oder ein vollst√§ndiger Tabellenscan f√ºr bestimmte Abfragen effizienter ist.  Ein niedriger Clustering-Faktor zeigt einen effizienten Index-Scan an. <br><br>  Ein Clustering-Faktor, der nahe an der Anzahl der Bl√∂cke in einer Tabelle liegt, gibt an, dass die Zeilen in den Tabellenbl√∂cken durch den Indexschl√ºssel physisch geordnet sind.  Wenn die Datenbank einen vollst√§ndigen Tabellenscan durchf√ºhrt, ruft die Datenbank die Zeilen ab, wenn sie auf der Festplatte gespeichert sind, sortiert nach dem Indexschl√ºssel.  Ein Clustering-Faktor, der nahe an der Anzahl der Zeilen liegt, zeigt an, dass die Zeilen in Bezug auf den Indexschl√ºssel zuf√§llig √ºber die Datenbankbl√∂cke verteilt sind.  Wenn die Datenbank einen vollst√§ndigen Tabellenscan durchf√ºhrt, ruft die Datenbank keine Zeilen in einer nach diesem Indexschl√ºssel sortierten Reihenfolge ab. <br><br>  In diesem Fall sind die Daten ideal sortiert, sodass der Clustering-Faktor gleich oder nahe an der Anzahl der belegten Bl√∂cke in der Tabelle liegt.  Bei einer Standardblockgr√∂√üe von 8 Kilobyte k√∂nnen Sie erwarten, dass ungef√§hr tausend enge Zahlenwerte in einen Block passen, sodass die Anzahl der Bl√∂cke und damit der Clustering-Faktor in der <b>Gr√∂√üenordnung von zehn liegt</b> . <br></div></div><br><h3>  Bei welchen Werten von N wird das folgende Skript erfolgreich in einer regul√§ren Datenbank mit Standardeinstellungen ausgef√ºhrt? </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> t ( a varchar2(N <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), b varchar2(N <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), c varchar2(N <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), d varchar2(N <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> t_i <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> t (a, b, c, d);</code> </pre><br><ul><li>  100 </li><li>  200 </li><li>  400 </li><li>  800 </li><li>  1600 </li><li>  3200 </li><li>  6400 </li></ul><br><div class="spoiler">  <b class="spoiler_title">Die Antwort</b> <div class="spoiler_text">  Laut Oracle-Dokumentation (zitiert aus 11.2): <br><br>  Logische Datenbankgrenzen <br><br><div class="scrollable-table"><table><thead><tr><td>  <strong>Artikel</strong> </td><td>  <strong>Art der Begrenzung</strong> </td><td>  <strong>Grenzwert</strong> </td></tr></thead><tbody><tr><td>  Indizes </td><td>  Gesamtgr√∂√üe der indizierten Spalte </td><td>  75% der Datenbankblockgr√∂√üe abz√ºglich eines gewissen Overheads </td></tr></tbody></table></div><br>  Daher sollte die Gesamtgr√∂√üe der indizierten Spalten 6 KB nicht √ºberschreiten.  Ferner h√§ngt es von der ausgew√§hlten Codierungsbasis ab.  Bei der AL32UTF8-Codierung kann ein Zeichen maximal 4 Byte belegen. Im schlimmsten Fall passen 6 Kilobyte auf etwa 1.500 Zeichen.  Daher verbietet Oracle die Erstellung eines Index bei N = 400 (wenn die Schl√ºssell√§nge im schlimmsten Fall 1600 Zeichen * 4 Byte + Zeilen-ID-L√§nge betr√§gt), w√§hrend die Erstellung des Index <b>bei N = 200 (oder weniger)</b> problemlos funktioniert. <br></div></div><br><h3>  Die INSERT-Anweisung mit dem APPEND-Hinweis dient zum Laden von Daten im direkten Modus.  Was passiert, wenn es auf die Tabelle angewendet wird, an der der Trigger h√§ngt? </h3><br><ul><li>  Die Daten werden im Direktmodus geladen, der Trigger funktioniert wie es sollte </li><li>  Daten werden im direkten Modus geladen, aber der Trigger wird nicht ausgef√ºhrt </li><li>  Die Daten werden im herk√∂mmlichen Modus geladen, der Trigger funktioniert wie gew√ºnscht </li><li>  Daten werden im herk√∂mmlichen Modus geladen, aber der Trigger wird nicht ausgef√ºhrt </li><li>  Daten werden nicht hochgeladen, Fehler behoben </li></ul><br><div class="spoiler">  <b class="spoiler_title">Die Antwort</b> <div class="spoiler_text">  Im Prinzip ist dies eher eine Frage der Logik.  Um die richtige Antwort zu finden, w√ºrde ich das folgende Argumentationsmodell vorschlagen: <br><br><ol><li>  Das Einf√ºgen im Direktmodus erfolgt durch direkte Bildung eines Datenblocks hinter der SQL-Engine, wodurch eine hohe Geschwindigkeit sichergestellt wird.  Daher ist es sehr schwierig, die Ausf√ºhrung des Triggers sicherzustellen, wenn dies √ºberhaupt m√∂glich ist, und dies macht keinen Sinn, da dies das Einf√ºgen ohnehin dramatisch verlangsamt. </li><li>  Wenn nicht ausgel√∂st wird, h√§ngt der Status der gesamten Datenbank (anderer Tabellen) bei gleichen Daten in der Tabelle davon ab, in welchen Modus die Daten eingef√ºgt werden.  Dies wird offensichtlich die Datenintegrit√§t zerst√∂ren und kann nicht als L√∂sung in der Produktion angewendet werden. </li><li>  Die Unf√§higkeit, die angeforderte Operation auszuf√ºhren, wird im Allgemeinen als Fehler behandelt.  Hierbei ist jedoch zu beachten, dass APPEND ein Hinweis ist und die allgemeine Logik von Hinweisen darin besteht, dass sie nach M√∂glichkeit ber√ºcksichtigt werden. Andernfalls wird der Operator ohne Ber√ºcksichtigung des Hinweises ausgef√ºhrt. </li></ol><br>  Die erwartete Antwort lautet daher, dass die <b>Daten im normalen (SQL) Modus geladen werden und der Trigger ausgel√∂st wird.</b> <br><br>  Laut Oracle-Dokumentation (zitiert ab 8.04): <br><br>  Verst√∂√üe gegen die Einschr√§nkungen f√ºhren dazu, dass die Anweisung unter Verwendung des herk√∂mmlichen Einf√ºgepfads ohne Warnungen oder Fehlermeldungen seriell ausgef√ºhrt wird.  Eine Ausnahme ist die Einschr√§nkung, dass Anweisungen in einer Transaktion mehrmals auf dieselbe Tabelle zugreifen, was zu Fehlermeldungen f√ºhren kann. <br>  Wenn beispielsweise Trigger oder referenzielle Integrit√§t in der Tabelle vorhanden sind, wird der APPEND-Hinweis ignoriert, wenn Sie versuchen, INSERT (seriell oder parallel) direkt zu laden, sowie gegebenenfalls den PARALLEL-Hinweis oder die PARALLEL-Klausel. </div></div><br><h3>  Was passiert beim Ausf√ºhren des folgenden Skripts? </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> t(i <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>, j <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> t); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trigger</span></span> t_a_i <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> <span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pragma</span></span> autonomous_transaction; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (:new.i + <span class="hljs-number"><span class="hljs-number">1</span></span>, :new.i); <span class="hljs-keyword"><span class="hljs-keyword">commit</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; / <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>);</code> </pre><br><ul><li>  Erfolgreiche Ausf√ºhrung </li><li>  Syntaxfehler fehlgeschlagen </li><li>  Ung√ºltiger Offline-Transaktionsfehler </li><li>  Fehler im Zusammenhang mit dem √úberschreiten der maximalen Anrufverschachtelung </li><li>  Fehler bei der Verletzung von Fremdschl√ºsseln </li><li>  Sperrfehler </li></ul><br><div class="spoiler">  <b class="spoiler_title">Die Antwort</b> <div class="spoiler_text">  Die Tabelle und der Trigger werden korrekt erstellt und dieser Vorgang sollte nicht zu Problemen f√ºhren.  Autonome Transaktionen im Trigger sind ebenfalls zul√§ssig, andernfalls w√§re beispielsweise eine Protokollierung nicht m√∂glich. <br><br>  Nach dem Einf√ºgen der ersten Zeile w√ºrde die erfolgreiche Operation des Triggers zum Einf√ºgen der zweiten Zeile f√ºhren, in Verbindung mit der der Trigger wieder funktionieren w√ºrde, die dritte Zeile einf√ºgen usw., bis die Anweisung aufgrund des √úberschreitens der maximalen Verschachtelung von Aufrufen abf√§llt.  Ein weiterer subtiler Punkt wird jedoch ausgel√∂st.  Zum Zeitpunkt der Ausf√ºhrung des Triggers wird das Commit f√ºr den ersten eingef√ºgten Datensatz noch nicht ausgef√ºhrt.  Daher versucht ein Trigger, der in einer autonomen Transaktion arbeitet, eine Zeile in die Tabelle einzuf√ºgen, die durch einen Fremdschl√ºssel auf einen Datensatz verweist, der noch nicht festgeschrieben wurde.  Dies f√ºhrt zu einer Wartezeit (eine autonome Transaktion wartet darauf, dass das Haupt-Commit versteht, ob Daten eingef√ºgt werden k√∂nnen), und gleichzeitig wartet die Haupttransaktion darauf, dass das autonome Commit nach dem Trigger weiter funktioniert.  <b>Ein Deadlock tritt auf und infolgedessen wird eine autonome Transaktion aus dem mit Sperren verbundenen Grund zur√ºckgeschickt</b> . <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de459680/">https://habr.com/ru/post/de459680/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de459662/index.html">PVS-Studio wollte, konnte aber keine Fehler in robots.txt finden</a></li>
<li><a href="../de459668/index.html">Erkennen von Text auf einem Foto: Neue Funktionen des Vision-Frameworks</a></li>
<li><a href="../de459670/index.html">Gehe nach Amsterdam</a></li>
<li><a href="../de459672/index.html">Unterstreichen Sie in Python</a></li>
<li><a href="../de459674/index.html">Threat Intelligence Epic Saga</a></li>
<li><a href="../de459682/index.html">Datenqualit√§t im Speicher</a></li>
<li><a href="../de459684/index.html">Karte der Moskauer U-Bahn und der ganzen Welt f√ºr Android</a></li>
<li><a href="../de459688/index.html">Urbanismus in China: Weniger Hipster, mehr Wissenschaft und IT</a></li>
<li><a href="../de459692/index.html">Wie wir Materialmodifikationen entdeckten, die etablierten chemischen Prinzipien widersprechen</a></li>
<li><a href="../de459694/index.html">Museum DataArt. Packen Sie Radio 86RK aus und starten Sie es</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>