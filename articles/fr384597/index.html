<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê∑ üèë üßëüèø‚Äçü§ù‚Äçüßëüèª Mesure de l'√©lectricit√©. Partie 1. Mesure de tension et de courant üö• üÜì üöë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="introduction
 Bonjour √† tous! Apr√®s la fin du cycle sur les capteurs, il a √©t√© question d'un plan diff√©rent pour mesurer les param√®tres de consommatio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mesure de l'√©lectricit√©. Partie 1. Mesure de tension et de courant</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/384597/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/4df/1f8/1cd/4df1f81cd86c4e2a8f5afa1441fb88e5.jpg" alt="image" align="left"></a><br>
<h4><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">introduction</font></font></b></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bonjour √† tous! </font><font style="vertical-align: inherit;">Apr√®s la fin du cycle sur les capteurs, il a √©t√© question d'un plan diff√©rent pour mesurer les param√®tres de consommation des appareils m√©nagers et peu √©lectriques. </font><font style="vertical-align: inherit;">Qui consomme combien, comment connecter quoi mesurer, quelles subtilit√©s se produisent, etc. </font><font style="vertical-align: inherit;">Il est temps de r√©v√©ler toutes les cartes de cette zone. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cette s√©rie d'articles, nous aborderons le sujet de la mesure des param√®tres de l'√©lectricit√©. </font><font style="vertical-align: inherit;">Ces param√®tres sont en fait un tr√®s grand nombre, que je vais essayer de raconter progressivement en petites s√©ries. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jusqu'√† pr√©sent, les plans sont en trois s√©ries:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mesure de l'√©lectricit√©. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La qualit√© de l'√©lectricit√©.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Appareils pour mesurer les param√®tres de l'√©lectricit√©.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le processus d'analyse, nous allons r√©soudre certains probl√®mes pratiques sur les microcontr√¥leurs jusqu'√† ce qu'un r√©sultat soit atteint. </font><font style="vertical-align: inherit;">Bien s√ªr, la majeure partie de ce cycle sera consacr√©e √† la mesure de la tension alternative et peut √™tre utile √† tous les ventilateurs pour contr√¥ler les appareils √©lectriques de leur maison intelligente. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la base des r√©sultats de l'ensemble du cycle, nous fabriquerons un certain compteur √©lectrique intelligent avec acc√®s Internet. </font><font style="vertical-align: inherit;">Des ventilateurs tr√®s connus pour contr√¥ler les appareils √©lectriques de leur maison intelligente peuvent apporter toute l'assistance possible dans la mise en ≈ìuvre de la partie communication sur la base, par exemple, de MajorDomo. </font><font style="vertical-align: inherit;">Faisons de OpenSource une maison intelligente meilleure, pour ainsi dire. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cette s√©rie en deux parties, nous aborderons les questions suivantes:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connexion de capteurs de courant et de tension dans des appareils CC, ainsi que des circuits CA monophas√©s et triphas√©s;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mesure des valeurs actuelles de courant et de tension;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mesure du facteur de puissance;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pleine puissance active et r√©active;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consommation d'√©nergie;</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par tacle, vous trouverez les r√©ponses aux deux premi√®res questions de cette liste. </font><font style="vertical-align: inherit;">Je n'ai pas d√©lib√©r√©ment abord√© les probl√®mes de pr√©cision des indicateurs de mesure et de cette s√©rie je ne suis satisfait que des r√©sultats obtenus avec une pr√©cision de plus ou moins de sabots. </font><font style="vertical-align: inherit;">Je consacrerai certainement un article s√©par√© √† cette question dans la troisi√®me s√©rie.</font></font><br>
<a name="habracut"></a><br>
<h4><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Connexion des capteurs</font></font></b></h4><br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/ueE-XPjVkRY%3Ffeature%3Doembed&amp;usg=ALkJrhgWbhGfOGki4JNoamIXPr2BbqbrAw" frameborder="0" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la derni√®re s√©rie sur les capteurs de tension et de courant, j'ai parl√© des types de capteurs, mais je n'ai pas expliqu√© comment les utiliser et o√π les placer. </font><font style="vertical-align: inherit;">Il est temps de le r√©parer</font></font><br>
<h5><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connexion de capteurs DC</font></font></b></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est clair que l'ensemble du cycle sera consacr√© aux syst√®mes √† courant alternatif, mais nous passerons √©galement rapidement en revue les circuits √† courant continu, car cela peut nous √™tre utile lors du d√©veloppement d'alimentations √† courant continu. Prenons, par exemple, un </font><i><font style="vertical-align: inherit;">convertisseur abaisseur </font></i></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PWM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> classique </font><font style="vertical-align: inherit;">: </font></font><br>
<img src="https://habrastorage.org/files/d35/255/0f2/d352550f2c04401ea57bcda120ee3790.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 1. Un convertisseur abaisseur PWM</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Notre objectif est de fournir une tension de sortie stable. De plus, sur la base des informations du capteur de courant, il est possible de contr√¥ler le mode de fonctionnement de l'inductance L1, en emp√™chant sa saturation, et √©galement de mettre en ≈ìuvre une protection en courant du convertisseur. Et franchement, il n'y a pas d'options particuli√®res pour installer des capteurs.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un capteur de tension sous la forme d'un diviseur r√©sistif R1-R2, qui est le seul capable de fonctionner en courant continu, est install√© en sortie du convertisseur. En r√®gle g√©n√©rale, un microcircuit de convertisseur sp√©cialis√© poss√®de une entr√©e de r√©troaction et met tout en ≈ìuvre pour garantir qu'√† cette entr√©e (3) il existe un certain niveau de tension prescrit dans la documentation du microcircuit. Par exemple, 1,25 V. Si notre tension de sortie correspond √† ce niveau - tout va bien - nous appliquons directement la tension de sortie √† cette entr√©e. Sinon, r√©glez le s√©parateur. Si nous devons fournir une tension de sortie de 5 V, le diviseur doit fournir un facteur de division de 4, c'est-√†-dire, par exemple, R1 = 30 k, R2 = 10 k.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un capteur de courant est g√©n√©ralement install√© entre la source d'alimentation et le convertisseur et sur la puce. A partir de la diff√©rence de potentiel entre les points 1 et 2, et avec une r√©sistance connue, les r√©sistances Rs peuvent d√©terminer la valeur actuelle du courant de notre inductance. L'installation d'un capteur de courant entre les sources et la charge n'est pas une bonne id√©e, car le condensateur de filtrage sera coup√© par la r√©sistance des consommateurs de courants puls√©s. L'installation d'une r√©sistance dans l'espace du fil commun ne promet √©galement rien de bon - il y aura deux niveaux de terre avec lesquels il est toujours amusant de jouer. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les probl√®mes de chute de tension peuvent √™tre √©vit√©s en utilisant des capteurs de courant sans contact - par exemple, des capteurs √† effet Hall: </font></font><br>
<img src="https://habrastorage.org/files/90c/b6b/1e2/90cb6b1e298b4d408bd27d971218781e.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 2. Capteur de courant sans contact</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, il existe un moyen plus d√©licat de mesurer le courant. Apr√®s tout, la tension chute √©galement sur le transistor et le m√™me courant circule que l'inductance qui le traverse. Par cons√©quent, par la chute de tension √† travers elle, vous pouvez √©galement d√©terminer la valeur actuelle du courant. Honn√™tement, si vous regardez la structure interne des circuits de conversion, par exemple de Texas Instruments, cette m√©thode se retrouve aussi souvent que les pr√©c√©dentes. La pr√©cision de cette m√©thode n'est certainement pas la plus √©lev√©e, mais cela suffit pour que la coupure actuelle fonctionne. </font></font><br>
<img src="https://habrastorage.org/files/2fd/ecb/bab/2fdecbbab26c483ea476483e32e2a0c9.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 3. Transistor comme capteur de courant Nous faisons de</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
m√™me dans d'autres circuits de convertisseurs similaires, qu'ils soient boosters ou inverseurs. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, il est n√©cessaire de mentionner s√©par√©ment les convertisseurs lin√©aires et flyback des transformateurs.</font></font><br>
<img src="https://habrastorage.org/files/1d7/ebd/4b1/1d7ebd4b13214a919014f35a8a672b24.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 4. Connexion des capteurs de courant dans les convertisseurs flyback</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ils peuvent √©galement utiliser soit une r√©sistance externe, soit un transistor dans son r√¥le. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec cela, nous avons connect√© les capteurs aux convertisseurs DC / DC. </font><font style="vertical-align: inherit;">Si vous avez des suggestions pour d'autres options, je serai heureux d'y ajouter un article.</font></font><br>
<h5><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.2 Connexion des capteurs aux circuits CA monophas√©s</font></font></b></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les circuits AC, nous avons une s√©lection beaucoup plus large de capteurs possibles. </font><font style="vertical-align: inherit;">Examinons plusieurs options. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le plus simple est l'utilisation d'un diviseur de tension r√©sistif et d'un shunt de courant. </font></font><br>
<img src="https://habrastorage.org/files/458/c52/e43/458c52e436ac451d96927f6d3a14d772.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 5. Connexion de capteurs √† r√©sistance,</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
mais elle pr√©sente quelques inconv√©nients importants:</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Premi√®rement, nous fournirons soit une amplitude significative du signal provenant du shunt actuel, en lui allouant une grande quantit√© d'√©nergie, soit nous serons satisfaits de la petite amplitude du signal et nous l'amplifierons ensuite. Et d'autre part, la r√©sistance cr√©e une diff√©rence de potentiel entre le neutre du r√©seau et le neutre de l'appareil. Si l'appareil est isol√©, peu importe, si l'appareil a une borne de mise √† la terre, nous risquons de rester sans signal du capteur de courant, car nous le court-circuiterons. Vous devriez peut-√™tre essayer des capteurs qui fonctionnent sur d'autres principes.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, nous utilisons des transformateurs de courant et de tension, ou un capteur de courant √† effet Hall et un transformateur de tension. </font><font style="vertical-align: inherit;">Ici, il y a beaucoup plus de possibilit√©s de travailler avec des √©quipements, car le fil neutre n'a pas de pertes, et surtout - dans les deux cas, il y a une isolation galvanique de l'√©quipement de mesure, ce qui peut souvent √™tre utile. </font><font style="vertical-align: inherit;">Cependant, il faut garder √† l'esprit que les capteurs de courant et de tension du transformateur ont une r√©ponse en fr√©quence limit√©e et si nous voulons mesurer la composition harmonique des distorsions, ce n'est pas un fait qui fonctionnera. </font></font><br>
<img src="https://habrastorage.org/files/b59/304/c28/b59304c2821d45ef87501f76acfa232a.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 6. Connexion du transformateur et des capteurs de courant et de tension sans contact</font></font></i><br>
<h5><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.3 Connexion de capteurs √† des circuits ca multiphas√©s</font></font></b></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les r√©seaux multiphasiques, notre capacit√© √† connecter des capteurs de courant est l√©g√®rement inf√©rieure. Cela est d√ª au fait que le shunt de courant ne peut pas √™tre utilis√© du tout, car la diff√©rence de potentiel entre les shunts de phase fluctuera √† des centaines de volts et je ne connais aucun contr√¥leur √† usage g√©n√©ral dont les entr√©es analogiques peuvent r√©sister √† une telle moquerie. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, il existe une fa√ßon d'utiliser les shunts de courant - pour chaque canal, il est n√©cessaire de faire une entr√©e analogique isol√©e galvaniquement. Mais il est beaucoup plus facile et plus fiable d'utiliser d'autres capteurs. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans mon analyseur de qualit√©, j'utilise des diviseurs de tension r√©sistifs et des capteurs de courant √† effet Hall √† distance. </font></font><br>
<img src="https://habrastorage.org/files/3e5/d90/547/3e5d90547af64b41a48bcfe42ee82429.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.7 Capteurs de courant dans un r√©seau triphas√©</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme le montre la figure, nous utilisons une connexion √† quatre fils. </font><font style="vertical-align: inherit;">Bien s√ªr, au lieu de capteurs de courant sur l'effet Hall, vous pouvez prendre des transformateurs de courant ou des boucles de Rogowski. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au lieu de diviseurs r√©sistifs, des transformateurs de tension peuvent √™tre utilis√©s, √† la fois pour un syst√®me √† quatre fils et √† trois fils. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce dernier cas, les enroulements primaires des transformateurs de tension sont reli√©s par un triangle, et le secondaire par une √©toile, dont le point commun est le point commun du circuit de mesure </font></font><br>
<img src="https://habrastorage.org/files/e4d/100/cf4/e4d100cf4d3048338dd15cacdb92a373.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 8. Utilisation de transformateurs de tension dans un r√©seau triphas√©</font></font></i><br>
<h4><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 Valeur actuelle de la tension et du courant</font></font></b></h4><br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/TOaW9xvr8NE%3Ffeature%3Doembed&amp;usg=ALkJrhhxR3qR2_41ES0Nx7DPLOCD_yJJ1g" frameborder="0" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le moment est venu de r√©soudre le probl√®me de la mesure de nos signaux. La signification pratique pour nous est principalement la valeur actuelle du courant et de la tension. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Permettez-moi de vous rappeler le mat√©riel du cycle du capteur. √Ä l'aide de l'ADC de notre microcontr√¥leur √† intervalles r√©guliers, nous fixerons la valeur de tension instantan√©e. Ainsi, pendant la p√©riode de mesure, nous aurons un tableau de donn√©es du niveau de la valeur de tension instantan√©e (pour le courant, tout est similaire). </font></font><br>
<img src="https://habrastorage.org/files/f70/ca7/063/f70ca706313a41a784c27c270cbd6eb2.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 9. Une s√©rie de valeurs de tension instantan√©es</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Notre t√¢che consiste √† calculer la valeur efficace. Pour commencer, nous utilisons la formule int√©grale: </font></font><br>
<img src="https://habrastorage.org/files/417/546/27d/41754627def647e89dce0c4037146eba.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans un syst√®me num√©rique, nous devons nous limiter √† un certain quantum temporel, nous allons donc √† la somme: </font></font><br>
<img src="https://habrastorage.org/files/17c/f0a/b23/17cf0ab2355a4a86a67504036f331c6b.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(2) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O√π </font></font><img src="https://habrastorage.org/files/c7c/ac5/dec/c7cac5dece7f4d03b262ad4c8ad30317.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est la p√©riode d'√©chantillonnage de notre signal, et</font></font><img src="https://habrastorage.org/files/289/63f/958/28963f958bf74b1888aeef21b047c567.gif"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- le nombre d'√©chantillons pour la p√©riode de mesure. Quelque part ici, dans une vid√©o, je commence √† frotter le jeu sur l'√©galit√© des zones. J'ai d√ª dormir ce jour-l√†. =) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les microcontr√¥leurs MSP430FE4252, qui sont utilis√©s dans les compteurs √©lectriques Mercury monophas√©s, 4096 relev√©s sont effectu√©s pour une p√©riode de mesure de 1, 2 ou 4 secondes. Sur T = 1s et N = 4096, nous nous appuierons plus loin. De plus, 4096 points par seconde nous permettront d'utiliser des algorithmes de transform√©e de Fourier rapides pour d√©terminer le spectre harmonique jusqu'√† 40 harmoniques, comme l'exige GOST. Mais plus √† ce sujet dans la prochaine s√©rie.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous d√©crivons l'algorithme de notre programme. Nous devons assurer un d√©marrage stable de l'ADC toutes les 1/8192 secondes, car nous avons deux canaux et nous mesurerons ces donn√©es en alternance. Pour ce faire, configurez la minuterie et le signal d'interruption red√©marrera automatiquement l'ADC. Tous les ADC le font. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous √©crirons le futur programme sur Arduino, comme beaucoup l'ont sous la main. Jusqu'√† pr√©sent, nous avons un int√©r√™t purement acad√©mique. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ayant une fr√©quence de quartz syst√®me de 16 MHz et une minuterie 8 bits (pour que la vie ne ressemble pas √† du miel), nous devons assurer la fr√©quence de fonctionnement de toute interruption de minuterie avec une fr√©quence de 8192 Hz. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sommes tristes du fait que 16 MHz n'est pas compl√®tement divis√© comme nous en avons besoin et que la fr√©quence finale de la minuterie est de 8198 Hz. Nous fermons les yeux sur une erreur de 0,04% et lisons encore 4096 √©chantillons par canal.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sommes tristes que l'interruption de d√©bordement dans arduino soit occup√©e √† calculer le temps (il est responsable des millis et du retard, donc cela cessera de fonctionner normalement), nous utilisons donc l'interruption en comparaison. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et nous r√©alisons soudain que le signal nous parvient bipolaire, et que msp430fe4252 s'en sort parfaitement. Nous nous contentons d'un ADC unipolaire, par cons√©quent, nous assemblons un simple convertisseur d'un signal bipolaire en un unipolaire sur un amplificateur op√©rationnel: </font></font><br>
<img src="https://habrastorage.org/files/18f/0dd/c20/18f0ddc202544b24be6d684ce9d98c23.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 10. Un convertisseur d'un signal bipolaire en unipolaire</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
De plus, notre t√¢che est de nous assurer que notre sinuso√Øde oscille par rapport √† la moiti√© de la tension de r√©f√©rence - alors nous allons soit soustraire la moiti√© de la plage ou activer l'option dans les param√®tres ADC et obtenez les valeurs des signes.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'Arduino a un ADC 10 bits, donc nous soustrayons la moiti√© du r√©sultat non sign√© dans 0-1023 et obtenons -512-511. Nous </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
v√©rifions le mod√®le assembl√© dans LTSpiceIV et nous assurons que tout fonctionne comme il se doit. </font><font style="vertical-align: inherit;">Dans le mat√©riel vid√©o, nous v√©rifions √©galement exp√©rimentalement. </font></font><br>
<img src="https://habrastorage.org/files/3de/320/1f6/3de3201f66f94937b29504236ded1044.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 11. R√©sultat de la simulation. </font><font style="vertical-align: inherit;">Le vert est le signal d'origine, le bleu est la sortie</font></font></i><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esquisse pour Arduino pour un canal</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span>
</span>{<font></font>
  autoadcsetup();<font></font>
  DDRD |=(<span class="hljs-number">1</span>&lt;&lt;PD2)|(<span class="hljs-number">1</span>&lt;&lt;PD3);<font></font>
  Serial.begin(<span class="hljs-number">38400</span>);<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">double</span> urms = <span class="hljs-number">0</span>;
<span class="hljs-keyword">double</span> utemp = <span class="hljs-number">0</span>;
<span class="hljs-keyword">int</span> umoment = <span class="hljs-number">0</span>;
<span class="hljs-keyword">int</span> N = <span class="hljs-number">0</span>;
<span class="hljs-keyword">int</span> flag = <span class="hljs-number">0</span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">if</span> (flag){<font></font>
    flag = <span class="hljs-number">0</span>;<font></font>
    Serial.println(urms);<font></font>
  }<font></font>
}<font></font>
<span class="hljs-keyword">int</span> i = <span class="hljs-number">255</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">autoadcsetup</span><span class="hljs-params">()</span></span>{
  <span class="hljs-comment">//set up TIMER0 to  4096Hz</span>
  <span class="hljs-comment">//TIMER0_OVF will be the trigger for ADC</span>
  <span class="hljs-comment">/*normal mode, prescaler 16
   16MHz / 64 / 61 = 4098 Hz 0.04% to 4096Hz*/</span>
  TCCR0B = (<span class="hljs-number">1</span> &lt;&lt; CS01)|(<span class="hljs-number">1</span> &lt;&lt; CS00);<span class="hljs-comment">//timer frequency = clk/64</span>
  OCR0A = <span class="hljs-number">60</span>;<span class="hljs-comment">//61-1</span>
  TIMSK0 = (<span class="hljs-number">1</span>&lt;&lt;OCIE0A);
  <span class="hljs-comment">//set ADC.</span>
  ADMUX =  (<span class="hljs-number">1</span> &lt;&lt; REFS0);<span class="hljs-comment">//8-bit mode, ADC0 channel, AVVCC as ref</span>
  ADCSRA = (<span class="hljs-number">1</span> &lt;&lt; ADEN) | (<span class="hljs-number">1</span> &lt;&lt; ADATE) | (<span class="hljs-number">1</span> &lt;&lt; ADIE) | (<span class="hljs-number">1</span> &lt;&lt; ADPS2);<span class="hljs-comment">//TUrn ADC On, trigger enable, Interrupt enable, sysclk/16=1MHz_ADC_clk=76kHz conv freq(13ticks per conversion)</span>
  ADCSRB = (<span class="hljs-number">1</span>&lt;&lt; ADTS1) | (<span class="hljs-number">1</span>&lt;&lt;ADTS0) | (<span class="hljs-number">1</span>&lt;&lt;MUX5);<span class="hljs-comment">//Auto trigger source</span><font></font>
}<font></font>
<font></font>
ISR(TIMER0_COMPA_vect){<font></font>
  <span class="hljs-keyword">if</span> (PIND &amp; (<span class="hljs-number">1</span>&lt;&lt;PD2)){<font></font>
    PORTD &amp;= ~(<span class="hljs-number">1</span>&lt;&lt;PD2);<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span>{<font></font>
    PORTD |=(<span class="hljs-number">1</span>&lt;&lt;PD2);<font></font>
  }<font></font>
  TCNT0 = <span class="hljs-number">0</span>;<font></font>
<font></font>
}<font></font>
<font></font>
<font></font>
ISR(ADC_vect){<font></font>
<font></font>
  <span class="hljs-keyword">if</span>( ( UCSR0A &amp; (<span class="hljs-number">1</span>&lt;&lt;UDRE0)) ){<font></font>
    umoment = ADCL;<span class="hljs-comment">//copy result.</span>
    umoment += (ADCH&lt;&lt;<span class="hljs-number">8</span>);<font></font>
    umoment = umoment - <span class="hljs-number">512</span>;<font></font>
    utemp = utemp + <span class="hljs-built_in">pow</span>((<span class="hljs-keyword">double</span>)(umoment),<span class="hljs-number">2</span>)/<span class="hljs-number">4096</span>;<font></font>
    N++;<font></font>
    <span class="hljs-keyword">if</span> (N == <span class="hljs-number">4095</span>){<font></font>
      urms = <span class="hljs-built_in">sqrt</span>(utemp)/<span class="hljs-number">102</span>;<font></font>
      N = <span class="hljs-number">0</span>;<font></font>
      utemp = <span class="hljs-number">0</span>;<font></font>
      flag = <span class="hljs-number">1</span>;
      <span class="hljs-keyword">if</span> (PIND &amp; (<span class="hljs-number">1</span>&lt;&lt;PD3)){<font></font>
        PORTD &amp;= ~(<span class="hljs-number">1</span>&lt;&lt;PD3);<font></font>
      }<font></font>
      <span class="hljs-keyword">else</span>{<font></font>
        PORTD |=(<span class="hljs-number">1</span>&lt;&lt;PD3);<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le programme est √©crit dans l'IDE Arduino pour le microcontr√¥leur ATmega1280. </font><font style="vertical-align: inherit;">Sur ma carte de d√©bogage, les 8 premiers canaux sont rout√©s pour les besoins internes de la carte, donc le canal ADC8 est utilis√©. </font><font style="vertical-align: inherit;">Il est possible d'utiliser ce croquis pour une carte avec ATmega168, cependant, vous devez s√©lectionner le canal correct. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä l'int√©rieur des interruptions, nous secouons quelques broches de service pour voir visuellement la fr√©quence de num√©risation de travail. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quelques mots sur l'origine du coefficient 102. Au premier d√©marrage, un signal d'amplitudes diff√©rentes a √©t√© fourni par le g√©n√©rateur, une indication de la valeur de tension effective a √©t√© lue sur l'oscilloscope et la valeur calcul√©e en unit√©s absolues de l'ADC a √©t√© prise √† partir de la console.</font></font><br>
<table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Umax, V</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Urms, In</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©nombr√©</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2,08</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">212</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2,5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,73</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">176</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,38</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">141</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,03</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">106</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,684</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">71</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,358</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">36</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,25</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,179</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dix-neuf</font></font></td>
</tr>
</tbody></table><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En divisant les valeurs de la troisi√®me colonne par les valeurs de la seconde, nous obtenons une moyenne de 102. Ce sera notre coefficient ¬´d'√©talonnage¬ª. Cependant, on peut noter que lorsque la tension diminue, la pr√©cision diminue fortement. Cela est d√ª √† la faible sensibilit√© de notre ADC. En fait, 10 d√©charges pour des calculs pr√©cis sont d√©sastreusement faibles et si la tension dans la prise peut √™tre mesur√©e de cette mani√®re, alors mettre un ADC 10 bits pour mesurer le courant consomm√© par la charge sera un crime contre la m√©trologie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä ce stade, nous nous arr√™terons. Dans la partie suivante, nous examinerons les trois autres questions de cette s√©rie et proc√©derons en douceur √† la cr√©ation de l'appareil lui-m√™me.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le firmware pr√©sent√©, ainsi que les autres firmware de cette s√©rie (puisque je filme du mat√©riel vid√©o plus vite que la pr√©paration d'articles), vous le trouverez dans le r√©f√©rentiel sur GitHub: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/radiolok/arduino_rms_count</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Quant au d√©veloppement du compteur √©lectrique, la r√©f√©rence de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TI SimpleLink WiFi CC3200</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sera prise comme base </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">SmartPlug</font></a><font style="vertical-align: inherit;"> , dont les nouvelles juste l'autre jour ont vol√© √† mon courrier. </font><font style="vertical-align: inherit;">J'aime vraiment le microcontr√¥leur CC3200, nous allons donc d√©velopper un booster pour le lunchpad existant et r√©aliser toutes les fonctionnalit√©s qui nous int√©ressent. </font><font style="vertical-align: inherit;">N'oubliez pas de le faire fonctionner si bien sur d'autres microcontr√¥leurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les commentaires sont invit√©s  </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">progchip666</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pour commentaires et ajouts au mat√©riel, ainsi que  </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">smart_alex</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comme pr√©c√©demment int√©ress√© √† mesurer le courant et la tension en utilisant Arduino.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr384597/">https://habr.com/ru/post/fr384597/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr384583/index.html">Les fans de "My Little Pony" collectent des fonds pour un jeu de combat bas√© sur la s√©rie anim√©e (mais avec de nouveaux personnages)</a></li>
<li><a href="../fr384585/index.html">Une histoire d√©taill√©e de l'√©chec de la pr√©occupation Volkswagen avec une contrefa√ßon de tests de respect de l'environnement</a></li>
<li><a href="../fr384589/index.html">Parler avec une ampoule - VOCCA Smart Cartridge Review</a></li>
<li><a href="../fr384593/index.html">[MISE √Ä JOUR ISS] √âclipse totale de Super Moon le 28 septembre</a></li>
<li><a href="../fr384595/index.html">Risque de rayonnement: r√©acteurs √† fission versus r√©acteurs √† fusion</a></li>
<li><a href="../fr384599/index.html">Pourquoi changer les ampoules en LED</a></li>
<li><a href="../fr384603/index.html">√âvaluation de Lima: service cloud personnel illimit√©</a></li>
<li><a href="../fr384605/index.html">Rendre un micro-ondes conventionnel plus intelligent avec IFTTT et OpenHAB</a></li>
<li><a href="../fr384607/index.html">Quelle est la forme d'Internet?</a></li>
<li><a href="../fr384611/index.html">Photos spatiales de la semaine (21/09/27/09)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>