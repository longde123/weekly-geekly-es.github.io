<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦍 ⏲️ 🗃️ Création d'une IA C # simple dans Unity 🤰🏾 🍿 🏇🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Presque tous les jeux nécessitent une intelligence artificielle (IA) qui interagit avec l'utilisateur, le plus souvent sous la forme d'une force hosti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Création d'une IA C # simple dans Unity</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419641/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f53/d1b/432/f53d1b43283124f71239cc56289eabfb.jpg" alt="image"></div><br>  Presque tous les jeux nécessitent une intelligence artificielle (IA) qui interagit avec l'utilisateur, le plus souvent sous la forme d'une force hostile au joueur.  Dans certains cas, l'IA devrait aider le joueur, dans d'autres, elle devrait le combattre, mais tous les personnages contrôlés par l'ordinateur ont des similitudes.  Selon les exigences du projet, l'IA peut utiliser des comportements simples ou complexes.  Ces exigences peuvent être la diplomatie avec un autre joueur ou une simple errance dans les deux sens sur la plate-forme.  Quoi qu'il en soit, il est nécessaire de s'assurer que l'IA fait son travail efficacement. <br><br>  Dans ce projet, je vais démontrer une intelligence artificielle très simple.  Supposons que nous créons un jeu dans lequel un joueur doit se faufiler près du quartier général ennemi.  Lorsqu'un joueur est remarqué par une caméra de sécurité, des ennemis sont créés à proximité et pour une courte période, poursuivez le joueur.  C'est ce que nous mettons en œuvre dans le projet au niveau le plus simple.  À la fin du projet, vous recevrez un objet de joueur contrôlé, un cercle utilisé comme caméra d'un ennemi et un objet ennemi qui poursuivra le joueur lorsque l'objet de la caméra informe de sa présence. <br><a name="habracut"></a><br><h2>  La préparation </h2><br>  Nous devons d'abord créer un projet 3D.  Cliquez sur le bouton <em>Nouveau</em> en haut de la fenêtre après avoir démarré Unity, comme illustré à la figure 1. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c16/bbf/df1/c16bbfdf150bec53113bc7955f901e64.jpg"></div><br>  <i>Figure 1: création d'un nouveau projet</i> <br><br>  Nommez votre projet <em>AI</em> et assurez-vous qu'il s'agit d'un projet 3D.  Après avoir choisi un emplacement sur l'ordinateur pour stocker le projet, cliquez sur le bouton <em>Créer un projet</em> en bas, illustré à la figure 2. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a3b/f46/c21/a3bf46c21915b44510b6052688e4f3c0.jpg"></div><br>  <i>Figure 2: écran de configuration du projet</i> <br><br>  Après avoir créé le projet, la première chose que nous devons faire est de configurer les dossiers dans la fenêtre <em>Actifs</em> pour organiser notre travail.  Cliquez avec le bouton droit sur la fenêtre <em>Actifs</em> et sélectionnez <em>Créer → Dossier</em> pour créer un nouveau dossier.  Nommez ce dossier <em>Matériaux</em> .  Créez ensuite un deuxième dossier et nommez-le <em>Scripts</em> .  La figure 3 montre à quoi cela devrait ressembler. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/db9/68a/709/db968a709778fc5f679ea8dcfd525222.jpg"></div><br>  <i>Figure 3: création d'un nouveau dossier</i> <br><br>  Après tout cela, la fenêtre <em>Actifs</em> devrait ressembler à celle illustrée à la figure 4. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ed8/a95/6f8/ed8a956f80044386ef356d0877931184.jpg"></div><br>  <i>Figure 4: fenêtre <em>Actifs</em> .</i> <br><br>  Ensuite, créez un sol sur lequel tous les objets se poseront.  Dans la fenêtre <em>Hiérarchie</em> , sélectionnez <em>Créer → Objet 3D → Plan</em> pour créer un objet plan qui sera utilisé comme sol. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e95/770/adc/e95770adc4bcf7c49f6398634cfb7dcc.jpg"></div><br>  <i>Figure 5: Création d'un objet plan.</i> <br><br>  Nommez cet objet <em>Floor</em> et changez sa valeur <em>X Scale</em> en 7, et la valeur <em>Z Scale</em> en 3. Après cela, la fenêtre <em>Inspector</em> avec l'objet <em>Floor</em> sélectionné devrait ressembler à la figure 6. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/428/36f/88a/42836f88a4e028e07aa3d8d63e8c90c6.jpg"></div><br>  <i>Figure 6: Définition des propriétés de l'objet <em>Floor</em> .</i> <br><br>  Maintenant, nous devons créer un nouveau matériau pour <em>Floor</em> afin de le distinguer du reste des objets qui seront placés dans la scène.  Dans le dossier <em>Matériaux</em> de la fenêtre <em>Actifs</em> , créez un nouveau matériau en cliquant avec le bouton droit sur la fenêtre <em>Actifs</em> et en choisissant <em>Créer → Matériau</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/790/e22/47c/790e2247cd0c57040bc20f46d2df93d0.jpg"></div><br>  <i>Figure 7: création d'un nouveau matériau</i> <br><br>  Une fois terminé, nommez le matériau <em>Floor</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb7/3fc/092/bb73fc09241585429e335997e0cc0ac4.jpg"></div><br>  <i>Figure 8: Matériau du <em>sol</em> .</i> <br><br>  En haut de la fenêtre <em>Inspecteur</em> avec <em>Plancher</em> sélectionné, sélectionnez un sélecteur de couleurs. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a98/e7e/211/a98e7e21145de32f77d8ba0346f36587.jpg"></div><br>  Figure 9: choix d'un sélecteur de couleurs. <br><br>  Bien sûr, vous pouvez choisir n'importe quelle couleur pour le sol, mais dans cet exemple, j'ai choisi le rouge-brun, comme le montre la figure 10. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ec/bed/360/3ecbed3607552e16d2dc9973c35cdceb.jpg"></div><br>  Figure 10: sélecteur de couleurs. <br><br>  Sélectionnez l'objet <em>Floor</em> dans la fenêtre <em>Hiérarchie</em> et dans le composant <em>Mesh Renderer</em> , sélectionnez la petite flèche en regard de <em>Matériaux</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/061/3f6/545/0613f6545880f95c917b481336c2589a.jpg"></div><br>  <i>Figure 11: Préparation d'un changement important.</i> <br><br>  Faites glisser le matériau <em>Floor</em> depuis la fenêtre <em>Assets</em> vers le champ <em>Element 0</em> du composant <em>Mesh Renderer</em> dans la fenêtre <em>Inspector</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e7d/3fe/247/e7d3fe24725c026b1d95f823ecd6832c.jpg"></div><br>  <i>Figure 12: Définition du matériau <em>Floor</em> comme matériau de l'objet <em>Floor</em> .</i> <br><br>  Après avoir terminé avec l'objet <em>Floor</em> , nous devons créer autour de la zone du mur afin que le joueur ne puisse pas tomber du bord.  Revenez à <em>Créer → Objet 3D → Plan</em> pour créer un nouveau plan.  Nous appelons ce plan de <em>mur</em> et le définissons aux mêmes dimensions que le <em>sol</em> , c'est-à-dire l' <em>échelle X</em> avec une valeur de 7 et l' <em>échelle Z</em> avec une valeur de 3. Ensuite, créez trois autres murs, sélectionnez un objet et appuyez trois fois sur Ctrl + D. Ensuite, placez les murs autour selon les données du tableau. <br><br><table><tbody><tr><td>  <strong>Le titre</strong> <br></td><td>  <strong>Position X</strong> <br></td><td>  <strong>Position Y</strong> <br></td><td>  <strong>Position z</strong> <br></td><td>  <strong>Rotation x</strong> <br></td><td>  <strong>Rotation z</strong> <br></td></tr><tr><td>  Mur <br></td><td>  -35 <br></td><td>  21 <br></td><td>  0 <br></td><td>  0 <br></td><td>  -90 <br></td></tr><tr><td>  Mur (1) </td><td>  -1 <br></td><td>  11 <br></td><td>  -15 <br></td><td>  90 <br></td><td>  0 <br></td></tr><tr><td>  Mur (2) <br></td><td>  -1 <br></td><td>  11 <br></td><td>  13,5 <br></td><td>  -90 <br></td><td>  0 <br></td></tr><tr><td>  Mur (3) <br></td><td>  34 <br></td><td>  21 <br></td><td>  0 <br></td><td>  0 <br></td><td>  90 </td></tr></tbody></table><br>  Tableau 1: Positions et rotations de tous les objets <em>Mur</em> . <br><br>  Après avoir terminé tout cela, vous devez changer la position de la caméra afin qu'elle regarde le sol par le haut.  Sélectionnez l'objet <em>Caméra principale</em> et définissez <em>Position Y</em> sur 30, <em>Position Z</em> sur 0 et <em>Rotation X</em> sur 80. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e3b/794/765/e3b794765d6fcb079014a487f435bf24.jpg"></div><br>  <i>Figure 13: configuration de l'objet caméra.</i> <br><br>  La scène est préparée, il est donc temps de créer le personnage du joueur.  Dans la fenêtre <em>Hiérarchie</em> , cliquez sur <em>Créer → Objet 3D → Sphère</em> pour créer un objet sphère.  Nommez cet objet <em>Player</em> , puis cliquez sur le bouton <em>Ajouter un composant</em> en bas de la fenêtre <em>Inspecteur</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/247/713/079/24771307910b2c0aaf9f19d2c74b6d9a.jpg"></div><br>  <i>Figure 14: ajout d'un nouveau composant.</i> <br><br>  Maintenant, trouvez le <em>Rigidbody</em> .  Après cela, sélectionnez le composant <em>Rigidbody</em> dans la liste et ajoutez le <em>Rigidbody</em> à l'objet <em>Player</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f3f/01e/f41/f3f01ef412da352b4131c02be07535df.jpg"></div><br>  <i>Figure 15: ajout d'un composant <em>Rigidbody</em> .</i> <br><br>  Ensuite, vous devez attribuer au joueur un tag, qui nous sera plus tard utile dans le code.  Cliquez sur le menu déroulant <em>Tag</em> dans le coin supérieur gauche de la fenêtre <em>Inspecteur</em> et sélectionnez la balise <em>Player</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c35/764/224/c35764224a4bb55b3e725c29aa597e19.jpg"></div><br>  <i>Figure 16: Définition d'une nouvelle balise.</i> <br><br>  Nous devons définir la position du joueur afin qu'il ne se trouve pas sous l'objet <em>Floor</em> .  Dans l'exemple, j'ai placé le joueur dans le coin supérieur gauche avec une <em>position X</em> égale à 26, une <em>position Y</em> égale à 1 et une <em>position Z</em> égale à -9. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b0/a09/4bf/2b0a094bf170d2d2fb3bb11fd54a5ab1.jpg"></div><br>  <i>Figure 17: placement du joueur.</i> <br><br>  Pour que notre futur code fonctionne correctement, nous devons, bien sûr, l'attacher à l'objet.  Revenez à la fenêtre <em>Hiérarchie</em> et sélectionnez cette fois <em>Créer → Objet 3D → Cube</em> .  Appelez ce cube <em>Guard</em> , ajoutez-y le composant <em>Rigidbody</em> et le composant <em>NavMesh Agent</em> à l'aide du bouton <em>Ajouter un composant</em> dans la fenêtre <em>Inspecteur</em> .  Ensuite, placez-le quelque part dans le coin supérieur gauche de la scène.  Après cela, la fenêtre <em>Inspecteur</em> de l'objet <em>Guard</em> ressemblera à ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/698/d9e/79d/698d9e79d24de65f2586482ed3ffa03b.jpg"></div><br>  <i>Figure 18: Objet de <em>garde</em> dans la fenêtre <em>Inspecteur</em> .</i> <br><br>  Et cet objet doit être situé comme ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/873/202/f6c/873202f6c470ad2b5b2233dd2fbe7a7f.jpg"></div><br>  <i>Figure 19: Placement de l'objet <em>Guard</em> .</i> <br><br>  Enfin, nous avons besoin d'un objet utilisé comme «œil» de l'objet <em>Guard</em> , qui informera le <em>Guard</em> que le joueur le touche.  Pour la dernière fois, allez dans la fenêtre <em>Hiérarchie</em> et sélectionnez <em>Créer → Objet 3D → Sphère</em> pour créer un autre objet sphère.  Nommez cet objet <em>Looker</em> .  Cette fois, nous n'avons pas besoin d'y ajouter d'autres composants.  Cependant, nous allons redimensionner l'objet.  Après avoir choisi <em>Looker</em> , modifiez les variables de composant <em>Transform</em> suivantes dans la fenêtre <em>Inspector</em> . <br><br><ul><li>  <em>Échelle X</em> à 9. </li><li>  <em>Échelle Y</em> à 0,5. </li><li>  <em>Échelle Z</em> à 9. </li></ul><br>  Après cela, positionnez le <em>Looker de</em> manière à ce qu'il soit situé dans la partie supérieure centrale du sol, comme illustré à la figure 20. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/021/427/aea/021427aea8c433f0d4beb49dcacf75ac.jpg"></div><br>  <i>Figure 20: Emplacement du Looker.</i> <br><br>  C'est le bon moment pour donner à <em>Looker un</em> matériau unique afin que vous puissiez voir qu'il vaut la peine d'être évité.  Dans le dossier <em>Matériaux</em> de la fenêtre <em>Actifs</em> , cliquez avec le bouton droit et créez un nouveau matériau.  Nommez-le <em>Looker</em> et donnez-lui une couleur rouge vif.  Après cela, désignez ce matériau comme le matériau de l'objet <em>Looker</em> pour changer sa couleur.  Après cela, la scène devrait ressembler à ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fd4/252/185/fd42521851c8f10540156ddd8678ce21.jpg"></div><br>  <i>Figure 21: objet <em>Looker</em> avec un nouveau matériau.</i> <br><br>  Il ne nous reste plus qu'à créer un maillage de navigation pour la <em>Garde</em> , sur lequel il pourra se déplacer.  Il y a un menu <em>Fenêtre</em> en haut de l'éditeur Unity.  Choisissez <em>Fenêtre → Navigation</em> pour ouvrir la fenêtre de <em>navigation</em> illustrée à la figure 22. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc8/f06/7b1/dc8f067b1f605af22531520c1de2f28f.jpg"></div><br>  <i>Figure 22: Fenêtre de <em>navigation</em> .</i> <br><br>  Sélectionnez l'objet <em>Floor</em> dans la <em>hiérarchie</em> , puis dans la fenêtre <em>Navigation</em> , cochez la case <em>Navigation Static</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f67/62e/b41/f6762eb4161c64a5388901e73909f1fc.jpg"></div><br>  <i>Figure 23: <em>Navigation statique</em> .</i> <br><br>  Ensuite, sélectionnez l'option <em>Bake</em> en haut de la fenêtre. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/025/7d0/dce/0257d0dce38af90396512cb4bd205316.jpg"></div><br>  <i>Figure 24: Basculez vers le menu <em>Bake</em> .</i> <br><br>  Le menu <em>Bake</em> s'ouvre, dans lequel vous pouvez modifier les propriétés du maillage de navigation que nous allons créer.  Dans notre exemple, rien ne doit être changé.  Cliquez simplement sur le bouton <em>Bake</em> en bas à droite. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ddd/ec7/6b8/dddec76b89364a5f66168b3cbd0c6fbb.jpg"></div><br>  <i>Figure 25: création d'un nouveau maillage de navigation.</i> <br><br>  À ce stade, Unity vous demandera de sauvegarder la scène.  Enregistrez-le, après quoi un maillage de navigation sera créé.  Maintenant, la scène ressemblera à ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f53/d1b/432/f53d1b43283124f71239cc56289eabfb.jpg"></div><br>  <i>Figure 26: La scène actuelle avec le maillage de navigation ajouté.</i> <br><br>  Maintenant, tout dans Unity est configuré, il est donc temps de créer les scripts nécessaires au fonctionnement du projet.  Dans la fenêtre <em>Actifs</em> , cliquez avec le bouton droit et sélectionnez <em>Créer → Script C #</em> .  Nommez ce script <em>Player</em> .  Répétez cette opération deux fois de plus, en créant des scripts avec les noms <em>Guard</em> et <em>Looker</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/12e/fb2/26b/12efb226b1de229b7c9b13eb69f0f483.jpg"></div><br>  <i>Figure 27: création d'un nouveau script.</i> <br><br>  Après cela, le dossier <em>Scripts</em> dans la fenêtre <em>Actifs</em> ressemblera à ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e7d/a2f/2a5/e7da2f2a5c94ee8683aed4179721e9bb.jpg"></div><br>  <i>Figure 28: dossier <em>Scripts</em> .</i> <br><br>  Tout d'abord, nous allons commencer à écrire le code du script <em>Player</em> .  Double-cliquez sur le script <em>Player</em> dans la fenêtre <em>Actifs</em> pour ouvrir Visual Studio et commencer à créer le code. <br><br><h2>  Code </h2><br>  Le script <em>Player</em> est assez simple, il ne fait que déplacer l’objet balle.  Sous la déclaration de classe, nous devons obtenir un lien vers le composant <em>Rigidbody</em> que nous avons précédemment créé dans le projet. <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Rigidbody rb;</code> </pre> <br>  Juste après cela, dans la fonction <strong>Démarrer</strong> , nous commandons à Unity de définir le composant <em>Rigidbody</em> actuel de l'objet <em>Player</em> sur <em>rb</em> . <br><br><pre> <code class="cs hljs">rb = GetComponent&lt;Rigidbody&gt;();</code> </pre> <br>  Après cela, le script <em>Player</em> ressemblera à ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/017/686/297/017686297368cffbd3ea3980b6036181.jpg"></div><br>  <i>Figure 29: Script du <em>joueur</em> pour le moment.</i> <br><br>  Maintenant que la valeur <em>rb</em> est affectée, nous devons laisser bouger l'objet <em>Player</em> lorsque nous appuyons sur les touches fléchées.  Pour déplacer l'objet, nous utiliserons la physique, en appliquant une force à l'objet lorsque l'utilisateur appuie sur les touches fléchées.  Pour ce faire, ajoutez simplement le code suivant à la fonction de <em>mise</em> à <em>jour</em> : <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKey(KeyCode.UpArrow)) rb.AddForce(Vector3.forward * <span class="hljs-number"><span class="hljs-number">20</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKey(KeyCode.DownArrow)) rb.AddForce(Vector3.back * <span class="hljs-number"><span class="hljs-number">20</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKey(KeyCode.LeftArrow)) rb.AddForce(Vector3.left * <span class="hljs-number"><span class="hljs-number">20</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKey(KeyCode.RightArrow)) rb.AddForce(Vector3.right * <span class="hljs-number"><span class="hljs-number">20</span></span>);</code> </pre> <br>  Avec cela, nous avons terminé le script <em>Player</em> .  Le script terminé ressemblera à ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3cf/82e/fc6/3cf82efc6aaef7dc0e7c8c6f21b503ff.jpg"></div><br>  <i>Figure 30: le script <em>Player</em> terminé.</i> <br><br>  Enregistrez votre travail et revenez à Unity.  Cette fois, sélectionnez le script <em>Guard</em> dans la fenêtre <em>Actifs</em> .  Pour que le code <em>Guard</em> fonctionne, vous devez ajouter la construction using en haut du script. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine.AI;</code> </pre> <br>  Ensuite, déclarez les variables suivantes immédiatement après la déclaration de classe. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject player; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> NavMeshAgent navmesh;</code> </pre> <br>  L'objet <strong>Player</strong> est utilisé comme valeur de la variable <strong>player</strong> de l'objet <em>Guard</em> .  Cela vous sera utile plus tard lorsque nous ordonnerons à l'objet <em>Garde</em> de poursuivre le joueur.  Ensuite, la variable <strong>navmesh</strong> est <strong>déclarée</strong> pour recevoir le composant <em>NavMeshAgent</em> de l'objet.  Nous l'utiliserons plus tard lorsque le <em>garde</em> commencera à chasser le joueur après avoir appris que le joueur touche l'objet <em>Looker</em> .  Dans la fonction <strong>Démarrer</strong> , nous devons définir la valeur de la variable <em>navmesh sur le</em> composant <em>NavMesh Agent de l'</em> objet: <br><br><pre> <code class="cs hljs">navmesh = GetComponent&lt;NavMeshAgent&gt;();</code> </pre> <br>  Ensuite, dans la fonction <em>Update</em> , nous ajoutons une seule ligne de code: <br><br><pre> <code class="cs hljs">navmesh.destination = player.transform.position;</code> </pre> <br>  Cette ligne définit la destination de l'objet <em>Guard</em> .  Dans notre cas, il prendra la position actuelle de l'objet <em>Player</em> et se déplacera jusqu'à ce point.  Après l'opération, l'objet poursuivra constamment le joueur.  La question est de savoir comment se déroule le processus de réponse?  Il ne sera pas encodé dans le script <em>Guard</em> , mais dans le script <em>Looker</em> .  Avant de passer au script Looker, consultez la figure 31 pour vérifier le code de votre script <em>Guard</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dfb/412/a11/dfb412a11448f070d31932d6c9e4c6c1.jpg"></div><br>  <i>Figure 31: le script <em>Guard</em> terminé.</i> <br><br>  Dans <em>Looker,</em> nous devons à nouveau déclarer les variables suivantes: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject guard; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> reset = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> movingDown;</code> </pre> <br>  Après cela, nous commentons la fonction <em>Démarrer</em> , dont nous n'avons pas besoin dans ce script.  Passons à la fonction de <em>mise</em> à <em>jour</em> et ajoutons le code suivant: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (movingDown == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) transform.position -= <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.1f</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> transform.position += <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.1f</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (transform.position.z &gt; <span class="hljs-number"><span class="hljs-number">10</span></span>) movingDown = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (transform.position.z &lt; <span class="hljs-number"><span class="hljs-number">-10</span></span>) movingDown = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; reset -= Time.deltaTime; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reset &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { guard.GetComponent&lt;Guard&gt;().enabled = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; GetComponent&lt;SphereCollider&gt;().enabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br>  C'est là que se déroulent les principales actions du projet, analysons donc le code.  Premièrement, selon la valeur de la variable booléenne <strong>movingDown</strong> , l'objet auquel ce script est attaché se déplacera vers le haut ou vers le bas.  Dès qu'il atteint un certain point, il change de direction.  Ensuite, <em>Looker</em> réduira la valeur de réinitialisation en fonction du temps réel.  Dès que le chronomètre devient inférieur à zéro, il prendra le script <em>Guard</em> de l'objet <em>Guard</em> et le désactivera, après quoi l'objet <em>Guard</em> commencera à se déplacer vers la dernière position connue du joueur jusqu'à ce moment, puis s'arrêtera.  <em>Looker rallume</em> également son collisionneur pour que l'ensemble du processus puisse recommencer.  Maintenant, notre script ressemble à ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ac9/dfc/7ec/ac9dfc7ec347c3422151e55b43682c3e.jpg"></div><br>  <i>Figure 32: script <em>Looker</em> .</i> <br><br>  En parlant de collisionneurs: il est temps de créer un code de conflit qui réinitialise le minuteur <em>Looker</em> et inclut le script <em>Guard</em> .  Dans la fonction de <em>mise à jour</em> , créez le code suivant: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnCollisionEnter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Collision collision</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (collision.gameObject.tag == <span class="hljs-string"><span class="hljs-string">"Player"</span></span>) { guard.GetComponent&lt;Guard&gt;().enabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; reset = <span class="hljs-number"><span class="hljs-number">5</span></span>; GetComponent&lt;SphereCollider&gt;().enabled = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }</code> </pre> <br>  <em>OnCollisionEnter</em> Unity le reconnaît automatiquement comme un code de collision et l'exécute donc lorsqu'une collision se produit avec un autre objet.  Dans notre cas, il vérifie d'abord si l'objet entrant en collision a une balise <em>Player</em> .  Sinon, il ignore le reste du code.  Sinon, il active le script <em>Guard</em> , définit le <em>délai de réinitialisation</em> sur 5 (c'est-à-dire cinq secondes) et désactive son collisionneur afin que le joueur puisse toujours se déplacer dans l'objet et ne pas se coincer accidentellement dans l'objet <em>Looker</em> .  La fonction est illustrée à la figure 33. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5ad/11c/5ce/5ad11c5cee401f612207f76322f6afc1.jpg"></div><br>  <i>Figure 33: Code de collision pour</i> Looker. <br><br>  C'est tout le code du projet est prêt!  Vous pouvez faire quelques autres choses avant de terminer le projet.  Enregistrez tout le travail et revenez à Unity. <br><br><h2>  Achèvement du projet </h2><br>  Pour terminer le projet, nous avons juste besoin d'attacher des scripts aux objets correspondants et de définir plusieurs variables.  Tout d'abord, passez de la fenêtre <em>Navigation</em> à la fenêtre <em>Inspecteur</em> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5b1/4a4/a83/5b14a4a8305887f6ce685516c0490724.jpg"></div><br>  <i>Figure 34: transition vers la fenêtre</i> Inspecteur. <br><br>  Après cela, commençons par l'objet <em>Player</em> .  Sélectionnez-le dans la fenêtre <em>Hiérarchie</em> , puis en bas de la fenêtre <em>Inspecteur</em> , cliquez sur le bouton <em>Ajouter un composant</em> et ajoutez le script <em>Player</em> .  Ceci termine l'objet <em>Player</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d03/fb6/745/d03fb67452e138ccd4a2b3a838e53615.jpg"></div><br>  <i>Figure 35: Composant de script du lecteur</i> . <br><br>  Ensuite, sélectionnez l'objet <em>Guard</em> .  Comme précédemment, attachez le script <em>Guard</em> à l'objet.  Cette fois, nous devons dire au <em>garde</em> qui est le joueur.  Pour ce faire, faites glisser l'objet <em>Player</em> de la <em>hiérarchie</em> vers le champ <em>Player</em> du composant de script <em>Guard</em> , comme illustré à la figure 36. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fae/14a/6f7/fae14a6f76221641adcdeca2d5993f84.jpg"></div><br>  <i>Figure 36: Faire de l'objet <em>Player</em> la valeur du champ <em>Player</em> .</i> <br><br>  Nous devons également désactiver le script <em>Guard</em> .  Dans notre projet, <em>Guard</em> poursuivra le joueur après avoir activé son script.  Ce script de <em>garde</em> ne doit être inclus qu'après que le joueur a <em>touché l'</em> objet <em>Looker</em> .  Il vous suffit de décocher la case à côté du texte <em>Guard (Script)</em> dans le composant: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ed2/ee4/093/ed2ee40931919ee69fa013f005e4a8b5.jpg"></div><br>  <i>Figure 37: Désactivation du script <em>Guard</em> .</i> <br><br>  Enfin, passons à l'objet <em>Looker</em> et y attachons le script <em>Looker</em> .  Cette fois, l'objet <em>Looker</em> aura besoin d'un objet <em>Guard</em> comme valeur de sa variable <em>Guard</em> .  Tout comme nous avons affecté l'objet <em>Player</em> à la variable <em>Player</em> du script <em>Guard</em> , nous ferons de même avec l'objet <em>Guard</em> et le script <em>Looker</em> .  Faites glisser la <em>Garde</em> de la <em>Hiérarchie</em> dans le champ <em>Garde</em> du script <em>Looker</em> .  Et le projet est terminé!  Cliquez sur le bouton Lecture en haut de l'éditeur Unity pour tester votre projet. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d5b/272/4ed/d5b2724edf53e1bc2e2c06951ef38cdc.jpg"></div><br>  <i>Figure 38: Test d'un projet.</i> <br><br>  Essayez de déplacer l'objet <em>Player</em> vers l'objet <em>Looker</em> (rappelez-vous que le déplacement se fait avec des flèches!).  Notez qu'après cela, l'objet <em>Guard</em> commencera à chasser le joueur.  Il poursuivra la poursuite pendant environ 5 secondes, après quoi il abandonnera. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bf2/4ba/729/bf24ba729b9457d0c038c4c50c5464a1.jpg"></div><br>  <i>Figure 39: Un projet entièrement achevé en action.</i> <br><br><h2>  Conclusion </h2><br>  Cette IA est très simple, mais elle peut facilement être étendue.  Supposons que si nous imaginons que l'objet <em>Looker</em> est une caméra et que le garde regarde à travers lui pour vous trouver, il sera logique de donner à l'objet <em>Guard</em> sa propre paire d'yeux.  Le joueur peut s'approcher des caméras, mais elles doivent tenir compte des yeux du gardien.  Vous pouvez également combiner ce projet avec le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">concept de trouver le chemin</a> : donner au gardien le chemin qu'il suivra, créant ainsi un environnement plus intéressant pour le joueur. <br><br>  Une IA aussi simple peut être développée de différentes manières.  Vous ne voudrez peut-être rien faire de ce qui précède et décider de faire quelque chose de votre choix.  Je vous conseille d'expérimenter, peut-être aurez-vous l'idée d'un projet intéressant, qui mérite d'être mené à terme. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr419641/">https://habr.com/ru/post/fr419641/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr419625/index.html">Aperçu de mes fonctionnalités PHP7 préférées</a></li>
<li><a href="../fr419627/index.html">Nous recherchons des conférenciers à Moscou Data Science Major</a></li>
<li><a href="../fr419633/index.html">Maintenant, toutes les principales listes de certificats racine sont approuvées par Let's Encrypt</a></li>
<li><a href="../fr419635/index.html">Sortie de la version stable de Dart 2.0 et Dart Web Platform</a></li>
<li><a href="../fr419637/index.html">[Français] Comment Graal - Java JVM JVM Compiler Works</a></li>
<li><a href="../fr419643/index.html">Conférence de Minsk EPAM sur l'ingénierie logicielle: Make it Real</a></li>
<li><a href="../fr419647/index.html">Séminaire «Black Friday dans le commerce électronique. Secrets of Survival, 16 août, Moscou</a></li>
<li><a href="../fr419649/index.html">Un peu sur les chats, ou quel CAT nous avons choisi pour les podcasts de synchronisation</a></li>
<li><a href="../fr419651/index.html">Ni GA ni YM. Comment nous avons créé notre propre flux de clics</a></li>
<li><a href="../fr419653/index.html">Comment faire des recherches d'utilisateurs sur GitHub sans React + RxJS 6 + Recompose</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>