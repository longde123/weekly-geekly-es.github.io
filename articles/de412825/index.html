<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèáüèæ üïï üò§ QEMU-Blockger√§te ü§≠ üë©‚Äçüë¶‚Äçüë¶ üà∂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="QEMU bietet verschiedene M√∂glichkeiten, ein Blockger√§t mit einer virtuellen Maschine zu verbinden. Dies wurde zun√§chst folgenderma√üen umgesetzt: 


-h...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>QEMU-Blockger√§te</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/412825/"><p><img src="https://habrastorage.org/getpro/habr/post_images/65a/367/b43/65a367b437b3a4242250ff30063f4455.png" alt="Bild"></p><br><p>  QEMU bietet verschiedene M√∂glichkeiten, ein Blockger√§t mit einer virtuellen Maschine zu verbinden.  Dies wurde zun√§chst folgenderma√üen umgesetzt: </p><br><pre><code class="plaintext hljs">-hda /dev/sda1</code> </pre> <br><p>  So wurden virtuelle Festplatten in den alten Tagen der Virtualisierung verbunden.  Es kann heute verwendet werden, wenn wir nur einige liveCDs testen m√∂chten.  Leider hat es seine Nachteile. <a name="habracut"></a>  :: </p><br><ul><li>  Beim Anschlie√üen virtueller Festplatten kann nur die Schnittstelle verwendet werden, die als <code>/dev/hda</code> (hda, hdb, hdc, ..) auf der virtuellen Maschine betrachtet wird.  F√ºr CD wird die Option <code>-cdrom</code> </li><li>  Wenn eine Datei (oder ein Ger√§t) mit einer virtuellen Maschine verbunden ist, verwendet QEMU nur die Standardeinstellungen. </li></ul><br><h2 id="drive">  fahren </h2><br><p>  Um andere Parameter (Bustyp, Cache-Nutzung usw.) <code>-drive</code> wurde <code>-drive</code> die Option <code>-drive</code> hinzugef√ºgt.  Obwohl es urspr√ºnglich zum Festlegen von Parametern sowohl f√ºr das <em>Backend</em> als auch f√ºr das <em>Frontend verwendet wurde</em> , werden derzeit <strong>nur</strong> die <em>Backend-</em> Parameter festgelegt, <em>dh</em> Parameter, die sich auf die Verbindung des virtuellen Ger√§ts innerhalb der virtuellen Maschine auswirken </p><br><pre> <code class="plaintext hljs">-drive file=/dev/sda1,if=ide,cache=writeback,aio=threads</code> </pre> <br><h2 id="device">  Ger√§t </h2><br><p>  Das Einstellen aller Parameter eines Blockger√§ts mit einer Option im Laufe der Zeit erwies sich als unvern√ºnftig.  Daher wurden die Optionen in zwei Teile geteilt.  <em>Backend-</em> Parameter, d. H. Solche, die zum Konfigurieren der Virtualisierungsumgebung verwendet werden.  Und <em>Frontend</em> , das sich darauf auswirkt, wie das Ger√§t in der virtuellen Maschine verbunden ist.  F√ºr diesen Parametersatz wurde eine neue Option <code>-device</code> eingef√ºhrt, die die <em>ID der</em> Laufwerks- <em>ID</em> enth√§lt, die durch den Parameter <code>-drive</code> angegeben wird. </p><br><p>  Das folgende Konfigurationsbeispiel verbindet das Laufwerk mit der <strong>ID ide0-hd0.</strong> Das Ergebnis entspricht dem Anschlie√üen eines virtuellen Laufwerks, wie in der Einf√ºhrung gezeigt. </p><br><pre> <code class="plaintext hljs">-drive file=/dev/sda1,id=ide0-hd0,if=none,cache=writeback,aio=threads \ -device ide-drive,bus=ide.0,drive=ide0-hd0</code> </pre> <br><h1 id="lokalnye-blochnye-ustroystva-v-virtualnoy-mashine">  Lokale Blockger√§te in einer virtuellen Maschine </h1><br><p> <a href=""><img src="https://habrastorage.org/webt/iu/bk/t0/iubkt0a0zeavkt_ntiqdcmg45bw.png"></a> </p><br><p>  Die Verwendung von physischen Blockger√§ten f√ºr virtuelle Maschinen ist heutzutage angesichts der weit verbreiteten Verwendung von virtuellen Festplatten nicht weit verbreitet.  Technisch gesehen k√∂nnen wir eine virtuelle Maschine mit einem propriet√§ren System von einer alten Festplatte ausf√ºhren.  In diesem Fall ist es jedoch besser, zuerst ein Disk-Image (Image) mit <strong>dd zu erstellen</strong> und das System bereits von dort aus zu starten. </p><br><p>  Wie ein lokales Blockger√§t kann es mit einer virtuellen Maschine verbunden werden. </p><br><ul><li>  Lokales RAID-Array - Ger√§t vom Typ MD </li><li>  Master-DRBD (Netzwerk-RAID1) - <em>Ger√§t vom</em> Typ <em>drbd</em> </li><li>  In LVM-Gruppe erstellte Festplattenpartition - Ger√§t vom Typ <em>dm</em> </li><li>  Eine regul√§re Datei, die √ºber eine Schleife verbunden ist, ist ein Schleifenger√§t </li><li><p>  Blockieren Sie das Ger√§t von einem anderen Computer, der √ºber einen NBD-Server exportiert wurde - ein Ger√§t vom Typ <em>nbd</em> </p><br><p>  <em>(Hier ist auch der Ceph-Ger√§tetyp rbd und der ZFS-Ger√§tetyp zvol zu erw√§hnen - ca. Per)</em> <br><br></p><br><h2 id="nbd">  NBD </h2><br><p>  Betrachten Sie das Konzept, ein Blockger√§t von einem Remotecomputer √ºber ein Netzwerk zu verbinden.  Siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">separates Handbuch f√ºr NBD</a> . </p><br></li></ul><br><p> <a href=""><img src="https://habrastorage.org/webt/on/dy/nf/ondynfow2qyce6r0j65pjmqwnqo.png" align="right"></a> <a href=""><img src="https://habrastorage.org/webt/tq/uv/am/tquvamsriwa3hlj4sh3972xbvyq.png" align="left"></a>  QEMU verf√ºgt √ºber eine integrierte NBD-API, sodass ein mit einem NBD-Server erweitertes Remote-Block-Ger√§t √ºber QEMU direkt mit der virtuellen Maschine verbunden werden kann - siehe Abbildung links. </p><br><p>  NBD ist jedoch ein ziemlich einfaches Protokoll, das keine Authentifizierung auf einem Remote-Server verwendet und den Status der Verbindung nicht steuert.  Das NBD-Protokoll geht davon aus, dass der Client erneut eine Verbindung herstellen kann, wenn die Verbindung zum Server unterbrochen wird, QEMU jedoch leider nicht. </p><br><p>  Zum Teil kann die Situation gel√∂st werden, indem mehrere NBD-Ger√§te angeschlossen und ein virtuelles RAID-Array darin erstellt werden.  Dieser Ansatz hat mehrere Vorteile und einen schwerwiegenden Fehler.  Wenn eines der Ger√§te ausgeschaltet wird, passiert nichts Schlimmes.  Aber wenn sie alle auf einmal herausfliegen = wird es schlecht sein.  E / A-Vorg√§nge in einer virtuellen Umgebung sind viel schneller, da Anforderungen parallel zu mehreren physischen Maschinen (NBD-Servern) gleichzeitig ausgef√ºhrt werden.  Andererseits werden mehr Ressourcen des virtuellen Prozessors und des virtuellen Speichers ben√∂tigt. </p><br><p>  Der Hauptnachteil beim Erstellen eines RAID-Arrays aus NBD-Ger√§ten in einer virtuellen Maschine ist das QEMU-Ger√§t. Wenn das NBD-Ger√§t abst√ºrzt, wird es erst nach einem <strong>vollst√§ndigen Neustart der</strong> Maschine wieder verbunden, w√§hrend ein interner Neustart des Betriebssystems in der virtuellen Maschine nicht ausreicht.  Sie k√∂nnen jedoch eine virtuelle Maschine ohne Festplatten erstellen, die unabh√§ngig auf den NBD-Server zugreift und die erforderlichen NBD-Ger√§te verbindet.  Dar√ºber hinaus m√ºssen ausgefallene Ger√§te erneut zum Array hinzugef√ºgt und neu synchronisiert werden. Dies kann entweder manuell oder mithilfe von Skripten in der virtuellen Maschine erfolgen. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/2z/hj/h8/2zhjh8517alwckyyggummg1-wj8.png" align="left"></a>  Es ist besser, mit dem Ger√§t der virtuellen NBD-Maschine auf den NBD-Server zuzugreifen.  In Bezug auf die E / A-Leistung ist es besonders gut, ein RAID-Array aus NBD-Ger√§ten zu erstellen. </p><br><p>  Diese L√∂sung erwies sich als die absolut produktivste aller getesteten.  Und die virtuelle Maschine konnte den ununterbrochenen Betrieb auch im Falle einer Unterbrechung des NBD-Servers (oder eines Ausfalls) im Laufe der Zeit fortsetzen. </p><br><p>  Somit war es m√∂glich, eine relativ stabile und gleichzeitig produktive Virtualisierungsumgebung auf instabilen Ger√§ten zu organisieren. </p><br><blockquote>  Das Hauptproblem bei RAID-Arrays auf NBD-Ger√§ten besteht darin, dass Sie beim Anschlie√üen eines Ger√§ts, das Teil eines RAID-Arrays ist, vom NBD-Server sehr vorsichtig sein m√ºssen.  Dies ist ein ziemlich heikler Prozess mit einer hohen Wahrscheinlichkeit eines schwerwiegenden Fehlers, der zu Datenverlust f√ºhren kann.  Ein kleiner Tippfehler reicht aus.  Siehe die Beschreibung des t√∂dlichen Autounfalls vom 21. Juli 2012 auf der Seite <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erdn√ºsse</a> . </blockquote><p>  Der Nachteil ist, dass ein Blockger√§t, mit dem eine virtuelle Maschine bereits arbeitet, nicht an einem anderen Ort verbunden werden kann, wenn das Dateisystem dies nicht zul√§sst. Dies √§hnelt <strong>iSCSI</strong> (Internet <strong>S</strong> computer Computer Interface - Netzwerkversion von SCSI) oder <strong>AoE</strong> ( <strong>Eine</strong> TA √ºber Internet-Technologie). </p><br><h1 id="virtualnye-diski">  Virtuelle Festplatten </h1><br><p> <a href=""><img src="https://habrastorage.org/webt/id/fl/lr/idfllr5zwpo6jniv5emsyqhir2m.png"></a> </p><br><p>  QEMU kann nicht nur Blockger√§te mit der virtuellen Maschine verbinden, sondern mithilfe verschiedener APIs kann auch eine regul√§re Datei verbunden werden, die wie ein Blockger√§t innerhalb der Maschine aussieht. </p><br><h2 id="formaty-virtualnyh-diskov">  Formate f√ºr virtuelle Festplatten </h2><br><blockquote>  Qemu kann mit virtuellen Festplatten in verschiedenen Formaten arbeiten.  F√ºr diese virtuellen Festplatten, die in Form von normalen Dateien dargestellt werden, gibt es ein Standarddienstprogramm <strong>qemu-img</strong> , das sowohl zum Konvertieren verwendet werden kann, um das verwendete Format als auch seine Parameter zu bestimmen. <br><br>  Abrufen von Informationen zur virtuellen Festplatte, die als regul√§re Datei gespeichert sind.  Auf die gleiche Weise k√∂nnen Sie Informationen zu einer in GlusterFS gespeicherten virtuellen Festplatte abrufen: <br><pre> <code class="plaintext hljs">root@stroj~# qemu-img info /path_to_file/soubor.img</code> </pre> <br><br>  Um jedoch mithilfe der GlusterFS-API Informationen zu einer virtuellen Festplatte zu erhalten, m√ºssen Sie dieselben Parameter verwenden, die zum Verbinden der virtuellen Festplatte mit der virtuellen Maschine verwendet werden.  So k√∂nnen Sie die interne Festplatte auf dem Computer identifizieren, auf dem der GlusterFS-Client installiert und verwendet wird: <br><pre> <code class="plaintext hljs">root@stroj~# qemu-img info gluster+tcp://192.168.0.2/volume_name/soubor.img</code> </pre> <br><br>  Die virtuelle VDI-Festplatte kann nur √ºber die Sheepdog-API identifiziert werden: <br><pre> <code class="plaintext hljs">root@stroj~# qemu-img info sheepdog:192.168.0.2:8000:vdi_name</code> </pre> <br><br>  F√ºr eine vom NBD-Server exportierte virtuelle Festplatte muss sichergestellt werden, dass der richtige Server und der richtige Port angegeben sind, da NBD keinen anderen Identifikations- oder Authentifizierungsmechanismus verwendet, der Verwechslungen mit anderen virtuellen Festplatten <em>vermeiden</em> w√ºrde <em>(die neue Version von nbd-server verwendet) nur ein Port und identifiziert das Ger√§t anhand des Namens - ca. pro)</em> : <br><pre> <code class="plaintext hljs">root@stroj~# qemu-img info nbd:192.168.0.2:8000</code> </pre> <br><br>  <strong>192.168.0.2</strong> <br>  Die IP-Adresse des Hosts, von dem aus das virtuelle Ger√§t eine Verbindung herstellt.  Wenn dies derselbe Host ist, auf dem <strong>qemu-img info ausgef√ºhrt</strong> wird, kann <em>localhost</em> anstelle der IP-Adresse verwendet werden <br><br>  <strong>8000</strong> <br>  Die Portnummer, die der D√§mon oder Server abh√∂rt.  Standardm√§√üig verwendet Sheepdog Port 7000, kann jedoch auch auf einem anderen Port ausgef√ºhrt werden, um Konflikte mit einer anderen Anwendung zu vermeiden.  Ein NBD-Server kann verschiedene Ports √ºberwachen, wenn mehr als ein Ger√§t exportiert wird. </blockquote><p>  <strong>roh</strong> <br>  Im Allgemeinen handelt es sich lediglich um einen Datensatz, der im gleichen Format wie bei einem herk√∂mmlichen Blockger√§t aufgezeichnet wurde.  Eine 5G-Datei belegt den gesamten Platz, unabh√§ngig davon, ob sie n√ºtzliche Daten oder nur leeren Speicherplatz enth√§lt.  <em>(Dies gilt nicht f√ºr Dateien mit geringer Dichte - ca. pro)</em> </p><br><p>  <strong>qcow</strong> <br>  Es unterscheidet sich vom Rohformat dadurch, dass es inkrementell sein kann, da es allm√§hlich w√§chst. Dies ist praktisch f√ºr Dateisysteme, die keine Dateien mit geringer Dichte unterst√ºtzen, z. B. FAT32.  Mit diesem Format k√∂nnen Sie auch separate inkrementelle Kopien von einer einzelnen Basisfestplatte erstellen.  Die Verwendung einer solchen ‚ÄûVorlage‚Äú spart Zeit und Speicherplatz.  Dar√ºber hinaus unterst√ºtzt es die AES-Verschl√ºsselung und die Zlib-Komprimierung.  Der Nachteil ist, dass eine solche Datei im Gegensatz zu Raw-Festplatten nicht direkt auf dem Computer bereitgestellt werden kann, auf dem sie sich befindet.  Gl√ºcklicherweise gibt es ein <strong>Dienstprogramm qemu-nbd</strong> , das diese Datei als Netzwerkblockger√§t exportieren und dann mit einem NBD-Ger√§t verbinden kann. </p><br><p>  <strong>qcow2</strong> <br>  ist eine aktualisierte Version des qcow-Formats.  Der Hauptunterschied besteht darin, dass Snapshots unterst√ºtzt werden.  Ansonsten unterscheiden sie sich nicht grundlegend.  Es ist auch m√∂glich, qcow2 zu treffen, das intern als QCOW Version 3 definiert ist, nachdem es vor langer Zeit im qcow2-Format enthalten war.  Tats√§chlich ist dies ein modifiziertes qcow2 mit dem Parameter lazy_refcounts, der f√ºr Snapshots verwendet wird.  Da der Unterschied nur ein Bit <strong>betr√§gt</strong> , verf√ºgt <strong>qemu-img</strong> ab Version 1.7 √ºber die Option "√Ñndern", um ihn zu √§ndern.  Fr√ºhere Versionen von <strong>qemu-img</strong> tun dies nicht.  Wenn Sie die Version des Formats √§ndern wollten, musste die virtuelle Festplatte in eine neue Datei konvertiert werden. W√§hrend der Konvertierung wurde der kompatible Parameter mit dem kompatiblen Parameter installiert, f√ºr den stattdessen "1.1" auf 0.10 "reduziert werden musste.  Das Vorhandensein der Option "√Ñndern" ist praktisch, da die Daten aufgrund derartiger geringf√ºgiger √Ñnderungen nicht √ºberschrieben werden m√ºssen. </p><br><pre> <code class="plaintext hljs">qemu-img create -f qcow2 -o compat=1.1 test.qcow2 8G</code> </pre> <br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://blog.wikichoon.com/2014/12/virt-manager-10-creates-qcow2-images.html</a> </p><br><p>  <strong>qed</strong> <br>  Dies ist ein inkrementelles COW-Format einer virtuellen Festplatte, die den Host am wenigsten belastet.  Es unterst√ºtzt keine Komprimierung und verwendet zwei parallele Tabellen, um Datenbl√∂cke (Cluster) zu adressieren.  Leider war lange Zeit kein einziger Entwickler an seiner Entwicklung interessiert, so dass seine Verwendung einige Probleme mit sich bringt, die erw√§hnt werden. </p><br><p>  <strong>vdi</strong> <br>  Format der virtuellen Festplatte, das vom Oracle Virtualbox-Virtualisierungssystem verwendet wird. </p><br><p>  <strong>vmdk</strong> <br>  Format der virtuellen Festplatte, das von VMware-Produkten verwendet wird.  Dies ist auch ein Format, mit dem eine Datei allm√§hlich wachsen kann.  Es hat jedoch einen gro√üen Vorteil gegen√ºber den Formaten qcow2 und qed, die auch mit plattenlosen L√∂sungen oder mit Netzwerkdateisystemen verwendet werden k√∂nnen.  Sie k√∂nnen eine virtuelle Festplattendatei in mehrere kleine Dateien mit einer Gr√∂√üe von 2 GB unterteilen.  Dies gilt ab dem Zeitpunkt, an dem Dateisysteme keine Dateien mit mehr als 2 GB erstellen konnten.  Der Vorteil besteht darin, dass bei der Replikation einer solchen virtuellen Festplatte √ºber das Netzwerk weniger Daten √ºbertragen werden und die Synchronisierung viel schneller erfolgt (z. B. bei GlusterFS).  Im Fall einer plattenlosen L√∂sung werden auch nur kleine Dateien mit Unterschieden f√ºr jeden Snapshot gespeichert </p><br><p>  <strong>vhdx</strong> <br>  Format der virtuellen Festplatte, das vom Microsoft Hyper-V-Virtualisierungssystem verwendet wird </p><br><p>  <strong>vpc</strong> <br>  Format der virtuellen Festplatte, das vom Microsoft VirtualPC-Virtualisierungssystem verwendet wird. </p><br><table><thead><tr><th></th><th>  <sup>Incre</sup> <sup><br></sup>  <sup>menti</sup> <sup><br></sup>  <sup>verwurzelt</sup> <sup><br></sup>  <sup>Dh</sup> <br></th><th>  <sup>Chiffre</sup> <sup><br></sup>  <sup>Novation</sup> <br></th><th>  <sup>Com</sup> <sup><br></sup>  <sup>pres</sup> <sup><br></sup>  <sup>das</sup> <br></th><th>  <sup>Preal</sup> <sup><br></sup>  <sup>Lage</sup> <br></th><th>  <sup>Shabl</sup> <sup><br></sup>  <sup>oniz</sup> <sup><br></sup>  <sup>Nation</sup> <br></th><th>  <sup>Prop</sup> <sup><br></sup>  <sup>Wiesel</sup> <br></th><th>  <sup>Abschnitt</sup> <sup><br></sup>  <sup>Bild</sup> <br></th><th>  <sup>Innen</sup> <sup><br></sup>  <sup>Schnappsch√ºsse</sup> <sup><br></sup>  <sup>du</sup> <br></th><th>  <sup>√úberpr√ºfung vereinbart</sup> <sup><br></sup>  <sup>Nosti</sup> <br></th><th>  <sup>Hinweis</sup> <br></th></tr></thead><tbody><tr><td>  <sup><b>roh</b></sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>ja</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Kann √ºber eine <i>Schlaufe</i> montiert werden</sup> <br></td></tr><tr><td>  <sup><b>Datei</b></sup> </td><td>  <sup>ja</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Option</sup> <sup><br></sup>  <sup>pers√∂nlich</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>F√ºr Btrfs sollten Sie Copy-on-Write deaktivieren</sup> <br></td></tr><tr><td>  <sup><b>qcow</b></sup> </td><td>  <sup>ja</sup> </td><td>  <sup>ja</sup> </td><td>  <sup>ja</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>ja</sup> </td><td>  <sup>ja</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td></td></tr><tr><td>  <sup><b>qcow2</b></sup> </td><td>  <sup>ja</sup> </td><td>  <sup>ja</sup> </td><td>  <sup>ja</sup> </td><td>  <sup>Option</sup> <sup><br></sup>  <sup>pers√∂nlich</sup> </td><td>  <sup>ja</sup> </td><td>  <sup>ja</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>ja</sup> </td><td>  <sup>ja</sup> </td><td></td></tr><tr><td>  <sup><b>qed</b></sup> </td><td>  <sup>ja</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>ja</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td></td></tr><tr><td>  <sup><b>vmdk</b></sup> </td><td>  <sup>ja</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Option</sup> <sup><br></sup>  <sup>pers√∂nlich</sup> </td><td>  <sup>ja</sup> </td><td>  <sup>huh</sup> <sup>?</sup> </td><td>  <sup>ja</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td></td></tr><tr><td>  <sup><b>vdi</b></sup> </td><td>  <sup>ja</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Option</sup> <sup><br></sup>  <sup>statisch (statisch)</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>ja</sup> </td><td></td></tr><tr><td>  <sup><b>vhdx</b></sup> </td><td>  <sup>ja</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Option</sup> <sup><br></sup>  <sup>fest (fest)</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>ja</sup> <sup><a name="cite_ref-1"></a></sup>  <sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">1</a></sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td></td></tr><tr><td>  <sup><b>vpc</b></sup> </td><td>  <sup>ja</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Option</sup> <sup><br></sup>  <sup>fest (fest)</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td>  <sup>Nein</sup> </td><td></td></tr></tbody></table><br><ol><li><a name="cite_note-1"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚Üë</a> Es kann nur f√ºr vorinstallierte Images verwendet werden (behoben) <br></li></ol><br><h2 id="ispolzuemye-api">  Verwendete APIs </h2><br><p>  Zus√§tzlich zu den Dateiformaten <strong>funktioniert qemu-img</strong> auch mit ‚ÄûFormaten‚Äú, die √ºber die API bereitgestellt werden, √ºber die auf diese Blockger√§te remote zugegriffen werden kann. </p><br><p>  <strong>nfs</strong> <br>  Datei der virtuellen Festplatte, die √ºber das NFS-Protokoll mit QEMU verbunden ist </p><br><p>  <strong>iscsi</strong> <br>  Die Kommunikation mit dem Blockger√§t erfolgt √ºber iSCSI.  Ein Ger√§t kann nicht gleichzeitig auf mehr als einem Client verwendet werden. </p><br><p>  <strong>nbd</strong> <br>  Der Zugriff √ºber NBD kann sehr schnell erfolgen.  Dies liegt daran, dass das Protokoll sehr einfach ist.  Dies ist ein Vorteil, aber gleichzeitig ein Nachteil.  Dies kann praktisch sein, wenn mehrere Clients eine Verbindung zu demselben NBD-Server herstellen k√∂nnen, wenn sie eine lokale Verbindung √ºber den xnbd-Server verwenden.  Da nbd jedoch keine Sicherheits- oder Authentifizierungsmechanismen hat, kann es leicht vorkommen, dass ein Client versehentlich eine Verbindung zum falschen Ger√§t herstellt, das zum gegebenen Zeitpunkt m√∂glicherweise bereits verwendet wird und es besch√§digt. </p><br><p>  <strong>ssh</strong> <br>  Die Verbindung zum Remote-Server erfolgt √ºber sshfs </p><br><p>  <strong>Glanz</strong> <br>  Verwendet die GlusterFS-Dateisystem-API, um auf die Datei der virtuellen Festplatte zuzugreifen.  Wenn die Datei Teil eines replizierten oder verteilten Volumes ist, werden die gespeicherten Daten auf andere Knoten verteilt.  Dadurch kann er im Fehlerfall auf anderen Knoten verf√ºgbar sein. </p><br><p>  <strong>Sch√§ferhund</strong> <br>  ist auch ein replikationsf√§higes verteiltes Dateisystem.  Im Gegensatz zu GlusterFS ist eine virtuelle Festplatte √ºber die API nicht als Datei, sondern als Blockger√§t verf√ºgbar.  Dies ist vorteilhaft f√ºr die Leistung, aber nachteilig, wenn wir √ºber die Sheepdog-Umgebung hinausgehen m√ºssen. </p><br><p>  <strong>Parallelen</strong> </p><br><h1 id="virtualnye-diski-na-setevom-hranilische">  Virtuelle Laufwerke im Netzwerkspeicher </h1><br><p>  Der Vorteil von Blockger√§ten au√üerhalb des Virtualisierungssystems besteht darin, dass sie dann immun gegen Ausf√§lle virtueller Maschinen sind. </p><br><p>  In diesem Fall werden auch eine hohe Verf√ºgbarkeit und ein ausreichendes Volumen f√ºr die Remote-Speicherung bereitgestellt. </p><br><p>  <strong>Verwenden von NFS</strong> <br> <a href=""><img src="https://habrastorage.org/webt/ws/ce/6f/wsce6f0lvdglrpbl1g_v4lif9py.png"></a> </p><br><p>  <strong>Sch√§ferhund</strong> <br> <a href=""><img src="https://habrastorage.org/webt/lv/ko/k4/lvkok49hqjv-kp1uiis-8sg3ejw.png"></a> </p><br><p>  <strong>GlusterFS</strong> <br> <a href=""><img src="https://habrastorage.org/webt/n9/jz/0z/n9jz0zjuprv_mj-tmq9lhjtqfjy.png"></a> </p><br><h1 id="virtualnye-mashiny-bez-blochnyh-ustroystv">  Blocklose virtuelle Maschinen </h1><br><p>  Ohne Blockger√§te k√∂nnen Betriebssysteme funktionieren, die √ºber NFS oder mit einem mit Plan9 ausgel√∂sten Host-Dateisystem gestartet werden k√∂nnen. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de412825/">https://habr.com/ru/post/de412825/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de412813/index.html">Unn√∂tige HTTP-Header</a></li>
<li><a href="../de412815/index.html">Web Manager OpenVPN-Clientschl√ºssel VPNFace Lite</a></li>
<li><a href="../de412819/index.html">Freitag Aufw√§rmen f√ºr den Geist: Perfektes Karma f√ºr Habrahabr</a></li>
<li><a href="../de412821/index.html">Sehen, sehen, schauen: Was ist der Unterschied?</a></li>
<li><a href="../de412823/index.html">Interview auf Englisch: Wie man es nicht schlimmer macht als der Freund des Sohnes der Mutter</a></li>
<li><a href="../de412827/index.html">Pavel Durov: Nach dem ILV-Appell hat Apple Telegramm-Updates auf der ganzen Welt blockiert</a></li>
<li><a href="../de412829/index.html">Verteilte Rechenzentren vom Anbieter: Was und warum</a></li>
<li><a href="../de412831/index.html">YouTrack 2018.2 Release: Neue Projektseite, YouTrack Docker Image und vieles mehr</a></li>
<li><a href="../de412833/index.html">Mehr als Ford</a></li>
<li><a href="../de412835/index.html">NanoEinf√ºhrung in das Internet der Nano-Dinge. Teil 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>