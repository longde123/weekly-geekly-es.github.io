<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ–ï¸ ğŸ™‡ğŸ¼ ğŸ– å·¥ä½œç³»ç»Ÿå’Œæœç´¢è·¯å¾„ ğŸ› ğŸ—“ï¸ ğŸ‘©ğŸ¿â€ğŸ¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ°å›¾ 
 åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ç ”ç©¶äº†æ–°çš„Jobç³»ç»Ÿæ˜¯ä»€ä¹ˆï¼Œå®ƒå¦‚ä½•å·¥ä½œï¼Œå¦‚ä½•åˆ›å»ºä»»åŠ¡ï¼Œå¦‚ä½•ç”¨æ•°æ®å¡«å……å®ƒä»¬å¹¶æ‰§è¡Œå¤šçº¿ç¨‹è®¡ç®—ï¼Œå¹¶ä¸”ä»…ç®€è¦è¯´æ˜äº†åœ¨å“ªé‡Œå¯ä»¥ä½¿ç”¨æ­¤ç³»ç»Ÿã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å°è¯•åˆ†æä¸€ä¸ªå…·ä½“ç¤ºä¾‹ï¼Œè¯´æ˜å¯ä»¥åœ¨å“ªé‡Œä½¿ç”¨æ­¤ç³»ç»Ÿä»¥è·å¾—æ›´é«˜çš„æ€§èƒ½ã€‚ 

 ç”±äºè¯¥ç³»ç»Ÿæœ€åˆæ˜¯ä¸ºå¤„ç†æ•°æ®è€Œå¼€å‘çš„ï¼Œå› æ­¤å¯¹äºè§£å†³å¯»è·¯ä»»åŠ¡...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>å·¥ä½œç³»ç»Ÿå’Œæœç´¢è·¯å¾„</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423601/"><h3> åœ°å›¾ </h3><br> åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œ</a>æˆ‘ç ”ç©¶äº†æ–°çš„<b>Jobç³»ç»Ÿæ˜¯</b>ä»€ä¹ˆï¼Œå®ƒå¦‚ä½•å·¥ä½œï¼Œå¦‚ä½•åˆ›å»ºä»»åŠ¡ï¼Œå¦‚ä½•ç”¨æ•°æ®å¡«å……å®ƒä»¬å¹¶æ‰§è¡Œå¤šçº¿ç¨‹è®¡ç®—ï¼Œå¹¶ä¸”ä»…ç®€è¦è¯´æ˜äº†åœ¨å“ªé‡Œå¯ä»¥ä½¿ç”¨æ­¤ç³»ç»Ÿã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å°è¯•åˆ†æä¸€ä¸ªå…·ä½“ç¤ºä¾‹ï¼Œè¯´æ˜å¯ä»¥åœ¨å“ªé‡Œä½¿ç”¨æ­¤ç³»ç»Ÿä»¥è·å¾—æ›´é«˜çš„æ€§èƒ½ã€‚ <br><a name="habracut"></a><br> ç”±äºè¯¥ç³»ç»Ÿæœ€åˆæ˜¯ä¸ºå¤„ç†æ•°æ®è€Œå¼€å‘çš„ï¼Œå› æ­¤å¯¹äºè§£å†³å¯»è·¯ä»»åŠ¡éå¸¸æœ‰ç”¨ã€‚ <br><br>  <b>Unity</b>å·²ç»æœ‰äº†ä¸€ä¸ªä¸é”™çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">NavMeshè·¯å¾„æŸ¥æ‰¾å™¨</a> ï¼Œä½†å°½ç®¡åœ¨åŒä¸€<i>èµ„äº§</i>ä¸Šæœ‰å¾ˆå¤šç°æˆçš„è§£å†³æ–¹æ¡ˆï¼Œä½†å®ƒä¸é€‚ç”¨äº2Dé¡¹ç›®ã€‚ å¥½å§ï¼Œæˆ‘ä»¬å°†ä¸ä»…å°è¯•åˆ›å»ºä¸€ä¸ªç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿå°†åœ¨åˆ›å»ºçš„åœ°å›¾ä¸ŠæŸ¥æ‰¾è·¯å¾„ï¼Œè€Œä¸”ä½¿è¯¥åœ°å›¾éå¸¸åŠ¨æ€ï¼Œä»¥ä¾¿æ¯æ¬¡å¯¹å…¶è¿›è¡Œæ›´æ”¹æ—¶ï¼Œç³»ç»Ÿéƒ½å°†åˆ›å»ºä¸€ä¸ªæ–°åœ°å›¾ï¼Œå½“ç„¶æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªæ–°çš„ä»»åŠ¡ç³»ç»Ÿï¼Œä»¥å…åŠ è½½ä¸»çº¿ç¨‹ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ç³»ç»Ÿæ“ä½œç¤ºä¾‹</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/527/a69/ec1/527a69ec1543218ffe1df7c4b1deddb0.gif" alt="å›¾ç‰‡"><br></div></div><br> åœ¨ç¤ºä¾‹ä¸­ï¼Œåœ¨åœ°å›¾ä¸Šæ„å»ºäº†ä¸€ä¸ªç½‘æ ¼ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªæœºå™¨äººå’Œä¸€ä¸ªéšœç¢ç‰©ã€‚ æ¯å½“æˆ‘ä»¬æ›´æ”¹åœ°å›¾çš„ä»»ä½•å±æ€§ï¼ˆæ— è®ºå¤§å°æˆ–ä½ç½®ï¼‰æ—¶ï¼Œéƒ½ä¼šé‡æ–°æ„å»ºç½‘æ ¼ã€‚ <br><br> å¯¹äºé£æœºï¼Œæˆ‘ä½¿ç”¨äº†ä¸€ä¸ªç®€å•çš„<b>SpriteRenderer</b> ï¼Œæ­¤ç»„ä»¶å…·æœ‰å‡ºè‰²çš„<b>bounds</b>å±æ€§ï¼Œé€šè¿‡å®ƒå¯ä»¥è½»æ¾æ‰¾å‡ºåœ°å›¾çš„å¤§å°ã€‚ <br><br> åŸºæœ¬ä¸Šè¿™åªæ˜¯ä¸€ä¸ªå¼€å§‹ï¼Œä½†æˆ‘ä»¬ä¸ä¼šåœä¸‹æ¥ç«‹å³ç€æ‰‹å¼€å±•ä¸šåŠ¡ã€‚ <br><br> è®©æˆ‘ä»¬ä»è„šæœ¬å¼€å§‹ã€‚ ç¬¬ä¸€ä¸ªæ˜¯éšœç¢ç‰©è„šæœ¬ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">éšœç¢ç‰©</b> <div class="spoiler_text"><pre><code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonoBehaviour</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre> <br></div></div><br> åœ¨<b>Obstacle</b>ç±»ä¸­ï¼Œæˆ‘ä»¬å°†æ•è·åœ°å›¾ä¸Šéšœç¢ç‰©çš„æ‰€æœ‰å˜åŒ–ï¼Œä¾‹å¦‚ï¼Œæ›´æ”¹å¯¹è±¡çš„ä½ç½®æˆ–å¤§å°ã€‚ <br> æ¥ä¸‹æ¥ï¼Œæ‚¨å¯ä»¥åˆ›å»ºå°†åœ¨å…¶ä¸Šæ„å»ºç½‘æ ¼çš„<b>Map</b> mapç±»ï¼Œå¹¶ä»<b>Obstacle</b>ç±»ç»§æ‰¿å®ƒã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">åœ°å›¾</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> sealed <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Map</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre> <br></div></div><br>  <b>Map</b>ç±»è¿˜å°†è·Ÿè¸ª<b>åœ°å›¾</b>ä¸Šçš„æ‰€æœ‰æ›´æ”¹ï¼Œä»¥ä¾¿åœ¨å¿…è¦æ—¶é‡å»ºç½‘æ ¼ã€‚ <br><br> ä¸ºæ­¤ï¼Œç”¨æ‰€æœ‰å¿…éœ€çš„å˜é‡å’Œæ–¹æ³•å¡«å……<b>Obstacle</b>åŸºç±»ï¼Œä»¥è·Ÿè¸ªå¯¹è±¡çš„å˜åŒ–ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">éšœç¢ç‰©</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonoBehaviour</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpriteRenderer renderer { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector2 tempSize; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector2 tempPos; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> virtual <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Awake() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.renderer = GetComponent&lt;SpriteRenderer&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempSize = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.size; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempPos = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.position; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> virtual bool CheckChanges() { Vector2 newSize = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.size; float diff = (newSize - <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempSize).sqrMagnitude; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (diff &gt; <span class="hljs-number"><span class="hljs-number">0.01</span></span>f) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempSize = newSize; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } Vector2 newPos = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.position; diff = (newPos - <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempPos).sqrMagnitude; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (diff &gt; <span class="hljs-number"><span class="hljs-number">0.01</span></span>f) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempPos = newPos; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vector2 size { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.renderer.bounds.size;} } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vector2 position { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.transform.position;} } }</code> </pre> <br></div></div><br> åœ¨è¿™é‡Œï¼Œ <b>renderer</b>å˜é‡å°†å¼•ç”¨<b>SpriteRenderer</b>ç»„ä»¶ï¼Œå¹¶ä¸”<b>tempSize</b>å’Œ<b>tempPoså˜é‡</b>å°†ç”¨äºè·Ÿè¸ªå¯¹è±¡çš„å¤§å°å’Œä½ç½®çš„å˜åŒ–ã€‚ <br><br>  <b>Awake</b>è™šæ‹Ÿæ–¹æ³•å°†ç”¨äºåˆå§‹åŒ–å˜é‡ï¼Œè€Œ<b>CheckChanges</b>è™šæ‹Ÿæ–¹æ³•å°†è·Ÿè¸ªå¯¹è±¡å¤§å°å’Œä½ç½®çš„å½“å‰å˜åŒ–å¹¶è¿”å›<b>å¸ƒå°”</b>ç»“æœã€‚ <br><br> ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç¦»å¼€<b>Obstacle</b>è„šæœ¬ï¼Œç»§ç»­å‰è¿›åˆ°<b>Map</b> mapè„šæœ¬æœ¬èº«ï¼Œåœ¨å…¶ä¸­æˆ‘ä»¬è¿˜ä¸ºå·¥ä½œå¡«å……äº†å¿…è¦çš„å‚æ•°ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">åœ°å›¾</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> sealed <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Map</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> </span></span>{ [Range(<span class="hljs-number"><span class="hljs-number">0.1</span></span>f, <span class="hljs-number"><span class="hljs-number">1</span></span>f)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> float nodeSize = <span class="hljs-number"><span class="hljs-number">0.5</span></span>f; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vector2 offset = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0.5</span></span>f, <span class="hljs-number"><span class="hljs-number">0.5</span></span>f); }</code> </pre> <br></div></div><br>  <b>nodeSize</b>å˜é‡å°†æŒ‡ç¤ºåœ°å›¾ä¸Šåƒå…ƒçš„å¤§å°ï¼Œè¿™é‡Œæˆ‘å°†å…¶å¤§å°é™åˆ¶ä¸º0.1åˆ°1ï¼Œè¿™æ ·ç½‘æ ¼ä¸Šçš„åƒå…ƒä¸ä¼šå¤ªå°ï¼Œä½†ä¹Ÿå¤ªå¤§ã€‚ æ„é€ ç½‘æ ¼æ—¶ï¼Œ <b>åç§»é‡</b>å˜é‡å°†ç”¨äºç¼©è¿›åœ°å›¾ï¼Œä»¥ä½¿ç½‘æ ¼ä¸ä¼šæ²¿åœ°å›¾çš„è¾¹ç¼˜ç”Ÿæˆã€‚ <br><br> ç”±äºç°åœ¨åœ¨åœ°å›¾ä¸Šæœ‰ä¸¤ä¸ªæ–°å˜é‡ï¼Œå› æ­¤äº‹å®è¯æ˜ï¼Œè¿˜éœ€è¦è·Ÿè¸ªå®ƒä»¬çš„æ›´æ”¹ã€‚ ä¸ºæ­¤ï¼Œè¯·æ·»åŠ å‡ ä¸ªå˜é‡ï¼Œå¹¶åœ¨<b>Map</b>ç±»ä¸­é‡è½½<b>CheckChanges</b>æ–¹æ³•ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">åœ°å›¾</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> sealed <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Map</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> </span></span>{ [Range(<span class="hljs-number"><span class="hljs-number">0.1</span></span>f, <span class="hljs-number"><span class="hljs-number">1</span></span>f)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> float nodeSize = <span class="hljs-number"><span class="hljs-number">0.5</span></span>f; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vector2 offset = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(<span class="hljs-number"><span class="hljs-number">0.5</span></span>f, <span class="hljs-number"><span class="hljs-number">0.5</span></span>f); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> float tempNodeSize; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector2 tempOffset; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Awake() { base.Awake(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempNodeSize = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempOffset = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.offset; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> bool CheckChanges() { float diff = Mathf.Abs(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempNodeSize - <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (diff &gt; <span class="hljs-number"><span class="hljs-number">0.01</span></span>f) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempNodeSize = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } diff = (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempOffset - <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.offset).sqrMagnitude; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (diff &gt; <span class="hljs-number"><span class="hljs-number">0.01</span></span>f) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempOffset = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.offset; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> base.CheckChanges(); } }</code> </pre> <br></div></div><br> åšå®Œäº† ç°åœ¨ï¼Œæ‚¨å¯ä»¥åœ¨èˆå°ä¸Šåˆ›å»ºä¸€ä¸ªåœ°å›¾ç²¾çµï¼Œå¹¶åœ¨å…¶ä¸Šæ”¾ç½®ä¸€ä¸ª<b>åœ°å›¾</b>è„šæœ¬ã€‚ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d75/60f/db8/d7560fdb8abeb5f00a7a5e1ec5e444df.png" alt="å›¾ç‰‡"><br><br> æˆ‘ä»¬å°†åœ¨éšœç¢ç‰©ä¸ŠåšåŒæ ·çš„äº‹æƒ…-åœ¨èˆå°ä¸Šåˆ›å»ºä¸€ä¸ªç®€å•çš„ç²¾çµï¼Œå¹¶åœ¨ä¸Šé¢<b>æ”¾ä¸ŠObstacle</b>è„šæœ¬ã€‚ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/347/ffa/e8d/347ffae8dd2b4cd3a3a50c881d5674df.png" alt="å›¾ç‰‡"><br><br> ç°åœ¨æˆ‘ä»¬åœ¨èˆå°ä¸Šæœ‰åœ°å›¾å¯¹è±¡å’Œéšœç¢ç‰©ã€‚ <br><br>  <b>Map</b>è„šæœ¬å°†è´Ÿè´£è·Ÿè¸ªåœ°å›¾ä¸Šçš„æ‰€æœ‰æ›´æ”¹ï¼Œåœ¨<b>Update</b>æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å°†æ£€æŸ¥æ¯ä¸ªæ¡†æ¶çš„æ›´æ”¹ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">åœ°å›¾</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> sealed <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Map</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*... â€¦*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> bool requireRebuild; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Update() { UpdateChanges(); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> UpdateChanges() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.requireRebuild) { print(â€œ  ,   !â€); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.requireRebuild = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.requireRebuild = CheckChanges(); } } <span class="hljs-comment"><span class="hljs-comment">/*... â€¦*/</span></span> }</code> </pre> <br></div></div><br> å› æ­¤ï¼Œåœ¨<b>UpdateChanges</b>æ–¹æ³•ä¸­<b>ï¼Œ</b>åœ°å›¾å°†ä»…è·Ÿè¸ªåˆ°ç›®å‰ä¸ºæ­¢çš„æ›´æ”¹ã€‚ æ‚¨ç”šè‡³å¯ä»¥ç«‹å³å¼€å§‹æ¸¸æˆï¼Œå¹¶å°è¯•æ›´æ”¹åœ°å›¾çš„å¤§å°æˆ–<b>åç§»åç§»</b> ï¼Œä»¥ç¡®ä¿è·Ÿè¸ªæ‰€æœ‰æ›´æ”¹ã€‚ <br><br> ç°åœ¨ï¼Œæ‚¨éœ€è¦ä»¥æŸç§æ–¹å¼åœ¨åœ°å›¾ä¸Šè·Ÿè¸ªéšœç¢ç‰©æœ¬èº«çš„å˜åŒ–ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†æ¯ä¸ªéšœç¢ç‰©æ”¾ç½®åœ¨åœ°å›¾ä¸Šçš„åˆ—è¡¨ä¸­ï¼Œè¯¥åˆ—è¡¨åˆå°†æ›´æ–°<b>Update</b>æ–¹æ³•ä¸­çš„æ¯ä¸ªå¸§ã€‚ <br><br> åœ¨<b>Map</b>ç±»ä¸­ï¼Œåˆ›å»ºä¸€ä¸ª<b>åœ°å›¾</b>ä¸Šæ‰€æœ‰å¯èƒ½éšœç¢ç‰©çš„åˆ—è¡¨ä»¥åŠä¸€äº›ç”¨äºæ³¨å†Œå®ƒä»¬çš„é™æ€æ–¹æ³•ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">åœ°å›¾</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> sealed <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Map</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*... â€¦*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Map ObjInstance; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;Obstacle&gt; obstacles = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;Obstacle&gt;(); <span class="hljs-comment"><span class="hljs-comment">/*... â€¦*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> bool RegisterObstacle(Obstacle obstacle) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (obstacle == Instance) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Instance.obstacles.Contains(obstacle) == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { Instance.obstacles.Add(obstacle); Instance.requireRebuild = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> bool UnregisterObstacle(Obstacle obstacle) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Instance.obstacles.Remove(obstacle)) { Instance.requireRebuild = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Map Instance { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ObjInstance == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) ObjInstance = FindObjectOfType&lt;Map&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ObjInstance; } } }</code> </pre> <br></div></div><br> åœ¨é™æ€<b>RegisterObstacle</b>æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å°†åœ¨åœ°å›¾ä¸Šæ³¨å†Œä¸€ä¸ªæ–°çš„<b>Obstacle</b>éšœç¢ç‰©å¹¶å°†å…¶æ·»åŠ åˆ°åˆ—è¡¨ä¸­ï¼Œä½†é¦–å…ˆå¿…é¡»è€ƒè™‘åˆ°åœ°å›¾æœ¬èº«ä¹Ÿæ˜¯ä»<b>Obstacle</b>ç±»ç»§æ‰¿çš„ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ£€æŸ¥æ˜¯å¦è¦å°è¯•å°†å¡æœ¬èº«æ³¨å†Œä¸ºéšœç¢ç‰©ã€‚ <br><br> ç›¸åï¼Œé™æ€çš„<b>UnregisterObstacle</b>æ–¹æ³•ä»åœ°å›¾ä¸Šæ¶ˆé™¤äº†éšœç¢ç‰©ï¼Œå¹¶åœ¨æˆ‘ä»¬å…è®¸é”€æ¯è¯¥éšœç¢ç‰©æ—¶å°†å…¶ä»åˆ—è¡¨ä¸­åˆ é™¤ã€‚ <br><br> åŒæ—¶ï¼Œæ¯æ¬¡æˆ‘ä»¬åœ¨åœ°å›¾ä¸Šæ·»åŠ æˆ–ç§»é™¤éšœç¢ç‰©æ—¶ï¼Œéƒ½å¿…é¡»é‡æ–°åˆ›å»ºåœ°å›¾æœ¬èº«ï¼Œå› æ­¤åœ¨æ‰§è¡Œè¿™äº›é™æ€æ–¹æ³•åï¼Œå°†<b>requireRebuild</b>å˜é‡è®¾ç½®ä¸º<b>true</b> ã€‚ <br><br> å¦å¤–ï¼Œä¸ºäº†æ–¹ä¾¿åœ°ä»ä»»ä½•è„šæœ¬è®¿é—®<b>Map</b>è„šæœ¬ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªé™æ€<b>Instance</b>å±æ€§ï¼Œè¯¥å±æ€§å°†è¿”å›ç»™æˆ‘<b>Mapçš„</b>è¿™ä¸ªå®ä¾‹ã€‚ <br><br> ç°åœ¨ï¼Œè®©æˆ‘ä»¬å›åˆ°<b>Obstacle</b>è„šæœ¬ä¸­ï¼Œåœ¨åœ°å›¾ä¸Šæ³¨å†Œéšœç¢ç‰©ï¼Œä¸ºæ­¤ï¼Œè¯·æ·»åŠ å‡ ä¸ª<b>OnEnable</b>å’Œ<b>OnDisable</b>æ–¹æ³•ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">éšœç¢ç‰©</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonoBehaviour</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*... â€¦*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> virtual <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> OnEnable() { Map.RegisterObstacle(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> virtual <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> OnDisable() { Map.UnregisterObstacle(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } }</code> </pre> <br></div></div><br> æ¯æ¬¡æˆ‘ä»¬åœ¨åœ°å›¾ä¸Šç©æ¸¸æˆæ—¶åˆ›å»ºä¸€ä¸ªæ–°éšœç¢ç‰©æ—¶ï¼Œå®ƒå°†è‡ªåŠ¨åœ¨<b>OnEnable</b>æ–¹æ³•ä¸­æ³¨å†Œï¼Œåœ¨æ„å»ºæ–°ç½‘æ ¼æ—¶ä¼šè€ƒè™‘åˆ°å®ƒï¼Œå¹¶åœ¨é”€æ¯æˆ–ç¦ç”¨å®ƒæ—¶ä½¿ç”¨<b>OnDisable</b>æ–¹æ³•å°†è‡ªå·±ä»åœ°å›¾ä¸Š<b>ç§»å¼€</b> ã€‚ <br><br> å®ƒä»…ç”¨äºåœ¨é‡è½½çš„<b>CheckChanges</b>æ–¹æ³•ä¸­è·Ÿè¸ª<b>Map</b>è„šæœ¬ä¸­éšœç¢æœ¬èº«çš„å˜åŒ–ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">åœ°å›¾</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> sealed <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Map</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*... â€¦*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> bool CheckChanges() { float diff = Mathf.Abs(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempNodeSize - <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (diff &gt; <span class="hljs-number"><span class="hljs-number">0.01</span></span>f) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempNodeSize = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } diff = (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempOffset - <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.offset).sqrMagnitude; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (diff &gt; <span class="hljs-number"><span class="hljs-number">0.01</span></span>f) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tempOffset = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.offset; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } foreach(Obstacle obstacle <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.obstacles) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (obstacle.CheckChanges()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> base.CheckChanges(); } <span class="hljs-comment"><span class="hljs-comment">/*... â€¦*/</span></span> }</code> </pre> <br></div></div><br> ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†åœ°å›¾ï¼Œé‡åˆ°äº†éšœç¢-ä¸€èˆ¬æ¥è¯´ï¼Œæ„å»ºç½‘æ ¼æ‰€éœ€çš„ä¸€åˆ‡ï¼Œç°åœ¨æ‚¨å¯ä»¥ç»§ç»­è¿›è¡Œæœ€é‡è¦çš„äº‹æƒ…ã€‚ <br><br><h4> ç½‘æ ¼åˆ’åˆ† </h4><br> æœ€ç®€å•çš„ç½‘æ ¼æ˜¯ç‚¹çš„äºŒç»´æ•°ç»„ã€‚ è¦æ„å»ºå®ƒï¼Œæ‚¨éœ€è¦çŸ¥é“åœ°å›¾çš„å¤§å°å’Œå…¶ä¸Šçš„ç‚¹çš„å¤§å°ï¼Œç»è¿‡ä¸€äº›è®¡ç®—ï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ°´å¹³å’Œå‚ç›´çš„ç‚¹æ•°ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„ç½‘æ ¼ã€‚ <br><br> æœ‰å¤šç§æ–¹æ³•å¯ä»¥åœ¨ç½‘æ ¼ä¸Šæ‰¾åˆ°è·¯å¾„ã€‚ ä½†æ˜¯ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæœ€ä¸»è¦çš„æ˜¯è¦äº†è§£å¦‚ä½•æ­£ç¡®ä½¿ç”¨ä»»åŠ¡ç³»ç»Ÿçš„åŠŸèƒ½ï¼Œå› æ­¤åœ¨è¿™é‡Œï¼Œæˆ‘å°†ä¸è€ƒè™‘ç”¨äºæŸ¥æ‰¾è·¯å¾„çš„å„ç§é€‰é¡¹ï¼Œå®ƒä»¬çš„ä¼˜ç¼ºç‚¹ï¼Œä½†æ˜¯å°†é‡‡ç”¨æœ€ç®€å•çš„æœç´¢é€‰é¡¹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">A *</a> ã€‚ <br><br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé™¤äº†ä½ç½®ä¹‹å¤–ï¼Œç½‘æ ¼ä¸Šçš„æ‰€æœ‰ç‚¹éƒ½åº”å…·æœ‰åæ ‡å’Œé€šç•…æ€§ã€‚ <br><br> æœ‰äº†é€šç•…æ€§ï¼Œæˆ‘è®¤ä¸ºä¸€åˆ‡éƒ½æ¸…æ¥šä¸ºä»€ä¹ˆä¼šéœ€è¦å®ƒï¼Œä½†æ˜¯åæ ‡å°†æŒ‡ç¤ºç‚¹åœ¨ç½‘æ ¼ä¸Šçš„é¡ºåºï¼Œè¿™äº›åæ ‡å¹¶ä¸ä¸“é—¨ä¸ç‚¹åœ¨ç©ºé—´ä¸­çš„ä½ç½®ç›¸å…³ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªç®€å•çš„ç½‘æ ¼ï¼Œæ˜¾ç¤ºäº†ä¸ä½ç½®çš„åæ ‡å·®å¼‚ã€‚ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7c1/c12/466/7c1c124662f7c41ecb2a1c55939a1a64.png" alt="å›¾ç‰‡"><br>  <i>ä¸ºä»€ä¹ˆè¦åæ ‡ï¼Ÿ</i> <br> äº‹å®æ˜¯ï¼Œä¸ºäº†ç»Ÿä¸€è¡¨ç¤ºä¸€ä¸ªå¯¹è±¡åœ¨ç©ºé—´ä¸­çš„ä½ç½®ï¼Œ <b>ä½¿ç”¨</b>äº†ä¸€ä¸ªéå¸¸ä¸å‡†ç¡®çš„ç®€å•<b>æµ®ç‚¹</b> ï¼Œå®ƒå¯èƒ½æ˜¯åˆ†æ•°æˆ–è´Ÿæ•°ï¼Œå› æ­¤å¾ˆéš¾ç”¨å®ƒæ¥åœ¨åœ°å›¾ä¸Šå®ç°è·¯å¾„æœç´¢ã€‚ åæ ‡ä»¥æ¸…æ™°çš„<b>int</b>å½¢å¼ç”Ÿæˆï¼Œè¯¥<b>int</b>å§‹ç»ˆä¸ºæ­£ï¼Œå¹¶ä¸”åœ¨æœç´¢ç›¸é‚»ç‚¹æ—¶æ›´å®¹æ˜“ä½¿ç”¨ã€‚ <br><br> é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç‚¹å¯¹è±¡ï¼Œè¿™å°†æ˜¯ä¸€ä¸ªç®€å•çš„<b>Node</b>ç»“æ„ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ç»“ç‚¹</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> struct Node { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int id; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vector2 position; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vector2Int coords; }</code> </pre> <br></div></div><br> è¯¥ç»“æ„å°†åŒ…å«<b>Vector2</b>å½¢å¼çš„<b>ä½ç½®</b> ï¼Œå…¶ä¸­ä½¿ç”¨æ­¤å˜é‡ï¼Œæˆ‘ä»¬å°†åœ¨ç©ºé—´ä¸­ç»˜åˆ¶ä¸€ä¸ªç‚¹ã€‚  <b>Vector2Int</b>å½¢å¼çš„<b>coords</b>åæ ‡<b>å˜é‡</b>å°†æŒ‡ç¤ºåœ°å›¾ä¸ŠæŸä¸ªç‚¹çš„åæ ‡ï¼Œè€Œ<b>id</b>å˜é‡ï¼ˆå…¶æ•°å­—å¸å·ï¼‰å°†ä½¿ç”¨å®ƒæ¥æ¯”è¾ƒç½‘æ ¼ä¸Šçš„ä¸åŒç‚¹å¹¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨ç‚¹ã€‚ <br><br> è¯¥ç‚¹çš„å¼€æ”¾æ€§å°†ä»¥å…¶<b>boolean</b>å±æ€§çš„å½¢å¼è¡¨ç¤ºï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬æ— æ³•åœ¨ä»»åŠ¡ç³»ç»Ÿä¸­ä½¿ç”¨<i>å¯è½¬æ¢</i>æ•°æ®<i>ç±»å‹</i> ï¼Œå› æ­¤æˆ‘ä»¬å°†ä»¥<b>int</b>æ•°çš„å½¢å¼æŒ‡ç¤ºå…¶å¼€æ”¾æ€§ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä½¿ç”¨äº†ä¸€ä¸ªç®€å•çš„æšä¸¾<b>NodeType</b> ï¼Œå…¶ä¸­ï¼š0ä¸æ˜¯å¯ä¼ é€’çš„ç‚¹ï¼Œ 1æ˜¯åˆæ ¼çš„ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">NodeTypeå’ŒNode</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> enum NodeType { NonWalkable = <span class="hljs-number"><span class="hljs-number">0</span></span>, Walkable = <span class="hljs-number"><span class="hljs-number">1</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> struct Node { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int id; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vector2 position; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vector2Int coords; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> int nodeType; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> bool isWalkable { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeType == (int)NodeType.Walkable;} } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Node(int id, Vector2 position, Vector2Int coords, NodeType type) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.id = id; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.position = position; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.coords = coords; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeType = (int)type; } }</code> </pre> <br></div></div><br> å¦å¤–ï¼Œä¸ºäº†æ–¹ä¾¿å¤„ç†ç‚¹ï¼Œæˆ‘å°†é‡è½½<b>Equals</b>æ–¹æ³•ï¼Œä»¥ä½¿å…¶æ›´å®¹æ˜“æ¯”è¾ƒç‚¹ï¼Œå¹¶è¡¥å……å­˜åœ¨ç‚¹çš„éªŒè¯æ–¹æ³•ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ç»“ç‚¹</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> struct Node { <span class="hljs-comment"><span class="hljs-comment">/*... â€¦*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> bool Equals(object obj) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (obj <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> Node) { Node other = (Node)obj; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.id == other.id; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> base.Equals(obj); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> implicit operator bool(Node node) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> node.id &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; } }</code> </pre> <br></div></div><br> ç”±äºç½‘æ ¼ä¸Šç‚¹çš„<b>ID</b>å·ä»¥1ä¸ªå•ä½å¼€å¤´ï¼Œå› æ­¤æˆ‘å°†æ£€æŸ¥ç‚¹æ˜¯å¦å­˜åœ¨ï¼Œä»¥ä½œä¸ºå…¶<b>ID</b>å¤§äº0çš„æ¡ä»¶ã€‚ <br><br> è½¬åˆ°<b>Map</b>ç±»ï¼Œæˆ‘ä»¬å°†ä¸ºåˆ›å»ºåœ°å›¾åšå‡†å¤‡ã€‚ <br> æˆ‘ä»¬å·²ç»è¿›è¡Œäº†æ›´æ”¹åœ°å›¾å‚æ•°çš„æ£€æŸ¥ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦ç¡®å®šå¦‚ä½•æ‰§è¡Œæ„å»ºç½‘æ ¼çš„è¿‡ç¨‹ã€‚ ä¸ºæ­¤ï¼Œåˆ›å»ºä¸€ä¸ªæ–°å˜é‡å’Œå‡ ç§æ–¹æ³•ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">åœ°å›¾</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> sealed <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Map</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*... â€¦*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> bool rebuilding { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Rebuild() {} <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> OnRebuildStart() {} <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> OnRebuildFinish() {} <span class="hljs-comment"><span class="hljs-comment">/*... â€¦*/</span></span> }</code> </pre> <br></div></div><br>  <b>é‡å»º</b>å±æ€§å°†æŒ‡ç¤º<b>ç½‘æ ¼åˆ’åˆ†</b>è¿‡ç¨‹æ˜¯å¦æ­£åœ¨è¿›è¡Œã€‚  <b>Rebuild</b>æ–¹æ³•å°†æ”¶é›†ç”¨äºæ„å»ºç½‘æ ¼çš„æ•°æ®å’Œä»»åŠ¡ï¼Œç„¶å<b>OnRebuildStart</b>æ–¹æ³•å°†å¯åŠ¨ç½‘æ ¼æ„å»ºè¿‡ç¨‹ï¼Œè€Œ<b>OnRebuildFinish</b>æ–¹æ³•å°†ä»ä»»åŠ¡ä¸­æ”¶é›†æ•°æ®ã€‚ <br><br> ç°åœ¨ï¼Œè®©æˆ‘ä»¬<b>ç¨å¾®</b>æ›´æ”¹<b>UpdateChanges</b>æ–¹æ³•ï¼Œä»¥ä¾¿è€ƒè™‘ç½‘æ ¼æ¡ä»¶ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">åœ°å›¾</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> sealed <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Map</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*... â€¦*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> bool rebuilding { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> UpdateChanges() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.rebuilding) { print(â€œ  ...â€); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.requireRebuild) { print(â€œ  ,   !â€); Rebuild(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.requireRebuild = CheckChanges(); } } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Rebuild() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.rebuilding) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; print(â€œ !â€); OnRebuildStart(); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> OnRebuildStart() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.rebuilding = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> OnRebuildFinish() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.rebuilding = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/*... â€¦*/</span></span> }</code> </pre> <br></div></div><br> å¦‚æ‚¨ç°åœ¨æ‰€çœ‹åˆ°çš„ï¼Œåœ¨<b>UpdateChanges</b>æ–¹æ³•ä¸­<b>å­˜åœ¨</b>ä¸€ä¸ªæ¡ä»¶ï¼Œå³åœ¨æ„å»ºæ—§ç½‘æ ¼æ—¶ä¸ä¼šå¼€å§‹å¼€å§‹æ„å»ºæ–°çš„ç½‘æ ¼ï¼Œåœ¨<b>Rebuild</b>æ–¹æ³•ä¸­ï¼Œç¬¬ä¸€ä¸ªæ“ä½œå°†æ£€æŸ¥ç½‘æ ¼åˆ’åˆ†è¿‡ç¨‹æ˜¯å¦å·²åœ¨è¿›è¡Œä¸­ã€‚ <br><br><h4> è§£å†³é—®é¢˜ </h4><br> ç°åœ¨ä»‹ç»ä¸€ä¸‹æ„å»ºåœ°å›¾çš„è¿‡ç¨‹ã€‚ <br> ç”±äºæˆ‘ä»¬å°†ä½¿ç”¨ä»»åŠ¡ç³»ç»Ÿå¹¶å¹¶è¡Œæ„å»ºç½‘æ ¼æ¥æ„å»ºåœ°å›¾ï¼Œå› æ­¤æˆ‘ä½¿ç”¨äº†<b>IJobParallelFor</b>ä»»åŠ¡çš„ç±»å‹ï¼Œè¯¥ä»»åŠ¡å°†æ‰§è¡Œä¸€å®šçš„æ¬¡æ•°ã€‚ ä¸ºäº†ä¸ä½¿ç”¨ä»»ä½•ä¸€ä¸ªå•ç‹¬çš„ä»»åŠ¡åŠ è½½æ„å»ºè¿‡ç¨‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ‰“åŒ…åˆ°ä¸€ä¸ª<b>JobHandleä¸­</b>çš„ä»»åŠ¡æ± ã€‚ <br><br> é€šå¸¸ï¼Œè¦æ„å»ºç½‘æ ¼ï¼Œè¯·ä½¿ç”¨å½¼æ­¤åµŒå¥—çš„ä¸¤ä¸ªå¾ªç¯æ¥æ„å»ºï¼Œä¾‹å¦‚æ°´å¹³å’Œå‚ç›´ã€‚ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è¿˜å°†å…ˆæ°´å¹³ç„¶åå†å‚ç›´æ„å»ºç½‘æ ¼ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬åœ¨<b>Rebuild</b>æ–¹æ³•ä¸­è®¡ç®—æ°´å¹³ç‚¹å’Œå‚ç›´ç‚¹çš„æ•°é‡ï¼Œç„¶ååœ¨<b>Rebuild</b>æ–¹æ³•ä¸­æ²¿ç€å‚ç›´ç‚¹è¿›è¡Œå¾ªç¯ï¼Œç„¶ååœ¨ä»»åŠ¡ä¸­å¹¶è¡Œæ„å»ºæ°´å¹³ç‚¹ã€‚ ä¸ºäº†æ›´å¥½åœ°æƒ³è±¡æ„å»ºè¿‡ç¨‹ï¼Œè¯·çœ‹ä¸‹é¢çš„åŠ¨ç”»ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ç½‘æ ¼åˆ’åˆ†</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/101/625/183/10162518305232afb889f9d8a45b70da.gif" alt="å›¾ç‰‡"><br></div></div><br> å‚ç›´ç‚¹çš„æ•°é‡å°†æŒ‡ç¤ºä»»åŠ¡çš„æ•°é‡ï¼Œä¾æ¬¡ï¼Œæ¯ä¸ªä»»åŠ¡å°†ä»…æ°´å¹³æ„å»ºç‚¹ï¼Œå®Œæˆæ‰€æœ‰ä»»åŠ¡åï¼Œå°†è¿™äº›ç‚¹æ±‡æ€»åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘éœ€è¦ä½¿ç”¨ç±»ä¼¼<b>IJobParallelFor</b>çš„ä»»åŠ¡æ¥å°†ç½‘æ ¼ä¸Šçš„ç‚¹çš„ç´¢å¼•æ°´å¹³ä¼ é€’åˆ°<b>Execute</b>æ–¹æ³•ä¸­çš„åŸå› ã€‚ <br><br> å› æ­¤ï¼Œæˆ‘ä»¬æœ‰äº†ç‚¹ç»“æ„ï¼Œç°åœ¨æ‚¨å¯ä»¥åˆ›å»º<b>Job</b>ä»»åŠ¡çš„ç»“æ„å¹¶ä»<b>IJobParallelFor</b>æ¥å£ç»§æ‰¿å®ƒï¼Œè¿™é‡Œçš„ä¸€åˆ‡éƒ½å¾ˆç®€å•ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å·¥ä½œæœºä¼š</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> struct Job : IJobParallelFor { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Execute(int index) {} }</code> </pre> <br></div></div><br> è¿”å›åˆ°<b>Map</b>ç±»çš„<b>Rebuild</b>æ–¹æ³•ï¼Œåœ¨æ­¤æˆ‘ä»¬å°†ä¸ºç½‘æ ¼æµ‹é‡è¿›è¡Œå¿…è¦çš„è®¡ç®—ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">åœ°å›¾</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> sealed <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Map</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*... ...*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Rebuild() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.rebuilding) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; print(â€œ !â€); Vector2 mapSize = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.size - <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.offset * <span class="hljs-number"><span class="hljs-number">2</span></span>f; int horizontals = Mathf.RoundToInt(mapSize.x / <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize); int verticals = Mathf.RoundToInt(mapSize.y / <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (horizontals &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { OnRebuildFinish(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } Vector2 center = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.position; Vector2 origin = center - (mapSize / <span class="hljs-number"><span class="hljs-number">2</span></span>f); OnRebuildStart(); } <span class="hljs-comment"><span class="hljs-comment">/*... ...*/</span></span> }</code> </pre> <br></div></div><br> åœ¨<b>Rebuild</b>æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘ç¼©è¿›æ¥è®¡ç®—<b>mapSize</b>åœ°å›¾çš„ç¡®åˆ‡å¤§å°ï¼Œç„¶ååœ¨<b>å‚ç›´æ–¹å‘ä¸Šå‚ç›´</b>å†™å…¥ç‚¹æ•°ï¼Œåœ¨<b>æ°´å¹³æ–¹å‘ä¸Šæ°´å¹³</b>å†™å…¥ç‚¹æ•°ã€‚ å¦‚æœå‚ç›´ç‚¹çš„æ•°é‡ä¸º0ï¼Œåˆ™æˆ‘ä»¬åœæ­¢æ„å»ºåœ°å›¾ï¼Œå¹¶è°ƒç”¨<b>OnRebuildFinish</b>æ–¹æ³•ä»¥å®Œæˆè¯¥è¿‡ç¨‹ã€‚  <b>origin</b>å˜é‡å°†æŒ‡ç¤ºæˆ‘ä»¬å°†å¼€å§‹æ„å»ºç½‘æ ¼çš„ä½ç½®-åœ¨ç¤ºä¾‹ä¸­ï¼Œè¿™æ˜¯åœ°å›¾ä¸Šçš„å·¦ä¸‹è§’ã€‚ <br><br> ç°åœ¨ï¼Œæ‚¨å¯ä»¥è½¬åˆ°ä»»åŠ¡æœ¬èº«ï¼Œå¹¶ç”¨æ•°æ®å¡«å……å®ƒä»¬ã€‚ <br> åœ¨æ„å»ºç½‘æ ¼çš„è¿‡ç¨‹ä¸­ï¼Œä»»åŠ¡å°†éœ€è¦ä¸€ä¸ªå°†è¦æ”¾ç½®ç‚¹çš„<b>NativeArray</b>æ•°ç»„ï¼Œè€Œä¸”ç”±äºæˆ‘ä»¬åœ¨åœ°å›¾ä¸Šæœ‰éšœç¢ç‰©ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦å°†å®ƒä»¬ä¼ é€’ç»™ä»»åŠ¡ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å¦ä¸€ä¸ª<b>NativeArray</b>æ•°ç»„ï¼Œç„¶åæˆ‘ä»¬éœ€è¦é—®é¢˜ä¸­ç‚¹çš„å¤§å°ï¼Œå³æˆ‘ä»¬å°†åœ¨å…¶ä¸Šæ„å»ºç‚¹çš„åˆå§‹ä½ç½®ä»¥åŠåºåˆ—çš„åˆå§‹åæ ‡ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å·¥ä½œæœºä¼š</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> struct Job : IJobParallelFor { [WriteOnly] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> NativeArray&lt;Node&gt; array; [ReadOnly] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> NativeArray&lt;Rect&gt; bounds; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> float nodeSize; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vector2 startPos; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vector2Int startCoords; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Execute(int index) {} }</code> </pre> <br></div></div><br> æˆ‘ç”¨å±æ€§<b>WriteOnly</b>æ ‡è®°äº†ç‚¹æ•°ç»„<b>ï¼Œ</b>å› ä¸ºåœ¨ä»»åŠ¡ä¸­åªéœ€è¦å°†æ¥æ”¶åˆ°çš„ç‚¹â€œ <i>å†™å…¥</i> â€åˆ°æ•°ç»„ä¸­ï¼Œç›¸åï¼Œéšœç¢ç‰©<b>è¾¹ç•Œ</b>çš„æ•°ç»„å°†ç”¨<b>ReadOnly</b>å±æ€§æ ‡è®°ï¼Œå› ä¸ºåœ¨ä»»åŠ¡ä¸­æˆ‘ä»¬å°†ä»…ä»è¯¥æ•°ç»„ä¸­â€œ <i>è¯»å–</i> â€æ•°æ®ã€‚ <br><br> å¥½äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬ç¨åå†è¿›è¡Œç‚¹æœ¬èº«çš„è®¡ç®—ã€‚ <br><br> ç°åœ¨å›åˆ°<b>Map</b>ç±»ï¼Œæˆ‘ä»¬åœ¨å…¶ä¸­è¡¨ç¤ºä»»åŠ¡ä¸­æ¶‰åŠçš„æ‰€æœ‰å˜é‡ã€‚ <br> é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå…¨å±€<b>çš„</b>ä»»åŠ¡<b>å¥æŸ„</b> ï¼Œä¸€ä¸ª<b>NativeArray</b>å½¢å¼çš„éšœç¢æ•°ç»„ï¼Œä¸€ä¸ªä»»åŠ¡åˆ—è¡¨ï¼Œå…¶ä¸­å°†åŒ…å«åœ¨ç½‘æ ¼ä¸Šæ¥æ”¶åˆ°çš„æ‰€æœ‰ç‚¹å’Œåœ¨<b>å­—å…¸</b>ä¸Šå…·æœ‰åœ°å›¾ä¸Šæ‰€æœ‰åæ ‡å’Œç‚¹çš„æ‰€æœ‰ç‚¹ï¼Œä»¥ä¾¿ä»¥åæœç´¢å®ƒä»¬ä¼šæ›´åŠ æ–¹ä¾¿ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">åœ°å›¾</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> sealed <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Map</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*... ...*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> JobHandle handle; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> NativeArray&lt;Rect&gt; bounds; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> HashSet&lt;NativeArray&lt;Node&gt;&gt; jobs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashSet&lt;NativeArray&lt;Node&gt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Dictionary&lt;Vector2Int, Node&gt; nodes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;Vector2Int, Node&gt;(); <span class="hljs-comment"><span class="hljs-comment">/*... ...*/</span></span> }</code> </pre> <br></div></div><br> å†ä¸€æ¬¡ï¼Œæˆ‘ä»¬è¿”å›<b>Rebuild</b>æ–¹æ³•å¹¶ç»§ç»­æ„å»ºç½‘æ ¼ã€‚ <br> é¦–å…ˆï¼Œåˆå§‹åŒ–éšœç¢çš„<b>bounds</b>æ•°ç»„ä»¥å°†å…¶ä¼ é€’ç»™ä»»åŠ¡ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ”¹å»º</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Rebuild() { <span class="hljs-comment"><span class="hljs-comment">/*... ...*/</span></span> Vector2 center = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.position; Vector2 origin = center - (mapSize / <span class="hljs-number"><span class="hljs-number">2</span></span>f); int count = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.obstacles.Count; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bounds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NativeArray&lt;Rect&gt;(count, Allocator.TempJob, NativeArrayOptions.UninitializedMemory); } OnRebuildStart(); }</code> </pre> <br></div></div><br> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡å¸¦æœ‰ä¸‰ä¸ªå‚æ•°çš„æ–°æ„é€ å‡½æ•°åˆ›å»º<b>NativeArray</b>çš„å®ä¾‹ã€‚ æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æ£€æŸ¥äº†å‰ä¸¤ä¸ªå‚æ•°ï¼Œä½†æ˜¯ç¬¬ä¸‰ä¸ªå‚æ•°å°†å¸®åŠ©æˆ‘ä»¬èŠ‚çœåˆ›å»ºæ•°ç»„çš„æ—¶é—´ã€‚ äº‹å®æ˜¯ï¼Œæˆ‘ä»¬å°†åœ¨åˆ›å»ºæ•°ç»„åç«‹å³å°†æ•°æ®å†™å…¥æ•°ç»„ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬æ— éœ€ç¡®ä¿å°†å…¶æ¸…é™¤ã€‚ æ­¤å‚æ•°å¯¹<b>NativeArray</b>å¾ˆæœ‰ç”¨ï¼Œå®ƒå°†ä»…åœ¨ä»»åŠ¡çš„<i>è¯»å–</i>æ¨¡å¼ä¸‹ä½¿ç”¨ã€‚ <br><br> å› æ­¤ï¼Œç„¶åæˆ‘ä»¬ç”¨æ•°æ®å¡«å……<b>bounds</b>æ•°ç»„ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ”¹å»º</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Rebuild() { <span class="hljs-comment"><span class="hljs-comment">/*... ...*/</span></span> Vector2 center = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.position; Vector2 origin = center - (mapSize / <span class="hljs-number"><span class="hljs-number">2</span></span>f); int count = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.obstacles.Count; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bounds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NativeArray&lt;Rect&gt;(count, Allocator.TempJob, NativeArrayOptions.UninitializedMemory); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(int i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; count; i++) { Obstacle obs = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.obstacles[i]; Vector2 position = obs.position; Rect rect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Rect(Vector2.zero, obs.size); rect.center = position; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bounds[i] = rect; } } OnRebuildStart(); }</code> </pre> <br></div></div><br> ç°åœ¨æˆ‘ä»¬å¯ä»¥ç»§ç»­åˆ›å»ºä»»åŠ¡ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†å¾ªç¯éå†ç½‘æ ¼çš„æ‰€æœ‰å‚ç›´è¡Œã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ”¹å»º</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Rebuild() { <span class="hljs-comment"><span class="hljs-comment">/*... ...*/</span></span> Vector2 center = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.position; Vector2 origin = center - (mapSize / <span class="hljs-number"><span class="hljs-number">2</span></span>f); int count = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.obstacles.Count; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bounds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NativeArray&lt;Rect&gt;(count, Allocator.TempJob, NativeArrayOptions.UninitializedMemory); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(int i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; count; i++) { Obstacle obs = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.obstacles[i]; Vector2 position = obs.position; Rect rect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Rect(Vector2.zero, obs.size); rect.center = position; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bounds[i] = rect; } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; verticals; i++) { float xPos = origin.x; float yPos = origin.y + (i * <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize) + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize / <span class="hljs-number"><span class="hljs-number">2</span></span>f; } OnRebuildStart(); }</code> </pre> <br></div></div><br> é¦–å…ˆï¼Œåœ¨<b>xPos</b>å’Œ<b>yPosä¸­ï¼Œ</b>æˆ‘ä»¬è·å¾—åºåˆ—çš„åˆå§‹æ°´å¹³ä½ç½®ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ”¹å»º</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Rebuild() { <span class="hljs-comment"><span class="hljs-comment">/*... ...*/</span></span> Vector2 center = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.position; Vector2 origin = center - (mapSize / <span class="hljs-number"><span class="hljs-number">2</span></span>f); int count = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.obstacles.Count; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bounds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NativeArray&lt;Rect&gt;(count, Allocator.TempJob, NativeArrayOptions.UninitializedMemory); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(int i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; count; i++) { Obstacle obs = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.obstacles[i]; Vector2 position = obs.position; Rect rect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Rect(Vector2.zero, obs.size); rect.center = position; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bounds[i] = rect; } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; verticals; i++) { float xPos = origin.x; float yPos = origin.y + (i * <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize) + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize / <span class="hljs-number"><span class="hljs-number">2</span></span>f; NativeArray&lt;Node&gt; array = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NativeArray&lt;Node&gt;(horizontals, Allocator.Persistent); Job job = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Job(); job.startCoords = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2Int(i * horizontals, i); job.startPos = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(xPos, yPos); job.nodeSize = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize; job.bounds = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bounds; job.array = array; } OnRebuildStart(); }</code> </pre> <br></div></div><br> æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„<b>NativeArray</b> ï¼Œåœ¨è¯¥ä½ç½®å°†æ”¾ç½®ä»»åŠ¡ä¸­çš„ç‚¹ï¼Œåœ¨æ­¤<b>æ•°ç»„ä¸­ï¼Œ</b>æ‚¨éœ€è¦æŒ‡å®šæ°´å¹³åˆ›å»ºçš„ç‚¹æ•°å’Œåˆ†é…ç±»å‹<b>Persistent</b> ï¼Œå› ä¸ºè¯¥ä»»åŠ¡å¯èƒ½éœ€è¦ä¸€å¸§ä»¥ä¸Šçš„æ—¶é—´ã€‚ <br> ä¹‹åï¼Œåˆ›å»º<b>Job</b>ä»»åŠ¡å®ä¾‹æœ¬èº«ï¼Œå°†<b>startCoords</b>ç³»åˆ—çš„åˆå§‹åæ ‡ï¼Œ <b>startPos</b>ç³»åˆ—çš„åˆå§‹ä½ç½®ï¼Œ <b>nodeSize</b>ç‚¹çš„å¤§å°ï¼Œéšœç¢çš„<b>è¾¹ç•Œ</b>æ•°ç»„ä»¥åŠç‚¹æœ¬èº«çš„æ•°ç»„æ”¾åœ¨æœ«å°¾ã€‚ <br> ä»…ä¿ç•™å°†ä»»åŠ¡ç½®äº<b>å¥æŸ„</b>å’Œå…¨å±€ä»»åŠ¡åˆ—è¡¨ä¸­ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ”¹å»º</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Rebuild() { <span class="hljs-comment"><span class="hljs-comment">/*... ...*/</span></span> Vector2 center = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.position; Vector2 origin = center - (mapSize / <span class="hljs-number"><span class="hljs-number">2</span></span>f); int count = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.obstacles.Count; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bounds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NativeArray&lt;Rect&gt;(count, Allocator.TempJob, NativeArrayOptions.UninitializedMemory); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(int i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; count; i++) { Obstacle obs = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.obstacles[i]; Vector2 position = obs.position; Rect rect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Rect(Vector2.zero, obs.size); rect.center = position; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bounds[i] = rect; } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; verticals; i++) { float xPos = origin.x; float yPos = origin.y + (i * <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize) + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize / <span class="hljs-number"><span class="hljs-number">2</span></span>f; NativeArray&lt;Node&gt; array = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NativeArray&lt;Node&gt;(horizontals, Allocator.Persistent); Job job = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Job(); job.startCoords = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2Int(i * horizontals, i); job.startPos = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(xPos, yPos); job.nodeSize = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize; job.bounds = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bounds; job.array = array; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handle = job.Schedule(horizontals, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handle); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.jobs.Add(array); } OnRebuildStart(); }</code> </pre> <br></div></div><br> åšå®Œäº† æˆ‘ä»¬æœ‰ä¸€ä¸ªä»»åŠ¡åŠå…¶å…¬å…±<b>å¥æŸ„</b>çš„åˆ—è¡¨ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥<b>é€šè¿‡</b>åœ¨<b>OnRebuildStart</b>æ–¹æ³•ä¸­è°ƒç”¨å…¶<b>Complete</b>æ–¹æ³•æ¥è¿è¡Œæ­¤<b>å¥æŸ„</b> ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">Onrebuildstart</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> OnRebuildStart() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.rebuilding = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handle.Complete(); }</code> </pre> <br></div></div><br> ç”±äº<b>é‡å»º</b>å˜é‡å°†æŒ‡ç¤º<b>ç½‘æ ¼åˆ’åˆ†</b>è¿‡ç¨‹æ­£åœ¨è¿›è¡Œä¸­ï¼Œå› æ­¤<b>UpdateChanges</b>æ–¹æ³•<b>æœ¬èº«</b>ä¹Ÿå¿…é¡»æŒ‡å®šæ­¤è¿‡ç¨‹å°†ä½¿ç”¨<b>handle</b>åŠå…¶<b>IsCompleted</b>å±æ€§ç»“æŸçš„æ¡ä»¶ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ›´æ–°å˜æ›´</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> UpdateChanges() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.rebuilding) { print(â€œ  ...â€); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handle.IsCompleted) OnRebuildFinish(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.requireRebuild) { print(â€œ  ,   !â€); Rebuild(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.requireRebuild = CheckChanges(); } } }</code> </pre> <br></div></div><br> å®Œæˆä»»åŠ¡åï¼Œå°†è°ƒç”¨<b>OnRebuildFinish</b>æ–¹æ³•ï¼Œåœ¨<b>è¯¥</b>æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å·²ç»å°†æ¥æ”¶åˆ°çš„ç‚¹æ”¶é›†åˆ°ä¸€ä¸ªå¸¸è§„<b>Dictionary</b>åˆ—è¡¨ä¸­ï¼Œæœ€é‡è¦çš„æ˜¯ï¼Œæ¸…é™¤äº†å ç”¨çš„èµ„æºã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">OnRebuildFinish</b> <div class="spoiler_text"><pre> <code class="actionscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> OnRebuildFinish() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodes.Clear(); foreach (NativeArray&lt;Node&gt; array <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.jobs) { foreach (Node node <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> array) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodes.Add(node.coords, node); array.Dispose(); } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.jobs.Clear(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bounds.IsCreated) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bounds.Dispose(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.requireRebuild = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.rebuilding = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é¦–å…ˆï¼Œæˆ‘ä»¬</font><font style="vertical-align: inherit;">ä»ä¹‹å‰çš„ç‚¹ä¸­</font><font style="vertical-align: inherit;">æ¸…é™¤</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èŠ‚ç‚¹</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­—å…¸</font><font style="vertical-align: inherit;">ï¼Œç„¶åä½¿ç”¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foreachå¾ªç¯å¯¹</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»ä»»åŠ¡ä¸­æ¥æ”¶åˆ°çš„æ‰€æœ‰ç‚¹</font><b><font style="vertical-align: inherit;">è¿›è¡Œ</font></b><font style="vertical-align: inherit;">æ’åº</font><font style="vertical-align: inherit;">ï¼Œç„¶å</font><font style="vertical-align: inherit;">å°†å®ƒä»¬æ”¾å…¥</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èŠ‚ç‚¹</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­—å…¸ä¸­</font><font style="vertical-align: inherit;">ï¼Œå…¶ä¸­é”®æ˜¯ç‚¹çš„åæ ‡ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸æ˜¯ä½ç½®</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ï¼‰ï¼Œè€Œå€¼æ˜¯ç‚¹æœ¬èº«ã€‚</font><font style="vertical-align: inherit;">æœ‰äº†è¿™æœ¬è¯å…¸çš„å¸®åŠ©ï¼Œæˆ‘ä»¬å°†å¯ä»¥æ›´è½»æ¾åœ°åœ¨åœ°å›¾ä¸Šæœç´¢ç›¸é‚»ç‚¹ã€‚</font><font style="vertical-align: inherit;">å¡«å……åï¼Œæˆ‘ä»¬</font><font style="vertical-align: inherit;">ä½¿ç”¨</font><b><font style="vertical-align: inherit;">Dispose</font></b><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">æ¸…é™¤æ•°ç»„</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ•°ç»„</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œæœ€åæ¸…é™¤</font><b><font style="vertical-align: inherit;">ä½œä¸š</font></b><font style="vertical-align: inherit;">ä»»åŠ¡åˆ—è¡¨æœ¬èº«</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å¦‚æœå®ƒæ˜¯å…ˆå‰åˆ›å»ºçš„ï¼Œ</font><font style="vertical-align: inherit;">åˆ™è¿˜éœ€è¦æ¸…é™¤éšœç¢çš„</font><b><font style="vertical-align: inherit;">è¾¹ç•Œ</font></b><font style="vertical-align: inherit;">æ•°ç»„</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å®Œæˆæ‰€æœ‰è¿™äº›æ“ä½œä¹‹åï¼Œæˆ‘ä»¬å°†è·å¾—åœ°å›¾ä¸Šæ‰€æœ‰ç‚¹çš„åˆ—è¡¨ï¼Œç°åœ¨æ‚¨å¯ä»¥åœ¨èˆå°ä¸Šç»˜åˆ¶å®ƒä»¬ã€‚</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åƒè¿™æ ·</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/65f/2d0/5a8/65f2d05a86a6a508900fcf321d546089.gif" alt="å›¾ç‰‡"><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œè¯·åœ¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Map</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»ä¸­</font><font style="vertical-align: inherit;">åˆ›å»º</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OnDrawGizmos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">ï¼Œåœ¨è¯¥</font><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">ä¸­ç»˜åˆ¶ç‚¹ã€‚</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ°å›¾</font></font></b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> sealed <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Map</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*... â€¦*/</span></span> #<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> UNITY_EDITOR <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> OnDrawGizmos() {} #endif }</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ç°åœ¨ï¼Œé€šè¿‡å¾ªç¯ç»˜åˆ¶æ¯ä¸ªç‚¹ã€‚ </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ°å›¾</font></font></b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> sealed <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Map</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*... â€¦*/</span></span> #<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> UNITY_EDITOR <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> OnDrawGizmos() { foreach (Node node <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodes.Values) { Gizmos.DrawWireSphere(node.position, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize / <span class="hljs-number"><span class="hljs-number">10</span></span>f); } } #endif }</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å®Œæˆæ‰€æœ‰è¿™äº›æ“ä½œåï¼Œæˆ‘ä»¬çš„åœ°å›¾çœ‹èµ·æ¥æœ‰äº›æ— èŠï¼Œä¸ºäº†çœŸæ­£è·å¾—ç½‘æ ¼ï¼Œæ‚¨éœ€è¦å°†å„ä¸ªç‚¹ç›¸äº’è¿æ¥ã€‚ </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç½‘çœ¼</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/460/01d/f10/46001df105fcb2bd9fb90ef382888f26.gif" alt="å›¾ç‰‡"><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦æœç´¢ç›¸é‚»ç‚¹ï¼Œæˆ‘ä»¬åªéœ€è¦é€šè¿‡å…¶åœ¨8ä¸ªæ–¹å‘ä¸Šçš„åæ ‡æ¥æŸ¥æ‰¾æ‰€éœ€çš„ç‚¹ï¼Œå› æ­¤åœ¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Map</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»ä¸­ï¼Œæˆ‘ä»¬å°†</font><font style="vertical-align: inherit;">é€šè¿‡å…¶</font><b><font style="vertical-align: inherit;">GetNode</font></b><font style="vertical-align: inherit;">åæ ‡</font><font style="vertical-align: inherit;">åˆ›å»ºä¸€ä¸ªç®€å•çš„</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Directions</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹å‘çš„é™æ€æ•°ç»„</font><font style="vertical-align: inherit;">å’Œä¸€ä¸ªå•å…ƒæ ¼æœç´¢æ–¹æ³•</font><font style="vertical-align: inherit;">ã€‚</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ°å›¾</font></font></b> <div class="spoiler_text"><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> sealed <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Map</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Obstacle</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> readonly Vector2Int[] Directions = { Vector2Int.up, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2Int(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), Vector2Int.right, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2Int(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>), Vector2Int.down, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2Int(<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>), Vector2Int.left, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2Int(<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), }; <span class="hljs-comment"><span class="hljs-comment">/*... â€¦*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Node GetNode(Vector2Int coords) { Node result = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>(Node); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { result = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodes[coords]; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> {} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } #<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> UNITY_EDITOR <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> OnDrawGizmos() {} #endif }</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetNode</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">å°†æŒ‰</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èŠ‚ç‚¹</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ—è¡¨ä¸­çš„åæ ‡è¿”å›ä¸€ä¸ªç‚¹</font><font style="vertical-align: inherit;">ï¼Œä½†æ˜¯æ‚¨éœ€è¦ä»”ç»†è¿›è¡Œæ­¤æ“ä½œï¼Œå› ä¸ºå¦‚æœ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vector2Int</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åæ ‡</font><font style="vertical-align: inherit;">ä¸æ­£ç¡®ï¼Œåˆ™ä¼šå‘ç”Ÿé”™è¯¯ï¼Œå› æ­¤åœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">try catch</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¼‚å¸¸ç»•è¿‡</font><b><font style="vertical-align: inherit;">å—</font></b><font style="vertical-align: inherit;">ï¼Œå®ƒå°†å¸®åŠ©ç»•è¿‡è¯¥å¼‚å¸¸è€Œä¸æ˜¯</font><font style="vertical-align: inherit;">ä½¿æ•´ä¸ªåº”ç”¨ç¨‹åºå› é”™è¯¯</font><font style="vertical-align: inherit;">è€Œ</font><b><font style="vertical-align: inherit;">`` </font></b></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŒ‚èµ·</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ''ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†éå†æ‰€æœ‰æ–¹å‘ï¼Œå¹¶å°è¯•åœ¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OnDrawGizmos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•ä¸­æ‰¾åˆ°ç›¸é‚»çš„ç‚¹</font><font style="vertical-align: inherit;">ï¼Œæœ€é‡è¦çš„æ˜¯ï¼Œä¸è¦å¿˜è®°è€ƒè™‘ç‚¹çš„é€šç•…æ€§ã€‚</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ondrawgizmos</font></font></b> <div class="spoiler_text"><pre> <code class="actionscript hljs"> #<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> UNITY_EDITOR <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> OnDrawGizmos() { Color c = Gizmos.color; foreach (Node node <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodes.Values) { Color newColor = Color.white; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (node.isWalkable) newColor = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Color32(<span class="hljs-number"><span class="hljs-number">153</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">51</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> newColor = Color.red; Gizmos.color = newColor; Gizmos.DrawWireSphere(node.position, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodeSize / <span class="hljs-number"><span class="hljs-number">10</span></span>f); newColor = Color.green; Gizmos.color = newColor; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (node.isWalkable) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; Directions.Length; i++) { Vector2Int coords = node.coords + Directions[i]; Node connection = GetNode(coords); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (connection) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (connection.isWalkable) Gizmos.DrawLine(node.position, connection.position); } } } } Gizmos.color = c; } #endif</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ç°åœ¨æ‚¨å¯ä»¥å®‰å…¨åœ°å¼€å§‹æ¸¸æˆï¼Œçœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆã€‚ </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŠ¨æ€åœ°å›¾</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/302/3ae/4e3/3023ae4e31ba9b2f888c27c4a9144ab7.gif" alt="å›¾ç‰‡"><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä»…ä½¿ç”¨ä»»åŠ¡æ„å»ºäº†å›¾æœ¬èº«ï¼Œä½†è¿™æ˜¯åœ¨æˆ‘å°†</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A *</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç®—æ³•æœ¬èº«æ‹§å…¥ç³»ç»Ÿåå‘ç”Ÿçš„äº‹æƒ…</font><font style="vertical-align: inherit;">ï¼Œè¯¥</font><font style="vertical-align: inherit;">ç®—æ³•æœ¬èº«</font><font style="vertical-align: inherit;">ä¹Ÿä½¿ç”¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jobç³»ç»Ÿ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥æŸ¥æ‰¾è·¯å¾„ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å³æœ¬æ–‡ç»“å°¾å¤„çš„æº</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ°å›¾å’Œè·¯å¾„æœç´¢</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/b2a/769/46c/b2a76946c68d7af5dc30d3226e27b5a1.gif" alt="å›¾ç‰‡"><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å› æ­¤ï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°å°†æ–°ä»»åŠ¡ç³»ç»Ÿç”¨äºç›®æ ‡å¹¶æ„å»ºæœ‰è¶£çš„ç³»ç»Ÿã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ä¸Šä¸€ç¯‡æ–‡ç« ä¸€æ ·ï¼Œè¯¥ä»»åŠ¡ç³»ç»Ÿåœ¨æ²¡æœ‰</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ECSçš„</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æƒ…å†µä¸‹ä½¿ç”¨</font><font style="vertical-align: inherit;">ï¼Œä½†æ˜¯å¦‚æœå°†æ­¤ç³»ç»Ÿä¸</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ECS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»“åˆä½¿ç”¨</font><font style="vertical-align: inherit;">ï¼Œåˆ™å¯ä»¥åœ¨æ€§èƒ½æå‡æ–¹é¢è·å¾—ä»¤äººç§°å¥‡çš„ç»“æœã€‚</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¥ä½ å¥½è¿</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼</font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è·¯å¾„æŸ¥æ‰¾å™¨é¡¹ç›®æº</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN423601/">https://habr.com/ru/post/zh-CN423601/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN423589/index.html">æˆ‘ä»¬å¦‚ä½•é€‰æ‹©TTSä½œä¸ºå­—å…¸ä¸­çš„å£°éŸ³ç¤ºä¾‹</a></li>
<li><a href="../zh-CN423591/index.html">å…³äºä¸»è¦å†…å®¹çš„æ—§æ­Œã€‚ Javaå’Œå¤–å‘è¯·æ±‚</a></li>
<li><a href="../zh-CN423593/index.html">Googleå®£å¸ƒä¸€é¡¹é’ˆå¯¹æœºå™¨è§†è§‰ç®—æ³•çš„æ”»å‡»ç«èµ›</a></li>
<li><a href="../zh-CN423595/index.html">Frango Anomalyï¼Œäº¤æ±‡å¤„</a></li>
<li><a href="../zh-CN423597/index.html">å¦‚ä½•ä»¥åŠåœ¨å®¢æˆ·ç¾¤ä¸­åˆ†é…å“ªäº›é›†ç¾¤</a></li>
<li><a href="../zh-CN423603/index.html">RxSwiftç¬¬1éƒ¨åˆ†</a></li>
<li><a href="../zh-CN423607/index.html">è±çº³æ–¯Â·æ‰˜ç“¦å°”å…¹ï¼ˆLinus Torvaldsï¼‰æ”¾å¼ƒäº†ç¡¬æ´¾é£æ ¼å¹¶æŠ½å‡ºæ—¶é—´</a></li>
<li><a href="../zh-CN423609/index.html">ç½‘ç«™æ­»åè¯¥å»å“ªé‡Œï¼Ÿ ä¸ªäººç»å†</a></li>
<li><a href="../zh-CN423611/index.html">ä¸€é”®å¼ä»˜æ¬¾-å¥½è¿˜æ˜¯åï¼Ÿ</a></li>
<li><a href="../zh-CN423615/index.html">ç”¨æˆ·ä½“éªŒä¸“å®¶è¦æ±‚çš„ä¸“ä¸šæŠ€èƒ½ï¼ˆ2018å¹´åˆ‡ç‰‡ï¼‰</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>