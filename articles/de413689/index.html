<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîù üïã ‚ÜîÔ∏è Debian + Postfix + Dovecot + Multidomain + SSL + IPv6 + OpenVPN + Multi-Interfaces + SpamAssassin-Learn + Bind üßõüèæ üë©‚Äç‚úàÔ∏è üëé</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel wird beschrieben, wie Sie einen modernen Mailserver einrichten. 
 Postfix + Taubenschlag. SPF + DKIM + rDNS. Mit IPv6. 
 Mit TLS-Ver...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Debian + Postfix + Dovecot + Multidomain + SSL + IPv6 + OpenVPN + Multi-Interfaces + SpamAssassin-Learn + Bind</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413689/">  In diesem Artikel wird beschrieben, wie Sie einen modernen Mailserver einrichten. <br>  Postfix + Taubenschlag.  SPF + DKIM + rDNS.  Mit IPv6. <br>  Mit TLS-Verschl√ºsselung.  Mit Unterst√ºtzung f√ºr mehrere Dom√§nen - Teil mit einem echten SSL-Zertifikat. <br>  Mit Anti-Spam-Schutz und hoher Anti-Spam-Bewertung auf anderen Mailservern. <br>  Mit Unterst√ºtzung f√ºr mehrere physische Schnittstellen. <br>  Mit OpenVPN, das √ºber IPv4 eine Verbindung herstellt und IPv6 bietet. <br><br>  Wenn Sie nicht alle diese Technologien erlernen m√∂chten, aber einen solchen Server konfigurieren m√∂chten, ist dieser Artikel genau das Richtige f√ºr Sie. <br><br>  Es gibt keine Versuche, jedes Detail im Artikel zu erkl√§ren.  Die Erkl√§rung bezieht sich auf das, was nicht standardm√§√üig konfiguriert ist oder aus Sicht des Verbrauchers wichtig ist. <br><a name="habracut"></a><br>  Die Motivation, einen Mailserver einzurichten, ist mein alter Traum.  Es mag albern klingen, aber meiner Meinung nach ist es viel besser, als von einem neuen Auto Ihrer Lieblingsmarke zu tr√§umen. <br><br>  Die Motivation, IPv6 zu konfigurieren, ist zwei.  IT-Experten m√ºssen st√§ndig neue Technologien erlernen, um zu √ºberleben.  Ich m√∂chte meinen bescheidenen Beitrag zum Kampf gegen die Zensur leisten. <br><br>  Die Motivation zum Einrichten von OpenVPN besteht nur darin, dass IPv6 auf dem lokalen Computer funktioniert. <br>  Die Motivation f√ºr die Einrichtung mehrerer physischer Schnittstellen besteht darin, dass auf meinem Server eine Schnittstelle "langsam, aber unbegrenzt" und die andere "schnell, aber mit einem Tarif" ist. <br><br>  Die Motivation zum Einrichten der Bindungseinstellungen besteht darin, dass mein Provider einen instabilen DNS-Server bereitstellt und Google ebenfalls abst√ºrzt.  Ich m√∂chte einen stabilen DNS-Server f√ºr den pers√∂nlichen Gebrauch. <br><br>  Motivation, einen Artikel zu schreiben - ein Entwurf wurde vor 10 Monaten geschrieben, und ich habe ihn bereits zweimal gepr√ºft.  Wenn selbst der Autor dies regelm√§√üig ben√∂tigt, besteht eine hohe Wahrscheinlichkeit, dass andere es ben√∂tigen. <br><br>  Es gibt keine universelle L√∂sung f√ºr den Mailserver.  Aber ich werde versuchen, etwas zu schreiben wie "Mach es so und dann, wenn alles so funktioniert, wie es sollte - wirf den √úberschuss weg". <br><br>  Es gibt einen Colocation-Server von tech.ru.  Es ist m√∂glich, mit OVH, Hetzner, AWS zu vergleichen.  Um dieses Problem zu l√∂sen, wird die Zusammenarbeit mit tech.ru viel effektiver sein. <br><br>  Debian 9 ist auf dem Server installiert. <br><br>  Auf dem Server gibt es 2 Schnittstellen `eno1` und` eno2`.  Der erste ist unbegrenzt und der zweite ist schnell. <br><br>  Es gibt 3 statische IP-Adressen, XX.XX.XX.X0 und XX.XX.XX.X1 und XX.XX.XX.X2 auf der Schnittstelle "eno1" und XX.XX.XX.X5 auf der Schnittstelle "eno2". <br><br>  Es gibt XXXX: XXXX: XXXX: XXXX :: / 64 einen Pool von IPv6-Adressen, die der Schnittstelle "eno1" und daraus XXXX: XXXX: XXXX: XXXX: 1: 2 :: / 96 auf meine Anfrage "eno2" zugewiesen sind. <br><br>  Es gibt 3 Domains "domain1.com", "domain2.com", "domain3.com".  F√ºr "domain1.com" und "domain3.com" gibt es ein SSL-Zertifikat. <br><br>  Es gibt ein Google-Konto, an das Sie das Postfach "vasya.pupkin @ domain1.com" binden m√∂chten (Empfangen von E-Mails und Senden von E-Mails direkt √ºber die Google Mail-Oberfl√§che). <br>  Es sollte ein Postfach "support @ domain2.com" vorhanden sein, eine Kopie der E-Mail, die ich in meinem Google Mail-Konto sehen m√∂chte.  Und es ist selten m√∂glich, etwas im Namen von "support @ domain2.com" √ºber die Weboberfl√§che zu senden. <br><br>  Es sollte eine Mailbox "ivanov @ domain3.com" geben, die Ivanov von seinem iPhone aus verwenden wird. <br><br>  Gesendete Briefe m√ºssen allen aktuellen Anti-Spam-Anforderungen entsprechen. <br>  In √∂ffentlichen Netzwerken sollte die h√∂chste Verschl√ºsselungsstufe bereitgestellt werden. <br>  Es muss IPv6-Unterst√ºtzung f√ºr das Senden und Empfangen von E-Mails geben. <br>  Es muss einen SpamAssassin geben, der niemals E-Mails l√∂scht.  Der Spam-Ordner wird entweder √ºbersprungen oder √ºbersprungen oder an IMAP gesendet. <br>  Das automatische SpamAssassin-Lernen sollte konfiguriert werden: Wenn ich den Brief in den Spam-Ordner verschiebe, lerne ich daraus.  Wenn ich den Brief aus dem Spam-Ordner verschiebe, lerne ich daraus.  SpamAssassin-Lernergebnisse - sollten sich auf die Reichweite der Nachricht im Spam-Ordner auswirken. <br>  PHP-Skripte sollten in der Lage sein, E-Mails f√ºr jede Domain auf diesem Server zu senden. <br>  Es sollte einen openvpn-Dienst geben, der IPv6 auf einem Client ohne IPv6 verwenden kann. <br><br>  Zuerst m√ºssen Sie Schnittstellen und Routing einschlie√ülich IPv6 konfigurieren. <br>  Anschlie√üend m√ºssen Sie OpenVPN konfigurieren, das eine Verbindung √ºber IPv4 herstellt und dem Client eine statisch-reale IPv6-Adresse zur Verf√ºgung stellt.  Dieser Client hat Zugriff auf alle IPv6-Dienste auf dem Server und auf alle IPv6-Ressourcen im Internet. <br>  Dann muss Postfix so konfiguriert werden, dass Briefe + SPF + DKIM + rDNS und andere √§hnliche Kleinigkeiten gesendet werden. <br>  Dann m√ºssen Sie Dovecot und Multidomain konfigurieren. <br>  Dann m√ºssen Sie SpamAssassin konfigurieren und das Training konfigurieren. <br>  Installieren Sie abschlie√üend Bind. <br><br><h2>  ============== Multi-Interfaces ============== </h2><br>  Um die Schnittstellen zu konfigurieren, m√ºssen Sie dies unter "/ etc / network / interfaces" registrieren. <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># The loopback network interface auto lo iface lo inet loopback # The primary network interface allow-hotplug eno1 iface eno1 inet static address XX.XX.XX.X0/24 gateway XX.XX.XX.1 dns-nameservers 127.0.0.1 213.248.1.6 post-up ip route add XX.XX.XX.0/24 dev eno1 src XX.XX.XX.X0 table eno1t post-up ip route add default via XX.XX.XX.1 table eno1t post-up ip rule add table eno1t from XX.XX.XX.X0 post-up ip rule add table eno1t to XX.XX.XX.X0 auto eno1:1 iface eno1:1 inet static address XX.XX.XX.X1 netmask 255.255.255.0 post-up ip rule add table eno1t from XX.XX.XX.X1 post-up ip rule add table eno1t to XX.XX.XX.X1 post-up ip route add 10.8.0.0/24 dev tun0 src XX.XX.XX.X1 table eno1t post-down ip route del 10.8.0.0/24 dev tun0 src XX.XX.XX.X1 table eno1t auto eno1:2 iface eno1:2 inet static address XX.XX.XX.X2 netmask 255.255.255.0 post-up ip rule add table eno1t from XX.XX.XX.X2 post-up ip rule add table eno1t to XX.XX.XX.X2 iface eno1 inet6 static address X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">1:1::/64 gateway X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">:1 up ip -6 addr add X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">1:1:1:1/64 dev $IFACE up ip -6 addr add X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">1:1:1:2/64 dev $IFACE down ip -6 addr del X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">1:1:1:1/64 dev $IFACE down ip -6 addr del X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">1:1:1:2/64 dev $IFACE # The secondary network interface allow-hotplug eno2 iface eno2 inet static address XX.XX.XX.X5 netmask 255.255.255.0 post-up ip route add XX.XX.XX.0/24 dev eno2 src XX.XX.XX.X5 table eno2t post-up ip route add default via XX.XX.XX.1 table eno2t post-up ip rule add table eno2t from XX.XX.XX.X5 post-up ip rule add table eno2t to XX.XX.XX.X5 post-up ip route add 10.8.0.0/24 dev tun0 src XX.XX.XX.X5 table eno2t post-down ip route del 10.8.0.0/24 dev tun0 src XX.XX.XX.X5 table eno2t iface eno2 inet6 static address X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">1:2::/96 up ip -6 addr add X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">1:2:1:1/64 dev $IFACE up ip -6 addr add X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">1:2:1:2/64 dev $IFACE down ip -6 addr del X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">1:2:1:1/64 dev $IFACE down ip -6 addr del X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">1:2:1:2/64 dev $IFACE # OpenVPN network iface tun0 inet6 static address X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">1:3::/80</span></span></code> </pre> <br>  Diese Einstellungen k√∂nnen auf jedem Server in tech.ru angewendet werden (mit ein wenig Koordination mit dem Support) und funktionieren sofort wie gew√ºnscht. <br><br>  Wenn die Erfahrung, √§hnliche Dinge f√ºr Hetzner, OVH - dort Freundin einzurichten.  H√§rter. <br><br>  eno1 ist der Name der Netzwerkkarte Nr. 1 (langsam, aber unbegrenzt). <br>  eno2 ist der Name der Netzwerkkarte Nr. 2 (schnell, aber mit einem Tarif). <br>  tun0 ist der Name der virtuellen Netzwerkkarte von OpenVPN. <br>  XX.XX.XX.X0 - IPv4 # 1 auf eno1. <br>  XX.XX.XX.X1 - IPv4 # 2 auf eno1. <br>  XX.XX.XX.X2 - IPv4 # 3 auf eno1. <br>  XX.XX.XX.X5 - IPv4 # 1 auf eno2. <br>  XX.XX.XX.1 - IPv4-Gateway. <br>  XXXX: XXXX: XXXX: XXXX :: / 64 - IPv6 f√ºr den gesamten Server. <br>  XXXX: XXXX: XXXX: XXXX: 1: 2 :: / 96 - IPv6 f√ºr eno2, alles andere geht von au√üen an eno1. <br>  XXXX: XXXX: XXXX: XXXX :: 1 - IPv6-Gateway (es ist erw√§hnenswert, dass Sie hier einen Freund finden k√∂nnen / m√ºssen. Geben Sie den IPv6-Switch an). <br>  DNS-Nameserver - 127.0.0.1 werden angegeben (da bind lokal installiert ist) und 213.248.1.6 (dies ist von tech.ru). <br><br>  "Tabelle eno1t" und "Tabelle eno2t" - die Bedeutung dieser Routenregeln ist, dass der Verkehr, der durch eno1 -&gt; geht, und der Verkehr, der durch eno2 -&gt; geht, durchgeht.  Und auch vom Server initiierte Verbindungen w√ºrden √ºber eno1 gehen. <br><br><pre> <code class="bash hljs">ip route add default via XX.XX.XX.1 table eno1t</code> </pre> <br>  Mit diesem Befehl setzen wir, dass jeder unverst√§ndliche Verkehr, der unter eine Regel f√§llt, mit "table eno1t" markiert ist -&gt; an die eno1-Schnittstelle senden. <br><br><pre> <code class="bash hljs">ip route add XX.XX.XX.0/24 dev eno1 src XX.XX.XX.X0 table eno1t</code> </pre> <br>  Mit diesem Befehl setzen wir, dass jeglicher vom Server initiierter Verkehr zur eno1-Schnittstelle geleitet wird. <br><br><pre> <code class="bash hljs">ip rule add table eno1t from XX.XX.XX.X0 ip rule add table eno1t to XX.XX.XX.X0</code> </pre> <br>  Mit diesem Befehl legen wir die Regeln f√ºr das Markieren des Datenverkehrs selbst fest. <br><br><pre> <code class="bash hljs">auto eno1:2 iface eno1:2 inet static address XX.XX.XX.X2 netmask 255.255.255.0 post-up ip rule add table eno1t from XX.XX.XX.X2 post-up ip rule add table eno1t to XX.XX.XX.X2</code> </pre> <br>  Dieser Block definiert das zweite IPv4 f√ºr die eno1-Schnittstelle. <br><br><pre> <code class="bash hljs">ip route add 10.8.0.0/24 dev tun0 src XX.XX.XX.X1 table eno1t</code> </pre> <br>  Mit diesem Befehl legen wir die Route von OpenVPN-Clients zu lokalem IPv4 mit Ausnahme von XX.XX.XX.X0 fest. <br>  Warum dieser Befehl f√ºr alle IPv4 ausreicht - verstehe ich immer noch nicht. <br><br><pre> <code class="bash hljs">iface eno1 inet6 static address XXXX:XXXX:XXXX:XXXX:1:1::/64 gateway XXXX:XXXX:XXXX:XXXX::1</code> </pre> <br>  Hier legen wir die Adresse f√ºr die Schnittstelle selbst fest.  Der Server verwendet es als "ausgehende" Adresse.  Wird nicht mehr verwendet. <br><br>  Warum ist ": 1: 1 ::" so kompliziert?  Das OpenVPN hat richtig funktioniert und nur daf√ºr.  Dazu sp√§ter mehr. <br><br>  Zum Thema Gateway - so funktioniert es.  Aber auf die richtige Weise - hier m√ºssen Sie den IPv6-Switch angeben, mit dem der Server verbunden ist. <br><br>  Aus irgendeinem Grund funktioniert IPv6 jedoch nicht mehr, wenn ich dies tue.  Vielleicht sind dies einige tech.ru-Probleme. <br><br><pre> <code class="bash hljs">ip -6 addr add XXXX:XXXX:XXXX:XXXX:1:1:1:1/64 dev <span class="hljs-variable"><span class="hljs-variable">$IFACE</span></span></code> </pre> <br>  Dadurch werden der Schnittstelle IPv6-Adressen hinzugef√ºgt.  Wenn Sie hundert Adressen ben√∂tigen, bedeutet dies hundert Zeilen in dieser Datei. <br><br><pre> <code class="bash hljs">iface eno1 inet6 static address XXXX:XXXX:XXXX:XXXX:1:1::/64 ... iface eno2 inet6 static address XXXX:XXXX:XXXX:XXXX:1:2::/96 ... iface tun0 inet6 static address XXXX:XXXX:XXXX:XXXX:1:3::/80</code> </pre> <br><blockquote>  Markierte die Adressen und Subnetze aller Schnittstellen so, dass es klar war. <br>  eno1 - es muss "/ 64" sein - weil dies unser gesamter Adresspool ist. <br>  tun0 - das Subnetz muss gr√∂√üer als eno1 sein.  Andernfalls k√∂nnen Sie das IPv6-Gateway nicht f√ºr OpenVPN-Clients konfigurieren. <br>  eno2 - Das Subnetz muss gr√∂√üer als tun0 sein.  Andernfalls k√∂nnen OpenVPN-Clients keine lokalen IPv6-Adressen abrufen. <br>  Aus Gr√ºnden der √úbersichtlichkeit habe ich den Subnetzschritt 16 gew√§hlt, aber Sie k√∂nnen sogar den Schritt ‚Äû1‚Äú ausf√ºhren, wenn Sie dies w√ºnschen. <br>  Dementsprechend ist 64 + 16 = 80 und 80 + 16 = 96. <br><br>  F√ºr noch mehr Klarheit: <br>  XXXX: XXXX: XXXX: XXXX: 1: 1: JJJJ: JJJJ - Dies sind Adressen, die bestimmten Sites oder Diensten auf der eno1-Schnittstelle zugewiesen werden sollten. <br>  XXXX: XXXX: XXXX: XXXX: 1: 2: JJJJ: JJJJ - Dies sind Adressen, die bestimmten Sites oder Diensten auf der eno2-Schnittstelle zugewiesen werden sollten. <br>  XXXX: XXXX: XXXX: XXXX: 1: 3: JJJJ: JJJJ sind Adressen, die OpenVPN-Clients zugewiesen oder als OpenVPN-Dienstadressen verwendet werden sollen. </blockquote><br><br>  Um das Netzwerk zu konfigurieren, sollte es m√∂glich sein, den Server neu zu starten. <br>  IPv4-√Ñnderungen werden w√§hrend der Ausf√ºhrung erfasst (stellen Sie sicher, dass Sie sie in den Bildschirm einschlie√üen - andernfalls l√∂scht dieser Befehl einfach das Netzwerk auf dem Server): <br><br><pre> <code class="bash hljs">/etc/init.d/networking restart</code> </pre> <br>  In der Datei "/ etc / iproute2 / rt_tables" am Ende hinzuf√ºgen: <br><br><pre> <code class="bash hljs">100 eno1t 101 eno2t</code> </pre> <br>  Ohne dies k√∂nnen Sie keine benutzerdefinierten Tabellen in der Datei "/ etc / network / interfaces" verwenden. <br>  Die Nummern m√ºssen eindeutig und kleiner als 65535 sein. <br><br>  IPv6-√Ñnderungen k√∂nnen problemlos ohne Neustart ge√§ndert werden. Dazu m√ºssen Sie jedoch mindestens drei Befehle lernen: <br><br><pre> <code class="bash hljs">ip -6 addr ... ip -6 route ... ip -6 neigh ...</code> </pre> <br>  Einrichten von "/etc/sysctl.conf" <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># Uncomment the next line to enable packet forwarding for IPv4 net.ipv4.ip_forward = 1 # Do not accept ICMP redirects (prevent MITM attacks) net.ipv4.conf.all.accept_redirects = 0 net.ipv6.conf.all.accept_redirects = 0 # Do not send ICMP redirects (we are not a router) net.ipv4.conf.all.send_redirects = 0 # For receiving ARP replies net.ipv4.conf.all.arp_filter = 0 net.ipv4.conf.default.arp_filter = 0 # For sending ARP net.ipv4.conf.all.arp_announce = 0 net.ipv4.conf.default.arp_announce = 0 # Enable IPv6 net.ipv6.conf.all.disable_ipv6 = 0 net.ipv6.conf.default.disable_ipv6 = 0 net.ipv6.conf.lo.disable_ipv6 = 0 # IPv6 configuration net.ipv6.conf.all.autoconf = 1 net.ipv6.conf.all.accept_ra = 0 # For OpenVPN net.ipv6.conf.all.forwarding = 1 net.ipv6.conf.all.proxy_ndp = 1 # For nginx on boot net.ipv6.ip_nonlocal_bind = 1</span></span></code> </pre> <br>  Dies sind die Sysctl-Einstellungen meines Servers.  Ich nehme das Wichtige zur Kenntnis. <br><br><pre> <code class="bash hljs">net.ipv4.ip_forward = 1</code> </pre> <br>  Ohne dies funktioniert OpenVPN in keiner Weise. <br><br><pre> <code class="bash hljs">net.ipv6.ip_nonlocal_bind = 1</code> </pre> <br>  Jeder, der versucht, IPv6 (z. B. nginx) direkt nach dem Hochfahren der Schnittstelle zu binden, erh√§lt eine Fehlermeldung.  Dass eine solche Adresse nicht verf√ºgbar ist. <br><br>  Um eine solche Situation zu vermeiden, wird eine solche Einstellung vorgenommen. <br><br><pre> <code class="bash hljs">net.ipv6.conf.all.forwarding = 1 net.ipv6.conf.all.proxy_ndp = 1</code> </pre> <br>  Ohne diese IPv6-Einstellungen gelangt der Datenverkehr vom OpenVPN-Client nicht in die Welt. <br><br>  Andere Einstellungen sind entweder irrelevant oder ich kann mich nicht erinnern, warum sie so sind. <br>  Aber nur f√ºr den Fall, ich lasse "wie es ist". <br><br>  Damit die √Ñnderungen in dieser Datei ohne Neustart des Servers √ºbernommen werden k√∂nnen, m√ºssen Sie den folgenden Befehl ausf√ºhren: <br><br><pre> <code class="bash hljs">sysctl -p</code> </pre> <br>  Weitere Details zu den "Tabellen" -Regeln: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">habr.com/post/108690</a> <br><br><h2>  ============== OpenVPN ============== </h2><br>  OpenVPN IPv4 funktioniert nicht ohne iptables. <br><br>  Ich habe diese iptables f√ºr VPN: <br><br><pre> <code class="bash hljs">iptables -A INPUT -p udp -s YY.YY.YY.YY --dport 1194 -j ACCEPT iptables -A FORWARD -i tun0 -o eno1 -j ACCEPT iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -o eno1 -j SNAT --to-source XX.XX.XX.X0 <span class="hljs-comment"><span class="hljs-comment">##iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -o eno1 -j MASQUERADE iptables -A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT iptables -A INPUT -p udp --dport 1194 -j DROP iptables -A FORWARD -p udp --dport 1194 -j DROP</span></span></code> </pre> <br>  YY.YY.YY.YY ist meine statische IPv4-Adresse des lokalen Computers. <br>  10.8.0.0/24 - IPv4-OpenVPN-Netzwerk.  IPv4-Adressen f√ºr OpenVPN-Clients. <br>  Die Reihenfolge der Regeln ist wichtig. <br><br><pre> <code class="bash hljs">iptables -A INPUT -p udp -s YY.YY.YY.YY --dport 1194 -j ACCEPT iptables -A FORWARD -i tun0 -o eno1 -j ACCEPT ... iptables -A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT iptables -A INPUT -p udp --dport 1194 -j DROP iptables -A FORWARD -p udp --dport 1194 -j DROP</code> </pre> <br>  Dies ist eine Einschr√§nkung, sodass nur ich OpenVPN von meiner statischen IP aus verwenden kann. <br><br><pre> <code class="bash hljs">iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -o eno1 -j SNAT --to-source XX.XX.XX.X0 --  -- iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -o eno1 -j MASQUERADE</code> </pre> <br>  Um IPv4-Pakete zwischen OpenVPN-Clients und dem Internet weiterzuleiten, m√ºssen Sie einen dieser Befehle registrieren. <br><br>  F√ºr verschiedene F√§lle ist eine der Optionen nicht geeignet. <br>  Beide Teams sind f√ºr meinen Fall geeignet. <br>  Nachdem ich die Dokumentation gelesen hatte, entschied ich mich f√ºr die erste Option, da sie weniger CPU verbraucht. <br><br>  Damit alle iptables-Einstellungen nach dem Neustart √ºbernommen werden, m√ºssen Sie sie irgendwo speichern. <br><br><pre> <code class="bash hljs">iptables-save &gt; /etc/iptables/rules.v4 ip6tables-save &gt; /etc/iptables/rules.v6</code> </pre> <br>  Solche Namen wurden nicht zuf√§llig gew√§hlt.  Das Paket iptables-persistent verwendet sie. <br><br><pre> <code class="bash hljs">apt-get install iptables-persistent</code> </pre> <br>  Installieren des OpenVPN-Hauptpakets: <br><br><pre> <code class="bash hljs">apt-get install openvpn easy-rsa</code> </pre> <br>  Richten Sie eine Vorlage f√ºr Zertifikate ein (ersetzen Sie Ihre Werte): <br><br><pre> <code class="bash hljs">make-cadir ~/openvpn-ca <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/openvpn-ca ln -s openssl-1.0.0.cnf openssl.cnf</code> </pre> <br>  Lassen Sie uns die Einstellungen f√ºr die Zertifikatvorlage bearbeiten: <br><br><pre> <code class="bash hljs">mcedit vars</code> </pre> <br><pre> <code class="bash hljs">... <span class="hljs-comment"><span class="hljs-comment"># These are the default values for fields # which will be placed in the certificate. # Don't leave any of these fields blank. export KEY_COUNTRY="RU" export KEY_PROVINCE="Krasnodar" export KEY_CITY="Dinskaya" export KEY_ORG="Own" export KEY_EMAIL="admin@domain1.com" export KEY_OU="VPN" # X509 Subject Field export KEY_NAME="server" ...</span></span></code> </pre> <br>  Erstellen Sie ein Serverzertifikat: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/openvpn-ca <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> vars ./clean-all ./build-ca ./build-key-server server ./build-dh openvpn --genkey --secret keys/ta.key</code> </pre> <br>  Wir bereiten die M√∂glichkeit vor, die resultierenden "client-name.opvn" -Dateien zu erstellen: <br><br><pre> <code class="bash hljs">mkdir -p ~/client-configs/files chmod 700 ~/client-configs/files cp /usr/share/doc/openvpn/examples/sample-config-files/client.conf ~/client-configs/base.conf mcedit ~/client-configs/base.conf</code> </pre> <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># Client mode client # Interface tunnel type dev tun # TCP protocol proto tcp-client # Address/Port of VPN server remote XX.XX.XX.X0 1194 # Don't bind to local port/address nobind # Don't need to re-read keys and re-create tun at restart persist-key persist-tun # Remote peer must have a signed certificate remote-cert-tls server ns-cert-type server # Enable compression comp-lzo # Custom ns-cert-type server tls-auth ta.key 1 cipher DES-EDE3-CBC</span></span></code> </pre> <br>  Wir werden ein Skript vorbereiten, das alle Dateien zu einer einzigen opvn-Datei zusammenf√ºgt. <br><br><pre> <code class="bash hljs">mcedit ~/client-configs/make_config.sh chmod 700 ~/client-configs/make_config.sh</code> </pre> <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # First argument: Client identifier KEY_DIR=~/openvpn-ca/keys OUTPUT_DIR=~/client-configs/files BASE_CONFIG=~/client-configs/base.conf cat ${BASE_CONFIG} \ &lt;(echo -e '&lt;ca&gt;') \ ${KEY_DIR}/ca.crt \ &lt;(echo -e '&lt;/ca&gt;\n&lt;cert&gt;') \ ${KEY_DIR}/${1}.crt \ &lt;(echo -e '&lt;/cert&gt;\n&lt;key&gt;') \ ${KEY_DIR}/${1}.key \ &lt;(echo -e '&lt;/key&gt;\n&lt;tls-auth&gt;') \ ${KEY_DIR}/ta.key \ &lt;(echo -e '&lt;/tls-auth&gt;') \ &gt; ${OUTPUT_DIR}/${1}.ovpn</span></span></code> </pre> <br>  Wir erstellen den ersten OpenVPN-Client: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/openvpn-ca <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> vars ./build-key client-name <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/client-configs ./make_config.sh client-name</code> </pre> <br>  Die Datei "~ / client-configs / files / client-name.ovpn" wird an den Client gesendet. <br><br>  F√ºr iOS-Clients m√ºssen Sie den folgenden Trick ausf√ºhren: <br>  Der Inhalt des tls-auth-Tags sollte kommentarlos sein. <br>  Und setzen Sie "key-direction 1" unmittelbar vor das Tag "tls-auth". <br><br>  Konfigurieren Sie die OpenVPN-Serverkonfiguration: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/openvpn-ca/keys cp ca.crt ca.key server.crt server.key ta.key dh2048.pem /etc/openvpn gunzip -c /usr/share/doc/openvpn/examples/sample-config-files/server.conf.gz | tee /etc/openvpn/server.conf mcedit /etc/openvpn/server.conf</code> </pre> <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># Listen port port 1194 # Protocol proto tcp-server # IP tunnel dev tun0 tun-ipv6 push tun-ipv6 # Master certificate ca ca.crt # Server certificate cert server.crt # Server private key key server.key # Diffie-Hellman parameters dh dh2048.pem # Allow clients to communicate with each other client-to-client # Client config dir client-config-dir /etc/openvpn/ccd # Run client-specific script on connection and disconnection script-security 2 client-connect "/usr/bin/sudo -u root /etc/openvpn/server-clientconnect.sh" client-disconnect "/usr/bin/sudo -u root /etc/openvpn/server-clientdisconnect.sh" # Server mode and client subnets server 10.8.0.0 255.255.255.0 server-ipv6 X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">1:3::/80 topology subnet # IPv6 routes push "route-ipv6 X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">:/64" push "route-ipv6 2000::/3" # DNS (for Windows) # These are OpenDNS push "dhcp-option DNS 208.67.222.222" push "dhcp-option DNS 208.67.220.220" # Configure all clients to redirect their default network gateway through the VPN push "redirect-gateway def1 bypass-dhcp" push "redirect-gateway ipv6" #For iOS # Don't need to re-read keys and re-create tun at restart persist-key persist-tun # Ping every 10s. Timeout of 120s. keepalive 10 120 # Enable compression comp-lzo # User and group user vpn group vpn # Log a short status status openvpn-status.log # Logging verbosity ##verb 4 # Custom config tls-auth ta.key 0 cipher DES-EDE3-CBC</span></span></code> </pre> <br>  Dies ist erforderlich, um f√ºr jeden Client eine statische Adresse festzulegen (nicht erforderlich, aber ich verwende): <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># Client config dir client-config-dir /etc/openvpn/ccd</span></span></code> </pre> <br>  Das schwierigste und wichtigste Detail. <br><br>  Leider kann OpenVPN das IPv6-Gateway f√ºr Clients noch nicht unabh√§ngig konfigurieren. <br>  Wir m√ºssen dies f√ºr jeden Kunden manuell weiterleiten. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># Run client-specific script on connection and disconnection script-security 2 client-connect "/usr/bin/sudo -u root /etc/openvpn/server-clientconnect.sh" client-disconnect "/usr/bin/sudo -u root /etc/openvpn/server-clientdisconnect.sh"</span></span></code> </pre> <br>  Datei "/etc/openvpn/server-clientconnect.sh": <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh # Check client variables if [ -z "$ifconfig_pool_remote_ip" ] || [ -z "$common_name" ]; then echo "Missing environment variable." exit 1 fi # Load server variables . /etc/openvpn/variables ipv6="" # Find out if there is a specific config with fixed IPv6 for this client if [ -f "/etc/openvpn/ccd/$common_name" ]; then # Get fixed IPv6 from client config file ipv6=$(sed -nr 's/^.*ifconfig-ipv6-push[ \t]+([0-9a-fA-F\\:]+).*$/\1/p' "/etc/openvpn/ccd/$common_name") echo $ipv6 fi # Get IPv6 from IPv4 if [ -z "$ipv6" ]; then ipp=$(echo "$ifconfig_pool_remote_ip" | cut -d. -f4) if ! [ "$ipp" -ge 2 -a "$ipp" -le 254 ] 2&gt;/dev/null; then echo "Invalid IPv4 part." exit 1 fi hexipp=$(printf '%x' $ipp) ipv6="$prefix$hexipp" fi # Create proxy rule /sbin/ip -6 neigh add proxy $ipv6 dev eno1</span></span></code> </pre> <br><br>  Datei "/etc/openvpn/server-clientdisconnect.sh": <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh # Check client variables if [ -z "$ifconfig_pool_remote_ip" ] || [ -z "$common_name" ]; then echo "Missing environment variable." exit 1 fi # Load server variables . /etc/openvpn/variables ipv6="" # Find out if there is a specific config with fixed IPv6 for this client if [ -f "/etc/openvpn/ccd/$common_name" ]; then # Get fixed IPv6 from client config file ipv6=$(sed -nr 's/^.*ifconfig-ipv6-push[ \t]+([0-9a-fA-F\\:]+).*$/\1/p' "/etc/openvpn/ccd/$common_name") fi # Get IPv6 from IPv4 if [ -z "$ipv6" ]; then ipp=$(echo "$ifconfig_pool_remote_ip" | cut -d. -f4) if ! [ "$ipp" -ge 2 -a "$ipp" -le 254 ] 2&gt;/dev/null; then echo "Invalid IPv4 part." exit 1 fi hexipp=$(printf '%x' $ipp) ipv6="$prefix$hexipp" fi # Delete proxy rule /sbin/ip -6 neigh del proxy $ipv6 dev eno1</span></span></code> </pre> <br>  Beide Skripte verwenden die Datei "/ etc / openvpn / variables": <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># Subnet prefix=X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">2: # netmask prefixlen=112</span></span></code> </pre> <br>  Warum steht es hier geschrieben? Ich kann mich nur schwer daran erinnern. <br><br>  Jetzt sieht es seltsam aus Netzmaske = 112 (genau dort sollte es 96 geben). <br>  Und das Pr√§fix ist komisch, passt nicht zum tun0-Netzwerk. <br>  Aber okay, ich lasse es "wie es ist". <br><br><pre> <code class="bash hljs">cipher DES-EDE3-CBC</code> </pre> <br>  Dies ist ein Amateur - ich habe diese Methode zum Verschl√ºsseln der Verbindung gew√§hlt. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Weitere Informationen zum Einrichten von OpenVPN IPv4.</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Weitere Informationen zum Einrichten von OpenVPN IPv6.</a> <br><br><h2>  ============== Postfix ============== </h2><br>  Hauptpaket installieren: <br><br><pre> <code class="bash hljs">apt-get install postfix</code> </pre> <br>  W√§hlen Sie bei der Installation "Internetseite". <br><br>  Mein "/etc/postfix/main.cf" sieht folgenderma√üen aus: <br><br><pre> <code class="bash hljs">smtpd_banner = <span class="hljs-variable"><span class="hljs-variable">$myhostname</span></span> ESMTP <span class="hljs-variable"><span class="hljs-variable">$mail_name</span></span> (Debian/GNU) biff = no <span class="hljs-comment"><span class="hljs-comment"># appending .domain is the MUA's job. append_dot_mydomain = no readme_directory = no # See http://www.postfix.org/COMPATIBILITY_README.html -- default to 2 on # fresh installs. compatibility_level = 2 # TLS parameters smtpd_tls_cert_file=/etc/ssl/domain1.com.2018.chained.crt smtpd_tls_key_file=/etc/ssl/domain1.com.2018.key smtpd_use_tls=yes smtpd_tls_auth_only = yes smtp_bind_address = XX.XX.XX.X0 smtp_bind_address6 = X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">X</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">XXX:</span></span></span><span class="hljs-comment">1:1:1:1 smtp_tls_security_level = may smtp_tls_ciphers = export smtp_tls_protocols = !SSLv2, !SSLv3 smtp_tls_loglevel = 1 smtpd_relay_restrictions = permit_mynetworks permit_sasl_authenticated defer_unauth_destination myhostname = domain1.com alias_maps = hash:/etc/aliases alias_database = hash:/etc/aliases myorigin = domain1.com mydestination = localhost relayhost = mynetworks = 127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128 mailbox_size_limit = 0 recipient_delimiter = + inet_interfaces = all inet_protocols = ipv4 internal_mail_filter_classes = bounce # Storage type virtual_transport = lmtp:unix:private/dovecot-lmtp virtual_mailbox_domains = mysql:/etc/postfix/mysql-virtual-mailbox-domains.cf virtual_mailbox_maps = mysql:/etc/postfix/mysql-virtual-mailbox-maps.cf virtual_alias_maps = mysql:/etc/postfix/mysql-virtual-alias-maps.cf # SMTP-Auth settings smtpd_sasl_type = dovecot smtpd_sasl_path = private/auth smtpd_sasl_auth_enable = yes smtpd_recipient_restrictions = permit_sasl_authenticated, permit_mynetworks, #reject_invalid_hostname, #reject_unknown_recipient_domain, reject_unauth_destination, reject_rbl_client sbl.spamhaus.org, check_policy_service unix:private/policyd-spf smtpd_helo_restrictions = #reject_invalid_helo_hostname, #reject_non_fqdn_helo_hostname, reject_unknown_helo_hostname smtpd_client_restrictions = permit_mynetworks, permit_sasl_authenticated, reject_non_fqdn_helo_hostname, permit # SPF policyd-spf_time_limit = 3600 # OpenDKIM milter_default_action = accept milter_protocol = 6 smtpd_milters = unix:var/run/opendkim/opendkim.sock non_smtpd_milters = unix:var/run/opendkim/opendkim.sock # IP address per domain sender_dependent_default_transport_maps = pcre:/etc/postfix/sdd_transport.pcre</span></span></code> </pre> <br>  Betrachten wir die Details dieser Konfiguration. <br><br><pre> <code class="bash hljs">smtpd_tls_cert_file=/etc/ssl/domain1.com.2018.chained.crt smtpd_tls_key_file=/etc/ssl/domain1.com.2018.key</code> </pre> <br><br><hr><blockquote><div class="spoiler">  <b class="spoiler_title">Laut den B√ºrgern von Chabrowsk enth√§lt dieser Block "Fehlinformationen und falsche Thesen".</b> <div class="spoiler_text">  Nur 8 Jahre nach Beginn meiner Karriere begann ich zu verstehen, wie SSL funktioniert. <br><br>  Daher erlaube ich mir, die Verwendung von SSL zu beschreiben (ohne die Fragen ‚ÄûWie funktioniert es?‚Äú Und ‚ÄûWarum funktioniert es?‚Äú Zu beantworten). <br><br>  Die Basis der modernen Verschl√ºsselung ist die Erstellung eines Schl√ºsselpaars (zwei sehr lange Zeilen von Zeichen). <br><br>  Ein "Schl√ºssel" ist privat, der andere ist "√∂ffentlich".  Wir halten den privaten Schl√ºssel sehr sorgf√§ltig geheim.  Wir verteilen den √∂ffentlichen Schl√ºssel an alle. <br><br>  Mit einem √∂ffentlichen Schl√ºssel k√∂nnen Sie eine Textzeichenfolge verschl√ºsseln, sodass nur der Eigent√ºmer des privaten Schl√ºssels entschl√ºsseln kann. <br>  Nun, das ist die ganze Grundlage der Technologie. <br><br>  Schritt 1 - https-Sites. <br>  Beim Zugriff auf die Site erf√§hrt der Browser vom Webserver, dass die Site https ist, und fordert daher einen √∂ffentlichen Schl√ºssel an. <br>  Der Webserver gibt den √∂ffentlichen Schl√ºssel an.  Mit dem √∂ffentlichen Schl√ºssel verschl√ºsselt der Browser die http-Anfrage und sendet sie. <br>  Der Inhalt der http-Anfrage kann nur von jemandem gelesen werden, der √ºber einen privaten Schl√ºssel verf√ºgt, dh nur von dem Server, an den der Anruf erfolgt. <br>  HTTP-Anfrage enth√§lt mindestens eine URI.  Wenn das Land versucht, den Zugriff nicht auf die gesamte Site, sondern auf eine bestimmte Seite zu beschr√§nken, kann dies f√ºr https-Sites nicht durchgef√ºhrt werden. <br><br>  Schritt 2 ist die verschl√ºsselte Antwort. <br>  Der Webserver bietet eine Antwort, die auf dem Weg leicht gelesen werden kann. <br>  Die L√∂sung ist √§u√üerst einfach: Der Browser generiert lokal f√ºr jede https-Site dasselbe privat-√∂ffentliche Schl√ºsselpaar. <br>  Zusammen mit der Anforderung des √∂ffentlichen Schl√ºssels der Site wird der lokale √∂ffentliche Schl√ºssel gesendet. <br>  Der Webserver merkt sich das und verschl√ºsselt beim Senden einer http-Antwort mit diesem √∂ffentlichen Schl√ºssel eines bestimmten Clients. <br>  Jetzt kann die http-Antwort nur vom Eigent√ºmer des privaten Schl√ºssels des Client-Browsers (dh des Clients selbst) entschl√ºsselt werden. <br><br>  Schritt Nummer 3 - Stellen Sie eine sichere Verbindung √ºber einen √∂ffentlichen Kanal her. <br>  In Beispiel Nr. 2 liegt eine Sicherheitsl√ºcke vor - nichts hindert Gratulanten daran, die http-Anfrage abzufangen und die Informationen zum √∂ffentlichen Schl√ºssel zu bearbeiten. <br>  Somit sieht der Vermittler fast den gesamten Inhalt der gesendeten und empfangenen Nachrichten, bis sich der Kommunikationskanal √§ndert. <br>  Dies zu bek√§mpfen ist extrem einfach - senden Sie einfach den √∂ffentlichen Schl√ºssel des Browsers als Nachricht, die mit dem √∂ffentlichen Schl√ºssel des Webservers verschl√ºsselt ist. <br>  Der Webserver sendet dann zun√§chst eine Antwort wie "Ihr √∂ffentlicher Schl√ºssel ist so" und verschl√ºsselt diese Nachricht mit demselben √∂ffentlichen Schl√ºssel. <br>  Der Browser √ºberpr√ºft die Antwort. Wenn die Meldung "Ihr √∂ffentlicher Schl√ºssel ist so" empfangen wird, ist dies eine 100% ige Garantie daf√ºr, dass dieser Kommunikationskanal sicher ist. <br>  Wie sicher ist es? <br>  Die Erstellung eines solchen sicheren Kommunikationskanals selbst erfolgt mit einer Ping * 2-Geschwindigkeit.  Zum Beispiel 20ms. <br>  Ein Angreifer muss entweder einen privaten Schl√ºssel der Partei im Voraus haben.  Oder holen Sie sich einen privaten Schl√ºssel f√ºr ein paar Millisekunden. <br>  Das Hacken eines modernen privaten Schl√ºssels wird auf einem Supercomputer Jahrzehnte dauern. <br><br>  Schritt 4 - √ñffentliche Datenbank mit √∂ffentlichen Schl√ºsseln. <br>  Offensichtlich besteht in dieser ganzen Geschichte die M√∂glichkeit, dass ein Angreifer auf dem Kommunikationskanal zwischen dem Client und dem Server sitzt. <br>  Die Gelegenheit f√ºr den Client wird vom Server und f√ºr den Server vom Client bereitgestellt.  Und emulieren Sie ein Schl√ºsselpaar in beide Richtungen. <br>  Dann sieht der Angreifer den gesamten Datenverkehr und kann den Datenverkehr "bearbeiten". <br>  √Ñndern Sie beispielsweise die Adresse, an die Geld gesendet werden soll, oder kopieren Sie das Passwort von der Online-Bank oder blockieren Sie ‚Äûanst√∂√üige‚Äú Inhalte. <br>  Um solche Angreifer zu bek√§mpfen, haben sie eine √∂ffentliche Datenbank mit √∂ffentlichen Schl√ºsseln f√ºr jede https-Site erstellt. <br>  Jeder Browser "kennt" die Existenz von etwa 200 dieser Datenbanken.  Dies ist in jedem Browser vorinstalliert. <br>  "Wissen" wird f√ºr jedes Zertifikat durch einen √∂ffentlichen Schl√ºssel gesichert.  Das hei√üt, es ist unm√∂glich, eine Verbindung mit jeder spezifischen Zertifizierungsstelle zu f√§lschen. <br><br>  Jetzt gibt es ein einfaches Verst√§ndnis f√ºr die Verwendung von SSL f√ºr https. <br>  Wenn Sie Ihr Gehirn bewegen, wird klar, wie die speziellen Dienste etwas in diesem Design knacken k√∂nnen.  Aber es wird sie enorme Anstrengungen kosten. <br>  Und Organisationen, die kleiner als die NSA oder die CIA sind - es ist fast unm√∂glich, das bestehende Schutzniveau zu knacken, selbst f√ºr VIPs. <br><br>  Ich werde auch Informationen zu SSH-Verbindungen hinzuf√ºgen.  Es gibt keine √∂ffentlichen Schl√ºssel, was zu tun ist.  Das Problem wird auf zwei Arten gel√∂st. <br>  Ssh Passwort Option: <br>  Bei der ersten Verbindung sollte der SSH-Client warnen, dass hier ein neuer √∂ffentlicher Schl√ºssel vom SSH-Server vorhanden ist. <br>  Wenn bei weiteren Verbindungen die Warnung "Ein neuer √∂ffentlicher Schl√ºssel vom SSH-Server" angezeigt wird, bedeutet dies, dass sie versuchen, Ihnen zuzuh√∂ren. <br>  Oder bei der ersten Verbindung, die Sie geh√∂rt haben, und jetzt sprechen Sie ohne Zwischenh√§ndler mit dem Server. <br>  Aufgrund der Tatsache, dass das Abh√∂ren einfach, schnell und m√ºhelos aufgedeckt werden kann, wird dieser Angriff nur in besonderen F√§llen f√ºr einen bestimmten Client verwendet. <br><br>  Schl√ºssel ssh Option: <br>  Wir nehmen ein Flash-Laufwerk, schreiben einen privaten Schl√ºssel f√ºr den SSH-Server darauf (daf√ºr gibt es Begriffe und eine Reihe wichtiger Nuancen, aber ich schreibe ein Lernprogramm, keine Gebrauchsanweisung). <br>  Wir belassen den √∂ffentlichen Schl√ºssel auf dem Computer, auf dem sich der SSH-Client befindet, und halten ihn auch geheim. <br>  Wir bringen das Flash-Laufwerk zum Server, stecken es ein, kopieren den privaten Schl√ºssel und verbrennen das Flash-Laufwerk und streuen den Staub im Wind (oder formatieren ihn zumindest mit Nullen). <br>  Das ist alles - nach einer solchen Operation wird es unm√∂glich sein, eine solche SSH-Verbindung zu knacken.  Nat√ºrlich kann man √ºber 10 Jahre Verkehr auf einem Supercomputer sehen - aber das ist eine andere Geschichte. <br><br>  Ich entschuldige mich f√ºr das offtopic. <br></div></div></blockquote>  Nun ist die Theorie bekannt.  Ich erz√§hle Ihnen, wie Sie ein SSL-Zertifikat erstellen. <br><br>  Mit "openssl genrsa" erstellen wir einen privaten Schl√ºssel und "Leerzeichen" f√ºr den √∂ffentlichen Schl√ºssel. <br>  Wir senden die "Rohlinge" an ein Drittunternehmen, an das wir f√ºr das einfachste Zertifikat ungef√§hr 9 US-Dollar zahlen. <br><br>  In wenigen Stunden erhalten wir von diesem Drittanbieter unseren ‚Äû√∂ffentlichen‚Äú Schl√ºssel und einen weiteren Satz mehrerer √∂ffentlicher Schl√ºssel. <br><br>  Warum sollte ein Drittunternehmen f√ºr die Ausgabe meines √∂ffentlichen Schl√ºssels bezahlen - ein separates Problem, das wir hier nicht ber√ºcksichtigen werden. <br><br>  Jetzt ist klar, was die Bedeutung der Inschrift ist: <br><br><pre> <code class="plaintext hljs">smtpd_tls_key_file=/etc/ssl/domain1.com.2018.key</code> </pre> <br>  Im Ordner "/ etc / ssl" werden alle Dateien f√ºr SSL-Fragen gespeichert. <br>  domain1.com - Domainname. <br>  2018 ist das Jahr der Schl√ºsselerstellung. <br>  "Schl√ºssel" - Bezeichnung, dass die Datei ein privater Schl√ºssel ist. <br><br>  Und die Bedeutung dieser Datei: <br><br>  smtpd_tls_cert_file = / etc / ssl / domain1.com.2018.chained.crt <br>  domain1.com - Domainname. <br>  2018 ist das Jahr der Schl√ºsselerstellung. <br>  verkettet - eine Bezeichnung daf√ºr, dass es eine Kette √∂ffentlicher Schl√ºssel gibt (der erste ist unser √∂ffentlicher Schl√ºssel und der Rest stammt von dem Unternehmen, das den √∂ffentlichen Schl√ºssel ausgestellt hat). <br>  crt - Bezeichnung, dass ein fertiges Zertifikat vorhanden ist (√∂ffentlicher Schl√ºssel mit technischen Erl√§uterungen). <br><br><pre> <code class="bash hljs">smtp_bind_address = XX.XX.XX.X0 smtp_bind_address6 = XXXX:XXXX:XXXX:XXXX:1:1:1:1</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diese Einstellung wird in diesem Fall nicht verwendet, sondern als Beispiel geschrieben. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Weil ein Fehler in diesem Parameter dazu f√ºhrt, dass Spam von Ihrem Server gesendet wird (ohne Ihren Willen). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dann beweisen Sie allen, dass Sie nicht schuld sind.</font></font><br><br><pre> <code class="bash hljs">recipient_delimiter = +</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vielleicht wissen es viele nicht, daher ist dies ein Standardsymbol f√ºr die Beweidung, und dies wird von den meisten modernen Mailservern unterst√ºtzt. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie beispielsweise ein Postfach "Benutzername@gmail.com" haben, senden Sie es an "Benutzername+ Spam@gmail.com" - sehen Sie, was passiert.</font></font><br><br><pre> <code class="bash hljs">inet_protocols = ipv4</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vielleicht ist das verwirrend. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das ist aber nicht nur so. </font><font style="vertical-align: inherit;">Jede neue Domain ist standardm√§√üig nur IPv4, dann aktiviere ich IPv6 f√ºr jede einzeln.</font></font><br><br><pre> <code class="bash hljs">virtual_transport = lmtp:unix:private/dovecot-lmtp virtual_mailbox_domains = mysql:/etc/postfix/mysql-virtual-mailbox-domains.cf virtual_mailbox_maps = mysql:/etc/postfix/mysql-virtual-mailbox-maps.cf virtual_alias_maps = mysql:/etc/postfix/mysql-virtual-alias-maps.cf</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier legen wir fest, dass alle eingehenden E-Mails an Dovecot gehen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und die Regeln f√ºr Domain, Mailbox, Alias ‚Äã‚Äã- schauen Sie in die Datenbank. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/postfix/mysql-virtual-mailbox-domains.cf</font></font><br><br><pre> <code class="bash hljs">user = usermail password = mailpassword hosts = 127.0.0.1 dbname = servermail query = SELECT 1 FROM virtual_domains WHERE name=<span class="hljs-string"><span class="hljs-string">'%s'</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> /etc/postfix/mysql-virtual-mailbox-maps.cf </font></font><br><br><pre> <code class="bash hljs">user = usermail password = mailpassword hosts = 127.0.0.1 dbname = servermail query = SELECT 1 FROM virtual_users WHERE email=<span class="hljs-string"><span class="hljs-string">'%s'</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> /etc/postfix/mysql-virtual-alias-maps.cf </font></font><br><br><pre> <code class="bash hljs">user = usermail password = mailpassword hosts = 127.0.0.1 dbname = servermail query = SELECT destination FROM virtual_aliases WHERE <span class="hljs-built_in"><span class="hljs-built_in">source</span></span>=<span class="hljs-string"><span class="hljs-string">'%s'</span></span></code> </pre> <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># SMTP-Auth settings smtpd_sasl_type = dovecot smtpd_sasl_path = private/auth smtpd_sasl_auth_enable = yes</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jetzt wei√ü postfix, dass Sie E-Mails nur mit Genehmigung von dovecot zum weiteren Senden annehmen k√∂nnen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich verstehe wirklich nicht wirklich, warum dies hier dupliziert wird. </font><font style="vertical-align: inherit;">Wir haben bereits in virtual_transport alles angegeben, was ben√∂tigt wird. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aber das Postfix-System ist sehr alt - es sind wahrscheinlich die Burgen aus alten Zeiten.</font></font><br><br><pre> <code class="bash hljs">smtpd_recipient_restrictions = ... smtpd_helo_restrictions = ... smtpd_client_restrictions = ...</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies wird f√ºr jeden Mailserver auf seine eigene Weise konfiguriert. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich habe 3 Mailserver zur Verf√ºgung und diese Einstellungen sind aufgrund unterschiedlicher Nutzungsanforderungen sehr unterschiedlich. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie m√ºssen sorgf√§ltig konfigurieren - andernfalls wird Spam Sie √ºberfluten oder schlimmer noch, Spam wird Sie √ºberfluten.</font></font><br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># SPF policyd-spf_time_limit = 3600</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Konfiguration f√ºr eine Art Plugin zur SPF-√úberpr√ºfung eingehender Nachrichten. </font></font><br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># OpenDKIM milter_default_action = accept milter_protocol = 6 smtpd_milters = unix:var/run/opendkim/opendkim.sock non_smtpd_milters = unix:var/run/opendkim/opendkim.sock</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Um alle ausgehenden Briefe zu konfigurieren, m√ºssen wir eine DKIM-Signatur bereitstellen. </font></font><br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># IP address per domain sender_dependent_default_transport_maps = pcre:/etc/postfix/sdd_transport.pcre</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies ist ein wichtiges Detail beim E-Mail-Routing beim Senden von E-Mails aus PHP-Skripten. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/etc/postfix/sdd_transport.pcre":</font></font><br><br><pre> <code class="bash hljs">/^www-domain1@domain1\.com$/ domain1: /^www-domain2@domain1\.com$/ domain2: /^www-domain3@domain1\.com$/ domain3: /@domain1\.com$/ domain1: /@domain2\.com$/ domain2: /@domain3\.com$/ domain3:</code> </pre> <br><blockquote>  ‚Äî  .  ‚Äî ,   . <br> Postfix     ‚Äî        . <br><br>     postfix    ‚Äî    ¬´master.cf¬ª. <br><br>  4, 5, 6 ‚Äî  .       ‚Äî    . <br>     php       ¬´from¬ª.      . <br><br>     ‚Äî       nginx+fpm. <br><br>  ‚Äî       linux-user .    fpm-pool. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fpm-pool verwendet eine beliebige Version von PHP (dies ist gro√üartig, wenn Sie verschiedene Versionen von PHP und sogar verschiedene PHP.ini auf demselben Server f√ºr benachbarte Sites verwenden k√∂nnen). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein bestimmter Linux-Benutzer "www-domain2" hat also eine domain2.com-Site. </font><font style="vertical-align: inherit;">Diese Site verf√ºgt √ºber einen Code zum Senden von Briefen, ohne das Feld from anzugeben. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selbst in diesem Fall werden die Buchstaben korrekt entfernt und gelangen nie in Spam.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mein "/etc/postfix/master.cf" sieht so aus: </font></font><br><br><pre> <code class="bash hljs">... smtp inet n - y - - smtpd -o content_filter=spamassassin ... submission inet n - y - - smtpd -o syslog_name=postfix/submission -o smtpd_tls_security_level=encrypt -o smtpd_sasl_auth_enable=yes -o smtpd_client_restrictions=permit_sasl_authenticated,reject ... policyd-spf unix - nn - 0 spawn user=policyd-spf argv=/usr/bin/policyd-spf spamassassin unix - nn - - pipe user=spamd argv=/usr/bin/spamc -f -e /usr/sbin/sendmail -oi -f <span class="hljs-variable"><span class="hljs-variable">${sender}</span></span> <span class="hljs-variable"><span class="hljs-variable">${recipient}</span></span> ... domain1 unix - - n - - smtp -o smtp_bind_address=XX.XX.XX.X1 -o smtp_helo_name=domain1.com -o inet_protocols=all -o smtp_bind_address6=XXXX:XXXX:XXXX:XXXX:1:1:1:1 -o syslog_name=postfix-domain1 domain2 unix - - n - - smtp -o smtp_bind_address=XX.XX.XX.X5 -o smtp_helo_name=domain2.com -o inet_protocols=all -o smtp_bind_address6=XXXX:XXXX:XXXX:XXXX:1:2:1:1 -o syslog_name=postfix-domain2 domain3 unix - - n - - smtp -o smtp_bind_address=XX.XX.XX.X2 -o smtp_helo_name=domain3 -o inet_protocols=all -o smtp_bind_address6=XXXX:XXXX:XXXX:XXXX:1:1:5:1 -o syslog_name=postfix-domain3</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Datei ist nicht vollst√§ndig angegeben - sie ist bereits sehr gro√ü. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notiert nur, was ge√§ndert wurde.</font></font><br><br><pre> <code class="bash hljs">smtp inet n - y - - smtpd -o content_filter=spamassassin ... spamassassin unix - nn - - pipe user=spamd argv=/usr/bin/spamc -f -e /usr/sbin/sendmail -oi -f <span class="hljs-variable"><span class="hljs-variable">${sender}</span></span> <span class="hljs-variable"><span class="hljs-variable">${recipient}</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dies sind die Einstellungen, die sich sp√§ter auf Spamassasin beziehen. </font></font><br><br><pre> <code class="bash hljs">submission inet n - y - - smtpd -o syslog_name=postfix/submission -o smtpd_tls_security_level=encrypt -o smtpd_sasl_auth_enable=yes -o smtpd_client_restrictions=permit_sasl_authenticated,reject</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie k√∂nnen √ºber Port 587 eine Verbindung zum Mailserver herstellen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Melden Sie sich dazu unbedingt an.</font></font><br><br><pre> <code class="bash hljs">policyd-spf unix - nn - 0 spawn user=policyd-spf argv=/usr/bin/policyd-spf</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aktivieren Sie die SPF-√úberpr√ºfung. </font></font><br><br><pre> <code class="bash hljs">apt-get install postfix-policyd-spf-python</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Installieren Sie das Paket f√ºr SPF-Pr√ºfungen oben. </font></font><br><br><pre> <code class="bash hljs">domain1 unix - - n - - smtp -o smtp_bind_address=XX.XX.XX.X1 -o smtp_helo_name=domain1.com -o inet_protocols=all -o smtp_bind_address6=XXXX:XXXX:XXXX:XXXX:1:1:1:1 -o syslog_name=postfix-domain1</code> </pre> <br><blockquote>    .          IPv4/IPv6 . <br><br>    rDNS. rDNS ‚Äî   -   IP . <br>         ,  helo   rDNS  ,    email. <br><br>  helo    ,      ‚Äî   . <br><br> Helo   rDNS ‚Äî    . <br>        IP . <br>  OVH ‚Äî      rDNS. <br>  tech.ru ‚Äî    . <br>  AWS ‚Äî    . <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Inet_protocols" und "smtp_bind_address6" - so aktivieren wir die IPv6-Unterst√ºtzung. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F√ºr IPv6 m√ºssen Sie auch rDNS registrieren. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Syslog_name" - und dies dient zum bequemen Lesen von Protokollen.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">empfehle hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Zertifikate zu kaufen </font><font style="vertical-align: inherit;">. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier ein paar Postfix + Dovecot einrichten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPF-Setup.</font></font></a> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ============== Dovecot ============== </font></font></h2><br><pre> <code class="bash hljs">apt-get install dovecot-imapd dovecot-pop3d dovecot-lmtpd dovecot-mysql dovecot-antispam</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurieren Sie MySQL und installieren Sie die Pakete selbst. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/etc/dovecot/conf.d/10-auth.conf"</font></font><br><br><pre> <code class="bash hljs">disable_plaintext_auth = yes auth_mechanisms = plain login</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Autorisierung wird nur verschl√ºsselt. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/etc/dovecot/conf.d/10-mail.conf"</font></font><br><br><pre> <code class="bash hljs">mail_location = maildir:/var/mail/vhosts/%d/%n</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier geben wir die Position der Buchstaben an. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich m√∂chte, dass sie in Dateien gespeichert und nach Dom√§nen gruppiert werden. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/etc/dovecot/conf.d/10-master.conf"</font></font><br><br><pre> <code class="bash hljs">service imap-login { inet_listener imap { port = 0 } inet_listener imaps { address = XX.XX.XX.X1, XX.XX.XX.X2, XX.XX.XX.X5, [XXXX:XXXX:XXXX:XXXX:1:1:1:1], [XXXX:XXXX:XXXX:XXXX:1:2:1:1], [XXXX:XXXX:XXXX:XXXX:1:1:5:1] port = 993 ssl = yes } } service pop3-login { inet_listener pop3 { port = 0 } inet_listener pop3s { address = XX.XX.XX.X1, XX.XX.XX.X2, XX.XX.XX.X5, [XXXX:XXXX:XXXX:XXXX:1:1:1:1], [XXXX:XXXX:XXXX:XXXX:1:2:1:1], [XXXX:XXXX:XXXX:XXXX:1:1:5:1] port = 995 ssl = yes } } service lmtp { unix_listener /var/spool/postfix/private/dovecot-lmtp { mode = 0600 user = postfix group = postfix } } service imap { } service pop3 { } service auth { unix_listener auth-userdb { mode = 0600 user = vmail } unix_listener /var/spool/postfix/private/auth { mode = 0666 user = postfix group = postfix } user = dovecot } service auth-worker { user = vmail } service dict { unix_listener dict { } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies ist die wichtigste Einstellungsdatei f√ºr Taubenschl√§ge. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier trennen wir ungesicherte Verbindungen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und sichere Verbindungen aktivieren. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/etc/dovecot/conf.d/10-ssl.conf"</font></font><br><br><pre> <code class="bash hljs">ssl = required ssl_cert = &lt;/etc/nginx/ssl/domain1.com.2018.chained.crt ssl_key = &lt;/etc/nginx/ssl/domain1.com.2018.key <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> XX.XX.XX.X5 { ssl_cert = &lt;/etc/nginx/ssl/domain2.com.2018.chained.crt ssl_key = &lt;/etc/nginx/ssl/domain2.com.2018.key }</code> </pre> <br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurieren Sie ssl. </font><font style="vertical-align: inherit;">Wir weisen darauf hin, dass ssl erforderlich ist. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und das Zertifikat selbst. </font><font style="vertical-align: inherit;">Ein wichtiges Detail ist die ‚Äûlokale‚Äú Richtlinie. </font><font style="vertical-align: inherit;">Gibt an, wenn eine Verbindung zu welchem ‚Äã‚Äãlokalen IPv4 hergestellt wird - welches SSL-Zertifikat verwendet werden soll. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPv6 ist hier √ºbrigens nicht konfiguriert, ich werde diese Auslassung sp√§ter als Thread korrigieren. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XX.XX.XX.X5 (Dom√§ne2) - kein Zertifikat. </font><font style="vertical-align: inherit;">Um Clients zu verbinden, m√ºssen Sie domain1.com angeben. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XX.XX.XX.X2 (Dom√§ne3) - Es gibt ein Zertifikat. Sie k√∂nnen domain1.com oder domain3.com angeben, um Clients zu verbinden.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datei "/etc/dovecot/conf.d/15-lda.conf" </font></font><br><br><pre> <code class="bash hljs">protocol lda { mail_plugins = <span class="hljs-variable"><span class="hljs-variable">$mail_plugins</span></span> sieve }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies wird in Zukunft f√ºr Spamassassin ben√∂tigt. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/etc/dovecot/conf.d/20-imap.conf"</font></font><br><br><pre> <code class="bash hljs">protocol imap { mail_plugins = <span class="hljs-variable"><span class="hljs-variable">$mail_plugins</span></span> antispam }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies ist ein Antispam-Plugin. </font><font style="vertical-align: inherit;">Es ist erforderlich, um Spamassasin zum Zeitpunkt der √úbertragung in / aus dem Spam-Ordner zu trainieren. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/etc/dovecot/conf.d/20-pop3.conf"</font></font><br><br><pre> <code class="bash hljs">protocol pop3 { }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Genau so eine Datei ist. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/etc/dovecot/conf.d/20-lmtp.conf"</font></font><br><br><pre> <code class="bash hljs">protocol lmtp { mail_plugins = <span class="hljs-variable"><span class="hljs-variable">$mail_plugins</span></span> sieve postmaster_address = admin@domain1.com }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurieren Sie lmtp. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/etc/dovecot/conf.d/90-antispam.conf"</font></font><br><br><pre> <code class="bash hljs">plugin { antispam_backend = pipe antispam_trash = Trash;trash antispam_spam = Junk;Spam;SPAM antispam_pipe_program_spam_arg = --spam antispam_pipe_program_notspam_arg = --ham antispam_pipe_program = /usr/bin/sa-learn antispam_pipe_program_args = --username=%Lu }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spamassasin-Trainingseinstellungen zum Zeitpunkt der √úbertragung in / aus dem Spam-Ordner. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/etc/dovecot/conf.d/90-sieve.conf"</font></font><br><br><pre> <code class="bash hljs">plugin { sieve = ~/.dovecot.sieve sieve_dir = ~/sieve sieve_after = /var/lib/dovecot/sieve/default.sieve }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine Datei, die angibt, was mit eingehenden E-Mails zu tun ist. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/var/lib/dovecot/sieve/default.sieve"</font></font><br><br><pre> <code class="bash hljs">require [<span class="hljs-string"><span class="hljs-string">"fileinto"</span></span>, <span class="hljs-string"><span class="hljs-string">"mailbox"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> header :contains <span class="hljs-string"><span class="hljs-string">"X-Spam-Flag"</span></span> <span class="hljs-string"><span class="hljs-string">"YES"</span></span> { fileinto :create <span class="hljs-string"><span class="hljs-string">"Spam"</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist notwendig, die Datei zu kompilieren: "sievec default.sieve". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/etc/dovecot/conf.d/auth-sql.conf.ext"</font></font><br><br><pre> <code class="bash hljs">passdb { driver = sql args = /etc/dovecot/dovecot-sql.conf.ext } userdb { driver = static args = uid=vmail gid=vmail home=/var/mail/vhosts/%d/%n }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Angeben von SQL-Dateien f√ºr die Autorisierung. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und die Datei selbst ist eine Art der Autorisierung. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/etc/dovecot/dovecot-sql.conf.ext"</font></font><br><br><pre> <code class="bash hljs">driver = mysql connect = host=127.0.0.1 dbname=servermail user=usermail password=password default_pass_scheme = SHA512-CRYPT password_query = SELECT email as user, password FROM virtual_users WHERE email=<span class="hljs-string"><span class="hljs-string">'%u'</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies entspricht den gleichen Einstellungen f√ºr Postfix. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/etc/dovecot/dovecot.conf"</font></font><br><pre> <code class="bash hljs">protocols = imap lmtp pop3 listen = *, :: dict { } !include conf.d/*.conf !include_try local.conf</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Hauptkonfigurationsdatei. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wichtig ist, dass wir hier angeben, Protokolle hinzuzuf√ºgen.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ============== SpamAssassin ============== </font></font></h2><br><pre> <code class="bash hljs">apt-get install spamassassin spamc</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Installieren Sie die Pakete. </font></font><br><br><pre> <code class="bash hljs">adduser spamd --disabled-login</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> F√ºgen Sie einen Benutzer hinzu, in dessen Namen. </font></font><br><br><pre> <code class="bash hljs">systemctl <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> spamassassin.service</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aktivieren Sie beim Booten den automatischen Download des Spamassassin-Dienstes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/ etc / default / spamassassin":</font></font><br><br><pre> <code class="bash hljs">CRON=1</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aktivieren Sie standardm√§√üig die automatische Aktualisierung von Regeln. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei "/etc/spamassassin/local.cf":</font></font><br><br><pre> <code class="bash hljs">report_safe 0 use_bayes 1 bayes_auto_learn 1 bayes_auto_expire 1 bayes_store_module Mail::SpamAssassin::BayesStore::MySQL bayes_sql_dsn DBI:mysql:sa:localhost:3306 bayes_sql_username sa bayes_sql_password password</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist notwendig, die Datenbank "sa" in MySQL mit dem Benutzer "sa" mit dem Passwort "Passwort" zu machen (durch etwas Passendes zu ersetzen). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">report_safe - Anstelle eines Briefes wird ein Bericht √ºber die Spam-Nachricht gesendet. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">use_bayes sind Spamassassin-Einstellungen f√ºr maschinelles Lernen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die verbleibenden Spamassassin-Einstellungen wurden fr√ºher in diesem Artikel angewendet. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die allgemeine Einstellung ist Spamassassin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informationen zum Verschieben neuer Spam-E-Mails in den IMAP-Spam-Ordner</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√úber einen einfachen Haufen Dovecot + SpamAssassin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich empfehle, die Theorie des Lernens von Spamassasin zu lesen, wenn Buchstaben in IMAP-Ordnern verschoben werden (und empfehle sie nicht zur Verwendung)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ============== Kontaktaufnahme mit der Community ============== </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich m√∂chte auch eine Idee in die Community einbringen, wie das Sicherheitsniveau f√ºr weitergeleitete Briefe erh√∂ht werden kann. </font><font style="vertical-align: inherit;">Da bin ich so tief in das Thema Mail eingetaucht. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Damit der Benutzer auf seinem Client ein Schl√ºsselpaar erstellen kann (Outlook, Thunderbird, Browser-Plugin, ...). </font><font style="vertical-align: inherit;">√ñffentlich und privat. </font><font style="vertical-align: inherit;">√ñffentlich - an DNS senden. </font><font style="vertical-align: inherit;">Privat - auf dem Client speichern. </font><font style="vertical-align: inherit;">Mailserver k√∂nnen den √∂ffentlichen Schl√ºssel verwenden, um an einen bestimmten Empf√§nger zu senden. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und um sich mit solchen E-Mails vor Spam zu sch√ºtzen (ja, der Mailserver kann den Inhalt nicht sehen), m√ºssen Sie drei Regeln eingeben:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Obligatorische echte DKIM-Signatur, obligatorischer SPF, obligatorischer rDNS. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ein neuronales Netzwerk zum Thema Antispam-Training + DB dazu auf der Client-Seite. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Der Verschl√ºsselungsalgorithmus sollte so sein, dass die sendende Seite 100-mal mehr CPU-Leistung f√ºr die Verschl√ºsselung aufwenden muss als die empfangende Seite. </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zus√§tzlich zu √∂ffentlichen Briefen - um ein Standard-Einladungsschreiben zu entwickeln, "um mit der sicheren Korrespondenz zu beginnen". </font><font style="vertical-align: inherit;">Einer der Benutzer (Postfach) sendet einen Brief mit einem Anhang an das andere Postfach. </font><font style="vertical-align: inherit;">In dem Brief der Textvorschlag zum Starten eines sicheren Kommunikationskanals f√ºr Korrespondenz und der √∂ffentliche Schl√ºssel des Eigent√ºmers der Mailbox (mit dem privaten Schl√ºssel auf der Clientseite).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie k√∂nnen sogar ein Schl√ºsselpaar speziell f√ºr jede Korrespondenz erstellen. Der Empf√§nger kann dieses Angebot annehmen und seinen √∂ffentlichen Schl√ºssel senden (ebenfalls speziell f√ºr diese Korrespondenz erstellt). Als n√§chstes sendet der erste Benutzer einen Dienststeuerbrief (verschl√ºsselt mit dem √∂ffentlichen Schl√ºssel des zweiten Benutzers) - nach dessen Empfang der zweite Benutzer den gebildeten Kommunikationskanal als zuverl√§ssig betrachten kann. Dann sendet der zweite Benutzer einen Kontrollbrief - und dann kann der erste Benutzer auch den gebildeten Kanal als gesch√ºtzt betrachten. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um das Abfangen von Schl√ºsseln auf der Stra√üe zu bek√§mpfen, muss im Protokoll die M√∂glichkeit vorgesehen werden, mindestens einen √∂ffentlichen Schl√ºssel √ºber ein Flash-Laufwerk zu √ºbertragen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und vor allem, dass alles funktioniert (die Frage ist: Wer wird daf√ºr bezahlen?):</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F√ºhren Sie E-Mail-Zertifikate im Wert von 10 USD f√ºr 3 Jahre ein. </font><font style="vertical-align: inherit;">Dadurch kann der Absender in DNS angeben, dass "meine √∂ffentlichen Schl√ºssel da drau√üen sind". </font><font style="vertical-align: inherit;">Und sie geben die M√∂glichkeit, eine sichere Verbindung herzustellen. </font><font style="vertical-align: inherit;">Nehmen Sie gleichzeitig solche Verbindungen kostenlos ein. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Mail monetarisiert schlie√ülich seine Nutzer. </font><font style="vertical-align: inherit;">F√ºr 10 US-Dollar in 3 Jahren - das Recht, sichere Korrespondenzkan√§le zu schaffen.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ============== Fazit ============== </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um den gesamten Artikel zu testen, wollte ich einen dedizierten Server f√ºr einen Monat mieten und eine Domain mit einem SSL-Zertifikat kaufen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Lebensumst√§nde entwickelten sich jedoch, so dass sich dieses Problem zwei Monate hinzog. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und als die Freizeit wieder auftauchte, beschloss ich, den Artikel so zu ver√∂ffentlichen, wie er ist, und nicht zu riskieren, dass sich die Ver√∂ffentlichung um ein weiteres Jahr verz√∂gert. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn es viele Fragen gibt wie "aber dies wird nicht ausf√ºhrlich genug beschrieben" - dann wird es wahrscheinlich Kr√§fte geben, einen dedizierten Server mit einer neuen Dom√§ne und einem neuen SSL-Zertifikat zu nehmen und detaillierter zu beschreiben und vor allem - alle fehlenden wichtigen Details zu identifizieren. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich m√∂chte auch Feedback zum Thema Ideen zu Mail-Zertifikaten erhalten. Wenn Ihnen die Idee gef√§llt, werde ich versuchen, die Kraft zu finden, einen Entwurf f√ºr rfc zu schreiben.</font></font><br><br> <b>     ‚Äî     . <br>       ‚Äî     . <br>           .</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de413689/">https://habr.com/ru/post/de413689/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de413675/index.html">Joker 2018: Club anonymer Java-Entwickler</a></li>
<li><a href="../de413677/index.html">ROS-Start auf dem selbstausgleichenden EduMIP-Roboter</a></li>
<li><a href="../de413679/index.html">Angular6. PWA. Faule Lademodule. Automatische Bereitstellung in Firebase</a></li>
<li><a href="../de413681/index.html">Die Technik zur Entwicklung hochzuverl√§ssiger Server auf Go</a></li>
<li><a href="../de413683/index.html">ILV hat 7 Millionen IP-Adressen entsperrt. Bleiben Sie 4 Millionen gesperrt</a></li>
<li><a href="../de413691/index.html">Starten Sie</a></li>
<li><a href="../de413693/index.html">Handmade: Programmierbare Tastatur f√ºr den Online-Handel zum Selbermachen</a></li>
<li><a href="../de413695/index.html">Messenger-Sicherheit: Warum das Speichern von Nachrichten in der Blockchain eine gute Idee sein k√∂nnte</a></li>
<li><a href="../de413697/index.html">Wie man keinen Code schreibt</a></li>
<li><a href="../de413699/index.html">"Wer r√ºhrt Wasser auf - 2": oder alles, was Sie √ºber Umkehrosmose wissen wollten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>