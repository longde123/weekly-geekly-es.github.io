<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêï üëçüèª üë®‚Äçüëß‚Äçüë¶ Profundidades do SIEM: correla√ß√µes prontas para uso. Parte 5. Metodologia para o desenvolvimento de regras de correla√ß√£o ü§≤üèº üçà üõ∞Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Conclu√≠mos a s√©rie de artigos dedicados √†s regras de correla√ß√£o elaboradas imediatamente. Estabelecemos uma meta para formular uma abordagem que nos p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Profundidades do SIEM: correla√ß√µes prontas para uso. Parte 5. Metodologia para o desenvolvimento de regras de correla√ß√£o</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/446212/">  Conclu√≠mos a s√©rie de artigos dedicados √†s regras de correla√ß√£o elaboradas imediatamente.  Estabelecemos uma meta para formular uma abordagem que nos permita criar regras de correla√ß√£o que possam funcionar "prontas para uso" com o m√≠nimo de falsos positivos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/e6/bz/th/e6bzthq7bfspxncuni5hbtudz84.png" alt="Metodologia para o desenvolvimento de regras de correla√ß√£o"></div><br>  <i>Imagem: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Marketing de Software</a></i> <br><a name="habracut"></a><br>  Todos os pontos-chave do artigo est√£o dispon√≠veis na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">conclus√£o</a> , no mesmo local em que esta metodologia √© apresentada na forma de um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">diagrama</a> gr√°fico. <br><br>  Brevemente sobre o que aconteceu nos artigos anteriores: eles descreveram como deveria ser um conjunto de campos de um evento normalizado - um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">diagrama</a> ;  qual sistema de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">categoriza√ß√£o de</a> eventos usar;  como, usando um sistema de categoriza√ß√£o e um esquema, para unificar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">processo de</a> normaliza√ß√£o de eventos.  Tamb√©m examinamos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">contexto da</a> implementa√ß√£o de regras de correla√ß√£o e examinamos o que o SIEM deveria saber sobre o Sistema Automatizado (AS) que est√° monitorando e por qu√™. <br><br>  Todas as abordagens e racioc√≠nios acima s√£o os blocos a partir dos quais a metodologia para o desenvolvimento de regras de correla√ß√£o √© constru√≠da.  √â hora de reuni-los e olhar para o quadro todo. <br><br>  Toda a metodologia para o desenvolvimento de regras de correla√ß√£o consiste em quatro blocos: <br><br><ul><li>  prepara√ß√£o de fontes e arredores; </li><li>  normaliza√ß√£o de eventos e seu enriquecimento; </li><li>  adapta√ß√£o das regras de correla√ß√£o ao contexto do EA; </li><li>  forma√ß√£o de um acordo sobre aspectos positivos. </li></ul><br><h1>  Preparando fontes e ambientes </h1><br>  As regras de correla√ß√£o operam em eventos que geram fontes.  Nesse sentido, √© extremamente importante que as fontes necess√°rias para as regras de correla√ß√£o estejam presentes nos alto-falantes e estejam configuradas corretamente. <br><br><img src="https://habrastorage.org/webt/7r/ih/b5/7rihb5lksdmrzhpjpte5q9-3wls.png" alt="Preparando fontes e ambientes"><br>  <i>Preparando fontes e ambientes</i> <br><br>  <b>Etapa 1</b> : <i>pense na l√≥gica geral da regra e entenda quais fontes de eventos s√£o necess√°rias.</i>  Se voc√™ estiver desenvolvendo do zero ou adotando uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">regra de</a> correla√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sigma</a> pronta, precisar√° entender com base nos eventos a partir dos quais as fontes funcionar√£o. <br><br>  <b>Etapa 2</b> : <i>verifique se todas as fontes necess√°rias est√£o na empresa e podem ser coletadas.</i>  Uma situa√ß√£o √© poss√≠vel quando uma regra opera em uma cadeia de eventos de v√°rias fontes do formul√°rio (evento A da origem 1) - (evento B da origem 2) - (evento C da origem 3) por 5 minutos.  Se sua empresa n√£o tiver pelo menos uma fonte, essa regra se tornar√° in√∫til, pois nunca funcionar√°.  Voc√™ precisa entender se, em princ√≠pio, √© poss√≠vel coletar eventos das fontes necess√°rias e se o seu SIEM pode fornec√™-lo.  Por exemplo, a fonte grava eventos em um arquivo, mas o arquivo √© criptografado ou um banco de dados n√£o padr√£o √© usado na origem para armazenamento, cujo acesso n√£o pode ser garantido por meio do driver ODBC / JDBC padr√£o. <br><br>  <b>Etapa 3</b> : <i>conectar fontes ao SIEM.</i>  <i>N√£o importa o qu√£o banal possa parecer, mas nesta etapa √© necess√°rio implementar a cole√ß√£o de eventos.</i>  Muitas vezes h√° muitos problemas.  Por exemplo, problemas organizacionais, quando o gerenciamento de TI pro√≠be categoricamente a conex√£o com sistemas de miss√£o cr√≠tica.  Ou t√©cnico, quando sem configura√ß√µes adicionais, o agente SIEM (SmartConnector, Universal Forwarder), ao coletar eventos, simplesmente "mata" a fonte, levando a uma nega√ß√£o de servi√ßo.  Isso geralmente pode ser observado ao conectar DBMSs altamente carregados ao SIEM. <br><br>  <b>Etapa 4</b> : <i>verifique se a auditoria nas fontes est√° configurada corretamente, se os eventos necess√°rios para a correla√ß√£o s√£o recebidos no SIEM.</i>  As regras de correla√ß√£o esperam certos tipos de eventos.  Eles devem ser gerados pela fonte.  Geralmente, para gerar os eventos necess√°rios para as regras, a fonte deve ser configurada adicionalmente: a auditoria avan√ßada √© ativada e a sa√≠da de log em um determinado formato √© configurada. <br><br>  A ativa√ß√£o da auditoria estendida frequentemente afeta a quantidade de fluxo de eventos (EPS) recebido no SIEM da fonte.  Devido ao fato de a pr√≥pria fonte e o SIEM estarem na √°rea de responsabilidade de diferentes departamentos, sempre existe o risco de a auditoria estendida ser desativada e, como resultado, os tipos de eventos necess√°rios deixar√£o de ocorrer no SIEM.  Esse problema pode ser parcialmente detectado pelo monitoramento do fluxo de eventos para cada fonte, ou melhor, pelo monitoramento de altera√ß√µes nos Eventos por Segundo (EPS). <br><br>  <b>Etapa 5</b> : <i>verifique se os eventos est√£o em andamento e configure o monitoramento de origem.</i>  Em qualquer infraestrutura, mais cedo ou mais tarde, aparecem falhas na rede ou na pr√≥pria fonte.  Nesse ponto, o SIEM perde contato com a fonte e n√£o pode receber eventos.  Se a fonte for passiva e gravar seus logs em um arquivo ou banco de dados, os eventos n√£o ser√£o perdidos no caso de uma falha e o SIEM poder√° receb√™-los quando a comunica√ß√£o for restaurada.  Se a fonte estiver ativa e enviar eventos para o SIEM, por exemplo, via syslog, sem salv√°-los adicionalmente em qualquer lugar, em caso de falha, os eventos ser√£o perdidos e sua regra de correla√ß√£o simplesmente n√£o funcionar√°, porque o evento desejado n√£o ser√° esperado.  Aprofundando, voc√™ pode ver que, mesmo ao trabalhar com uma fonte passiva, ao restaurar a comunica√ß√£o ap√≥s uma falha, n√£o h√° garantia de que as regras de correla√ß√£o funcionem, especialmente aquelas que funcionam com janelas de tempo.  Considere o exemplo de regra descrito acima: (evento A da fonte 1) - (evento B da fonte 2) - (evento C da fonte 3) por 5 minutos.  Se ocorrer uma falha ap√≥s o evento B e a conex√£o for restaurada em uma hora, a correla√ß√£o n√£o funcionar√°, pois o evento C n√£o chegar√° nos 5 minutos esperados. <br><br>  Mantendo esses recursos em mente, voc√™ deve configurar o monitoramento das fontes das quais os eventos s√£o coletados.  Esse monitoramento deve monitorar a disponibilidade das fontes, a pontualidade da chegada dos eventos a partir delas, o poder do fluxo de eventos coletados (EPS). <br><br>  O acionamento do sistema de monitoramento √© o primeiro sino que fala da apar√™ncia de um fator negativo que afeta o desempenho de todas ou parte das regras de correla√ß√£o. <br><br><h1>  Normaliza√ß√£o de eventos e seu enriquecimento </h1><br>  Coletar os eventos necess√°rios para a correla√ß√£o n√£o √© suficiente.  Eventos que chegam ao SIEM devem ser normalizados estritamente de acordo com as regras aceitas.  Escrevemos sobre os problemas de normaliza√ß√£o e a forma√ß√£o de uma metodologia de normaliza√ß√£o em um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo</a> separado.  Em geral, esse bloco pode ser caracterizado como uma luta contra a entrada e sa√≠da de lixo ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GIGO</a> ). <br><br><img src="https://habrastorage.org/webt/1b/na/-x/1bna-xnslsomq5xp8shkaz7snr4.png" alt="Normaliza√ß√£o e enriquecimento de eventos"><br>  <i>Normaliza√ß√£o e enriquecimento de eventos</i> <br><br>  <b>Etapa 6</b> e <b>Etapa 7</b> : <i>Categoriza√ß√£o de eventos e normaliza√ß√£o de eventos de acordo com a categoria, com base na metodologia.</i>  N√£o iremos nos aprofundar neles em detalhes, pois consideramos essas etapas em detalhes no artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">‚ÄúMetodologia para normaliza√ß√£o de eventos‚Äù</a> . <br><br>  <b>Etapa 8</b> : <i>Enriquecimento de eventos com informa√ß√µes ausentes e adicionais, de acordo com a categoria.</i>  Frequentemente, os eventos recebidos nem sempre cont√™m informa√ß√µes na medida necess√°ria para que as regras de correla√ß√£o funcionem.  Por exemplo, um evento cont√©m apenas o endere√ßo IP do host, mas n√£o h√° informa√ß√µes sobre seu FQDN ou nome do host.  Outro exemplo: um evento cont√©m um ID do usu√°rio, mas n√£o h√° nome de usu√°rio no evento.  Nesse caso, as informa√ß√µes necess√°rias devem ser extra√≠das de fontes externas - bancos de dados, controladores de dom√≠nio ou outros diret√≥rios e adicionadas ao evento. <br><br>  √â importante observar que a categoriza√ß√£o dos eventos ocorre no in√≠cio - antes da normaliza√ß√£o.  Al√©m do fato de a categoria definir as regras para normalizar o evento, tamb√©m define a lista de dados que devem ser buscados em fontes externas, se n√£o estiverem no pr√≥prio evento. <br><br><h1>  Adaptando Regras de Correla√ß√£o ao Contexto AS </h1><br>  Depois de preparar os dados de entrada (eventos) e prosseguir com o desenvolvimento de regras de correla√ß√£o, √© necess√°rio levar em considera√ß√£o as especificidades dos eventos recebidos, o pr√≥prio AS e sua variabilidade.  Mais sobre isso foi no artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Modelo de sistema como um contexto de regras de correla√ß√£o"</a> . <br><br><img src="https://habrastorage.org/webt/i6/tr/uk/i6trukg2z33jqm-lhuzuierlcbk.png" alt="Adaptando Regras de Correla√ß√£o ao Contexto AS"><br>  <i>Adaptando Regras de Correla√ß√£o ao Contexto AS</i> <br><br>  <b>Etapa 9</b> : <i>Entenda a frequ√™ncia dos eventos de cada fonte, determine a janela de tempo para correla√ß√£o.</i>  Frequentemente, as regras de correla√ß√£o usam janelas de tempo quando √© necess√°rio esperar a chegada de um determinado evento dentro de um determinado intervalo de tempo.  Ao desenvolver essas regras, √© importante considerar o atraso no recebimento de eventos.  Eles geralmente s√£o causados ‚Äã‚Äãpor dois fatores. <br><br>  <b>Primeiro</b> , a pr√≥pria fonte n√£o pode gravar imediatamente eventos no banco de dados, em um arquivo ou envi√°-lo via syslog.  O tempo desse atraso deve ser estimado e levado em considera√ß√£o na regra. <br><br>  <b>Em segundo lugar</b> , h√° um atraso na entrega de eventos ao SIEM.  Por exemplo, a cole√ß√£o de eventos do banco de dados √© configurada para que a solicita√ß√£o de eventos seja realizada a cada 10 minutos, √© claro, para que a janela de correla√ß√£o de 5 minutos n√£o seja a melhor solu√ß√£o nessa situa√ß√£o. <br><br>  O problema √© agravado quando √© necess√°rio desenvolver uma regra de correla√ß√£o que funcione com eventos de v√°rias fontes ao mesmo tempo.  Nesse caso, √© importante entender que eles podem ter prazos de entrega diferentes.  Na pior das hip√≥teses, os eventos ocorrer√£o em ordem aleat√≥ria, com uma viola√ß√£o da cronologia.  Em tal situa√ß√£o, o desenvolvedor das regras de correla√ß√£o precisa entender claramente a que horas o SIEM realiza a correla√ß√£o (no hor√°rio do evento ou quando o evento chegou no SIEM).  Observo que a correla√ß√£o no hor√°rio de chegada dos eventos √© a op√ß√£o tecnicamente mais simples e comum para processar eventos no modo pseudo-em tempo real.  No entanto, esta op√ß√£o apenas exacerba os problemas acima e n√£o os resolve. <br><br>  Se o seu SIEM fornece uma correla√ß√£o no hor√°rio do evento, provavelmente existem mecanismos para reordenar eventos que podem restaurar a cronologia real dos eventos. <br><br>  No caso de entender que a janela de tempo √© muito grande para correlacionar no fluxo, voc√™ deve usar o mecanismo de correla√ß√£o retroativa, no qual os eventos j√° salvos s√£o selecionados no banco de dados SIEM de acordo com o planejamento e executam as regras de correla√ß√£o. <br><br>  <b>Etapa 10</b> : <i>Estabelecer um Mecanismo de Exce√ß√£o.</i>  No mundo real, sempre haver√° um objeto com comportamento especial que n√£o deve ser tratado por uma regra de correla√ß√£o espec√≠fica, pois isso leva a um falso positivo.  Portanto, no est√°gio de desenvolvimento das regras, devem ser criados mecanismos para adicionar esses objetos a exce√ß√µes.  Por exemplo, se sua regra funcionar com os endere√ßos IP das m√°quinas, voc√™ precisar√° de uma lista de tabelas na qual poder√° adicionar endere√ßos para os quais a regra n√£o funcionar√°.  Da mesma forma, se uma regra funcionar com logins de usu√°rios ou nomes de processos, √© necess√°rio trabalhar preliminarmente com listas de exclus√£o de tabelas na l√≥gica da regra. <br><br>  Essa abordagem permitir√° que voc√™ adicione objetos de maneira autom√°tica ou autom√°tica a exce√ß√µes sem precisar reescrever o corpo da regra. <br><br>  <b>Etapa 11</b> : <i>Defina os limites f√≠sicos e l√≥gicos de aplicabilidade da regra de correla√ß√£o.</i>  Ao desenvolver uma regra de correla√ß√£o, √© importante entender inicialmente os limites de aplicabilidade (escopo) da regra e se eles existem.  Ao elaborar a l√≥gica e depurar a regra, √© necess√°rio focar nas especificidades dessa √°rea.  Se uma regra come√ßar a trabalhar com dados que v√£o al√©m do escopo dessa √°rea, a probabilidade de falsos positivos aumenta. <br><br>  Dois tipos de escopo podem ser distinguidos: f√≠sico e l√≥gico.  O escopo f√≠sico s√£o as redes da empresa e adjacentes e a √°rea l√≥gica s√£o as partes do AS, aplicativos de neg√≥cios ou processos de neg√≥cios.  Exemplos da √°rea f√≠sica: segmento DMZ, sub-redes internas e externas, redes de acesso remoto.  Exemplos do escopo l√≥gico das regras: controle de processo, contabilidade, segmento PCI DSS, segmento PD ou apenas fun√ß√µes espec√≠ficas de equipamento - controladores de dom√≠nio, comutadores de acesso, roteadores principais. <br><br>  Voc√™ pode definir escopos para regras de correla√ß√£o por meio de listas de tabelas.  Eles podem ser preenchidos manualmente ou automaticamente.  Se voc√™ encontrar tempo na sua empresa para o gerenciamento de ativos (gerenciamento de ativos), todos os dados necess√°rios j√° podem estar contidos no modelo AS criado no SIEM.  A gera√ß√£o autom√°tica de tais listas tabulares permite incluir dinamicamente no escopo novos ativos que aparecem na empresa.  Por exemplo, se voc√™ tivesse uma regra que funcionasse exclusivamente com controladores de dom√≠nio, a adi√ß√£o de um novo controlador √† floresta de dom√≠nio ser√° corrigida no modelo e cair√° no escopo da sua regra. <br><br>  Em geral, as listas de tabelas usadas para exce√ß√µes podem ser consideradas listas negras e as listas respons√°veis ‚Äã‚Äãpelo escopo das regras como listas brancas. <br><br>  <b>Etapa 12</b> : <i>use o modelo do alto-falante para esclarecer o contexto.</i>  No processo de desenvolvimento de uma regra de correla√ß√£o que identifique a√ß√µes maliciosas, √© importante garantir que elas possam realmente ser implementadas.  Se isso n√£o for levado em considera√ß√£o, o acionamento da regra que revelou o ataque em potencial ser√° falso, pois esse tipo de ataque pode n√£o ser aplic√°vel √† sua infraestrutura.  Vou explicar com um exemplo: <br><br><ol><li>  Suponha que tenhamos uma regra de correla√ß√£o que detecte conex√µes RDP remotas com servidores. </li><li>  O firewall apresenta uma tentativa de conectar-se √† porta TCP 3389 do servidor myserver.local. </li><li>  A regra √© acionada e voc√™ come√ßa a analisar um incidente em potencial com alta prioridade. </li></ol><br>  Durante a investiga√ß√£o, voc√™ rapidamente descobre que no myserver.local 3389 ele est√° fechado e nunca foi aberto por nenhum servi√ßo e o Linux est√° l√°.  Este √© um falso positivo que levou tempo para investigar. <br><br>  Outro exemplo: o IPS envia um evento de disparo de assinatura quando √© feita uma tentativa de explorar a vulnerabilidade CVE-2017-0144, mas durante a investiga√ß√£o, verifica-se que o patch correspondente est√° instalado na m√°quina atacada e n√£o h√° necessidade de responder a esse incidente com a maior prioridade. <br>  O uso de dados do modelo do alto-falante ajudar√° a nivelar esse problema. <br><br>  <b>Etapa 13</b> : <i>use identificadores de entidade, n√£o suas chaves de origem.</i>  Como j√° descrito no artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Modelo de sistema como um contexto de regras de correla√ß√£o", o</a> endere√ßo IP, o FQDN e at√© o MAC de um ativo podem mudar.  Portanto, se voc√™ usar os identificadores de origem do ativo na regra de correla√ß√£o ou na lista de tabelas, depois de um tempo, haver√° uma grande chance de receber falsos positivos por um motivo completamente banal, por exemplo, o servidor DHCP simplesmente emitiu esse IP para outra m√°quina. <br><br>  Se o seu SIEM tiver um mecanismo para identificar ativos, rastrear suas altera√ß√µes e permitir que voc√™ opere com seus identificadores, use identificadores, n√£o as chaves de origem do ativo. <br><br><h1>  Forma√ß√£o de um acordo positivo </h1><br>  Aproximando-se do bloco final de cria√ß√£o da regra de correla√ß√£o, lembramos que o resultado da regra √© um incidente levantado no SIEM.  Profissionais respons√°veis ‚Äã‚Äãdevem responder a esse incidente.  Embora o objetivo desta s√©rie de artigos n√£o inclua a considera√ß√£o do processo de resposta a incidentes, deve-se observar que parte das informa√ß√µes sobre o incidente j√° √© gerada no est√°gio de cria√ß√£o da regra de correla√ß√£o correspondente. <br><br>  A seguir, consideramos os pontos b√°sicos que devem ser levados em considera√ß√£o ao configurar os par√¢metros para acionar a regra de correla√ß√£o e gerar um incidente. <br><br><img src="https://habrastorage.org/webt/fg/z5/dj/fgz5djbyxha-uqiduo8ubym8ncq.png" alt="Forma√ß√£o de um acordo positivo"><br>  <i>Forma√ß√£o de um acordo positivo</i> <br><br>  <b>Etapa 14</b> : <i>Determine as condi√ß√µes de agrega√ß√£o e desligamento no caso de um grande n√∫mero de falsos positivos.</i>  No est√°gio de depura√ß√£o e no processo de funcionamento, se voc√™ n√£o aderir a esta t√©cnica :), podem ocorrer alarmes falsos das regras.  √â bom se houver uma ou duas viagens por dia, mas e se uma regra tiver milhares ou dezenas de milhares de viagens?  Obviamente, isso sugere que a regra precisa ser mais desenvolvida.  No entanto, √© necess√°rio garantir que em tais situa√ß√µes um falso positivo maci√ßo: <br><br><ol><li>  N√£o afetou o desempenho do SIEM. </li><li>  Entre a massa de falsos positivos, incidentes realmente importantes n√£o foram perdidos.  Existe at√© um tipo separado de ataque destinado a ocultar a principal atividade maliciosa por tr√°s de muitas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">atividades</a> falsas. </li></ol><br>  Problemas desse tipo podem ser resolvidos se, ao criar uma regra de correla√ß√£o no n√≠vel de todo o sistema como um todo ou para cada regra separadamente, condi√ß√µes para a agrega√ß√£o de incidentes e condi√ß√µes para o desligamento de emerg√™ncia da regra. <br><br>  O mecanismo de agrega√ß√£o de incidentes permitir√° n√£o criar milh√µes de incidentes id√™nticos, mas "colar" novos incidentes em um, desde que sejam id√™nticos.  Em casos extremos, quando mesmo a agrega√ß√£o de incidentes gera uma carga significativa, √© recomend√°vel definir a regra de correla√ß√£o para desligar automaticamente quando o n√∫mero especificado de opera√ß√µes por unidade de tempo for excedido (minuto, hora, dia). <br><br>  <b>Etapa 15</b> : <i>defina as regras para gerar o nome do incidente.</i>  Esse item geralmente √© negligenciado, especialmente se eles n√£o estiverem desenvolvendo regras para sua empresa, por exemplo, se uma empresa terceirizada for respons√°vel por implementar o SIEM e desenvolver regras.  O nome da regra de correla√ß√£o, bem como o incidente gerado, devem ser curtos e refletir claramente a ess√™ncia de uma regra espec√≠fica. <br><br>  Se mais de uma pessoa trabalhar com incidentes e regras de correla√ß√£o em sua empresa, √© recomend√°vel que voc√™ desenvolva regras de nomenclatura.  Eles devem ser entendidos e aceitos por toda a equipe que trabalha com o SIEM. <br><br>  <b>Etapa 16</b> : <i>defina as regras para definir a import√¢ncia do incidente.</i>  A maioria das solu√ß√µes SIEM no √∫ltimo est√°gio de cria√ß√£o de um incidente permite definir sua import√¢ncia e signific√¢ncia.  Algumas decis√µes chegam a calcular a import√¢ncia automaticamente, com base no contexto do incidente e nos objetos envolvidos. <br><br>  Caso seu SIEM opere exclusivamente o c√°lculo autom√°tico da import√¢ncia dos incidentes, vale a pena descobrir com base no que e com que f√≥rmula √© calculada.  Por exemplo, se a import√¢ncia √© calculada com base na signific√¢ncia dos ativos envolvidos no incidente, √© necess√°rio levar a s√©rio os problemas do Asset Management em uma empresa com anteced√™ncia. <br><br>  Se voc√™ definir a import√¢ncia de um incidente manualmente, √© recomend√°vel desenvolver uma f√≥rmula de c√°lculo que leve em considera√ß√£o pelo menos o seguinte: <br><br><ol><li>  A import√¢ncia do escopo em que a regra funciona.  Por exemplo, um incidente na zona de miss√£o cr√≠tica dos sistemas pode ser mais cr√≠tico do que se o mesmo incidente ocorresse exatamente na zona de sistemas cr√≠ticos de neg√≥cios. </li><li>  A import√¢ncia dos ativos e contas de usu√°rio envolvidos no incidente. </li><li>  A recorr√™ncia deste incidente na empresa. </li></ol><br>  Al√©m disso, como na nomea√ß√£o de incidentes, √© importante que todas as partes interessadas compreendam clara e igualmente as regras pelas quais a import√¢ncia de um incidente √© formada. <br><a name="Conclusions"></a><br><h1>  Conclus√µes </h1><br>  Resumindo os resultados de nossa s√©rie de artigos, observo que √© poss√≠vel, na minha opini√£o, criar regras de correla√ß√£o que funcionem imediatamente.  A solu√ß√£o pode ser uma fus√£o de abordagens organizacionais e t√©cnicas.  O pr√≥prio SIEM deve ser capaz de fazer algo, mas os especialistas que o operam precisam fazer e saber algo. <br><br>  Para resumir: <br><br><ol><li>  O m√©todo consiste nos seguintes blocos: <br><ul><li>  Preparando fontes e ambientes. </li><li>  Normaliza√ß√£o de eventos e seu enriquecimento. </li><li>  Adapta√ß√£o de regras de correla√ß√£o ao contexto AS. </li><li>  Forma√ß√£o de um acordo sobre aspectos positivos. </li></ul></li><li>  Cada unidade possui componentes organizacionais e t√©cnicos. </li><li>    ,        SIEM,        . </li><li>      ,     ,     SIEM-. </li><li>              .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> . </li></ol><br><a name="Schema"></a><br><img src="https://habrastorage.org/webt/iw/gz/kz/iwgzkzilc0khjwsscaycz8mowes.png" alt="Metodologia para o desenvolvimento de regras de correla√ß√£o prontas para uso"><br> <i>   ,  ¬´ ¬ª</i> <br><br>   ,     ,       .      ‚Äî        .   . <br><a name="Articles"></a><br><hr><br> <b> :</b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> SIEM:  ¬´ ¬ª.  1:     ?</a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> SIEM:  ¬´ ¬ª.  2.      ¬´¬ª</a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> SIEM:  ¬´ ¬ª.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3.1.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> SIEM:  ¬´ ¬ª.  3.2.   </a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> SIEM:  ¬´ ¬ª.  4.      </a> <br><br>  SIEM:  ¬´ ¬ª.  5.     ( <i> </i> ) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt446212/">https://habr.com/ru/post/pt446212/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt446202/index.html">O resumo de materiais frescos do mundo do front-end da √∫ltima semana n ¬∞ 358 (25 a 31 de mar√ßo de 2019)</a></li>
<li><a href="../pt446204/index.html">Previs√£o de como as restri√ß√µes da Internet ser√£o superadas</a></li>
<li><a href="../pt446206/index.html">Tutorial Reagir Parte 26: Arquitetura de Aplicativos, Padr√£o de Container / Componente</a></li>
<li><a href="../pt446208/index.html">Tutorial Reagir Parte 25: Workshop sobre formul√°rios</a></li>
<li><a href="../pt446210/index.html">ADAM-3600 - um controlador industrial multifuncional</a></li>
<li><a href="../pt446214/index.html">OS1: um kernel primitivo no Rust para x86. Parte 3. Cart√£o de mem√≥ria, exce√ß√£o de falha de p√°gina, pilha e aloca√ß√µes</a></li>
<li><a href="../pt446218/index.html">O designer de jogos n√£o √© muito diferente de um psicopata. Como fizemos o jogo CMAN</a></li>
<li><a href="../pt446222/index.html">Uso de potenciais t√©rmicos para an√°lise de territ√≥rio</a></li>
<li><a href="../pt446228/index.html">Melhorando a qualidade da classifica√ß√£o de texto conectando a Wikipedia</a></li>
<li><a href="../pt446230/index.html">Monitoramento e gerenciamento remotos de dispositivos baseados em Linux / OpenWrt / Lede atrav√©s da porta 80, continua√ß√£o</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>