<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëßüèº üíÄ üêõ Maschinelles Lernen @ booking.com üí∑ üëπ üòñ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Durch maschinelles Lernen k√∂nnen Sie den Dienst f√ºr Benutzer wesentlich komfortabler gestalten. Es ist nicht so schwierig, mit der Umsetzung von Empfe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Maschinelles Lernen @ booking.com</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/427673/"> Durch maschinelles Lernen k√∂nnen Sie den Dienst f√ºr Benutzer wesentlich komfortabler gestalten.  Es ist nicht so schwierig, mit der Umsetzung von Empfehlungen zu beginnen. Die ersten Ergebnisse k√∂nnen auch ohne eine etablierte Infrastruktur erzielt werden. Hauptsache, Sie beginnen.  Und nur dann, um ein Gro√üsystem aufzubauen.  So fing alles bei Booking.com an.  Und was daraus resultierte, welche Ans√§tze derzeit verwendet werden, wie Modelle in die Produktion eingef√ºhrt werden, welche √ºberwacht werden m√ºssen, sagte Viktor Bilyk gegen√ºber HighLoad ++ Siberia.  M√∂gliche Fehler und Probleme gingen nicht √ºber Bord, es wird jemandem helfen, die Untiefen zu umgehen, und jemand wird neue Ideen entwickeln. <br><br><img src="https://habrastorage.org/webt/xi/se/oi/xiseoiionccibwqnt5plovk4qza.jpeg"><br><br>  <strong>√úber den Sprecher:</strong> Victor Bilyk f√ºhrt auf Booking.com Produkte f√ºr maschinelles Lernen in den kommerziellen Betrieb ein. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/8IskcexLLpI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Lassen Sie uns zun√§chst sehen, wo Booking.com in welchen Produkten maschinelles Lernen einsetzt. <br><img src="https://habrastorage.org/webt/ka/6t/3y/ka6t3y4chljglcr3ijjzszcxhgm.jpeg"><br><br>  Erstens ist dies eine gro√üe Anzahl von Empfehlungssystemen f√ºr Hotels, Reiseziele, Daten und an verschiedenen Stellen im Verkaufstrichter und in verschiedenen Kontexten.  Wir versuchen beispielsweise zu erraten, wohin Sie gehen, wenn Sie √ºberhaupt nichts in die Suchzeile eingegeben haben. <br><br><img src="https://habrastorage.org/webt/lo/em/bh/loembheuhe8qp-vhv_jntors2je.jpeg"><br><br>  Dies ist ein Screenshot in meinem Konto, und ich werde dieses Jahr definitiv zwei dieser Bereiche besuchen. <br><br><img src="https://habrastorage.org/webt/ab/zc/go/abzcgoqypaywtxwzygsoxo4njrc.jpeg"><br><br>  Wir verarbeiten fast alle Textnachrichten von Kunden, von banalen Spamfiltern bis hin zu hoch entwickelten Produkten wie Assistant und ChatToBook, die Modelle verwenden, um Absichten zu bestimmen und Entit√§ten zu erkennen.  Dar√ºber hinaus gibt es Modelle, die nicht so auff√§llig sind, beispielsweise die Betrugserkennung. <br><br>  Wir analysieren Bewertungen.  Models erz√§hlen uns, warum Leute zum Beispiel nach Berlin gehen. <br><img src="https://habrastorage.org/webt/xn/sv/9e/xnsv9escc-iqeayrkec7ekop_n4.jpeg"><br><br>  Mit Hilfe von Modellen f√ºr maschinelles Lernen wird analysiert, warum das Hotel gelobt wird, damit Sie nicht selbst Tausende von Bewertungen lesen m√ºssen. <br><img src="https://habrastorage.org/webt/u6/qi/4y/u6qi4yc7gz7vgiqk0ekkxa72a_i.jpeg"><br><br>  An einigen Stellen unserer Benutzeroberfl√§che ist fast jedes Teil an die Vorhersagen einiger Modelle gebunden.  Zum Beispiel versuchen wir hier vorherzusagen, wann das Hotel ausverkauft sein wird. <br><img src="https://habrastorage.org/webt/7f/yy/kv/7fyykvfv6k6h7unwgh2unlvgzdq.jpeg"><br><br>  Wir haben oft Recht - nach 19 Stunden ist das letzte Zimmer bereits gebucht. <br><img src="https://habrastorage.org/webt/41/wy/bp/41wybpl2pkhjpcidi6yv-geyvpy.jpeg"><br><br>  Oder zum Beispiel - das Abzeichen "G√ºnstiges Angebot".  Hier versuchen wir das Subjektive zu formalisieren: Was ist ein so vorteilhaftes Angebot?  Wie kann man verstehen, dass die vom Hotel f√ºr diese Daten festgelegten Preise gut sind?  Schlie√ülich h√§ngt dies neben dem Preis von vielen Faktoren ab, wie z. B. zus√§tzlichen Dienstleistungen, und oft sogar von externen Gr√ºnden, wenn beispielsweise in dieser Stadt gerade die Weltmeisterschaft oder eine gro√üe technische Konferenz stattfindet. <br><br><h2>  Beginn der Implementierung <br></h2><br>  Lassen Sie uns vor ein paar Jahren, im Jahr 2015, zur√ºckspulen.  Einige der Produkte, √ºber die ich gesprochen habe, existieren bereits.  Dar√ºber hinaus ist das System, √ºber das ich heute sprechen werde, noch nicht.  Wie fand die Implementierung zu diesem Zeitpunkt statt?  Die Dinge waren ehrlich gesagt nicht sehr.  Tatsache ist, dass wir ein gro√ües Problem hatten, von dem ein Teil technisch und ein Teil organisatorisch ist. <br><img src="https://habrastorage.org/webt/05/om/8s/05om8smme1rfenwrzl_ue7rwwh4.jpeg"><br><br>  Wir haben Datenwissenschaftler an bestehende funktions√ºbergreifende Teams geschickt, die an einem bestimmten Benutzerproblem arbeiten, und erwartet, dass sie das Produkt irgendwie verbessern. <br><br>  Meistens wurden diese Teile des Produkts auf dem Perl-Stapel erstellt.  Es gibt ein offensichtliches Problem mit Perl - es ist nicht f√ºr intensives Computing ausgelegt, und unser Backend ist bereits mit anderen Dingen geladen.  Dar√ºber hinaus konnte die Entwicklung seri√∂ser Systeme, die dieses Problem l√∂sen w√ºrden, innerhalb des Teams nicht priorisiert werden, da der Fokus des Teams auf der L√∂sung eines Benutzerproblems und nicht auf der L√∂sung eines Benutzerproblems durch maschinelles Lernen liegt.  Daher w√§re Product Owner (PO) sehr dagegen. <br><br>  Mal sehen, wie es dann passiert ist. <br><br>  Es gab nur zwei M√∂glichkeiten - das wei√ü ich ganz genau, denn zu dieser Zeit arbeitete ich nur in einem solchen Team und half den Data Scientists, ihre ersten Modelle in den Kampf zu ziehen. <br><br>  Die erste Option war die <strong>Materialisierung von Vorhersagen</strong> .  Angenommen, es gibt ein sehr einfaches Modell mit nur zwei Merkmalen: <br><br><ol><li>  Land, in dem sich der Besucher befindet; </li><li>  die Stadt, in der er ein Hotel sucht. </li></ol><br>  Wir m√ºssen die Wahrscheinlichkeit eines Ereignisses vorhersagen.  Wir sprengen einfach alle Eingabevektoren: sagen wir 100.000 St√§dte, 200 L√§nder - insgesamt 20 Millionen Zeilen in MySQL.  Es klingt nach einer voll funktionsf√§higen Option f√ºr die Ausgabe einiger kleiner Rangfolgesysteme oder anderer einfacher Modelle in die Produktion. <br><img src="https://habrastorage.org/webt/vh/jq/y0/vhjqy0gxsyydgrnirucbg4kpiva.jpeg"><br><br>  Eine andere M√∂glichkeit besteht darin, <strong>die Vorhersagen direkt in den Backend-Code einzubetten</strong> .  Es gibt gro√üe Einschr√§nkungen - Hunderte, vielleicht Tausende von Koeffizienten - das ist alles, was wir uns leisten k√∂nnen. <br><img src="https://habrastorage.org/webt/oa/sm/qn/oasmqn17bfvbsfjxla2qcidhgds.jpeg"><br><br>  Offensichtlich k√∂nnen Sie weder auf die eine noch auf die andere Weise zumindest ein komplexes Modell in der Produktion herausbringen.  Dies begrenzte das Rechenzentrum und die Erfolge, die sie durch die Verbesserung von Produkten erzielen konnten.  Offensichtlich musste dieses Problem irgendwie gel√∂st werden. <br><br><h3>  Vorhersage-Service <br></h3><br>  Das erste, was wir machten, war ein Vorhersagedienst.  Wahrscheinlich ist die einfachste Architektur, die jemals in Habr√© und HighLoad ++ gezeigt wurde, niedriger. <br><img src="https://habrastorage.org/webt/my/xw/jx/myxwjxsaotaglrxaq7obr2klmtc.jpeg"><br><br>  Wir haben eine kleine Anwendung in Scala + Akka + Spray geschrieben, die einfach eingehende Vektoren nahm und die Vorhersage zur√ºckgab.  Tats√§chlich bin ich ein bisschen gerissen - das System war etwas komplizierter, weil wir es irgendwie √ºberwachen und ausrollen mussten.  In Wirklichkeit sah alles so aus: <br><img src="https://habrastorage.org/webt/jc/mi/o9/jcmio9itnh23j0xsjwm0--_mmkc.jpeg"><br><br>  Booking.com hat ein Event-System - so etwas wie ein Magazin f√ºr alle Systeme.  Es ist sehr einfach, dort zu schreiben, und dieser Stream ist sehr einfach umzuleiten.  Zuerst mussten wir Client-Telemetrie mit wahrgenommenen Latenzen und detaillierten Informationen von der Serverseite an Graphite und Grafana senden. <br><img src="https://habrastorage.org/webt/r1/9x/kf/r19xkf9zdmzalcslvhxamaxj9qk.jpeg"><br><br>  Wir haben einfache Client-Bibliotheken f√ºr Perl erstellt - den gesamten RPC in einem lokalen Aufruf versteckt, mehrere Modelle dort abgelegt und der Dienst gestartet.  Der Verkauf eines solchen Produkts war recht einfach, da wir die M√∂glichkeit hatten <strong>, komplexere Modelle vorzustellen und viel weniger Zeit zu verbringen</strong> . <br><img src="https://habrastorage.org/webt/g9/b-/xd/g9b-xdm7jzfyeysocelckin2rdc.jpeg"><br><br>  Datenwissenschaftler begannen mit viel weniger Einschr√§nkungen zu arbeiten, und in einigen F√§llen reduzierte sich die Arbeit der R√ºckst√§nde auf eine einzige Zeile. <br><br><h3>  Produktvorhersagen <br></h3><br>  Aber lassen Sie uns kurz darauf zur√ºckkommen, wie wir diese Vorhersagen im Produkt verwendet haben. <br><br>  Es gibt ein Modell, das Vorhersagen basierend auf bekannten Fakten macht.  Basierend auf dieser Vorhersage √§ndern wir irgendwie die Benutzeroberfl√§che.  Dies ist nat√ºrlich nicht das einzige Szenario f√ºr den Einsatz von maschinellem Lernen in unserem Unternehmen, aber durchaus √ºblich. <br><br>  <strong>Was ist das Problem beim Starten solcher Funktionen?</strong>  Die Sache ist, dass dies zwei Dinge in einer Flasche sind: ein Modell und eine √Ñnderung in der Benutzeroberfl√§che.  Es ist sehr schwierig, die Effekte von beiden zu trennen. <br><br>  Stellen Sie sich vor, Sie starten das Abzeichen ‚ÄûG√ºnstiges Angebot‚Äú als Teil eines AB-Experiments.  Wenn es nicht startet - es gibt keine statistisch signifikante √Ñnderung der Zielmetriken - ist nicht bekannt, wo das Problem liegt: ein unverst√§ndliches, kleines, unauff√§lliges Abzeichen oder ein schlechtes Modell. <br><br>  Dar√ºber hinaus k√∂nnen sich Modelle verschlechtern, und daf√ºr kann es viele Gr√ºnde geben.  Was gestern funktioniert hat, funktioniert heute nicht unbedingt.  Au√üerdem sind wir st√§ndig im Kaltstartmodus und verbinden st√§ndig neue St√§dte und Hotels. Menschen aus neuen St√§dten kommen zu uns.  Wir m√ºssen irgendwie verstehen, dass sich das Modell in diesen Teilen des eingehenden Raums immer noch gut verallgemeinert. <br><img src="https://habrastorage.org/webt/np/rc/91/nprc91mvpwisjodjjq2ri2eueps.jpeg"><br><br>  Der wahrscheinlich zuletzt bekannte Fall der Modellverschlechterung war die Geschichte mit Alex.  H√∂chstwahrscheinlich begann sie infolge der Umschulung, zuf√§llige Ger√§usche als Aufforderung zum Lachen zu verstehen, und begann nachts zu kichern, was die Besitzer erschreckte. <br><br><h3>  Vorhersage√ºberwachung <br></h3><br>  Um die Vorhersagen zu √ºberwachen, haben wir unser System leicht modifiziert (Abbildung unten).  Auf die gleiche Weise haben wir vom Ereignissystem aus den Stream nach Hadoop umgeleitet und begonnen, zus√§tzlich zu allem, was wir zuvor gespeichert haben, alle Eingabevektoren und alle von unserem System gemachten Vorhersagen zu speichern.  Dann haben wir sie mit Oozie in MySQL zusammengefasst und von dort mit einer kleinen Webanwendung denjenigen gezeigt, die an qualitativen Merkmalen der Modelle interessiert sind. <br><img src="https://habrastorage.org/webt/nw/jj/3i/nwjj3iu-btqmjbx1ajvbsgik2hg.jpeg"><br><br>  Es ist jedoch wichtig herauszufinden, was dort gezeigt werden soll.  Die Sache ist, dass es in unserem Fall sehr schwierig ist, die √ºblichen Metriken zu berechnen, die im Modelltraining verwendet werden, da wir oft eine gro√üe Verz√∂gerung bei den Etiketten haben. <br><br>  Betrachten Sie dies als Beispiel.  Wir m√∂chten vorhersagen, ob der Benutzer alleine oder mit der Familie in den Urlaub f√§hrt.  Wir brauchen diese Vorhersage, wenn eine Person ein Hotel w√§hlt, aber wir k√∂nnen die Wahrheit erst in einem Jahr herausfinden.  Gerade nach dem Urlaub erh√§lt der Benutzer eine Einladung, eine Bewertung abzugeben, wobei sich unter anderem die Frage stellt, ob er alleine oder mit seiner Familie dort war. <br><br>  Das hei√üt, Sie m√ºssen alle im Laufe des Jahres gemachten Vorhersagen irgendwo speichern, damit Sie schnell √úbereinstimmungen mit den eingehenden Etiketten finden k√∂nnen.  Es klang nach einer sehr ernsten, vielleicht sogar schweren Investition.  Bis wir dieses Problem gel√∂st haben, haben wir uns daher entschlossen, etwas Einfacheres zu tun. <br><br>  Es stellte sich heraus, dass dies ‚Äûeinfacher‚Äú nur ein <strong>Histogramm der Vorhersagen</strong> des Modells war. <br><img src="https://habrastorage.org/webt/k4/gu/gm/k4gugmskee9ve0ewmw2qldlcopg.jpeg"><br><br>  Oben in der Grafik befindet sich eine logistische Regression, die vorhersagt, ob der Benutzer das Datum seiner Reise √§ndern wird oder nicht.  Es ist zu sehen, dass es die Benutzer gut in zwei Klassen unterteilt: Auf der linken Seite ist der H√ºgel diejenigen, die dies nicht tun werden;  Der H√ºgel rechts ist derjenige, der es tut. <br><img src="https://habrastorage.org/webt/fy/ac/dk/fyacdkdo2pmlpmbmnmelkm3zx8w.jpeg"><br><br>  Tats√§chlich zeigen wir sogar zwei Diagramme: eines f√ºr den aktuellen Zeitraum und das andere f√ºr den vorherigen.  Es ist deutlich zu sehen, dass das Modell diese Woche (dies ist ein Wochen-Chart) eine √Ñnderung der Daten etwas h√§ufiger vorhersagt.  Es ist schwer sicher zu sagen, ob es sich um Saisonalit√§t oder um dieselbe Verschlechterung im Laufe der Zeit handelt. <br><br>  Dies f√ºhrte zu einer √Ñnderung in der Arbeit von Datenh√§ndlern, die aufh√∂rten, andere Personen einzubeziehen, und begannen, ihre Modelle schneller zu iterieren.  Sie schickten Modelle zusammen mit Backend-Ingenieuren im Trockenlauf in die Produktion.  Das hei√üt, die Vektoren wurden gesammelt, das Modell machte eine Vorhersage, aber diese Vorhersagen wurden in keiner Weise verwendet. <br><br>  Im Falle eines Abzeichens haben wir wie bisher einfach nichts angezeigt, sondern Statistiken gesammelt.  Dadurch konnten wir keine Zeit mit fehlgeschlagenen Projekten im Voraus verschwenden.  Wir haben Zeit f√ºr das Front-End und Designer f√ºr andere Experimente frei gemacht.  <strong>Solange das Rechenzentrum nicht sicher ist, ob das Modell wie gew√ºnscht funktioniert, bezieht es andere einfach nicht in diesen Prozess ein.</strong> <br><br>  Es ist interessant zu sehen, wie sich die Grafiken in verschiedenen Abschnitten √§ndern. <br><img src="https://habrastorage.org/webt/kb/z_/oy/kbz_oyrod8128_uwtafqsjoym_m.jpeg"><br><br>  Links ist die Wahrscheinlichkeit, dass sich die Daten auf dem Desktop √§ndern, rechts auf Tablets.  Es ist deutlich zu sehen, dass das Modell auf Tablets eine wahrscheinlichere √Ñnderung der Daten vorhersagt.  Dies ist h√∂chstwahrscheinlich auf die Tatsache zur√ºckzuf√ºhren, dass das Tablet h√§ufig f√ºr die Reiseplanung und seltener f√ºr Reservierungen verwendet wird. <br><br>  Es ist auch interessant zu sehen, wie sich diese Diagramme √§ndern, wenn Benutzer sich durch den Verkaufstrichter bewegen. <br><img src="https://habrastorage.org/webt/oi/ck/zi/oickzi_2tyz5vm8qyf4uk3g-dlw.jpeg"><br><br>  Links ist die Wahrscheinlichkeit der Datums√§nderung auf der Suchseite, rechts auf der ersten Buchungsseite.  Es ist zu sehen, dass eine viel gr√∂√üere Anzahl von Personen, die sich bereits f√ºr einen Termin entschieden haben, auf die Buchungsseite gelangt. <br><br>  Aber das waren gute Grafiken.  Wie sehen die schlechten aus?  Auf sehr unterschiedliche Weise.  Manchmal ist es nur Rauschen, manchmal ist es ein riesiger H√ºgel, was bedeutet, dass das Modell keine zwei Klassen von Vorhersagen effektiv trennen kann. <br><img src="https://habrastorage.org/webt/uv/c4/zo/uvc4zocpgcdejqtebbpzzvgibws.jpeg"><br><br>  Manchmal sind das riesige Gipfel. <br><img src="https://habrastorage.org/webt/gv/l1/y3/gvl1y36_ui-ut8wbo9ncdhciksg.jpeg"><br><br>  Dies ist auch eine logistische Regression, und bis zu einem gewissen Punkt zeigte sich ein sch√∂nes Bild mit zwei H√ºgeln, aber eines Morgens wurde es so. <br><br>  Um zu verstehen, was im Inneren passiert ist, m√ºssen Sie verstehen, wie die logistische Regression berechnet wird. <br><br><h4>  Kurzanleitung <br></h4><br><img src="https://habrastorage.org/webt/-f/op/w2/-fopw2q3tayu8rhnyg_pp5z4yms.jpeg"><br><br>  Dies ist eine logistische Funktion des Skalarprodukts, wobei x <sub>n</sub> einige Merkmale sind.  Eines dieser Merkmale war der Preis f√ºr eine Nacht in einem Hotel (in Euro). <br><img src="https://habrastorage.org/webt/sb/mw/6o/sbmw6ocz3ts8f-fdjawob2ve3zk.jpeg"><br><br>  Dieses Modell zu nennen w√§re ungef√§hr so: <br><img src="https://habrastorage.org/webt/cf/so/m1/cfsom1foagpoo152nli4z31aqmo.jpeg"><br><br>  Achten Sie auf die Auswahl.  Es war notwendig, den Preis in Euro umzurechnen, aber der Entwickler verga√ü es. <br><img src="https://habrastorage.org/webt/sz/5x/my/sz5xmybzwpcutqsc1xrj9vczaei.jpeg"><br><br>  W√§hrungen wie Rupien oder Rubel multiplizierten das Skalarprodukt um ein Vielfaches und zwangen dieses Modell daher, viel h√§ufiger einen Wert nahe der Einheit zu erzeugen, den wir auf dem Diagramm sehen. <br><br><h4>  Schwellenwerte <br></h4><br>  Ein weiteres n√ºtzliches Merkmal dieser Histogramme war die M√∂glichkeit einer bewussten und optimalen Auswahl von Schwellenwerten. <br><img src="https://habrastorage.org/webt/0p/j-/lj/0pj-ljv2emwsf_7wu8bttcdb-e8.jpeg"><br><br>  Wenn Sie den Ball in diesem Histogramm auf den h√∂chsten H√ºgel legen, dr√ºcken Sie ihn und stellen Sie sich vor, wo er aufh√∂ren wird. Dies ist der Punkt, der f√ºr die Klassentrennung optimal ist.  Alles rechts ist eine Klasse, alles links ist eine andere. <br><br>  Wenn Sie diesen Punkt jedoch verschieben, k√∂nnen Sie sehr interessante Effekte erzielen.  Angenommen, wir m√∂chten ein Experiment ausf√ºhren, das die Benutzeroberfl√§che irgendwie √§ndert, wenn das Modell "Ja" sagt.  Wenn Sie diesen Punkt nach rechts verschieben, wird das Publikum unseres Experiments reduziert.  Immerhin ist die Anzahl der Personen, die diese Vorhersage erhalten haben, der Bereich unter der Kurve.  In der Praxis ist die Genauigkeit von Vorhersagen jedoch viel h√∂her.  Wenn nicht gen√ºgend statische Leistung vorhanden ist, k√∂nnen Sie das Publikum Ihres Experiments erh√∂hen, aber die Genauigkeit der Vorhersagen verringern. <br><br>  Zus√§tzlich zu den Vorhersagen selbst haben wir begonnen, die Eingabewerte in den Vektoren zu √ºberwachen. <br><br><h4>  Eine hei√üe Codierung <br></h4><br>  Die meisten Funktionen unserer einfachsten Modelle sind kategorisch.  Dies bedeutet, dass dies keine Zahlen sind, sondern bestimmte Kategorien: die Stadt, aus der der Benutzer stammt, oder die Stadt, in der er ein Hotel sucht.  Wir verwenden One Hot Encoding und wandeln jeden der m√∂glichen Werte in eine Einheit in einem bin√§ren Vektor um.  Da wir zun√§chst nur unseren eigenen Rechenkern verwendeten, war es einfach, Situationen zu identifizieren, in denen im eingehenden Vektor kein Platz f√ºr die eingehende Kategorie vorhanden ist, dh das Modell hat diese Daten w√§hrend des Trainings nicht gesehen. <br><img src="https://habrastorage.org/webt/xf/9t/w4/xf9tw4lzt0qbikwpfzeenzjjpie.jpeg"><br><br>  So sieht es normalerweise aus. <br><img src="https://habrastorage.org/webt/hb/ih/0n/hbih0nrx9t3xlnl2coxoot3ek7a.jpeg"><br><br>  destination_id - die Stadt, in der der Benutzer ein Hotel sucht.  Nat√ºrlich hat das Modell nicht etwa 5% der Werte gesehen, da wir st√§ndig neue St√§dte verbinden.  besucher_cty_id = 23,32%, weil Datenwissenschaftler manchmal bewusst weniger verbreitete St√§dte weglassen. <br><br>  In einem schlechten Fall k√∂nnte es so aussehen: <br><img src="https://habrastorage.org/webt/mq/14/ak/mq14akuux2wuwsqqyif_02e8j-e.jpeg"><br><br>  Sofort 3 Eigenschaften, 100% der Werte, die das Modell noch nie gesehen hat.  Meistens geschieht dies aufgrund der Verwendung anderer als der im Training verwendeten Formate oder einfach banaler Tippfehler. <br><br>  Mit Hilfe von Dashboards erkennen und korrigieren wir solche Situationen jetzt sehr schnell. <br><br><h2>  Showcase f√ºr maschinelles Lernen <br></h2><br>  Lassen Sie uns √ºber andere Probleme sprechen, die wir gel√∂st haben.  Nachdem wir Client-Bibliotheken erstellt und √ºberwacht hatten, gewann der Service sehr schnell an Dynamik.  Wir waren buchst√§blich √ºberw√§ltigt von Anwendungen aus verschiedenen Teilen des Unternehmens: ‚ÄûLassen Sie uns auch dieses Modell verbinden!  Lass uns den alten aktualisieren! ‚Äú  Wir haben gerade gen√§ht, tats√§chlich hat jede neue Entwicklung aufgeh√∂rt. <br><br>  Wir sind aus der Situation herausgekommen, indem wir <strong>einen Selbstbedienungskiosk f√ºr Datenwissenschaftler gebaut haben</strong> .  Jetzt k√∂nnen Sie einfach zu unserem Portal gehen, das wir zun√§chst nur zur √úberwachung verwendet haben, und buchst√§blich durch Klicken auf die Schaltfl√§che das Modell in die Produktion laden.  In wenigen Minuten wird sie arbeiten und Vorhersagen geben. <br><br>  Es gab noch ein Problem. <br><img src="https://habrastorage.org/webt/mw/rp/l-/mwrpl-evpqktnfdk9l61shicboc.jpeg"><br><br>  Booking.com hat ungef√§hr 200 IT-Teams.  Wie kann man das Team in einem ganz anderen Teil des Unternehmens wissen lassen, dass es ein Modell gibt, das ihnen helfen k√∂nnte?  Sie wissen vielleicht einfach nicht, dass es ein solches Team √ºberhaupt gibt.  Wie finde ich heraus, welche Modelle es gibt und wie man sie benutzt?  Traditionell ist die externe Kommunikation in unseren Teams mit PO (Product Owner) verbunden.  Dies bedeutet nicht, dass wir keine anderen horizontalen Verbindungen haben, nur PO tut dies mehr als andere.  Es ist jedoch offensichtlich, dass auf einer solchen Skala die Eins-zu-Eins-Kommunikation nicht skaliert.  Sie m√ºssen etwas dagegen tun. <br><br>  <strong>Wie kann die Kommunikation erleichtert werden?</strong> <br><br>  Pl√∂tzlich wurde uns klar, dass das Portal, das wir ausschlie√ülich f√ºr die √úberwachung erstellt haben, allm√§hlich zu einem Schaufenster des maschinellen Lernens in unserem Unternehmen wird. <br><img src="https://habrastorage.org/webt/p_/r8/ps/p_r8pst3fhoza0zyb-b5lercws8.jpeg"><br><br>  Wir haben Datenwissenschaftlern erm√∂glicht, ihre Modelle detailliert zu beschreiben.  Wenn es viele Modelle gab, haben wir Themen- und Bereichsbezeichnungen f√ºr eine bequeme Gruppierung hinzugef√ºgt. <br><img src="https://habrastorage.org/webt/54/d5/ft/54d5ftteqrf-siyozzgllalvuly.jpeg"><br><br>  Wir haben unser Tool mit ExperimentTool verkn√ºpft.  Dies ist ein Produkt in unserem Unternehmen, das A / B-Experimente bereitstellt und die gesamte Geschichte des Experimentierens speichert. <br><img src="https://habrastorage.org/webt/kh/bp/e2/khbpe2ifrcjlhkpaf9ihq-_3m0e.jpeg"><br><br>  Zusammen mit der Beschreibung des Modells k√∂nnen Sie jetzt auch sehen, was andere Teams zuvor mit diesem Modell gemacht haben und wie erfolgreich.  Es hat alles ver√§ndert. <br><br>  Im Ernst, dies hat die Funktionsweise der IT ver√§ndert, da Sie auch in Situationen, in denen kein Datenwissenschaftler im Team ist, maschinelles Lernen verwenden k√∂nnen. <br><img src="https://habrastorage.org/webt/kf/4n/pn/kf4npnnbrtj1vh_1080whzeewbk.jpeg"><br><br>  Beispielsweise verwenden viele Teams dies w√§hrend Brainstorming-Sitzungen.  Wenn sie neue Produktideen entwickeln, w√§hlen sie einfach die Modelle aus, die zu ihnen passen, und verwenden sie.  Hierf√ºr ist nichts Kompliziertes erforderlich. <br><br>  <strong>Was hat es f√ºr uns versch√ºttet?</strong>  Derzeit liefern wir auf dem H√∂hepunkt etwa 200.000 Vorhersagen pro Sekunde mit einer Latenz von weniger als 20 bis 30 ms, einschlie√ülich HTTP-Roundtrip, und der Platzierung von mehr als 200 Modellen. <br><br>  Es scheint, dass es ein so einfacher Spaziergang im Park war: Wir haben einen wunderbaren Job gemacht, alles funktioniert, alle sind gl√ºcklich! <br><img src="https://habrastorage.org/webt/do/-q/mg/do-qmg7z1boovf5kyag7ngbr2wy.jpeg"><br><br>  Das passiert nat√ºrlich nicht.  Es gab Fehler.  Zu Beginn haben wir zum Beispiel eine kleine Zeitbombe gepflanzt.  Aus irgendeinem Grund haben wir angenommen, dass die meisten unserer Modelle Empfehlungssysteme mit starken Eingabevektoren sind, und der Scala + Akka-Stapel wurde genau deshalb ausgew√§hlt, weil es mit seiner Hilfe sehr einfach ist, parallele Berechnungen zu organisieren.  In Wirklichkeit erwies sich der Aufwand f√ºr all diese Parallelisierung zum Sammeln als h√∂her als der m√∂gliche Gewinn.  Irgendwann verarbeiteten unsere 100 Maschinen nur noch 100.000 RPS, und es traten Fehler mit ganz charakteristischen Symptomen auf: Die CPU-Auslastung ist gering, es treten jedoch Zeit√ºberschreitungen auf. <br><img src="https://habrastorage.org/webt/ms/so/zz/mssozzq2glmsbn5o-g5au7dqjaa.jpeg"><br><br>  Dann kehrten wir zu unserem Rechenkern zur√ºck, √ºberpr√ºften, machten Benchmarks und stellten als Ergebnis von Kapazit√§tstests fest, dass wir f√ºr denselben Verkehr nur 4 Maschinen ben√∂tigen. ,    ,      -,       , ,   ,      100 000 RPS  4 . <br><br>    -  ,        ,        .  -       ,      ,    ,    . <br><br>   ‚Äî    ,           .  ,    ID ,     .    ,    0. <br><img src="https://habrastorage.org/webt/cq/0b/6w/cq0b6wonigy8ltd8_jwilv7j62k.jpeg"><br><br>   ‚Äî    ,   ‚Äî     . <br><img src="https://habrastorage.org/webt/v-/qb/-u/v-qb-uqcn4kn09heh1z03rycgfm.jpeg"><br><br>   ,        .       ,    .    ,        ‚Äî      ,   .  , ,  ,       - . <br><br>     ,           ‚Äî  ID .        ‚Äî 49-51%.      ,     .     ,     ,    .     ,     . <br><br><h2>  Zukunftspl√§ne <br></h2><br><ul><li> Label based metrics <br></li></ul><br>     -           ,     .   Label based metrics,   precision  recall   . <br><br><ul><li> More tools &amp; integrations <br></li></ul><br>        ,     .     ,            Perl  Java,  ,  ,   .       Spark,        . <br><br><ul><li> Reusable training pipelines <br></li></ul><br>          . <br><br> ,   -.  ,       , ,    ,  , <strong>steaming</strong> ‚Äî    -   ,       ,   . <br><br>      .     pipeline,    ,   .       ,    ,    . <br><br><ul><li> Async models <br></li></ul><br>     .    ,  <strong>,   50 ,    </strong> .   ,            .          ,      ,   . <br><br><h3> Start small <br></h3><br><blockquote>  ,   ,         Booking.com,    ,   ,     ‚Äî   ! <br></blockquote><br>        ,  ,    MySQL. ,      ,      .    -    . B      .      ,     ,    -     ‚Äî      . <br><br><blockquote>    ,      ? <br></blockquote><br><h3> Monitor <br></h3><br>     ‚Äî      , -, . <strong> ‚Äî     </strong> .   ‚Äî   ,    .    , ,   ,  .      :  ,  . ,      ,       ,      ‚Äî ! <br><br><h3> Organization footprint <br></h3><br>   ,    .         ,     . ,                . <br><br><h3> (Don't) Follow our steps <br></h3><br>   - , , ,    . , -     ,    .   ,     .   ‚Äî     ,      ,  ?  ,  ,     ,    ? <br><br> <strong>, ,   !</strong> <br><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">HighLoad++ 2018,</a>   8  9   ,  <strong>135 </strong> ,      .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> <strong>9  -  </strong> .    ,      . <br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de427673/">https://habr.com/ru/post/de427673/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de427661/index.html">Sportiduino - elektronisches Markierungssystem f√ºr Sportveranstaltungen, Teil 3</a></li>
<li><a href="../de427663/index.html">Habro B√§ren und Krabben</a></li>
<li><a href="../de427665/index.html">Die besten intelligenten Waagen (laut Wareable)</a></li>
<li><a href="../de427669/index.html">KNX Home Control: Beleuchtung</a></li>
<li><a href="../de427671/index.html">Sberbank und Yandex haben die Beru-Handelsplattform, die russische Version von Amazon, offiziell gestartet</a></li>
<li><a href="../de427675/index.html">Papiere bitte. Wie ein neuronales Netzwerk uns hilft, Kunden zu verifizieren und Betr√ºger zu fangen</a></li>
<li><a href="../de427679/index.html">Wenn die Entscheidung getroffen wird, dauert es anderthalb Jahre, bis das Limit f√ºr zollfreie Eink√§ufe auf Null gesetzt ist</a></li>
<li><a href="../de427681/index.html">Ziehen und wischen Sie in RecyclerView. Teil 1: ItemTouchHelper</a></li>
<li><a href="../de427683/index.html">Warum das Portieren √ºber einen Ganzzahl√ºberlauf keine gute Idee ist</a></li>
<li><a href="../de427685/index.html">FSB gegen Satelliten-Internet von ausl√§ndischen Betreibern</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>