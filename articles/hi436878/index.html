<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСТ тШВя╕П ЁЯЩЕЁЯП╗ BERT 104 рднрд╛рд╖рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрддреНрдпрд╛рдзреБрдирд┐рдХ рднрд╛рд╖рд╛ рдореЙрдбрд▓ рд╣реИред рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ BERT рдХреЛ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдФрд░ Google Colab рдкрд░ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП ЁЯШЭ ЁЯСиЁЯП╗тАНЁЯТ╝ ЁЯСйЁЯП╜тАНЁЯдЭтАНЁЯСиЁЯП╛</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="BERT, Google рдХрд╛ рдПрдХ рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХ рд╣реИ, рдЬреЛ рдХрд┐ рдХрдИ рдмрдбрд╝реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдмрдбрд╝реЗ рдкреИрдорд╛рдиреЗ рдкрд░ рдЕрддреНрдпрд╛рдзреБрдирд┐рдХ рдкрд░рд┐рдгрд╛рдо рджрд┐рдЦрд╛рддрд╛ рд╣реИред BERT рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рдПрдХ рдкреНрд░рд╛рдХреГрддрд┐рдХ рднрд╛рд╖...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>BERT 104 рднрд╛рд╖рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрддреНрдпрд╛рдзреБрдирд┐рдХ рднрд╛рд╖рд╛ рдореЙрдбрд▓ рд╣реИред рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ BERT рдХреЛ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдФрд░ Google Colab рдкрд░ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436878/"><p><img src="https://habrastorage.org/getpro/habr/post_images/2bd/0ba/1c4/2bd0ba1c4fb80fe4d771f555168c9ff0.png" alt="рдЫрд╡рд┐"></p><br><p>  BERT, Google рдХрд╛ рдПрдХ рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХ рд╣реИ, рдЬреЛ рдХрд┐ рдХрдИ рдмрдбрд╝реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдмрдбрд╝реЗ рдкреИрдорд╛рдиреЗ рдкрд░ рдЕрддреНрдпрд╛рдзреБрдирд┐рдХ рдкрд░рд┐рдгрд╛рдо рджрд┐рдЦрд╛рддрд╛ рд╣реИред  BERT рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рдПрдХ рдкреНрд░рд╛рдХреГрддрд┐рдХ рднрд╛рд╖рд╛ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП AI рдкреНрд░реЛрдЧреНрд░рд╛рдо рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ: рдХрд┐рд╕реА рднреА рд░реВрдк рдореЗрдВ рдкреВрдЫреЗ рдЧрдП рд╕рд╡рд╛рд▓реЛрдВ рдХреЗ рдЬрд╡рд╛рдм рджреЗрдВ, рдЪреИрдЯ рдмреЙрдЯ рдмрдирд╛рдПрдВ, рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЕрдиреБрд╡рд╛рджрдХ, рдкрд╛рда рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВ, рдФрд░ рдЗрд╕реА рддрд░рд╣ред </p><br><p>  Google рдиреЗ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд BERT рдореЙрдбрд▓ рдкреЛрд╕реНрдЯ рдХрд┐рдП рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЬреИрд╕рд╛ рдХрд┐ рдЖрдорддреМрд░ рдкрд░ рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ, рд╡реЗ рдкреНрд░рд▓реЗрдЦрди рдХреА рдХрдореА рд╕реЗ рдЧреНрд░рд╕реНрдд рд╣реИрдВред  рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдореЗрдВ рд╣рдо рд╕реАрдЦреЗрдВрдЧреЗ рдХрд┐ рд╕реНрдерд╛рдиреАрдп рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░ BERT рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдХреИрд╕реЗ рдЪрд▓рд╛рдирд╛ рд╣реИ, рд╕рд╛рде рд╣реА Google Colab рдкрд░ рдореБрдлреНрдд рд╕рд░реНрд╡рд░ GPU рдкрд░ рднреАред </p><a name="habracut"></a><br><h2 id="zachem-eto-voobsche-nuzhno">  рдРрд╕рд╛ рдХреНрдпреЛрдВ рдЬрд░реВрд░реА рд╣реИ </h2><br><p>  рдПрдХ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЗрдирдкреБрдЯ рдХреЛ рдЯреЗрдХреНрд╕реНрдЯ рд╕рдмрдорд┐рдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдХрд┐рд╕реА рддрд░рд╣ рдЗрд╕реЗ рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдЗрд╕ рдкрддреНрд░ рдХреЛ рдкрддреНрд░ рджреНрд╡рд╛рд░рд╛ рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рд╡реЗрд╢ рджреНрд╡рд╛рд░ рдкрд░ рдПрдХ рдкрддреНрд░ рд▓рд╛рдЧреВ рдХрд░рдирд╛ред  рдлрд┐рд░ рдкреНрд░рддреНрдпреЗрдХ рдЕрдХреНрд╖рд░ рдХреЛ 0 рд╕реЗ 32 рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЗ рд╕рд╛рде рдХреВрдЯрдмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ (рд╕рд╛рде рд╣реА рд╡рд┐рд░рд╛рдо рдЪрд┐рд╣реНрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдорд╛рд░реНрдЬрд┐рди)ред  рдпрд╣ рддрдерд╛рдХрдерд┐рдд рдЪрд░рд┐рддреНрд░-рд╕реНрддрд░ рд╣реИред </p><br><p>  рд▓реЗрдХрд┐рди рдмрд╣реБрдд рдмреЗрд╣рддрд░ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреЗ рд╣реИрдВ рдЕрдЧрд░ рд╣рдо рдкреНрд░рд╕реНрддрд╛рд╡реЛрдВ рдХреЛ рдПрдХ рдкрддреНрд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╕реНрддреБрдд рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдЗрдирдкреБрдЯ рдХреЛ рддреБрд░рдВрдд рдПрдХ рдкреВрд░рд╛ рд╢рдмреНрдж (рдпрд╛ рдХрдо рд╕реЗ рдХрдо рд╢рдмреНрджрд╛рдВрд╢) рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред  рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рд╢рдмреНрдж-рд╕реНрддрд░ рд╣реЛрдЧрд╛ред  рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рд╡рд┐рдХрд▓реНрдк рд╕рднреА рдореМрдЬреВрджрд╛ рд╢рдмреНрджреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рд╕рдВрдХрд▓рд┐рдд рдХрд░рдирд╛ рд╣реИ, рдФрд░ рдЗрд╕ рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рд╢рдмреНрджреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдЦрд┐рд▓рд╛рдирд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ 1678 рдореЗрдВ "рдбреЙрдЧ" рд╢рдмреНрдж рдЗрд╕ рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рд╣реИ, рддреЛ рд╣рдо рдЗрд╕ рд╢рдмреНрдж рдХреЗ рд▓рд┐рдП рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЗрдирдкреБрдЯ рдХреЗ рд▓рд┐рдП 1678 рдирдВрдмрд░ рджрд░реНрдЬ рдХрд░рддреЗ рд╣реИрдВред </p><br><p>  рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ рдПрдХ рдкреНрд░рд╛рдХреГрддрд┐рдХ рднрд╛рд╖рд╛ рдореЗрдВ, "рдХреБрддреНрддреЗ" рд╢рдмреНрдж рдХреЗ рд╕рд╛рде, рдмрд╣реБрдд рд╕рд╛рд░реЗ рд╕рдВрдШ рдПрдХ рдмрд╛рд░ рдореЗрдВ рдПрдХ рд╡реНрдпрдХреНрддрд┐ рдореЗрдВ рдкреЙрдк рдЕрдк рдХрд░рддреЗ рд╣реИрдВ: "рд╢рд░рд╛рдмреА", "рдмреБрд░рд╛рдИ", "рдПрдХ рд╡реНрдпрдХреНрддрд┐ рдХрд╛ рджреЛрд╕реНрдд"ред  рдХреНрдпрд╛ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╕реНрддреБрддрд┐ рдореЗрдВ рд╣рдорд╛рд░реА рд╕реЛрдЪ рдХреА рдЗрд╕ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЛ рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ рдмрджрд▓рдирд╛ рд╕рдВрднрд╡ рд╣реИ?  рдпрд╣ рдЖрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╣ рд╢рдмреНрдж рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреЛ рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ рддрд╛рдХрд┐ рдЕрд░реНрде рдореЗрдВ рдкрд╛рд╕ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рд╢рдмреНрдж рдПрдХ рд╕рд╛рде рдЦрдбрд╝реЗ рд╣реЛрдВред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ "рдХреБрддреНрддреЗ" рдХреЗ рд▓рд┐рдП рдирдВрдмрд░ 1678, рдФрд░ рд╢рдмреНрдж "рд╢рд░рд╛рдмреА" рдХреЗ рд▓рд┐рдП 1680 рдирдВрдмрд░ рдХреЗ рд▓рд┐рдП рдмрддрд╛рдпрд╛ рдЬрд╛рдПред рдФрд░ "рдЪрд╛рдпрджрд╛рдиреА" рд╢рдмреНрдж рдХреЗ рд▓рд┐рдП рд╕рдВрдЦреНрдпрд╛ 9000 рд╣реИред рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рд╕рдВрдЦреНрдпрд╛ 1678 рдФрд░ 1680 рд╕рдВрдЦреНрдпрд╛ 9000 рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдПрдХ рджреВрд╕рд░реЗ рдХреЗ рдмрд╣реБрдд рдХрд░реАрдм рд╣реИрдВред </p><br><p>  рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ, рдкреНрд░рддреНрдпреЗрдХ рд╢рдмреНрдж рдХреЛ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рдирд╣реАрдВ, рдмрд▓реНрдХрд┐ рдХрдИ - 32 рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХрд╛ рдПрдХ рд╕рджрд┐рд╢, рдХрд╣рддреЗ рд╣реИрдВред  рдФрд░ рджреВрд░реА рдХреЛ рдЙрди рдмрд┐рдВрджреБрдУрдВ рдХреЗ рдмреАрдЪ рдХреА рджреВрд░реА рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдкрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдпреЗ рд╡реИрдХреНрдЯрд░ рд╕рдВрдмрдВрдзрд┐рдд рдЖрдпрд╛рдо рдХреЗ рд╕реНрдерд╛рди рдкрд░ рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реИрдВ (рдПрдХ рд╡реЗрдХреНрдЯрд░ 32 рдЕрдВрдХреЛрдВ рдХреЗ рд▓рд┐рдП рд▓рдВрдмреЗ рд╕рдордп рддрдХ, рдпрд╣ 32 рдЖрдпрд╛рдореЛрдВ рдХреЗ рд╕рд╛рде, рдпрд╛ 32 рдЕрдХреНрд╖реЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рд╕реНрдерд╛рди рд╣реИ)ред  рдпрд╣ рдЖрдкрдХреЛ рдПрдХ рд╢рдмреНрдж рдХреА рддреБрд▓рдирд╛ рдПрдХ рд╕рд╛рде рдХрдИ рд╢рдмреНрджреЛрдВ рдХреЗ рд╕рд╛рде рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ рдЕрд░реНрде рдореЗрдВ рдХрд░реАрдм рд╣реИрдВ (рдЬрд┐рд╕ рдкрд░ рднрд░реЛрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдХреНрд╖ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ)ред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЕрдВрдХрдЧрдгрд┐рдд рд╕рдВрдЪрд╛рд▓рди рд╡реИрдХреНрдЯрд░ рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдПрдХ рдХреНрд▓рд╛рд╕рд┐рдХ рдЙрджрд╛рд╣рд░рдг: рдпрджрд┐ рдЖрдк рд╡реЗрдХреНрдЯрд░ "рдореИрди" рдХреЛ рд╡реЗрдХреНрдЯрд░ рд╕реЗ рдШрдЯрд╛рддреЗ рд╣реИрдВ, рддреЛ "рдХрд┐рдВрдЧ" рд╢рдмреНрдж рдХреЛ рджрд░реНрд╢рд╛рддреЗ рд╣реИрдВ рдФрд░ "рдорд╣рд┐рд▓рд╛" рд╢рдмреНрдж рдХреЗ рд▓рд┐рдП рд╡реЗрдХреНрдЯрд░ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдкрд░рд┐рдгрд╛рдо рд╡реЗрдХреНрдЯрд░ рдорд┐рд▓рддрд╛ рд╣реИред  рдФрд░ рд╡рд╣ рдЪрдорддреНрдХрд╛рд░рд┐рдХ рд░реВрдк рд╕реЗ "рд░рд╛рдиреА" рд╢рдмреНрдж рдХреЗ рдЕрдиреБрд░реВрдк рд╣реЛрдЧрд╛ред  рдФрд░ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, "рд░рд╛рдЬрд╛ рдкреБрд░реБрд╖ + рд╕реНрддреНрд░реА = рд░рд╛рдиреА рд╣реИред"  рдЬрд╛рджреВ!  рдФрд░ рдпрд╣ рдПрдХ рд╕рд╛рд░ рдЙрджрд╛рд╣рд░рдг рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ</a> ред  рдпрд╣ рджреЗрдЦрддреЗ рд╣реБрдП рдХрд┐ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдЕрдкрдиреЗ рдЗрдирдкреБрдЯ рдкрд░ рдЧрдгрд┐рддреАрдп рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдЕрдиреБрдХреВрд▓рд┐рдд рд╣реИрдВ, рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЗрд╕ рдкрджреНрдзрддрд┐ рдХреА рдЗрддрдиреА рдЙрдЪреНрдЪ рджрдХреНрд╖рддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред </p><br><p>  рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЛ рдПрдВрдмреЗрдбрд┐рдВрдЧ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╕рднреА рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рдкреИрдХреЗрдЬ (TensorFlow, PyTorch) рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рдкрд╣рд▓реА рдкрд░рдд рдХреЛ рдПрдВрдмреЗрдбрд┐рдВрдЧ рд▓реЗрдпрд░ рдХреА рдПрдХ рд╡рд┐рд╢реЗрд╖ рдкрд░рдд рд▓рдЧрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рдЬреЛ рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХрд░рддрд╛ рд╣реИред  рдпрд╣реА рд╣реИ, рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЗрдирдкреБрдЯ рдкрд░ рд╣рдо рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдп рд╢рдмреНрдж рд╕рдВрдЦреНрдпрд╛ рдкреНрд░рд╕реНрддреБрдд рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдПрдореНрдмреЗрдбрд┐рдВрдЧ рд▓реЗрдпрд░, рд╕реНрд╡-рд╢рд┐рдХреНрд╖рдг, рдкреНрд░рддреНрдпреЗрдХ рд╢рдмреНрдж рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд▓рдВрдмрд╛рдИ рдХреЗ рд╡реЗрдХреНрдЯрд░ рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХрд░рддреЗ рд╣реИрдВ, рдХрд╣рддреЗ рд╣реИрдВ, 32 рдирдВрдмрд░ред </p><br><p>  рд▓реЗрдХрд┐рди рдЙрдиреНрд╣реЗрдВ рдЬрд▓реНрджреА рд╕реЗ рдПрд╣рд╕рд╛рд╕ рд╣реБрдЖ рдХрд┐ рдЗрд╕ рддрд░рд╣ рдХреЗ рд╕рджрд┐рд╢ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХреЛ рд╢рдмреНрджреЛрдВ рдХреЗ рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рд▓рд╛рднрджрд╛рдпрдХ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкреВрд░реЗ рд╡рд┐рдХрд┐рдкреАрдбрд┐рдпрд╛ рдкрд░, рдЧреНрд░рдВрдереЛрдВ рдХреЗ рдХреБрдЫ рд╡рд┐рд╢рд╛рд▓ рдХреЛрд╖реЛрдВ рдкрд░ рдФрд░ рд╣рд░ рдмрд╛рд░ рдлрд┐рд░ рд╕реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп рд╡рд┐рд╢рд┐рд╖реНрдЯ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рддреИрдпрд╛рд░ рдХрд┐рдП рдЧрдП рд╢рдмреНрдж рд╡реИрдХреНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ред </p><br><p>  рд╡реИрдХреНрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рд╢рдмреНрджреЛрдВ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВ, рд╡реЗ рдзреАрд░реЗ-рдзреАрд░реЗ рд╡рд┐рдХрд╕рд┐рдд рд╣реБрдП: рд╢рдмреНрдж 2vec, GloVe, рдПрд▓реНрдореЛред </p><br><p>  2018 рдХреА рдЧрд░реНрдорд┐рдпреЛрдВ рдореЗрдВ, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">OpenAI рдиреЗ рджреЗрдЦрд╛</a> рдХрд┐ рдпрджрд┐ рдЖрдк рдкрд╛рда рдХреЗ рдмрдбрд╝реЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдкрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░</a> рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдкрд░ рдПрдХ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд░реВрдк рд╕реЗ рдФрд░ рдмрдбрд╝реЗ рдорд╛рд░реНрдЬрд┐рди рдХреЗ рд╕рд╛рде рдХрдИ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкреНрд░рд╛рдХреГрддрд┐рдХ рднрд╛рд╖рд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рдЙрддреНрдХреГрд╖реНрдЯ рдкрд░рд┐рдгрд╛рдо рджрд┐рдЦрд╛рддрд╛ рд╣реИред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЗрд╕ рддрд░рд╣ рдХреЗ рдПрдХ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдЕрдкрдиреЗ рдЙрддреНрдкрд╛рджрди рдореЗрдВ рд╢рдмреНрджреЛрдВ рдХреЗ рд▓рд┐рдП рд╡реЗрдХреНрдЯрд░ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдмрдирд╛рддрд╛ рд╣реИ, рдФрд░ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдкреВрд░реЗ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рднреАред  рдФрд░ рдЗрд╕ рддрд░рд╣ рдХреЗ рднрд╛рд╖рд╛ рдореЙрдбрд▓ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд▓рдЯрдХрд╛рдХрд░ рдиреНрдпреВрд░реЙрдиреНрд╕ рдХреА рдЕрддрд┐рд░рд┐рдХреНрдд рдкрд░рддреЛрдВ рдХреА рдПрдХ рдЬреЛрдбрд╝реА рдХрд╛ рдПрдХ рдЫреЛрдЯрд╛ рд╕рд╛ рдмреНрд▓реЙрдХ, рдЖрдк рдХрд┐рд╕реА рднреА рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдЗрд╕ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  Google рд╕реЗ BERT, OpenAI (рдпреВрдирд┐рдбрд╛рдпрд░реЗрдХреНрд╢рдирд▓, рдЖрджрд┐ рдХреЗ рдмрдЬрд╛рдп рджреНрд╡рд┐рджрд┐рд╢) рд╕реЗ рдПрдХ рдЙрдиреНрдирдд GPA рдиреЗрдЯрд╡рд░реНрдХ рд╣реИ, рдЬреЛ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдкрд░ рднреА рдЖрдзрд╛рд░рд┐рдд рд╣реИред  рдлрд┐рд▓рд╣рд╛рд▓, рдмреАрдИрдЖрд░рдЯреА рд▓рдЧрднрдЧ рд╕рднреА рд▓реЛрдХрдкреНрд░рд┐рдп рдПрдирдПрд▓рдкреА рдмреЗрдВрдЪрдорд╛рд░реНрдХ рдкрд░ рдЕрддреНрдпрд╛рдзреБрдирд┐рдХ рд╣реИред </p><br><h2 id="kak-oni-eto-sdelali">  рдЙрдиреНрд╣реЛрдВрдиреЗ рдпрд╣ рдХреИрд╕реЗ рдХрд┐рдпрд╛ </h2><br><p>  BERT рдХреЗ рдкреАрдЫреЗ рдХрд╛ рд╡рд┐рдЪрд╛рд░ рдмрд╣реБрдд рд╕рд░рд▓ рд╣реИ: рдЪрд▓реЛ рд╡рд╛рдХреНрдпрд╛рдВрд╢реЛрдВ рдХреЗ рд╕рд╛рде рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдлрд╝реАрдб рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рд╣рдо 15% рд╢рдмреНрджреЛрдВ рдХреЛ [MASK] рд╕реЗ рдмрджрд▓ рджреЗрддреЗ рд╣реИрдВ рдФрд░ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдЗрди рдореБрдЦреМрдЯреЗ рд╡рд╛рд▓реЗ рд╢рдмреНрджреЛрдВ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВред </p><br><p>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рд╣рдо рд╡рд╛рдХреНрдпрд╛рдВрд╢ "рдореИрдВ рдЖрдпрд╛ [MASK] рдФрд░ рдЦрд░реАрджрд╛ [MASK]" рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЗрдирдкреБрдЯ рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ "рд╕реНрдЯреЛрд░" рдФрд░ "рджреВрдз" рд╢рдмреНрдж рджрд┐рдЦрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдпрд╣ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдмреАрдИрдЖрд░рдЯреА рдкреГрд╖реНрда рд╕реЗ рдПрдХ рд╕рд░рд▓ рдЙрджрд╛рд╣рд░рдг рд╣реИ, рд▓рдВрдмреЗ рд╡рд╛рдХреНрдпреЛрдВ рдкрд░, рд╕рдВрднрд╛рд╡рд┐рдд рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреА рд╕реАрдорд╛ рдЫреЛрдЯреА рд╣реЛ рдЬрд╛рддреА рд╣реИ, рдФрд░ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЕрд╕реНрдкрд╖реНрдЯ рд╣реИред </p><br><p>  рдФрд░ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рд╡рд╛рдХреНрдпреЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрдмрдВрдзреЛрдВ рдХреЛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реАрдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдпрд╣ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░реЗрдВрдЧреЗ рдХрд┐ рдХреНрдпрд╛ рджреВрд╕рд░рд╛ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдкрд╣рд▓реЗ рдХреА рддрд╛рд░реНрдХрд┐рдХ рдирд┐рд░рдВрддрд░рддрд╛ рд╣реИред  рдпрд╛ рдпрд╣ рдХреБрдЫ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдкрд╣рд▓реЗ рд╕реЗ рдХреЛрдИ рд▓реЗрдирд╛-рджреЗрдирд╛ рдирд╣реАрдВ рд╣реИред </p><br><p>  рддреЛ, рджреЛ рд╡рд╛рдХреНрдпреЛрдВ рдХреЗ рд▓рд┐рдП: "рдореИрдВ рд╕реНрдЯреЛрд░ рдореЗрдВ рдЧрдпрд╛ред"  рдФрд░ "рдФрд░ рд╡рд╣рд╛рдВ рджреВрдз рдЦрд░реАрджрд╛ред", рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдЬрд╡рд╛рдм рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдпрд╣ рддрд╛рд░реНрдХрд┐рдХ рд╣реИред  рдФрд░ рдЕрдЧрд░ рджреВрд╕рд░рд╛ рд╡рд╛рдХреНрдпрд╛рдВрд╢ "рдХреНрд░реВрд╕рд┐рдпрди рдЖрдХрд╛рд╢ рдкреНрд▓реВрдЯреЛ" рд╣реИ, рддреЛ рдореБрдЭреЗ рдЬрд╡рд╛рдм рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдЗрд╕ рдкреНрд░рд╕реНрддрд╛рд╡ рдХрд╛ рдкрд╣рд▓реЗ рд╕реЗ рдХреЛрдИ рд▓реЗрдирд╛-рджреЗрдирд╛ рдирд╣реАрдВ рд╣реИред  рд╣рдо рдиреАрдЪреЗ рдЗрди рджреЛрдиреЛрдВ BERT рдореЛрдб рдХреЗ рд╕рд╛рде рдЦреЗрд▓реЗрдВрдЧреЗред </p><br><p>  рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╡рд┐рдХрд┐рдкреАрдбрд┐рдпрд╛ рд╕реЗ рдЧреНрд░рдВрдереЛрдВ рдХреЗ рд╢рд░реАрд░ рдкрд░ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдФрд░ рдкреБрд╕реНрддрдХ рд╕рдВрдЧреНрд░рд╣ рдмреБрдХрдХреЙрд░реНрдкрд╕ рдХреЛ 4 рджрд┐рдиреЛрдВ рдХреЗ рд▓рд┐рдП 16 рдЯреАрдкреАрдпреВ рдореЗрдВ рд░рдЦрдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдореЗрдВ рдмреАрдИрдЖрд░рдЯреА рдорд┐рд▓рд╛ред </p><br><h2 id="ustanovka-i-nastroyka">  рд╕реНрдерд╛рдкрдирд╛ рдФрд░ рд╕реЗрдЯрдЕрдк </h2><br><p>  <em><strong>рдиреЛрдЯ</strong> : рдЗрд╕ рдЦрдВрдб рдореЗрдВ рд╣рдо рд╕реНрдерд╛рдиреАрдп рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░ BERT рдХреЗ рд╕рд╛рде рд▓реЙрдиреНрдЪ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЦреЗрд▓реЗрдВрдЧреЗред</em>  <em>рдПрдХ рд╕реНрдерд╛рдиреАрдп GPU рдкрд░ рдЗрд╕ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ 4 GB рд╡реАрдбрд┐рдпреЛ рдореЗрдореЛрд░реА рдпрд╛ рдЙрдЪреНрдЪрддрд░ рдХреЗ рд╕рд╛рде NVidia GTX 970 рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред</em>  <em>рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ BERT рдЪрд▓рд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ (рдЗрд╕рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЕрдкрдиреЗ рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░ рднреА GPU рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ), рддреЛ Google Colab рд╕реЗрдХреНрд╢рди рдореЗрдВ рдЬрд╛рдПрдБред</em> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Https://www.tensorflow.org/install</a> рдХреЗ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реБрдП, рдкрд╣рд▓реЗ TensorFlow рд╕реНрдерд╛рдкрд┐рдд <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХрд░реЗрдВ</a> ред  GPU рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкрд╣рд▓реЗ CUDA рдЯреВрд▓рдХрд┐рдЯ 9.0, рдлрд┐рд░ cuDNN SDK 7.2, рдФрд░ рдХреЗрд╡рд▓ рддрдм GPU рд╕рдорд░реНрдерди рдХреЗ рд╕рд╛рде TensorFlow рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛: </p><br><pre><code class="dos hljs">pip install tensorflow-gpu</code> </pre> <br><p>  рдореВрд▓ рд░реВрдк рд╕реЗ, рдпрд╣ BERT рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред  рд▓реЗрдХрд┐рди рдЗрд╕ рддрд░рд╣ рдХреЛрдИ рдирд┐рд░реНрджреЗрд╢ рдирд╣реАрдВ рд╣реИ, рдЖрдк рдЗрд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд░рди_рдХреНрд▓рд╛рд╕реАрдлреЛрд░реЛрдлрд╝реЙрд░реНрдо</a> рдлрд╝рд╛рдЗрд▓ (рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдп рд╕реНрдерд┐рддрд┐ рддрдм рд╣реЛрддреА рд╣реИ рдЬрдм рдЖрдкрдХреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реЛрдВ рдХреЗ рдмрдЬрд╛рдп рд╕реНрд░реЛрддреЛрдВ рдореЗрдВ рдЬрд╛рдирд╛ рд╣реЛрддрд╛ рд╣реИ) рдХреЗ рд╕реНрд░реЛрддреЛрдВ рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЫрд╛рдБрдЯрдХрд░</a> рдЗрд╕реЗ рд╕реНрд╡рдпрдВ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди рд╣рдо рдЗрд╕реЗ рдЖрд╕рд╛рди рдХрд░реЗрдВрдЧреЗ рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреЗрд░рд╕ рдмреАрдИрдЖрд░рдЯреА</a> рд╢реЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ (рдпрд╣ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдмрд╛рдж рдореЗрдВ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдХреЗрд░рд╕ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ)ред </p><br><p>  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдХреЗрд░реЗрд╕ рдХреЛ рд╕реНрд╡рдпрдВ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ: </p><br><pre> <code class="dos hljs">pip install keras</code> </pre> <br><p>  рдФрд░ рдХреЗрд░рд╕ BERT рдХреЗ рдмрд╛рдж: </p><br><pre> <code class="dos hljs">pip install keras-bert</code> </pre> <br><p>  рд╣рдореЗрдВ рдореВрд▓ github BERT рд╕реЗ рднреА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">tokenization.py</a> рдлрд╝рд╛рдЗрд▓ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред  рдпрд╛ рддреЛ рд░реЙ рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ рдЗрд╕реЗ рднрд╡рд┐рд╖реНрдп рдХреА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВ, рдпрд╛ рд╕рдВрдкреВрд░реНрдг рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╡рд╣рд╛рдВ рд╕реЗ рд▓реЗ рдЬрд╛рдПрдВ, рдпрд╛ рдЗрд╕ рдХреЛрдб <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://github.com/blade1780/bert рдХреЗ</a> рд╕рд╛рде рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд╕реЗ рдПрдХ рдХреЙрдкреА рд▓реЗрдВред </p><br><p>  рдЕрдм рдкреВрд░реНрд╡ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рдЖ рдЧрдпрд╛ рд╣реИред  BERT рдХреЗ рд▓рд┐рдП рдХрдИ рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ, рдЬреЛ рд╕рднреА рдЖрдзрд┐рдХрд╛рд░рд┐рдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">github.com/google-research/bert</a> рдкреГрд╖реНрда рдкрд░ рд╕реВрдЪреАрдмрджреНрдз рд╣реИрдВред  рд╣рдо 104 рднрд╛рд╖рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рдмрд╣реБрднрд╛рд╖реА "рдмреАрдИрдЖрд░рдЯреА-рдмреЗрд╕, рдмрд╣реБрднрд╛рд╖реА рдХреИрд╕рдб" рд▓реЗрдВрдЧреЗред  <a href="">рдмрд╣реБ_cased_L-12_H-768_A-12.zip</a> рдлрд╝рд╛рдЗрд▓ (632 рдПрдордмреА) рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдЗрд╕реЗ рднрд╡рд┐рд╖реНрдп рдХреА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдирдЬрд╝рд┐рдк рдХрд░реЗрдВред </p><br><p>  рд╕рдм рдХреБрдЫ рддреИрдпрд╛рд░ рд╣реИ, BERT.py рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдВ, рдлрд┐рд░ рдереЛрдбрд╝рд╛ рдХреЛрдб рд╣реЛрдЧрд╛ред </p><br><p>  рдЖрд╡рд╢реНрдпрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдФрд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд░рд╛рд╕реНрддреЛрдВ рдХреЛ рдЖрдпрд╛рдд рдХрд░реЗрдВ </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># coding: utf-8 import sys import codecs import numpy as np from keras_bert import load_trained_model_from_checkpoint import tokenization # ,     BERT folder = 'multi_cased_L-12_H-768_A-12' config_path = folder+'/bert_config.json' checkpoint_path = folder+'/bert_model.ckpt' vocab_path = folder+'/vocab.txt'</span></span></code> </pre> <br><p>  рдЪреВрдБрдХрд┐ рд╣рдореЗрдВ рдЯреЗрдХреНрд╕реНрдЯ рдХреА рд╕рд╛рдзрд╛рд░рдг рд▓рд╛рдЗрдиреЛрдВ рдХреЛ рдЯреЛрдХрди рдХреЗ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢реЗрд╖ рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдПрдВрдЧреЗред  Do_lower_case = False рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдХреИрд╕рд░реНрдб BERT рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЬреЛ рдХрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИред </p><br><pre> <code class="python hljs">tokenizer = tokenization.FullTokenizer(vocab_file=vocab_path, do_lower_case=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>)</code> </pre> <br><p>  рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ рдореЙрдбрд▓ </p><br><pre> <code class="python hljs">model = load_trained_model_from_checkpoint(config_path, checkpoint_path, training=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) model.summary()</code> </pre> <br><p>  BERT рджреЛ рдореЛрдб рдореЗрдВ рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИ: рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдореЗрдВ рдЫреВрдЯреЗ рд╣реБрдП рд╢рдмреНрджреЛрдВ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдирд╛, рдпрд╛ рдпрд╣ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдирд╛ рдХрд┐ рдХреНрдпрд╛ рджреВрд╕рд░рд╛ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдкрд╣рд▓реЗ рдХреЗ рдмрд╛рдж рддрд╛рд░реНрдХрд┐рдХ рд╣реИред  рд╣рдо рджреЛрдиреЛрдВ рд╡рд┐рдХрд▓реНрдк рдХрд░реЗрдВрдЧреЗред </p><br><p>  рдкрд╣рд▓реЗ рдореЛрдб рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдПрдХ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдЬрдорд╛ рдХрд░рдирд╛ рд╣реЛрдЧрд╛: </p><br><pre> <code class="dos hljs">[<span class="hljs-built_in"><span class="hljs-built_in">CLS</span></span>]    [MASK]   [MASK]. [SEP]</code> </pre> <br><p>  рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдорд╛рд╕реНрдХ рдХреЗ рд╕реНрдерд╛рди рдкрд░ рднрд░реЗ рд╣реБрдП рд╢рдмреНрджреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдкреВрд░рд╛ рд╡рд╛рдХреНрдп рд╡рд╛рдкрд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП: "рдореИрдВ рджреБрдХрд╛рди рдореЗрдВ рдЖрдпрд╛ рдФрд░ рджреВрдз рдЦрд░реАрджрд╛ред" </p><br><p>  рджреВрд╕рд░реЗ рдореЛрдб рдХреЗ рд▓рд┐рдП, рдПрдХ рд╡рд┐рднрд╛рдЬрдХ рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ рдХрд┐рдП рдЧрдП рджреЛрдиреЛрдВ рд╡рд╛рдХреНрдпрд╛рдВрд╢реЛрдВ рдХреЛ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЗрдирдкреБрдЯ рдХреЛ рдЦрд┐рд▓рд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП: </p><br><pre> <code class="dos hljs">[<span class="hljs-built_in"><span class="hljs-built_in">CLS</span></span>]    . [SEP]   . [SEP]</code> </pre> <br><p>  рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдЬрд╡рд╛рдм рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдХреНрдпрд╛ рджреВрд╕рд░рд╛ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдкрд╣рд▓реЗ рдХреА рддрд╛рд░реНрдХрд┐рдХ рдирд┐рд░рдВрддрд░рддрд╛ рд╣реИред  рдпрд╛ рдпрд╣ рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдкрд╣рд▓реЗ рд╕реЗ рдХреЛрдИ рд▓реЗрдирд╛-рджреЗрдирд╛ рдирд╣реАрдВ рд╣реИред </p><br><p>  рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП BERT рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рддреАрди рд╡реИрдХреНрдЯрд░ рддреИрдпрд╛рд░ рдХрд░рдиреЗ рд╣реЛрдВрдЧреЗ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреА рд▓рдВрдмрд╛рдИ 512 рдирдВрдмрд░ рд╣реЛрдЧреА: token_input, seg_input рдФрд░ mask_inputред </p><br><p>  <strong>рдЯреЛрдХрди_рдЗрдирдкреБрдЯ</strong> рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдорд╛рд░реЗ рд╕реНрд░реЛрдд рдХреЛрдб рдХреЛ рдЯреЛрдХрди рдореЗрдВ рдЕрдиреБрд╡рд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рдЕрдиреБрдХреНрд░рдорд┐рдд рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдЗрд╕ рд╡реЗрдХреНрдЯрд░ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╣реЛрдЧрд╛, рдФрд░ рдмрд╛рдХреА рд╢реВрдиреНрдп рд╕реЗ рднрд░ рдЬрд╛рдПрдЧрд╛ред </p><br><p>  <strong>Mask_input рдореЗрдВ,</strong> рд╣рдореЗрдВ рдЙрди рд╕рднреА рдкрджреЛрдВ рдХреЗ рд▓рд┐рдП 1 рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд╣рд╛рдВ [MASK] рдореБрдЦреМрдЯрд╛ рд╣реИ, рдФрд░ рдмрд╛рдХреА рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рднрд░реЗрдВред </p><br><p>  <strong>Seg_input рдореЗрдВ,</strong> рд╣рдореЗрдВ рдкрд╣рд▓рд╛ рд╡рд╛рдХреНрдпрд╛рдВрд╢ (рдЖрд░рдВрднрд┐рдХ рд╕реАрдПрд▓рдПрд╕ рдФрд░ рдПрд╕рдИрдкреА рд╡рд┐рднрд╛рдЬрдХ рд╕рд╣рд┐рдд) рдХреЛ 0 рдХреЗ рд░реВрдк рдореЗрдВ <strong>рдирд┐рд░реВрдкрд┐рдд</strong> рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рджреВрд╕рд░рд╛ рд╡рд╛рдХреНрдпрд╛рдВрд╢ (рдЕрдВрддрд┐рдо рдПрд╕рдИрдкреА рд╕рд╣рд┐рдд) 1 рдХреЗ рд░реВрдк рдореЗрдВ рд╣реИ, рдФрд░ рд╢реЗрд╖ рдХреЛ рдЬреАрд░реЛ рдХреЗ рд╕рд╛рде рд╡реЗрдХреНрдЯрд░ рдХреЗ рдЕрдВрдд рдореЗрдВ рднрд░реЗрдВред </p><br><p>  BERT рдкреВрд░реЗ рд╢рдмреНрджреЛрдВ рдХреЗ рд╢рдмреНрджрдХреЛрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдмрд▓реНрдХрд┐ рд╕рдмрд╕реЗ рдЖрдо рд╢рдмреНрджрд╛рдВрд╢реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЗрд╕рдореЗрдВ рдкреВрд░реЗ рд╢рдмреНрдж рднреА рд╣реИрдВред  рдЖрдк рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдП рдЧрдП рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ vocab.txt рдлрд╛рдЗрд▓ рдХреЛ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХ рдЕрдкрдиреЗ рдЗрдирдкреБрдЯ рдореЗрдВ рдХрд┐рди рд╢рдмреНрджреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдлреНрд░рд╛рдВрд╕ рдЬреИрд╕реЗ рдкреВрд░реЗ рд╢рдмреНрдж рд╣реИрдВред  рд▓реЗрдХрд┐рди рдЕрдзрд┐рдХрд╛рдВрд╢ рд░реВрд╕реА рд╢рдмреНрджреЛрдВ рдХреЛ рд╢рдмреНрджрд╛рдВрд╢реЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рддреЛ, "рдЖрдпрд╛" рд╢рдмреНрдж рдХреЛ "рд╕рд╛рде" рдФрд░ "## рдЧрдпрд╛" рдореЗрдВ рддреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  BERT рджреНрд╡рд╛рд░рд╛ рдЖрд╡рд╢реНрдпрдХ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкрд╛рда рдХреА рдирд┐рдпрдорд┐рдд рд▓рд╛рдЗрдиреЛрдВ рдХреЛ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо tokenization.py рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред </p><br><h2 id="rezhim-1-predskazanie-slov-zakrytyh-tokenom-mask-v-fraze">  рдореЛрдб 1: рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдореЗрдВ рд╢рдмреНрдж [MASK] рджреНрд╡рд╛рд░рд╛ рдмрдВрдж рд╢рдмреНрджреЛрдВ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА </h2><br><p>  рдЗрдирдкреБрдЯ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдЬреЛ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЗрдирдкреБрдЯ рдХреЛ рдЦрд┐рд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </p><br><pre> <code class="python hljs">sentence = <span class="hljs-string"><span class="hljs-string">'   [MASK]   [MASK].'</span></span> print(sentence)</code> </pre> <br><p>  рдЗрд╕реЗ рдЯреЛрдХрди рдореЗрдВ рдмрджрд▓реЗрдВред  рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЯреЛрдХрди рд╕реЗрд╡рд╛ рдХреЗ рдирд┐рд╢рд╛рди [CLS] рдФрд░ [MASK] рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╢рдмреНрджрдХреЛрд╖ рдореЗрдВ рд╡реЛ рд╢рдмреНрдж рд╣реИред  рдЗрд╕рд▓рд┐рдП, рд╣рдореЗрдВ рдЕрдкрдиреЗ рд▓рд╛рдЗрди рдХреЛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ [MASK] рдорд╛рд░реНрдХрд░реЛрдВ рд╕реЗ рддреЛрдбрд╝рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЯреЛрдХрди рд╕реЗ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ BERT рдЯреЛрдХрди рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╛рджреЗ рдкрд╛рда рдХреЗ рдЯреБрдХрдбрд╝реЗ рдирд┐рдХрд╛рд▓рдиреЗ рд╣реЛрдВрдЧреЗред  рд╢реБрд░реБрдЖрдд рдореЗрдВ [CLS] рдФрд░ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдХреЗ рдЕрдВрдд рдореЗрдВ [SEP] рднреА рдЬреЛрдбрд╝реЗрдВред </p><br><pre> <code class="python hljs">sentence = sentence.replace(<span class="hljs-string"><span class="hljs-string">' [MASK] '</span></span>,<span class="hljs-string"><span class="hljs-string">'[MASK]'</span></span>); sentence = sentence.replace(<span class="hljs-string"><span class="hljs-string">'[MASK] '</span></span>,<span class="hljs-string"><span class="hljs-string">'[MASK]'</span></span>); sentence = sentence.replace(<span class="hljs-string"><span class="hljs-string">' [MASK]'</span></span>,<span class="hljs-string"><span class="hljs-string">'[MASK]'</span></span>) <span class="hljs-comment"><span class="hljs-comment">#    sentence = sentence.split('[MASK]') #     tokens = ['[CLS]'] #      [CLS] #        tokenizer.tokenize(),    [MASK] for i in range(len(sentence)): if i == 0: tokens = tokens + tokenizer.tokenize(sentence[i]) else: tokens = tokens + ['[MASK]'] + tokenizer.tokenize(sentence[i]) tokens = tokens + ['[SEP]'] #      [SEP]</span></span></code> </pre> <br><p>  рдЯреЛрдХрди рдореЗрдВ рдЕрдм рдЯреЛрдХрди рд╣реИрдВ рдЬреЛ рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рдЕрдиреБрдХреНрд░рдорд┐рдд рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╣реЛрдиреЗ рдХреА рдЧрд╛рд░рдВрдЯреА рд╣реИред  рдЪрд▓реЛ рдЗрд╕реЗ рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre> <code class="python hljs">token_input = tokenizer.convert_tokens_to_ids(tokens)</code> </pre> <br><p>  рдЕрдм рдЯреЛрдХрди_рдЗрдирдкреБрдЯ рдореЗрдВ рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рд╣реЛрддреА рд╣реИ (рд╢рдмреНрдж рд╕рдВрдЦреНрдпрд╛ред рд╢рдмреНрджрдХреЛрд╖ рдореЗрдВ) рдЬреЛ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЗрдирдкреБрдЯ рдХреЛ рдЦрд┐рд▓рд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдпрд╣ рдХреЗрд╡рд▓ 512 рддрддреНрд╡реЛрдВ рдХреА рд▓рдВрдмрд╛рдИ рддрдХ рдЗрд╕ рд╡реЗрдХреНрдЯрд░ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдиреА рд╣реБрдИ рд╣реИред  рдЕрдЬрдЧрд░ рдХрд╛ рдирд┐рд░реНрдорд╛рдг [0] * рд▓рдВрдмрд╛рдИ рд▓рдВрдмрд╛рдИ рдХреА рдПрдХ рд▓рдВрдмрд╛рдИ рдмрдирд╛рддрд╛ рд╣реИ, рд╢реВрдиреНрдп рд╕реЗ рднрд░ рдЬрд╛рддрд╛ рд╣реИред  рдмрд╕ рдЗрд╕реЗ рд╣рдорд╛рд░реЗ рдЯреЛрдХрди рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ, рдЬреЛ рдЕрдЬрдЧрд░ рдореЗрдВ рджреЛ рд╕рд░рдгрд┐рдпреЛрдВ рдХреЛ рдПрдХ рдореЗрдВ рдЬреЛрдбрд╝рддрд╛ рд╣реИред </p><br><pre> <code class="python hljs">token_input = token_input + [<span class="hljs-number"><span class="hljs-number">0</span></span>] * (<span class="hljs-number"><span class="hljs-number">512</span></span> - len(token_input))</code> </pre> <br><p>  рдЕрдм рд╣рд░ рдЬрдЧрд╣ 1 рд▓рдВрдмрд╛рдИ рдореЗрдВ рдПрдХ рдореБрдЦреМрдЯрд╛ рдореБрдЦреМрдЯрд╛ 512 рдмрдирд╛рдПрдВ, рдЬрд╣рд╛рдВ 103 рдирдВрдмрд░ рдЯреЛрдХрди рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ (рдЬреЛ рдХрд┐ рд╢рдмреНрджрдХреЛрд╖ рдореЗрдВ рдорд╛рд░реНрдХрд░ [MASK] рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ), рдФрд░ рдмрд╛рдХреА рдХреЛ 0 рд╕реЗ рднрд░рдирд╛: </p><br><pre> <code class="python hljs">mask_input = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">512</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(mask_input)): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> token_input[i] == <span class="hljs-number"><span class="hljs-number">103</span></span>: mask_input[i] = <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><p>  рдСрдкрд░реЗрд╢рди рдХреЗ рдкрд╣рд▓реЗ BERT рдореЛрдб рдХреЗ рд▓рд┐рдП, seg_input рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╢реВрдиреНрдп рд╕реЗ рднрд░рд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП: </p><br><pre> <code class="python hljs">seg_input = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">512</span></span></code> </pre> <br><p>  рдЕрдВрддрд┐рдо рдЪрд░рдг, рдЖрдкрдХреЛ рдЕрдЬрдЧрд░ рд╕рд░рдгрд┐рдпреЛрдВ рдХреЛ рдЖрдХрд╛рд░ (1,512) рдХреЗ рд╕рд╛рде рдЕрдлреАрдо рд╕рд░рдгрд┐рдпреЛрдВ рдореЗрдВ рдмрджрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рд╣рдо рдЙрдиреНрд╣реЗрдВ рдПрдХ рдЙрдк-рд╢реНрд░реЗрдгреА рдореЗрдВ рдбрд╛рд▓рддреЗ рд╣реИрдВ: </p><br><pre> <code class="python hljs">token_input = np.asarray([token_input]) mask_input = np.asarray([mask_input]) seg_input = np.asarray([seg_input])</code> </pre> <br><p>  рдареАрдХ рд╣реИ, рдХрд┐рдпрд╛ред  рдЕрдм рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдЪрд▓рд╛рдПрдВ! </p><br><pre> <code class="python hljs">predicts = model.predict([token_input, seg_input, mask_input])[<span class="hljs-number"><span class="hljs-number">0</span></span>] predicts = np.argmax(predicts, axis=<span class="hljs-number"><span class="hljs-number">-1</span></span>) predicts = predicts[<span class="hljs-number"><span class="hljs-number">0</span></span>][:len(tokens)] <span class="hljs-comment"><span class="hljs-comment">#   ,    ,       </span></span></code> </pre> <br><p>  рдЕрдм рдкрд░рд┐рдгрд╛рдо рдХреЛ рдЯреЛрдХрди рд╕реЗ рд░рд┐рдХреНрдд рд╕реНрдерд╛рди рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ рдХрд┐рдП рдЧрдП рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ рд╕реНрд╡рд░реВрдкрд┐рдд рдХрд░реЗрдВ </p><br><pre> <code class="python hljs">out = [] <span class="hljs-comment"><span class="hljs-comment">#   out     [MASK],    1  mask_input for i in range(len(mask_input[0])): if mask_input[0][i] == 1: # [0][i], ..   batch   (1,512),       out.append(predicts[i]) out = tokenizer.convert_ids_to_tokens(out) #     out = ' '.join(out) #       out = tokenization.printable_text(out) #    out = out.replace(' ##','') #   : " ##" -&gt; ""</span></span></code> </pre> <br><p>  рдФрд░ рдкрд░рд┐рдгрд╛рдо рдХрд╛ рдЙрддреНрдкрд╛рджрди рдХрд░реЗрдВ: </p><br><pre> <code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">'Result:'</span></span>, out)</code> </pre> <br><p>  рд╣рдорд╛рд░реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдХреЗ рд▓рд┐рдП "рдореИрдВ [MASK] рдЖрдпрд╛ рдФрд░ [MASK] рдХреЛ рдЦрд░реАрджрд╛ред"  рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдиреЗ "рдШрд░" рдФрд░ "рдпрд╣" рдкрд░рд┐рдгрд╛рдо рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛: "рдореИрдВ рдШрд░ рдЖрдпрд╛ рдФрд░ рдЗрд╕реЗ рдЦрд░реАрджрд╛ред"  рд╡реИрд╕реЗ, рдкрд╣рд▓реА рдмрд╛рд░ рдЗрддрдирд╛ рдмреБрд░рд╛ рдирд╣реАрдВ рд╣реИред  рдШрд░ рдЦрд░реАрджрдирд╛ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рджреВрдз рд╕реЗ рдмреЗрд╣рддрд░ рд╣реИ)ред </p><br><div class="spoiler">  <b class="spoiler_title">рдЕрдиреНрдп рдЙрджрд╛рд╣рд░рдг (рдореИрдВ рдЕрд╕рдлрд▓ рд▓реЛрдЧреЛрдВ рдХреЛ рдирд╣реАрдВ рджреЗрддрд╛, рд╕рдлрд▓ рд▓реЛрдЧреЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдмрд╣реБрдд рдЕрдзрд┐рдХ рд╣реИрдВред рдЬреНрдпрд╛рджрд╛рддрд░ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдиреЗрдЯрд╡рд░реНрдХ рдПрдХ рдЦрд╛рд▓реА рдЙрддреНрддрд░ рджреЗрддрд╛ рд╣реИ:</b> <div class="spoiler_text"><p>  рдкреГрдереНрд╡реА рд╕реВрд░реНрдп рд╕реЗ рддреАрд╕рд░реА [MASK] рд╣реИ <br>  рдкрд░рд┐рдгрд╛рдо: рд╕реНрдЯрд╛рд░ </p><br><p>  рдордХреНрдЦрди рдХреЗ рд╕рд╛рде рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╕реИрдВрдбрд╡рд┐рдЪ [рдорд╛рд╕] <br>  рдкрд░рд┐рдгрд╛рдо: рдореАрдЯ </p><br><p>  [MASK] рджреЛрдкрд╣рд░ рдХреЗ рднреЛрдЬрди рдХреЗ рдмрд╛рдж рд╕реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ <br>  рдкрд░рд┐рдгрд╛рдо: рдЗрд╕рдореЗрдВ рд╕реЗ </p><br><p>  [MASK] рд╕реЗ рджреВрд░ рд╣реЛ рдЬрд╛рдУ <br>  рдкрд░рд┐рдгрд╛рдо: ## рдУрд╣ - рдпрд╣ рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЕрднрд┐рд╢рд╛рдк рд╣реИ?  ) </p><br><p>  [MASK] рджрд░рд╡рд╛рдЬреЗ рд╕реЗ <br>  рдкрд░рд┐рдгрд╛рдо: рджреЗрдЦреЗрдВ </p><br><p>  [MASK] рдХреЗ рд╕рд╛рде рд╣рдереМрдбрд╝рд╛ рдФрд░ рдирд╛рдЦреВрди рдХреИрдмрд┐рдиреЗрдЯ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ <br>  рдкрд░рд┐рдгрд╛рдо: рдорджрдж </p><br><p>  рдФрд░ рдЕрдЧрд░ рдХрд▓ рдирд╣реАрдВ рд╣реИ?  рдЖрдЬ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣ [MASK] рдирд╣реАрдВ рд╣реИ! <br>  рдкрд░рд┐рдгрд╛рдо: рд╣реЛрдЧрд╛ </p><br><p>  [MASK] рдХреА рдЕрдирджреЗрдЦреА рдХрд░рдХреЗ рдЖрдк рдХреИрд╕реЗ рдердХ рд╕рдХрддреЗ рд╣реИрдВ? <br>  рдкрд░рд┐рдгрд╛рдо: рдЙрд╕реЗ </p><br><p>  рд╣рд░ рд░реЛрдЬрд╝ рддрд░реНрдХ рд╣реИ, рдорд╣рд┐рд▓рд╛ рддрд░реНрдХ рд╣реИ, рд▓реЗрдХрд┐рди рдкреБрд░реБрд╖ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рднреА рдирд╣реАрдВ рдкрддрд╛ рд╣реИ [MASK] <br>  рдкрд░рд┐рдгрд╛рдо: рджрд░реНрд╢рди </p><br><p>  рдорд╣рд┐рд▓рд╛рдУрдВ рдореЗрдВ, рддреАрд╕ рд╡рд░реНрд╖ рдХреА рдЖрдпреБ рддрдХ, рд░рд╛рдЬрдХреБрдорд╛рд░ рдХреА рдПрдХ рдЫрд╡рд┐ рдмрдирддреА рд╣реИ, рдЬреЛ рдХрд┐рд╕реА рднреА [MASK] рдкрд░ рдлрд┐рдЯ рдмреИрдарддреА рд╣реИред <br>  рдкрд░рд┐рдгрд╛рдо: рдЖрджрдореА </p><br><p>  рдмрд╣реБрдордд рдХреЗ рдордд рд╕реЗ, рд╕реНрдиреЛ рд╡реНрд╣рд╛рдЗрдЯ рдФрд░ рд╕рд╛рдд рдбреНрд╡рд╛рд░реНрдл рдиреЗ рдПрдХ рд╡реЛрдЯ рдХреЗ рд╕рд╛рде [MASK] рдХреЗ рд▓рд┐рдП рдорддрджрд╛рди рдХрд┐рдпрд╛ред <br>  рдкрд░рд┐рдгрд╛рдо: рдЧрд╛рдБрд╡ - рдкрд╣рд▓рд╛ рдЕрдХреНрд╖рд░ рд╕рд╣реА рд╣реИ </p><br><p>  рдЕрдкрдиреЗ рдердХрд╛рдКрдкрди рдХреЛ 10-рдмрд┐рдВрджреБ рдкреИрдорд╛рдиреЗ рдкрд░ рдЖрдВрдХреЗрдВ: [MASK] рдЕрдВрдХ <br>  рдкрд░рд┐рдгрд╛рдо: 10 </p><br><p>  рдЖрдкрдХрд╛ [MASK], [MASK] рдФрд░ [MASK]! <br>  рдкрд░рд┐рдгрд╛рдо: рдореБрдЭреЗ рдкреНрдпрд╛рд░ рдХрд░реЛ - рдирд╣реАрдВ, BERT, рдореБрдЭреЗ рдЗрд╕рдХрд╛ рдорддрд▓рдм рдмрд┐рд▓реНрдХреБрд▓ рдирд╣реАрдВ рдерд╛ </p></div></div><br><p>  рдЖрдк рдЕрдВрдЧреНрд░реЗрдЬреА рд╡рд╛рдХреНрдпрд╛рдВрд╢ (рдФрд░ 104 рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рдХреЛрдИ рднреА, рдЬрд┐рдирдореЗрдВ <a href="">рд╕реЗ</a> рдПрдХ рд╕реВрдЪреА <a href="">рдпрд╣рд╛рдВ рд╣реИ</a> ) рджрд░реНрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </p><br><p>  [рдорд╛рд╕] рдкрд░ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП! <br>  рдкрд░рд┐рдгрд╛рдо: I </p><br><h2 id="rezhim-2-proverka-logichnosti-dvuh-fraz">  рдореЛрдб 2: рджреЛ рд╡рд╛рдХреНрдпрд╛рдВрд╢реЛрдВ рдХреА рд╕реНрдерд┐рд░рддрд╛ рдХреА рдЬрд╛рдБрдЪ рдХрд░рдирд╛ </h2><br><p>  рд╣рдо рджреЛ рд▓рдЧрд╛рддрд╛рд░ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЗрдирдкреБрдЯ рдХреЛ рдЦрд┐рд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ </p><br><pre> <code class="python hljs">sentence_1 = <span class="hljs-string"><span class="hljs-string">'   .'</span></span> sentence_2 = <span class="hljs-string"><span class="hljs-string">'  .'</span></span> print(sentence_1, <span class="hljs-string"><span class="hljs-string">'-&gt;'</span></span>, sentence_2)</code> </pre> <br><p>  рд╣рдо рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рд╛рджреЗ рдкрд╛рда рдХреЛ рдЯреЛрдХрди рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддреЗ рд╣реБрдП [CLS] рд╡рд╛рдХреНрдпрд╛рдВрд╢_1 [SEP] рд╡рд╛рдХреНрдпрд╛рдВрд╢_2 [SEP] рдореЗрдВ рдЯреЛрдХрди рдмрдирд╛рдПрдВрдЧреЗ: </p><br><pre> <code class="python hljs">tokens_sen_1 = tokenizer.tokenize(sentence_1) tokens_sen_2 = tokenizer.tokenize(sentence_2) tokens = [<span class="hljs-string"><span class="hljs-string">'[CLS]'</span></span>] + tokens_sen_1 + [<span class="hljs-string"><span class="hljs-string">'[SEP]'</span></span>] + tokens_sen_2 + [<span class="hljs-string"><span class="hljs-string">'[SEP]'</span></span>]</code> </pre> <br><p>  рд╣рдо рд╕реНрдЯреНрд░рд┐рдВрдЧ рдЯреЛрдХрди рдХреЛ рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рд╕реВрдЪрдХ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддреЗ рд╣реИрдВ (рд╢рдмреНрдж рд╕рдВрдЦреНрдпрд╛ред рд╢рдмреНрджрдХреЛрд╖ рдореЗрдВ) рдФрд░ рд╡реЗрдХреНрдЯрд░ рдХреЛ 512 рддрдХ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд░реЗрдВ: </p><br><pre> <code class="python hljs">token_input = tokenizer.convert_tokens_to_ids(tokens) token_input = token_input + [<span class="hljs-number"><span class="hljs-number">0</span></span>] * (<span class="hljs-number"><span class="hljs-number">512</span></span> - len(token_input))</code> </pre> <br><p>  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдореБрдЦреМрдЯрд╛ рд╢рдмреНрдж рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╢реВрдиреНрдп рд╕реЗ рднрд░рд╛ рд╣реИ </p><br><pre> <code class="python hljs">mask_input = [<span class="hljs-number"><span class="hljs-number">0</span></span>] * <span class="hljs-number"><span class="hljs-number">512</span></span></code> </pre> <br><p>  рд▓реЗрдХрд┐рди рдкреНрд░рд╕реНрддрд╛рд╡ рдореБрдЦреМрдЯрд╛ рдХреЛ рджреВрд╕рд░реЗ рд╡рд╛рдХреНрдпрд╛рдВрд╢ (рдЕрдВрддрд┐рдо рдПрд╕рдИрдкреА рд╕рд╣рд┐рдд) рдХреЗ рддрд╣рдд рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЗ рд╕рд╛рде рднрд░рд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рд╢реВрдиреНрдп рдХреЗ рд╕рд╛рде рдмрд╛рдХреА рд╕рдм рдХреБрдЫ: </p><br><pre> <code class="python hljs">seg_input = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">512</span></span> len_1 = len(tokens_sen_1) + <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-comment"><span class="hljs-comment">#   , +2 -   CLS   SEP for i in range(len(tokens_sen_2)+1): # +1, ..   SEP seg_input[len_1 + i] = 1 #   ,   SEP,  #   numpy   (1,) -&gt; (1,512) token_input = np.asarray([token_input]) mask_input = np.asarray([mask_input]) seg_input = np.asarray([seg_input])</span></span></code> </pre> <br><p>  рд╣рдо рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡рд╛рдХреНрдпрд╛рдВрд╢реЛрдВ рдХреЛ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ (рдЗрд╕ рд╕рдордп рдкрд░рд┐рдгрд╛рдо [1] рдореЗрдВ рд╣реИ, рдФрд░ [0] рдореЗрдВ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдКрдкрд░ рдерд╛) </p><br><pre> <code class="python hljs">predicts = model.predict([token_input, seg_input, mask_input])[<span class="hljs-number"><span class="hljs-number">1</span></span>]</code> </pre> <br><p>  рдФрд░ рд╣рдо рдЗрд╕ рд╕рдВрднрд╛рд╡рдирд╛ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рджреВрд╕рд░рд╛ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╣реИ, рдФрд░ рд╢рдмреНрджреЛрдВ рдХрд╛ рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╕реЗрдЯ рдирд╣реАрдВ рд╣реИ </p><br><pre> <code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">'Sentence is okey:'</span></span>, int(round(predicts[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">100</span></span>)), <span class="hljs-string"><span class="hljs-string">'%'</span></span>)</code> </pre> <br><p>  рджреЛ рд╡рд╛рдХреНрдпрд╛рдВрд╢реЛрдВ рдореЗрдВ: </p><br><p>  рдореИрдВ рд╕реНрдЯреЛрд░ рдореЗрдВ рдЖрдпрд╛ред  -&gt; рдФрд░ рджреВрдз рдЦрд░реАрджрд╛ред </p><br><p>  рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛: </p><br><p>  рд╡рд╛рдХреНрдп рдареАрдХ рд╣реИ: 99% </p><br><p>  рдФрд░ рдЕрдЧрд░ рджреВрд╕рд░рд╛ рд╡рд╛рдХреНрдпрд╛рдВрд╢ "рдХреНрд░реВрд╕рд┐рдпрди рдЖрдХрд╛рд╢ рдкреНрд▓реВрдЯреЛ" рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдЙрддреНрддрд░ рд╣реЛрдЧрд╛: </p><br><p>  рд╡рд╛рдХреНрдп рдареАрдХ рд╣реИ: 4% </p><br><h2 id="google-colab">  рдЧреВрдЧрд▓ рдХреЛрд▓рд╛рдм </h2><br><p>  Google 12 рдЬреАрдмреА рдХреА рд╡реАрдбрд┐рдпреЛ рдореЗрдореЛрд░реА рдХреЗ рд╕рд╛рде рдПрдХ рдореБрдлреНрдд рдЯреЗрд╕реНрд▓рд╛ K80 рд╕рд░реНрд╡рд░ GPU рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ (TPU рдЕрдм рдЙрдкрд▓рдмреНрдз рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЙрдирдХрд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИ)ред  рдХреЛрд▓рд╛рдм рдХреЗ рд▓рд┐рдП рд╕рднреА рдХреЛрдб рдЬреНрдпреВрдкрд┐рдЯрд░ рдиреЛрдЯрдмреБрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдП рдЬрд╛рдиреЗ рдЪрд╛рд╣рд┐рдПред  рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ BERT рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдмрд╕ рд▓рд┐рдВрдХ рдЦреЛрд▓реЗрдВ </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">http://colab.research.google.com/github/blade1780/bert/blob/master/BERT.ipynb</a> </p><br><p>  <strong>рд░рдирдЯрд╛рдЗрдо</strong> рдореЗрдиреВ рд╕реЗ, <strong>рд░рди рдСрд▓ рдХрд╛</strong> рдЪрдпрди рдХрд░реЗрдВ, рддрд╛рдХрд┐ рдкрд╣рд▓реА рдмрд╛рд░ рд╕рднреА рд╕реЗрд▓ рд╢реБрд░реВ рд╣реЛ рдЬрд╛рдПрдВ, рдореЙрдбрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рдЖрд╡рд╢реНрдпрдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЬреБрдбрд╝реЗ рд╣реБрдП рд╣реИрдВред  рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рддреЛ рд╕рднреА рд░рдирдЯрд╛рдЗрдо рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╣рдордд рд╣реЛрдВред </p><br><div class="spoiler">  <b class="spoiler_title">рдЕрдЧрд░ рдХреБрдЫ рдЧрд▓рдд рд╣реБрдЖ рд╣реИ ...</b> <div class="spoiler_text"><p>  рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ GPU рдФрд░ рдкрд╛рдпрдерди 3 рдХреЛ рд░рдирдЯрд╛рдЗрдо рдореЗрдВ рдЪреБрдирд╛ рдЧрдпрд╛ рд╣реИ -&gt; рд░рдирдЯрд╛рдЗрдо рдкреНрд░рдХрд╛рд░ рдореЗрдиреВ рдмрджрд▓реЗрдВ </p><br><p>  рдпрджрд┐ рдХрдиреЗрдХреНрдЯ рдмрдЯрди рд╕рдХреНрд░рд┐рдп рдирд╣реАрдВ рд╣реИ, рддреЛ рдХрдиреЗрдХреНрдЯреЗрдб рдмрдирдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред </p></div></div><br><p>  рдЕрдм рдЗрдирдкреБрдЯ рд▓рд╛рдЗрдиреЛрдВ <strong>рд╡рд╛рдХреНрдп</strong> , <strong>рд╡рд╛рдХреНрдп_1</strong> рдФрд░ <strong>pun_2 рдХреЛ</strong> рдмрджрд▓реЗрдВ, рдФрд░ рдХреЗрд╡рд▓ рд╡рд░реНрддрдорд╛рди рд╕реЗрд▓ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╛рдИрдВ рдУрд░ рдкреНрд▓реЗ рдЖрдЗрдХрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред  рд╕рдВрдкреВрд░реНрдг рдиреЛрдЯрдмреБрдХ рдЪрд▓рд╛рдирд╛ рдЕрдм рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИред </p><br><p>  рдЖрдк рд╕реНрдорд╛рд░реНрдЯрдлреЛрди рд╕реЗ рднреА Google Colab рдкрд░ BERT рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдпрд╣ рдирд╣реАрдВ рдЦреБрд▓рд╛, рддреЛ рдЖрдкрдХреЛ рдЕрдкрдиреА рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ рдкреВрд░реНрдг рд╕рдВрд╕реНрдХрд░рдг рдЪреЗрдХрдмреЙрдХреНрд╕ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рдкрдбрд╝ рд╕рдХрддрд╛ рд╣реИред </p><br><h2 id="chto-dalshe">  рдЖрдЧреЗ рдХреНрдпрд╛ рд╣реИ? </h2><br><p>  рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдмреАрдИрдЖрд░рдЯреА рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдЗрд╕рдХреЗ рдКрдкрд░ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдлреАрдб рдлреЙрд░рд╡рд░реНрдб рдиреЗрдЯрд╡рд░реНрдХ рдХреА рдПрдХ рдпрд╛ рджреЛ рдкрд░рддреЗрдВ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ, рдФрд░ рдХреЗрд╡рд▓ рдЗрд╕реЗ рдореБрдЦреНрдп рдмреАрдИрдЖрд░рдЯреА рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдЫреВрдиреЗ рдХреЗ рдмрд┐рдирд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░реЗрдВред  рдпрд╣ рдпрд╛ рддреЛ рдирдВрдЧреЗ TensorFlow рдкрд░ рдпрд╛ рдХреЗрд░рд╕ BERT рд╢реЗрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдХрд┐рд╕реА рд╡рд┐рд╢рд┐рд╖реНрдЯ рдбреЛрдореЗрди рдХреЗ рд▓рд┐рдП рдЗрд╕ рддрд░рд╣ рдХрд╛ рдЕрддрд┐рд░рд┐рдХреНрдд рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдмрд╣реБрдд рдЬрд▓реНрджреА рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдХрдирд╡рд▓реНрд╢рди рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдлрд╛рдЗрди рдЯреНрдпреВрдирд┐рдВрдЧ рдХреЗ рд╕рдорд╛рди рд╣реИред  рддреЛ, рдПрд╕рдХреНрдпреВрдПрдбреА рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП, рдЖрдк рдХреЗрд╡рд▓ 30 рдорд┐рдирдЯ рдореЗрдВ рдПрдХ рдЯреАрдкреАрдпреВ рдкрд░ рдПрдХ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдмреАрдИрдЯреАрдЯреА рдХреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП 16 рдЯреАрдкреАрдпреВ рдкрд░ 4 рджрд┐рдиреЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ)ред </p><br><p>  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдпрд╣ рдЕрдзреНрдпрдпрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ BERT рдореЗрдВ рдЕрдВрддрд┐рдо рдкрд░рддреЛрдВ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рд╕рд╛рде рдПрдХ рдЙрдкрдпреБрдХреНрдд рдбреЗрдЯрд╛рд╕реЗрдЯ рднреА рд╣реИред  рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдмреАрдИрдЖрд░рдЯреА рдкреЗрдЬ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://github.com/google-research/bert рдкрд░</a> рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХрдИ рдЙрджрд╛рд╣рд░рдг рд╣реИрдВ, рд╕рд╛рде рд╣реА рдХреНрд▓рд╛рдЙрдб рдЯреАрдкреАрдпреВ рдкрд░ рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рдирд┐рд░реНрджреЗрд╢ рднреА рд╣реИрдВред  рдФрд░ рдмрд╛рдХреА рд╕рднреА рдЪреАрдЬреЛрдВ рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">run_classifier.py</a> рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">extract_features.py</a> рдореЗрдВ рд╕реНрд░реЛрдд рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рджреЗрдЦрдирд╛ рд╣реЛрдЧрд╛</a> ред </p><br><h3 id="ps">  рдкреБрдирд╢реНрдЪ </h3><br><p>  рдпрд╣рд╛рдВ рдкреНрд░рд╕реНрддреБрдд Google Colab рдХреЗ рдХреЛрдб рдФрд░ рдЬреБрдкрд┐рдЯрд░ рдиреЛрдЯрдмреБрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><strong>рдХреЛ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рд╣реЛрд╕реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ</strong></a> ред </p><br><p>  рдЪрдорддреНрдХрд╛рд░ рдХреА рдЙрдореНрдореАрдж рдирд╣реАрдВ рдХреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдПред  BERT рд╕реЗ рдХрд┐рд╕реА рд╡реНрдпрдХреНрддрд┐ рдХреА рддрд░рд╣ рдмрд╛рдд рдХрд░рдиреЗ рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рди рдХрд░реЗрдВред  рдЕрддреНрдпрд╛рдзреБрдирд┐рдХ рдХреА рд╕реНрдерд┐рддрд┐ рдХрд╛ рдорддрд▓рдм рдпрд╣ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдПрдирдПрд▓рдкреА рдореЗрдВ рдкреНрд░рдЧрддрд┐ рдПрдХ рд╕реНрд╡реАрдХрд╛рд░реНрдп рд╕реНрддрд░ рдкрд░ рдкрд╣реБрдВрдЪ рдЧрдИ рд╣реИред  рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╕рд┐рд░реНрдл рдЗрддрдирд╛ рд╣реИ рдХрд┐ BERT рдкрд┐рдЫрд▓реЗ рдореЙрдбрд▓реЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдмреЗрд╣рддрд░ рд╣реИ, рдЬреЛ рдХрд┐ рдФрд░ рднреА рдмреБрд░реЗ рдереЗред  рдордЬрдмреВрдд рд╕рдВрд╡рд╛рджреА рдПрдЖрдИ рдЕрднреА рднреА рдмрд╣реБрдд рджреВрд░ рд╣реИред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдмреАрдИрдЖрд░рдЯреА рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдПрдХ рднрд╛рд╖рд╛ рдореЙрдбрд▓ рд╣реИ, рди рдХрд┐ рддреИрдпрд╛рд░ рдЪреИрдЯ рдмреЙрдЯ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдХрд┐рд╕реА рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рд╣реА рдЕрдЪреНрдЫреЗ рдкрд░рд┐рдгрд╛рдо рджрд┐рдЦрд╛рддрд╛ рд╣реИред </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi436878/">https://habr.com/ru/post/hi436878/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi436866/index.html">рдлрд░реНрдЬреА рдПрдЬрд╛рдЗрд▓ рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреЛ рдХреИрд╕реЗ рдкрд╣рдЪрд╛рдиреЗрдВ</a></li>
<li><a href="../hi436868/index.html">рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╕реНрдереИрддрд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдПрдореНрдмреЗрдб рдХрд░реЗрдВ, рдЗрд╕рдХреЗ рд╕рд╛рде рдмрдЧ рдХреА рддрд▓рд╛рд╢ рди рдХрд░реЗрдВ</a></li>
<li><a href="../hi436872/index.html">PGConf.Russia 2019 рдЬрд▓реНрдж рд╣реА рдЖ рд░рд╣рд╛ рд╣реИ</a></li>
<li><a href="../hi436874/index.html">рдПрдлрд╕реА рдПрдбрд╛рдкреНрдЯрд░ рдХреЗ рдЖрд╕рдкрд╛рд╕ рдирдП рд╕рд╛рд▓ рдХрд╛ рдиреГрддреНрдп рдпрд╛ рд╕рдорд╕реНрдпрд╛ рдХреЗ рдХрд╛рд░рдгреЛрдВ рдХреЗ рд▓рдХреНрд╖рдгреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рдХрд╣рд╛рдиреА рд╣реИ</a></li>
<li><a href="../hi436876/index.html">[SAP] dummies рдХреЗ рд▓рд┐рдП SAPUI5 рднрд╛рдЧ 1: рдПрдХ рд╕рдВрдкреВрд░реНрдг рдЪрд░рдг-рджрд░-рдЪрд░рдг рд╡реНрдпрд╛рдпрд╛рдо</a></li>
<li><a href="../hi436880/index.html">C ++ рдЯреЗрдореНрдкрд▓реЗрдЯ рдореВрд▓ рдмрд╛рддреЗрдВ: рдлрд╝рдВрдХреНрд╢рди рдЯреЗрдореНрдкрд▓реЗрдЯ</a></li>
<li><a href="../hi436884/index.html">рд╣рдо рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЙрджрд╛рд╣рд░рдг рдкрд░ async / рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi436886/index.html">рд╕реНрдХреНрд░реИрдЪ рд╕реЗ рдПрдХ рд░рд┐рдПрдХреНрдЯ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреИрдмреЗрд▓ рдФрд░ рд╡реЗрдмрдкреИрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</a></li>
<li><a href="../hi436888/index.html">рдПрдкреАрдЖрдИ рдбрд┐рдЬрд╛рдЗрди рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЗ рдкрд░ рдХрд╣рд╛рдиреА</a></li>
<li><a href="../hi436890/index.html">рд░рд┐рдПрдХреНрдЯ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рднрд╛рдЧ 10: рдШрдЯрдХ рдЧреБрдгреЛрдВ рдФрд░ рд╕реНрдЯрд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдкрд░ рдХрд╛рд░реНрдпрд╢рд╛рд▓рд╛</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>