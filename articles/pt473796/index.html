<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö∂üèº üåç ‚öΩÔ∏è Extensor HDMI √≥ptico. 300 metros ‚úíÔ∏è ü§öüèø üñçÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bom dia, Habr! 



 Desenvolvimento de cabo de extens√£o de fibra √≥ptica HDMI para 300 metros. Recusa do canal de retorno (transmiss√£o de dados em um c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Extensor HDMI √≥ptico. 300 metros</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473796/"> Bom dia, Habr! <br><br><img src="https://habrastorage.org/webt/mn/v0/c1/mnv0c1yzdk47cytsckizxbgnvxk.jpeg"><br><br>  Desenvolvimento de cabo de extens√£o de fibra √≥ptica HDMI para 300 metros.  Recusa do canal de retorno (transmiss√£o de dados em um cabo de fibra √≥ptica).  Clonando EDID no monitor. <br><a name="habracut"></a><br>  O padr√£o HDMI √© amplamente utilizado em muitas √°reas em que voc√™ deseja exibir a imagem na tela.  Pessoalmente, consegui transmitir o sinal atrav√©s de um cabo HDMI a uma dist√¢ncia de 10 metros (simplesmente n√£o era mais necess√°rio).  Eu acho que sem perda de qualidade, voc√™ pode transferir a imagem para uma dist√¢ncia de 30-40m.  As principais desvantagens no caso de prender esse cabo s√£o o seu di√¢metro e tamanho, diretamente, dos conectores.  A maneira mais f√°cil de excluir o cabo √© usar um cabo de extens√£o sem fio, acho que ser√° poss√≠vel atingir 100-150 metros, mas n√£o vou dizer com certeza.  Infelizmente, nem todos os objetos, por um motivo ou outro, permitem o uso de redes sem fio.  E se voc√™ precisar ainda mais? <br><br><img src="https://habrastorage.org/webt/a0/bl/n5/a0bln5vodfqydql1puhfo7gwdjw.jpeg"><br>  <i>Fig. 1.</i>  <i>Cabo HDMI e √≥ptica (LC)</i> <br><br>  Obviamente, a √≥ptica provavelmente n√£o √© a melhor op√ß√£o para a transmiss√£o de v√≠deo, mas ao usar PCs e monitores fixos, nem √© nada.  A primeira tese √© o di√¢metro do cabo √≥ptico (no meu caso, √© de 2-3 mm) e o di√¢metro do conector do cabo de fibra √≥ptica.  O segundo √©, obviamente, a dist√¢ncia.  Olhando para o futuro, direi que os testes foram realizados em um cabo de 300m de di√¢metro externo (3mm). <br><br><h4>  Base elementar </h4><br>  Ao desenvolver a base de elementos, a escolha recaiu inesperadamente na empresa chinesa SiFotonics, especializada nesse tipo de equipamento.  Para come√ßar, estudamos seus produtos e obtivemos duas depura√ß√µes que conectamos com um cabo √≥ptico de trezentos metros e garantimos que tudo funcionasse perfeitamente.  Eles tamb√©m possuem receptores / transmissores √≥pticos SFP (ROSA / TOSA), serializadores / desserializadores, drivers, etc. <br><br><h4>  Princ√≠pio de funcionamento </h4><br>  Para conectar e operar os dispositivos, √© necess√°rio conectar dois cabos √≥pticos e aplicar energia (cabo microUSB).  Se fizermos uma analogia com um cabo HDMI convencional, no qual h√° I2C para trocar uma tabela EDID, tudo ser√° o mesmo - um canal para transfer√™ncia de dados, o segundo - para transferir EDID do monitor para a placa de v√≠deo.  Os dados s√£o transmitidos a uma velocidade de 10 Gbps.  Rasgando o cabo do canal de retorno, a imagem desaparece invariavelmente.  Nesse momento, surgiram algumas d√∫vidas e se est√£o sendo transmitidos dados de servi√ßo ou marcas de sincroniza√ß√£o no canal de retorno, ou talvez os dispositivos estejam monitorando conex√µes entre si ... <br><br><img src="https://habrastorage.org/webt/kr/zc/jj/krzcjjntpkohogy_33h8uf0nksk.png"><br>  <i>Fig. 2.</i>  <i>A composi√ß√£o dos m√≥dulos</i> <br><br>  A primeira itera√ß√£o da placa, tamb√©m √© um layout, ficou com tamanho 20X45mm.  Com um conector de energia ‚Äúlateral‚Äù, para facilitar a distribui√ß√£o de barramentos de energia em aterros sanit√°rios.  Total de 4 camadas acabou.  Por que essa configura√ß√£o de PCB √© ruim, escreverei mais tarde.  Os desenvolvedores de depura√ß√£o complicados usaram 0201 passivo, o que eu absolutamente n√£o queria fazer, ent√£o usei 0402 e um mingau de capacitor sob o chip. <br><br><img src="https://habrastorage.org/webt/qj/90/cf/qj90cfepirzf-imyui0ouuutqu8.png"><br>  <i>Fig. 3.</i>  <i>Modelo 3D do layout da placa do m√≥dulo de origem</i> <br><br>  Como escrevi acima, minha tarefa n√£o era apenas formar um casal com uma dist√¢ncia de trabalho de 300 metros, mas tamb√©m remover o canal de retorno da √≥ptica.  Mesmo no est√°gio de desenvolvimento, decidimos n√£o nos envolver na finaliza√ß√£o do software chin√™s (embora tenhamos sido gentilmente fornecidos com todas as fontes), porque, primeiro, esse √© um monte de linhas de c√≥digo estranhas em um compilador incompreens√≠vel e, em segundo lugar, a SiFotonics pode fornecer chips flash, que √â muito conveniente, pois √© muito dif√≠cil usar dispositivos flash como parte da produ√ß√£o.  Para que o leitor n√£o pense que estou exagerando ao falar sobre as dificuldades, darei uma foto do estande de programa√ß√£o. <br><br><img src="https://habrastorage.org/webt/n_/nm/fn/n_nmfnhsezuqt1q-ly4tg3kewms.jpeg"><br>  <i>Fig. 4.</i>  <i>Suporte para programa√ß√£o e diagn√≥stico</i> <br><br>  Sim, sim, como voc√™ provavelmente j√° adivinhou, os contatos JTAG para programa√ß√£o s√£o enviados para contatos microUSB e para alguns contatos HDMI que costumavam ser GND.  Devo dizer imediatamente que isso n√£o afetou a qualidade do trabalho.  Ent√£o fique de p√©.  Para programar o chip, voc√™ deve primeiro montar um circuito do suporte e colocar o chip no modo de programa√ß√£o usando software especializado.  Em seguida, voc√™ precisa montar outro circuito e usar o outro software para exibir a placa.  Depois disso, ele entra automaticamente no modo de trabalho. <br>  Em geral, parece-me que isso √© impratic√°vel, mesmo para 1000 pe√ßas. <br><br>  Vamos voltar ao canal reverso.  Para armazenar tabelas EDID, precisamos de uma EEPROM e precisaremos alterar seu endere√ßo rapidamente.  Ele levou o N24C02UDTG em um pacote miniatura de US-8.  Para sua programa√ß√£o, utilizo o microcontrolador STM32F031G4U6, tamb√©m no menor pacote que pode ser encontrado em dom√≠nio p√∫blico - UFQFPN-28.  Tamb√©m peguei o interruptor TPS27081ADDCR.  E aqui est√° o que eu tenho: <br><br><img src="https://habrastorage.org/webt/h4/kb/gj/h4kbgj-h9ntrucsztkaiurs06do.jpeg"><br>  <i>Fig. 5.</i>  <i>Esquema de implementa√ß√£o da clonagem EDID</i> <br><br>  A ideia √© a seguinte.  Este circuito √© implementado no m√≥dulo de transmiss√£o (aquele que se conecta ao PC).  Para clonar um monitor EDID, o dispositivo se conecta ao monitor.  Por padr√£o, o endere√ßo EEPROM em nosso m√≥dulo n√£o deve coincidir com o endere√ßo EEPROM no monitor (durante a leitura), ou seja, pode ser qualquer outro, por exemplo, tornei a perna A0 gerenci√°vel.  No momento da conex√£o ao monitor, a energia √© fornecida √† EEPROM e a perna A0 √© puxada para o resistor l√≥gico "0".  Duas EEPROMs com os mesmos endere√ßos est√£o penduradas no barramento i2c, mas isso n√£o √© cr√≠tico, pois ainda n√£o estamos trabalhando com elas.  No meu circuito, h√° tamb√©m um bot√£o e LED para indicar erros / energia EDID / firmware.  Um breve toque no bot√£o altera o endere√ßo e permite que o microcontrolador comece a ler / gravar EDID.  Redefinimos a EEPROM com energia (apenas no caso) quando recebemos o sinal do bot√£o, lemos o EDID do monitor e imediatamente o gravamos em nosso chip.  Piscamos 3 vezes com o LED e desligamos a energia da EEPROM.  A leitura / grava√ß√£o ocorre instantaneamente, portanto √© feito um atraso for√ßado para piscar, para que o usu√°rio entenda que algo est√° acontecendo.  Ou seja, come√ßamos a piscar quando j√° √© poss√≠vel deixar ir.  Se algo estiver errado, n√£o acenda o LED. <br><br>  Em seguida, conecte o m√≥dulo ao PC e veja imediatamente o novo monitor nas configura√ß√µes.  O problema est√° resolvido. <br><br>  Para programar o microcontrolador trouxe o barramento SWD. <br><br><img src="https://habrastorage.org/webt/oe/xl/ba/oexlbaajt8temn8aq4sdthg29dy.jpeg"><br>  <i>Fig. 6.</i>  <i>Verso da placa do m√≥dulo</i> <br><br><h4>  Funcionalidades </h4><br>  Depois de todo o trabalho realizado com a clonagem EDID, removi o canal √≥ptico reverso e tudo funcionou perfeitamente.  Nessas experi√™ncias, a energia veio de um PC USB.  Durante a inicializa√ß√£o, o computador (em qualquer caso o meu) desliga a alimenta√ß√£o USB por um momento e a imagem do BIOS pisca no monitor - isso n√£o √© cr√≠tico.  Depois, retirei os m√≥dulos de canal reverso dos dispositivos e, depois disso, a imagem parou de se recuperar.  E isso foi precisamente devido √† falta de um m√≥dulo TOSA no dispositivo de monitor.  Tentei imitar a presen√ßa de um laser, mas sem sucesso.  Estou quase certo de que esse problema pode ser resolvido pelo firmware, mas decidimos n√£o entrar nele.  Um milagre aconteceu quando eu conectei os dois dispositivos (receptor e transmissor) √†s fontes de alimenta√ß√£o (como, ali√°s, foi indicado na declara√ß√£o de trabalho).  A imagem parou de piscar e desapareceu.  Se voc√™ distorcer a energia dos dispositivos durante a opera√ß√£o, a imagem ser√° restaurada sem problemas. <br><br><img src="https://habrastorage.org/webt/fz/00/35/fz0035l-7lplz-hgibwwnnkma8m.png"><br>  <i>Fig. 7.</i>  <i>Circuito de comuta√ß√£o do m√≥dulo transmissor (laser)</i> <br><br>  Agora, de volta √† configura√ß√£o da placa de circuito impresso e ao conector de alimenta√ß√£o lateral.  Essa implementa√ß√£o foi inicialmente inconveniente e adequada apenas para o layout.  No dispositivo de libera√ß√£o, reduzi a largura da placa para 16,3 mm e coloquei o conector de energia no lugar do m√≥dulo √≥ptico do canal reverso - isso permitir√° incluir v√°rios dispositivos em uma placa de v√≠deo.  Caso contr√°rio, o conector de alimenta√ß√£o interferiu comigo e a placa era muito larga. <br><br><img src="https://habrastorage.org/webt/9l/jd/_4/9ljd_4un4tsnidmubcxb2pjgiz4.jpeg"><br>  <i>Fig. 8.</i>  <i>Placas estreitas de receptor e transmissor</i> <br><br>  Aqui, √© claro, houve muitas re-liga√ß√µes e rearranjos de componentes.  As faixas de suprimentos foram completamente refeitas para otimizar esses tamanhos e transferir o conector microUSB.  Como voc√™ pode imaginar, os casos para os dois dispositivos s√£o id√™nticos; portanto, a configura√ß√£o da placa, os conectores e o m√≥dulo √≥ptico est√£o localizados da mesma forma.  O corpo √© fresado em alum√≠nio e √© um dissipador de calor para o processador e o driver.  As sali√™ncias para esses componentes s√£o fresadas por dentro e tamb√©m localizadas da mesma maneira. <br><br><h4>  Conclus√£o </h4><br>  No momento, quatro pares de dispositivos s√£o soldados, os testes s√£o realizados em um cabo longo em diferentes monitores e TV.  N√£o h√° queixas sobre o trabalho.  Verificamos apenas em fullHD e abaixo. <br><br>  Obrigado e at√© breve! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt473796/">https://habr.com/ru/post/pt473796/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt473784/index.html">Como escrever um contrato inteligente para o WebAssembly em uma rede Ontology? Parte 2: C ++</a></li>
<li><a href="../pt473786/index.html">As inscri√ß√µes para o hackathon em Riga est√£o terminando. Pr√™mio - treinamento de curta dura√ß√£o na PhysTech</a></li>
<li><a href="../pt473788/index.html">Microprote√≠nas descobrem aspectos desconhecidos da biologia moderna</a></li>
<li><a href="../pt473790/index.html">Splines em gr√°ficos 3D, a op√ß√£o mais automatizada</a></li>
<li><a href="../pt473794/index.html">Phishing para celular - amea√ßas sem fim</a></li>
<li><a href="../pt473798/index.html">Programa√ß√£o orientada a protocolo. Parte 1</a></li>
<li><a href="../pt473800/index.html">Bio radar, drone de papel√£o e lingui√ßa voadora - Nikita Kalinovsky sobre boas e m√°s tecnologias de pesquisa</a></li>
<li><a href="../pt473802/index.html">Alain Bombar - queda ap√≥s triunfo</a></li>
<li><a href="../pt473804/index.html">Qual √© o sal√°rio do Junior QA?</a></li>
<li><a href="../pt473806/index.html">Este √© o tipo de internet que queremos: como as m√≠dias sociais se transformaram em uma arma mortal</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>