<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚹 🌇 🕵🏻 Nun, Apple BLEee 👊🏿 💰 👨🏿‍🤝‍👨🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Apple stellt der Masse aktiv die Idee vor, dass jetzt alles in Ordnung ist und die Benutzerdaten für ihre Produkte geschützt sind. Forscher von Hexway...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nun, Apple BLEee</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/463639/"><p>  Apple stellt der Masse aktiv die Idee vor, dass jetzt alles in Ordnung ist und die Benutzerdaten für ihre Produkte geschützt sind.  Forscher von Hexway fanden jedoch heraus, dass Sie mit dem standardmäßigen und aktiv verwendeten Bluetooth LE (BLE) -Mechanismus viel über Ihr iPhone lernen können. </p><br><p>  Wenn Bluetooth aktiviert ist, kann jeder innerhalb der Reichweite des Signals Folgendes herausfinden: </p><br><ul><li>  Gerätestatus </li><li>  Gebühreninformationen; </li><li>  Gerätename </li><li>  Wi-Fi-Status </li><li>  Pufferverfügbarkeit; </li><li>  iOS-Version </li><li>  Telefonnummer. </li></ul><br><p><img src="https://habrastorage.org/webt/m9/qz/-d/m9qz-do9oa75iyybzwvj4du78cu.png"></p><a name="habracut"></a><br><p>  Dies ist höchstwahrscheinlich auf die in diesem Jahr angekündigte neue Funktion "Find my" zurückzuführen ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Apples Funktion "Find My" verwendet eine sehr clevere Kryptografie | WIRED</a> ).  Im Wesentlichen geht es darum, ein Ökosystem von Apple-Geräten zu schaffen, die BLE-Informationen miteinander austauschen <em>, um gestohlene und verlorene Geräte zu verfolgen, ohne GPS und mobile Kommunikationskanäle zu verwenden, selbst wenn diese ausgeschaltet sind</em> .  Obwohl festgestellt wurde, dass </p><br><blockquote>  ... baute die Funktion auf einem einzigartigen Verschlüsselungssystem auf, das sorgfältig entwickelt wurde, um genau diese Art der Verfolgung zu verhindern - selbst von Apple selbst <br>  Übersetzung: [Find my] verwendet ein einzigartiges Kryptosystem, das die Verfolgung [durch andere Personen], einschließlich Apple, verhindern soll. </blockquote><br><h2 id="primery-aktualnyh-vektorov-atak">  Beispiele für relevante Angriffsvektoren </h2><br><h3 id="airdrop">  Airdrop </h3><br><p>  Mit dieser Technologie können Sie Dateien zwischen Apple-Geräten ohne Internetverbindung austauschen.  Jedes Mal, wenn Sie "teilen", sendet das Gerät einen Hash Ihres Telefons an SHA256.  Nachdem Sie eine Datenbank mit Telefonnummern (Hash: Telefonnummer) erstellt haben, können Sie Telefone an überfüllten Orten sehr effizient abfangen ... und über iMessage personalisierte Nachrichten an ihre Besitzer senden (Sie können den Namen des Besitzers über TrueCaller oder über den Gerätenamen abrufen).  Der Gewinn für Geschäfte ist mehr als offensichtlich: Spam für alle Passanten. </p><br><h3 id="poluchenie-wi-fi-paroley">  Abrufen von Wi-Fi-Passwörtern </h3><br><p>  Wenn das Gerät mit einem Apple Wi-Fi-Netzwerk verbunden ist, sendet es eine Broadcast-Anfrage, und ein Apple-freundliches Gerät kann Ihnen helfen, auf das Netzwerk zuzugreifen, wenn der Benutzer dies wünscht.  Wenn Sie 3 Bytes Hashes eines Mitarbeiters erhalten und beim Versuch, eine Verbindung zum Unternehmensnetzwerk herzustellen, eine Sendung mit den empfangenen Daten erstellen, ist der andere Mitarbeiter möglicherweise sehr freundlich und teilt Ihnen das Kennwort mit, wenn er in der Anfrage einen vertrauten Namen sieht. </p><br><h2 id="kak-eto-rabotaet">  Wie funktioniert es? </h2><br><h3 id="analiz-ble-paketov">  BLE-Paketanalyse </h3><br><p>  Durch Ändern der Skripte aus dem Paket py-bluetooth-utils können Sie den Sniffer des BLE-Verkehrs anzeigen.  Apple verwendet ADV_IND-Nachrichten, um den Gerätestatus zu senden. </p><br><p>  <em>Paketstruktur bewerben</em> </p><br><p><img src="https://habrastorage.org/webt/qn/ar/tg/qnartgyw8poy82dp28fuyrmwtqm.png"></p><br><h3 id="nearby-soobscheniya">  Nachrichten in der Nähe </h3><br><p> <strong>Beispielnachrichtentypen:</strong> <br>  0x05 - Lufttropfen <br>  0x07 - Airpods <br>  0x10 - In der Nähe <br>  0x0b - Verbindung überwachen <br>  0x0c - Übergabe <br>  0x0d - Wi-Fi-Einstellungen <br>  0x0e - Hotspot <br>  0x0f - Wi-Fi Join Network </p><br><p>  <strong>Auch aus Paketen in der Nähe können Sie die Status erhalten:</strong> <br>  0x0b - Startbildschirm <br>  0x1c - Startbildschirm <br>  0x1b - Startbildschirm <br>  0x11 - Startbildschirm <br>  0x03 - Aus <br>  0x18 - Aus <br>  0x09 - Aus <br>  0x13 - Aus <br>  0x0a - Aus <br>  0x1a - Aus <br>  0x01 - Aus <br>  0x07 - Bildschirm sperren <br>  0x17 - Bildschirm sperren <br>  0x0e - Anrufen <br>  0x5b - Startbildschirm <br>  0x5a - Aus </p><br><p>  Als Ergebnis können Sie einen einfachen BLE-Paketanalysator erstellen: </p><br><p><img src="https://habrastorage.org/webt/yb/46/hp/yb46hphbjtrmnws1ll1b2njgek4.png"></p><br><h3 id="wi-fi">  Wifi </h3><br><p>  Beim Versuch, von Gerät <strong>A aus eine</strong> Verbindung zu Wi-Fi herzustellen <strong>, wird ein</strong> Paket mit der folgenden Struktur gesendet, das die ersten drei Bytes aus den SHA256-Hashes von AppleID (5-7 Byte), Telefonnummer (8-11 Byte) und E-Mail (12-14 Byte) enthält: </p><br><p><img src="https://habrastorage.org/webt/89/5c/ww/895cww-dhaj6v9kvfjmxhcsjii8.png"></p><br><p>  Vermutlich haben Apple-Geräte alle Kontakte gehasht und mit denen im Werbepaket verglichen.  Wenn Gerät <strong>B</strong> ein Paket mit übereinstimmenden Kontakt-Hashes empfängt, bietet Gerät <strong>B</strong> Gerät <strong>A</strong> ein Netzwerkverbindungskennwort an <strong>.</strong> </p><br><p>  Wenn Sie eine Tabelle mit Hashes von Telefonnummern für eine bestimmte Region (etwa mehrere Millionen) erstellen, können Sie für die ersten 3 Bytes des Hash eine Kollision in der Größenordnung von mehreren zehn Nummern pro Hash erhalten.  Es gibt zwei Möglichkeiten, die Richtigkeit von Zahlen zu überprüfen: </p><br><ol><li>  Einige Zahlen können ausgeschlossen werden, indem sie über das HLR ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">HLR Lookup - Front Page - Index</a> ) überprüft werden. </li><li>  Da die Nummer an AppleID gebunden sein muss, können Sie dies über iMessage überprüfen. </li></ol><br><p>  In jedem Fall ermöglicht der erhaltene Satz von Zahlen eine recht effektive Dekanonymisierung des Eigentümers (z. B. durch weitere Verwendung von Social-Engineering-Methoden). </p><br><h3 id="airdrop-1">  Airdrop </h3><br><p>  Apple AirDrop verfügt über drei Datenschutzeinstellungen: </p><br><ol><li>  Empfangen aus. </li><li>  Nur Kontakte. </li><li>  Jeder. </li></ol><br><p>  Beim Start von AirDrop wird ein Paket mit der folgenden Struktur gesendet, das zwei Byte AppleID-Hashes, E-Mail und Telefonnummer enthält: </p><br><p><img src="https://habrastorage.org/webt/gs/zp/eb/gszpebo9vd4ndcd9volhmxudpea.png"></p><br><p>  Gleichzeitig wird AirDrop nur zum Initiieren der Übertragung verwendet. Für die Datenübertragung selbst wird die Peer2peer-Verbindung über WLAN (AWDL - Apple Wireless Direct Link) verwendet. </p><br><p>  Während der Authentifizierung sendet der <strong>Absender die Datensatzdaten</strong> des <strong>Absenders</strong> , um die Datenschutzeinstellungen des Empfängers zu überprüfen.  Diese Nachricht enthält den vollständigen SHA256-Hash des Absenders.  Somit kann ein Angreifer auf alle anderen AirDrop BLE-Anfragen antworten und vollständige Zahlen-Hashes erhalten. </p><br><p>  AirDrop-Betriebsschema: </p><br><p><img src="https://habrastorage.org/webt/bd/tw/pl/bdtwpldckibjre2qd2nrltpkuti.png"></p><br><h2 id="rezyumiruya">  Zusammenfassen </h2><br><p>  Es wird nur ein Teil des Informationsverlusts berücksichtigt, der mit BLE möglich ist.  Im Moment ist es schwierig, dies als Sicherheitslücke zu bezeichnen, sondern als schlecht durchdachte Implementierung des neuen Ökosystems von Apple.  Was sie im Prinzip selbst sagten: </p><br><blockquote>  Apple warnt davor, dass es sich immer noch um eine etwas vereinfachte Version des Find My-Protokolls handelt und dass sich das System noch ändern kann, bevor es später in diesem Jahr tatsächlich in MacOS Catalina und iOS 13 veröffentlicht wird.  © <br>  Verkabelt <br>  Übersetzung: Apple warnte davor, dass derzeit eine vereinfachte Version des Find My-Protokolls verwendet wird, die in zukünftigen Versionen gegen Ende des Jahres aktualisiert werden soll. </blockquote><p>  Im Moment gibt es keine andere Möglichkeit, Datenlecks zu verhindern, als Bluetooth auszuschalten.  Darüber hinaus ist dieses Verhalten typisch für iOS-Versionen 10.3.1 und höher (einschließlich iOS 13 Beta).  Ältere Geräte (bis zu iPhone 6s) verwenden diese Funktion ebenfalls, jedoch mit einer begrenzten Anzahl von Meldungen, möglicherweise um Batteriestrom zu sparen. </p><br><h2 id="ssylki">  Referenzen </h2><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub - hexway / apple_bleee: Apple BLE-Forschung</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Apple bleee.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Jeder weiß, was auf Ihrem iPhone passiert - hexway</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de463639/">https://habr.com/ru/post/de463639/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de463625/index.html">Netzwerküberwachung und Erkennung abnormaler Netzwerkaktivitäten mithilfe von Flowmon Networks-Lösungen</a></li>
<li><a href="../de463627/index.html">Assembler-Codegenerator-Bibliothek für AVR-Mikrocontroller. Teil 4</a></li>
<li><a href="../de463629/index.html">Konfigurieren von NextCloud + ONLYOFFICE auf demselben Server mit Docker</a></li>
<li><a href="../de463631/index.html">Dialoge über Briefe</a></li>
<li><a href="../de463637/index.html">Testen Sie Ihre Infrastruktur als Code mit Pulumi. Teil 2</a></li>
<li><a href="../de463647/index.html">Videos und Berichte mit SmartMail Meetup: Frontend</a></li>
<li><a href="../de463649/index.html">Analytischer Hinweis. Überprüfung der Anordnung des Energieministeriums der Russischen Föderation vom 6. November 2018 N 1015</a></li>
<li><a href="../de463651/index.html">Diskrete Mathematik für WMS: Algorithmus zum Komprimieren von Waren in Zellen (Teil 2)</a></li>
<li><a href="../de463653/index.html">Einschränkungen von 16-Bit-Spielen und deren Wiederherstellung in Unity</a></li>
<li><a href="../de463655/index.html">Die Geburt eines Projekts oder wie man ein eigenes CMS schreibt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>