<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç† üêô ü§ö LEDs de endere√ßo coloridos para o novo ano sem programa√ß√£o e solda üëâüèø üöí üë©üèº‚Äçüé§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O ano novo est√° chegando em breve, mas o clima por v√°rias raz√µes √†s vezes n√£o √© o ano novo, e aqui a ilumina√ß√£o do ano novo vem em socorro. Quero fala...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>LEDs de endere√ßo coloridos para o novo ano sem programa√ß√£o e solda</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/481566/"><p> O ano novo est√° chegando em breve, mas o clima por v√°rias raz√µes √†s vezes n√£o √© o ano novo, e aqui a ilumina√ß√£o do ano novo vem em socorro.  Quero falar sobre minha experi√™ncia com guirlandas e fitas de LED endere√ß√°veis.  √â improv√°vel que descubra a Am√©rica, mas ficou bonito e barato. </p><br><p><img src="https://habrastorage.org/webt/eu/ks/bo/euksbogl1rav5lvy75cz1xuzkrc.gif"><br>  Vou considerar duas op√ß√µes - separadamente, sem a automa√ß√£o residencial existente e trabalhar em conjunto com uma ‚Äúcasa inteligente‚Äù. </p><a name="habracut"></a><br><p>  Muitas informa√ß√µes estruturadas apareceram em fitas LED endere√ß√°veis ‚Äã‚Äãe, portanto, voc√™ pode facilmente fazer uma escolha informada.  Por exemplo, antes de comprar, assisti atentamente aos v√≠deos correspondentes dos <a href="https://youtu.be/tXvtxwK3jRk%3Ft%3D438">canais DrZzs (em ingl√™s)</a> e <a href="https://youtu.be/QnvircC22hU%3Ft%3D213">The Hook Up (em ingl√™s)</a> e <a href="https://youtu.be/tXvtxwK3jRk%3Ft%3D438">tirei</a> conclus√µes sobre o custo das fitas necess√°rias - porque o resultado do trabalho das fitas no meu caso √© um - destaque colorido. </p><br><p>  Ele optou por duas op√ß√µes baratas da China: </p><br><ol><li>  <a href="https://www.aliexpress.com/item/32682015405.html">Fita WS2812B - 300 LEDs</a> - 5 metros. </li><li>  <a href="https://www.aliexpress.com/item/32444382333.html">WS2811 Garland - 50 LEDs</a> x 3 pe√ßas - aproximadamente 10 metros (3 x 3,3 m) </li></ol><br><p><img src="https://habrastorage.org/webt/0x/gh/8o/0xgh8oibngraaijuiyih_bw-8ni.jpeg"><br>  <em>Pixels de endere√ßo no interior de um escrit√≥rio</em> </p><br><p>  Nos dois casos, s√£o necess√°rios 5 volts para alimentar minhas fitas.  N√£o contei com energia, mas instalei a fonte de alimenta√ß√£o <a href="https://meanwellpower.ru/istochnik-pitaniya-ac-dc-mean-well-rs-150-5">Mean Well RS-150-5</a> existente e acess√≠vel. </p><br><p><img src="https://habrastorage.org/webt/hj/eg/v5/hjegv5csxbptdn1x0_4z4t9gxmy.jpeg"><br>  <em>Fonte de alimenta√ß√£o Mean Well RS-150-5</em> </p><br><p>  E a parte mais importante para gerenciar o programa de Ano Novo √© o controlador.  Escolhi o microcontrolador ESP8266 do fabricante chin√™s Espressif Systems, ou seja, no meu caso, usei uma <a href="https://www.aliexpress.com/item/32529101036.html">miniplaca LOLIN (WEMOS) D1 de</a> baixo custo. </p><br><p><img src="https://habrastorage.org/webt/7u/4m/6t/7u4m6thz8kgpqlriu89ezskz-he.jpeg"><br>  <em>LOLIN (WEMOS) D1 mini-psiquiatra conectado a uma fita na √°rvore de Natal</em> </p><br><h2 id="hardware">  Hardware </h2><br><p>  Para fitas e guirlandas, h√° uma escolha muito ampla - h√° um grande n√∫mero de chipsets diferentes e voc√™ precisa procurar para que o controlador suporte as fitas que voc√™ vai comprar. <br>  Minha tarefa era usar fitas de pixel de endere√ßo como parte da automa√ß√£o baseada no <a href="https://www.home-assistant.io/">Home Assistant da</a> plataforma de c√≥digo aberto.  A op√ß√£o mais acess√≠vel para isso √© usar o ESP8266.  H√° um <a href="https://blakadder.github.io/templates/light.html">grande banco de dados de controladores fabricados de f√°brica compat√≠veis</a> (se√ß√£o LED Controller), compilados pelos autores do firmware Tasmota. <br>  Na minha opini√£o, Tasmota √© um bom firmware, mas para pixels controlados e <a href="https://habr.com/ru/post/480690/">motores de passo</a> n√£o √© muito adequado. </p><br><p><img src="https://habrastorage.org/webt/xv/ah/o-/xvaho-hbz991uoxukkboyrdj_a0.jpeg"><br>  <em>LOLIN (WEMOS) D1 mini conectado a uma guirlanda</em> </p><br><h2 id="software">  De software </h2><br><h3 id="variant-bez-domashney-avtomatizacii">  Op√ß√£o sem automa√ß√£o residencial </h3><br><p>  Se voc√™ deseja um in√≠cio r√°pido "sem registro e SMS", a solu√ß√£o mais razo√°vel √© o firmware ESP8266 do projeto WLED <a href="https://github.com/Aircoookie/WLED">(driver de efeitos de ilumina√ß√£o WiFi)</a> .  O firmware possui seu pr√≥prio aplicativo que permite controlar facilmente os LEDs, al√©m de uma enorme lista de efeitos predefinidos para fitas de endere√ßo e guirlandas.  O WLED tamb√©m suporta muitos protocolos de gerenciamento, incluindo <abbr title="Transporte de Telemetria do Servi√ßo de Enfileiramento de Mensagens">MQTT</abbr> , se necess√°rio. <br>  A solda para conectar a fita ao WEMOS n√£o √© necess√°ria. </p><br><p><img src="https://habrastorage.org/webt/y0/u4/1c/y0u41c5hp2qj17vjcwm3adynbc8.png"><br>  <em>Interface WLED (driver de efeitos de ilumina√ß√£o WiFi)</em> </p><br><h3 id="adresnaya-illyuminaciya-v-sostave-umnogo-doma-na-baze-home-assistant">  Ilumina√ß√£o direcionada como parte de uma casa inteligente com base no Home Assistant </h3><br><p>  Note-se que o WLED recentemente (em dezembro de 2019) apareceu <a href="https://www.home-assistant.io/integrations/wled/">integra√ß√£o total para o Home Assistant</a> . <br>  Por√©m, desde que eu estava envolvido em guirlandas em novembro, antes que essa integra√ß√£o aparecesse, a conex√£o WLED MQTT do Assistente Dom√©stico me pareceu um buggy. </p><br><p><img src="https://habrastorage.org/webt/84/zs/iz/84zsiziqm9ymyidmesj2rqorn4q.png"><br>  <em>Painel de Controle ESPHome</em> </p><br><p>  Para o Home Assistant, existe um firmware <a href="https://esphome.io/index.html">ESPHome</a> nativo que funciona com o Home Assistant sem MQTT e tamb√©m <a href="https://esphome.io/components/light/fastled.html">suporta LEDs de endere√ßo</a> . </p><br><div class="spoiler">  <b class="spoiler_title">Aqui est√° uma lista de chipsets suportados.</b> <div class="spoiler_text"><p>  Clockless: <br>  NEOPIXEL <br>  WS2811 <br>  WS2811_400 (WS2811 com uma taxa de clock de 400kHz) <br>  WS2812B <br>  WS2812 <br>  WS2813 <br>  WS2852 <br>  APA104 <br>  APA106 <br>  Gw6205 <br>  GW6205_400 (GW6205 com uma taxa de clock de 400kHz) <br>  LPD1886 <br>  LPD1886_8BIT (LPD1886 com valores de canal de cores de 8 bits) <br>  PL9823 <br>  SK6812 <br>  SK6822 <br>  TM1803 <br>  TM1804 <br>  TM1809 <br>  TM1829 <br>  UCS1903B <br>  UCS1903 <br>  UCS1904 <br>  UCS2903 </p><br><p>  SPI: <br>  APA102 <br>  Dotstar <br>  LPD8806 <br>  P9813 <br>  SK9822 <br>  SM16716 <br>  WS2801 <br>  WS2803 </p></div></div><br><p>  Como uso a imagem <a href="https://www.home-assistant.io/hassio/">Hass.io</a> , usei a op√ß√£o mais simples para compilar o firmware - o <a href="https://github.com/esphome/hassio">complemento ESPHome Hass.io Add-on</a> . </p><br><p><img src="https://habrastorage.org/webt/vq/1_/or/vq1_orjpjkcqkmcs-f71-e0k34a.png"><br>  <em>Janela do editor de firmware ESPHome</em> </p><br><p>  As guirlandas e fitas de firmware resultantes: </p><br><div class="spoiler">  <b class="spoiler_title">ws2811_string.yaml</b> <div class="spoiler_text"><pre><code class="plaintext hljs">substitutions: devicename: ws2811_string upper_devicename: WS2811 string esphome: name: $devicename platform: ESP8266 board: d1_mini wifi: ssid: "XXX" password: "XXX" # Enable fallback hotspot (captive portal) in case wifi connection fails ap: ssid: "WS2811 string Fallback Hotspot" password: "XXX" captive_portal: web_server: port: 80 css_url: http://192.168.15.10:8123/local/webserver-v1.min.css #   -        https://github.com/esphome/issues/issues/648 js_url: http://192.168.15.10:8123/local/webserver-v1.min.js # Enable Home Assistant API api: # Enable OTA Access ota: # Enable verbose logging over serial logger: light: - platform: fastled_clockless chipset: WS2811 pin: D4 num_leds: 150 name: " WS2811" effects: - addressable_rainbow: name: Rainbow Effect With Custom Values speed: 30 width: 150 - addressable_color_wipe: name: Color Wipe Effect With Custom Values colors: - red: 10% green: 10% blue: 100% num_leds: 1 - red: 0% green: 0% blue: 0% num_leds: 1 add_led_interval: 100ms reverse: False - random: name: "My Fast Random Effect" transition_length: 4s update_interval: 5s - strobe: name: Strobe Effect With Custom Values colors: - state: True brightness: 100% red: 100% green: 90% blue: 0% duration: 500ms - state: False duration: 250ms - state: True brightness: 100% red: 0% green: 100% blue: 0% duration: 500ms - addressable_scan: name: Scan Effect With Custom Values move_interval: 60ms - addressable_fireworks: name: Fireworks Effect With Custom Values update_interval: 32ms spark_probability: 10% use_random_color: false fade_out_rate: 120 #     sensor: - platform: uptime id: uptime_sec - platform: wifi_signal name: ${upper_devicename} WiFi Signal id: wifis_signal update_interval: 900s text_sensor: - platform: template name: ${upper_devicename} Uptime lambda: |- int seconds = (id(uptime_sec).state); int days = seconds / (24 * 3600); seconds = seconds % (24 * 3600); int hours = seconds / 3600; seconds = seconds % 3600; int minutes = seconds / 60; seconds = seconds % 60; return { (String(days) +"d " + String(hours) +"h " + String(minutes) +"m "+ String(seconds) +"s").c_str() }; icon: mdi:clock-start update_interval: 113s - platform: template name: ${upper_devicename} Wifi Strength icon: "mdi:wifi" lambda: |- if (id(wifis_signal).state &gt; -50 ) { return {"Excellent"}; } else if (id(wifis_signal).state &gt; -60) { return {"Good"}; } else if (id(wifis_signal).state &gt; -70) { return {"Fair"}; } else if (id(wifis_signal).state &lt; -70) { return {"Weak"}; } else { return {"None"}; } update_interval: 900s - platform: version name: ${upper_devicename} Version - platform: template name: ${upper_devicename} MAC Address lambda: 'return {WiFi.macAddress().c_str()};' icon: mdi:fingerprint update_interval: 1d switch: - platform: restart name: ${upper_devicename} Restart</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">ws2811_strip.yaml</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">substitutions: devicename: ws2811_strip upper_devicename: WS2811 strip esphome: name: $devicename platform: ESP8266 board: d1_mini_lite wifi: ssid: "XXX" password: "XXX" # Enable fallback hotspot (captive portal) in case wifi connection fails ap: ssid: "WS2811 strip Fallback Hotspot" password: "XXX" captive_portal: web_server: port: 80 css_url: http://192.168.15.10:8123/local/webserver-v1.min.css #   -        https://github.com/esphome/issues/issues/648 js_url: http://192.168.15.10:8123/local/webserver-v1.min.js # Enable Home Assistant API api: # Enable OTA Access ota: # Enable verbose logging over serial logger: light: - platform: fastled_clockless chipset: WS2811 pin: D4 num_leds: 300 rgb_order: GRB name: " WS2811" effects: - addressable_rainbow: name: Rainbow Effect With Custom Values speed: 30 width: 300 - addressable_color_wipe: name: Color Wipe Effect With Custom Values colors: - red: 10% green: 10% blue: 100% num_leds: 1 - red: 0% green: 0% blue: 0% num_leds: 1 add_led_interval: 100ms reverse: False - random: name: "My Fast Random Effect" transition_length: 4s update_interval: 5s - strobe: name: Strobe Effect With Custom Values colors: - state: True brightness: 100% red: 100% green: 90% blue: 0% duration: 500ms - state: False duration: 250ms - state: True brightness: 100% red: 0% green: 100% blue: 0% duration: 500ms - addressable_scan: name: Scan Effect With Custom Values move_interval: 60ms - addressable_fireworks: name: Fireworks Effect With Custom Values update_interval: 32ms spark_probability: 10% use_random_color: false fade_out_rate: 120 #     sensor: - platform: uptime id: uptime_sec - platform: wifi_signal name: ${upper_devicename} WiFi Signal id: wifis_signal update_interval: 900s text_sensor: - platform: template name: ${upper_devicename} Uptime lambda: |- int seconds = (id(uptime_sec).state); int days = seconds / (24 * 3600); seconds = seconds % (24 * 3600); int hours = seconds / 3600; seconds = seconds % 3600; int minutes = seconds / 60; seconds = seconds % 60; return { (String(days) +"d " + String(hours) +"h " + String(minutes) +"m "+ String(seconds) +"s").c_str() }; icon: mdi:clock-start update_interval: 113s - platform: template name: ${upper_devicename} Wifi Strength icon: "mdi:wifi" lambda: |- if (id(wifis_signal).state &gt; -50 ) { return {"Excellent"}; } else if (id(wifis_signal).state &gt; -60) { return {"Good"}; } else if (id(wifis_signal).state &gt; -70) { return {"Fair"}; } else if (id(wifis_signal).state &lt; -70) { return {"Weak"}; } else { return {"None"}; } update_interval: 900s - platform: version name: ${upper_devicename} Version - platform: template name: ${upper_devicename} MAC Address lambda: 'return {WiFi.macAddress().c_str()};' icon: mdi:fingerprint update_interval: 1d switch: - platform: restart name: ${upper_devicename} Restart</code> </pre> </div></div><br><p>  Depois de adicionar os dispositivos resultantes ao Assistente Dom√©stico na interface, voc√™ pode ver e definir as op√ß√µes de efeitos. </p><br><p><img src="https://habrastorage.org/webt/on/56/ah/on56ah882ioqsx4950ppkg-mlec.png"><br>  <em>Interface do Assistente Dom√©stico</em> </p><br><p>  Al√©m disso, os efeitos podem ser usados ‚Äã‚Äãna automa√ß√£o.  Por exemplo, quando voc√™ abre a porta por 30 segundos, um efeito, 10 segundos, outro efeito e, em seguida, desliga para n√£o distrair.  Mas h√° uma condi√ß√£o: inclus√£o apenas quando a rua j√° est√° no crep√∫sculo. </p><br><div class="spoiler">  <b class="spoiler_title">automations.yaml</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">################################################### # # # WS2811 :    # # # ################################################### - alias: WS2811 string trigger: - platform: state entity_id: binary_sensor.dver from: 'off' to: 'on' condition: - condition: numeric_state entity_id: 'sensor.osveshchennost_u_okna' below: 1500 # action: - service: homeassistant.turn_on data: entity_id: group.new_year #light.girlianda_ws2811 brightness: 255 effect: Rainbow Effect With Custom Values - delay: '00:00:25' - service: homeassistant.turn_on data: entity_id: group.new_year brightness: 255 effect: Color Wipe Effect With Custom Values - delay: '00:00:13' - service: homeassistant.turn_off entity_id: group.new_year - alias: Table lamp ON trigger: - platform: state entity_id: binary_sensor.dver from: 'off' to: 'on' condition: - condition: numeric_state entity_id: 'sensor.osveshchennost_u_okna' below: 90 # action: - service: homeassistant.turn_on entity_id: switch.potolochnaia_lampa - alias: Table lamp OFF trigger: - platform: state entity_id: binary_sensor.dver from: 'on' to: 'off' condition: [] action: - service: homeassistant.turn_off entity_id: switch.potolochnaia_lampa</code> </pre> </div></div><br><p><img src="https://habrastorage.org/webt/gy/ci/o9/gycio9hm7fhzga6hjjxbn3yb2eg.jpeg"><br>  <em>√Årvore de Natal com fita LED de endere√ßo</em> </p><br><h2 id="itog">  Sum√°rio </h2><br><p>  Como voc√™ pode ver, com um pouco de destreza, voc√™ pode organizar a ilumina√ß√£o de Ano Novo de maneira barata e ajust√°-la ao sistema ‚Äúsmart home‚Äù existente ou us√°-lo separadamente, sem automa√ß√£o residencial, usando um aplicativo separado em seu smartphone. </p><br><p>  Mais detalhes podem ser encontrados no <a href="https://github.com/empenoso/diy-holiday-lighting">GitHub</a> . </p><br><p>  Publicado por: <a href="https://www.facebook.com/mikhail.shardin">Mikhail Shardin</a> , <br>  23 de dezembro de 2019 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt481566/">https://habr.com/ru/post/pt481566/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt481554/index.html">Como fa√ßo para passar pelo Mestrado Online em Ci√™ncia da Computa√ß√£o e a quem isso pode n√£o ser adequado</a></li>
<li><a href="../pt481556/index.html">Fila de tarefas do PostgreSQL</a></li>
<li><a href="../pt481560/index.html">O resumo de materiais frescos do mundo do front-end da √∫ltima semana n ¬∞ 394 (15 a 22 de dezembro de 2019)</a></li>
<li><a href="../pt481562/index.html">Teste de calor Raspberry Pi 4</a></li>
<li><a href="../pt481564/index.html">PHP Digest No. 170 (9 a 23 de dezembro de 2019)</a></li>
<li><a href="../pt481568/index.html">Eventos digitais em Moscou de 23 a 29 de dezembro</a></li>
<li><a href="../pt481570/index.html">Hoje, √†s 17:00, o semin√°rio on-line DevOps: Ferramentas e N√∫meros ser√° realizado</a></li>
<li><a href="../pt481572/index.html">Minha nova pilha de tecnologias da web para 2020</a></li>
<li><a href="../pt481574/index.html">Auto-hospedagem de recursos de terceiros: bom, ruim, mau</a></li>
<li><a href="../pt481576/index.html">Frontend 2019: resultados do ano</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>