<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏁 🍲 ⛏️ 房子的黑匣子：我们用自己的双手收集NAS，第2部分-宏伟的NAS4Free 👨🏿‍🏫 🌌 👩🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="该出版物面向不从事系统管理的人员。这篇文章演示了出色的NAS4Free操作系统的基本功能，该功能使您甚至可以在完全不了解FreeBSD和命令行的情况下，甚至在低功耗的硬件上部署家庭NAS。该出版物的第一部分位于此处。
 
 因此，我们有一个具有以下特征的盒子：
 
 

- 案例：Thermalta...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>房子的黑匣子：我们用自己的双手收集NAS，第2部分-宏伟的NAS4Free</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/397575/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该出版物面向不从事系统管理的人员。</font><font style="vertical-align: inherit;">这篇文章演示了出色的NAS4Free操作系统的基本功能，该功能使您甚至可以在完全不了解FreeBSD和命令行的情况下，甚至在低功耗的硬件上部署家庭NAS。</font><font style="vertical-align: inherit;">该出版物的第一部分位于</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，我们有一个具有以下特征的盒子：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">案例：Thermaltake Core V1；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">电源：Chieftec HPS-350NS；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主板：技嘉GA-J1800N-D2H;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAM：创见SO-DIMM 2Gb DDR-III 1333Mhz x 2;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">硬盘：WD Re 2004FBYZ x 2（在制作圆形眼睛之前，请先阅读</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第一部分</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">冷却：TITAN直流风扇（80 mm，2000 rpm）x 2。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在是时候将其转变为家用NAS，在当前环境中尽可能可靠。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zettabyte文件系统</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将为我们提供帮助</font><font style="vertical-align: inherit;">-也许是组织容错和高效文件存储的最佳解决方案。</font><font style="vertical-align: inherit;">ZFS由Sun Microsistems为Solaris开发，后来被移植到Linux和FreeBSD。</font><font style="vertical-align: inherit;">在众多优点中，我们将对以下内容感兴趣：</font></font><br>
<br>
<ol>
<li> ,          ,   ,    –   ,  LVM;</li>
<li>     256-  ;</li>
<li>      ;</li>
<li>    RAID-    .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在专门的解决方案，可与ZFS工作，明确区分了竞争对手- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FreeNAS的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nas4free</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。这样的“镜像”名称绝不是偶然的-这两个程序集都是基于FreeBSD的，而NAS4Free本身是FreeNAS 0.7的一个分支，它起源于原始操作系统进入iXsystems的行列之时。我个人最喜欢的是NAS4Free。怎么了让我们做对。</font></font><br>
<br>
<ol>
<li>.   ,       NAS,     ,   NAS4Free   .       ?   , 4  RAM,  4-  ,       .     512    2-   .  FreeNAS   :      8  RAM  8- ,          1616 (    ).</li>
<li>.   NAS4Free       “ ” –         :<br>
<img src="https://habrastorage.org/files/db0/488/59d/db048859d2fd48b891142fb3bdb4b3b5.JPG"></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方便。</font><font style="vertical-align: inherit;">在NAS4Free中，几乎所有内容都可以通过真正直观的Web界面进行控制，此外，它包含许多技巧，并且与竞争对手相比，可以很好地翻译成俄语。</font><font style="vertical-align: inherit;">原则上，您将能够在不启动控制台的情况下使用磁盘和服务，管理文件系统，创建快照和挂载克隆，这将吸引新手用户和根本不熟悉nix管理的人员。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我认为以上论点足以做出明确的选择。</font><font style="vertical-align: inherit;">现在，我们将处理系统的安装和初始设置。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装NAS4Free</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于系统中只有两个磁盘，因此我们将使用USB闪存驱动器作为引导驱动器。哪一个绝对无关紧要，任何2 GB以上的上古都足够了。如果对设备的运行状况有疑问，可以使用相同的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rufus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并运行多个测试。然后一切都变得简单- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下载LiveCD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并继续进行安装。首先，您将看到以下屏幕：</font></font><br>
<br>
<img src="https://habrastorage.org/files/fbf/648/4da/fbf6484daa0547b0909f3c6ae628055c.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一段时间后，文本菜单出现在显示屏上：</font></font><br>
<br>
<img src="https://habrastorage.org/files/a67/f79/d38/a67f79d38d184d7398b43e8e47ec31e6.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们对第9个项目感兴趣-我们选择了第9个项目。安装过程开始：</font></font><br>
<br>
<img src="https://habrastorage.org/files/e0b/749/0b5/e0b7490b5b9249e3afe759a0338f00ac.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们不使用专家模式，但是GPT和MBR之间的选择取决于计算机主板的寿命。如果您是BIOS中“经典”用户的粉丝，请选择第二项。值得UEFI-选择第一个。确认后，NAS4Free将告诉您它将要执行的操作-我们在所有方面都达成共识：</font></font><br>
<br>
<img src="https://habrastorage.org/files/9e0/573/d3d/9e0573d3d97748f9886e27cfce14abd7.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，选择带有安装盘的驱动器（在我们的示例中是唯一的</font></font><br>
<br>
<img src="https://habrastorage.org/files/4e4/6e0/278/4e46e0278ccd4e81ac36823d4deaae17.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
驱动器</font><font style="vertical-align: inherit;">）：</font><font style="vertical-align: inherit;">然后，您应指定要在其上执行安装的USB闪存驱动器。很容易将它与系统驱动器的大小和名称区分开来：</font></font><br>
<br>
<img src="https://habrastorage.org/files/2ab/ab6/10c/2abab610c86a4e088662cc49dadb6788.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
下一步是设置页面文件的大小。规则很简单：如果使用2 GB的驱动器-放置512 MB，则放置4 GB-如果使用8-2放置1024 MB，很多人在评论中都有一个公平的问题，但是将操作系统安装在USB闪存驱动器上的可靠性如何，更重要的是，对其进行交换？我认为有必要澄清这一点。首先，嵌入式版本的功能是在RAM中创建系统的磁盘映像，即仅在加载NAS时以及保存设置时才访问闪存驱动器。其次，安装程序需要正确创建交换文件，同时错误地确定其大小。在4 gig设备上进行8 gig交换？容易！无论如何，根据程序，都值得尝试。为避免错误，最简单的方法是设置上面给出的正确值之一。最后，交换文件是在设置中手动连接的-它不会被使用，这意味着闪存驱动器也不会被杀死。</font></font><br>
<br>
<img src="https://habrastorage.org/files/f60/05b/781/f6005b78119547c887160a817bc13307.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
安装过程将开始，然后您将看到以下屏幕：</font></font><br>
<br>
<img src="https://habrastorage.org/files/899/565/757/89956575762146aa86febf2e095cf33e.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以断开USB闪存驱动器的连接并重新引导-安装成功。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，让我们使用NAS本身。由于我们为瘦客户机选择了预算选项作为主板，因此我们必须首先调整启动参数，不仅将USB闪存驱动器连接，而且将带有键盘的显示器连接到设备。由于视频输出具有D-Sub和HDMI，因此应该没有问题。打开机器电源后，我们按“删除”，然后在“启动”菜单中将USB闪存驱动器设置为主启动设备（默认情况下，UEFI Shell会启动，但我们不需要）。我们保存更改，重新启动NAS，如果一切都正确完成，我们将看到一个熟悉的菜单：</font></font><br>
<br>
<img src="https://habrastorage.org/files/145/570/2e1/1455702e1f1845a79781dfc2fcf7f1f7.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以通过任何方式将NAS连接到工作环境：通过路由器，交换机，零集线器-这一切都取决于您的个人需求。</font><font style="vertical-align: inherit;">由于您可能希望将机器带到家庭网络，因此最好的选择是路由器，因此让我们在步骤2中设置一个静态IP地址。始终如一地回答系统提出的问题：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您是否要为此接口使用DHCP？</font><font style="vertical-align: inherit;">-否（我们要设置一个静态IP）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输入新的LAN IPv4地址-192.168.1.250（默认情况下已安装，如果您的网络已使用它-输入任何免费的）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输入新的LAN子网掩码-24（子网掩码255.255.255.0）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输入IPv4默认网关-192.168.1.1（指定路由器的地址）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输入DNS IPv4地址-192.168.1.1（还要指定路由器的地址）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是否要为此接口配置IPv6？</font><font style="vertical-align: inherit;">-否（我们根本不需要IPv6家庭网络）</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该屏幕将证明配置已成功完成：</font></font><br>
<br>
<img src="https://habrastorage.org/files/e11/c1a/3b2/e11c1a3b258a446984032148e61f0d6c.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NAS的准备工作已完成-现在，您可以将存储连接到网络并继续进行配置。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自定义驱动器</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所有操作都通过便捷的WebGUI进行-只需输入先前设置的IP地址（在我们的示例中为192.168.1.250），然后立即转到授权表单：</font></font><br>
<br>
<img src="https://habrastorage.org/files/844/ba8/a75/844ba8a75db746cc88c0d4ab6107eeff.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
默认登录名是admin，密码（可能会想到）是nas4free。</font><font style="vertical-align: inherit;">登录并查看系统监视器：</font></font><br>
<br>
<img src="https://habrastorage.org/files/7ee/93c/0d5/7ee93c0d52084fdba42170d9f4a9be33.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们立即切换至强大的功能：转到“系统”-&gt;“常规”并将语言更改为俄语：</font></font><br>
<br>
<img src="https://habrastorage.org/files/6f7/99d/35b/6f799d35b471485697b7a7284a8e2589.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这里，您还可以为Web界面设置新的用户名和密码。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，我们来设置磁盘。</font><font style="vertical-align: inherit;">我们转到“驱动器”-&gt;“管理”部分，...我们什么也没找到：</font></font><br>
<br>
<img src="https://habrastorage.org/files/fa5/4b0/53a/fa54b053a6a94984b083c298b52930f6.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
只有没有慌张-在NAS4Free中，您需要用手做所有事情。</font><font style="vertical-align: inherit;">最简单的选择是单击“清除配置并导入磁盘”，但是我建议单击右侧的蓝色加号并一次添加一个驱动器。</font><font style="vertical-align: inherit;">菜单如下：</font></font><br>
<br>
<img src="https://habrastorage.org/files/aac/ab4/fc0/aacab4fc02874f59a086427a3ae2bcbd.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们看一下这些选项：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述完全可以留空，我使用了光盘的缩写名称。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">传输方式离开自动；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据个人需要指定将驱动器转移到待机模式的时间。</font><font style="vertical-align: inherit;">但是，应考虑以下因素：频繁重启对于可靠的WD Re甚至都没有好处，因此设置5-10分钟没有意义-这只会加速HDD的磨损。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">电源管理-我将等级设置为127-在性能和功耗之间进行权衡；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">噪音水平-由于WD的运行非常安静，因此我认为不需要使用它。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果要启用SMART监视，请选中该框；否则，请单击复选框。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于磁盘是新磁盘，因此在最后一行保留“未格式化”（未格式化）。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，单击“添加”按钮，并对其余磁盘重复该过程。</font><font style="vertical-align: inherit;">您无需添加闪存驱动器即可避免任何误会（快速格式化它，一切都必须从头开始）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
完成所有操作后，我们将在磁盘设置菜单中看到以下内容：</font></font><br>
<br>
<img src="https://habrastorage.org/files/f7d/1d9/ca0/f7d1d9ca037f40d286c4fa1f4edf577b.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
阅读屏幕快照中的警告。</font><font style="vertical-align: inherit;">是的，这是NAS4Free的功能：首先，我们进行设置，然后通过单击“应用更改”确认选择-您将不得不习惯它。</font><font style="vertical-align: inherit;">此后，我们观察到操作的结果：</font></font><br>
<br>
<img src="https://habrastorage.org/files/aef/a97/cd9/aefa97cd9662417f8a71903c3f408636.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果要通过监视磁盘状态来接收SMART数据，请转到同名的选项卡。</font></font><br>
<br>
<img src="https://habrastorage.org/files/972/633/2f8/9726332f81f54e4fbcc01c31ebf99db3.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
选中“启用”复选框，选择“待机”电源模式（以免在待机模式下干扰硬盘驱动器）并保存更改。还可以配置警报。现在，您可以在“诊断”-&gt;“信息”-&gt;“ SMART”部分中查看每个驱动器的详细数据。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，两个驱动器都处于联机状态，所有系统都可以正常工作。但这仅仅是旅程的开始。让我们进入“ HDD Formatting”标签。正如我们在本文开头所同意的，我们将使用ZFS。选择两个驱动器，然后单击“下一步”：</font></font><br>
<br>
<img src="https://habrastorage.org/files/1eb/08e/72e/1eb08e72e4b5475d872eaa8975b111ae.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在下一步中，设置卷标-我选择了WDREZFS％1。 “％1”的结构表示我们格式化的磁盘将接收以1开头的序列号。也就是说，第一个将被命名为WDREZFS1，第二个将被命名为WDREZFS2，依此类推。如果未指定起点，请在不带数字的地方加上“％”符号，则系统本身将为HDD编号。您也可以按序列号命名。例如，“ [4”表示序列号的后四位将用作标签。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此外，如果您要构建复杂的多磁盘池，并计划将来添加新的驱动器，我强烈建议在“在GPT分区上创建ZFS”复选框上打钩。</font></font><br>
<br>
<img src="https://habrastorage.org/files/191/bd3/bc8/191bd3bc8f494c89b9eb38abd80c8890.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们格式化磁盘，等待操作完成，然后单击“确定”按钮。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在我们需要构建一个虚拟设备。转到“驱动器”-&gt;“ ZFS”-&gt;“池”-&gt;“虚拟设备”，单击蓝色加号，然后看到以下图片：</font></font><br>
<br>
<img src="https://habrastorage.org/files/90c/f28/391/90cf28391fee481b9fb04c0f94e72fb8.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这里，我们可以将磁盘收集到一个阵列中。我需要RAID-1的类似物，因此我选择了“镜像”（作为参考，“条带”与RAID-0基本相同）。确认选择后，不要忘记应用更改：</font></font><br>
<br>
<img src="https://habrastorage.org/files/8b0/b18/5c7/8b0b185c703c4208b4ae127141cc9b47.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，我们进入“ Pools”选项卡，并使用新创建的虚拟设备添加一个新的：</font></font><br>
<br>
<img src="https://habrastorage.org/files/44a/2ad/fa5/44a2adfa59424164917a37b8f5dc902d.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
只需输入一个名称，您无需配置其他任何内容。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
原则上，您已经可以开始上传文件，但是最好利用ZFS的主要优势-创建数据集的能力。实际上，它们是辅助文件系统，因此我们有机会为每个数据集选择一种压缩方法，设置访问权限和磁盘配额（这样可以消除您的视频收藏安全地吞噬文档的所有可用空间的情况），最重要的是-创建快照，使您几乎可以立即恢复丢失的信息。因此，让我们转到“数据集”并创建几个：</font></font><br>
<br>
<img src="https://habrastorage.org/files/89f/4e1/1be/89f4e11be0744aeda26a792ef9bf26dd.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在上面的屏幕快照中，唯一的池被选中-WDREP和压缩方法lzjb（效率和性能之间的折衷）。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重复数据删除</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使其保持关闭状态，因为其正常运行至少需要16 GB的RAM。该术语本身是指通过消除重复副本来压缩数据阵列的方法。例如，如果您定期创建大量信息的备份副本，而它们之间的差异很小，则它很有用。如果NAS仅充当电影，音乐，照片和其他媒体内容的存储角色，您将根本不会注意到复制的好处，这意味着您不应该在硬件上花费额外的钱。其余设置默认为保留。出于演示目的，唯一的事情是，我将在“可见性快照”前打勾-现在可以从其他设备上看到这些图片。在“保留空间”字段中，您可以指定数据集的最小保证体积，而“配额”则允许您设置上方的小节。您可以在下面选择用户并配置访问权限：</font></font><br>
<br>
<img src="https://habrastorage.org/files/6ec/2ba/9d4/6ec2ba9d4925465faa41e66dfb7f324f.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以相同的方式，您可以根据需要添加任意数量的数据集：</font></font><br>
<br>
<img src="https://habrastorage.org/files/466/fbd/283/466fbd2831a44e5a84b7745a1d27795f.JPG"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是时候上传文件了</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NAS可以全面运行，还需要教他如何与外界通信。</font><font style="vertical-align: inherit;">为此，该操作系统在“服务”菜单中为每种口味提供了一套非常令人印象深刻的工具。</font><font style="vertical-align: inherit;">您需要的取决于您- </font></font><br>
<br>
<img src="https://habrastorage.org/files/fba/8fa/c95/fba8fac9596241358493ce24f5630068.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自行</font><font style="vertical-align: inherit;">决定，现在我将限于基本的FTP设置：</font><font style="vertical-align: inherit;">不要忘记选中“启用”复选框（默认情况下，所有服务均处于禁用状态）。</font><font style="vertical-align: inherit;">客户端数量由将同时与存储设备联系的设备数量设置（3个与我有关）。</font><font style="vertical-align: inherit;">我建议保留连接数2。然后将在一个流中上载/下载文件，这将避免碎片并实现最大速度。</font><font style="vertical-align: inherit;">保存设置并尝试连接到NAS：</font></font><br>
<br>
<img src="https://habrastorage.org/files/052/afa/e33/052afae33a9942d9a619b994ea98ef44.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如您所见，池和数据集以目录形式显示，并显示.zfs目录，其中将保存快照。而且，在我看来，是时候更详细地讨论它们了。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
快照-整个池或所选数据集的快照。无需赘述，快照是备份空间的最快，最“便宜”的方式。当前，在WebGUI中实现的图像管理功能有所限制，但是它能够完全满足普通用户的需求。如果需要更多，则必须使用控制台。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NAS4Free支持手动和自动快照创建。要手动拍摄照片，请转到“ ZFS”选项卡-&gt;“快照”-&gt;“快照”，单击加号，指定路径（例如，我创建了Music数据集），并考虑未来照片的名称：</font></font><br>
<br>
<img src="https://habrastorage.org/files/7f9/b24/baa/7f9b24baa4654293b8c185dca3194338.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
“递归”列中的复选标记”意味着将创建“音乐”中所有子数据集的快照（如果有的话）。结果将如下所示：</font></font><br>
<br>
<img src="https://habrastorage.org/files/a55/41b/3fa/a5541b3fa5f54b359cae79e9825ddddc.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
是的，这不是错误-快照在数据集中的数据更改之前不会占用可用空间。例如，当您从“音乐”中删除mp3文件时，它会增长。可以在“自动快照”选项卡上自动执行快照过程。</font></font><br>
<br>
<img src="https://habrastorage.org/files/f4c/8b3/e4b/f4c8b3e4bdbf412a83c6072edce9cf48.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这里，除了上面讨论的设置之外，您还可以选择拍摄照片的时间及其存储时间。您无法在此处指定每日以外的其他类型（只能通过控制台来指定）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
好吧，假设您不小心删除了重要文件。如何恢复它们？这是通过创建克隆来完成的。让我们回到“快照”选项卡，然后单击快照前面的扳手图标。将出现以下窗口：</font></font><br>
<br>
<img src="https://habrastorage.org/files/526/7dd/131/5267dd131142459faee1659b7a207e56.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这里，您需要选择克隆将位于的路径。当然，它应该是唯一的，并且不重复数据集的名称。单击“运行”，然后通过FTP检查结果：</font></font><br>
<br>
<img src="https://habrastorage.org/files/ae5/e3e/771/ae5e3e77122a46cdb4a769a024e686a2.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如您所见，MusicSnap的克隆完全重复了原始数据集的内容。</font><font style="vertical-align: inherit;">现在，您可以从克隆中提取丢失的文件，然后将其复制回Music。</font><font style="vertical-align: inherit;">在克隆之后，可以在同一选项卡中删除：</font></font><br>
<br>
<img src="https://habrastorage.org/files/c50/efe/325/c50efe325b014a7f99d97c77428886d2.JPG"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后一点</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，即使主板缺乏ECC支持，基于几乎不可破坏的Western Digital Re的ZFS Mirror仍可让您创建具有相当可接受的可靠性的家用NAS。但是，所描述的系统存在一个弱点-闪存驱动器。除非使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工业芯片</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">否则不能将闪存称为可靠存储器</font><font style="vertical-align: inherit;">，但是NAS4Free提供了一种非常方便的机制来从头开始构建服务器。在“系统”-“保存/还原”部分中，您只需单击一下即可获得带有设置的XML文件：</font></font><br>
<br>
<img src="https://habrastorage.org/files/da2/325/19b/da232519b3b347d3b2773b3b171972cb.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可以选择使用密码加密。如果闪存驱动器发生故障，那么您所需要做的就是干净安装系统并从文件中恢复配置。所有先前创建的池和数据集以及存储的信息将再次可用。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实际上，仅此而已-家用NAS已准备就绪。</font><font style="vertical-align: inherit;">目前，上述程序集花费了我大约一个月的时间，在此期间，大约要消化500 GB的数据。</font><font style="vertical-align: inherit;">当然，这离磨损工作还很远，但是，存储设备运行正常，在此期间未发现任何问题。</font><font style="vertical-align: inherit;">现在，我将安排一些互动性：在注释中写下您想看到的NAS4Free功能，或您希望基于它实现的非标准解决方案。</font><font style="vertical-align: inherit;">例如，   </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dispi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对提高成熟的LAMP的可能性感兴趣-申请被接受，尽管我不保证在不久的将来发布。</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN397575/">https://habr.com/ru/post/zh-CN397575/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN397561/index.html">音频摘要9：有关声音，音乐和音频技术的博客</a></li>
<li><a href="../zh-CN397563/index.html">第四个尚存的玛雅手抄本《格罗利尔密码》的真实性得到了证明。</a></li>
<li><a href="../zh-CN397565/index.html">Lyft如何看待十年内的公路运输</a></li>
<li><a href="../zh-CN397567/index.html">在诺基亚贝尔实验室，他们通过光纤以1 Tbit / s的速度实现了数据传输</a></li>
<li><a href="../zh-CN397571/index.html">混合面料将阳光和机械能转化为电能</a></li>
<li><a href="../zh-CN397577/index.html">终结者，Bender，Dandy和Apple 2处理器：MOS 6502</a></li>
<li><a href="../zh-CN397579/index.html">意外的微处理器历史记录</a></li>
<li><a href="../zh-CN397581/index.html">现在踢！有了Kickstarter，未来更近了</a></li>
<li><a href="../zh-CN397583/index.html">一次意外的会议。第四章</a></li>
<li><a href="../zh-CN397585/index.html">“是的，你开车！” 超频者如何改变计算机行业</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>