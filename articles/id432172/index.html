<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèáüèº üôéüèΩ üëú Undangan berbahaya, atau Cara pertempuran memuat untuk email phishing üë§ üâê üßóüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Baru-baru ini, spesialis PT ESC menemukan dokumen format Penerbit yang disebut ‚ÄúUndangan 29-30 November, 2018.pub‚Äù (1edd5b6a02ec82cec381c1a1ec74a67e)....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Undangan berbahaya, atau Cara pertempuran memuat untuk email phishing</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/432172/"><img src="https://habrastorage.org/webt/hh/mj/f1/hhmjf18rranoihy6liikn8gvlq0.jpeg"><br><br>  Baru-baru ini, spesialis PT ESC menemukan dokumen format Penerbit yang disebut ‚ÄúUndangan 29-30 November, 2018.pub‚Äù (1edd5b6a02ec82cec381c1a1ec74a67e).  Dalam artikel ini, kami akan memberi tahu Anda bagaimana dokumen yang tampak biasa berubah menjadi trojan, memungkinkan penyerang untuk menangkap gambar dari webcam, merekam suara dengan perintah atau ketika jendela Skype terdeteksi, jalankan skrip PowerShell, ambil tangkapan layar, salin file dari perangkat media. <a name="habracut"></a><br><br>  Jadi, ketika Anda membuka dokumen, sebuah jendela muncul dengan tulisan rintisan buram dan permintaan untuk memasukkan skrip Microsoft Publisher. <br><br><img src="https://habrastorage.org/webt/6z/gx/0e/6zgx0evgnzve3k9tdrjtlkqhvhe.png"><br><br>  Setelah pengguna menyalakannya, skrip dibangun ke dalam dokumen berjalan dalam JavaScript.  Ini terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/wt/ig/pt/wtigptknnjdcp4noozibkmcisci.png"><br><br>  Hasil skrip akan menjadi decoding dari dua file, PDF dan EXE, dari Base64.  Kedua file akan ditulis ke C: \ Users \ {Username} \ AppData \ Roaming \ DBFUpdate.  Dengan demikian, kedua file akan dieksekusi, dan pengguna akan melihat tulisan rintisan di layar dokumen: <br><br><img src="https://habrastorage.org/webt/oc/az/v_/ocazv_kws7t4hvkhq4r5jpqw6xi.png"><br><br><h2>  Pemburu Harta Karun RAT </h2><br>  Penyerang menggunakan RAT multi-modul dengan seperangkat fungsi besar yang menyediakan akses penuh ke mesin yang terinfeksi. <br><br>  Fitur Kode: <br><br><ol><li>  Sepenuhnya ditulis dalam C ++ dengan sejumlah besar konstruksi STL yang digunakan secara internal. </li><li>  Aplikasi meningkatkan perpustakaan, khususnya JSON dan Arsip. </li><li>  Fungsi debugging (lebih banyak pada bagian tentang stager). </li></ol><br><h2>  Trojan utama </h2><br>  Trojan utama diperbaiki pada mesin korban dan merupakan platform di mana modul jahat dimuat dari C2. <br><br>  Pertama, stager menginisialisasi direktori kerja, yang selanjutnya akan menyimpan informasi yang dikumpulkan oleh modul, utilitas yang diperlukan agar modul berfungsi, dll. <br><br><img src="https://habrastorage.org/webt/_h/qg/ba/_hqgbarp_rsej6ubiv1v8zuy32c.png"><br><br>  Di bawah ini adalah inisialisasi jalur untuk membuat direktori kerja: <br><br><img src="https://habrastorage.org/webt/78/tg/ot/78tgotzxv4jl_vrucszwktoaef4.png"><br><br>  Setelah direktori yang diperlukan dibuat, trojan utama mengumpulkan informasi tentang mesin yang terinfeksi dan mengirimkannya ke server kontrol. <br><br>  Troyan tertarik pada data tersebut: <br><br><ul><li>  pengidentifikasi versi OS di mana trojan utama berjalan; </li><li>  Bahasa antarmuka default </li><li>  Nomor versi utama dari OS Paket Layanan; </li><li>  nama komputer dan pengenal mesin (untuk perincian tentang cara mendapatkan pengenal mesin, lihat bagian pada protokol jaringan). </li></ul><br>  Ini adalah bagaimana informasi tentang mesin yang terinfeksi dikumpulkan: <br><br><img src="https://habrastorage.org/webt/0n/rn/xn/0nrnxnxdov8bp85g6dmlwzzvwzs.png"><br><br>  Selanjutnya, trojan utama diperbaiki pada mesin yang terinfeksi melalui modifikasi nilai dalam registri di HKCU \ Environment \ UserInitMprLogonScript.  Nama file yang dapat dieksekusi yang dialokasikan selama inisialisasi direktori kerja ditulis di sini, dalam hal ini sama dengan "DCTHOST.exe".  Metode ini <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dijelaskan di blog Hexacorn</a> , dan juga digunakan oleh APT28 dan grup Cobalt dalam ComDLLDroper mereka. <br><br><img src="https://habrastorage.org/webt/j3/tl/0g/j3tl0gm0n3zb3vzxfpps_abdgq0.png"><br><br>  Dan langkah terakhir dalam menginisialisasi trojan utama adalah menyalin file yang dapat dieksekusi dari lokasi saat ini ke direktori kerja dengan nama yang sama yang dipilih ketika direktori kerja diinisialisasi. <br><br>  Setelah trojan utama diinisialisasi, persiapan untuk menerima perintah dilakukan.  Modul Core ditambahkan ke daftar modul yang sedang berjalan, yang merupakan trojan utama.  Selanjutnya, sebuah perintah diluncurkan dari modul Core dengan identifier 0. Tidak ada implementasi dari perintah ini di modul utama, melainkan hanya sebuah rintisan.  Konstruktor objek modul Inti disajikan di bawah ini. <br><br><img src="https://habrastorage.org/webt/mi/hy/us/mihyuspzzqd5fwesqr1em7jyiqu.png"><br><br>  Pada akhirnya, dua utas dimulai.  Salah satu utas memulai penghitung waktu, yang bangun secara default setiap detik dan mencoba meminta perintah dari C2. <br><br><img src="https://habrastorage.org/webt/o9/53/um/o953um8yermaycyqre2jugxbzly.png"><br><br>  Streaming kedua memuat perpustakaan tambahan dan modul standar.  Perpustakaan, seperti modul, memiliki pengidentifikasi, tetapi tidak seperti modul, pengidentifikasi perpustakaan negatif, mulai dari -1, tumbuh menuju angka yang lebih rendah.  Di bawah ini adalah daftar perpustakaan yang diunduh dari C2. <br><br><img src="https://habrastorage.org/webt/8n/bl/pj/8nblpjayad6etstkkqxvwtaplts.png"><br><br><h2>  Fitur debugging dari trojan utama </h2><br>  Pada awal pekerjaannya, segera setelah inisialisasi, trojan utama menetapkan penangan pengecualian melalui SetUnhandledExceptionFilter, yang berisi fungsionalitas yang menarik.  Ketika pengecualian terjadi, mereka jatuh ke dalam handler, yang menulis minidump aplikasi, sementara juga menyimpan informasi tentang pengecualian.  Kemudian restart sendiri.  Di layar - membuat minidump: <br><br><img src="https://habrastorage.org/webt/1w/sw/3j/1wsw3jy1hd8wpgcvfw0yliwt_yy.png"><br><br><h2>  Protokol jaringan </h2><br>  Pertukaran antara perangkat lunak dan C2 berlangsung menggunakan protokol biner yang ditulis sendiri.  Setiap pesan dideskripsikan menggunakan BinPackage (nama diambil dari RTTI).  Setiap BinPackage pada dasarnya adalah pembungkus di atas std :: vector, yang menyimpan set PackageRecord (namanya diciptakan).  PackageRecord adalah unit minimum untuk menyimpan data. <br><br><pre><code class="bash hljs">struct PackageRecord { _DWORD dataId; _DWORD datatype; _DWORD szData; char[] data; };</code> </pre> <br>  Lebih lanjut tentang bidang struktur ini: <br><br><ul><li>  <b>dataId</b> - menunjukkan jenis catatan.  Entah entri tersebut adalah pengidentifikasi modul, atau pengidentifikasi perintah, atau muatan. </li><li>  <b>szData</b> - ukuran data yang disimpan dalam catatan. </li><li>  <b>datatype</b> adalah <b>tipe</b> data. </li></ul><br>  Secara total, penggunaan tiga tipe data dicatat: <br><ul><li>  Nilai "0" berarti bahwa data yang disimpan dalam catatan harus ditafsirkan sebagai DWORD. </li><li>  Nilai "1" - data yang disimpan dalam catatan harus ditafsirkan sebagai string ASCIIZ. </li><li>  Nilai "2" - data yang disimpan dalam catatan harus ditafsirkan sebagai data terenkripsi / buffer mentah. </li></ul><br><br>  Saat mengirim BinPackage ke server kontrol, pengenal mesin ditambahkan ke dalamnya.  Identifier adalah GUID dari bagian dari mana semua karakter khusus dipotong.  Pada gambar - mendapatkan pengenal mesin: <br><br><img src="https://habrastorage.org/webt/iw/kn/le/iwknleyhgrfk7tfu2fxiggdx_7w.png"><br><br>  Sebelum mengirim, semua catatan yang disimpan di BinPackage dikumpulkan secara berurutan dalam satu buffer dan dienkripsi.  Untuk enkripsi, perpustakaan <a href="">WinAES digunakan</a> , khususnya AES-128-CBC. <br><br>  Menggunakan CryptoAPI Windows, dua pseudo-random array 16-byte dihasilkan.  Satu untuk IV, yang lain untuk kuncinya.  Enkripsi dilakukan dan data terenkripsi ditambahkan kembali ke BinPackage, yang berisi paket terenkripsi dan terdiri dari tiga entri: <br><br><ul><li>  rekam dengan ID 0x777 - berisi kunci yang digunakan untuk enkripsi; </li><li>  catatan dengan ID 0x555 - berisi IV yang digunakan untuk enkripsi; </li><li>  catatan dengan ID 0x999 - berisi data terenkripsi (secara umum, catatan dengan ID ini menunjukkan muatan dan digunakan tidak hanya untuk menyimpan data terenkripsi). </li></ul><br>  Setelah proses enkripsi selesai, BinPackage yang dihasilkan dikumpulkan lagi dalam satu buffer dan dikirim melalui permintaan HTTP POST ke server pengelola 151.80.2.237.222. <br><br><img src="https://habrastorage.org/webt/zj/8b/dd/zj8bdd1d7hlb1ozmxarkmmkf60q.png"><br><br>  Di bawah ini adalah contoh dari paket yang berisi informasi mesin: <br><br><img src="https://habrastorage.org/webt/ma/gu/du/magudufvut9bwna3qk9g8atebju.png"><br><br>  Dan ini adalah contoh paket terenkripsi dengan informasi sistem: <br><br><img src="https://habrastorage.org/webt/tv/rm/0s/tvrm0sniivu5dxahli4lfnsnfwa.png"><br><br><h2>  Modul </h2><br>  Setiap modul, kecuali Core, dimuat dari server kontrol.  Semua modul dapat dibagi menjadi dua kategori - modul yang dimuat secara otomatis, dan modul yang dimuat berdasarkan permintaan dari server kontrol. <br><br>  Contoh paket yang meminta modul: <br><br><img src="https://habrastorage.org/webt/zw/_o/mw/zw_omw8mqjoa74a0gouuylkgnk8.png"><br><br>  Respons terhadap permintaan modul: <br><br><img src="https://habrastorage.org/webt/9u/2g/qc/9u2gqcvb1mhw4kuky3fl6f1zljq.png"><br><br>  Setiap modul memiliki antarmuka sederhana yang terdiri dari tiga fungsi: dipanggil saat memuat modul Init, dipanggil setelah penyelesaian fini, dan fungsi yang mengubah konfigurasi modul.  Setiap modul juga memiliki ekspor bernama GetModule, yang membangun objek yang mewakili modul ini dan mengembalikannya ke trojan utama.  Semua modul yang kami temukan diluncurkan dalam memori menggunakan pemuatan reflektif. <br><br><img src="https://habrastorage.org/webt/p7/rz/qk/p7rzqkvwrfbybtduak7hfttchgy.png"><br><br>  Selanjutnya, nama-nama modul diberikan dalam bentuk di mana mereka hadir dalam RTTI sebagai nama kelas. <br><br><h2>  Modul CCore </h2><br>  Modul ini mewakili fungsi dasar dan dibangun langsung ke trojan utama.  Konstruktornya dapat dilihat pada tabel di bawah ini: <br><table><tbody><tr><th width="100">  Modul id </th><th width="100">  ID tim </th><th>  Deskripsi </th></tr><tr><td rowspan="6">  0 </td><td>  0 </td><td>  Pada dasarnya, trojan bukan perintah adalah sebuah rintisan, dan tujuan pastinya tidak dapat ditetapkan </td></tr><tr><td>  1 </td><td>  Ubah konfigurasi modul </td></tr><tr><td>  2 </td><td>  Minta informasi komputer </td></tr><tr><td>  3 </td><td>  Unduh utilitas dari server kontrol </td></tr><tr><td>  4 </td><td>  Minta daftar direktori yang berisi utilitas </td></tr><tr><td>  5 </td><td>  Unduh modul dan jalankan </td></tr></tbody></table><br><h2>  Modul CShell </h2><br>  Modul ini menyediakan shell jarak jauh ke mesin yang terinfeksi.  Ketika modul diinisialisasi, proses cmd.exe dibuat, di mana dua pipa terpasang: satu untuk input standar dan satu untuk output standar, di mana perintah diterima dan dikirim dari server kontrol dan sebaliknya.  Juga pada saat ini, utas dimulai, yang secara otomatis mengambil semua output dan mengirimkannya ke server kontrol.  Gambar tersebut menunjukkan inisialisasi modul CShell. <br><br><img src="https://habrastorage.org/webt/73/g3/6v/73g36vgr-tbimku5nrr-x1r8l1u.png"><br><table><tbody><tr><th width="100">  Modul id </th><th width="100">  ID tim </th><th>  Deskripsi </th></tr><tr><td rowspan="4">  2 </td><td>  0 </td><td>  Kirim perintah ke shell </td></tr><tr><td>  1 </td><td>  Cetak file.  File dibaca, jalur yang ditransmisikan dari server kontrol, dan konten file ini diunggah ke server kontrol </td></tr><tr><td>  2 </td><td>  Dapatkan daftar semua drive yang ada di sistem.  Data dikirim ke server kontrol dalam format JSON </td></tr><tr><td>  3 </td><td>  Unduh file dari server kontrol.  Jalur tempat menyimpan file, dan data diterima dari server kontrol </td></tr></tbody></table><br><h2>  Modul CFileSystemBrowser </h2><br>  Ini adalah modul pasif, yang atas permintaan memungkinkan Anda menerima informasi tentang struktur sistem file.  Ini adalah bagaimana inisialisasi modul CFileSystemBrowser terjadi: <br><br><img src="https://habrastorage.org/webt/sm/as/pn/smaspn0xpx9jmukbwfsupllke88.png"><br><table><tbody><tr><th width="100">  Modul id </th><th width="100">  ID tim </th><th>  Deskripsi </th></tr><tr><td rowspan="4">  3 </td><td>  0 </td><td>  Dapatkan daftar semua disk yang ada di sistem.  Data dikirim ke C2 dalam format JSON </td></tr><tr><td>  1 </td><td>  Dapatkan daftar direktori.  Daftar dihasilkan dalam format JSON </td></tr><tr><td>  2 </td><td>  Cetak file.  File dibaca, jalur yang ditransfer dari C2, dan konten file ini diunggah ke C2 </td></tr><tr><td>  3 </td><td>  Hapus file.  Jalur ke file ditransfer dari C2 </td></tr></tbody></table><br><h2>  Modul CScreenShot </h2><br>  Modul ini memungkinkan Anda untuk mengambil tangkapan layar atau mengambil gambar dari webcam.  Ini dapat melakukan ini baik berdasarkan permintaan dan dengan periode waktu tertentu. <br><img src="https://habrastorage.org/webt/nw/km/qg/nwkmqgynrgbuywc05kwjrvkq1ye.png"><br><table><tbody><tr><th width="100">  Modul id </th><th width="100">  ID tim </th><th>  Deskripsi </th></tr><tr><td rowspan="4">  4 </td><td>  0 </td><td>  Ambil tangkapan layar dan kirimkan ke server kontrol </td></tr><tr><td>  1 </td><td>  Jalankan penghitung waktu, setelah itu tangkapan layar diambil dari layar mesin.  Tangkapan layar yang dihasilkan dikemas dalam BinPackage dan disimpan ke folder log.  Nama untuk file dihasilkan menggunakan API GetTempFileName dengan awalan "MS_". </td></tr><tr><td>  2 </td><td>  Dapatkan video perangkat yang tersedia di mesin yang terinfeksi </td></tr><tr><td>  3 </td><td>  Ambil bingkai dari webcam dan kirimkan ke server kontrol </td></tr></tbody></table><br><h2>  Modul CSender </h2><br>  Modul ini awalnya tidak diaktifkan.  Itu mengunggah isi folder log ke server kontrol.  Itu diaktifkan ketika permintaan datang untuk mengubah konfigurasi, yang berisi periode verifikasi. <br><br><img src="https://habrastorage.org/webt/wd/64/0e/wd640e65m5umn66eyqrg1vuwolu.png"><br><br><h2>  Modul CKeylogger </h2><br>  Modul ini pada awalnya juga tidak diaktifkan.  Ini diaktifkan ketika permintaan untuk perubahan konfigurasi tiba yang berisi ukuran buffer di mana log disimpan.  Intersepsi input dilakukan melalui <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">input mentah</a> .  Selain itu, keylogger memonitor jendela di mana pengguna membuat input dan mencatat judulnya. <br><br><img src="https://habrastorage.org/webt/wu/ek/r6/wuekr6dftcwhuubqmce3h5n49vg.png"><br><br><h2>  Modul CDictaphone </h2><br>  Modul ini merekam suara dengan perintah atau saat mendeteksi jendela Skype.  Ketika diluncurkan, ia memulai utas yang mencantumkan semua jendela dan jendela anak mereka di sistem dan mencari jendela di antara kelas-kelas yang nama kelasnya adalah TLiveConversation atau TCallMonitorControl.  Jika jendela seperti itu ditemukan, perekaman dimulai.  Di bawah ini adalah inisialisasi modul CDictaphone: <br><br><img src="https://habrastorage.org/webt/y7/kq/e0/y7kqe0xqb1lytearyqn--ojslpu.png"><br><br>  Dan pencarian jendela Skype <br><br><img src="https://habrastorage.org/webt/6j/49/br/6j49brec889qzpw8hqqd0mjo-5g.png"><br><br>  Perekaman dilakukan melalui MCI dengan mengirimkan perintah khusus.  Ini adalah bagaimana siklus menulis modul CDictaphone terlihat: <br><br><img src="https://habrastorage.org/webt/nh/ef/zk/nhefzkr0smgjs0xpnabh9oglqzy.png"><br><br>  Setelah menutup jendela atau menerima perintah untuk menyelesaikan rekaman, data yang diterima disimpan dalam folder sementara, setelah itu dikodekan oleh MP3 encoder lame (dianggap sebagai utilitas dan harus sudah dimuat, itu tidak mungkin untuk mendapatkannya dari server kontrol).  File yang disandikan disimpan di folder log.  Membuat nama folder mirip dengan membuat nama untuk tangkapan layar. <br><table><tbody><tr><th width="100">  Modul id </th><th width="100">  ID tim </th><th>  Deskripsi </th></tr><tr><td rowspan="3">  7 </td><td>  0 </td><td>  Mulai merekam dan menyelesaikannya setelah 15 menit </td></tr><tr><td>  1 </td><td>  Hentikan rekaman </td></tr><tr><td>  2 </td><td>  Periksa status: sedang merekam sedang berlangsung </td></tr></tbody></table><br><h2>  Modul Manajer Proses </h2><br>  Ini adalah modul pasif, yang mampu mengembalikan daftar proses berdasarkan permintaan atau diakhiri oleh PID yang diteruskan kepadanya. <br><br><img src="https://habrastorage.org/webt/us/if/sf/usifsfffgu9i_sfbbus6xc5_ch4.png"><br><table><tbody><tr><th width="100">  Modul id </th><th width="100">  ID tim </th><th>  Deskripsi </th></tr><tr><td rowspan="2">  8 </td><td>  0 </td><td>  Mengembalikan daftar proses: nama mereka, PID, dan nama pengguna yang memiliki proses. </td></tr><tr><td>  1 </td><td>  Selesainya proses PID </td></tr></tbody></table><br><h2>  Modul Pengunduh CD </h2><br>  Modul ini dirancang untuk mengunggah file besar ke server kontrol.  Melakukan transmisi data dengan potongan, yang ukurannya ditentukan oleh konfigurasinya.  Modul membaca data dari file, jalur yang diterimanya dari server kontrol, dan paket potongan di BinPackage.  Untuk setiap BinPackage yang berisi chunk, entri dengan pengenal 0x888 ditambahkan, termasuk jalur ke file.  Setelah melewati setiap chunk, tidur dilakukan selama 5 detik. <br><img src="https://habrastorage.org/webt/ch/-1/wj/ch-1wjtsdqiwbglodlmf25cp3om.png"><br><table><tbody><tr><th width="100">  Modul id </th><th width="100">  ID tim </th><th>  Deskripsi </th></tr><tr><td rowspan="3">  9 </td><td>  0 </td><td>  Stub, gagal menetapkan nilai yang tepat </td></tr><tr><td>  1 </td><td>  Melakukan transfer sejumlah besar data (0x500000 byte), setelah itu mengukur waktu yang dihabiskan untuk transfer, dan mengirimkan nilai ini ke C2 </td></tr><tr><td>  2 </td><td>  Unduh file dari mesin </td></tr></tbody></table><br><h2>  Modul CPS </h2><br>  Modul ini memungkinkan Anda untuk menjalankan skrip PowerShell. <br><br><img src="https://habrastorage.org/webt/ua/nn/vn/uannvn5wtvk7p2jnfaz6exur2ia.png"><br><table><tbody><tr><th width="100">  Modul id </th><th width="100">  ID tim </th><th>  Deskripsi </th></tr><tr><td>  10 </td><td>  0 </td><td>  Menerima skrip PowerShell dari C2 dan menjalankannya </td></tr></tbody></table><br><h2>  Modul CDeviceMonitor </h2><br>  Modul pasif yang memonitor perangkat media yang terhubung dan menyalin file dari mereka.  Ini menggunakan pesan siaran WM_DEVICECHANGE untuk mendeteksi konektivitas perangkat.  Setelah menghubungkan perangkat ke server kontrol, informasi dikirim tentang kapan perangkat terhubung, label volumenya dan jalur ke perangkat.  Kode yang digunakan untuk mendapatkan jalur ke perangkat sangat mirip dengan ini.  Semua file disalin ke folder log.  Nama dibuat dengan cara yang sama seperti untuk tangkapan layar.  File fsIndex.dat dibuat secara terpisah, di mana kamus bersambung dengan boost :: archive berada.  Kamus ini menyimpan jalur asli ke file yang disalin, dan hash MD5 mereka.  Di bawah ini adalah tanda terima dari DevicePath: <br><br><img src="https://habrastorage.org/webt/3y/k0/ap/3yk0apdk8elf3rhhjqnsako0zne.png"><br><br>  Sebagai epilog, beberapa rekomendasi: <br><br><ul><li>  Tidak perlu membuka lampiran dalam surat dari penerima yang tidak dikenal, apalagi menyertakan skrip Microsoft Publisher. </li><li>  Tidak kalah berbahaya untuk mengklik tautan dalam surat dari pengirim yang tidak dikenal.  Situs tujuan Anda dapat meng-host malware yang secara otomatis akan mengunduh ke PC Anda. </li><li>  Anda harus secara teratur memperbarui perangkat lunak, terutama Microsoft Windows dan Microsoft Office, yang akan menutup akses ke berbagai malware. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id432172/">https://habr.com/ru/post/id432172/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id432160/index.html">Video dari Android Kolesa Mobile: tentang pengembangan modular, UI yang digerakkan oleh backend dan integrasi berkelanjutan</a></li>
<li><a href="../id432162/index.html">‚ÄúKami mencoba untuk memberikan kisah kehidupan nyata‚Äù: tentang program Heisenbug 2018 Moscow</a></li>
<li><a href="../id432166/index.html">Apache NiFi: apa itu dan gambaran umum singkat fitur-fiturnya</a></li>
<li><a href="../id432168/index.html">Otoritas Tiongkok mengumpulkan informasi dari kendaraan listrik warga negara</a></li>
<li><a href="../id432170/index.html">Transport pusat data dalam 14.400 detik</a></li>
<li><a href="../id432174/index.html">Bagaimana mengembangkan produk perangkat lunak secara kompeten dan efektif</a></li>
<li><a href="../id432176/index.html">Bagaimana kami menggandakan kecepatan bekerja dengan Float di Mono</a></li>
<li><a href="../id432178/index.html">... dan jaminan untuk proyektor - meningkat</a></li>
<li><a href="../id432180/index.html">Cara memompa karir Anda melalui GitHub</a></li>
<li><a href="../id432182/index.html">Kami mengambil surat tanpa sms dan registrasi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>