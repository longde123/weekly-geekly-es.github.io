<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚¨ÖÔ∏è üë©‚Äçüî¨ üéç MSVC-Backend-Updates in Visual Studio 2019 Vorschau 2: Neue Optimierungen, OpenMP- und Build-Durchsatzverbesserungen ‚ÜîÔ∏è üë¶üèΩ üßñüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In Visual Studio 2019 Preview 2 haben wir das C ++ - Backend mit neuen Funktionen, neuen und verbesserten Optimierungen, Verbesserungen des Build-Durc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MSVC-Backend-Updates in Visual Studio 2019 Vorschau 2: Neue Optimierungen, OpenMP- und Build-Durchsatzverbesserungen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/microsoft/blog/437670/"><img width="140" align="left" src="https://habrastorage.org/webt/gq/ke/xi/gqkexi_dekwffzpjqtx04zp7ee8.png"><br><p>  In Visual Studio 2019 Preview 2 haben wir das C ++ - Backend mit neuen Funktionen, neuen und verbesserten Optimierungen, Verbesserungen des Build-Durchsatzes und √Ñnderungen der Lebensqualit√§t weiter verbessert. </p><a name="habracut"></a><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Original im Blog</a> <br><br><h3>  Neue Funktionen </h3><br><ul><li>  Ein neuer Inlining-Befehlszeilenschalter wurde hinzugef√ºgt: -Ob3.  -Ob3 ist eine aggressivere Version von -Ob2.  -O2 (die Bin√§rdatei f√ºr die Geschwindigkeit optimieren) impliziert standardm√§√üig weiterhin -Ob2, dies kann sich jedoch in Zukunft √§ndern.  Wenn Sie feststellen, dass der Compiler nicht ausreichend inline ist, sollten Sie -O2 -Ob3 √ºbergeben. </li><li>  Grundlegende Unterst√ºtzung f√ºr die OpenMP-SIMD-Vektorisierung hinzugef√ºgt, die die am h√§ufigsten verwendete OpenMP-Funktion in ML-Bibliotheken (Machine Learning) ist.  Unsere Fallstudie ist die Intel MKL-DNN-Bibliothek, die als Baustein f√ºr andere bekannte Open-Source-ML-Bibliotheken einschlie√ülich Tensor Flow verwendet wird.  Dies kann mit einem neuen CL-Schalter -openmp: experimentell aktiviert werden.  Dadurch k√∂nnen mit "#pragma omp simd" annotierte Schleifen m√∂glicherweise vektorisiert werden.  Die Vektorisierung ist nicht garantiert, und kommentierte, aber nicht vektorisierte Schleifen erhalten eine Warnung.  Es werden keine SIMD-Klauseln unterst√ºtzt. Sie werden einfach ignoriert, wenn eine Warnung gemeldet wird. </li><li>  Es wurde ein neuer C ++ - Ausnahmebehandler __CxxFrameHandler4 hinzugef√ºgt, der den Metadatenaufwand f√ºr die Ausnahmebehandlung um 66% reduziert.  Dies bietet eine Verbesserung der Bin√§rgr√∂√üe um bis zu 15% gegen√ºber Bin√§rdateien, die gro√üe Mengen an C ++ - Ausnahmebehandlung verwenden.  Probieren Sie es aus, indem Sie beim Kompilieren mit cl.exe "/ d2FH4" √ºbergeben.  Beachten Sie, dass / d2FH4 ansonsten nicht dokumentiert ist und langfristig nicht unterst√ºtzt wird.  Dies wird derzeit in UWP-Apps nicht unterst√ºtzt, da die UWP-Laufzeit noch nicht √ºber diese Funktion verf√ºgt. </li><li>  Um die Handvektorisierung von Schleifen zu unterst√ºtzen, die Aufrufe von Funktionen der Mathematikbibliothek und bestimmte andere Operationen wie die Ganzzahldivision enthalten, unterst√ºtzt MSVC jetzt die intrinsischen Funktionen der Short Vector Math Library (SVML), die die Vektor√§quivalente berechnen.  Die meisten Funktionen werden von 128-Bit-, 256-Bit- und 512-Bit-Vektoren unterst√ºtzt, mit den unten aufgef√ºhrten Ausnahmen.  Beachten Sie, dass diese Funktionen errno nicht setzen.  Definitionen der unterst√ºtzten Funktionen finden Sie im Intel Intrinsic Guide. <br>  Ausnahmen sind: <br><ul><li>  Die kombinierte Division und der Rest von Vektor-Ganzzahlen sind nur f√ºr 32-Bit-Elemente und 128-Bit- und 256-Bit-Vektorl√§ngen verf√ºgbar.  Verwenden Sie separate Teilungs- und Restfunktionen f√ºr andere Elementgr√∂√üen und Vektorl√§ngen. </li><li>  Die SVML-Quadratwurzel ist nur in 128-Bit- und 256-Bit-Vektorl√§ngen verf√ºgbar.  Sie k√∂nnen die Funktionen <em>_mm512_sqrt_pd</em> oder <em>_mm512_sqrt_ps</em> f√ºr 512-Bit-Vektoren verwenden. </li><li>  Es sind nur 512-Bit-Vektorversionen von <em>Rint-</em> und <em>Nearintintint-</em> Funktionen verf√ºgbar.  In vielen F√§llen k√∂nnen Sie stattdessen runde Funktionen verwenden, z. B. <em>_mm256_round_ps (x, _MM_FROUND_CUR_DIRECTION)</em> als 256-Bit-Vektorversion von <em>rint</em> oder <em>_mm256_round_ps (x, _MM_FROUND_TO_NEAREST_INT)</em> f√ºr <em>nearint</em> . </li><li>  Es wird nur ein 512-Bit-Kehrwert bereitgestellt.  Sie k√∂nnen das √Ñquivalent mit den Funktionen set1 und div berechnen, z. B. k√∂nnte der 256-Bit-Kehrwert als <em>_mm256_div_ps (_mm256_set1_ps (1.0f), (x))</em> berechnet werden. </li><li>  Es gibt SVML-Funktionen f√ºr komplexe Quadratwurzel, Logarithmus und Exponentiation mit einfacher Genauigkeit nur in 128-Bit- und 256-Bit-Vektorl√§ngen. </li></ul></li></ul><br><h3>  Neue und verbesserte Optimierungen </h3><br><ul><li>  Abgerollte Memsets und Blockinitialisierungen verwenden jetzt SSE2-Anweisungen (oder AVX-Anweisungen, falls zul√§ssig).  Der Gr√∂√üenschwellenwert f√ºr das, was abgewickelt wird, hat sich entsprechend erh√∂ht (Kompilieren f√ºr Gr√∂√üe mit SSE2: Schwellenwert f√ºr Abrollen von 31 auf 63 Byte, Kompilieren f√ºr Geschwindigkeit mit SSE2: Schwellenwert von 79 auf 159 Byte). </li><li>  Das Code-Gen wurde f√ºr kleine Memsets optimiert, die haupts√§chlich auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">initial gesch√ºtzte</a> Funktionen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">abzielen</a> . </li><li>  Verbesserungen bei der Beseitigung redundanter Speicher durch den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SSA Optimizer</a> : Bessere Escape-Analyse und Handhabung von Schleifen </li><li>  Der Compiler erkennt memmove () als intrinsische Funktion und optimiert entsprechend.  Dies verbessert die Codegenerierung f√ºr Operationen, die auf memmove () basieren, einschlie√ülich std :: copy () und anderem √ºbergeordneten Bibliothekscode wie std :: vector und std :: string </li><li>  Der Optimierer kann kurze memmove () -, memcpy () - und memcmp () -Operationen mit fester L√§nge besser optimieren. </li><li>  Implementierung der Optimierung der Switch-Duplizierung f√ºr eine bessere Leistung der Switches in Hot Loops.  Wir haben die Switch-Jumps dupliziert, um die Genauigkeit der Verzweigungsvorhersage und damit die Laufzeitleistung zu verbessern. </li><li>  Konstante Faltung und arithmetische Vereinfachungen f√ºr Ausdr√ºcke unter Verwendung von SIMD (Vektor) intrinsisch hinzugef√ºgt, sowohl f√ºr Float- als auch f√ºr Integer-Formen.  Die meisten der √ºblichen Ausdrucksoptimierungen verarbeiten jetzt SSE2- und AVX2-Eigenheiten, entweder aus Benutzercode oder als Ergebnis einer automatischen Vektorisierung. </li><li> Mehrere neue FMA-Muster (Scalar Fused Multiply Add) sind mit / arch: AVX2 / fp: fast gekennzeichnet.  Dazu geh√∂ren die folgenden allgemeinen Ausdr√ºcke: <code>(x + 1.0) * y; (x ‚Äì 1.0) * y; (1.0 ‚Äì x) * y; (-1.0 ‚Äì x) * y</code> <code>(x + 1.0) * y; (x ‚Äì 1.0) * y; (1.0 ‚Äì x) * y; (-1.0 ‚Äì x) * y</code> </li><li>  Codesequenzen, die einen __m128 SIMD (Vektor) -Wert Element f√ºr Element initialisieren, werden identifiziert und durch ein intrinsisches <em>_mm_set_ps ersetzt</em> .  Dadurch k√∂nnen die neuen SIMD-Optimierungen den Wert als Teil von Ausdr√ºcken betrachten. Dies ist insbesondere dann n√ºtzlich, wenn der Wert nur konstante Elemente enth√§lt.  Ein zuk√ºnftiges Update wird mehr Werttypen unterst√ºtzen. </li><li>  Common Sub-Expression Elimination (CSE) ist effektiver, wenn Variablen vorhanden sind, die auf indirekte Weise ge√§ndert werden k√∂nnen, weil ihre Adresse √ºbernommen wurde. </li><li>  In mehreren weiteren F√§llen werden nutzlose Struktur- / Klassenkopien entfernt, einschlie√ülich Kopien f√ºr Ausgabeparameter und Funktionen, die ein Objekt zur√ºckgeben.  Diese Optimierung ist besonders effektiv in C ++ - Programmen, die Objekte nach Wert √ºbergeben. </li><li>  Es wurde eine leistungsf√§higere Analyse zum Extrahieren von Informationen √ºber Variablen aus dem Kontrollfluss (if / else / switch-Anweisungen) hinzugef√ºgt, mit der Verzweigungen entfernt werden, die sich als immer wahr oder falsch erweisen k√∂nnen, und um die Sch√§tzung des Variablenbereichs zu verbessern.  Code, der gsl :: span verwendet, weist Verbesserungen auf. Einige unn√∂tige Bereichspr√ºfungen werden jetzt entfernt. </li><li>  Die Optimierung der Devirtualisierung bietet jetzt zus√§tzliche M√∂glichkeiten, z. B. wenn Klassen in anonymen Namespaces definiert werden. </li></ul><br><h3>  Durchsatzverbesserungen erstellen </h3><br><ul><li>  Filtern Sie Debug-Informationen w√§hrend der Kompilierung anhand der Symbole und Typen, auf die verwiesen wird, um die Gr√∂√üe des Debug-Abschnitts zu verringern und den Linker-Durchsatz zu verbessern.  Durch das Aktualisieren von 15.9 auf 16.0 kann die Eingabegr√∂√üe f√ºr den Linker um bis zu 40% reduziert werden. </li><li>  Verbesserungen der Verbindungszeit beim Zusammenf√ºhren und Erstellen von PDB-Typen. </li><li>  Durch die Aktualisierung von 15.9 auf 16.0 k√∂nnen die Verbindungszeiten um das Zweifache beschleunigt werden.  Das Verkn√ºpfen von Chrome f√ºhrte beispielsweise bei Verwendung von / DEBUG: full zu einer 1,75-fachen Beschleunigung der Verbindungszeit und bei Verwendung von / DEBUG: fastlink zu einer 1,4-fachen Beschleunigung der Verbindungszeit. </li></ul><br><h3>  Verbesserung der Lebensqualit√§t </h3><br><ul><li>  Der Compiler zeigt Dateinamen und Pfade unter Verwendung eines vom Benutzer bereitgestellten Geh√§uses an, wobei der Compiler zuvor Dateinamen und Pfade in Kleinbuchstaben angezeigt hat. </li><li>  Der neue Linker meldet nun potenziell √ºbereinstimmende Symbole f√ºr nicht aufgel√∂ste Symbole, wie z. </li></ul><br><pre> <code class="cpp hljs">main.obj : error LNK2019: unresolved external symbol _foo referenced in function _main Hint on symbols that are defined <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> could potentially match: <span class="hljs-string"><span class="hljs-string">"int __cdecl foo(int)"</span></span> (?foo@@YAHH@Z) <span class="hljs-string"><span class="hljs-string">"bool __cdecl foo(double)"</span></span> (?foo@@YA_NN@Z) @foo@<span class="hljs-number"><span class="hljs-number">0</span></span> foo@@<span class="hljs-number"><span class="hljs-number">4</span></span> main.exe : fatal error LNK1120: <span class="hljs-number"><span class="hljs-number">1</span></span> unresolved externals</code> </pre> <ul><li>  Beim Generieren einer statischen Bibliothek muss das Flag / LTCG nicht mehr an LIB.exe √ºbergeben werden. </li><li>  Linker-Option / LINKREPROTARGET: [Bin√§rname] hinzugef√ºgt, um nur einen Link-Repro f√ºr die angegebene Bin√§rdatei zu generieren.  Dadurch k√∂nnen% LINK_REPRO% oder / LINKREPRO: [Verzeichnisname] in einem gro√üen Build mit mehreren Verkn√ºpfungen festgelegt werden, und der Linker generiert nur den Repro f√ºr die in / linkreprotarget angegebene Bin√§rdatei. </li></ul><br><p>  Wir w√ºrden uns freuen, wenn Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Visual Studio 2019 herunterladen</a> und ausprobieren.  Wie immer freuen wir uns √ºber Ihr Feedback.  Sie erreichen uns √ºber die folgenden Kommentare oder per E-Mail ( <a href="">visualcpp@microsoft.com</a> ).  Wenn Sie Probleme mit Visual Studio oder MSVC haben oder einen Vorschlag f√ºr uns haben, teilen Sie uns dies bitte √ºber <strong>Hilfe&gt; Feedback senden&gt; Problem melden / Vorschlag</strong> im Produkt oder √ºber die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Entwickler-Community mit</a> .  Sie finden uns auch auf Twitter ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">@VisualC</a> ) und Facebook (msftvisualcpp). </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de437670/">https://habr.com/ru/post/de437670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de437656/index.html">Elefant in einem Porzellanladen: 3D-Drucker mit einem riesigen Druckfeld</a></li>
<li><a href="../de437658/index.html">Anleitung: Thymeleaf + Spring. Teil 3</a></li>
<li><a href="../de437660/index.html">Aktualisierung des Lebenszeitprofils in Visual Studio 2019 Vorschau 2</a></li>
<li><a href="../de437664/index.html">Zusammengesetzte R√ºckgewinnung</a></li>
<li><a href="../de437666/index.html">Ank√ºndigung der F # 4.6-Vorschau</a></li>
<li><a href="../de437672/index.html">cyberd: Berechnung des Wissens aus web3</a></li>
<li><a href="../de437674/index.html">3D-Objekterkennungsmethoden f√ºr unbemannte Fahrzeuge. Yandex-Bericht</a></li>
<li><a href="../de437676/index.html">Universit√§ten und Corporate Accelerators als Hebel f√ºr den Start eines B2B-Startups in den USA</a></li>
<li><a href="../de437680/index.html">Meine DIY-Sammlung auf Youtube</a></li>
<li><a href="../de437682/index.html">Schreiben eines weiteren Kubernetes-Template-Tools</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>