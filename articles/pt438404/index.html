<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüë©‚Äçüë¶‚Äçüë¶ üîÅ üßëüèø‚Äçü§ù‚Äçüßëüèø Pre√ßo da composi√ß√£o no mundo javascript üë®‚Äçüç≥ üì° ‚úÖ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A id√©ia de que, no desenvolvimento de qualquer l√≥gica de neg√≥cios mais ou menos complexa, seja dada prioridade √† composi√ß√£o de objetos, em vez de hera...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pre√ßo da composi√ß√£o no mundo javascript</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438404/"> A id√©ia de que, no desenvolvimento de qualquer l√≥gica de neg√≥cios mais ou menos complexa, seja dada prioridade √† composi√ß√£o de objetos, em vez de heran√ßa, √© popular entre os desenvolvedores de software de v√°rios tipos.  Na pr√≥xima onda de popularidade do paradigma de programa√ß√£o funcional lan√ßado pelo sucesso do ReactJS, as discuss√µes sobre os benef√≠cios das solu√ß√µes composicionais chegaram ao front end.  Neste post, h√° um pequeno layout nas prateleiras da teoria da composi√ß√£o de objetos em Javascript, um exemplo espec√≠fico, sua an√°lise e a resposta para a pergunta de quanto custa a eleg√¢ncia sem√¢ntica para o usu√°rio (spoiler: muito). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f30/874/502/f308745025666d09822337569aad1b1c.jpg" alt="V. Kandinsky - Composi√ß√£o X"><br>  <i>Vasily Kandinsky - "Composi√ß√£o X"</i> <br><a name="habracut"></a><br>  Anos de desenvolvimento bem-sucedido de uma abordagem orientada a objetos para o desenvolvimento, principalmente no campo acad√™mico, levaram a um desequil√≠brio vis√≠vel na mente do desenvolvedor m√©dio.  Portanto, na maioria dos casos, o primeiro pensamento, se necess√°rio, generalizar um comportamento para v√°rias entidades diversas √© criar uma classe pai e herdar esse comportamento.  Essa abordagem de abuso leva a v√°rios problemas que complicam o design e inibem o desenvolvimento. <br><br>  Primeiro, a classe base sobrecarregada de l√≥gica se torna <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fr√°gil</a> - uma pequena mudan√ßa em seus m√©todos pode afetar fatalmente as classes derivadas.  Uma maneira de contornar essa situa√ß√£o √© distribuir a l√≥gica entre v√°rias classes, criando uma hierarquia de heran√ßa mais complexa.  Nesse caso, o desenvolvedor recebe outro problema - a l√≥gica das classes pai √© duplicada nos herdeiros conforme necess√°rio, nos casos de interse√ß√£o entre a funcionalidade das classes pai, mas, o mais importante, n√£o √© completa. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/fc2/3fa/4ac/fc23fa4ac64d720585bded474be46303.png" alt="imagem"></a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">mail.mozilla.org/pipermail/es-discuss/2013-June/031614.html</a> <br><br>  E, finalmente, criando uma hierarquia bastante profunda, o usu√°rio, ao usar qualquer entidade, √© for√ßado a arrastar todos os seus ancestrais, juntamente com todas as suas depend√™ncias, independentemente de usar ou n√£o sua funcionalidade.  Esse problema de depend√™ncia excessiva do meio ambiente, com a m√£o leve de Joe Armstrong, criador de Erlang, foi chamado de problema do gorila e da banana: <br><br><blockquote>  Eu acho que a falta de reutiliza√ß√£o vem nas linguagens orientadas a objetos, n√£o nas linguagens funcionais.  Como o problema das linguagens orientadas a objetos √© que elas t√™m todo esse ambiente impl√≠cito que carregam consigo.  Voc√™ queria uma banana, mas o que conseguiu foi um gorila segurando a banana e toda a selva. </blockquote><br>  A composi√ß√£o dos objetos √© chamada para resolver todos esses problemas como uma alternativa √† heran√ßa de classes.  A id√©ia n√£o √© nova, mas n√£o encontra um entendimento completo entre os desenvolvedores.  A situa√ß√£o no mundo front-end √© um pouco melhor, onde a estrutura dos projetos de software geralmente √© bastante simples e n√£o estimula a cria√ß√£o de um esquema complexo de relacionamento orientado a objetos.  No entanto, seguir cegamente os conv√™nios da Gangue dos Quatro, recomendando que a composi√ß√£o seja preferida √† heran√ßa, tamb√©m pode representar um truque na sabedoria inspiradora dos grandes desenvolvedores. <br><br>  Transferindo defini√ß√µes de Design Patterns para o mundo din√¢mico do Javascript, podemos resumir tr√™s tipos de composi√ß√£o de objetos: <b>agrega√ß√£o</b> , <b>concatena√ß√£o</b> e <b>delega√ß√£o</b> .  Vale dizer que essa separa√ß√£o e o conceito de composi√ß√£o de objetos em geral t√™m natureza puramente t√©cnica, enquanto o significado desses termos tem interse√ß√µes, o que gera confus√£o.  Assim, por exemplo, a heran√ßa de classe em Javascript √© implementada com base na delega√ß√£o (heran√ßa de prot√≥tipo).  Portanto, √© melhor fazer backup de cada um dos casos com exemplos de c√≥digo ativo. <br><br>  <b>A agrega√ß√£o</b> √© uma uni√£o enumer√°vel de objetos, cada um dos quais pode ser obtido usando um identificador de acesso exclusivo.  Exemplos incluem matrizes, √°rvores, gr√°ficos.  Um bom exemplo do mundo do desenvolvimento web √© a √°rvore DOM.  A principal qualidade desse tipo de composi√ß√£o e o motivo de sua cria√ß√£o √© a capacidade de aplicar convenientemente algum manipulador a cada filho da composi√ß√£o. <br><br>  Um exemplo sint√©tico √© uma matriz de objetos que se revezam definindo um estilo para um elemento visual arbitr√°rio. <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> styles = [  { <span class="hljs-attr"><span class="hljs-attr">fontSize</span></span>: <span class="hljs-string"><span class="hljs-string">'12px'</span></span>, <span class="hljs-attr"><span class="hljs-attr">fontFamily</span></span>: <span class="hljs-string"><span class="hljs-string">'Arial'</span></span> },  { <span class="hljs-attr"><span class="hljs-attr">fontFamily</span></span>: <span class="hljs-string"><span class="hljs-string">'Verdana'</span></span>, <span class="hljs-attr"><span class="hljs-attr">fontStyle</span></span>: <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-attr"><span class="hljs-attr">fontWeight</span></span>: <span class="hljs-string"><span class="hljs-string">'bold'</span></span> },  { <span class="hljs-attr"><span class="hljs-attr">fontFamily</span></span>: <span class="hljs-string"><span class="hljs-string">'Tahoma'</span></span>, <span class="hljs-attr"><span class="hljs-attr">fontStyle</span></span>: <span class="hljs-string"><span class="hljs-string">'normal'</span></span>} ];</code> </pre> <br>  Cada um dos objetos de estilo pode ser extra√≠do por seu √≠ndice sem perda de informa√ß√µes.  Al√©m disso, usando Array.prototype.map (), voc√™ pode processar todos os valores armazenados de uma determinada maneira. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> getFontFamily = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">s</span></span></span><span class="hljs-function"> =&gt;</span></span> s.fontFamily; styles.map(getFontFamily) <span class="hljs-comment"><span class="hljs-comment">//["Arial","Verdana","Tahoma"]</span></span></code> </pre> <br>  <b>A concatena√ß√£o</b> envolve a expans√£o da funcionalidade de um objeto existente, adicionando novas propriedades a ele.  Assim, por exemplo, redutores de estado no Redux funcionam.  Os dados recebidos para atualiza√ß√£o s√£o gravados no objeto state, expandindo-o.  Os dados no estado atual do objeto, diferentemente da agrega√ß√£o, s√£o perdidos se n√£o forem salvos. <br><br>  Retornando ao exemplo, aplicando alternadamente as configura√ß√µes acima ao elemento visual, voc√™ pode gerar o resultado final concatenando os par√¢metros dos objetos. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> concatenate = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, s</span></span></span><span class="hljs-function">) =&gt;</span></span> ({‚Ä¶a, ‚Ä¶s}); styles.reduce(concatenate, {}) <span class="hljs-comment"><span class="hljs-comment">//{fontSize:"12px",fontFamily:"Tahoma",fontStyle:"normal",fontWeight:"bold"}</span></span></code> </pre> <br>  Valores de um estilo mais espec√≠fico acabar√£o substituindo estados anteriores. <br><br>  Ao <b>delegar</b> , como voc√™ pode imaginar, um objeto √© delegado para outro.  Delegados, por exemplo, s√£o prot√≥tipos em Javascript.  Inst√¢ncias de objetos derivados redirecionam chamadas para m√©todos pai.  Se n√£o houver propriedade ou m√©todo necess√°rio na inst√¢ncia da matriz, ele redirecionar√° essa chamada para Array.prototype e, se necess√°rio - al√©m de Object.prototype.  Assim, o mecanismo de heran√ßa em Javascript √© baseado na cadeia de delega√ß√£o de prot√≥tipos, que √© tecnicamente uma vers√£o (surpresa) da composi√ß√£o. <br><br>  A combina√ß√£o de uma matriz de objetos de estilo por delega√ß√£o pode ser feita da seguinte maneira. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> delegate = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create(a), b); styles.reduceRight(delegate, {}) <span class="hljs-comment"><span class="hljs-comment">//{"fontSize":"12px","fontFamily":"Arial"} styles.reduceRight(delegate, {}).fontWeight //bold</span></span></code> </pre> <br>  Como voc√™ pode ver, as propriedades delegadas n√£o s√£o acess√≠veis por enumera√ß√£o (por exemplo, usando Object.keys ()), mas s√£o acess√≠veis apenas por acesso expl√≠cito.  O fato de isso nos dar est√° no final do post. <br><br>  Agora, para os detalhes.  Um bom exemplo de caso que incentiva um desenvolvedor a usar composi√ß√£o em vez de heran√ßa est√° na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">composi√ß√£o de objeto de</a> Michael Rise <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">em Javascript</a> .  Aqui, o autor considera o processo de cria√ß√£o de uma hierarquia de personagens.  Primeiro, s√£o necess√°rios dois tipos de personagens - um guerreiro e um m√°gico, cada um com uma certa reserva de sa√∫de e um nome.  Essas propriedades s√£o comuns e podem ser movidas para a classe pai Character. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Character</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(name) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.health = <span class="hljs-number"><span class="hljs-number">100</span></span>; } }</code> </pre> <br>  O guerreiro se distingue pelo fato de saber atacar, enquanto gasta sua resist√™ncia e o mago - a capacidade de lan√ßar feiti√ßos, reduzindo a quantidade de mana. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Fighter</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Character</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(name) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(name); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stamina = <span class="hljs-number"><span class="hljs-number">100</span></span>; } fight() { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.name}</span></span></span><span class="hljs-string"> takes a mighty swing!`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stamina -  ; } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Mage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Character</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(name) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(name); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mana = <span class="hljs-number"><span class="hljs-number">100</span></span>; } cast() { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.name}</span></span></span><span class="hljs-string"> casts a fireball!`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mana -  ; } }</code> </pre> <br>  Tendo criado as classes Fighter e Mage, os descendentes de Character, o desenvolvedor enfrenta um problema inesperado quando h√° necessidade de criar a classe Paladin.  O novo personagem se distingue pela invej√°vel capacidade de lutar e conjurar.  De antem√£o, voc√™ pode ver algumas solu√ß√µes que diferem na mesma falta de gra√ßa. <br><br><ol><li>  Voc√™ pode fazer de Paladin um descendente de Personagem e implementar tanto fight () quanto cast () nele do zero.  Nesse caso, o princ√≠pio DRY √© violado grosseiramente, porque cada um dos m√©todos ser√° duplicado durante a cria√ß√£o e, posteriormente, precisar√° de sincroniza√ß√£o constante com os m√©todos das classes Mage e Fighter para rastrear altera√ß√µes. </li><li>  Os m√©todos fight () e cast () podem ser implementados no n√≠vel da classe Charater, para que todos os tr√™s tipos de personagens os possuam.  Essa √© uma solu√ß√£o um pouco mais agrad√°vel, no entanto, nesse caso, o desenvolvedor deve redefinir o m√©todo fight () para o m√°gico e o m√©todo cast () para o guerreiro, substituindo-os por tocos vazios. </li></ol><br>  Em qualquer uma das op√ß√µes, mais cedo ou mais tarde √© preciso enfrentar os problemas de heran√ßa manifestados no in√≠cio do post.  Eles podem ser resolvidos com uma abordagem funcional para a implementa√ß√£o de caracteres.  √â o suficiente para se afastar n√£o de seus tipos, mas de suas fun√ß√µes.  No final das contas, temos dois recursos principais que determinam a capacidade dos personagens - a capacidade de lutar e a capacidade de conjurar.  Esses recursos podem ser definidos usando fun√ß√µes de f√°brica que expandem o estado que define o caractere (um exemplo de composi√ß√£o √© concatena√ß√£o). <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> canCast = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">cast</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">spell</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${state.name}</span></span></span><span class="hljs-string"> casts </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${spell}</span></span></span><span class="hljs-string">!`</span></span>); state.mana -  ; } }) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> canFight = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">fight</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${state.name}</span></span></span><span class="hljs-string"> slashes at the foe!`</span></span>); state.stamina -  ; } })</code> </pre> <br>  Assim, o personagem √© determinado pelo conjunto desses recursos e pelas propriedades iniciais, gerais (nome e sa√∫de) e privadas (resist√™ncia e mana). <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> fighter = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> state = { name, <span class="hljs-attr"><span class="hljs-attr">health</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">stamina</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign(state, canFight(state)); } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mage = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> state = { name, <span class="hljs-attr"><span class="hljs-attr">health</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">mana</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign(state, canCast(state)); } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> paladin = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> state = { name, <span class="hljs-attr"><span class="hljs-attr">health</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">mana</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">stamina</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign(state, canCast(state), canFight(state)); }</code> </pre> <br>  Tudo √© lindo - o c√≥digo de a√ß√£o √© reutilizado, voc√™ pode adicionar qualquer novo personagem com facilidade, sem tocar nos anteriores e sem aumentar a funcionalidade de qualquer objeto.  Para encontrar uma mosca na pomada na solu√ß√£o proposta, basta comparar o desempenho da solu√ß√£o com base na heran√ßa (delega√ß√£o de leitura) e a solu√ß√£o com base na concatena√ß√£o.  Crie um milion√©simo ex√©rcito de inst√¢ncias dos personagens criados. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> inheritanceArmy = []; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">1000000</span></span>; i++) { inheritanceArmy.push(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Fighter(<span class="hljs-string"><span class="hljs-string">'Fighter'</span></span> + i)); inheritanceArmy.push(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mage(<span class="hljs-string"><span class="hljs-string">'Mage'</span></span> + i)); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> compositionArmy = []; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">1000000</span></span>; i++) { compositionArmy.push(fighter(<span class="hljs-string"><span class="hljs-string">'Fighter'</span></span> + i)); compositionArmy.push(mage(<span class="hljs-string"><span class="hljs-string">'Mage'</span></span> + i)); }</code> </pre> <br>  E compare os custos de mem√≥ria e computacionais entre heran√ßa e composi√ß√£o necess√°rios para criar objetos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/158/509/b8f/158509b8fb1d5dc214b2728f72145565.png" alt="imagem"><br><br>  Em m√©dia, uma solu√ß√£o usando uma composi√ß√£o por concatena√ß√£o requer 100 a 150% mais recursos.  Os resultados apresentados foram obtidos no ambiente NodeJS. Voc√™ pode ver os resultados para o mecanismo do navegador executando este <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://medium.com/r/%3Furl%3D">teste</a> . <br><br>  A vantagem da solu√ß√£o baseada na delega√ß√£o de heran√ßa pode ser explicada economizando mem√≥ria devido √† falta de acesso impl√≠cito √†s propriedades do delegado, al√©m de desativar algumas otimiza√ß√µes de mecanismo para delegados din√¢micos.  Por sua vez, a solu√ß√£o baseada em concatena√ß√£o usa o m√©todo Object.assign () muito caro, que afeta muito seu desempenho.  Curiosamente, o Firefox Quantum mostra resultados diametralmente opostos ao Chromium - a segunda solu√ß√£o funciona muito mais r√°pido no Gecko. <br><br>  Obviamente, vale a pena confiar nos resultados dos testes de desempenho apenas ao resolver tarefas bastante trabalhosas associadas √† cria√ß√£o de um grande n√∫mero de objetos de infraestrutura complexa - por exemplo, ao trabalhar com uma √°rvore virtual de elementos ou ao desenvolver uma biblioteca gr√°fica.  Na maioria dos casos, a beleza estrutural da solu√ß√£o, sua confiabilidade e simplicidade acabam sendo mais importantes, e uma pequena diferen√ßa no desempenho n√£o desempenha um papel importante (as opera√ß√µes com elementos DOM ocupam muito mais recursos). <br><br>  Em conclus√£o, vale ressaltar que os tipos de composi√ß√£o considerados n√£o s√£o √∫nicos e mutuamente exclusivos.  A delega√ß√£o pode ser implementada usando agrega√ß√£o e heran√ßa de classe usando delega√ß√£o (como √© feito em JavaScript).  Em sua ess√™ncia, qualquer combina√ß√£o de objetos ser√° de uma forma ou de outra de composi√ß√£o e, em √∫ltima an√°lise, apenas a simplicidade e a flexibilidade da solu√ß√£o resultante s√£o importantes. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt438404/">https://habr.com/ru/post/pt438404/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt438394/index.html">Yii 2.0.16</a></li>
<li><a href="../pt438396/index.html">Por que voc√™ deve pensar em programa√ß√£o funcional</a></li>
<li><a href="../pt438398/index.html">Como eu Keras em C ++ lan√ßado</a></li>
<li><a href="../pt438400/index.html">Cientistas israelenses desenvolveram um tratamento universal contra o c√¢ncer</a></li>
<li><a href="../pt438402/index.html">Neutralinojs - o que √© voc√™? Ou maneira UNIX onde voc√™ n√£o esperou</a></li>
<li><a href="../pt438406/index.html">ReactJS + MobX - Experi√™ncia DI</a></li>
<li><a href="../pt438408/index.html">Nuvens e pa√≠ses: caracter√≠sticas nacionais do mercado de nuvens</a></li>
<li><a href="../pt438412/index.html">An√°lise de 112654 tarefas de teste e tend√™ncias no mercado de trabalho de programadores em 2019</a></li>
<li><a href="../pt438414/index.html">Civiliza√ß√£o da Primavera, 3/5</a></li>
<li><a href="../pt438416/index.html">Sobre horm√¥nios</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>