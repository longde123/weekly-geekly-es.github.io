<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ ğŸš¶ğŸ½ ğŸ¥ Comment combiner en toute sÃ©curitÃ© les segments de rÃ©seau de trois grandes banques: partager des astuces ğŸ›„ ğŸ§™ğŸ¿ ğŸ‘¨ğŸ½â€ğŸ’»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il y a quelque temps, sous la marque VTB, trois grandes banques ont fusionnÃ©: VTB, ex-VTB24 et ex-Bank of Moscow. Pour les observateurs externes, la b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment combiner en toute sÃ©curitÃ© les segments de rÃ©seau de trois grandes banques: partager des astuces</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vtb/blog/439046/">  Il y a quelque temps, sous la marque VTB, trois grandes banques ont fusionnÃ©: VTB, ex-VTB24 et ex-Bank of Moscow.  Pour les observateurs externes, la banque VTB combinÃ©e fonctionne dÃ©sormais dans son ensemble, mais de l'intÃ©rieur, tout semble beaucoup plus compliquÃ©.  Dans cet article, nous parlerons des plans pour crÃ©er un rÃ©seau unifiÃ© de la banque VTB intÃ©grÃ©e, partager des astuces de vie sur l'organisation de l'interaction des pare-feu, connecter et combiner des segments de rÃ©seau sans interrompre les services. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c50/429/465/c50429465565f4cf1ec0ee1d62097102.png"><br><a name="habracut"></a><br><h2>  DifficultÃ©s d'interaction d'infrastructures disparates </h2><br>  Les opÃ©rations de VTB sont actuellement soutenues par trois infrastructures existantes: l'ancienne banque de Moscou, l'ex-VTB24 et la VTB elle-mÃªme.  Les infrastructures de chacun d'entre eux ont leur propre ensemble de pÃ©rimÃ¨tres de rÃ©seau, Ã  la frontiÃ¨re duquel se trouvent des Ã©quipements de protection.  L'une des conditions d'intÃ©gration des infrastructures au niveau du rÃ©seau est l'existence d'une structure d'adressage IP cohÃ©rente. <br><br>  ImmÃ©diatement aprÃ¨s la fusion, nous avons commencÃ© Ã  aligner les espaces d'adressage, et maintenant elle est presque terminÃ©e.  Mais le processus prend du temps et est rapide, et les dÃ©lais pour organiser les accÃ¨s croisÃ©s entre les infrastructures Ã©taient trÃ¨s serrÃ©s.  Par consÃ©quent, dans un premier temps, nous avons connectÃ© les infrastructures de diffÃ©rentes banques entre elles sous la forme telle qu'elles sont - par le biais du pare-feu pour un certain nombre de zones de sÃ©curitÃ© principales.  Selon ce schÃ©ma, afin d'organiser l'accÃ¨s d'un pÃ©rimÃ¨tre de rÃ©seau Ã  un autre, il est nÃ©cessaire d'acheminer le trafic Ã  travers de nombreux pare-feu et autres moyens de protection, diffusÃ©s aux adresses conjointes des ressources et des utilisateurs utilisant les technologies NAT et PAT.  De plus, tous les pare-feu aux jonctions sont rÃ©servÃ©s Ã  la fois localement et gÃ©ographiquement, et cela doit toujours Ãªtre pris en compte lors de l'organisation des interactions et de la construction des chaÃ®nes de services. <br><br>  Un tel schÃ©ma est assez fonctionnel, mais vous ne pouvez certainement pas l'appeler optimal.  Il y a Ã  la fois des problÃ¨mes techniques et organisationnels.  Il est nÃ©cessaire de coordonner et de documenter les interactions de nombreux systÃ¨mes dont les composants sont dispersÃ©s sur diffÃ©rentes infrastructures et zones de sÃ©curitÃ©.  ParallÃ¨lement, dans le processus de transformation des infrastructures, il est nÃ©cessaire de mettre Ã  jour rapidement cette documentation pour chaque systÃ¨me.  La conduite de ce processus charge considÃ©rablement notre ressource la plus prÃ©cieuse - des spÃ©cialistes hautement qualifiÃ©s. <br><br>  Les problÃ¨mes techniques se traduisent par la multiplication du trafic sur les liaisons, la forte charge d'outils de sÃ©curitÃ©, la complexitÃ© d'organisation des interactions rÃ©seau, l'impossibilitÃ© de crÃ©er certaines interactions sans traduction d'adresse. <br><br>  Le problÃ¨me de la multiplication du trafic se pose principalement en raison des nombreuses zones de sÃ©curitÃ© interagissant entre elles via des pare-feu sur diffÃ©rents sites.  Quelle que soit la situation gÃ©ographique des serveurs eux-mÃªmes, si le trafic dÃ©passe le pÃ©rimÃ¨tre de la zone de sÃ©curitÃ©, il passera par une chaÃ®ne de fonctions de sÃ©curitÃ© pouvant se trouver dans d'autres emplacements.  Par exemple, nous avons deux serveurs dans un centre de donnÃ©es, mais un dans le pÃ©rimÃ¨tre de VTB et l'autre dans le pÃ©rimÃ¨tre de l'ancien rÃ©seau VTB24.  Le trafic entre eux ne passe pas directement, mais passe par 3-4 pare-feu qui peuvent Ãªtre actifs dans d'autres centres de donnÃ©es, et le trafic sera acheminÃ© vers le pare-feu et inversÃ© plusieurs fois via le rÃ©seau de jonction. <br><br>  Pour garantir une haute fiabilitÃ©, nous avons besoin de chaque pare-feu en 3 Ã  4 copies - deux sur un site sous la forme d'un cluster HA et un ou deux pare-feu sur un autre site, vers lesquels le trafic basculera si le cluster de pare-feu principal ou le site dans son ensemble est interrompu. <br><br>  Nous rÃ©sumons.  Trois rÃ©seaux indÃ©pendants reprÃ©sentent un <b>tas de problÃ¨mes</b> : une complexitÃ© excessive, la nÃ©cessitÃ© d'Ã©quipements supplÃ©mentaires coÃ»teux, des goulots d'Ã©tranglement, des difficultÃ©s de redondance et, par consÃ©quent, des coÃ»ts Ã©levÃ©s d'exploitation de l'infrastructure. <br><br><h2>  Approche gÃ©nÃ©rale d'intÃ©gration </h2><br>  Depuis que nous avons dÃ©cidÃ© d'entreprendre la transformation de l'architecture de rÃ©seau, nous allons commencer par les choses de base.  Allons de haut en bas, nous allons commencer par analyser les besoins des entreprises, des candidats, des ingÃ©nieurs systÃ¨me et du personnel de sÃ©curitÃ©. <br><br><ul><li>  En fonction de leurs besoins, nous concevons la structure cible des zones de sÃ©curitÃ© et les principes d'interconnexion entre ces zones. <br></li><li>  Nous imposons cette structure de zones Ã  la gÃ©ographie de nos principaux consommateurs - datacenters et grands bureaux. <br></li><li>  Ensuite, nous formons le rÃ©seau de transport MPLS. <br></li><li>  En dessous, nous apportons dÃ©jÃ  le rÃ©seau principal qui fournit des services Ã  la couche physique. <br></li><li>  Nous sÃ©lectionnons des emplacements pour le placement des modules de pÃ©riphÃ©rie et des modules de pare-feu. <br></li><li>  Une fois l'image cible clarifiÃ©e, nous Ã©laborons et approuvons la mÃ©thodologie de migration de l'infrastructure existante vers l'infrastructure cible afin que le processus soit transparent pour les systÃ¨mes en fonctionnement. <br></li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/c50/429/465/c50429465565f4cf1ec0ee1d62097102.png"><br>  <i>Concept de rÃ©seau cible</i> <br><br>  Nous aurons un rÃ©seau principal de base - il s'agit d'une infrastructure de transport de tÃ©lÃ©communications basÃ©e sur des lignes de communication Ã  fibre optique (FOCL), des Ã©quipements passifs et actifs de formation de canaux.  Il peut Ã©galement utiliser le sous-systÃ¨me de densification des canaux optiques xWDM et, Ã©ventuellement, un rÃ©seau SDH. <br><br>  Sur la base du rÃ©seau principal, nous construisons ce que l'on appelle <i><b>le rÃ©seau central</b></i> .  Il aura un seul plan d'adresses et un seul ensemble de protocoles de routage.  Le rÃ©seau central comprend: <br><br><ul><li>  MPLS - rÃ©seau multiservice; <br></li><li>  DCI - liens entre les centres de donnÃ©es; <br></li><li>  Modules EDGE - divers modules de connexion: pare-feu, organisations partenaires, canaux Internet, centres de donnÃ©es, LAN, rÃ©seaux rÃ©gionaux. <br></li></ul><br>  Nous <i>crÃ©ons un</i> rÃ©seau multiservice <i>selon un principe hiÃ©rarchique avec l'allocation des nÅ“uds de transit (P) et d'extrÃ©mitÃ© (PE)</i> .  Au cours d'une analyse prÃ©liminaire des Ã©quipements disponibles sur le marchÃ© aujourd'hui, il est devenu clair qu'il serait plus Ã©conomiquement faisable de transfÃ©rer le niveau des nÅ“uds P vers des Ã©quipements sÃ©parÃ©s que de combiner la fonctionnalitÃ© P / PE dans un seul appareil. <br><br>  Un rÃ©seau multiservice aura une haute disponibilitÃ©, une tolÃ©rance aux pannes, un temps de convergence minimum, une Ã©volutivitÃ©, des performances et des fonctionnalitÃ©s Ã©levÃ©es, en particulier IPv6 et la prise en charge de la multidiffusion. <br><br>  Pendant la construction du rÃ©seau fÃ©dÃ©rateur, nous avons l'intention d' <i>abandonner les technologies propriÃ©taires</i> (si possible sans compromettre la qualitÃ©), car nous nous efforÃ§ons de rendre la solution flexible et non liÃ©e Ã  un fournisseur spÃ©cifique.  Mais en mÃªme temps, nous ne voulons pas crÃ©er une Â«vinaigretteÂ» Ã  partir de l'Ã©quipement de divers fournisseurs.  Notre principe de conception fondamental est de fournir le nombre maximum de services lors de l'utilisation d'Ã©quipements qui est minimalement suffisant pour ce nombre de fournisseurs.  Cela permettra, entre autres, d'organiser la maintenance de l'infrastructure du rÃ©seau, en utilisant un nombre limitÃ© de personnel.  Il est Ã©galement important que le nouvel Ã©quipement soit compatible avec l'Ã©quipement existant afin d'assurer un processus de migration sans heurt. <br><br>  La structure des zones de sÃ©curitÃ© des rÃ©seaux VTB, ex-VTB24 et ex-Bank of Moscow dans le cadre du projet devrait Ãªtre entiÃ¨rement repensÃ©e dans le but de combiner des segments fonctionnellement dupliquÃ©s.  Une structure unifiÃ©e des zones de sÃ©curitÃ© avec des rÃ¨gles de routage communes et un concept unifiÃ© d'accÃ¨s interrÃ©seaux est prÃ©vue.  Nous prÃ©voyons d'effectuer un pare-feu entre les zones de sÃ©curitÃ© Ã  l'aide de pare-feu matÃ©riels sÃ©parÃ©s, espacÃ©s sur deux emplacements principaux.  Nous prÃ©voyons Ã©galement de mettre en Å“uvre tous les modules de pÃ©riphÃ©rie indÃ©pendamment sur deux sites diffÃ©rents avec une redondance automatique entre eux sur la base de protocoles de routage dynamique normalisÃ©s. <br><br>  Nous organisons la gestion des Ã©quipements du cÅ“ur de rÃ©seau via un rÃ©seau physique distinct (hors bande).  L'accÃ¨s administratif Ã  tous les Ã©quipements du rÃ©seau sera assurÃ© par un service unique d'authentification, d'autorisation et de comptabilitÃ© (AAA). <br><br>  Pour trouver rapidement des problÃ¨mes dans le rÃ©seau, il est trÃ¨s important de pouvoir copier le trafic depuis n'importe quel point du rÃ©seau pour analyse et le transmettre Ã  l'analyseur via un canal de communication indÃ©pendant.  Pour ce faire, nous allons crÃ©er un rÃ©seau isolÃ© pour le trafic SPAN, Ã  l'aide duquel nous collecterons, filtrerons et transmettrons les flux de trafic aux serveurs d'analyse. <br><br>  Afin de standardiser les services fournis par le rÃ©seau et la possibilitÃ© de rÃ©partir les coÃ»ts, nous allons introduire un catalogue unique avec des indicateurs SLA.  Nous passons au modÃ¨le de service, dans lequel nous prenons en compte l'interconnexion de l'infrastructure rÃ©seau avec les tÃ¢ches appliquÃ©es, l'interconnexion des Ã©lÃ©ments des applications de contrÃ´le et leur impact sur les services.  Et ce modÃ¨le de service est soutenu par un systÃ¨me de surveillance du rÃ©seau afin que nous puissions correctement rÃ©partir les coÃ»ts informatiques. <br><br><h2>  De la thÃ©orie Ã  la pratique </h2><br>  Nous allons maintenant descendre d'un niveau et vous parler des solutions les plus intÃ©ressantes de notre nouvelle infrastructure qui pourraient vous Ãªtre utiles. <br><br><h3>  ForÃªt de ressources: dÃ©tails </h3><br>  Nous avons dÃ©jÃ  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">familiarisÃ© les</a> habitants de Khabrovsk avec la forÃªt ressource VTB.  Essayez maintenant de donner une description technique plus dÃ©taillÃ©e. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3a4/b23/d21/3a4b23d2100cddffa97e76603577a207.png"><br><br>  Supposons que nous ayons deux (pour plus de simplicitÃ©) des infrastructures de rÃ©seau d'organisations diffÃ©rentes qui doivent Ãªtre combinÃ©es.  Au sein de chaque infrastructure, en rÃ¨gle gÃ©nÃ©rale, parmi l'ensemble des segments de rÃ©seau fonctionnels (zones de sÃ©curitÃ©), on peut distinguer le segment de rÃ©seau productif principal, oÃ¹ se trouvent les principaux systÃ¨mes industriels.  Nous relions ces zones productives Ã  une certaine structure de segments d'Ã©cluse, que nous appelons la <i>Â«forÃªt ressourceÂ»</i> .  Ces segments de passerelle publient les ressources partagÃ©es disponibles Ã  partir des deux infrastructures. <br><br>  Le concept d'une forÃªt de ressources, d'un point de vue rÃ©seau, est de crÃ©er une zone de sÃ©curitÃ© de passerelle constituÃ©e de deux VPN IP (pour le cas de deux banques).  Ces VPN IP sont librement routÃ©s entre eux et connectÃ©s via des pare-feu Ã  des segments productifs.  L'adressage IP pour ces segments est sÃ©lectionnÃ© dans une plage disjointe d'adresses IP.  Ainsi, le routage vers la forÃªt ressource devient possible Ã  partir des rÃ©seaux des deux organisations. <br><br>  Mais avec le routage de la forÃªt de ressources vers les segments industriels, la situation est un peu pire, car l'adressage en eux se recoupe souvent et il est impossible de former une table unique.  Pour rÃ©soudre ce problÃ¨me, nous avons juste besoin de deux segments dans la forÃªt de ressources.  Dans chacun des segments de la forÃªt ressource, un itinÃ©raire par dÃ©faut est Ã©crit vers le rÃ©seau industriel de "leur" organisation.  Autrement dit, les utilisateurs peuvent accÃ©der sans traduire les adresses Ã  leur Â«propreÂ» segment de la forÃªt de ressources et Ã  un autre segment via PAT. <br><br>  Ainsi, deux segments de la forÃªt de ressources reprÃ©sentent une zone de sÃ©curitÃ© de passerelle unique, si vous tracez la frontiÃ¨re le long des pare-feu.  Chacun d'eux a son propre routage: la passerelle par dÃ©faut regarde vers "sa" banque.  Si nous plaÃ§ons une ressource dans un segment de la forÃªt de ressources, les utilisateurs de la banque correspondante peuvent interagir avec elle sans NAT. <br><br>  L'interaction sans NAT est trÃ¨s importante pour de nombreux systÃ¨mes et, tout d'abord, pour les interactions de domaine Microsoft - aprÃ¨s tout, dans la forÃªt de ressources, nous avons des serveurs Active Directory pour le nouveau domaine commun, dont les approbations sont Ã©tablies par les deux organisations.  De plus, sans interaction NAT, des systÃ¨mes tels que Skype Entreprise, ABS Â«MBANKÂ» et de nombreuses autres applications sont nÃ©cessaires, oÃ¹ le serveur retourne Ã  l'adresse du client.  Et si le client est derriÃ¨re PAT, la connexion inverse ne sera plus Ã©tablie. <br><br>  Les serveurs que nous installons dans les segments de la forÃªt de ressources sont divisÃ©s en deux catÃ©gories: l'infrastructure (par exemple, les serveurs MS AD) et donnant accÃ¨s Ã  certains systÃ¨mes d'information.  Le dernier type de serveur que nous appelons Data Marts.  Les vitrines sont gÃ©nÃ©ralement des serveurs Web, dont le backend est dÃ©jÃ  derriÃ¨re le pare-feu dans le rÃ©seau de production de l'organisation qui a crÃ©Ã© cette vitrine dans la forÃªt de ressources. <br><br>  Et comment les <i>utilisateurs</i> sont-ils <i>authentifiÃ©s</i> lorsqu'ils accÃ¨dent aux ressources publiÃ©es?  Si nous fournissons simplement l'accÃ¨s Ã  certaines applications Ã  un ou deux utilisateurs dans un autre domaine, nous pouvons crÃ©er pour eux des comptes distincts pour l'authentification dans notre domaine.  Mais lorsque nous parlons de la fusion en masse des infrastructures - disons, 50 000 utilisateurs - il est complÃ¨tement irrÃ©aliste de crÃ©er et de gÃ©rer des comptes croisÃ©s sÃ©parÃ©s pour eux.  Il n'est pas toujours possible de crÃ©er des approbations directes entre les forÃªts de diffÃ©rentes organisations, Ã  la fois pour des raisons de sÃ©curitÃ© et en raison de la nÃ©cessitÃ© de rendre les utilisateurs PAT dans les conditions d'intersection des espaces d'adressage.  Par consÃ©quent, pour rÃ©soudre le problÃ¨me de l'authentification unifiÃ©e des utilisateurs, une nouvelle forÃªt MS AD constituÃ©e d'un domaine est crÃ©Ã©e dans le pÃ©rimÃ¨tre de la forÃªt de ressources.  Dans ce nouveau domaine, les utilisateurs s'authentifient lorsqu'ils accÃ¨dent aux services.  Pour rendre cela possible, des fiducies bilatÃ©rales au niveau des forÃªts sont Ã©tablies entre la nouvelle forÃªt et les forÃªts de domaine de chaque organisation.  Ainsi, l'utilisateur de n'importe laquelle des organisations peut s'authentifier sur n'importe quelle ressource publiÃ©e. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5d9/79b/c38/5d979bc3857f12b2c7d2169fdd579326.png"><br><br><h3>  Obtenir l'intÃ©gration rÃ©seau </h3><br>  AprÃ¨s avoir Ã©tabli l'interaction des systÃ¨mes Ã  travers l'infrastructure de la forÃªt ressource et ainsi Ã©liminÃ© les symptÃ´mes aigus, il Ã©tait temps de reprendre l'intÃ©gration directe des rÃ©seaux. <br><br>  Pour ce faire, dans un premier temps, nous avons connectÃ© les segments de produits de trois banques Ã  un seul pare-feu puissant (logiquement unifiÃ©, mais physiquement plusieurs fois rÃ©servÃ© sur diffÃ©rents sites).  Le pare-feu fournit une interaction directe entre les systÃ¨mes de diffÃ©rentes banques. <br><br>  Avec l'ex-VTB24, avant d'organiser des interactions directes entre les systÃ¨mes, nous avons dÃ©jÃ  rÃ©ussi Ã  aligner les espaces d'adressage.  AprÃ¨s avoir formÃ© les tables de routage sur le pare-feu et ouvert les accÃ¨s appropriÃ©s, nous avons pu assurer l'interaction entre les systÃ¨mes dans deux infrastructures diffÃ©rentes. <br><br>  Avec l'ex-Banque de Moscou, les espaces d'adressage au moment de l'organisation des interactions appliquÃ©es n'Ã©taient pas alignÃ©s, et nous avons dÃ» utiliser le NAT mutuel pour organiser l'interaction des systÃ¨mes.  L'utilisation de NAT a crÃ©Ã© un certain nombre de problÃ¨mes de rÃ©solution DNS qui ont Ã©tÃ© rÃ©solus par la maintenance de zones DNS en double.  De plus, en raison du NAT, il y avait des difficultÃ©s avec le fonctionnement d'un certain nombre de systÃ¨mes d'application.  Maintenant, nous avons presque Ã©liminÃ© les intersections des espaces d'adressage, mais nous sommes confrontÃ©s au fait que de nombreux systÃ¨mes VTB et ex-Bank of Moscow sont Ã©troitement liÃ©s pour interagir aux adresses traduites.  Nous devons maintenant migrer ces interactions vers de vÃ©ritables adresses IP tout en maintenant la continuitÃ© des activitÃ©s. <br><br><h3>  Suppression du NAT </h3><br>  Ici, notre objectif est d'assurer le fonctionnement des systÃ¨mes dans un espace d'adressage unique pour une intÃ©gration plus poussÃ©e des services d'infrastructure (MS AD, DNS) et des applications (Skype Entreprise, MBANK).  Malheureusement, Ã©tant donnÃ© que certains des systÃ¨mes d'application sont dÃ©jÃ  liÃ©s les uns aux autres aux adresses traduites, un travail individuel avec chaque systÃ¨me d'application est nÃ©cessaire pour Ã©liminer le NAT pour des interactions spÃ©cifiques. <br><br>  Parfois, vous pouvez <i>opter pour une telle astuce</i> : dÃ©finir le mÃªme serveur en mÃªme temps sous l'adresse traduite et sous la vraie.  Ainsi, les administrateurs d'applications peuvent tester le travail Ã  une adresse rÃ©elle avant la migration, essayer de basculer vers une interaction non NAT par eux-mÃªmes et revenir en arriÃ¨re si nÃ©cessaire.  Dans le mÃªme temps, nous surveillons le pare-feu Ã  l'aide de la fonction de capture de paquets pour voir si quelqu'un communique avec le serveur via l'adresse traduite.  DÃ¨s que cette communication s'arrÃªte, nous, en accord avec le propriÃ©taire de la ressource, arrÃªtons la diffusion: le serveur n'a qu'une adresse rÃ©elle. <br><br>  AprÃ¨s avoir analysÃ© NAT, malheureusement, pendant un certain temps, il sera nÃ©cessaire de maintenir le pare-feu entre des segments fonctionnellement identiques, car toutes les zones ne sont pas conformes aux mÃªmes normes de sÃ©curitÃ©.  AprÃ¨s la standardisation des segments, le pare-feu entre les segments est remplacÃ© par le routage et les zones de sÃ©curitÃ© fonctionnellement identiques fusionnent. <br><br><h3>  Pare-feu </h3><br>  Passons au problÃ¨me du pare-feu interrÃ©seau.  En principe, il est pertinent pour toute grande organisation dans laquelle il est nÃ©cessaire de fournir une tolÃ©rance aux pannes locale et globale des Ã©quipements de protection. <br><br><img src="https://habrastorage.org/webt/ui/l2/mq/uil2mq95zf7o-4uipsjevhk5-j8.png"><br><br>  Essayons de formuler le problÃ¨me de la rÃ©servation du pare-feu en gÃ©nÃ©ral.  Nous avons deux sites: le site 1 et le site 2. Il existe plusieurs (par exemple, trois) VPN IP MPLS qui communiquent entre eux via un pare-feu dynamique.  Ce pare-feu doit Ãªtre rÃ©servÃ© localement et gÃ©ographiquement. <br><br>  Nous ne considÃ©rerons pas le problÃ¨me de la sauvegarde locale des pare-feu; presque tous les fabricants offrent la possibilitÃ© d'assembler des pare-feu dans un cluster HA local.  En ce qui concerne la rÃ©servation gÃ©ographique des pare-feu, pratiquement aucun fournisseur n'a cette tÃ¢che prÃªte Ã  l'emploi. <br><br>  Bien sÃ»r, vous pouvez Â«Ã©tirerÂ» un cluster de pare-feu sur plusieurs sites le long de L2, mais ce cluster reprÃ©sentera alors un point de dÃ©faillance unique et la fiabilitÃ© de notre solution ne sera pas trÃ¨s Ã©levÃ©e.  Parce que les clusters se bloquent parfois complÃ¨tement en raison d'erreurs logicielles, ou tombent dans un Ã©tat de cerveau divisÃ© en raison d'une rupture de lien L2 entre les sites.  Pour cette raison, nous avons immÃ©diatement refusÃ© d'Ã©tirer les clusters de pare-feu sur L2. <br><br>  Nous devions trouver un schÃ©ma dans lequel si un module de pare-feu Ã©chouait sur un site, une transition automatique vers un autre site se produirait.  Voici comment nous l'avons fait. <br><br>  Il a Ã©tÃ© dÃ©cidÃ© de s'en tenir au modÃ¨le de gÃ©o-rÃ©servation Active / Standby lorsque le cluster actif est situÃ© sur le mÃªme site.  Sinon, nous rencontrons immÃ©diatement des problÃ¨mes de routage asymÃ©trique, ce qui est difficile Ã  rÃ©soudre avec un grand nombre de VPN L3. <br><br>  Le cluster de pare-feu actif doit en quelque sorte signaler son bon fonctionnement.  Comme mÃ©thode de signalisation, nous avons choisi l'annonce OSPF du pare-feu au rÃ©seau de la route de test (drapeau) avec le masque / 32.  L'Ã©quipement rÃ©seau sur le site 1 surveille la prÃ©sence de cette route depuis le pare-feu et, si disponible, active le routage statique (par exemple, 0.0.0.0 / 0), vers le cluster de pare-feu donnÃ©.  Cette route statique par dÃ©faut est ensuite placÃ©e (par redistribution) dans la table de protocole BGP MP et distribuÃ©e Ã  travers le rÃ©seau de base.     ,     OSPF  ,    ,                IP VPN. <br><br>        ,           ,          ,        . <br><br>      1 - ,    ,    1      ,     2  â€”       .    ,    ,     VPN'    . ,      ,     ,      . <br><br>    ,          active/standby.      active-.             ,     .   ,          (, IP-    ).          .       .         . <br><br>        L3 ,         .    . <br><br><h3>   </h3><br>          . ,     ,     â€”  , ,   .            L3-,         . <br><br>             ,         IP-.           MPLS VPN.     MPLS VPN Â«INÂ»    VPN Â«OUTÂ».   VPN     HUB-and-spoke VPN.   Spoke   HUB'       VPN,      . <br><br>  Â«INÂ» <b> </b> -     Spoke VPN'        VPN.  Â«OUTÂ» <b> </b>      Spoke VPN'    . <br><br>       MPLS VPN Â«INÂ».     VPN    .          VPN  HUB-VPN Â«INÂ»    .          .           ,       Policy Based  Routing.      VPN Â«OUTÂ»,           VPN Â«OUTÂ»   Spoke-VPN. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4f8/3f3/b13/4f83f3b1381bcc6e34a05b94736210f2.png"><br><br>        VPN,     .           MPLS import / export    HUB VPN. <br><br>      VPN     ,          â€”      ,  VLAN,    .. <br><br><h2>  Conclusion </h2><br>           ,     ,          .     ,         ,       ,      .          . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr439046/">https://habr.com/ru/post/fr439046/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr439032/index.html">Amazon et Google prÃ©voient d'entrer sur le marchÃ© de l'Ã©nergie</a></li>
<li><a href="../fr439034/index.html">Webinaire du Groupe IB: Â«Red Team or PentestÂ» 02/12/2019</a></li>
<li><a href="../fr439036/index.html">L'essentiel est de ne pas entrer dans le centre commercial sous la vÃ©rification des heures</a></li>
<li><a href="../fr439038/index.html">CrÃ©er un rÃ©seau de neurones: comment ne pas briser le cerveau</a></li>
<li><a href="../fr439042/index.html">Puma recherche des bÃªta-testeurs pour les chaussures de traction Fi</a></li>
<li><a href="../fr439050/index.html">Formation Cisco 200-125 CCNA v3.0. SpÃ©cialiste rÃ©seau certifiÃ© Cisco (CCNA). Jour 2. ModÃ¨les OSI et TCP-IP</a></li>
<li><a href="../fr439056/index.html">IntÃ©gration de la marque de ciment</a></li>
<li><a href="../fr439060/index.html">7 types de clients</a></li>
<li><a href="../fr439062/index.html">Compositeur Anisoprint: impression 3D haute rÃ©sistance</a></li>
<li><a href="../fr439064/index.html">Une erreur de grille typique (Bootstrap Grid), ou pourquoi le concepteur et le concepteur de mise en page ne se comprennent pas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>