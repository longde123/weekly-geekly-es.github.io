<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶É üèä üç† ESET: Analisis Komponen Zebrocy Baru üö£üèª üòΩ üì°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cybergroup Sednit telah beroperasi setidaknya sejak 2004 dan secara teratur muncul di berita. Sednit (lebih dikenal sebagai Fancy Bear) diyakini berad...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ESET: Analisis Komponen Zebrocy Baru</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/437236/">  Cybergroup Sednit telah beroperasi setidaknya sejak 2004 dan secara teratur muncul di berita.  Sednit (lebih dikenal sebagai Fancy Bear) diyakini berada di belakang celah Komite Nasional Demokrat AS sebelum pemilu 2016, Badan Anti-Doping Dunia (WADA), jaringan televisi TV5Monde, dan serangan lainnya.  Gudang senjata kelompok ini mencakup seperangkat alat jahat, beberapa di antaranya telah kami dokumentasikan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dalam laporan sebelumnya</a> . <br><br>  Kami baru-baru ini merilis laporan tentang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">LoJax</a> , rootkit UEFI yang juga terkait dengan Sednit dan digunakan dalam serangan di Balkan, di Eropa Tengah dan Timur. <br><br>  Pada Agustus 2018, operator Sednit mengerahkan dua komponen Zebrocy baru, dan mulai sekarang kita telah melihat lonjakan dalam penggunaan alat ini.  Zebrocy adalah koleksi bootloader, droppers, dan backdoors.  Pengunduh dan dropper adalah untuk kecerdasan, sementara backdoors menyediakan kegigihan dan spyware.  Komponen-komponen baru ini memiliki cara yang tidak biasa untuk menggali data yang dikumpulkan melalui protokol layanan surat SMTP dan POP3. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fh/nc/qk/fhncqkih604tvkrg44vywz9uzum.jpeg"></div><a name="habracut"></a><br>  Para korban alat baru menyerupai para korban yang disebutkan dalam posting kami sebelumnya tentang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Zebrocy</a> , serta di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kaspersky Lab</a> .  Sasaran serangan adalah di Asia Tengah, Eropa Tengah dan Timur, ini terutama kedutaan besar, kementerian luar negeri dan diplomat. <br><br><h3>  Ulasan </h3><br><img src="https://habrastorage.org/webt/-y/xq/ob/-yxqobqgv5jqqvti0t4zsnea5se.png"><br>  <i>Gambar 1. Skema komponen Zebrocy lama dan baru</i> <br><br>  Selama dua tahun, cybergroup Sednit menggunakan email phising sebagai vektor infeksi untuk Zebrocy (opsi 1 dan 2 dalam tabel di atas).  Setelah kompromi, para penyerang menggunakan berbagai bootloader dari tahap pertama untuk mengumpulkan informasi tentang korban dan, jika berminat, setelah beberapa jam atau beberapa hari digunakan salah satu pintu belakang dari tingkat kedua. <br><br>  Skema kampanye Zebrocy klasik adalah untuk mendapatkan korban sebagai arsip dalam lampiran surat itu.  Arsip berisi dua file, salah satunya adalah dokumen yang tidak berbahaya, dan yang kedua adalah file yang dapat dieksekusi.  Penyerang mencoba menipu korban dengan memanggil file kedua nama khas dokumen atau gambar dan menggunakan "ekstensi ganda". <br><br>  Dalam kampanye baru (opsi 3 dalam tabel), skema yang lebih rumit digunakan - kami akan menganalisisnya di bawah ini. <br><br><h3>  Penetes delphi </h3><br>  Biner pertama adalah dropper Delphi, yang sangat tidak biasa untuk kampanye Zebrocy.  Dalam kebanyakan kasus, ini lebih merupakan bootloader yang diinstal pada sistem korban pada tahap pertama serangan. <br><br>  Dengan bantuan beberapa metode, pipet mempersulit rekayasa terbalik.  Dalam sampel yang diperiksa, ia menggunakan kata kunci <i>hati</i> untuk menunjukkan awal dan akhir elemen kunci, seperti yang ditunjukkan di bawah ini. <br><br><pre><code class="plaintext hljs">$ yara -s tag_yara.yar SCANPASS_QXWEGRFGCVT_323803488900X_jpeg.exe find_tag SCANPASS_QXWEGRFGCVT_323803488900X_jpeg.exe 0x4c260:$tag: l\x00i\x00v\x00e\x00r\x00 0x6f000:$tag: liver 0x6f020:$tag: liver 0x13ab0c:$tag: liver</code> </pre> <br>  Aturan YARA di atas mencari string <i>liver</i> .  Baris <i>hati</i> pertama digunakan dalam kode, tetapi tidak memisahkan apa pun, sementara yang lain berbagi deskriptor kunci, gambar (hexdump ditunjukkan di bawah) dan komponen terenkripsi dalam penetes. <br><br><pre> <code class="plaintext hljs">$ hexdump -Cn 48 -s 0x6f000 SCANPASS_QXWEGRFGCVT_323803488900X_jpeg.exe 0006f000 6c 69 76 65 72 4f 70 65 6e 41 69 72 33 39 30 34 |liverOpenAir3904| 0006f010 35 5f 42 61 79 72 65 6e 5f 4d 75 6e 63 68 65 6e |5_Bayren_Munchen| 0006f020 6c 69 76 65 72 ff d8 ff e0 00 10 4a 46 49 46 00 |liver‚Ä¶‚Ä¶JFIF.|</code> </pre> <br>  Pertama, data disimpan dalam gambar dengan nama file <i>C: \ Users \ public \ Pictures \ scanPassport.jpg</i> , jika file tersebut belum ada. <br><br>  Menariknya, file dropper ini disebut <i>SCANPASS_QXWEGRFGCVT_323803488900X_jpeg.exe</i> , yang juga menyarankan skema phishing terkait dengan paspor dan informasi perjalanan.  Ini mungkin berarti bahwa operator mungkin mengetahui tujuan dari pesan phishing.  Dropper membuka gambar dan, jika file sudah ada, menghentikan eksekusi.  Kalau tidak, ia membukanya dan menerima pegangan kunci <i>OpenAir39045_Bayren_Munchen</i> .  Tidak ada gambar, meskipun formatnya benar - lihat gambar di bawah ini. <br><br><img src="https://habrastorage.org/webt/c9/_d/km/c9_dkmprdqv95bluopzc9ylq5ly.png"><br>  <i>Gambar 2. ScanPassport.jpg</i> <br><br>  Baris uraian kunci berisi <i>Bayren_Munchen</i> - kemungkinan besar referensi ke tim sepak bola FC Bayern Munich.  Bagaimanapun, isi deskriptor tidak penting, tetapi panjangnya, yang dengannya Anda bisa mendapatkan kunci XOR untuk mendekripsi komponen. <br><br>  Untuk mendapatkan kunci XOR, dropper mencari kata kunci <i>hati</i> terakhir dan menguraikannya menurut panjang kata kunci.  Panjang kunci XOR adalah 27 (0x1b) byte (identik dengan panjang deskriptor kunci). <br><br>  Menggunakan kunci XOR dan loop sederhana, dropper mendekripsi bagian terakhir - komponen terenkripsi terletak tepat setelah tag terakhir ke akhir file.  Harap dicatat bahwa header MZ dari komponen yang dapat dieksekusi dimulai segera setelah kata kunci <i>hati</i> , dan kunci XOR diperoleh dari bagian header PE, yang biasanya merupakan urutan 0x00 byte yang dipulihkan setelah dekripsi komponen, seperti yang ditunjukkan pada gambar di bawah ini. <br><br><img src="https://habrastorage.org/webt/lm/lt/ty/lmlttyypf34eysahxyd0kplpuhu.png"><br>  <i>Gambar 3. Komponen terenkripsi (kiri) versus komponen terenkripsi (kanan)</i> <br><br>  Komponen diatur ulang ke <i>C: \ Users \ Public \ Documents \ AcrobatReader.txt</i> dan mengonversi file ke <i>C: \ Users \ Public \ Documents \ AcrobatReader.exe</i> . <br><br>  Mungkin ini adalah upaya untuk mem-bypass perlindungan PC, yang menghasilkan peringatan ketika file biner mem-flush file dengan ekstensi .exe ke disk. <br><br>  Sekali lagi, operator mencoba untuk menipu korban, dan jika dia memperhatikan direktori, dia akan melihat gambar seperti pada gambar berikut: <br><br><img src="https://habrastorage.org/webt/ql/vj/q3/qlvjq3gqetpqgo5cgyo8-bc9nug.png"><br>  <i>Gambar 4. Komponen terlihat seperti file PDF</i> <br><br>  Secara default, Windows menyembunyikan ekstensi, dan ini digunakan oleh penyerang yang membuang file yang dapat dieksekusi ke folder Documents dan menyamarkannya sebagai PDF. <br><br>  Akhirnya, dropper mengeksekusi komponen yang di-host dan keluar. <br><br><h3>  MSIL Mail Loader </h3><br>  Komponen yang dikirim dari dropper sebelumnya adalah loader MSIL yang dikemas dengan UPX.  Untuk pemahaman yang lebih baik, logika proses dijelaskan di bawah ini, kemudian kode sumber diberikan dan skema kontrol dipertimbangkan. <br><br>  Metode utama memanggil <i>Jalankan</i> untuk meluncurkan aplikasi, yang kemudian membuat <i>Form1</i> . <br><br><pre> <code class="plaintext hljs">{   Application.EnableVisualStyles();   Application.SetCompatibleTextRenderingDefault(false);   Application.Run((Form) new Form1()); }</code> </pre> <br>  <i>Form1</i> memberikan banyak variabel, termasuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Timer</a> baru untuk tujuh dari mereka. <br><br><pre> <code class="plaintext hljs">   this.start = new Timer(this.components);  this.inf = new Timer(this.components);   this.txt = new Timer(this.components);   this.subject = new Timer(this.components);   this.run = new Timer(this.components);   this.load = new Timer(this.components);   this.screen = new Timer(this.components);</code> </pre> <br>  Objek Timer memiliki tiga bidang penting: <br><br><ul><li>  Diaktifkan: Menunjukkan status timer yang diaktifkan. </li><li>  Interval: waktu antar peristiwa dalam milidetik </li><li>  Centang: callback dijalankan setelah timer kedaluwarsa dan jika timer menyala </li></ul><br>  Bidang ditunjukkan sebagai berikut: <br><br><pre> <code class="plaintext hljs">  this.start.Enabled = true;   this.start.Interval = 120000;   this.start.Tick += new EventHandler(this.start_Tick);   this.inf.Interval = 10000;   this.inf.Tick += new EventHandler(this.inf_Tick);   this.txt.Interval = 120000;   this.txt.Tick += new EventHandler(this.txt_Tick);   this.subject.Interval = 120000;   this.subject.Tick += new EventHandler(this.subject_Tick);   this.run.Interval = 60000;   this.run.Tick += new EventHandler(this.run_Tick);   this.load.Interval = 120000;   this.load.Tick += new EventHandler(this.load_Tick);   this.screen.Interval = 8000;   this.screen.Tick += new EventHandler(this.screen_Tick);</code> </pre> <br>  Untuk setiap objek, interval <i>Interval</i> diatur dari 8 detik hingga 2 menit.  Panggilan balik ditambahkan ke pengendali acara.  Perhatikan bahwa hanya <i>mulai</i> menetapkan nilai menjadi true untuk <i>Diaktifkan</i> , yang berarti bahwa setelah 2 menit (12.000 milidetik = 120 detik), <i>start_Tick</i> akan dipanggil oleh pengendali acara. <br><br><pre> <code class="plaintext hljs">   private void start_Tick(object sender, EventArgs e)   {       try       {           this.start.Enabled = false;           Lenor lenor = new Lenor();           this.dir = !Directory.Exists(this.label15.Text.ToString()) ? this.label16.Text.ToString() + "\" : this.label15.Text.ToString() + "\";           this.att = this.dir + "audev.txt";           this._id = lenor.id(this.dir);           this.inf.Enabled = true;       }</code> </pre> <br>  Selanjutnya, setiap metode menunjukkan perilaku yang identik - mengubah nilai <i>Diaktifkan</i> ke <i>false</i> di awal.  Metode ini dijalankan, dan kemudian mengubah nilai <i>Diaktifkan</i> dari objek berikutnya menjadi <i>true</i> , yang mengaktifkan timer berikutnya.  Variabel yang <i>Diaktifkan</i> digunakan oleh operator untuk membuat sesuatu seperti mesin negara - jika fungsi tidak bekerja, mekanisme mengulangi pelaksanaannya hingga menerima hasil yang positif.  Waktu antara eksekusi dua fungsi dapat digunakan sebagai upaya untuk mem-bypass perlindungan anti-virus dengan menambahkan penundaan. <br><br>  Sekarang, setelah menjelaskan struktur masing-masing metode, kami beralih ke algoritma kontrol.  Berikut ini adalah ikhtisar langkah-langkah dalam bentuk bertukar email antar kotak surat. <br><br><img src="https://habrastorage.org/webt/hd/zj/tl/hdzjtlq57qrzyht5k_lsydclpxm.png"><br>  <i>Gambar 5. Pertukaran email</i> <br><br>  Malvar memeriksa keberadaan jalur khusus yang digunakan untuk membuang setiap file selama eksekusi.  Jika memungkinkan, gunakan <i>C: \ Users \ Public \ Videos \</i> , jika tidak <i>C: \ Documents and Settings \ All Users \ Documents \</i> sebagai direktori default.  Harap dicatat bahwa jalur kedua khusus untuk Windows XP, sedangkan jalur pertama khusus untuk Vista dan lebih tinggi. <br><br>  <i>ID</i> 16-byte dihasilkan dengan menggabungkan nomor seri volume C: dan nama pengguna;  itu disimpan dalam file <i>audev.txt</i> . <br><br>  Bootloader mengumpulkan informasi berikut: <br>  - jalur aplikasi saat ini <br>  - versi sistem operasi <br>  - direktori sistem <br>  - domain pengguna <br>  - nama mobil <br>  - nama pengguna <br>  - zona waktu saat ini <br>  - tanggal sekarang <br>  - daftar drive logis dan informasi tentang masing-masing (model, nomor seri, dll.) <br>  - daftar direktori <i>C: \ Program Files \</i> dan <i>C: \ Program Files (x86) \</i> <br>  - daftar proses <br><br>  Data ini disimpan dalam file <i>C: \ Users \ Public \ Videos \ si.ini</i> dan dikirim melalui surat dalam lampiran melalui SMTPS menggunakan port default 465. Badan pesan berisi baris <i>SI</i> (yang mungkin berarti Informasi Sistem), penerima pesan adalah <i>sym777. g@post.cz</i> .  Untuk seluruh pertukaran informasi, subjek surat diindikasikan sebagai <i>id</i> . <br><br>  Operator memutuskan untuk membuat beberapa alamat cadangan dan mengirim surat yang sama ke dua penerima lainnya, kemungkinan besar, jika alamat utama tidak berfungsi.  Setelah mengirim surat, bootloader menghapus file <i>si.ini</i> . <br><br>  Selama menjalankan pertama dari malware, file <i>set.txt dibuat</i> dengan teks <i>{System_Parametrs = 10}</i> di dalam dan entri di kunci registri Windows. <br><br><img src="https://habrastorage.org/webt/hl/eh/ge/hlehgecuzoyjoygnnlt6c1q2l58.png"><br>  <i>Gambar 6. Kegigihan dalam registri</i> <br><br>  Satu tangkapan layar <i>diambil</i> dengan nama <i>scx.bin</i> dari komputer korban dan dikirim melalui lampiran email dengan teks <i>SC</i> (yang mungkin berarti Screenshot) di badan pesan. <br><br>  Setelah mengirim, malware menghubungi kotak surat <i>kae.mezhnosh@post.cz</i> menggunakan protokol POP3 melalui SSL (port 995) dan mencari pesan dengan subjek yang sesuai dengan <i>id</i> .  Jika pesan seperti itu ada dan isi tidak kosong, malware mendekripsi dan mengirimkan pesan dengan <i>okey</i> di badan untuk <i>sym777.g@post.cz</i> .  Isi dari pesan yang diterima sebelumnya dihapus dan diuraikan sebagai berikut: <br><br><pre> <code class="plaintext hljs">string[] strArray = this._adr.Replace("B&amp;", "").Replace("Db", "").Split('%');       string str1 = strArray[0];       string str2 = strArray[1];</code> </pre> <br>  Dua baris diperoleh: yang pertama adalah kata sandi, dan yang kedua adalah nama pengguna untuk alamat surat. <br><br>  Kredensial baru digunakan untuk menghubungkan ke kotak surat yang diterima, mencari pesan dengan topik yang cocok dengan <i>id</i> malvari, dan aplikasi dengan string <i>audev</i> dalam nama file.  Jika kedua kondisi terpenuhi, malware menyimpan aplikasi dan menghapus pesan dari server. <br><br>  Log pesan dikirim ke <i>sym777.g@post.cz</i> , dan pesan yang diterima melalui POP3 berasal dari penerima dengan data pengguna yang baru saja diterima. <br><br>  Skema serangan mempersulit penyelidikan.  Pertama, jika Anda memiliki bootloader dengan huruf, Anda tidak dapat terhubung ke kotak surat yang berisi langkah selanjutnya. <br><br>  Kedua, jika Anda menerima kredensial untuk surat, Anda masih tidak bisa mendapatkan muatan berikutnya karena dihapus setelah penerimaan. <br><br>  Ketika bootloader berhasil menulis lampiran ke disk, ia mengirim pesan melalui pos dengan <i>okey2</i> di tubuh dan lampiran <i>l.txt yang</i> berisi <i>090</i> .  File yang sama ditimpa dengan nol, dan malware mencoba untuk mendapatkan pesan lain.  Jika ini berhasil, file <i>l.txt dikirim</i> dengan <i>okey3</i> di badan.  Isi lampiran adalah direktori dan nama file.  Malvar memindahkan file audev ke alamat ini.  Akhirnya, malware mengirim email dengan <i>okey4</i> di badan dan <i>l.txt</i> di lampiran.  Ini meluncurkan file yang dapat dieksekusi, <i>audev.exe,</i> dan memeriksa keberadaan garis <i>audev</i> dalam daftar proses. <br><br><pre> <code class="plaintext hljs">  Process.Start(this.rn);   foreach (Process process in Process.GetProcesses())   {       if (process.ProcessName.Contains("audev")) }</code> </pre> <br>  Jika nama tersebut ditemukan, surat terakhir akan dikirim, yang berisi isi <i>okey5</i> dan <i>l.txt</i> di lampiran.  Akhirnya, <i>l.txt</i> dan <i>set.txt</i> dihapus, kunci registri Windows yang dibuat dihapus, dan program berakhir. <br><br><h3>  Pengunduh Email Delphi </h3><br>  Peran utama dari bootloader adalah menilai pentingnya sistem yang dikompromikan dan, jika tampaknya menarik, muat dan jalankan bootloader Zebrocy terbaru. <br><br>  File biner ditulis dalam Delphi dan dikemas menggunakan UPX.  Definisi lengkap objek <i>TForm1</i> dapat ditemukan di bagian dengan sumber dayanya, ini menunjukkan beberapa parameter konfigurasi yang digunakan.  Bagian berikut ini menjelaskan inisialisasi, kemampuan, dan protokol jaringan bootloader. <br><br><h3>  Inisialisasi </h3><br>  Pertama, dekripsi set string yang merupakan alamat email dan kata sandi.  Operator menerapkan algoritma enkripsi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">AES ECB</a> .  Setiap baris didekripsi di tempat heksadesimal, di mana empat byte pertama sesuai dengan ukuran akhir dari baris yang didekripsi (garis yang didekripsi pada bagian akhir mungkin mengandung beberapa indentasi).  Objek <i>TForm1</i> berisi dua kunci AES: yang pertama digunakan untuk mengenkripsi data, dan yang kedua digunakan untuk mendekripsi. <br><br>  Alamat email dan kata sandi digunakan oleh operator untuk mengirim perintah ke malvari, serta untuk memperoleh informasi yang dikumpulkan dari komputer korban.  Protokol komunikasi SMTP dan POP3 diterapkan - baik melalui SSL.  Untuk menggunakan OpenSSL, malware menjatuhkan dan menggunakan dua pustaka dinamis OpenSSL: <i>libeay32.dll (98c348cab0f835d6cf17c3a31cd5811f86c0388b)</i> dan <i>ssleay32.dll (6d981d71895581dfb103170486b8614f7f203bdc)</i> . <br><br><img src="https://habrastorage.org/webt/fo/vl/_6/fovl_6evpu2kfxhr3b-4kcjeets.png"><br>  <i>Gambar 7. Properti OpenSSL DLL</i> <br><br>  Harap dicatat bahwa semua file dibuang ke direktori kerja malware <i>: C: \ Users \ Public \</i> . <br><br>  Kegigihan diberikan selama eksekusi pertama malvari melalui <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">teknik</a> penulisan skrip entri yang terkenal.  File dengan skrip <i>registrasi.bat</i> dibuat dan beberapa baris ditulis dari objek <i>TForm1</i> .  Script terakhir adalah sebagai berikut: <br><br><pre> <code class="plaintext hljs">reg add HKCU\Environment /v "UserInitMprLogonScript" /t REG_EXPAND_SZ /d "C:\Users\Public\Videos\audev.exe" /f del C:\Users\Public\Videos\registr.bat exit</code> </pre> <br>  Last but not least, malware menciptakan <i>id</i> , dengan cara yang sama seperti dalam biner Zebrocy yang dijelaskan sebelumnya.  Itu mendapatkan nama pengguna menggunakan <i>GetUserNameW</i> Windows API dan menambahkan nomor seri drive C: \ ke awal. <br><br><h3>  Kemungkinan </h3><br>  Mengingat bahwa ada beberapa kondisi dan prosedur untuk mengumpulkan informasi tentang korban, berikut ini adalah deskripsi dari berbagai kemampuannya.  Konfigurasi pemindaian disimpan dalam objek <i>TForm1</i> , di mana tujuh kemungkinan berbeda untuk mengumpulkan informasi dari komputer korban dikelompokkan. <br><br>  Dimulai dengan pemindaian sederhana, informasi pertama yang dapat diperoleh malware terkait dengan file dengan ekstensi berikut: <i>.docx, .xlsx, .pdf, .pptx, .rar, .zip, .zip, .jpg, .bmp, .tiff</i> .  Untuk setiap file yang ditemukan pada disk, malware menerima jalur lengkap dan tanggal modifikasi terakhir.  Informasi ini dienkripsi menggunakan kunci AES, yang telah kita bicarakan sebelumnya, dan disimpan dalam file <i>0.txt</i> .  Pemindaian lain ditujukan pada ekstensi <i>.dat, .json, .db</i> dan, seperti dalam kasus sebelumnya, mendapatkan path lengkap dan tanggal terakhir file diubah.  Itu kemudian mengenkripsi mereka dan menyimpannya di file <i>57.txt</i> . <br><br>  Daftar proses yang berjalan adalah fitur lain dari malvari yang memungkinkan Anda untuk menyimpan informasi dalam file <i>08.txt</i> .  Ini terlihat seperti ini: <br><br><pre> <code class="plaintext hljs">======Listing_of_processes======= [System Process] System smss.exe csrss.exe wininit.exe csrss.exe winlogon.exe services.exe lsass.exe [‚Ä¶]</code> </pre> <br>  File <i>i.txt</i> mengumpulkan informasi umum tentang komputer korban, serta beberapa informasi tentang malvari (nomor versi dan jalur yang digunakan untuk menjalankannya).  Lihat contoh di bawah ini: <br><br><pre> <code class="plaintext hljs">v7.00 C:\Users\Public\Videos\audev.txt ============================================ Log_Drivers: C: fixed; size= 102297 Mb, free=83927 Mb S/N: [redacted] ================================================== OSV: Windows 7 WinType: 32 WinDir: C:\Windows Lang: English (United States) TZ: UTC1:0 Romance Standard Time HostN: [redacted]-PC User: [redacted] ===============S_LIST===================== C:\Program Files\Common Files C:\Program Files\desktop.ini C:\Program Files\DVD Maker C:\Program Files\Internet Explorer C:\Program Files\Microsoft.NET C:\Program Files\MSBuild C:\Program Files\Reference Assemblies C:\Program Files\Uninstall Information C:\Program Files\Windows Defender [‚Ä¶]</code> </pre> <br>  Malware dapat mengambil tangkapan layar, yang disimpan dalam format <i>2 \ [YYYY-mm-dd HH-MM-SS] -Image_001.jpg</i> , dan menghasilkan file lain <i>2 \ sa.bin</i> , diisi dengan daftar jalur ke file semua tangkapan layar yang diambil.  Opsi terakhir adalah daftar komponen jaringan dan data sistem, hasilnya ditulis dalam <i>4.txt</i> . <br><br><h3>  Protokol jaringan </h3><br>  Pemuat surat Delphi adalah tambahan yang relatif baru untuk Zebrocy toolkit, ini menyediakan cara baru untuk mengekstrak data dan menerima perintah dari operator.  Eksfiltrasi cukup sederhana, tetapi membuat banyak kebisingan di jaringan, karena file terenkripsi yang dikumpulkan sebelumnya dikirim melalui SMTPS, setiap versi file tiga kali. <br><br><img src="https://habrastorage.org/webt/tw/xe/if/twxeif5sgovtnxjkuxhrcmcqyze.png"><br><br>  Subjek pesan adalah <i>id</i> korban, dan file dikirim sebagai lampiran dengan kata kunci yang sesuai dengan isi file.  Harap dicatat bahwa untuk setiap file ada versi terenkripsi yang dikirim. <br><br><img src="https://habrastorage.org/webt/pn/pv/1m/pnpv1mmbkhhjs3qfrxa2uthwsky.png"><br><br>  Tangkapan layar dan file untuk kedua pemindaian juga dikirim, tetapi dengan kata kunci yang berbeda. <br><br><img src="https://habrastorage.org/webt/vu/s8/32/vus8328b9llia3xsyobiyqmnejw.png"><br><br><img src="https://habrastorage.org/webt/x9/ds/0h/x9ds0hckegel5ayp75d4nmkgtuc.png"><br>  <i>Gambar 8. Contoh pesan dengan data yang dikirim</i> <br><br>  Sementara SMTP digunakan untuk exfiltrasi data, file biner terhubung ke <i>alamat</i> surat <i>tomasso25@ambcomission.com</i> melalui POP3 dan penguraian pesan.  Isi surat berisi berbagai kata kunci yang ditafsirkan oleh malware sebagai perintah. <br><br><img src="https://habrastorage.org/webt/wg/de/u7/wgdeu7jmqergcyp8lkyt4tk8ogs.png"><br><br>  Setelah eksekusi, log debugger dan hasil dari perintah (jika ada) dikirim kembali ke operator.  Misalnya, setelah perintah pemindaian, operator menerima file yang berisi daftar file dengan ekstensi yang cocok bersama dengan setiap file tersebut. <br><br>  Sementara bootloader ini memiliki fungsi-fungsi backdoor, ia menjalankan sistem bootloader pada Delphi, yang sudah dikaitkan dengan grup ini, yang kami jelaskan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel</a> sebelumnya tentang Zebrocy. <br><br><h3>  Kesimpulan </h3><br>  Di masa lalu, kita telah melihat persimpangan Zebrocy dan malware Sednit tradisional.  Kami menangkap Zebrocy membuang pintu belakang unggulan Sednit ke sistem XAgent, jadi kami menghubungkan kepenulisan Zebrocy dengan cybergroup ini dengan keyakinan tinggi. <br><br>  Namun demikian, analisis file biner mengungkapkan kesalahan pada tingkat bahasa, serta pengembangan, menunjukkan tingkat kualifikasi yang berbeda dari penulis.  Kedua bootloader menggunakan protokol surat untuk mengekstrak data dan memiliki mekanisme yang sama untuk mengumpulkan informasi yang sama.  Namun, mereka membuat banyak suara di jaringan dan sistem, membuat banyak file dan mengirimkannya.  Dalam proses menganalisis pemuat surat pada Delphi, tampak bagi kami bahwa beberapa fungsi telah hilang, tetapi garis masih tetap dalam file biner.  Toolkit ini digunakan oleh tim Sednit, tetapi kami percaya bahwa ini sedang dikembangkan oleh tim lain - kurang berpengalaman dibandingkan dengan pencipta komponen Sednit tradisional. <br><br>  Komponen Zebrocy adalah tambahan untuk toolkit Sednit, dan peristiwa baru-baru ini dapat menjelaskan peningkatan penggunaan aktif binari Zebrocy alih-alih malvari tradisional. <br><br><h3>  Indikator kompromi </h3><br><br>  <b>Nama File, SHA-1, dan Deteksi oleh Produk ESET</b> <br><br>  1. SCANPASS_QXWEGRFGCVT_323803488900X_jpeg.exe - 7768fd2812ceff05db8f969a7bed1de5615bfc5a - <b>Win32 / Sednit.ORQ</b> <br>  2. C: \ Users \ public \ Pictures \ scanPassport.jpg - da70c54a8b9fd236793bb2ab3f8a50e6cd37e2df <br>  3. C: \ Users \ Public \ Documents \ AcrobatReader. {Exe, txt} - a225d457c3396e647ffc710cd1edd4c74dc57152 - <b>MSIL / Sednit.D</b> <br>  4. C: \ Users \ Public \ Videos \ audev.txt - a659a765536d2099ecbde988d6763028ff92752e - <b>Win32 / Sednit.CH</b> <br>  5.% TMP% \ Indy0037C632.tmp - 20954fe36388ae8b1174424c8e4996ea2689f747 - <b>Win32 / TrojanDownloader.Sednit.CMR</b> <br>  6.% TMP% \ Indy01863A21.tmp - e0d8829d2e76e9bb02e3b375981181ae02462c43 - <b>Win32 / TrojanDownloader.Sednit.CMQ</b> <br><br>  <b>Email</b> <br><br>  <i>carl.dolzhek17@post.cz</i> <i><br></i>  <i>shinina.lezh@post.cz</i> <i><br></i>  <i>P0tr4h4s7a@post.cz</i> <i><br></i>  <i>carl.dolzhek17@post.cz</i> <i><br></i>  <i>sym777.g@post.cz</i> <i><br></i>  <i>kae.mezhnosh@post.cz</i> <i><br></i>  <i>tomasso25@ambcomission.com</i> <i><br></i>  <i>kevin30@ambcomission.com</i> <i><br></i>  <i>salah444@ambcomission.com</i> <i><br></i>  <i>karakos3232@seznam.cz</i> <i><br></i>  <i>rishit333@ambcomission.com</i> <i><br></i>  <i>antony.miloshevich128@seznam.cz</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id437236/">https://habr.com/ru/post/id437236/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id437226/index.html">Kelvin Point Shadow</a></li>
<li><a href="../id437228/index.html">Bitcoin, sebagai mata uang, akan mengarah pada krisis ekonomi</a></li>
<li><a href="../id437230/index.html">Periklanan online yang sangat berbeda. Tiga sumbu vs AI, Teknologi Iklan, dan DOOH</a></li>
<li><a href="../id437232/index.html">Bagus juga</a></li>
<li><a href="../id437234/index.html">Kami mulai mempelajari mikrokontroler menggunakan contoh STM32F030f4p6</a></li>
<li><a href="../id437238/index.html">Orange Pi 3 dirilis - mini-pc $ 30 penuh di Linux</a></li>
<li><a href="../id437240/index.html">Bagaimana cara mengintegrasikan Zimbra Collaboration Suite dengan Active Directory</a></li>
<li><a href="../id437242/index.html">Penguasaan manajer produk. Permintaan fitur</a></li>
<li><a href="../id437244/index.html">Google mengajarkan pengguna untuk mengenali email phising</a></li>
<li><a href="../id437248/index.html">FPGA mitap di St. Petersburg</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>