<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ‚Äçüè≠ ‚õëÔ∏è üßëüèª Gerenciando o Windows Server a partir do Centro de Administra√ß√£o do Windows üôãüèº üòπ üï∫üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Neste artigo, continuamos falando sobre o trabalho com o Windows Server Core 2019. Nas postagens anteriores, falamos sobre como preparamos m√°quinas vi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gerenciando o Windows Server a partir do Centro de Administra√ß√£o do Windows</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ultravds/blog/476416/">  Neste artigo, continuamos falando sobre o trabalho com o Windows Server Core 2019. Nas postagens anteriores, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">falamos sobre</a> como preparamos m√°quinas virtuais clientes usando o exemplo da nossa nova tarifa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">VDS Ultralight</a> com o Server Core por 99 rublos.  Em seguida, eles <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">mostraram</a> como trabalhar com o Windows Server 2019 Core e como instalar uma GUI nele.  Hoje falaremos sobre como gerenciar com o Windows Admin Center. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/q0/tg/25/q0tg25azhtnd9dcqre4n3hwrgmy.jpeg"></a> <a name="habracut"></a>  <sub>Foto: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">TASS</a></sub> <br><br>  Por motivos de seguran√ßa, a dor de cabe√ßa provavelmente foi separar as fun√ß√µes de servidor.  Inicie v√°rias m√°quinas para separar fisicamente o controlador de dom√≠nio e o servidor de arquivos. <br>  Felizmente, a virtualiza√ß√£o veio em nosso aux√≠lio e agora v√°rios servi√ßos podem funcionar isolados um do outro, o que, por raz√µes de seguran√ßa, n√£o pode funcionar no mesmo servidor.  A virtualiza√ß√£o trouxe muita comodidade, a implanta√ß√£o de m√°quinas virtuais a partir de um √∫nico modelo economiza tempo dos especialistas e, fisicamente, tudo em uma caixa com um hardware poderoso. <br><br>  Existem menos m√°quinas, e h√° cada vez mais servidores, at√© para mim, para "apenas ver" dois controladores de dom√≠nio formados, um servidor de arquivos, um servidor para aplicativos Java e v√°rios servidores da Web. Vamos falar sobre como gerenciar com efici√™ncia os servidores Windows, sem levantar a m√£o esquerda do caf√©. <br><br>  - Usando o PowerShell! <br><br>  Claro que sim, mas ... n√£o.  O produto est√° posicionado como uma ferramenta conveniente para gerenciar uma infraestrutura gigante.  √â claro que isso n√£o √© inteiramente verdade; nesses casos, existem Powershell ISE e scripts, ent√£o eu gostaria de considerar casos de usu√°rios realmente √∫teis.  Se voc√™ tem sua pr√≥pria experi√™ncia que deseja compartilhar, podemos adicion√°-la a este artigo. <br><br><h2>  TL; DR </h2><br>  O Windows Admin Center √© melhor para gerenciar componentes de estoque.  Atualmente, apenas o RSAT pode gerenciar fun√ß√µes estabelecidas. <br><br>  Usando o WAC, voc√™ pode melhorar a seguran√ßa de sua infraestrutura se us√°-la como um gateway. <br><br>  Uma tabela resumida disso, ele sabe como e n√£o sabe: <br><br>  <b>Gerenciamento do sistema</b> <br><div class="scrollable-table"><table><tbody><tr><th></th><th width="220">  Wac </th><th width="220">  RSAT </th></tr><tr><td>  Gerenciamento de componentes </td><td>  Sim </td><td>  Sim </td></tr><tr><td>  Editor do Registro <br></td><td>  Sim <br></td><td>  N√£o <br></td></tr><tr><td>  Gerenciamento de rede <br></td><td>  Sim <br></td><td>  Sim <br></td></tr><tr><td>  Visualizador de Eventos <br></td><td>  Sim <br></td><td>  Sim <br></td></tr><tr><td>  Pastas compartilhadas <br></td><td>  Sim <br></td><td>  Sim <br></td></tr><tr><td>  Gerenciamento de unidades <br></td><td>  Sim <br></td><td>  Somente para servidores com uma GUI <br></td></tr><tr><td>  Agendador de tarefas <br></td><td>  Sim <br></td><td>  Sim <br></td></tr><tr><td>  Gerenciamento de dispositivos <br></td><td>  Sim <br></td><td>  Somente para servidores com uma GUI <br></td></tr><tr><td>  Gerenciamento de arquivos <br></td><td>  Sim <br></td><td>  N√£o <br></td></tr><tr><td>  Gerenciamento de usu√°rios <br></td><td>  Sim <br></td><td>  Sim <br></td></tr><tr><td>  Gerenciamento de grupo <br></td><td>  Sim <br></td><td>  Sim <br></td></tr><tr><td>  Gerenciamento de certificado <br></td><td>  Sim <br></td><td>  Sim <br></td></tr><tr><td>  Atualiza√ß√µes <br></td><td>  Sim <br></td><td>  N√£o <br></td></tr><tr><td>  Desinstalar programas <br></td><td>  Sim <br></td><td>  N√£o <br></td></tr><tr><td>  Monitor do sistema <br></td><td>  Sim <br></td><td>  Sim <br></td></tr></tbody></table></div><br>  <b>Gerenciamento de fun√ß√µes</b> <br><div class="scrollable-table"><table><tbody><tr><th></th><th width="220">  Wac <br></th><th width="220">  RSAT <br></th></tr><tr><td>  Prote√ß√£o avan√ßada de rosca </td><td>  TEXTO </td><td>  N√£o </td></tr><tr><td>  Defensor do Windows <br></td><td>  TEXTO <br></td><td>  Sim <br></td></tr><tr><td>  Contentores <br></td><td>  TEXTO <br></td><td>  Sim <br></td></tr><tr><td>  Centro Administrativo do AD <br></td><td>  TEXTO <br></td><td>  Sim <br></td></tr><tr><td>  Dom√≠nio e rela√ß√µes de confian√ßa do AD <br></td><td>  N√£o <br></td><td>  Sim <br></td></tr><tr><td>  Sites e servi√ßos do AD <br></td><td>  N√£o <br></td><td>  Sim <br></td></tr><tr><td>  DHCP <br></td><td>  TEXTO <br></td><td>  Sim <br></td></tr><tr><td>  DNS <br></td><td>  TEXTO <br></td><td>  Sim <br></td></tr><tr><td>  Gerente DFS <br></td><td>  N√£o <br></td><td>  Sim <br></td></tr><tr><td>  Gerente de GPO <br></td><td>  N√£o <br></td><td>  Sim <br></td></tr><tr><td>  Gerenciador do IIS <br></td><td>  N√£o <br></td><td>  Sim <br></td></tr></tbody></table></div><br>  Visualizar - instalar vers√µes beta de componentes para WAC, n√£o faz parte da montagem.  N√£o √© necess√°rio listar tudo, porque literalmente todos os componentes s√£o controlados apenas com o RSAT. <br><br><h2>  Nuances </h2><br>  O PowerShell no Windows Admin Center n√£o possui seu pr√≥prio ambiente de script semelhante ao Powershell ISE. <br>  O Windows Admin Center n√£o oferece suporte ao Powershell abaixo de 5.0; em m√°quinas mais antigas, voc√™ deve instalar o novo Powershell se desejar us√°-lo. <br><br>  A principal desvantagem do Windows Admin Center em micro inst√¢ncias √© o consumo de RAM do servidor.  Ele cria quatro sess√µes de 50 a 60 megabytes cada, e cada sess√£o permanece mesmo ap√≥s o fechamento do Windows Admin Center. <br><br>  O mesmo problema com o Powershell via Enter-PSSession, ele tamb√©m cria uma nova sess√£o e, se voc√™ fechar a janela do terminal, uma sess√£o com 70 megabytes permanecer√° no servidor remoto se voc√™ n√£o o fechar antes de sair do Exit-PSSession ou Remove-Pssession. <br>  Ao usar o Centro de administra√ß√£o do Windows, voc√™ ter√° que aturar isso, isso levar√° cerca de 170 megabytes de RAM, o RSAT n√£o sofre com isso. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/747/210/e4e/747210e4ee5805952f0a10b36cdec9bc.png"></div><br>  <i>(Consulte wsmprovhost.exe)</i> <br><br><h2>  Simplifique o trabalho </h2><br>  A conveni√™ncia m√°xima de gerenciamento √© alcan√ßada se a esta√ß√£o de trabalho na qual o WAC est√° instalado estiver no dom√≠nio.  S√£o necess√°rias as credenciais de um usu√°rio conectado, a conex√£o com os servidores √© realizada com um clique. <br><br>  Voc√™ pode importar a lista de servidores usando um arquivo txt, listando nomes de servidores por avan√ßo de linha, como no RSAT. <br><br>  O que tamb√©m agrada, anteriormente, para integrar uma m√°quina virtual Server Core ao AD, era necess√°rio faz√™-lo atrav√©s do sconfig, o que significa que voc√™ precisa de acesso direto √† sua tela.  No caso de hospedagem, eu tive que fazer tudo isso atrav√©s do VNC.  Agora, quando voc√™ for para a p√°gina principal, poder√° clicar em "Alterar identifica√ß√£o do computador" e entrar no dom√≠nio. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/807/481/d51/807481d51f6b8b1fad7a431bf1681b76.png"><br><br>  A prop√≥sito, para inserir o Windows Server 2019 no dom√≠nio, o Sysprep n√£o √© mais necess√°rio, porque o Sysprep tamb√©m precisava ser conclu√≠do por meio do VNC. <br><br>  Para alterar as configura√ß√µes de rede agora, voc√™ precisa fazer dois cliques.  Conecte-se ao servidor e altere. <br><br>  Ele sai t√£o r√°pido quanto atrav√©s do WinRM, com apenas uma m√£o. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/68a/ce8/01a/68ace801aa6a07ccbd868b8e26984692.png"><br><br><h2>  Aumentar a seguran√ßa </h2><br>  Atualmente, existem quatro tipos de implanta√ß√£o.  Instala√ß√£o local, como gateway, em um dos servidores de produ√ß√£o e como parte de um cluster. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/12d/cca/764/12dcca764475fb2ef3020f0ae96009e5.png"></div><br>  <i>* Imagem do site da Microsoft</i> <br><br>  A instala√ß√£o como um gateway, em um servidor separado, √© a op√ß√£o mais segura e recomendada.  Este √© um an√°logo de um esquema de VPN quando o acesso ao gerenciamento est√° dispon√≠vel apenas em um endere√ßo IP ou se√ß√£o de rede espec√≠fica. <br><br>  Concordo, √© muito mais conveniente manter v√≠deos e memes em uma guia e a Central de administra√ß√£o do Windows na outra do que perder completamente sua conex√£o com o YouTube devido √† entrada em uma rede segura. <br>  Como proteger todos os seus servidores N?  Usando o seguinte script: <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">##     ## $servers = Get-Content -Path .\Servers.txt ##      ## $rules = Get-Content -Path .\Rules.txt ## IP      WAC ## $gate = "1.1.1.1"  $MySecureCreds = Get-Credential  foreach ($server in $servers.Split("`n")) {     foreach ($line in $rules.Split("`n")) {         Invoke-Command -ComputerName $server -ScriptBlock {             Set-NetFirewallRule -Name $Using:line -RemoteAddress $Using:gate         } -Credential $MySecureCreds     } } #  , RULES.txt#  RemoteDesktop-UserMode-In-TCP RemoteDesktop-UserMode-In-UDP WINRM-HTTP-In-TCP WINRM-HTTP-In-TCP-PUBLIC #   , SERVERS.txt#  1.1.1.1, 1.1.1.2, 1.1.1.3</span></span></code> </pre> <br>  Esse script alterar√° as regras de firewall padr√£o de forma que voc√™ possa usar o RDP e o WinRM apenas a partir de um endere√ßo IP espec√≠fico; ser√° necess√°rio organizar o acesso seguro √† infraestrutura. <br><br>  O Powershell no Windows Admin Center n√£o possui seu pr√≥prio ambiente de script semelhante ao Powershell ISE; voc√™ pode chamar apenas scripts prontos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/273/729/b03/273729b0363c6b1d8584fd14e2abd68f.png"><br><br>  A prop√≥sito, √© assim que o RDP se parece no Windows Server Core. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7af/2e1/909/7af2e190944139e15971bcee9acbd777.png"><br><br><h2>  Conclus√µes </h2><br>  Atualmente, o Windows Admin Center n√£o pode substituir o RSAT, no entanto, ele j√° cont√©m fun√ß√µes que o RSAT n√£o possui.  Snap-ins antigos s√£o adicionados, o que n√£o √© t√£o conveniente para gerenciar pelo navegador. <br><br>  A prioridade de desenvolvimento √© estranha, as fun√ß√µes adicionadas mais ativamente s√£o aquelas integradas ao Azure, hospedadas pela Microsoft, em vez de fun√ß√µes realmente √∫teis. <br>  Infelizmente, por enquanto, voc√™ s√≥ pode gerenciar todas as fun√ß√µes do Windows Server com conveni√™ncia se conectando a ele via RDP. <br><br>  Apesar de todas as desvantagens, o Windows Admin Center possui seu pr√≥prio SDK, com o qual voc√™ pode escrever seus pr√≥prios m√≥dulos e gerenciar seu pr√≥prio software atrav√©s dele, o que um dia o tornar√° melhor que o RSAT. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/ww/d4/ro/wwd4ro5_5a28hvdxyazf3enjxou.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt476416/">https://habr.com/ru/post/pt476416/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt476404/index.html">Semana de Seguran√ßa 47: Vulnerabilidades n√£o triviais</a></li>
<li><a href="../pt476406/index.html">Redes neurais no namoro</a></li>
<li><a href="../pt476408/index.html">Retirada de livros</a></li>
<li><a href="../pt476412/index.html">Hannes Lindemann v. Alain Bombard: desmascarando um mito?</a></li>
<li><a href="../pt476414/index.html">Identifique a atividade do disco do Linux</a></li>
<li><a href="../pt476418/index.html">Startups: 10 sugest√µes de 20 aulas na Universidade de Stanford</a></li>
<li><a href="../pt476420/index.html">Comece a usar o ReactiveX no dardo e no Flutter desde o in√≠cio</a></li>
<li><a href="../pt476424/index.html">Estruturas - mais desvantagens do que vantagens</a></li>
<li><a href="../pt476428/index.html">Nginx VTS Stats, Mockify - API mock, compara√ß√£o Wiremock e Mockify</a></li>
<li><a href="../pt476430/index.html">Como criar o portf√≥lio t√©cnico perfeito</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>