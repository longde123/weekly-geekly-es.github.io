<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ñ™Ô∏è ü§≥üèø üç∏ RSA blockchain acak üôç üëè ‚ÜôÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ada masalah - sulit untuk menghasilkan nomor acak di jaringan yang didesentralisasi. Hampir semua blockchain telah mengalami ini. Memang, dalam jaring...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>RSA blockchain acak</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/waves/blog/464357/"> Ada masalah - sulit untuk menghasilkan nomor acak di jaringan yang didesentralisasi.  Hampir semua blockchain telah mengalami ini.  Memang, dalam jaringan di mana tidak ada kepercayaan di antara pengguna, penciptaan nomor acak yang tak terbantahkan memecahkan banyak masalah. <br><br>  Artikel ini menceritakan cara mengatasi masalah menggunakan game sebagai contoh.  Yang pertama adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pohon Natal Gelombang</a> .  Untuk pengembangan, kami membutuhkan generator angka acak. <br><br><img src="https://habrastorage.org/webt/nq/lx/gi/nqlxgizojulzpf3ydp-rmq8g9fc.png"><br><a name="habracut"></a><br>  Awalnya, kami berencana untuk menghasilkan nomor berdasarkan informasi dari blockchain.  Namun, kemudian menjadi jelas: jumlahnya bisa dicurangi, yang berarti solusinya tidak cocok. <br><br>  Kami menemukan solusi: gunakan skema pengungkapan komitmen.  Server "menebak" angka dari 1 hingga 5, menambahkan "garam" ke dalamnya, dan kemudian <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mengacak</a> hasilnya menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">fungsi Keccak</a> .  Server pra-menyebarkan kontrak pintar dengan nomor yang sudah disimpan.  Ternyata permainan dikurangi menjadi fakta bahwa pengguna menebak nomor yang disembunyikan oleh hash. <br><br>  Pemain membuat taruhan, dan server mengirim nomor yang diminta dan "garam" ke kontrak pintar.  Dalam bahasa yang sederhana, ia mengungkapkan kartunya.  Setelah itu, server memverifikasi nomor dan memutuskan apakah pengguna menang atau kalah. <br><br>  Jika server tidak mengirim nomor atau "garam" untuk verifikasi, pengguna menang.  Dalam hal ini, untuk setiap pertandingan itu perlu untuk menggunakan kontrak pintar di muka dan meletakkan potensi kemenangan di dalamnya.  Ternyata tidak nyaman, panjang dan mahal.  Saat itu, tidak ada solusi aman lainnya. <br><br>  Baru-baru ini, tim Tradisys telah mengusulkan penambahan fungsi <b>rsaVerify ()</b> ke protokol Waves.  Ini memverifikasi validitas tanda tangan RSA berdasarkan kunci publik dan pribadi.  Akibatnya, fungsi itu ditambahkan. <br><br>  Kami mengembangkan tiga game: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dice Roller</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Coin Flip</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ride On Waves</a> .  Setiap menerapkan teknologi angka acak.  Mari kita lihat cara kerjanya. <br><br><img src="https://habrastorage.org/webt/tu/b5/bx/tub5bxgtyithovcsurhvcbkhgw8.png"><br><br>  Pertimbangkan pembuatan bilangan acak menggunakan Ride on Waves sebagai contoh.  Kontrak pintar dapat ditemukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br>  Buka tab <b>Skrip</b> dan pilih <b>Dompilasi</b> .  Lihat kode kontrak pintar (skrip alias). <br><br><img src="https://habrastorage.org/webt/s2/93/x-/s293x-xhotbeck3_j1ghquvhbmo.png"><br><br>  Kode kontrak pintar berisi serangkaian fungsi.  Yang ditandai sebagai @Callable dapat dipicu menggunakan <b>transaksi</b> Invokasi.  Kami tertarik pada dua fungsi: <b>bertaruh</b> dan <b>menarik</b> : <br><br><ul><li>  func bet (pemain Pilih) </li><li>  func withdraw (gameId, rsaSign) </li></ul><br>  1. Pengguna memilih panjang segmen dan ukuran taruhan. <br><br><img src="https://habrastorage.org/webt/7s/0a/qu/7s0aqupmfkhtboadeg0bhtxpyrk.png"><br><br>  2. Klien membentuk fungsi taruhan.  Untuk gambar di atas, ini akan menjadi <b>taruhan ("50")</b> . <br><br>  3. Klien mengirimkan transaksi Invokasi ke alamat kontrak pintar (broadcast InvocationTx).  Transaksi sebagai parameter Panggilan berisi fungsi taruhan.  Ini berarti bahwa transaksi Doa memulai pelaksanaan fungsi taruhan (pilihan: String) pada kontrak pintar. <br><br><img src="https://habrastorage.org/webt/gz/xx/r4/gzxxr4qfp3qzavthif-gifp6k3y.png"><br><br>  4. Pertimbangkan fungsi taruhan: <br><br><pre><code class="scala hljs"><span class="hljs-meta"><span class="hljs-meta">@Callable</span></span>(i) func bet (playerChoice) = { let newGameNum = <span class="hljs-type"><span class="hljs-type">IncrementGameNum</span></span>() let gameId = toBase58String(i.transactionId) let pmt = extract(i.payment) let betNotInWaves = isDefined(pmt.assetId) let feeNotInWaves = isDefined(pmt.assetId) let winAmt = <span class="hljs-type"><span class="hljs-type">ValidateBetAndDefineWinAmt</span></span>(pmt.amount, playerChoice) let txIdUsed = isDefined(getString(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, gameId)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (betNotInWaves) then <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> (<span class="hljs-string"><span class="hljs-string">"Bet amount must be in Waves"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (feeNotInWaves) then <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> (<span class="hljs-string"><span class="hljs-string">"Transaction's fee must be in Waves"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (txIdUsed) then <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> (<span class="hljs-string"><span class="hljs-string">"Passed txId had been used before. Game aborted."</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { let playerPubKey58 = toBase58String(i.callerPublicKey) let gameDataStr = <span class="hljs-type"><span class="hljs-type">FormatGameDataStr</span></span>(<span class="hljs-type"><span class="hljs-type">STATESUBMITTED</span></span>, playerChoice, playerPubKey58, height, winAmt, <span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-type"><span class="hljs-type">ScriptResult</span></span>(<span class="hljs-type"><span class="hljs-type">WriteSet</span></span>(cons(<span class="hljs-type"><span class="hljs-type">DataEntry</span></span>(<span class="hljs-type"><span class="hljs-type">RESERVATIONKEY</span></span>, <span class="hljs-type"><span class="hljs-type">ValidateAndIncreaseReservedAmt</span></span>(winAmt)), cons(<span class="hljs-type"><span class="hljs-type">DataEntry</span></span>(<span class="hljs-type"><span class="hljs-type">GAMESCOUNTERKEY</span></span>, newGameNum), cons(<span class="hljs-type"><span class="hljs-type">DataEntry</span></span>(gameId, gameDataStr), nil)))), <span class="hljs-type"><span class="hljs-type">TransferSet</span></span>(cons(<span class="hljs-type"><span class="hljs-type">ScriptTransfer</span></span>(<span class="hljs-type"><span class="hljs-type">SERVER</span></span>, <span class="hljs-type"><span class="hljs-type">COMMISSION</span></span>, unit), nil))) } }</code> </pre> <br>  Fungsi menulis game baru ke status kontrak pintar.  Yaitu: <br><br><ul><li>  Pengidentifikasi unik untuk game baru <b>(id game)</b> </li><li>  Status permainan = SUBMITTED </li><li>  Pilihan pemain (panjang garis 50) </li><li>  Kunci publik </li><li>  Kemenangan potensial (tergantung pada taruhan pemain) </li></ul><br><img src="https://habrastorage.org/webt/ia/w6/s9/iaw6s9uiyfpaut6mhn8gkolxaou.png"><br><br>  Ini adalah bagaimana catatan data di blockchain terlihat seperti (nilai kunci): <br><br><pre> <code class="scala hljs">{ <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-string"><span class="hljs-string">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">"03WON_0283_448t8Jn9P3717UnXFEVD5VWjfeGE5gBNeWg58H2aJeQEgJ_06574069_09116020000_0229"</span></span>, <span class="hljs-string"><span class="hljs-string">"key"</span></span>: <span class="hljs-string"><span class="hljs-string">"2GKTX6NLTgUrE4iy9HtpSSHpZ3G8W4cMfdjyvvnc21dx"</span></span> }</code> </pre> <br>  "Kunci" (kunci) - <b>id game dari</b> game baru.  Data yang tersisa terkandung dalam garis "nilai" bidang (nilai).  Entri-entri ini disimpan di tab <b>Data</b> pada kontrak pintar: <br><br><img src="https://habrastorage.org/webt/5l/fi/ur/5lfiurrw9f4mhxvttifuzjue5xm.png"><br><br><img src="https://habrastorage.org/webt/33/8q/tq/338qtq74ja1r7vylnmx_ska0aoy.png"><br><br>  5. Server ‚Äúmelihat‚Äù kontrak pintar dan menemukan transaksi yang dikirim (permainan baru) menggunakan blockchain Api.  Id game dari game baru sudah direkam di blockchain, yang berarti tidak mungkin lagi untuk mengubah atau mempengaruhinya <br><br>  6. Server membentuk fungsi penarikan (gameId, rsaSign).  Sebagai contoh, ini: <br><br><pre> <code class="plaintext hljs">withdraw ("FwsuaaShC6DMWdSWQ5osGWtYkVbTEZrsnxqDbVx5oUpq", "base64:Gy69dKdmXUEsAmUrpoWxDLTQOGj5/qO8COA+QjyPVYTAjxXYvEESJbSiCSBRRCOAliqCWwaS161nWqoTL/TltiIvw3nKyd4RJIBNSIgEWGM1tEtNwwnRwSVHs7ToNfZ2Dvk/GgPUqLFDSjnRQpTHdHUPj9mQ8erWw0r6cJXrzfcagKg3yY/0wJ6AyIrflR35mUCK4cO7KumdvC9Mx0hr/ojlHhN732nuG8ps4CUlRw3CkNjNIajBUlyKQwpBKmmiy3yJa/QM5PLxqdppmfFS9y0sxgSlfLOgZ51xRDYuS8NViOA7c1JssH48ZtDbBT5yqzRJXs3RnmZcMDr/q0x6Bg==")</code> </pre> <br>  7. Server mengirimkan transaksi Invokasi ke kontrak pintar (broadcast InvocationTx).  Transaksi berisi panggilan ke fungsi penarikan yang dibuat (gameId, rsaSign): <br><br><img src="https://habrastorage.org/webt/5s/qv/a9/5sqva9dije7xwufaactablctnic.png"><br><br>  Fungsi ini berisi <b>id game dari</b> game baru dan hasil tanda tangan RSA dari pengidentifikasi unik dengan kunci pribadi.  Hasil tanda tangan tidak berubah. <br><br>  <i>Apa artinya ini?</i> <br><br>  Kami mengambil nilai yang sama (id game) dan menerapkan metode tanda tangan RSA untuk itu.  Kami akan selalu mendapatkan hasil yang sama.  Ini adalah cara kerja algoritma RSA.  Anda tidak dapat memanipulasi angka terakhir, karena id game dan hasil penggunaan RSA tidak diketahui.  Mencocokkan angka juga tidak ada gunanya. <br><br>  8. Blockchain menerima transaksi.  Ini menjalankan fungsi penarikan (gameId, rsaSign) <br><br>  9. Di dalam fungsi withdraw, <b>fungsi GenerateRandInt</b> (gameId, rsaSign) diekspor.  Ini adalah pembangkit angka acak <br><br><br><pre> <code class="scala hljs"># <span class="hljs-meta"><span class="hljs-meta">@return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> ... <span class="hljs-number"><span class="hljs-number">100</span></span> func <span class="hljs-type"><span class="hljs-type">GenerateRandInt</span></span> (gameId,rsaSign) = { # verify <span class="hljs-type"><span class="hljs-type">RSA</span></span> signature to proof random let rsaSigValid = rsaVerify (<span class="hljs-type"><span class="hljs-type">SHA256</span></span>, toBytes(gameId), rsaSign, <span class="hljs-type"><span class="hljs-type">RSAPUBLIC</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rsaSigValid) then { let rand = (toInt(sha256(rsaSign)) % <span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-number"><span class="hljs-number">0</span></span> &gt; rand)) then ((<span class="hljs-number"><span class="hljs-number">-1</span></span> * rand) + <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> (rand + <span class="hljs-number"><span class="hljs-number">1</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> (<span class="hljs-string"><span class="hljs-string">"Invalid RSA signature"</span></span>) }</code> </pre> <br>  <b>rand</b> - dan ada nomor acak. <br><br>  Pertama, sebuah string diambil, yang merupakan hasil dari tanda tangan RSA <b>id game dengan</b> kunci pribadi ( <b>rsaSign</b> ).  Kemudian hash menggunakan SHA-256 ( <b>sha256 (rsaSign)</b> ). <br><br>  Kami tidak dapat memprediksi hasil tanda tangan dan hashing selanjutnya.  Oleh karena itu, tidak mungkin untuk mempengaruhi pembangkitan bilangan acak.  Untuk mendapatkan nomor dalam rentang tertentu (misalnya, dari 1 hingga 100), fungsi konversi toInt dan% 100 digunakan (analog ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mod</a> ). <br><br>  Di awal artikel, kami menyebutkan fungsi <b>rsaVerify ()</b> , yang memungkinkan Anda memverifikasi validitas tanda tangan RSA dengan kunci pribadi dengan kunci publik.  Inilah bagian GenerateRandInt (gameId, rsaSign): <br><br><pre> <code class="plaintext hljs">rsaVerify (SHA256, toBytes(gameId), rsaSign, RSAPUBLIC)</code> </pre> <br>  Kunci publik RSAPUBLIC dan string rsaSign diteruskan ke input.  Tanda tangan diperiksa untuk validitasnya.  Sejumlah dihasilkan jika cek berhasil.  Jika tidak, sistem menganggap bahwa tanda tangan tidak valid (tanda tangan RSA tidak valid). <br><br>  Server harus menandatangani id game dengan kunci pribadi dan mengirim tanda tangan Rsa yang valid dalam 2880 blok.  Parameter ini dikonfigurasi saat menggunakan kontrak pintar.  Jika tidak ada yang terjadi selama waktu yang ditentukan, pengguna menang.  Dalam hal ini, hadiah harus dikirim ke alamat Anda sendiri.  Ternyata server "tidak menguntungkan untuk menipu", karena ini menyebabkan kerugian.  Di bawah ini adalah contohnya. <br><br><img src="https://habrastorage.org/webt/y6/bt/q_/y6btq_yqv9ypdejhwe3d-mhnbfi.png"><br><br>  Pengguna memainkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dice Roller</a> .  Saya memilih 2 dari 6 wajah kubus, taruhannya adalah 14 GELOMBANG.  Jika server tidak mengirim tanda tangan RSA yang valid pada kontrak pintar dalam waktu yang ditentukan (2880 blok), pengguna akan mengambil 34,44 WAVES. <br><br>  Untuk menghasilkan angka dalam gim, kami menggunakan oracle - sistem eksternal yang tidak menghalangi.  Server mengimplementasikan id game tanda tangan RSA.  Kontrak pintar memeriksa validitas tanda tangan dan menentukan pemenang.  Jika server tidak mengirim apa pun, maka pengguna otomatis menang. <br><br>  Metode yang dijelaskan memastikan bahwa manipulasi secara teknis tidak mungkin.  Semua game Tradisys menggunakan algoritme, sehingga jujur ‚Äã‚Äãdan transparan.  Semuanya cocok untuk pengawasan publik.  Ini memastikan kejujuran. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id464357/">https://habr.com/ru/post/id464357/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id464345/index.html">5 alasan untuk membuka startup IT di Jerman</a></li>
<li><a href="../id464347/index.html">Modul Ketergantungan Injeksi, JavaScript, dan ES6</a></li>
<li><a href="../id464351/index.html">Kamera IP PoE, persyaratan khusus, dan operasi bebas masalah - menyatukan semuanya</a></li>
<li><a href="../id464353/index.html">1C: ERP VS 1C: KA 2.0. Apa yang harus produsen makanan pilih?</a></li>
<li><a href="../id464355/index.html">Bagaimana sebuah frame ditampilkan di Shadow Fight 3</a></li>
<li><a href="../id464359/index.html">Fitur pengujian aplikasi Web Seluler</a></li>
<li><a href="../id464361/index.html">Intel Quartz Canyon - NUC untuk Profesional</a></li>
<li><a href="../id464365/index.html">Security Week 34: kerentanan luar biasa di Windows</a></li>
<li><a href="../id464367/index.html">Dan lain-lain 0day Eskalasi Privilege Lokal Klien Windows Steam</a></li>
<li><a href="../id464369/index.html">Blocker mana yang Anda gunakan? Hasil</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>