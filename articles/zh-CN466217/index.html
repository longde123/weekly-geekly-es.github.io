<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ–•ğŸ» ğŸŒ ğŸ‘©ğŸ½â€ğŸ³ ä½¿ç”¨ONLYOFFICE DocumentBuilderç”Ÿæˆæ–‡æ¡£ ğŸ•·ï¸ ğŸ¥„ ğŸ›«</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å“ˆHa 


 æˆ‘æƒ³è°ˆè°ˆä¸€ä¸ªåä¸ºDocumentBuilderçš„å®ç”¨ç¨‹åºï¼Œè¯¥å®ç”¨ç¨‹åºå…è®¸æ‚¨ç”Ÿæˆæ–‡æ¡£ï¼Œè¡¨æ ¼å’Œæ¼”ç¤ºæ–‡ç¨¿ï¼Œå¹¶é€šè¿‡ä½¿ç”¨ä»æ¨¡æ¿åˆ›å»ºç®€å†çš„ç¤ºä¾‹æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨å®ƒæ¥è§£å†³é—®é¢˜ã€‚ 


 æ„å»ºå™¨çš„å·¥ä½œæ–¹å¼å¦‚ä¸‹ï¼šæ‚¨å¯ä»¥ä½¿ç”¨æ–‡æ¡£ä¸­çš„ç‰¹æ®Šæ–¹æ³•ç”¨jsç¼–å†™ä»£ç ï¼Œå°†å…¶æä¾›ç»™å®ç”¨ç¨‹åºï¼Œç„¶åæ”¶é›†æ–‡æ¡£ã€‚ æˆ–å¦‚æœæœ‰é”™è¯¯åˆ™ä¸...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä½¿ç”¨ONLYOFFICE DocumentBuilderç”Ÿæˆæ–‡æ¡£</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466217/"><p><img src="https://habrastorage.org/webt/i8/j3/kd/i8j3kdtzriyrkwbhkbqbbpozbik.png"></p><br><p> å“ˆHa </p><br><p> æˆ‘æƒ³è°ˆè°ˆä¸€ä¸ªåä¸ºDocumentBuilderçš„å®ç”¨ç¨‹åºï¼Œè¯¥å®ç”¨ç¨‹åºå…è®¸æ‚¨ç”Ÿæˆæ–‡æ¡£ï¼Œè¡¨æ ¼å’Œæ¼”ç¤ºæ–‡ç¨¿ï¼Œå¹¶é€šè¿‡ä½¿ç”¨ä»æ¨¡æ¿åˆ›å»ºç®€å†çš„ç¤ºä¾‹æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨å®ƒæ¥è§£å†³é—®é¢˜ã€‚ </p><br><p> æ„å»ºå™¨çš„å·¥ä½œæ–¹å¼å¦‚ä¸‹ï¼šæ‚¨å¯ä»¥ä½¿ç”¨æ–‡æ¡£ä¸­çš„ç‰¹æ®Šæ–¹æ³•ç”¨jsç¼–å†™ä»£ç ï¼Œå°†å…¶æä¾›ç»™å®ç”¨ç¨‹åºï¼Œç„¶åæ”¶é›†æ–‡æ¡£ã€‚ æˆ–å¦‚æœæœ‰é”™è¯¯åˆ™ä¸æ”¶é›†ã€‚ </p><a name="habracut"></a><br><p> å¦‚æœè¦è§£å†³ä»¥ä¸‹ç±»å‹çš„ä»»åŠ¡ï¼Œå»ºè®®ä½¿ç”¨æ„å»ºå™¨ï¼š </p><br><ul><li> æ‚¨éœ€è¦åˆ¶ä½œè®¸å¤šå˜åŒ–ä¸å¤§çš„æ–‡æ¡£ï¼Œæˆ–è€…åŸºäºå¤§é‡æ•°æ®çš„æ–‡æ¡£ã€‚ </li><li> æ‚¨éœ€è¦åœ¨ä»»ä½•æœåŠ¡ä¸­é›†æˆæ–‡æ¡£çš„ç”Ÿæˆã€‚ </li></ul><br><p> æœ‰ä¸€äº›æœåŠ¡å¯è®©æ‚¨åˆ›å»ºç®€å†ï¼šç”¨æˆ·å¡«å†™å¿…å¡«å­—æ®µï¼Œç„¶åç³»ç»Ÿç”Ÿæˆæ–‡æ¡£å¹¶å°†å…¶æä¾›ç»™ç”¨æˆ·ã€‚ è¿™å°†æ˜¯å¦‚ä½•ä½¿ç”¨æ„å»ºå™¨çš„ç¤ºä¾‹ã€‚ </p><br><p> ä½œä¸ºå·¥å…·ï¼Œæˆ‘å°†ä½¿ç”¨Node.jsï¼ˆå¿«é€Ÿï¼‰ã€‚ </p><br><p> è®¡åˆ’ï¼š </p><br><ol><li> ç”¨æˆ·åœ¨æµè§ˆå™¨çš„é¡µé¢ä¸Šçš„è¡¨å•ä¸­è¾“å…¥æ•°æ®ï¼Œè¯¥è¡¨å•è¢«å‘é€åˆ°æœåŠ¡å™¨ã€‚ </li><li> åœ¨Node.jsæœåŠ¡å™¨ä¸Šï¼Œå®ƒåŸºäºç”¨æˆ·æ•°æ®ä¸ºæ„å»ºå™¨åˆ›å»ºè„šæœ¬ã€‚ </li><li>  Node.jså°†è„šæœ¬æä¾›ç»™æ„å»ºå™¨ã€‚ </li><li> æ„å»ºå™¨ä½¿ç”¨è„šæœ¬åˆ¶ä½œæ–‡æ¡£ã€‚ </li><li>  Node.jså°†æŒ‡å‘æ–‡æ¡£çš„é“¾æ¥è¿”å›ç»™ç”¨æˆ·ã€‚ </li></ol><br><h2 id="sozdanie-formy"> è¡¨æ ¼åˆ¶ä½œ </h2><br><p> é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªè¡¨å•ï¼Œç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­è¾“å…¥æ•°æ®ã€‚ è¯¥è¡¨æ ¼å°†åŒ…å«8ä¸ªå­—æ®µï¼šâ€œå…¨åâ€ï¼Œâ€œç”µè¯å·ç â€ï¼Œâ€œç”µå­é‚®ä»¶â€ï¼Œâ€œä¸ªäººèµ„æ–™â€ï¼Œâ€œå­¦ä½â€ï¼Œâ€œå¤§å­¦â€ï¼Œâ€œä½ç½®â€ï¼Œâ€œå¹´ä»½â€ï¼Œâ€œæŠ€èƒ½â€ã€‚ æŠ€èƒ½å­—æ®µå¯ä»¥å…‹éš†ã€‚ </p><br><p> åˆ›å»ºä¸€ä¸ªindex.htmlæ–‡ä»¶å¹¶å‘å…¶ä¸­æ·»åŠ æ¨¡æ¿ä»£ç ã€‚ </p><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill-name"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill-name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"full name"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"phone-number"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"number"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"phone-number"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"phone number"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"email"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"email"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"email"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"profile"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textarea</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"profile"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Insert a brief description of yourself"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textarea</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"education"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"degree"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"degree"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"university"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"university"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"location"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"location"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"date"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"year"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"year"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"skills"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"skill"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"new-skill"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"skill"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onkeyup</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add_skill_by_enter(event)"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add_skill()"</span></span></span><span class="hljs-tag">&gt;</span></span>+<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p> åœ¨è¿™é‡Œï¼Œæˆ‘ä½¿ç”¨ä¸¤ä¸ªå‡½æ•°ï¼šadd_skill_by_enterï¼ˆäº‹ä»¶ï¼‰å’Œadd_skillï¼ˆï¼‰ã€‚ ä»–ä»¬éœ€è¦é€šè¿‡æŒ‰+æˆ–EnteræŒ‰é’®æ·»åŠ å‡ ä¸ªå­—æ®µã€‚ æˆ‘å°†åœ¨ç¨åæè¿°è¿™äº›åŠŸèƒ½ã€‚ </p><br><p> æ·»åŠ ä¸€ä¸ªæŒ‰é’®ä»¥å°†è¡¨å•æäº¤åˆ°æœåŠ¡å™¨ï¼š </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sendForm()"</span></span></span><span class="hljs-tag">&gt;</span></span>Send<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p> ç°åœ¨ï¼Œæˆ‘ä»¬å°†ç¼–å†™ç”¨äºå¤„ç†è¡¨å•çš„å‡½æ•°ã€‚ </p><br><p> ç¬¬ä¸€ä¸ªåŠŸèƒ½æ˜¯add_skillï¼ˆï¼‰ </p><br><pre> <code class="javascript hljs">add_skill = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> newSkill = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"new-skill"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newSkill.value === <span class="hljs-string"><span class="hljs-string">''</span></span>) {<span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-comment"><span class="hljs-comment">//   ,       const div = document.createElement("div"); .// div const span = document.createElement("span"); //   const button = document.createElement("button"); //    span.innerText += newSkill.value; //   span   newSkill.value = ''; //      newSkill.focus(); //        button.innerText += "-"; button.onclick = () =&gt; { //      div.remove(); }; div.appendChild(span); //  span  div div.appendChild(button); //   document.getElementsByClassName('skills')[0].appendChild(div); //     }; add_skill_by_enter() add_skill_by_enter = (event) =&gt; { if (event.code === "Enter") { //  ,      enter add_skill(); } };</span></span></code> </pre> <br><p> æˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªç®€å•çš„åŠŸèƒ½ï¼Œå¯ä»¥ä»å­—æ®µä¸­æ”¶é›†æ•°æ®å¹¶å°†å…¶å‘é€åˆ°æœåŠ¡å™¨ã€‚ </p><br><pre> <code class="javascript hljs"> get_skill_values = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> skills = []; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'new-skill'</span></span>).value !== <span class="hljs-string"><span class="hljs-string">''</span></span>) { skills.push(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'new-skill'</span></span>).value); } <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.from(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementsByClassName(<span class="hljs-string"><span class="hljs-string">'skillfield'</span></span>)).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">current_element</span></span></span><span class="hljs-function"> =&gt;</span></span> { skills.push(current_element.innerHTML); }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> skills; }; sendForm() sendForm = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { fetch(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">method</span></span>: <span class="hljs-string"><span class="hljs-string">'POST'</span></span>, <span class="hljs-attr"><span class="hljs-attr">headers</span></span>: { <span class="hljs-string"><span class="hljs-string">'Content-Type'</span></span>: <span class="hljs-string"><span class="hljs-string">'application/json'</span></span> }, <span class="hljs-attr"><span class="hljs-attr">body</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify({ <span class="hljs-attr"><span class="hljs-attr">userData</span></span>: { <span class="hljs-attr"><span class="hljs-attr">fillName</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'fill-name'</span></span>).value, <span class="hljs-attr"><span class="hljs-attr">phoneNumber</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'phone-number'</span></span>).value, <span class="hljs-attr"><span class="hljs-attr">email</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'email'</span></span>).value, <span class="hljs-attr"><span class="hljs-attr">profile</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'profile'</span></span>).value, <span class="hljs-attr"><span class="hljs-attr">education</span></span>: { <span class="hljs-attr"><span class="hljs-attr">degree</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'degree'</span></span>).value, <span class="hljs-attr"><span class="hljs-attr">university</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'university'</span></span>).value, <span class="hljs-attr"><span class="hljs-attr">location</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'location'</span></span>).value, <span class="hljs-attr"><span class="hljs-attr">year</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'year'</span></span>).value, }, <span class="hljs-attr"><span class="hljs-attr">skills</span></span>: get_skill_values() } }) }).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.json()) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function"> =&gt;</span></span> { location.replace(<span class="hljs-string"><span class="hljs-string">'/'</span></span> + response.filename); <span class="hljs-comment"><span class="hljs-comment">//  ,       }) .catch(error =&gt; console.error('Error:', error)); };</span></span></code> </pre> <br><h2 id="servernaya-chast-dlya-raboty-s-formoy"> æœåŠ¡å™¨ç«¯ç”¨äºå¤„ç†è¡¨å• </h2><br><p> æˆ‘åœ¨Expressä¸Šå†™æœåŠ¡å™¨éƒ¨åˆ†ã€‚ æ‰€æœ‰åº“çš„è¿æ¥ï¼ŒæœåŠ¡å™¨é…ç½®ä»¥åŠgetå’Œpostæ–¹æ³•çš„æè¿°å¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> path = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'path'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> bodyParser = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'body-parser'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> app = express(); app.use(bodyParser.json()); app.get(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, (req, res) =&gt; { res.sendFile(path.join(__dirname + <span class="hljs-string"><span class="hljs-string">'/index.html'</span></span>)); }); app.post(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, (req, res) =&gt; { <span class="hljs-comment"><span class="hljs-comment">//        }); app.listen(3000, () =&gt; console.log(`Example app listening on port ${3000}!`));</span></span></code> </pre> <br><p> è¿è¡Œå¿«é€’ï¼š <br> <code>node main.js</code> </p> <br><p> åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€åœ°å€ï¼š <br> <code>http:localhost:3000</code> </p> <br><p> æˆ‘ä»¬çœ‹åˆ°åˆ›å»ºçš„è¡¨å•ã€‚ æˆ‘ä»¬ç”¨ä»»æ„æ•°æ®å¡«å……å®ƒï¼š <br><img src="https://habrastorage.org/webt/v9/qo/sq/v9qosqh3l4ppxfrt-zulcv1fyce.png"></p><br><p> æˆ‘ä»¬å¾—åˆ°ä»¥ä¸‹jsonï¼š </p><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"userData"</span></span>:{<span class="hljs-attr"><span class="hljs-attr">"fillName"</span></span>:<span class="hljs-string"><span class="hljs-string">"Rotatyy Dmitryi"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"phoneNumber"</span></span>:<span class="hljs-string"><span class="hljs-string">"89879879898"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"email"</span></span>:<span class="hljs-string"><span class="hljs-string">"flamine@list.ru"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"profile"</span></span>:<span class="hljs-string"><span class="hljs-string">"Hi, my name is Joe\nAnd I work in a button factory\nI got a wife and two kids\nOne day, my boss says, â€œJoe, are you busy?â€\nI said, â€œnoâ€\nâ€œThen push this button with your right handâ€"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"country"</span></span>:<span class="hljs-string"><span class="hljs-string">"Russia"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"city"</span></span>:<span class="hljs-string"><span class="hljs-string">"Nizhniy Novgorod"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"education"</span></span>:{<span class="hljs-attr"><span class="hljs-attr">"degree"</span></span>:<span class="hljs-string"><span class="hljs-string">"Master of Pupets"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"university"</span></span>:<span class="hljs-string"><span class="hljs-string">"Nizhny novgorod state technical university"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"location"</span></span>:<span class="hljs-string"><span class="hljs-string">"Nizhniy Novgorod"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"year"</span></span>:<span class="hljs-string"><span class="hljs-string">"2015-05-02"</span></span>},<span class="hljs-attr"><span class="hljs-attr">"skills"</span></span>:[<span class="hljs-string"><span class="hljs-string">"apple.js"</span></span>,<span class="hljs-string"><span class="hljs-string">"vintage.js"</span></span>,<span class="hljs-string"><span class="hljs-string">"zerg.js"</span></span>,<span class="hljs-string"><span class="hljs-string">"css"</span></span>,<span class="hljs-string"><span class="hljs-string">"html"</span></span>,<span class="hljs-string"><span class="hljs-string">"linux"</span></span>]}};</code> </pre> <br><p> ç°åœ¨ï¼Œæ‚¨éœ€è¦ä¸ºæ„å»ºå™¨ç¼–å†™è„šæœ¬ã€‚ æˆ‘ä»¥Google Docsæä¾›çš„æ¨¡æ¿ï¼ˆç®€å†æ¨¡æ¿ï¼‰ä¸ºåŸºç¡€ã€‚ </p><br><p> è¯¥æ¨¡æ¿å¦‚ä¸‹æ‰€ç¤ºï¼š <br><img src="https://habrastorage.org/getpro/habr/post_images/0a0/488/bbe/0a0488bbe082407d850b2fe37bd5704f.png" alt="å›¾ç‰‡"></p><br><p> ä½¿ç”¨æ­¤æ•°æ®å’Œæ¨¡æ¿ï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªè„šæœ¬ï¼Œæ„å»ºå™¨å°†ä½¿ç”¨è¯¥è„šæœ¬åˆ›å»ºæ–‡æ¡£ã€‚ </p><br><p> æœ‰å‡ ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯ä¸‹è½½æ¡Œé¢ç‰ˆæœ¬çš„ONLYOFFICEç¼–è¾‘å™¨å¹¶ç¼–å†™ä¸€ä¸ªå®ï¼Œè¯¥å®å°†ä½¿ç”¨æ•°æ®åˆ›å»ºæ–‡æ¡£ã€‚ ç„¶åå°†åˆ›å»ºå’Œä¿å­˜æ–‡ä»¶æ·»åŠ åˆ°å®ä¸­-æ‚¨å°†è·å¾—æ„å»ºå™¨çš„è„šæœ¬ã€‚ è¿™å°†èµ·ä½œç”¨ï¼Œå› ä¸ºå®å’Œç”Ÿæˆå™¨ä½¿ç”¨ç›¸åŒçš„APIã€‚ <br><img src="https://habrastorage.org/webt/0n/qo/ee/0nqoeewn2so-cv6gvwwdlvpywls.png"></p><br><h2 id="sozdanie-skripta-dlya-bildera"> ä¸ºæ„å»ºå™¨åˆ›å»ºè„šæœ¬ </h2><br><p> æˆ‘ä»¬é¦–å…ˆåˆå§‹åŒ–é¡µé¢å¯¹è±¡å¹¶æ·»åŠ æ¥è‡ªç”¨æˆ·çš„æ•°æ®ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Document = Api.GetDocument(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> data = {<span class="hljs-string"><span class="hljs-string">"userData"</span></span>:{<span class="hljs-string"><span class="hljs-string">"fillName"</span></span>:<span class="hljs-string"><span class="hljs-string">"Rotatyy Dmitryi"</span></span>,<span class="hljs-string"><span class="hljs-string">"phoneNumber"</span></span>:<span class="hljs-string"><span class="hljs-string">"89879879898"</span></span>,<span class="hljs-string"><span class="hljs-string">"email"</span></span>:<span class="hljs-string"><span class="hljs-string">"flamine@list.ru"</span></span>,<span class="hljs-string"><span class="hljs-string">"profile"</span></span>:<span class="hljs-string"><span class="hljs-string">"Hi, my name is Joe\nAnd I work in a button factory\nI got a wife and two kids\nOne day, my boss says, â€œJoe, are you busy?â€\nI said, â€œnoâ€\nâ€œThen push this button with your right handâ€"</span></span>,<span class="hljs-string"><span class="hljs-string">"country"</span></span>:<span class="hljs-string"><span class="hljs-string">"Russia"</span></span>,<span class="hljs-string"><span class="hljs-string">"city"</span></span>:<span class="hljs-string"><span class="hljs-string">"Nizhniy Novgorod"</span></span>,<span class="hljs-string"><span class="hljs-string">"education"</span></span>:{<span class="hljs-string"><span class="hljs-string">"degree"</span></span>:<span class="hljs-string"><span class="hljs-string">"Master of Pupets"</span></span>,<span class="hljs-string"><span class="hljs-string">"university"</span></span>:<span class="hljs-string"><span class="hljs-string">"Nizhny novgorod state technical university"</span></span>,<span class="hljs-string"><span class="hljs-string">"location"</span></span>:<span class="hljs-string"><span class="hljs-string">"Nizhniy Novgorod"</span></span>,<span class="hljs-string"><span class="hljs-string">"year"</span></span>:<span class="hljs-string"><span class="hljs-string">"2015-05-02"</span></span>},<span class="hljs-string"><span class="hljs-string">"skills"</span></span>:[<span class="hljs-string"><span class="hljs-string">"apple.js"</span></span>,<span class="hljs-string"><span class="hljs-string">"vintage.js"</span></span>,<span class="hljs-string"><span class="hljs-string">"zerg.js"</span></span>,<span class="hljs-string"><span class="hljs-string">"css"</span></span>,<span class="hljs-string"><span class="hljs-string">"html"</span></span>,<span class="hljs-string"><span class="hljs-string">"linux"</span></span>]}};</code> </pre> <br><p> ç°åœ¨ï¼Œæ‚¨éœ€è¦æ·»åŠ å…·æœ‰å®Œæ•´ç”¨æˆ·åçš„æ®µè½ã€‚ å®ƒç”¨ç²—ä½“å†™ï¼Œè¯¥æ®µçš„è¡Œè·ä¸º1.15ã€‚ </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> paragraph = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.GetElement(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-comment"><span class="hljs-comment">//       FullName_style = Document.CreateStyle("FullName"); //    FullName_style.GetTextPr().SetFontSize(28); //    FullName_style.GetTextPr().SetBold(true); //  bold paragraph.SetStyle(FullName_style); //      paragraph.SetSpacingLine(1.15 * 240, "auto"); //    paragraph.AddText(data.userData.fillName); //    </span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">æˆ‘ä»¬è¿˜æ·»åŠ å…¶ä½™æ®µè½ï¼š</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Country and city const CountryCity_style = Document.CreateStyle("CountryCity"); CountryCity_style.GetTextPr().SetFontSize(20); CountryCity_style.GetTextPr().SetCaps(true); CountryCity_style.GetTextPr().SetBold(true); paragraph = Api.CreateParagraph(); paragraph.AddText(data.userData.country + ', ' + data.userData.city); paragraph.SetStyle(CountryCity_style); paragraph.SetSpacingAfter(0); Document.Push(paragraph); // phone number const PhoneNumber_style = Document.CreateStyle("PhoneNumber"); PhoneNumber_style.GetTextPr().SetFontSize(20); PhoneNumber_style.GetParaPr().SetSpacingAfter(0); PhoneNumber_style.GetTextPr().SetBold(true); paragraph = Api.CreateParagraph(); paragraph.AddText(data.userData.phoneNumber); paragraph.SetStyle(PhoneNumber_style); Document.Push(paragraph); // email const Email_style = Document.CreateStyle("Email"); Email_style.GetTextPr().SetFontSize(18); Email_style.GetParaPr().SetSpacingAfter(0); Email_style.GetTextPr().SetBold(true); paragraph = Api.CreateParagraph(); paragraph.AddText(data.userData.email); paragraph.SetStyle(Email_style); Document.Push(paragraph); // SectionHeader style const SectionHeader = Document.CreateStyle("SectionHeader"); SectionHeader.GetTextPr().SetBold(true); SectionHeader.GetTextPr().SetColor(247, 93, 93, false); SectionHeader.GetTextPr().SetFontSize(28); SectionHeader.GetParaPr().SetSpacingBefore(1.33 * 240); SectionHeader.GetParaPr().SetSpacingLine(1 * 240, "auto"); // add header Profile: paragraph = Api.CreateParagraph(); paragraph.AddText("Profile:") paragraph.SetStyle(SectionHeader); Document.Push(paragraph); // add profile text: paragraph = Api.CreateParagraph(); paragraph.AddText(data.userData.profile) Document.Push(paragraph); // add header Education: paragraph = Api.CreateParagraph(); paragraph.AddText("Education:") paragraph.SetStyle(SectionHeader); Document.Push(paragraph); // add education year: const EducationYear_style = Document.CreateStyle("EducationYear"); EducationYear_style.GetTextPr().SetColor(102, 102, 102); EducationYear_style.GetTextPr().SetFontSize(18); EducationYear_style.GetParaPr().SetSpacingAfter(0); paragraph = Api.CreateParagraph(); paragraph.SetStyle(EducationYear_style); paragraph.AddText(data.userData.education.year) Document.Push(paragraph); // add education university: paragraph = Api.CreateParagraph(); run = Api.CreateRun(); run.AddText(data.userData.education.university) run.AddText(', ') run.AddText(data.userData.education.location) run.SetBold(true); paragraph.AddElement(run); run = Api.CreateRun(); run.AddText(' â€“ ' + data.userData.education.degree) paragraph.AddElement(run); Document.Push(paragraph); // add header Skills: paragraph = Api.CreateParagraph(); paragraph.AddText("Skills:") paragraph.SetStyle(SectionHeader); Document.Push(paragraph); // add skills text: paragraph = Api.CreateParagraph(); const skills = data.userData.skills.map(x =&gt; ' ' + x).toString(); paragraph.AddText(skills) Document.Push(paragraph);</span></span></code> </pre> </div></div><br><p> é€šè¿‡æ‰§è¡Œæ­¤è„šæœ¬ï¼Œæˆ‘ä»¬å¾—åˆ°ä»¥ä¸‹æ–‡æ¡£ï¼š <br><img src="https://habrastorage.org/webt/jt/bu/c3/jtbuc3bitzmanxfyvddrmrohi_8.png"></p><br><p> ç°åœ¨æ˜¯æ—¶å€™æ·»åŠ ä¸€äº›åŠŸèƒ½ï¼Œä»¥å°†è„šæœ¬ä»£ç å†™å…¥æ–‡ä»¶å¹¶ç”Ÿæˆæ–‡æ¡£ã€‚ </p><br><p> æˆ‘ä»¬ç”Ÿæˆè„šæœ¬-&gt;å†™å…¥æ–‡ä»¶-&gt;å°†æ–‡ä»¶æä¾›ç»™æ„å»ºå™¨-&gt;å°†æ–‡ä»¶é“¾æ¥è¿”å›ç»™ç”¨æˆ·ã€‚ </p><br><p> æˆ‘ä»¬æ·»åŠ äº†ç”¨äºä½¿ç”¨Node.jså¤„ç†æ–‡ä»¶å’Œè¿è¡Œå‘½ä»¤çš„é™„åŠ ç»„ä»¶è¿æ¥ï¼Œå¹¶ä¸”è¿˜åˆ›å»ºäº†ä¸€ä¸ªâ€œ publicâ€æ–‡ä»¶å¤¹å¹¶å°†å…¶å…¬å¼€ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {exec} = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'child_process'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> fs = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'fs'</span></span>); app.use(express.static(<span class="hljs-string"><span class="hljs-string">'public'</span></span>));</code> </pre> <br><p> ç”¨è„šæœ¬ç”Ÿæˆæ–‡æœ¬çš„åŠŸèƒ½å°†éå¸¸ç®€å•-åœ¨æ·»åŠ ç”¨æˆ·æ•°æ®çš„åŒæ—¶ï¼Œå®ƒä»…è¿”å›åŒ…å«æ„å»ºå™¨æ‰€æœ‰ä»£ç çš„å­—ç¬¦ä¸²ã€‚ åœ¨æ¯è¡Œçš„æœ«å°¾æ·»åŠ ä¸€ä¸ªæ¢è¡Œç¬¦éå¸¸é‡è¦ï¼Œå¦åˆ™å°†æ— æ•ˆã€‚ </p><br><pre> <code class="javascript hljs">generate_script = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> first_template = <span class="hljs-string"><span class="hljs-string">'builder.CreateFile("docx");\n'</span></span> + <span class="hljs-string"><span class="hljs-string">'const Document = Api.GetDocument();\n'</span></span>; first_template += <span class="hljs-string"><span class="hljs-string">'const data = '</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(data) + <span class="hljs-string"><span class="hljs-string">';\n'</span></span>; first_template += <span class="hljs-string"><span class="hljs-string">'let paragraph = Document.GetElement(0);\n'</span></span> + <span class="hljs-string"><span class="hljs-string">'FullName_style = Document.CreateStyle("FullName");\n'</span></span> + ....   ~~~~~~~~~~~ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> first_template; };</code> </pre> <br><p> ç°åœ¨ï¼Œæ‚¨éœ€è¦å°†è„šæœ¬å†™å…¥æ–‡ä»¶å¹¶å°†å…¶æä¾›ç»™æ„å»ºå™¨ã€‚ å®é™…ä¸Šï¼Œä¸æ„å»ºå™¨çš„æ‰€æœ‰å·¥ä½œéƒ½å°†ç®€åŒ–ä¸ºæˆ‘ä»¬éœ€è¦<code>documentbuilder path/script.js   Node.js</code>æ‰§è¡Œ<code>documentbuilder path/script.js   Node.js</code>å‘½ä»¤çš„äº‹å® </p><br><p> æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªæ„å»ºå‡½æ•°æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼š </p><br><pre> <code class="javascript hljs">build = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data, res</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> filename = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random().toString(<span class="hljs-number"><span class="hljs-number">36</span></span>).substring(<span class="hljs-number"><span class="hljs-number">7</span></span>) + <span class="hljs-string"><span class="hljs-string">'.docx'</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    let script = generate_script(data); script += 'builder.SaveFile("docx", "' + __dirname + '/public/' + filename + '");\n' + 'builder.CloseFile();'; fs.writeFile('public/' + filename + 'js', script, () =&gt; { exec('documentbuilder ' + 'public/' + filename + 'js', () =&gt; { res.send({'filename': filename }); }); }); };</span></span></code> </pre> <br><p> æ·»åŠ å¯¹buildæ–¹æ³•çš„è°ƒç”¨ï¼ˆreq.bodyï¼Œresï¼‰ï¼› å‘å¸ƒè¯·æ±‚æ—¶ </p><br><pre> <code class="javascript hljs">app.post(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, (req, res) =&gt; { build(req.body, res); });</code> </pre> <br><p> è¿™æ ·å°±å®Œæˆäº†ã€‚ ä»¥é˜²ä¸‡ä¸€ï¼Œæˆ‘åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„</a>å‘å¸ƒäº†å®Œæ•´çš„ç¤ºä¾‹ä»£ç ã€‚ </p><br><p> å› æ­¤ï¼Œæ‚¨å¯ä»¥å°†ONLYOFFICE DocumentBuilderåµŒå…¥åˆ°Webåº”ç”¨ç¨‹åºä¸­ã€‚ </p><br><p> æˆ‘å¸Œæœ›å°½ç®¡æœ‰å¾ˆå¤šç®€åŒ–ï¼Œä½†æ˜¯ä¸€åˆ‡éƒ½æ¸…æ¥šäº†ã€‚ æˆ‘åªä½¿ç”¨äº†å¿…è¦çš„æœ€å°ä»£ç æ¥æ˜¾ç¤ºä¸€åˆ‡ã€‚ </p><br><p> ç›®å‰ï¼Œæœ‰ä¸€äº›æƒ³æ³•å¯ä»¥å®Œæˆå®ç”¨ç¨‹åºå¹¶æ‰©å¤§è¦è§£å†³çš„é—®é¢˜çš„èŒƒå›´ã€‚ å¦‚æœæ‚¨åœ¨è¯„è®ºæˆ–PMä¸­åˆ†äº«ç”Ÿæˆæ–‡æ¡£çš„å®é™…æ¡ˆä¾‹ï¼ˆå½“ç„¶ï¼Œå½“ç„¶ä¹ŸåŒ…å«æ¼”ç¤ºæ–‡ç¨¿çš„è¡¨æ ¼ï¼‰ï¼Œæˆ‘å°†ä¸èƒœæ„Ÿæ¿€ã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN466217/">https://habr.com/ru/post/zh-CN466217/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN466201/index.html">å¦‚ä½•å°†ç§‘å­¦ç•™åœ¨ITä¸­å¹¶æˆä¸ºæµ‹è¯•äººå‘˜ï¼šä¸€ä¸ªèŒä¸šçš„å†å²</a></li>
<li><a href="../zh-CN466203/index.html">åœ¨åœ£å½¼å¾—å ¡çš„Techdiræ—¥ã€‚ å•¤é…’ï¼Œæ¯”è¨é¥¼ï¼Œä¸¤ä¸ªéº¦å…‹é£</a></li>
<li><a href="../zh-CN466211/index.html">Android 10ä¸­çš„é¡¹ç›®ä¸»çº¿</a></li>
<li><a href="../zh-CN466213/index.html">åˆ›å»ºå€™é€‰äººèµ„æ–™çš„4ä¸ªæ­¥éª¤</a></li>
<li><a href="../zh-CN466215/index.html">é¢å‘æ¨¡å‹çš„è®¾è®¡ã€‚ ä»¥èˆªç©ºçƒ­äº¤æ¢å™¨ä¸ºä¾‹ï¼Œåˆ›å»ºå¯é çš„æ¨¡å‹</a></li>
<li><a href="../zh-CN466223/index.html">æ¸…æ´åˆ†è§£</a></li>
<li><a href="../zh-CN466227/index.html">é¢å‘èŠ‚ç‚¹çš„ç¼–ç¨‹</a></li>
<li><a href="../zh-CN466229/index.html">å¦‚ä½•ä¹°åç›’æ£‰ç»’è€Œä¸ä¼šå‡ºé”™</a></li>
<li><a href="../zh-CN466231/index.html">ShIoTinyå’Œå‘¨å›´çš„ä¸–ç•Œï¼šå°†ä¼ æ„Ÿå™¨è¿æ¥åˆ°äºŒè¿›åˆ¶è¾“å…¥ï¼Œæ¥è§¦åå¼¹å’Œå…¶ä»–é—®é¢˜</a></li>
<li><a href="../zh-CN466235/index.html">è’™å…‹ï¼ˆMunchï¼‰ä¸ç­‰è·ç¦»æ‰«æå’Œè¿ˆè€¶éœå°”å¾·ï¼ˆMeyerholdï¼‰ä¸€èµ·æ‘§æ¯äº†çº¢åœº-Denis Semenovè°ˆVRè‰ºæœ¯</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>