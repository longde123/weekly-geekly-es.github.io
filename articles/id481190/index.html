<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§üüèª üíß üö∑ 10 bug teratas dalam proyek C ++ untuk 2019 üïï üçò üåí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Satu tahun lagi akan berakhir, jadi sekarang saatnya untuk membuat kopi dan membaca kembali laporan bug selama setahun terakhir. Tentu saja, ini akan ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>10 bug teratas dalam proyek C ++ untuk 2019</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/481190/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7a8/cc3/539/7a8cc3539721631b68ce36c56f5471bf.png" alt="Gambar 7"></div><br>  Satu tahun lagi akan berakhir, jadi sekarang saatnya untuk membuat kopi dan membaca kembali laporan bug selama setahun terakhir.  Tentu saja, ini akan memakan banyak waktu, jadi artikel ini ditulis.  Saya sarankan untuk melihat tempat-tempat gelap paling menarik dari proyek yang kami temui pada 2019 dalam proyek yang ditulis dalam C dan C ++. <br><a name="habracut"></a><br><h2>  Tempat kesepuluh: "Apa OS kita?" </h2><br>  <a href="https://www.viva64.com/ru/w/v1040/">V1040</a> Kemungkinan salah ketik dalam ejaan nama makro yang telah ditentukan sebelumnya.  Makro '__MINGW32_' mirip dengan '__MINGW32__'.  winapi.h 4112 <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> !defined(__UNICODE_STRING_DEFINED) &amp;&amp; defined(__MINGW32_) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> __UNICODE_STRING_DEFINED #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span></span></code> </pre> <br>  Di sini, kesalahan ketik dibuat dengan nama makro <i>__MINGW32</i> _ (MINGW32 menyatakan __MINGW32__).  Di tempat lain proyek, verifikasi ditulis dengan benar: <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ed5/ad7/425/ed5ad7425145902765d728287ab5f2fa.png" alt="Gambar 3"></div><br><br>  Ini, kebetulan, bukan hanya kesalahan pertama dalam artikel " <a href="https://www.viva64.com/ru/b/0658/">CMake: kasus ketika proyek tidak dapat dimaafkan untuk kualitas kodenya</a> ", tetapi secara umum kesalahan nyata pertama yang ditemukan oleh diagnostik V1040 dalam proyek terbuka nyata (19 Agustus 2019). <br><br><h2>  Tempat kesembilan: "Siapa yang pertama?" </h2><br>  <a href="https://www.viva64.com/ru/w/v502/">V502</a> Mungkin <a href="https://www.viva64.com/ru/w/v502/">operator</a> '?:' Bekerja dengan cara yang berbeda dari yang diharapkan.  Operator '?:' Memiliki prioritas lebih rendah daripada operator '=='.  mir_parser.cpp 884 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Opcode : uint8 { kOpUndef, .... OP_intrinsiccall, OP_intrinsiccallassigned, .... kOpLast, }; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> MIRParser::ParseStmtIntrinsiccall(StmtNodePtr &amp;stmt, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> isAssigned) { Opcode o = !isAssigned ? (....) : (....); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> *intrnCallNode = mod.CurFuncCodeMemPool()-&gt;New&lt;IntrinsiccallNode&gt;(....); lexer.NextToken(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (o == !isAssigned ? OP_intrinsiccall : OP_intrinsiccallassigned) { intrnCallNode-&gt;SetIntrinsic(GetIntrinsicID(lexer.GetTokenKind())); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { intrnCallNode-&gt;SetIntrinsic(<span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;MIRIntrinsicID&gt;(....)); } .... }</code> </pre> <br>  Kami tertarik pada bagian berikut dari kode ini: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (o == !isAssigned ? OP_intrinsiccall : OP_intrinsiccallassigned) { .... }</code> </pre> <br>  Operator '==' memiliki prioritas lebih tinggi daripada operator ternary (? :).  Karena itu, ekspresi kondisional tidak dievaluasi dengan benar.  Kode tertulis setara dengan yang berikut: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((o == !isAssigned) ? OP_intrinsiccall : OP_intrinsiccallassigned) { .... }</code> </pre> <br>  Dan dengan mempertimbangkan fakta bahwa konstanta <i>OP_intrinsiccall</i> dan <i>OP_intrinsiccallassignedignign</i> memiliki nilai bukan nol, kondisi ini selalu mengembalikan nilai sebenarnya.  Tubuh cabang <i>lain</i> adalah kode yang tidak dapat dijangkau. <br><br>  Kesalahan ini datang ke atas kami dari artikel " <a href="https://www.viva64.com/ru/b/0690/">Memeriksa kode Kompiler Ark baru-baru ini dibuka oleh Huawei</a> ." <br><br><h2>  Tempat kedelapan: "Bahaya operasi bitwise" </h2><br>  <a href="https://www.viva64.com/ru/w/v1046/">V1046</a> Penggunaan bool 'dan' int 'yang tidak aman secara bersamaan dalam operasi' &amp; = '.  GSLMultiRootFinder.h 175 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddFunction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ROOT::Math::IMultiGenFunction &amp; func)</span></span></span><span class="hljs-function"> </span></span>{ ROOT::Math::IMultiGenFunction * f = func.Clone(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!f) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; fFunctions.push_back(f); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fFunctions.size(); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FuncIterator</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bool</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SetFunctionList</span></span></span><span class="hljs-class">( </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FuncIterator</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">begin</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FuncIterator</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class">) {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> ret = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (FuncIterator itr = begin; itr != end; ++itr) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ROOT::Math::IMultiGenFunction * f = *itr; ret &amp;= AddFunction(*f); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ret; }</code> </pre> <br>  Berdasarkan kode, fungsi <i>SetFunctionList diharapkan untuk</i> mem-bypass daftar iterator.  Dan jika setidaknya salah satu dari mereka tidak valid, maka nilai pengembalian akan <i>salah</i> , jika tidak <i>benar</i> . <br><br>  Namun, pada kenyataannya, fungsi <i>SetFunctionList</i> dapat mengembalikan <i>false</i> bahkan untuk iterator yang valid.  Mari kita <i>lihat</i> situasinya. Fungsi <i>AddFunction</i> mengembalikan jumlah iterator yang valid dalam daftar <i>fFunctions</i> .  Yaitu  saat menambahkan iterator bukan nol, ukuran daftar ini akan meningkat secara berurutan: 1, 2, 3, 4, dll.  Di sinilah kesalahan dalam kode mulai terwujud: <br><br><pre> <code class="cpp hljs">ret &amp;= AddFunction(*f);</code> </pre> <br>  Karena  Karena fungsi mengembalikan hasil dari tipe <i>int</i> , bukan <i>bool</i> , operasi '&amp; =' dengan angka genap akan memberikan nilai <i>salah</i> .  Lagi pula, bit angka genap paling tidak signifikan akan selalu nol.  Oleh karena itu, kesalahan yang tidak terlihat seperti itu akan merusak hasil fungsi <i>SetFunctionsList</i> bahkan untuk argumen yang valid. <br><br>  Jika Anda hati-hati membaca kode dari contoh (dan Anda membaca dengan cermat, kan?), Maka Anda mungkin memperhatikan bahwa ini adalah kode dari proyek ROOT.  Tentu saja, kami mengujinya: " <a href="https://www.viva64.com/ru/b/0682/">Analisis kode ROOT - kerangka kerja untuk analisis data penelitian ilmiah</a> ." <br><br><h2>  Tempat ketujuh: "Kebingungan dalam variabel" </h2><br>  <a href="https://www.viva64.com/ru/w/v1001/">V1001</a> [CWE-563] Variabel 'Mode' ditugaskan tetapi tidak digunakan pada akhir fungsi.  SIModeRegister.cpp 48 <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Status</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> Mask; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> Mode; Status() : Mask(<span class="hljs-number"><span class="hljs-number">0</span></span>), Mode(<span class="hljs-number"><span class="hljs-number">0</span></span>){}; Status(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> Mask, <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> Mode) : Mask(Mask), Mode(Mode) { Mode &amp;= Mask; }; .... };</code> </pre> <br>  Sangat berbahaya untuk memberi argumen fungsi nama yang sama dengan anggota kelas.  Sangat mudah bingung.  Di hadapan kita adalah kasus seperti itu.  Ungkapan ini tidak masuk akal: <br><br><pre> <code class="cpp hljs">Mode &amp;= Mask;</code> </pre> <br>  Argumen fungsi berubah.  Dan itu dia.  Argumen ini tidak lagi digunakan.  Kemungkinan besar, perlu menulis seperti ini: <br><br><pre> <code class="cpp hljs">Status(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> Mask, <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> Mode) : Mask(Mask), Mode(Mode) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;Mode &amp;= Mask; };</code> </pre> <br>  Dan ini adalah kesalahan dari <a href="http://llvm.org/">LLVM</a> .  Kami memiliki tradisi dari waktu ke waktu untuk menganalisis proyek ini.  Tahun ini kami juga memiliki <a href="https://www.viva64.com/ru/b/0629/">artikel</a> tentang verifikasi. <br><br><h2>  Tempat keenam: "C ++ memiliki undang-undang sendiri" </h2><br>  Kesalahan berikut muncul dalam kode karena fakta bahwa aturan C ++ tidak selalu bertepatan dengan aturan matematika atau "akal sehat".  Perhatikan sendiri di mana kesalahan ada dalam potongan kecil kode? <br><br>  <a href="https://www.viva64.com/ru/w/v709/">V709</a> Perbandingan mencurigakan ditemukan: 'f0 == f1 == m_fractureBodies.size ()'.  Ingat bahwa 'a == b == c' tidak sama dengan 'a == b &amp;&amp; b == c'.  btFractureDynamicsWorld.cpp 483 <br><br><pre> <code class="cpp hljs">btAlignedObjectArray&lt;btFractureBody*&gt; m_fractureBodies; <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> btFractureDynamicsWorld::fractureCallback() { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; numManifolds; i++) { .... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> f0 = m_fractureBodies.findLinearSearch(....); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> f1 = m_fractureBodies.findLinearSearch(....); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (f0 == f1 == m_fractureBodies.size()) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; .... } .... }</code> </pre> <br>  Tampaknya kondisi memeriksa bahwa <i>f0</i> sama dengan <i>f1</i> dan sama dengan jumlah elemen di <i>m_fractureBodies</i> .  Sepertinya perbandingan ini seharusnya memeriksa apakah <i>f0</i> dan <i>f1 berada</i> di akhir array <i>m_fractureBodies</i> , karena mereka berisi posisi objek yang ditemukan oleh metode <i>findLinearSearch ()</i> .  Namun, pada kenyataannya, ungkapan ini berubah menjadi cek untuk melihat apakah <i>f0</i> dan <i>f1</i> sama, dan kemudian menjadi cek untuk melihat apakah <i>m_fractureBodies.size ()</i> sama dengan hasil <i>f0 == f1</i> .  Akibatnya, operan ketiga di sini dibandingkan dengan 0 atau 1. <br><br>  Kesalahan indah!  Dan, untungnya, sangat jarang.  Sejauh ini kami hanya <a href="https://www.viva64.com/ru/examples/v709/">bertemu</a> dengannya di tiga proyek terbuka, dan, yang menarik, semuanya hanyalah mesin game.  Omong-omong, ini bukan satu-satunya kesalahan yang kami temukan di Bullet.  Yang paling menarik masuk ke artikel kami " <a href="https://www.viva64.com/ru/b/0647/">PVS-Studio melihat ke dalam Red Dead Redemption - Bullet engine</a> ". <br><br><h2>  Tempat kelima: "Apa akhir dari garis?" </h2><br>  Kesalahan berikut mudah terdeteksi jika Anda tahu tentang satu kehalusan. <br><br>  <a href="https://www.viva64.com/ru/w/v739/">V739</a> EOF tidak boleh dibandingkan dengan nilai tipe 'char'.  'Ch' harus dari tipe 'int'.  json.cpp 762 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> JsonIn::skip_separator() { <span class="hljs-keyword"><span class="hljs-keyword">signed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> ch; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ch == <span class="hljs-string"><span class="hljs-string">','</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( ate_separator ) { .... } .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ch == EOF) { .... }</code> </pre> <br>  Ini adalah salah satu kesalahan yang sulit untuk diketahui jika Anda tidak tahu bahwa <i>EOF</i> didefinisikan sebagai -1.  Karenanya, jika Anda mencoba membandingkannya dengan variabel tipe <i>char yang ditandatangani</i> , kondisinya hampir selalu <i>salah</i> .  Satu-satunya pengecualian adalah jika kode karakter adalah 0xFF (255).  Ketika membandingkan simbol seperti itu akan berubah menjadi -1 dan kondisinya akan benar. <br><br>  Ada banyak kesalahan terkait dengan permainan di atas ini: dari mesin ke permainan terbuka.  Seperti yang Anda duga, tempat ini juga datang kepada kami dari daerah ini.  Anda dapat melihat lebih banyak kesalahan dalam artikel " <a href="https://www.viva64.com/ru/b/0628/">Cataclysm Dark Days Menjelang, Analisis Statis, dan Bagel</a> ." <br><br><h2>  Tempat keempat: "Keajaiban Angka Pi" </h2><br>  <a href="https://www.viva64.com/ru/w/v624/">V624</a> Mungkin ada kesalahan cetak dalam konstanta '3.141592538'.  Pertimbangkan untuk menggunakan konstanta M_PI dari &lt;math.h&gt;.  PhysicsClientC_API.cpp 4109 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">B3_SHARED_API </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b3ComputeProjectionMatrixFOV</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fov, ....)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> yScale = <span class="hljs-number"><span class="hljs-number">1.0</span></span> / <span class="hljs-built_in"><span class="hljs-built_in">tan</span></span>((<span class="hljs-number"><span class="hljs-number">3.141592538</span></span> / <span class="hljs-number"><span class="hljs-number">180.0</span></span>) * fov / <span class="hljs-number"><span class="hljs-number">2</span></span>); .... }</code> </pre> <br><br>  Kesalahan ketik kecil di nomor Pi (3.141592653 ...), hilang nomor "6" di posisi ke-7 di bagian fraksional. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f83/42b/62f/f8342b62f2250ce927675fbbc1f40af7.png" alt="Gambar 4"></div>  Mungkin kesalahan di tempat desimal kesepuluh juta tidak akan menghasilkan konsekuensi nyata, tetapi Anda harus tetap menggunakan konstanta perpustakaan yang ada tanpa kesalahan ketik.  Untuk Pi, misalnya, ada konstanta M_PI dari header math.h. <br><br>  Kesalahan ini dari artikel " <a href="https://www.viva64.com/ru/b/0647/">PVS-Studio melihat ke dalam Red Dead Redemption - Bullet engine</a> ", yang sudah tidak asing bagi kita di tempat keenam.  Jika Anda belum menundanya untuk nanti, maka ini adalah kesempatan terakhir. <br><br><h2>  Sedikit penyimpangan </h2><br>  Jadi kita dekat dengan tiga kesalahan paling menarik teratas.  Seperti yang mungkin Anda perhatikan, mereka tidak diurutkan berdasarkan konsekuensi bencana dari kehadiran mereka, tetapi oleh kompleksitas deteksi.  Bagaimanapun, pada akhirnya, keuntungan paling penting dari analisis statis atas review kode adalah bahwa mesin tidak lelah dan tidak melupakan apa pun.  :) <br><br>  Dan sekarang saya perhatikan tiga yang pertama. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ff/519/18d/2ff51918d95a06eaf72aa7037aa66732.png" alt="Gambar 8"></div><br><br><h2>  Tempat ketiga: "Pengecualian Sulit dipahami" </h2><br>  Kelas <a href="https://www.viva64.com/ru/w/v702/">V702</a> harus selalu diturunkan dari std :: exception (dan yang sama) sebagai 'publik' (tidak ada kata kunci yang ditentukan, jadi kompiler secara default ke 'private').  CalcManager CalcException.h 4 <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CalcException</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::exception { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: CalcException(HRESULT hr) { m_hr = hr; } <span class="hljs-function"><span class="hljs-function">HRESULT </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetException</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> m_hr; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: HRESULT m_hr; };</code> </pre> <br>  Analyzer mendeteksi kelas yang diwarisi dari kelas <i>std :: exception</i> melalui pengubah <i>pribadi</i> (pengubah default jika tidak ada yang ditentukan).  Masalah dengan kode ini adalah ketika Anda mencoba menangkap pengecualian umum <i>std :: exception,</i> pengecualian tipe <i>CalcException</i> akan dilewati.  Perilaku ini terjadi karena warisan pribadi menghalangi konversi tipe implisit. <br><br>  Ya, saya tidak ingin melihat program macet karena pengubah <i>publik yang</i> hilang <i>.</i>  Ngomong-ngomong, saya yakin Anda pasti menggunakan aplikasi itu dalam hidup Anda setidaknya satu kali, kode sumber yang baru saja kita lihat.  Ini adalah <a href="https://github.com/Microsoft/calculator">kalkulator Windows</a> standar lama yang baik yang juga kami <a href="https://www.viva64.com/ru/b/0615/">uji</a> . <br><br><h2>  Tempat Kedua: Tag HTML Tidak Tertutup </h2><br>  <a href="https://www.viva64.com/ru/w/v735/">V735</a> Mungkin HTML yang salah.  Tag penutup "&lt;/body&gt;" ditemukan, sedangkan tag "&lt;/div&gt;" diharapkan.  book.cpp 127 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> QString </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeAlgebraLogBaseConversionPage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> BEGIN INDEX_LINK TITLE(Book::tr(<span class="hljs-string"><span class="hljs-string">"Logarithmic Base Conversion"</span></span>)) FORMULA(y = <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(x) / <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(a), <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>&lt;sub&gt;a&lt;/sub&gt;x = <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(x) / <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(a)) END; }</code> </pre> <br>  Seperti yang sering terjadi dengan kode C / C ++, tidak ada yang jelas dari sumbernya, jadi mari kita beralih ke kode yang sudah diproses untuk fragmen ini: <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/19a/7cf/4d4/19a7cf4d4da73085a677db2eceede962.png" alt="Gambar 6"></div><br><br>  Penganalisis mendeteksi <i>tag &lt;div&gt; yang</i> tidak tertutup.  Ada banyak fragmen kode html dalam file ini dan sekarang harus diperiksa tambahan oleh pengembang. <br><br>  Terkejut bahwa kita dapat memeriksa dan semacamnya?  Ketika saya pertama kali melihat ini, saya terkesan.  Jadi kami menganalisis sedikit kode html.  Benar, hanya dalam kode C ++.  :) <br><br>  Ini bukan hanya tempat kedua, tetapi juga kalkulator kedua di atas kami.  Anda dapat menemukan daftar semua kesalahan dalam artikel " <a href="https://www.viva64.com/ru/b/0618/">Mengikuti jejak kalkulator: SpeedCrunch</a> ". <br><br><h2>  Tempat Pertama: "Fitur Standar yang Sulit dipahami" </h2><br>  Jadi kami sampai di tempat pertama.  Masalah aneh yang mengesankan yang melalui tinjauan kode. <br><br>  Cobalah untuk menemukannya sendiri: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EatWhitespace</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FILE * InFile)</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">/* ----------------------------------------------------------------------- ** * Scan past whitespace (see ctype(3C)) and return the first non-whitespace * character, or newline, or EOF. * * Input: InFile - Input source. * * Output: The next non-whitespace character in the input stream. * * Notes: Because the config files use a line-oriented grammar, we * explicitly exclude the newline character from the list of * whitespace characters. * - Note that both EOF (-1) and the nul character ('\0') are * considered end-of-file markers. * * ----------------------------------------------------------------------- ** */</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (c = getc (InFile); <span class="hljs-built_in"><span class="hljs-built_in">isspace</span></span> (c) &amp;&amp; (<span class="hljs-string"><span class="hljs-string">'\n'</span></span> != c); c = getc (InFile)) ; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (c); } <span class="hljs-comment"><span class="hljs-comment">/* EatWhitespace */</span></span></code> </pre> <br>  Sekarang mari kita lihat apa yang disumpah oleh penganalisa: <br><br>  <a href="https://www.viva64.com/ru/w/v560/">V560</a> Bagian dari ekspresi kondisional selalu benar: ('\ n'! = C).  params.c 136. <br><br>  Aneh bukan?  Mari kita lihat sesuatu yang menarik dalam proyek yang sama, tetapi dalam file yang berbeda (charset.h): <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> isspace #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">undef</span></span></span><span class="hljs-meta"> isspace #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> .... #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> isspace(c) ((c)==</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">' '</span></span></span><span class="hljs-meta"> || (c) == </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'\t'</span></span></span><span class="hljs-meta">)</span></span></code> </pre> <br>  Jadi, dan ini sudah benar-benar aneh ... Ternyata jika variabel <i>c</i> sama dengan <i>'\ n',</i> maka fungsi <i>isspace (c) yang</i> benar-benar tidak berbahaya akan mengembalikan false dan bagian kedua dari tes ini tidak akan dilakukan karena evaluasi hubung singkat.  Jika <i>isspace (c)</i> dijalankan, maka variabel <i>c</i> adalah <i>''</i> atau <i>'\ t',</i> dan ini jelas tidak sama dengan <i>'\ n'</i> . <br><br>  Tentu saja, Anda dapat mengatakan bahwa makro ini seperti <i>#define true false</i> , dan kode seperti itu tidak akan pernah melewati tinjauan kode.  Namun, kode ini lulus ulasan dan menunggu kami dengan aman di repositori proyek. <br><br>  Jika Anda memerlukan analisis kesalahan yang lebih terperinci, maka ada di artikel " <a href="https://www.viva64.com/ru/b/0610/">Bagi mereka yang ingin bermain sebagai detektif: temukan kesalahan dalam fungsi dari Midnight Commander</a> ". <br><br><h2>  Kesimpulan </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a63/2b1/196/a632b119620f61c1a553a02c998b1509.png" alt="Gambar 9"></div><br><br>  Selama setahun terakhir, kami telah menemukan banyak kesalahan.  Ini adalah kesalahan salin-tempel yang biasa, kesalahan dalam konstanta, tag tidak tertutup, dan banyak masalah lainnya.  Tetapi penganalisa kami semakin membaik dan <a href="https://www.viva64.com/ru/b/0632/">belajar</a> untuk mencari lebih banyak bug, jadi ini masih jauh dari akhir, dan artikel baru tentang proyek pengecekan akan diterbitkan sesering sebelumnya. <br><br>  Jika seseorang membaca artikel kami untuk pertama kalinya, untuk berjaga-jaga, saya akan mengklarifikasi bahwa semua kesalahan ini ditemukan menggunakan penganalisa kode statis PVS-Studio, yang kami sarankan <a href="https://www.viva64.com/ru/pvs-studio-download/">unduh</a> dan coba.  Penganalisis dapat mendeteksi kesalahan dalam kode program yang ditulis dalam bahasa: C, C ++, C # dan Java. <br><br>  Jadi kita telah sampai pada akhirnya!  Jika Anda melewatkan dua level pertama, maka saya sarankan untuk tidak melewatkan kesempatan dan melewati mereka bersama kami: <a href="https://habr.com/ru/company/pvs-studio/blog/481178/">C #</a> dan <a href="https://habr.com/ru/company/pvs-studio/blog/481186/">Java</a> . <br><br><p> <a href="https://habr.com/en/company/pvs-studio/blog/481188/"><img src="https://habrastorage.org/getpro/habr/post_images/c78/30f/70c/c7830f70c5577c3d6704f254d7cad6a3.png" align="left"></a> </p><br><br>  Jika Anda ingin berbagi artikel ini dengan audiens yang berbahasa Inggris, silakan gunakan tautan ke terjemahan: Maxim Zvyagintsev.  <a href="https://habr.com/en/company/pvs-studio/blog/481188/">10 Bug Top Ditemukan di Proyek C ++ pada 2019</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id481190/">https://habr.com/ru/post/id481190/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id481180/index.html">Apakah pengembang perlu menerima saran dari pengguna?</a></li>
<li><a href="../id481182/index.html">Seri Posting Layanan Istio</a></li>
<li><a href="../id481184/index.html">Top 10 Bug Ditemukan di Proyek Java pada tahun 2019</a></li>
<li><a href="../id481186/index.html">10 bug terbaik di proyek Java untuk 2019</a></li>
<li><a href="../id481188/index.html">10 Bug Top Ditemukan di Proyek C ++ pada 2019</a></li>
<li><a href="../id481200/index.html">Kontrol Suara dan VoiceOver: cara menyesuaikan aplikasi untuk orang buta atau diam</a></li>
<li><a href="../id481202/index.html">Antiquities: prinsip pengumpulan sampah dan hasil 2019</a></li>
<li><a href="../id481204/index.html">Rilis Tech Mail.ru Group, musim dingin 2019</a></li>
<li><a href="../id481206/index.html">Bagaimana Amerika menempatkan musang hidup di collider</a></li>
<li><a href="../id481208/index.html">Sepeda motor e-sepeda murah murah yang bisa dikerjakan sendiri</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>