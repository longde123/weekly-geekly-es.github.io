<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ¿â€âœˆï¸ ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘¦ ğŸ§“ğŸ½ ä½¿ç”¨Rä¸­çš„åŠ¨ç”»æ¡å½¢å›¾å¯è§†åŒ–NBAçƒé˜Ÿçš„è·èƒœæ¬¡æ•° â›±ï¸ ğŸ‘©ğŸ¼â€ğŸŒ¾ â˜¹ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="é¦–å…ˆï¼Œä¸€äº›èƒŒæ™¯èµ„æ–™ã€‚ æˆ‘å«Vladislavï¼Œä¸Rçš„ç›¸è¯†å‘ç”Ÿåœ¨å»å¹´8æœˆã€‚ ç”±äºåº”ç”¨æ€§ï¼Œæˆ‘å†³å®šå­¦ä¹ ä¸€ç§ç¼–ç¨‹è¯­è¨€ã€‚ ä»å°å¼€å§‹ï¼Œæˆ‘å–œæ¬¢ä¿æŒä½“è‚²ç»Ÿè®¡ã€‚ éšç€å¹´é¾„çš„å¢é•¿ï¼Œè¿™ç§çˆ±å¥½å˜æˆäº†ä¸€ç§ä»¥æŸç§æ–¹å¼åˆ†æè¿™äº›æ•°å­—çš„æ„¿æœ›ï¼Œå¹¶åœ¨æ•°æ®åˆ†æçš„åŸºç¡€ä¸Šï¼Œæå‡ºäº†å¯èƒ½çš„å·§å¦™æƒ³æ³•ã€‚ é—®é¢˜æ˜¯ï¼Œè¿‘å¹´æ¥ï¼Œä½“è‚²è¿åŠ¨å·²è¢«ä¸€æ³¢æ•°æ®å¸­å·ï¼Œæ•°å...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä½¿ç”¨Rä¸­çš„åŠ¨ç”»æ¡å½¢å›¾å¯è§†åŒ–NBAçƒé˜Ÿçš„è·èƒœæ¬¡æ•°</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/458904/"><p> é¦–å…ˆï¼Œä¸€äº›èƒŒæ™¯èµ„æ–™ã€‚ æˆ‘å«Vladislavï¼Œä¸Rçš„ç›¸è¯†å‘ç”Ÿåœ¨å»å¹´8æœˆã€‚ ç”±äºåº”ç”¨æ€§ï¼Œæˆ‘å†³å®šå­¦ä¹ ä¸€ç§ç¼–ç¨‹è¯­è¨€ã€‚ ä»å°å¼€å§‹ï¼Œæˆ‘å–œæ¬¢ä¿æŒä½“è‚²ç»Ÿè®¡ã€‚ éšç€å¹´é¾„çš„å¢é•¿ï¼Œè¿™ç§çˆ±å¥½å˜æˆäº†ä¸€ç§ä»¥æŸç§æ–¹å¼åˆ†æè¿™äº›æ•°å­—çš„æ„¿æœ›ï¼Œå¹¶åœ¨æ•°æ®åˆ†æçš„åŸºç¡€ä¸Šï¼Œæå‡ºäº†å¯èƒ½çš„å·§å¦™æƒ³æ³•ã€‚ é—®é¢˜æ˜¯ï¼Œè¿‘å¹´æ¥ï¼Œä½“è‚²è¿åŠ¨å·²è¢«ä¸€æ³¢æ•°æ®å¸­å·ï¼Œæ•°åå®¶å…¬å¸ç›¸äº’ç«äº‰ï¼Œè¯•å›¾è®¡ç®—ï¼Œæè¿°å¹¶å°†è¶³çƒè¿åŠ¨å‘˜ï¼Œç¯®çƒè¿åŠ¨å‘˜ï¼Œæ£’çƒè¿åŠ¨å‘˜åœ¨çƒåœºä¸Šçš„ä»»ä½•åŠ¨ä½œæ¨å‘ç¥ç»å…ƒã€‚  Excelç»å¯¹ä¸é€‚åˆè¿›è¡Œåˆ†æã€‚ å› æ­¤ï¼Œæˆ‘å†³å®šç ”ç©¶Rï¼Œä»¥ä¾¿æœ€ç®€å•çš„åˆ†æä¸ä¼šèŠ±è´¹åŠå¤©ã€‚ åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œå·²ç»å¢åŠ äº†å¯¹ç¼–ç¨‹çš„å…´è¶£ï¼Œä½†æ˜¯è¿™å·²ç»æ˜¯æ­Œè¯äº†ã€‚ </p><a name="habracut"></a><br><p> æˆ‘æƒ³ç«‹å³æ³¨æ„åˆ°ä»¥åæˆ‘ä¼šå†™çš„å¾ˆå¤šä¸œè¥¿ <del> å·²ç»åœ¨è¾›æ™®æ£®ä¸€å®¶ </del> åœ¨Habrä¸Šçš„æ–‡ç« â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æˆ‘ä»¬ä½¿ç”¨Råˆ›å»ºåŠ¨ç”»ç›´æ–¹å›¾â€ä¸­ã€‚ç›¸åº”åœ°ï¼Œ</a>æœ¬æ–‡æ˜¯å¯¹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨</a> Mediumä¸­çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Råˆ›å»ºè¶‹åŠ¿åŠ¨ç”»æ¡å½¢å›¾</a>çš„æ–‡ç« çš„ç¿»è¯‘ã€‚ å› æ­¤ï¼Œä¸ºäº†ä¸ä¸Šè¿°æ–‡ç« æœ‰æ‰€ä¸åŒï¼Œæˆ‘å°†å°è¯•æ›´å…¨é¢åœ°æè¿°æˆ‘åœ¨åšä»€ä¹ˆï¼Œä»¥åŠé‚£äº›ä¸åœ¨åŸå§‹æ–‡ç« ä¸­çš„æ—¶åˆ»ã€‚ ä¾‹å¦‚ï¼Œä¸ºäº†å¡«å……åˆ—ï¼Œæˆ‘ä½¿ç”¨äº†NBAå‘½ä»¤çš„é¢œè‰²ï¼Œè€Œä¸æ˜¯æ ‡å‡†çš„<code>ggplot2</code>è°ƒè‰²æ¿ï¼Œè€Œæ˜¯åœ¨æ•°æ®å¤„ç†<code>data.table</code>åŒ…è€Œä¸æ˜¯<code>dplyr</code>ä½¿ç”¨äº†é¢œè‰²ã€‚ æˆ‘å·²ç»å®Œæˆäº†æ‰€æœ‰è¿™äº›å·¥ä½œï¼Œæ‰€ä»¥ç°åœ¨åªéœ€å†™ä¸‹å›¢é˜Ÿçš„åç§°å’Œæ‚¨éœ€è¦è®¡ç®—èƒœåˆ©æ•°çš„å¹´ä»½å°±è¶³å¤Ÿäº†ã€‚ </p><br><h2 id="dannye"> èµ„æ–™ </h2><br><p> ä¸ºäº†åˆ¶å®šæ—¶é—´è¡¨ï¼Œæˆ‘ä½¿ç”¨äº†è¿‡å»15ä¸ªèµ›å­£ä¸­30æ”¯NBAçƒé˜Ÿä¸­æ¯æ”¯çƒé˜Ÿè·èƒœæ¬¡æ•°çš„æ•°æ®ã€‚ å®ƒä»¬æ˜¯ä½¿ç”¨<strong>NBA Data Retriever</strong>æ‰©å±•åä»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">stats.nba.com</a>æ”¶é›†çš„ï¼Œè¯¥æ‰©å±•åé€šè¿‡ä½¿ç”¨NBA APIç”Ÿæˆå…·æœ‰å¿…è¦ç»Ÿè®¡ä¿¡æ¯çš„csvæ–‡ä»¶ã€‚ è¿™æ˜¯æˆ‘<a href="">åœ¨Githubä¸Šçš„</a>é¡¹ç›®çš„å®Œæ•´ç»†èŠ‚ã€‚ </p><br><h2 id="ispolzuemye-biblioteki"> ä½¿ç”¨çš„å›¾ä¹¦é¦† </h2><br><pre> <code class="plaintext hljs">library(data.table) library(tidyverse) library(gganimate)</code> </pre> <br><p> å¯¹äºæ•°æ®å¤„ç†ï¼Œæˆ‘ä½¿ç”¨<code>data.table</code> ï¼ˆä»…å› ä¸ºæˆ‘ä¹‹å‰é‡åˆ°è¿‡æ­¤è½¯ä»¶åŒ…ï¼‰ã€‚ æˆ‘è¿˜ä¸‹è½½äº†ä¸€å¥—<code>tidyverse</code>è½¯ä»¶åŒ…ï¼Œè€Œä¸æ˜¯å•ç‹¬çš„<code>ggplot2</code>ä»¥å…æ‹…å¿ƒï¼Œå¦‚æœåœ¨åˆ†æè¿‡ç¨‹ä¸­å‡ºç°æŸç§æƒ³æ³•ï¼Œéœ€è¦ä»è¯¥é›†åˆä¸­å¦å¤–åŠ è½½ä¸€ä¸ªè½¯ä»¶åŒ…ã€‚ åœ¨è¿™ç§ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œ <code>ggplot2</code> ï¼Œä¸æ¶‰åŠå…¶ä»–è®¾ç½®åŒ…ã€‚ å¥½å§ï¼Œ <code>gganimate</code>ä½¿å›¾å½¢è¿åŠ¨ã€‚ </p><br><h2 id="rabota-s-dannymi"> å¤„ç†æ•°æ® </h2><br><p> é¦–å…ˆï¼Œæ‚¨éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ’åºã€‚ åŸºæœ¬ä¸Šï¼Œè¦æ„å»ºå›¾å½¢ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å…·æœ‰åŸå§‹æ•°æ®çš„è¡¨çš„79åˆ—ä¸­é€‰æ‹©2åˆ—ã€‚ æ‚¨å¯ä»¥å…ˆé€‰æ‹©å¿…è¦çš„åˆ—ï¼Œç„¶åå†æ›¿æ¢ä¸€äº›å€¼ã€‚ æˆ‘èµ°äº†ç¬¬äºŒæ¡è·¯ã€‚ </p><br><p>  <code>data.table</code>ä¸­çš„è¡¨çš„æ ¼å¼ä¸º<code>dt[i, j, by]</code> ï¼Œå…¶ä¸­byæ˜¯å¯¹å…ƒç´ åˆ†ç»„â€œè´Ÿè´£â€çš„ã€‚ æˆ‘å°†æŒ‰â€œå›¢é˜Ÿåç§°â€åˆ—è¿›è¡Œåˆ†ç»„ã€‚ è€Œä¸”æœ‰ä¸€ä¸ªéšœç¢ã€‚ æ­¤åˆ—æ˜¾ç¤ºçƒé˜Ÿåç§°ï¼šæ¹–äººï¼Œå‡¯å°”ç‰¹äººï¼Œçƒ­ç«ç­‰ã€‚ ä½†æ˜¯åœ¨æœ¬æŠ¥å‘Šæ‰€è¿°æœŸé—´ï¼ˆä»2004/05èµ›å­£å¼€å§‹ï¼‰ï¼Œå‡ æ”¯çƒé˜Ÿæ”¹åï¼šæ–°å¥¥å°”è‰¯é»„èœ‚é˜Ÿå˜æˆæ–°å¥¥å°”è‰¯é¹ˆé¹•é˜Ÿï¼Œå¤æ´›ç‰¹å±±çŒ«é˜Ÿæ”¹å›äº†å†å²åç§°å¤æ´›ç‰¹é»„èœ‚é˜Ÿï¼Œè¥¿é›…å›¾è¶…éŸ³é€Ÿé˜Ÿå˜æˆäº†ä¿„å…‹æ‹‰è·é©¬åŸé›·éœ†é˜Ÿã€‚ è¿™ä¼šå¼•èµ·æ··ä¹±ã€‚ ä»¥ä¸‹è½¬æ¢æœ‰åŠ©äºé¿å…è¿™ç§æƒ…å†µï¼š </p><br><pre> <code class="plaintext hljs">table1 &lt;- table[TeamCity == "New Orleans" &amp; TeamName == "Hornets", TeamName := "Pelicans"][ TeamCity == "New Orleans/Oklahoma City" &amp; TeamName == "Hornets", TeamName := "Pelicans"][ TeamName == "Bobcats", TeamName := "Hornets"][ TeamName == "SuperSonics", TeamName := "Thunder"]</code> </pre> <br><p> åœ¨æ­¤æ—¶é—´æ®µå†…ï¼Œæ›´æ”¹å¾ˆå°ï¼Œä½†æ˜¯å¦‚æœå°†å…¶æ‰©å±•ï¼Œåˆ™æŒ‰TeamNameåˆ†ç»„å°†å˜å¾—éå¸¸å›°éš¾ï¼Œå¹¶ä¸”æ‚¨å°†éœ€è¦ä½¿ç”¨æ›´å¯é çš„åˆ—ã€‚ åœ¨æ­¤æ•°æ®ä¸­ï¼Œè¿™æ˜¯TeamIDã€‚ </p><br><p> é¦–å…ˆï¼Œæˆ‘ä»¬æ‘†è„±â€œé¢å¤–â€ä¿¡æ¯ï¼Œä»…ä¿ç•™æˆ‘ä»¬éœ€è¦å·¥ä½œçš„é‚£äº›åˆ—ï¼š </p><br><pre> <code class="plaintext hljs">table1 &lt;- table1[ , .(TeamName, WINS)]</code> </pre> <br><p> åœ¨<code>data.table</code> ã€‚ï¼ˆï¼‰æ„é€ æ›¿æ¢<code>list</code>å‡½æ•°ã€‚ é€‰æ‹©åˆ—çš„æ›´â€œç»å…¸â€é€‰é¡¹æ˜¯<code>table1 &lt;- table1[, c("TeamName", "WINS")]</code> ã€‚ ä¹‹åï¼Œè¯¥è¡¨é‡‡ç”¨ä»¥ä¸‹å½¢å¼ï¼š </p><br><div class="scrollable-table"><table><thead><tr><th> é˜Ÿå </th><th> èƒœ </th></tr></thead><tbody><tr><td> å¤ªé˜³é˜Ÿ </td><td>  62 </td></tr><tr><td> çƒ­åº¦ </td><td>  59 </td></tr><tr><td> é©¬åˆºé˜Ÿ </td><td>  59 </td></tr><tr><td> æ´»å¡æ† </td><td>  54 </td></tr></tbody></table></div><br><p> å¯¹äºæ¯ä¸ªå­£èŠ‚å•ç‹¬çš„åŠ¨ç”»ï¼Œè¿™å°±è¶³å¤Ÿäº†ï¼Œä½†æ˜¯è¦è®¡ç®—é€‰å®šæ—¶é—´æ®µå†…çš„æ€»èƒœåˆ©æ•°ï¼Œæ‚¨éœ€è¦è®¡ç®—æ€»èƒœåˆ©æ•°ã€‚ </p><br><p> <code>table1 &lt;- table1[, CumWins := cumsum(WINS), by = "TeamName"]</code> </p> <br><p> ä½¿ç”¨<code>cumsum</code>å‡½æ•°<code>cumsum</code>æˆ‘ä»¬å¾—åˆ°æ‰€éœ€çš„æ•°å­—ã€‚ ä½¿ç”¨ï¼š=ä»£æ›¿=å…è®¸æ‚¨å‘è¡¨ä¸­æ·»åŠ æ–°åˆ—ï¼›æˆ‘ä¸ä¼šç”¨ç›¸åŒçš„CumWinsåˆ—è¦†ç›–å®ƒã€‚  <code>by = "TeamName"</code>æŒ‰å›¢é˜Ÿåç§°å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œå¹¶åˆ†åˆ«ä¸º30ä¸ªå›¢é˜Ÿä¸­çš„æ¯ä¸ªå›¢é˜Ÿ<code>by = "TeamName"</code>ç´¯ç§¯é‡ã€‚ </p><br><p> æ¥ä¸‹æ¥ï¼Œæˆ‘åœ¨æ¯ä¸ªå­£èŠ‚å¼€å§‹çš„å¹´ä»½æ·»åŠ ä¸€åˆ—ã€‚  NBAçš„å­£èŠ‚ä»10æœˆåˆ°5æœˆï¼Œæ‰€ä»¥å®ƒåˆ†ä¸ºä¸¤ä¸ªæ—¥å†å¹´ã€‚ åœ¨å­£èŠ‚çš„æŒ‡å®šä¸­ï¼Œå³å¼€å§‹çš„å¹´ä»½ï¼Œå³ èµ›å­£ï¼šå›¾è¡¨ä¸­çš„2018å¹´å®é™…ä¸Šæ˜¯2018/19èµ›å­£ã€‚ </p><br><p> åŸå§‹è¡¨å…·æœ‰æ­¤æ•°æ®ã€‚  SeasonIDåˆ—ä»¥2çš„å½¢å¼ï¼ˆå­£èŠ‚å¼€å§‹çš„å¹´ä»½ï¼‰æ˜¾ç¤ºä¸€ä¸ªæ•°å­—ï¼Œä¾‹å¦‚22004ã€‚æ‚¨å¯ä»¥ä½¿ç”¨<code>stringr</code>ç¨‹åºåŒ…æˆ–åŸºæœ¬çš„Rå‡½æ•°åˆ é™¤å‰ä¸¤ä¸ª<code>stringr</code> ï¼Œä½†æ˜¯æˆ‘é‡‡ç”¨äº†ä¸€äº›ä¸åŒçš„æ–¹å¼ã€‚ åŸæ¥ï¼Œæˆ‘é¦–å…ˆä½¿ç”¨æ­¤åˆ—æŒ‡ç¤ºæ‰€éœ€çš„å­£èŠ‚ï¼Œç„¶ååˆ é™¤å¹¶å†æ¬¡åˆ›å»ºä¸€ä¸ªåŒ…å«æ—¥æœŸçš„åˆ—ã€‚ é¢å¤–çš„åŠ¨ä½œã€‚ </p><br><p> æˆ‘è¿™æ ·åšå¦‚ä¸‹ï¼š </p><br><p> <code>table1 &lt;- table1[,year := rep(seq(2004, 2018), each = length(unique(table1$TeamName)))]</code> </p> <br><p> æˆ‘å¾ˆå¹¸è¿ï¼Œåœ¨é€‰å®šçš„æ—¶é—´æ®µå†…ï¼ŒNBAçš„çƒé˜Ÿæ•°é‡æ²¡æœ‰å˜åŒ–ï¼Œæ‰€ä»¥æˆ‘åªé‡å¤äº†2004å¹´è‡³2018å¹´çš„æ•°å­—30æ¬¡ã€‚ åŒæ ·ï¼Œå¦‚æœæ‚¨ä¸äº†è§£å†å²ï¼Œåˆ™æ­¤æ–¹æ³•å°†å¾ˆä¸æ–¹ä¾¿ï¼Œå› ä¸ºæ¯ä¸ªèµ›å­£çš„çƒé˜Ÿæ•°é‡ä¼šæœ‰æ‰€ä¸åŒï¼Œå› æ­¤æœ€å¥½åœ¨æ¸…é™¤SeasonIDåˆ—æ—¶ä½¿ç”¨è¯¥é€‰é¡¹ã€‚ </p><br><p> ç„¶åæ·»åŠ cumrankåˆ—ã€‚ </p><br><p> <code>table1 &lt;- table1[, cumrank := frank(-CumWins, ties.method = "random"), by = "year"]</code> </p> <br><p> å®ƒä»£è¡¨æ¯ä¸ªèµ›å­£çš„è·èƒœæ¬¡æ•°æ’åï¼Œå¹¶å°†ç”¨ä½œXè½´å€¼ã€‚å…·æœ‰ç›¸åŒèƒœåˆ©æ•°çš„çƒé˜Ÿå°†ä»¥ä»€ä¹ˆé¡ºåºå‰è¿›ï¼Œå› æ­¤<code>ties.method = "random"</code> ã€‚å¥½å§ï¼Œæ‰€æœ‰è¿™äº›<code>ties.method = "random"</code>ä¸€å¹´ã€‚ </p><br><p> æœ€åçš„è¡¨è½¬æ¢æ˜¯æ·»åŠ <code>value_rel</code>åˆ—ã€‚ </p><br><p> <code>table1 &lt;- table1[, value_rel := CumWins/CumWins[cumrank==1], by = "year"]</code> </p> <br><p> è¯¥åˆ—è€ƒè™‘äº†æ¯ä¸ªå›¢é˜Ÿçš„èƒœåˆ©æ¬¡æ•°ä¸è¯¥å¹´åº¦æœ€é«˜æŒ‡æ ‡çš„æ¯”ç‡ã€‚ å¯¹äºæœ€ä½³çƒé˜Ÿï¼Œè¯¥æŒ‡æ ‡ä¸º1ï¼Œå¯¹äºå…¶ä»–çƒé˜Ÿï¼Œè¯¥æŒ‡æ ‡åˆ™è¾ƒå°ï¼Œå…·ä½“å–å†³äºèµ›å­£çš„æˆåŠŸç¨‹åº¦ã€‚ </p><br><p> åœ¨æ‰€æœ‰æ·»åŠ ä¹‹åï¼Œè¯¥è¡¨å…·æœ‰ä»¥ä¸‹å½¢å¼ï¼š </p><br><div class="scrollable-table"><table><thead><tr><th> é˜Ÿå </th><th> èƒœ </th><th> åº·æ–‡æ–¯ </th><th> å¹´ä»½ </th><th>  cumrank </th><th>  value_rel </th></tr></thead><tbody><tr><td> é©¬åˆºé˜Ÿ </td><td>  59 </td><td>  59 </td><td>  2004å¹´ </td><td>  3 </td><td>  0.9516129 </td></tr><tr><td> é©¬åˆºé˜Ÿ </td><td>  63 </td><td>  122 </td><td>  2005å¹´ </td><td>  1ä¸ª </td><td>  1.0000000 </td></tr><tr><td> é©¬åˆºé˜Ÿ </td><td>  58 </td><td>  180 </td><td>  2006å¹´ </td><td>  2 </td><td>  0.9729730 </td></tr><tr><td> é©¬åˆºé˜Ÿ </td><td>  56 </td><td>  236 </td><td>  2007å¹´ </td><td>  1ä¸ª </td><td>  1.0000000 </td></tr></tbody></table></div><br><p> è¡¨æ ¼ä¸­ä»…æ˜¾ç¤ºä¸€ä¸ªå›¢é˜Ÿæ¥è¯´æ˜ç´¯ç§¯æ€§ã€‚ æ‰€æœ‰è¿™äº›æ“ä½œéƒ½å®Œæˆäº†ï¼Œå°±åƒåç§°æ›´æ”¹ä¸€æ ·ï¼Œä½¿ç”¨äº†ä¸€ç³»åˆ—æ–¹æ‹¬å· </p><br><pre> <code class="plaintext hljs">table1 &lt;- table1[ ,.(TeamName, WINS)][ , CumWins := cumsum(WINS), by = "TeamName"][ ,year := rep(seq(2004, 2018), each = length(unique(table1$TeamName)))][ , cumrank := frank(-CumWins, ties.method = "random"), by = "year"][ , value_rel := CumWins/CumWins[cumrank==1], by = "year"]</code> </pre> <br><h2 id="izmenenie-zalivki-stolbcov-so-standartnoy-na-cveta-komand"> å°†åˆ—çš„å¡«å……ä»æ ‡å‡†æ›´æ”¹ä¸ºå›¢é˜Ÿçš„é¢œè‰²ã€‚ </h2><br><p> æ‚¨å¯ä»¥ç«‹å³è¿›è¡Œå›¾çš„æ„å»ºï¼Œä½†æ˜¯åœ¨æˆ‘çœ‹æ¥ï¼Œæœ‰ä¸€ä¸ªé‡è¦ç‚¹ï¼šå›¾ä¸­åˆ—çš„é¢œè‰²ã€‚ æ‚¨å¯ä»¥ä¿ç•™æ ‡å‡†çš„<code>ggplot2</code>è°ƒè‰²æ¿ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªä¸å¥½çš„é€‰æ‹©ã€‚ é¦–å…ˆï¼Œåœ¨æˆ‘çœ‹æ¥å¥¹å¾ˆä¸‘ã€‚ å…¶æ¬¡ï¼Œè¿™ä½¿å¾—å¾ˆéš¾åœ¨å›¾è¡¨ä¸Šæ‰¾åˆ°å›¢é˜Ÿã€‚ å¯¹äºNBAçƒè¿·æ¥è¯´ï¼Œæ¯æ”¯çƒé˜Ÿéƒ½æœ‰ç‰¹å®šçš„é¢œè‰²ï¼šæ³¢å£«é¡¿æ˜¯ç»¿è‰²ï¼ŒèŠåŠ å“¥æ˜¯çº¢è‰²ï¼Œè¨å…‹æ‹‰æ›¼å¤šæ˜¯ç´«è‰²ï¼Œç­‰ç­‰ã€‚ å› æ­¤ï¼Œå°½ç®¡æœ‰å¾ˆå¤šè“è‰²å’Œçº¢è‰²ï¼Œä½†åœ¨å¡«å……åˆ—ä¸­ä½¿ç”¨å‘½ä»¤çš„é¢œè‰²æœ‰åŠ©äºæ›´å¿«åœ°è¯†åˆ«å®ƒã€‚ </p><br><p> ä¸ºæ­¤ï¼Œè¯·åˆ›å»ºä¸€ä¸ªå¸¦æœ‰å‘½ä»¤åç§°åŠå…¶ä¸»è¦é¢œè‰²çš„è¡¨<code>table_color</code> ã€‚ é¢œè‰²å–è‡ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">teamcolorcodes.com</a> ã€‚ </p><br><div class="scrollable-table"><table><thead><tr><th> é˜Ÿå </th><th>  TEAM_color </th></tr></thead><tbody><tr><td> é¹°é˜Ÿ </td><td>  ï¼ƒE03A3E </td></tr><tr><td> å‡¯å°”ç‰¹äººé˜Ÿ </td><td>  ï¼ƒ007A33 </td></tr><tr><td> ç¯®ç½‘ </td><td>  ï¼ƒ000000 </td></tr></tbody></table></div><br><p> ä½¿ç”¨é¢œè‰²è¡¨ï¼Œæ‚¨éœ€è¦å†è¿›è¡Œä¸€æ¬¡æ“ä½œã€‚ å› ä¸º å½“ä½¿ç”¨ç»˜å›¾å› å­æ—¶ï¼Œå›¢é˜Ÿçš„é¡ºåºå°±ä¼šæ”¹å˜ã€‚ åå•ä¸Šçš„ç¬¬ä¸€ä¸ªæ˜¯â€œæ•°å­—â€åç§°çš„å”¯ä¸€æ‰€æœ‰è€…è´¹åŸ76ï¼Œç„¶åæ ¹æ®å­—æ¯ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ç›¸åŒçš„é¡ºåºæ’åˆ—é¢œè‰²ï¼Œç„¶åä»è¡¨ä¸­æå–åŒ…å«å®ƒä»¬çš„å‘é‡ã€‚ æˆ‘è¿™æ ·åšå¦‚ä¸‹ï¼š </p><br><pre> <code class="plaintext hljs"> table_color &lt;- table_color[order(TeamName)] cols &lt;- table_color[, "TEAM_color"]</code> </pre> <br><h2 id="postroenie-grafika"> ç»˜å›¾ </h2><br><p> æˆ‘ä»¬å®é™…ä¸Šåªæ„å»ºäº†ä¸€ä¸ªå›¾è¡¨ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰450åœºèƒœåˆ©ï¼ˆ15å­£* 30æ”¯çƒé˜Ÿï¼‰çš„èƒœåˆ©æŒ‡æ ‡ï¼Œç„¶åä½¿ç”¨<code>gganimate</code>è½¯ä»¶åŒ…ä¸­çš„å‡½æ•°å°†å…¶â€œåˆ’åˆ†â€ä¸ºå¿…è¦çš„å˜é‡ï¼ˆåœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ä¸ºå¹´ä»½ï¼‰ã€‚ </p><br><pre> <code class="plaintext hljs">gg &lt;- ggplot(table1, aes(cumrank, group = TeamName, fill = as.factor(TeamName), color = as.factor(TeamName))) + geom_tile(aes(y = CumWins/2, height = CumWins, width = 0.7), color = NA, alpha = 0.8)</code> </pre> <br><p> é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨<code>ggplot</code>å‡½æ•°åˆ›å»ºå›¾å½¢ã€‚ åœ¨<code>aes</code>å‚æ•°ä¸­ï¼ŒæŒ‡å®šå¦‚ä½•å°†è¡¨ä¸­çš„å˜é‡æ˜¾ç¤ºåœ¨å›¾è¡¨ä¸Šã€‚ æˆ‘ä»¬é€šè¿‡TeamNameå¯¹å®ƒä»¬è¿›è¡Œåˆ†ç»„ï¼Œ <code>fill</code>å’Œ<code>color</code>å°†è´Ÿè´£åˆ—çš„é¢œè‰²ã€‚ </p><br><p> çœŸå®çš„åˆ—ç§°å®ƒå¹¶ä¸å®Œå…¨æ­£ç¡®ã€‚ ä½¿ç”¨<code>geom_tile</code>æˆ‘ä»¬å°†å›¾è¡¨ä¸Šçš„æ•°æ®â€œåˆ’åˆ†â€ä¸ºçŸ©å½¢ã€‚ è¿™æ˜¯æ­¤ç±»å›¾è¡¨çš„ç¤ºä¾‹ï¼š <br><img src="https://habrastorage.org/getpro/habr/post_images/210/405/916/2104059165b8000275951025c2020b5b.jpg"><br> å¯ä»¥çœ‹å‡ºï¼Œå›¾å½¢æ˜¯å¦‚ä½•â€œåˆ’åˆ†â€ä¸ºæ­£æ–¹å½¢çš„ï¼ˆå®ƒä»¬æ˜¯ä½¿ç”¨<code>coord_equal()</code>å±‚ä»çŸ©å½¢è·å¾—çš„ï¼‰ï¼Œæ¯åˆ—ä¸‰ä¸ªã€‚ ä½†æ˜¯ç”±äºå‚æ•°<code>width</code>å°äº1ï¼Œæˆ‘ä»¬çš„å›¾å—é‡‡ç”¨äº†åˆ—çš„å½¢å¼ã€‚ </p><br><pre> <code class="plaintext hljs"> geom_text(aes(y = 0, label = paste(TeamName, " ")), vjust = 0.2, hjust = 1, size = 6) + geom_text(aes(y = CumWins, label = paste0(" ",round(CumWins))), hjust = 0, size = 7) + coord_flip(clip = "off", expand = FALSE) + scale_fill_manual(values = cols) + scale_color_manual(values = cols) + scale_y_continuous(labels = scales::comma) + scale_x_reverse() + guides(color = FALSE, fill = FALSE) +</code> </pre> <br><p> æ¥ä¸‹æ¥ï¼Œæˆ‘ä½¿ç”¨<code>geom_text</code>æ·»åŠ ä¸¤ä¸ªç­¾åï¼šå›¢é˜Ÿåç§°å’Œè·èƒœæ¬¡æ•°ã€‚  <code>coord_flip</code>äº¤æ¢è½´ï¼Œ <code>scale_fill_manual</code>å’Œ<code>scale_color_manual</code>æ›´æ”¹åˆ—çš„é¢œè‰²ï¼Œ <code>scale_x_reverse</code> â€œæ‰©å±•â€ Xè½´æ³¨æ„ï¼Œæˆ‘ä»¬ä»å…ˆå‰åˆ›å»ºçš„<code>cols</code>çŸ¢é‡ä¸­è·å–é¢œè‰²ã€‚ </p><br><p>  <code>theme</code>å±‚æŒ‡å®šç”¨äºè°ƒæ•´å›¾å½¢æ˜¾ç¤ºçš„é€‰é¡¹ã€‚ æ­¤å¤„æŒ‡ç¤ºäº†å¦‚ä½•æ˜¾ç¤ºè½´çš„æ ‡é¢˜å’Œæ ‡ç­¾ï¼ˆæ— è®ºå¦‚ä½•ï¼Œç­‰å·å³ä¾§çš„<code>element_blank</code>éƒ½ä¸å‘Šè¯‰æˆ‘ä»¬ï¼‰ã€‚ æˆ‘ä»¬æ²¿Yè½´åˆ é™¤å›¾ä¾‹ï¼ŒèƒŒæ™¯ï¼Œæ¡†æ¶å’Œç½‘æ ¼çº¿ï¼Œå¹¶<code>plot.title</code> ï¼Œ <code>plot.subtitle</code> ï¼Œ <code>plot.caption</code>å‚æ•°è®¾ç½®æ ‡é¢˜ï¼Œå­—å¹•å’Œå›¾è¡¨ç­¾åçš„æ˜¾ç¤ºé€‰é¡¹ã€‚ æœ‰å…³æ‰€æœ‰å‚æ•°å«ä¹‰çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">gglot2ã€‚</a> </p><br><pre> <code class="plaintext hljs">theme(axis.line=element_blank(), axis.text.x=element_blank(), axis.text.y=element_blank(), axis.ticks=element_blank(), axis.title.x=element_blank(), axis.title.y=element_blank(), legend.position="none", panel.background=element_blank(), panel.border=element_blank(), panel.grid.major=element_blank(), panel.grid.minor=element_blank(), panel.grid.major.x = element_line( size=.1, color="grey" ), panel.grid.minor.x = element_line( size=.1, color="grey" ), plot.title=element_text(size=25, hjust=0.5, face="bold", colour="black", vjust=-1), plot.subtitle = element_text(size = 15), plot.caption =element_text(size=15, hjust=0.5, color="black"), plot.background=element_blank(), plot.margin = margin(2,2, 2, 4, "cm"))</code> </pre> <br><h2 id="sozdanie-animacii"> åˆ›å»ºåŠ¨ç”» </h2><br><p> æˆ‘ä¸ä¼šå†ä½¿ç”¨<code>transition_states</code>å‡½æ•°ï¼Œè¿™éƒ¨åˆ†ä¸æˆ‘å…ˆå‰åœ¨HabrÃ©ä¸Šå‘è¡¨çš„æ–‡ç« ç›¸åŒã€‚ å¯¹äº<code>labs</code>å®ƒå°†åˆ›å»ºå›¾è¡¨çš„æ ‡é¢˜ï¼Œå‰¯æ ‡é¢˜å’Œç­¾åã€‚ ä½¿ç”¨<code>{closest_state}</code>å¯ä»¥è®©æ‚¨åœ¨å›¾è¡¨ä¸Šæ˜¾ç¤ºæ¯ä¸ªç‰¹å®šçš„å¹´ä»½ï¼Œè¿™äº›å›¾è¡¨æˆ‘ä»¬ç›®å‰æ­£åœ¨æŸ¥çœ‹ã€‚ </p><br><pre> <code class="plaintext hljs"> anim &lt;- gg + transition_states(year, transition_length = 4, state_length = 1) + view_follow(fixed_x = TRUE) + labs(title = "Cumulative Wins by teams in seasons", subtitle = "Season: {closest_state}", caption = "Telegram: @NBAatlantic, Twitter: @vshufiskiy\n Data sourse: stats.nba.com")</code> </pre> <br><h2 id="funkciya-nba_cumulative_wins-dlya-sozdaniya-grafikov">  <code>nba_cumulative_wins</code>å‡½æ•°ç”¨äºåˆ›å»ºå›¾è¡¨ã€‚ </h2><br><p> å¦‚æœæ‚¨éœ€è¦å¤šæ¬¡ä½¿ç”¨ä»£ç ï¼Œç¼–å†™å‡½æ•°å¯ä»¥ç®€åŒ–å¹¶åŠ å¿«è·å¾—ç»“æœçš„è¿‡ç¨‹ã€‚ é€šå¸¸ï¼ŒRä¸­çš„å‡½æ•°å…·æœ‰ä»¥ä¸‹å½¢å¼ï¼š </p><br><pre> <code class="plaintext hljs">_ &lt;- function( ) { _ }</code> </pre> <br><p> é¦–å…ˆï¼Œæ‚¨éœ€è¦äº†è§£è¦ä½¿ç”¨è¯¥å‡½æ•°æ›´æ”¹å“ªäº›å‚æ•°ï¼Œå…¶å‚æ•°å°†å–å†³äºæ­¤ã€‚ ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ­£åœ¨è¾“å…¥çš„æ•°æ®è¡¨çš„åç§°ã€‚ è¿™æ ·ï¼Œæ‚¨å¯ä»¥åœ¨éœ€è¦æ—¶é‡å‘½åå®ƒï¼Œè€Œæ— éœ€æ›´æ”¹å‡½æ•°æœ¬èº«ä¸­çš„ä»»ä½•å†…å®¹ã€‚ æˆ‘è¿˜å¸Œæœ›å›¾è¡¨ä¸Šæ˜¾ç¤ºä»»æ„æ•°é‡çš„å‘½ä»¤ï¼šä»ä¸€ä¸ªï¼ˆæ¯«æ— æ„ä¹‰ï¼‰åˆ°30ä¸ªï¼ˆæ ¹æœ¬ä¸å†å­˜åœ¨ï¼‰ã€‚ æˆ‘è¿˜å¸Œæœ›èƒ½å¤Ÿè€ƒè™‘æˆ‘æ‹¥æœ‰æ•°æ®çš„é‚£15å¹´å†…çš„ä»»ä½•æ—¶é—´æ®µã€‚ æ‰€æœ‰è¿™äº›éƒ½æ˜¯é€šè¿‡ä»¥ä¸‹å‡½æ•°å½¢å¼å®ç°çš„ï¼š </p><br><pre> <code class="plaintext hljs">nba_cumulative_wins &lt;- function(table, elements, first_season, last_season){ ... }</code> </pre> <br><p> å…¶ä¸­<code>table</code>æ˜¯å…·æœ‰è¾“å…¥æ•°æ®çš„è¡¨çš„åç§°ï¼Œ <br>  <code>elements</code>åº”è¯¥åœ¨å›¾è¡¨ä¸Šæ˜¾ç¤ºçš„å›¢é˜Ÿçš„åç§° <br>  <code>first_season</code>è¦åœ¨å›¾è¡¨ä¸Šæ˜¾ç¤ºçš„ç¬¬ä¸€ä¸ªå­£èŠ‚ <br>  <code>last_season</code>å›¾è¡¨ä¸Šè¦æ˜¾ç¤ºçš„æœ€åä¸€ä¸ªå­£èŠ‚ã€‚ </p><br><p> å¦‚æœå‚æ•°ç»å¸¸ä¸ç‰¹å®šå€¼ä¸€èµ·ä½¿ç”¨ï¼Œåˆ™å¯ä»¥é»˜è®¤è®¾ç½®å®ƒã€‚ ç„¶åï¼Œå¦‚æœåœ¨å‡½æ•°çš„å‚æ•°ä¸­å°†å…¶çœç•¥ï¼Œåˆ™å°†æ›¿æ¢è¯¥å€¼ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æ³¨å†Œ </p><br><p> <code>nba_cumulative_wins &lt;- function(table, elements, first_season, last_season = 2018)</code> </p> <br><p> é™¤éå¦æœ‰è¯´æ˜ï¼Œå¦åˆ™æ—¶é—´è¡¨å°†ä¸€ç›´æŒç»­åˆ°2018/19èµ›å­£ã€‚ </p><br><h2 id="rabota-s-argumentami-elements-first_season-last_season"> ä½¿ç”¨å‚æ•°<code>elements</code> ï¼Œ <code>first_season</code> ï¼Œ <code>last_season</code> </h2><br><p> ä½¿ç”¨<code>elements</code>å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šè¦åœ¨å›¾è¡¨ä¸Šçœ‹åˆ°çš„çƒé˜Ÿçš„åç§°ã€‚ å½“æœ‰2æˆ–3ä¸ªè¿™æ ·çš„çƒé˜Ÿæ—¶ï¼Œè¿™éå¸¸æ–¹ä¾¿ï¼Œä½†æ˜¯å¦‚æœè¦æ˜¾ç¤ºæ•´ä¸ªè”èµ›ï¼Œæˆ‘ä»¬å°†å¿…é¡»åœ¨æ–¹æ‹¬å·ä¸­å†™ä¸Š<code>elements = c()</code>å’Œæ‰€æœ‰30æ”¯çƒé˜Ÿçš„åç§°ã€‚ </p><br><p> å› æ­¤ï¼Œæˆ‘å†³å®šå°†<code>elements</code>å‚æ•°çš„è¾“å…¥å€¼â€œæ‹†åˆ†â€ä¸ºå‡ ç»„ã€‚ <br>  <code>nba_cumulative_wins</code>å‡½æ•°å¯ä»¥ä¸ºå•ä¸ªå›¢é˜Ÿï¼Œéƒ¨é—¨ï¼Œä¼šè®®æˆ–æ•´ä¸ªNBAæ„å»ºå›¾å½¢ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä½¿ç”¨äº†ä»¥ä¸‹æ„é€ ï¼š </p><br><pre> <code class="plaintext hljs"> select_teams &lt;- unique(table1$TeamName) select_div &lt;- unique(table1$Division) select_conf &lt;- unique(table1$Conference) select_nba &lt;- "NBA" table1 &lt;- if(elements %in% select_teams){ table1[TeamName %in% elements] } else if (elements %in% select_div){ table1[Division %in% elements] } else if(elements %in% select_conf){ table1[Conference %in% elements] } else if(elements == "NBA"){ table1 } else { NULL }</code> </pre> <br><p>  <code>select_</code>ç¬¦å·å‘é‡åŒ…å«æ‰€æœ‰30æ”¯çƒé˜Ÿï¼Œ6ä¸ªåˆ†åŒºï¼Œ2ä¸ªä¼šè®®å’ŒNBAçš„åç§°ï¼Œ <code>unique</code>åŠŸèƒ½ä»…ç•™ä¸‹ä¸€ä¸ªå”¯ä¸€åç§°ï¼Œè€Œä¸æ˜¯15ï¼ˆæŒ‰æ•°æ®å¹´é™ï¼‰ã€‚ </p><br><p> ç„¶åï¼Œä½¿ç”¨<code>if...else</code> ï¼ŒéªŒè¯è¾“å…¥çš„<code>elements</code>å‚æ•°å±äºä¸€ä¸ªç±»ï¼ˆ <code>%in%</code>ç”¨äºç¡®å®šå…ƒç´ æ˜¯å¦å±äºå‘é‡ï¼‰ï¼Œå¹¶ç›¸åº”åœ°ä¿®æ”¹æ•°æ®è¡¨ã€‚ ç°åœ¨ï¼Œå¦‚æœæˆ‘æƒ³çœ‹çœ‹è¥¿å—åˆ†åŒºçš„æ¯”èµ›ç»“æœ </p><br><p> <code>elements = c("Mavericks", "Spurs", "Rockets", "Grillies", "Pelicans")</code> </p> <br><p> åªéœ€è¾“å…¥ </p><br><p>  <code>elements = "Southwest"</code> ï¼Œå®ƒæ›´å¿«ï¼Œæ›´æ–¹ä¾¿ã€‚ </p><br><p> ç”±äºå¯ä»¥é€‰æ‹©å­£èŠ‚ï¼Œå¸¦æ—¥æœŸçš„å·¥ä½œä¹Ÿä¼šæ”¹å˜ã€‚ åœ¨å¼€å§‹æ—¶ï¼Œæ·»åŠ ä»¥ä¸‹è¡Œï¼š </p><br><pre> <code class="plaintext hljs">table1 &lt;- table1[SeasonID &gt;= as.numeric(paste(2, first_season, sep = "")) &amp; SeasonID &lt;= as.numeric(paste(2, last_season, sep = ""))]</code> </pre> <br><p> å› æ­¤ï¼Œæˆ‘åªåœ¨è¡¨ä¸­ä¿ç•™é‚£äº›å±äºæˆ‘ä»¬é€‰æ‹©çš„æ—¶é—´é—´éš”çš„è¡Œã€‚ åˆ›å»º<code>year</code>åˆ—çš„ä»£ç ä¹Ÿä¼šæ›´æ”¹ã€‚ ç°åœ¨çœ‹èµ·æ¥åƒè¿™æ ·ï¼š </p><br><pre> <code class="plaintext hljs">table1 &lt;- table1[ ,year := rep(seq(first_season, last_season), each = length(unique(table1$TeamName)))]</code> </pre> <br><p> ä¸å…ƒç´ åˆ†ç»„æœ‰å…³ï¼Œè·å¾—æ‰€éœ€é¢œè‰²çš„è¿‡ç¨‹å¾ˆå¤æ‚ã€‚ äº‹å®æ˜¯åœ¨è¡¨<code>table_color</code>åªæœ‰å‘½ä»¤çš„åç§°ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦â€œæ”¶ç¼©â€æˆ‘ä»¬çš„å®«ç¼©ã€‚ ä¸ºæ­¤ï¼Œè¯·å†æ¬¡ä½¿ç”¨<code>if...else</code>æ„é€ ã€‚ </p><br><pre> <code class="plaintext hljs"> elements1 &lt;- if (elements == "NBA"){ c("Hawks", "Celtics", "Nets", "Hornets", "Bulls", "Cavaliers", "Mavericks", "Nuggets", "Pistons", "Warriors", "Rockets", "Pacers", "Clippers", "Lakers", "Grizzlies", "Heat", "Bucks", "Timberwolves", "Pelicans", "Knicks", "Thunder", "Magic", "76ers", "Suns", "Trail Blazers","Kings", "Spurs", "Raptors", "Jazz", "Wizards") } else if (elements == "West") { c("Mavericks","Nuggets", "Warriors", "Rockets", "Clippers", "Lakers", "Grizzlies","Timberwolves", "Pelicans", "Thunder", "Suns", "Trail Blazers","Kings", "Spurs", "Jazz") } else if (elements == "East") { c("Hawks", "Celtics", "Nets", "Hornets", "Bulls", "Cavaliers","Pistons", "Pacers", "Heat", "Bucks", "Knicks", "Magic", "76ers", "Raptors", "Wizards") } else if (elements == "Pacific") { c("Warriors", "Clippers", "Lakers", "Suns", "Kings") } else if (elements == "Southeast") { c("Magic", "Hornets", "Heat", "Hawks", "Wizards") } else if (elements == "Southwest") { c("Mavericks", "Grizzlies", "Pelicans", "Rockets", "Spurs") } else if (elements == "Central") { c("Bucks", "Pacers", "Pistons", "Bulls", "Cavaliers") } else if (elements == "Atlantic") { c("Knicks", "Nets", "Celtics", "Raptors", "76ers") } else if (elements == "Northwest") { c("Nuggets", "Trail Blazers", "Jazz", "Thunder", "Suns") } else { elements }</code> </pre> <br><p> æ¥ä¸‹æ¥ï¼Œä½¿ç”¨æ‰€éœ€å‘½ä»¤çš„åç§°åˆ›å»ºä¸€ä¸ªè¡¨ï¼Œä½¿ç”¨<code>dplyr</code>åŒ…ä¸­çš„<code>inner_join</code>å‡½æ•°å°†è¯¥è¡¨è¿æ¥è‡³<code>table_color</code> ã€‚  <code>inner_join</code>ä»…åŒ…æ‹¬åœ¨ä¸¤ä¸ªè¡¨ä¸­éƒ½åŒ¹é…çš„æƒ…å†µã€‚ </p><br><pre> <code class="plaintext hljs"> table_elements1 &lt;- data.table(TeamName = elements1) table_color &lt;- table_color[order(TeamName)] inner_table_color &lt;- inner_join(table_color, table_elements1) cols &lt;- inner_table_color[, "TEAM_color"]</code> </pre> <br><p> è¯¥åŠŸèƒ½æ›´æ”¹æ ‡é¢˜å’Œå‰¯æ ‡é¢˜çš„æ‹¼å†™ã€‚ ä»–ä»¬çœ‹èµ·æ¥åƒè¿™æ ·ï¼š </p><br><pre> <code class="plaintext hljs">anim &lt;- gg + transition_states(year, transition_length = 4, state_length = 1) + view_follow(fixed_x = TRUE) + labs(title = paste("Cumulative Wins by teams in seasons", first_season, "-", last_season, sep = " "), subtitle = paste(if (elements %in% select_div ){ paste(elements, "Division", sep = " ") } else if (elements %in% select_conf ){ paste("Conference", elements, sep = " ") }, "Season: {closest_state}", sep = " "), caption = "Telegram: @NBAatlantic, Twitter: @vshufiskiy\nData sourse: stats.nba.com")</code> </pre> <br><h2 id="rendering"> æ¸²æŸ“å›¾ </h2><br><p> æ­¤å¤–ï¼Œæ‰€æœ‰è¿™äº›éƒ½å¯è§†åŒ–äº†ã€‚ </p><br><pre> <code class="plaintext hljs">animate(anim, nframes = (last_season - first_season + 1) * (length(unique(table1$TeamName)) + 20), fps = 20, width = 1200, height = 1000, renderer = gifski_renderer(paste(elements[1], "cumwins.gif", sep = "_")))</code> </pre> <br><p> æˆ‘å‡­ç»éªŒé€‰æ‹©äº†<code>nframes</code>çš„æ•°å­—ï¼Œå› æ­¤ï¼Œæ ¹æ®æ‰€é€‰å‘½ä»¤çš„æ•°é‡ï¼Œé€Ÿåº¦ä¼šå¢åŠ /å‡å°‘ã€‚ </p><br><h2 id="grafik"> å›¾è¡¨ </h2><br><p><img src="https://habrastorage.org/getpro/habr/post_images/e15/803/11d/e1580311d19d5f814b201c32237a3ed5.gif"></p><br><p> å¸Œæœ›æˆ‘çš„å¸–å­æœ‰è¶£ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Github</a>é¡¹ç›®ä»£ç ã€‚ </p><br><p> å¦‚æœæ‚¨å¯¹è¿™äº›å¯è§†åŒ–çš„ä½“è‚²éƒ¨åˆ†æ„Ÿå…´è¶£ï¼Œå¯ä»¥è®¿é—®æˆ‘åœ¨sports.ruä¸Šçš„åšå®¢â€œå¤§è¥¿æ´‹ä¸¤å²¸â€ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN458904/">https://habr.com/ru/post/zh-CN458904/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN458892/index.html">æœ‰å…³æ¼æ´å’Œä¿æŠ¤æœºå™¨å­¦ä¹ æ¨¡å‹çš„å»ºè®®</a></li>
<li><a href="../zh-CN458894/index.html">å…¸å‹äººç‰©åŠå…¶æ‰€ç”Ÿæ´»çš„ç½‘ç»œ</a></li>
<li><a href="../zh-CN458896/index.html">åŠŸèƒ½JavaScriptï¼šä»€ä¹ˆæ˜¯é«˜é˜¶å‡½æ•°ï¼Œä¸ºä»€ä¹ˆéœ€è¦å®ƒä»¬ï¼Ÿ</a></li>
<li><a href="../zh-CN458900/index.html">æ§åˆ¶å°ç›’å¸¦ä½œä¸ºè°ƒåˆ¶è§£è°ƒå™¨</a></li>
<li><a href="../zh-CN458902/index.html">5ä¸ªå¸¸è§çš„åˆå­¦è€…Pythoné”™è¯¯</a></li>
<li><a href="../zh-CN458906/index.html">[å¶å¡æ·ç³å ¡ï¼Œå…¬å‘Š] Flutteron-Flutterå¼€å‘ç ”è®¨ä¼š</a></li>
<li><a href="../zh-CN458908/index.html">é€šè¿‡ç½‘ç»œæ‰«ææ–‡æ¡£</a></li>
<li><a href="../zh-CN458910/index.html">ä½¿ç”¨å¤§å‹Linuxé¡µé¢å¯¹PostgreSQLè¿›è¡ŒåŸºå‡†æµ‹è¯•</a></li>
<li><a href="../zh-CN458912/index.html">ä½¿ç”¨imapsyncè¿ç§»åˆ°Zimbra</a></li>
<li><a href="../zh-CN458914/index.html">åœ¨Unityä¸Šåˆ›å»ºæ¸¸æˆéœ€è¦äº†è§£ä»€ä¹ˆï¼ˆä¸æ˜¯ï¼‰</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>