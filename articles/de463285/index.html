<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍⚖️ 👁‍🗨 🧙🏽 ShIoTiny: Knoten, Links und Ereignisse oder Funktionen von Zeichenprogrammen ➖ 🧘🏾 🏂🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wichtige Punkte oder worum es in diesem Artikel geht 
 Das Thema des Artikels ist die hier beschriebene visuelle Programmierung der ShIoTiny- SPS für ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ShIoTiny: Knoten, Links und Ereignisse oder Funktionen von Zeichenprogrammen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463285/"><img src="https://habrastorage.org/webt/s3/ym/wy/s3ymwykg-no-z12-gk5znf02hrs.jpeg"><br><br><h4>  Wichtige Punkte oder worum es in diesem Artikel geht </h4><br>  Das Thema des Artikels ist die hier beschriebene visuelle Programmierung der <b>ShIoTiny-</b> SPS für das Smart Home: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ShIoTiny: kleine Automatisierung, das Internet der Dinge oder „sechs Monate vor den Feiertagen“</a> . <br><br>  Konzepte wie <b>Knoten</b> , <b>Kommunikation</b> , <b>Ereignisse</b> sowie Funktionen zum Laden und Ausführen eines visuellen Programms auf <b>ESP8266</b> , das die Grundlage von <b>ShIoTiny</b> PLC bildet, werden <b>sehr kurz besprochen</b> . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>ShIoTiny-</b> Projektseite</a> <br><br><a name="habracut"></a><br><h4>  Einführung oder ein paar organisatorische Fragen </h4><br>  In einem früheren Artikel über meine Entwicklung gab ich einen kurzen Überblick über die Funktionen des <b>ShIoTiny-</b> Controllers. <br><br>  Seltsamerweise zeigte die Öffentlichkeit ein ziemlich starkes Interesse und stellte mir viele Fragen.  Einige Kameraden boten mir sogar sofort an, einen Controller zu kaufen.  Nein, ich bin nicht dagegen, ein wenig Geld zu verdienen, aber mein Gewissen erlaubt mir nicht, etwas zu verkaufen, das in Bezug auf Software immer noch sehr grob ist. <br><br>  Daher habe ich auf GitHub Firmware-Binärdateien und Gerätediagrammen gepostet: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Firmware + kürzeste Anweisung + Schaltung + Beispiele</a> . <br><br>  Jetzt kann jeder ESP-07 flashen und alleine mit der Firmware spielen.  Wenn jemand wirklich nur ein Brett wie auf dem Foto haben möchte, dann habe ich mehrere davon.  Schreiben Sie an <b>shiotiny@yandex.ru</b> .  Aber wie die unvergesslichen Gurken immer sagten: "Ich bin für nichts verantwortlich!" <br><br>  Kommen wir also zum Punkt: Was ist ein „ <b>Knoten</b> “ (Knoten) und ein „ <b>Ereignis</b> “?  Wie wird das Programm ausgeführt? <br><br>  Beginnen Sie wie gewohnt in der richtigen Reihenfolge: indem Sie das Programm herunterladen. <br><br><h4>  Wie wird das Programm geladen? </h4><br>  Was passiert, wenn wir im <b>ElDraw-</b> Editor auf die Schaltfläche <b>Hochladen</b> <b>klicken</b> und unser Programmschema, das aus schönen Quadraten besteht, in das Gerät fliegt. <br><br>  Zunächst wird auf der Grundlage des von uns gezeichneten Diagramms dessen Beschreibung in Textform erstellt. <br>  Zweitens wird geprüft, ob alle Eingänge der Knoten mit den Ausgängen verbunden sind.  Es sollten keine "hängenden" Eingänge vorhanden sein.  Wenn ein solcher Eingang erkannt wird, wird die Schaltung in ShIoTiny nicht geladen und der Editor zeigt eine Warnung an. <br><br>  Wenn alles gut gegangen ist, sendet der Editor eine Textbeschreibung der Schaltung an einen Knoten in ShIoTiny.  Natürlich wurde das vorhandene Schema von ShIoTiny zuvor entfernt.  Die resultierende Textbeschreibung wird im FLASH-Speicher gespeichert. <br><br>  Übrigens, wenn Sie die Schaltung vom Gerät entfernen möchten, laden Sie einfach eine leere Schaltung (die keine Knotenelemente enthält) hinein. <br><br>  Sobald die gesamte Programmschaltung in die ShIoTiny-SPS geladen ist, beginnt sie zu „laufen“.  Was bedeutet das? <br><br>  Beachten Sie, dass die Prozesse zum Laden der Schaltung aus dem FLASH-Speicher beim Einschalten und beim Empfang der Schaltung vom Editor identisch sind. <br><br>  Zuerst werden Knotenobjekte basierend auf ihrer Beschreibung erstellt. <br>  Dann wird die Anordnung der Verbindungen zwischen Knoten hergestellt.  Das heißt, Verknüpfungen von Ausgängen zu Eingängen und Eingängen zu Ausgängen werden erzeugt. <br><br>  Und erst danach wird der Hauptprogrammausführungszyklus gestartet. <br><br>  Ich habe lange geschrieben, aber der gesamte Prozess - vom „Laden“ der Schaltung aus dem FLASH-Speicher bis zum Start der Hauptschleife - dauert für eine Schaltung mit 60-80 Knoten einen Sekundenbruchteil. <br><br>  Wie funktioniert die Hauptschleife?  Sehr einfach.  Zuerst wartet er darauf, dass das <b>Ereignis</b> in einem beliebigen Knoten <b>auftritt</b> , und verarbeitet dann dieses Ereignis.  Und so ohne Ende.  Nun, oder bis sie ein neues Schema auf ShIoTiny hochladen. <br><br>  Ich habe bereits mehrmals Dinge wie <b>Ereignisse</b> , <b>Knoten</b> und <b>Verbindungen erwähnt</b> .  Aber was ist das aus Software-Sicht?  Wir werden heute darüber sprechen. <br><br><h4>  Knoten, Verbindungen und Ereignisse </h4><br>  Schauen Sie sich einfach die Beispiele für Schaltungsprogramme für <b>ShIoTiny</b> an, um zu verstehen, dass eine Schaltung nur aus zwei Entitäten besteht - Knoten (oder Elementen) und den Beziehungen zwischen ihnen. <br><br>  <b>Ein Knoten</b> , <b>Knoten</b> oder <b>Schaltungselement</b> ist eine virtuelle Darstellung einer <b>Aktion</b> auf Daten.  Dies kann eine arithmetische Operation, eine logische Operation oder eine beliebige Operation sein, die uns einfällt.  Die Hauptsache ist, dass der Knoten einen Eingang und einen Ausgang hat. <br><br>  <b>Bei einer Eingabe</b> empfängt der Knoten Daten.  Eingabebilder sind Punkte, die sich immer auf der linken Seite des Knotens befinden. <br><br>  <b>Die Ausgabe</b> ist der Ort, an dem das Ergebnis der Knotenoperation extrahiert wird.  Ausgabebilder sind Punkte, die sich immer auf der rechten Seite des Knotens befinden. <br><br>  Einige Knoten haben keine Eingaben.  Solche Knoten erzeugen ein Ergebnis in sich.  Zum Beispiel ein konstanter Knoten oder ein Sensorknoten: Sie benötigen keine Daten von anderen Knoten, um das Ergebnis zu melden. <br><br>  Andere Knoten haben dagegen keine Ausgänge.  Dies sind Knoten, die beispielsweise Aktuatoren (Relais oder ähnliche Geräte) anzeigen.  Sie akzeptieren Daten, generieren jedoch nicht das Ergebnis von Berechnungen, die anderen Knoten zur Verfügung stehen. <br><br>  Darüber hinaus gibt es einen eindeutigen Kommentarknoten.  Er tut nichts, hat weder Ein- noch Ausgänge.  Sein Zweck ist es, eine Erklärung im Diagramm zu sein. <br><br>  Was ist ein " <b>Ereignis</b> "?  <b>Ein Ereignis</b> ist das Auftreten neuer Daten in einem Knoten.  Zu den Ereignissen gehören beispielsweise: Ändern des Eingabestatus (Eingabeknoten), Empfangen von Daten von einem anderen Gerät ( <b>MQTT-</b> und <b>UDP-</b> Knoten), Ablauf eines bestimmten Zeitraums ( <b>Timer-</b> und <b>Verzögerungsknoten</b> ) usw. <br><br>  Wofür sind Events?  Ja, um festzustellen, auf welchem ​​Knoten die neuen Daten erschienen sind und welche Zustände im Zusammenhang mit dem Empfang neuer Daten geändert werden müssen.  Das Ereignis „läuft“ sozusagen entlang der Knotenkette, bis alle Knoten umgangen wurden, deren Status überprüft und geändert werden muss. <br><br>  Alle Knoten können in zwei Kategorien unterteilt werden. <br>  Die Knoten, die Ereignisse erzeugen können, werden als " <b>aktive Knoten</b> " bezeichnet. <br>  Die Knoten, die keine Ereignisse generieren können, werden als " <b>passive Knoten</b> " bezeichnet. <br><br>  Wenn ein Knoten ein Ereignis generiert (dh neue Daten werden an seiner Ausgabe angezeigt), ändert sich im Allgemeinen der Status der gesamten Knotenkette, die mit der Ausgabe des Ereignisgeneratorknotens verbunden ist. <br><br>  Betrachten Sie zur Verdeutlichung das Beispiel in der Abbildung. <br><br><img src="https://habrastorage.org/webt/mi/vd/kz/mivdkz3cx_wvzdhnd4fflb9t1xu.png"><br><br>  Die aktiven Knoten hier sind Input1, Input2 und Input3.  Die restlichen Knoten sind passiv.  Überlegen Sie, was passiert, wenn diese oder jene Eingabe geschlossen wird.  Der Einfachheit halber sind die Ergebnisse tabellarisch aufgeführt. <br><br><img src="https://habrastorage.org/webt/er/eh/wn/erehwn5_nqschmn03cnblvlbdbk.jpeg"><br><br>  Wie Sie sehen können, wird beim Eintreten eines Ereignisses eine Kette vom Quellknoten des Ereignisses zum Endknoten erstellt.  Der Status der Knoten, die nicht in die Kette fallen, ändert sich nicht. <br><br>  Es stellt sich eine berechtigte Frage, aber was passiert, wenn zwei oder sogar mehrere Ereignisse gleichzeitig auftreten? <br><br>  Als Liebhaber von Gleb Anfilovs Werk bin ich versucht, einen neugierigen Fragesteller zu seinem Buch "Flight from Surprise" zu schicken.  Dies ist eine solche "Relativitätstheorie für die Kleinsten", in der gut gesagt wird, was "gleichzeitig" ist und wie man damit lebt. <br><br>  Aber fast alles ist viel einfacher: Wenn zwei oder sogar mehrere Ereignisse auftreten, werden alle Ketten aus jeder Ereignisquelle nacheinander aufgebaut und verarbeitet, und es gibt keine Wunder. <br><br>  Die nächste rechtmäßige Frage eines neugierigen Lesers ist, was passiert, wenn die Knoten in einem Ring verbunden sind?  Oder, wie es unter Ihren klugen Männern üblich ist, Feedback einzuführen.  Verbinden Sie also den Ausgang eines der Knoten mit dem Eingang des vorherigen Knotens, sodass der Ausgangszustand dieses Knotens den Zustand seines Eingangs beeinflusst.  <b>Mit dem ElDraw-</b> Editor können Sie die <b>Knotenausgabe</b> nicht direkt mit der eigenen Eingabe verbinden.  Aber indirekt, wie in der folgenden Abbildung, kann dies getan werden. <br><br>  Was wird in diesem Fall sein?  Die Antwort wird sehr "eindeutig" sein: abhängig von den Knoten.  Betrachten Sie das Beispiel in der Abbildung. <br><br><img src="https://habrastorage.org/webt/ta/rr/wd/tarrwdvrk01cizkl5xg9x4ilfym.png"><br><br>  Wenn die Kontakte des Eingangseingangs1 am oberen Eingang von Knoten A - 0 geöffnet sind. Am Ausgang von Knoten A auch 0. Am Ausgang von Knoten B - 1. Und schließlich am unteren Eingang von Knoten A - 1. Alles ist klar.  Und für wen es nicht klar ist - unten finden Sie eine Beschreibung der Funktionsweise der Knoten "UND" und "NICHT". <br><br>  Schließen Sie nun die Kontakte des Eingangseingangs1, dh wir versorgen den oberen Eingang von Knoten A mit einem.  Diejenigen, die mit Elektronik vertraut sind, wissen, dass wir tatsächlich eine klassische Logikgeneratorschaltung erhalten.  Und theoretisch sollte ein solches Schema am Ausgang der Elemente A und B endlos die Sequenzen 1-0-1-0-1-0 erzeugen ....  und 0-1-0-1-0-1-1 ....  Schließlich sollte ein Ereignis den Zustand der Knoten A und B ständig ändern und in einem Kreis 2-3-2-3- ... laufen! <br><br>  Das passiert aber eigentlich nicht.  Die Schaltung fällt in einen zufälligen Zustand - oder das Relais bleibt ein- oder ausgeschaltet, oder es summt mehrmals hintereinander leicht ein und aus.  Es hängt alles vom Wetter am Südpol des Mars ab.  Und deshalb passiert dies. <br><br>  Ein Ereignis vom Knoten Input1 ändert den Status von Knoten A, dann von Knoten B usw. mehrmals in einem Kreis.  Das Programm bestimmt die "Schleife" des Ereignisses und beendet diesen Karneval gewaltsam.  Danach werden die Zustandsänderungen der Knoten A und B blockiert, bis ein neues Ereignis eintritt.  Der Moment, in dem das Programm entscheidet - "Hör auf, dich im Kreis zu drehen!"  - Im allgemeinen Fall hängt es von vielen Faktoren ab und kann als zufällig angesehen werden. <br><blockquote>  Seien Sie vorsichtig, wenn Sie Knoten in einem Ring verbinden - die Auswirkungen sind nicht immer offensichtlich!  Stellen Sie sich vor, was und warum Sie tun! </blockquote>  Aber ist es möglich, einen Generator auf den uns zugänglichen Knoten zu bauen?  Ja du kannst!  Dies erfordert jedoch einen Knoten, der selbst weiß, wie Ereignisse generiert werden.  Und es gibt einen solchen Knoten - dies ist eine "Verzögerungsleitung".  In der folgenden Abbildung sehen wir, wie der Generator mit einem Zeitraum von 6 Sekunden arbeitet. <br><br><img src="https://habrastorage.org/webt/xy/ng/xc/xyngxczc6i7ryhc2ssrygfdtcwy.png"><br><br>  Ein Schlüsselelement des Generators ist der Knoten A, die Verzögerungsleitung.  Wenn Sie den Eingangszustand der Verzögerungsleitung von 0 auf 1 ändern, erscheint 1 am Ausgang nicht sofort, sondern erst nach einer bestimmten Zeit.  In unserem Fall sind es 3 Sekunden.  Wenn Sie den Eingangsstatus der Verzögerungsleitung von 1 auf 0 ändern, wird am Ausgang nach denselben 3 Sekunden ebenfalls 0 angezeigt.  Die Verzögerungszeit wird in Zehntelsekunden eingestellt.  Das heißt, der Wert ist 30 und bedeutet - 3 Sekunden. <br><br>  Ein Merkmal der Verzögerungsleitung besteht darin, dass sie nach Ablauf der Verzögerungszeit ein Ereignis erzeugt. <br><br>  Angenommen, der Ausgang der Verzögerungsleitung war anfangs 0. Nach dem Durchgang durch Knoten B, den Wechselrichter, wird diese 0 zu 1 und geht zum Eingang der Verzögerungsleitung.  Nichts passiert sofort.  Am Ausgang der Verzögerungsleitung bleibt wie bisher 0, aber dann wird der Countdown für die Verzögerungszeit aktiviert.  Es dauert 3 Sekunden.  Und dann erzeugt die Verzögerungsleitung ein Ereignis.  Am Ausgang hat sie 1. Diese Einheit wird nach Durchlaufen des Knotens B, des Wechselrichters, zu 0 und geht zum Eingang der Verzögerungsleitung.  Weitere 3 Sekunden vergehen ... und der Vorgang wiederholt sich.  Das heißt, alle 3 Sekunden ändert sich der Ausgangszustand der Verzögerungsleitung von 0 auf 1 und dann von 1 auf 0. Das Relais klickt.  Der Generator arbeitet.  Die Impulsdauer beträgt 6 Sekunden (3 Sekunden am Ausgang von Null und 3 Sekunden - Eins). <br><br>  In realen Schaltkreisen müssen Sie dieses Beispiel jedoch normalerweise nicht verwenden.  Es gibt spezielle Zeitgeberknoten, die perfekt und ohne externe Hilfe dazu beitragen, eine Folge von Impulsen mit einer bestimmten Periode zu erzeugen.  Die Dauer von "Null" und "Einheiten" in diesen Impulsen entspricht der Hälfte der Periode. <br><blockquote>  Verwenden Sie Zeitgeberknoten, um periodische Aktionen festzulegen. </blockquote>  Ich stelle fest, dass solche digitalen Signale, bei denen die Dauer von „Null“ und „Einheiten“ gleich ist, als „Mäander“ bezeichnet werden. <br><br>  Ich hoffe, ich habe die Frage ein wenig geklärt, wie Ereignisse zwischen Knoten verteilt sind und was nicht getan werden sollte. <br><br><h4>  Schlussfolgerung und Referenzen </h4><br>  Der Artikel erwies sich als kurz, aber dieser Artikel ist die Antwort auf die Fragen zu Knoten und Ereignissen. <br><br>  Während sich die Firmware weiterentwickelt und neue Beispiele erscheinen, werde ich darüber schreiben, wie man kleine <b>ShIoTiny-</b> Artikel programmiert, solange dies für die Leute interessant sein wird. <br><br>  Nach wie vor finden Sie hier das Schema, die Firmware, Beispiele, die Beschreibung der Knoten und alles <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">andere</a> . <br><br>  Fragen, Wünsche, Kritik - hier: <b>shiotiny@yandex.ru</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de463285/">https://habr.com/ru/post/de463285/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de463273/index.html">Frontend Weekly Digest (5. - 11. August 2019)</a></li>
<li><a href="../de463275/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends für die letzte Woche Nr. 375 (5. - 11. August 2019)</a></li>
<li><a href="../de463277/index.html">Aufgabe zur Selbstentwicklung: HTML-Formular mit einer Liste zufälliger Zeichenfolgen und deren Auswahl</a></li>
<li><a href="../de463279/index.html">PHP Digest Nr. 162 (1. - 12. August 2019)</a></li>
<li><a href="../de463281/index.html">Warum es bei Google Play nur wenige innovative Anwendungen gibt oder warum Programmieren manchmal magisch ist</a></li>
<li><a href="../de463289/index.html">Diskrete Mathematik für WMS: Clustering von Lagerbeständen</a></li>
<li><a href="../de463291/index.html">Würfel oder Knochen</a></li>
<li><a href="../de463293/index.html">Müllsammler. Voller Kurs + Transfer von BOTR</a></li>
<li><a href="../de463295/index.html">C ++ und CMake - Brothers Forever, Teil II</a></li>
<li><a href="../de463297/index.html">Loyalität nach Ihrem Geschmack</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>