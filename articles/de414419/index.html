<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé≠ ü§æ üóûÔ∏è ESET bereitet seit 2013 InvisiMole-Spyware vor ‚ìÇÔ∏è üíÉüèª üìâ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Behalten Sie hochrangige Opfer im Auge, indem Sie im Schatten bleiben. Dies ist das Funktionsprinzip von zwei sch√§dlichen Komponenten von InvisiMole. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ESET bereitet seit 2013 InvisiMole-Spyware vor</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/414419/">  Behalten Sie hochrangige Opfer im Auge, indem Sie im Schatten bleiben.  Dies ist das Funktionsprinzip von zwei sch√§dlichen Komponenten von InvisiMole.  Sie verwandeln den infizierten Computer in eine Videokamera der Angreifer, mit der Sie alles sehen und h√∂ren k√∂nnen, was im B√ºro oder an einem anderen Ort passiert, an dem sich das Ger√§t befindet.  InvisiMole-Bediener stellen problemlos eine Verbindung zum System her, √ºberwachen die Aktionen des Opfers und stehlen seine Geheimnisse. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qz/z_/0f/qzz_0fx62wvi_detfemzuckk0zs.jpeg"></div><br>  Laut ESET-Telemetrie sind die Angreifer hinter dieser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Spyware</a> seit mindestens 2013 aktiv.  Dieses <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cyberspionagetool</a> wurde jedoch nicht nur nicht untersucht, sondern erst entdeckt, als es von ESET-Produkten auf infizierten Computern in Russland und der Ukraine entdeckt wurde. <br><br>  Die Kampagne ist sehr zielgerichtet, was die geringe Infektionsrate erkl√§rt - nur ein paar Dutzend Computer. <br><a name="habracut"></a><br>  InvisiMole hat eine modulare Architektur, beginnt seine Reise mit einer Wrapper-DLL (Wrapper-DLL), in deren Ressourcen zwei Module integriert sind.  Beide Module sind multifunktionale Backdoors, mit denen die Malvari maximale Informationen √ºber das Ziel sammeln kann. <br><br>  Um die Aufmerksamkeit des Benutzers von dem infizierten Computer abzulenken, werden zus√§tzliche Ma√ünahmen angewendet.  Dadurch kann das Schadprogramm lange auf dem System verbleiben.  Wir haben den Infektionsvektor noch nicht festgelegt - derzeit sind alle Optionen m√∂glich, einschlie√ülich der manuellen Installation mit physischem Zugriff auf die Maschine. <br><br><h3>  Installation und Persistenz </h3><br>  Der erste Teil der untersuchten Malvari ist ein DLL-Wrapper, der mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Free Pascal</a> Compiler kompiliert wurde.  Gem√§√ü unseren Telemetriedaten wird die DLL im Windows-Ordner abgelegt und als legitime <code>mpr.dll</code> Bibliotheksdatei mit gef√§lschten Versionsinformationen getarnt. <br><br><img src="https://habrastorage.org/webt/63/po/le/63polemyrko5n7gdyrzmenhgeva.png"><br>  <i>Abbildung 1. DLL-Wrapper, der als legitime mpr.dll-Bibliotheksdatei getarnt ist und den Namen und die Versionsinformationen kopiert</i> <br><br>  Wir haben keine Beispiele mit anderen Wrapper-Namen gesehen, obwohl der DLL-Code Hinweise darauf enth√§lt, dass die Datei auch <code>fxsst.dll</code> oder <code>winmm.dll</code> . <br><br>  Der erste Weg, um malvari zu starten, ist die Technik des Ersetzens von DLLs (DLL-Hijacking).  Der DLL-Wrapper befindet sich im selben Ordner wie <code>explorer.exe</code> und wird beim Windows-Start zusammen mit dem Windows Explorer-Prozess anstelle der legitimen Bibliothek im <code>%windir%\system32</code> . <br><br>  Wir haben 32- und 64-Bit-Versionen von Malvari gefunden, die in beiden Architekturen Persistenz bieten. <br><br>  Alternativ zum Spoofing von DLLs sind andere Lade- und Persistenzmethoden m√∂glich.  Die Wrapper-DLL exportiert die <code>GetDataLength</code> Funktion.  Beim Aufrufen dieser Funktion √ºberpr√ºft die DLL, ob sie vom Prozess <code>rundll32.exe</code> geladen wurde, indem <code>explorer.exe</code> oder <code>svchost.exe</code> als √ºbergeordneter Prozess verwendet werden, und startet erst dann die Nutzdaten.  Dies schl√§gt andere m√∂gliche Methoden vor, um die Persistenz sicherzustellen - Hinzuf√ºgen von Aufgaben zum Scheduler (der √ºbergeordnete Prozess ist <code>svchost.exe</code> ) oder Schreiben in den Autorun-Schl√ºssel in der Registrierung (der √ºbergeordnete Prozess ist <code>explorer.exe</code> ). <br><br>  Unabh√§ngig davon, wie die Persistenz aufrechterhalten wird, ist das Verhalten der Malware und der Nutzdaten selbst in allen F√§llen gleich.  Der DLL-Wrapper l√§dt das in Ressourcen gespeicherte Modul unter den Namen <code>RC2FM</code> und <code>RC2CL</code> und (wenn eine DLL-Ersetzung verwendet wird) eine legitime Bibliothek in die <code>RC2CL</code> process <code>explorer.exe</code> , um den normalen Betrieb der Anwendung nicht zu unterbrechen und unbemerkt zu bleiben. <br><br><img src="https://habrastorage.org/webt/tf/-0/eh/tf-0ehnfccoxblcwcetgc7zcgq8.png"><br>  <i>Abbildung 2. Exportierte Wrapperfunktionen</i> <br><br><h2>  Technische Analyse </h2><br>  Das genaue Datum der Kompilierung der Malware ist nicht bekannt - die neuesten DLL-Wrapper-Beispiele wurden von den Autoren ge√§ndert, PE-Zeitstempel wurden manuell auf Null zur√ºckgesetzt.  Im Verlauf der Studie haben wir jedoch eine fr√ºhere Version vom 13. Oktober 2013 gefunden, damit die neuen Versionen sp√§ter klar zusammengestellt werden. <br><br><img src="https://habrastorage.org/webt/rg/ke/pn/rgkepn1sgdnddzbzmrfdij84cbu.png"><br>  <i>Abbildung 3. In allen sp√§teren Beispielen werden Zeitstempel auf Null gesetzt</i> <br><br><h3>  Verschl√ºsselung und Entschl√ºsselung </h3><br>  Um sich vor Virenanalysten und Systemadministratoren zu sch√ºtzen, verwenden die Autoren des Schadprogramms die Verschl√ºsselung von Zeichenfolgen, internen Dateien, Konfigurationsdaten und Netzwerkkommunikation.  W√§hrend das <code>RC2FM</code> Modul benutzerdefinierte Chiffren verwendet, verwenden der DLL-Wrapper und das <code>RC2CL</code> Modul f√ºr alle Zwecke ein bestimmtes Verfahren, einschlie√ülich des Entschl√ºsselns anderer im DLL-Wrapper integrierter sch√§dlicher Module. <br><br>  Das Skript, mit dem Sie die integrierten <code>RC2FM</code> und <code>RC2CL</code> aus dem DLL-Wrapper extrahieren k√∂nnen, ist im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ESET-Repository auf GitHub</a> verf√ºgbar. <br><br><img src="https://habrastorage.org/webt/wx/qz/dm/wxqzdmpwpxazkzgym0u3n-zghmw.png"><br>  <i>Abbildung 4. Entschl√ºsselungsverfahren in verschiedenen Beispielen (dekompiliert und zerlegt)</i> <br><br><h3>  RC2FM-Modul </h3><br>  Das erste, kleinere <code>RC2FM</code> Modul enth√§lt eine Hintert√ºr, die 15 Befehle unterst√ºtzt.  Sie werden auf dem infizierten Computer gem√§√ü den Anweisungen des Angreifers ausgef√ºhrt.  Das Modul kann verschiedene √Ñnderungen am System vornehmen und enth√§lt auch Tools f√ºr die Cyberspionage. <br><br>  Die Dateien k√∂nnen protokolliert werden, aber der Name des Systemprotokolls ist im Beispiel nicht angegeben.  Dies deutet darauf hin, dass die Funktion nur in der Entwicklungsphase verwendet wurde. <br><br><h4>  Netzwerkkommunikation </h4><br>  Dieses Modul kommuniziert mit C &amp; C-Servern, die entweder im Beispiel fest codiert oder sp√§ter von Angreifern hinzugef√ºgt werden. <br><br>  Dar√ºber hinaus kann das Modul auch mit dem auf dem infizierten Computer konfigurierten Proxy auf den C &amp; C-Server zugreifen.  Wenn keine direkte Verbindung hergestellt werden konnte, versucht das Modul, mithilfe lokal konfigurierter Proxys oder Proxys, die f√ºr verschiedene Browser (Firefox, Pale Moon und Opera) konfiguriert sind, eine Verbindung zu einem seiner C &amp; C-Server herzustellen. <br>  RC2FM kann sogar die Liste der zuletzt verwendeten Anwendungen √ºberpr√ºfen und versuchen, ausf√ºhrbare Dateien f√ºr tragbare Browser zu finden: <br><br>  FirefoxPortable.exe <br>  OperaPortable.exe <br>  F√ºhren Sie waterfox.exe aus <br>  OperaAC.exe <br>  Palemoon-Portable.exe <br><br>  Wenn das Opfer einen dieser tragbaren Browser <i>mit konfiguriertem Proxyserver verwendet</i> , kann die Malware ihn in den Benutzereinstellungen erkennen und zur Kommunikation mit seinen C &amp; C-Servern verwenden. <br><br>  Die Kommunikation mit dem C &amp; C-Server besteht aus einer Reihe von HTTP-GET- und POST-Anforderungen (siehe Abbildung 5). Die verschl√ºsselte Anforderung enth√§lt die PC-ID und den Zeitstempel sowie einige andere Informationen (optional).  Es ist wichtig zu beachten, dass das <code>RC2FM</code> Modul im Gegensatz zu anderen InvisiMole-Komponenten mehrere Verschl√ºsselungsmethoden (Varianten der einfachen XOR-Verschl√ºsselung) verwendet. <br><br><img src="https://habrastorage.org/webt/ml/ev/kx/mlevkxds5qah0qvlkocfgxsfplk.png"><br>  <i>Abbildung 5. Ein Beispiel f√ºr eine Anforderung, die vom RC2FM-Modul an einen C &amp; C-Server gesendet wurde</i> <br><br>  Nach erfolgreicher Registrierung des Opfers auf dem C &amp; C-Server werden zus√§tzliche Informationen in das System geladen, die vom Befehl backdoor interpretiert werden. <br><br><h4>  Funktionalit√§t </h4><br>  <code>RC2FM</code> unterst√ºtzt Befehle zum Auflisten grundlegender Systeminformationen und zum <code>RC2FM</code> einfacher √Ñnderungen am System sowie verschiedene Spyware-Funktionen.  Auf Wunsch der Angreifer kann das Modul das Mikrofon eines kompromittierten Computers aus der Ferne einschalten und Audio aufnehmen.  Der Datensatz wird im MP3-Format mit der legitimen Bibliothek <code>lame.dll</code> , die von Malware heruntergeladen und verwendet wird. <br><br>  Ein weiteres Tool zum Stehlen von Daten sind Screenshots.  Einer der Backdoor-Befehle dient zum Aufnehmen von Screenshots. <br><br>  Ein Schadprogramm √ºberwacht alle internen und externen Festplatten, die auf dem lokalen System angezeigt werden.  Wenn ein neues Laufwerk angeschlossen wird, erstellt es eine Liste mit allen Dateien und speichert sie in verschl√ºsselter Form. <br><br>  Die gesammelten Informationen werden nach dem Senden des entsprechenden Befehls an den Angreifer √ºbertragen. <br><br><h4>  Backdoor-Teams </h4><br>  Im Folgenden finden Sie die IDs und Beschreibungen der unterst√ºtzten Befehle.  Die Visualisierung der Backdoor-Funktion im Interpreter ist in Abbildung 6 dargestellt. <br><br>  0 - Erstellen Sie Listen mit angezeigten Datentr√§gern, Dateien in einem Ordner und Netzwerkfreigaben <br>  2 - Erstellen, Verschieben, Umbenennen, Ausf√ºhren oder L√∂schen einer Datei, L√∂schen eines Verzeichnisses unter Verwendung des angegebenen Pfads <br>  4 - √ñffnen Sie die Datei und setzen Sie den Zeiger auf den Anfang der Datei <br>  5 - Schlie√üen Sie eine zuvor ge√∂ffnete Datei <br>  6 - Schreiben Sie Daten in eine zuvor ge√∂ffnete Datei <br>  7 - √Ñndern Sie die Dateiattribute von time / delete file <br>  8 - √ñffnen Sie die Datei und setzen Sie den Zeiger auf das Ende der Datei <br>  10 - √Ñndern Sie die Dateiattribute von time / delete file <br>  12 - Suchen Sie Dateien anhand der angegebenen Dateimaske im angegebenen Verzeichnis <br>  13 - Machen Sie einen Screenshot <br>  14 - Dateien mithilfe interner Daten hochladen oder √§ndern <br>  15 - Ton mit angeschlossenen Audioger√§ten aufnehmen, Liste der verf√ºgbaren Ger√§te erstellen, Aufzeichnung senden, Konfiguration √§ndern <br>  16 - √úberpr√ºfen Sie das Modul auf offene Dateien <br>  17 - Aktualisieren Sie die Liste der C &amp; C-Server <br>  19 - Erstellen, Installieren, Kopieren, Auflisten oder L√∂schen bestimmter Registrierungsschl√ºssel oder -werte <br><br><img src="https://habrastorage.org/webt/41/kf/7v/41kf7vzsczihmuttbyyjrbtcybe.png"><br>  <i>Abbildung 6. Die Backdoor-Funktion im Interpreter (Original und nach unserer Analyse mit der Funktion Group Nodes in IDA Pro ge√§ndert, um die Lesbarkeit zu gew√§hrleisten)</i> <br><br><h3>  RC2CL-Modul </h3><br>  Das <code>RC2CL</code> Modul ist auch eine Hintert√ºr mit einer Vielzahl von Spionagewerkzeugen.  Es wird von einem DLL-Wrapper gleichzeitig mit dem <code>RC2FM</code> Modul <code>RC2FM</code> .  Dies ist ein komplexeres Modul, dessen Funktionen eher auf die maximale Erfassung von Informationen abzielen als auf √Ñnderungen am System. <br><br>  Interessanterweise hat das <code>RC2CL</code> Modul die M√∂glichkeit, die Backdoor-Funktionalit√§t auszuschalten und als Proxy zu arbeiten.  In diesem Fall f√§hrt die Malware die Windows-Firewall herunter und erstellt einen Server, der die Kommunikation zwischen dem Client und dem C &amp; C-Server oder zwei Clients unterst√ºtzt. <br><br><h4>  Netzwerkkommunikation </h4><br>  Malware kommuniziert mit C &amp; C-Servern √ºber einen TCP-Socket.  Vom Client gesendete Nachrichten werden unter dem HTTP-Protokoll maskiert. Beachten Sie jedoch die ung√ºltige HTTP-Methode "HIDE" im Beispiel in Abbildung 7. <br><br>  Die Anforderungen enthalten die Kennung der gef√§hrdeten Software, die Art der Anforderung und verschl√ºsselte Informationen, die von den Angreifern gesendet werden m√ºssen, dh das Ergebnis der Ausf√ºhrung von Backdoor-Befehlen oder einer Anforderung neuer Anweisungen. <br><br><img src="https://habrastorage.org/webt/jf/og/gu/jfoggu3qvtsjumjvxt6etxex9mw.png"><br>  <i>Abbildung 7. Ein Beispiel f√ºr eine Anforderung, die vom RC2CL-Modul an den Befehlsserver gesendet wurde</i> <br><br><h4>  Funktionalit√§t </h4><br>  Abh√§ngig vom empfangenen Befehl kann die Hintert√ºr verschiedene Vorg√§nge auf dem infizierten System ausf√ºhren.  Regelm√§√üige Backdoors f√ºhren Manipulationen mit dem Dateisystem und den Registrierungsschl√ºsseln durch, unterst√ºtzen die Dateiausf√ºhrung und die Remote-Shell-Aktivierung.  Dieser Spivar unterst√ºtzt all diese Teams und noch mehr - 84 Teams erm√∂glichen es Angreifern, umfassende Informationen √ºber das Opfer zu sammeln. <br><br>  Ein Schadprogramm scannt einen infizierten Computer und √ºbertr√§gt verschiedene Daten an Angreifer: Systeminformationen (Liste der aktiven Prozesse, laufenden Dienste, geladenen Treiber oder verf√ºgbaren Festplatten), Netzwerkinformationen (IP-Adresstabelle, Geschwindigkeit der Internetverbindung). <br><br>  InvisiMole kann verf√ºgbare drahtlose Netzwerke auf einem gef√§hrdeten System scannen.  Spivar zeichnet Informationen wie SSID- und MAC-Adressen erkannter Wi-Fi-Zugangspunkte auf.  Diese Daten k√∂nnen dann mit √∂ffentlichen Datenbanken √ºberpr√ºft werden, sodass Angreifer die Geolokalisierung des Opfers verfolgen k√∂nnen. <br><br>  Andere Befehle enthalten Informationen zu Benutzern des gef√§hrdeten Computers, ihren Konten und fr√ºheren Sitzungen. <br><br>  Von besonderem Interesse ist die auf einem kompromittierten Computer installierte Software.  Welche Programme sind im System installiert?  Welche von ihnen starten automatisch beim Systemstart oder bei der Benutzeranmeldung?  Welche Programme verwendet ein bestimmter Benutzer?  Wenn die Angreifer an etwas interessiert sind, geben Sie einfach einen Befehl ein, um die erforderlichen Daten abzurufen. <br><br>  Malware kann einen Befehl zum Suchen nach k√ºrzlich ge√∂ffneten Dokumenten und anderen interessanten Dateien erhalten.  Es kann bestimmte Verzeichnisse und externe Ger√§te anzeigen, √Ñnderungen melden und von Angreifern ausgew√§hlte Dateien extrahieren. <br><br>  Malware kann das Account Management System (UAC) aktivieren oder deaktivieren oder es umgehen und mit Dateien in gesch√ºtzten Verzeichnissen ohne Administratorrechte arbeiten (mehr unter dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link</a> ).  Wenn die Malware unter dem Prozess <code>explorer.exe</code> , der automatisch erh√∂hte Rechte erh√§lt, kann sie ein COM-Objekt erstellen und damit Dateien in Bereichen l√∂schen und verschieben, f√ºr die Administratorrechte erforderlich sind. <br><br>  Dar√ºber hinaus kann InvisiMole die Webcam und das Mikrofon des Opfers aus der Ferne einschalten, indem Sie Bilder aufnehmen oder Ton aufnehmen.  Angreifer k√∂nnen die Aktivit√§t auf dem Ger√§t √ºberwachen, indem sie Screenshots machen.  Was besonders interessant ist, InvisiMole erm√∂glicht es Ihnen, Screenshots nicht nur des gesamten Bildschirms, sondern auch jedes ge√∂ffneten Fensters zu machen.  Auf diese Weise k√∂nnen Angreifer Informationen sammeln, auch wenn sich die Fenster gegenseitig schlie√üen. <br><br>  Mit einem der Backdoor-Befehle k√∂nnen Sie den Inhalt von Treibern durch die folgenden Namen ersetzen: <br><br> <code>blbdrive.sys <br> compbatt.sys <br> secdrv.sys</code> <br> <br>  Wir haben die Verwendung dieses Befehls durch Angreifer nicht beobachtet, k√∂nnen jedoch davon ausgehen, dass er verwendet wird, um zus√§tzliche Persistenz auf 32-Bit-Systemen bereitzustellen. <br><br>  Die Hintert√ºr kann das System st√∂ren (z. B. sich als Benutzer anmelden, den Vorgang abschlie√üen oder das System ausschalten), bietet jedoch haupts√§chlich passive Vorg√§nge.  Das Programm versucht, seine Aktivit√§t nach M√∂glichkeit zu verbergen. <br><br>  Spivar erkundet also interessante Stellen im System, untersucht k√ºrzlich ge√∂ffnete Dokumente oder √§ndert einige Dateien.  Diese Aktionen hinterlassen Spuren und k√∂nnen den Verdacht des Opfers hervorrufen, da sich nach jedem solchen Vorgang der Zeitpunkt der letzten √Ñnderung der Datei und / oder der Zugriff darauf √§ndert.  Um eine Erkennung zu verhindern, stellt die Malware das Datum der vorherigen √Ñnderung oder des √ñffnens der Datei wieder her, um ihre Manipulationen vor dem Benutzer zu verbergen. <br><br>  Ein weiteres Beispiel daf√ºr, wie Spayvari-Autoren versuchen, eine Erkennung zu vermeiden, ist die Arbeit mit Spuren, die auf der Festplatte verbleiben.  Ein Schadprogramm sammelt eine gro√üe Menge vertraulicher Daten, die einige Zeit in Dateien gespeichert und nach einem erfolgreichen Upload auf C &amp; C-Server gel√∂scht werden.  Das Problem besteht darin, dass ein erfahrener Systemadministrator gel√∂schte Dateien wiederherstellen kann. Dies hilft bei der Untersuchung des Angriffs, nachdem das Opfer von dem Kompromiss erfahren hat.  Dies ist m√∂glich, da einige Informationen auch nach dem L√∂schen der Datei auf der Festplatte verbleiben.  Um dies zu verhindern, kann InvisiMole alle Dateien sicher l√∂schen.  Dies bedeutet, dass zuerst die Daten mit Null oder zuf√§lligen Bytes √ºberschrieben werden und erst danach die Datei gel√∂scht wird. <br><br><h4>  Eingebauter Speicher </h4><br>  Die Backdoor-Konfiguration und die gesammelten Daten werden an zwei Adressen gespeichert - dies ist das Arbeitsverzeichnis und die Registrierungsschl√ºssel.  Ein wesentlicher Teil der Backdoor-Befehle dient zur Manipulation dieser Datenspeicherorte und ihrer Inhalte. <br><br>  Der Speicherort des Arbeitsverzeichnisses wird mithilfe von Befehlen von einem Remote-Server bestimmt.  Das Verzeichnis wird als tempor√§rer Speicher f√ºr Dateien verwendet, die Informationen enthalten, die von einem gef√§hrdeten Computer gesammelt wurden.  Diese Dateien haben eine gemeinsame Benennungsmethode, einen gemeinsamen Verschl√ºsselungsalgorithmus und eine gemeinsame Struktur.  Sie werden mit einer einfachen Version der XOR-Verschl√ºsselung verschl√ºsselt, die in den Komponenten von malvari verwendet wird.  Der Dateityp kann aus der 4-Byte-Steuersequenz am Anfang der Datei abgerufen werden. <br><br>  Zus√§tzlich zum Speichern der gesammelten Daten wird das Verzeichnis als Basisverzeichnis f√ºr eine Kopie der legitimen WinRAR.exe-Anwendung verwendet.  Malvar kopiert es und verwendet es, um gestohlene Daten zu archivieren. <br><br>  Die Registrierung speichert Konfigurationsdaten sowie eine Liste der Dateien im Arbeitsverzeichnis.  Die Daten werden mit der in der Bin√§rdatei malvari implementierten Zlib-Prozedur gepackt und mit derselben Verschl√ºsselung wie die internen Dateien verschl√ºsselt. <br><br><img src="https://habrastorage.org/webt/ih/al/gw/ihalgw7xzb35fahkfx9rcmr3_l0.png"><br><br><h4>  Backdoor-Teams </h4><br>  Mehr als achtzig Backdoor-Befehle verwenden das Arbeitsverzeichnis und die Registrierungsschl√ºssel, um Zwischenergebnisse und Konfigurationsdaten zu speichern.  Das Diagramm mit der Hintert√ºr im Interpreter ist in Abbildung 8 dargestellt. <br><br>  Etwa ein Drittel aller Befehle bezieht sich auf das Lesen und Aktualisieren der in der Registrierung gespeicherten Konfigurationsdaten.  Die IDs und Beschreibungen der verbleibenden Befehle sind unten aufgef√ºhrt. <br><br>  4 - Erstellen Sie eine Liste mit Dateiinformationen im Verzeichnis <br>  6 - Datei herunterladen <br>  20 - Aktive Prozesse auflisten <br>  22 - Beenden Sie den Vorgang anhand der ID <br>  24 - Datei ausf√ºhren <br>  26 - Datei l√∂schen <br>  28 - IP-Weiterleitungstabelle abrufen <br>  30 - Daten in eine Datei schreiben <br>  31 - Unt√§tigkeit <br>  38 - Erstellen Sie eine Liste der Konten <br>  40 - Erstellen Sie eine Liste der Dienste im System <br>  42 - Erstellen Sie eine Liste der geladenen Treiber <br>  43 - Sammeln grundlegender Systeminformationen (Computername, Betriebssystemversion, Speicherstatus, Ortszeit, Festplatteninformationen, Informationen zu konfigurierten Proxys, aktuelle Richtlinie zur Verhinderung der Datenausf√ºhrung f√ºr das System und die Prozesse usw.) <br>  44 - Erstellen Sie eine Liste der installierten Software <br>  46 - Lokale Benutzer und Sitzungsinformationen auflisten <br>  48 - Erstellen Sie eine Liste der von Benutzern verwendeten Anwendungen <br>  52 - Verzeichnisstruktur erstellen <br>  78 - Remote-Shell erstellen <br>  81 - F√ºhren Sie den Befehl √ºber die Remote-Shell aus <br>  91 - Benutzerkontensteuerung aktivieren / deaktivieren <br>  93 - Endbenutzersitzung / Herunterfahren / Neustarten des Systems <br>  101 - Verfolgen und Aufzeichnen von √Ñnderungen an angegebenen Verzeichnissen <br>  103 - Verzeichnis l√∂schen <br>  109 - Monitor ein- / ausschalten / Standby aktivieren <br>  120 - Machen Sie einen Screenshot der Anzeige / aktiven Fenster <br>  126 - Machen Sie einen Screenshot der Anzeige / aktiven Fenster und aktualisieren Sie die Konfigurationsdaten <br>  130 - Liste der Ressourceninformationen auf nicht zugewiesenen Datentr√§gern <br>  132 - Benennen / Verschieben der Datei, √Ñndern der Erstellungs- / √ñffnungs- / Schreibzeit der Datei auf die angegebene Zeit <br>  134 - Liste der zuletzt ge√∂ffneten Dateien <br>  152 - Trennen Sie (zuvor angeschlossene) Wechseldatentr√§ger <br>  155 - Registrierungsschl√ºssel erstellen / l√∂schen, Registrierungsschl√ºsselwerte festlegen / l√∂schen oder Registrierungswerte / -schl√ºssel / -daten auflisten <br>  159, 161 - Deaktivieren Sie Routing / Firewall und erstellen Sie einen Proxyserver an einem bestimmten Port <br>  172 - Wiederholen Sie das Dialogfeld, in dem Sie aufgefordert werden, den Computer neu zu starten <br>  175 - Benutzerkontosteuerung f√ºr Dateimanipulation umgehen <br>  177 - Erstellen und Schreiben einer Datei, Festlegen der Daten zum Zeitpunkt der Erstellung / √ñffnung / √Ñnderung <br>  181 - Entfernen Sie alle Systemwiederherstellungspunkte <br>  183 - Zur√ºcksetzen (legitime) Komponente einer WinRAR-Anwendung <br>  185 - Dateien zum passwortgesch√ºtzten Archiv hinzuf√ºgen (password = "12KsNh92Dwd") <br>  187 - Entschl√ºsseln, entpacken und laden Sie die DLL, laden Sie exe-Dateien aus RC2CL- und RC2FM-Ressourcen <br>  189 - Erstellen Sie einen Systemwiederherstellungspunkt <br>  191 - Passwortgesch√ºtztes Archiv extrahieren (12KsNh92Dwd) <br>  193 - √Ñndern Sie die verschl√ºsselte Datei <br>  195 - Nach Abschluss des Hauptprozesses neu starten <br>  197 - Senden Sie 198 Bytes fest codierter Daten in einem Muster <br>  199 - Datei umbenennen / verschieben <br>  206 - Entschl√ºsseln, entpacken und herunterladen Sie die DLL, laden Sie exe-Dateien aus RC2CL- und RC2FM-Ressourcen <br>  211 - Laden Sie die gesammelten Informationen herunter (Screenshots, Audioaufnahmen usw.) <br>  213 - Erstellen Sie eine Liste der aktiven Fenster <br>  218 - API zum Aufzeichnen von Audio von Eingabeger√§ten <br>  220 - API zum Aufnehmen von Fotos von einer Webcam <br>  224 - Erstellen Sie eine Liste der Dateien, die bei jedem Systemstart ausgef√ºhrt werden <br>  226 - Erstellen Sie eine Liste der aktivierten drahtlosen Netzwerke (MAC-Adresse, SSID, Signalisierungsintervall). <br>  228 - Komprimiertes Zlib-Paket zur√ºcksetzen <br><br><img src="https://habrastorage.org/webt/jf/og/gu/jfoggu3qvtsjumjvxt6etxex9mw.png"><br>  <i>Abbildung 8. Die Backdoor-Funktion im Interpreter (Original und ge√§ndert mit der Funktion Group Nodes in IDA Pro zur besseren Lesbarkeit)</i> <br><br><h2>  Fazit </h2><br>  InvisiMole ist eine Spyware-Software mit vollem Funktionsumfang, die umfangreiche Funktionen bietet, die mit anderen bekannten Cyberspionage-Tools konkurrieren k√∂nnen. <br><br>  Man kann nur raten, warum die Autoren zwei Module mit doppelten Funktionen verwenden.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist davon auszugehen, dass das kleinere Modul </font></font><code>RC2FM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in der ersten Aufkl√§rungsphase verwendet wird und das gr√∂√üere </font></font><code>RC2CL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nur auf Maschinen l√§uft, die den Bediener interessieren. </font><font style="vertical-align: inherit;">Dies ist jedoch nicht der Fall - zwei Module werden gleichzeitig gestartet. </font><font style="vertical-align: inherit;">Die zweite m√∂gliche Erkl√§rung: Die Module werden von verschiedenen Autoren zusammengestellt und dann kombiniert, um den Bedienern ein Maximum an Werkzeugen zur Verf√ºgung zu stellen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InvisiMole verwendet nur wenige Techniken, um Erkennung und Analyse zu vermeiden. </font><font style="vertical-align: inherit;">Da Spyware jedoch bei Angriffen auf eine kleine Anzahl hochrangiger Ziele eingesetzt wurde, gelang es ihr, die Erkennung f√ºr mindestens f√ºnf Jahre zu vermeiden.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kompromissindikatoren (IoCs) </font></font></h2><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ESET-Erkennung </font></font></h3><br> <code>Win32/InvisiMole.A trojan <br> Win32/InvisiMole.B trojan <br> Win32/InvisiMole.C trojan <br> Win32/InvisiMole.D trojan <br> Win64/InvisiMole.B trojan <br> Win64/InvisiMole.C trojan <br> Win64/InvisiMole.D trojan</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1-Hashes </font></font></h3><br> <code>5EE6E0410052029EAFA10D1669AE3AA04B508BF9 <br> 2FCC87AB226F4A1CC713B13A12421468C82CD586 <br> B6BA65A48FFEB800C29822265190B8EAEA3935B1 <br> C8C4B6BCB4B583BA69663EC3AED8E1E01F310F9F <br> A5A20BC333F22FD89C34A532680173CBCD287FF8</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C &amp; C Server Domain Namen </font></font></h3><br> <code>activationstate.sytes[.]net <br> advstatecheck.sytes[.]net <br> akamai.sytes[.]net <br> statbfnl.sytes[.]net <br> updchecking.sytes[.]net</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IP-Adressen von C &amp; C-Servern und Aktivit√§tszeitraum </font></font></h3><br> <code>2013-2014 - 46.165.231.85 <br> 2013-2014 - 213.239.220.41 <br> 2014-2017 - 46.165.241.129 <br> 2014-2016 - 46.165.241.153 <br> 2014-2018 - 78.46.35.74 <br> 2016-2016 - 95.215.111.109 <br> 2016-2018 - 185.118.66.163 <br> 2017-2017 - 185.118.67.233 <br> 2017-2018 - 185.156.173.92 <br> 2018-2018 - 46.165.230.241 <br> 2018-2018 - 194.187.249.157</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Registrierungsschl√ºssel und -werte </font></font></h3><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RC2FM </font></font></h4><br> <code>[HKEY_CURRENT_USER\Software\Microsoft\IE\Cache] <br> "Index"</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RC2CL </font></font></h4><br> <code>[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Console] <br> or [HKEY_CURRENT_USER\Software\Microsoft\Direct3D] <br> "Settings" <br> "Type" <br> [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\OLE] <br> or [HKEY_CURRENT_USER\Software\Microsoft\Direct3D] <br> "Common" <br> "Current" <br> "ENC" <br> "FFLT" <br> "Flag1" <br> "FlagLF" <br> "FlagLF2" <br> "IfData" <br> "INFO" <br> "InstallA" <br> "InstallB" <br> "LegacyImpersonationNumber" <br> "LM" <br> "MachineAccessStateData" <br> "MachineState 0" <br> "RPT" <br> "SP2" <br> "SP3" <br> "SettingsMC" <br> "SettingsSR1" <br> "SettingsSR2"</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dateien und Ordner </font></font></h3><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RC2FM </font></font></h4><br> <code>%APPDATA%\Microsoft\Internet Explorer\Cache\AMB6HER8\ <br> %volumeSerialNumber%.dat <br> content.dat <br> cache.dat <br> index.dat <br> %APPDATA%\Microsoft\Internet Explorer\Cache\MX0ROSB1\ <br> content.dat <br> index.dat <br> %random%.%ext% <br> %APPDATA%\Microsoft\Internet Explorer\Cache\index0.dat</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RC2CL </font></font></h4><br> <code>Winrar\ <br> comment.txt <br> descript.ion <br> Default.SFX <br> WinRAR.exe <br> main.ico <br> fl_%timestamp%\strcn%num%\ <br> fdata.dat <br> index.dat <br> ~mrc_%random%.tmp <br> ~src_%random%.tmp <br> ~wbc_%random%.tmp <br> sc\~sc%random%.tmp <br> ~zlp\zdf_%random%.data <br> ~lcf\tfl_%random%</code> </div> </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de414419/">https://habr.com/ru/post/de414419/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de414405/index.html">Installieren Sie das Zertifikat auf dem Apache HTTP-Server</a></li>
<li><a href="../de414411/index.html">Wiren Board 6: wieder auf Habr√© mit der neuen Version der Steuerung f√ºr die Automatisierung</a></li>
<li><a href="../de414413/index.html">Zusammenfassung und Video der Geschichte √ºber das Networking in der Spielebranche mit dem Gamedev des Festivals</a></li>
<li><a href="../de414415/index.html">Tarantool-Konferenz 21. Juni - nicht nur √ºber Tarantool, sondern allgemein √ºber In-Memory-Computing</a></li>
<li><a href="../de414417/index.html">Digitale Veranstaltungen in Moskau vom 18. bis 24. Juni</a></li>
<li><a href="../de414423/index.html">An diesem Tag haben wir so nah wie m√∂glich gebracht ... Eine neue Version von SBM 11.4 wurde ver√∂ffentlicht</a></li>
<li><a href="../de414425/index.html">Algorithmus zur Erkennung von One-Shot-Lernmustern</a></li>
<li><a href="../de414427/index.html">Was kann ein 3D-Drucker? Bericht aus der Ausstellung Maker Faire Bay Area 2018</a></li>
<li><a href="../de414429/index.html">Wie man eine Fremdsprache ohne Lehrer lernt. Teil 1. "Meine Erfahrung"</a></li>
<li><a href="../de414431/index.html">Mitap JavaJam. Javista Debatte, Log Rafting, Experimente und Microservices</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>