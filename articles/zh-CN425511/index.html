<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>âœ‰ï¸ ğŸ“¿ ğŸ›ƒ Rotativaåº”ç”¨ç¨‹åºçš„éæ˜¾è€Œæ˜“è§çš„åŠŸèƒ½ï¼Œç”¨äºåœ¨ASP.NET MVCåº”ç”¨ç¨‹åºä¸­ç”ŸæˆPDF ğŸ•´ğŸ¿ ğŸ›ŒğŸ½ ğŸŒ€</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="è®¸å¤šå¼€å‘äººå‘˜é¢ä¸´ç€ä¸ºWebåº”ç”¨ç¨‹åºåˆ›å»ºPDFæŠ¥å‘Šçš„ä»»åŠ¡ï¼Œè¿™æ˜¯å®Œå…¨è‡ªç„¶çš„è¦æ±‚ã€‚ åœ¨ä½¿ç”¨Rotativaåº“ç”ŸæˆæŠ¥å‘Šæ—¶ï¼Œæˆ‘æƒ³æé†’æ‚¨æˆ‘å¯¹æ­¤ç±»ä»»åŠ¡çš„ç»éªŒã€‚ åœ¨æˆ‘çœ‹æ¥ï¼Œè¿™æ˜¯ä¸ºæ­¤ç›®çš„è€Œè®¾è®¡çš„æœ€æ–¹ä¾¿çš„åº“ä¹‹ä¸€ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨å®ƒæ—¶ï¼Œæˆ‘é‡åˆ°äº†å‡ ä¸ªæˆ‘æƒ³è°ˆçš„ä¸æ˜æ˜¾çš„åœ°æ–¹ã€‚ 


 è€å®è¯´ï¼Œæˆ‘æƒ³åˆ†äº«åœ¨é›†æˆè¯¥åº“çš„è¿‡ç¨‹ä¸­è¸©åˆ°çš„æ‰€æœ‰è€™å­...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rotativaåº”ç”¨ç¨‹åºçš„éæ˜¾è€Œæ˜“è§çš„åŠŸèƒ½ï¼Œç”¨äºåœ¨ASP.NET MVCåº”ç”¨ç¨‹åºä¸­ç”ŸæˆPDF</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425511/"><p> è®¸å¤šå¼€å‘äººå‘˜é¢ä¸´ç€ä¸ºWebåº”ç”¨ç¨‹åºåˆ›å»ºPDFæŠ¥å‘Šçš„ä»»åŠ¡ï¼Œè¿™æ˜¯å®Œå…¨è‡ªç„¶çš„è¦æ±‚ã€‚ åœ¨ä½¿ç”¨Rotativaåº“ç”ŸæˆæŠ¥å‘Šæ—¶ï¼Œæˆ‘æƒ³æé†’æ‚¨æˆ‘å¯¹æ­¤ç±»ä»»åŠ¡çš„ç»éªŒã€‚ åœ¨æˆ‘çœ‹æ¥ï¼Œè¿™æ˜¯ä¸ºæ­¤ç›®çš„è€Œè®¾è®¡çš„æœ€æ–¹ä¾¿çš„åº“ä¹‹ä¸€ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨å®ƒæ—¶ï¼Œæˆ‘é‡åˆ°äº†å‡ ä¸ªæˆ‘æƒ³è°ˆçš„ä¸æ˜æ˜¾çš„åœ°æ–¹ã€‚ </p><a name="habracut"></a><br><p> è€å®è¯´ï¼Œæˆ‘æƒ³åˆ†äº«åœ¨é›†æˆè¯¥åº“çš„è¿‡ç¨‹ä¸­è¸©åˆ°çš„æ‰€æœ‰è€™å­ï¼Œè¿™æ— ç–‘æ˜¯éå¸¸å¿«é€Ÿä¸”éå¸¸æ–¹ä¾¿çš„ã€‚ </p><br><p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä¸ä¼šè§£å†³é€‰æ‹©åº“çš„é—®é¢˜ã€‚ æ¯ä¸ªäººéƒ½æœ‰å…¶ä½¿ç”¨è¯¥ä¸»é¢˜çš„ç†ç”±ã€‚ æˆ‘é€‰æ‹©Rotativaï¼Œæ˜¯å› ä¸ºä»¥æœ€ä½çš„è®¾ç½®æˆæœ¬ï¼Œå®ƒå¯ä»¥æ»¡è¶³å®¢æˆ·çš„éœ€æ±‚ã€‚ é™¤äº†å¥¹ï¼Œæˆ‘è¿˜å°è¯•äº†ä¸‰åˆ°å››ä¸ªé€‰é¡¹ã€‚ </p><br><h3 id="postanovka-zadachi"> é—®é¢˜é™ˆè¿° </h3><br><p>  ASP.NET MVCï¼Œ.NETç‰ˆæœ¬4.6ä¸Šçš„Webåº”ç”¨ç¨‹åºã€‚ é™¤éƒ¨ç½²å¤–ï¼Œå…¶ä»–åŠŸèƒ½åœ¨æ­¤æƒ…å†µä¸‹å‡ä¸ç›¸å…³ã€‚ é¢„è®¡å°†åœ¨Azureä¸Šè¿›è¡Œéƒ¨ç½²ã€‚ è¿™å¾ˆé‡è¦ï¼Œå› ä¸ºæŸäº›å…¶ä»–åº“ï¼ˆä¾‹å¦‚HiQPdfï¼‰ä¸ä¼šåœ¨æŸäº›Azureé…ç½®ä¸­è½¬ç§»å®‰è£…ï¼Œå·²åœ¨æ–‡æ¡£ä¸­è®°å½•ã€‚ </p><br><p> æˆ‘éœ€è¦é€šè¿‡ä¸€ä¸ªé“¾æ¥æ‰“å¼€æŸä¸ªé™æ€HTMLæŠ¥å‘Šï¼Œå¹¶é€šè¿‡ç¬¬äºŒä¸ªé“¾æ¥æ‰“å¼€åŒä¸€æŠ¥å‘Šçš„PDFç‰ˆæœ¬ã€‚ æŠ¥å‘Šæœ¬èº«åªæ˜¯ä¸€ç»„è¡¨ï¼Œå­—æ®µå’Œå›¾å½¢çš„é›†åˆï¼Œä»¥å‘ç”¨æˆ·æ¼”ç¤ºã€‚ è¿™ä¸¤ä¸ªç‰ˆæœ¬éƒ½éœ€è¦ä¸€ä¸ªèœå•â€‹â€‹ï¼Œè¯¥èœå•å¯å¯¼èˆªæŠ¥è¡¨çš„å„ä¸ªéƒ¨åˆ†ï¼Œè¡¨çš„å­˜åœ¨ï¼ŒæŸäº›å›¾å½¢ï¼ˆé¢œè‰²ï¼Œæ–‡æœ¬å¤§å°ï¼Œè¾¹æ¡†ï¼‰ã€‚ </p><br><h3 id="primenenie-biblioteki-rotativa"> ä½¿ç”¨Rotativaåº“ </h3><br><p> æˆ‘è®¤ä¸ºRotativaå°½å¯èƒ½æ˜“äºåº”ç”¨ã€‚ </p><br><ol><li> æ‚¨å·²ç»æœ‰ä¸€ä¸ªç°æˆçš„HTMLæŠ¥å‘Šï¼Œå½¢å¼ä¸ºASP.NET MVCæ¨¡æ¿å’Œæ§åˆ¶å™¨ï¼Œä¾‹å¦‚ï¼š </li></ol><br><pre><code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">HttpGet</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;ActionResult&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Index</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> param1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> param2</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> model = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> service.GetReportDataAsync(param1, param2); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> View(model); }</code> </pre> <br><ol><li><p> å®‰è£…nuget Rotativaè½¯ä»¶åŒ… </p><br></li><li><p> ä¸ºPDFæŠ¥å‘Šæ·»åŠ æ–°çš„æ§åˆ¶å™¨ </p><br></li></ol><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">HttpGet</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;ActionResult&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Pdf</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> param1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> param2</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> model = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> service.GetReportDataAsync(param1, param2); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ViewAsPdf(<span class="hljs-string"><span class="hljs-string">"Index"</span></span>, model); }</code> </pre> <br><p> ä»ç°åœ¨å¼€å§‹ï¼Œä»æœ¬è´¨ä¸Šè®²ï¼Œæ‚¨å°†PDFä½œä¸ºæ–‡ä»¶è¿”å›ï¼Œå…¶ä¸­åŒ…å«åŸå§‹HTMLæŠ¥å‘Šä¸­çš„æ‰€æœ‰æ•°æ®ã€‚ </p><br><p>  <em>æˆ‘åœ¨è¿™é‡Œæ²¡æœ‰æè¿°è·¯ç”±ï¼Œä½†æ˜¯å¯ä»¥ç†è§£ï¼Œæ‚¨å·²ç»é…ç½®äº†è·¯ç”±ä»¥æ­£ç¡®è°ƒç”¨ä¸¤ä¸ªæ§åˆ¶å™¨</em> </p><br><p> æœ‰è¶£çš„æ˜¯ï¼Œè¯¥åº“æœ¬èº«å®è´¨ä¸Šæ˜¯è‘—åçš„æ§åˆ¶å°å®ç”¨ç¨‹åº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">wkhtmltopdfçš„åŒ…è£…</a> ã€‚ æ‚¨å¯ä»¥æ‰“èµŒï¼ŒAzureå¯ä»¥åœ¨é«˜ç©ºå·¥ä½œçš„é€Ÿåº¦-ä¼šèµ·ä½œç”¨ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬å°†è®¨è®ºä¸€äº›åŠŸèƒ½ã€‚ </p><br><h3 id="page-number"> é¡µç  </h3><br><p> é€»è¾‘ä¸Šå‡è®¾å®¢æˆ·å°†æ‰“å°PDFå¹¶å¸Œæœ›æŸ¥çœ‹é¡µç ã€‚ æ„Ÿè°¢Rotativaçš„åˆ›å»ºè€…ï¼Œè¿™é‡Œçš„ä¸€åˆ‡éƒ½éå¸¸ç®€å•ã€‚ </p><br><p> æ ¹æ®Rotativaæ–‡æ¡£ï¼Œé€šè¿‡<code>CustomSwitches</code>å‚æ•°ï¼Œ <code>CustomSwitches</code>å¯ä»¥æŒ‡å®šå°†ä¼ é€’ç»™<code>wkhtmltopdf</code>å®ç”¨ç¨‹åº<code>wkhtmltopdf</code> ã€‚ å—¯ï¼Œåœ¨çº¿æŠ€å·§æœ‰å¾ˆå¤šä¾‹å­ã€‚ ä»¥ä¸‹è°ƒç”¨åœ¨æ¯ä¸ªé¡µé¢çš„åº•éƒ¨æ·»åŠ ä¸€ä¸ªæ•°å­—ï¼š </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ViewAsPdf(<span class="hljs-string"><span class="hljs-string">"Index"</span></span>, model) { PageMargins = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Rotativa.Options.Margins(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>), PageSize = Rotativa.Options.Size.A4, PageOrientation = Rotativa.Options.Orientation.Portrait, CustomSwitches = <span class="hljs-string"><span class="hljs-string">"--page-offset 0 --footer-center [page] --footer-font-size 8 };</span></span></code> </pre> <br><p> æ•ˆæœå¾ˆå¥½ã€‚ é¡µç æœ¬èº«æ˜¯ä½¿ç”¨<code>[page]</code>å‚æ•°ä¼ é€’çš„ï¼Œæ­¤ç±»å‚æ•°å°†æ›¿æ¢ä¸ºç‰¹å®šçš„å€¼ã€‚ </p><br><blockquote> é™¤äº†<code>[page]</code>è¿˜æœ‰å…¶ä»–ï¼š <br><ul><li>  [é¡µé¢]æ›¿æ¢ä¸ºå½“å‰æ­£åœ¨æ‰“å°çš„é¡µé¢æ•° </li><li>  [frompage]æ›¿æ¢ä¸ºè¦æ‰“å°çš„ç¬¬ä¸€é¡µçš„ç¼–å· </li><li>  [topage]æ›¿æ¢ä¸ºè¦æ‰“å°çš„æœ€åä¸€é¡µçš„ç¼–å· </li><li>  [ç½‘é¡µ]æ›¿æ¢ä¸ºè¦æ‰“å°çš„é¡µé¢çš„URL </li><li>  [section]æ›¿æ¢ä¸ºå½“å‰éƒ¨åˆ†çš„åç§° </li><li>  [å°èŠ‚]æ›¿æ¢ä¸ºå½“å‰å°èŠ‚çš„åç§° </li><li>  [date]ä»¥ç³»ç»Ÿæœ¬åœ°æ ¼å¼æ›¿æ¢ä¸ºå½“å‰æ—¥æœŸ </li><li>  [isodate]æ›¿æ¢ä¸ºISO 8601æ‰©å±•æ ¼å¼çš„å½“å‰æ—¥æœŸ </li><li>  [time]ä»¥ç³»ç»Ÿæœ¬åœ°æ ¼å¼æ›¿æ¢ä¸ºå½“å‰æ—¶é—´ </li><li>  [title]æ›¿æ¢ä¸ºå½“å‰é¡µé¢å¯¹è±¡çš„æ ‡é¢˜ </li><li>  [doctitle]æ›¿æ¢ä¸ºè¾“å‡ºæ–‡æ¡£çš„æ ‡é¢˜ </li><li>  [sitepage]æ›¿æ¢ä¸ºè¦è½¬æ¢çš„å½“å‰ç«™ç‚¹ä¸­çš„é¡µé¢æ•° </li><li>  [sitepages]æ›¿æ¢ä¸ºå½“å‰ç½‘ç«™ä¸­æ­£åœ¨è½¬æ¢çš„é¡µé¢æ•° </li></ul><br></blockquote><br><h3 id="table-of-content"> ç›®å½•è¡¨ </h3><br><p> å¤§å‹å¤šé¡µæŠ¥å‘Šéœ€è¦PDFå†…å®¹å’Œé¡µé¢å¯¼èˆªã€‚ å½“æŠ¥è¡¨ä¸­çš„é¡µé¢æ•°è¶…è¿‡ä¸€ç™¾æ—¶ï¼Œè¿™éå¸¸æ–¹ä¾¿ï¼Œå¹¶ä¸”è‡³å…³é‡è¦ã€‚ </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">wkhtmltopdfæ‰‹å†Œ</a>åŒ…å«æ‰€æœ‰é€‰é¡¹çš„å®Œæ•´åˆ—è¡¨ï¼Œå…¶ä¸­åŒ…æ‹¬<code>--toc</code> ã€‚ çœ‹åˆ°æ­¤å‚æ•°ï¼Œè¯¥å®ç”¨ç¨‹åºå®è´¨ä¸Šå°†æ”¶é›†æ–‡æ¡£ä¸­çš„æ‰€æœ‰æ ‡ç­¾<code>&lt;h1&gt;, &lt;h2&gt;, ... &lt;h6&gt;</code> ï¼Œå¹¶åŸºäºè¿™äº›æ ‡ç­¾ç”Ÿæˆç›®å½•ã€‚ å› æ­¤ï¼Œæœ‰å¿…è¦åœ¨HTMLæ¨¡æ¿ä¸­æ­£ç¡®ä½¿ç”¨è¿™äº›æ ‡é¢˜æ ‡ç­¾ã€‚ </p><br><p> ä½†å®é™…ä¸Šï¼Œæ·»åŠ <code>--toc</code>ä¸ä¼šå¯¼è‡´ä»»ä½•åæœã€‚ å¥½åƒæ²¡æœ‰å‚æ•°ã€‚ ä½†æ˜¯ï¼Œå…¶ä»–é€‰é¡¹ä¹Ÿå¯ä»¥ã€‚ æ„Ÿè°¢åœ¨æŸä¸ªè®ºå›ä¸Šçš„å¸–å­ï¼Œæˆ‘å‘ç°æ­¤å‚æ•°åº”è¯¥åœ¨ä¸å¸¦è¿å­—ç¬¦çš„æƒ…å†µä¸‹ä¼ é€’ï¼š <code>toc</code> ã€‚ å®é™…ä¸Šï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå†…å®¹è¢«æ·»åŠ ä¸ºç¬¬ä¸€é¡µã€‚ å½“æ‚¨å•å‡»å†…å®¹ä¸­çš„ä¸€è¡Œæ—¶ï¼Œæ‚¨å°†è½¬åˆ°æ–‡æ¡£ä¸­æ‰€éœ€çš„é¡µé¢ï¼Œé¡µç æ­£ç¡®ã€‚ </p><br><p> ç›®å‰å°šä¸æ¸…æ¥šå¦‚ä½•è‡ªå®šä¹‰æ ·å¼ï¼Œä½†æ˜¯æˆ‘è¿˜æ²¡æœ‰åšåˆ°è¿™ä¸€ç‚¹ã€‚ </p><br><h3 id="javascript-execution">  JavaScriptæ‰§è¡Œ </h3><br><p> æˆ‘é‡åˆ°çš„ä¸‹ä¸€ç‚¹æ˜¯éœ€è¦åœ¨æŠ¥å‘Šä¸­æ·»åŠ å›¾å½¢ã€‚ æˆ‘çš„HTMLé¡µé¢åŒ…å«JSä»£ç ï¼Œè¯¥ä»£ç ä½¿ç”¨<code>dc.js</code>åº“æ·»åŠ äº†å›¾å½¢ã€‚ è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼š </p><br><pre> <code class="hljs matlab"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initChart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">renderChart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Html.Raw(Json.Encode(Model.Chart_1_Data)</span></span></span><span class="hljs-function">), '</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chartDiv_1</span></span></span><span class="hljs-function">'); } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">renderChart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, chartElementId)</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">var</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">colors</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">['#03a9f4', '#67daff', '#8bc34a']</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">var</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">barHeight</span></span></span><span class="hljs-function"> = 45; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">var</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clientHeight</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">data</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">length</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">barHeight</span></span></span><span class="hljs-function"> + 50; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">var</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clientWidth</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">document</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getElementById</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(chartId)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offsetWidth</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">var</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chart</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dc</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rowChart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">('#' + chartElementId)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">var</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ndx</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">crossfilter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dataToRender)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">var</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dimension</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ndx</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dimension</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(d =&gt; d.name)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">var</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">group</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dimension</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">group</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reduceSum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(d =&gt; d.value)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chart</span></span></span><span class="hljs-function"> .</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">width</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(clientWidth)</span></span></span><span class="hljs-function"> .</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">height</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(clientHeight)</span></span></span><span class="hljs-function"> .</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">margins</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">({ top: 16, right: 16, bottom: 16, left: 16 })</span></span></span><span class="hljs-function"> .</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ordinalColors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(colors)</span></span></span><span class="hljs-function"> .</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dimension</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dimension)</span></span></span><span class="hljs-function"> .</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">group</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(group)</span></span></span><span class="hljs-function"> .</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">xAxis</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> .</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">scale</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(d3.scaleLinear()</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">domain</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">([0, 2])</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">range</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">([1, 3])</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nice</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chart</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; }</span></span></code> </pre> <br><p> åŒæ—¶ï¼Œåœ¨HTMLä¸­ï¼Œæˆ‘æœ‰ä¸€ä¸ªå¯¹åº”çš„å…ƒç´ ï¼š </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"chart_C2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dc-chart"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p> ä¸ºäº†ä½¿æ­¤ä»£ç èµ·ä½œç”¨ï¼Œæ‚¨éœ€è¦å¯¼å…¥é€‚å½“çš„åº“ï¼š <code>dc.js</code> ï¼Œ <code>d3.js</code> ï¼Œ <code>crossfilter.js</code> ã€‚ è°ƒç”¨<code>initChart</code>å‡½æ•°å°†åˆ›å»ºä¸€ä¸ªå›¾å½¢å¹¶æ’å…¥ç»“æœ <br>  svgåˆ°æ ‘ä¸­çš„æŒ‡å®šé¡¹ç›®ã€‚ </p><br><p> ä½†æ˜¯PDFä¸åŒ…å«ä»»ä½•å›¾å½¢ã€‚ ä»¥åŠPDFæ¸²æŸ“ä¹‹å‰æ‰§è¡ŒJavaScriptä»£ç çš„å…¶ä»–ä»»ä½•æ–¹å¼ã€‚ æ£€æŸ¥è¿™éå¸¸å®¹æ˜“-åªéœ€æ·»åŠ åŸºæœ¬ä»£ç ä»¥åˆ›å»ºå¸¦æœ‰æ–‡æœ¬çš„ç®€å•<code>&lt;div&gt;</code>å…ƒç´ ï¼Œå³å¯æµ‹è¯•JavaScriptè°ƒç”¨çš„äº‹å®ã€‚ </p><br><p> æ ¹æ®ç»éªŒï¼Œäº‹å®è¯æ˜ï¼Œ <code>wkhtmltopdf</code>çš„JSä»£ç çš„<code>wkhtmltopdf</code>èµ·ç€é‡è¦ä½œç”¨ã€‚ ä½äº<code>&lt;html&gt;</code>æœ«å°¾æˆ–ä¾‹å¦‚<code>&lt;body&gt;</code> JSæœ«å°¾çš„ä»£ç å°†ä¸ä¼šæ‰§è¡Œã€‚ å®ç”¨ç¨‹åºä¼¼ä¹æ ¹æœ¬æ²¡æœ‰æ³¨æ„åˆ°ä»–ï¼Œæˆ–è€…ä¸å¸Œæœ›åœ¨é‚£é‡Œè§åˆ°ä»–ã€‚ </p><br><p> ä½†æ˜¯<code>&lt;head&gt;</code>å†…éƒ¨çš„ä»£ç å·²æ‰§è¡Œã€‚ å› æ­¤ï¼Œå½“JavaScriptä»£ç ä½äº<code>&lt;head&gt;</code>å†…çš„æ ·å¼å£°æ˜ä¹‹åå¹¶é€šè¿‡é€šå¸¸çš„æ„é€ è°ƒç”¨JavaScriptä»£ç æ—¶ï¼Œæˆ‘æ¥åˆ°äº†è¯¥æ–¹æ¡ˆï¼š </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"initCharts()"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»£ç å°†æŒ‰é¢„æœŸæ‰§è¡Œã€‚ </p><br><h3 id="javascript-limitations">  JavaScripté™åˆ¶ </h3><br><p> ä½†æ˜¯æ— è®ºå¦‚ä½•ï¼Œè¾“å‡ºPDFä¸­ä»ç„¶æ²¡æœ‰å›¾å½¢ã€‚ ç„¶åï¼Œæˆ‘å¼€å§‹çŒœæµ‹pdfæ¸²æŸ“å’Œæ‰§è¡Œå¼•æ“ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„æµè§ˆå™¨ï¼Œå¾ˆå¯èƒ½ä¸æ˜¯å®Œç¾çš„ï¼Œå¹¶ä¸”ä¸äº†è§£æœ€åçš„è§„åˆ™ã€‚ å†æ¬¡ï¼Œé€šè¿‡å®éªŒï¼Œæˆ‘å‘ç°ç®­å¤´åŠŸèƒ½æœªè¢«æ„ŸçŸ¥ã€‚ æ­¤å¤–ï¼Œå¦‚æœå£è¯‘å‘˜å‘ç°ä»–ä¸çŸ¥é“çš„ä¸œè¥¿ï¼Œé‚£ä¹ˆå®ƒå°†åœæ­¢å·¥ä½œã€‚ </p><br><p> ç”¨æ›´ç»å…¸çš„<code>function(x) { return x.value; }</code>æ›¿æ¢å½¢å¼<code>x =&gt; x.value</code>ç®­å¤´å‡½æ•°<code>function(x) { return x.value; }</code>  <code>function(x) { return x.value; }</code>æœ‰æ‰€å¸®åŠ©ï¼Œå¹¶ä¸”æ‰€æœ‰ä»£ç éƒ½å·²æ‰§è¡Œï¼Œç»“æœå›¾è¿›å…¥PDFæ–‡ä»¶ã€‚ </p><br><h3 id="chart-width"> å›¾è¡¨å®½åº¦ </h3><br><p> æ ¹æ®ç»éªŒï¼Œäº‹å®è¯æ˜æœ‰å¿…è¦æ¸…æ¥šåœ°æŒ‡å‡ºå›¾çš„çˆ¶å…ƒç´ çš„å®½åº¦ã€‚ ä¸ºæ­¤ï¼Œæˆ‘æŒ‡å®šäº†<code>dc-chart</code>æ ·å¼ã€‚ å®ƒåŒ…å«å›¾å½¢çš„å®½åº¦ï¼ˆä»¥åƒç´ ä¸ºå•ä½ï¼‰ã€‚ å¦åˆ™ï¼ŒPDFä¸Šçš„å›¾è¡¨å°†å¾ˆå°ï¼Œå°½ç®¡äº‹å®ä¸Šåœ¨HTMLç‰ˆæœ¬ä¸­å®ƒå°†å æ®æ•´ä¸ªå®½åº¦ã€‚ æŒ‡å®šç™¾åˆ†æ¯”å®½åº¦ä»…é€‚ç”¨äºHTMLã€‚ </p><br><h3 id="inline-javascript--css"> å†…è”JavaScript / CSS </h3><br><p> æœ€åï¼Œæˆ‘æƒ³æŒ‡å‡ºçš„æ˜¯ï¼Œè®¸å¤šå°†HTMLè½¬æ¢ä¸ºPDFçš„åº“éƒ½æ¥å—æŸä¸ªbaseUrlä½œä¸ºå‚æ•°ã€‚ è¿™æ˜¯URLï¼Œè½¬æ¢å™¨å°†ä»¥æ­¤URLä¸ºåŸºç¡€å®Œæˆæ¥æ”¶å¯¼å…¥çš„CSSæ ·å¼ï¼ŒJavaScirptæ–‡ä»¶æˆ–å­—ä½“çš„ç›¸å¯¹è·¯å¾„ã€‚ æˆ‘ä¸èƒ½è‚¯å®šåœ°è¯´è¿™åœ¨Rotativaä¸­å¦‚ä½•å·¥ä½œï¼Œä½†æˆ‘æƒ³å‡ºäº†å¦ä¸€ç§æ–¹æ³•ã€‚ </p><br><p> ä¸ºäº†åŠ å¿«æŠ¥è¡¨çš„åˆå§‹åŠ è½½é€Ÿåº¦å¹¶æ¶ˆé™¤è½¬æ¢æœŸé—´åµŒå…¥è„šæœ¬æˆ–æ ·å¼æ–‡ä»¶çš„é—®é¢˜æ ¹æºï¼Œæˆ‘å°†å¿…è¦çš„JSå’ŒCSSç›´æ¥åµŒå…¥åˆ°HTMLæ¨¡æ¿çš„ä¸»ä½“ä¸­ã€‚ </p><br><p> ä¸ºæ­¤ï¼Œè¯·åˆ›å»ºé€‚å½“çš„æ†ç»‘åŒ…ï¼š </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">BundleConfig</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RegisterBundles</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BundleCollection bundles</span></span></span><span class="hljs-function">)</span></span> { bundles.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StyleBundle(<span class="hljs-string"><span class="hljs-string">"~/Styles/report-html"</span></span>) .Include(<span class="hljs-string"><span class="hljs-string">"~/Styles/report-common.css"</span></span>) .Include(<span class="hljs-string"><span class="hljs-string">"~/Styles/report-html.css"</span></span>) ); bundles.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StyleBundle(<span class="hljs-string"><span class="hljs-string">"~/Styles/report-pdf"</span></span>) .Include(<span class="hljs-string"><span class="hljs-string">"~/Styles/report-common.css"</span></span>) .Include(<span class="hljs-string"><span class="hljs-string">"~/Styles/report-pdf.css"</span></span>) ); bundles.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ScriptBundle(<span class="hljs-string"><span class="hljs-string">"~/Scripts/charts"</span></span>) .Include(<span class="hljs-string"><span class="hljs-string">"~/Scripts/d3/d3.js"</span></span>) .Include(<span class="hljs-string"><span class="hljs-string">"~/Scripts/crossfilter/crossfilter.js"</span></span>) .Include(<span class="hljs-string"><span class="hljs-string">"~/Scripts/dc/dc.js"</span></span>) ); } }</code> </pre> <br><p> å°†è¿™äº›æ†ç»‘åŒ…çš„é…ç½®è°ƒç”¨æ·»åŠ åˆ°<code>Global.asax.cs</code> </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Application_Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { ... BundleConfig.RegisterBundles(BundleTable.Bundles); }</code> </pre> <br><p> å¹¶æ·»åŠ é€‚å½“çš„æ–¹æ³•å°†ä»£ç åµŒå…¥é¡µé¢ä¸­ã€‚ å®ƒéœ€è¦ä¸<code>Global.asax.cs</code>æ”¾åœ¨åŒä¸€å‘½åç©ºé—´ä¸­ï¼Œä»¥ä¾¿å¯ä»¥ä»HTMLæ¨¡æ¿è°ƒç”¨è¯¥æ–¹æ³•ï¼š </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HtmlHelperExtensions</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> IHtmlString </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InlineStyles</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HtmlHelper htmlHelper, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bundleVirtualPath</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> bundleContent = LoadBundleContent(htmlHelper.ViewContext.HttpContext, bundleVirtualPath); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> htmlTag = <span class="hljs-string"><span class="hljs-string">$"&lt;style rel=\"stylesheet\" type=\"text/css\"&gt;</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{bundleContent}</span></span></span><span class="hljs-string">&lt;/style&gt;"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HtmlString(htmlTag); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> IHtmlString </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InlineScripts</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HtmlHelper htmlHelper, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bundleVirtualPath</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> bundleContent = LoadBundleContent(htmlHelper.ViewContext.HttpContext, bundleVirtualPath); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> htmlTag = <span class="hljs-string"><span class="hljs-string">$"&lt;script type=\"text/javascript\"&gt;</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{bundleContent}</span></span></span><span class="hljs-string">&lt;/script&gt;"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HtmlString(htmlTag); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LoadBundleContent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HttpContextBase httpContext, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bundleVirtualPath</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bundleContext = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BundleContext(httpContext, BundleTable.Bundles, bundleVirtualPath); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bundle = BundleTable.Bundles.Single(b =&gt; b.Path == bundleVirtualPath); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bundleResponse = bundle.GenerateBundleResponse(bundleContext); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> bundleResponse.Content; } }</code> </pre> <br><p> å¥½å§ï¼Œæœ€åä¸€ç‚¹å°±æ˜¯æ¨¡æ¿è°ƒç”¨ï¼š </p><br><pre> <code class="html hljs xml">@Html.InlineStyles("~/Styles/report-pdf"); @Html.InlineScripts("~/Scripts/charts");</code> </pre> <br><p> ç»“æœï¼Œæ‰€æœ‰å¿…éœ€çš„CSSå’ŒJavaScriptéƒ½å°†ç›´æ¥ä»¥HTMLæ ¼å¼æ˜¾ç¤ºï¼Œå°½ç®¡åœ¨å¼€å‘è¿‡ç¨‹ä¸­æ‚¨å¯ä»¥ä½¿ç”¨å•ä¸ªæ–‡ä»¶ã€‚ </p><br><p> å¾ˆå¯èƒ½ï¼Œè®¸å¤šäººä¼šç«‹å³è€ƒè™‘åˆ°è¿™ç§æ–¹æ³•åœ¨æµè§ˆå™¨ç¼“å­˜è¯·æ±‚æ–¹é¢çš„æ•ˆç‡ä½ä¸‹ã€‚ ä½†æ˜¯æˆ‘æœ‰ä¸¤ä¸ªå…·ä½“ç›®æ ‡ï¼š </p><br><ul><li> å› æ­¤ï¼ŒPDFè½¬æ¢å™¨ä¸å¿…åœ¨æŸå¤„è¯·æ±‚æ ·å¼æˆ–ä»£ç ï¼Œè€Œç”¨æˆ·åˆ™å¿…é¡»åˆ†åˆ«ç­‰å¾…ï¼› </li><li> å› æ­¤ï¼Œé¦–æ¬¡ä¸‹è½½PDFå’ŒHTMLæŠ¥å‘Šæ‰€éœ€çš„æ—¶é—´æœ€å°‘ï¼Œè€Œæ— éœ€ç­‰å¾…ä¸€äº›å…¶ä»–è¯·æ±‚ã€‚ åœ¨æˆ‘çš„é¡¹ç›®ä¸­ï¼Œè¿™å¾ˆé‡è¦ï¼› </li></ul><br><h3 id="page-breaks"> åˆ†é¡µç¬¦ </h3><br><p> å°†æŠ¥å‘Šåˆ†ä¸ºå‡ éƒ¨åˆ†å¯èƒ½éœ€è¦ä»æ–°é¡µé¢å¼€å§‹æ–°éƒ¨åˆ†çš„è¦æ±‚ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥æˆåŠŸä½¿ç”¨ç®€å•çš„CSSæ–¹æ³•ï¼š </p><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.page-break-before</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">page-break-before</span></span>: always; } <span class="hljs-selector-class"><span class="hljs-selector-class">.no-page-break-inside</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">page-break-before</span></span>: auto; <span class="hljs-attribute"><span class="hljs-attribute">page-break-inside</span></span>: avoid; }</code> </pre> <br><p>  wkhtmltopdfå®ç”¨ç¨‹åºæˆåŠŸè¯»å–äº†è¿™äº›ç±»ï¼Œå¹¶äº†è§£æœ‰å¿…è¦å¯åŠ¨ä¸€ä¸ªæ–°é¡µé¢ã€‚ ç¬¬ä¸€ç±»<code>page-break-before</code> before-å‘Šè¯‰å®ç”¨ç¨‹åºå§‹ç»ˆä½¿ç”¨æ­¤å…ƒç´ å¼€å§‹ä¸€ä¸ªæ–°é¡µé¢ã€‚ ç¬¬äºŒç±»<code>no-page-break-inside</code>åº”è¯¥åº”ç”¨äºå¸Œæœ›åœ¨é¡µé¢ä¸Šä¿æŒå°½å¯èƒ½å®Œæ•´çš„é‚£äº›å…ƒç´ ã€‚ ä¾‹å¦‚ï¼Œæ‚¨æœ‰è¿ç»­çš„ç»“æ„åŒ–ä¿¡æ¯å—æˆ–è¡¨ã€‚ å¦‚æœé¡µé¢ä¸Šæœ‰ä¸¤ä¸ªå—-å°†æ‰¾åˆ°å®ƒä»¬ã€‚ å¦‚æœç¬¬ä¸‰ä¸ªé¡µé¢ä¸é€‚åˆè¯¥é¡µé¢ï¼Œåˆ™ä¸ä¼šæ˜¯ä¸‹ä¸€ä¸ªã€‚ å¦‚æœå®ƒå¤§äºä¸€é¡µï¼Œé‚£ä¹ˆå®ƒçš„ä¼ è¾“å·²ç»ä¸å¯é¿å…ã€‚ æ‰€æœ‰è¿™äº›å·¥ä½œéƒ½å……åˆ†ä¸”æ–¹ä¾¿åœ°è¿›è¡Œã€‚ </p><br><h3 id="flex-behavior-in-wkhtmltopdf">  wkhtmltopdfä¸­çš„Flexè¡Œä¸º </h3><br><p> å¥½å§ï¼Œæˆ‘æ³¨æ„åˆ°çš„æœ€åä¸€ä¸ªåŠŸèƒ½ä¸flexboxæ ‡è®°æ ·å¼çš„ä½¿ç”¨æœ‰å…³ã€‚ æˆ‘ä»¬éƒ½å·²ç»ä¹ æƒ¯äº†å®ƒä»¬ï¼Œå‡ ä¹æ‰€æœ‰çš„æ ‡è®°éƒ½æ˜¯ç”±flexsè¿›è¡Œçš„ã€‚ ä½†æ˜¯ï¼Œwkhtmltopdfåœ¨è¿™æ–¹é¢æœ‰ç‚¹è½åã€‚ æ°´å¹³ä¼¸ç¼©é€‰é¡¹ä¸èµ·ä½œç”¨ï¼ˆè‡³å°‘åœ¨æˆ‘è€Œè¨€ï¼Œè¿™ä¸èµ·ä½œç”¨ã€‚æˆ‘åœ¨ç½‘ç»œä¸­çœ‹åˆ°ï¼Œå€¼å¾—å¤åˆ¶ä¼¸ç¼©æ ·å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">display</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">-webkit-flex</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">display</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">flex</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">flex-direction</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">row</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">-webkit-flex-direction</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">row</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">-webkit-box-pack</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">justify</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* wkhtmltopdf uses this one */</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-webkit-justify-content</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">space-between</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">justify-content</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">space-between</span></span>;</code> </pre> <br><p> ä½†æ˜¯ä¸å¹¸çš„æ˜¯ï¼Œè¿™å¹¶æ²¡æœ‰å¯¼è‡´é¢„æœŸçš„PDFæ ‡è®°ã€‚ æˆ‘å¿…é¡»é‡åšä¸€äº›å…ƒç´ çš„å¸ƒå±€ï¼Œä»¥ä¾¿æŒ‰éœ€è¦æ°´å¹³æ”¾ç½®å—ã€‚ å¦‚æœæœ‰äººåœ¨å°†flexé›†æˆåˆ°wkhtmltopdfæ–¹é¢å…·æœ‰æˆåŠŸçš„ç»éªŒï¼Œè¯·åˆ†äº«ã€‚ é‚£ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚ </p><br><p> ä¸€äº›é“¾æ¥ï¼š </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">wkhtmltopdf</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">wkhtmltopdfæ‰‹å†Œ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Rotativaçš„github</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è½®çŠ¶åŒ…è£…</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å†…è”æ ·å¼HowTo</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN425511/">https://habr.com/ru/post/zh-CN425511/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN425499/index.html">HyperX Impact DDR4-å¯ä»¥çš„SO-DIMMï¼ è¿˜æ˜¯ä¸ºä»€ä¹ˆåœ¨ç¬”è®°æœ¬ç”µè„‘ä¸­ä»¥3200 MHzçš„é¢‘ç‡å­˜å‚¨64 GBå†…å­˜ï¼Ÿ</a></li>
<li><a href="../zh-CN425501/index.html">ä»Aåˆ°Zåœ¨Androidä¸Šè¿›è¡ŒA / Bæµ‹è¯•</a></li>
<li><a href="../zh-CN425503/index.html">Cassandra Sinkç”¨äºSparkç»“æ„åŒ–æµ</a></li>
<li><a href="../zh-CN425505/index.html">Linuxå†…æ ¸å¯åŠ¨è¿‡ç¨‹åˆ†æ</a></li>
<li><a href="../zh-CN425507/index.html">Parsim Wikipediaè´Ÿè´£4ä¸ªå›¢é˜Ÿçš„NLPä»»åŠ¡</a></li>
<li><a href="../zh-CN425515/index.html">Appleé˜»æ­¢å¯¹æ–°MacBookå‹å·è¿›è¡Œç‹¬ç«‹ç»´ä¿®</a></li>
<li><a href="../zh-CN425517/index.html">Yandexå¦‚ä½•ä½¿ç”¨é›·è¾¾å’Œå«æ˜Ÿåˆ›å»ºå…¨çƒé™æ°´é¢„æŠ¥</a></li>
<li><a href="../zh-CN425521/index.html">JavaScript ES5ä¸­çš„å—ä¿æŠ¤æ–¹æ³•</a></li>
<li><a href="../zh-CN425525/index.html">è’‚å§†Â·ä¼¯çº³æ–¯Â·æï¼ˆTim Berners-Leeï¼‰èµ°ä¸Šäº†æˆ˜äº‰çš„é“è·¯ï¼šâ€œç½‘ç»œçš„ç¬¬ä¸€æ­¥...â€</a></li>
<li><a href="../zh-CN425527/index.html">åœ¨Kotlinåˆ—å‡ºã€‚ Haskellæ–¹æ³•</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>