<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë®‚Äçüë¶‚Äçüë¶ üßõüèø üÖ±Ô∏è Nous programmons le contr√¥le de l'√©clairage par des capteurs de mouvement et d'√©clairage sur Node-RED üê™ üßòüèΩ üïã</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il existe peu d'articles sur un environnement de programmation tel que Node-RED sur Internet en langue russe . Cet article r√©v√©lera le secret du ridea...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous programmons le contr√¥le de l'√©clairage par des capteurs de mouvement et d'√©clairage sur Node-RED</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/396985/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il existe peu d'articles sur un environnement de programmation tel que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Node-RED</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur Internet en langue russe </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cet article r√©v√©lera le secret du rideau sur ce produit et montrera, √† l'aide de l'exemple de cr√©ation d'un algorithme de contr√¥le d'√©clairage pour les capteurs de mouvement, √† quel point il est simple d'utiliser Node-RED pour impl√©menter divers sc√©narios et r√®gles pour automatiser une maison intelligente sous une forme compl√®tement graphique sans √©crire de code.</font></font><br>
<br>
<img src="https://habrastorage.org/files/639/1c2/c9f/6391c2c9f6134818a598bc2e703815ce.png"><br>
<a name="habracut"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'est-ce que Node-RED?</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IBM, comme d'autres grandes entreprises, essaie de trouver sa niche dans l'Internet des objets en √©volution. </font><font style="vertical-align: inherit;">Ceci est g√©n√©ralement associ√© √† la sortie d'applications et de produits open source afin de populariser leurs plateformes payantes. </font><font style="vertical-align: inherit;">Par exemple, chez IBM, la plate-forme payante est Bluemix. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Node-RED est une cr√©ation open source d'IBM et, comme il est simplement √©crit sur le site, c'est un outil qui sert √† connecter le mat√©riel, les API et les services de mani√®re nouvelle et int√©ressante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces m√©thodes sont bas√©es sur l'utilisation de lignes de communication graphiques √† travers lesquelles des messages sont envoy√©s entre les n≈ìuds. </font><font style="vertical-align: inherit;">Ainsi, vous pouvez connecter les diff√©rents blocs simplement avec la souris sans utiliser de programmation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le d√©veloppement dans Node-RED s'effectue via un navigateur ordinaire, le noyau lui-m√™me peut √™tre ex√©cut√© sur diff√©rentes plates-formes - PC, RPi, cloud, etc.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Node-RED pour la maison intelligente</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai d√©cid√© d'essayer Node-RED pour √©crire des scripts et des r√®gles pour la maison intelligente. Autrement dit, pour l'automatisation. La connexion m√™me avec divers actionneurs, services Web et capteurs se fait sur OpenHAB. Pourquoi ai-je d√©cid√© de ne pas y faire d'automatisation? Plusieurs raisons: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Dans OpenHAB, les scripts et les r√®gles sont √©crits dans leur propre langage. Je ne voulais pas l'√©tudier uniquement pour une seule application. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Le d√©bogage des r√®gles lui-m√™me est pratiquement impossible - si la r√®gle ne fonctionne pas, il est difficile de comprendre pourquoi </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - je voudrais que mes r√®gles soient ind√©pendantes du mat√©riel, des canaux de communication, des plates-formes et du logiciel lui-m√™me pour communiquer avec les appareils. Pour que je puisse facilement passer √† une autre plate-forme UD, par exemple Domoticz, MajorDomo, FHEM et emporter mes r√®gles avec moi, sans les r√©√©crire sous la nouvelle plate-forme UD.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Contr√¥le de l'√©clairage par des capteurs de mouvement et de lumi√®re</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commen√ßons donc. </font><font style="vertical-align: inherit;">En fait, la t√¢che d'origine est simple et triviale: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
j'ai contr√¥l√© des spots LED pour l'√©clairage dans le couloir. </font><font style="vertical-align: inherit;">Je veux que la lumi√®re s'allume en mouvement et s'√©teigne apr√®s 10 secondes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compliquons un peu la t√¢che: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - La lumi√®re ne doit s'allumer que lorsqu'il fait sombre √† l'ext√©rieur </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - L'intensit√© de la lumi√®re doit d√©pendre du temps - jusqu'√† 21 heures, la lumi√®re doit s'allumer √† pleine intensit√©, et apr√®s seulement 10% comme r√©tro-√©clairage.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capteurs, interpr√®tes, etc. fer</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les protocoles et les options de communication avec les capteurs et actionneurs que je ne d√©crirai pas ici. Qu'il suffise de dire que dans ma maison intelligente, tous ces protocoles sont r√©duits √† un - MQTT, et gr√¢ce √† lui la communication avec Node-RED est d√©j√† en cours. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alors, quels capteurs et actionneurs ai-je? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Le capteur de mouvement. Publie un message OUVERT dans la rubrique / myhome / state / Hall_motion lorsqu'il d√©tecte un mouvement et FERM√â s'il n'y a aucun mouvement pendant 2 secondes. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Capteur de lumi√®re. Il mesure la luminosit√© de l'√©clairage public dans la plage de 0 √† 1 000 lux. Il publie un message une fois par minute dans le sujet / myhome / state / Lumin_Hall avec le niveau d'√©clairage actuel.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Lampes LED de contr√¥le de gradateur. </font><font style="vertical-align: inherit;">Il est abonn√© √† la rubrique / myhome / command / Light_Hall / state. </font><font style="vertical-align: inherit;">Si vous √©crivez 0 l√† - la lumi√®re s'√©teindra. </font><font style="vertical-align: inherit;">100 - s'allume √† la luminosit√© maximale. </font><font style="vertical-align: inherit;">1-99 - changera l'intensit√© lumineuse. </font><font style="vertical-align: inherit;">Pour un √©clairage nocturne, une intensit√© suffisante 1.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description du flux dans le n≈ìud-RED</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est suppos√© que vous avez d√©j√† install√© Node-RED. </font><font style="vertical-align: inherit;">Sinon, suivez le lien ci-dessus et installez n'importe quelle option qui vous convient - sur un ordinateur, Raspberry, clowd, etc. </font><font style="vertical-align: inherit;">Dans mon cas, Node-RED est install√© sur RPi2 (√† mon avis, il vient m√™me avec Raspbian, donc rien ne doit √™tre install√© du tout). </font><font style="vertical-align: inherit;">Ce flux ne n√©cessite l'installation d'aucune biblioth√®que suppl√©mentaire.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entr√©es et sorties</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, nous cr√©ons les entr√©es et sorties n√©cessaires √† notre algorithme. Il s'agira de clients MQTT abonn√©s aux rubriques pertinentes. Nous les faisons glisser de la biblioth√®que de gauche et les personnalisons. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remarque: Les noms de bloc affich√©s peuvent √™tre modifi√©s dans leurs param√®tres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour le capteur de lumi√®re, cr√©ez le n≈ìud Hall Light Sensor √† partir de l'entr√©e MQTT: </font></font><br>
<br>
<img src="https://habrastorage.org/files/498/4bf/290/4984bf2904f44c0b97aad3d2ea8bb116.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dans sa configuration, il suffit d'enregistrer l'adresse et le sujet du courtier MQTT. </font></font><br>
<br>
<img src="https://habrastorage.org/files/883/3ca/27f/8833ca27f19e4f789a545265e877b4fc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mon courtier tourne sur la m√™me plate-forme, alors laissez simplement localhost. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous cr√©ons le n≈ìud Hall Motion Sensor pour le capteur de mouvement: </font></font><br>
<br>
<img src="https://habrastorage.org/files/b07/e06/172/b07e0617262c43f8af32d02b10ecc6cd.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout est pareil pour lui, il suffit de d√©finir un autre sujet / myhome / state / Hall_motion. </font></font><br>
<br>
<img src="https://habrastorage.org/files/58e/186/5e9/58e1865e981a444395d03419537ab8b9.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez voir l'adresse et les param√®tres du courtier, ce n≈ìud a d√©j√† pris le relais du pr√©c√©dent, vous n'avez donc pas besoin de les saisir dans un nouveau.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il reste √† ajouter la sortie MQTT pour faire une sortie pour le gradateur LED. Faites glisser et d√©posez la sortie MQTT et appelez-la Hall Light Dimmer. </font></font><br>
<br>
<img src="https://habrastorage.org/files/4c5/779/1de/4c57791de90247ad9a1b6208d5199c0d.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les param√®tres, encore une fois, il vous suffit de sp√©cifier la rubrique souhait√©e, √† laquelle les messages pour contr√¥ler le gradateur seront envoy√©s - / myhome / command / Light_Hall / state </font></font><br>
<br>
<img src="https://habrastorage.org/files/7b6/8fb/545/7b68fb5452b142a7bfb1c4c293d902fe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, nous avons obtenu trois n≈ìuds pour notre Flow. </font></font><br>
<br>
<img src="https://habrastorage.org/files/6ae/70c/cf9/6ae70ccf981d46318f6c487435dbeb81.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il ne ferait pas de mal de les tester pour leur fonctionnalit√©. C'est simple. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous connectons la sortie de d√©bogage aux blocs d'entr√©e. </font></font><br>
<br>
<img src="https://habrastorage.org/files/9e6/5fa/e1b/9e65fae1b1c2464a9c5d553f5be90411.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et connectez l'entr√©e d'injection au bloc de sortie. </font></font><br>
<br>
<img src="https://habrastorage.org/files/11e/d81/8c6/11ed818c639f4331a317232357d88b57.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les param√®tres de ce n≈ìud, vous devez modifier la charge utile au niveau de la luminosit√© souhait√©e de la lampe. Par exemple, dans ce cas, il s'agit de 100. </font></font><br>
<br>
<img src="https://habrastorage.org/files/77b/dd8/1d6/77bdd81d6fb046ec94b0c5a6907f0956.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous pouvons cr√©er plusieurs blocs d'injection identiques par copier-coller, changer la luminosit√© et les connecter √† la sortie comme ceci:</font></font><br>
<br>
<img src="https://habrastorage.org/files/a2c/63b/706/a2c63b70698841d7a610d89de62aca37.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela fonctionnera aussi. </font><font style="vertical-align: inherit;">Il est temps de v√©rifier. </font><font style="vertical-align: inherit;">Nous cliquons sur le bouton D√©ployer: </font></font><br>
<br>
<img src="https://habrastorage.org/files/c93/3e5/16f/c933e516faa0478485d82513326f96dd.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sous les n≈ìuds MQTT, vous devriez voir un petit message: </font></font><br>
<br>
<img src="https://habrastorage.org/files/132/d32/701/132d32701d154b038b17b7d6a5e0055d.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cela signifie qu'ils sont connect√©s au courtier MQTT. </font><font style="vertical-align: inherit;">Si tout s'est d√©roul√© comme pr√©vu, dans l'onglet de d√©bogage de droite, vous devriez voir les messages des capteurs, et si vous cliquez sur les rectangles √† gauche des n≈ìuds d'injection, l'intensit√© lumineuse de la lampe connect√©e au gradateur devrait changer. </font><font style="vertical-align: inherit;">Si tout fonctionne, vous pouvez aller plus loin.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Circuit de commande d'√©clairage du capteur de mouvement</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour simplifier, je ferai r√©f√©rence aux blocs individuels interconnect√©s comme des cha√Ænes. Tout d'abord, essayons de cr√©er un circuit simple qui allume la lumi√®re par le capteur de mouvement et l'√©teint apr√®s un certain temps. Pour ce faire, selon le concept Node-RED, nous avons besoin du message du capteur de mouvement pour atteindre le gradateur √† travers certains blocs et avoir un certain texte. Tout d'abord, nous traiterons de l'inclusion de la lumi√®re. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, nous s√©lectionnons parmi tous les messages du capteur de mouvement un message avec le texte OUVERT - cela signifie que le mouvement est apparu. Pour ce faire, utilisez le bloc commutateur. Connectez-le √† la sortie du bloc Hall Motion Sensor que nous avons d√©j√† cr√©√©. </font></font><br>
<br>
<img src="https://habrastorage.org/files/ad2/92d/eb3/ad292deb31634ef7853c1cb9bcc45cef.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons le configurer pour que le bloc ne g√©n√®re que des messages avec le texte OPEN</font></font><br>
<br>
<img src="https://habrastorage.org/files/79c/989/4f7/79c9894f70154190835afd1969fa8f2a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir sur l'image, le bloc comparera la charge utile avec le texte OUVERT et enverra des messages √† la sortie si le texte correspond. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre variateur n√©cessite que des messages avec la luminosit√© requise 0 ... 100 y soient entr√©s. Il ne comprendra pas le texte OUVERT. Par cons√©quent, nous utilisons le bloc Modifier pour modifier le texte du message. </font></font><br>
<br>
<img src="https://habrastorage.org/files/a25/202/c7d/a25202c7dc5b40e5ab5e4ac2aa9503db.png"><br>
<img src="https://habrastorage.org/files/e8e/7a6/102/e8e7a6102c54450a9ae86a7b5eeed678.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les param√®tres de ce bloc, notez la modification requise - la charge utile du message passe √† 100 - l'intensit√© d'√©clairage requise. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et enfin, nous connectons tout cela √† l'entr√©e de notre gradateur: </font></font><br>
<br>
<img src="https://habrastorage.org/files/4e5/cb7/810/4e5cb78102d24e208f4d770a6b7c71a7.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
si vous d√©marrez ce circuit, vous pouvez vous assurer qu'il fonctionne - la lumi√®re s'allumera en mouvement. Reste √† s'assurer qu'il s'√©teint √©galement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ce faire, utilisez l'unit√© de d√©clenchement et connectez-la √† la sortie du capteur de mouvement.</font></font><br>
<br>
<img src="https://habrastorage.org/files/a9b/e70/538/a9be70538741423fb180dd6453c9d5eb.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le bloc d√©clencheur vous permet de g√©n√©rer des messages retard√©s et peut √©galement √™tre r√©initialis√© par un message sp√©cifique. Nous allons le </font></font><br>
<br>
<img src="https://habrastorage.org/files/cb2/a37/a90/cb2a37a90a81451a935ffb92db9fcc00.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
configurer de </font><font style="vertical-align: inherit;">cette fa√ßon: </font><font style="vertical-align: inherit;">Ce param√®tre signifie que lorsque le premier message arrive, le d√©clencheur n'envoie rien, mais d√©marre un d√©lai de 8 secondes et ensuite il envoie un message avec le texte 0. Le d√©clencheur est √©galement r√©initialis√© s'il re√ßoit une entr√©e avec le texte OUVERT. Qu'est-ce que cela signifie dans notre cas? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supposons que le capteur de mouvement affiche un message OUVERT. Ce message ram√®nera le d√©clencheur √† son √©tat d'origine sans aucune r√©action. Ensuite, apr√®s un certain temps, le d√©tecteur de mouvement √©met un message FERM√â. Ce message d√©marrera la temporisation et 8 secondes apr√®s que le d√©clencheur affichera un message 0.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si pendant ce d√©lai, le message OPEN arrive √† nouveau, le d√©clencheur reviendra √† son √©tat d'origine et attendra le prochain message (qui sera logiquement FERM√â). Dans ce cas, le d√©clencheur n'affichera aucun message. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autrement dit, nous avons cr√©√© une minuterie qui nous servira √† √©teindre automatiquement la lumi√®re apr√®s une exposition donn√©e. Si nous rappelons la description du capteur de mouvement, il devient clair pourquoi 8 secondes sont d√©finies ici, et non 10 - 2 secondes sont ajout√©es en raison de la vitesse d'obturation du capteur de mouvement lui-m√™me. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il reste √† connecter la sortie de d√©clenchement au gradateur et vous pouvez d√©marrer le circuit pour v√©rification. </font></font><br>
<br>
<img src="https://habrastorage.org/files/df4/c60/62f/df4c6062f86d48feab6b08ac3050b6fa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je note que pour plus de simplicit√©, je poste des captures d'√©cran de cha√Ænes d√©j√† d√©bogu√©es. Vous pouvez accrocher des blocs avec votre cha√Æne de d√©bogage pour comprendre comment cela fonctionne, et votre cha√Æne peut ressembler √† ceci:</font></font><br>
<br>
<img src="https://habrastorage.org/files/e63/3c7/10e/e633c710e67f47d1931e0c33b92a69b7.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et il n'y a rien √† craindre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et vous pouvez le faire comme ceci: en </font></font><br>
<br>
<img src="https://habrastorage.org/files/cff/c68/6ca/cffc686cab3f49059033979c52ac0ae5.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
g√©n√©ral, en cliquant sur les rectangles √† gauche des blocs d'injection, vous pouvez d√©boguer le circuit sans fer √† repasser - sur votre ordinateur portable lors d'un voyage dans le m√©tro ou m√™me une tablette.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Circuit marche / arr√™t de la lumi√®re en fonction de la luminosit√© de l'√©clairage public </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous devons nous assurer que la lumi√®re ne s'allume pas si la rue est trop claire. Pour ce faire, nous devons ajouter une autre cha√Æne et modifier l√©g√®rement la cha√Æne principale pour tenir compte de ce facteur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, prenez le bloc de commutation que nous connaissons d√©j√† et connectez-le √† la sortie du capteur de lumi√®re. </font></font><br>
<br>
<img src="https://habrastorage.org/files/5fc/b76/7f8/5fcb767f8f4c470eb4d99f8464da301b.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons configurer cette unit√© afin qu'elle envoie des messages du capteur de lumi√®re √† l'une des sorties, en fonction de l'√©clairage actuel. </font></font><br>
<br>
<img src="https://habrastorage.org/files/bd6/b5c/f07/bd6b5cf07f2c4d3395bed17d0c2e4e9e.png"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La condition ci-dessus signifie que si l'√©clairage est inf√©rieur √† 10 lux, le message sera envoy√© √† la sortie 1. Sinon, il ira √† la sortie 2. N'oubliez pas que vous devez s√©lectionner l' </font></font><br>
<br>
<img src="https://habrastorage.org/files/c17/91f/640/c1791f6403f4420885d4187f9ef88e7c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
option pour que le message soit dirig√© vers une seule des sorties.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la base du principe de fonctionnement, il s'av√®re logiquement que si le message appara√Æt sur la premi√®re sortie (sup√©rieure), nous devons activer la d√©tection de mouvement, et si sur la seconde, puis l'√©teindre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, bien s√ªr, 1000 et 1 m√©thodes sont possibles, la plus simple √©tant de simplement bloquer le message pour allumer la lumi√®re du capteur de mouvement si elle est lumineuse √† l'ext√©rieur. Nous le r√©alisons.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est √† noter que dans Node-RED, le moteur d'ex√©cution est impl√©ment√© en fonction des messages. C'est-√†-dire pas de message - pas d'√©v√©nement, pas de r√©action. Cela impose certaines sp√©cificit√©s dans le cas o√π diff√©rents messages arrivent de mani√®re asynchrone, c'est-√†-dire √† diff√©rents moments. Par exemple, dans ce cas, le message du capteur de lumi√®re est asynchrone avec les messages du capteur de mouvement. Par cons√©quent, afin de prendre en compte l'effet du capteur de lumi√®re, nous devons nous souvenir des informations contenues dans son message, puis les appliquer la prochaine fois qu'un message provient du capteur de mouvement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, le contexte vient √† la rescousse - un champ o√π vous pouvez stocker des informations pendant l'ex√©cution du flux. Le contexte est global par rapport √† l'ensemble de l'environnement, ou local √† un flux sp√©cifique, ou g√©n√©ralement uniquement √† un bloc sp√©cifique.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre cas, nous utiliserons un contexte local √† ce flux. C'est-√†-dire les variables seront visibles par tous les blocs de ce flux. Cr√©ez un bloc de changement et connectez-le √† la premi√®re sortie du d√©tecteur de seuil de lumi√®re. </font></font><br>
<br>
<img src="https://habrastorage.org/files/0fc/c00/305/0fcc00305f154d0f91ff49bef62a28dc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme nous nous en souvenons, un message appara√Æt sur cette sortie si le capteur de lumi√®re signale que l'√©clairage public est inf√©rieur √† 10 Lux. Tenez compte de la configuration du bloc de modification. </font></font><br>
<br>
<img src="https://habrastorage.org/files/96b/881/dcf/96b881dcfdc9420b96d4d358cd67a63b.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, nous utilisons la r√®gle Set pour d√©finir la variable flow.Light_enabled sur Oui. Ainsi, nous avons attribu√© une valeur √† la variable globale, que nous pouvons utiliser dans d'autres blocs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De la m√™me mani√®re, cr√©ez le deuxi√®me bloc de modification et connectez-le √† la deuxi√®me sortie. </font></font><br>
<br>
<img src="https://habrastorage.org/files/c31/f0a/67b/c31f0a67bbf34ddc86ded46ddf74c9fa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sa configuration sera la suivante:</font></font><br>
<br>
<img src="https://habrastorage.org/files/8a8/a88/553/8a8a885534e44d3b871c127119451efd.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour savoir si un tel d√©tecteur fonctionne correctement, nous pouvons cr√©er un circuit simple avec des blocs d'injection et de d√©bogage. </font></font><br>
<br>
<img src="https://habrastorage.org/files/f7b/963/1c8/f7b9631c800c48e2a6c32985b901f47b.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les param√®tres Injecter bloc , </font><font style="vertical-align: inherit;">nous notons qu'il devrait publier chaque seconde valeur de la variable flow.Light_enabled </font></font><br>
<br>
<img src="https://habrastorage.org/files/517/cde/9ba/517cde9ba14d43dab8e56c10abc3bedf.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite , </font><font style="vertical-align: inherit;">le r√©sultat du capteur de </font><font style="vertical-align: inherit;">lumi√®re peut √™tre facilement vu dans l'onglet Mise au </font><font style="vertical-align: inherit;">point de la </font></font><br>
<br>
<img src="https://habrastorage.org/files/698/faf/415/698faf41515040aa953448b86b3ed101.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cha√Æne totale on / off la </font><font style="vertical-align: inherit;">lumi√®re sur l'√©clairage du capteur ressemblera √† </font><font style="vertical-align: inherit;">ceci </font></font><br>
<br>
<img src="https://habrastorage.org/files/368/721/3b4/3687213b4253469494c227c0fdc4df39.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
maintenant, pour tenir compte de cet effet le circuit de commande du capteur de mouvement, il nous suffit d'ins√©rer le bloc interrupteur dans le circuit du chemin pour allumer la lumi√®re. </font></font><br>
<br>
<img src="https://habrastorage.org/files/1d9/610/d37/1d9610d375064d959272c7b0e471b733.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et configurez-le de mani√®re √† ce qu'il ignore les messages du capteur de mouvement uniquement si notre flux de variables globales.Light_enabled est d√©fini sur Oui, c'est-√†-dire il fait sombre dehors. </font></font><br>
<br>
<img src="https://habrastorage.org/files/30e/8b7/29e/30e8b729e5f54ad895b171d4d06a5ce9.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est fait! Maintenant, notre flux ressemble √† ceci:</font></font><br>
<br>
<img src="https://habrastorage.org/files/b16/886/c1b/b16886c1bae2485cbe959c9008603c90.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modification de la luminosit√© de la lampe en fonction du temps </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il en reste tr√®s peu. </font><font style="vertical-align: inherit;">Nous voulons changer l'intensit√© de la lampe LED. </font><font style="vertical-align: inherit;">C'est-√†-dire </font><font style="vertical-align: inherit;">s'il fait sombre chez nous, mais qu'il est avant 21 heures, la lumi√®re devrait s'allumer √† pleine puissance. </font><font style="vertical-align: inherit;">Mais apr√®s neuf heures - seulement √† faible puissance, comme l'√©clairage nocturne. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ce faire, cr√©ez un bloc Inject: </font></font><br>
<br>
<img src="https://habrastorage.org/files/f09/eb9/610/f09eb96103554139bf45f3cc6d74e7c9.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
il peut √™tre configur√© pour qu'il affiche un message √† un moment pr√©cis. </font><font style="vertical-align: inherit;">R√©glez-le √† 21h00 tous les jours. </font></font><br>
<br>
<img src="https://habrastorage.org/files/fa2/eaa/acf/fa2eaaacf5ea4ba294253e875831936b.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le m√™me temps, nous notons qu'il √©mettra un message avec une valeur de 1. Ce sera notre intensit√© de r√©tro-√©clairage souhait√©e en mode nuit. </font><font style="vertical-align: inherit;">Pour utiliser cette valeur dans le circuit de contr√¥le de la lumi√®re, nous utilisons la m√™me astuce avec les variables globales. </font><font style="vertical-align: inherit;">Cr√©ez une modification: bloquez-la </font></font><br>
<br>
<img src="https://habrastorage.org/files/c39/9ae/134/c399ae13425e47a9a4d3f2d0c3800790.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
et configurez-la de sorte que la variable flow.Light_Brightness re√ßoive la valeur du message.</font></font><br>
<img src="https://habrastorage.org/files/5ab/906/2bd/5ab9062bdaa04d88bec7bc0485c7f46b.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour rendre la luminosit√© initiale le matin, cr√©ez un deuxi√®me bloc d'injection, qui sera ex√©cut√© √† 6 heures du matin et donnera une valeur de luminosit√© de 100. Connectez-le l√†. </font></font><br>
<br>
<img src="https://habrastorage.org/files/d2f/342/e3c/d2f342e3c2094eeb9e2055fe3df454af.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, la variable flow.Light_brightness se verra attribuer la valeur 1 tous les soirs √† 9 heures et la valeur 100 tous les matins √† 6 heures. </font><font style="vertical-align: inherit;">Il ne reste plus qu'√† l'appliquer dans le circuit principal. </font><font style="vertical-align: inherit;">Pour ce faire, nous avons d√©j√† le bloc de r√©glage de la luminosit√© de la lumi√®re: </font></font><br>
<br>
<img src="https://habrastorage.org/files/cd8/130/7c7/cd81307c79d445c2b3ecf08ed709e92b.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pour lequel nous avons seulement besoin de modifier le param√®tre afin qu'il n'affecte pas une constante, mais la valeur du d√©bit variable.</font></font><br>
<br>
<img src="https://habrastorage.org/files/f01/e09/da0/f01e09da09cb417586297f0efbfeab77.png"><br>
 <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©sultat final</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le flux final, d√©barrass√© des blocs de d√©bogage, semble net et propre. </font><font style="vertical-align: inherit;">Lors de la cr√©ation, nous avons utilis√© uniquement les blocs de construction de l'installation Node-RED. </font><font style="vertical-align: inherit;">Sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flows.nodered.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cependant, il existe plus de 800 blocs et biblioth√®ques suppl√©mentaires qui vous permettent d'ajouter de nombreuses choses diff√©rentes. </font></font><br>
<br>
<img src="https://habrastorage.org/files/e4b/3c3/20b/e4b3c320b15745ffbbd91e343715a156.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ceux qui souhaitent r√©p√©ter cet algorithme, je poste le flux que j'ai utilis√© pour le d√©bogage: </font></font><br>
<br>
<img src="https://habrastorage.org/files/cc2/27a/61c/cc227a61c0f5434bad8a469623439e23.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ainsi que son code json, qui peut √™tre facilement import√© dans n'importe quelle version de Node-RED et test√©.</font></font><br>
<pre><code class="hljs json">[{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"5afd41b4.d61318"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"switch"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Movement detected?"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"property"</span></span>:<span class="hljs-string"><span class="hljs-string">"payload"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"propertyType"</span></span>:<span class="hljs-string"><span class="hljs-string">"msg"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"rules"</span></span>:[{<span class="hljs-attr"><span class="hljs-attr">"t"</span></span>:<span class="hljs-string"><span class="hljs-string">"eq"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"v"</span></span>:<span class="hljs-string"><span class="hljs-string">"OPEN"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"vt"</span></span>:<span class="hljs-string"><span class="hljs-string">"str"</span></span>}],<span class="hljs-attr"><span class="hljs-attr">"checkall"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"outputs"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">562</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">285</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[<span class="hljs-string"><span class="hljs-string">"381b0d6d.a0bd7a"</span></span>]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"35bac8e.57dd5b8"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"trigger"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"op1"</span></span>:<span class="hljs-string"><span class="hljs-string">"5"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"op2"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"op1type"</span></span>:<span class="hljs-string"><span class="hljs-string">"nul"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"op2type"</span></span>:<span class="hljs-string"><span class="hljs-string">"val"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"duration"</span></span>:<span class="hljs-string"><span class="hljs-string">"8"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"extend"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-attr"><span class="hljs-attr">"units"</span></span>:<span class="hljs-string"><span class="hljs-string">"s"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"reset"</span></span>:<span class="hljs-string"><span class="hljs-string">"OPEN"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Switch off delay"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">750</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">373</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[<span class="hljs-string"><span class="hljs-string">"e995e130.1e2118"</span></span>,<span class="hljs-string"><span class="hljs-string">"af1f191f.498098"</span></span>]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"d85623d1.29b058"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"change"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Light Brightness Adjustment"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"rules"</span></span>:[{<span class="hljs-attr"><span class="hljs-attr">"t"</span></span>:<span class="hljs-string"><span class="hljs-string">"set"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"p"</span></span>:<span class="hljs-string"><span class="hljs-string">"payload"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"pt"</span></span>:<span class="hljs-string"><span class="hljs-string">"msg"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"to"</span></span>:<span class="hljs-string"><span class="hljs-string">"Light_brightness"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"tot"</span></span>:<span class="hljs-string"><span class="hljs-string">"flow"</span></span>}],<span class="hljs-attr"><span class="hljs-attr">"action"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"property"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"from"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"to"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"reg"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">1013.9999389648438</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">284.63330078125</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[<span class="hljs-string"><span class="hljs-string">"e995e130.1e2118"</span></span>,<span class="hljs-string"><span class="hljs-string">"af1f191f.498098"</span></span>]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"934ff922.ca34f"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"inject"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"topic"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"payload"</span></span>:<span class="hljs-string"><span class="hljs-string">"OPEN"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"payloadType"</span></span>:<span class="hljs-string"><span class="hljs-string">"str"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"repeat"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"crontab"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"once"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">258.5</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">408</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[<span class="hljs-string"><span class="hljs-string">"5afd41b4.d61318"</span></span>]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"ea0e2e99.52a6f8"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"inject"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"topic"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"payload"</span></span>:<span class="hljs-string"><span class="hljs-string">"CLOSED"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"payloadType"</span></span>:<span class="hljs-string"><span class="hljs-string">"str"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"repeat"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"crontab"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"once"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">269</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">459</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[<span class="hljs-string"><span class="hljs-string">"35bac8e.57dd5b8"</span></span>,<span class="hljs-string"><span class="hljs-string">"5afd41b4.d61318"</span></span>]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"4187db59.93c2dc"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"mqtt in"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Hall Light Sensor"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"topic"</span></span>:<span class="hljs-string"><span class="hljs-string">"/myhome/state/Lumin_Hall"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"qos"</span></span>:<span class="hljs-string"><span class="hljs-string">"2"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"broker"</span></span>:<span class="hljs-string"><span class="hljs-string">"bfc8eee2.a46c9"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">243</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">146</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[<span class="hljs-string"><span class="hljs-string">"c94e7c4.849f48"</span></span>]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"c94e7c4.849f48"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"switch"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Light Threshold Selector"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"property"</span></span>:<span class="hljs-string"><span class="hljs-string">"payload"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"propertyType"</span></span>:<span class="hljs-string"><span class="hljs-string">"msg"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"rules"</span></span>:[{<span class="hljs-attr"><span class="hljs-attr">"t"</span></span>:<span class="hljs-string"><span class="hljs-string">"lt"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"v"</span></span>:<span class="hljs-string"><span class="hljs-string">"10"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"vt"</span></span>:<span class="hljs-string"><span class="hljs-string">"num"</span></span>},{<span class="hljs-attr"><span class="hljs-attr">"t"</span></span>:<span class="hljs-string"><span class="hljs-string">"else"</span></span>}],<span class="hljs-attr"><span class="hljs-attr">"checkall"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"outputs"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">517.3333129882812</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">145.7166748046875</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[<span class="hljs-string"><span class="hljs-string">"48e6a07a.962798"</span></span>],[<span class="hljs-string"><span class="hljs-string">"ca8b6623.f11c7"</span></span>]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"381b0d6d.a0bd7a"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"switch"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Light Enabled?"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"property"</span></span>:<span class="hljs-string"><span class="hljs-string">"Light_enabled"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"propertyType"</span></span>:<span class="hljs-string"><span class="hljs-string">"flow"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"rules"</span></span>:[{<span class="hljs-attr"><span class="hljs-attr">"t"</span></span>:<span class="hljs-string"><span class="hljs-string">"eq"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"v"</span></span>:<span class="hljs-string"><span class="hljs-string">"Yes"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"vt"</span></span>:<span class="hljs-string"><span class="hljs-string">"str"</span></span>}],<span class="hljs-attr"><span class="hljs-attr">"checkall"</span></span>:<span class="hljs-string"><span class="hljs-string">"true"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"outputs"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">775.5</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">285</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[<span class="hljs-string"><span class="hljs-string">"d85623d1.29b058"</span></span>]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"48e6a07a.962798"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"change"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Enable Light"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"rules"</span></span>:[{<span class="hljs-attr"><span class="hljs-attr">"t"</span></span>:<span class="hljs-string"><span class="hljs-string">"set"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"p"</span></span>:<span class="hljs-string"><span class="hljs-string">"Light_enabled"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"pt"</span></span>:<span class="hljs-string"><span class="hljs-string">"flow"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"to"</span></span>:<span class="hljs-string"><span class="hljs-string">"Yes"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"tot"</span></span>:<span class="hljs-string"><span class="hljs-string">"str"</span></span>}],<span class="hljs-attr"><span class="hljs-attr">"action"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"property"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"from"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"to"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"reg"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">822</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">109</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"ca8b6623.f11c7"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"change"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Disable Light"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"rules"</span></span>:[{<span class="hljs-attr"><span class="hljs-attr">"t"</span></span>:<span class="hljs-string"><span class="hljs-string">"set"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"p"</span></span>:<span class="hljs-string"><span class="hljs-string">"Light_enabled"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"pt"</span></span>:<span class="hljs-string"><span class="hljs-string">"flow"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"to"</span></span>:<span class="hljs-string"><span class="hljs-string">"No"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"tot"</span></span>:<span class="hljs-string"><span class="hljs-string">"str"</span></span>}],<span class="hljs-attr"><span class="hljs-attr">"action"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"property"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"from"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"to"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"reg"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">824.6666259765625</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">177.51666259765625</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"b6ea27c1.c33cd"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"inject"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"topic"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"payload"</span></span>:<span class="hljs-string"><span class="hljs-string">"Light_enabled"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"payloadType"</span></span>:<span class="hljs-string"><span class="hljs-string">"flow"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"repeat"</span></span>:<span class="hljs-string"><span class="hljs-string">"1"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"crontab"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"once"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">330.5</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">678</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[<span class="hljs-string"><span class="hljs-string">"db66aec8.b3abc"</span></span>]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"db66aec8.b3abc"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"debug"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Light_enabled"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"active"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-attr"><span class="hljs-attr">"console"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"complete"</span></span>:<span class="hljs-string"><span class="hljs-string">"payload"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">670.5</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">679</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"fa4b50b8.e6e0f"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"inject"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"topic"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"payload"</span></span>:<span class="hljs-string"><span class="hljs-string">"5"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"payloadType"</span></span>:<span class="hljs-string"><span class="hljs-string">"num"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"repeat"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"crontab"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"once"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">233.5</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">212</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[<span class="hljs-string"><span class="hljs-string">"c94e7c4.849f48"</span></span>]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"e7b1a39.f9e596"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"inject"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"topic"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"payload"</span></span>:<span class="hljs-string"><span class="hljs-string">"100"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"payloadType"</span></span>:<span class="hljs-string"><span class="hljs-string">"num"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"repeat"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"crontab"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"once"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">235</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">266</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[<span class="hljs-string"><span class="hljs-string">"c94e7c4.849f48"</span></span>]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"4b2f3c6f.de9aac"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"mqtt in"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Hall Motion Sensor"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"topic"</span></span>:<span class="hljs-string"><span class="hljs-string">"/myhome/state/Hall_motion"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"qos"</span></span>:<span class="hljs-string"><span class="hljs-string">"2"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"broker"</span></span>:<span class="hljs-string"><span class="hljs-string">"87b370d1.dd497"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">247</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">334</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[<span class="hljs-string"><span class="hljs-string">"5afd41b4.d61318"</span></span>,<span class="hljs-string"><span class="hljs-string">"35bac8e.57dd5b8"</span></span>]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"e995e130.1e2118"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"mqtt out"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Hall Light Dimmer "</span></span>,<span class="hljs-attr"><span class="hljs-attr">"topic"</span></span>:<span class="hljs-string"><span class="hljs-string">"/myhome/command/Light_Hall/state"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"qos"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"retain"</span></span>:<span class="hljs-string"><span class="hljs-string">"true"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"broker"</span></span>:<span class="hljs-string"><span class="hljs-string">"87b370d1.dd497"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">1310</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">315</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"781e72a7.3c0abc"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"inject"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Reduce Brightness at 21:00"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"topic"</span></span>:<span class="hljs-string"><span class="hljs-string">"Night Brightness"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"payload"</span></span>:<span class="hljs-string"><span class="hljs-string">"1"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"payloadType"</span></span>:<span class="hljs-string"><span class="hljs-string">"str"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"repeat"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"crontab"</span></span>:<span class="hljs-string"><span class="hljs-string">"00 21 * * *"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"once"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">339</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">517</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[<span class="hljs-string"><span class="hljs-string">"adbf1e2e.3f5ae"</span></span>]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"aa444315.a48ad8"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"inject"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Normal Brightness at 6:00"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"topic"</span></span>:<span class="hljs-string"><span class="hljs-string">"Night Brightness"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"payload"</span></span>:<span class="hljs-string"><span class="hljs-string">"50"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"payloadType"</span></span>:<span class="hljs-string"><span class="hljs-string">"num"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"repeat"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"crontab"</span></span>:<span class="hljs-string"><span class="hljs-string">"00 6 * * *"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"once"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">349.6666259765625</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">604.683349609375</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[<span class="hljs-string"><span class="hljs-string">"adbf1e2e.3f5ae"</span></span>]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"adbf1e2e.3f5ae"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"change"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Light Brightness Adjustment"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"rules"</span></span>:[{<span class="hljs-attr"><span class="hljs-attr">"t"</span></span>:<span class="hljs-string"><span class="hljs-string">"set"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"p"</span></span>:<span class="hljs-string"><span class="hljs-string">"Light_brightness"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"pt"</span></span>:<span class="hljs-string"><span class="hljs-string">"flow"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"to"</span></span>:<span class="hljs-string"><span class="hljs-string">"payload"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"tot"</span></span>:<span class="hljs-string"><span class="hljs-string">"msg"</span></span>}],<span class="hljs-attr"><span class="hljs-attr">"action"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"property"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"from"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"to"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"reg"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">692</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">554</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[[]]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"af1f191f.498098"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"debug"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"active"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>,<span class="hljs-attr"><span class="hljs-attr">"console"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"complete"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"x"</span></span>:<span class="hljs-number"><span class="hljs-number">1303.5</span></span>,<span class="hljs-attr"><span class="hljs-attr">"y"</span></span>:<span class="hljs-number"><span class="hljs-number">429</span></span>,<span class="hljs-attr"><span class="hljs-attr">"wires"</span></span>:[]},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"bfc8eee2.a46c9"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"mqtt-broker"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"broker"</span></span>:<span class="hljs-string"><span class="hljs-string">"localhost"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"port"</span></span>:<span class="hljs-string"><span class="hljs-string">"1883"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"clientid"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"usetls"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-attr"><span class="hljs-attr">"verifyservercert"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>,<span class="hljs-attr"><span class="hljs-attr">"compatmode"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>,<span class="hljs-attr"><span class="hljs-attr">"keepalive"</span></span>:<span class="hljs-string"><span class="hljs-string">"60"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"cleansession"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>,<span class="hljs-attr"><span class="hljs-attr">"willTopic"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"willQos"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"willRetain"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>,<span class="hljs-attr"><span class="hljs-attr">"willPayload"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"birthTopic"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"birthQos"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"birthRetain"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>,<span class="hljs-attr"><span class="hljs-attr">"birthPayload"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>},{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"87b370d1.dd497"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"mqtt-broker"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"z"</span></span>:<span class="hljs-string"><span class="hljs-string">"2384634b.17767c"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"broker"</span></span>:<span class="hljs-string"><span class="hljs-string">"localhost"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"port"</span></span>:<span class="hljs-string"><span class="hljs-string">"1883"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"clientid"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"usetls"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-attr"><span class="hljs-attr">"verifyservercert"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>,<span class="hljs-attr"><span class="hljs-attr">"compatmode"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>,<span class="hljs-attr"><span class="hljs-attr">"keepalive"</span></span>:<span class="hljs-string"><span class="hljs-string">"60"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"cleansession"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>,<span class="hljs-attr"><span class="hljs-attr">"willTopic"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"willQos"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"willRetain"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>,<span class="hljs-attr"><span class="hljs-attr">"willPayload"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"birthTopic"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-attr"><span class="hljs-attr">"birthQos"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"birthRetain"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>,<span class="hljs-attr"><span class="hljs-attr">"birthPayload"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>}]
</code></pre><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©sum√©</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, j'ai essay√© de d√©montrer et de dire √† quel point il est facile d'impl√©menter des algorithmes de domotique au quotidien dans un environnement Node-RED. J'ai √©galement essay√© de montrer les principaux avantages de cet environnement de programmation, tels que: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - une repr√©sentation graphique logique des connexions et des fonctions </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - facilit√© de programmation et facilit√© de d√©bogage des scripts utilisateur </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - ind√©pendance du mat√©riel et de la plate-forme des algorithmes r√©sultants - ce script fonctionnera aussi bien avec OpenHAB qu'avec ioBroker et avec toute autre plate-forme de maison intelligente prenant en charge le protocole MQTT. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - facilit√© d'√©change d'algorithmes pr√™ts √† l'emploi entre utilisateurs gr√¢ce au code Copy-Paste JSON et la pr√©sence d'une plateforme en ligne pour l'√©change de solutions performantes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Node-RED peut faire beaucoup plus, par exemple, recevoir la m√©t√©o sur Internet, envoyer des notifications √† Twitter ou utiliser les thermostats Nest. </font><font style="vertical-align: inherit;">Et sur cette base, vous pouvez cr√©er de nombreux autres algorithmes d'automatisation int√©ressants et utiles. </font><font style="vertical-align: inherit;">Mais ce sont des sujets pour les articles suivants.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr396985/">https://habr.com/ru/post/fr396985/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr396975/index.html">Ordinateur dans la voiture, ann√©e 2016</a></li>
<li><a href="../fr396977/index.html">L'intelligence artificielle a des probl√®mes de langage</a></li>
<li><a href="../fr396979/index.html">R√¥le critique: un nouveau regard sur D&D</a></li>
<li><a href="../fr396981/index.html">Le premier robot autonome au monde aliment√© au peroxyde d'hydrog√®ne</a></li>
<li><a href="../fr396983/index.html">Comment je suis devenu radio-amateur et j'ai enregistr√© mon premier RES</a></li>
<li><a href="../fr396987/index.html">Les nanobots intelligents injectent des substances en r√©ponse √† des conditions c√©r√©brales</a></li>
<li><a href="../fr396989/index.html">Syst√®me de ventilation d'alimentation bas√© sur l'unit√© int√©rieure de canal du climatiseur</a></li>
<li><a href="../fr396993/index.html">Projet Wikiverse: visualisation de l'univers d'information de Wikip√©dia</a></li>
<li><a href="../fr396995/index.html">H√©, je suis l√†-bas?</a></li>
<li><a href="../fr396997/index.html">Comment allumer un ordinateur avec un mot de passe? Contournement de mot de passe sous Windows</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>