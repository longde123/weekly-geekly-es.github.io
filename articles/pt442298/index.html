<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍝 🚴🏽 👩🏿‍🎨 Gatsby.js em detalhes 🔱 🍙 👩‍❤️‍💋‍👨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Como você sabe, você não pode ir muito longe em alguns clichês, então você precisa se aprofundar em qualquer tecnologia para aprender a escrever algo ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gatsby.js em detalhes</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442298/"><p><img src="https://habrastorage.org/webt/05/2c/ll/052cllvfmcuw_rru5rhjwhxxqem.jpeg"></p><br><p>  Como você sabe, você não pode ir muito longe em alguns clichês, então você precisa se aprofundar em qualquer tecnologia para aprender a escrever algo que vale a pena.  Este artigo discute os detalhes do <strong>Gatsby.js</strong> , cujo conhecimento permitirá criar e manter sites e blogs complexos. </p><a name="habracut"></a><br><blockquote> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Artigo anterior</a> sobre como criar e publicar um blog pessoal usando JAM-stack </blockquote><p>  Tópicos discutidos abaixo: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Estrutura e roteamento da página</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Componentes, modelos e sua interação</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Trabalhar com dados</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Plugins</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Estilo de aplicativo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Otimização SEO usando react-helmet</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Configuração do PWA</a> </li></ul><br><h2 id="podgotovka">  Preparação </h2><br><div class="spoiler">  <b class="spoiler_title">Instale o Gatsby no PC</b> <div class="spoiler_text"><pre><code class="bash hljs">yarn global add gatsby-cli</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Clonando um projeto mínimo</b> <div class="spoiler_text"><pre> <code class="bash hljs"> npx gatsby new gatsby-tutorial https://github.com/gatsbyjs/gatsby-starter-hello-world <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> gatsby-tutorial</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Inicialização do Repositório</b> <div class="spoiler_text"><pre> <code class="bash hljs"> git init git add . git commit -m <span class="hljs-string"><span class="hljs-string">"init commit"</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Verificação de integridade</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> yarn start</code> </pre> <br><p>  Se não houver erros no console e no navegador ao longo do caminho <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http: // localhost: 8000, você</a> verá "Olá, mundo!"  isso significa que tudo está funcionando corretamente.  Você pode tentar alterar o conteúdo do arquivo <em>/src/pages/index.js</em> para verificar a <em>atualização</em> a quente. </p></div></div><br><h2 id="struktura-stranic-i-routing">  Estrutura e roteamento da página </h2><br><p>  Para criar uma página no Gatsby, basta colocar o novo arquivo na pasta <em>/ src / pages</em> e ele será compilado em uma página HTML separada.  <strong>É importante observar que o caminho para esta página corresponderá ao caminho real com o nome</strong> .  Por exemplo, adicione mais algumas páginas: </p><br><pre> <code class="plaintext hljs">src └── pages ├── about.js ├── index.js └── tutorial ├── part-four.js ├── part-one.js ├── part-three.js ├── part-two.js └── part-zero.js</code> </pre><br><p>  O conteúdo ainda não é importante, portanto, qualquer texto pode ser usado para distinguir entre as páginas. </p><br><pre> <code class="plaintext hljs">import React from "react"; export default () =&gt; &lt;div&gt;Welcome to tutorial/part-one&lt;/div&gt;;</code> </pre> <br><p>  Verifique no navegador: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http: // localhost: 8000 / tutorial / parte um</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http: // localhost: 8000 / sobre</a> </li></ul><br><p>  Dessa maneira, ao estruturar arquivos, você pode resolver imediatamente os problemas de roteamento. </p><br><blockquote>  Há também uma <strong>API createPage</strong> especial com a qual você pode controlar de maneira mais flexível os caminhos e os nomes das páginas, mas para trabalhar com ela, precisamos entender como os dados funcionam no Gatsby, portanto, consideraremos um pouco mais no artigo. </blockquote><p>  Combine as páginas criadas usando os links. Para isso, usamos o componente <code>&lt;Link /&gt;</code> do pacote Gatsby, criado especificamente para navegação interna.  Para todos os links externos, use a tag <code>&lt;a&gt;</code> regular. </p><br><p>  <em>/src/pages/index.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import { Link } from "gatsby"; export default () =&gt; ( &lt;div&gt; &lt;ul&gt; &lt;li&gt; &lt;Link to="/about"&gt;about&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-zero"&gt;Part #0&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-one"&gt;Part #1&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-two"&gt;Part #2&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-three"&gt;Part #3&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-four"&gt;Part #4&lt;/Link&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; );</code> </pre> <br><blockquote>  <code>&lt;Link&gt;</code> oculto possui um mecanismo muito complicado para otimizar o carregamento da página e, portanto, é usado em vez de <code>&lt;a&gt;</code> para navegar no site.  Mais detalhes podem ser encontrados <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . </blockquote><p><img src="https://habrastorage.org/webt/no/ev/fj/noevfjkjdbel6tonxughcn6mkfq.gif" alt="navegação"></p><br><p>  As páginas são criadas, os links são adicionados, e a navegação está concluída. </p><br><h2 id="komponenty-shablony-i-ih-vzaimodeystvie">  Componentes, modelos e sua interação </h2><br><p>  Como você sabe, em qualquer projeto sempre há elementos repetidos; para sites, é um cabeçalho, rodapé, barra de navegação.  Além disso, as páginas, independentemente do conteúdo, são criadas de acordo com uma certa estrutura e, como o <strong>Gatsby</strong> é um compilador do <strong>React</strong> , a mesma abordagem de componente é usada para resolver esses problemas. </p><br><p>  Crie os componentes para o cabeçalho e o painel de navegação: </p><br><p>  <em>/src/components/header.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import { Link } from "gatsby"; /** *         *  ,     React-. *      ,    *  " ".     *    ""  GraphQL  gatsby- */ import logoSrc from "../images/logo.png"; export default () =&gt; ( &lt;header&gt; &lt;Link to="/"&gt; &lt;img src={logoSrc} alt="logo" width="60px" height="60px" /&gt; &lt;/Link&gt; That is header &lt;/header&gt; );</code> </pre> <br><p>  <em>/src/components/sidebar.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import { Link } from "gatsby"; export default () =&gt; ( &lt;div&gt; &lt;ul&gt; &lt;li&gt; &lt;Link to="/about"&gt;about&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-zero"&gt;Part #0&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-one"&gt;Part #1&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-two"&gt;Part #2&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-three"&gt;Part #3&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-four"&gt;Part #4&lt;/Link&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; );</code> </pre> <br><p>  e adicione-os a <em>/src/pages/index.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import Header from "../components/header"; import Sidebar from "../components/sidebar"; export default () =&gt; ( &lt;div&gt; &lt;Header /&gt; &lt;Sidebar /&gt; &lt;h1&gt;Index page&lt;/h1&gt; &lt;/div&gt; );</code> </pre> <br><p>  Verificamos: </p><br><p><img src="https://habrastorage.org/webt/bg/l6/jn/bgl6jndogi4j0qzvm9q0jvsiglk.jpeg" alt="index_page"></p><br><p>  Tudo funciona, mas precisamos importar o cabeçalho e a barra lateral em cada página separadamente, o que não é muito conveniente. Para resolver esse problema, basta criar um componente de layout e agrupar cada página. </p><br><blockquote>  Layout de Gatsby == reagir contêiner <br>  <em>sim, não é uma igualdade estrita, porque é "quase" a mesma coisa</em> </blockquote><p>  <em>/src/components/layout.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import Header from "./header"; import Sidebar from "./sidebar"; export default ({ children }) =&gt; ( &lt;&gt; &lt;Header /&gt; &lt;div style={{ margin: `0 auto`, maxWidth: 650, backgroundColor: `#eeeeee` }} &gt; &lt;Sidebar /&gt; {children} &lt;/div&gt; &lt;/&gt; );</code> </pre> <br><p>  <em>/src/pages/index.js</em> (e todas as outras páginas) </p><br><pre> <code class="plaintext hljs">import React from "react"; import Layout from "../components/layout"; export default () =&gt; ( &lt;Layout&gt; &lt;h1&gt;Index page&lt;/h1&gt; &lt;/Layout&gt; );</code> </pre> <br><p>  Feito, olhe para o navegador: </p><br><p><img src="https://habrastorage.org/webt/9p/9v/wo/9p9vwogkf2px--00mtzbgz2ke64.gif" alt="disposição"></p><br><blockquote>  Por que o projeto tem todos os nomes de arquivo com uma letra minúscula?  Para começar, vamos determinar que o namespace para <strong>React</strong> vem do fato de "todo arquivo é uma classe e a classe sempre é maiúscula".  No <strong>Gatsby, os</strong> arquivos ainda contêm classes, mas existe um "mas" - "cada arquivo é uma página em potencial e seu nome é o URL dessa página".  A comunidade chegou à conclusão de que links como <code>http://domain.com/User/Settings</code> não são <em>comme-il-faut</em> e kebab-case aprovado para nomes de arquivos. </blockquote><br><div class="spoiler">  <b class="spoiler_title">Estrutura de arquivo</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> src ├── components │ ├── header.js │ ├── layout.js │ └── sidebar.js ├── images │ └── logo.png └── pages ├── about.js ├── index.js └── tutorial ├── part-eight.js ├── part-five.js ├── part-four.js ├── part-one.js ├── part-seven.js ├── part-six.js ├── part-three.js ├── part-two.js └── part-zero.js</code> </pre> </div></div><br><h2 id="rabota-s-dannymi">  Trabalhar com dados </h2><br><p>  Agora que a estrutura do site está pronta, você pode prosseguir para o preenchimento do conteúdo.  A abordagem clássica de "código rígido" não se adequava aos criadores da pilha JAM, além de "renderizar conteúdo de solicitações AJAX" e, portanto, sugeriram preencher os sites com conteúdo em tempo de compilação.  No caso do <strong>Gatsby</strong> , o <strong>GraphQL</strong> é responsável por isso, o que facilita o trabalho com fluxos de dados de qualquer fonte. </p><br><blockquote>  É impossível falar sobre o GraphQL em poucas palavras, por isso é aconselhável estudá-lo você mesmo ou aguardar meu próximo artigo.  Você pode ler mais sobre como trabalhar com o GraphQL <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . </blockquote><p>  Para trabalhar com o <strong>GraphQL</strong> , a partir da segunda versão, o pacote <code>gatsby</code> possui um componente <code>gatsby</code> que pode ser usado nas páginas e em componentes simples, e essa é sua principal diferença em relação à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">consulta da página anterior</a> .  Até o momento, nosso site não está conectado a nenhuma fonte de dados, portanto, tentemos exibir os metadados da página, por exemplo, e depois passar para coisas mais complexas. </p><br><p>  Para criar uma <code>query</code> é necessário abrir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http: // localhost: 8000 / ___ graphql</a> e usar a barra lateral com a documentação para encontrar os dados disponíveis sobre o site e não se esqueça do preenchimento automático. </p><br><p><img src="https://habrastorage.org/webt/qw/im/yd/qwimydi9eummj2mlkdpuzxdlg_0.gif" alt="graphql"></p><br><p>  <em>/src/components/sidebar.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import { Link, StaticQuery, graphql } from "gatsby"; export default () =&gt; ( &lt;StaticQuery query={graphql` { allSitePage { edges { node { id path } } } } `} render={({ allSitePage: { edges } }) =&gt; ( &lt;ul&gt; {edges.map(({ node: { id, path } }) =&gt; ( &lt;li key={id}&gt; &lt;Link to={path}&gt;{id}&lt;/Link&gt; &lt;/li&gt; ))} &lt;/ul&gt; )} /&gt; );</code> </pre> <br><p>  Agora, usando a <code>query</code> obtemos dados sobre as páginas que renderizamos no painel de navegação e não precisamos nos preocupar com o fato de o link não corresponder ao nome, porque todos os dados são coletados automaticamente. </p><br><p><img src="https://habrastorage.org/webt/nc/pk/6l/ncpk6l8hirx9guim5am6ikgpfvo.jpeg" alt="queried_navigation_panel"></p><br><p>  De fato, esses são todos os dados que podem estar em nosso site sem o uso de plug-ins de terceiros e sem o bom e antigo "hardcode"; portanto, passamos sem problemas ao próximo tópico do nosso artigo - plugins. </p><br><h2 id="plaginy">  Plugins </h2><br><p>  Na sua essência, Gatsby é um compilador com um monte de guloseimas, que são plugins.  Utilizando-os, você pode personalizar o processamento de determinados arquivos, tipos de dados e vários formatos. </p><br><p>  Crie o arquivo <em>/gatsby-config.js</em> no nível raiz do aplicativo.  responsável pela configuração do compilador como um todo e tente configurar o primeiro plug-in para trabalhar com arquivos: </p><br><p>  Instalação do plugin: </p><br><pre> <code class="bash hljs">yarn add gatsby-source-filesystem</code> </pre> <br><p>  Configuração no arquivo <em>/gatsby-config.js:</em> </p><br><pre> <code class="plaintext hljs">module.exports = { plugins: [ { resolve: `gatsby-source-filesystem`, options: { name: `images`, path: `${__dirname}/src/images/`, } } ], }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Mais detalhes sobre o arquivo acima</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> /** * gatsby-config.js     *     JS *     */ module.exports = { /** *  'plugins'  pipeline  * ,      */ plugins: [ /** *        , *         */ `gatsby-example-plugin`, { resolve: `gatsby-source-filesystem`, options: { name: `images`, path: `${__dirname}/src/images/`, } } ], }</code> </pre> </div></div><br><p>  Lembra-se de que conversamos sobre a importação "correta" de imagens para o <strong>Gatsby</strong> ? </p><br><p>  <em>/src/components/header.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import { Link, StaticQuery, graphql } from "gatsby"; export default () =&gt; ( &lt;StaticQuery query={graphql` { allFile(filter: { name: { eq: "logo" } }) { edges { node { publicURL } } } } `} render={({ allFile: { edges: [ { node: { publicURL } } ] } }) =&gt; ( &lt;header&gt; &lt;Link to="/"&gt; &lt;img src={publicURL} alt="logo" width="60px" height="60px" /&gt; &lt;/Link&gt; That is header &lt;/header&gt; )} /&gt; );</code> </pre> <br><p>  Nada mudou no site, mas agora a imagem é substituída usando o GraphQL, em vez de uma simples importação de webpack.  À primeira vista, pode parecer que os designs são muito complexos e foram gestos desnecessários, mas não vamos tirar conclusões precipitadas, porque a coisa está nos mesmos plugins.  Por exemplo, se decidíssemos postar milhares de fotos no site, em qualquer caso, teríamos que pensar em otimizar o carregamento de todo o conteúdo e, para não criar nosso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">processo de carregamento lento a</a> partir do zero, basta adicionar um plug <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">-</a> in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gatsby-image</a> que otimize o carregamento de todos imagens importadas usando a <code>query</code> . </p><br><p>  Instalando plug-ins para estilizar: </p><br><pre> <code class="bash hljs">yarn add gatsby-plugin-typography react-typography typography typography-theme-noriega node-sass gatsby-plugin-sass gatsby-plugin-styled-components styled-components babel-plugin-styled-components</code> </pre> <br><p>  <em>gatsby-config.js</em> </p><br><pre> <code class="plaintext hljs">module.exports = { plugins: [ { resolve: `gatsby-source-filesystem`, options: { name: `images`, path: `${__dirname}/src/images/` } }, // add style plugins below `gatsby-plugin-typography`, `gatsby-plugin-sass`, `gatsby-plugin-styled-components` ] };</code> </pre> <br><blockquote>  No <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">site oficial,</a> você pode encontrar um plugin para todos os gostos. </blockquote><br><h2 id="stilizaciya-prilozheniya">  Estilo de aplicativo </h2><br><p>  Vamos começar a estilizar o aplicativo usando várias abordagens.  Na etapa anterior, já instalamos plug-ins para trabalhar com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SASS</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">os componentes com estilo</a> e a biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">typography.js</a> , embora seja importante observar que o css.modules é suportado imediatamente. </p><br><p>  Vamos começar com os estilos globais, que, como outras coisas relacionadas ao site inteiro, devem ser configurados no arquivo <em>/gatsby-browser.js</em> : </p><br><pre> <code class="plaintext hljs">import "./src/styles/global.scss";</code> </pre> <br><blockquote>  Mais sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gatsby-browser.js</a> </blockquote><p>  <em>/src/styles/global.scss</em> </p><br><pre> <code class="plaintext hljs">body { background-color: lavenderblush; }</code> </pre> <br><p>  Por várias razões, as tendências dos últimos anos estão inclinadas para a abordagem "CSS em JS", portanto você não deve abusar dos estilos globais e é melhor limitar-se a indicar a fonte e as classes reutilizadas.  Este projeto em particular planeja usar o <strong>Typography.js</strong> para esses fins, para que os estilos globais permaneçam vazios. </p><br><p>  Você pode ter notado alterações na aparência do site após adicionar a <code>gatsby-plugin-typography</code> à configuração - isso ocorre porque a predefinição padrão foi aplicada e agora vamos configurá-la por nós mesmos. </p><br><p>  <em>/src/utils/typography.js</em> </p><br><pre> <code class="plaintext hljs">import Typography from "typography"; import theme from "typography-theme-noriega"; const typography = new Typography(theme); export default typography;</code> </pre> <br><blockquote>  Você pode selecionar qualquer outra predefinição da <a href="">lista</a> ou criar sua própria usando a API do pacote ( <a href="">exemplo da</a> configuração do site oficial do Gatsby) </blockquote><p>  <em>/gatsby-config.js</em> </p><br><pre> <code class="plaintext hljs">module.exports = { plugins: [ { resolve: `gatsby-source-filesystem`, options: { name: `images`, path: `${__dirname}/src/images/` } }, { resolve: `gatsby-plugin-typography`, options: { pathToConfigModule: `src/utils/typography` } }, `gatsby-plugin-sass`, `gatsby-plugin-styled-components` ] };</code> </pre> <br><p>  E, dependendo da predefinição selecionada, o estilo global do site será alterado.  Decida qual abordagem definir estilos globais para si mesmo, é uma questão de preferências e diferenças pessoais do ponto de vista técnico, mas passamos aos componentes de estilo usando componentes de <strong>estilo</strong> : </p><br><p>  Adicione um arquivo com variáveis ​​globais <em>/src/utils/vars.js</em> </p><br><pre> <code class="plaintext hljs">export const colors = { main: `#663399`, second: `#fbfafc`, main50: `rgba(102, 51, 153, 0.5)`, second50: `rgba(251, 250, 252, 0.5)`, textMain: `#000000`, textSecond: `#ffffff`, textBody: `#222222` };</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">/src/components/header.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> import React from "react"; import { Link, StaticQuery, graphql } from "gatsby"; import styled from "styled-components"; import { colors } from "../utils/vars"; const Header = styled.header` width: 100%; height: 3em; display: flex; justify-content: space-between; align-items: center; background-color: ${colors.main}; color: ${colors.textSecond}; padding: 0.5em; `; const Logo = styled.img` border-radius: 50%; height: 100%; `; const logoLink = `height: 100%;`; export default () =&gt; ( &lt;StaticQuery query={graphql` { allFile(filter: { name: { eq: "logo" } }) { edges { node { publicURL } } } } `} render={({ allFile: { edges: [ { node: { publicURL } } ] } }) =&gt; ( &lt;Header&gt; That is header &lt;Link to="/" css={logoLink}&gt; &lt;Logo src={publicURL} alt="logo" /&gt; &lt;/Link&gt; &lt;/Header&gt; )} /&gt; );</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">/src/components/sidebar.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> import React from "react" import { Link, StaticQuery, graphql } from "gatsby" import styled from "styled-components" import { colors } from "../utils/vars" const Sidebar = styled.section` position: fixed; left: 0; width: 20%; height: 100%; display: flex; flex-direction: column; justify-content: center; background-color: ${colors.second}; color: ${colors.textMain}; ` const navItem = ` display: flex; align-items: center; margin: 0 1em 0 2em; padding: 0.5em 0; border-bottom: 0.05em solid ${colors.mainHalf}; postion: relative; color: ${colors.textBody}; text-decoration: none; &amp;:before { content: ''; transition: 0.5s; width: 0.5em; height: 0.5em; position: absolute; left: 0.8em; border-radius: 50%; display: block; background-color: ${colors.main}; transform: scale(0); } &amp;:last-child { border-bottom: none; } &amp;:hover { &amp;:before { transform: scale(1); } } ` export default () =&gt; ( &lt;StaticQuery query={graphql` { allSitePage { edges { node { id, path } } } } `} render={({ allSitePage: { edges } }) =&gt; ( &lt;Sidebar&gt; { edges.map(({ node: { id, path } }) =&gt; ( &lt;Link to={path} key={id} css={navItem} &gt;{id}&lt;/Link&gt; )) } &lt;/Sidebar&gt; )} /&gt; )</code> </pre> </div></div><br><p><img src="https://habrastorage.org/webt/qf/1w/i6/qf1wi6f95fjjjx794g8qvujbksw.gif" alt="estilizado"></p><br><p>  Os elementos já existentes são estilizados e é hora de associar o conteúdo ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Contentful</a> , conectar o plug-in de margem e gerar páginas usando a <strong>API createPages</strong> . </p><br><blockquote>  Leia mais sobre como vincular Gatsby e Contentful em um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo anterior.</a> </blockquote><br><div class="spoiler">  <b class="spoiler_title">Estrutura dos meus dados com Contentful</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> [ { "id": "title", "type": "Symbol" }, { "id": "content", "type": "Text", }, { "id": "link", "type": "Symbol", }, { "id": "orderNumber", "type": "Integer", } ]</code> </pre> </div></div><br><p>  Instalação do pacote: </p><br><pre> <code class="bash hljs">yarn add dotenv gatsby-source-contentful gatsby-transformer-remark</code> </pre> <br><p>  <em>/gatsby-config.js</em> </p><br><pre> <code class="plaintext hljs">if (process.env.NODE_ENV === "development") { require("dotenv").config(); } module.exports = { plugins: [ `gatsby-transformer-remark`, { resolve: `gatsby-source-filesystem`, options: { name: `images`, path: `${__dirname}/src/images/`, } }, { resolve: `gatsby-plugin-typography`, options: { pathToConfigModule: `src/utils/typography`, }, }, { resolve: `gatsby-source-contentful`, options: { spaceId: process.env.CONTENTFUL_SPACE_ID, accessToken: process.env.CONTENTFUL_ACCESS_TOKEN, }, }, `gatsby-plugin-sass`, `gatsby-plugin-styled-components`, ], }</code> </pre> <br><p>  Exclua a pasta <em>/ src / pages</em> com todos os arquivos internos e crie um novo arquivo para gerenciar os nós no Gatsby: </p><br><p>  <em>/gatsby-node.js</em> </p><br><pre> <code class="plaintext hljs">const path = require(`path`); /** *  ,      *       */ exports.createPages = ({ graphql, actions }) =&gt; { /** *        *        *    */ const { createPage } = actions; return graphql(` { allContentfulArticle { edges { node { title link content { childMarkdownRemark { html } } } } } } `).then(({ data: { allContentfulArticle: { edges } } }) =&gt; { /** *       *  createPage()    *      */ edges.forEach(({ node }) =&gt; { createPage({ path: node.link, component: path.resolve(`./src/templates/index.js`), context: { slug: node.link } }); }); }); };</code> </pre> <br><blockquote>  Mais sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gatsby-node.js</a> </blockquote><p>  Crie um arquivo de modelo que será a base para as páginas geradas <br>  <em>/src/templates/index.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import { graphql } from "gatsby"; import Layout from "../components/layout"; export default ({ data: { allContentfulArticle: { edges: [ { node: { content: { childMarkdownRemark: { html } } } } ] } } }) =&gt; { return ( &lt;Layout&gt; &lt;div dangerouslySetInnerHTML={{ __html: html }} /&gt; &lt;/Layout&gt; ); }; export const query = graphql` query($slug: String!) { allContentfulArticle(filter: { link: { eq: $slug } }) { edges { node { title link content { childMarkdownRemark { html } } } } } } `;</code> </pre> <br><blockquote>  Por que o componente <code>&lt;StaticQuery /&gt;</code> não é usado aqui?  O fato é que ele não suporta variáveis ​​para construir uma solicitação, mas precisamos usar a variável <code>$slug</code> no contexto da página. </blockquote><br><div class="spoiler">  <b class="spoiler_title">Atualizando a lógica na barra de navegação</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> import React from "react"; import { Link, StaticQuery, graphql } from "gatsby"; import styled from "styled-components"; import { colors } from "../utils/vars"; const Sidebar = styled.section` position: fixed; left: 0; width: 20%; height: 100%; display: flex; flex-direction: column; justify-content: center; background-color: ${colors.second}; color: ${colors.textMain}; `; const navItem = ` display: flex; align-items: center; margin: 0 1em 0 2em; padding: 0.5em 0; border-bottom: 0.05em solid ${colors.main50}; postion: relative; color: ${colors.textBody}; text-decoration: none; &amp;:before { content: ''; transition: 0.5s; width: 0.5em; height: 0.5em; position: absolute; left: 0.8em; border-radius: 50%; display: block; background-color: ${colors.main}; transform: scale(0); } &amp;:last-child { border-bottom: none; } &amp;:hover { &amp;:before { transform: scale(1); } } `; export default () =&gt; ( &lt;StaticQuery query={graphql` { allContentfulArticle(sort: { order: ASC, fields: orderNumber }) { edges { node { title link orderNumber } } } } `} render={({ allContentfulArticle: { edges } }) =&gt; ( &lt;Sidebar&gt; {edges.map(({ node: { title, link, orderNumber } }) =&gt; ( &lt;Link to={link} key={link} css={navItem}&gt; {orderNumber}. {title} &lt;/Link&gt; ))} &lt;/Sidebar&gt; )} /&gt; );</code> </pre> </div></div><br><p><img src="https://habrastorage.org/webt/fn/bc/fs/fnbcfsl-qbdzkh1murfclmr7itk.gif" alt="dados"></p><br><h2 id="seo-optimizaciya">  Otimização SEO </h2><br><p>  No lado técnico, o site pode ser considerado pronto, então vamos trabalhar com seus metadados.  Para fazer isso, precisamos dos seguintes plugins: </p><br><pre> <code class="bash hljs">yarn add gatsby-plugin-react-helmet react-helmet</code> </pre> <br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O react-helmet</a> gera <code>&lt;head&gt;...&lt;/head&gt;</code> para páginas HTML e, em conjunto com a renderização de Gatsby, é uma ferramenta poderosa e conveniente para trabalhar com SEO. </blockquote><p>  <em>/src/templates/index.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import { graphql } from "gatsby"; import { Helmet } from "react-helmet"; import Layout from "../components/layout"; export default ({ data: { allContentfulArticle: { edges: [ { node: { title, content: { childMarkdownRemark: { html } } } } ] } } }) =&gt; { return ( &lt;Layout&gt; &lt;Helmet&gt; &lt;meta charSet="utf-8" /&gt; &lt;title&gt;{title}&lt;/title&gt; &lt;/Helmet&gt; &lt;div dangerouslySetInnerHTML={{ __html: html }} /&gt; &lt;/Layout&gt; ); }; export const query = graphql` query($slug: String!) { allContentfulArticle(filter: { link: { eq: $slug } }) { edges { node { title link content { childMarkdownRemark { html } } } } } } `;</code> </pre> <br><p>  Agora, o <code>title</code> site sempre corresponderá ao título do artigo, o que afetará significativamente a emissão do site nos resultados da pesquisa especificamente para esse problema.  Aqui você pode adicionar facilmente <code>&lt;meta name="description" content=" "&gt;</code> com uma descrição de cada artigo separadamente, permitindo assim ao usuário entender sobre o que é o artigo na página de pesquisa, em geral, todos os recursos de SEO agora estão disponíveis e gerenciáveis um lugar. </p><br><p><img src="https://habrastorage.org/webt/_7/l2/ht/_7l2hthmllnqdgycorxhaz2v_mw.png" alt="seo"></p><br><h2 id="nastroyka-pwa">  Configuração do PWA </h2><br><p>  <strong>O Gatsby foi</strong> projetado para oferecer desempenho de primeira classe imediatamente.  Ele cuida dos problemas de separação e minimização de código, além da otimização na forma de pré-carregamento em segundo plano, processamento de imagens etc., para que o site que você cria tenha alto desempenho sem nenhuma configuração manual.  Esses recursos de desempenho são uma parte importante do suporte a uma abordagem progressiva de aplicativos da web. </p><br><p>  Mas, além de tudo isso, existem três critérios básicos para um site que o define como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PWA</a> : </p><br><ul><li>  protocolo https </li><li>  presença de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">manifest.json</a> </li><li>  acesso offline ao site devido a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">funcionários de serviço</a> </li></ul><br><p>  O primeiro ponto não pode ser resolvido pelo Gatsby, já que o <em>domínio</em> , a <em>hospedagem</em> e o <em>protocolo</em> são problemas de implantação e não de desenvolvimento, mas posso recomendar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Netlify</a> , que resolve o problema do https por padrão. </p><br><p>  Passamos para os itens restantes, para isso instalaremos dois plugins: </p><br><pre> <code class="bash hljs">yarn add gatsby-plugin-manifest gatsby-plugin-offline</code> </pre> <br><p>  e configure-os <em>/src/gatsby-config.js</em> </p><br><pre> <code class="plaintext hljs">if (process.env.NODE_ENV === "development") { require("dotenv").config(); } module.exports = { plugins: [ { resolve: `gatsby-plugin-manifest`, options: { name: `GatsbyJS translated tutorial`, short_name: `GatsbyJS tutorial`, start_url: `/`, background_color: `#f7f0eb`, theme_color: `#a2466c`, display: `standalone`, icon: `public/favicon.ico`, include_favicon: true } }, `gatsby-plugin-offline`, `gatsby-transformer-remark`, { resolve: `gatsby-source-filesystem`, options: { name: `images`, path: `${__dirname}/src/images/` } }, { resolve: `gatsby-plugin-typography`, options: { pathToConfigModule: `src/utils/typography` } }, { resolve: `gatsby-source-contentful`, options: { spaceId: process.env.CONTENTFUL_SPACE_ID, accessToken: process.env.CONTENTFUL_ACCESS_TOKEN } }, `gatsby-plugin-sass`, `gatsby-plugin-styled-components`, `gatsby-plugin-react-helmet` ] };</code> </pre> <br><p>  Você pode personalizar seu manifesto usando a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documentação</a> , bem como personalizar a estratégia de trabalhadores de serviço, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">substituindo as configurações do plug-in</a> . </p><br><p>  Você não notará nenhuma alteração no modo de desenvolvimento, mas o site já atende aos requisitos mais recentes do mundo da web e, quando está hospedado no domínio https: //, não será igual. </p><br><h2 id="vyvod">  Conclusão </h2><br><p>  Alguns anos atrás, quando eu encontrei problemas ao trazer o aplicativo React para a Internet, apoiá-lo e atualizar o conteúdo, não conseguia imaginar que já existia uma abordagem de pilha JAM no mercado que simplifica todos esses processos e agora não vou me surpreender com isso. simplicidade.  Gatsby resolve a maioria dos problemas que afetam o desempenho do site apenas "pronto para uso" e, se você entender um pouco mais sobre os meandros de personalizá-lo para suas necessidades, poderá obter indicadores 100% para todos os itens do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Lighthouse</a> , o que afeta significativamente a entrega do site nos mecanismos de pesquisa (por pelo menos no Google). </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Repositório com projeto</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt442298/">https://habr.com/ru/post/pt442298/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt442286/index.html">Oftalmologistas russos falaram sobre visão biônica. O novo aplicativo móvel demonstra o trabalho de cyber</a></li>
<li><a href="../pt442288/index.html">Radiação: fontes</a></li>
<li><a href="../pt442290/index.html">Fazendo o ST-Link V2.1 a partir do chinês ST-Link V2</a></li>
<li><a href="../pt442292/index.html">Estágio Sberseasons: Python, UX / UI, dados e muito mais para estudantes</a></li>
<li><a href="../pt442294/index.html">O que Oleg Artamonov está um pouco errado</a></li>
<li><a href="../pt442300/index.html">Olho e ouço onde quero. Integrando o Chromecast em um aplicativo Android</a></li>
<li><a href="../pt442304/index.html">Smartphones dobráveis: e os aplicativos?</a></li>
<li><a href="../pt442306/index.html">Como vender um git para outro git</a></li>
<li><a href="../pt442310/index.html">Firmware Sonoff Basic via Raspberry Pi</a></li>
<li><a href="../pt442312/index.html">DoT para distribuição RPZ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>