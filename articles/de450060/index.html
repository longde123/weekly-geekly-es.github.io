<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥈 🤰🏿 🤮 Wie ich herausfand, dass mein Visum noch nicht fertig ist, eine Nachricht in Slack 🏦 👩‍🏭 🧒🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Fasten für die Maiferien. Vor 6 Wochen habe ich ein Visum für Irland beantragt. Die Abreise ist für den 30. April geplant. Es gibt eine Botschaftswebs...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie ich herausfand, dass mein Visum noch nicht fertig ist, eine Nachricht in Slack</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/newprolab/blog/450060/"><p>  Fasten für die Maiferien.  Vor 6 Wochen habe ich ein Visum für Irland beantragt.  Die Abreise ist für den 30. April geplant.  Es gibt eine Botschaftswebsite, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">auf der Listen</a> mit Visumentscheidungen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">veröffentlicht werden</a> .  Sie tun dies montags und donnerstags.  Und hier sitze ich am Sonntag, 28. April, es gibt noch keine Lösung für mein Visum.  Und meine weiteren Maßnahmen am Montag hängen davon ab, ob meine Erklärung im neuen Bericht enthalten sein wird oder nicht.  Wenn nicht, müssen Sie zur Botschaft gehen und das klären.  Wenn ja, ziehen Sie das Visumzentrum.  Das Sitzen und Aktualisieren der Seite den ganzen Tag am Montag schien ein langweiliger Zeitvertreib zu sein, also schrieb ich ein Python-Skript. </p><br><p><img src="https://habrastorage.org/webt/gz/a6/ec/gza6ecxqgxhhjcyjbyho7h3nd-a.jpeg"></p><br><p>  Haftungsausschluss.  Ich bin kein Programmierer, aber ich kann programmieren.  Dies bedeutet, dass ich keinen eleganten und effizienten Code schreiben kann, aber ich kann diese Drehorgel dazu bringen, das zu tun, was ich brauche. </p><a name="habracut"></a><br><h3 id="1-proverka-stranicy-na-nalichie-novogo-otcheta">  1. Überprüfen Sie die Seite auf einen neuen Bericht </h3><br><p>  Was muss also getan werden: </p><br><ol><li>  Sie müssen diese Seite analysieren. </li><li> Suchen Sie unter den Berichten einen neuen nach einem neuen Datum (in meinem Fall können Sie nach dem Wort <code>24 April</code> suchen). </li><li>  Holen Sie sich einen Link zu diesem Bericht. </li></ol><br><p>  Der Funktionscode lautet wie folgt: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">check_report</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(url, div_class, date)</span></span></span><span class="hljs-function">:</span></span> embassy_page = requests.get(url) page_text = BeautifulSoup(embassy.text, <span class="hljs-string"><span class="hljs-string">'lxml'</span></span>) tags = page_text.findAll(<span class="hljs-string"><span class="hljs-string">'div'</span></span>, {<span class="hljs-string"><span class="hljs-string">"class"</span></span>: div_class}) text = <span class="hljs-string"><span class="hljs-string">''</span></span> report_url = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> tag <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tags: tag_soup = BeautifulSoup(tag.text, <span class="hljs-string"><span class="hljs-string">'lxml'</span></span>) report = s(text=re.compile(date)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(report) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>: text = <span class="hljs-string"><span class="hljs-string">'New report published'</span></span> report_url = <span class="hljs-string"><span class="hljs-string">'https://www.dfa.ie'</span></span> + tag.find(<span class="hljs-string"><span class="hljs-string">'a'</span></span>).attrs[<span class="hljs-string"><span class="hljs-string">'href'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> text, report_url</code> </pre> <br><p>  Nun mehr darüber, was in diesem Code passiert. </p><br><p>  Zunächst verwenden wir die <code>requests</code> , mit deren Hilfe wir die erforderliche Seite herunterladen können.  Dann verwenden wir eine andere <code>BeautifulSoup</code> Bibliothek, mit deren Hilfe dieses wilde Seitenlayout schöner und bequemer gestaltet werden kann. </p><br><p>  Vor der Verwendung von <code>BeautifulSoup</code> : </p><br><pre> <code class="html hljs xml">'<span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span>\r\n\r\n<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span>\r\n <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span>\r\n <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">META</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"X-UA-Compatible"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"IE=edge"</span></span></span><span class="hljs-tag">&gt;</span></span>\r\n <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Content-Type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html; charset=UTF-8"</span></span></span><span class="hljs-tag">&gt;</span></span>\t\r\n\t<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewport"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"initial-scale=1"</span></span></span><span class="hljs-tag">&gt;</span></span>\r\n \r\n \r\n \r\n \r\n \r\n <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Static Meta data --&gt;</span></span>\r\n \r\n\t<span class="hljs-comment"><span class="hljs-comment">&lt;!-- &lt;meta name="DC.Creator" content="Department of Foreign Affairs" /&gt;\r\n\t&lt;meta name="DC.Publisher" content="Department of Foreign Affairs" /&gt; \r\n\t&lt;meta name="DC.Format" content="text/xhtml" /&gt; \r\n\t&lt;meta name="DC.Copyright" content="All material (c) copyright 2012 Department of Foreign Affairs" /&gt; \r\n\t&lt;meta name="DC.Source" content="Department of Foreign Affairs" /&gt; \r\n\t&lt;meta name="DC.Language" content="en" /&gt;\r\n\t&lt;meta name="DC.Author" content="Department of Foreign Affairs" /&gt; --&gt;</span></span>\r\n\r\n\r\n<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"author"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Department of Foreign Affairs"</span></span></span><span class="hljs-tag">&gt;</span></span>\r\n<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"google-site-verification"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HHtulupgM8GXpd9YYDjoXUb6MiU7_mGTkHixUrVPFYQ"</span></span></span><span class="hljs-tag"> /&gt;</span></span>\r\n \r\n\t<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Weekly Decision Report - Department of Foreign Affairs and Trade<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>\r\n <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> /&gt;</span></span> \r\n <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">media</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"screen"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/media/dfa-2017/style-assets/css/font-defs.css"</span></span></span><span class="hljs-tag"> /&gt;</span></span>\t<span class="hljs-comment"><span class="hljs-comment">&lt;!-- 2017 font-defs.css --&gt;</span></span> \r\n\t<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">media</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"screen"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/media/dfa-2017/style-assets/css/style.css"</span></span></span><span class="hljs-tag"> /&gt;</span></span>\t<span class="hljs-comment"><span class="hljs-comment">&lt;!-- 2017 style.css --&gt;</span></span>\r\n <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">media</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"print"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/media/dfa-2017/style-assets/css/print.css"</span></span></span><span class="hljs-tag"> /&gt;</span></span>\t<span class="hljs-comment"><span class="hljs-comment">&lt;!-- 2017 print.css --&gt;</span></span>\r\n</code> </pre> <br><p>  Nachher: </p><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"IE=edge"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"X-UA-Compatible"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html; charset=utf-8"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Content-Type"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"initial-scale=1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewport"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Static Meta data --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- &lt;meta name="DC.Creator" content="Department of Foreign Affairs" /&gt; &lt;meta name="DC.Publisher" content="Department of Foreign Affairs" /&gt; &lt;meta name="DC.Format" content="text/xhtml" /&gt; &lt;meta name="DC.Copyright" content="All material (c) copyright 2012 Department of Foreign Affairs" /&gt; &lt;meta name="DC.Source" content="Department of Foreign Affairs" /&gt; &lt;meta name="DC.Language" content="en" /&gt; &lt;meta name="DC.Author" content="Department of Foreign Affairs" /&gt; --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Department of Foreign Affairs"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"author"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HHtulupgM8GXpd9YYDjoXUb6MiU7_mGTkHixUrVPFYQ"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"google-site-verification"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Weekly Decision Report - Department of Foreign Affairs and Trade<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/media/dfa-2017/style-assets/css/font-defs.css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">media</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"screen"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- 2017 font-defs.css --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/media/dfa-2017/style-assets/css/style.css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">media</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"screen"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- 2017 style.css --&gt;</span></span></code> </pre> <br><p>  Jetzt können Sie irgendwie damit leben und arbeiten.  In meinem Fall werden wir insbesondere nach einer speziellen <code>div class</code> suchen, die für Links zu Berichten verwendet wird.  Wir sehen dies aus dem Quellcode der Seite: <code>&lt;div class="gen-content-landing__block"&gt;</code> .  In meinem Code suchen wir nach all diesen Tags. </p><br><p>  Gehen Sie als Nächstes die gesammelten Tags durch und suchen Sie nach dem Tag, der das Datum des neuen Berichts enthält: <code>24 April</code> .  Wenn ein solches Ergebnis gefunden wird, extrahieren wir den Link daraus und bilden den Text, dass ein neuer Bericht veröffentlicht wurde. </p><br><h3 id="2-poisk-id-vizy-v-novom-otchete">  2. Suchen Sie in einem neuen Bericht nach einer Visa-ID </h3><br><p>  Was muss jetzt hier getan werden: </p><br><ol><li>  Laden Sie diesen neuen Bericht herunter. </li><li>  Analysiert die PDF-Datei. </li><li>  Finde meinen Ausweis darin. </li><li>  Suchen Sie den entsprechenden Status. </li></ol><br><p>  Der Funktionscode lautet wie folgt: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">check_visa</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(report_url, filename, visa_id, text)</span></span></span><span class="hljs-function">:</span></span> pdf = requests.get(report_url) file_path = Path(filename) file_path.write_bytes(pdf.content) pdfFileObj = open(filename, <span class="hljs-string"><span class="hljs-string">'rb'</span></span>) pdfReader = PyPDF2.PdfFileReader(pdfFileObj, strict=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> pageNum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, pdfReader.numPages): page = str(pdfReader.getPage(pageNum).extractText().encode(<span class="hljs-string"><span class="hljs-string">'utf-8'</span></span>)).split(<span class="hljs-string"><span class="hljs-string">'\\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> visa_id <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> page: visa_index = page.index(visa_id) status = page[visa_index + <span class="hljs-number"><span class="hljs-number">1</span></span>] text = text + <span class="hljs-string"><span class="hljs-string">'\t'</span></span> + visa_id + <span class="hljs-string"><span class="hljs-string">'\t'</span></span> + status <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> text</code> </pre> <br><p>  Wenn wir die <code>requests</code> erneut verwenden, stellen wir eine Anfrage an diesen Bericht.  Speichern Sie es anschließend lokal.  Mit der <code>PyPDF2</code> Bibliothek lesen <code>PyPDF2</code> die Datei.  Danach sortieren wir die Seiten und suchen im Token-Array nach <code>visa_id</code> .  Das Markup dieser PDF-Datei ist so, dass das nächste Token nach <code>visa_id</code> direkt der <code>visa_id</code> : <code>Approved</code> oder <code>Refused</code> .  Als nächstes verketten wir den vorhandenen Text mit ID und Status. </p><br><h3 id="3-otpravka-statusa-soobscheniem-v-slack">  3. Senden einer Statusmeldung in Slack </h3><br><p>  Gut.  Das Skript hat beispielsweise meine ID gefunden, aber Sie müssen mich irgendwo darüber informieren.  Wir in unserer Firma verwenden Slack als Messenger, daher dachte ich, es wäre praktisch für mich, dort eine Benachrichtigung zu erhalten. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Über diesen Link</a> können Sie Ihren Webhook konfigurieren.  Dort können Sie den Kanal oder den Empfänger auswählen, an den die Nachricht gesendet werden soll (für diesen Schritt muss möglicherweise ein WorkSpace-Administrator erforderlich sein).  Dort erhalten Sie eine eindeutige URL für den Webhook, die im Code verwendet werden kann. </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send_to_slack</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(webhook_url, text)</span></span></span><span class="hljs-function">:</span></span> post = {<span class="hljs-string"><span class="hljs-string">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"{0}"</span></span>.format(text)} json_data = json.dumps(post) req = requests.post(webhook_url, data=json_data.encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>), headers={<span class="hljs-string"><span class="hljs-string">'Content-Type'</span></span>: <span class="hljs-string"><span class="hljs-string">'application/json'</span></span>}) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> req.status_code</code> </pre> <br><p>  Unter Verwendung derselben <code>requests</code> wir eine POST-Anforderung mit dem <code>text</code> von webhook. </p><br><h3 id="4-ispolzovanie-funkciy">  4. Verwendung von Funktionen </h3><br><p>  Der Rest des Codes sieht folgendermaßen aus: </p><br><pre> <code class="python hljs">url = <span class="hljs-string"><span class="hljs-string">'https://www.dfa.ie/irish-embassy/russia/visas/weekly-decision-report/'</span></span> div_class = <span class="hljs-string"><span class="hljs-string">'gen-content-landing__block'</span></span> date = <span class="hljs-string"><span class="hljs-string">'24 April'</span></span> filename = <span class="hljs-string"><span class="hljs-string">'weekly_report.pdf'</span></span> visa_id = <span class="hljs-string"><span class="hljs-string">'38644112'</span></span> webhook_url = <span class="hljs-string"><span class="hljs-string">'https://hooks.slack.com/services/...'</span></span> text, report_url = check_report(url, div_class, date) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> text != <span class="hljs-string"><span class="hljs-string">''</span></span>: text = check_visa(report_url, filename, visa_id, text) print(send_to_slack(webhook_url, text))</code> </pre> <br><p>  Wir weisen allen notwendigen Variablen Werte zu und führen dann die vorgeschriebenen Funktionen aus. </p><br><h3 id="5-zapusk-po-planu">  5. Nach Plan starten </h3><br><p>  Ok  Ich habe ein Skript geschrieben, aber wenn ich es jedes Mal selbst abrufen muss, bin ich nicht weit vom ursprünglichen Zustand entfernt, in dem ich sitzen und die Seite aktualisieren müsste. </p><br><pre> <code class="bash hljs">$ crontab -e</code> </pre> <br><p>  Fügte eine Zeile hinzu: </p><br><pre> <code class="plaintext hljs">*/10 * * * * python3 /home/ubuntu/embassy.py &gt;/dev/null 2&gt;&amp;1</code> </pre> <br><p>  Ich dachte, es reicht mir, wenn dieses Skript alle 10 Minuten von cron auf einem Server mit Ubuntu ausgeführt wird. </p><br><h3 id="6-zaklyuchenie">  6. Fazit </h3><br><p>  Um 11:50 Uhr erhielt ich eine Nachricht, dass ein neuer Bericht erschienen war, aber mein Visum war nicht darin ... Danach ging ich zur Botschaft.  Er eroberte es im Sturm (sie beantworteten mehrere Wochen lang keine Briefe und Anrufe) und erhielt daraufhin seinen Pass mit einem Visum. </p><br><p>  Im Allgemeinen ist die Programmierkenntnis in der modernen Welt wichtig, auch wenn Sie kein Programmierer sind.  Es ermöglicht Ihnen, einige Ihrer Routinevorgänge zu automatisieren, was Ihre Welt ein wenig komfortabler macht.  Tatsächlich könnte dies sogar in einem separaten Dienst arrangiert werden, bei dem eine Person einfach ihren Ausweis und ihre E-Mail-Adresse eingibt und eine Nachricht über die Bereitschaft eines Visums für E-Mails erhält. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de450060/">https://habr.com/ru/post/de450060/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de450048/index.html">Anmerkungen zu Änderungen des Bundesgesetzes Nr. 149-ФЗ „Über Information, Informationstechnologien und Informationsschutz“</a></li>
<li><a href="../de450050/index.html">Die Grundlagen der reaktiven Programmierung mit RxJS. Teil 3. Observable höherer Ordnung</a></li>
<li><a href="../de450054/index.html">Hacke den JWT-Token</a></li>
<li><a href="../de450056/index.html">Achten Sie auf Nummer 2: Zusammenfassung der Artikel zu Produktdenken, Verhaltenspsychologie und persönlicher Produktivität</a></li>
<li><a href="../de450058/index.html">Der Lebenslauf dieses Typen</a></li>
<li><a href="../de450062/index.html">Wiederherstellung des Kreislaufs im Gehirn wenige Stunden nach dem Tod</a></li>
<li><a href="../de450064/index.html">Microsoft Build 2019 - Live-Stream in russischer Sprache</a></li>
<li><a href="../de450066/index.html">Test: Wie erfüllen Sie die Anforderungen für die Verarbeitung personenbezogener Daten?</a></li>
<li><a href="../de450068/index.html">Wie Technologie Ihren Geist manipuliert: Das Aussehen eines Illusionisten und Designethik-Experten Google</a></li>
<li><a href="../de450070/index.html">60 Millionen Felder und 27 Pflanzen. Wie wir eine Karte aller Bereiche Europas und der USA erstellt haben</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>