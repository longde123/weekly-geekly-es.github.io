<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍👩‍👦‍👦 📠 ☝🏾 1.Elastic stack：安全日志分析。 引言 🗳️ ↙️ 👼🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="与Splunk日志记录和分析系统在俄罗斯的销售终止有关，提出了如何替换此解决方案的问题？ 花了很多时间熟悉各种解决方案后，我选择了一个真正的人的解决方案- “ ELK堆栈” 。 该系统需要时间来配置它，因此，您可以获得一个非常强大的系统，用于分析组织中信息安全事件的状态和操作响应。 在本系列文章中，...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>1.Elastic stack：安全日志分析。 引言</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tssolution/blog/480570/"><img src="https://habrastorage.org/webt/kp/u5/no/kpu5nookmtr9sfo1o7xvyqla0hm.png"><br><br> 与Splunk日志记录和分析系统在俄罗斯的销售终止有关，提出了如何替换此解决方案的问题？ 花了很多时间熟悉各种解决方案后，我选择了一个真正的人的解决方案- <b>“ ELK堆栈”</b> 。 该系统需要时间来配置它，因此，您可以获得一个非常强大的系统，用于分析组织中信息安全事件的状态和操作响应。 在本系列文章中，我们将考虑ELK堆栈的基本（或可能不是）功能，考虑如何解析日志，如何构建图形和仪表板，以及使用来自Check Point防火墙或OpenVas安全扫描程序的日志可以完成哪些有趣的功能。 首先，考虑一下它是什么-ELK堆栈以及它组成的组件。 <br><a name="habracut"></a><br>  <b>ELK堆栈</b>是三个开源项目的缩写： <b>Elasticsearch</b> ， <b>Logstash</b>和<b>Kibana</b> 。 由Elastic以及所有相关项目开发。  Elasticsearch是整个系统的核心，它结合了数据库，搜索和分析系统的功能。  Logstash是服务器端数据处理管道，可同时从多个源接收数据，解析日志，然后将其发送到Elasticsearch数据库。  Kibana允许用户使用Elasticsearch中的图表将数据可视化。 也可以通过Kibana来管理数据库。 接下来，我们将分别更详细地考虑每个系统。 <br><br><img src="https://habrastorage.org/webt/yh/-x/71/yh-x71ljji24rz0otkd6yqlzin0.png"><br><br><h3>  Logstash </h3><br>  Logstash是用于处理来自各种来源的日志事件的实用程序，您可以使用它选择消息中的字段及其值，还可以配置过滤和编辑数据。 完成所有操作后，Logstash将事件重定向到最终数据存储。 该实用程序仅通过配置文件进行配置。 <br> 典型的logstash配置是一个文件，由多个传入信息流（输入），此信息的多个过滤器（过滤器）和几个输出流（输出）组成。 它看起来像一个或多个配置文件，在最简单的版本中（根本不执行任何操作）如下所示： <br><br><pre><code class="javascript hljs">input { } filter { } output { }</code> </pre> <br> 在INPUT中，我们配置日志将进入哪个端口，并根据哪种协议进行配置，或者配置从哪个文件夹中读取新文件或不断写入的文件。 在FILTER中，我们配置日志解析器：解析字段，编辑值，添加新参数或删除。  FILTER是Logstash附带的消息管理字段，其中包含大量的编辑选项。 在输出中，我们配置已解析日志的发送位置（如果它是elasticsearch），则发送JSON请求，在其中发送带有值的字段，或者作为调试的一部分，可以将其输出到stdout或写入文件。 <br><br><img src="https://habrastorage.org/webt/kj/ns/qh/kjnsqhfoxgr7fqtku2tpgibgh5y.png"><br><br><h3> 弹性搜索 </h3><br> 最初，Elasticsearch是一个全文搜索解决方案，但具有其他功能，例如易于扩展，复制等，这使该产品成为适用于具有大量数据的高负载项目的非常便捷且良好的解决方案。  Elasticsearch是JSON格式的文档的非关系存储库（NoSQL），并且是基于Lucene全文搜索的搜索引擎。 硬件平台是Java虚拟机，因此系统需要大量的处理器和RAM资源才能工作。 <br> 使用Logstash或使用查询API的每条传入消息都被索引为“文档”-关系SQL中表的类似物。 所有文档都存储在索引中-SQL中数据库的类似物。 <br><br> 数据库中文档的示例： <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"_index"</span></span>: <span class="hljs-string"><span class="hljs-string">"checkpoint-2019.10.10"</span></span>, <span class="hljs-string"><span class="hljs-string">"_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"_doc"</span></span>, <span class="hljs-string"><span class="hljs-string">"_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"yvNZcWwBygXz5W1aycBy"</span></span>, <span class="hljs-string"><span class="hljs-string">"_version"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"_score"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"_source"</span></span>: { <span class="hljs-string"><span class="hljs-string">"layer_uuid"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"dae7f01c-4c98-4c3a-a643-bfbb8fcf40f0"</span></span>, <span class="hljs-string"><span class="hljs-string">"dbee3718-cf2f-4de0-8681-529cb75be9a6"</span></span> ], <span class="hljs-string"><span class="hljs-string">"outzone"</span></span>: <span class="hljs-string"><span class="hljs-string">"External"</span></span>, <span class="hljs-string"><span class="hljs-string">"layer_name"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"TSS-Standard Security"</span></span>, <span class="hljs-string"><span class="hljs-string">"TSS-Standard Application"</span></span> ], <span class="hljs-string"><span class="hljs-string">"time"</span></span>: <span class="hljs-string"><span class="hljs-string">"1565269565"</span></span>, <span class="hljs-string"><span class="hljs-string">"dst"</span></span>: <span class="hljs-string"><span class="hljs-string">"103.5.198.210"</span></span>, <span class="hljs-string"><span class="hljs-string">"parent_rule"</span></span>: <span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"host"</span></span>: <span class="hljs-string"><span class="hljs-string">"10.10.10.250"</span></span>, <span class="hljs-string"><span class="hljs-string">"ifname"</span></span>: <span class="hljs-string"><span class="hljs-string">"eth6"</span></span>, ] }</code> </pre><br> 数据库的所有工作都基于使用REST API的JSON请求，该请求可以按索引发布文档，也可以采用以下格式的某些统计信息：问题-答案。 为了可视化所有请求答案，编写了Kibana，这是一个Web服务。 <br><br><h3> 基巴纳 </h3><br>  Kibana允许您从elasticsearch数据库中搜索/获取数据并请求统计信息，但是许多美丽的图形和仪表板都是基于答案构建的。 该系统还具有Elasticsearch数据库管理功能，在后续文章中，我们将更详细地考虑此服务。 现在，让我们展示一下Check Point防火墙和可以构建的OpenVas漏洞扫描程序上的仪表板示例。 <br><br>  Check Point的仪表板示例，图片可点击： <br><br> <a href=""><img src="https://habrastorage.org/webt/uf/qo/sc/ufqosc54roxobmwjvcsh6t73xoi.png"></a> <br><br>  OpenVas仪表板示例，图片可点击： <br><br> <a href=""><img src="https://habrastorage.org/webt/_n/et/7p/_net7pq1xbagdowqy4utbfd-d9c.png"></a> <br><br><h3> 结论 </h3><br> 我们检查了<b>ELK堆栈的</b>组成，并对主要产品有所了解，然后在课程中，我们将分别考虑编写Logstash配置文件，在Kibana上设置仪表板，熟悉API请求，自动化等等！ <br><br> 所以请继续关注（ <a href="https://t.me/tssolution">Telegram</a> ， <a href="https://www.facebook.com/groups/tssolution.info/">Facebook</a> ， <a href="https://vk.com/ts_solution">VK</a> ， <a href="https://tssolution.ru/blog">TS Solution Blog</a> ）， <a href="https://zen.yandex.ru/id/5c7d2162fa818600ae386a52">Yandex.Zen</a> 。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN480570/">https://habr.com/ru/post/zh-CN480570/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN480552/index.html">Firefox为网络的未来而战</a></li>
<li><a href="../zh-CN480556/index.html">NGINX：俄罗斯IT社区的验证</a></li>
<li><a href="../zh-CN480558/index.html">挖矿的收支平衡水平如何让您确定比特币的关键点</a></li>
<li><a href="../zh-CN480564/index.html">没有框架的Java中的REST API</a></li>
<li><a href="../zh-CN480566/index.html">我在2019年找到的IT工作知识</a></li>
<li><a href="../zh-CN480580/index.html">因此系统无法解决</a></li>
<li><a href="../zh-CN480582/index.html">安全周51：iOS和英特尔处理器中的漏洞</a></li>
<li><a href="../zh-CN480594/index.html">前后：著名电子游戏的视觉演变</a></li>
<li><a href="../zh-CN480596/index.html">创新的网络操作系统ArubaOS-CX等待着您</a></li>
<li><a href="../zh-CN480598/index.html">关于...难题的任何编程的基础</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>