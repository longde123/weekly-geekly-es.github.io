<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🤝‍👨🏿 👩🏿‍💼 👨‍🌾 Bagaimana saya mengajar AI bermain Tetris untuk NES. Bagian 1: analisis kode permainan 🆖 💖 🐼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada artikel ini, saya akan mengeksplorasi mekanisme menipu sederhana dari Nintendo Tetris, dan di bagian kedua saya akan menjelaskan bagaimana saya m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana saya mengajar AI bermain Tetris untuk NES. Bagian 1: analisis kode permainan</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420725/">  Pada artikel ini, saya akan mengeksplorasi mekanisme menipu sederhana dari Nintendo Tetris, dan di bagian kedua saya akan menjelaskan bagaimana saya membuat AI yang mengeksploitasi mekanik ini. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/48f/1a4/9b8/48f1a49b87860e6139e8d298e1fe6188.png"></div><br><h2>  Coba sendiri </h2><br><h3>  Tentang proyek </h3><br>  Bagi mereka yang tidak memiliki ketekunan, kesabaran, dan waktu yang dibutuhkan untuk menguasai Nintendo Tetris, saya menciptakan AI yang bisa bermain sendiri.  Anda akhirnya bisa mencapai level 30 dan bahkan lebih jauh.  Anda akan melihat cara mendapatkan jumlah poin maksimum dan mengamati perubahan tak henti dari penghitung baris, level, dan statistik.  Anda akan belajar warna apa yang muncul pada level di atas yang tidak bisa didaki seseorang.  Lihat seberapa jauh Anda bisa melangkah. <br><a name="habracut"></a><br><h3>  Persyaratan </h3><br>  Untuk menjalankan AI, Anda memerlukan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">emulator</a> NES / Famicom <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">FCEUX</a> universal.  Kecerdasan buatan dikembangkan untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">FCEUX 2.2.2</a> , versi terbaru dari emulator pada saat penulisan. <br><br>  Anda juga memerlukan file ROM Nintendo Tetris (versi AS).  Coba cari di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Google</a> . <br><br><h3>  Unduh </h3><br>  Unzip <code>lua/NintendoTetrisAI.lua</code> dari <a href="">file zip sumber</a> ini. <br><br><h3>  Luncurkan </h3><br>  Luncurkan FCEUX.  Dari menu, pilih File |  Buka ROM ... Di kotak dialog Buka File, pilih file Nintendo Tetris ROM dan klik Buka.  Game akan dimulai. <br><br>  Dari menu, pilih File |  Lua |  Jendela Lua Script Baru ... Di jendela Lua Script, masukkan path ke <code>NintendoTetrisAI.lua</code> atau klik tombol Browse untuk menemukannya.  Setelah itu, klik Run. <br><br>  Skrip pada Lua akan mengarahkan Anda ke layar pertama dari menu.  Tinggalkan jenis permainan A-Type, dan Anda dapat memilih musik apa pun.  Pada komputer yang lambat, musik dapat diputar dengan sangat menyentak, maka Anda harus mematikannya.  Tekan Mulai (Enter) untuk pergi ke layar menu berikutnya.  Di menu kedua, Anda dapat menggunakan tombol panah untuk mengubah level awal.  Klik Mulai untuk memulai permainan.  Dan di sini AI akan mengambil kendali. <br><br>  Jika setelah memilih level pada layar menu kedua, tahan tombol gamepad A (Anda dapat mengubah tata letak keyboard di menu Config | Input ...) dan tekan Start, maka level awal akan 10 lebih dari nilai yang dipilih.  Level entri maksimum adalah sembilan belas. <br><br><h3>  Konfigurasi </h3><br>  Untuk membuat game berjalan lebih cepat, buka skrip Lua dalam editor teks.  Di awal file, temukan baris berikut. <br><br> <code>PLAY_FAST = false</code> <br> <br>  Ganti <code>false</code> dengan <code>true</code> seperti yang ditunjukkan di bawah ini. <br><br> <code>PLAY_FAST = true</code> <br> <br>  Simpan file.  Kemudian klik tombol Restart di jendela Lua Script. <br><br><h2>  Mekanisme Nintendo Tetris </h2><br><h3>  Deskripsi Tetrimino </h3><br>  Setiap angka tetrimino sesuai dengan nama huruf tunggal yang menyerupai bentuknya. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/975/440/5ed/9754405ed7b3d83a47181edef3de6913.png"></div><br>  Desainer Nintendo Tetris secara sewenang-wenang mengatur urutan tetrimino yang ditunjukkan di atas.  Angka-angka ditunjukkan dalam orientasi di mana mereka muncul di layar, dan sirkuit menciptakan gambar yang hampir simetris (mungkin inilah mengapa urutan ini dipilih).  Indeks urutan memberi setiap tetrimino ID numerik unik.  Pengidentifikasi urutan dan tipe penting di tingkat pemrograman;  selain itu, mereka memanifestasikan diri dalam urutan angka yang ditampilkan di bidang statistik (lihat di bawah). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc2/35d/778/dc235d778c47654e1abbc5896581fd6a.png"></div><br>  19 orientasi yang digunakan dalam Nintendo Tetris tetrimino dikodekan dalam tabel yang terletak pada <code>$8A9C</code> dari memori konsol NES.  Setiap gambar direpresentasikan sebagai urutan 12 byte yang dapat dibagi menjadi tiga kali lipat <code>(Y, tile, X)</code> yang menggambarkan setiap kotak pada gambar.  Nilai heks koordinat di atas <code>$7F</code> menunjukkan bilangan bulat negatif ( <code>$FF= −1</code> , dan <code>$FE = −2</code> ). <br><br> <code>; Y0 T0 X0 Y1 T1 X1 Y2 T2 X2 Y3 T3 X3 <br> <br> 8A9C: 00 7B FF 00 7B 00 00 7B 01 FF 7B 00 ; 00: T up <br> 8AA8: FF 7B 00 00 7B 00 00 7B 01 01 7B 00 ; 01: T right <br> 8AB4: 00 7B FF 00 7B 00 00 7B 01 01 7B 00 ; 02: T down (spawn) <br> 8AC0: FF 7B 00 00 7B FF 00 7B 00 01 7B 00 ; 03: T left <br> <br> 8ACC: FF 7D 00 00 7D 00 01 7D FF 01 7D 00 ; 04: J left <br> 8AD8: FF 7D FF 00 7D FF 00 7D 00 00 7D 01 ; 05: J up <br> 8AE4: FF 7D 00 FF 7D 01 00 7D 00 01 7D 00 ; 06: J right <br> 8AF0: 00 7D FF 00 7D 00 00 7D 01 01 7D 01 ; 07: J down (spawn) <br> <br> 8AFC: 00 7C FF 00 7C 00 01 7C 00 01 7C 01 ; 08: Z horizontal (spawn) <br> 8B08: FF 7C 01 00 7C 00 00 7C 01 01 7C 00 ; 09: Z vertical <br> <br> 8B14: 00 7B FF 00 7B 00 01 7B FF 01 7B 00 ; 0A: O (spawn) <br> <br> 8B20: 00 7D 00 00 7D 01 01 7D FF 01 7D 00 ; 0B: S horizontal (spawn) <br> 8B2C: FF 7D 00 00 7D 00 00 7D 01 01 7D 01 ; 0C: S vertical <br> <br> 8B38: FF 7C 00 00 7C 00 01 7C 00 01 7C 01 ; 0D: L right <br> 8B44: 00 7C FF 00 7C 00 00 7C 01 01 7C FF ; 0E: L down (spawn) <br> 8B50: FF 7C FF FF 7C 00 00 7C 00 01 7C 00 ; 0F: L left <br> 8B5C: FF 7C 01 00 7C FF 00 7C 00 00 7C 01 ; 10: L up <br> <br> 8B68: FE 7B 00 FF 7B 00 00 7B 00 01 7B 00 ; 11: I vertical <br> 8B74: 00 7B FE 00 7B FF 00 7B 00 00 7B 01 ; 12: I horizontal (spawn) <br> <br> 8B80: 00 FF 00 00 FF 00 00 FF 00 00 FF 00 ; 13: Unused</code> <br> <br>  Di bagian bawah tabel ada satu catatan yang tidak digunakan, berpotensi memberikan kesempatan untuk menambahkan orientasi lain.  Namun, di berbagai bagian kode, <code>$13</code> menunjukkan bahwa pengenal orientasi tetrimino aktif tidak diberi nilai. <br><br>  Untuk kemudahan membaca, koordinat kotak dalam desimal ditunjukkan di bawah ini. <br><br> <code>-- { { X0, Y0 }, { X1, Y1 }, { X2, Y2 }, { X3, Y3 }, }, <br> <br> { { -1, 0 }, { 0, 0 }, { 1, 0 }, { 0, -1 }, }, -- 00: T up <br> { { 0, -1 }, { 0, 0 }, { 1, 0 }, { 0, 1 }, }, -- 01: T right <br> { { -1, 0 }, { 0, 0 }, { 1, 0 }, { 0, 1 }, }, -- 02: T down (spawn) <br> { { 0, -1 }, { -1, 0 }, { 0, 0 }, { 0, 1 }, }, -- 03: T left <br> <br> { { 0, -1 }, { 0, 0 }, { -1, 1 }, { 0, 1 }, }, -- 04: J left <br> { { -1, -1 }, { -1, 0 }, { 0, 0 }, { 1, 0 }, }, -- 05: J up <br> { { 0, -1 }, { 1, -1 }, { 0, 0 }, { 0, 1 }, }, -- 06: J right <br> { { -1, 0 }, { 0, 0 }, { 1, 0 }, { 1, 1 }, }, -- 07: J down (spawn) <br> <br> { { -1, 0 }, { 0, 0 }, { 0, 1 }, { 1, 1 }, }, -- 08: Z horizontal (spawn) <br> { { 1, -1 }, { 0, 0 }, { 1, 0 }, { 0, 1 }, }, -- 09: Z vertical <br> <br> { { -1, 0 }, { 0, 0 }, { -1, 1 }, { 0, 1 }, }, -- 0A: O (spawn) <br> <br> { { 0, 0 }, { 1, 0 }, { -1, 1 }, { 0, 1 }, }, -- 0B: S horizontal (spawn) <br> { { 0, -1 }, { 0, 0 }, { 1, 0 }, { 1, 1 }, }, -- 0C: S vertical <br> <br> { { 0, -1 }, { 0, 0 }, { 0, 1 }, { 1, 1 }, }, -- 0D: L right <br> { { -1, 0 }, { 0, 0 }, { 1, 0 }, { -1, 1 }, }, -- 0E: L down (spawn) <br> { { -1, -1 }, { 0, -1 }, { 0, 0 }, { 0, 1 }, }, -- 0F: L left <br> { { 1, -1 }, { -1, 0 }, { 0, 0 }, { 1, 0 }, }, -- 10: L up <br> <br> { { 0, -2 }, { 0, -1 }, { 0, 0 }, { 0, 1 }, }, -- 11: I vertical <br> { { -2, 0 }, { -1, 0 }, { 0, 0 }, { 1, 0 }, }, -- 12: I horizontal (spawn)</code> <br> <br>  Semua orientasi ditempatkan dalam matriks 5 × 5. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8ca/435/322/8ca435322ee85d07cc631640c11a9aee.png"></div><br>  Pada gambar di atas, kotak putih menunjukkan pusat matriks, titik referensi untuk rotasi gambar. <br><br>  Tabel orientasi disajikan secara grafis di bawah ini. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b18/4e0/f0e/b184e0f0ea182222b58d151c09217567.png"></div><br>  Pengidentifikasi orientasi (tabel indeks) ditampilkan dalam heksadesimal di sudut kanan atas setiap matriks.  Dan mnemonik yang ditemukan untuk proyek ini ditampilkan di sudut kiri atas.  <code>u</code> , <code>r</code> , <code>d</code> , <code>l</code> , <code>h</code> dan <code>v</code> adalah singkatan dari "atas, kanan, bawah, kiri, horisontal dan vertikal".  Misalnya, lebih mudah untuk menunjukkan orientasi <code>Jd</code> daripada <code>$07</code> . <br><br>  Matriks yang berisi orientasi gambar selama penciptaan ditandai dengan bingkai putih. <br><br>  Tetrimino I, S dan Z dapat diberikan 4 orientasi terpisah, tetapi pencipta Nintendo Tetris memutuskan untuk membatasi diri menjadi dua.  Selain itu, <code>Zv</code> dan <code>Sv</code> bukan gambar cermin ideal satu sama lain.  Keduanya dibuat dengan memutar berlawanan arah jarum jam, menghasilkan ketidakseimbangan. <br><br>  Tabel orientasi juga berisi nilai ubin untuk setiap kotak di setiap gambar yang berorientasi.  Namun, dengan penelitian yang cermat, menjadi jelas bahwa nilai-nilai untuk satu jenis tetrimino selalu sama. <br><br><div class="scrollable-table"><table><tbody><tr><th>  T </th><th>  J </th><th>  Z </th><th>  O </th><th>  S </th><th>  L. </th><th>  Saya </th></tr><tr><td> <code>7B</code> </td> <td> <code>7D</code> </td> <td> <code>7C</code> </td> <td> <code>7B</code> </td> <td> <code>7D</code> </td> <td> <code>7C</code> </td> <td> <code>7B</code> </td> </tr></tbody></table></div><br>  Nilai petak adalah indeks dari tabel (warna semu) dari pola yang ditunjukkan di bawah ini. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e00/97a/713/e0097a713f629afaf73936d3192820e3.png"></div><br>  Ubin <code>$7B</code> , <code>$7C</code> dan <code>$7D</code> terletak tepat di bawah "ATIS" dari kata "STATISTIK".  Ini adalah tiga jenis kotak dari mana tetrimino dibuat. <br><br>  Bagi yang penasaran, saya akan mengatakan bahwa burung unta dan penguin digunakan di akhir mode Tipe-B.  Topik ini dibahas secara rinci di bagian "Berakhir". <br><br>  Di bawah ini adalah hasil dari memodifikasi ROM setelah mengganti <code>$7B</code> dengan <code>$29</code> .  Jantung adalah ubin di bawah simbol P dalam tabel pola untuk semua orientasi T. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5fa/551/215/5fa55121523b443f8f3b6daa2bd46ad8.png"></div><br>  Ubin hati tetap berada di lapangan bermain bahkan setelah Ts yang dimodifikasi dikunci di tempatnya.  Seperti yang dinyatakan di bawah ini di bagian "Menciptakan Tetrimino", ini berarti bahwa lapangan bermain menyimpan nilai sebenarnya dari indeks petak Tetrimino yang dimainkan. <br><br>  Pemrogram game memungkinkan untuk menggunakan 4 ubin terpisah untuk setiap gambar, dan bukan hanya satu jenis kotak yang tidak berubah-ubah.  Ini adalah fitur yang berguna yang dapat digunakan untuk mengubah tampilan permainan.  Tabel pola memiliki banyak ruang kosong untuk ubin baru yang dapat memberikan tampilan unik pada setiap tetrimino. <br><br>  Koordinat kotak sangat mudah untuk dimanipulasi.  Sebagai contoh, versi modifikasi dari tiga kali lipat pertama dalam tabel orientasi ditunjukkan di bawah ini. <br><br> <code>8A9C: FE 7B FE FE 7B 02 02 7B FE 02 7B 02 ; 00: T up</code> <br> <br>  Perubahan ini mirip dengan yang berikut: <br><br> <code>{ { -2, -2 }, { 2, -2 }, { -2, 2 }, { 2, 2 }, }, -- 00: T up</code> <br> <br>  Hasilnya adalah split tetrimino. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3a6/ab5/86d/3a6ab586d06a57b92208bd612b755109.png"></div><br>  Saat memindahkan tetrimino yang terbagi, kuadratnya tidak bisa melampaui batas-batas lapangan bermain dan tidak bisa melewati angka tempat yang sebelumnya terkunci.  Selain itu, permainan melarang rotasi dalam orientasi ini jika mengarah ke kotak jatuh di luar batas lapangan bermain atau fakta bahwa kotak tumpang tindih dengan kotak yang sudah berbohong. <br><br>  Split tetrimino terkunci pada tempatnya ketika ada dukungan untuk kotak mana pun.  Jika angka itu diblokir, maka kotak yang menggantung di udara terus menggantung. <br><br>  Permainan ini menangani tetrimino yang terpecah seperti sosok normal lainnya.  Ini membuat kita mengerti bahwa tidak ada tabel tambahan yang menyimpan metadata dari gambar.  Misalnya, mungkin ada meja yang menyimpan ukuran kotak pembatas dari masing-masing orientasi untuk memeriksa tabrakan dengan batas lapangan permainan.  Tapi meja seperti itu tidak digunakan.  Sebagai gantinya, game hanya memeriksa keempat kotak tepat sebelum memanipulasi bentuk. <br><br>  Selain itu, koordinat kotak dapat berupa nilai apa pun;  mereka tidak terbatas pada interval <code>[−2, 2]</code> .  Tentu saja, nilai-nilai yang jauh melebihi interval ini akan memberi kita angka yang tidak dapat diterapkan yang tidak dapat ditampung di lapangan permainan.  Lebih penting lagi, seperti yang dinyatakan dalam bagian "Status permainan dan mode render", ketika sebuah gambar terkunci di tempatnya, mekanisme untuk membersihkan garis yang diisi hanya memindai perpindahan baris dari −2 ke 1 dari kuadrat tengah gambar;  kuadrat dengan koordinat <code>y</code> luar interval ini tidak akan dikenali. <br><br><h3>  Rotasi tetrimino </h3><br>  Dalam ilustrasi grafis dari tabel orientasi, rotasi terdiri dari bergerak dari matriks ke salah satu matriks di sebelah kiri atau di sebelah kanan dengan transfer seri jika perlu.  Konsep ini dikodekan dalam tabel di <code>$88EE</code> . <br><br> <code>; CCW CW <br> 88EE: 03 01 ; Tl Tr <br> 88F0: 00 02 ; Tu Td <br> 88F2: 01 03 ; Tr Tl <br> 88F4: 02 00 ; Td Tu <br> 88F6: 07 05 ; Jd Ju <br> 88F8: 04 06 ; Jl Jr <br> 88FA: 05 07 ; Ju Jd <br> 88FC: 06 04 ; Jr Jl <br> 88FE: 09 09 ; Zv Zv <br> 8900: 08 08 ; Zh Zh <br> 8902: 0A 0A ; OO <br> 8904: 0C 0C ; Sv Sv <br> 8906: 0B 0B ; Sh Sh <br> 8908: 10 0E ; Lu Ld <br> 890A: 0D 0F ; Lr Ll <br> 890C: 0E 10 ; Ld Lu <br> 890E: 0F 0D ; Ll Lr <br> 8910: 12 12 ; Ih Ih <br> 8912: 11 11 ; Iv Iv</code> <br> <br>  Untuk membuatnya lebih jelas, kami akan memindahkan setiap kolom dari tabel ini ke baris tabel di bawah ini. <br><div class="scrollable-table"><table><tbody><tr><th></th><th> <code>Tu</code> </th> <th> <code>Tr</code> </th> <th> <code>Td</code> </th> <th> <code>Tl</code> </th> <th> <code>Jl</code> </th> <th> <code>Ju</code> </th> <th> <code>Jr</code> </th> <th> <code>Jd</code> </th> <th> <code>Zh</code> </th> <th> <code>Zv</code> </th> <th> <code>O</code> </th> <th> <code>Sh</code> </th> <th> <code>Sv</code> </th> <th> <code>Lr</code> </th> <th> <code>Ld</code> </th> <th> <code>Ll</code> </th> <th> <code>Lu</code> </th> <th> <code>Iv</code> </th> <th> <code>Ih</code> </th> </tr><tr><th>  Berlawanan arah jarum jam </th><td> <code>Tl</code> </td> <td> <code>Tu</code> </td> <td> <code>Tr</code> </td> <td> <code>Td</code> </td> <td> <code>Jd</code> </td> <td> <code>Jl</code> </td> <td> <code>Ju</code> </td> <td> <code>Jr</code> </td> <td> <code>Zv</code> </td> <td> <code>Zh</code> </td> <td> <code>O</code> </td> <td> <code>Sv</code> </td> <td> <code>Sh</code> </td> <td> <code>Lu</code> </td> <td> <code>Lr</code> </td> <td> <code>Ld</code> </td> <td> <code>Ll</code> </td> <td> <code>Ih</code> </td> <td> <code>Iv</code> </td> </tr><tr><th>  Searah jarum jam </th><td> <code>Tr</code> </td> <td> <code>Td</code> </td> <td> <code>Tl</code> </td> <td> <code>Tu</code> </td> <td> <code>Ju</code> </td> <td> <code>Jr</code> </td> <td> <code>Jd</code> </td> <td> <code>Jl</code> </td> <td> <code>Zv</code> </td> <td> <code>Zh</code> </td> <td> <code>O</code> </td> <td> <code>Sv</code> </td> <td> <code>Sh</code> </td> <td> <code>Ld</code> </td> <td> <code>Ll</code> </td> <td> <code>Lu</code> </td> <td> <code>Lr</code> </td> <td> <code>Ih</code> </td> <td> <code>Iv</code> </td> </tr></tbody></table></div><br>  Mnemonik dalam pos di atas dapat diartikan sebagai indeks urutan atau kunci distribusi.  Sebagai contoh, memutar berlawanan arah jarum jam memberi kita <code>Tl</code> , dan memutar searah jarum jam memberi kita <code>Tr</code> . <br><br>  Tabel rotasi menyandikan urutan ID orientasi yang terhubung rantai;  oleh karena itu, kita dapat memodifikasi rekaman sehingga rotasi mengubah satu jenis tetrimino menjadi yang lain.  Teknik ini berpotensi digunakan untuk mengambil keuntungan dari baris yang tidak digunakan dalam tabel orientasi. <br><br>  Di depan tabel rotasi adalah kode untuk mengaksesnya. <br><br> <code>88AB: LDA $0042 <br> 88AD: STA $00AE ; originalOrientationID = orientationID; <br> <br> 88AF: CLC <br> 88B0: LDA $0042 <br> 88B2: ASL <br> 88B3: TAX ; index = 2 * orientationID; <br> <br> 88B4: LDA $00B5 <br> 88B6: AND #$80 ; if (not just pressed button A) { <br> 88B8: CMP #$80 ; goto aNotPressed; <br> 88BA: BNE $88CF ; } <br> <br> 88BC: INX <br> 88BD: LDA $88EE,X <br> 88C0: STA $0042 ; orientationID = rotationTable[index + 1]; <br> <br> 88C2: JSR $948B ; if (new orientation not valid) { <br> 88C5: BNE $88E9 ; goto restoreOrientationID; <br> ; } <br> <br> 88C7: LDA #$05 <br> 88C9: STA $06F1 ; play rotation sound effect; <br> 88CC: JMP $88ED ; return; <br> <br> aNotPressed: <br> <br> 88CF: LDA $00B5 <br> 88D1: AND #$40 ; if (not just pressed button B) { <br> 88D3: CMP #$40 ; return; <br> 88D5: BNE $88ED ; } <br> <br> 88D7: LDA $88EE,X <br> 88DA: STA $0042 ; orientationID = rotationTable[index]; <br> <br> 88DC: JSR $948B ; if (new orientation not valid) { <br> 88DF: BNE $88E9 ; goto restoreOrientationID; <br> ; } <br> <br> 88E1: LDA #$05 <br> 88E3: STA $06F1 ; play rotation sound effect; <br> 88E6: JMP $88ED ; return; <br> <br> restoreOrientationID: <br> <br> 88E9: LDA $00AE <br> 88EB: STA $0042 ; orientationID = originalOrientationID; <br> <br> 88ED: RTS ; return;</code> <br> <br>  Untuk rotasi berlawanan arah jarum jam, indeks tabel rotasi dikurangi dengan menggandakan ID orientasi.  Dengan menambahkan 1 padanya, kita mendapatkan indeks rotasi searah jarum jam. <br><br>  Koordinat <code>x</code> , <code>y</code> dan orientasi ID tetrimino saat ini masing-masing disimpan di alamat <code>$0040</code> , <code>$0041</code> dan <code>$0042</code> . <br><br>  Kode menggunakan variabel sementara untuk membuat cadangan ID orientasi.  Kemudian, setelah mengubah orientasi, kode memverifikasi bahwa keempat kotak berada di dalam batas-batas lapangan bermain dan bahwa tidak ada yang tumpang tindih dengan kotak yang sudah berbohong (kode verifikasi terletak di <code>$948B</code> , di bawah fragmen kode yang ditunjukkan di atas).  Jika orientasi baru salah, maka yang asli dikembalikan, tidak memungkinkan pemain untuk memutar gambar. <br><br>  Menghitung dengan tanda silang, pengontrol NES memiliki delapan tombol, statusnya diwakili oleh bit alamat <code>$00B6</code> . <br><br><div class="scrollable-table"><table><tbody><tr><th> <code>7</code> </th> <th> <code>6</code> </th> <th> <code>5</code> </th> <th> <code>4</code> </th> <th> <code>3</code> </th> <th> <code>2</code> </th> <th> <code>1</code> </th> <th> <code>0</code> </th> </tr><tr><td>  A </td><td>  B </td><td>  Pilih </td><td>  Mulai </td><td>  Naik </td><td>  Turun </td><td>  Ke kiri </td><td>  Ke kanan </td></tr></tbody></table></div><br>  Misalnya, <code>$00B6</code> akan berisi nilai <code>$81</code> sementara pemain memegang A dan Kiri. <br><br>  Di sisi lain, <code>$00B5</code> melaporkan ketika tombol-tombol ditekan;  bit <code>$00B5</code> hanya berlaku selama satu iterasi dari loop game (1 frame yang diberikan).  Kode ini menggunakan <code>$00B5</code> untuk merespons penekanan A dan B. Masing-masing harus dilepaskan sebelum digunakan lagi. <br><br>  <code>$00B5</code> dan <code>$00B6</code> adalah mirror dari <code>$00F5</code> dan <code>$00F6</code> .  Kode di bagian berikut menggunakan alamat ini secara bergantian. <br><br><h3>  Buat Tetrimino </h3><br>  Bidang permainan Nintendo Tetris terdiri dari matriks dengan 22 baris dan 10 kolom sehingga dua baris teratas disembunyikan dari pemain. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6e1/0dc/33b/6e10dc33b40eaa5dec35bc6e7bf42c5f.png"></div><br>  Seperti yang ditunjukkan dalam kode di bawah ini, saat membuat angka Tetrimino, itu selalu terletak di koordinat <code>(5, 0)</code> lapangan bermain. <br><br> <code>98BA: LDA #$00 <br> 98BC: STA $00A4 <br> 98BE: STA $0045 <br> 98C0: STA $0041 ; Tetrimino Y = 0 <br> 98C2: LDA #$01 <br> 98C4: STA $0048 <br> 98C6: LDA #$05 <br> 98C8: STA $0040 ; Tetrimino X = 5</code> <br> <br>  Di bawah ini adalah matriks 5 × 5 yang ditumpangkan pada titik ini. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fcf/d3b/d94/fcfd3bd94514779d6e967770a1f216cb.png"></div><br>  Tidak satu pun dari matriks penciptaan memiliki kuadrat di atas titik awal.  Artinya, saat membuat tetrimino, keempat kotaknya segera menjadi terlihat oleh pemain.  Namun, jika pemain dengan cepat memutar bagian sebelum sempat jatuh, bagian dari potongan akan sementara disembunyikan di dua baris pertama dari lapangan bermain. <br><br>  Biasanya kami berpikir bahwa permainan berakhir ketika tumpukan mencapai puncak.  Tetapi pada kenyataannya, ini tidak sepenuhnya benar.  Permainan berakhir ketika tidak mungkin lagi membuat karya selanjutnya.  Artinya, sebelum penampilan gambar, keempat sel dari lapangan bermain sesuai dengan posisi kotak dari tetrimino yang dibuat harus bebas.  Angka tersebut dapat dikunci di tempat sedemikian rupa sehingga bagian dari kuadratnya muncul dalam garis bernomor negatif, dan permainan tidak berakhir;  namun, di Nintendo Tetris, garis negatif adalah abstraksi yang hanya terkait dengan tetrimino aktif.  Setelah gambar diblokir (menjadi bohong), hanya kotak di garis dari nol dan lebih banyak yang ditulis ke lapangan.  Secara konseptual, ternyata garis bernomor negatif secara otomatis dihapus setelah diblokir.  Namun dalam kenyataannya, permainan tidak menyimpan data ini, memotong bagian atas angka. <br><br>  Area yang terlihat dari lapangan bermain 20 × 10 disimpan pada <code>$0400</code> baris demi baris, setiap byte berisi nilai ubin latar belakang.  Sel kosong dilambangkan oleh ubin <code>$EF</code> , kotak hitam solid. <br><br>  Saat membuat bentuk, tiga tabel pencarian digunakan.  Jika ada ID orientasi sewenang-wenang, tabel di <code>$9956</code> memberi kita ID orientasi saat membuat jenis tetrimino yang sesuai. <br><br> <code>9956: 02 02 02 02 ; Td <br> 995A: 07 07 07 07 ; Jd <br> 995E: 08 08 ; Zh <br> 9960: 0A ; O <br> 9961: 0B 0B ; Sh <br> 9963: 0E 0E 0E 0E ; Ld <br> 9967: 12 12 ; Ih</code> <br> <br>  Lebih mudah untuk menunjukkan ini di tabel. <br><br><div class="scrollable-table"><table><tbody><tr><th> <code>Tu</code> </th> <th> <code>Tr</code> </th> <th> <code>Td</code> </th> <th> <code>Tl</code> </th> <th> <code>Jl</code> </th> <th> <code>Ju</code> </th> <th> <code>Jr</code> </th> <th> <code>Jd</code> </th> <th> <code>Zh</code> </th> <th> <code>Zv</code> </th> <th> <code>O</code> </th> <th> <code>Sh</code> </th> <th> <code>Sv</code> </th> <th> <code>Lr</code> </th> <th> <code>Ld</code> </th> <th> <code>Ll</code> </th> <th> <code>Lu</code> </th> <th> <code>Iv</code> </th> <th> <code>Ih</code> </th> </tr><tr><td> <code>Td</code> </td> <td> <code>Td</code> </td> <td> <code>Td</code> </td> <td> <code>Td</code> </td> <td> <code>Jd</code> </td> <td> <code>Jd</code> </td> <td> <code>Jd</code> </td> <td> <code>Jd</code> </td> <td> <code>Zh</code> </td> <td> <code>Zh</code> </td> <td> <code>O</code> </td> <td> <code>Sh</code> </td> <td> <code>Sh</code> </td> <td> <code>Ld</code> </td> <td> <code>Ld</code> </td> <td> <code>Ld</code> </td> <td> <code>Ld</code> </td> <td> <code>Ih</code> </td> <td> <code>Ih</code> </td> </tr></tbody></table></div><br>  Misalnya, semua orientasi J dilampirkan ke <code>Jd</code> . <br><br>  Tabel di <code>$993B</code> berisi tipe Tetrimino untuk ID orientasi yang diberikan. <br><br> <code>993B: 00 00 00 00 ; T <br> 993F: 01 01 01 01 ; J <br> 9943: 02 02 ; Z <br> 9945: 03 ; O <br> 9946: 04 04 ; S <br> 9948: 05 05 05 05 ; L <br> 994C: 06 06 ; I</code> <br> <br>  Untuk lebih jelasnya, saya akan menunjukkan semuanya dalam bentuk tabel. <br><br><div class="scrollable-table"><table><tbody><tr><th> <code>Tu</code> </th> <th> <code>Tr</code> </th> <th> <code>Td</code> </th> <th> <code>Tl</code> </th> <th> <code>Jl</code> </th> <th> <code>Ju</code> </th> <th> <code>Jr</code> </th> <th> <code>Jd</code> </th> <th> <code>Zh</code> </th> <th> <code>Zv</code> </th> <th> <code>O</code> </th> <th> <code>Sh</code> </th> <th> <code>Sv</code> </th> <th> <code>Lr</code> </th> <th> <code>Ld</code> </th> <th> <code>Ll</code> </th> <th> <code>Lu</code> </th> <th> <code>Iv</code> </th> <th> <code>Ih</code> </th> </tr><tr><td> <code>T</code> </td> <td> <code>T</code> </td> <td> <code>T</code> </td> <td> <code>T</code> </td> <td> <code>J</code> </td> <td> <code>J</code> </td> <td> <code>J</code> </td> <td> <code>J</code> </td> <td> <code>Z</code> </td> <td> <code>Z</code> </td> <td> <code>O</code> </td> <td> <code>S</code> </td> <td> <code>S</code> </td> <td> <code>L</code> </td> <td> <code>L</code> </td> <td> <code>L</code> </td> <td> <code>L</code> </td> <td> <code>I</code> </td> <td> <code>I</code> </td> </tr></tbody></table></div><br>  Kami akan melihat tabel pencarian ketiga di bagian selanjutnya. <br><br><h3>  Seleksi tetrimino </h3><br>  Nintendo Tetris menggunakan register geser umpan balik linier (LFSR) 16-bit sebagai pembangkit angka pseudo-acak (PRNG) dalam konfigurasi Fibonacci.  Nilai 16-bit disimpan sebagai big-endian di alamat <code>$0017</code> - <code>$0018</code> .  Angka sewenang-wenang <code>$8988</code> digunakan sebagai Benih. <br><br> <code>80BC: LDX #$89 <br> 80BE: STX $0017 <br> 80C0: DEX <br> 80C1: STX $0018</code> <br> <br>  Setiap angka pseudo-acak berikutnya dihasilkan sebagai berikut: nilainya dianggap sebagai angka 17-bit, dan bit yang paling signifikan diperoleh dengan melakukan XOR untuk bit 1 dan 9. Kemudian nilainya digeser ke kanan, membuang bit yang paling tidak signifikan. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3a0/45d/3f2/3a045d3f2d64a94aa272aa15f351ac7a.png"></div><br>  Proses ini terjadi pada <code>$AB47</code> . <br><br> <code>AB47: LDA $00,X <br> AB49: AND #$02 <br> AB4B: STA $0000 ; extract bit 1 <br> <br> AB4D: LDA $01,X <br> AB4F: AND #$02 ; extract bit 9 <br> <br> AB51: EOR $0000 <br> AB53: CLC <br> AB54: BEQ $AB57 <br> AB56: SEC ; XOR bits 1 and 9 together <br> <br> AB57: ROR $00,X <br> AB59: INX <br> AB5A: DEY ; right shift <br> AB5B: BNE $AB57 ; shifting in the XORed value <br> <br> AB5D: RTS ; return</code> <br> <br>  Menariknya, parameter subrutin di atas dapat diatur sehingga fungsi panggilan dapat menentukan lebar register geser dan alamat di mana ia dapat ditemukan dalam memori.  Namun, parameter yang sama digunakan di mana-mana, sehingga kita dapat mengasumsikan bahwa pengembang meminjam kode ini di suatu tempat. <br><br>  Bagi mereka yang ingin memodifikasi algoritma lebih lanjut, saya menulisnya di Java. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateNextPseudorandomNumber</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> bit1 = (value &gt;&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> bit9 = (value &gt;&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> leftmostBit = bit1 ^ bit9; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (leftmostBit &lt;&lt; <span class="hljs-number"><span class="hljs-number">15</span></span>) | (value &gt;&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>); }</code> </pre> <br>  Dan semua kode ini dapat diperas menjadi satu baris. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateNextPseudorandomNumber</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((((value &gt;&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">1</span></span>) ^ ((value &gt;&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">1</span></span>)) &lt;&lt; <span class="hljs-number"><span class="hljs-number">15</span></span>) | (value &gt;&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>); }</code> </pre> <br>  PRNG ini secara terus menerus dan deterministik menghasilkan 32.767 nilai unik, memulai setiap siklus dari seed asli.  Ini adalah kurang dari setengah dari angka yang mungkin bisa masuk dalam register, dan nilai apa pun dalam set ini dapat digunakan sebagai seed.  Banyak nilai di luar himpunan membuat rantai yang akhirnya mengarah ke nomor dari himpunan.  Namun, beberapa angka awal menghasilkan urutan nol tanpa batas. <br><br>  Untuk mengevaluasi kinerja PRNG ini secara kasar, saya membuat representasi grafis dari nilai-nilai yang dibuatnya berdasarkan kalimat dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">RANDOM.ORG</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/254/477/bef/254477befbd14f540925a6d3169e5179.png"></div><br>  Saat membuat gambar, PRNG digunakan sebagai generator angka pseudo-acak, bukan bilangan bulat 16-bit.  Setiap piksel diwarnai berdasarkan nilai bit 0. Gambar tersebut memiliki ukuran 128 × 256, artinya mencakup seluruh urutan. <br><br>  Terlepas dari garis-garis yang hampir tidak terlihat di sisi atas dan kiri, terlihat acak.  Tidak ada pola yang jelas muncul. <br><br>  Setelah memulai, PRNG secara konstan menggeser register, bekerja setidaknya sekali dalam satu frame.  Ini tidak hanya terjadi pada layar splash dan layar menu, tetapi juga ketika tetrimino jatuh di antara operasi pembuatan bentuk.  Artinya, angka yang muncul berikut ini tergantung pada jumlah frame yang dibutuhkan pemain untuk menempatkan angka tersebut.  Faktanya, permainan bergantung pada keacakan dari tindakan orang yang berinteraksi dengannya. <br><br>  Selama pembuatan gambar, kode dieksekusi di alamat <code>$9907</code> , yang memilih jenis angka baru. <br><br> <code>9907: INC $001A ; spawnCount++; <br> <br> 9909: LDA $0017 ; index = high byte of randomValue; <br> <br> 990B: CLC <br> 990C: ADC $001A ; index += spawnCount; <br> <br> 990E: AND #$07 ; index &amp;= 7; <br> <br> 9910: CMP #$07 ; if (index == 7) { <br> 9912: BEQ $991C ; goto invalidIndex; <br> ; } <br> <br> 9914: TAX <br> 9915: LDA $994E,X ; newSpawnID = spawnTable[index]; <br> <br> 9918: CMP $0019 ; if (newSpawnID != spawnID) { <br> 991A: BNE $9938 ; goto useNewSpawnID; <br> ; } <br> <br> invalidIndex: <br> <br> 991C: LDX #$17 <br> 991E: LDY #$02 <br> 9920: JSR $AB47 ; randomValue = generateNextPseudorandomNumber(randomValue); <br> <br> 9923: LDA $0017 ; index = high byte of randomValue; <br> <br> 9925: AND #$07 ; index &amp;= 7; <br> <br> 9927: CLC <br> 9928: ADC $0019 ; index += spawnID; <br> <br> 992A: CMP #$07 <br> 992C: BCC $9934 <br> 992E: SEC <br> 992F: SBC #$07 <br> 9931: JMP $992A ; index %= 7; <br> <br> 9934: TAX <br> 9935: LDA $994E,X ; newSpawnID = spawnTable[index]; <br> <br> useNewSpawnID: <br> <br> 9938: STA $0019 ; spawnID = newSpawnID; <br> <br> 993A: RTS ; return;</code> <br> <br>  Di alamat <code>$001A</code> toko <code>$001A</code> menyimpan penghitung jumlah angka yang dibuat dengan power-up.  Penambahan penghitung dilakukan oleh baris pertama dari subrutin, dan karena itu adalah penghitung byte tunggal, setelah setiap 256 keping kembali ke nol lagi.  Karena penghitung tidak diatur ulang di antara game, riwayat game sebelumnya memengaruhi proses pemilihan gambar.  Ini adalah cara lain permainan menggunakan pemain sebagai sumber keacakan. <br><br>  Rutin mengubah byte paling signifikan dari nomor pseudo-acak ( <code>$0017</code> ) ke jenis tetrimino dan menggunakannya sebagai indeks tabel yang terletak di <code>$994E</code> untuk mengonversi jenis ke ID orientasi penciptaan bentuk. <br><br> <code>994E: 02 ; Td <br> 994F: 07 ; Jd <br> 9950: 08 ; Zh <br> 9951: 0A ; O <br> 9952: 0B ; Sh <br> 9953: 0E ; Ld <br> 9954: 12 ; Ih</code> <br> <br>  Pada tahap pertama konversi, penghitung angka yang dibuat ditambahkan ke byte atas.  Kemudian topeng diterapkan untuk menyimpan hanya 3 bit yang lebih rendah.  Jika hasilnya bukan 7, maka ini adalah jenis tetrimino yang benar, dan jika tidak sama dengan angka yang dipilih sebelumnya, maka angka tersebut digunakan sebagai indeks dalam tabel untuk membuat angka.  Jika tidak, nomor pseudo-acak berikutnya dihasilkan dan mask diterapkan untuk mendapatkan 3 bit lebih rendah dari byte atas, dan kemudian ID orientasi penciptaan bentuk sebelumnya ditambahkan.  Akhirnya, operasi modulo dilakukan untuk mendapatkan jenis tetrimino yang benar, yang digunakan sebagai indeks dalam tabel pembuatan bentuk. <br><br>  Karena prosesor tidak mendukung pembagian dengan sisa, operator ini ditiru dengan berulang kali mengurangi 7 sampai hasilnya menjadi kurang dari 7. Divisi dengan sisa diterapkan ke jumlah byte atas dengan penutup yang diterapkan dan ke ID orientasi penciptaan bentuk sebelumnya.  Nilai maksimum dari jumlah ini adalah 25. Artinya, untuk menguranginya menjadi sisa 4, hanya 3 iterasi yang diperlukan. <br><br>  Di awal setiap permainan, ID orientasi pembuatan bentuk ( <code>$0019</code> ) diinisialisasi dengan nilai <code>Tu</code> ( <code>$00</code> ).  Nilai ini berpotensi digunakan pada <code>$9928</code> selama pembuatan bentuk pertama. <br><br>  Saat menggunakan ID orientasi sebelumnya untuk membuat gambar, daripada tipe sebelumnya, Tetrimino menambahkan distorsi, karena nilai-nilai ID orientasi tidak terdistribusi secara merata.  Ini ditunjukkan pada tabel: <br><br><div class="scrollable-table"><table><tbody><tr><th>  $ 00 </th><th> <code>$02</code> </th> <th> <code>$07</code> </th> <th> <code>$08</code> </th> <th> <code>$0A</code> </th> <th> <code>$0B</code> </th> <th> <code>$0E</code> </th> <th> <code>$12</code> </th> </tr><tr><th>  0 </th><td>  2 </td><td>  0 </td><td>  1 </td><td>  3 </td><td>  4 </td><td>  0 </td><td>  4 </td></tr><tr><th>  1 </th><td>  3 </td><td>  1 </td><td>  2 </td><td>  4 </td><td>  5 </td><td>  1 </td><td>  5 </td></tr><tr><th>  2 </th><td>  4 </td><td>  2 </td><td>  3 </td><td>  5 </td><td>  6 </td><td>  2 </td><td>  6 </td></tr><tr><th>  3 </th><td>  5 </td><td>  3 </td><td>  4 </td><td>  6 </td><td>  0 </td><td>  3 </td><td>  0 </td></tr><tr><th>  4 </th><td>  6 </td><td>  4 </td><td>  5 </td><td>  0 </td><td>  1 </td><td>  4 </td><td>  1 </td></tr><tr><th>  5 </th><td>  0 </td><td>  5 </td><td>  6 </td><td>  1 </td><td>  2 </td><td>  5 </td><td>  2 </td></tr><tr><th>  6 </th><td>  1 </td><td>  6 </td><td>  0 </td><td>  2 </td><td>  3 </td><td>  6 </td><td>  3 </td></tr><tr><th>  7 </th><td>  2 </td><td>  0 </td><td>  1 </td><td>  3 </td><td>  4 </td><td>  0 </td><td>  4 </td></tr></tbody></table></div><br>  Setiap sel berisi jenis tetrimino, dihitung dengan menambahkan ID orientasi dari gambar yang dibuat (kolom) ke nilai 3-bit (baris), dan kemudian menerapkan sisa pembagian dengan 7. Jumlah, setiap baris berisi duplikat, karena <code>$07</code> dan <code>$0E</code> dibagi secara merata oleh 7, sedangkan <code>$0B</code> dan <code>$12</code> memiliki saldo bersama.  Garis 0 dan 7 sama karena jarak 7. <br><br>  Ada 56 kemungkinan kombinasi input, dan jika tipe tetrimino yang dihasilkan terdistribusi secara merata, maka kita dapat berharap bahwa pada tabel di atas, setiap tipe akan muncul tepat 8 kali.  Tetapi seperti yang ditunjukkan di bawah ini, ini tidak terjadi. <br><br><div class="scrollable-table"><table><tbody><tr><th>  Jenis </th><th>  Frekuensi </th></tr><tr><td>  T </td><td>  9 </td></tr><tr><td>  J </td><td>  8 </td></tr><tr><td>  Z </td><td>  8 </td></tr><tr><td>  O </td><td>  8 </td></tr><tr><td>  S </td><td>  9 </td></tr><tr><td>  L. </td><td>  7 </td></tr><tr><td>  Saya </td><td>  7 </td></tr></tbody></table></div><br>  T dan S muncul lebih sering, dan L dan I - lebih jarang.  Tetapi kode miring menggunakan ID orientasi tidak mengeksekusi setiap kali subrutin dipanggil. <br><br>  Misalkan PRNG memang membuat urutan nilai independen statistik terdistribusi secara seragam.  Ini sebenarnya adalah asumsi yang adil, mengingat bagaimana permainan mencoba untuk mendapatkan keacakan yang tepat dari tindakan pemain.  Menambahkan jumlah angka yang dibuat ke alamat <code>$990C</code> tidak akan mempengaruhi distribusi, karena jumlahnya meningkat secara merata antar panggilan.  Menggunakan bitmask pada <code>$990E</code> mirip dengan menerapkan pembagian dengan 8 dengan sisanya, yang juga tidak mempengaruhi distribusi.  Oleh karena itu, memeriksa <code>$9910</code> masuk ke <code>invalidIndex</code> di 1/8 dari semua kasus.  Dan probabilitas memukul ketika memeriksa di alamat <code>$9918</code> , di mana angka yang baru dipilih dibandingkan dengan angka sebelumnya, adalah 7/8, dengan kemungkinan kebetulan 1/7.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini berarti bahwa ada peluang tambahan untuk </font></font><code>7/8 × 1/7 = 1/8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">masuk </font></font><code>invalidIndex</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Secara umum, ada kemungkinan 25% menggunakan kode miring dan 75% kemungkinan menggunakan kode yang memilih Tetrimino secara merata. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam satu set 224 tetriminos yang dibuat, ekspektasi matematis adalah 32 instance untuk setiap tipe. </font><font style="vertical-align: inherit;">Tetapi sebenarnya kode menciptakan distribusi berikut:</font></font><br><br><div class="scrollable-table"><table><tbody><tr><th>  Jenis </th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Frekuensi </font></font></th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> T </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 33 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> J </font></font></td><td>  32 </td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Z </font></font></td><td>  32 </td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O </font></font></td><td>  32 </td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> S </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 33 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L. </font></font></td><td>  31 </td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Saya </font></font></td><td>  31 </td></tr></tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yaitu, membersihkan 90 garis dan mencapai level 9, pemain akan menerima satu tambahan T dan S dan satu kurang L dan I daripada yang diharapkan secara statistik. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetrimino dipilih dengan probabilitas berikut:</font></font><br><br><div class="scrollable-table"><table><tbody><tr><th>  Jenis </th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kemungkinan </font></font></th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> T </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 14,73% </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> J </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 14,29% </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Z </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 14,29% </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 14,29% </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> S </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 14,73% </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L. </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 13,84% </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Saya </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 13,84% </font></font></td></tr></tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tampaknya dalam pernyataan bahwa "tongkat panjang" saya tidak pernah muncul ketika dibutuhkan, ada bagian dari kebenaran (setidaknya untuk Nintendo Tetris). </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pergeseran Tetrimino </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nintendo Tetris menggunakan Delayed Auto Shift (DAS). </font><font style="vertical-align: inherit;">Mengklik "Kiri" atau "Kanan" langsung menggerakkan tetrimino satu sel secara horizontal. </font><font style="vertical-align: inherit;">Sambil memegang salah satu tombol arah ini menyebabkan game secara otomatis menggeser gambar setiap 6 frame dengan penundaan awal 16 frame. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jenis gerakan horisontal ini dikendalikan oleh kode di alamat </font></font><code>$89AE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Seperti dalam kode rotasi, variabel sementara digunakan di sini untuk membuat cadangan koordinat </font><font style="vertical-align: inherit;">jika posisi baru salah. </font><font style="vertical-align: inherit;">Perhatikan bahwa cek mencegah Anda dari memindahkan potongan sementara pemain menekan Bawah.</font></font><br><br> <code>89AE: LDA $0040 <br> 89B0: STA $00AE ; originalX = tetriminoX; <br> <br> 89B2: LDA $00B6 ; if (pressing down) { <br> 89B4: AND #$04 ; return; <br> 89B6: BNE $8A09 ; } <br> <br> 89B8: LDA $00B5 ; if (just pressed left/right) { <br> 89BA: AND #$03 ; goto resetAutorepeatX; <br> 89BC: BNE $89D3 ; } <br> <br> 89BE: LDA $00B6 ; if (not pressing left/right) { <br> 89C0: AND #$03 ; return; <br> 89C2: BEQ $8A09 ; } <br> <br> 89C4: INC $0046 ; autorepeatX++; <br> 89C6: LDA $0046 ; if (autorepeatX &lt; 16) { <br> 89C8: CMP #$10 ; return; <br> 89CA: BMI $8A09 ; } <br> <br> 89CC: LDA #$0A <br> 89CE: STA $0046 ; autorepeatX = 10; <br> 89D0: JMP $89D7 ; goto buttonHeldDown; <br> <br> resetAutorepeatX: <br> <br> 89D3: LDA #$00 <br> 89D5: STA $0046 ; autorepeatX = 0; <br> <br> buttonHeldDown: <br> <br> 89D7: LDA $00B6 ; if (not pressing right) { <br> 89D9: AND #$01 ; goto notPressingRight; <br> 89DB: BEQ $89EC ; } <br> <br> 89DD: INC $0040 ; tetriminoX++; <br> 89DF: JSR $948B ; if (new position not valid) { <br> 89E2: BNE $8A01 ; goto restoreX; <br> ; } <br> <br> 89E4: LDA #$03 <br> 89E6: STA $06F1 ; play shift sound effect; <br> 89E9: JMP $8A09 ; return; <br> <br> notPressingRight: <br> <br> 89EC: LDA $00B6 ; if (not pressing left) { <br> 89EE: AND #$02 ; return; <br> 89F0: BEQ $8A09 ; } <br> <br> 89F2: DEC $0040 ; tetriminoX--; <br> 89F4: JSR $948B ; if (new position not valid) { <br> 89F7: BNE $8A01 ; goto restoreX; <br> ; } <br> <br> 89F9: LDA #$03 <br> 89FB: STA $06F1 ; play shift sound effect; <br> 89FE: JMP $8A09 ; return; <br> <br> restoreX: <br> <br> 8A01: LDA $00AE <br> 8A03: STA $0040 ; tetriminoX = originalX; <br> <br> 8A05: LDA #$10 <br> 8A07: STA $0046 ; autorepeatX = 16; <br> <br> 8A09: RTS ; return;</code> <br> <br><font style="vertical-align: inherit;"></font><code>x</code><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Melontar Tetrimino </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kecepatan keturunan otomatis Tetrimino adalah fungsi dari angka level. </font><font style="vertical-align: inherit;">Kecepatan dikodekan sebagai jumlah frame yang diberikan untuk keturunan dalam tabel yang terletak di </font></font><code>$898E</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Karena NES beroperasi pada 60,0988 frame / s, Anda dapat menghitung periode antara turun dan kecepatan.</font></font><br><br><div class="scrollable-table"><table><tbody><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Level </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bingkai keturunan </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Periode (s / descent) </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kecepatan (sel / s) </font></font></th></tr><tr><td>  0 </td><td>  48 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .799 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1.25 </font></font></td></tr><tr><td>  1 </td><td>  43 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .715 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1.40 </font></font></td></tr><tr><td>  2 </td><td>  38 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0,632 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1.58 </font></font></td></tr><tr><td>  3 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 33 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0,549 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1,82 </font></font></td></tr><tr><td>  4 </td><td>  28 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0,466 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2.15 </font></font></td></tr><tr><td>  5 </td><td>  23 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .383 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2.61 </font></font></td></tr><tr><td>  6 </td><td>  18 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0,300 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3.34 </font></font></td></tr><tr><td>  7 </td><td>  13 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .216 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4.62 </font></font></td></tr><tr><td>  8 </td><td>  8 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .133 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 7.51 </font></font></td></tr><tr><td>  9 </td><td>  6 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0,100 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10.02 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10-12 </font></font></td><td>  5 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0,083 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 12.02 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 13-15 </font></font></td><td>  4 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0,067 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 15.05 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 16-18 </font></font></td><td>  3 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0,050 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 03/20 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 19–28 </font></font></td><td>  2 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0,033 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 30.05 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 29+ </font></font></td><td>  1 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0,017 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 60.10 </font></font></td></tr></tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabel ini memiliki total 30 entri. Setelah level 29, nilai frame untuk descent selalu 1. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jumlah integer dari frame untuk descent bukanlah cara yang sangat rinci untuk menggambarkan kecepatan. Seperti yang ditunjukkan pada grafik di bawah, kecepatan meningkat secara eksponensial dengan setiap level. Faktanya, level 29 dua kali lebih cepat dari level 28.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ddd/18c/a29/ddd18ca2950f9055bd5f82108a4d3ddc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan 1 frame / keturunan, pemain tidak memiliki lebih dari 1/3 detik untuk memposisikan gambar, setelah itu ia akan mulai bergerak. Pada kecepatan turun ini, DAS tidak memungkinkan gambar untuk mencapai tepi lapangan bermain sampai terkunci di tempatnya, yang bagi kebanyakan orang berarti mengakhiri permainan dengan cepat. Namun, beberapa pemain, terutama </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Thor Akerlund</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , berhasil mengalahkan DAS dengan getaran cepat dari tombol silang ( </font></font><code>D-pad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). Dalam kode shift yang ditunjukkan di atas, dapat dilihat bahwa sementara tombol arah horisontal dilepaskan melalui bingkai, dimungkinkan untuk menggeser tetrimino pada level 29 dan di atas dengan setengah frekuensi. Ini adalah maksimum teoretis, tetapi setiap getaran jempol di atas 3,75 ketukan / s dapat mengalahkan keterlambatan asli 16 frame.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika penurunan otomatis dan pemain-dikendalikan (dengan menekan "Turun") bertepatan dan terjadi dalam satu bingkai, efeknya tidak bertambah. Setiap atau kedua peristiwa ini menyebabkan bentuk turun tepat satu sel dalam bingkai ini. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Logika kendali pemicu terletak di </font></font><code>$8914</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Tabel frame keturunan di bawah label </font><font style="vertical-align: inherit;">. Seperti disebutkan di atas, pada level 29 dan di atas, kecepatannya secara konstan sama dengan 1 shutter / frame. </font><font style="vertical-align: inherit;">(alamat </font><font style="vertical-align: inherit;">) memulai keturunan saat mencapai </font><font style="vertical-align: inherit;">( </font><font style="vertical-align: inherit;">). Peningkatan </font><font style="vertical-align: inherit;">dilakukan pada alamat di </font><font style="vertical-align: inherit;">luar fragmen kode ini. Selama penurunan otomatis atau terkontrol, itu diatur ulang ke 0. </font><font style="vertical-align: inherit;">Variabel </font><font style="vertical-align: inherit;">( </font><font style="vertical-align: inherit;">) diinisialisasi dengan nilai </font><font style="vertical-align: inherit;">(di alamat</font></font><br><br> <code>8914: LDA $004E ; if (autorepeatY &gt; 0) { <br> 8916: BPL $8922 ; goto autorepeating; <br> ; } else if (autorepeatY == 0) { <br> ; goto playing; <br> ; } <br> <br> ; game just started <br> ; initial Tetrimino hanging at spawn point <br> <br> 8918: LDA $00B5 ; if (not just pressed down) { <br> 891A: AND #$04 ; goto incrementAutorepeatY; <br> 891C: BEQ $8989 ; } <br> <br> ; player just pressed down ending startup delay <br> <br> 891E: LDA #$00 <br> 8920: STA $004E ; autorepeatY = 0; <br> 8922: BNE $8939 <br> <br> playing: <br> <br> 8924: LDA $00B6 ; if (left or right pressed) { <br> 8926: AND #$03 ; goto lookupDropSpeed; <br> 8928: BNE $8973 ; } <br> <br> ; left/right not pressed <br> <br> 892A: LDA $00B5 <br> 892C: AND #$0F ; if (not just pressed only down) { <br> 892E: CMP #$04 ; goto lookupDropSpeed; <br> 8930: BNE $8973 ; } <br> <br> ; player exclusively just presssed down <br> <br> 8932: LDA #$01 <br> 8934: STA $004E ; autorepeatY = 1; <br> <br> 8936: JMP $8973 ; goto lookupDropSpeed; <br> <br> autorepeating: <br> <br> 8939: LDA $00B6 <br> 893B: AND #$0F ; if (down pressed and not left/right) { <br> 893D: CMP #$04 ; goto downPressed; <br> 893F: BEQ $894A ; } <br> <br> ; down released <br> <br> 8941: LDA #$00 <br> 8943: STA $004E ; autorepeatY = 0 <br> 8945: STA $004F ; holdDownPoints = 0 <br> 8947: JMP $8973 ; goto lookupDropSpeed; <br> <br> downPressed: <br> <br> 894A: INC $004E ; autorepeatY++; <br> 894C: LDA $004E <br> 894E: CMP #$03 ; if (autorepeatY &lt; 3) { <br> 8950: BCC $8973 ; goto lookupDropSpeed; <br> ; } <br> <br> 8952: LDA #$01 <br> 8954: STA $004E ; autorepeatY = 1; <br> <br> 8956: INC $004F ; holdDownPoints++; <br> <br> drop: <br> <br> 8958: LDA #$00 <br> 895A: STA $0045 ; fallTimer = 0; <br> <br> 895C: LDA $0041 <br> 895E: STA $00AE ; originalY = tetriminoY; <br> <br> 8960: INC $0041 ; tetriminoY++; <br> 8962: JSR $948B ; if (new position valid) { <br> 8965: BEQ $8972 ; return; <br> ; } <br> <br> ; the piece is locked <br> <br> 8967: LDA $00AE <br> 8969: STA $0041 ; tetriminoY = originalY; <br> <br> 896B: LDA #$02 <br> 896D: STA $0048 ; playState = UPDATE_PLAYFIELD; <br> 896F: JSR $9CAF ; updatePlayfield(); <br> <br> 8972: RTS ; return; <br> <br> lookupDropSpeed: <br> <br> 8973: LDA #$01 ; tempSpeed = 1; <br> <br> 8975: LDX $0044 ; if (level &gt;= 29) { <br> 8977: CPX #$1D ; goto noTableLookup; <br> 8979: BCS $897E ; } <br> <br> 897B: LDA $898E,X ; tempSpeed = framesPerDropTable[level]; <br> <br> noTableLookup: <br> <br> 897E: STA $00AF ; dropSpeed = tempSpeed; <br> <br> 8980: LDA $0045 ; if (fallTimer &gt;= dropSpeed) { <br> 8982: CMP $00AF ; goto drop; <br> 8984: BPL $8958 ; } <br> <br> 8986: JMP $8972 ; return; <br> <br> incrementAutorepeatY: <br> <br> 8989: INC $004E ; autorepeatY++; <br> 898B: JMP $8972 ; return;</code> <br> <br><font style="vertical-align: inherit;"></font><code>lookupDropSpeed</code><font style="vertical-align: inherit;"></font><br><br> <code>fallTimer</code><font style="vertical-align: inherit;"></font><code>$0045</code><font style="vertical-align: inherit;"></font><code>dropSpeed</code><font style="vertical-align: inherit;"></font><code>$00AF</code><font style="vertical-align: inherit;"></font><code>fallTimer</code><font style="vertical-align: inherit;"></font><code>$8892</code><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><code>autorepeatY</code><font style="vertical-align: inherit;"></font><code>$004E</code><font style="vertical-align: inherit;"></font><code>$0A</code><font style="vertical-align: inherit;"></font><code>$8739</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), yang ditafsirkan sebagai −96. Suatu kondisi di awal menyebabkan penundaan awal. Tetrimino pertama tetap berada di udara pada titik penciptaan hingga </font></font><code>autorepeatY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">meningkat menjadi 0, yang membutuhkan 1,6 detik. Namun, ketika Anda menekan Turun dalam fase ini, itu </font></font><code>autorepeatY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">langsung ditetapkan 0. Sangat menarik bahwa Anda dapat memindahkan dan memutar angka dalam fase ini dari penundaan awal tanpa membatalkannya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peningkatan </font></font><code>autorepeatY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dilakukan sambil menahan. Ketika mencapai 3, penurunan yang dikontrol pria (keturunan "lembut") terjadi dan </font></font><code>autorepeatY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ditetapkan 1. Oleh karena itu, penurunan lembut awal memerlukan 3 frame, tetapi kemudian diulang di setiap frame. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selain itu, </font></font><code>autorepeatY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peningkatan dari 0 menjadi 1 hanya ketika permainan mengakui bahwa pemain baru saja mengklik Bawah (at</font></font><code>$00B5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), tetapi tidak mengakui menahan. Ini penting karena </font></font><code>autorepeatY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diatur ulang ke 0 saat membuat Tetrimino (di alamat </font></font><code>$98E8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), yang menciptakan fitur penting: jika pemain sendiri menurunkan angka dan diblokir, dan ia terus menekan "Turun" ketika membuat angka berikutnya, yang sering terjadi pada level tinggi, lalu ini tidak akan menyebabkan keturunan lembut dari sosok baru. Agar ini terjadi, pemain harus melepaskan "Bawah," dan kemudian tekan tombol lagi. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keturunan yang berpotensi lembut dapat meningkatkan poin. </font></font><code>holdDownPoints</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font><code>$004F</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) meningkat dengan setiap keturunan, tetapi ketika dirilis, "Down" diatur ulang ke 0. Oleh karena itu, untuk mencetak poin, perlu untuk menurunkan tetrimino ke dalam kunci dengan keturunan lembut. Keturunan lunak jangka pendek, yang mungkin terjadi di jalan gambar, tidak mempengaruhi poin. Akun diperbarui di alamat</font></font><code>$9BFE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, tetapi </font></font><code>holdDownPoints</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diatur ulang ke 0 segera setelah itu, di alamat </font></font><code>$9C2F</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cek, yang mencegah pemain melakukan penurunan lembut dengan pergeseran horisontal angka, mempersulit set poin. Ini berarti bahwa langkah terakhir sebelum mengunci bagian di tempat harus "Turun." </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketika keturunan terjadi, </font></font><code>tetriminoY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>$0041</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) disalin ke </font></font><code>originalY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>$00AE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). Jika posisi baru yang dibuat oleh kenaikan </font></font><code>tetriminoY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ternyata tidak benar (yaitu, angka itu mendorong lantai lapangan bermain, atau ditumpangkan pada kotak yang sudah berbohong), maka tetrimino tetap di posisi sebelumnya. Dalam hal ini, ini dikembalikan</font></font><code>tetriminoY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan angka tersebut dianggap diblokir. </font><font style="vertical-align: inherit;">Ini berarti bahwa penundaan sebelum penguncian (jumlah maksimum frame yang diharapkan tetrimino, tahan di udara sebelum mengunci) sama dengan penundaan dalam penurunan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keturunan kaku (langsung jatuh) tidak didukung di Nintendo Tetris.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Geser dan Gulir </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Buklet manual Nintendo Tetris memiliki contoh slip bergambar: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f6f/4bb/647/f6f4bb647937094d3d68fae530b0bfd4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geser terdiri dari pemindahan di sepanjang permukaan figur-figur lain atau di sepanjang lantai lapangan bermain. </font><font style="vertical-align: inherit;">Biasanya digunakan untuk mendorong sosok di bawah kotak menggantung. </font><font style="vertical-align: inherit;">Geser dapat dilakukan sampai waktu jatuh mencapai kecepatan turun, setelah itu angka akan terkunci di tempatnya. </font><font style="vertical-align: inherit;">Contoh animasi ditunjukkan di bawah ini.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/efe/9f5/022/efe9f502248d4185409fc20db3a47647.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Di sisi lain, menggulir memungkinkan Anda untuk mendorong angka ke dalam ruang yang tidak dapat dicapai dengan cara lain (lihat di bawah). </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c53/ca5/350/c53ca53509826b9f2c462c0290ffa9c9.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti halnya meluncur, menggulir tidak dimungkinkan tanpa penundaan kunci. Tapi di luar itu, gulir mengeksploitasi cara permainan memanipulasi bentuk. Sebelum memindahkan atau memutar angka, permainan memeriksa bahwa setelah mengubah posisi semua kotak tetrimino akan berada di sel kosong dalam batas-batas lapangan bermain. Pemeriksaan seperti itu, seperti yang ditunjukkan di bawah ini, tidak mencegah rotasi melalui blok yang diisi di dekatnya. </font><font style="vertical-align: inherit;">Sebagaimana dinyatakan dalam bagian Deskripsi Tetrimino, setiap baris tabel orientasi berisi 12 byte; oleh karena itu, indeks dalam tabel ini dihitung dengan mengalikan ID orientasi tetrimino aktif dengan 12. Seperti yang ditunjukkan di bawah ini, semua perkalian dalam rutin dilakukan dengan menggunakan shift dan penambahan.</font></font><br><br> <code>948B: LDA $0041 <br> 948D: ASL <br> 948E: STA $00A8 <br> 9490: ASL <br> 9491: ASL <br> 9492: CLC <br> 9493: ADC $00A8 <br> 9495: ADC $0040 <br> 9497: STA $00A8 <br> <br> 9499: LDA $0042 <br> 949B: ASL <br> 949C: ASL <br> 949D: STA $00A9 <br> 949F: ASL <br> 94A0: CLC <br> 94A1: ADC $00A9 <br> 94A3: TAX ; index = 12 * orientationID; <br> 94A4: LDY #$00 <br> <br> 94A6: LDA #$04 <br> 94A8: STA $00AA ; for(i = 0; i &lt; 4; i++) { <br> <br> 94AA: LDA $8A9C,X ; squareY = orientationTable[index]; <br> 94AD: CLC <br> 94AE: ADC $0041 ; cellY = squareY + tetriminoY; <br> 94B0: ADC #$02 ; if (cellY &lt; -2 || cellY &gt;= 20) { <br> 94B2: CMP #$16 ; return false; <br> 94B4: BCS $94E9 ; } <br> <br> 94B6: LDA $8A9C,X <br> 94B9: ASL <br> 94BA: STA $00AB <br> 94BC: ASL <br> 94BD: ASL <br> 94BE: CLC <br> 94BF: ADC $00AB <br> 94C1: CLC <br> 94C2: ADC $00A8 <br> 94C4: STA $00AD <br> <br> 94C6: INX <br> 94C7: INX ; index += 2; <br> <br> 94C8: LDA $8A9C,X ; squareX = orientationTable[index]; <br> 94CB: CLC <br> 94CC: ADC $00AD <br> 94CE: TAY ; cellX = squareX + tetriminoX; <br> 94CF: LDA ($B8),Y ; if (playfield[10 * cellY + cellX] != EMPTY_TILE) { <br> 94D1: CMP #$EF ; return false; <br> 94D3: BCC $94E9 ; } <br> <br> 94D5: LDA $8A9C,X <br> 94D8: CLC <br> 94D9: ADC $0040 ; if (cellX &lt; 0 || cellX &gt;= 10) { <br> 94DB: CMP #$0A ; return false; <br> 94DD: BCS $94E9 ; } <br> <br> 94DF: INX ; index++; <br> 94E0: DEC $00AA <br> 94E2: BNE $94AA ; } <br> <br> 94E4: LDA #$00 <br> 94E6: STA $00A8 <br> 94E8: RTS ; return true; <br> <br> 94E9: LDA #$FF <br> 94EB: STA $00A8 <br> 94ED: RTS</code> <br> <br><font style="vertical-align: inherit;"></font><br><br> <code>index = (orientationID &lt;&lt; 3) + (orientationID &lt;&lt; 2); // index = 8 * orientationID + 4 * orientationID; <br> <br> (cellY &lt;&lt; 3) + (cellY &lt;&lt; 1) // 8 * cellY + 2 * cellY</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setiap iterasi siklus menggeser posisi tetrimino oleh koordinat relatif dari salah satu kotak dari tabel orientasi untuk mendapatkan lokasi sel yang sesuai di lapangan bermain. Dia kemudian memeriksa bahwa koordinat sel berada dalam batas-batas lapangan bermain, dan bahwa sel itu sendiri kosong. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Komentar lebih jelas menggambarkan cara memeriksa spasi baris. </font><font style="vertical-align: inherit;">Selain sel-sel dalam garis yang terlihat, kode menganggap dua garis tersembunyi di atas lapangan bermain sebagai posisi hukum kotak tanpa menggunakan kondisi gabungan. Ini berfungsi karena dalam </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">kode tambahan</font></a><font style="vertical-align: inherit;"> angka negatif yang diwakili oleh variabel byte tunggal setara dengan nilai yang lebih besar dari 127. Dalam kasus ini, nilai minimum </font><font style="vertical-align: inherit;">adalah −2, yang disimpan sebagai</font></font><br><br> <code>94AA: LDA $8A9C,X ; squareY = orientationTable[index]; <br> 94AD: CLC <br> 94AE: ADC $0041 ; cellY = squareY + tetriminoY; <br> 94B0: ADC #$02 ; if (cellY + 2 &gt;= 22) { <br> 94B2: CMP #$16 ; return false; <br> 94B4: BCS $94E9 ; }</code> <br> <br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><code>cellY</code><font style="vertical-align: inherit;"></font><code>$FE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(254 dalam notasi desimal).</font><font style="vertical-align: inherit;"> Aneh cek interval itu</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indeks dari lapangan bermain adalah jumlah </font></font><code>cellY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dikalikan dengan 10 dan </font></font><code>cellX</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Namun, ketika </font></font><code>cellY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">−1 ( </font></font><code>$FF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= 255) atau −2 ( </font></font><code>$FE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= 254), produk menghasilkan −10 ( </font></font><code>$F6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= 246) dan −20 ( </font></font><code>$EC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= 236). Berada dalam interval, </font></font><code>cellX</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bisa tidak lebih dari 9, yang memberikan indeks maksimum 246 + 9 = 255, dan ini jauh lebih jauh dari akhir lapangan bermain. Namun, game ini menginisialisasi </font></font><code>$0400</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>$04FF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan nilai </font></font><code>$EF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ubin kosong), menciptakan 56 byte tambahan ruang kosong. </font><font style="vertical-align: inherit;">dilakukan setelah memeriksa sel lapangan bermain. Tapi itu berfungsi dengan benar dalam urutan apa pun. Selain itu, memeriksa interval menghindari kondisi komposit, seperti yang ditunjukkan dalam komentar di bawah ini.</font></font><br><br><code>cellX</code><font style="vertical-align: inherit;"></font><br><br> <code>94D5: LDA $8A9C,X <br> 94D8: CLC <br> 94D9: ADC $0040 ; if (cellX &gt;= 10) { <br> 94DB: CMP #$0A ; return false; <br> 94DD: BCS $94E9 ; }</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Contoh bergulir yang ditunjukkan di bawah ini dimungkinkan karena cara kode ini memeriksa posisi. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/45f/c2d/dc0/45fc2ddc0d156d534aad4fd065b86aa4.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/15f/185/0db/15f1850dbfca0b491498e8d81ab03877.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Seperti yang ditunjukkan di bawah ini, Anda bahkan dapat melakukan geser dengan menggulir. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/08f/74c/c78/08f74cc7825cd53d5a8002b8e33c4612.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> AI mengambil keuntungan penuh dari kemampuan bergerak Nintendo Tetris, termasuk sliding dan scrolling. </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Level 30 ke atas </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Setelah mencapai level 30, tampaknya level tersebut diatur ulang ke nol. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/feb/fee/b1f/febfeeb1faafda1a70f5da385c2276ac.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tetapi level 31 menunjukkan bahwa sesuatu yang lain sedang terjadi: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/26e/057/20c/26e05720ca15aa302a0b61e09498e5a0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nilai level yang ditampilkan terletak di tabel di alamat </font></font><code>$96B8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <code>96B8: 00 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti ditunjukkan di bawah, tabel pola memerintahkan agar ubin dengan </font></font><code>$00</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di </font></font><code>$0F</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adalah simbol untuk mesin terbang </font></font><code>0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pada </font></font><code>F</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ini berarti bahwa ketika menampilkan angka desimal atau heksadesimal, nilai digit itu sendiri digunakan sebagai indeks dari tabel pola. Dalam kasus kami, nilai level disimpan sebagai binary-coded decimal (BCD); setiap gigitan dari setiap byte dalam urutan adalah nilai ubin.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e00/97a/713/e0097a713f629afaf73936d3192820e3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sayangnya, tampaknya para desainer game berasumsi bahwa tidak ada yang akan lulus level 29, dan karena itu memutuskan untuk memasukkan hanya 30 entri ke dalam tabel. Nilai yang ditampilkan aneh adalah byte yang berbeda setelah tabel. Hanya satu byte (di alamat </font></font><code>$0044</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) yang </font><font style="vertical-align: inherit;">digunakan untuk menunjukkan nomor level </font><font style="vertical-align: inherit;">, itulah sebabnya permainan perlahan-lahan memutar sekitar 256 nilai yang ditunjukkan di bawah ini.</font></font><br><br><div class="scrollable-table"><table><tbody><tr><th> <code>00</code> </th> <th> <code>0</code> </th> <th> <code>1</code> </th> <th> <code>2</code> </th> <th> <code>3</code> </th> <th> <code>4</code> </th> <th> <code>5</code> </th> <th> <code>6</code> </th> <th> <code>7</code> </th> <th> <code>8</code> </th> <th> <code>9</code> </th> <th> <code>A</code> </th> <th> <code>B</code> </th> <th> <code>C</code> </th> <th> <code>D</code> </th> <th> <code>E</code> </th> <th> <code>F</code> </th> </tr><tr><th> <code>0</code> </th> <td> <code>00</code> </td> <td> <code>01</code> </td> <td> <code>02</code> </td> <td> <code>03</code> </td> <td> <code>04</code> </td> <td> <code>05</code> </td> <td> <code>06</code> </td> <td> <code>07</code> </td> <td> <code>08</code> </td> <td> <code>09</code> </td> <td> <code>10</code> </td> <td> <code>11</code> </td> <td> <code>12</code> </td> <td> <code>13</code> </td> <td> <code>14</code> </td> <td> <code>15</code> </td> </tr><tr><th> <code>1</code> </th> <td> <code>16</code> </td> <td> <code>17</code> </td> <td> <code>18</code> </td> <td> <code>19</code> </td> <td> <code>20</code> </td> <td> <code>21</code> </td> <td> <code>22</code> </td> <td> <code>23</code> </td> <td> <code>24</code> </td> <td> <code>25</code> </td> <td> <code>26</code> </td> <td> <code>27</code> </td> <td> <code>28</code> </td> <td> <code>29</code> </td> <td> <code>00</code> </td> <td> <code>0A</code> </td> </tr><tr><th> <code>2</code> </th> <td> <code>14</code> </td> <td> <code>1E</code> </td> <td> <code>28</code> </td> <td> <code>32</code> </td> <td> <code>3C</code> </td> <td> <code>46</code> </td> <td> <code>50</code> </td> <td> <code>5A</code> </td> <td> <code>64</code> </td> <td> <code>6E</code> </td> <td> <code>78</code> </td> <td> <code>82</code> </td> <td> <code>8C</code> </td> <td> <code>96</code> </td> <td> <code>A0</code> </td> <td> <code>AA</code> </td> </tr><tr><th> <code>3</code> </th> <td> <code>B4</code> </td> <td> <code>BE</code> </td> <td> <code>C6</code> </td> <td> <code>20</code> </td> <td> <code>E6</code> </td> <td> <code>20</code> </td> <td> <code>06</code> </td> <td> <code>21</code> </td> <td> <code>26</code> </td> <td> <code>21</code> </td> <td> <code>46</code> </td> <td> <code>21</code> </td> <td> <code>66</code> </td> <td> <code>21</code> </td> <td> <code>86</code> </td> <td> <code>21</code> </td> </tr><tr><th> <code>4</code> </th> <td> <code>A6</code> </td> <td> <code>21</code> </td> <td> <code>C6</code> </td> <td> <code>21</code> </td> <td> <code>E6</code> </td> <td> <code>21</code> </td> <td> <code>06</code> </td> <td> <code>22</code> </td> <td> <code>26</code> </td> <td> <code>22</code> </td> <td> <code>46</code> </td> <td> <code>22</code> </td> <td> <code>66</code> </td> <td> <code>22</code> </td> <td> <code>86</code> </td> <td> <code>22</code> </td> </tr><tr><th> <code>5</code> </th> <td> <code>A6</code> </td> <td> <code>22</code> </td> <td> <code>C6</code> </td> <td> <code>22</code> </td> <td> <code>E6</code> </td> <td> <code>22</code> </td> <td> <code>06</code> </td> <td> <code>23</code> </td> <td> <code>26</code> </td> <td> <code>23</code> </td> <td> <code>85</code> </td> <td> <code>A8</code> </td> <td> <code>29</code> </td> <td> <code>F0</code> </td> <td> <code>4A</code> </td> <td> <code>4A</code> </td> </tr><tr><th> <code>6</code> </th> <td> <code>4A</code> </td> <td> <code>4A</code> </td> <td> <code>8D</code> </td> <td> <code>07</code> </td> <td> <code>20</code> </td> <td> <code>A5</code> </td> <td> <code>A8</code> </td> <td> <code>29</code> </td> <td> <code>0F</code> </td> <td> <code>8D</code> </td> <td> <code>07</code> </td> <td> <code>20</code> </td> <td> <code>60</code> </td> <td> <code>A6</code> </td> <td> <code>49</code> </td> <td> <code>E0</code> </td> </tr><tr><th> <code>7</code> </th> <td> <code>15</code> </td> <td> <code>10</code> </td> <td> <code>53</code> </td> <td> <code>BD</code> </td> <td> <code>D6</code> </td> <td> <code>96</code> </td> <td> <code>A8</code> </td> <td> <code>8A</code> </td> <td> <code>0A</code> </td> <td> <code>AA</code> </td> <td> <code>E8</code> </td> <td> <code>BD</code> </td> <td> <code>EA</code> </td> <td> <code>96</code> </td> <td> <code>8D</code> </td> <td> <code>06</code> </td> </tr><tr><th> <code>8</code> </th> <td> <code>20</code> </td> <td> <code>CA</code> </td> <td> <code>A5</code> </td> <td> <code>BE</code> </td> <td> <code>C9</code> </td> <td> <code>01</code> </td> <td> <code>F0</code> </td> <td> <code>1E</code> </td> <td> <code>A5</code> </td> <td> <code>B9</code> </td> <td> <code>C9</code> </td> <td> <code>05</code> </td> <td> <code>F0</code> </td> <td> <code>0C</code> </td> <td> <code>BD</code> </td> <td> <code>EA</code> </td> </tr><tr><th> <code>9</code> </th> <td> <code>96</code> </td> <td> <code>38</code> </td> <td> <code>E9</code> </td> <td> <code>02</code> </td> <td> <code>8D</code> </td> <td> <code>06</code> </td> <td> <code>20</code> </td> <td> <code>4C</code> </td> <td> <code>67</code> </td> <td> <code>97</code> </td> <td> <code>BD</code> </td> <td> <code>EA</code> </td> <td> <code>96</code> </td> <td> <code>18</code> </td> <td> <code>69</code> </td> <td> <code>0C</code> </td> </tr><tr><th> <code>A</code> </th> <td> <code>8D</code> </td> <td> <code>06</code> </td> <td> <code>20</code> </td> <td> <code>4C</code> </td> <td> <code>67</code> </td> <td> <code>97</code> </td> <td> <code>BD</code> </td> <td> <code>EA</code> </td> <td> <code>96</code> </td> <td> <code>18</code> </td> <td> <code>69</code> </td> <td> <code>06</code> </td> <td> <code>8D</code> </td> <td> <code>06</code> </td> <td> <code>20</code> </td> <td> <code>A2</code> </td> </tr><tr><th> <code>B</code> </th> <td> <code>0A</code> </td> <td> <code>B1</code> </td> <td> <code>B8</code> </td> <td> <code>8D</code> </td> <td> <code>07</code> </td> <td> <code>20</code> </td> <td> <code>C8</code> </td> <td> <code>CA</code> </td> <td> <code>D0</code> </td> <td> <code>F7</code> </td> <td> <code>E6</code> </td> <td> <code>49</code> </td> <td> <code>A5</code> </td> <td> <code>49</code> </td> <td> <code>C9</code> </td> <td> <code>14</code> </td> </tr><tr><th> <code>C</code> </th> <td> <code>30</code> </td> <td> <code>04</code> </td> <td> <code>A9</code> </td> <td> <code>20</code> </td> <td> <code>85</code> </td> <td> <code>49</code> </td> <td> <code>60</code> </td> <td> <code>A5</code> </td> <td> <code>B1</code> </td> <td> <code>29</code> </td> <td> <code>03</code> </td> <td> <code>D0</code> </td> <td> <code>78</code> </td> <td> <code>A9</code> </td> <td> <code>00</code> </td> <td> <code>85</code> </td> </tr><tr><th> <code>D</code> </th> <td> <code>AA</code> </td> <td> <code>A6</code> </td> <td> <code>AA</code> </td> <td> <code>B5</code> </td> <td> <code>4A</code> </td> <td> <code>F0</code> </td> <td> <code>5C</code> </td> <td> <code>0A</code> </td> <td> <code>A8</code> </td> <td> <code>B9</code> </td> <td> <code>EA</code> </td> <td> <code>96</code> </td> <td> <code>85</code> </td> <td> <code>A8</code> </td> <td> <code>A5</code> </td> <td> <code>BE</code> </td> </tr><tr><th> <code>E</code> </th> <td> <code>C9</code> </td> <td> <code>01</code> </td> <td> <code>D0</code> </td> <td> <code>0A</code> </td> <td> <code>A5</code> </td> <td> <code>A8</code> </td> <td> <code>18</code> </td> <td> <code>69</code> </td> <td> <code>06</code> </td> <td> <code>85</code> </td> <td> <code>A8</code> </td> <td> <code>4C</code> </td> <td> <code>BD</code> </td> <td> <code>97</code> </td> <td> <code>A5</code> </td> <td> <code>B9</code> </td> </tr><tr><th> <code>F</code> </th> <td> <code>C9</code> </td> <td> <code>04</code> </td> <td> <code>D0</code> </td> <td> <code>0A</code> </td> <td> <code>A5</code> </td> <td> <code>A8</code> </td> <td> <code>38</code> </td> <td> <code>E9</code> </td> <td> <code>02</code> </td> <td> <code>85</code> </td> <td> <code>A8</code> </td> <td> <code>4C</code> </td> <td> <code>BD</code> </td> <td> <code>97</code> </td> <td> <code>A5</code> </td> <td> <code>A8</code> </td> </tr></tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20 nilai ordinal pertama sebenarnya adalah tabel lain yang menyimpan offset pada lapangan bermain untuk masing-masing dari 20 baris. </font><font style="vertical-align: inherit;">Karena bidang permainan dimulai dengan </font><font style="vertical-align: inherit;">dan setiap baris berisi 10 sel, alamat sel sewenang-wenang adalah: </font><font style="vertical-align: inherit;">Mengingat bahwa prosesor tidak mendukung perkalian secara langsung, tabel pencarian ini menyediakan cara yang sangat cepat untuk mendapatkan produk. </font><font style="vertical-align: inherit;">Tabel yang sesuai menempati 40 byte berikutnya. </font><font style="vertical-align: inherit;">Ini berisi 20 alamat dalam format endian kecil untuk nametable 0 (area memori VRAM yang berisi nilai ubin latar belakang). </font><font style="vertical-align: inherit;">Mereka adalah pointer ke garis offset lapangan bermain </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Bytes yang tersisa dari mana nilai level yang ditampilkan disusun adalah instruksi.</font></font><br><br> <code>96D6: 00 ; 0 <br> 96D7: 0A ; 10 <br> 96D8: 14 ; 20 <br> 96D9: 1E ; 30 <br> 96DA: 28 ; 40 <br> 96DB: 32 ; 50 <br> 96DC: 3C ; 60 <br> 96DD: 46 ; 70 <br> 96DE: 50 ; 80 <br> 96DF: 5A ; 90 <br> 96E0: 64 ; 100 <br> 96E1: 6E ; 110 <br> 96E2: 78 ; 120 <br> 96E3: 82 ; 130 <br> 96E4: 8C ; 140 <br> 96E5: 96 ; 150 <br> 96E6: A0 ; 160 <br> 96E7: AA ; 170 <br> 96E8: B4 ; 180 <br> 96E9: BE ; 190</code> <br> <br><font style="vertical-align: inherit;"></font><code>$0400</code><font style="vertical-align: inherit;"></font><br><br> <code>$0400 + 10 * y + x</code> <br> <br><font style="vertical-align: inherit;"></font><br><br> <code>$0400 + [$96D6 + y] + x</code> <br> <br><font style="vertical-align: inherit;"></font><code>$06</code><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Baris dan statistik </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jumlah baris dan statistik tetrimino yang lengkap masing-masing menempati 2 byte di alamat berikut. </font></font><br><br><div class="scrollable-table"><table><tbody><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Alamat </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jumlah </font></font></th></tr><tr><td> <code>0050</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><code>0051</code> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Peringkat </font></font></td></tr><tr><td> <code>03F0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><code>03F1</code> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> T </font></font></td></tr><tr><td> <code>03F2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><code>03F3</code> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> J </font></font></td></tr><tr><td> <code>03F4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><code>03F5</code> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Z </font></font></td></tr><tr><td> <code>03F6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><code>03F7</code> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O </font></font></td></tr><tr><td> <code>03F8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><code>03F9</code> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> S </font></font></td></tr><tr><td> <code>03FA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><code>03FB</code> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L. </font></font></td></tr><tr><td> <code>03FC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><code>03FD</code> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Saya </font></font></td></tr></tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bahkan, nilai-nilai ini disimpan sebagai BCD endian kecil 16-bit yang dikemas. </font><font style="vertical-align: inherit;">Misalnya, jumlah baris ditampilkan di bawah ini, yaitu 123. Byte dihitung dari kanan ke kiri sehingga angka desimal berjalan berurutan.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4f4/68b/c0e/4f468bc0e6f22afe40d74f1711bad46e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namun, para desainer game mengasumsikan bahwa tidak ada nilai yang lebih besar dari 999. Oleh karena itu, logika tampilan memproses byte pertama dengan benar sebagai BCD yang dikemas, di mana setiap nibble digunakan sebagai nilai ubin. </font><font style="vertical-align: inherit;">Tetapi keseluruhan byte kedua sebenarnya digunakan sebagai angka desimal teratas. </font><font style="vertical-align: inherit;">Ketika digit bawah beralih dari </font></font><code>99</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ke </font></font><code>00</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, kenaikan normal dari byte kedua terjadi. </font><font style="vertical-align: inherit;">Akibatnya, byte kedua siklus melalui semua 256 ubin. </font><font style="vertical-align: inherit;">Contohnya ditunjukkan di bawah ini.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6c7/b4a/d52/6c7b4ad52a59641b8c2e04971415f0df.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setelah menghapus baris, kode berikut dijalankan untuk menambah jumlah baris. </font><font style="vertical-align: inherit;">Pemeriksaan dilakukan untuk digit tengah dan bawah sehingga mereka tetap antara 0 dan 9. Tetapi digit atas dapat ditingkatkan tanpa batas. </font><font style="vertical-align: inherit;">Jika setelah penambahan jumlah baris, angka yang lebih rendah adalah 0, maka ini berarti bahwa pemain baru saja menyelesaikan serangkaian 10 baris dan Anda perlu menambah nomor level. Seperti yang dapat Anda lihat dari kode di bawah ini, pemeriksaan tambahan dilakukan sebelum kenaikan level. </font><font style="vertical-align: inherit;">Pemeriksaan kedua terkait dengan level entri yang dipilih. Untuk menuju ke level tertentu </font><font style="vertical-align: inherit;">, terlepas dari level awal, pemain harus membersihkan</font></font><br><br> <code>9BA8: INC $0050 ; increment middle-lowest digit pair <br> 9BAA: LDA $0050 <br> 9BAC: AND #$0F <br> 9BAE: CMP #$0A ; if (lowest digit &gt; 9) { <br> 9BB0: BMI $9BC7 <br> 9BB2: LDA $0050 <br> 9BB4: CLC <br> 9BB5: ADC #$06 ; set lowest digit to 0, increment middle digit <br> 9BB7: STA $0050 <br> 9BB9: AND #$F0 <br> 9BBB: CMP #$A0 ; if (middle digit &gt; 9) { <br> 9BBD: BCC $9BC7 <br> 9BBF: LDA $0050 <br> 9BC1: AND #$0F <br> 9BC3: STA $0050 ; set middle digit to 0 <br> 9BC5: INC $0051 ; increment highest digit <br> ; } <br> ; }</code> <br> <br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br> <code>9BC7: LDA $0050 <br> 9BC9: AND #$0F <br> 9BCB: BNE $9BFB ; if (lowest digit == 0) { <br> 9BCD: JMP $9BD0 <br> <br> 9BD0: LDA $0051 <br> 9BD2: STA $00A9 <br> 9BD4: LDA $0050 <br> 9BD6: STA $00A8 ; copy digits from $0050-$0051 to $00A8-$00A9 <br> <br> 9BD8: LSR $00A9 <br> 9BDA: ROR $00A8 <br> 9BDC: LSR $00A9 <br> 9BDE: ROR $00A8 <br> 9BE0: LSR $00A9 <br> 9BE2: ROR $00A8 ; treat $00A8-$00A9 as a 16-bit packed BCD value <br> 9BE4: LSR $00A9 ; and right-shift it 4 times <br> 9BE6: ROR $00A8 ; this leaves the highest and middle digits in $00A8 <br> <br> 9BE8: LDA $0044 <br> 9BEA: CMP $00A8 ; if (level &lt; [$00A8]) { <br> 9BEC: BPL $9BFB <br> <br> 9BEE: INC $0044 ; increment level <br> ; } <br> ; }</code> <br> <br><font style="vertical-align: inherit;"></font><code>X</code><font style="vertical-align: inherit;"></font><code>10X</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">garis. Misalnya, jika seorang pemain mulai di level 5, ia akan tetap di sana sampai ia telah membersihkan 60 baris, setelah itu ia akan pergi ke level 6. Setelah itu, setiap 10 baris tambahan akan mengarah pada peningkatan jumlah level. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk melakukan pemeriksaan ini, nilai baris yang diisi disalin dari </font></font><code>$0050</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>$0051</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ke </font></font><code>$00A8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>$00A9</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Kemudian salinan digeser ke kanan 4 kali, yang untuk BCD yang dikemas mirip dengan membagi dengan 10. Digit desimal terkecil dibuang, dan digit tertinggi dan tengah digeser oleh satu posisi, menghasilkan camilan </font></font><code>$00A8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8e4/c0b/2e7/8e4c0b2e7d53a33d54cea8717a872a65.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namun, pada alamat tersebut, </font></font><code>$9BEA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jumlah level secara langsung dibandingkan dengan nilai paket BCD </font></font><code>$00A8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Tidak ada pencarian di tabel untuk mengonversi nilai BCD ke desimal, dan ini merupakan kesalahan yang jelas. </font><font style="vertical-align: inherit;">Sebagai contoh, pada gambar di atas, angka level harus dibandingkan dengan </font></font><code>$12</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(18 dalam desimal), dan bukan 12. Oleh karena itu, jika seorang pemain memutuskan untuk memulai di level 17, maka level sebenarnya akan pergi ke 120 baris, karena 18 lebih dari 17. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabel menunjukkan jumlah baris yang diharapkan diperlukan untuk transisi di setiap level awal. </font><font style="vertical-align: inherit;">Ini dibandingkan dengan apa yang sebenarnya terjadi karena bug.</font></font><br><br><div class="scrollable-table"><table><tbody><tr><th> <code> </code> </th> <td>  0 </td><td>  1 </td><td>  2 </td><td>  3 </td><td>  4 </td><td>  5 </td><td>  6 </td><td>  7 </td><td>  8 </td><td>  9 </td><td>  10 </td><td>  11 </td><td>  12 </td><td>  13 </td><td>  14 </td><td>  15 </td><td>  16 </td><td>  17 </td><td>  18 </td><td>  19 </td></tr><tr><th> <code>  </code> </th> <td>  10 </td><td>  20 </td><td>  30 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 40 </font></font></td><td>  50 </td><td>  60 </td><td>  70 </td><td>  80 </td><td>  90 </td><td>  100 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 110 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 120 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 130 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 140 </font></font></td><td>  150 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 160 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 170 </font></font></td><td>  180 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 190 </font></font></td><td>  200 </td></tr><tr><th> <code>    </code> </th> <td>  10 </td><td>  20 </td><td>  30 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 40 </font></font></td><td>  50 </td><td>  60 </td><td>  70 </td><td>  80 </td><td>  90 </td><td>  100 </td><td>  100 </td><td>  100 </td><td>  100 </td><td>  100 </td><td>  100 </td><td>  100 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 110 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 120 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 130 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 140 </font></font></td></tr></tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jumlah yang diharapkan sama dengan benar untuk level awal 0–9. </font><font style="vertical-align: inherit;">Faktanya, kebetulan untuk entry level 9 adalah acak; </font><font style="vertical-align: inherit;">10-15 juga naik ke level berikutnya dengan 100 baris, karena </font></font><code>$10</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ini 16 dalam bentuk desimal. </font><font style="vertical-align: inherit;">Perbedaan terbesar antara yang diharapkan dan yang sebenarnya adalah 60 baris. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya menduga bug ini disebabkan oleh perubahan desain pada tahap pengembangan selanjutnya. </font><font style="vertical-align: inherit;">Lihatlah layar menu, yang memungkinkan pemain untuk memilih level entri.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/858/51e/019/85851e019d65bf00d265fa4ea277b8c2.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tidak ada penjelasan tentang bagaimana memulai dari level di atas 9. Namun dalam buklet Nintendo Tetris, rahasia ini terungkap: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c20/cee/c3b/c20ceec3b4b30879812be109b6666b79.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tampaknya fitur tersembunyi ini ditemukan pada saat terakhir. Mungkin itu ditambahkan sangat dekat dengan tanggal rilis, yang tidak memungkinkan untuk sepenuhnya mengujinya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bahkan, memeriksa seri awal berisi kesalahan kedua terkait dengan output nilai untuk interval. Di bawah ini adalah komentar dalam kode yang menjelaskan lebih baik apa yang terjadi pada level rendah. </font><font style="vertical-align: inherit;">Perbandingan dilakukan dengan mengurangi dan memeriksa tanda hasil. Tetapi bilangan bertanda single-byte terbatas pada −128 hingga 127. Jika perbedaannya kurang dari −128, jumlahnya terbawa dan hasilnya menjadi angka positif. Prinsip ini dijelaskan dalam komentar pada kode. </font><font style="vertical-align: inherit;">Ketika memeriksa bahwa perbedaannya ada dalam interval ini, harus diperhitungkan bahwa nomor level, ketika menambah nilai lebih dari 255, melakukan transfer ke 0, dan</font></font><br><br> <code>9BE8: LDA $0044 <br> 9BEA: CMP $00A8 ; if (level - [$00A8] &lt; 0) { <br> 9BEC: BPL $9BFB <br> <br> 9BEE: INC $0044 ; increment level <br> ; }</code> <br> <br><font style="vertical-align: inherit;"></font><br><br> <code>9BE8: LDA $0044 ; difference = level - [$00A8]; <br> 9BEA: CMP $00A8 ; if (difference &lt; 0 &amp;&amp; difference &gt;= -128) { <br> 9BEC: BPL $9BFB <br> <br> 9BEE: INC $0044 ; increment level <br> ; }</code> <br> <br><font style="vertical-align: inherit;"></font><code>$00A8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berpotensi mengandung nilai apa pun, karena gigitan atasnya diambil dari </font></font><code>$0051</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang kenaikannya dapat terjadi tanpa batas.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Efek ini tumpang tindih, menciptakan periode di mana angka level secara keliru tetap tidak berubah. </font><font style="vertical-align: inherit;">Periode terjadi pada interval reguler 2.900 baris, mulai dari 2.190 baris, dan terakhir untuk 800 baris. </font><font style="vertical-align: inherit;">Misalnya, dari 2190 ( </font></font><code>L90</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) hingga 2990 ( </font></font><code>T90</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), levelnya tetap sama dengan </font></font><code>$DB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>96</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), seperti yang ditunjukkan di bawah ini.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/055/e15/8de/055e158de2ecde24e0f052cd325bef32.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Periode berikutnya terjadi dari 5090 hingga 5890, levelnya selalu sama dengan </font></font><code>$AD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>06</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">Selain itu, selama periode ini, palet warna juga tidak berubah.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Halaman mewarnai Tetrimino </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di setiap tingkat, ubin tetrimino diberi 4 warna unik. </font><font style="vertical-align: inherit;">Warna diambil dari tabel yang terletak di </font></font><code>$984C</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Catatannya digunakan kembali setiap 10 level. </font><font style="vertical-align: inherit;">Dari kiri ke kanan: kolom tabel yang sesuai dengan area hitam, putih, biru dan merah pada gambar di bawah ini.</font></font><br><br> <code>984C: 0F 30 21 12 ; level 0 <br> 9850: 0F 30 29 1A ; level 1 <br> 9854: 0F 30 24 14 ; level 2 <br> 9858: 0F 30 2A 12 ; level 3 <br> 985C: 0F 30 2B 15 ; level 4 <br> 9860: 0F 30 22 2B ; level 5 <br> 9864: 0F 30 00 16 ; level 6 <br> 9868: 0F 30 05 13 ; level 7 <br> 986C: 0F 30 16 12 ; level 8 <br> 9870: 0F 30 27 16 ; level 9</code> <br> <br><font style="vertical-align: inherit;"></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/68e/fc4/7d7/68efc47d771e9c673b003d76810d74fb.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nilai-nilai sesuai dengan palet warna NES. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e80/c0a/8b6/e80c0a8b624b90261042d71eb21d50db.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 warna pertama dari setiap entri selalu hitam dan putih. Namun, warna pertama sebenarnya diabaikan; terlepas dari nilainya, itu dianggap sebagai warna transparan yang melaluinya latar belakang hitam pekat mengintip. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Akses ke tabel warna dilakukan dalam rutinitas di </font></font><code>$9808</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Indeks tabel warna didasarkan pada jumlah level dibagi dengan sisa 10. Siklus menyalin entri ke tabel palet di VRAM. </font><font style="vertical-align: inherit;">Pembagian dengan sisanya ditiru dengan pengurangan konstan 10 hingga hasilnya kurang dari 10. Awal dari subrutin dengan komentar ditunjukkan di bawah ini.</font></font><br><br> <code>9808: LDA $0064 <br> 980A: CMP #$0A <br> 980C: BMI $9814 <br> 980E: SEC <br> 980F: SBC #$0A <br> 9811: JMP $980A ; index = levelNumber % 10; <br> <br> 9814: ASL <br> 9815: ASL <br> 9816: TAX ; index *= 4; <br> <br> 9817: LDA #$00 <br> 9819: STA $00A8 ; for(i = 0; i &lt; 32; i += 16) { <br> <br> 981B: LDA #$3F <br> 981D: STA $2006 <br> 9820: LDA #$08 <br> 9822: CLC <br> 9823: ADC $00A8 <br> 9825: STA $2006 ; palette = $3F00 + i + 8; <br> <br> 9828: LDA $984C,X <br> 982B: STA $2007 ; palette[0] = colorTable[index + 0]; <br> <br> 982E: LDA $984D,X <br> 9831: STA $2007 ; palette[1] = colorTable[index + 1]; <br> <br> 9834: LDA $984E,X <br> 9837: STA $2007 ; palette[2] = colorTable[index + 2]; <br> <br> 983A: LDA $984F,X <br> 983D: STA $2007 ; palette[3] = colorTable[index + 3]; <br> <br> 9840: LDA $00A8 <br> 9842: CLC <br> 9843: ADC #$10 <br> 9845: STA $00A8 <br> 9847: CMP #$20 <br> 9849: BNE $981B ; } <br> <br> 984B: RTS ; return;</code> <br> <br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br> <code>9808: LDA $0064 ; index = levelNumber; <br> 980A: CMP #$0A ; while(index &gt;= 10) { <br> 980C: BMI $9814 <br> 980E: SEC <br> 980F: SBC #$0A ; index -= 10; <br> 9811: JMP $980A ; }</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namun, seperti yang dinyatakan pada bagian sebelumnya, pengurangan dan percabangan berdasarkan tanda perbedaan digunakan sebagai perbandingan. </font><font style="vertical-align: inherit;">Nomor bertanda byte tunggal terbatas pada −128 hingga 127. Komentar yang diperbarui di bawah ini mencerminkan prinsip ini. </font><font style="vertical-align: inherit;">Komentar di bawah ini semakin disederhanakan. </font><font style="vertical-align: inherit;">Kata-kata ini mengungkapkan kesalahan dalam kode. </font><font style="vertical-align: inherit;">Operasi pembagian sisanya sepenuhnya dilewati untuk level dari 138 dan lebih tinggi. </font><font style="vertical-align: inherit;">Sebagai gantinya, indeks ditugaskan langsung ke nomor level, yang menyediakan akses ke byte jauh melampaui akhir tabel warna. </font><font style="vertical-align: inherit;">Seperti yang ditunjukkan di bawah ini, ini bahkan dapat menyebabkan tetrimino yang hampir tidak terlihat.</font></font><br><br> <code>9808: LDA $0064 ; index = levelNumber; <br> ; difference = index - 10; <br> 980A: CMP #$0A ; while(difference &gt;= 0 &amp;&amp; difference &lt;= 127) { <br> 980C: BMI $9814 <br> 980E: SEC ; index -= 10; <br> 980F: SBC #$0A ; difference = index - 10; <br> 9811: JMP $980A ; }</code> <br> <br><font style="vertical-align: inherit;"></font><br><br> <code>9808: LDA $0064 ; index = levelNumber; <br> 980A: CMP #$0A ; while(index &gt;= 10 &amp;&amp; index &lt;= 137) { <br> 980C: BMI $9814 <br> 980E: SEC <br> 980F: SBC #$0A ; index -= 10; <br> 9811: JMP $980A ; }</code> <br> <br><font style="vertical-align: inherit;"></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ed/2e5/2c6/6ed2e52c6a20dc9c8c1ffd1bf13d9b37.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di bawah ini adalah warna dari semua 256 level. </font><font style="vertical-align: inherit;">Ubin disusun dalam 10 kolom untuk menekankan penggunaan siklus tabel warna, dilanggar di level 138. Baris dan kolom di header ditunjukkan dalam desimal.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/423/6f0/ed6/4236f0ed6a508633b746d773a530fe90.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setelah 255, angka level kembali ke 0. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selain itu, seperti yang disebutkan di bagian sebelumnya, beberapa level tidak berubah hingga 800 baris dihapus. </font><font style="vertical-align: inherit;">Selama level panjang ini, warna tetap tidak berubah.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mode permainan </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mode permainan yang disimpan di alamat </font></font><code>$00C0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menentukan dari berbagai layar dan menu mana yang saat ini ditampilkan kepada pengguna.</font></font><br><br><div class="scrollable-table"><table><tbody><tr><th>  Nilai </th><th>  Deskripsi </th></tr><tr><td> <code>00</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Layar Informasi Hukum </font></font></td></tr><tr><td> <code>01</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Layar splash </font></font></td></tr><tr><td> <code>02</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Menu Jenis Game </font></font></td></tr><tr><td> <code>03</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Menu level dan ketinggian </font></font></td></tr><tr><td> <code>04</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Game / skor tinggi / akhir / jeda </font></font></td></tr><tr><td> <code>05</code> </td> <td>  Demo </td></tr></tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti yang ditunjukkan di atas, gim ini memiliki rutin yang ditulis dengan cerdas yang bertindak sebagai pernyataan pergantian menggunakan tabel navigasi endian kecil yang terletak tepat setelah panggilan. </font><font style="vertical-align: inherit;">Daftar di atas menunjukkan alamat semua mode game. Perhatikan bahwa mode "Game" dan "Demo" menggunakan kode yang sama. </font><font style="vertical-align: inherit;">Rutinitas ini tidak pernah kembali. Sebaliknya, kode tersebut menggunakan alamat pengirim; biasanya itu menunjuk ke instruksi segera setelah panggilan ke lompat ke subrutin (minus 1 byte), tetapi dalam kasus ini menunjuk ke tabel lompat. Alamat pengirim muncul dari tumpukan dan disimpan di </font><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">. Setelah menyimpan alamat dari tabel lompat, kode menggunakan nilai dalam register A sebagai indeks dan melakukan transisi yang sesuai.</font></font><br><br> <code>8161: LDA $00C0 <br> 8163: JSR $AC82 ; switch(gameMode) { <br> 8166: 00 82 ; case 0: goto 8200; //     <br> 8168: 4F 82 ; case 1: goto 824F; //   <br> 816A: D1 82 ; case 2: goto 82D1; //    <br> 816C: D7 83 ; case 3: goto 83D7; //     <br> 816E: 5D 81 ; case 4: goto 815D; //  /   /  /  <br> 8170: 5D 81 ; case 5: goto 815D; //  <br> ; }</code> <br> <br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><code>$0000</code><font style="vertical-align: inherit;"></font><code>$0001</code><font style="vertical-align: inherit;"></font><br><br> <code>AC82: ASL <br> AC83: TAY <br> AC84: INY <br> <br> AC85: PLA <br> AC86: STA $0000 <br> AC88: PLA ; pop return address off of stack <br> AC89: STA $0001 ; and store it at $0000-$0001 <br> <br> AC8B: LDA ($00),Y <br> AC8D: TAX <br> AC8E: INY <br> AC8F: LDA ($00),Y <br> AC91: STA $0001 <br> AC93: STX $0000 <br> AC95: JMP ($0000) ; goto Ath 16-bit address <br> ; in table at [$0000-$0001]</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kode dapat menggunakan saklar rutin ini selama indeks mendekati 0 dan tidak ada spasi atau beberapa di antara kemungkinan kasus. </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Layar Informasi Hukum </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Permainan dimulai dengan layar yang menunjukkan pemberitahuan hukum. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/524/4e2/d4b/5244e2d4b26989579afaad64838c0962.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di bagian bawah layar, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aleksey Pazhitnov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> disebut </font><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">sebut </font><font style="vertical-align: inherit;">sebagai penemu, perancang dan pemrogram Tetris pertama. Pada tahun 1984, bekerja sebagai pengembang komputer di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dorodnitsyn Computing Center</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (lembaga penelitian terkemuka dari Akademi Ilmu Pengetahuan Rusia di Moskow), ia mengembangkan prototipe permainan pada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Electronics-60</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (klon Soviet DEC </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LSI-11</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Sebuah prototipe dikembangkan untuk mode teks monokrom hijau di mana kotak ditunjukkan oleh pasangan tanda kurung </font></font><code>[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dengan bantuan anak sekolah berusia 16 tahun, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vadim Gerasimov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan insinyur komputer Dmitry Pavlovsky beberapa hari setelah penemuan game, prototipe diangkut ke PC IBM dengan MS DOS dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Turbo Pascal</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Selama dua tahun, mereka menyempurnakan permainan bersama, menambahkan fitur seperti warna tetrimino, statistik, dan, yang lebih penting, waktu dan kode grafis yang memungkinkan game untuk bekerja pada berbagai model PC dan klon. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sayangnya, karena kekhasan Uni Soviet pada waktu itu, upaya mereka untuk mendapatkan uang dari permainan tidak berhasil dan pada akhirnya mereka memutuskan untuk membagikan versi PC dengan teman-teman mereka secara gratis. Sejak saat itu, "Tetris" mulai menyebar secara virus di seluruh negeri dan di luar, disalin dari disk ke disk. Tetapi karena permainan dikembangkan oleh karyawan dari lembaga negara, negara adalah pemiliknya, dan pada tahun 1987, organisasi yang bertanggung jawab atas perdagangan internasional dalam teknologi elektronik mengambil alih lisensi permainan (</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Electronorgtekhnika (ELORG)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) Singkatan V / O pada layar informasi hukum mungkin merupakan kependekan dari Version Originale. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perusahaan perangkat lunak Inggris </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andromeda</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mencoba untuk mendapatkan hak atas Tetris dan, sebelum penyelesaian transaksi, mensublisensikan permainan tersebut kepada pemasok lain, misalnya, penerbit Inggris untuk permainan komputer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mirrorsoft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Mirrorsoft, pada gilirannya, mensublisensikannya ke </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tengen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , anak perusahaan Atari Games. Tengen memberikan Bullet-Proof Software hak untuk mengembangkan game untuk komputer dan konsol di Jepang, yang menghasilkan Tetris untuk Nintendo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Famicom</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Di bawah ini adalah layar informasi hukumnya.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/750/b96/6c0/750b966c0d526110e504b409b3f1a1af.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menariknya, dalam versi ini, anak sekolah Vadim Gerasimov disebut desainer dan programmer asli. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mencoba untuk mengamankan versi portabel dari konsol Game Boy yang akan datang, Nintendo menggunakan Bullet-Proof Software untuk menyimpulkan kesepakatan yang sukses secara langsung dengan ELORG. Dalam proses menyimpulkan kesepakatan, ELORG merevisi kontraknya dengan Andromeda, menambahkan bahwa Andromeda hanya mendapatkan hak untuk game untuk komputer dan mesin arcade. Karena itu, Bullet-Proof Software harus membayar royalti ELORG untuk semua kartrid yang dijual untuk Famicom, karena hak yang diterima dari Tengen ternyata palsu. Tetapi melalui rekonsiliasi dengan ELORG, Bullet-Proof Software akhirnya berhasil mendapatkan hak game konsol di seluruh dunia untuk Nintendo.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bullet-Proof Software mensublisensikan hak game portabel Nintendo dan bersama-sama mereka mengembangkan Game Boy Tetris, yang tercermin dalam layar informasi hukum di bawah ini.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0dc/d28/e4c/0dcd28e4c4f7b3da1a0259fcdbcf9b70.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan hak game konsol global, Nintendo telah mengembangkan versi Tetris untuk NES yang kami eksplorasi dalam artikel ini. Kemudian Bullet-Proof Software mensublisensikan hak Nintendo, yang memungkinkannya untuk terus menjual kartrid untuk Famicom di Jepang. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini diikuti oleh pertempuran hukum yang kompleks. Baik Nintendo dan Tengen menuntut agar pihak lawan berhenti memproduksi dan menjual versi permainan mereka. Akibatnya, Nintendo menang, dan ratusan ribu kartrid </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tengen Tetris</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hancur. Putusan pengadilan juga melarang beberapa perusahaan lain seperti Mirrorsoft untuk membuat versi konsol. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pajitnov tidak pernah menerima potongan dari ELORG atau negara Soviet. Namun, pada tahun 1991 ia pindah ke Amerika Serikat dan pada tahun 1996 dengan dukungan dari pemilik Bullet-Proof Software</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Henka Rogers</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ikut mendirikan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Tetris Company</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang memungkinkannya mengambil untung dari versi perangkat seluler dan konsol modern.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sangat menarik untuk melihat layar informasi hukum sebagai jendela yang memberikan gagasan tentang asal usul permainan yang sederhana dan pertarungan berikutnya untuk hak kekayaan intelektual, karena bagi sebagian besar pemain layar ini hanya merupakan penghalang yang menjengkelkan, hilangnya yang sepertinya harus menunggu selamanya. Penundaan diatur oleh dua penghitung, penghitungan berurutan dari 255 ke 0. Fase pertama tidak dapat dilewati, dan yang kedua dilewati dengan menekan tombol Start. Oleh karena itu, layar informasi hukum ditampilkan setidaknya 4,25 detik dan tidak lebih dari 8,5 detik. Namun, saya pikir sebagian besar pemain menyerah, berhenti menekan Start selama interval pertama, dan karena ini mereka menunggu penyelesaian lengkap.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Waktu fase, serta sisa permainan, diatur oleh penangan interrupt terbuka yang disebut pada awal setiap interval pengosongan vertikal, periode waktu singkat antara rendering frame televisi. Artinya, setiap 16.6393 milidetik, eksekusi program normal terganggu oleh kode berikut. </font><font style="vertical-align: inherit;">Pawang mulai dengan meneruskan nilai register utama ke stack dan mengambilnya setelah selesai agar tidak mengganggu tugas yang terputus. Panggilan </font><font style="vertical-align: inherit;">memperbarui VRAM, mengubah deskripsi model memori menjadi apa yang ditampilkan di layar. Lebih lanjut, pawang mengurangi nilai penghitung layar informasi hukum jika lebih besar dari nol. Tantangan</font></font><br><br> <code>8005: PHA <br> 8006: TXA <br> 8007: PHA <br> 8008: TYA <br> 8009: PHA ; save A, X, Y <br> <br> 800A: LDA #$00 <br> 800C: STA $00B3 <br> 800E: JSR $804B ; render(); <br> <br> 8011: DEC $00C3 ; legalScreenCounter1--; <br> <br> 8013: LDA $00C3 <br> 8015: CMP #$FF ; if (legalScreenCounter1 &lt; 0) { <br> 8017: BNE $801B ; legalScreenCounter1 = 0; <br> 8019: INC $00C3 ; } <br> <br> 801B: JSR $AB5E ; initializeOAM(); <br> <br> 801E: LDA $00B1 <br> 8020: CLC <br> 8021: ADC #$01 <br> 8023: STA $00B1 <br> 8025: LDA #$00 <br> 8027: ADC $00B2 <br> 8029: STA $00B2 ; frameCounter++; <br> <br> 802B: LDX #$17 <br> 802D: LDY #$02 <br> 802F: JSR $AB47 ; randomValue = generateNextPseudorandomNumber(randomValue); <br> <br> 8032: LDA #$00 <br> 8034: STA $00FD <br> 8036: STA $2005 ; scrollX = 0; <br> 8039: STA $00FC <br> 803B: STA $2005 ; scrollY = 0; <br> <br> 803E: LDA #$01 <br> 8040: STA $0033 ; verticalBlankingInterval = true; <br> <br> 8042: JSR $9D51 ; pollControllerButtons(); <br> <br> 8045: PLA <br> 8046: TAY <br> 8047: PLA <br> 8048: TAX <br> 8049: PLA ; restore A, X, Y <br> <br> 804A: RTI ; resume interrupted task</code> <br> <br><font style="vertical-align: inherit;"></font><code>render()</code><font style="vertical-align: inherit;"></font><code>initializeOAM()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">melakukan langkah yang diperlukan oleh peralatan pembuatan bingkai. Pawang terus bekerja dengan menambah penghitung bingkai - nilai endian 16-bit kecil yang disimpan di alamat </font></font><code>$00B1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>$00B2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang digunakannya di tempat yang berbeda untuk pengaturan waktu yang terkontrol. Setelah itu, nomor pseudo-acak berikut dihasilkan; seperti yang disebutkan di atas, ini terjadi terlepas dari mode setidaknya sekali per frame. </font></font><code>$8040</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bendera interval pengosongan vertikal ditetapkan </font><font style="vertical-align: inherit;">pada alamat </font><font style="vertical-align: inherit;">, yang berarti bahwa pawang baru saja dieksekusi. Akhirnya, tombol-tombol pengontrol disurvei; perilaku rutin ini dijelaskan di bawah di bagian Demo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bendera </font></font><code>verticalBlankingInterval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">digunakan oleh rutin yang dibahas di atas. Ini berlanjut sampai pelaksanaan interrupt handler dimulai.</font></font><br><br> <code>AA2F: JSR $E000 ; updateAudio(); <br> <br> AA32: LDA #$00 <br> AA34: STA $0033 ; verticalBlankingInterval = false; <br> <br> AA36: NOP <br> <br> AA37: LDA $0033 <br> AA39: BEQ $AA37 ; while(!verticalBlankingInterval) { } <br> <br> AA3B: LDA #$FF <br> AA3D: LDX #$02 <br> AA3F: LDY #$02 <br> AA41: JSR $AC6A ; fill memory page 2 with all $FF's <br> <br> AA44: RTS ; return;</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rutin pemblokiran ini digunakan oleh dua tahap waktu layar informasi hukum, yang dieksekusi satu demi satu. </font><font style="vertical-align: inherit;">Skrip Lua AI memotong keterlambatan ini dengan mengatur kedua penghitung ke 0.</font></font><br><br> <code>8236: LDA #$FF <br> 8238: JSR $A459 <br> <br> ... <br> <br> A459: STA $00C3 ; legalScreenCounter1 = 255; <br> <br> A45B: JSR $AA2F ; do { <br> A45E: LDA $00C3 ; waitForVerticalBlankingInterval(); <br> A460: BNE $A45B ; } while(legalScreenCounter1 &gt; 0); <br> <br> A462: RTS ; return;</code> <br> <br> <code>823B: LDA #$FF <br> 823D: STA $00A8 ; legalScreenCounter2 = 255; <br> <br> ; do { <br> <br> 823F: LDA $00F5 ; if (just pressed Start) { <br> 8241: CMP #$10 ; break; <br> 8243: BEQ $824C ; } <br> <br> 8245: JSR $AA2F ; waitForVerticalBlankingInterval(); <br> <br> 8248: DEC $00A8 ; legalScreenCounter2--; <br> 824A: BNE $823F ; } while(legalScreenCounter2 &gt; 0); <br> <br> 824C: INC $00C0 ; gameMode = TITLE_SCREEN;</code> <br> <br><font style="vertical-align: inherit;"></font><br><br><h3>  Demo </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demo ini menampilkan sekitar 80 detik gameplay pra-rekam. Itu tidak hanya menampilkan file video, tetapi menggunakan mesin yang sama seperti di dalam game. Selama pemutaran, dua tabel digunakan. Yang pertama, terletak di alamat </font></font><code>$DF00</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, berisi urutan pembuatan tetrimino berikut: </font></font><br><br> <code>TJTSZJTSZJSZLZJTTSITO JSZLZLIOLZLIOJTSITOJ</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saat membuat gambar, itu dipilih secara acak, atau dibaca dari tabel, tergantung pada mode. Perpindahan terjadi di alamat </font></font><code>$98EB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Jenis tetrimino diekstraksi dari bit 6, 5 dan 4 dari setiap byte. Dari waktu ke waktu, operasi ini memberi kita nilai </font><font style="vertical-align: inherit;">- tipe yang salah. Namun, tabel menciptakan bentuk ( </font><font style="vertical-align: inherit;">) digunakan untuk konversi ketik ID tetrimino orientasi sebenarnya terletak antara dua tabel terkait: </font><font style="vertical-align: inherit;">Arti</font></font><br><br> <code>98EB: LDA $00C0 <br> 98ED: CMP #$05 <br> 98EF: BNE $9903 ; if (gameMode == DEMO) { <br> <br> 98F1: LDX $00D3 <br> 98F3: INC $00D3 <br> 98F5: LDA $DF00,X ; value = demoTetriminoTypeTable[++demoIndex]; <br> <br> 98F8: LSR <br> 98F9: LSR <br> 98FA: LSR <br> 98FB: LSR <br> 98FC: AND #$07 <br> 98FE: TAX ; tetriminoType = bits 6,5,4 of value; <br> <br> 98FF: LDA $994E,X <br> 9902: RTS ; return spawnTable[tetriminoType]; <br> ; } else { <br> ; pickRandomTetrimino(); <br> ; }</code> <br> <br><font style="vertical-align: inherit;"></font><code>$07</code><font style="vertical-align: inherit;"></font><code>$994E</code><font style="vertical-align: inherit;"></font><br><br> <code>993B: 00 00 00 00 ; T <br> 993F: 01 01 01 01 ; J <br> 9943: 02 02 ; Z <br> 9945: 03 ; O <br> 9946: 04 04 ; S <br> 9948: 05 05 05 05 ; L <br> 994C: 06 06 ; I</code> <br> <br> <code>994E: 02 ; Td <br> 994F: 07 ; Jd <br> 9950: 08 ; Zh <br> 9951: 0A ; O <br> 9952: 0B ; Sh <br> 9953: 0E ; Ld <br> 9954: 12 ; Ih</code> <br> <br> <code>9956: 02 02 02 02 ; Td <br> 995A: 07 07 07 07 ; Jd <br> 995E: 08 08 ; Zh <br> 9960: 0A ; O <br> 9961: 0B 0B ; Sh <br> 9963: 0E 0E 0E 0E ; Ld <br> 9967: 12 12 ; Ih</code> <br> <br><font style="vertical-align: inherit;"></font><code>$07</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memaksanya untuk membaca di luar akhir tabel, di berikutnya, yang memberi </font></font><code>Td</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>$02</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Karena efek ini, skema ini dapat memberi kita urutan ID pseudo-acak yang tak terbatas tetapi dapat direproduksi dari orientasi gambar yang dibuat. Kode akan berfungsi karena setiap alamat yang berubah-ubah dalam urutan byte yang berubah tidak memungkinkan kami untuk menentukan di mana tabel berakhir. Bahkan, urutan di alamat </font></font><code>$DF00</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dapat menjadi bagian dari sesuatu yang sama sekali tidak terkait dengan ini, terutama mengingat bahwa penugasan 5 bit bukan nol yang tersisa tidak jelas, dan urutan yang dihasilkan menunjukkan pengulangan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selama inisialisasi mode demo, indeks tabel ( </font></font><code>$00D3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) diatur ulang ke alamat </font></font><code>$872B</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabel kedua dari demo berisi catatan tombol gamepad yang disandikan dalam pasangan byte. </font><font style="vertical-align: inherit;">Bit dari byte pertama berhubungan dengan tombol.</font></font><br><br><div class="scrollable-table"><table><tbody><tr><th> <code>7</code> </th> <th> <code>6</code> </th> <th> <code>5</code> </th> <th> <code>4</code> </th> <th> <code>3</code> </th> <th> <code>2</code> </th> <th> <code>1</code> </th> <th> <code>0</code> </th> </tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> B </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pilih </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mulai </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Naik </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Turun </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ke kiri </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ke kanan </font></font></td></tr></tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Byte kedua menyimpan jumlah bingkai di mana kombinasi tombol ditekan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabel ini memuat alamat </font></font><code>$DD00</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>$DEFF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan terdiri dari 256 pasangan. Akses ke sana dilakukan oleh subrutin di alamat </font></font><code>$9D5B</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Karena tabel tombol demo panjangnya 512 byte, indeks dua byte diperlukan untuk mengaksesnya. Indeks disimpan sebagai endian kecil di </font><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">. Ini diinisialisasi dengan nilai alamat tabel </font><font style="vertical-align: inherit;">, dan kenaikannya dilakukan oleh kode berikut. </font><font style="vertical-align: inherit;">Programmer meninggalkan pemrosesan input pemain dalam kode, yang memungkinkan kita untuk melihat proses pengembangan dan mengganti demo dengan catatan lain. Mode perekaman demo diaktifkan ketika </font><font style="vertical-align: inherit;">nilai diberikan.</font></font><br><br> <code>9D5B: LDA $00D0 ; if (recording mode) { <br> 9D5D: CMP #$FF ; goto recording; <br> 9D5F: BEQ $9DB0 ; } <br> <br> 9D61: JSR $AB9D ; pollController(); <br> 9D64: LDA $00F5 ; if (start button pressed) { <br> 9D66: CMP #$10 ; goto startButtonPressed; <br> 9D68: BEQ $9DA3 ; } <br> <br> 9D6A: LDA $00CF ; if (repeats == 0) { <br> 9D6C: BEQ $9D73 ; goto finishedMove; <br> ; } else { <br> 9D6E: DEC $00CF ; repeats--; <br> 9D70: JMP $9D9A ; goto moveInProgress; <br> ; } <br> <br> finishedMove: <br> <br> 9D73: LDX #$00 <br> 9D75: LDA ($D1,X) <br> 9D77: STA $00A8 ; buttons = demoButtonsTable[index]; <br> <br> 9D79: JSR $9DE8 ; index++; <br> <br> 9D7C: LDA $00CE <br> 9D7E: EOR $00A8 <br> 9D80: AND $00A8 <br> 9D82: STA $00F5 ; setNewlyPressedButtons(difference between heldButtons and buttons); <br> <br> 9D84: LDA $00A8 <br> 9D86: STA $00CE ; heldButtons = buttons; <br> <br> 9D88: LDX #$00 <br> 9D8A: LDA ($D1,X) <br> 9D8C: STA $00CF ; repeats = demoButtonsTable[index]; <br> <br> 9D8E: JSR $9DE8 ; index++; <br> <br> 9D91: LDA $00D2 ; if (reached end of demo table) { <br> 9D93: CMP #$DF ; return; <br> 9D95: BEQ $9DA2 ; } <br> <br> 9D97: JMP $9D9E ; goto holdButtons; <br> <br> moveInProgress: <br> <br> 9D9A: LDA #$00 <br> 9D9C: STA $00F5 ; clearNewlyPressedButtons(); <br> <br> holdButtons: <br> <br> 9D9E: LDA $00CE <br> 9DA0: STA $00F7 ; setHeldButtons(heldButtons); <br> <br> 9DA2: RTS ; return; <br> <br> startButtonPressed: <br> <br> 9DA3: LDA #$DD <br> 9DA5: STA $00D2 ; reset index; <br> <br> 9DA7: LDA #$00 <br> 9DA9: STA $00B2 ; counter = 0; <br> <br> 9DAB: LDA #$01 <br> 9DAD: STA $00C0 ; gameMode = TITLE_SCREEN; <br> <br> 9DAF: RTS ; return;</code> <br> <br><font style="vertical-align: inherit;"></font><code>$00D1</code><font style="vertical-align: inherit;"></font><code>$00D2</code><font style="vertical-align: inherit;"></font><code>$872D</code><font style="vertical-align: inherit;"></font><br><br> <code>9DE8: LDA $00D1 <br> 9DEA: CLC ; increment [$00D1] <br> 9DEB: ADC #$01 ; possibly causing wrap around to 0 <br> 9DED: STA $00D1 ; which produces a carry <br> <br> 9DEF: LDA #$00 <br> 9DF1: ADC $00D2 <br> 9DF3: STA $00D2 ; add carry to [$00D2] <br> <br> 9DF5: RTS ; return</code> <br> <br><font style="vertical-align: inherit;"></font><code>$00D0</code><font style="vertical-align: inherit;"></font><code>$FF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dalam hal ini, kode berikut diluncurkan, dimaksudkan untuk menulis ke tabel tombol untuk demo. </font><font style="vertical-align: inherit;">Namun, tabel disimpan dalam PRG-ROM. </font><font style="vertical-align: inherit;">Mencoba menulis tidak akan memengaruhi data yang disimpan. </font><font style="vertical-align: inherit;">Sebaliknya, setiap operasi penulisan memicu switch bank, menghasilkan efek kesalahan yang ditunjukkan di bawah ini.</font></font><br><br> <code>recording: <br> <br> 9DB0: JSR $AB9D ; pollController(); <br> <br> 9DB3: LDA $00C0 ; if (gameMode != DEMO) { <br> 9DB5: CMP #$05 ; return; <br> 9DB7: BNE $9DE7 ; } <br> <br> 9DB9: LDA $00D0 ; if (not recording mode) { <br> 9DBB: CMP #$FF ; return; <br> 9DBD: BNE $9DE7 ; } <br> <br> 9DBF: LDA $00F7 ; if (getHeldButtons() == heldButtons) { <br> 9DC1: CMP $00CE ; goto buttonsNotChanged; <br> 9DC3: BEQ $9DE4 ; } <br> <br> 9DC5: LDX #$00 <br> 9DC7: LDA $00CE <br> 9DC9: STA ($D1,X) ; demoButtonsTable[index] = heldButtons; <br> <br> 9DCB: JSR $9DE8 ; index++; <br> <br> 9DCE: LDA $00CF <br> 9DD0: STA ($D1,X) ; demoButtonsTable[index] = repeats; <br> <br> 9DD2: JSR $9DE8 ; index++; <br> <br> 9DD5: LDA $00D2 ; if (reached end of demo table) { <br> 9DD7: CMP #$DF ; return; <br> 9DD9: BEQ $9DE7 ; } <br> <br> 9DDB: LDA $00F7 <br> 9DDD: STA $00CE ; heldButtons = getHeldButtons(); <br> <br> 9DDF: LDA #$00 <br> 9DE1: STA $00CF ; repeats = 0; <br> <br> 9DE3: RTS ; return; <br> <br> buttonsNotChanged: <br> <br> 9DE4: INC $00CF ; repeats++; <br> <br> 9DE6: RTS <br> 9DE7: RTS ; return;</code> <br> <br><font style="vertical-align: inherit;"></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a07/66a/261/a0766a261967e1ee2e7d4a61d3367ee6.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini menunjukkan bahwa pengembang dapat menjalankan program sebagian atau sepenuhnya dalam RAM. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk mengatasi kendala ini, saya membuat </font></font><code>lua/RecordDemo.lua</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">satu yang terletak di </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zip dengan kode sumber</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Setelah beralih ke mode perekaman demo, itu mengalihkan operasi tulis ke tabel di konsol Lua. </font><font style="vertical-align: inherit;">Dari itu, byte dapat disalin dan ditempelkan ke ROM.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk merekam demo Anda sendiri, jalankan FCEUX dan unduh file Nintendo Tetris ROM (File | Open ROM ...). Kemudian buka jendela Lua Script (File | Lua | New Lua Script Window ...), telusuri file tersebut atau masukkan path. Tekan tombol Jalankan untuk memulai mode perekaman demo, dan kemudian klik pada jendela FCEUX untuk beralih fokus ke sana. Anda dapat mengontrol bentuk sampai tabel tombol penuh. Setelah itu, game akan secara otomatis kembali ke screen saver. Klik Stop di jendela Lua Script untuk menghentikan skrip. Data yang direkam akan muncul di Konsol Output, seperti yang ditunjukkan pada gambar di bawah ini.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f2e/3cd/f61/f2e3cdf61589005f2e1cae0659f66467.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pilih semua konten dan salin ke clipboard (Ctrl + C). </font><font style="vertical-align: inherit;">Kemudian jalankan Hex Editor (Debug | Hex Editor ...). </font><font style="vertical-align: inherit;">Dari menu Hex Editor, pilih View | </font><font style="vertical-align: inherit;">File ROM lalu File | </font><font style="vertical-align: inherit;">Alamat Goto. </font><font style="vertical-align: inherit;">Di kotak dialog Goto, masukkan 5D10 (alamat tabel tombol demo di file ROM) dan klik Ok. </font><font style="vertical-align: inherit;">Kemudian rekatkan isi clipboard (Ctrl + V).</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bef/599/392/bef599392455c773652e850de13f6413.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terakhir, di menu FCEUX, pilih NES | </font><font style="vertical-align: inherit;">Setel ulang </font><font style="vertical-align: inherit;">Jika Anda berhasil mengulangi semua langkah ini, maka demo harus diganti oleh versi Anda sendiri. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda ingin menyimpan perubahan, pilih File | </font><font style="vertical-align: inherit;">Simpan Rom As ... dan masukkan nama file ROM yang dimodifikasi, lalu klik Simpan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan cara yang sama, Anda dapat menyesuaikan urutan tetriminos yang dibuat.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Layar kematian </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti disebutkan di atas, sebagian besar pemain tidak dapat mengatasi kecepatan penurunan angka di level 29, yang dengan cepat mengarah ke akhir pertandingan. Karena itu, para pemain ia menjadi terkait dengan nama "layar kematian." Tetapi dari sudut pandang teknis, layar kematian tidak memungkinkan pemain untuk melangkah lebih jauh karena bug di mana keturunan cepat sebenarnya bukan bug, tetapi fitur. Para desainer sangat baik bahwa mereka membiarkan permainan untuk melanjutkan sementara pemain mampu menahan kecepatan manusia super. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Layar kematian sebenarnya muncul pada sekitar 1550 baris yang ditarik. Ia memanifestasikan dirinya dalam berbagai cara. Terkadang gim ini dimulai kembali. Dalam kasus lain, layar menjadi hitam. Biasanya gim membeku ("membeku") segera setelah menghapus satu baris, seperti yang ditunjukkan di bawah ini. Efek seperti itu sering didahului oleh artefak grafis acak.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/09d/7fe/4f3/09d7fe4f3ec1e77057c7ee5e252d8d75.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Layar kematian adalah hasil dari bug dalam kode yang menambahkan poin saat menghapus baris. Akun enam karakter disimpan sebagai BCD endian kecil 24-bit dan terletak di </font></font><code>$0053</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>$0055</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Untuk melakukan konversi antara jumlah baris yang dihapus dan poin yang diperoleh, sebuah tabel digunakan; setiap entri di dalamnya adalah nilai endian BCD kecil 16 bit yang dikemas. </font><font style="vertical-align: inherit;">Setelah menambah jumlah baris, dan mungkin level, nilai dalam daftar ini dikalikan dengan jumlah level ditambah satu, dan hasilnya ditambahkan ke poin. Ini jelas ditunjukkan dalam tabel dari buklet manual Nintendo Tetris:</font></font><br><br> <code>9CA5: 00 00 ; 0: 0 <br> 9CA7: 40 00 ; 1: 40 <br> 9CA9: 00 01 ; 2: 100 <br> 9CAB: 00 03 ; 3: 300 <br> 9CAD: 00 12 ; 4: 1200</code> <br> <br><font style="vertical-align: inherit;"></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/34b/a36/7cf/34ba367cfefad47e493306fa6ef8fe3e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti yang ditunjukkan di bawah ini, perkalian disimulasikan oleh siklus yang menambahkan poin ke skor. Ini dieksekusi setelah bentuk terkunci, bahkan jika tidak ada baris yang dihapus. </font><font style="vertical-align: inherit;">Sayangnya, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">Ricoh 2A03</font></a><font style="vertical-align: inherit;"> tidak memiliki mode desimal biner 6502; dia bisa sangat menyederhanakan tubuh siklus. Sebagai gantinya, penambahan dilakukan dalam langkah-langkah menggunakan mode biner. Digit apa pun yang melebihi 9 setelah penambahan pada dasarnya diperoleh dengan mengurangi 10 dan menambah digit di sebelah kiri. Misalnya, </font><font style="vertical-align: inherit;">yang dikonversi menjadi </font><font style="vertical-align: inherit;">. Tetapi skema semacam itu tidak sepenuhnya dilindungi. Ambil </font><font style="vertical-align: inherit;">: cek tidak dapat mengubah hasilnya menjadi</font></font><br><br> <code>9C31: LDA $0044 <br> 9C33: STA $00A8 <br> 9C35: INC $00A8 ; for(i = 0; i &lt;= level; i++) { <br> <br> 9C37: LDA $0056 <br> 9C39: ASL <br> 9C3A: TAX <br> 9C3B: LDA $9CA5,X ; points[0] = pointsTable[2 * completedLines]; <br> <br> 9C3E: CLC <br> 9C3F: ADC $0053 <br> 9C41: STA $0053 ; score[0] += points[0]; <br> <br> 9C43: CMP #$A0 <br> 9C45: BCC $9C4E ; if (upper digit of score[0] &gt; 9) { <br> <br> 9C47: CLC <br> 9C48: ADC #$60 <br> 9C4A: STA $0053 ; upper digit of score[0] -= 10; <br> 9C4C: INC $0054 ; score[1]++; <br> ; } <br> <br> 9C4E: INX <br> 9C4F: LDA $9CA5,X ; points[1] = pointsTable[2 * completedLines + 1]; <br> <br> 9C52: CLC <br> 9C53: ADC $0054 <br> 9C55: STA $0054 ; score[1] += points[1]; <br> <br> 9C57: AND #$0F <br> 9C59: CMP #$0A <br> 9C5B: BCC $9C64 ; if (lower digit of score[1] &gt; 9) { <br> <br> 9C5D: LDA $0054 <br> 9C5F: CLC ; lower digit of score[1] -= 10; <br> 9C60: ADC #$06 ; increment upper digit of score[1]; <br> 9C62: STA $0054 ; } <br> <br> 9C64: LDA $0054 <br> 9C66: AND #$F0 <br> 9C68: CMP #$A0 <br> 9C6A: BCC $9C75 ; if (upper digit of score[1] &gt; 9) { <br> <br> 9C6C: LDA $0054 <br> 9C6E: CLC <br> 9C6F: ADC #$60 <br> 9C71: STA $0054 ; upper digit of score[1] -= 10; <br> 9C73: INC $0055 ; score[2]++; <br> ; } <br> <br> 9C75: LDA $0055 <br> 9C77: AND #$0F <br> 9C79: CMP #$0A <br> 9C7B: BCC $9C84 ; if (lower digit of score[2] &gt; 9) { <br> <br> 9C7D: LDA $0055 <br> 9C7F: CLC ; lower digit of score[2] -= 10; <br> 9C80: ADC #$06 ; increment upper digit of score[2]; <br> 9C82: STA $0055 ; } <br> <br> 9C84: LDA $0055 <br> 9C86: AND #$F0 <br> 9C88: CMP #$A0 <br> 9C8A: BCC $9C94 ; if (upper digit of score[2] &gt; 9) { <br> <br> 9C8C: LDA #$99 <br> 9C8E: STA $0053 <br> 9C90: STA $0054 <br> 9C92: STA $0055 ; max out score to 999999; <br> ; } <br> <br> 9C94: DEC $00A8 <br> 9C96: BNE $9C37 ; }</code> <br> <br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><code>$07 + $07 = $0E</code><font style="vertical-align: inherit;"></font><code>$14</code><font style="vertical-align: inherit;"></font><code>$09 + $09 = $12</code><font style="vertical-align: inherit;"></font><code>$18</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Untuk mengkompensasi hal ini, tidak satu pun angka desimal dalam entri dalam kartu skor melebihi 6. Selain itu, agar dapat menggunakannya, digit terakhir dari semua entri selalu 0. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perlu waktu untuk menyelesaikan siklus yang panjang dan rumit ini. </font><font style="vertical-align: inherit;">Pada level tinggi, sejumlah besar iterasi memengaruhi waktu permainan, karena dibutuhkan lebih dari 1/60 detik untuk menghasilkan setiap frame. </font><font style="vertical-align: inherit;">Semua ini sebagai akibatnya mengarah pada berbagai manifestasi "layar kematian". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skrip Lua AI membatasi jumlah iterasi dalam satu lingkaran hingga 30 - nilai maksimum yang bisa dicapai oleh desainer seperti yang dirancang oleh desainer, yang menghilangkan layar kematian.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Akhir </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dalam buklet Nintendo Tetris, game A-Type dijelaskan sebagai berikut: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c53/f16/5ea/c53f165ea675badb06f75f6409f6c836.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Permainan ini memberi penghargaan kepada para pemain yang mencetak jumlah poin yang cukup besar di salah satu dari lima animasi akhir. Pilihan akhir seluruhnya didasarkan pada dua digit paling kiri dari skor enam digit. Seperti yang ditunjukkan di bawah ini, untuk mendapatkan salah satu ujungnya, pemain harus mencetak setidaknya 30.000 poin. </font><font style="vertical-align: inherit;">Perlu dicatat bahwa </font><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">adalah cermin alamat </font><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">. Akun tersebut digandakan di alamat </font><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Setelah melewati tes pertama, animasi akhir dipilih oleh pernyataan switch berikut.</font></font><br><br> <code>9A4D: LDA $0075 <br> 9A4F: CMP #$03 <br> 9A51: BCC $9A5E ; if (score[2] &gt;= $03) { <br> <br> 9A53: LDA #$80 <br> 9A55: JSR $A459 <br> 9A58: JSR $9E3A <br> 9A5B: JMP $9A64 ; select ending; <br> ; }</code> <br> <br><font style="vertical-align: inherit;"></font><code>$0060</code><font style="vertical-align: inherit;"></font><code>$007F</code><font style="vertical-align: inherit;"></font><code>$0040</code><font style="vertical-align: inherit;"></font><code>$005F</code><font style="vertical-align: inherit;"></font><code>$0073</code><font style="vertical-align: inherit;"></font><code>$0075</code><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br> <code>A96E: LDA #$00 <br> A970: STA $00C4 <br> A972: LDA $0075 ; if (score[2] &lt; $05) { <br> A974: CMP #$05 ; ending = 0; <br> A976: BCC $A9A5 ; } <br> <br> A978: LDA #$01 <br> A97A: STA $00C4 <br> A97C: LDA $0075 ; else if (score[2] &lt; $07) { <br> A97E: CMP #$07 ; ending = 1; <br> A980: BCC $A9A5 ; } <br> <br> A982: LDA #$02 <br> A984: STA $00C4 <br> A986: LDA $0075 ; else if (score[2] &lt; $10) { <br> A988: CMP #$10 ; ending = 2; <br> A98A: BCC $A9A5 ; } <br> <br> A98C: LDA #$03 <br> A98E: STA $00C4 <br> A990: LDA $0075 ; else if (score[2] &lt; $12) { <br> A992: CMP #$12 ; ending = 3; <br> A994: BCC $A9A5 ; } <br> <br> A996: LDA #$04 ; else { <br> A998: STA $00C4 ; ending = 4; <br> ; }</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pada akhirnya, roket dengan ukuran yang semakin besar diluncurkan dari landasan peluncuran di sebelah Katedral St. Basil. </font><font style="vertical-align: inherit;">Di akhir keempat, pesawat ruang angkasa Buran ditampilkan - versi Soviet dari Space Shuttle Amerika. </font><font style="vertical-align: inherit;">Pada akhir terbaik, katedral itu sendiri naik ke udara, dan sebuah UFO menggantung di atas landasan peluncuran. </font><font style="vertical-align: inherit;">Di bawah ini adalah gambar dari setiap akhir dan skor yang terkait dengannya.</font></font><br><div class="scrollable-table"><table><tbody><tr><td> <code>30000–49999</code> <div style="text-align:center;"> <img src="https://habrastorage.org/getpro/habr/post_images/0b9/b73/4b4/0b9b734b43dae52eccafaa71e3c1441d.png"></div></td><td> <code>50000–69999</code> <div style="text-align:center;"> <img src="https://habrastorage.org/getpro/habr/post_images/ade/f93/f39/adef93f395eb2bef2c1fd71562857c39.png"></div></td><td> <code>70000–99999</code> <div style="text-align:center;"> <img src="https://habrastorage.org/getpro/habr/post_images/df3/480/b63/df3480b63de128a70b7c9e4dd7cec81f.png"></div></td></tr><tr><td> <code>100000–119999</code> <div style="text-align:center;"> <img src="https://habrastorage.org/getpro/habr/post_images/8e3/91a/658/8e391a6581df6e7ec0c08134b6a6d5bf.png"></div></td><td> <code>120000+</code> <div style="text-align:center;"> <img src="https://habrastorage.org/getpro/habr/post_images/3e1/2bd/42f/3e12bd42ffc331742d809325db418f78.png"></div></td><td></td></tr></tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dalam mode permainan B-Type, tes lain diterapkan, yang dijelaskan dalam buklet Nintendo Tetris sebagai berikut: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0aa/929/624/0aa929624f41a68ea1388b6ba9013dd3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika pemain berhasil mengosongkan 25 baris, maka permainan menunjukkan akhir, tergantung pada level awal. Ujung untuk level 0–8 terdiri dari hewan dan benda yang terbang atau berlari dalam bingkai, secara misterius lewat di belakang Katedral St. Basil. UFO dari akhir terbaik dari mode A-Type muncul di akhir 3. Pada akhirnya 4, pterosaurus terbang yang punah muncul, dan pada akhirnya 7 naga terbang mitos ditampilkan. Di akhir 2 dan 6, burung tanpa sayap ditampilkan: penguin dan burung unta berlari. Pada akhir 5, langit diisi dengan airships BAIK (jangan dikacaukan dengan Goodyear airships). Dan di akhir 8, banyak "Buranas" menyapu layar, meskipun pada kenyataannya hanya ada satu. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketinggian awal (plus 1) digunakan sebagai pengganda, yang memberi penghargaan kepada pemain dengan sejumlah besar binatang / benda untuk peningkatan kompleksitas.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di akhir terbaik dari B-Type, sebuah kastil yang penuh dengan karakter dari alam semesta Nintendo ditampilkan: Princess Peach bertepuk tangan, Kid Icarus memainkan biola, Donkey Kong mengetuk drum besar, tarian Mario dan Luigi, Bowser memainkan akordeon, Samus memainkan cello, Link - dengan seruling, sementara kubah Katedral St. Basil melambung ke udara. Jumlah elemen-elemen ini yang ditunjukkan pada akhir tergantung pada ketinggian awal. Di bawah ini adalah gambar dari 10 ujung.</font></font><br><br><div class="scrollable-table"><table><tbody><tr><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5d9/c8e/525/5d9c8e525177613cb3fcd59c7c6aa53a.png"></div></td><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ade/2fc/f3d/ade2fcf3d389b67e5d4b3d7e8c5c1ea0.png"></div></td><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ec9/bd3/9dd/ec9bd39dd26529013d7d408f6a4e855b.png"></div></td></tr><tr><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fdb/125/132/fdb125132ecaed550966562b5e08f169.png"></div></td><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/22b/758/028/22b75802841a3b558f8fae476f2d2598.png"></div></td><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/43e/710/858/43e710858220b08e1860da00a309c665.png"></div></td></tr><tr><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dda/332/1d5/dda3321d5e5246d2aa92eafb69f3cf5d.png"></div></td><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c6f/2d0/843/c6f2d0843995d294393bbbf277b83bdf.png"></div></td><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/572/3b8/f29/5723b8f2919ac35746b52923d59dbf41.png"></div></td></tr><tr><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/639/938/9df/6399389dfff187a8db7ac92f1dc815e3.png"></div></td><td></td><td></td></tr></tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AI dapat dengan cepat menghapus semua 25 baris yang diperlukan dalam mode B-Type pada level dan ketinggian awal apa pun, yang memungkinkan Anda untuk melihat salah satu dari ujungnya. Penting juga mengevaluasi seberapa keren dia menangani tumpukan besar blok acak. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pada akhir 0–8, hingga 6 objek dapat bergerak dalam bingkai. Koordinat y dari objek disimpan dalam tabel yang terletak di at </font></font><code>$A7B7</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Jarak horizontal antara objek disimpan dalam tabel di alamat </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Urutan nilai dengan tanda di alamat </font><font style="vertical-align: inherit;">menentukan kecepatan dan arah objek. </font><font style="vertical-align: inherit;">Indeks sprite disimpan di </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Bahkan, setiap objek terdiri dari dua sprite dengan indeks yang berdekatan. Untuk mendapatkan indeks kedua, Anda perlu menambahkan 1. Misalnya, naga terdiri dari</font></font><br><br> <code>A7B7: 98 A8 C0 A8 90 B0 ; 0 <br> A7BD: B0 B8 A0 B8 A8 A0 ; 1 <br> A7C3: C8 C8 C8 C8 C8 C8 ; 2 <br> A7C9: 30 20 40 28 A0 80 ; 3 <br> A7CF: A8 88 68 A8 48 78 ; 4 <br> A7D5: 58 68 18 48 78 38 ; 5 <br> A7DB: C8 C8 C8 C8 C8 C8 ; 6 <br> A7E1: 90 58 70 A8 40 38 ; 7 <br> A7E7: 68 88 78 18 48 A8 ; 8</code> <br> <br><font style="vertical-align: inherit;"></font><code>$A77B</code><font style="vertical-align: inherit;"></font><br><br> <code>A77B: 3A 24 0A 4A 3A FF ; 0 <br> A781: 22 44 12 32 4A FF ; 1 <br> A787: AE 6E 8E 6E 1E 02 ; 2 <br> A78D: 42 42 42 42 42 02 ; 3 <br> A793: 22 0A 1A 04 0A FF ; 4 <br> A799: EE DE FC FC F6 02 ; 5 <br> A79F: 80 80 80 80 80 FF ; 6 <br> A7A5: E8 E8 E8 E8 48 FF ; 7 <br> A7AB: 80 AE 9E 90 80 02 ; 8</code> <br> <br><font style="vertical-align: inherit;"></font><code>$A771</code><font style="vertical-align: inherit;"></font><br><br> <code>A771: 01 ; 0: 1 <br> A772: 01 ; 1: 1 <br> A773: FF ; 2: -1 <br> A774: FC ; 3: -4 <br> A775: 01 ; 4: 1 <br> A776: FF ; 5: -1 <br> A777: 02 ; 6: 2 <br> A778: 02 ; 7: 2 <br> A779: FE ; 8: -1</code> <br> <br><font style="vertical-align: inherit;"></font><code>$A7F3</code><font style="vertical-align: inherit;"></font><br><br> <code>A7F3: 2C ; 0: dragonfly <br> A7F4: 2E ; 1: dove <br> A7F5: 54 ; 2: penguin <br> A7F6: 32 ; 3: UFO <br> A7F7: 34 ; 4: pterosaur <br> A7F8: 36 ; 5: blimp <br> A7F9: 4B ; 6: ostrich <br> A7FA: 38 ; 7: dragon <br> A7FB: 3A ; 8: Buran</code> <br> <br><font style="vertical-align: inherit;"></font><code>$38</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>$39</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ubin untuk sprite ini terdapat dalam tabel pola di bawah ini.</font></font><br><br><div class="scrollable-table"><table><tbody><tr><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/86d/524/373/86d5243738d9c3e34db5318889c4f894.png"></div></td><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d82/2d1/229/d822d122984b77a0973f08feac962647.png"></div></td><td><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d8a/3c1/9b5/d8a3c19b513fb9f7338e250b97fdeac1.png"></div></td></tr></tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami memeriksa tabel pusat dari pola di atas, digunakan untuk menampilkan tetrimino dan lapangan bermain. </font><font style="vertical-align: inherit;">Menariknya, ini berisi seluruh alfabet, sementara yang lain hanya berisi sebagian saja untuk menghemat ruang. </font><font style="vertical-align: inherit;">Tetapi yang lebih menarik adalah sprite pesawat dan helikopter di tabel pola di sebelah kiri; </font><font style="vertical-align: inherit;">mereka tidak muncul di akhir atau di bagian lain dari permainan. </font><font style="vertical-align: inherit;">Ternyata pesawat dan helikopter memiliki indeks sprite </font></font><code>$30</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>$16</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan Anda dapat mengubah tabel yang ditunjukkan di atas, untuk melihat mereka beraksi.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/04e/2e2/203/04e2e2203b1581876d99736ad9b56fd6.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/445/153/3b4/4451533b43874485cb5a0cdfd9df0c58.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sayangnya, tunggangan helikopter tidak ditampilkan, tetapi rotor utama dan rotornya beranimasi indah. </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2 Pemain Versus </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nintendo Tetris berisi mode dua pemain yang tidak lengkap yang dapat Anda aktifkan dengan mengubah jumlah pemain ( </font></font><code>$00BE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) menjadi 2. Seperti yang ditunjukkan di bawah ini, dua bidang game muncul di latar mode single-player.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/418/6e7/2af/4186e72af40c6c617996ca2f8d39a72c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tidak ada batas antara bidang karena wilayah tengah latar belakang hitam pekat. Nilai yang </font></font><code>003</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ditunjukkan di atas bidang bermain menunjukkan jumlah baris yang dihapus oleh masing-masing pemain. Satu-satunya figur umum untuk dua pemain muncul di tempat yang sama dengan mode pemain tunggal. Sayangnya, ini terletak di lapangan bermain yang tepat. Kotak dan ubin lainnya berwarna salah. Dan saat pemain kalah, permainan dimulai kembali. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapi jika Anda mengabaikan masalah ini, maka mode ini cukup bisa dimainkan. Setiap pemain dapat secara independen mengontrol potongan-potongan di lapangan bermain yang sesuai. Dan ketika pemain mengetik Double, Triple atau Tetris (yaitu, membersihkan dua, tiga atau empat baris), baris sampah dengan satu kotak yang hilang muncul di bagian bawah bidang permainan lawan.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bidang tambahan terletak di </font></font><code>$0500</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. A </font></font><code>$0060</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>$007F</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, biasanya menjadi cermin </font></font><code>$0040</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>$005F</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, digunakan untuk pemain kedua. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mungkin, mode menarik ini ditinggalkan karena jadwal pengembangan yang sibuk. Atau mungkin dia dibiarkan belum selesai dengan sengaja. Salah satu alasan Tetris dipilih sebagai game yang dibundel dengan Nintendo Game Boy adalah karena mendorong pembelian </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Game Link Cable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- aksesori yang menghubungkan dua Game Boys bersama-sama untuk meluncurkan 2 pemain versus mode. </font><font style="vertical-align: inherit;">Kabel ini menambahkan elemen "sosialitas" ke sistem - ini mendorong teman untuk membeli Game Boy untuk bergabung dalam kegembiraan. </font><font style="vertical-align: inherit;">Mungkin Nintendo takut bahwa jika versi konsol permainan memiliki 2 pemain versus mode, maka kekuatan "iklan" Tetris, yang merangsang pembelian Game Boy, mungkin akan melemah.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Efek musik dan suara </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Musik latar dihidupkan ketika </font></font><code>$06F5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">salah satu nilai yang tercantum dalam tabel diberikan.</font></font><br><br><div class="scrollable-table"><table><tbody><tr><th>  Nilai </th><th>  Deskripsi </th></tr><tr><td> <code>01</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Musik layar splash yang tidak digunakan </font></font></td></tr><tr><td> <code>02</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mencapai target mode Tipe-B </font></font></td></tr><tr><td> <code>03</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Musik-1 </font></font></td></tr><tr><td> <code>04</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Musik-2 </font></font></td></tr><tr><td> <code>05</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Musik-3 </font></font></td></tr><tr><td> <code>06</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Musik-1 allegro </font></font></td></tr><tr><td> <code>07</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Musik-2 allegro </font></font></td></tr><tr><td> <code>08</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Musik-3 allegro </font></font></td></tr><tr><td> <code>09</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Layar Selamat </font></font></td></tr><tr><td> <code>0A</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Akhir </font></font></td></tr><tr><td> <code>0B</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mencapai target mode Tipe-B </font></font></td></tr></tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda dapat mendengarkan musik yang tidak digunakan dari screen saver di </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dalam game itu sendiri, tidak ada yang terdengar selama layar screen saver. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Music-1 adalah versi " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dance of the Dragee Fairy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", musik untuk balerina dari babak ketiga </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pas de deux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> waltz </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"The Nutcracker" oleh</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tchaikovsky. Musik penutup adalah variasi dari " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bullfighter Verses</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", sebuah aria dari opera </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carmen</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Georges Bizet. Komposisi ini diatur oleh komposer dari sisa musik </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hirokazu Tanaka</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Musik-2 terinspirasi oleh lagu-lagu tradisional Rusia. Musik-3 misterius, futuristik dan lembut; Untuk sementara, itu nada dering telepon dukungan pelanggan Nintendo of America.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk membantu pemain jatuh ke dalam kepanikan ketika ketinggian tumpukan mendekati langit-langit lapangan bermain, versi musik latar mulai diputar dengan kecepatan cepat ( </font></font><code>$06</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>$08</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menariknya, di antara komposisi musik tidak ada " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chapman</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", tema terkenal yang terdengar di Game Boy Tetris. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Efek suara dipicu dengan merekam di </font></font><code>$06F0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>$06F1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sesuai dengan tabel berikut.</font></font><br><br><div class="scrollable-table"><table><tbody><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Alamatnya </font></font></th><th>  Nilai </th><th>  Deskripsi </th></tr><tr><td> <code>06F0</code> </td> <td> <code>02</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tirai akhir pertandingan </font></font></td></tr><tr><td> <code>06F0</code> </td> <td> <code>03</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Roket pada akhirnya </font></font></td></tr><tr><td> <code>06F1</code> </td> <td> <code>01</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pilihan opsi menu </font></font></td></tr><tr><td> <code>06F1</code> </td> <td> <code>02</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pemilihan Layar Menu </font></font></td></tr><tr><td> <code>06F1</code> </td> <td> <code>03</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pergeseran Tetrimino </font></font></td></tr><tr><td> <code>06F1</code> </td> <td> <code>04</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Menerima Tetris </font></font></td></tr><tr><td> <code>06F1</code> </td> <td> <code>05</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rotasi tetrimino </font></font></td></tr><tr><td> <code>06F1</code> </td> <td> <code>06</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tingkat baru </font></font></td></tr><tr><td> <code>06F1</code> </td> <td> <code>07</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kunci Tetrimino </font></font></td></tr><tr><td> <code>06F1</code> </td> <td> <code>08</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kicau </font></font></td></tr><tr><td> <code>06F1</code> </td> <td> <code>09</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Membersihkan baris </font></font></td></tr><tr><td> <code>06F1</code> </td> <td> <code>0A</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Baris terisi </font></font></td></tr></tbody></table></div><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Status gim dan mode render </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selama bermain game, kondisi permainan saat ini diwakili oleh bilangan bulat di alamat </font></font><code>$0048</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Sebagian besar waktu memiliki makna </font></font><code>$01</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang menunjukkan bahwa pemain mengontrol tetrimino aktif. </font><font style="vertical-align: inherit;">Namun, ketika potongan terkunci di tempatnya, permainan secara bertahap beralih dari negara </font></font><code>$02</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ke negara </font></font><code>$08</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, seperti yang ditunjukkan dalam tabel.</font></font><br><br><div class="scrollable-table"><table><tbody><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ketentuan </font></font></th><th>  Deskripsi </th></tr><tr><td> <code>00</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ID Orientasi yang Tidak Ditugaskan </font></font></td></tr><tr><td> <code>01</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pemain mengontrol tetrimino aktif </font></font></td></tr><tr><td> <code>02</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kunci tetrimino di lapangan bermain </font></font></td></tr><tr><td> <code>03</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Memeriksa Baris yang Diisi </font></font></td></tr><tr><td> <code>04</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tampilkan animasi pembersihan baris </font></font></td></tr><tr><td> <code>05</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Memperbarui baris dan statistik </font></font></td></tr><tr><td> <code>06</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Memeriksa target mode Tipe-B </font></font></td></tr><tr><td> <code>07</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tidak digunakan </font></font></td></tr><tr><td> <code>08</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Buat Tetrimino Berikutnya </font></font></td></tr><tr><td> <code>09</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tidak digunakan </font></font></td></tr><tr><td> <code>0A</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pembaruan Tirai Game </font></font></td></tr><tr><td> <code>0B</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Peningkatan status game </font></font></td></tr></tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Percabangan kode, tergantung pada kondisi gim, terjadi di alamat berikut </font></font><code>$81B2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">Pada kondisi </font><font style="vertical-align: inherit;">sakelar, lompatan ke kode yang memberikan </font><font style="vertical-align: inherit;">nilai yang </font><font style="vertical-align: inherit;">menunjukkan bahwa orientasi tidak diatur. </font><font style="vertical-align: inherit;">Pawang tidak pernah dipanggil; Namun, kondisi permainan </font><font style="vertical-align: inherit;">berfungsi sebagai sinyal ke bagian lain dari kode. </font><font style="vertical-align: inherit;">Negara </font><font style="vertical-align: inherit;">memungkinkan pemain untuk menggeser, memutar, dan menurunkan tetrimino aktif: </font><font style="vertical-align: inherit;">Seperti yang dinyatakan dalam bagian sebelumnya, pergeseran, rotasi, dan penurunan rutinitas gambar sebelum menjalankan kode memeriksa posisi baru tetrimino. Satu-satunya cara untuk memblokir bentuk di posisi yang salah adalah membuatnya di atas bentuk yang sudah ada. Dalam hal ini, permainan berakhir. Seperti yang ditunjukkan di bawah ini, kode status melakukan pemeriksaan ini.</font></font><br><br> <code>81B2: LDA $0048 <br> 81B4: JSR $AC82 ; switch(playState) { <br> 81B7: 2F 9E ; case 00: goto 9E2F; // Unassign orientationID <br> 81B9: CF 81 ; case 01: goto 81CF; // Player controls active Tetrimino <br> 81BB: A2 99 ; case 02: goto 99A2; // Lock Tetrimino into playfield <br> 81BD: 6B 9A ; case 03: goto 9A6B; // Check for completed rows <br> 81BF: 39 9E ; case 04: goto 9E39; // Display line clearing animation <br> 81C1: 58 9B ; case 05: goto 9B58; // Update lines and statistics <br> 81C3: F2 A3 ; case 06: goto A3F2; // B-Type goal check; Unused frame for A-Type <br> 81C5: 03 9B ; case 07: goto 9B03; // Unused frame; Execute unfinished 2 player mode logic <br> 81C7: 8E 98 ; case 08: goto 988E; // Spawn next Tetrimino <br> 81C9: 39 9E ; case 09: goto 9E39; // Unused <br> 81CB: 11 9A ; case 0A: goto 9A11; // Update game over curtain <br> 81CD: 37 9E ; case 0B: goto 9E37; // Increment play state <br> ; }</code> <br> <br><font style="vertical-align: inherit;"></font><code>$00</code><font style="vertical-align: inherit;"></font><code>orientationID</code><font style="vertical-align: inherit;"></font><code>$13</code><font style="vertical-align: inherit;"></font><br><br> <code>9E2F: LDA #$13 <br> 9E31: STA $0042 ; orientationID = UNASSIGNED; <br> <br> 9E33: RTS ; return;</code> <br> <br><font style="vertical-align: inherit;"></font><code>$00</code><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><code>$01</code><font style="vertical-align: inherit;"></font><br><br> <code>81CF: JSR $89AE ; shift Tetrimino; <br> 81D2: JSR $88AB ; rotate Tetrimino; <br> 81D5: JSR $8914 ; drop Tetrimino; <br> <br> 81D8: RTS ; return;</code> <br> <br><font style="vertical-align: inherit;"></font><code>$02</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Jika posisi terkunci benar, ini menandai 4 sel terkait dari lapangan bermain sebagai ditempati. Jika tidak, ia membuat transisi ke keadaan </font><font style="vertical-align: inherit;">- tirai yang tidak menyenangkan di akhir permainan.</font></font><br><br> <code>99A2: JSR $948B ; if (new position valid) { <br> 99A5: BEQ $99B8 ; goto updatePlayfield; <br> ; } <br> <br> 99A7: LDA #$02 <br> 99A9: STA $06F0 ; play curtain sound effect; <br> <br> 99AC: LDA #$0A <br> 99AE: STA $0048 ; playState = UPDATE_GAME_OVER_CURTAIN; <br> <br> 99B0: LDA #$F0 <br> 99B2: STA $0058 ; curtainRow = -16; <br> <br> 99B4: JSR $E003 ; updateAudio(); <br> <br> 99B7: RTS ; return;</code> <br> <br><font style="vertical-align: inherit;"></font><code>$0A</code><font style="vertical-align: inherit;"></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b1b/7c0/a46/b1b7c0a4637995c25423a07984bce24e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tirai ditarik dari bagian atas lapangan bermain ke bawah, turun satu baris setiap 4 frame. </font></font><code>curtainRow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>$0058</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) menginisialisasi dengan nilai −16, menciptakan penundaan tambahan 0,27 detik antara kunci terakhir dan awal animasi. Di alamat </font></font><code>$9A21</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dalam keadaan </font></font><code>$0A</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kode yang ditunjukkan di bawah ini, tabel perkalian diakses, yang keliru ditampilkan sebagai angka level. Ini dilakukan untuk menskalakan </font></font><code>curtainRow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10. Selain itu, seperti yang ditunjukkan di atas, kode di alamat </font></font><code>$9A51</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memulai animasi akhir jika skor pemain tidak kurang dari 30.000 poin; jika tidak, ia akan mengklik Mulai. </font><font style="vertical-align: inherit;">Kode selesai dengan memberikan nilai ke status permainan </font><font style="vertical-align: inherit;">, tetapi penangan yang sesuai tidak dipanggil karena permainan selesai.</font></font><br><br> <code>9A11: LDA $0058 ; if (curtainRow == 20) { <br> 9A13: CMP #$14 ; goto endGame; <br> 9A15: BEQ $9A47 ; } <br> <br> 9A17: LDA $00B1 ; if (frameCounter not divisible by 4) { <br> 9A19: AND #$03 ; return; <br> 9A1B: BNE $9A46 ; } <br> <br> 9A1D: LDX $0058 ; if (curtainRow &lt; 0) { <br> 9A1F: BMI $9A3E ; goto incrementCurtainRow; <br> ; } <br> <br> 9A21: LDA $96D6,X <br> 9A24: TAY ; rowIndex = 10 * curtainRow; <br> <br> 9A25: LDA #$00 <br> 9A27: STA $00AA ; i = 0; <br> <br> 9A29: LDA #$13 <br> 9A2B: STA $0042 ; orientationID = NONE; <br> <br> drawCurtainRow: <br> <br> 9A2D: LDA #$4F <br> 9A2F: STA ($B8),Y ; playfield[rowIndex + i] = CURTAIN_TILE; <br> 9A31: INY <br> 9A32: INC $00AA ; i++; <br> 9A34: LDA $00AA <br> 9A36: CMP #$0A ; if (i != 10) { <br> 9A38: BNE $9A2D ; goto drawCurtainRow; <br> ; } <br> <br> 9A3A: LDA $0058 <br> 9A3C: STA $0049 ; vramRow = curtainRow; <br> <br> incrementCurtainRow: <br> <br> 9A3E: INC $0058 ; curtainRow++; <br> <br> 9A40: LDA $0058 ; if (curtainRow != 20) { <br> 9A42: CMP #$14 ; return; <br> 9A44: BNE $9A46 ; } <br> <br> 9A46: RTS ; return; <br> <br> endGame: <br> <br> 9A47: LDA $00BE <br> 9A49: CMP #$02 <br> 9A4B: BEQ $9A64 ; if (numberOfPlayers == 1) { <br> <br> 9A4D: LDA $0075 <br> 9A4F: CMP #$03 <br> 9A51: BCC $9A5E ; if (score[2] &gt;= $03) { <br> <br> 9A53: LDA #$80 <br> 9A55: JSR $A459 <br> 9A58: JSR $9E3A <br> 9A5B: JMP $9A64 ; select ending; <br> ; } <br> <br> 9A5E: LDA $00F5 ; if (not just pressed Start) { <br> 9A60: CMP #$10 ; return; <br> 9A62: BNE $9A6A ; } <br> ; } <br> <br> 9A64: LDA #$00 <br> 9A66: STA $0048 ; playState = INITIALIZE_ORIENTATION_ID; <br> 9A68: STA $00F5 ; clear newly pressed buttons; <br> <br> 9A6A: RTS ; return;</code> <br> <br><font style="vertical-align: inherit;"></font><code>$00</code><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Baris dari lapangan bermain secara bertahap disalin ke VRAM untuk menampilkannya. </font><font style="vertical-align: inherit;">Indeks baris saat ini untuk disalin terkandung dalam </font></font><code>vramRow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>$0049</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><code>$9A3C</code> <code>vramRow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nilai ditugaskan </font><font style="vertical-align: inherit;">di alamat </font></font><code>curtainRow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang akhirnya membuat garis ini terlihat saat rendering. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manipulasi dengan VRAM terjadi selama interval pengosongan vertikal, yang diakui oleh pengendali interupsi yang dijelaskan dalam bagian "Layar Informasi Hukum". </font><font style="vertical-align: inherit;">Ia menyebut subrutin yang ditunjukkan di bawah ini (ditandai dalam komentar interrupt handler as </font></font><code>render()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">Mode rendering mirip dengan mode game. </font><font style="vertical-align: inherit;">Itu disimpan di alamat </font><font style="vertical-align: inherit;">dan dapat memiliki salah satu dari nilai berikut:</font></font><br><br> <code>804B: LDA $00BD <br> 804D: JSR $AC82 ; switch(renderMode) { <br> 8050: B1 82 ; case 0: goto 82B1; // Legal and title screens <br> 8052: DA 85 ; case 1: goto 85DA; // Menu screens <br> 8054: 44 A3 ; case 2: goto A344; // Congratulations screen <br> 8056: EE 94 ; case 3: goto 94EE; // Play and demo <br> 8058: 95 9F ; case 4: goto 9F95; // Ending animation <br> ; }</code> <br> <br><font style="vertical-align: inherit;"></font><code>$00BD</code><font style="vertical-align: inherit;"></font><br><br><div class="scrollable-table"><table><tbody><tr><th>  Nilai </th><th>  Deskripsi </th></tr><tr><td> <code>00</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Layar dengan legal </font><font style="vertical-align: inherit;">informasi dan screen saver</font></font></td></tr><tr><td> <code>01</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Layar Menu </font></font></td></tr><tr><td> <code>02</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Layar Selamat </font></font></td></tr><tr><td> <code>03</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Game dan demo </font></font></td></tr><tr><td> <code>04</code> </td> <td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mengakhiri animasi </font></font></td></tr></tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian dari mode rendering </font></font><code>$03</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ditunjukkan di bawah ini. </font><font style="vertical-align: inherit;">Seperti yang dapat Anda lihat di bawah, ini </font><font style="vertical-align: inherit;">melewati VRAM garis lapangan bermain dengan indeks </font><font style="vertical-align: inherit;">. Jika </font><font style="vertical-align: inherit;">lebih besar dari 20, rutin tidak melakukan apa pun. </font><font style="vertical-align: inherit;">Tabel </font><font style="vertical-align: inherit;">( </font><font style="vertical-align: inherit;">) berisi alamat-alamat VRAM dalam format endian kecil yang sesuai dengan garis-garis yang ditampilkan dari lapangan bermain bergeser 6 dalam mode normal dan by2 dan 12 untuk lapangan bermain dalam mode yang belum selesai 2 Player Versus. Byte dari tabel ini adalah bagian dari daftar nilai yang keliru ditampilkan sebagai angka level setelah level 29. Bytes yang lebih rendah dan lebih tinggi dari masing-masing alamat diperoleh secara terpisah dan pada dasarnya digabungkan menjadi alamat 16-bit, yang digunakan dalam siklus penyalinan. </font><font style="vertical-align: inherit;">Selisih dieksekusi pada akhir subrutin.</font></font><br><br> <code>952A: JSR $9725 ; copyPlayfieldRowToVRAM(); <br> 952D: JSR $9725 ; copyPlayfieldRowToVRAM(); <br> 9530: JSR $9725 ; copyPlayfieldRowToVRAM(); <br> 9533: JSR $9725 ; copyPlayfieldRowToVRAM();</code> <br> <br><font style="vertical-align: inherit;"></font><code>copyPlayfieldRowToVRAM()</code><font style="vertical-align: inherit;"></font><code>vramRow</code><font style="vertical-align: inherit;"></font><code>vramRow</code><font style="vertical-align: inherit;"></font><br><br> <code>9725: LDX $0049 ; if (vramRow &gt; 20) { <br> 9727: CPX #$15 ; return; <br> 9729: BPL $977E ; } <br> <br> 972B: LDA $96D6,X <br> 972E: TAY ; playfieldAddress = 10 * vramRow; <br> <br> 972F: TXA <br> 9730: ASL <br> 9731: TAX <br> 9732: INX ; high = vramPlayfieldRows[vramRow * 2 + 1]; <br> 9733: LDA $96EA,X <br> 9736: STA $2006 <br> 9739: DEX <br> <br> 973A: LDA $00BE <br> 973C: CMP #$01 <br> 973E: BEQ $975E ; if (numberOfPlayers == 2) { <br> <br> 9740: LDA $00B9 <br> 9742: CMP #$05 <br> 9744: BEQ $9752 ; if (leftPlayfield) { <br> <br> 9746: LDA $96EA,X <br> 9749: SEC <br> 974A: SBC #$02 <br> 974C: STA $2006 ; low = vramPlayfieldRows[vramRow * 2] - 2; <br> <br> 974F: JMP $9767 ; } else { <br> <br> 9752: LDA $96EA,X <br> 9755: CLC <br> 9756: ADC #$0C <br> 9758: STA $2006 ; low = vramPlayfieldRows[vramRow * 2] + 12; <br> <br> 975B: JMP $9767 ; } else { <br> <br> 975E: LDA $96EA,X <br> 9761: CLC <br> 9762: ADC #$06 ; low = vramPlayfieldRows[vramRow * 2] + 6; <br> 9764: STA $2006 ; } <br> <br> ; vramAddress = (high &lt;&lt; 8) | low; <br> <br> 9767: LDX #$0A <br> 9769: LDA ($B8),Y <br> 976B: STA $2007 <br> 976E: INY ; for(i = 0; i &lt; 10; i++) { <br> 976F: DEX ; vram[vramAddress + i] = playfield[playfieldAddress + i]; <br> 9770: BNE $9769 ; } <br> <br> 9772: INC $0049 ; vramRow++; <br> 9774: LDA $0049 ; if (vramRow &lt; 20) { <br> 9776: CMP #$14 ; return; <br> 9778: BMI $977E ; } <br> <br> 977A: LDA #$20 <br> 977C: STA $0049 ; vramRow = 32; <br> <br> 977E: RTS ; return;</code> <br> <br><font style="vertical-align: inherit;"></font><code>vramPlayfieldRows</code><font style="vertical-align: inherit;"></font><code>$96EA</code><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><code>vramRow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Jika nilainya mencapai 20, maka diberikan nilai 32, yang berarti bahwa salinannya telah selesai sepenuhnya. Seperti yang ditunjukkan di atas, hanya 4 baris yang disalin per bingkai. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penangan negara </font></font><code>$03</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bertanggung jawab untuk mengenali garis yang telah diselesaikan dan menghapusnya dari lapangan permainan. Selama 4 panggilan terpisah, ia memindai garis offset di </font></font><code>[−2, 1]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dekat pusat tetrimino (kedua koordinat dari semua kotak tetrimino berada dalam interval ini). Indeks baris selesai disimpan di </font></font><code>$004A</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>$004D</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; indeks yang direkam 0 digunakan untuk menunjukkan bahwa tidak ada baris lengkap yang ditemukan dalam pass ini. Pawang ditunjukkan di bawah ini. </font><font style="vertical-align: inherit;">Pemeriksaan </font><font style="vertical-align: inherit;">di awal tidak memungkinkan pawang untuk mengeksekusi ketika mentransfer garis lapangan bermain ke VRAM (pengendali keadaan)</font></font><br><br> <code>9A6B: LDA $0049 <br> 9A6D: CMP #$20 ; if (vramRow &lt; 32) { <br> 9A6F: BPL $9A74 ; return; <br> 9A71: JMP $9B02 ; } <br> <br> 9A74: LDA $0041 ; rowY = tetriminoY - 2; <br> 9A76: SEC <br> 9A77: SBC #$02 ; if (rowY &lt; 0) { <br> 9A79: BPL $9A7D ; rowY = 0; <br> 9A7B: LDA #$00 ; } <br> <br> 9A7D: CLC <br> 9A7E: ADC $0057 <br> 9A80: STA $00A9 ; rowY += lineIndex; <br> <br> 9A82: ASL <br> 9A83: STA $00A8 <br> 9A85: ASL <br> 9A86: ASL <br> 9A87: CLC <br> 9A88: ADC $00A8 <br> 9A8A: STA $00A8 ; rowIndex = 10 * rowY; <br> <br> 9A8C: TAY <br> 9A8D: LDX #$0A <br> 9A8F: LDA ($B8),Y <br> 9A91: CMP #$EF ; for(i = 0; i &lt; 10; i++) { <br> 9A93: BEQ $9ACC ; if (playfield[rowIndex + i] == EMPTY_TILE) { <br> 9A95: INY ; goto rowNotComplete; <br> 9A96: DEX ; } <br> 9A97: BNE $9A8F ; } <br> <br> 9A99: LDA #$0A <br> 9A9B: STA $06F1 ; play row completed sound effect; <br> <br> 9A9E: INC $0056 ; completedLines++; <br> <br> 9AA0: LDX $0057 <br> 9AA2: LDA $00A9 <br> 9AA4: STA $4A,X ; lines[lineIndex] = rowY; <br> <br> 9AA6: LDY $00A8 <br> 9AA8: DEY <br> 9AA9: LDA ($B8),Y <br> 9AAB: LDX #$0A <br> 9AAD: STX $00B8 <br> 9AAF: STA ($B8),Y <br> 9AB1: LDA #$00 <br> 9AB3: STA $00B8 <br> 9AB5: DEY ; for(i = rowIndex - 1; i &gt;= 0; i--) { <br> 9AB6: CPY #$FF ; playfield[i + 10] = playfield[i]; <br> 9AB8: BNE $9AA9 ; } <br> <br> 9ABA: LDA #$EF <br> 9ABC: LDY #$00 <br> 9ABE: STA ($B8),Y <br> 9AC0: INY ; for(i = 0; i &lt; 10; i++) { <br> 9AC1: CPY #$0A ; playfield[i] = EMPTY_TILE; <br> 9AC3: BNE $9ABE ; } <br> <br> 9AC5: LDA #$13 <br> 9AC7: STA $0042 ; orientationID = UNASSIGNED; <br> <br> 9AC9: JMP $9AD2 ; goto incrementLineIndex; <br> <br> rowNotComplete: <br> <br> 9ACC: LDX $0057 <br> 9ACE: LDA #$00 <br> 9AD0: STA $4A,X ; lines[lineIndex] = 0; <br> <br> incrementLineIndex: <br> <br> 9AD2: INC $0057 ; lineIndex++; <br> <br> 9AD4: LDA $0057 ; if (lineIndex &lt; 4) { <br> 9AD6: CMP #$04 ; return; <br> 9AD8: BMI $9B02 ; } <br> <br> 9ADA: LDY $0056 <br> 9ADC: LDA $9B53,Y <br> 9ADF: CLC <br> 9AE0: ADC $00BC <br> 9AE2: STA $00BC ; totalGarbage += garbageLines[completedLines]; <br> <br> 9AE4: LDA #$00 <br> 9AE6: STA $0049 ; vramRow = 0; <br> 9AE8: STA $0052 ; clearColumnIndex = 0; <br> <br> 9AEA: LDA $0056 <br> 9AEC: CMP #$04 <br> 9AEE: BNE $9AF5 ; if (completedLines == 4) { <br> 9AF0: LDA #$04 ; play Tetris sound effect; <br> 9AF2: STA $06F1 ; } <br> <br> 9AF5: INC $0048 ; if (completedLines &gt; 0) { <br> 9AF7: LDA $0056 ; playState = DISPLAY_LINE_CLEARING_ANIMATION; <br> 9AF9: BNE $9B02 ; return; <br> ; } <br> <br> 9AFB: INC $0048 ; playState = UPDATE_LINES_AND_STATISTICS; <br> <br> 9AFD: LDA #$07 <br> 9AFF: STA $06F1 ; play piece locked sound effect; <br> <br> 9B02: RTS ; return;</code> <br> <br><font style="vertical-align: inherit;"></font><code>vramRow</code><font style="vertical-align: inherit;"></font><code>$03</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">disebut dalam setiap frame). Jika baris yang diisi terdeteksi, maka </font></font><code>vramRow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reset ke 0, yang memaksa pemindahan total. </font></font><br><br> <code>lineIndex</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><code>$00A9</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) diinisialisasi dengan nilai 0 dan kenaikannya dilakukan di setiap pass. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tidak seperti keadaan gim </font></font><code>$0A</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan rutinitas salin bidang gim, yang menggunakan tabel perkalian alamat </font></font><code>$96D6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, blok yang dimulai dengan </font></font><code>$9A82</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengalikan </font></font><code>rowY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan 10 menggunakan shift dan penambahan: </font></font><br><br> <code>rowIndex = (rowY &lt;&lt; 1) + (rowY &lt;&lt; 3); // rowIndex = 2 * rowY + 8 * rowY;</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini dilakukan hanya karena </font></font><code>rowY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dibatasi oleh interval </font></font><code>[0, 20]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan tabel perkalian hanya mencakup </font></font><code>[0, 19]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Pemindaian baris dapat melampaui batas lapangan permainan. Namun, seperti yang dikatakan sebelumnya, permainan menginisialisasi </font></font><code>$0400</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>$04FF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan nilai</font></font><code>$EF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ubin kosong), membuat lebih dari 5 garis tersembunyi kosong tambahan di bawah lantai lapangan bermain. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blok yang dimulai dengan </font></font><code>$9ADA</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adalah bagian dari mode 2 Player Versus yang tidak lengkap. Seperti disebutkan di atas, membersihkan baris menambah puing ke lapangan permainan lawan. Jumlah baris sampah ditentukan oleh tabel di alamat </font></font><code>$9B53</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">Siklus di alamat </font><font style="vertical-align: inherit;">menggeser materi di atas baris yang diisi satu baris ke bawah. Dia mengambil keuntungan dari kenyataan bahwa setiap baris dalam urutan kontinyu dipisahkan dari yang lain dengan 10 byte. Loop berikutnya membersihkan baris atas. </font><font style="vertical-align: inherit;">Animasi baris-jelas dilakukan selama keadaan permainan </font><font style="vertical-align: inherit;">, tetapi seperti yang ditunjukkan di bawah ini, itu tidak terjadi di pengendali keadaan permainan, yang benar-benar kosong.</font></font><br><br> <code>9B53: 00 ; no cleared lines <br> 9B54: 00 ; Single <br> 9B55: 01 ; Double <br> 9B56: 02 ; Triple <br> 9B57: 04 ; Tetris</code> <br> <br><font style="vertical-align: inherit;"></font><code>$9AA6</code><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><code>$04</code><font style="vertical-align: inherit;"></font><br><br> <code>9E39: RTS ; return;</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sebagai gantinya, selama kondisi permainan </font></font><code>$04</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, percabangan berikutnya dari mode rendering dilakukan </font></font><code>$03</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">dan nilai cermin diperlukan untuk mode yang belum selesai 2 Player Versus. </font><font style="vertical-align: inherit;">Subrutin ditunjukkan di bawah ini </font><font style="vertical-align: inherit;">. Itu disebut di setiap frame, tetapi kondisi di awal memungkinkan untuk dieksekusi hanya di setiap frame keempat. Di setiap lintasan, ia menelusuri daftar indeks dari baris yang telah selesai dan membersihkan 2 kolom di baris ini, bergerak dari kolom tengah ke arah luar. </font><font style="vertical-align: inherit;">Alamat VRAM 16-bit dibangun dengan cara yang sama seperti yang ditunjukkan dalam rutinitas bidang salin. Namun, dalam hal ini, ia melakukan offset dengan indeks kolom yang diperoleh dari tabel di bawah ini.</font></font><br><br> <code>94EE: LDA $0068 <br> 94F0: CMP #$04 <br> 94F2: BNE $9522 ; if (playState == DISPLAY_LINE_CLEARING_ANIMATION) { <br> <br> 94F4: LDA #$04 <br> 94F6: STA $00B9 ; leftPlayfield = true; <br> <br> 94F8: LDA $0072 <br> 94FA: STA $0052 <br> 94FC: LDA $006A <br> 94FE: STA $004A <br> 9500: LDA $006B <br> 9502: STA $004B <br> 9504: LDA $006C <br> 9506: STA $004C <br> 9508: LDA $006D <br> 950A: STA $004D <br> 950C: LDA $0068 <br> 950E: STA $0048 ; mirror values; <br> <br> 9510: JSR $977F ; updateLineClearingAnimation(); <br> <br> ; ... <br> ; }</code> <br> <br> <code>leftPlayfield</code><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><code>updateLineClearingAnimation()</code><font style="vertical-align: inherit;"></font><br><br> <code>977F: LDA $00B1 ; if (frameCounter not divisible by 4) { <br> 9781: AND #$03 ; return; <br> 9783: BNE $97FD ; } <br> <br> 9785: LDA #$00 ; for(i = 0; i &lt; 4; i++) { <br> 9787: STA $00AA ; rowY = lines[i]; <br> 9789: LDX $00AA ; if (rowY == 0) { <br> 978B: LDA $4A,X ; continue; <br> 978D: BEQ $97EB ; } <br> <br> 978F: ASL <br> 9790: TAY <br> 9791: LDA $96EA,Y <br> 9794: STA $00A8 ; low = vramPlayfieldRows[2 * rowY]; <br> <br> 9796: LDA $00BE ; if (numberOfPlayers == 2) { <br> 9798: CMP #$01 ; goto twoPlayers; <br> 979A: BNE $97A6 ; } <br> <br> 979C: LDA $00A8 <br> 979E: CLC <br> 979F: ADC #$06 <br> 97A1: STA $00A8 ; low += 6; <br> <br> 97A3: JMP $97BD ; goto updateVRAM; <br> <br> twoPlayers: <br> <br> 97A6: LDA $00B9 <br> 97A8: CMP #$04 <br> 97AA: BNE $97B6 ; if (leftPlayfield) { <br> <br> 97AC: LDA $00A8 <br> 97AE: SEC <br> 97AF: SBC #$02 <br> 97B1: STA $00A8 ; low -= 2; <br> <br> 97B3: JMP $97BD ; } else { <br> <br> 97B6: LDA $00A8 <br> 97B8: CLC <br> 97B9: ADC #$0C ; low += 12; <br> 97BB: STA $00A8 ; } <br> <br> updateVRAM: <br> <br> 97BD: INY <br> 97BE: LDA $96EA,Y <br> 97C1: STA $00A9 <br> 97C3: STA $2006 <br> 97C6: LDX $0052 ; high = vramPlayfieldRows[2 * rowY + 1]; <br> 97C8: LDA $97FE,X <br> 97CB: CLC ; rowAddress = (high &lt;&lt; 8) | low; <br> 97CC: ADC $00A8 <br> 97CE: STA $2006 ; vramAddress = rowAddress + leftColumns[clearColumnIndex]; <br> 97D1: LDA #$FF <br> 97D3: STA $2007 ; vram[vramAddress] = 255; <br> <br> 97D6: LDA $00A9 <br> 97D8: STA $2006 <br> 97DB: LDX $0052 ; high = vramPlayfieldRows[2 * rowY + 1]; <br> 97DD: LDA $9803,X <br> 97E0: CLC ; rowAddress = (high &lt;&lt; 8) | low; <br> 97E1: ADC $00A8 <br> 97E3: STA $2006 ; vramAddress = rowAddress + rightColumns[clearColumnIndex]; <br> 97E6: LDA #$FF <br> 97E8: STA $2007 ; vram[vramAddress] = 255; <br> <br> 97EB: INC $00AA <br> 97ED: LDA $00AA <br> 97EF: CMP #$04 <br> 97F1: BNE $9789 ; } <br> <br> 97F3: INC $0052 ; clearColumnIndex++; <br> 97F5: LDA $0052 ; if (clearColumnIndex &lt; 5) { <br> 97F7: CMP #$05 ; return; <br> 97F9: BMI $97FD ; } <br> <br> 97FB: INC $0048 ; playState = UPDATE_LINES_AND_STATISTICS; <br> <br> 97FD: RTS ; return;</code> <br> <br><font style="vertical-align: inherit;"></font><br><br> <code>97FE: 04 03 02 01 00 ; left columns <br> 9803: 05 06 07 08 09 ; right columns</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk membersihkan animasi, diperlukan 5 pass. Kemudian kode berlanjut ke status permainan berikutnya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penangan status gim </font></font><code>$05</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berisi kode yang dijelaskan di bagian "Baris dan Statistik". Pawang berakhir dengan kode ini: </font><font style="vertical-align: inherit;">Variabel </font><font style="vertical-align: inherit;">tidak direset hingga akhir kondisi permainan </font><font style="vertical-align: inherit;">, setelah itu digunakan untuk memperbarui jumlah total baris dan skor. Urutan ini memungkinkan bug menarik untuk dieksekusi. Dalam mode demo, Anda harus menunggu sampai permainan mengumpulkan baris penuh, dan kemudian dengan cepat tekan Mulai sampai animasi untuk menghapus seri telah berakhir. Gim akan kembali ke screen saver, tetapi jika Anda memilih waktu yang tepat, nilainya akan </font><font style="vertical-align: inherit;">disimpan. Sekarang Anda dapat memulai permainan dalam mode A-Type. Ketika dikunci di tempat angka pertama, pengendali status permainan</font></font><br><br> <code>9C9E: LDA #$00 <br> 9CA0: STA $0056 ; completedLines = 0; <br> <br> 9CA2: INC $0048 ; playState = B_TYPE_GOAL_CHECK; <br> <br> 9CA4: RTS ; return;</code> <br> <br><font style="vertical-align: inherit;"></font><code>completedLines</code><font style="vertical-align: inherit;"></font><code>$05</code><font style="vertical-align: inherit;"></font><code>completedLines</code><font style="vertical-align: inherit;"></font><code>$03</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mulai memindai baris yang sudah selesai. Dia tidak akan menemukan mereka, tetapi membiarkannya </font></font><code>completedLines</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak berubah. Akhirnya, ketika kondisi permainan terpenuhi, </font></font><code>$05</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jumlah total baris dan skor akan meningkat, seolah-olah Anda telah mencetaknya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cara termudah untuk melakukan ini adalah untuk mendapatkan jumlah terbesar, menunggu demo untuk mengumpulkan Tetris (akan ada 2 dari mereka dalam demo). Segera setelah Anda melihat layar berkedip, klik Mulai.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2a8/80a/091/2a880a09173c42fb8c5256f9921a635b.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setelah memulai gim baru, layar akan terus berkedip. Semua ini berkat kode berikut yang disebut oleh interrupt handler. </font><font style="vertical-align: inherit;">Bahkan, jika Anda membiarkan angka pertama secara otomatis turun ke lantai lapangan bermain, skor akan meningkat dengan nilai yang lebih besar, karena </font><font style="vertical-align: inherit;">( </font><font style="vertical-align: inherit;">) juga akan menyimpan nilainya dari demo. Ini berlaku bahkan untuk kasus-kasus ketika demo tidak mengisi satu baris pun. </font><font style="vertical-align: inherit;">Ini tidak diatur ulang sampai tombol "Turun" ditekan. </font><font style="vertical-align: inherit;">Selain itu, jika Anda mengklik Mulai selama animasi membersihkan baris kombinasi Tetris dalam mode demo, dan kemudian menunggu demo untuk memulai lagi, tidak hanya poin untuk Tetris akan dihitung dalam demo, tetapi seluruh waktu akan tercampur. Akibatnya, demo akan kalah. Setelah membatasi akhir permainan, Anda dapat kembali ke screen saver dengan mengklik Mulai.</font></font><br><br> <code>9673: LDA #$3F <br> 9675: STA $2006 <br> 9678: LDA #$0E <br> 967A: STA $2006 ; prepare to modify background tile color; <br> <br> 967D: LDX #$00 ; color = DARK_GRAY; <br> <br> 967F: LDA $0056 <br> 9681: CMP #$04 <br> 9683: BNE $9698 ; if (completedLines == 4) { <br> <br> 9685: LDA $00B1 <br> 9687: AND #$03 <br> 9689: BNE $9698 ; if (frameCounter divisible by 4) { <br> <br> 968B: LDX #$30 ; color = WHITE; <br> <br> 968D: LDA $00B1 <br> 968F: AND #$07 <br> 9691: BNE $9698 ; if (frameCounter divisible by 8) { <br> <br> 9693: LDA #$09 <br> 9695: STA $06F1 ; play clear sound effect; <br> <br> ; } <br> ; } <br> ; } <br> <br> 9698: STX $2007 ; update background tile color;</code> <br> <br><font style="vertical-align: inherit;"></font><code>holdDownPoints</code><font style="vertical-align: inherit;"></font><code>$004F</code><font style="vertical-align: inherit;"></font><code>holdDownPoints</code><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Status permainan </font></font><code>$06</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">melakukan pemeriksaan target untuk game Tipe-B. </font><font style="vertical-align: inherit;">Dalam mode A-Type, ini pada dasarnya adalah bingkai yang tidak digunakan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Status permainan </font></font><code>$07</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berisi secara eksklusif 2 Player vs. logika tidak lengkap. </font><font style="vertical-align: inherit;">Dalam mode pemain tunggal, ia berperilaku seperti bingkai yang tidak digunakan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Status permainan </font></font><code>$08</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dibahas di bagian “Menciptakan Tetrimino” dan “Memilih Tetrimino”. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Status permainan </font></font><code>$09</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak digunakan. </font></font><code>$0B</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">meningkatkan status permainan, tetapi juga terlihat tidak digunakan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dan akhirnya, siklus utama permainan:</font></font><br><br> <code>; while(true) { <br> <br> 8138: JSR $8161 ; branchOnGameMode(); <br> <br> 813B: CMP $00A7 ; if (vertical blanking interval wait requested) { <br> 813D: BNE $8142 ; waitForVerticalBlankingInterval(); <br> 813F: JSR $AA2F ; } <br> <br> 8142: LDA $00C0 <br> 8144: CMP #$05 <br> 8146: BNE $815A ; if (gameMode == DEMO) { <br> <br> 8148: LDA $00D2 <br> 814A: CMP #$DF <br> 814C: BNE $815A ; if (reached end of demo table) { <br> <br> 814E: LDA #$DD <br> 8150: STA $00D2 ; reset demo table index; <br> <br> 8152: LDA #$00 <br> 8154: STA $00B2 ; clear upper byte of frame counter; <br> <br> 8156: LDA #$01 <br> 8158: STA $00C0 ; gameMode = TITLE_SCREEN; <br> ; } <br> ; } <br> 815A: JMP $8138 ; }</code> </div> </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id420725/">https://habr.com/ru/post/id420725/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id420707/index.html">Startup JITX menggunakan AI untuk mengotomatisasi pengembangan papan sirkuit tercetak yang kompleks</a></li>
<li><a href="../id420709/index.html">T2F: proyek untuk mengubah teks menjadi gambar wajah dengan pembelajaran yang mendalam</a></li>
<li><a href="../id420711/index.html">Jurusan Ilmu Data Moskow: pengumuman dan pendaftaran</a></li>
<li><a href="../id420713/index.html">Bagaimana Chuck Hull menciptakan pencetakan 3D</a></li>
<li><a href="../id420715/index.html">Kebenaran sulit tentang beratnya belajar</a></li>
<li><a href="../id420729/index.html">Buka webinar "Naive Bayes Classifier"</a></li>
<li><a href="../id420731/index.html">Zabbix tentang steroid: cara kerja platform pemantauan terpadu Sbertech</a></li>
<li><a href="../id420735/index.html">Kami mengundang Anda ke final marathon Find Yourself in Digital di kantor Mail.Ru Group</a></li>
<li><a href="../id420737/index.html">Mini ai cup 2 atau hampir AgarIO - apa yang bisa dilakukan untuk menang</a></li>
<li><a href="../id420739/index.html">Kotaknya masih ada di pegangan: mengapa pada tahun 2018 Anda masih perlu belajar bahasa sendiri</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>