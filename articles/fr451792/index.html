<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêé üçâ üñïüèø Quatre renifleurs javascript qui vous pi√®gent dans les boutiques en ligne üóÑÔ∏è üßëüèæ üàÅ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Presque chacun d'entre nous utilise les services des boutiques en ligne, ce qui signifie qu'il risque t√¥t ou tard d'√™tre victime de renifleurs JavaScr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Quatre renifleurs javascript qui vous pi√®gent dans les boutiques en ligne</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/451792/"><img src="https://habrastorage.org/webt/m2/18/ri/m218ribvsirj8bn0787eizy9oei.jpeg"><br><br>  Presque chacun d'entre nous utilise les services des boutiques en ligne, ce qui signifie qu'il risque t√¥t ou tard d'√™tre victime de renifleurs JavaScript - un code sp√©cial que les cybercriminels injectent sur le site pour voler des informations de carte bancaire, des adresses, des identifiants et des mots de passe d'utilisateurs. <br><br>  Pr√®s de 400 000 utilisateurs du site Internet et de l'application mobile de la compagnie a√©rienne British Airways, ainsi que les visiteurs du site Internet britannique du g√©ant du sport FILA et du distributeur de billets am√©ricain Ticketmaster, ont d√©j√† souffert de renifleurs. <br><br>  Viktor Okorokov, analyste du Threat Intelligence Group-IB, explique comment les renifleurs sont int√©gr√©s dans le code du site et volent les informations de facturation, ainsi que les CRM qu'ils attaquent. <a name="habracut"></a><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l_/b0/sa/l_b0sa5cjkma2zr779uhbfi5h8m.jpeg"></div><br><br><h2>  La menace fant√¥me </h2><br>  Il s'est av√©r√© que pendant longtemps les renifleurs JS sont rest√©s hors de la vue des analystes antivirus, et les banques et les syst√®mes de paiement n'y ont pas vu de menace s√©rieuse.  Et compl√®tement en vain.  Les experts du Groupe IB ont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">analys√©</a> 2 440 magasins en ligne infect√©s dont les visiteurs - environ 1,5 million de personnes par jour - √©taient menac√©s de compromis.  Parmi les victimes figurent non seulement des utilisateurs, mais √©galement des boutiques en ligne, des syst√®mes de paiement et des banques qui ont √©mis des cartes compromises. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le rapport</a> Group-IB <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">a</a> √©t√© la premi√®re √©tude sur le march√© du darknet pour les renifleurs, leur infrastructure et les moyens de mon√©tiser, rapportant √† leurs cr√©ateurs des millions de dollars.  Nous avons identifi√© 38 familles de renifleurs, dont seulement 12 √©taient auparavant connus des chercheurs. <br><br>  Arr√™tons-nous en d√©tail sur les quatre familles de renifleurs √©tudi√©es au cours de l'√©tude. <br><br><h2>  Famille ReactGet </h2><br>  Les renifleurs de la famille ReactGet sont utilis√©s pour voler les donn√©es des cartes bancaires sur les sites des boutiques en ligne.  Un renifleur peut fonctionner avec un grand nombre de syst√®mes de paiement diff√©rents utilis√©s sur le site: une valeur de param√®tre correspond √† un syst√®me de paiement, et des versions individuelles de renifleur d√©tect√©es peuvent √™tre utilis√©es pour voler des informations d'identification, ainsi que pour voler des donn√©es de carte bancaire √† partir de formes de paiement de plusieurs syst√®mes de paiement √† la fois, telles que le soi-disant renifleur universel.  Il a √©t√© constat√© que, dans certains cas, des attaquants m√®nent des attaques de phishing contre les administrateurs de boutique en ligne afin d'acc√©der au panneau d'administration du site. <br><br>  La campagne utilisant cette famille de renifleurs a d√©but√© en mai 2017, des sites sous le contr√¥le de CMS et les plateformes Magento, Bigcommerce, Shopify ont √©t√© attaqu√©s. <br><br><h3>  Comment ReactGet est int√©gr√© dans le code de la boutique en ligne </h3><br>  En plus de l'impl√©mentation ¬´classique¬ª d'un script par r√©f√©rence, la famille de renifleurs ReactGet utilise une technique sp√©ciale: en utilisant du code JavaScript, elle v√©rifie si l'adresse actuelle o√π se trouve l'utilisateur r√©pond √† certains crit√®res.  Un code malveillant ne sera lanc√© que si l'URL actuelle contient la sous-cha√Æne <b>checkout</b> ou <b>onestepcheckout</b> , <b>onepage /</b> , <b>out / onepag</b> , <b>checkout / one</b> , <b>ckout / one</b> .  Ainsi, le code sniffer sera ex√©cut√© exactement au moment o√π l'utilisateur proc√®de au paiement des achats et saisit les informations de paiement dans le formulaire du site. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kz/fz/lr/kzfzlrityshdouqlvh5ns14vlhm.png"></div><br>  Ce renifleur utilise une technique non standard.  Le paiement et les donn√©es personnelles de la victime sont collect√©s ensemble, encod√©s en <b>base64</b> , puis la cha√Æne r√©sultante est utilis√©e comme param√®tre pour envoyer une demande au site des attaquants.  Le plus souvent, le chemin d'acc√®s √† la porte simule un fichier JavaScript, par exemple <b>resp.js</b> , <b>data.js</b> et ainsi de suite, mais √©galement des liens vers des fichiers image, <b>GIF</b> et <b>JPG sont</b> √©galement utilis√©s.  La particularit√© est que le renifleur cr√©e un objet image avec une taille de 1 par 1 pixel et utilise le lien obtenu pr√©c√©demment comme param√®tre <b>src</b> de l'image.  Autrement dit, pour l'utilisateur, une telle demande de trafic ressemblera √† une demande d'image r√©guli√®re.  Une technique similaire a √©t√© utilis√©e dans les renifleurs de la famille ImageID.  De plus, la technique d'utilisation d'une image 1 par 1 pixel est utilis√©e dans de nombreux scripts d'analyse en ligne l√©gitimes, ce qui peut √©galement induire l'utilisateur en erreur. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jo/bf/xm/jobfxmbqsrjqolrvo84fkstgrhi.png"></div><br><h3>  Analyse de version </h3><br>  Une analyse des domaines actifs utilis√©s par les op√©rateurs de renifleurs ReactGet a r√©v√©l√© de nombreuses versions diff√©rentes de la famille de renifleurs.  Les versions se distinguent par la pr√©sence ou l'absence d'obscurcissement, et en outre, chaque renifleur est con√ßu pour un syst√®me de paiement sp√©cifique qui traite les paiements par carte bancaire pour les magasins en ligne.  Apr√®s avoir tri√© la valeur du param√®tre correspondant au num√©ro de version, les sp√©cialistes du Groupe IB ont obtenu une liste compl√®te des variantes de renifleur disponibles, et par les noms des champs de formulaire que chaque renifleur recherche dans le code de page, ils ont d√©termin√© les syst√®mes de paiement auxquels le renifleur est destin√©. <br><br><div class="spoiler">  <b class="spoiler_title">Liste des renifleurs et de leurs syst√®mes de paiement correspondants</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  URL de renifleur <br></th><th width="200">  Syst√®me de paiement <br></th></tr><tr><td align="center">  <a href="">reactjsapi.com/react.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.1</a> </td><td align="center">  Cartes <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.4</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.5</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.6</a> </td><td align="center">  Adyen </td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.7</a> </td><td align="center">  USAePay </td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.9</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.1</a> </td><td align="center">  USAePay </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.3</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.5</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.6</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.7</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.8</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.9</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.3.0</a> </td><td align="center">  Stripe <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.2</a> </td><td align="center">  Realex </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.3</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.4</a> </td><td align="center">  Linkpoint </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.5</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.7</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.8</a> </td><td align="center">  Datacash <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.9</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">asianfoodgracer.com/footer.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.5</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.7</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.8</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=2.0</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/react.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=1.3</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.4</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.6</a> <br></td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.7</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.8</a> </td><td align="center">  Chase Paymentech <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.9</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.91</a> </td><td align="center">  Adyen <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.92</a> </td><td align="center">  Psigate <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.93</a> </td><td align="center">  Cyber ‚Äã‚Äãsource </td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.95</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.97</a> </td><td align="center">  Realex </td></tr><tr><td align="center">  <a href="">geisseie.com/gs.js</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/age.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.3</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.5</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.6</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.7</a> </td><td align="center">  Realex <br></td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.0</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.1</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.2</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.4</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livecheckpay.com/react.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.2</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.3</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.5</a> </td><td align="center">  Cyber ‚Äã‚Äãsource <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.8</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.9</a> </td><td align="center">  Realex </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.0</a> </td><td align="center">  Cyber ‚Äã‚Äãsource </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.1</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.3</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.4</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.5</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.7</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.8</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.9</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.2</a> </td><td align="center">  Premi√®re passerelle mondiale de donn√©es <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.5</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.8</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.4.0</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">maxstatics.com/site.js</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">mediapack.info/track.js?d=funlove.com</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">mediapack.info/track.js?d=qbedding.com</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mediapack.info/track.js?d=vseyewear.com</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.4</a> </td><td align="center">  Stripe </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.7</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.8</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.1</a> </td><td align="center">  Braintree </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.10</a> </td><td align="center">  Braintree <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.3</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.31</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.32</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.33</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.34</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.35</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.4</a> </td><td align="center">  Stripe </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.7</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.8</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.1</a> </td><td align="center">  Braintree </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.2</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.3</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.31</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.32</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.33</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.34</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.35</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">mxcounter.com/cnt.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/j.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=1.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=1.8</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=4.5</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=4.6</a> </td><td align="center">  Payway Westpac <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.0</a> </td><td align="center">  Payfort <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.1</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.3</a> </td><td align="center">  Stripe <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.4</a> </td><td align="center">  Premi√®re passerelle mondiale de donn√©es <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.5</a> </td><td align="center">  Psigate </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.8</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.9</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.1</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.2</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.3</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.5</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.6</a> </td><td align="center">  Linkpoint <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.7</a> </td><td align="center">  Payway Westpac <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.8</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.2</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.3</a> </td><td align="center">  Adyen </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.4</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.5</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.6</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.7</a> </td><td align="center">  EBizCharge <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.8</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.9</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.1.2</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.11</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.12</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.13</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.14</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.15</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.16</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.17</a> </td><td align="center">  Payway Westpac <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.18</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.19</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.21</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.22</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.23</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.24</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.25</a> </td><td align="center">  Payfort <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.29</a> </td><td align="center">  Cyber ‚Äã‚Äãsource <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.4</a> </td><td align="center">  PayPal Payflow Pro <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.8</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.9</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.3</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.5</a> </td><td align="center">  Stripe <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.8</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.9</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.2</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=0.1.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=0.1.1</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.2</a> </td><td align="center">  Silex </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.4</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.5</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.51</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.8</a> </td><td align="center">  Stripe </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.9</a> </td><td align="center">  Gros z√®bre <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.0</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.2</a> </td><td align="center">  Premi√®re passerelle mondiale de donn√©es <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.4</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.5</a> </td><td align="center">  Adyen <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.7</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.8</a> </td><td align="center">  Services aux marchands QuickBooks <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.9</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.91</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.92</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.94</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.3.97</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.5</a> </td><td align="center">  Sage pay </td></tr><tr><td align="center">  <a href="">reactjsapi.com/react.js</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">sydneysalonsupplies.com/gtm.js</a> </td><td align="center">  eWAY Rapid </td></tr><tr><td align="center">  <a href="">tagsmediaget.com/react.js</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.2</a> </td><td align="center">  ANZ eGate </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.3</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.5</a> </td><td align="center">  Cyber ‚Äã‚Äãsource </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.7</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.8</a> </td><td align="center">  Sage pay </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.9</a> </td><td align="center">  Realex <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.0</a> </td><td align="center">  Cyber ‚Äã‚Äãsource </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.1</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.3</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.4</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.5</a> </td><td align="center">  eWAY Rapid </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.7</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.8</a> </td><td align="center">  Sage pay <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.9</a> <br></td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.0</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.2</a> </td><td align="center">  Premi√®re passerelle mondiale de donn√©es <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.5</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.8</a> </td><td align="center">  Paypal <br></td></tr></tbody></table></div><br></div></div><br><h3>  Renifleur de mot de passe <br></h3><br>  L'un des avantages des renifleurs JavaScript travaillant du c√¥t√© client du site est sa polyvalence: un code malveillant int√©gr√© sur le site peut voler n'importe quel type de donn√©es, qu'il s'agisse de donn√©es de paiement ou du nom d'utilisateur et du mot de passe d'un compte utilisateur.  Les sp√©cialistes du groupe IB ont d√©couvert un √©chantillon d'un renifleur appartenant √† la famille ReactGet, con√ßu pour voler les adresses e-mail et les mots de passe des utilisateurs du site. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7x/9c/x1/7x9cx1en90ze5etozgc6jmg5eh8.png"></div><br><h3>  Intersection avec ImageID Sniffer <br></h3><br>  Une analyse de l'un des magasins infect√©s a r√©v√©l√© que son site avait √©t√© infect√© deux fois: en plus du code malveillant de la famille de sniffers ReactGet, un code de sniffer de la famille ImageID a √©t√© d√©tect√©.  Cette intersection peut indiquer que les op√©rateurs derri√®re l'utilisation des deux renifleurs utilisent des techniques similaires pour injecter du code malveillant. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8s/m0/ed/8sm0edvplxoguwsczm9ja3-g_ng.png"></div><br><h3>  Renifleur universel <br></h3><br>  Une analyse de l'un des noms de domaine li√©s √† l'infrastructure de renifleur ReactGet a r√©v√©l√© que le m√™me utilisateur avait enregistr√© trois autres noms de domaine.  Ces trois domaines simulaient des domaines de sites r√©els et √©taient auparavant utilis√©s pour h√©berger des renifleurs.  Lors de l'analyse du code de trois sites l√©gitimes, un renifleur inconnu a √©t√© d√©couvert et une analyse plus approfondie a montr√© qu'il s'agit d'une version am√©lior√©e du renifleur ReactGet.  Toutes les versions de sniffers de cette famille pr√©c√©demment suivies visaient un syst√®me de paiement unique, c'est-√†-dire que pour chaque syst√®me de paiement, une version sp√©ciale du sniffer √©tait requise.  Cependant, dans ce cas, une version universelle du renifleur a √©t√© d√©couverte, capable de voler des informations √† partir de formulaires li√©s √† 15 syst√®mes de paiement et modules de sites de commerce √©lectronique diff√©rents pour les paiements en ligne. <br><br>  Ainsi, au d√©but du travail, le renifleur a recherch√© les champs de base du formulaire contenant les informations personnelles de la victime: nom complet, adresse physique, num√©ro de t√©l√©phone. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g_/py/vs/g_pyvsjovjp7p6x2vlqzaqho5ey.png"></div><br>  Ensuite, le renifleur a recherch√© plus de 15 pr√©fixes diff√©rents correspondant √† diff√©rents syst√®mes et modules de paiement pour les paiements en ligne. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dd/ty/as/ddtyasulurz4un7owfvlv-3xepu.png"></div><br>  De plus, les donn√©es personnelles et les informations de paiement de la victime ont √©t√© collect√©es et envoy√©es au site contr√¥l√© par l'attaquant: dans ce cas particulier, deux versions du renifleur universel ReactGet situ√©es sur deux sites pirat√©s diff√©rents ont √©t√© d√©couvertes.  Cependant, les deux versions ont envoy√© les donn√©es vol√©es au m√™me site pirat√© <b>zoobashop.com</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ee/mt/tb/eemttbv-vdn0ff9ncd3siqfzokq.png"></div><br>  Une analyse des pr√©fixes utilis√©s par le sniffer pour rechercher les champs contenant les informations de paiement de la victime nous a permis de d√©terminer que ce mod√®le de sniffer visait les syst√®mes de paiement suivants: <br><br><ul><li>  <b>Authorize.Net</b> </li><li>  <b>Verisign</b> </li><li>  <b>Premi√®res donn√©es</b> </li><li>  <b>USAePay</b> </li><li>  <b>Stripe</b> </li><li>  <b>Paypal</b> </li><li>  <b>ANZ eGate</b> </li><li>  <b>Braintree</b> </li><li>  <b>DataCash (MasterCard)</b> </li><li>  <b>Paiements Realex</b> </li><li>  <b>Psigate</b> </li><li>  <b>Syst√®mes de paiement Heartland</b> </li></ul><br><h3>  Quels outils sont utilis√©s pour voler les informations de facturation? <br></h3><br>  Le premier outil d√©couvert lors de l'analyse de l'infrastructure de l'attaquant est utilis√© pour masquer des scripts malveillants responsables du vol de cartes bancaires.  Un script bash a √©t√© d√©couvert sur l'un des h√¥tes attaquants √† l'aide de la CLI <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">javascript-obfuscator</a></b> pour automatiser l'obscurcissement du code de renifleur. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5m/aw/lu/5mawlut23obt6lpoa3ed2luu8ss.png"></div><br>  Le deuxi√®me outil d√©tect√© est con√ßu pour g√©n√©rer du code qui est responsable du chargement du renifleur principal.  Cet outil g√©n√®re du code JavaScript qui v√©rifie si l'utilisateur se trouve sur la page de paiement en recherchant l'adresse actuelle de l'utilisateur pour le <b>paiement des</b> lignes, le <b>panier,</b> etc. Si le r√©sultat est positif, le code charge le renifleur principal depuis le serveur des attaquants.  Pour masquer les activit√©s malveillantes, toutes les lignes, y compris les lignes de test pour d√©terminer la page de paiement, ainsi qu'un lien vers le renifleur, sont cod√©es √† l'aide de <b>base64</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vn/ew/ym/vnewymbt1r6nc8n98roze5drnnk.png"></div><br><h3>  Attaques de phishing <br></h3><br>  Lors de l'analyse de l'infrastructure r√©seau des attaquants, il a √©t√© constat√© que souvent un groupe criminel utilise le phishing pour acc√©der au panneau d'administration de la boutique en ligne cible.  Les attaquants enregistrent un domaine qui ressemble visuellement au domaine d'un magasin, puis y d√©ploient un faux formulaire de connexion au panneau d'administration Magento.  En cas de succ√®s, les attaquants auront acc√®s au panneau d'administration de CMS Magento, qui leur permet de modifier les composants du site et d'impl√©menter un renifleur pour voler les informations de carte de cr√©dit. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yf/-a/lz/yf-alzxabbg_kij0vkaq5qcr9vs.png"></div><br><div class="spoiler">  <b class="spoiler_title">L'infrastructure</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  Domaine <br></th><th width="200">  Date de d√©couverte / apparition <br></th></tr><tr><td align="center">  mediapack.info </td><td align="center">  05/04/2017 <br></td></tr><tr><td align="center">  adsgetapi.com </td><td align="center">  15/06/2017 <br></td></tr><tr><td align="center">  simcounter.com </td><td align="center">  14/08/2017 </td></tr><tr><td align="center">  mageanalytics.com </td><td align="center">  22/12/2017 </td></tr><tr><td align="center">  maxstatics.com </td><td align="center">  16/01/2018 <br></td></tr><tr><td align="center">  reactjsapi.com </td><td align="center">  19/01/2018 </td></tr><tr><td align="center">  mxcounter.com </td><td align="center">  02/02/2018 </td></tr><tr><td align="center">  apitstatus.com </td><td align="center">  03/01/2018 <br></td></tr><tr><td align="center">  orderracker.com </td><td align="center">  20/04/2018 <br></td></tr><tr><td align="center">  tagstracking.com </td><td align="center">  25/06/2018 <br></td></tr><tr><td align="center">  adsapigate.com </td><td align="center">  07/12/2018 <br></td></tr><tr><td align="center">  trust-tracker.com </td><td align="center">  15/07/2018 <br></td></tr><tr><td align="center">  fbstatspartner.com </td><td align="center">  10/02/2018 <br></td></tr><tr><td align="center">  billgetstatus.com </td><td align="center">  10/12/2018 </td></tr><tr><td align="center">  aldenmlilhouse.com </td><td align="center">  20/10/2018 <br></td></tr><tr><td align="center">  balletbeautlful.com </td><td align="center">  20/10/2018 <br></td></tr><tr><td align="center">  bargalnjunkie.com </td><td align="center">  20/10/2018 <br></td></tr><tr><td align="center">  payselector.com </td><td align="center">  10.21.2018 <br></td></tr><tr><td align="center">  tagsmediaget.com </td><td align="center">  11/02/2018 <br></td></tr><tr><td align="center">  hs-payments.com </td><td align="center">  16/11/2018 <br></td></tr><tr><td align="center">  ordercheckpays.com </td><td align="center">  19/11/2018 <br></td></tr><tr><td align="center">  geisseie.com </td><td align="center">  24/11/2018 <br></td></tr><tr><td align="center">  gtmproc.com </td><td align="center">  29/11/2018 <br></td></tr><tr><td align="center">  livegetpay.com </td><td align="center">  18/12/2018 <br></td></tr><tr><td align="center">  sydneysalonsupplies.com </td><td align="center">  18/12/2018 <br></td></tr><tr><td align="center">  newrelicnet.com <br></td><td align="center">  19/12/2018 <br></td></tr><tr><td align="center">  nr-public.com </td><td align="center">  01/03/2019 </td></tr><tr><td align="center">  cloudodesc.com </td><td align="center">  01/04/2019 <br></td></tr><tr><td align="center">  ajaxstatic.com </td><td align="center">  01/11/2019 <br></td></tr><tr><td align="center">  livecheckpay.com </td><td align="center">  21/01/2019 <br></td></tr><tr><td align="center">  asianfoodgracer.com </td><td align="center">  25/01/2019 <br></td></tr></tbody></table></div><br></div></div><br><h2>  Famille G-analytics <br></h2><br>  Cette famille de renifleurs est utilis√©e pour voler des cartes aux clients des magasins en ligne.  Le tout premier nom de domaine utilis√© par le groupe a √©t√© enregistr√© en avril 2016, ce qui pourrait indiquer le d√©but de l'activit√© du groupe mi-2016. <br><br>  Dans la campagne actuelle, le groupe utilise des noms de domaine qui imitent des services r√©els tels que Google Analytics et jQuery, masquant l'activit√© de renifleur avec des scripts l√©gitimes et similaires aux noms de domaine l√©gitimes.  L'attaque a √©t√© ex√©cut√©e sur des sites ex√©cutant CMS Magento. <br><br><h3>  Comment G-Analytics est int√©gr√© dans le code de la boutique en ligne <br></h3><br>  Une caract√©ristique distinctive de cette famille est l'utilisation de diverses m√©thodes de vol des informations de paiement de l'utilisateur.  En plus de l'impl√©mentation classique du code JavaScript dans la partie client du site, le groupe criminel a √©galement utilis√© la technique d'incorporation de code dans la partie serveur du site, √† savoir des scripts PHP qui traitent les donn√©es saisies par l'utilisateur.  Cette technique est dangereuse dans la mesure o√π il est difficile pour des chercheurs tiers de d√©tecter un code malveillant.  Les sp√©cialistes de Group-IB ont d√©couvert une version d'un renifleur int√©gr√© au code PHP du site, utilisant le domaine <b>dittm.org</b> comme porte d'entr√©e. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ud/m_/dk/udm_dkzu4pw_4pbxhrstk0e9oo8.png"></div><br>  Une version ant√©rieure du renifleur a √©galement √©t√© d√©couverte, qui utilise le m√™me domaine <b>dittm.org</b> pour collecter les donn√©es vol√©es, mais cette version est d√©j√† destin√©e √† √™tre install√©e du c√¥t√© client de la boutique en ligne. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kr/0m/nh/kr0mnhgtjfxqs5lftvx53ofrm54.png"></div><br>  Plus tard, le groupe a chang√© de tactique et a commenc√© √† accorder plus d'attention √† la dissimulation d'activit√©s malveillantes et √† un d√©guisement. <br><br>  D√©but 2017, le groupe a commenc√© √† utiliser le domaine <b>jquery-js.com</b> , d√©guis√© en CDN pour jQuery: lorsqu'il redirige vers un site d'utilisateurs malveillants, il redirige vers le site l√©gitime <b>jquery.com</b> . <br><br>  Et √† la mi-2018, le groupe a adopt√© le nom de domaine <b>g-analytics.com</b> et a commenc√© √† masquer les activit√©s du renifleur sous le service l√©gitime de Google Analytics. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rd/fj/mj/rdfjmj8foi7qtcv_fi_lix69a4u.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/y3/xp/24/y3xp24ypsp9vloflbz5lbnrrfnk.png"></div><br><h3>  Analyse de version <br></h3><br>  Lors de l'analyse des domaines utilis√©s pour stocker le code de renifleur, il a √©t√© constat√© que le site dispose d'un grand nombre de versions qui diff√®rent par la pr√©sence d'obscurcissement, ainsi que par la pr√©sence ou l'absence de code inaccessible ajout√© au fichier pour distraire l'attention et masquer le code malveillant. <br><br>  Au total, six versions de renifleurs ont √©t√© identifi√©es sur <b>jquery-js.com</b> .  Ces renifleurs envoient les donn√©es vol√©es √† l'adresse situ√©e sur le m√™me site que le renifleur lui-m√™me: <b>hxxps: // jquery-js [.] Com / latest / jquery.min.js</b> : <br><br><ul><li>  <b>hxxps: // jquery-js [.] com / jquery.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.2.2.4.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.8.3.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.6.4.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.4.4.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.12.4.min.js</b> </li></ul><br>  Le <b>dernier</b> domaine <b>g-analytics.com</b> , utilis√© par le groupe lors d'attaques depuis la mi-2018, sert de r√©f√©rentiel √† un plus grand nombre de renifleurs.  Au total, 16 versions diff√©rentes de renifleurs ont √©t√© d√©couvertes.  Dans ce cas, la porte d'envoi des donn√©es vol√©es a √©t√© d√©guis√©e en lien vers une image <b>GIF</b> : <b>hxxp: // g-analytics [.] Com / __ utm.gif? V = 1 &amp; _v = j68 &amp; a = 98811130 &amp; t = pageview &amp; _s = 1 &amp; sd = 24 bits &amp; sr = 2560x1440 &amp; vp = 2145x371 &amp; je = 0 &amp; _u = AACAAEAB ~ &amp; jid = 1841704724 &amp; gjid = 877686936 &amp; cid</b> <b><br></b>  <b>= 1283183910.1527732071</b> : <br><br><ul><li>  <b>hxxps: // g-analytics [.] com / libs / 1.0.1 / analytics.js</b> </li><li>  <b>hxxps: // g-analytics [.] com / libs / 1.0.10 / analytics.js</b> </li><li>  <b>hxxps: // g-analytics [.] com / libs / 1.0.11 / analytics.js</b> </li><li>  <b>hxxps: // g-analytics [.] com / libs / 1.0.12 / analytics.js</b> </li><li>  <b>hxxps: // g-analytics [.] com / libs / 1.0.13 / analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.14/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.15/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.16/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.3/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.4/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.5/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.6/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.7/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.8/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.9/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/analytics.js</b> </li></ul><br><h3>    <br></h3><br>     ,       ,   .  ,  ,  ,  <b>google-analytics.cm</b>     ,    <b>cardz.vc</b> .  <b>cardz.vc</b>         Cardsurfs (Flysurfs),           AlphaBay      ,    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/k6/l6/-w/k6l6-wxdifwkyfd-kq-3xicgsdq.png"></div><br>   <b>analytic.is</b> ,     ,   ,      ,  Group-IB  ,   Cookie-, , ,    .        <b>iozoz.com</b> ,        ,   2016 . ,            .      email- <b>kts241@gmail.com</b> ,        <b>cardz.su</b>  <b>cardz.vc</b> ,     Cardsurfs. <br><br>    ,   ,    G-Analytics        Cardsurfs      ,       ,    . <br><br><div class="spoiler">  <b class="spoiler_title">L'infrastructure</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  <br></th><th width="200">  / <br></th></tr><tr><td align="center"> iozoz.com </td><td align="center"> 08.04.2016 </td></tr><tr><td align="center"> dittm.org </td><td align="center"> 10.09.2016 <br></td></tr><tr><td align="center"> jquery-js.com </td><td align="center"> 02.01.2017 </td></tr><tr><td align="center"> g-analytics.com </td><td align="center"> 31.05.2018 <br></td></tr><tr><td align="center"> google-analytics.is </td><td align="center"> 21.11.2018 <br></td></tr><tr><td align="center"> analytic.to </td><td align="center"> 04.12.2018 </td></tr><tr><td align="center"> google-analytics.to </td><td align="center"> 06.12.2018 <br></td></tr><tr><td align="center"> google-analytics.cm </td><td align="center">  28/12/2018 <br></td></tr><tr><td align="center"> analytic.is </td><td align="center">  28/12/2018 <br></td></tr><tr><td align="center"> googlc-analytics.cm </td><td align="center"> 17.01.2019 <br></td></tr></tbody></table></div><br></div></div><br><h2>  Illum </h2><br> Illum ‚Äî  ,     -,    CMS Magento.    ,          ,       . <br><br>    ,     ,      , ,   ,        .        ,  ,  ,       2016 . <br><br><h3>  Illum    - </h3><br>          .      <b>cdn.illum[.]pw/records.php</b> ,       <b>base64</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/m0/ek/gs/m0ekgsjvued_xicxubpz6dprhag.png"></div><br>      ,    ‚Äî <b>records.nstatistics[.]com/records.php</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yy/zq/3d/yyzq3dtgunc6ansnwrk2eun4mjy.png"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> Willem de Groot,      ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> ,     CSU. <br><br><h3>    <br></h3><br>  Group-IB    ,           . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dm/ze/i3/dmzei3jrukearwtcs-9ch_b2nue.png"></div><br>  ,    ,           Linux:  , Linux Privilege Escalation Check Script,    (Mike Czumak),     CVE-2009-1185. <br><br>     -    : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>      <b>core_config_data</b>    CVE-2016-4010, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>    RCE    CMS Magento,       -. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/j7/st/5r/j7st5ryg0ixjehutzjvneckqaw8.jpeg"></div><br>              ,         .      ,        ,       CMS      .  ,  <b>segapay_standart.js</b>  <b>segapay_onpage.js</b>     ,    Sage Pay. <br><br><div class="spoiler"> <b class="spoiler_title">     </b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  </th><th width="200">   </th></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs_special/visiondirect.co.uk.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs_special/topdierenshop.nl.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs_special/tiendalenovo.es.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs_special/pro-bolt.com.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs_special/plae.co.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs_special/ottolenghi.co.uk.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs_special/oldtimecandy.com.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs_special/mylook.ee.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs_special/luluandsky.com.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs_special/julep.com.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs_special/gymcompany.es.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs_special/grotekadoshop.nl.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs_special/fushi.co.uk.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs_special/fareastflora.com.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs_special/compuindia.com.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs/segapay_standart.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs/segapay_onpage.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs/replace_standart.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs/all_inputs.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/mjs/add_inputs_standart.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/magento/payment_standart.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/magento/payment_redirect.js </td><td align="center"> //payrightnow[.]cf/?payment= <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/magento/payment_redcrypt.js </td><td align="center"> //payrightnow[.]cf/?payment= <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sr.illum</a> [.]pw/magento/payment_forminsite.js </td><td align="center"> //paymentnow[.]tk/?payment= <br></td></tr></tbody></table></div><br></div></div><br>  <b>paymentnow[.]tk</b> ,      <b>payment_forminsite.js</b> ,    <b>subjectAltName</b>   ,    CloudFlare.  ,     <b>evil.js</b> .    ,        CVE-2016-4010,        footer    CMS Magento.        <b>request.requestnet[.]tk</b> ,    ,    <b>paymentnow[.]tk</b> . <br><br><h3>    <br></h3><br>          .        -    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vd/vz/9b/vdvz9bvo34cv-5sp86ost9kadvg.png"></div><br>    ‚Äî     PayPal,           . <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6o/rk/92/6ork92ddgqisrzpksczgd-gcwyu.png"></div><br><div class="spoiler">  <b class="spoiler_title">L'infrastructure</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  <br></th><th width="200">  / </th></tr><tr><td align="center"> cdn.illum.pw </td><td align="center"> 27/11/2016 <br></td></tr><tr><td align="center"> records.nstatistics.com </td><td align="center"> 06/09/2018 <br></td></tr><tr><td align="center"> request.payrightnow.cf </td><td align="center"> 25/05/2018 <br></td></tr><tr><td align="center"> paymentnow.tk </td><td align="center"> 16/07/2017 <br></td></tr><tr><td align="center"> payment-line.tk </td><td align="center"> 01/03/2018 <br></td></tr><tr><td align="center"> paymentpal.cf </td><td align="center"> 04/09/2017 <br></td></tr><tr><td align="center"> requestnet.tk </td><td align="center"> 28/06/2017 <br></td></tr></tbody></table></div><br></div></div><br><h2>  CoffeMokko </h2><br>   CoffeMokko,       -,      2017 . ,        Group 1,   RiskIQ  2016 .       CMS,  Magento, OpenCart, WordPress, osCommerce, Shopify. <br><br><h3>  CoffeMokko    - </h3><br>         :      <b>src</b>  <b>js</b>   .          . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wn/pz/s8/wnpzs8nq8gwew8hgxkmhocu8nv0.png"></div><br>        ,     .   ,      ,        . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fh/pj/am/fhpjamaj2zikswysse44wophdxq.png"></div><br>          ,      :           ,    ,      . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ia/wz/qw/iawzqwyetk6kadgy3hjgcbhalgi.png"></div><br>           <b>/savePayment/index.php  /tr/index.php</b> . ,           ,     .            <b>base64</b> ,      : <br><br><ul><li>  ¬´e¬ª   ¬´:¬ª </li><li>  ¬´w¬ª   ¬´+¬ª </li><li>  ¬´o¬ª   ¬´%¬ª </li><li>  ¬´d¬ª   ¬´#¬ª </li><li>  ¬´a¬ª   ¬´-¬ª </li><li>  ¬´7¬ª   ¬´^¬ª </li><li>  ¬´h¬ª   ¬´_¬ª </li><li>  ¬´T¬ª   ¬´@¬ª </li><li>  ¬´0¬ª   ¬´/¬ª </li><li>  ¬´Y¬ª   ¬´*¬ª </li></ul><br>        <b>base64</b>   ,    . <br><br>     ,   : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/iv/rw/jv/ivrwjvwtjyflx73jxnzyedtgqxw.png"></div><br><h3>   <br></h3><br>       ,      -.           TLD.       ,       . <br><br>      ,      jQuery ( <b>slickjs[.]org</b>  ,   <b>slick.js</b> ),   ( <b>sagecdn[.]org</b>  ,    Sage Pay). <br><br>     ,          ,    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nc/8p/mc/nc8pmckp6ig-wh6zqiflqsvvuv8.png"></div><br>    ,     <b>/js</b>  <b>/src</b> .      :       .        ,                . <br><br><h3>   <br></h3><br><h4>    <br></h4><br>  Dans certains √©chantillons de renifleurs d√©tect√©s de cette famille, le code √©tait obscurci et contenait les donn√©es chiffr√©es n√©cessaires au fonctionnement du renifleur: en particulier, l'adresse du portail de renifleur, une liste de champs de formulaire de paiement et, dans certains cas, un faux code de formulaire de paiement.  Dans le code √† l'int√©rieur de la fonction, les ressources ont √©t√© chiffr√©es √† l'aide de <b>XOR</b> √† l'aide de la cl√©, qui a √©t√© pass√©e par l'argument de la m√™me fonction. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uu/io/h2/uuioh2egdec0k1wpsa4wxti_1qc.png"></div><br>  Apr√®s avoir d√©chiffr√© la cha√Æne avec la cl√© correspondante, unique pour chaque √©chantillon, vous pouvez obtenir une cha√Æne contenant toutes les lignes du code renifleur via le caract√®re d√©limiteur. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yi/ma/ch/yimachmb5zfakdeqn-u4v-dwesc.png"></div><br><h4>  Deuxi√®me algorithme d'obscurcissement <br></h4><br>  Dans des √©chantillons de renifleurs ult√©rieurs de cette famille, un m√©canisme d'obscurcissement diff√©rent a √©t√© utilis√©: dans ce cas, les donn√©es ont √©t√© chiffr√©es √† l'aide d'un algorithme auto-√©crit.  Une cha√Æne contenant les donn√©es chiffr√©es n√©cessaires au fonctionnement du renifleur a √©t√© transmise comme argument √† la fonction de d√©chiffrement. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/co/hs/bi/cohsbisd1wm4g_46sclbiq-wngc.png"></div><br>  √Ä l'aide de la console du navigateur, vous pouvez d√©chiffrer les donn√©es chiffr√©es et obtenir un tableau contenant des ressources de renifleur. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/a8/zw/eh/a8zweh8fi_s1p6x-pgl6l7ugfei.png"></div><br><h3>  Lien avec les premi√®res attaques MageCart <br></h3><br>  Une analyse de l'un des domaines utilis√©s par le groupe comme portail pour collecter les donn√©es vol√©es a r√©v√©l√© que le domaine poss√®de une infrastructure de vol de cartes de cr√©dit identique √† celle utilis√©e par le groupe 1, l'un des premiers groupes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©couverts</a> par les sp√©cialistes de RiskIQ. <br><br>  Deux fichiers ont √©t√© trouv√©s sur l'h√¥te de la famille des renifleurs CoffeMokko: <br><br><ul><li>  <b>mage.js</b> - fichier contenant le code de renifleur du groupe 1 avec l'adresse de la porte <b>js-cdn.link</b> </li><li>  <b>mag.php</b> - <b>Script</b> PHP responsable de la collecte de donn√©es vol√©es par des renifleurs </li></ul><br><div class="spoiler">  <b class="spoiler_title">Contenu du fichier Mage.js</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/84/mx/99/84mx99wtkbnzni7faierof1lxbs.png"></div></div></div><br>  Il a √©galement √©t√© constat√© que les premiers domaines utilis√©s par le groupe derri√®re la famille de renifleurs CoffeMokko ont √©t√© enregistr√©s le 17 mai 2017: <br><br><ul><li>  <b>link-js [.] lien</b> </li><li>  <b>lien info-js [.]</b> </li><li>  <b>lien track-js [.]</b> </li><li>  <b>lien map-js [.]</b> </li><li>  <b>lien smart-js [.]</b> </li></ul><br>  Le format de ces noms de domaine est le m√™me que celui des noms de domaine du groupe 1 utilis√©s lors des attaques de 2016. <br><br>  Sur la base des faits d√©couverts, on peut supposer qu'il existe un lien entre les op√©rateurs de renifleurs CoffeMokko et le groupe criminel du groupe 1.  Vraisemblablement, les op√©rateurs de CoffeMokko pourraient emprunter des outils et des logiciels de vol de cartes √† leurs pr√©d√©cesseurs.  Cependant, il est plus probable que le groupe criminel derri√®re l'utilisation de la famille de renifleurs CoffeMokko soit les m√™mes personnes qui ont commis les attaques dans le cadre des activit√©s du groupe 1. Apr√®s la publication du premier rapport sur les activit√©s du groupe criminel, tous leurs noms de domaine ont √©t√© bloqu√©s et les outils ont √©t√© √©tudi√©s en d√©tail et sont d√©crits.  Le groupe a √©t√© contraint de faire une pause, d'affiner leurs outils internes et de r√©√©crire le code du renifleur afin de poursuivre leurs attaques et passer inaper√ßu. <br><br><div class="spoiler">  <b class="spoiler_title">L'infrastructure</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  Domaine </th><th width="200">  Date de d√©couverte / apparition </th></tr><tr><td align="center">  link-js.link </td><td align="center">  17/05/2017 </td></tr><tr><td align="center">  info-js.link </td><td align="center">  17/05/2017 </td></tr><tr><td align="center">  track-js.link </td><td align="center">  17/05/2017 </td></tr><tr><td align="center">  map-js.link </td><td align="center">  17/05/2017 </td></tr><tr><td align="center">  smart-js.link </td><td align="center">  17/05/2017 </td></tr><tr><td align="center">  adorebeauty.org </td><td align="center">  09/03/2017 </td></tr><tr><td align="center">  security-payment.su </td><td align="center">  09/03/2017 </td></tr><tr><td align="center">  braincdn.org </td><td align="center">  09/04/2017 </td></tr><tr><td align="center">  sagecdn.org </td><td align="center">  09/04/2017 </td></tr><tr><td align="center">  slickjs.org </td><td align="center">  09/04/2017 </td></tr><tr><td align="center">  oakandfort.org </td><td align="center">  09/10/2017 </td></tr><tr><td align="center">  citywlnery.org </td><td align="center">  15/09/2017 </td></tr><tr><td align="center">  dobell.su </td><td align="center">  10/04/2017 </td></tr><tr><td align="center">  childsplayclothing.org </td><td align="center">  31/10/2017 </td></tr><tr><td align="center">  jewsondirect.com </td><td align="center">  11/05/2017 </td></tr><tr><td align="center">  shop-rnib.org </td><td align="center">  15/11/2017 </td></tr><tr><td align="center">  closetlondon.org </td><td align="center">  16/11/2017 </td></tr><tr><td align="center">  misshaus.org </td><td align="center">  28/11/2017 </td></tr><tr><td align="center">  battery-force.org </td><td align="center">  12/01/2017 </td></tr><tr><td align="center">  kik-vape.org </td><td align="center">  12/01/2017 </td></tr><tr><td align="center">  greatfurnituretradingco.org </td><td align="center">  12/02/2017 </td></tr><tr><td align="center">  etradesupply.org </td><td align="center">  12/04/2017 </td></tr><tr><td align="center">  replacemyremote.org </td><td align="center">  12/04/2017 </td></tr><tr><td align="center">  all-about-sneakers.org </td><td align="center">  12/05/2017 </td></tr><tr><td align="center">  mage-checkout.org </td><td align="center">  12/05/2017 </td></tr><tr><td align="center">  nililotan.org </td><td align="center">  12/07/2017 </td></tr><tr><td align="center">  lamoodbighats.net </td><td align="center">  12/08/2017 </td></tr><tr><td align="center">  walletgear.org </td><td align="center">  10/12/2017 </td></tr><tr><td align="center">  dahlie.org </td><td align="center">  12/12/2017 </td></tr><tr><td align="center">  davidsfootwear.org </td><td align="center">  20/12/2017 </td></tr><tr><td align="center">  blackriverimaging.org </td><td align="center">  23/12/2017 </td></tr><tr><td align="center">  exrpesso.org </td><td align="center">  01/02/2018 </td></tr><tr><td align="center">  parks.su </td><td align="center">  01/09/2018 </td></tr><tr><td align="center">  pmtonline.su </td><td align="center">  01/12/2018 </td></tr><tr><td align="center">  ottocap.org </td><td align="center">  15/01/2018 </td></tr><tr><td align="center">  christohperward.org </td><td align="center">  27/01/2018 </td></tr><tr><td align="center">  coffetea.org </td><td align="center">  31/01/2018 </td></tr><tr><td align="center">  energycoffe.org </td><td align="center">  31/01/2018 </td></tr><tr><td align="center">  energytea.org </td><td align="center">  31/01/2018 </td></tr><tr><td align="center">  teacoffe.net </td><td align="center">  31/01/2018 </td></tr><tr><td align="center">  adaptivecss.org </td><td align="center">  03/01/2018 </td></tr><tr><td align="center">  coffemokko.com </td><td align="center">  03/01/2018 </td></tr><tr><td align="center">  londontea.net </td><td align="center">  03/01/2018 </td></tr><tr><td align="center">  ukcoffe.com </td><td align="center">  03/01/2018 </td></tr><tr><td align="center">  labbe.biz </td><td align="center">  20/03/2018 </td></tr><tr><td align="center">  batterynart.com </td><td align="center">  04/03/2018 </td></tr><tr><td align="center">  btosports.net </td><td align="center">  04/09/2018 </td></tr><tr><td align="center">  chicksaddlery.net </td><td align="center">  16/04/2018 </td></tr><tr><td align="center">  paypaypay.org </td><td align="center">  05/11/2018 </td></tr><tr><td align="center">  ar500arnor.com </td><td align="center">  26/05/2018 </td></tr><tr><td align="center">  authorizecdn.com </td><td align="center">  28/05/2018 </td></tr><tr><td align="center">  slickmin.com </td><td align="center">  28/05/2018 </td></tr><tr><td align="center">  bannerbuzz.info </td><td align="center">  06/03/2018 </td></tr><tr><td align="center">  kandypens.net </td><td align="center">  06/08/2018 </td></tr><tr><td align="center">  mylrendyphone.com </td><td align="center">  15/06/2018 </td></tr><tr><td align="center">  freshchat.info </td><td align="center">  07/01/2018 </td></tr><tr><td align="center">  3lift.org </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  abtasty.net </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  mechat.info </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  zoplm.com </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  zapaljs.com </td><td align="center">  09/02/2018 </td></tr><tr><td align="center">  foodandcot.com </td><td align="center">  15/09/2018 </td></tr><tr><td align="center">  freshdepor.com </td><td align="center">  15/09/2018 </td></tr><tr><td align="center">  swappastore.com </td><td align="center">  15/09/2018 </td></tr><tr><td align="center">  verywellfitnesse.com </td><td align="center">  15/09/2018 </td></tr><tr><td align="center">  elegrina.com </td><td align="center">  18/11/2018 </td></tr><tr><td align="center">  majsurplus.com </td><td align="center">  19/11/2018 </td></tr><tr><td align="center">  top5value.com </td><td align="center">  19/11/2018 </td></tr></tbody></table></div><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr451792/">https://habr.com/ru/post/fr451792/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr451780/index.html">Audit en 60 minutes - v√©rifiez gratuitement la r√©sistance des employ√©s aux attaques de phishing via Sophos Phish Threat</a></li>
<li><a href="../fr451782/index.html">Sous-syst√®me Windows pour Linux (WSL) version 2: comment sera-t-il? (FAQ)</a></li>
<li><a href="../fr451784/index.html">Lecteurs hybrides pour le stockage d'entreprise. Exp√©rience avec Seagate EXOS</a></li>
<li><a href="../fr451786/index.html">Ex√©cutez des tests instrumentaux dans le Firebase Test Lab. Partie 1: projet iOS</a></li>
<li><a href="../fr451790/index.html">Les dangers de la collecte de donn√©es en jeu</a></li>
<li><a href="../fr451794/index.html">Pixels de retrait de texture</a></li>
<li><a href="../fr451796/index.html">√âcrire une extension de navigateur s√©curis√©e</a></li>
<li><a href="../fr451798/index.html">Migration des donn√©es avec mongoDB et Spring Boot</a></li>
<li><a href="../fr451800/index.html">Faire un simple modem sonar</a></li>
<li><a href="../fr451802/index.html">La communaut√© .Net de Raiffeisenbank invite √† la diffusion UPD mitap</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>