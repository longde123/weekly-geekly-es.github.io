<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ›¡ï¸ ğŸš¶ğŸ¿ ğŸ‘¨ğŸ¿â€ğŸ¤ Teste de Unidade e Python ğŸ§‘ğŸ¼ ğŸ‘¨ğŸ¼â€ğŸ­ ğŸŒ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Meu nome Ã© Vadim, sou um desenvolvedor lÃ­der no Mail.Ru Search. Compartilharei nossa experiÃªncia em testes de unidade. O artigo consiste em trÃªs parte...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Teste de Unidade e Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/418929/"><img src="https://habrastorage.org/webt/vw/s_/rj/vws_rjpt_tkcghfjw_emwmzdakc.jpeg"><br><br>  Meu nome Ã© Vadim, sou um desenvolvedor lÃ­der no Mail.Ru Search.  Compartilharei nossa experiÃªncia em testes de unidade.  O artigo consiste em trÃªs partes: na primeira, vou lhe dizer o que geralmente alcanÃ§amos com a ajuda do teste de unidade;  a segunda parte descreve os princÃ­pios que seguimos;  e na terceira parte, vocÃª aprenderÃ¡ como os princÃ­pios mencionados sÃ£o implementados no Python. <br><a name="habracut"></a><br><h1>  Objetivos </h1><br>  Ã‰ muito importante entender por que vocÃª estÃ¡ aplicando testes de unidade.  AÃ§Ãµes concretas dependerÃ£o disso.  Se vocÃª usar os testes de unidade incorretamente ou, com a ajuda deles, nÃ£o fizer o que queria, nada de bom resultarÃ¡ disso.  Portanto, Ã© muito importante entender com antecedÃªncia quais objetivos vocÃª estÃ¡ perseguindo. <br><br>  Em nossos projetos, buscamos vÃ¡rios objetivos. <br><br>  A primeira Ã© a <b>regressÃ£o</b> banal: para consertar algo no cÃ³digo, executar os testes e descobrir que nada quebrou.  Embora, de fato, nÃ£o seja tÃ£o simples quanto parece. <br><br>  O segundo objetivo Ã© <b>avaliar o impacto da arquitetura</b> .  Se vocÃª introduzir testes de unidade obrigatÃ³rios no projeto, ou simplesmente concordar com os desenvolvedores sobre o uso de testes de unidade, isso afetarÃ¡ imediatamente o estilo de escrever cÃ³digo.  Ã‰ impossÃ­vel escrever funÃ§Ãµes em 300 linhas com 50 variÃ¡veis â€‹â€‹locais e 15 parÃ¢metros se essas funÃ§Ãµes forem submetidas a testes de unidade.  AlÃ©m disso, graÃ§as a esses testes, as interfaces se tornarÃ£o mais compreensÃ­veis e algumas Ã¡reas problemÃ¡ticas aparecerÃ£o.  Afinal, se o cÃ³digo nÃ£o estiver tÃ£o quente, o teste serÃ¡ uma curva e chamarÃ¡ sua atenÃ§Ã£o imediatamente. <br><br>  O terceiro objetivo Ã© <b>tornar o cÃ³digo mais claro</b> .  Suponha que vocÃª veio para um novo projeto e recebeu 50 MB de cÃ³digo-fonte.  Talvez vocÃª nÃ£o consiga entendÃª-los.  Se nÃ£o houver testes de unidade, a Ãºnica maneira de se familiarizar com o trabalho do cÃ³digo, alÃ©m de ler a fonte, Ã© o â€œmÃ©todo de puxÃ£oâ€.  Mas se o sistema for bastante complicado, poderÃ¡ levar muito tempo para obter os trechos de cÃ³digo necessÃ¡rios por meio da interface.  E, graÃ§as aos testes de unidade, vocÃª pode ver como o cÃ³digo Ã© executado de qualquer lugar. <br><br>  O quarto objetivo Ã© <b>simplificar a depuraÃ§Ã£o</b> .  Por exemplo, vocÃª encontrou alguma classe e deseja depurÃ¡-la.  Se, em vez de testes de unidade, houver apenas testes do sistema ou nenhum teste, resta apenas chegar ao lugar certo atravÃ©s da interface.  Por acaso participei de um projeto em que, para testar alguns recursos, demorou meia hora para criar um usuÃ¡rio, cobrar dinheiro, alterar seu status, iniciar algum tipo de cron, para que esse status fosse transferido para outro lugar, clique em algo na interface, inicie algo algum outro cron ... ApÃ³s meia hora, um programa de bÃ´nus para esse usuÃ¡rio finalmente apareceu.  E se eu fizesse testes de unidade, poderia chegar imediatamente ao lugar certo. <br><br>  Finalmente, o objetivo mais importante e muito abstrato, que une todos os anteriores, Ã© o <b>conforto</b> .  Quando tenho testes de unidade, sinto menos estresse ao trabalhar com cÃ³digo, porque entendo o que estÃ¡ acontecendo.  Posso pegar uma fonte desconhecida, corrigir trÃªs linhas, executar testes e garantir que o cÃ³digo funcione conforme o planejado.  E nem Ã© que os testes sejam verdes: eles podem ser vermelhos, mas exatamente onde eu espero.  Ou seja, eu entendo como o cÃ³digo funciona. <br><br><h1>  PrincÃ­pios </h1><br>  Se vocÃª entender seus objetivos, poderÃ¡ entender o que precisa ser feito para alcanÃ§Ã¡-los.  E aqui comeÃ§am os problemas.  O fato Ã© que muitos livros e artigos foram escritos em testes de unidade, mas a teoria ainda Ã© muito imatura. <br><br>  Se vocÃª jÃ¡ leu artigos sobre teste de unidade, tentou aplicar o descrito e nÃ£o obteve Ãªxito, Ã© muito provÃ¡vel que o motivo seja a imperfeiÃ§Ã£o da teoria.  Isso acontece o tempo todo.  Eu, como todos os desenvolvedores, uma vez pensei que o problema estava em mim.  E entÃ£o ele percebeu: nÃ£o posso estar errado tantas vezes.  E ele decidiu que, nos testes de unidade, era necessÃ¡rio proceder a partir de suas prÃ³prias consideraÃ§Ãµes, para agir com mais sensibilidade. <br><br>  O conselho padrÃ£o que vocÃª pode encontrar em todos os livros e artigos: â€œvocÃª deve testar nÃ£o a implementaÃ§Ã£o, mas a interfaceâ€.  Afinal, a implementaÃ§Ã£o pode mudar, mas a interface nÃ£o.  Vamos testÃ¡-lo para que os testes nÃ£o caiam o tempo todo em todas as ocasiÃµes.  O conselho, ao que parece, nÃ£o Ã© ruim e tudo parece lÃ³gico.  Mas sabemos muito bem: para testar algo, vocÃª precisa selecionar alguns valores de teste.  Normalmente, ao testar funÃ§Ãµes, as chamadas classes de equivalÃªncia sÃ£o distinguidas: o conjunto de valores nos quais a funÃ§Ã£o se comporta de maneira uniforme.  Grosso modo, o teste para cada se.  Mas, para saber quais classes de equivalÃªncia temos, Ã© necessÃ¡ria uma implementaÃ§Ã£o.  VocÃª nÃ£o o testa, mas precisa, deve investigar para saber quais valores de teste escolher. <br><br>  Fale com qualquer testador: ele lhe dirÃ¡ que, com testes manuais, ele sempre imagina uma implementaÃ§Ã£o.  Por sua experiÃªncia, ele entende perfeitamente onde os programadores geralmente cometem erros.  O testador nÃ£o verifica tudo, primeiro digitando 5, depois 6 e depois 7. Ele verifica 5, abc, â€“7 e o nÃºmero tem 100 caracteres, porque ele sabe que a implementaÃ§Ã£o desses valores pode ser diferente, mas para 6 e 7 Ã© improvÃ¡vel . <br><br>  Portanto, nÃ£o estÃ¡ claro como seguir o princÃ­pio de "testar a interface, nÃ£o a implementaÃ§Ã£o".  VocÃª nÃ£o pode simplesmente pegar, fechar os olhos e escrever um teste.  O TDD estÃ¡ tentando resolver esse problema em parte.  A teoria sugere a introduÃ§Ã£o de classes de equivalÃªncia uma de cada vez e a escrita de testes para elas.  Eu li muitos livros e artigos sobre esse assunto, mas de alguma forma isso nÃ£o se mantÃ©m.  No entanto, concordo com a tese de que os testes devem ser escritos primeiro.  Chamamos esse princÃ­pio de teste primeiro.  NÃ£o temos TDD e, em conexÃ£o com o exposto acima, os testes nÃ£o sÃ£o escritos antes da criaÃ§Ã£o do cÃ³digo, mas em paralelo com ele. <br><br>  Definitivamente, nÃ£o recomendo escrever testes retroativamente.  Afinal, eles influenciam a arquitetura e, se jÃ¡ se acalmou, Ã© tarde demais para influenciÃ¡-la - tudo terÃ¡ que ser reescrito.  Em outras palavras, a testabilidade do cÃ³digo Ã© uma propriedade separada que o cÃ³digo terÃ¡ que <b>dotar</b> , e nÃ£o se tornarÃ¡ tal.  Portanto, tentamos escrever testes junto com o cÃ³digo.  NÃ£o acredite em histÃ³rias como â€œvamos escrever um projeto em trÃªs meses e depois cobrir tudo com testes em uma semanaâ€, isso nunca acontecerÃ¡. <br><br>  A coisa mais importante a entender: o teste de unidade nÃ£o Ã© uma maneira de verificar o cÃ³digo, nem uma maneira de verificar sua correÃ§Ã£o.  Isso faz parte da sua arquitetura, o design do seu aplicativo.  Ao trabalhar com testes de unidade, vocÃª muda seus hÃ¡bitos.  Testes que apenas verificam a exatidÃ£o sÃ£o antes testes de aceitaÃ§Ã£o.  SerÃ¡ um erro pensar que vocÃª pode cobrir algo com testes de unidade ou que o cÃ³digo nÃ£o precisarÃ¡ ser verificado. <br><br><h1>  ImplementaÃ§Ã£o Python </h1><br>  Usamos a biblioteca unittest padrÃ£o da famÃ­lia xUnit.  A histÃ³ria Ã© a seguinte: havia a linguagem SmallTalk e nela a biblioteca SUnit.  Todos gostaram, comeÃ§aram a copiÃ¡-lo.  A biblioteca foi importada para Java com o nome Junit, de lÃ¡ em C ++ com o nome CppUnit e em Ruby com o nome RUnit (depois foi renomeada para RSpec).  Finalmente, a partir de Java, a biblioteca "mudou-se" para Python com o nome de mais unittest.  E eles o importaram tÃ£o literalmente que atÃ© o CamelCase permaneceu, embora isso nÃ£o corresponda ao PEP 8. <br><br>  Sobre o xUnit, hÃ¡ um livro maravilhoso, â€œxUnit Test Patternsâ€.  Descreve como trabalhar com as estruturas dessa famÃ­lia.  A Ãºnica desvantagem do livro Ã© seu tamanho: Ã© enorme, mas cerca de 2/3 do conteÃºdo Ã© um catÃ¡logo de padrÃµes.  E o primeiro terÃ§o do livro Ã© maravilhoso, este Ã© um dos melhores livros sobre TI que eu jÃ¡ conheci. <br><br>  Um teste de unidade Ã© um cÃ³digo regular que possui uma certa arquitetura padrÃ£o.  Todos os testes de unidade consistem em trÃªs estÃ¡gios: configurar, exercitar e verificar.  VocÃª prepara os dados, executa os testes e verifica se tudo estÃ¡ no estado correto. <br><br><img src="https://habrastorage.org/webt/mi/ph/la/miphla26gfglcsjvog2giitgrko.jpeg"><br><br><h3>  ConfiguraÃ§Ã£o </h3><br>  A fase mais difÃ­cil e interessante.  Trazer o sistema ao seu estado original a partir do qual vocÃª deseja testÃ¡-lo pode ser muito difÃ­cil.  E o estado do sistema pode ser arbitrariamente complexo. <br><br>  Quando sua funÃ§Ã£o Ã© chamada, muitos eventos poderiam ter acontecido, um milhÃ£o de objetos poderia ter sido criado na memÃ³ria.  Em todos os componentes associados ao seu software - no sistema de arquivos, banco de dados, caches - algo jÃ¡ estÃ¡ localizado e a funÃ§Ã£o pode funcionar apenas nesse ambiente.  E se o ambiente nÃ£o estiver preparado, as aÃ§Ãµes da funÃ§Ã£o nÃ£o terÃ£o sentido. <br><br>  Geralmente, todo mundo afirma que, em nenhum caso, vocÃª pode usar sistemas de arquivos, bancos de dados ou qualquer outro componente separado, porque isso torna seu teste nÃ£o modular, mas integrado.  Na minha opiniÃ£o, isso nÃ£o Ã© verdade, porque o teste de integraÃ§Ã£o Ã© feito pelo teste de integraÃ§Ã£o.  Se vocÃª usar alguns componentes nÃ£o para verificaÃ§Ã£o, mas apenas para fazer o sistema funcionar, nÃ£o hÃ¡ nada de errado nisso.  Seu cÃ³digo interage com muitos componentes do computador e do sistema operacional.  O Ãºnico problema com o uso de um sistema de arquivos ou banco de dados Ã© a velocidade. <br><br>  Diretamente no cÃ³digo, usamos <b>injeÃ§Ã£o de dependÃªncia</b> .  VocÃª pode lanÃ§ar parÃ¢metros na funÃ§Ã£o em vez dos padrÃµes.  VocÃª pode atÃ© encaminhar links para bibliotecas.  Ou vocÃª pode inserir um stub em vez de uma solicitaÃ§Ã£o para que o cÃ³digo dos testes nÃ£o acesse a rede.  VocÃª pode armazenar registradores personalizados nos atributos da classe para nÃ£o gravar no disco e economizar tempo. <br><br>  Para stubs, usamos o mock habitual do unittest.  HÃ¡ tambÃ©m uma funÃ§Ã£o de patch que, em vez de implementar honestamente dependÃªncias, simplesmente diz: "neste pacote, essa importaÃ§Ã£o Ã© um substituto para outro".  Ã‰ conveniente porque vocÃª nÃ£o precisa jogar nada em lugar nenhum.  Ã‰ verdade que nÃ£o estÃ¡ claro quem substituiu o que, portanto, use-o com cuidado. <br><br>  Quanto ao sistema de arquivos, fingir Ã© bem simples.  HÃ¡ um mÃ³dulo io com <code>io.StringIO</code> e <code>io.BytesIO</code> .  VocÃª pode criar objetos semelhantes a arquivos que realmente nÃ£o acessam o disco.  Mas, de repente, isso nÃ£o Ã© suficiente para vocÃª, existe um maravilhoso mÃ³dulo tempfile com gerenciadores de contexto para arquivos temporÃ¡rios, diretÃ³rios, arquivos nomeados, qualquer coisa.  Tempfile Ã© um super-mÃ³dulo se, por algum motivo, o IO nÃ£o couber em vocÃª. <br><br>  Com um banco de dados, tudo Ã© mais complicado.  HÃ¡ uma recomendaÃ§Ã£o padrÃ£o: "NÃ£o use uma base real, mas uma base falsa".  NÃ£o conheÃ§o vocÃª, mas na minha vida nÃ£o vi uma Ãºnica base falsa e suficientemente funcional.  Toda vez que eu pedia conselhos sobre o que especificamente levar sob Python ou Perl, eles respondiam que ninguÃ©m sabia de nada pronto e se ofereciam para escrever algo prÃ³prio.  NÃ£o consigo imaginar como vocÃª pode escrever um emulador, por exemplo, PostgreSQL.  Outra dica: "obtenha o SQLite".  Mas isso quebrarÃ¡ o isolamento, porque o SQLite trabalha com o sistema de arquivos.  AlÃ©m disso, se vocÃª usar algo como MySQL ou PostgreSQL, o SQLite provavelmente nÃ£o funcionarÃ¡.  Se lhe parece que vocÃª nÃ£o estÃ¡ usando os recursos especÃ­ficos de produtos especÃ­ficos, provavelmente estÃ¡ enganado.  Certamente, mesmo para coisas comuns, como trabalhar com datas, vocÃª usa recursos especÃ­ficos que apenas o DBMS suporta. <br><br>  Como resultado, eles geralmente usam uma base real.  A soluÃ§Ã£o nÃ£o Ã© ruim, sÃ³ precisamos mostrar uma certa precisÃ£o.  NÃ£o use um banco de dados centralizado, porque os testes podem ser interrompidos entre si.  Idealmente, a prÃ³pria base deve subir durante os testes e parar apÃ³s o teste. <br><br>  Uma situaÃ§Ã£o um pouco pior Ã© quando vocÃª Ã© obrigado a executar um banco de dados local, que serÃ¡ usado.  Mas a questÃ£o Ã©: como os dados chegarÃ£o lÃ¡?  JÃ¡ dissemos que deve haver algum estado inicial do sistema, deve haver alguns dados no banco de dados.  De onde eles vÃªm nÃ£o Ã© uma pergunta fÃ¡cil. <br><br>  A abordagem mais ingÃªnua que me deparei Ã© usar uma cÃ³pia de um banco de dados real.  Uma cÃ³pia era tirada regularmente, da qual os dados confidenciais eram excluÃ­dos.  Os autores argumentaram que dados reais sÃ£o mais adequados para testes.  AlÃ©m disso, escrever testes para uma cÃ³pia de um banco de dados real Ã© um tormento.  VocÃª nÃ£o sabe quais dados existem.  VocÃª precisa primeiro encontrar o que vai testar.  Se essas informaÃ§Ãµes nÃ£o estiverem disponÃ­veis, o que fazer nÃ£o Ã© claro.  Acabou que naquele projeto eles decidiram escrever testes para a conta do departamento de operaÃ§Ãµes, que â€œnunca mudarÃ£oâ€.  Claro, depois de algum tempo ela mudou. <br><br>  Isso geralmente Ã© seguido pela decisÃ£o: â€œvamos criar um elenco da base real, copiÃ¡-lo e nÃ£o sincronizar mais.  EntÃ£o serÃ¡ possÃ­vel estar vinculado a um objeto especÃ­fico, observar o que acontece lÃ¡ e escrever testes. â€  Surge imediatamente a pergunta: o que acontecerÃ¡ quando novas tabelas forem adicionadas ao banco de dados?  Aparentemente, vocÃª terÃ¡ que inserir manualmente dados falsos. <br><br>  Mas, como faremos de qualquer maneira, vamos preparar imediatamente o elenco base manualmente.  Essa opÃ§Ã£o Ã© muito parecida com o que geralmente Ã© chamado de acessÃ³rios no Django: eles criam JSON enormes, enviam casos de teste para todas as ocasiÃµes, os enviam para o banco de dados no inÃ­cio do teste, e tudo ficarÃ¡ bem conosco.  Essa abordagem tambÃ©m tem muitas desvantagens.  Os dados sÃ£o empilhados em uma pilha, nÃ£o estÃ¡ claro a que teste ele se relaciona.  NinguÃ©m pode entender se os dados foram excluÃ­dos ou nÃ£o.  E hÃ¡ estados incompatÃ­veis no banco de dados: por exemplo, um teste nÃ£o precisa ter usuÃ¡rios no banco de dados e o outro para tÃª-los.  Essas duas condiÃ§Ãµes nÃ£o podem ser armazenadas simultaneamente no mesmo molde.  Nesse caso, um dos testes precisarÃ¡ modificar o banco de dados.  E como vocÃª ainda precisa lidar com isso, Ã© mais fÃ¡cil comeÃ§ar com um banco de dados vazio, para que cada teste coloque os dados necessÃ¡rios e, ao final do teste, limpe o banco de dados.  A Ãºnica desvantagem dessa abordagem Ã© a dificuldade de criar dados em cada teste.  Em um dos projetos em que trabalhei, para criar um serviÃ§o, foi necessÃ¡rio gerar 8 entidades em tabelas diferentes: um serviÃ§o em uma conta pessoal, uma conta pessoal em um cliente, um cliente em uma entidade legal, uma entidade legal em uma cidade, um cliente em uma cidade e assim por diante.  AtÃ© vocÃª criar tudo isso em uma cadeia, vocÃª nÃ£o satisfarÃ¡ a chave estrangeira, nada funciona. <br><br>  Para tais situaÃ§Ãµes, existem bibliotecas especiais que facilitam muito a vida.  VocÃª pode escrever ferramentas auxiliares, geralmente chamadas de fÃ¡bricas (nÃ£o confunda com o padrÃ£o de design).  Por exemplo, usamos a biblioteca factory_boy, que Ã© adequada para o Django.  Este Ã© um clone da biblioteca factory_girl, que foi renomeada para factory_bot no ano passado por razÃµes de correÃ§Ã£o polÃ­tica.  Escrever uma biblioteca para sua prÃ³pria estrutura nÃ£o custa nada.  Ã‰ baseado em uma ideia muito importante: uma vez vocÃª cria uma fÃ¡brica para os objetos que deseja gerar, estabelece conexÃµes para ela e diz ao usuÃ¡rio: â€œquando vocÃª for criado, pegue seu prÃ³ximo nome e gere o grupo usando a fÃ¡brica de grupoâ€.  E na fÃ¡brica, tudo Ã© exatamente o mesmo: gere o nome dessa maneira, entidades relacionadas, tal e tal. <br><br>  Como resultado, apenas uma Ãºltima linha permanece no cÃ³digo: <code>user = UserFactory()</code> .  O usuÃ¡rio foi criado e vocÃª pode trabalhar com ele, porque, sob o capÃ´, ele gerou tudo o que Ã© necessÃ¡rio.  Se desejar, vocÃª pode configurar algo manualmente. <br><br>  Para limpar os dados apÃ³s o teste, usamos transaÃ§Ãµes triviais.  No inÃ­cio de cada teste, BEGIN estÃ¡ concluÃ­do, o teste faz algo com a base e, apÃ³s o teste, ROLLBACK estÃ¡ concluÃ­do.  Se forem necessÃ¡rias transaÃ§Ãµes no prÃ³prio teste - por exemplo, porque compromete algo extra no banco de dados - ele chama o mÃ©todo que chamamos de <code>break_db</code> , informa Ã  estrutura que ela quebrou a base de dados e a estrutura a <code>break_db</code> novamente.  Acontece lentamente, mas como geralmente hÃ¡ muito poucos testes que precisam de transaÃ§Ãµes, tudo estÃ¡ em ordem. <br><br><h3>  ExercÃ­cio </h3><br>  NÃ£o hÃ¡ nada de especial para contar sobre esse estÃ¡gio.  A Ãºnica coisa que pode dar errado aqui Ã© virar para fora, por exemplo, para a Internet.  Por algum tempo, estÃ¡vamos lutando com isso administrativamente: dissemos aos programadores que devemos mergulhar funÃ§Ãµes que vÃ£o a algum lugar ou lanÃ§ar sinalizadores especiais para que as funÃ§Ãµes nÃ£o funcionem.  Se o teste acessar o etcd corporativo, isso nÃ£o serÃ¡ bom.  Como resultado, chegamos Ã  conclusÃ£o de que tudo foi desperdiÃ§ado: nÃ³s mesmos esquecemos constantemente que alguma funÃ§Ã£o chama uma funÃ§Ã£o que chama uma funÃ§Ã£o que vai para o etcd.  Portanto, no setUp da classe base, adicionamos o moki de todas as chamadas, ou seja, bloqueado com a ajuda de stubs todas as chamadas onde nÃ£o foram colocadas. <br><br>  Os stubs podem ser feitos facilmente usando remendos, coloque remendos em um dicionÃ¡rio separado e dÃª acesso a todos os testes.  Por padrÃ£o, os testes nÃ£o podem ir a lugar algum e, se vocÃª ainda precisar abrir o acesso para alguns, poderÃ¡ redirecionÃ¡-lo.  Muito confortÃ¡vel  Jenkins nÃ£o enviarÃ¡ mais SMS para seus clientes Ã  noite :) <br><br><h3>  Verificar </h3><br>  Nesse estÃ¡gio, usamos ativamente declaraÃ§Ãµes auto-escritas, mesmo de linha Ãºnica.  Se vocÃª testar a existÃªncia de um arquivo no teste, em vez de afirmar <code>self.assertTrue(file_exists(f))</code> recomendo escrever afirmando que <code>not file exists</code> .  Holivar estÃ¡ conectado com isso: devo continuar usando o CamelCase em nomes, como em unittest, ou devo seguir o PEP 8?  Eu nÃ£o tenho resposta.  Se vocÃª seguir o PEP 8, no cÃ³digo de teste haverÃ¡ uma confusÃ£o no CamelCase e no snake_case.  E se vocÃª usa o CamelCase, isso nÃ£o corresponde ao PEP 8. <br><br>  E o Ãºltimo.  Suponha que vocÃª tenha um cÃ³digo que estÃ¡ testando alguma coisa e hÃ¡ muitas opÃ§Ãµes de dados nas quais esse cÃ³digo precisa ser executado.  Se vocÃª usar py.test, poderÃ¡ executar o mesmo teste com diferentes dados de entrada.  Se vocÃª nÃ£o possui py.test, pode usar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">esse decorador</a> .  Uma tabela Ã© passada para o decorador e um teste se transforma em vÃ¡rios outros, cada um dos quais testa um dos casos. <br><br><h1>  ConclusÃ£o </h1><br>  NÃ£o confie em artigos e livros incondicionalmente.  Se vocÃª acha que eles estÃ£o errados, Ã© possÃ­vel que sim. <br><br>  Sinta-se livre para usar testes de dependÃªncia.  NÃ£o hÃ¡ nada de errado nisso.  Se vocÃª criou o memcached, porque sem ele seu cÃ³digo nÃ£o funciona normalmente, tudo bem.  Mas Ã© melhor ficar sem ele, se possÃ­vel. <br><br>  Preste atenÃ§Ã£o nas fÃ¡bricas.  Este Ã© um padrÃ£o muito interessante. <br><br>  PS Convido vocÃª para o canal Telegram do meu autor para programaÃ§Ã£o em Python - @pythonetc. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt418929/">https://habr.com/ru/post/pt418929/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt418919/index.html">Sobre o crescimento profissional do designer e trabalhar com estresse. E como encontrar forÃ§a nos momentos mais difÃ­ceis</a></li>
<li><a href="../pt418921/index.html">4 bibliotecas facilitando a vida de um desenvolvedor do React</a></li>
<li><a href="../pt418923/index.html">PWA Ã© apenas</a></li>
<li><a href="../pt418925/index.html">Big Data - mano ou nÃ£o mano</a></li>
<li><a href="../pt418927/index.html">PadrÃµes escuros da Amazon</a></li>
<li><a href="../pt418931/index.html">RubyMine 2018.2: anexando um depurador a processos remotos, chruby, anÃ¡lise de cÃ³digo aprimorada e muito mais</a></li>
<li><a href="../pt418933/index.html">OnePlus Review 6. Quando os chineses fizeram tudo o mesmo da Ãºltima vez</a></li>
<li><a href="../pt418935/index.html">DZ Online Tech: ABBYY. Como nÃ£o se confundir em redes neurais?</a></li>
<li><a href="../pt418937/index.html">Comemorando o 8Âº aniversÃ¡rio com o primeiro lanÃ§amento na GeekUniversity</a></li>
<li><a href="../pt418941/index.html">NÃ£o tenha medo do microsserviÃ§o: Alexey Baitov sobre o uso da arquitetura de microsserviÃ§o na prÃ¡tica</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>