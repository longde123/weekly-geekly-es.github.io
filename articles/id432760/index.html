<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥪 🙋 🚊 Tampilan produk vektor, atau penggunaan model Word2Vec lainnya 🙅🏾 🙇🏽 ✌🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Setiap hari, satu setengah juta orang mencari Ozon untuk berbagai produk, dan untuk masing-masing layanan harus memilih yang serupa (jika penyedot deb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tampilan produk vektor, atau penggunaan model Word2Vec lainnya</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ozontech/blog/432760/"><img src="https://habrastorage.org/webt/w4/qo/hx/w4qohxd9gujf6kayzuow0bww9dc.png" alt="gambar"><br><br><p>  Setiap hari, satu setengah juta orang mencari Ozon untuk berbagai produk, dan untuk masing-masing layanan harus memilih yang serupa (jika penyedot debu masih membutuhkan yang lebih kuat) atau yang terkait (jika baterai diperlukan untuk bernyanyi dinosaurus).  Ketika ada terlalu banyak jenis produk, model Word2Vec membantu menyelesaikan masalah.  Kami memahami cara kerjanya dan cara membuat representasi vektor untuk objek yang berubah-ubah. </p><a name="habracut"></a><br><h3>  Motivasi </h3><br><p> Untuk membangun dan melatih model, kami menggunakan teknik embedding, standar untuk pembelajaran mesin, ketika setiap objek berubah menjadi vektor dengan panjang tetap, dan vektor dekat sesuai dengan objek dekat.  Hampir semua model yang dikenal mensyaratkan bahwa input data memiliki panjang yang tetap, dan satu set vektor adalah cara mudah untuk membawanya ke formulir ini. </p><br><p>  Salah satu metode penyematan pertama adalah word2vec.  Kami mengadaptasi metode ini untuk tugas kami, kami menggunakan produk sebagai kata-kata, dan sesi pengguna sebagai kalimat.  Jika semuanya jelas bagi Anda, jangan ragu untuk membalik-balik hasilnya. </p><br><p>  Selanjutnya saya akan berbicara tentang arsitektur model dan cara kerjanya.  Karena kita berurusan dengan barang, kita perlu belajar bagaimana membangun deskripsi mereka sehingga, di satu sisi, berisi informasi yang cukup, dan di sisi lain, dapat dimengerti untuk algoritma pembelajaran mesin. </p><br><img src="https://habrastorage.org/webt/y0/pj/fz/y0pjfzmvk5o-aulmjygpnjrphji.png" alt="gambar"><br><p>  Di situs web, setiap produk memiliki kartu.  Ini terdiri dari judul, deskripsi teks, spesifikasi dan foto.  Juga tersedia untuk kami, ada data tentang interaksi pengguna dengan produk: pandangan, penambahan ke keranjang atau favorit disimpan dalam log. </p><br><p>  Ada dua cara yang berbeda secara mendasar untuk membangun deskripsi vektor suatu produk: </p><br><p>  - Menggunakan konten - jaringan saraf konvolusional untuk mengekstraksi fitur dari foto, jaringan berulang atau sekumpulan kata untuk menganalisis deskripsi teks; <br>  - penggunaan data pada interaksi pengguna dengan produk: produk apa dan seberapa sering mereka terlihat / ditambahkan ke keranjang bersama dengan data. </p><br><p>  Kami akan fokus pada metode kedua. </p><br><h3>  Data untuk Model Prod2Vec </h3><br><p>  Pertama, mari kita cari tahu data apa yang kita gunakan.  Kami memiliki semua klik pengguna di situs yang kami miliki, mereka dapat dibagi menjadi sesi pengguna - urutan klik dengan interval tidak lebih dari 30 menit antara klik yang berdekatan.  Untuk melatih model, kami menggunakan data dari sekitar 100 juta sesi pengguna, di mana masing-masing kami hanya tertarik untuk melihat dan menambahkan produk ke keranjang. </p><br><p>  Contoh sesi pengguna nyata: </p><br><img src="https://habrastorage.org/webt/q5/ov/fe/q5ovfeg-qfqarxgzxyzcfq5vssk.png" alt="gambar"><br><p>  Setiap produk dalam sesi sesuai dengan konteksnya - semua produk yang ditambahkan pengguna ke keranjang di sesi ini, serta produk yang dilihat dengan ini.  Model prod2vec didasarkan pada asumsi bahwa produk serupa paling sering memiliki konteks yang sama. </p><br><p>  Sebagai contoh: </p><br><img src="https://habrastorage.org/webt/ch/_m/tp/ch_mtpiawhaak2ddrks2pjxvgae.png" alt="gambar"><br><p>  Jadi, jika asumsi itu benar, maka, misalnya, kasus untuk model telepon yang sama akan memiliki konteks yang sama (telepon yang sama).  Kami akan menguji hipotesis ini dengan membuat vektor produk. </p><br><h3>  Model Prod2Vec </h3><br><p>  Ketika kami memperkenalkan konsep produk dan konteksnya, kami menggambarkan model itu sendiri.  Ini adalah jaringan saraf dengan dua lapisan yang terhubung sepenuhnya.  Jumlah input dari lapisan pertama sama dengan jumlah produk yang ingin kita buat vektor.  Setiap produk di pintu masuk akan dikodekan oleh vektor nol dengan satu unit - tempat produk ini dalam kamus. </p><br><p>  Jumlah neuron pada output lapisan pertama sama dengan dimensi vektor yang ingin kita dapatkan, misalnya 64. Pada output lapisan terakhir, sekali lagi, ada sejumlah neuron yang sama dengan jumlah barang. </p><br><img src="https://habrastorage.org/webt/nf/0i/bf/nf0ibftkdqs3bkun8jn_qkwodfo.jpeg" alt="gambar"><br><br><p>  Kami akan melatih model untuk memprediksi konteks, mengetahui produk.  Arsitektur ini disebut Skip-gram (alternatifnya adalah CBOW, di mana kami memperkirakan produk sesuai dengan konteksnya).  Selama pelatihan, barang dikirim ke pintu masuk, barang diharapkan menjadi output dari konteksnya (vektor nol dengan unit di tempat yang sesuai). </p><br><p>  Intinya, ini adalah klasifikasi multiklass, dan cross entropy loss dapat digunakan untuk melatih model.  Untuk satu pasangan kata-kata dari konteksnya, ditulis sebagai berikut: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">L</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-4" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-7" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-9">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">g</span><span class="MJXp-mtext" id="MJXp-Span-13">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">u</span><span class="MJXp-msubsup" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-18"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">i</span><span class="MJXp-mo" id="MJXp-Span-20">=</span><span class="MJXp-mn" id="MJXp-Span-21">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">p</span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-29" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.263ex" height="3.142ex" viewBox="0 -935.7 13030 1352.7" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-4C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-3D" x="959" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-2212" x="2015" y="0"></use><g transform="translate(2794,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-63" x="712" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-2B" x="3926" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-6C" x="5177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-6F" x="5475" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-67" x="5961" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-73" x="6691" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-75" x="7161" y="0"></use><g transform="translate(7733,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-56" x="1242" y="510"></use><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-65" x="9860" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-78" x="10327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-70" x="10899" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-28" x="11403" y="0"></use><g transform="translate(11792,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-69" x="712" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-29" x="12640" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> L = -p_c + \ log \ sum_ {i = 1} ^ V exp (p_i) </script></p><br><p>  dimana <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-31"><span class="MJXp-msubsup" id="MJXp-Span-32"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-34" style="vertical-align: -0.4em;">c</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.203ex" height="1.817ex" viewBox="-38.5 -520.7 948.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-63" x="712" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> p_c </script>  - prediksi jaringan untuk produk dari konteks, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">V</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.787ex" height="2.057ex" viewBox="0 -780.1 769.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-56" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> V </script>  - jumlah total barang <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-37"><span class="MJXp-msubsup" id="MJXp-Span-38"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-40" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.059ex" height="1.817ex" viewBox="-38.5 -520.7 886.3 782.1" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-69" x="712" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> p_i </script>  - prediksi jaringan untuk produk <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="1.937ex" viewBox="0 -728.2 345.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-69" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> i </script>  . </p><br><p>  Setelah melatih model, kita dapat membuang lapisan kedua - tidak diperlukan untuk mendapatkan vektor.  Matriks bobot lapisan pertama (ukuran jumlah barang x 64) adalah kamus vektor barang.  Setiap produk sesuai dengan satu baris matriks dengan panjang 64 - ini adalah vektor yang sesuai dengan produk, yang dapat digunakan dalam algoritma lain. </p><br><p>  Tetapi prosedur ini tidak berfungsi untuk sejumlah besar produk.  Dan kita memilikinya, ingat, satu setengah juta. </p><br><p>  Mengapa Prod2Vec Tidak Bekerja </p><br><p>  - Fungsi kerugian mengandung banyak operasi pengambilan eksponen - ini adalah komputasi yang panjang dan tidak stabil. <br>  - Akibatnya, gradien dipertimbangkan untuk semua bobot jaringan - dan mungkin ada puluhan juta. </p><br><p>  Untuk mengatasi masalah ini, metode pengambilan sampel negatif cocok, dengan menggunakan yang kami ajarkan jaringan tidak hanya untuk memprediksi konteks untuk produk, tetapi juga mengajarkan untuk tidak memprediksi produk yang tidak tepat dalam konteks.  Untuk melakukan ini, kita perlu membuat contoh negatif - untuk setiap produk, pilih yang tidak perlu diprediksi untuk itu.  Dan di sini ketersediaan sejumlah besar barang membantu kami.  Ketika memilih pasangan acak untuk suatu produk, kami memiliki probabilitas yang sangat kecil bahwa itu akan menjadi produk dari konteksnya. </p><br><p>  Akibatnya, untuk setiap produk dalam konteks, kami secara acak menghasilkan 5-10 produk yang tidak termasuk dalam konteks.  Selain itu, barang tidak diambil sampelnya dengan distribusi yang seragam, tetapi sesuai dengan frekuensi kemunculannya. </p><br><p>  Fungsi kerugian sekarang mirip dengan yang digunakan dalam klasifikasi biner.  Untuk satu pasangan kata-kata, dari konteksnya, terlihat seperti ini: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">L</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-47">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">g</span><span class="MJXp-mtext" id="MJXp-Span-51">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">a</span><span class="MJXp-mo" id="MJXp-Span-57" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-58"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59" style="margin-right: 0.05em;">u</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-60"><span class="MJXp-msubsup" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-63" style="vertical-align: -0.4em;">O</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-65"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-67" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-68"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-70" style="vertical-align: -0.4em;">I</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-73">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">u</span><span class="MJXp-msubsup" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-78" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-81" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-82">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">g</span><span class="MJXp-mtext" id="MJXp-Span-86">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">a</span><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-94"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95" style="margin-right: 0.05em;">u</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-96"><span class="MJXp-msubsup" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-99" style="vertical-align: -0.4em;">n</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-103" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-106" style="vertical-align: -0.4em;">I</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="56.786ex" height="2.901ex" viewBox="0 -883.9 24449.5 1249" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-4C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-3D" x="959" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-2212" x="2015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-6C" x="3044" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-6F" x="3342" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-67" x="3828" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-73" x="4558" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-69" x="5028" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-67" x="5373" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-6D" x="5854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-61" x="6732" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-28" x="7262" y="0"></use><g transform="translate(7651,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-54" x="809" y="488"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-4F" x="1013" y="-218"></use></g></g><g transform="translate(9283,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-76" x="0" y="0"></use><g transform="translate(485,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-49" x="1013" y="-213"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-29" x="10698" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-2212" x="11309" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-73" x="12560" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-75" x="13030" y="0"></use><g transform="translate(13602,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-6E" x="1013" y="-213"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-6C" x="15708" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-6F" x="16007" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-67" x="16492" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-73" x="17223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-69" x="17692" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-67" x="18038" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-6D" x="18518" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-61" x="19397" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-28" x="19926" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-2212" x="20316" y="0"></use><g transform="translate(21094,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-54" x="809" y="488"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-6E" x="1013" y="-213"></use></g></g><g transform="translate(22644,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-76" x="0" y="0"></use><g transform="translate(485,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-49" x="1013" y="-213"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-29" x="24060" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> L = - \ log \ sigma (u_ {w_O} ^ T v_ {w_I}) - \ sum_ {w_n} \ log \ sigma (-u_ {w_n} ^ T v_ {w_I}) </script></p><br><p>  Dalam notasi ini <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-108"><span class="MJXp-msubsup" id="MJXp-Span-109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-111" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-114" style="vertical-align: -0.4em;">O</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.79ex" height="2.057ex" viewBox="0 -520.7 1631.6 885.9" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-75" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-4F" x="1013" y="-218"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-7"> u_ {w_O} </script>  menunjukkan kolom matriks berat lapisan kedua yang sesuai dengan produk dari konteks, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-115"><span class="MJXp-msubsup" id="MJXp-Span-116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-118" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-121" style="vertical-align: -0.4em;">n</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.6ex" height="2.057ex" viewBox="0 -520.7 1550.1 885.9" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-75" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-6E" x="1013" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-8"> u_ {w_n} </script>  - sama untuk produk yang dipilih secara acak, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-122"><span class="MJXp-msubsup" id="MJXp-Span-123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-125" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-128" style="vertical-align: -0.4em;">I</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.287ex" height="1.937ex" viewBox="0 -520.7 1415.1 834" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-76" x="0" y="0"></use><g transform="translate(485,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-49" x="1013" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-9"> v_ {w_I} </script>  - baris matriks bobot dari lapisan pertama yang sesuai dengan produk utama (ini persis vektor yang kami bangun untuk itu).  Fungsi <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-129"><span class="MJXp-mtext" id="MJXp-Span-130">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">a</span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">x</span><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-140">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">c</span><span class="MJXp-mrow" id="MJXp-Span-145"><span class="MJXp-mn" id="MJXp-Span-146">1</span></span><span class="MJXp-mrow" id="MJXp-Span-147"><span class="MJXp-mn" id="MJXp-Span-148">1</span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">p</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-154" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">x</span><span class="MJXp-mo" id="MJXp-Span-156" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.937ex" height="2.66ex" viewBox="0 -832 13750.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-61" x="2424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-28" x="2953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-78" x="3343" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-29" x="3915" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-3D" x="4582" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-66" x="5889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-72" x="6439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-61" x="6891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-63" x="7420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-31" x="7854" y="0"></use><g transform="translate(8354,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-2B" x="722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-65" x="1723" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-78" x="2189" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-70" x="2762" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-28" x="3265" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-2212" x="3655" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMATHI-78" x="4433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhj_dgsuxmHdqGeaVSqsg6JL58y8bg#MJMAIN-29" x="5006" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-10"> \ sigma (x) = \ frac {1} {1 + exp (-x)} </script>  . </p><br><p>  Perbedaan dari versi sebelumnya adalah bahwa kita tidak perlu memperbarui semua bobot jaringan pada setiap iterasi, kita hanya perlu memperbarui yang sesuai dengan sejumlah kecil produk (produk pertama adalah yang kita prediksi, sisanya adalah produk dari konteksnya atau dipilih secara acak )  Pada saat yang sama, kami menyingkirkan sejumlah besar tangkapan eksponensial di setiap iterasi. </p><br><p>  Teknik lain, yang pada gilirannya meningkatkan kualitas model yang dihasilkan, adalah subsampling.  Dalam hal ini, kami sengaja mengambil barang yang kurang sering ditemukan untuk pelatihan guna mendapatkan hasil terbaik untuk barang langka. </p><br><h3>  Hasil </h3><br><h4>  Produk Terkait </h4><br><p>  Jadi, kami belajar cara mendapatkan vektor untuk barang, sekarang kami perlu memeriksa kecukupan dan penerapan model kami. </p><br><p>  Gambar berikut menunjukkan produk dan tetangga terdekatnya dalam ukuran kedekatan kosinus. </p><br><img src="https://habrastorage.org/webt/n7/rp/ja/n7rpjaf-eyfsmq7mtmd6womojfw.jpeg" alt="gambar"><br><p>  Hasilnya terlihat bagus, tetapi Anda perlu memeriksa secara numerik seberapa baik model kami.  Untuk melakukan ini, kami menerapkannya pada tugas rekomendasi produk.  Untuk setiap produk, kami sarankan datang dalam ruang vektor yang dibangun.  Kami membandingkan model prod2vec dengan yang lebih sederhana, berdasarkan statistik pandangan bersama dan menambahkan item ke keranjang.  Untuk setiap produk dalam sesi, daftar 7 rekomendasi diambil.  Kombinasi dari semua produk yang direkomendasikan dalam sesi dibandingkan dengan apa yang sebenarnya ditambahkan seseorang ke keranjang.  Menggunakan prod2vec, di lebih dari 40% sesi kami merekomendasikan setidaknya satu produk, yang kemudian ditambahkan ke keranjang.  Sebagai perbandingan, algoritma yang lebih sederhana menunjukkan kualitas 34%. </p><br><p>  Deskripsi vektor yang dihasilkan memungkinkan kita tidak hanya untuk mencari yang terdekat (yang dapat dilakukan dengan model yang lebih sederhana, walaupun dengan kualitas yang lebih buruk).  Kita dapat mempertimbangkan efek samping menarik apa yang dapat ditunjukkan dengan menggunakan model kami. </p><br><h3>  Aritmatika vektor </h3><br><p>  Untuk menggambarkan bahwa vektor membawa arti sebenarnya dari barang, kita dapat mencoba menggunakan aritmatika vektor untuk mereka.  Seperti dalam contoh buku teks di word2vec (raja - pria + wanita = ratu), kita dapat misalnya bertanya pada diri sendiri produk mana yang kira-kira berjarak sama dengan printer dengan kantong debu dari penyedot debu.  Akal sehat menyatakan bahwa itu harus semacam bahan habis pakai, yaitu kartrid.  Model kami dapat menangkap pola-pola tersebut: </p><br><img src="https://habrastorage.org/webt/m1/j5/ac/m1j5aca_jsyjupowx9yapcorpmo.png" alt="gambar"><br><br><h3>  Visualisasi ruang produk </h3><br><p>  Untuk lebih memahami hasilnya, kita dapat memvisualisasikan ruang vektor barang di pesawat, mengurangi dimensi menjadi dua (dalam contoh ini, kami menggunakan t-SNE). </p><br><img src="https://habrastorage.org/webt/_d/v8/m1/_dv8m1fmgufpknn_l1klly2wqwi.png" alt="gambar"><br><br>  Terlihat jelas bahwa produk-produk terkait membentuk kluster.  Misalnya, cluster dengan tekstil untuk kamar tidur, pakaian pria dan wanita, sepatu terlihat jelas.  Sekali lagi, kami mencatat bahwa model ini dibangun hanya atas dasar sejarah interaksi pengguna dengan barang, kami tidak menggunakan kesamaan gambar atau deskripsi teks saat pelatihan. <br><p>  Dari ilustrasi ruang Anda juga dapat melihat bagaimana, menggunakan model, Anda dapat memilih aksesori untuk barang.  Untuk melakukan ini, Anda perlu mengambil barang dari cluster terdekat, misalnya, merekomendasikan barang olahraga untuk T-shirt, dan topi untuk sweater hangat. </p><br><h3>  Paket </h3><br><p>  Kami sekarang memperkenalkan model prod2vec dalam produksi untuk menghitung rekomendasi produk.  Selain itu, vektor yang diperoleh dapat digunakan sebagai fitur untuk algoritme pembelajaran mesin lainnya yang digunakan oleh tim kami (memperkirakan permintaan barang, menentukan peringkat dalam pencarian dan katalog, rekomendasi pribadi). </p><br><p>  Di masa mendatang, kami berencana untuk mengimplementasikan embeddings yang diterima di situs secara real-time.  Untuk semua barang yang dilihat, yang berikutnya akan berada di sesi, yang akan langsung tercermin dalam pengiriman yang dipersonalisasi.  Kami juga berencana untuk mengintegrasikan analisis gambar dan analisis kesamaan sesuai dengan deskripsi vektor ke dalam model kami, yang akan sangat meningkatkan kualitas vektor yang dihasilkan. </p><br><p>  Jika Anda tahu cara terbaik untuk melakukan ini (atau membuat ulang) - kunjungi untuk mengunjungi (dan bahkan pekerjaan yang lebih baik). </p><br><p>  <b>Referensi:</b> </p><br><ol><li>  Mikolov, Tomas, dkk.  "Representasi kata dan frasa yang didistribusikan serta komposisionalitasnya."  Kemajuan dalam sistem pemrosesan informasi saraf.  2013 </li><li>  Grbovic, Mihajlo, dkk.  "E-commerce di kotak masuk Anda: Rekomendasi produk pada skala."  Prosiding Konferensi Internasional ACM SIGKDD ke-21 tentang Penemuan Pengetahuan dan Penambangan Data.  ACM, 2015. </li><li>  Grbovic, Mihajlo, dan Haibin Cheng.  "Personalisasi Real-time menggunakan Peringkat Pernikahan untuk Pencarian di Airbnb."  Prosiding Konferensi Internasional ACM SIGKDD ke-24 tentang Penemuan Pengetahuan &amp; Penambangan Data.  ACM, 2018. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id432760/">https://habr.com/ru/post/id432760/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id432748/index.html">Kiat & trik Kubernetes: alokasi simpul dan banyak aplikasi web</a></li>
<li><a href="../id432750/index.html">Kegembiraan Haxe. Sebuah novel dengan bahasa pemrograman yang terabaikan</a></li>
<li><a href="../id432752/index.html">Bukit atau benteng semut? Saya sedang membangun rumah untuk harga sebuah apartemen. 3 bagian. Catu daya</a></li>
<li><a href="../id432754/index.html">Penyimpanan data In-Memory dan On-Disk akan dibawa ke publik</a></li>
<li><a href="../id432756/index.html">Kami menerapkan dukungan aksesibilitas tanpa mengubah komponen visual dari aplikasi seluler</a></li>
<li><a href="../id432762/index.html">Pendeteksi kebohongan AI dapat mendeteksi ketika seseorang berbohong</a></li>
<li><a href="../id432764/index.html">UDB. Apa ini</a></li>
<li><a href="../id432766/index.html">Cara menyandikan pesan rahasia dalam sidik jari</a></li>
<li><a href="../id432768/index.html">Headphone nirkabel untuk "serial maraton": di Dolby mereka akan ditawarkan seharga $ 599</a></li>
<li><a href="../id432770/index.html">Botnet dan tipenya: apa yang diketahui pada 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>