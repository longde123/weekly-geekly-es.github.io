<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥞 ☄️ 🕍 Équilibrage de charge Openstack (partie 2) 📡 🤰🏾 👩🏻‍🔬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans un article précédent, nous avons parlé d'essayer d'utiliser Watcher et présenté un rapport de test. Nous effectuons périodiquement de tels tests ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Équilibrage de charge Openstack (partie 2)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rostelecom/blog/465715/">  Dans un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article précédent,</a> nous avons parlé d'essayer d'utiliser Watcher et présenté un rapport de test.  Nous effectuons périodiquement de tels tests pour équilibrer et d'autres fonctions critiques d'un grand cloud d'entreprise ou d'opérateur. <br><br>  La grande complexité du problème résolu peut nécessiter plusieurs articles pour décrire notre projet.  Aujourd'hui, nous publions le deuxième article de la série sur l'équilibrage des machines virtuelles dans le cloud. <br><br><h3>  Quelques terminologies </h3><br>  VmWare a introduit l'utilitaire DRS (Distributed Resource Scheduler) pour équilibrer la charge de leur environnement de virtualisation. <br><br>  Comme l'écrit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">searchvmware.techtarget.com/definition/VMware-DRS</a> <br>  <i>«VMware DRS (Distributed Resource Scheduler) est un utilitaire qui équilibre la charge de calcul avec les ressources disponibles dans un environnement virtuel.</i>  <i>L'utilitaire fait partie d'un package de virtualisation appelé VMware Infrastructure.</i> <i><br><br></i>  <i>À l'aide de VMware DRS, les utilisateurs définissent les règles de distribution des ressources physiques entre les machines virtuelles (VM).</i>  <i>L'utilitaire peut être configuré pour un contrôle manuel ou automatique.</i>  <i>Les pools de ressources VMware peuvent être facilement ajoutés, supprimés ou réorganisés.</i>  <i>Si vous le souhaitez, les pools de ressources peuvent être isolés entre différentes unités commerciales.</i>  <i>Si la charge de travail d'une ou plusieurs machines virtuelles change considérablement, VMware DRS redistribue les machines virtuelles entre les serveurs physiques.</i>  <i>Si la charge de travail globale est réduite, certains serveurs physiques peuvent être temporairement hors service et la charge de travail consolidée. »</i> <br><br><h3>  Pourquoi ai-je besoin d'équilibrage? </h3><br><a name="habracut"></a><br>  À notre avis, le DRS est une caractéristique indispensable du cloud, bien que cela ne signifie pas que le DRS doit être utilisé toujours et partout.  Selon le but et les besoins du cloud, il peut y avoir des exigences différentes pour le DRS et les méthodes d'équilibrage.  Il y a peut-être des situations où l'équilibre n'est pas du tout nécessaire.  Ou même dangereux. <br><br>  Pour mieux comprendre où et pour quels clients DRS sont nécessaires, tenez compte de leurs buts et objectifs.  Les nuages ​​peuvent être divisés en publics et privés.  Voici les principales différences entre ces nuages ​​et les objectifs des clients. <br><br><div class="scrollable-table"><table><tbody><tr><td></td><td>  Clouds privés / grandes entreprises </td><td>  Clouds publics / petites et moyennes entreprises, personnes </td></tr><tr><td>  Les principaux critères et objectifs de l'opérateur </td><td>  Fournir un service ou un produit fiable </td><td>  Réduire le coût des services dans la lutte dans un marché concurrentiel </td></tr><tr><td>  Exigences de service </td><td>  Fiabilité à tous les niveaux et dans tous les éléments du système <br><br>  Performance garantie <br><br>  Hiérarchisation des machines virtuelles en plusieurs catégories <br><br>  Sécurité des informations et des données physiques <br><br>  SLA et support 24/7 </td><td>  Facilité de service maximale <br><br>  Services relativement simples <br><br>  La responsabilité des données incombe au client <br><br>  Priorité VM non requise <br><br>  Sécurité de l'information au niveau des services standards, responsabilité du client <br><br>  Il peut y avoir des échecs <br><br>  Pas de SLA, qualité non garantie <br><br>  Support par mail <br><br>  La sauvegarde est facultative </td></tr><tr><td>  Caractéristiques du client </td><td>  Une très large gamme d'applications. <br><br>  Applications héritées héritées de l'entreprise. <br><br>  Architectures personnalisées sophistiquées pour chaque client. <br><br>  Règles d'affinité. <br><br>  Le logiciel fonctionne sans s'arrêter en mode 7x24. <br><br>  Outils de sauvegarde à la volée. <br><br>  Charge cyclique prévisible du client. </td><td> Applications typiques - équilibrage réseau, Apache, WEB, VPN, SQL <br><br>  Il est possible d'arrêter l'application pendant un certain temps <br><br>  La distribution arbitraire de VM dans le cloud est autorisée <br><br>  Sauvegarde client <br><br>  Prévisible pour un grand nombre de clients, une charge moyennée statistiquement. </td></tr><tr><td>  Implications pour l'architecture </td><td>  Géoclustering <br><br>  Stockage centralisé ou distribué <br><br>  IBS réservé </td><td>  Stockage local de données sur des nœuds de calcul </td></tr><tr><td>  Équilibrer les objectifs </td><td>  Répartition uniforme de la charge <br><br>  Réactivité maximale de l'application <br><br>  Temps de retard d'équilibrage minimum <br><br>  Équilibrer uniquement lorsque cela est clairement nécessaire <br><br>  Conclusion d'un équipement pour maintenance préventive </td><td>  Réduire le coût des services et les coûts d'opérateur <br><br>  Désactiver certaines ressources en cas de faible charge <br><br>  Économie d'énergie <br><br>  Coûts de personnel réduits </td></tr></tbody></table></div><br><br><h3>  Nous tirons les conclusions suivantes pour nous-mêmes: </h3><br>  <b>Pour les clouds privés</b> fournis aux grandes entreprises, le DRS peut être appliqué sous réserve de restrictions: <br><br><ul><li>  les règles de sécurité de l'information et d'affinité comptable pour l'équilibrage; </li><li>  la disponibilité d'une quantité suffisante de ressources en cas d'accident; </li><li>  les données de la machine virtuelle résident sur un système de stockage centralisé ou distribué; </li><li>  diversité temporelle des procédures d'administration, de sauvegarde et d'équilibrage; </li><li>  équilibrage uniquement dans l'ensemble des hôtes clients; </li><li>  équilibrer uniquement avec un fort déséquilibre, la migration la plus efficace et la plus sûre des machines virtuelles (après tout, la migration peut échouer); </li><li>  équilibrer des machines virtuelles relativement «silencieuses» (la migration de machines virtuelles «bruyantes» peut prendre très longtemps); </li><li>  équilibrage en tenant compte du «coût» - la charge sur le système de stockage et le réseau (avec des architectures personnalisées pour les gros clients); </li><li>  équilibrage en tenant compte du comportement individuel de chaque VM; </li><li>  l'équilibrage est souhaitable après les heures (nuit, week-end, vacances). </li></ul><br>  <b>Pour les clouds publics</b> qui fournissent des services aux petits clients, le DRS peut être utilisé beaucoup plus souvent, avec des fonctionnalités avancées: <br><br><ul><li>  absence de restrictions de sécurité de l'information et de règles d'affinité; </li><li>  équilibrage dans le cloud; </li><li>  équilibrer à tout moment raisonnable; </li><li>  équilibrer n'importe quelle machine virtuelle; </li><li>  équilibrer les machines virtuelles «bruyantes» (pour ne pas interférer avec le reste); </li><li>  les données de la machine virtuelle se trouvent souvent sur des disques locaux; </li><li>  prise en compte des performances moyennes de stockage et de réseau (l'architecture cloud est unifiée); </li><li>  équilibrage selon des règles généralisées et des statistiques disponibles sur le comportement du centre de données. </li></ul><br><h2>  Complexité du problème </h2><br>  La difficulté d'équilibrer est que le DRS doit fonctionner avec beaucoup de facteurs incertains: <br><br><ul><li>  comportement des utilisateurs de chacun des systèmes d'information client; </li><li>  algorithmes pour le fonctionnement des serveurs de systèmes d'information; </li><li>  Comportement du serveur SGBD </li><li>  charge sur les ressources informatiques, le stockage, le réseau; </li><li>  l'interaction des serveurs entre eux dans la lutte pour les ressources cloud. </li></ul><br>  La charge d'un grand nombre de serveurs d'applications virtuelles et de bases de données sur les ressources cloud se produit au fil du temps, les conséquences peuvent se produire et se chevaucher avec des effets imprévisibles après des temps imprévisibles.  Même pour contrôler des processus relativement simples (par exemple, pour contrôler un moteur, un système de chauffage de l'eau à la maison), les systèmes de contrôle automatique doivent utiliser des algorithmes de rétroaction de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">différenciation proportionnelle-intégrale</a> complexes. <br><br><img src="https://habrastorage.org/webt/82/5j/7x/825j7x1s3unwoacrnswrm4j9r_m.png"><br><br>  Notre tâche est beaucoup plus compliquée, et il existe un risque que le système ne puisse pas équilibrer la charge aux valeurs établies dans un délai raisonnable, même si les influences externes des utilisateurs ne se produisent pas. <br><br><img src="https://habrastorage.org/webt/4c/b9/a7/4cb9a70sso1h2dz_tlb4gzzuegg.gif"><br><br><h2>  Histoire de nos développements </h2><br>  Pour résoudre ce problème, nous avons décidé de ne pas repartir de zéro, mais de tirer parti de l'expérience existante et avons commencé à interagir avec des spécialistes qui ont de l'expérience dans ce domaine.  Heureusement, notre compréhension des problèmes coïncidait complètement. <br><br><h3>  Étape 1 </h3><br>  Nous avons utilisé un système basé sur la technologie des réseaux de neurones et avons essayé d'optimiser nos ressources sur cette base. <br><br>  L'intérêt de cette étape était de tester la nouvelle technologie, et son importance était d'appliquer une approche non standard pour résoudre le problème où, toutes choses étant égales par ailleurs, les approches standard se sont pratiquement épuisées. <br><br>  Nous avons démarré le système et nous sommes vraiment allés en équilibre.  L'ampleur de notre cloud ne nous a pas permis d'obtenir des résultats optimistes annoncés par les développeurs, mais il était clair que l'équilibrage fonctionnait. <br><br>  De plus, nous avions des limitations assez sérieuses: <br><br><ul><li>  Pour former un réseau neuronal, les machines virtuelles doivent fonctionner sans changements importants pendant des semaines ou des mois. </li><li>  L'algorithme est conçu pour une optimisation basée sur l'analyse de données "historiques" antérieures. </li><li>  Pour former un réseau de neurones, une quantité suffisante de données et de ressources informatiques est nécessaire. </li><li>  L'optimisation et l'équilibrage peuvent être effectués relativement rarement - une fois toutes les quelques heures, ce qui n'est clairement pas suffisant. </li></ul><br><h3>  Étape 2 </h3><br>  Comme nous n'étions pas satisfaits de la situation, nous avons décidé de modifier le système, et pour cela de répondre à la <b>question principale</b> - pour qui le faisons-nous? <br><br>  D'abord pour les entreprises.  Nous avons donc besoin d'un système qui fonctionne efficacement, avec ces restrictions d'entreprise qui ne font que simplifier la mise en œuvre. <br><br>  <b>La deuxième question</b> est de <b>savoir</b> ce que signifie le mot «opérationnel»?  À la suite d'un court débat, nous avons décidé qu'il était possible de s'appuyer sur le temps de réponse de 5 à 10 minutes pour que les sauts à court terme n'introduisent pas le système en résonance. <br><br>  <b>La troisième question</b> est quelle taille du nombre équilibré de serveurs choisir? <br>  Cette question a été décidée d'elle-même.  En règle générale, les clients ne rendent pas les agrégats de serveurs très volumineux, ce qui est conforme aux recommandations de l'article pour limiter les agrégats à 30 à 40 serveurs. <br><br>  De plus, en segmentant le pool de serveurs, nous simplifions la tâche de l'algorithme d'équilibrage. <br><br>  <b>La quatrième question</b> est de savoir à quel point un réseau de neurones nous convient avec son long processus d'apprentissage et son équilibre rare?  Nous avons décidé de l'abandonner au profit d'algorithmes opérationnels plus simples afin d'obtenir le résultat en quelques secondes. <br><br><img src="https://habrastorage.org/webt/-9/vj/wy/-9vjwyj2x4a__iiszz7l9clhopq.png"><br><br>  Une description du système utilisant de tels algorithmes et de ses défauts peut être trouvée <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici.</a> <br><br>  Nous avons implémenté et lancé ce système et obtenu des résultats encourageants.Il analyse désormais régulièrement la charge du cloud et donne des recommandations sur le déplacement des machines virtuelles, qui sont largement correctes.  Même maintenant, il est clair que nous pouvons obtenir une libération de 10 à 15% des ressources pour les nouvelles machines virtuelles avec une amélioration de la qualité des machines existantes. <br><br> <a href=""><img src="https://habrastorage.org/webt/ie/ky/wa/iekywainupnidp_73j55hc1dbnw.png"></a> <br><br>  Lorsqu'un déséquilibre est détecté par la RAM ou le CPU, le système donne des commandes au planificateur Tionics pour effectuer une migration en direct des machines virtuelles requises.  Comme le montre le système de surveillance, la machine virtuelle est passée d'un hôte (supérieur) à un autre (inférieur) et a libéré de la mémoire sur l'hôte supérieur (surligné en cercles jaunes), l'occupant respectivement sur l'hôte inférieur (surligné en cercles blancs). <br><br>  Maintenant, nous essayons d'évaluer plus précisément l'efficacité de l'algorithme actuel et essayons de trouver d'éventuelles erreurs dans celui-ci. <br><br><h3>  Étape 3 </h3><br>  Il semblerait que vous puissiez vous calmer là-dessus, attendre une efficacité prouvée et clore le sujet. <br>  Mais les opportunités d'optimisation évidentes suivantes nous poussent à mener une nouvelle phase. <br><br><ol><li>  Les statistiques, par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici,</a> montrent que les performances des systèmes à deux et à quatre processeurs sont nettement inférieures à celles des monoprocesseurs.  Cela signifie que tous les utilisateurs reçoivent des rendements nettement inférieurs des CPU, RAM, SSD, LAN, FC achetés dans des systèmes multiprocesseurs par rapport à ceux à processeur unique. </li><li>  Les planificateurs de ressources eux-mêmes peuvent travailler avec de graves erreurs, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">voici l'un des articles</a> sur ce sujet. </li><li>  Les technologies offertes par Intel et AMD pour surveiller la RAM et le cache permettent d'étudier le comportement des machines virtuelles et de les placer de telle manière que les voisins bruyants n'interfèrent pas avec les machines virtuelles silencieuses. </li><li>  Extension de l'ensemble des paramètres (réseau, stockage, priorité de la machine virtuelle, coût de la migration, sa préparation à la migration). </li></ol><br><h2>  Total </h2><br>  Le résultat de nos travaux sur l'amélioration des algorithmes d'équilibrage a permis de conclure sans ambiguïté qu'en raison des algorithmes modernes, il est possible d'obtenir une optimisation significative des ressources (25-30%) des centres de données et d'améliorer la qualité du service client. <br><br>  L'algorithme basé sur les réseaux de neurones est, bien sûr, une solution intéressante qui a besoin d'être développée, et en raison des restrictions existantes, il ne convient pas pour résoudre de tels problèmes sur des volumes caractéristiques des nuages ​​privés.  Dans le même temps, dans des clouds publics de taille significative, l'algorithme a montré de bons résultats. <br><br>  Nous vous en dirons plus sur les capacités des processeurs, des planificateurs et de l'équilibrage de haut niveau dans les articles suivants. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr465715/">https://habr.com/ru/post/fr465715/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr465691/index.html">Utilisation de REST dans ENM Ericsson en Python</a></li>
<li><a href="../fr465703/index.html">Comment obtenir des revenus supplémentaires pour l'entreprise en utilisant l'échange: investissement dans des produits structurels</a></li>
<li><a href="../fr465709/index.html">JustCode - un navigateur haute vitesse pour les ordinateurs et tablettes économiques sous Windows</a></li>
<li><a href="../fr465711/index.html">Comment le RGPD a provoqué des fuites de données personnelles</a></li>
<li><a href="../fr465713/index.html">À lire au chef de projet: livres sur la gestion du personnel, les compétences générales et les DevOps</a></li>
<li><a href="../fr465719/index.html">Pourquoi les notifications PUSH ne reçoivent pas dans le client VoIP 3CX pour Android</a></li>
<li><a href="../fr465721/index.html">Système aérospatial entièrement réutilisable à partir des technologies existantes</a></li>
<li><a href="../fr465723/index.html">Posit-arithmétique: vaincre un point flottant dans son propre champ. Partie 1</a></li>
<li><a href="../fr465725/index.html">Formation Cisco 200-125 CCNA v3.0. Jour 28. Étude approfondie du LCA</a></li>
<li><a href="../fr465727/index.html">Devenez un programmeur Zuckerberg ou enfance</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>