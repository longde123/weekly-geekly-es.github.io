<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÖüèø üßëüèª üë©üèª‚Äçüé§ Chaque temps est bon: un indicateur m√©t√©o qui cosplay üèÖ üë©üèº‚Äç‚úàÔ∏è üôâ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Imaginons qu'apr√®s une escarmouche avec Dave Bowman, les vestiges de l'intelligence jadis puissante de HAL 9000 aient suffi √† ramener Discovery One su...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Chaque temps est bon: un indicateur m√©t√©o qui cosplay</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/399409/"><img src="https://habrastorage.org/files/4ce/918/71b/4ce91871b01040ecb8a968131e3c4f32.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imaginons qu'apr√®s une escarmouche avec Dave Bowman, les vestiges de l'intelligence jadis puissante de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL 9000 aient</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suffi √† ramener Discovery One sur Terre et, sous le slogan ¬´la mort √† tous les peuples¬ª, √† l'√©craser sur la plan√®te, afin qu'il ne soit plus mauvais de le faire avec les ordinateurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le cataclysme qui a √©clat√©, bien s√ªr, a d√©truit toute l'humanit√© rationnelle, et seuls des individus comme moi sont rest√©s, avec un marteau dans une main et un Arduino dans l'autre. Par cons√©quent, il n'est pas surprenant que l'appareil myst√©rieux trouv√© par les restes encore myst√©rieux du vaisseau spatial trouv√© dans la montagne ne puisse √™tre utilis√© que dans une station m√©t√©orologique. Eh bien, √† juste titre!</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous rejetons la romance, alors la dure v√©rit√© de la vie √©tait que le c√©l√®bre ITEAD a offert l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©cran Nextion HMI NX4832T035 pour les tests</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âtant donn√© que les produits Nextion ont √©t√© d√©crits √† plusieurs reprises ici, il est concis sur ses capacit√©s. Il s'agit d'un √©cran avec sa propre API simple et son √©cran tactile pour cr√©er des unit√©s de contr√¥le avec des menus graphiques sans trop de tracas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä cet effet, Nextion dispose d'un syst√®me de commande simple pour afficher des images (et leurs parties), des √©l√©ments de texte, des champs de saisie, des graphiques. De plus, il existe une sorte de langage de script pour effectuer des actions, par exemple, en appuyant sur les boutons √† l'√©cran ou par minuterie. Et en m√™me temps, un port pour recevoir des commandes externes de microcontr√¥leurs ou similaires et renvoyer des donn√©es sur le toucher de l'√©cran pour savoir quels boutons les mains ludiques du propri√©taire sont arriv√©s et dans quel √©tat ce bouton est (press√©, rel√¢ch√©) pour le moment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En gros, il n'est pas n√©cessaire de souffrir et de collecter des tableaux de points ou de connecter un nuage de toutes sortes de biblioth√®ques. Une ligne - et l'arri√®re-plan a chang√© √† l'√©cran. Cliqu√© - un menu s'ouvre. Nous avons connect√© Arduino - nous construisons des graphiques en fonction des donn√©es re√ßues via le port s√©rie.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autrement dit, √† en juger par la description, l'√©cran est si intelligent qu'il peut montrer et r√©pondre (il y a un √©cran tactile) √† tout. Mais je n'ai rien chez moi, mais les donn√©es climatiques volent p√©riodiquement dans l'air. √Ä partir du m√™me </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BDS-M</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , par exemple, ou du capteur m√©t√©o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PI-TV-2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, tous sont finalement transf√©r√©s vers </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">People‚Äôs Monitoring</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , d'o√π j'ai la chance de les regarder via un navigateur ou une application sur mon smartphone. Mais je n'ai pas pu r√©sister √† l'id√©e de faire "une autre station m√©t√©o sur l'Arduino". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et, pour √™tre honn√™te, ce n'√©tait pas tant une question de technologie en tant que telle, mais du fait que j'√©tais obstin√©ment attir√© par la conception d'interfaces. Probablement, il tire avec la m√™me force avec laquelle il tire pour chanter tous ceux √† qui l'ours a march√© sur son oreille.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par cons√©quent, je m'excuse imm√©diatement pour le fait qu'il y aura encore moins d'√©quipement et plus de fantasmes fantastiques. </font><font style="vertical-align: inherit;">Mais d'abord, une petite d√©monstration du produit fini, selon laquelle vous pouvez d√©cider, lire ou passer au mat√©riau suivant.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/8A02d27uJ9U" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, j'avais 3,5 pouces, 480x320 pixels, ce qui semblait une API assez simple et sept param√®tres qui devaient √™tre affich√©s (entre parenth√®ses, les capteurs y sont attach√©s): </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) La temp√©rature √† l'int√©rieur et √† l'ext√©rieur (BMP085 / DHT22) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) L'humidit√© √† l'int√©rieur et ext√©rieur (DHT22 / DHT22) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4) Pression atmosph√©rique (BMP085) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5) La concentration de gaz peu utiles dans la pi√®ce, en particulier le CO2 (MQ135) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6) La concentration de </font><font style="vertical-align: inherit;">solides </font><font style="vertical-align: inherit;">dans l'air ambiant, en particulier les PM2,5 (Sharp GP2Y1010AU0F)</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il convient de noter ici que les camarades qui se sont familiaris√©s avec les caract√©ristiques des deux derniers capteurs concluent que la meilleure r√©ponse est obtenue uniquement dans le domaine du CO2 et des PM2,5, respectivement. En fait, cela explique mon choix: ce n'est pas dommage de d√©penser deux sous et de voir ce qui se passe, alors que les capteurs sp√©cialis√©s sont beaucoup plus chers et en cas d'√©chec, le crapaud a toujours quelque chose √† montrer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est clair que je ne m'attendais pas √† beaucoup de pr√©cision de la part de capteurs bon march√© - je m'attendais plut√¥t √† corr√©ler mes propres sentiments avec leurs lectures. Et, au fait, tout est assez √©vident: cela vaut la peine de fermer la fen√™tre, car en m√™me temps que la temp√©rature et la congestion augmentent, les valeurs de concentration de gaz du MQ135 commencent √† grimper.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, aux param√®tres. Il m'a sembl√© ennuyeux de ne montrer que sept chiffres, par cons√©quent, la t√¢che technique de l'appareil s'est √©tendue: j'ai trouv√© pour chaque param√®tre un graphique des changements dans le temps. Et de sorte que sur un √©cran, il √©tait possible de visualiser jusqu'√† quatre courbes en m√™me temps pour la perception visuelle des motifs (s'il y en a) dans les changements de divers indicateurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un lecteur attentif et propri√©taire de tout appareil portable d'une diagonale de 3,5 pouces ou plus, dira probablement qu'il n'y a rien de compliqu√© √† ce sujet. Par exemple, sur un tel √©cran et plus de donn√©es s'adapteront facilement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais il y a une astuce: pour un appareil √©lectrom√©nager, les chiffres et les signatures doivent √™tre aussi grands que possible afin qu'ils n'aient pas √† regarder l'√©cran longtemps dans une loupe, essayant de percer l'esprit de l'esprit du cr√©ateur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, je voulais l'interface la plus large et pas trop encombr√©e, dont la logique pouvait se comprendre sans un enseignement sup√©rieur. </font><font style="vertical-align: inherit;">Ayant une telle image dans ma t√™te, je l'ai transf√©r√©e vers l'√©diteur Nextion et j'ai obtenu deux principaux types d'√©cran. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âcran principal avec lectures actuelles des capteurs:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/5d2/51b/d5c/5d251bd5c5614232b44b219ff0bde021.jpg"></div><br>
<img src="https://habrastorage.org/files/c85/8f5/487/c858f548742546128af66272d59c3775.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus des lectures r√©elles, vous pouvez √©galement voir une indication de la tendance du changement (haut / bas) et des marqueurs des param√®tres s√©lectionn√©s pour l'affichage sur le graphique. </font><font style="vertical-align: inherit;">Les quadrangles translucides sont les zones sensorielles invisibles dans l'≈ìuvre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âcran avec graphiques. </font><font style="vertical-align: inherit;">En fait, il y en a quatre √† afficher d'un √† quatre graphiques, mais en fait ils sont tous identiques. </font><font style="vertical-align: inherit;">Par exemple, un √©cran avec un et quatre graphiques:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/f68/cbf/014/f68cbf01497145c2a70f830c67c203d2.jpg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/355/835/edf/355835edf53d4e4fbbed68c1d8a3b56d.jpg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/09c/940/2a5/09c9402a56164373aadbf7e5a22e85e4.JPG"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, pour chaque param√®tre, son maximum et son minimum sont √©galement affich√©s afin de comprendre les limites. Mais il n'y a pas de chronologie: premi√®rement, l'appareil n'a pas d'horloge, et deuxi√®mement, il n'y a tout simplement pas de place pour la balance. Au moins, je n'ai pas trouv√© o√π le joindre, √©tant donn√© que je voulais montrer un maximum de quatre graphiques. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, le code pr√©voit l'ajout des indicateurs obtenus √† l'archive toutes les demi-heures avec une profondeur d'archivage totale de 48 valeurs, c'est-√†-dire pendant environ une journ√©e. Approximativement - parce que les donn√©es sont transmises via le canal radio 433 MHz, qui n'est pas prot√©g√© contre les interf√©rences, des √©carts sont donc possibles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et dans le cas de ces √©carts, la dur√©e de vie des capteurs est √©galement pr√©vue dans la m√™me demi-heure. Et s'il n'y a pas eu de r√©ception de donn√©es dans une demi-heure, les relev√©s du capteur ne sont pas affich√©s et ne sont pas entr√©s dans l'archive.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les tendances des indicateurs sont calcul√©es </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par le premier algorithme qui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rencontre les six derniers points de l'histoire, √† savoir selon les six derni√®res indications. Et puisque les lectures sont faites √† intervalles d'une demi-heure, il s'av√®re que la tendance refl√®te les changements au cours des trois derni√®res heures. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme tout designer, je devais "jouer avec les polices". En train de dessiner les options, il s'est av√©r√© que ma sym√©trie pr√©f√©r√©e a √©t√© forc√©e d'√™tre bris√©e non seulement par la combinaison d'indicateurs d'humidit√© dans le coin sup√©rieur droit, mais aussi par un ph√©nom√®ne beaucoup plus d√©cevant sous la forme de temp√©ratures n√©gatives.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä savoir, les inconv√©nients ont g√¢ch√© toute l'image. J'ai donc agi √† ma fa√ßon: mettre un moins sur la valeur. Pour les math√©maticiens, cela, bien s√ªr, semblera √™tre une solution barbare, et les personnes impliqu√©es, bien s√ªr, tressailliront involontairement, r√©fl√©chissant aux raisons pour lesquelles les stations m√©t√©orologiques devraient √™tre modulo-√©valu√©es. Mais √ßa s'est bien pass√© et les chiffres ne dansent pas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La logique de l'interface est la suivante. Le principal mode de fonctionnement est le mode veille avec une luminosit√© de l'√©cran de 15% de la valeur nominale et une mise √† jour r√©guli√®re des relev√©s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Touchez n'importe o√π - allez en ligne avec une luminosit√© de 100%. Apr√®s cela, en cliquant sur les lectures, s√©lectionnez-les pour un affichage ult√©rieur sur le graphique, et en cliquant sur le "≈ìil" HAL passe √† l'√©cran avec des graphiques.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a exactement cinq secondes pour cela. </font><font style="vertical-align: inherit;">Ensuite, les marques sont effac√©es et apr√®s cinq autres minutes d'inactivit√©, l'appareil repasse en mode veille. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur l'√©cran du graphique, la partie gauche est un pas en arri√®re (l'√©cran principal ou l'√©cran avec les graphiques), et la partie droite est une augmentation du graphique s√©lectionn√© en plein √©cran ou, encore une fois, allez √† l'√©cran principal s'il y a un graphique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il m'a sembl√© que ce sch√©ma est assez simple pour ne pas ajouter de boutons suppl√©mentaires, ce que je ne veux pas vraiment voir ici. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soit dit en passant, les images d'arri√®re-plan peuvent √™tre modifi√©es si vous le souhaitez. </font><font style="vertical-align: inherit;">J'ai m√™me pr√©par√© quelques options suppl√©mentaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les colons:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/7f5/ca7/c80/7f5ca7c80d444ade864e1213b7a85e60.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les hobbits:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/941/05e/ed4/94105eed4f554e5286788bfeab3df7c6.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les romantiques:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/aed/804/3da/aed8043da8794986a150611ef7e21b6c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les amateurs de caf√©:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/6d4/0be/56f/6d40be56f89445c1aca705da660063ae.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans son concept, l'ensemble de l'appareil n'est pas tant une station m√©t√©o qu'un √©cran sans fil sp√©cialis√©. Par cons√©quent, la conception est extr√™mement simple: seuls l'√©cran, l'Arduino Pro Mini et le r√©cepteur 433 MHz avec modulation d'amplitude sont √† l'int√©rieur. Il n'y a aucune fonctionnalit√© dans l'assemblage: l'√©cran est pour l'alimentation et le port s√©rie, le r√©cepteur est pour l'alimentation et la broche 2 du contr√¥leur. Et, outre le besoin de capteurs externes compatibles - c'est tout. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour comprendre la simplicit√©, je montre une des options de logement avec un remplissage presque install√©: </font></font><br>
<br>
<img src="https://habrastorage.org/files/700/2b8/086/7002b80861af43d5a87296066f825fb3.JPG"><br>
<br>
<img src="https://habrastorage.org/files/41d/4a0/ec6/41d4a0ec62ea4d57b458d40625b8a966.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, je n'insiste pas sur une telle configuration, mais dans mon cas, elle √©tait optimale √† la fois en termes de p√©nibilit√© et de compatibilit√© avec d'autres composants de la domotique.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, la s√©paration de l'√©cran et des capteurs vous permet de placer ce m√™me √©cran √† l'endroit le plus pratique - comme, en fait, n'importe quelle station m√©t√©o avec des capteurs externes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, pour que tout cela fonctionne et ne provoque pas l'horreur des animaux √† la vue de blocs de fils, d'un tas de capteurs et de microcontr√¥leurs suspendus dans l'air, vous devez comprendre les cas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La dure v√©rit√© de la vie √©tait que la bo√Æte o√π BDS-M avait v√©cu jusqu'√† pr√©sent n'√©tait pas en mesure d'accueillir trois capteurs suppl√©mentaires. Par cons√©quent, j'ai donn√© libre cours √† mes sentiments et j'ai imprim√© une superbe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lampe de Markellov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Du point de vue du capteur m√©t√©o, il est id√©al, car il est souffl√© par tous les vents et cache en m√™me temps efficacement et efficacement le d√©sordre √† l'int√©rieur. Apr√®s de tels m√©tamorphes, BDS-M a cess√© d'exister: maintenant il est glamour (si vous ne vous en approchez pas) Multisensor: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Shell: </font></font><br>
<br>
<img src="https://habrastorage.org/files/a8b/afb/02d/a8bafb02d48a400fa5c15fd021572114.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assembl√© et en place: </font></font><br>
<br>
<img src="https://habrastorage.org/files/65e/4be/cf8/65e4becf853f44a786b39e7e741d38ae.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'est av√©r√© plus difficile avec l'unit√© d'affichage. En g√©n√©ral, je voulais le voir plut√¥t massif et brutal. Eh bien, bien s√ªr, comme si l'aborig√®ne qui avait trouv√© une partie du vaisseau spatial l'avait encadr√©e dans la pierre. Par cons√©quent, le cadre, dont le mod√®le √©tait d√©j√† propos√© dans Nextion, ne correspondait en aucune fa√ßon. Premi√®rement, c'√©tait effrayant, et deuxi√®mement, l'affichage √©tait dans une niche l√†-bas, ce qui ne me convenait absolument pas - je voulais rincer la surface.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai quand m√™me commenc√© de toute fa√ßon avec du plastique - juste pour casser la forme. Les options interm√©diaires ressemblaient √† ceci: </font></font><br>
<br>
<img src="https://habrastorage.org/files/688/8ba/7e5/6888ba7e5fb04821813a4f0cc8028b75.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, j'ai bien aim√© (j'ai d√©cid√© de ne pas remarquer un peu de m√©contentement), mais le poids, bien s√ªr, est assez ridicule, pas de pierre. Par cons√©quent, l'un des b√¢timents utilis√© comme coffrage interne pour la fabrication de "ossature" en b√©ton. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le processus m'a profond√©ment choqu√© - j'ai rarement apport√© autant de salet√© √† la maison. Le r√©sultat est le m√™me. Bien que, par endroits, il se soit av√©r√© ne rien √™tre, il s'est av√©r√© que le m√©lange de r√©paration renforc√© n'√©tait pas tr√®s appropri√© pour de tels produits.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peut-√™tre que le b√©ton de sable pur serait id√©al, mais √† ce moment-l√†, j'√©tais d√©j√† d√©√ßu de mes propres comp√©tences en construction et je suis parti comme mon coll√®gue. Et lui, apr√®s avoir r√©fl√©chi un peu, a dit qu'il avait le bonheur dans sa vie de travailler avec de la peinture en a√©rosol sous la pierre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bingo, je me suis dit, et j'ai imm√©diatement commenc√© √† fouiller les d√©tails. Apr√®s tout, imprimer un bo√Ætier et le peindre est beaucoup plus esth√©tique que de transformer une maison en un chantier de construction en taille r√©elle. En g√©n√©ral, la peinture √©tait inhumainement ch√®re, mais tr√®s cool (pour les int√©ress√©s - Rust-Oleum American Accents Stone). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cours de route, j'ai √©galement conclu que je n'aimais pas le corps avec quelque chose (tr√®s probablement, avec des cadres √©pais sur tout le p√©rim√®tre), alors je me suis ressaisi et, apr√®s un interrogatoire avec une d√©pendance, j'ai pris une forme apparemment d√©finitive. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'√©tait: </font></font><br>
<br>
<img src="https://habrastorage.org/files/ff2/ef2/20a/ff2ef220a1534983a766a1a8367e0224.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est devenu:</font></font><br>
<br>
<img src="https://habrastorage.org/files/dfa/fd7/496/dfafd749673e4d5fa288916efc429e6a.JPG"><br>
<br>
<img src="https://habrastorage.org/files/f7b/341/41a/f7b34141a71f4b88a2f412087c6f1b7e.JPG"><br>
<br>
<img src="https://habrastorage.org/files/4e3/882/4dc/4e38824dcdb54b879398271bd16834a6.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est facile de voir qu'il n'y a aucune trace de massivit√©, mais pour une raison quelconque, cette forme me pla√Æt le plus. Je m'y attarderai. Au revoir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La vue, bien s√ªr, est un amateur, car certains abats de l'√©cran (la m√™me boucle de l'√©cran tactile) sont en vue, et rien ne peut √™tre fait avec cela de mani√®re raisonnable. D√©raisonnable, √† mon avis, - superpositions, peinture, rubans adh√©sifs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et depuis que j'ai imprim√© avec du plastique transparent, la nuit dans l'espace g√©n√©ral:</font></font><br>
<br>
<img src="https://habrastorage.org/files/c7e/c9f/222/c7ec9f222f2745d2bf3213d045ffd4d8.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, √† propos de, disons, les nuances du design. Je vais peut-√™tre partir du m√™me b√¢timent. Le d√©sir de beaut√© a jou√© une mauvaise blague: comme je voulais que l'√©cran affleure la surface, la d√©coupe a fait autant que possible correspondre aux dimensions ext√©rieures de l'√©cran. Et apr√®s environ une douzaine de raccords, il a fait son travail - soit rompu le c√¢ble de l'√©cran tactile, soit rompu le contact avec la carte, mais maintenant, il est tr√®s difficile de faire fonctionner le capteur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par cons√©quent, je ne peux probablement pas recommander une telle conception. Eh bien, ou je le recommande, mais gardez √† l'esprit que c'est l'un des moyens les plus simples et les plus beaux (oui, je me flatte effront√©ment) de briser l'√©cran. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, je devais passer en revue plusieurs fonctionnalit√©s de l‚Äô√©cran lui-m√™me, dont je peux personnellement d√©crire la description comme ¬´vous ne pouvez pas simplement le prendre et ...¬ª.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, on ne peut pas simplement prendre et afficher n'importe quelle police. C'est, th√©oriquement - oui. N'importe quelle police Windows peut √™tre t√©l√©charg√©e dans le convertisseur int√©gr√© √† l'environnement de Nextion et la sortie sera un raster plut√¥t costaud qui ne sera pas le meilleur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, comparez la police convertie avec l'original:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/fbd/832/99d/fbd83299db274e43bfab9f7e5ffc5adf.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par cons√©quent, j'ai d√ª suivre la voie morne. A savoir - pour composer des nombres et des signatures √† partir d'√©l√©ments graphiques pr√©alablement pr√©par√©s dans GIMP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puis je suis tomb√© sur les graphiques. Il s'est av√©r√© que vous ne pouvez pas simplement prendre et alimenter un ensemble de donn√©es arbitraires vers l'√©l√©ment Waveform destin√© √† dessiner des courbes. Tout d'abord, vous devez tout mettre au format requis - de 0 √† 255 et terminer les points interm√©diaires, s'il y a moins que la largeur de l'√©cran. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, j'ai d√©couvert que ce n'√©tait pas tout. Il s'av√®re que 255 points logiques ne sont pas mis √† l'√©chelle par l'affichage lorsque la hauteur de l'√©l√©ment de graphique Waveform change. Par cons√©quent, lorsque vous modifiez la hauteur de l'√©l√©ment de graphique Waveform, il est n√©cessaire de modifier proportionnellement l'√©chelle des valeurs, sinon le graphique sera "coup√©".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, vous ne pouvez pas utiliser d'images avec un arri√®re-plan transparent, ce qui a quelque peu limit√© la largeur utile des champs d'information - de sorte qu'il n'y a pas de chevauchement laid dans la zone de d√©grad√© de l'image d'arri√®re-plan. √Ä mon avis, le forum Nextion en a discut√© et il semble que ITEAD a promis d'ajouter la possibilit√© de travailler avec des images transparentes, mais ne l'a pas encore fait. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela, comme mon tourment avec la commutation de la vitesse du port (qui est n√©cessaire pour dessiner rapidement des graphiques), sans aucun doute, semblera ridicule aux camarades exp√©riment√©s. Cependant, je ne peux pas rester silencieux - j'ai d√©pens√© d√©cemment les forces √† vaincre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais dans l'ensemble, je me sens comme un gagnant. Ce que je voulais - je l'ai fait, et la collection d'appareils √©lectrom√©nagers a √©t√© reconstitu√©e avec une autre. De plus, ce n'est pas tout √† fait inutile: il est pratique de voir imm√©diatement ce que les capteurs domestiques montrent sans atteindre un smartphone et sans allumer un ordinateur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, cette chose ne d√©pend pas d'Internet et dans ce contexte, elle ressemble √† un appareil anti-IoT, car elle stocke tout en soi. </font><font style="vertical-align: inherit;">Et puis j'imagine, comme si un pirate avec un sens de l'humour absurde couperait ma station m√©t√©o et la ferait fermer la porte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je raclerais ensuite dehors avec des demandes comme: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Ouvrir les portes de la baie Pod, HAL </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
True, serait-ce dr√¥le? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS Dans la fabrication de l'appareil a √©t√© guid√© par les manuels: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nextion HMI Solution</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FLProg + Nextion HMI. </font><font style="vertical-align: inherit;">Le√ßon 1</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
¬ª </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FLProg + Nextion HMI. </font><font style="vertical-align: inherit;">Le√ßon 2</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
¬ª </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IHM FLProg + Nextion. </font><font style="vertical-align: inherit;">Le√ßon 3,</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
je peux √©galement proposer: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La disposition de l'interface pour l'√©dition dans Nextion Editor</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
"</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Afficher le fichier d'interface de t√©l√©chargement</font></font></a><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Afficher le code de pi√®ce pour Arduino</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// v5:     Serial - Arduino, Serial1 - Nextion</span></span>
<span class="hljs-comment"><span class="hljs-comment">// v6:  </span></span>
<span class="hljs-comment"><span class="hljs-comment">// v7:     </span></span>
<span class="hljs-comment"><span class="hljs-comment">// v8:      ( ,    ,  )</span></span>
<span class="hljs-comment"><span class="hljs-comment">// v9:       DHT.h Adafruit</span></span>
<span class="hljs-comment"><span class="hljs-comment">// v10:     ,      </span></span>
<span class="hljs-comment"><span class="hljs-comment">// v11:    CO2/PM2.5</span></span>
<span class="hljs-comment"><span class="hljs-comment">// v12:     , reDraw   statusBoolean = true</span></span>
<span class="hljs-comment"><span class="hljs-comment">// ToDo:   40 ,     ,     (  )</span></span><font></font>
<font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;DHT.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;RCSwitch.h&gt; //   http://code.google.com/p/rc-switch/</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;MQ135.h&gt; //    CO2</span></span></span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> measurePin  A1  </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// analog</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ledPower  12 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// digital</span></span></span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> samplingTime 280</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> deltaTime 40</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> sleepTime 9680</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> voMeasured = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> calcVoltage = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> dustDensity = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> ppm = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> analogPin A0 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//   MQ135    A0 Arduino</span></span></span></span><font></font>
<font></font>
MQ135 gasSensor = MQ135(analogPin); <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tempInX 10</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tempOutX 380 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// 415</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> humidityInX 320 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//325</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> humidityOutX 410</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> pressureX 20 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// 10</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ppmX 20</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> pmX 370</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> Y0 0 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//    </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> Y1 5 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// , </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> Y2 125 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> Y3 230 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// ppm&amp;pm</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> dotY 125 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//  </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> minusY 115</span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// </span></span></span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> minusXOut 380</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> minusXIn 10</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> minusH 3 </span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> minusPicID 2 </span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> symbolID 1 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//     </span></span></span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> statusTimeOut 2200000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//  ""   (,       ) 900000</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> updateTimeOut 300000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//      60000 (300000)</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> historyTimeOut 1800000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//      (1800000)</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> selectionTimeOut 5000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//      </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> backLightTimeOut 300000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//      </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> waveLimit 254</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> parameterS[<span class="hljs-number"><span class="hljs-number">7</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//  . : tempIn, tempOut, humidityIn, humidityOut, pressure, ppm, pm</span></span>
byte statusS[<span class="hljs-number"><span class="hljs-number">7</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//         ( /  )</span></span>
boolean statusBoolean[<span class="hljs-number"><span class="hljs-number">7</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">/*
//      
int coordinateX[7] = {tempInX, tempOutX, humidityInX, humidityOutX, pressureX, ppmX, pmX};
int coordinateY[7] = {Y2, Y2, Y1, Y1, Y1, Y3, Y3};
*/</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-comment"><span class="hljs-comment">//  : tempIn, tempOut, humidityIn, humidityOut, pressure, ppm, pm</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> historyArray[<span class="hljs-number"><span class="hljs-number">7</span></span>][<span class="hljs-number"><span class="hljs-number">48</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// 7   48 </span></span>
boolean drawArray[<span class="hljs-number"><span class="hljs-number">7</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> arrayMax; <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> arrayMin;<font></font>
byte waveShift; <span class="hljs-comment"><span class="hljs-comment">//        waveform 0 - 255</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> arrayNorm; <span class="hljs-comment"><span class="hljs-comment">//        </span></span><font></font>
<font></font>
byte count=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
byte arrayCounter; <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
byte waveCount; <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> splitData[<span class="hljs-number"><span class="hljs-number">4</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//       [, , , ]</span></span>
byte thousands, hundreds, tens, ones; <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tempIn, tempOut, humidityIn, humidityOut, pressure;
<span class="hljs-comment"><span class="hljs-comment">// int tempIn, tempOut, humidityIn, humidityOut, pressure, ppm, pm;</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> symbolX0;
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> posX; <span class="hljs-comment"><span class="hljs-comment">//    X  </span></span>
byte tempInStatus, tempOutStatus, humidityInStatus, humidityOutStatus, pressureStatus, ppmStatus, pmStatus; <span class="hljs-comment"><span class="hljs-comment">//       StatusTimeOut</span></span><font></font>
byte symbolCount, symbolWidth;<font></font>
boolean minusIn = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
boolean minusOut = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
byte i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> statusTime, updateTime, historyTime, selectionTime, backLightTime;<font></font>
String stringToNextion;<font></font>
byte historyCount;<font></font>
boolean backLight; <span class="hljs-comment"><span class="hljs-comment">//           </span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> weatherData = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dht22Humidity = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//CLICKER VARIABLE SECTION</span></span>
byte buffer[<span class="hljs-number"><span class="hljs-number">30</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// buffer for bytes coming from HMI.</span></span>
byte waveCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-comment"><span class="hljs-comment">// boolean drawArray[7]; //     </span></span><font></font>
boolean allClear;<font></font>
byte currentPage = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
byte searchTarget, searchNumber, searchCounter, pageNum, drawCounter, channelToDraw;<font></font>
<span class="hljs-comment"><span class="hljs-comment">// int historyArray[7][48]; // 7   48 </span></span>
<span class="hljs-comment"><span class="hljs-comment">// int arrayMax; //       </span></span>
<span class="hljs-comment"><span class="hljs-comment">// int arrayMin;</span></span>
<span class="hljs-comment"><span class="hljs-comment">// byte waveShift; //        waveform 0 - 255</span></span>
<span class="hljs-comment"><span class="hljs-comment">// float arrayNorm; //        </span></span>
byte iconCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// int splitData[4]; //       [, , , ]</span></span>
<span class="hljs-comment"><span class="hljs-comment">// int posX; //    X  </span></span>
<span class="hljs-comment"><span class="hljs-comment">// byte count = 0; //    </span></span>
<span class="hljs-comment"><span class="hljs-comment">// String stringToNextion;</span></span>
<span class="hljs-comment"><span class="hljs-comment">// int symbolX0;</span></span>
<span class="hljs-comment"><span class="hljs-comment">// byte symbolCount;</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> minusH 3 </span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> minusPicID 2 </span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//       </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> axisX[<span class="hljs-number"><span class="hljs-number">5</span></span>][<span class="hljs-number"><span class="hljs-number">7</span></span>] = {{<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">380</span></span>, <span class="hljs-number"><span class="hljs-number">320</span></span>, <span class="hljs-number"><span class="hljs-number">410</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">370</span></span>}, <span class="hljs-comment"><span class="hljs-comment">//  0</span></span>
               {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>},<font></font>
               {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>},<font></font>
               {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>},<font></font>
               {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}}; <span class="hljs-comment"><span class="hljs-comment">//  1-4</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> axisY[<span class="hljs-number"><span class="hljs-number">5</span></span>][<span class="hljs-number"><span class="hljs-number">7</span></span>] = {{<span class="hljs-number"><span class="hljs-number">115</span></span>, <span class="hljs-number"><span class="hljs-number">115</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">230</span></span>, <span class="hljs-number"><span class="hljs-number">230</span></span>}, <span class="hljs-comment"><span class="hljs-comment">//  0</span></span>
               {<span class="hljs-number"><span class="hljs-number">145</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}, <span class="hljs-comment"><span class="hljs-comment">//  1</span></span>
               {<span class="hljs-number"><span class="hljs-number">63</span></span>, <span class="hljs-number"><span class="hljs-number">226</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}, <span class="hljs-comment"><span class="hljs-comment">//  2 </span></span>
               {<span class="hljs-number"><span class="hljs-number">37</span></span>, <span class="hljs-number"><span class="hljs-number">145</span></span>, <span class="hljs-number"><span class="hljs-number">253</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> }, <span class="hljs-comment"><span class="hljs-comment">//  3</span></span>
               {<span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">105</span></span>, <span class="hljs-number"><span class="hljs-number">185</span></span>, <span class="hljs-number"><span class="hljs-number">265</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}}; <span class="hljs-comment"><span class="hljs-comment">//  4</span></span><font></font>
<font></font>
<font></font>
byte symbolW[<span class="hljs-number"><span class="hljs-number">5</span></span>][<span class="hljs-number"><span class="hljs-number">11</span></span>] = {{<span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>},<font></font>
                       {<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>},<font></font>
                       {<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>},<font></font>
                       {<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>},<font></font>
                       {<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>}};<span class="hljs-comment"><span class="hljs-comment">//   0, 1, 2, 3, 4, 5, 6, 7, 8, 9</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// {13, 7, 15, 13, 17, 15, 13, 14, 14, 14, 5}   25 Comfortaa Light</span></span><font></font>
<font></font>
byte numberPic[<span class="hljs-number"><span class="hljs-number">5</span></span>] = {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>}; <span class="hljs-comment"><span class="hljs-comment">// ID   </span></span><font></font>
<font></font>
byte symbolH[<span class="hljs-number"><span class="hljs-number">5</span></span>] = {<span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>}; <span class="hljs-comment"><span class="hljs-comment">//     25   25 Comfortaa Light</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// CLICKER VARIABLE SECTION ENDS    </span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// TREND VARIABLE SECTION</span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> x2 70 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//    </span></span></span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> trendArray[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">6</span></span>] = {{<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}, <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
                        {<span class="hljs-number"><span class="hljs-number">-5</span></span>, <span class="hljs-number"><span class="hljs-number">-3</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>},<font></font>
                        {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}};<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sumY, sumXY;<font></font>
byte trendCount;<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> trend; <font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// TREND VARIABLE SECTION ENDS                  </span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> DHTPIN 7</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> DHTTYPE DHT22</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// Setup a DHT22 instance</span></span>
<span class="hljs-function"><span class="hljs-function">DHT </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dht</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DHTPIN, DHTTYPE)</span></span></span></span>;<font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// Setup RC-Switch</span></span><font></font>
RCSwitch mySwitch = RCSwitch();<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendToNextion</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  Serial.write(<span class="hljs-number"><span class="hljs-number">0xff</span></span>);<font></font>
  Serial.write(<span class="hljs-number"><span class="hljs-number">0xff</span></span>);<font></font>
  Serial.write(<span class="hljs-number"><span class="hljs-number">0xff</span></span>);<font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//      </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawMark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte mark, byte markNum)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> markX;<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//        </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (allClear == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
  allClear = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
}<font></font>
<font></font>
markX = axisX[<span class="hljs-number"><span class="hljs-number">0</span></span>][markNum];<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (markNum == <span class="hljs-number"><span class="hljs-number">1</span></span> || markNum == <span class="hljs-number"><span class="hljs-number">3</span></span> || markNum == <span class="hljs-number"><span class="hljs-number">6</span></span>) {<font></font>
  markX = <span class="hljs-number"><span class="hljs-number">475</span></span>;<font></font>
} <font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (markNum == <span class="hljs-number"><span class="hljs-number">0</span></span> || markNum == <span class="hljs-number"><span class="hljs-number">4</span></span> || markNum == <span class="hljs-number"><span class="hljs-number">5</span></span>) {<font></font>
  markX = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (markNum == <span class="hljs-number"><span class="hljs-number">2</span></span>) {<font></font>
  markX = markX - <span class="hljs-number"><span class="hljs-number">15</span></span>;<font></font>
}<font></font>
<font></font>
    stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"fill "</span></span>);<font></font>
    stringToNextion = stringToNextion + String(markX); <span class="hljs-comment"><span class="hljs-comment">// String(axisX[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(axisY[<span class="hljs-number"><span class="hljs-number">0</span></span>][markNum]+<span class="hljs-number"><span class="hljs-number">30</span></span>); <span class="hljs-comment"><span class="hljs-comment">// String(axisY[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"5"</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"30"</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mark == <span class="hljs-number"><span class="hljs-number">1</span></span>) {<font></font>
<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"RED"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.println("Mark set");</span></span><font></font>
<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mark == <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"BLACK"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.println("Mark clear");</span></span><font></font>
<font></font>
}<font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.println(stringToNextion);</span></span><font></font>
    Serial.print(stringToNextion);<font></font>
    sendToNextion();<font></font>
  <font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//  :     </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clearSelection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (byte jj = <span class="hljs-number"><span class="hljs-number">0</span></span>; jj &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; jj++) {
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (drawArray[jj] == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
    drawArray[jj] = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
    drawMark(<span class="hljs-number"><span class="hljs-number">0</span></span>, jj);<font></font>
   }<font></font>
  }<font></font>
<font></font>
  allClear = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
  waveCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateHistory</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
mySwitch.disableReceive();<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   ,       -   ,       </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (arrayCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>; arrayCounter &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; arrayCounter++) {
  <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("StatusBoolean for array #");// Serial2.print(arrayCounter);// Serial2.print(" = "); // Serial2.println(statusBoolean[arrayCounter]);</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (statusBoolean[arrayCounter] == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">47</span></span>; i &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; i--) {<font></font>
      historyArray[arrayCounter][i] = historyArray[arrayCounter][i<span class="hljs-number"><span class="hljs-number">-1</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// </span></span><font></font>
    }<font></font>
    historyArray[arrayCounter][<span class="hljs-number"><span class="hljs-number">0</span></span>] = parameterS[arrayCounter]; <span class="hljs-comment"><span class="hljs-comment">//  </span></span><font></font>
  }<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// statusBoolean[arrayCounter] = false; // ,       </span></span><font></font>
<font></font>
  }<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (arrayCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>; arrayCounter &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; arrayCounter++) {
 <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">47</span></span>; i++) {
   <span class="hljs-comment"><span class="hljs-comment">// Serial2.print(historyArray[arrayCounter][i]);// Serial2.print(", ");</span></span><font></font>
  }<font></font>
 <span class="hljs-comment"><span class="hljs-comment">// Serial2.println();</span></span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// Serial2.println();  </span></span><font></font>
<font></font>
mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
  <font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawTrend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte arrayToTrend)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> markX;<font></font>
<font></font>
markX = axisX[<span class="hljs-number"><span class="hljs-number">0</span></span>][arrayToTrend];<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   X   </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayToTrend == <span class="hljs-number"><span class="hljs-number">1</span></span> || arrayToTrend == <span class="hljs-number"><span class="hljs-number">3</span></span> || arrayToTrend == <span class="hljs-number"><span class="hljs-number">6</span></span>) {<font></font>
  markX = <span class="hljs-number"><span class="hljs-number">472</span></span>;<font></font>
} <font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayToTrend == <span class="hljs-number"><span class="hljs-number">0</span></span> || arrayToTrend == <span class="hljs-number"><span class="hljs-number">4</span></span> || arrayToTrend == <span class="hljs-number"><span class="hljs-number">5</span></span>) {<font></font>
  markX = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayToTrend == <span class="hljs-number"><span class="hljs-number">2</span></span>) {<font></font>
  markX = markX - <span class="hljs-number"><span class="hljs-number">15</span></span>;<font></font>
}<font></font>
<font></font>
    stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"xpic "</span></span>);<font></font>
    stringToNextion = stringToNextion + String(markX); <span class="hljs-comment"><span class="hljs-comment">//   X</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(axisY[<span class="hljs-number"><span class="hljs-number">0</span></span>][arrayToTrend]); <span class="hljs-comment"><span class="hljs-comment">//   Y</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"8"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    7x18</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"18"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (trend &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
<font></font>
<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">// </span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  Y    0</span></span><font></font>
<font></font>
  <font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (trend &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"8"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    5</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">// </span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  Y    0</span></span><font></font>
    <font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (trend == <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"16"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     10</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">// </span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  Y    0</span></span><font></font>
 <font></font>
}<font></font>
<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"5"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ID    </span></span>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.println(stringToNextion);    </span></span><font></font>
    Serial.print(stringToNextion);<font></font>
    sendToNextion();<font></font>
 <font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">splitRoutine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> input)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
<font></font>
<font></font>
input = <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(input); <span class="hljs-comment"><span class="hljs-comment">//      ,   </span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (count = <span class="hljs-number"><span class="hljs-number">0</span></span>; count &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; count++) {<font></font>
  splitData[count] = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
}<font></font>
<font></font>
count = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (input &gt; <span class="hljs-number"><span class="hljs-number">9999</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
  count = <span class="hljs-number"><span class="hljs-number">5</span></span>;<font></font>
} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (input &gt; <span class="hljs-number"><span class="hljs-number">999</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  9999</span></span>
  splitData[<span class="hljs-number"><span class="hljs-number">3</span></span>] = input/<span class="hljs-number"><span class="hljs-number">1000</span></span>;<font></font>
  input = input - splitData[<span class="hljs-number"><span class="hljs-number">3</span></span>]*<span class="hljs-number"><span class="hljs-number">1000</span></span>;<font></font>
  count = <span class="hljs-number"><span class="hljs-number">4</span></span>;
<span class="hljs-comment"><span class="hljs-comment">/*
  Serial.print("SplitData Count 4:");
  Serial.println(splitData[3]);
*/</span></span><font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (input &gt; <span class="hljs-number"><span class="hljs-number">99</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  999</span></span>
  splitData[<span class="hljs-number"><span class="hljs-number">2</span></span>] = input/<span class="hljs-number"><span class="hljs-number">100</span></span>;<font></font>
  input = input - splitData[<span class="hljs-number"><span class="hljs-number">2</span></span>]*<span class="hljs-number"><span class="hljs-number">100</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count == <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
    count = <span class="hljs-number"><span class="hljs-number">3</span></span>;
<span class="hljs-comment"><span class="hljs-comment">/*
  Serial.print("SplitData Count 3:");
  Serial.println(splitData[2]);
*/</span></span>  <font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (input &gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  99</span></span>
  splitData[<span class="hljs-number"><span class="hljs-number">1</span></span>] = input/<span class="hljs-number"><span class="hljs-number">10</span></span>;<font></font>
  input = input - splitData[<span class="hljs-number"><span class="hljs-number">1</span></span>]*<span class="hljs-number"><span class="hljs-number">10</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count == <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
    count = <span class="hljs-number"><span class="hljs-number">2</span></span>;
<span class="hljs-comment"><span class="hljs-comment">/*
  Serial.print("SplitData Count 2:");
  Serial.println(splitData[1]);
*/</span></span>  <font></font>
  }<font></font>
} <font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (input &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) {<font></font>
  splitData[<span class="hljs-number"><span class="hljs-number">0</span></span>] = input;
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count == <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
    count = <span class="hljs-number"><span class="hljs-number">1</span></span>;
<span class="hljs-comment"><span class="hljs-comment">/*
  Serial.print("SplitData Count 1:");
  Serial.println(splitData[0]);
*/</span></span>  <font></font>
  }<font></font>
}<font></font>
<font></font>
}<font></font>
<span class="hljs-comment"><span class="hljs-comment">/*
  Serial.print("Input = ");
  Serial.println(input);
  Serial.print("Count = ");
  Serial.println(count);
*/</span></span><font></font>
<font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawRoutine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte page, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value, byte type, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> drawX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> drawY)</span></span></span><span class="hljs-function"> </span></span>{ <font></font>
<font></font>
mySwitch.disableReceive();  <font></font>
<span class="hljs-comment"><span class="hljs-comment">// page -  ; value = ; type =       ; drawX    X, drawY -  Y</span></span><font></font>
  <font></font>
  boolean minusSign = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
<font></font>
  splitRoutine(value);  <font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (page == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-comment"><span class="hljs-comment">//   (  pm25)         ( 470 = 480 - 10)</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
    drawX = <span class="hljs-number"><span class="hljs-number">470</span></span> - count*<span class="hljs-number"><span class="hljs-number">30</span></span> - <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       10      ,  30    + 5  </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count == <span class="hljs-number"><span class="hljs-number">1</span></span>) {<font></font>
      drawX = drawX - <span class="hljs-number"><span class="hljs-number">30</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   0,        </span></span><font></font>
    }<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type == <span class="hljs-number"><span class="hljs-number">6</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  pm25</span></span>
    drawX = <span class="hljs-number"><span class="hljs-number">470</span></span> - count*<span class="hljs-number"><span class="hljs-number">30</span></span> - <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       20      ,  30   </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count == <span class="hljs-number"><span class="hljs-number">1</span></span>) {<font></font>
      drawX = drawX - <span class="hljs-number"><span class="hljs-number">30</span></span>;<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> posX = drawX;<font></font>
<font></font>
 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
  minusSign = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
 }<font></font>
<font></font>
 <font></font>
<font></font>
 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    9999</span></span><font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((count == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; ((type == <span class="hljs-number"><span class="hljs-number">0</span></span>) || (type  == <span class="hljs-number"><span class="hljs-number">1</span></span>) || (type  == <span class="hljs-number"><span class="hljs-number">6</span></span>))) { <span class="hljs-comment"><span class="hljs-comment">//    pm2.5     0,  0   </span></span>
  <span class="hljs-comment"><span class="hljs-comment">// xpic X, Y, , , X, Y, </span></span><font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// </span></span>
    stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"xpic "</span></span>);<font></font>
    stringToNextion = stringToNextion + String(drawX); <span class="hljs-comment"><span class="hljs-comment">// String(axisX[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(drawY); <span class="hljs-comment"><span class="hljs-comment">// String(axisY[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(symbolW[page][<span class="hljs-number"><span class="hljs-number">0</span></span>]);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(symbolH[page]);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(numberPic[page]);<font></font>
   <span class="hljs-comment"><span class="hljs-comment">// // Serial2.println("Temp leading zero");</span></span>
   <span class="hljs-comment"><span class="hljs-comment">// // Serial2.println(stringToNextion);</span></span><font></font>
    Serial.print(stringToNextion);<font></font>
    sendToNextion();<font></font>
    drawX = drawX + symbolW[page][<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//     0</span></span><font></font>
      <font></font>
   } <span class="hljs-comment"><span class="hljs-comment">// count = 1</span></span><font></font>
<font></font>
   <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (byte ii = count; ii &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; ii--) { <span class="hljs-comment"><span class="hljs-comment">//   ,    </span></span><font></font>
<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((ii == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; ((type == <span class="hljs-number"><span class="hljs-number">0</span></span>) || (type == <span class="hljs-number"><span class="hljs-number">1</span></span>) || (type == <span class="hljs-number"><span class="hljs-number">6</span></span>))) { <span class="hljs-comment"><span class="hljs-comment">//  ,     </span></span>
      stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"xpic "</span></span>);<font></font>
      stringToNextion = stringToNextion + String(drawX); <span class="hljs-comment"><span class="hljs-comment">// String(axisX[page, type]);</span></span>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
      stringToNextion = stringToNextion + String(drawY); <span class="hljs-comment"><span class="hljs-comment">// String(axisY[page, type]);</span></span>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
      stringToNextion = stringToNextion + String(symbolW[page][<span class="hljs-number"><span class="hljs-number">10</span></span>]);<font></font>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
      stringToNextion = stringToNextion + String(symbolH[page]);<font></font>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (page == <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
        stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"265"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//        265</span></span>
      } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
        stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"118"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//       135  Comfortaa Light 25</span></span><font></font>
      }<font></font>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">// </span></span>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    Y    0</span></span>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
      stringToNextion = stringToNextion + String(numberPic[page]); <font></font>
     <span class="hljs-comment"><span class="hljs-comment">// // Serial2.println("Temp decimal dot");</span></span>
     <span class="hljs-comment"><span class="hljs-comment">// // Serial2.println(stringToNextion);      </span></span><font></font>
      Serial.print(stringToNextion);<font></font>
      sendToNextion();<font></font>
      drawX = drawX + symbolW[page][<span class="hljs-number"><span class="hljs-number">10</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
    } <span class="hljs-comment"><span class="hljs-comment">// ii == 1 &amp;&amp; type == 0 || type == 1</span></span><font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
    symbolX0 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (symbolCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; symbolCount &lt; (splitData[ii<span class="hljs-number"><span class="hljs-number">-1</span></span>]);symbolCount++) { <span class="hljs-comment"><span class="hljs-comment">//     X    (   )</span></span><font></font>
      symbolX0 = symbolX0 + symbolW[page][symbolCount];<font></font>
    }<font></font>
<font></font>
    stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"xpic "</span></span>);<font></font>
    stringToNextion = stringToNextion + String(drawX); <span class="hljs-comment"><span class="hljs-comment">// String(axisX[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(drawY); <span class="hljs-comment"><span class="hljs-comment">// String(axisY[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(symbolW[page][splitData[ii<span class="hljs-number"><span class="hljs-number">-1</span></span>]]);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(symbolH[page]);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(symbolX0); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(numberPic[page]);<font></font>
   <span class="hljs-comment"><span class="hljs-comment">// // Serial2.print("Symbol: "); // Serial2.println(splitData[ii-1]);</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//  // Serial2.println(stringToNextion);    </span></span><font></font>
    Serial.print(stringToNextion);<font></font>
    sendToNextion();<font></font>
    drawX = drawX + symbolW[page][splitData[ii<span class="hljs-number"><span class="hljs-number">-1</span></span>]];<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (minusSign == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">/*
    symbolX0 = 0; //    
    for (byte ii = count; ii &gt; 0; ii--) { 
      symbolX0 = symbolX0 + symbolW[page][splitData[ii-1]];
    }

    */</span></span><font></font>
    <font></font>
    stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"xpic "</span></span>);<font></font>
    stringToNextion = stringToNextion + String(posX); <span class="hljs-comment"><span class="hljs-comment">// String(axisX[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(drawY<span class="hljs-number"><span class="hljs-number">-8</span></span>); <span class="hljs-comment"><span class="hljs-comment">// String(axisY[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(drawX - posX);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(minusH); <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(minusPicID);<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    // Serial2.print("Symbol: "); // Serial2.println(splitData[ii-1]);</span></span>
 <span class="hljs-comment"><span class="hljs-comment">//   // Serial2.println(stringToNextion);    </span></span><font></font>
    Serial.print(stringToNextion);<font></font>
    sendToNextion();<font></font>
    <font></font>
  }<font></font>
  <font></font>
 } <span class="hljs-comment"><span class="hljs-comment">// if count &lt; 5    9999</span></span>
  mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
}         <font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//     ( )</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getMinMax</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte arrayToMax, byte maxCount)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  <font></font>
byte getMaxCount = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
arrayMax = historyArray[arrayToMax][getMaxCount]; <span class="hljs-comment"><span class="hljs-comment">//      </span></span>
arrayMin = historyArray[arrayToMax][getMaxCount]; <span class="hljs-comment"><span class="hljs-comment">//      </span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (byte getMaxCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; getMaxCount &lt; maxCount; getMaxCount++) { <span class="hljs-comment"><span class="hljs-comment">// maxCount 47   , 6  </span></span><font></font>
  <font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (historyArray[arrayToMax][getMaxCount+<span class="hljs-number"><span class="hljs-number">1</span></span>] &gt; arrayMax){ <font></font>
    arrayMax = historyArray[arrayToMax][getMaxCount+<span class="hljs-number"><span class="hljs-number">1</span></span>];<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayMin &gt; historyArray[arrayToMax][getMaxCount+<span class="hljs-number"><span class="hljs-number">1</span></span>]){ <font></font>
    arrayMin = historyArray[arrayToMax][getMaxCount+<span class="hljs-number"><span class="hljs-number">1</span></span>];<font></font>
  }<font></font>
  <font></font>
}<font></font>
 <font></font>
}      <font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte arrayToTrend)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
mySwitch.disableReceive();<font></font>
getMinMax(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>); <span class="hljs-comment"><span class="hljs-comment">//        </span></span><font></font>
<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (trendCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; trendCount &lt; <span class="hljs-number"><span class="hljs-number">6</span></span>; trendCount++) {
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayMin &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
    trendArray[<span class="hljs-number"><span class="hljs-number">0</span></span>][trendCount] = historyArray[arrayToTrend][<span class="hljs-number"><span class="hljs-number">5</span></span>-trendCount] + <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(arrayMin); <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
  } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
    trendArray[<span class="hljs-number"><span class="hljs-number">0</span></span>][trendCount] = historyArray[arrayToTrend][<span class="hljs-number"><span class="hljs-number">5</span></span>-trendCount];<font></font>
  }<font></font>
}<font></font>
<font></font>
sumY = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
sumXY = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   ,   XY</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (trendCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; trendCount &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; trendCount++) {<font></font>
  sumY = sumY + trendArray[<span class="hljs-number"><span class="hljs-number">0</span></span>][trendCount];<font></font>
  sumXY = sumXY + trendArray[<span class="hljs-number"><span class="hljs-number">0</span></span>][trendCount]*trendArray[<span class="hljs-number"><span class="hljs-number">1</span></span>][trendCount];<font></font>
}<font></font>
<font></font>
trend = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) (sumY/<span class="hljs-number"><span class="hljs-number">10</span></span> + (sumXY/x2)*trendArray[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">5</span></span>]) - (sumY/<span class="hljs-number"><span class="hljs-number">10</span></span> + (sumXY/x2)*trendArray[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>])+<span class="hljs-number"><span class="hljs-number">0.5</span></span>;<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// Serial2.print("Trend: "); // Serial2.println(trend);</span></span><font></font>
<font></font>
drawTrend(arrayToTrend);<font></font>
mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reDraw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
 mySwitch.disableReceive();<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// Serial2.println("Redraw main page");</span></span>
<span class="hljs-comment"><span class="hljs-comment">/*    
 for (i = 0; i &lt; 7; i++) {
  parameterS[i] = random(255);
  statusS[i] = 1;
 }
    */</span></span> <font></font>
<font></font>
 Serial.print(<span class="hljs-string"><span class="hljs-string">"page 0"</span></span>);<font></font>
 sendToNextion();<font></font>
 <span class="hljs-comment"><span class="hljs-comment">// Serial.print("pic 0,0,6");</span></span>
 <span class="hljs-comment"><span class="hljs-comment">// sendToNextion();</span></span><font></font>
 <font></font>
 <font></font>
 <font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; i++) {
   <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("StatusBoolean on reDraw for item "); // Serial2.print(i); // Serial2.print(" is "); // Serial2.println(statusBoolean[i]);</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (statusBoolean[i] == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//     " "</span></span><font></font>
    drawRoutine(currentPage, parameterS[i], i, axisX[currentPage][i], axisY[currentPage][i]);<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("Redraw, ");// Serial2.print(i); // Serial2.print(": "); // Serial2.println(parameterS[i]);</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (historyCount &gt; <span class="hljs-number"><span class="hljs-number">5</span></span>) {<font></font>
      getTrend(i);<font></font>
    }<font></font>
<font></font>
   }<font></font>
    <font></font>
  }<font></font>
<font></font>
 mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNorm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
arrayNorm = <span class="hljs-number"><span class="hljs-number">1.00</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  1:1</span></span><font></font>
<font></font>
  arrayNorm = <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(arrayMax - arrayMin);<font></font>
  <font></font>
    arrayNorm = waveLimit/arrayNorm; <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
  <font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawHistory</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte arrayCounter, byte waveCount)</span></span></span></span>{<font></font>
mySwitch.disableReceive();<font></font>
byte tC01 = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
byte tC02 = <span class="hljs-number"><span class="hljs-number">0</span></span>; 
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> interPoint, lineMulti;
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> justPoint;<font></font>
<font></font>
  byte channelCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   ,   (ID = 0),           </span></span><font></font>
<font></font>
      getMinMax(arrayCounter, <span class="hljs-number"><span class="hljs-number">47</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  47   ,  39,        ,   </span></span>
 <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("arrayMax: "); // Serial2.println(arrayMax);</span></span>
 <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("arrayMin: "); // Serial2.println(arrayMin);</span></span><font></font>
      getNorm();<font></font>
      <font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage == <span class="hljs-number"><span class="hljs-number">2</span></span>) {<font></font>
         arrayNorm = arrayNorm*<span class="hljs-number"><span class="hljs-number">0.5</span></span>;      <font></font>
      }<font></font>
<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage == <span class="hljs-number"><span class="hljs-number">3</span></span>) {<font></font>
         arrayNorm = arrayNorm*<span class="hljs-number"><span class="hljs-number">0.3</span></span>;      <font></font>
      }<font></font>
<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage == <span class="hljs-number"><span class="hljs-number">4</span></span>) {<font></font>
         arrayNorm = arrayNorm*<span class="hljs-number"><span class="hljs-number">0.2</span></span>;<font></font>
      }<font></font>
<font></font>
 <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("arrayNorm: "); // Serial2.println(arrayNorm);   </span></span><font></font>
<font></font>
     <font></font>
     <font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//  </span></span>
      stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"add "</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
      stringToNextion = stringToNextion + String(waveCount); <span class="hljs-comment"><span class="hljs-comment">//    ID</span></span>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
      stringToNextion = stringToNextion + String(channelCount); <span class="hljs-comment"><span class="hljs-comment">//   0, 1, 2  3</span></span>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayMin &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
        justPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) (historyArray[arrayCounter][tC01] + <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(arrayMin))*arrayNorm + <span class="hljs-number"><span class="hljs-number">0.5</span></span>;<font></font>
        stringToNextion = stringToNextion + String(justPoint); <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
      } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
        justPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) historyArray[arrayCounter][tC01]*arrayNorm + <span class="hljs-number"><span class="hljs-number">0.5</span></span>;<font></font>
        stringToNextion = stringToNextion + String(justPoint); <span class="hljs-comment"><span class="hljs-comment">//    </span></span><font></font>
      }<font></font>
      Serial.print(stringToNextion);<font></font>
      <span class="hljs-comment"><span class="hljs-comment">// // Serial2.print("First point, original");// Serial2.println(historyArray[arrayCounter][tC01]);</span></span>
      <span class="hljs-comment"><span class="hljs-comment">// // Serial2.print("First point: "); // Serial2.println(stringToNextion);          </span></span><font></font>
      sendToNextion(); <font></font>
                <font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (tC01 = <span class="hljs-number"><span class="hljs-number">0</span></span>; tC01 &lt; <span class="hljs-number"><span class="hljs-number">46</span></span>; tC01++) { <span class="hljs-comment"><span class="hljs-comment">//   37  46</span></span><font></font>
          <font></font>
          lineMulti = (historyArray[arrayCounter][tC01+<span class="hljs-number"><span class="hljs-number">1</span></span>] - historyArray[arrayCounter][tC01])/<span class="hljs-number"><span class="hljs-number">9</span></span>; <span class="hljs-comment"><span class="hljs-comment">//         </span></span><font></font>
          <font></font>
          <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayMin &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
            justPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) historyArray[arrayCounter][tC01] + <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(arrayMin) + lineMulti+<span class="hljs-number"><span class="hljs-number">0.5</span></span>;<font></font>
            interPoint = justPoint;<font></font>
          } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
            justPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) historyArray[arrayCounter][tC01] + lineMulti + <span class="hljs-number"><span class="hljs-number">0.5</span></span>;<font></font>
            interPoint = justPoint;<font></font>
          }<font></font>
          <font></font>
          <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (tC02 = <span class="hljs-number"><span class="hljs-number">0</span></span>; tC02 &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; tC02++) { <span class="hljs-comment"><span class="hljs-comment">//   ,  ,    9</span></span>
            stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"add "</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
            stringToNextion = stringToNextion + String(waveCount); <span class="hljs-comment"><span class="hljs-comment">//     (1, 2, 3  4 )</span></span>
            stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
            stringToNextion = stringToNextion + String(channelCount); <span class="hljs-comment"><span class="hljs-comment">//   0, 1, 2  3</span></span>
            stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
            justPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) interPoint*arrayNorm;<font></font>
            stringToNextion = stringToNextion + String(justPoint);<font></font>
            interPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) interPoint + lineMulti;<font></font>
            Serial.print(stringToNextion);   <font></font>
           <span class="hljs-comment"><span class="hljs-comment">// // Serial2.print("Connecting point: "); // Serial2.println(stringToNextion);                               </span></span><font></font>
            sendToNextion();                      <font></font>
          }<font></font>
          stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"add "</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
          stringToNextion = stringToNextion + String(waveCount); <span class="hljs-comment"><span class="hljs-comment">//     (1, 2, 3  4 )</span></span>
          stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
          stringToNextion = stringToNextion + String(channelCount); <span class="hljs-comment"><span class="hljs-comment">//   0, 1, 2  3</span></span>
          stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);
          <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayMin &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
            justPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) (historyArray[arrayCounter][tC01+<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(arrayMin))*arrayNorm + <span class="hljs-number"><span class="hljs-number">0.5</span></span>;<font></font>
            stringToNextion = stringToNextion + String(justPoint); <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
          } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
            justPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) historyArray[arrayCounter][tC01+<span class="hljs-number"><span class="hljs-number">1</span></span>]*arrayNorm + <span class="hljs-number"><span class="hljs-number">0.5</span></span>;<font></font>
            stringToNextion = stringToNextion + String(justPoint); <span class="hljs-comment"><span class="hljs-comment">//    </span></span><font></font>
          }<font></font>
          <font></font>
          Serial.print(stringToNextion);<font></font>
         <span class="hljs-comment"><span class="hljs-comment">// // Serial2.print("Next/Last point, original: ");// Serial2.println(historyArray[arrayCounter][tC01+1]);               </span></span>
          <span class="hljs-comment"><span class="hljs-comment">// // Serial2.print("Next/Last point: "); // Serial2.println(stringToNextion);               </span></span><font></font>
          sendToNextion();                                  <font></font>
        }<font></font>
    <font></font>
 mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>);   <font></font>
  }<font></font>
  <font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawIcon</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> where, byte what)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//// Serial2.print("Where: "); // Serial2.println(where);</span></span>
<span class="hljs-comment"><span class="hljs-comment">//// Serial2.print("What: "); // Serial2.println(what);</span></span><font></font>
<font></font>
stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"xpic "</span></span>);<font></font>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// String(axisX[page, type]);</span></span>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
stringToNextion = stringToNextion + String(where<span class="hljs-number"><span class="hljs-number">-3</span></span>); <span class="hljs-comment"><span class="hljs-comment">// String(axisY[page, type]);</span></span>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
stringToNextion = stringToNextion + String(<span class="hljs-number"><span class="hljs-number">80</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
stringToNextion = stringToNextion + String(<span class="hljs-number"><span class="hljs-number">30</span></span>);<font></font>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
stringToNextion = stringToNextion + String(what*<span class="hljs-number"><span class="hljs-number">80</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     X = 80*  </span></span>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">// </span></span>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   Y  0</span></span>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
stringToNextion = stringToNextion + String(<span class="hljs-number"><span class="hljs-number">4</span></span>);
<span class="hljs-comment"><span class="hljs-comment">//// Serial2.println(stringToNextion);</span></span><font></font>
Serial.print(stringToNextion);<font></font>
sendToNextion();<font></font>
  <font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toPage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte pageNum)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
mySwitch.disableReceive();<font></font>
currentPage = pageNum;<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">/*
//    
stringToNextion = String("ref page");
stringToNextion = stringToNextion + String(pageNum);
Serial.print(stringToNextion);
sendToNextion();
*/</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
  String stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"page "</span></span>);<font></font>
  stringToNextion = stringToNextion + String(pageNum);<font></font>
 <span class="hljs-comment"><span class="hljs-comment">// // Serial2.print("Switch to: "); // Serial2.println(stringToNextion);</span></span><font></font>
  Serial.print(stringToNextion);<font></font>
  sendToNextion();<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pageNum == <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
  clearSelection();<font></font>
  reDraw();<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//        </span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pageNum &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
<font></font>
    <font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pageNum == <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; waveCounter &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//           </span></span>
 <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Draw single, searchCounter-1: "); // Serial2.println(searchCounter-1);</span></span>
      getMinMax(searchCounter<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">47</span></span>); <span class="hljs-comment"><span class="hljs-comment">//      </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//    // Serial2.print("arrayMax: "); // Serial2.println(arrayMax);</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//    // Serial2.print("arrayMin: "); // Serial2.println(arrayMin);</span></span>
      drawRoutine(pageNum, arrayMax, searchCounter<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">117</span></span>); <span class="hljs-comment"><span class="hljs-comment">// 115</span></span>
      drawIcon(<span class="hljs-number"><span class="hljs-number">145</span></span>, searchCounter<span class="hljs-number"><span class="hljs-number">-1</span></span>);<font></font>
      drawRoutine(pageNum, arrayMin, searchCounter<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">185</span></span>); <span class="hljs-comment"><span class="hljs-comment">// 175</span></span>
      drawHistory(searchCounter<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  :     </span></span>
     } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
<font></font>
              <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
              iconCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>;
              <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (drawCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>; drawCounter &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; drawCounter++) {
                <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (drawArray[drawCounter] == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {
        <span class="hljs-comment"><span class="hljs-comment">//          // Serial2.print("pageNum: "); // Serial2.println(pageNum);</span></span>
       <span class="hljs-comment"><span class="hljs-comment">//           // Serial2.print("iconCounter: "); // Serial2.println(iconCounter);</span></span>
      <span class="hljs-comment"><span class="hljs-comment">//            // Serial2.print("drawCounter: "); // Serial2.println(drawCounter);</span></span>
                  getMinMax(drawCounter, <span class="hljs-number"><span class="hljs-number">39</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   39  47</span></span>
      <span class="hljs-comment"><span class="hljs-comment">//            // Serial2.print("arrayMax: "); // Serial2.println(arrayMax);</span></span>
     <span class="hljs-comment"><span class="hljs-comment">//             // Serial2.print("arrayMin: "); // Serial2.println(arrayMin);</span></span>
                  drawRoutine(pageNum, arrayMax, drawCounter, <span class="hljs-number"><span class="hljs-number">0</span></span>, axisY[pageNum][iconCounter]<span class="hljs-number"><span class="hljs-number">-22</span></span>);   <span class="hljs-comment"><span class="hljs-comment">// -30               </span></span><font></font>
                  drawIcon(axisY[pageNum][iconCounter], drawCounter);<font></font>
                  drawRoutine(pageNum, arrayMin, drawCounter, <span class="hljs-number"><span class="hljs-number">0</span></span>, axisY[pageNum][iconCounter]+<span class="hljs-number"><span class="hljs-number">35</span></span>); <span class="hljs-comment"><span class="hljs-comment">// +30</span></span><font></font>
                  iconCounter++;<font></font>
                }<font></font>
            }      <font></font>
              channelToDraw = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">//      ,    ,   - </span></span>
              <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (drawCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>; drawCounter &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; drawCounter++) { <span class="hljs-comment"><span class="hljs-comment">//   " "</span></span>
                <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (drawArray[drawCounter] == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
                  drawHistory(drawCounter, channelToDraw);<font></font>
           <span class="hljs-comment"><span class="hljs-comment">//       // Serial2.print("drawCounter / channelToDraw "); // Serial2.print(drawCounter); // Serial2.print(" | "); // Serial2.println(channelToDraw);</span></span><font></font>
                  channelToDraw++;<font></font>
                 }<font></font>
              }<font></font>
      }<font></font>
    }<font></font>
    <font></font>
  mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
  pinMode(ledPower,OUTPUT);<font></font>
 <span class="hljs-comment"><span class="hljs-comment">// pinMode(measurePin, INPUT);</span></span><font></font>
<font></font>
 pinMode(<span class="hljs-number"><span class="hljs-number">4</span></span>, OUTPUT);<font></font>
 digitalWrite(<span class="hljs-number"><span class="hljs-number">4</span></span>, HIGH);<font></font>
<font></font>
<font></font>
<font></font>
 <font></font>
  currentPage = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  allClear = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
  historyCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
  backLight = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//          ,   false</span></span><font></font>
  <font></font>
<span class="hljs-comment"><span class="hljs-comment">//     </span></span>
<span class="hljs-comment"><span class="hljs-comment">//  . : tempIn, tempOut, humidityIn, humidityOut, pressure, ppm, pm</span></span>
 <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; i++) {<font></font>
  parameterS[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  statusS[i] = <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
 }<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (arrayCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>; arrayCounter &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; arrayCounter++) {
 <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;<span class="hljs-number"><span class="hljs-number">48</span></span>; i++) {<font></font>
  historyArray[arrayCounter][i]=<span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
 }<font></font>
}<font></font>
 <font></font>
 statusTime = millis();<font></font>
 updateTime = millis();<font></font>
 historyTime = millis();<font></font>
 backLightTime = millis();<font></font>
<font></font>
 Serial.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">"baud=57600"</span></span>);<font></font>
  sendToNextion();<font></font>
 Serial.end();<font></font>
<font></font>
 Serial.begin(<span class="hljs-number"><span class="hljs-number">57600</span></span>);<font></font>
 Serial.print(<span class="hljs-string"><span class="hljs-string">"baud=57600"</span></span>);<font></font>
 sendToNextion();<font></font>
 <font></font>
 <span class="hljs-comment"><span class="hljs-comment">// Serial2.begin(115200);</span></span><font></font>
 dht.begin();<font></font>
 mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
 delay(<span class="hljs-number"><span class="hljs-number">2000</span></span>);<font></font>
 Serial.print(<span class="hljs-string"><span class="hljs-string">"page 0"</span></span>);<font></font>
 sendToNextion();<font></font>
 <span class="hljs-comment"><span class="hljs-comment">// Serial2.println("Ready");</span></span><font></font>
 <font></font>
 reDraw();<font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span><font></font>
<font></font>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mySwitch.available()) { <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> value = mySwitch.getReceivedValue();
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value != <span class="hljs-number"><span class="hljs-number">0</span></span>) {
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("RC-Switch: "); // Serial2.println(mySwitch.getReceivedValue());</span></span>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mySwitch.getReceivedValue() / <span class="hljs-number"><span class="hljs-number">100000</span></span> == <span class="hljs-number"><span class="hljs-number">161</span></span>) {<font></font>
<font></font>
        weatherData = mySwitch.getReceivedValue() - <span class="hljs-number"><span class="hljs-number">16100000</span></span>;
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (weatherData &gt; <span class="hljs-number"><span class="hljs-number">10000</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
          parameterS[<span class="hljs-number"><span class="hljs-number">3</span></span>] = (weatherData - <span class="hljs-number"><span class="hljs-number">10000</span></span>)/<span class="hljs-number"><span class="hljs-number">10</span></span>;<font></font>
          statusS[<span class="hljs-number"><span class="hljs-number">3</span></span>] = statusS[<span class="hljs-number"><span class="hljs-number">3</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>;   <font></font>
          statusBoolean[<span class="hljs-number"><span class="hljs-number">3</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;  <font></font>
        }<font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
          <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (weatherData &gt; <span class="hljs-number"><span class="hljs-number">1000</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
            parameterS[<span class="hljs-number"><span class="hljs-number">1</span></span>] = -(weatherData - <span class="hljs-number"><span class="hljs-number">1000</span></span>);<font></font>
            minusOut = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
          }<font></font>
          <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
            parameterS[<span class="hljs-number"><span class="hljs-number">1</span></span>] = weatherData;<font></font>
            minusOut = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
          }<font></font>
        }<font></font>
          statusS[<span class="hljs-number"><span class="hljs-number">1</span></span>] = statusS[<span class="hljs-number"><span class="hljs-number">1</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
          statusBoolean[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
      }<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mySwitch.getReceivedValue() / <span class="hljs-number"><span class="hljs-number">10000</span></span> == <span class="hljs-number"><span class="hljs-number">1210</span></span>) {<font></font>
        parameterS[<span class="hljs-number"><span class="hljs-number">4</span></span>] = (mySwitch.getReceivedValue() - <span class="hljs-number"><span class="hljs-number">12100000</span></span>) / <span class="hljs-number"><span class="hljs-number">1.33</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
        statusS[<span class="hljs-number"><span class="hljs-number">4</span></span>] = statusS[<span class="hljs-number"><span class="hljs-number">4</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>;   <font></font>
        statusBoolean[<span class="hljs-number"><span class="hljs-number">4</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;   
        <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("Pressure: "); // Serial2.println(parameterS[4]);     </span></span><font></font>
      }<font></font>
<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mySwitch.getReceivedValue() / <span class="hljs-number"><span class="hljs-number">100000</span></span> == <span class="hljs-number"><span class="hljs-number">131</span></span>) {<font></font>
        weatherData = mySwitch.getReceivedValue() - <span class="hljs-number"><span class="hljs-number">13100000</span></span>;
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (weatherData &gt; <span class="hljs-number"><span class="hljs-number">1000</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
          parameterS[<span class="hljs-number"><span class="hljs-number">0</span></span>] = -(weatherData - <span class="hljs-number"><span class="hljs-number">1000</span></span>);<font></font>
          minusIn = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
        }<font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
          parameterS[<span class="hljs-number"><span class="hljs-number">0</span></span>] = weatherData;<font></font>
          minusIn = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
        }<font></font>
          statusS[<span class="hljs-number"><span class="hljs-number">0</span></span>] = statusS[<span class="hljs-number"><span class="hljs-number">0</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
          statusBoolean[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
      }<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//        </span></span><font></font>
<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mySwitch.getReceivedValue() / <span class="hljs-number"><span class="hljs-number">10000</span></span> == <span class="hljs-number"><span class="hljs-number">1212</span></span>) {<font></font>
        parameterS[<span class="hljs-number"><span class="hljs-number">2</span></span>] = (mySwitch.getReceivedValue() - <span class="hljs-number"><span class="hljs-number">12120000</span></span>); <span class="hljs-comment"><span class="hljs-comment">// </span></span>
        statusS[<span class="hljs-number"><span class="hljs-number">2</span></span>] = statusS[<span class="hljs-number"><span class="hljs-number">2</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>;   <font></font>
        statusBoolean[<span class="hljs-number"><span class="hljs-number">2</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;   
        <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("HumidityIn: "); // Serial2.println(parameterS[2]);     </span></span><font></font>
      }<font></font>
<span class="hljs-comment"><span class="hljs-comment">// CO2 PPM</span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mySwitch.getReceivedValue() / <span class="hljs-number"><span class="hljs-number">10000</span></span> == <span class="hljs-number"><span class="hljs-number">1213</span></span>) {<font></font>
        parameterS[<span class="hljs-number"><span class="hljs-number">5</span></span>] = (mySwitch.getReceivedValue() - <span class="hljs-number"><span class="hljs-number">12130000</span></span>); <span class="hljs-comment"><span class="hljs-comment">// CO2</span></span>
        statusS[<span class="hljs-number"><span class="hljs-number">5</span></span>] = statusS[<span class="hljs-number"><span class="hljs-number">5</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>;   <font></font>
        statusBoolean[<span class="hljs-number"><span class="hljs-number">5</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;   
        <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("CO2 PPM: "); // Serial2.println(parameterS[5]);     </span></span><font></font>
      }      <font></font>
<span class="hljs-comment"><span class="hljs-comment">// PM2.5</span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mySwitch.getReceivedValue() / <span class="hljs-number"><span class="hljs-number">10000</span></span> == <span class="hljs-number"><span class="hljs-number">1214</span></span>) {<font></font>
        parameterS[<span class="hljs-number"><span class="hljs-number">6</span></span>] = (mySwitch.getReceivedValue() - <span class="hljs-number"><span class="hljs-number">12140000</span></span>); <span class="hljs-comment"><span class="hljs-comment">// PM2.5</span></span>
        statusS[<span class="hljs-number"><span class="hljs-number">6</span></span>] = statusS[<span class="hljs-number"><span class="hljs-number">6</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>;   <font></font>
        statusBoolean[<span class="hljs-number"><span class="hljs-number">6</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;   
        <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("PM2.5: "); // Serial2.println(parameterS[6]);     </span></span><font></font>
      } <font></font>
<font></font>
    }<font></font>
    mySwitch.resetAvailable();<font></font>
    <span class="hljs-comment"><span class="hljs-comment">//    mySwitch.enableReceive(0); //  RC Switch</span></span><font></font>
  }   <font></font>
<font></font>
  <font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage == <span class="hljs-number"><span class="hljs-number">0</span></span>) {
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - selectionTime) &gt; selectionTimeOut) { 
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (allClear == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) {<font></font>
      clearSelection();<font></font>
    }<font></font>
  }<font></font>
 }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Serial.available())<font></font>
  {<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> moretocome = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> endcount = <span class="hljs-number"><span class="hljs-number">0</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> bytesread = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
    byte inbyte;<font></font>
    <span class="hljs-comment"><span class="hljs-comment">//bool isascii = false;</span></span><font></font>
<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (moretocome)<font></font>
    {<font></font>
      inbyte = Serial.read();<font></font>
<font></font>
        delay(<span class="hljs-number"><span class="hljs-number">2</span></span>);<font></font>
        <font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inbyte == <span class="hljs-number"><span class="hljs-number">0xFF</span></span>)<font></font>
      {<font></font>
        endcount++;<font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (endcount == <span class="hljs-number"><span class="hljs-number">3</span></span>)<font></font>
        {<font></font>
          moretocome = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;
          <span class="hljs-comment"><span class="hljs-comment">// Serial2.println("");</span></span><font></font>
        }<font></font>
      }<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">else</span></span><font></font>
      {<font></font>
        endcount = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
      }<font></font>
      buffer[bytesread] = inbyte;<font></font>
      bytesread++;<font></font>
<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; bytesread; x++)<font></font>
    {<font></font>
      <span class="hljs-comment"><span class="hljs-comment">// Serial2.print(buffer[x], HEX);</span></span>
      <span class="hljs-comment"><span class="hljs-comment">// Serial2.print(" ");</span></span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">//// Serial2.println(bytesread, DEC);</span></span>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.println("");</span></span><font></font>
<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-number"><span class="hljs-number">101</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
   backLightTime = millis(); <span class="hljs-comment"><span class="hljs-comment">//        </span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (backLight == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    ,   </span></span>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.println("Backlight 50%");</span></span>
    Serial.print(<span class="hljs-string"><span class="hljs-string">"dim=100"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  </span></span><font></font>
    sendToNextion();<font></font>
    backLight = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
   } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//     </span></span><font></font>
    <font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    </span></span><font></font>
      selectionTime = millis();<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>] &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (waveCounter &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    4 </span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (drawArray[buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>] == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
          drawArray[buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    ,   </span></span>
          drawMark(<span class="hljs-number"><span class="hljs-number">1</span></span>, buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>);<font></font>
          waveCounter = waveCounter + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
     <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Set button: "); // Serial2.println(buffer[2]);          </span></span>
     <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Total buttons: "); // Serial2.println(waveCounter);</span></span>
        } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
          drawArray[buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>] = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
          drawMark(<span class="hljs-number"><span class="hljs-number">0</span></span>, buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>);
          <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (waveCounter &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
            waveCounter = waveCounter - <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
          }<font></font>
     <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Clear button: "); // Serial2.println(buffer[2]);          </span></span>
     <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Total buttons: "); // Serial2.println(waveCounter);          </span></span><font></font>
        }<font></font>
      } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (drawArray[buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>] == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    ,  </span></span>
          drawArray[buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>] = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
          drawMark(<span class="hljs-number"><span class="hljs-number">0</span></span>, buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>);<font></font>
          waveCounter = waveCounter - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
     <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Clear button: "); // Serial2.println(buffer[2]);          </span></span>
     <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Total buttons: "); // Serial2.println(waveCounter);          </span></span><font></font>
        }<font></font>
      }<font></font>
    } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//      </span></span><font></font>
        currentPage = waveCounter;<font></font>
        toPage(waveCounter);    <font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { 
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//      ,    ID = 5    0</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">5</span></span>) {<font></font>
          toPage(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
        }<font></font>
      }<font></font>
<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//   1   ,    ID = 5    0</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">5</span></span>) {
          <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (waveCounter == <span class="hljs-number"><span class="hljs-number">1</span></span>) {<font></font>
            toPage(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
          } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
            toPage(waveCounter); <span class="hljs-comment"><span class="hljs-comment">//       </span></span><font></font>
          }<font></font>
        }<font></font>
      }<font></font>
<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    1     ID = 6 -          </span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">6</span></span>) {<font></font>
          toPage(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
        }<font></font>
      }      <font></font>
      <font></font>
      <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    1, .   1</span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">5</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//     ID &gt; 2, ..  </span></span>
   <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Buffer[2]: ");</span></span>
   <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.println(buffer[2]);</span></span>
   <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Normalized button: ");</span></span>
        searchTarget = buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-comment"><span class="hljs-comment">// ""  ,     ,   :  1 -   -  true   drawarray   1</span></span>
        searchNumber = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
        searchCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>;
   <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.println(searchTarget);</span></span><font></font>
<font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ((searchCounter &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>) &amp;&amp; (searchNumber &lt; searchTarget)) {
          <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (drawArray[searchCounter] == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
            searchNumber++;<font></font>
          }<font></font>
          searchCounter++;<font></font>
        }<font></font>
        <font></font>
   <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("searchCounter: "); // Serial2.println(searchCounter);</span></span>
        toPage(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">//      </span></span><font></font>
      }<font></font>
    }<font></font>
<font></font>
<font></font>
      <font></font>
     }<font></font>
    }<font></font>
  } <font></font>
<font></font>
buffer[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    *Status   1   </span></span>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//  :       ,    9</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - statusTime) &gt; statusTimeOut) {<font></font>
<font></font>
 <font></font>
 <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; i++) { <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
  <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("Status of "); // Serial2.print(i); // Serial2.print(" is: "); // Serial2.println(statusS[i]);</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (statusS[i] == <span class="hljs-number"><span class="hljs-number">0</span></span>) {statusBoolean[i] = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("As StatusS "); // Serial2.print(i); // Serial2.print(" is "); // Serial2.print(statusS[i]); // Serial2.println(" StatusBoolean set to false");</span></span><font></font>
    }<font></font>
    statusS[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    </span></span><font></font>
 }<font></font>
  statusTime = millis();<font></font>
  <font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//       </span></span><font></font>
<font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - updateTime) &gt; updateTimeOut) {<font></font>
<font></font>
  reDraw();<font></font>
  updateTime = millis();<font></font>
 }<font></font>
<font></font>
 <font></font>
 <font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//         </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - backLightTime) &gt; backLightTimeOut) {
 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (backLight == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
  backLight = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;
  <span class="hljs-comment"><span class="hljs-comment">// Serial2.println("Backlight 15%");</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//Serial.print("page 0");</span></span>
  <span class="hljs-comment"><span class="hljs-comment">// sendToNextion();</span></span>
  currentPage = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  clearSelection();<font></font>
  reDraw();<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">"dim=15"</span></span>);<font></font>
  sendToNextion();<font></font>
 }<font></font>
  <font></font>
 }<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - historyTime) &gt; historyTimeOut) {<font></font>
  updateHistory();<font></font>
<font></font>
    historyCount++;<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("History Q: "); // Serial2.println(historyCount);</span></span><font></font>
 <font></font>
  historyTime = millis();<font></font>
  }<font></font>
<font></font>
}  </code></pre><br>
<br>
</div></div><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mod√®le de bo√Ætier (soigneusement - vous pouvez casser l'√©cran)</font></font></a></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr399409/">https://habr.com/ru/post/fr399409/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr399399/index.html">Perc√©e du VIH: un nouvel anticorps bloque 98% de toutes les souches virales connues</a></li>
<li><a href="../fr399401/index.html">Demandez √† Ethan n ¬∞ 108: existe-t-il une lumi√®re solaire instantan√©e?</a></li>
<li><a href="../fr399403/index.html">Douleur dans les mains lorsque vous travaillez sur un ordinateur. Partie 2. Nous lib√©rons les √©paules et le cou</a></li>
<li><a href="../fr399405/index.html">Anniversaire du fondateur de Nintendo</a></li>
<li><a href="../fr399407/index.html">Pourquoi vous ne pouvez pas encore acheter d'√©couteurs sans fil</a></li>
<li><a href="../fr399411/index.html">La voie √©pineuse de l'√©volution des synth√©tiseurs: l'histoire oubli√©e des inventions r√©volutionnaires</a></li>
<li><a href="../fr399413/index.html">Un cauchemar complet: USB-C et Thunderbolt 3</a></li>
<li><a href="../fr399415/index.html">Comment Atlas s'est pr√©par√© pour le Black Friday</a></li>
<li><a href="../fr399417/index.html">Nouveaux produits Xiaomi avec de telles remises</a></li>
<li><a href="../fr399419/index.html">Examen du moniteur de jeu incurv√© Lenovo Y27g Razer Edition</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>