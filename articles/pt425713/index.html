<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòÇ „ÄΩÔ∏è üë®üèø‚Äç‚öïÔ∏è Integra√ß√£o do mecanismo HTML no aplicativo nativo do Windows - escolha e arquitetura üôèüèø üì≤ üå¶Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Como traduzimos o trabalho com HTML no 1C: Enterprise do Internet Explorer para o WebKit 

 A capacidade de exibir HTML nos formul√°rios 1C apareceu na...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Integra√ß√£o do mecanismo HTML no aplicativo nativo do Windows - escolha e arquitetura</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/1c/blog/425713/">  <b>Como traduzimos o trabalho com HTML no 1C: Enterprise do Internet Explorer para o WebKit</b> <br><br>  A capacidade de exibir HTML nos formul√°rios 1C apareceu na plataforma 1C: Enterprise em 2003, vers√£o 8.0.  Para trabalhar com HTML, a plataforma usava o mecanismo do navegador Internet Explorer (1C: Enterprise naquela √©poca trabalhava apenas no Windows).  O mecanismo do navegador foi usado pela plataforma para fins utilit√°rios.  Por exemplo, para escrever do zero um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">elemento</a> completo para editar texto no Word - com a possibilidade de v√°rias solu√ß√µes de cores e fontes, inserir imagens, etc.  - uma tarefa muito dif√≠cil.  E se voc√™ usar HTML para esses fins e usar o mecanismo do navegador da Internet como ferramenta de exibi√ß√£o, a tarefa ser√° bastante simplificada.  Al√©m disso, com a ajuda do mecanismo, v√°rios outros mecanismos (por exemplo, exibindo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">informa√ß√µes de ajuda</a> ) e elementos (por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Agendador</a> ) foram implementados. <br><br>  Bem, a capacidade dos desenvolvedores de aplicativos exibirem usando o design customizado em HTML pelos padr√µes do mundo dos sistemas de contabilidade √†s vezes possibilitou trazer uma variedade de destaques agrad√°veis ‚Äã‚Äã√† interface dos aplicativos de neg√≥cios. <br><br>  Com o passar do tempo, a plataforma come√ßou a dar suporte ao Linux primeiro e depois ao macOS.  O Internet Explorer n√£o era adequado para trabalhar com HTML nesses sistemas operacionais por raz√µes √≥bvias;  no Linux, usamos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">WebKitGTK +</a> e no macOs, uma biblioteca baseada em Cocoa.  Portanto, a unidade da base de c√≥digo para diferentes sistemas operacionais (que tentamos manter para o c√≥digo do cliente no n√≠vel de 95%) foi violada nessa √°rea.  Bem, o mecanismo do IE a essa altura se tornou a fonte de v√°rios problemas. <br><img src="https://habrastorage.org/webt/xo/c6/2k/xoc62k11ifqv9dfeunr279csd4q.png" alt="imagem"><br><a name="habracut"></a><br>  Os problemas: <br><br><ul><li>  O mecanismo do IE fechou o c√≥digo-fonte - significa: <br><ul><li>  N√£o √© poss√≠vel o ajuste flex√≠vel do motor √†s necessidades da plataforma </li><li>  Depura√ß√£o e compreens√£o de processos internos </li><li>  N√£o √© poss√≠vel corrigir bugs e erros atualizando a vers√£o do mecanismo </li></ul></li><li>  O mecanismo n√£o √© adequado para a implementa√ß√£o de tarefas modernas de programa√ß√£o da web </li><li>  Problemas de desempenho em m√°quinas fracas </li></ul><br>  Portanto, a tradu√ß√£o de trabalhar com HTML na vers√£o 1C: Enterprise for Windows do mecanismo do IE para outra coisa era √≥bvia.  O que escolher? <br><br>  Para come√ßar, formulamos os requisitos para o mecanismo: <br><br><ul><li>  Suporte para modernas tecnologias de programa√ß√£o da web </li><li> C√≥digo aberto para personaliza√ß√£o flex√≠vel do mecanismo e entendimento de sua l√≥gica </li><li>  Alto desempenho em computadores mais lentos </li><li>  √â desej√°vel que o mecanismo exija um pequeno n√∫mero de bibliotecas de terceiros para funcionar </li></ul><br><h2>  Sele√ß√£o do motor </h2><br>  O que escolher?  Come√ßamos, √© claro, com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">WebKit</a> , com o qual j√° trabalhamos em vers√µes da plataforma para Linux e macOS. <br><br>  O WebKit foi desenvolvido na Apple no in√≠cio dos anos 2000 com base nos mecanismos de c√≥digo aberto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">KHTML</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">KJS</a> .  Com base no WebKit, o navegador Safari foi criado posteriormente - Chrome (ainda mais tarde, o Chrome passou do WebKit para o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Blink</a> , que novamente se baseia no c√≥digo WebCore do WebKit). <br><br>  O c√≥digo fonte do WebKit √© de c√≥digo aberto e licenciado sob a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">LGPL</a> .  O WebKit foi escrito para o macOS, existem v√°rias portas para o Windows: <br><br><h3>  WebKit AppleWin </h3><br>  Essa √© a porta que os desenvolvedores do WebKit sugerem criar no Windows por padr√£o.  Foi fabricado por funcion√°rios da Apple em meados do final dos anos 2000.  Ele usa a biblioteca de gr√°ficos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CoreGraphics</a> , que √© uma vers√£o simplificada da biblioteca para macOS, portada para o Windows.  Para executar o JavaScript, a porta usa a biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">JavaScriptCore</a> com a mesma API usada na implementa√ß√£o da plataforma para Linux.  Isso o torna um excelente candidato para uso. <br><br><h3>  WebKit WinCairo </h3><br>  Essa porta usa a biblioteca do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cairo</a> para gr√°ficos.  H√° algum tempo, a Apple desenvolve ativamente essa porta como um an√°logo √† principal porta AppleWin.  A vantagem dessa porta √© que ela depende menos das bibliotecas espec√≠ficas do macOS que o CoreGraphics exige.  Al√©m disso, a porta usa a mesma biblioteca de gr√°ficos ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cairo</a> ) que o mecanismo WebKitGTK +, usado na implementa√ß√£o da plataforma Linux, o que √© bom para padronizar o comportamento do nosso c√≥digo. <br><br><h3>  QtWebKit </h3><br>  Outra implementa√ß√£o do mecanismo WebKit para Windows, agora independente dos desenvolvedores do pr√≥prio mecanismo.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O Qt</a> √© uma biblioteca popular de plataforma cruzada com sua pr√≥pria biblioteca de gr√°ficos QtGui.  Essa porta tamb√©m usa a biblioteca JavaScriptCore para manipular o JavaScript, no entanto, possui desvantagens: <br><br><ul><li>  Forte depend√™ncia dos principais componentes do Qt, que, se usados ‚Äã‚Äãem software de terceiros, precisar√£o ser entregues com ele </li><li>  Um conjunto diferente de interfaces para trabalhar com componentes para renderizar HTML em compara√ß√£o com o WebKitGTK e sua pr√≥pria l√≥gica para trabalhar com eles. </li></ul><br><h3>  WebKitGtk + para Windows </h3><br>  J√° usamos o WebKitGtk + na vers√£o Linux da plataforma.  Mas a op√ß√£o de us√°-lo no Windows foi descartada devido √† complexidade da montagem, √† documenta√ß√£o insuficiente desse processo e √† falta de suporte constante para essa √°rea de desenvolvimento por parte dos desenvolvedores do WebKitGTK +. <br><br><h3>  Cr√≥mio (intermitente) </h3><br>  O primeiro e √∫nico mecanismo n√£o semelhante ao WebKit, considerado um candidato para resolver o problema.  Foi rejeitado devido a grandes diferen√ßas na l√≥gica dos componentes para renderizar HTML em compara√ß√£o com o WebKitGTK + e outra biblioteca para trabalhar com JavaScript ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V8</a> ). <br><br><h3>  O que escolher? </h3><br>  Ap√≥s a pesquisa, AppleWin e WinCairo chegaram √† final. <br>  Para fazer a escolha final, estudamos como o WebKit funciona. <br><br><h2>  Estrutura do mecanismo WebKit </h2><br>  Normalmente, portas diferentes do WebKit diferem de duas maneiras.  A primeira √© diretamente a implementa√ß√£o de um sistema operacional espec√≠fico usando componentes espec√≠ficos do sistema operacional.  O segundo √© uma biblioteca de gr√°ficos.  A figura abaixo descreve as diferen√ßas nesse sentido entre as portas do WebKit.  Para o Windows, os desenvolvedores do WebKit criaram portas na biblioteca CoreGraphics e Cairo adaptada. <br><br><img src="https://habrastorage.org/webt/y5/m5/mo/y5m5moefn2yjpbt4ohq9iwqqqj4.png" alt="imagem"><br><br>  Um modelo simplificado do mecanismo: tr√™s mecanismos tradicionais para formatar uma p√°gina da web - HTML, JavaScript e CSS - s√£o alimentados no mecanismo, que forma e exibe a p√°gina a partir deles: <br><br><img src="https://habrastorage.org/webt/j4/2n/r5/j42nr5vmxoryxsbq-c_mxe9oots.png" alt="imagem"><br><br>  O pr√≥prio mecanismo consiste em v√°rios componentes: <br><br><ul><li>  WTF (Web Template Framework, n√£o o que voc√™ poderia ter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pensado</a> ): aqui voc√™ encontra suas pr√≥prias implementa√ß√µes de estruturas de dados para o funcionamento do mecanismo, al√©m de trabalhar com fluxos </li><li>  JavaScriptCore: um componente, como o nome indica, para trabalhar com a linguagem JavaScript </li><li>  WebCore: todo o trabalho com DOM, estilos, an√°lise de HTML e XML est√° escrito aqui.  Toda a "m√°gica" principal do mecanismo √© feita aqui. </li><li>  Plataforma: executa a√ß√µes t√©cnicas para interagir com a rede, colocar dados em um banco de dados, decodificar imagens, trabalhar com m√≠dia </li><li>  WebKit e WebKit2 API - vinculando todos os componentes e fornecendo acesso a eles </li></ul><br><img src="https://habrastorage.org/webt/ao/zr/gp/aozrgpbezfy8ex2ufhbnrzqf68e.png" alt="imagem"><br>  O relacionamento entre os componentes do WebKit e os recursos espec√≠ficos do SO √© mostrado na figura abaixo.  Como voc√™ pode ver, existem alguns pontos espec√≠ficos que precisam ser implementados para cada sistema operacional separadamente.  Embora o JavaScriptCore permita que voc√™ se use em cada porta sem implementa√ß√µes separadas. <br><br><img src="https://habrastorage.org/webt/r7/hz/c8/r7hzc8sbq6bcn_qpltvdzpimugu.png" alt="imagem"><br><br><h3>  Como uma p√°gina da web √© formada </h3><br>  A partir da rede, uma resposta chega a uma solicita√ß√£o ao servidor com dados para download.  O carregador passa os dados para o analisador, que, interagindo com o componente para JavaScript, forma o DOM e a folha de estilos.  Em seguida, os dados gerados s√£o transferidos para a √°rvore de renderiza√ß√£o e exibidos em um contexto gr√°fico. <br><img src="https://habrastorage.org/webt/k-/id/dh/k-iddhrnyvvcw8yzacaigtetlai.png" alt="imagem"><br>  A pr√≥pria p√°gina tamb√©m consiste em componentes individuais.  O componente WebCore implementa a classe Page, que permite acesso a toda a p√°gina.  A p√°gina possui um quadro principal - MainFrame, um quadro sempre possui um documento.  O quadro principal pode ter qualquer n√∫mero de outros quadros, tamb√©m com documentos dentro.  Para cada quadro, alguns eventos s√£o formados separadamente, bem como contextos gr√°ficos e JavaScript espec√≠ficos. <br><br><img src="https://habrastorage.org/webt/zv/fo/9c/zvfo9cqiclfhckd1wmzpnnv4jx4.png" alt="imagem"><br><br>  O analisador HTML simplificado funciona assim.  Do conjunto de bytes recebidos do servidor, o decodificador gera um conjunto de caracteres para an√°lise.  Os s√≠mbolos s√£o convertidos em tokens ou tokens, que geralmente s√£o trechos de c√≥digo elementares com metainforma√ß√µes sobre o tipo de texto, se faz parte da sintaxe ou do conte√∫do do idioma.  Em seguida, os n√≥s s√£o formados a partir de tokens para construir uma √°rvore DOM.  Um construtor de √°rvores de um conjunto de n√≥s forma um modelo de objeto completo para um documento de p√°gina da web. <br><br><img src="https://habrastorage.org/webt/iq/9q/b5/iq9qb5qwciws_d-rfzze2afuopw.png" alt="imagem"><br><br><h2>  Escolha final </h2><br><ul><li>  Applewin <ul><li>  Pr√≥s: <ul><li>  Implementado em uma biblioteca de gr√°ficos executada no macOS - a principal plataforma de destino para desenvolvedores do WebKit </li></ul></li><li>  Contras: <ul><li>  Falta de implementa√ß√£o do mecanismo de impress√£o </li><li>  Um grande n√∫mero de depend√™ncias </li></ul></li></ul></li><li>  Wincairo <ul><li>  Pr√≥s: <ul><li>  A mesma biblioteca de gr√°ficos (Cairo), usada na porta Linux da plataforma 1C </li></ul></li><li>  Contras: <ul><li>  Essencial para as nossas tarefas n√£o encontradas </li></ul></li></ul></li></ul><br>  Derrotado WinCairo.  Para o desenvolvimento, foi utilizada a vers√£o mais recente do WebKit dispon√≠vel na √©poca - 605.1.11. <br><br><h2>  Implementa√ß√£o </h2><br>  Embora o mecanismo seja bastante bem coberto por testes de unidade (cerca de 30.000 para todos os componentes do mecanismo, escritos pelos autores do mecanismo), existem erros e defici√™ncias nas implementa√ß√µes de sistemas operacionais "n√£o essenciais" (ou seja, para tudo que n√£o √© macOS).  Essas falhas de implementa√ß√£o foram gradualmente descobertas √† medida que o mecanismo foi desenvolvido e testado como parte da plataforma 1C: Enterprise. <br><br><h3>  Baixar HTML via Arrastar e Soltar </h3><br>  Ao arrastar o texto para a janela, verificou-se que, se o texto sendo arrastado contiver caracteres n√£o ASCII, os hier√≥glifos ser√£o inseridos no documento final.  O erro apareceu apenas na implementa√ß√£o do mecanismo do Windows, porque funcionava com um mecanismo espec√≠fico do SO para arrastar e soltar elementos.  Acontece que o texto n√£o foi decodificado de UNICODE para UTF-16 antes de ser passado para o manipulador de eventos de inser√ß√£o. <br><br><h3>  Alterar Shift + Enter Comportamento do teclado </h3><br>  Na maioria dos editores de texto (incluindo o Microsoft Word), essa combina√ß√£o insere uma quebra de linha.  O comportamento padr√£o do WebKit √© inserir um novo par√°grafo (como se estivesse simplesmente pressionando Enter).  Mudamos o mecanismo, tornando o comportamento mais familiar para os usu√°rios. <br><br><h3>  Organiza√ß√£o do mecanismo Desfazer e Refazer. </h3><br>  O WebKit fornece uma API para implementar seu pr√≥prio mecanismo para cancelar e repetir a√ß√µes do usu√°rio.  Seu esquema √© o seguinte: quando o usu√°rio executa uma certa a√ß√£o discreta do ponto de vista do mecanismo (por exemplo, alternando para um novo par√°grafo, formatando em it√°lico, colando), o WebKit informa o desenvolvedor sobre isso usando a API para que ele possa registrar esta a√ß√£o. <br><br>  No processo de teste do mecanismo implementado, uma coisa desagrad√°vel foi descoberta: o mecanismo n√£o relata altera√ß√µes na estrutura das tabelas.  Foram adicionados comandos para adicionar e remover c√©lulas e alterar o atributo colSpan, que se tornaram parte de a√ß√µes compostas, como, por exemplo, adicionar / remover uma coluna ou uma linha de uma tabela.  Esses comandos compostos s√£o registrados na mesma pilha de desfazer e refazer e, junto com os comandos do mecanismo, garantem a opera√ß√£o correta do mecanismo. <br><br><h3>  Colar do Excel </h3><br>  Aqueles que trabalharam com a √°rea de transfer√™ncia do Windows e o Excel podem saber que, em primeiro lugar, ao copiar do Excel para HTML, o formato da √°rea de transfer√™ncia no fragmento copiado cont√©m apenas as marcas de c√©lulas e linhas, mas n√£o a marca da tabela e, em segundo lugar, estilos de um documento do Excel n√£o s√£o transferidos para as c√©lulas.  Por esse motivo, inserir, por exemplo, uma tabela de cores em um elemento edit√°vel no Chrome se parece com o seguinte: <br><br>  Original: <br><br><img src="https://habrastorage.org/webt/gp/qu/fd/gpqufdcqtefrrio5zechwq0ufus.png" alt="imagem"><br><br>  No Chrome: <br><br><img src="https://habrastorage.org/webt/gf/6y/uu/gf6yuuqrxmu8il-7bgoeql7xtwy.png" alt="imagem"><br><br>  Esses dois fatores n√£o foram levados em considera√ß√£o pelos desenvolvedores do WebKit.  A abertura do c√≥digo do mecanismo nos permitiu refinar o mecanismo de inser√ß√£o, e agora o fragmento da tabela inserida no campo HTML do documento est√° pr√≥ximo ao original: <br><br><img src="https://habrastorage.org/webt/l8/pi/bo/l8piboap1-odjv6iwb2jd4zdhim.png" alt="imagem"><br><br><h3>  Gera√ß√£o de fonte em it√°lico </h3><br>  Se o Windows n√£o tiver uma vers√£o em it√°lico de uma fonte n√£o padr√£o, a maioria dos editores de texto poder√° gerar essa fonte usando sua vers√£o regular.  No entanto, o WebKit n√£o foi capaz de fazer isso e enganou os desenvolvedores algumas vezes: como √© que no c√≥digo HTML do documento colocamos o texto na tag &lt;i&gt;, mas, apesar disso, o texto permaneceu reto.  O motivo √© que o mecanismo WebKit seleciona a fonte correta na porta WinCairo que usamos - se n√£o houver vers√£o em it√°lico, o mecanismo usar√° a vers√£o regular.  Esse comportamento foi substitu√≠do pelo uso da fonte em it√°lico gerada pela biblioteca de gr√°ficos do Cairo. <br><br><h3>  Erros na decodifica√ß√£o de imagens e anima√ß√µes </h3><br>  Foram encontrados erros no comportamento do mecanismo ao trabalhar com elementos gr√°ficos.  Ao carregar algumas imagens no formato PNG, foi observada distor√ß√£o da imagem e, algumas vezes, sua aus√™ncia.  N√£o foi poss√≠vel descobrir o motivo desse comportamento, pois ocorre um erro ao decodificar imagens nas entranhas da biblioteca libpng. <br><br>  Empiricamente, verificou-se que, ao vincular a biblioteca libpng de maneira din√¢mica, em vez de est√°tica, o problema √© corrigido.  A prop√≥sito, na vers√£o atual do mecanismo, a vincula√ß√£o √© feita dessa maneira.  Foi decidido fazer o mesmo. <br><br>  Outro problema foi o mecanismo ao carregar anima√ß√µes no formato GIF.  O erro era reproduzido periodicamente ao carregar a p√°gina com essas anima√ß√µes e causava o travamento do programa.  O erro foi causado pela falta de sincroniza√ß√£o ao trabalhar com o buffer no qual o pr√≥ximo quadro da anima√ß√£o √© colocado.  O problema foi resolvido usando as ferramentas internas de sincroniza√ß√£o do WebKit. <br><br><h3>  Suporte de ortografia </h3><br>  Na montagem com o Internet Explorer, no Windows vers√£o 8 e posterior, a verifica√ß√£o ortogr√°fica pode ser ativada para o campo edit√°vel em HTML.  Para fazer isso, basta atribuir "verifica√ß√£o ortogr√°fica" igual a "true".  O WebKit tinha solu√ß√µes diferentes para portas diferentes: no Linux, √© a biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Enchant</a> , no macOS, possui seu pr√≥prio mecanismo, familiar a todos os usu√°rios de produtos da Apple.  Mas para o Windows n√£o h√° implementa√ß√£o, mas uma API √© fornecida para sua pr√≥pria solu√ß√£o.  Usamos a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">API de verifica√ß√£o ortogr√°fica</a> do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Windows</a> , dispon√≠vel a partir do Windows 8, e implementamos um mecanismo semelhante √† compila√ß√£o no Internet Explorer.  A prop√≥sito, agora em um documento formatado em clientes nativos 1C: Enterprise, essa funcionalidade tamb√©m funciona.  Antes da vers√£o 8.3.14, era desabilitada devido ao baixo desempenho do Internet Explorer. <br><br><h3>  Suporte para Windows XP </h3><br>  Alguns de nossos clientes ainda trabalham no Windows XP e n√£o atualizar√£o o sistema operacional no futuro pr√≥ximo.  Triste para n√≥s como desenvolvedores, mas √© verdade.  Ent√£o - precisamos apoi√°-los.  E aqui tivemos uma surpresa desagrad√°vel: os desenvolvedores do WebKit h√° cerca de um ano n√£o suportam o mecanismo no WinXP.  Uma tentativa de compilar uma vers√£o do mecanismo com um conjunto de ferramentas de compila√ß√£o para o WinXP n√£o teve √™xito - os desenvolvedores do WebKit usam bibliotecas que est√£o dispon√≠veis apenas no Windows Vista e vers√µes posteriores. <br><br>  O que fazer  As op√ß√µes foram as seguintes: <br><br><ol><li>  Deixe a implementa√ß√£o do WinXP com o mecanismo do Internet Explorer e use o WebKit em vers√µes mais antigas do Windows </li><li>  Leve para o desenvolvimento uma vers√£o anterior do mecanismo WebKit, que funciona no WinXP, e use esta vers√£o em todos os sistemas operacionais. </li><li>  Use a vers√£o apropriada do WebKit no WinXP e use o mecanismo mais recente nas vers√µes mais antigas do Windows </li><li>  Portar a vers√£o atual do mecanismo para o WinXP e us√°-lo em qualquer lugar </li></ol><br>  A quest√£o n√£o era simples.  A primeira op√ß√£o permitiu que voc√™ usasse a vers√£o mais recente do mecanismo WebKit, mas o for√ßaria a retornar a implementa√ß√£o antiga com o Internet Explorer.  Em tal solu√ß√£o, seria dif√≠cil garantir a opera√ß√£o sem erros do programa, e o pr√≥prio c√≥digo seria muito complicado.  A segunda op√ß√£o forneceu o mesmo comportamento em todos os sistemas operacionais Windows, no entanto, n√£o nos deixaria a oportunidade de desenvolvimento - atualizando o mecanismo para corrigir erros e obter novos recursos dos desenvolvedores do mecanismo em vers√µes posteriores.  A terceira op√ß√£o permitiu que voc√™ usasse a vers√£o atual do mecanismo em vers√µes mais antigas do Windows, mas complicou bastante a l√≥gica de instala√ß√£o e garantiu o mesmo comportamento de vers√£o em todos os sistemas operacionais.  A quarta op√ß√£o parecia prefer√≠vel a todas as outras, mas era imposs√≠vel prever a complexidade e, em geral, a possibilidade de tal solu√ß√£o. <br><br>  No entanto, decidimos arriscar e implementar a quarta op√ß√£o, a mais correta do ponto de vista arquitetural (usando um c√≥digo-fonte de mecanismo √∫nico em todas as vers√µes do Windows).  A vers√£o portada do WebKit funciona de maneira diferente no WinXP e nas vers√µes mais recentes do Windows: <br><br><ul><li>  Eu tive que abandonar as ferramentas do novo DirectX (d3d11) em favor do antigo DirectX9 (d3d9) e adaptar seus arquivos de cabe√ßalho √† vers√£o mais nova do SDK. </li><li>  As fun√ß√µes do novo SDK, quando executadas em novas vers√µes do Windows, s√£o chamadas no endere√ßo (obtido por meio de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GetProcAddress</a> ). </li><li>  Para transferir dados entre fluxos no mecanismo, o WinXP usa o armazenamento local Thread, em novas vers√µes - armazenamento local Fiber. </li></ul><br><h2>  Sum√°rio </h2><br>  Portanto, agora em nossa plataforma 1C: Enterprise a partir da vers√£o 8.3.14 (vers√£o final de 2018), o HTML ser√° suportado no n√≠vel mais alto - HTML5, OpenGL, etc.  Tanto a quantidade quanto a qualidade das passas que podem ser tomadas nas decis√µes em nossa plataforma s√£o limitadas apenas pela imagina√ß√£o do desenvolvedor.  E, no entanto, √© claro, o sistema operacional do cliente - no WinXP, muitos p√£es saborosos em HTML5 n√£o funcionam, por raz√µes √≥bvias. <br><br>  Agora, os aplicativos Windows na plataforma 1C: Enterprise poder√£o mostrar isso: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/zL6beG-cNEI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Mas, usando os "benef√≠cios" do HTML em solu√ß√µes de aplicativos, n√£o esque√ßa o bom senso.  O uso de HTML √© apropriado e recomendado para tarefas especializadas (exibindo ajuda, t√©cnicas, descri√ß√µes de produtos, ...), mas n√£o para implementar tarefas de l√≥gica de neg√≥cios (entrada / sa√≠da de informa√ß√µes estruturadas).  Para fazer isso, voc√™ precisa usar os mecanismos de interface 1C: Enterprise padr√£o que fornecem suporte autom√°tico para direitos de acesso, gerenciamento de funcionalidade, adapta√ß√£o ao fator de forma do dispositivo, suporte para configura√ß√µes do usu√°rio e o trabalho de muitos outros mecanismos, sem os quais a opera√ß√£o completa de um aplicativo de neg√≥cios se torna quase imposs√≠vel. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt425713/">https://habr.com/ru/post/pt425713/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt425703/index.html">Kafka na Wargaming: Blitz</a></li>
<li><a href="../pt425705/index.html">Replica√ß√£o do Percona Server para MySQL para PostgreSQL usando a ferramenta pg_chameleon</a></li>
<li><a href="../pt425707/index.html">Sistema de notifica√ß√£o do console para o Telegram</a></li>
<li><a href="../pt425709/index.html">Fizemos um memorando para os chineses que vieram at√© voc√™</a></li>
<li><a href="../pt425711/index.html">Perda de linha incompat√≠vel</a></li>
<li><a href="../pt425715/index.html">Programa educacional em qu√≠mica: revers√£o √°cida de microcircuitos (como expor um cristal de um microcircuito para sua posterior fotografia)</a></li>
<li><a href="../pt425717/index.html">Rede neural para desenvolvedores de C ++</a></li>
<li><a href="../pt425719/index.html">Aipo em projetos ocupados: um pouco de pr√°tica</a></li>
<li><a href="../pt425723/index.html">O Facebook est√° desenvolvendo ativamente um servi√ßo para encontrar trabalho e contratar funcion√°rios em uma rede social</a></li>
<li><a href="../pt425725/index.html">Caso de Patentes da Nintendo - Game Boy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>