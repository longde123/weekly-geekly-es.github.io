<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👚 🤸🏿 🚓 Rekko Challenge-如何在推荐系统的创建中获得第二名 💆🏼 👨‍👧‍👧 📤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="大家好 我在Tinkoff的团队正在构建推荐系统。 如果您对每月的现金返还感到满意，那么这就是我们的业务。 我们还建立了合作伙伴特别优惠的推荐系统，并在Tinkoff应用程序中收集了个人故事集。 而且，我们喜欢参加机器学习竞赛，以保持自己的健康状态。 


 从2月18日到4月18日，为期两个月的竞...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rekko Challenge-如何在推荐系统的创建中获得第二名</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tinkoff/blog/454818/"><p> 大家好 我在Tinkoff的团队正在构建推荐系统。 如果您对每月的现金返还感到满意，那么这就是我们的业务。 我们还建立了合作伙伴特别优惠的推荐系统，并在Tinkoff应用程序中收集了个人故事集。 而且，我们喜欢参加机器学习竞赛，以保持自己的健康状态。 </p><br><p> 从2月18日到4月18日，为期两个月的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">竞赛</a>在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Boosters.pro上</a>进行，目的是基于来自俄罗斯最大的在线电影院<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Okko的</a>真实数据构建推荐系统。 组织者旨在改善现有的推荐系统。 目前，竞赛<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">以沙盒模式</a>进行，您可以在其中测试您的方法并磨练构建推荐系统的技能。 </p><br><p><img src="https://habrastorage.org/webt/lv/1c/rj/lv1crjkiorbmthzwkmprnoqdusa.png" alt="alt_text"></p><a name="habracut"></a><br><h1 id="opisanie-dannyh"> 资料说明 </h1><br><p> 可通过电视或智能手机上的应用程序或通过Web界面来访问Okko中的内容。 内容可以租用，购买（P）或按订阅查看（S）。 比赛的组织者提供了N天（N&gt; 60）的观看数据，此外，还提供了有关评分和添加的书签的信息。 值得牢记的一个重要细节是，如果用户多次观看一部电影或该系列的几集，那么平板电脑中只会记录最后一次交易的日期和每单位内容花费的总时间。 </p><br><p><img src="https://habrastorage.org/webt/qy/w5/2z/qyw52zw89wafhju80zo73p3uxya.png" alt="alt_text"></p><br><p> 为50万用户提供了约1000万笔交易，45万个评级和95万个书签事实。 </p><br><p><img src="https://habrastorage.org/webt/nz/g6/_g/nzg6_gexjoxdvmsng8lkjcm9_m8.png" alt="alt_text"></p><br><p> 该样本不仅包含活跃用户，还包含在整个时期内观看了几部电影的用户。 </p><br><p> Okko目录包含三种类型的内容：电影（电影），系列（系列）和系列电影（multipart_movie），总共10,200个对象。 对于每个对象，都有一组匿名属性和属性（feature_1，...，feature_5），订阅，出租或购买的可用性和持续时间。 </p><br><p><img src="https://habrastorage.org/webt/ww/z3/wj/wwz3wjub5-tgvdrpjkinmi8ojgg.png" alt="alt_text"></p><br><h1 id="celevaya-peremennaya-i-metrika"> 目标变量和指标 </h1><br><p> 该任务需要预测用户在未来60天内将要使用的大量内容。 据信，如果用户： </p><br><ul><li> 买或租 </li><li> 通过订阅观看电影的一半以上 </li><li> 订阅观看该系列节目的三分之一以上 </li></ul><br><p><img src="https://habrastorage.org/webt/hs/62/an/hs62anr4vai9g-7aivjqq8gfjek.png" alt="alt_text"></p><br><ul><li>  <strong>r_u（i）</strong> -用户u是否在位置i（1或0）处消费了对其预测的内容 </li><li>  <strong>n_u-</strong>用户在测试期间消耗的元素数 </li><li>  <strong>U-</strong>许多测试用户 </li></ul><br><p> 您可以从这篇<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章中</a>了解有关排名任务的指标的更多<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">信息</a> 。 </p><br><p> 大多数用户都看完电影为止，因此，积极类别的交易份额为65％。 使用来自所提供样本的5万名用户的子集评估了算法的质量。 </p><br><h1 id="agregirovannyy-reyting"> 综合评分 </h1><br><p> 竞争决定始于将所有用户与内容的互动汇总到一个评分等级中。 假定如果用户购买了内容，则意味着最大的兴趣。 电影比系列短，因此，要从整体上观看该系列，您需要给出更多分数。 结果，根据以下规则形成了总评级： </p><br><ul><li> 电影份额* 5 </li><li> 电视节目分享* 10 </li><li>  [给电影添加书签] * 0.5 </li><li>  [为系列添加书签] * 1.5 </li><li>  [内容的购买/租赁] * 15 </li><li> 评分+ 2 </li></ul><br><h1 id="model-pervogo-urovnya"> 一级模型 </h1><br><p> 组织者提供了基于Tf-IDF量表的协作过滤的基本解决方案。 将所有类型的互动添加到汇总评分中，将最近邻居的数量从20增加到150，并用BM25权重替换Tf-IDF，从而在LB（排行榜）上淘汰了约<strong>0.03</strong> 。 </p><br><p> 受<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在2018年RecSys挑战赛中获得第三名的团队的</a>启发，我选择了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WARP</a>损失的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">LightFM</a>模型作为第二基本模型。 带有选定超参数的LightFM（学习率，no_components，item_alpha，user_alpha，max_sampled）在LB上给出<strong>0.033</strong> 。 </p><br><p><img src="https://habrastorage.org/webt/le/km/ak/lekmakeznlccijkuu24mnvqlcsm.png" alt="alt_text"></p><br><p> 模型的验证是按时进行的：互动的前80％落入了火车，其余的20％进入了验证。 对于LB提交，使用选择用于验证的参数对整个数据集训练模型。 </p><br><h1 id="blending-modeley"> 模型融合 </h1><br><p> 在上一阶段，事实证明建立了两个强有力的基准，此外，他们的建议平均相交了建议内容的60％。 如果有两个强相关且同时弱相关的模型，则将它们融合是一个合理的步骤。 </p><br><p><img src="https://habrastorage.org/webt/2-/5x/ya/2-5xyaedg2u-tqzbjr80v-49j38.png" alt="alt_text"></p><br><p> 在这种情况下，模型得分属于不同的分布并且具有不同的等级，因此决定使用等级的总和来组合两个模型。 模型混合在LB上产生<strong>0.0347</strong> 。 </p><br><p><img src="https://habrastorage.org/webt/b4/8e/m4/b48em4d9um22gvkdttdp8i-heco.png" alt="alt_text"></p><br><h1 id="model-vtorogo-urovnya"> 二级模型 </h1><br><p> 推荐系统通常使用两级方法来构建模型：首先，通过简单的第一级模型选择排名靠前的候选人，然后通过添加大量功能的更复杂的模型对排名靠前的候选人进行排名。 </p><br><p><img src="https://habrastorage.org/webt/e5/ll/db/e5lldbt4k4ncxq5uiqbk61l8doc.png" alt="alt_text"></p><br><p> 数据集在时间上分为训练和验证部分。 为每个用户的验证部分收集了一系列建议，其中包括结合顶级200预测的第一级模型和已观看电影的预测。 此外，还需要教导模型为每个用户重新排列最终的顶部。 该问题是根据二进制分类提出的。 仅当用户在验证期间消费了内容时，对（用户，内容）才属于肯定类别。 作为第二级模型，使用了梯度增强，即LightGBM软件包。 </p><br><h2 id="priznaki"> 迹象 </h2><br><p> 配对（用户，内容）的第一级模型以速度的形式评估相关性，并按降序排序以获得排名。 对模型进行了等级和速度标志训练，再加上内容目录中的标志，在LB上剔除了<strong>0.0359</strong> 。 </p><br><p> 从第一个匿名特征的发行形式可以得出结论，这是电影在目录中出现的日期，因此，使用选定的验证方案对该模型进行了严格的重新训练。 从样品中去除特征会导致LB增加至<strong>0.0367</strong> </p><br><p> 除了为用户预测内容的相关性之外，LightFM模型还返回两个向量：项目偏好和用户偏好，这两个向量分别与内容的受欢迎程度和用户观看的电影数量相关。 添加符号将LB的速度提高到<strong>0.0388</strong> 。 </p><br><p> 您可以在删除已观看的电影之前或之后为一对（用户，内容）分配等级。 方法的改变后者使LB增加到<strong>0.0395</strong> 。 </p><br><p><img src="https://habrastorage.org/webt/dm/ux/h_/dmuxh_6p9obkaumaeimtritdre0.png" alt="alt_text"></p><br><p> 几乎没有人看过电影目录中的很大一部分。 从样本中删除了少于100个用户观看的内容，以训练第二级模型，这使目录减少了一半。 移除不受欢迎的内容使得从第一级模型中进行选择更加相关，并且只有在此之后，LightFM的用户向量才提高了验证速度，并将LB增加到<strong>0.0429</strong> 。 </p><br><p> 此外，添加了一个标志-用户将书签添加到了书中，但没有查看火车时间段，这将LB的速度提高到<strong>0.0447</strong> 。 另外，添加了有关第一次和最后一次交易的日期的标志，它们使LB的<strong>速度提高</strong>到<strong>0.0457</strong> 。 </p><br><p><img src="https://habrastorage.org/webt/jy/4_/0v/jy4_0vcyt5ndutilvgqmbcivlkq.png" alt="alt_text"></p><br><p> 我们将最终考虑该模型。 最重要的是来自第一级模型的标志和来自内容目录的匿名标志。 </p><br><p> 以下功能并未增加到最终模型中： </p><br><ul><li> 书签数量+书签中已查看内容的份额<strong>-0.0453</strong>磅 </li><li> 购买的胶片数量<strong>0.0451</strong>磅 </li></ul><br><p> 但是当与最终模型融合时，他们在LB上淘汰了<strong>0.0465</strong> 。 受融合结果的启发，以下模型分别进行了训练： </p><br><ul><li> 在第一级模型中使用不同比例的训练样本。  90％/ 10％的分配增加了，而95％/ 5％和70％/ 30％的分配却有所增加。 </li><li> 使用改良的评分汇总方法。 </li><li> 在第二级模型的训练集中增加了不受欢迎的电影。 对于每个内容单元，共编译了1000个用户。 </li></ul><br><p>  6个模型的最终融合使LB达到<strong>0.0469678</strong> ，对应第5位。 </p><br><p><img src="https://habrastorage.org/webt/zu/tk/zm/zutkzmaxdgaatxyk5qddhdo5dda.png" alt="alt_text"></p><br><p> 在私密部分，发生了一场大变革，将解决方案推到了第二位。 我认为，由于大量模型的融合，该解决方案证明是可持续的。 </p><br><p><img src="https://habrastorage.org/webt/rm/qo/8q/rmqo8ql3pgwas205pr5peg49hoy.png" alt="alt_text"></p><br><h1 id="ne-zashlo"> 未输入 </h1><br><p> 在解决比赛的过程中，产生了许多似乎肯定会进入的迹象，但可惜。 最值得信赖的标志和方法： </p><br><ul><li> 匿名内容属性。 不确定其中包含的内容，但是比赛中的所有参与者都认为它们包含有关演员，导演，作曲家的信息。在我的决定中，我尝试将它们添加为几种格式：最受欢迎的二进制字符，列出了内容矩阵使用LightFM和BigARTM设置属性，然后拉出向量并将其添加到第二级模型。 </li><li> 二级模型中LigthFM模型的内容向量。 </li><li> 用户从中查看内容的设备的属性。 </li><li> 降低二级模型流行内容的权重。 </li><li> 电影/电视节目相对于已观看内容总数的比例。 </li><li> 来自CatBoost的排名指标。 </li></ul><br><h1 id="interesnye-fakty-o-sorevnovanii"> 有关比赛的有趣事实 </h1><br><ul><li> 事实证明，Top1解决方案比Okko产品型号0.048和0.062差。 应该记住的是，产品模型在采样时已经启动。 </li><li> 比赛开始大约一周后，数据集发生了变化，对于那些从一开始就参加比赛的人，他们添加了30份参赛作品，但在两支球队合并后却被意外烧毁。 </li><li> 验证并不总是与LB相关，这表明可能会发生变化。 </li></ul><br><h1 id="kod-resheniya"> 决策代码 </h1><br><p> 该解决方案以两个jupyter-laptop的形式在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github</a>上可用：评级聚合，第一和第二级的训练模型。 <br> 第三名的解决方案也可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github上找到</a> 。 </p><br><h1 id="reshenie-organizatorov"> 组织者的决定 </h1><br><p> 我附上了组织者的主要特点，而不是一千个字。 </p><br><p><img src="https://habrastorage.org/webt/xa/yg/gx/xayggxsl3bpargxaeinl8wgsbhy.jpeg" alt="alt_text"></p><br><p> 此外，来自Okko的家伙<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">发表了一篇文章</a> ，讨论了推荐引擎的开发阶段。 </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在这里的</a> PS中<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">，您可以</a>在Data Fest 6上<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">看到</a>有关此问题解决方案<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的</a>性能。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN454818/">https://habr.com/ru/post/zh-CN454818/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN454804/index.html">使用微模板创建组件</a></li>
<li><a href="../zh-CN454806/index.html">培训Cisco 200-125 CCNA v3.0。 第9天。交换机的物理世界。 第一部分</a></li>
<li><a href="../zh-CN454808/index.html">关于航天器和太空。 如何在整个过程中更改整个产品来制作功能</a></li>
<li><a href="../zh-CN454810/index.html">火星上的新鲜空气：弯曲二氧化碳分子并吸收氧气</a></li>
<li><a href="../zh-CN454816/index.html">在WSL下配置php-fpm + nginx捆绑包</a></li>
<li><a href="../zh-CN454820/index.html">Azure搜索</a></li>
<li><a href="../zh-CN454824/index.html">离散元件上最简单的运算放大器</a></li>
<li><a href="../zh-CN454826/index.html">使用hashget将备份减少99.5％</a></li>
<li><a href="../zh-CN454828/index.html">创建马赛克图片</a></li>
<li><a href="../zh-CN454830/index.html">成功的产品经理的三项关键素质：亚历山大·别利亚耶夫（Alexander Belyaev）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>