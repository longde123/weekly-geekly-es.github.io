<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“ ğŸ‘Š ğŸ˜« Die innere Welt der Formanten P432 ğŸ“‰ ğŸ¦• ğŸ™‹ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die Geschichte, wie ich unerwartet einen Synthesizer gekauft, repariert, herausgefunden und einen Emulator geschrieben habe. 

 Diese Geschichte began...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Die innere Welt der Formanten P432</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482292/"><img src="https://habrastorage.org/webt/dv/3b/pd/dv3bpdmwtjhonhrkr64jbohha3m.jpeg"><br><br>  Die Geschichte, wie ich unerwartet einen Synthesizer gekauft, repariert, herausgefunden und einen Emulator geschrieben habe. <br><a name="habracut"></a><br>  Diese Geschichte begann wÃ¤hrend des <a href="https://2019.chaosconstructions.ru/" rel="nofollow">Chaos Constructions</a> Festivals am letzten Wochenende im August 2019.  Als ich abends in Avito nach interessanten Artefakten vergangener Zeiten suchte, stieÃŸ ich auf einen billigen Formant P432-Synthesizer.  Bei digitalen Synthesizern sah es recht vertraut aus: Im unteren Teil befindet sich eine Tastatur mit 41 Tasten (3,5 Oktaven), im oberen Teil befinden sich Tasten zum AuswÃ¤hlen eines Tons, zum Einschalten der Chorus- und Unisono-Effekte sowie KnÃ¶pfe zum Einstellen des Vibrato-Effekts.  Links neben der Tastatur befindet sich ein Joystick, mit dem Sie die TonhÃ¶he nach oben und unten verschieben und das Vibrato reibungslos anschlieÃŸen kÃ¶nnen. <br><br>  Das Interessanteste fÃ¼r mich war, dass dieser Synthesizer digital war und KlÃ¤nge mit der Wavetable-Methode erzeugte, dh, zum Zeitpunkt des Tastendrucks erzeugte er KlÃ¤nge basierend auf in ROM-Chips gespeicherten Tabellendaten.  Nach einem kurzen Kennenlernen der Schaltkreise im Internet wurde klar, dass die Synthesizer-Steuerung auf dem bekannten Mikroprozessor KP580VM80 (i8080) aufbaut und die Sounds in 8 ROM-Chips mit einem Gesamtvolumen von 8 * 2 = 16 Kb gespeichert sind. <br><br>  Der Synthesizer wurde gekauft und fuhr langsam von der Stadt des VerkÃ¤ufers zum Ã¶rtlichen BÃ¼ro des Transportunternehmens, und ich fuhr fort, die PlÃ¤ne zu studieren.  Der VerkÃ¤ufer schrieb in einer Anzeige, dass das Werkzeug einen Defekt aufweist, der sich in Form eines Keuchens bemerkbar macht, wenn Sie mehr als eine Taste drÃ¼cken.  Umso interessanter, dachte ich.  "Es wird notwendig sein, zu finden und zu beseitigen." <br><br>  Das Hauptmotiv fÃ¼r den Kauf war jedoch der Wunsch, sich mit dem internen GerÃ¤t zu befassen und Klangbeispiele aus dem ROM des Synthesizers zu extrahieren. <br><br>  <b>HAFTUNGSAUSSCHLUSS</b> : Die Namen der Komponenten der Synthesizer-Knoten und -Signale (auÃŸer den in AnfÃ¼hrungszeichen und in GROSSEN Buchstaben angegebenen) wurden von mir erfunden und kÃ¶nnen von den von den Entwicklern beabsichtigten abweichen.  Die Beschreibung der Funktionsweise der Knoten basiert auf meinen (begrenzten) Kenntnissen, Materialien aus dem Internet und dem Rat erfahrener Personen. <br><br><h3>  Reparieren </h3><br>  Als P432 [ <a href="https://habr.com/ru/post/482292/">2</a> ] sicher zu mir kam, war das erste, was ich tat, es auseinanderzunehmen.  Drinnen erwartete ich keinen sehr angenehmen Anblick von BÃ¼ndeln von DrÃ¤hten und mehreren Leiterplatten. <br><br><div class="spoiler">  <b class="spoiler_title">Steuerknoten</b> <div class="spoiler_text">  Die Platine, auf der die Tasten und Bedienelemente auf der Frontplatte eingelÃ¶tet sind, sowie eine Anzeige der BetriebszustÃ¤nde. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Prozessorknoten</b> <div class="spoiler_text">  Es enthÃ¤lt den Mikroprozessor KR580VM80 und weitere 580 Chips, 2 KB ROM auf RF2 sowie zwei statische RAM-Chips mit einer GesamtkapazitÃ¤t von 256 Byte (K541RU2).  AuÃŸerdem sind auf der Karte Decoder installiert, die Teile des Adressraums fÃ¼r die Interaktion mit der Tastatur mit Steuertasten und Registern zuweisen, an deren Ausgang Steuersignale fÃ¼r den Generatorknoten erzeugt werden. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">MIDI Interface Node</b> <div class="spoiler_text">  Es ist oberhalb des Prozessorknotens installiert und besteht aus einem separaten ROM mit MIDI-Messaging-Routinen, feiner Logik und zwei groÃŸen Mikroschaltkreisen: dem VN59-Interrupt-Controller und der in Reihe geschalteten BB51-Schnittstelle.  An die TX / RX VN51-Kontakte ist eine Standard-Midi-Stromschleifen-Implementierungsschaltung mit Optokoppler-Isolation angeschlossen. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Chor Knoten</b> <div class="spoiler_text">  In Form einer isolierten Karte mit nur analogem Eingang, Ausgang und Leistung.  Es ist in KA528BR2-Mikroschaltungen implementiert - analoge VerzÃ¶gerungsleitungen.  Das GerÃ¤t ist sehr laut, verleiht dem Klang jedoch eine interessante Farbe. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Generatoranordnung</b> <div class="spoiler_text">  Das Hauptmodul des Synthesizers.  Es enthÃ¤lt 8 ROM-Chips mit je 2 KB, digitale Logik (Register, Addierer), zwei DACs, ein analoges Filter mit variablen Parametern und eine thermische Stabilisierung.  Der Knoten enthÃ¤lt auch einen Taktgenerator, mit dem der Betrieb der Register des Prozessorknotens synchronisiert wird.  Die Tochterplatine dieses Knotens verfÃ¼gt Ã¼ber eine VCO-Platine (Voltage Controlled Generator), die eine Weiterentwicklung spÃ¤terer Versionen des Synthesizers darstellt. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Baugruppe aus Gleichrichter und Stabilisator</b> <div class="spoiler_text">  Ein lineares Netzteil, das + 5V fÃ¼r Logikstrom und + 12 / -15V fÃ¼r OperationsverstÃ¤rker erzeugt.  + 5V wird durch KR142EN5 stabilisiert, dessen Strahler das MetallgehÃ¤use des Synthesizers ist, und + 12 / -15V ist der einfachste parametrische Stabilisator fÃ¼r Zenerdioden und Transistoren.  Eine zusÃ¤tzliche Versorgungsspannung von -5V fÃ¼r den KR580VM50 wird durch eine Zenerdiode von -15V direkt auf der Prozessorplatine gebildet.  Analoge und digitale Masse sind getrennt und werden nur in diesem Block angeschlossen. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Instrumententastatur</b> <div class="spoiler_text">  Reed-Schalter, nicht anschlagdynamisch, wie bei anderen Synthesizern der Kachkanar-Radiofabrik von Formant. <br></div></div><br><img src="https://habrastorage.org/webt/ug/qe/2x/ugqe2xza93bmihgm3hhezgz9qxi.jpeg"><br><br>  Das Entfernen des MIDI-Knotens auf einer separaten Karte mit ROM ist darauf zurÃ¼ckzufÃ¼hren, dass ein anderer Synthesizer in der P432-Reihe vorhanden ist - der â€Formant MINIâ€œ, der keine MIDI-Schnittstelle und keinen HOR-Effekt hat.  Der MINI-Prozessorknoten unterscheidet sich geringfÃ¼gig in der Firmware, und der Generatorknoten ist der gleiche wie bei P432. <br><br>  Beim ersten Einschalten fielen mir also zwei Probleme auf: ein sehr schwacher Signalpegel am linearen Ausgang und der bereits erwÃ¤hnte Ton, wenn mehr als eine Taste gleichzeitig gedrÃ¼ckt wurde.  Es ist zu beachten, dass der P432 ein polyphoner Synthesizer ist und gleichzeitig 4 Stimmen (Frequenzen) eines Timbres spielen kann.  Mit dem UNISON-Effekt erhÃ¶ht sich die Anzahl der gleichzeitig gesprochenen Stimmen auf 8, zwei fÃ¼r jede Taste. <br><br>  Der Grund fÃ¼r das leise GerÃ¤usch wurde fast sofort gefunden, der verbrannte Ausgang OU K544UD1A war schuld. <br><br>  Nach dem Ersetzen begann das Instrument laut zu klingen, auch wenn passive KopfhÃ¶rer an den Ausgang angeschlossen waren. <br><br>  Aber mit seltsamen GerÃ¤uschen war die Situation sehr unverstÃ¤ndlich, denn selbst wenn einzelne Tasten gedrÃ¼ckt wurden, entsprachen die GerÃ¤usche der TÃ¶ne nicht der P432-Demonstration von YouTube. <br><br>  Es dauerte eine Weile, bis das Problem gefunden wurde, aber am Ende wurde es auf der Ebene des Haupt-DAC lokalisiert.  Das High-Bit des Digitaleingangs reichte nicht aus, um es als logische 1 zu erkennen, sodass das analoge Ausgangssignal verzerrt war.  Der TÃ¤ter dieser Geschichte wurde gefunden und beseitigt, woraufhin das Problem behoben wurde.  Alle TÃ¶ne begannen klar und ohne Probleme mit ein paar Klicks zu klingen. <br><br>  Es wÃ¼rde ein Ende der Geschichte geben, aber es wurde bereits viel Zeit fÃ¼r die Reparatur aufgewendet, und ich entschied, dass wir hier nicht aufhÃ¶ren sollten, und wir mÃ¼ssen es herausfinden: <br><br><ul><li>  Wie ist der Klangsynthesevorgang? </li><li>  Was ist in dem ROM der Generatoreinheit gespeichert </li><li>  Wie der Filter funktioniert und welche Eigenschaften hat er? </li><li>  wo die Konfiguration fÃ¼r jeden Ton und HÃ¼llkurvenparameter gespeichert wird </li></ul><br>  Das Ergebnis dieser Arbeit war die Software-Emulation von P432 unter Verwendung von Daten aus dem ursprÃ¼nglichen ROM. <br><br><h3>  Generatoranordnung </h3><br>  Die Wellenform am Ausgang des Haupt-DAC der Generatoreinheit wird nach dem Prinzip der direkten digitalen Synthese (DDS) gebildet [ <a href="https://habr.com/ru/post/482292/">1</a> ].  Das empfangene analoge Signal wird durch ein Tiefpassfilter geleitet, dann, falls erforderlich, mit dem Ausgang der Choranordnung gemischt, durch einen AusgangsverstÃ¤rker verstÃ¤rkt und einem linearen Ausgang zugefÃ¼hrt.  Der Filter in P432 wird gemÃ¤ÃŸ dem zuvor im Polyvox-Synthesizer verwendeten Schema hergestellt [ <a href="https://habr.com/ru/post/482292/">3</a> ]. <br><br><img src="https://habrastorage.org/webt/ts/7l/5c/ts7l5cybnhehm2zl7btvloqsorq.png"><br>  <i>Das Diagramm zeigt die Generatoreinheit und ihre HauptfunktionsblÃ¶cke.</i>  <i>Orange Pfeile kennzeichnen Ein- und AusgÃ¤nge externer digitaler Signale, schwarz - digitale Signale im Modul, blau - analoge Signale.</i> <i><br></i> <br><br>  Betrachten Sie zunÃ¤chst die Ein- und AusgÃ¤nge: <br><br><ul><li>  Input â€œFrequencyâ€ (11 Bit) - FÃ¼r jede Voice, einschlieÃŸlich Unisono, stammen die Werte, die der gedrÃ¼ckten Taste oder der MIDI-Note entsprechen, vom Prozessorknoten. <br></li><li>  VerstÃ¤rkereingang (8 Bit) - Der HÃ¼llkurvenwert fÃ¼r die Signalamplitude. </li><li>  Input â€œFilterâ€ (8 Bit) - Werte der HÃ¼llkurve der Grenzfrequenz des Filters. </li><li>  â€Controlâ€œ -Eingang - (8 Bit) - 3 niedrigstwertige Bits sind fÃ¼r die Wellenformauswahl verantwortlich, 2 Bits fÃ¼r den Filter-Offset, 2 weitere fÃ¼r die Q-Filter-QualitÃ¤tsstufe Q (Resonanz) und das letzte Bit bestimmt, ob der UNISON-Effekt ein- oder ausgeschaltet ist. </li><li>  Ausgang â€Adresseâ€œ (3 Bit) - verantwortlich fÃ¼r die Synchronisation mit dem Prozessorknoten. </li></ul><br>  Nun wollen wir sehen, wie die HauptblÃ¶cke des Knotens funktionieren. <br><br>  Die Synchronisationsschaltung erzeugt mit Hilfe von Multivibratoren, einem ZÃ¤hler und Logikelementen Steuerimpulse fÃ¼r verschiedene Module der Generatoreinheit und gibt die aktuelle Sprachnummer an den Ausgang â€Adresseâ€œ.  Wenn der UNISON "Address" -Modus aktiv ist, werden die Werte [0,1,2,3,4,5,6,7] und inaktiv: [0,2,4,6] verwendet.  Die Frequenz des Master-Oszillators kann mit dem Einstellknopf an der Vorderseite und dem Joystick links neben der Tastatur geringfÃ¼gig geÃ¤ndert werden. <br><br><img src="https://habrastorage.org/webt/kc/m2/cf/kcm2cfudodvfljpi178cyw3yy3k.png">  <i>Zeitdiagramm der Taktimpulse.</i>  <i>ErlÃ¤uterungen: Unison - Log.</i>  <i>0 aktiver Pegel, FA0-2 - "Adresse" -Ausgang, DD8-12 - Phasenakkumulatorregister, DD33-35 - Stimmengesamtregister, DD36-37 - DAC-Register.</i> <i><br></i> <br><br>  Der digitale Teil der Generatorplatine fÃ¼r jede von 4 (8) Stimmen fÃ¼hrt gleichzeitig mit einer Ã„nderung des Werts des Ausgangs â€Adresseâ€œ die folgenden Operationen aus.  Vom Prozessorknoten empfÃ¤ngt der Eingang â€Frequenzâ€œ die Signalfrequenzwerte.  Der lineare Wert der Frequenz wird vom Decoder im ROM in Phaseninkrement umgewandelt.  Die Inkremente werden im Phasenakkumulator (20 Bit) summiert, der aus einem Addierer und einem 8-Wort-RAM besteht.  Die hÃ¶chsten 9 Bits der Summe werden den AdresseneingÃ¤ngen des Wellenform-ROM zugefÃ¼hrt.  Ein bestimmter ROM-Bereich wird durch die drei niedrigstwertigen Bits des Eingangs "Control" ausgewÃ¤hlt.  10 Bits vom Ausgang des ROM werden mit dem Wert am Eingang des "VerstÃ¤rkers" summiert und den EingÃ¤ngen des Skalierungs-ROM zugefÃ¼hrt, der einen Bipolarcode fÃ¼r den DAC erzeugt.  Die Ausgabe fÃ¤llt in den Akkumulationspuffer, der aus Addierern und Registern besteht und der nacheinander die Codewerte aller 4 (8) Stimmen summiert.  Am Ende jedes Zyklus wird der endgÃ¼ltige Code vom Speicherregister zwischengespeichert und gelangt zum 12-Bit-DAC.  Die Frequenz, mit der der Code auf dem DAC ausgegeben wird, ist die Abtastfrequenz des Signals und fÃ¼r P432 etwa 33 Kilohertz.  Laut Nyquist betrÃ¤gt die maximale Schallfrequenz, die dem P432-Generator zur VerfÃ¼gung steht, ungefÃ¤hr 16,5 kHz. <br><br>  Wenn das ausgewÃ¤hlte Timbre eine dynamische Ã„nderung der Tiefpassfilterparameter erfordert, werden die HÃ¼llkurvenwerte an den Filtereingang ausgegeben, der Ã¼ber den 10-Bit-DAC die Steuerspannung fÃ¼r das OperationsverstÃ¤rkerfilter bildet.  Das Tiefpassfilter ist gemÃ¤ÃŸ dem Nichtkondensatorfilter des Filters mit variablem Zustand hergestellt und enthÃ¤lt eine Temperaturstabilisierungsschaltung, einen Block zum Ã„ndern des Q-Faktors von Q und die anfÃ¤ngliche Vorspannung. <br><a name="dia1"></a><br><img src="https://habrastorage.org/webt/ii/fh/bq/iifhbqm2guxdn1b2vpagozcg9l8.png"><br>  <i>Dieses Zeitdiagramm zeigt zwei Diskretisierungsperioden der Generatorplatine.</i>  <i>UNISON ist aus.</i>  <i>Der Frequenzeingang (Freq_in) empfÃ¤ngt synchron zur AdressÃ¤nderung die Frequenznummern von vier verschiedenen Tasten.</i>  <i>Es werden jedoch nur die letzten beiden gedrÃ¼ckt (Volume_in = 0xFF).</i>  <i>Gleichzeitig wird ein konstanter Wert (Filter_in = 0x60) an den Eingang â€Filterâ€œ ausgegeben.</i>  <i>Der endgÃ¼ltige Code wird nach dem Einrasten in die Speicherregister (DD36-37) in den DAC (DAC) eingegeben.</i> <br><br><div class="spoiler">  <b class="spoiler_title">FÃ¼r mitgelieferte UNISON</b> <div class="spoiler_text">  Alles sieht gleich aus, nur der Eingang â€Frequenzâ€œ erhÃ¤lt ein Zahlenpaar: fÃ¼r die Hauptstimme und fÃ¼r den Gleichklang. <br><br>  Hinweis: Es wird nur eine Periode angezeigt. <br><br><img src="https://habrastorage.org/webt/nn/-n/z2/nn-nz27kbozdrgb9nvn9l8apzzy.png"><br></div></div><br><h4>  Eine detailliertere Beschreibung der Generatoranordnung </h4><br>  Nachfolgend finden Sie die Details und elektrischen SchaltplÃ¤ne fÃ¼r diejenigen, die das Synthesizer-GerÃ¤t genauer verstehen mÃ¶chten.  Die Schaltkreise wurden im Internet gefunden, obwohl meinem Synthesizer eine Bedienungsanleitung [ <a href="https://habr.com/ru/post/482292/">4</a> ] und ein kompletter Satz von Papierschaltkreisen [ <a href="https://habr.com/ru/post/482292/">5</a> ] beigefÃ¼gt waren.  Gute Leute teilten das Archiv mit den Inhalten aller ROMs in einem Forum, aber es stellte sich heraus, dass eine der Dateien einen Fehler aufwies, sodass ich separate ROMs extrahieren und sie mit der Firmware im Archiv vergleichen musste. <br><br>  Es ist zu beachten, dass der Hersteller wÃ¤hrend der Produktion von P432 mehrere Revisionen der Synthesizer-Boards herausgegeben hat, um die technischen Eigenschaften zu verbessern, die von den im Folgenden vorgestellten ersten Revisionsschemata abweichen kÃ¶nnen. <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/webt/r_/j2/wh/r_j2wh8ff0lhsgn0t4-vewucrge.jpeg"></a> <br><br><ol><li>  Der Frequenzinkrement-Umwandlungs-ROM - DD1-2, der an zwei 573RF2 ausgefÃ¼hrt wird, enthÃ¤lt eine Entsprechungstabelle des linearen Frequenzwerts zum exponentiellen Phaseninkrement.  Grafisch sieht der Inhalt so aus <br><br><img src="https://habrastorage.org/webt/u4/dm/w0/u4dmw0zfe_tzpofn0b8bfg-yege.png"><br><br>  Synchron mit einer Ã„nderung des Wertes am Ausgang â€Adresseâ€œ gibt der Prozessorknoten einen 11-Bit-Frequenzwert der entsprechenden Stimme an den Eingang â€Frequenzâ€œ aus, der in 16-Bit-Inkremente umgewandelt wird. <br><br><div class="spoiler">  <b class="spoiler_title">Wenn wir den Inhalt der ersten 16 WÃ¶rter von DD1-2 betrachten, dann werden dort einige seltsame Zahlen geschrieben, die bei der Synthese des Klangs anscheinend nicht verwendet werden:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/9e/vx/rz/9evxrzasws-fe1lhvnloma1gzp4.png"><br></div></div></li><li>  Phasenakkumulator - besteht aus DD3-7-Addierern (561IM1) und DD8-12-Registern (561IR11).  Addierer sind in der Kette mit einer GesamtkapazitÃ¤t von 20 Bits enthalten.  Mit dem Registerblock kÃ¶nnen Sie acht 20-Byte-Signalphasenwerte speichern.  Die AdresseneingÃ¤nge der Lese- / Schreibregister sind mit dem Bus "Adresse" verbunden.  Diese Einbeziehung ermÃ¶glicht es Ihnen, den vorherigen Wert am Ausgang des Taktimpulses zu empfangen und den aktuellen Wert vom Eingang zu speichern.  Dies stellt die Akkumulation der Phase fÃ¼r jeden Sprachsynthesizer separat sicher.  Die hohen 9 Bits des Registerausgangs werden den AdresseneingÃ¤ngen des Wellenform-ROM zugefÃ¼hrt. </li><li>  Die ROM-Wellenform - DD13-14, DD18-19 (5732) enthÃ¤lt Tabellen mit acht Wellenformen, die von einer Generatorbaugruppe synthetisiert werden kÃ¶nnen.  Ein bestimmter Speicherbereich und ein Paar von ROMs werden durch die Bits S0-S2 des "Steuer" -Signals ausgewÃ¤hlt.  Bei der Beschreibung jedes Signals werden 512 WÃ¶rter mit einer BitkapazitÃ¤t von 11 Bits zugewiesen.  Das hÃ¶chstwertige 10-Bit hat einen Nutzwert, der die PolaritÃ¤t des Signals angibt: 1-positiv, 0-negativ.  Das Erscheinungsbild der Wellenformen wird unter BerÃ¼cksichtigung der Umkehrung negativer Werte angegeben: <br><br><div class="spoiler">  <b class="spoiler_title">Wave_00</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/or/vw/6u/orvw6ufj6zwaagtsfpnkhbi7kco.png"></div></div><div class="spoiler">  <b class="spoiler_title">Wave_01</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/f7/ki/qe/f7kiqemlbbaeapbd8zk0a1v25yi.png"></div></div><div class="spoiler">  <b class="spoiler_title">Wave_02</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/bp/1r/6y/bp1r6ypxrnj5ux1gcavtzv-77tk.png"></div></div><div class="spoiler">  <b class="spoiler_title">Wave_03</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/xu/sb/l3/xusbl3xahaejjicw-dilwuiumtw.png"></div></div><div class="spoiler">  <b class="spoiler_title">Wave_04</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/h_/ki/6l/h_ki6lga37bdnhfrul7cxoufp6m.png"></div></div><div class="spoiler">  <b class="spoiler_title">Wave_05</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/dm/ic/6m/dmic6msl9qiow18hx4qtvj8g_-s.png"></div></div><div class="spoiler">  <b class="spoiler_title">Wave_06</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ud/q0/kj/udq0kj3ce_wdf5dclef5kdruy3m.png"></div></div><div class="spoiler">  <b class="spoiler_title">Wave_07</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ec/gq/tf/ecgqtft3xeliwxyp4rkrtjlhqjq.png"></div></div></li><li>  HÃ¼llkurven-Addierer - Am VerstÃ¤rkereingang werden 8 HÃ¼llkurven-Bits (um 2 Bits nach links verschoben) empfangen, die auf den DD23-25 â€‹â€‹(561IM1) -Elementen mit den 10 niedrigstwertigen Bits des Wellenform-ROM-Ausgangs summiert werden.  Die HÃ¼llkurve hat 4 Phasen: Attack, Decay, Sustain, Release, die von der Prozessoreinheit fÃ¼r jede der 4 Hauptstimmen separat gebildet werden, je nachdem, wann die Taste gedrÃ¼ckt / losgelassen wird. <br>  Ein Beispiel fÃ¼r eine HÃ¼llkurve fÃ¼r Ton 00: Es ist deutlich ein schneller Angriff auf 255 zu erkennen, dann eine Abnahme auf UnterstÃ¼tzungsstufe 239, dann eine sanfte Abnahme der Stufe, die beim Loslassen der Taste mit einer starken DÃ¤mpfung auf 0 endet.  Auf der horizontalen Achse steht die Zeit in Sekunden, auf der vertikalen Achse der Wert des Eingangs â€VerstÃ¤rkerâ€œ. <br><br><div style="text-align:center;"><img alt="HÃ¼llkurve des Eingangs &quot;VerstÃ¤rker&quot;" src="https://habrastorage.org/webt/sc/ih/1e/scih1ebv64qe7hr9uywlvqixrpw.png"></div><br><br>  Die Werte im Synthesizer-ROM werden so gewÃ¤hlt, dass bei 0 am Eingang des â€VerstÃ¤rkersâ€œ der Ausgang des DAC ebenfalls einen Null-Signalpegel aufweist, obwohl alle Zwischenkreise stÃ¤ndig die Werte der Variablen verÃ¤ndern und unterschiedliche Signale erzeugen. </li><li>  Das aus DD27-28 (573 DD2) bestehende Skalierungs-ROM enthÃ¤lt Kurven zum Erhalten des Codes des bipolaren Signals in Ãœbereinstimmung mit dem Wert des hÃ¶herwertigen Bits der Wellenform.  In grafischer Form sieht der Inhalt des ROM so aus. <br><br><img src="https://habrastorage.org/webt/si/vk/qd/sivkqdmz_xprac6wlofmlq85cfy.png"><br><br>  Wenn das 10. Bit 1 ist, wird der Wert vom Ausgang DD28 + 256 verwendet, und wenn 0, dann DD27 + 1. </li><li>  Der Akkumulator der Stimmen von DD30-32 (561IM1) und die Register DD33-DD35 (5619) mischen die Werte der Codes aller Stimmen, bevor sie an den DAC ausgegeben werden.  Nach dem Verarbeiten des Codes der letzten Stimme wird der empfangene Wert weiter in das Speicherregister Ã¼bertragen und das Addiererregister auf Null zurÃ¼ckgesetzt. <br><br>  Beispiel: Wie oben erwÃ¤hnt, erhalten wir, wenn "VerstÃ¤rker" = 0 und der maximal mÃ¶gliche Amplitudenwert am Ausgang des Wellenform-ROM (1 &lt;&lt; 10) -1 = 1023 ist, am Ausgang des Skalierungs-ROM entweder 0 + 256 oder 255+ 1 abhÃ¤ngig von 10 Bits der Wellenform, was insgesamt 256 * 8 = 2048 ergibt und 0 am Ausgang des DAC entspricht. </li><li>  Das Speicherregister der Elemente DD36-37 (555TM9) empfÃ¤ngt und speichert den Wert des Codes wÃ¤hrend des Abtastintervalls am Ausgang.  Die Abtastfrequenz des Generatorknotens betrÃ¤gt ungefÃ¤hr 33000 Hz. </li><li>  DAC DA38 (534PA1) - wandelt einen 12-Bit-Wert in ein analoges bipolares Signal um, Code 2048 entspricht analog 0. </li><li>  Tiefpassfilter - gebaut nach dem Schema, das Vladimir Kuzmin fÃ¼r den Polivox-Synthesizer entwickelt hat. P432 wurde jedoch um einen Knoten zur thermischen Stabilisierung des OA-Filtersteuerstroms erweitert.  DarÃ¼ber hinaus stammt es aus demselben Polivox, in dem es zur Frequenzstabilisierung von Generatoren eingesetzt wurde.  Auf der Website des Autors finden Sie Anweisungen zum Konfigurieren dieses Knotens [ <a href="https://habr.com/ru/post/482292/">6</a> ]. <br><br>  Ãœber den Filter selbst ist schon viel geschrieben worden, so dass wir auf Details verzichten kÃ¶nnen. <br>  Die Filtersteuerung basiert auf einem 10-Bit-DAC (572PA1), dessen Eingang ein 8-Bit- â€Filterâ€œ -Signal ist, das die FilterhÃ¼llkurve darstellt. Je nach Klangfarbe kann es ein konstanter Wert sein und im Allgemeinen gleich Null sein.  Die Filterparameter werden auch durch den Wert von 4 Bit des Signals â€Controlâ€œ beeinflusst: F0-F1 legt den Offset der DAC-Ausgangsspannung fest, und Q0-Q1 sind fÃ¼r den QualitÃ¤tsfaktor (Resonanzpegel) des Filters verantwortlich. </li><li>  Nach dem Filter ist ein Schalter installiert, mit dem Sie das Mischen mit dem vom HOP-Effekt verarbeiteten Hauptsignal seiner Kopie aktivieren kÃ¶nnen.  In frÃ¼heren Modifikationen des P432 wurde der Tonausgang mit demselben Schalter ausgeschaltet, wenn keine Taste gedrÃ¼ckt wurde.  Aber in spÃ¤teren Ãœberarbeitungen wurde dies abgelehnt, sie begannen, Wege zu schneiden, DrÃ¤hte zu werfen und der Schaltung neue Elemente hinzuzufÃ¼gen. </li><li>  VerstÃ¤rker - ErhÃ¶ht den Ausgangssignalpegel auf 250 mV. </li></ol><br><h3>  CPU-Konfiguration und Knoten </h3><br>  Also haben wir die Generatoren herausgefunden.  Jetzt bleibt zu verstehen, woher alle Steuersignale kommen und wo die sie beschreibenden Parameter gespeichert sind. <br><br>  ZunÃ¤chst plante ich, alle Steuersignale mit einem Logikanalysator zu entfernen und einen Algorithmus zu entwickeln, der sie beschreibt.  Beispielsweise kÃ¶nnen die HÃ¼llkurven des VerstÃ¤rkers und des Filters durch eine stÃ¼ckweise lineare Funktion beschrieben werden, die eine begrenzte Anzahl von Parametern erfordert. <br><br>  Mit dem â€Frequencyâ€œ -Eingang war es auch ausreichend, die Frequenzwerte eines einzelnen Keys fÃ¼r jedes Timbre aufzuzeichnen und alle anderen darauf basierend zu berechnen. <br><br>  Laut Bedienungsanleitung verfÃ¼gt das P432 Ã¼ber eine Tastatur mit 41 Tasten und einer LautstÃ¤rke von 3 und 5/12 Oktaven mit einem Bereich von C1-E4 in wissenschaftlicher Notation oder C1-e1 in Helmholtz-Notation.  In der Praxis (fÃ¼r Ton 00) stellte sich jedoch anhand der Entsprechung A4 = 440 Hz heraus, dass die Taste A in der zweiten linken Oktave einen Ton dieser Frequenz erzeugt, und dies ergibt bereits den Bereich C3-E6.  Wie sich spÃ¤ter herausstellte, kann der Bereich der wiedergegebenen Frequenzen je nach aktivem Ton variieren und sich um 1 oder 2 Oktaven verschieben. <br><br>     Â«Â»             . <br><br><div class="spoiler"> <b class="spoiler_title">     Â«Â»</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/za/0x/9n/za0x9nglorah92outrafd3zafp8.png"></div></div><br>  ,            ,           DD16  . ,    5732  2048 . <br><br><img src="https://habrastorage.org/webt/ra/li/sr/ralisrftayjhrw4kilnbi20ere4.png"><br><br> 1024       32 ,  32     .               ,    .      . <br><br><div class="spoiler"> <b class="spoiler_title">    .</b> <div class="spoiler_text">      ,      00/FF,     . <br><div class="scrollable-table"><table><tbody><tr><th>  </th><th>  Symbol </th><th>  Beschreibung </th></tr><tr><td>  0 </td><td> FA_min </td><td>      </td></tr><tr><td>  1 </td><td> FA_dt </td><td>     </td></tr><tr><td>  2 </td><td> FA_max </td><td>     </td></tr><tr><td>  3 </td><td>  ? </td><td>  ? </td></tr><tr><td>  4 </td><td> FD_ft </td><td>      </td></tr><tr><td>  5 </td><td> FD_dt </td><td>     </td></tr><tr><td>  6 </td><td> FS_lvl </td><td>    </td></tr><tr><td>  7 </td><td> FREQ_u1 </td><td>     </td></tr><tr><td>  8 </td><td> FS_ft </td><td>      </td></tr><tr><td>  9 </td><td> FS_dt </td><td>     </td></tr><tr><td>  10 </td><td> FR_ft </td><td>      </td></tr><tr><td>  11 </td><td> FR_dt </td><td>     </td></tr><tr><td>  12 </td><td>  ? </td><td>  ? </td></tr><tr><td>  13 </td><td></td><td>  00 </td></tr><tr><td>  14 </td><td> FREQ_u2 </td><td>     </td></tr><tr><td>  15 </td><td> Ctrl </td><td>  Â«Â» </td></tr><tr><td>  16 </td><td> A_min </td><td>      </td></tr><tr><td>  17 </td><td> A_dt </td><td>     </td></tr><tr><td>  18 </td><td> A_max </td><td>      </td></tr><tr><td>  19 </td><td></td><td>  FF </td></tr><tr><td>  20 </td><td> D_ft </td><td>      </td></tr><tr><td>  21 </td><td> D_dt </td><td>     </td></tr><tr><td>  22 </td><td> S_lvl </td><td>    </td></tr><tr><td>  23 </td><td></td><td>  FF </td></tr><tr><td>  24 </td><td> S_ft </td><td>      </td></tr><tr><td>  25 </td><td></td><td>  00 </td></tr><tr><td>  26 </td><td></td><td>  00 </td></tr><tr><td>  27 </td><td> R_dt </td><td>      </td></tr><tr><td>  28 </td><td>  ? </td><td>  ? </td></tr><tr><td>  29. </td><td></td><td>  00 </td></tr><tr><td>  30 </td><td> FREQ_1 </td><td>     </td></tr><tr><td>  31 </td><td> FREQ_2 </td><td>     </td></tr></tbody></table></div></div></div><br>    ,       :    Â«Â»,   Â«Â»,   Â«Â»  ,          Â«Â». <br><br>       ,       .        ,     ,   -     . <br><br>    *_dt       , ,   00: A_min=0, A_dt=48  A_max=255.  ,     0    48,     255.     D_dt    A_max   S_lvl,  S_ft&gt;0,         S_ft  1,    .  R_dt     :       R_dt       0.  dt  1,    *_dt&lt;=1   *_dt   . <br><br>  *_ft  ,       ,      .   ,       ~ 100     ~ 3 .          <i>int(256 / *_ft) * 100</i> , .. *_ft       100  . <br><br> ,      .              *_ft/*_dt. <br><br><img src="https://habrastorage.org/webt/l4/4x/eh/l44xehulnortzobmt4psredmfka.png"><br><br>  Â«Â»      ,        . <br><br>      Â«Â».    ,     4  (),   ,   ,                 1-2 . <br><br>    : FREQ_1, FREQ_2    FREQ_u1, FREQ_u2  .          A    432. <br><br><pre><code class="python hljs">freq_offset = {<span class="hljs-number"><span class="hljs-number">4</span></span>:<span class="hljs-number"><span class="hljs-number">0xd0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>:<span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>:<span class="hljs-number"><span class="hljs-number">0x50</span></span>} freq = (config[<span class="hljs-string"><span class="hljs-string">'FREQ_1'</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) + freq_offset[config[<span class="hljs-string"><span class="hljs-string">'FREQ_1'</span></span>]] + config[<span class="hljs-string"><span class="hljs-string">'FREQ_2'</span></span>]</code> </pre> <br>  Ein Beispiel fÃ¼r Ton 00, wobei FREQ_1 = 6, FREQ_2 = 8 ergibt: 6 * 0x100 + 0x50 + 8 = 0x658, was mit den Logikanalysatordaten fÃ¼r alle TÃ¶ne Ã¼bereinstimmt.  FÃ¼r unisono ist die Berechnung Ã¤hnlich. <br><br>  Es ist anzumerken, dass fÃ¼r Ton 00 der Wert 0x658 einer Frequenz von 440 Hz oder der Note A4 entspricht. <br>  Es wurde experimentell festgestellt, dass das Frequenzintervall fÃ¼r benachbarte (einschlieÃŸlich schwarzer) Tasten 16 (0x10) Einheiten betrÃ¤gt.  Wenn wir also den Wert fÃ¼r die 22. Taste links (A der zweiten Oktave) - 0x658 kennen, kÃ¶nnen wir leicht den Wert fÃ¼r die ganz linke (Nr. 1): 0x508 und die ganz rechte (Nr. 41): 0x788 ermitteln. <br><br>  Auf dieser Grundlage kÃ¶nnen Sie den Tastaturbereich und die wiedergegebenen Frequenzen fÃ¼r verschiedene TÃ¶ne berechnen.  Die Spalte â€Frequenzâ€œ ist nur fÃ¼r einfache Wellenformen korrekt. <br><div class="scrollable-table"><table><tbody><tr><th>  FREQ_1 </th><th>  Reichweite </th><th>  Frequenz Hz </th><th>  Timbres </th></tr><tr><td>  4 </td><td>  C1 - E4 </td><td>  32,70 - 329,63 </td><td>  01, 07, 13, 14, 25, 30, 31, 32, 33, 34, 35 </td></tr><tr><td>  5 </td><td>  C2 - E5 </td><td>  65,41 - 659,26 </td><td>  03, 05, 06, 10, 15, 17, 23, 24, 27, 37 </td></tr><tr><td>  6 </td><td>  C3 - E6 </td><td>  130,81 - 1318,51 </td><td>  00, 02, 04, 11, 12, 16, 20, 21, 22, 26, 36 </td></tr></tbody></table></div>  Das oben Genannte ist mehr als genug, um den P432-Emulator zu erstellen. Fahren wir also damit fort. <br><br><h3>  P432-Emulation in Python erstellen </h3><br>  Ich dachte, es wÃ¤re schÃ¶n, Konfigurationsspeicher und Klangerzeugung zu trennen, also wurden zwei Hauptklassen erstellt: <br><br><ul><li>  P432data, verantwortlich fÃ¼r das Laden von Werten aus ROM-Images und das Bringen der Konfiguration von TÃ¶nen in eine bequeme Form zur Verwendung; </li><li>  P432 mit Methoden zum Erstellen von HÃ¼llkurven und zum tatsÃ¤chlichen Erzeugen von digitalen Samples. <br></li></ul>  Ich werde nicht im Detail auf P432data eingehen, der Quellcode kann auf Github eingesehen werden. <br>  Die Methoden von P432 werden jedoch ausfÃ¼hrlicher betrachtet. <br><br>  Das wichtigste ist natÃ¼rlich <b>gen_samples</b> mit einem Parameter, der die Anzahl der zurÃ¼ckzugebenden Samples angibt.  Bei diesem Verfahren wird die Verarbeitung der Signale vom Empfang des Wertes am Eingang â€Frequenzâ€œ bis zum Ausgang zum DAC so nah wie mÃ¶glich am Prototyp neu erstellt.  Im Prinzip kÃ¶nnen Sie, wenn Sie sich auf das P432-Schema konzentrieren, schnell die Python-Entsprechungen der Module der Generatorbaugruppe finden.  Das einzige, was explizit hinzugefÃ¼gt werden musste, war die Reduzierung der Variablen auf die angegebene Dimension: 20 Bit fÃ¼r den Phasenakkumulator, 11 Bit fÃ¼r den HÃ¼llkurvenaddierer und 12 Bit fÃ¼r den Stimmenaddierer.  Diese EinschrÃ¤nkung ist erforderlich, damit die Logik des Ãœberlaufs dieser Variablen normal funktioniert. <br><br>  Die Methoden zum Erstellen von HÃ¼llkurven des <b>getADS-</b> VerstÃ¤rkers und des <b>getFADS-</b> Filterformulars enthalten Werte fÃ¼r die HÃ¼llkurvenamplitude, aus denen gen_samples beim DrÃ¼cken der Tasten Werte entnimmt.  Sie haben einige <b>getR-</b> und <b>getFR-</b> Methoden in ihrem Unternehmen, die die Envelope Attenuation-Phase bilden.  Sie nehmen den Pegelparameter als Eingabe - den aktuellen Wert des HÃ¼llkurvenpegels, von dem aus er auf 0 abfÃ¤llt. <br><br>  Die vier Hauptstimmen haben die gleiche HÃ¼llkurvenform von VerstÃ¤rker und Filter. Wenn die HÃ¼llkurve jedoch fÃ¼r jede Stimme eine eigene HÃ¼llkurve hat und beim DrÃ¼cken einer Taste startet, wird sie fÃ¼r den Filter fÃ¼r alle Stimmen ab dem ersten DrÃ¼cken verwendet, nach dem nÃ¤chsten neu gestartet und dauert bis zum letzten loslassen.  <a href="https://habr.com/ru/post/482292/">Schau oben</a> <br><br>  GemÃ¤ÃŸ der Bedienungsanleitung gibt P432 MIDI-Notennummern von 36 bis 77 (in Wirklichkeit 76) fÃ¼r die Tastaturtasten 1 bis 41 aus.  Um das Rad nicht neu zu erfinden, entschied ich mich, den Bereich 36-76 im Emulator als Nummer der gedrÃ¼ckten Taste zu verwenden, und benÃ¶tigte daher die Methode midi2freq, die die Tastennummer unter BerÃ¼cksichtigung des ausgewÃ¤hlten Tons in den Wert â€Frequencyâ€œ umwandelt. <br><br>  Das letzte Methodenpaar war <b>key_press</b> (midi_note) und <b>key_release</b> (midi_note), die ein WÃ¶rterbuch der Entsprechung der Stimme mit der Frequenz des Grundtons, der Phase und der aktuellen Position der HÃ¼llkurve bildeten. <br><br>  Die letzte Hauptmethode ist <b>setprog</b> (prog, clean = True), um den aktiven Ton auszuwÃ¤hlen.  <b>Setprog</b> lÃ¤dt die Konfiguration des gewÃ¼nschten Tons und lÃ¶scht die internen Variablen, wenn das Clean-Flag nicht gelÃ¶scht wird.  Wenn clean auf False gesetzt ist, werden die internen Variablen nicht zurÃ¼ckgesetzt, sodass Sie wÃ¤hrend der Klangerzeugung praktisch ohne Klicks oder andere unangenehme GerÃ¤usche zwischen den TÃ¶nen wechseln kÃ¶nnen. <br><br>  Um die generierten Samples in die WAV-Datei zu schreiben, wurde die Dienstprogrammmethode write_wav basierend auf dem Wave-Modul erstellt.  FÃ¼r jedes Sample wird eine Skalierung durchgefÃ¼hrt, um die Amplitude zu erhÃ¶hen und auf eine vorzeichenbehaftete 16-Bit-Form zu bringen. <br><br>  Diese Methoden reichen aus, um eine WAV-Datei zu erstellen, in der einige Sekunden eines Synthesizer-Sounds aufgezeichnet werden. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    p432=P432() #   p432.setprog(0) #     (  ) p432.unison=False p432.filter_en = False #   A   p432.key_press(57) #  3   samples=p432.gen_samples(33000*3) #   p432.key_release(57) #    p432.write_wav('test_00.wav',samples)</span></span></code> </pre> <br>  Die Wellenform von Timbre 00 ist eine Sinuskurve, daher erhalten wir am Ausgang eine Sinuskurve mit einer Ã¼berlagerten HÃ¼llkurve.  <a href="https://soundcloud.com/user-439332338/sound-00" rel="nofollow">ZuhÃ¶ren.</a> <br><br><img src="https://habrastorage.org/webt/ab/69/fj/ab69fjssefu7whas7t2cgdwnehg.png"><br><br>  Etwas interessanter ist die Aufnahme von Ton 14 mit eingeschaltetem Unisono und Filter.  <a href="https://soundcloud.com/user-439332338/sound-14" rel="nofollow">ZuhÃ¶ren.</a> <br><br><img src="https://habrastorage.org/webt/xp/zt/nc/xpztnckj7tfji6_nmuiozfuvn_o.png"><br><br><h4>  GUI </h4><br>  Ein Konsolensoundgenerator ist gut, aber ich mÃ¶chte auch auf der Tastatur spielen.  Also habe ich beschlossen, eine einfache GUI fÃ¼r Tkinter zu erstellen. <br><br>  Das Interface wurde vom echten P432 beeinflusst, mit einer zusÃ¤tzlichen Tastaturlegende, einer Auswahltaste fÃ¼r MIDI-EingÃ¤nge und der MÃ¶glichkeit, den Filter auszuschalten. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2p/1z/ac/2p1zac1vtiabmog8o9wurzqfoli.png"></div><br>  Die SchaltflÃ¤che â€Midi Inâ€œ wird angezeigt, wenn Sie das Modul â€python-rtmidiâ€œ installiert haben.  Nach dem DrÃ¼cken und AuswÃ¤hlen des MIDI-EingabegerÃ¤ts aktiviert das Programm eine RÃ¼ckruffunktion, die die Ereignisse Note-On, Note-Off und Program Change auf allen 16 MIDI-KanÃ¤len erfasst.  Ãœber Program Change kÃ¶nnen Sie die Nummer des aktiven Emulatortons Ã¤ndern. <br><br>  Verwenden Sie zum Abfangen von TastaturtastenanschlÃ¤gen die Tkinter- <b>Bindungsmethode ('&lt;KeyPress')</b> , die <b>Bindungsmethode ('&lt;KeyRelease')</b> , und in der RÃ¼ckruffunktion wird die Tastennummer mit der zulÃ¤ssigen Liste Ã¼berprÃ¼ft, in eine Midi-Note konvertiert und die <b>p432.key_press ()</b> -Methode <b>aufgerufen</b> . <b>p432.key_release ()</b> .  Das Abfangen wird beim Start des Programms aktiviert und am Ende deaktiviert. <br><br>  FÃ¼r die Ausgabe von Streaming-Sound wird das Pyaudio-Modul im nicht blockierenden Modus verwendet.  Nach dem Rendern der Schnittstelle wird sie in einem separaten Thread gestartet, und tkinter funktioniert hauptsÃ¤chlich weiter.  In der Callback-Funktion Ã¼bergibt pyaudio die Anzahl der zu generierenden Samples und empfÃ¤ngt im Gegenzug Samples von gen_samples und ein Status-Flag.  Um die Latenz zwischen dem Note-On-Ereignis (durch DrÃ¼cken einer Taste) und dem Erscheinen von Sound zu verringern, wird ein relativ kleiner Puffer ausgewÃ¤hlt: 200 Samples.  Sie wird durch den Parameter frames_per_buffer der Methode open pyaudio festgelegt. <br><br>  Die kompilierte Pyinstall-Version von P432_emulator fÃ¼r Windows kann von <a href="" rel="nofollow">Releases</a> heruntergeladen werden. <br><br><h3>  Fazit </h3><br>  In diesem Artikel werden die Details der Funktionsweise des Analogfilters im Generatorknoten (und seiner digitalen Implementierung im Emulator), des Prozessorknotens, des HOP-Effekts und der MIDI-Schnittstelle fast nicht offenbart.  Der Schwerpunkt lag auf dem Design des digitalen Teils der Generatoreinheit, der Methode, die Parameter der Klangfarben zu speichern und sie bei der Erstellung des Emulators zu verwenden. <br><br>  Wenn das Thema von Interesse ist, plane ich einen zweiten Artikel mit einer Analyse der verbleibenden. <br><br>  Wenn Sie den Eindruck haben, dass die Beschreibung des Betriebs von P432-Knoten fehlerhaft oder ungenau ist, schreiben Sie dies bitte in die Kommentare. <br><br>  Der Quellcode des Projekts, die ROM-Firmware, Diagramme und die Bedienungsanleitung sind auf <a href="https://github.com/sintech/Formanta_P432" rel="nofollow">github</a> verfÃ¼gbar. <br><br><h3>  Referenzliste </h3><br><ol><li><a name="lit1"></a>  <a href="https://www.kit-e.ru/articles/elcomp/2001_07_50.php" rel="nofollow">Ridiko L. DDS: Direkte digitale Frequenzsynthese.</a> </li><li><a name="lit2"></a>  Museum der sowjetischen Synthesizer, Formant P432.  <a href="http://www.ruskeys.net/base/form432.php" rel="nofollow">www.ruskeys.net/base/form432.php</a> </li><li><a name="lit3"></a>  Wikipedia  <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D0%25BB%25D0%25B8%25D0%25B2%25D0%25BE%25D0%25BA%25D1%2581" rel="nofollow">Polyvox.</a> </li><li><a name="lit4"></a>  Elektromusikalisches Tasteninstrument "Formant P432".  <a href="https://github.com/sintech/Formanta_P432/raw/master/docs/Formanta%2520P432%2520Users%2520manual.pdf" rel="nofollow">Bedienungsanleitung</a> . </li><li><a name="lit5"></a>  <a href="https://github.com/sintech/Formanta_P432/tree/master/schematic" rel="nofollow">Elektrische SchaltplÃ¤ne des â€Formant P432â€œ.</a> </li><li><a name="lit6"></a>  <a href="http://www.muztech.com/manuals.php" rel="nofollow">Einstellen der TemperaturstabilitÃ¤t von Polyvox.</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de482292/">https://habr.com/ru/post/de482292/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de482282/index.html">Das Ende der ARMv7-Ã„ra oder ein bisschen Ã¼ber das Portieren von Spielen</a></li>
<li><a href="../de482284/index.html">"50 BrauntÃ¶ne" oder "Wie sind wir dazu gekommen"</a></li>
<li><a href="../de482286/index.html">Unerwartete gemeinsame ÃœberprÃ¼fung von Audio-Technica-Kassetten</a></li>
<li><a href="../de482288/index.html">Geschenke fÃ¼r den aufmerksamen ZuhÃ¶rer: Welche Audiohooks waren in der "Pre-Gap" auf der Audio-CD versteckt</a></li>
<li><a href="../de482290/index.html">Zwietracht Bot mit Wirtschaft mit SQLite</a></li>
<li><a href="../de482294/index.html">Neuigkeiten aus der Welt von OpenStreetMap Nr. 491 (10.12.2019-16.12.2019)</a></li>
<li><a href="../de482296/index.html">Tutorial von Ember.js Tutorial. Super Rentals App. Teil 1.1</a></li>
<li><a href="../de482298/index.html">Fanatischer Programmierer. Wie kÃ¶nnen Wettbewerbsvorteile erhalten und sichtbar werden?</a></li>
<li><a href="../de482300/index.html">Java 14-DatensÃ¤tze erkunden</a></li>
<li><a href="../de482302/index.html">Psychologischer Dunst Ã¼ber das neue Jahr</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>