<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛹🏿 🏄 🧑🏾‍🤝‍🧑🏽 Web地理服务。 现代解决方案概述 📳 🦄 👮</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="作为几乎所有在线产品的一部分，您可以完成一项任务，该任务需要使用与地图，地理编码，地理位置相关的特定服务。 就个人而言，我从事在线房地产目录工作已有近10年的时间，作为许多其他项目的一部分，我拥有使用各种在线地理服务的特定功能的经验。 

 在本文中，我将研究程序员最常遇到的地理任务，对提供解决这些...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Web地理服务。 现代解决方案概述</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462011/"><img src="https://habrastorage.org/webt/0u/8u/jn/0u8ujnh7xzhzt6m8mp2ed630fei.jpeg"><br><br> 作为几乎所有在线产品的一部分，您可以完成一项任务，该任务需要使用与地图，地理编码，地理位置相关的特定服务。 就个人而言，我从事在线房地产目录工作已有近10年的时间，作为许多其他项目的一部分，我拥有使用各种在线地理服务的特定功能的经验。 <br><br> 在本文中，我将研究程序员最常遇到的地理任务，对提供解决这些问题的解决方案的服务进行简短回顾，并分享我使用这些服务的经验。 <br><br> 我还指望评论员的参与-如果您在评论中发现描述不正确，缺乏良好的服务或者只是在您已经写的内容中添加了一些内容-请在评论中写，我将收集所有内容，以便将来能长期获得大量可用的工具清单在所有场合。 <br><a name="habracut"></a><br><h2> 目录 </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在网站上显示地图</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">正向和反向地理编码</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">解析和自动完成地址</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">搜索组织</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">用户位置</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">建设路线</a> </li></ul><br><a name="sitemaps"></a><br><h2> 在网站上显示地图 </h2><br> 一个非常流行的任务是在站点上显示在线地图。 例如，要确切显示办公室在地图上的位置。 或者，您可以在这里领取广告作者出售的东西。 <br><br> 为了显示地图，使用了两种主要类型的API： <br><br><ul><li>  Javascript API（交互式） </li><li> 静态API（静态） </li></ul><br><h3>  Javascript API </h3><br> 我开发的所有服务都主要在俄罗斯使用，因此，我将介绍我自己使用的并且在我们中很流行的API。 我知道bing和其他地图提供程序都具有API，但是我没有使用它们。 <br><br>  Javascript API允许您在站点上显示交互式地图，并具有缩放，显示标记，与地图交互（拖动标记，显示工具提示等）的功能。 <br><br><h4>  Javascript API Yandex.Maps </h4><br><ul><li> 俄罗斯的好地图 </li><li> 虽然免费，但不包括某些功能 </li><li> 充足的机会-聚类标签等 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tech.yandex.ru/maps/jsapi/doc/2.1/quick-start/index-docpage</a> </li></ul><br><h4>  Javascript API Google Maps </h4><br><ul><li> 全世界的好地图 </li><li> 通过Yandex级别的功能 </li><li> 付费-每1000个呼叫7美元 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">developers.google.com/maps/documentation/javascript/tutorial</a> </li></ul><br><h4>  2GIS API </h4><br><ul><li> 很好的卡片，但并非无处不在。 </li><li> 免费再见 </li><li>  API功能比Yandex / Google弱，但可以使用Leaflet模块进行扩展 </li><li> 但是有购物中心的楼层地图 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">api.2gis.ru/doc/maps/ru/quickstart</a> </li></ul><br><h4>  Azure地图 </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">azure.microsoft.com/en-us/services/azure-maps</a> </li><li> 大量服务（包括路由构建器）通过IP确定位置 </li><li> 有免费限制和付费API </li></ul><br><h4> 地图框 </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">docs.mapbox.com/api/maps</a> </li><li> 针对web和移动的可爱卡片。 </li><li> 我可能会误会，但卡片似乎只有英文 </li><li> 对于移动应用程序，每月最多释放25,000个用户，在网络上每月最多释放50,000个下载 </li></ul><br><br><h3> 静态API </h3><br> 静态API可以用于您只需要显示地图图片而无需交互的地方。 例如，您想将地图附加到电子邮件，或允许用户向您打印路线。 好吧，或者您的设计师绘制了一个使用地图而非背景的布局-为此类任务加载完整的JS卡似乎是多余的。 同样，静态图像可以用作预览，以加快用户页面的加载-并使页面具有交互性。 <br><br><h4> 静态API Yandex.Maps </h4><br><ul><li> 最大尺寸650x450像素 </li><li> 免费再见 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tech.yandex.ru/maps/staticapi/doc/1.x/dg/concepts/input_params-docpage</a> </li></ul><br><h4> 静态API Google地图 </h4><br><ul><li> 每千个请求$ 2 </li><li> 基本费率的最大大小为640x640，高级费率为2048x2048（每月200美元） </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">developers.google.com/maps/documentation/maps-static/intro</a> </li></ul><br><h4>  2GIS静态API </h4><br><ul><li> 由于某种原因，该网站被列为“过时” </li><li> 免费再见 </li><li> 最大尺寸1280x1280 </li><li> 到处都不是 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">api.2gis.ru/doc/maps/1.0/static</a> </li></ul><br><h4> 地图框 </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">docs.mapbox.com/api/maps</a> </li><li> 我可能会误会，但卡片似乎只有英文 </li><li> 最大尺寸1280x1280 </li><li> 每月最多可下载25,000张地图 </li></ul><br><a name="geocoding"></a><br><h2> 地理编码 </h2><br> 地理编码是一个过程，可让您查找对象地址处的坐标。 好吧，还是反向地理编码-通过坐标找出在那里放置了哪种地理对象。 实际上，所有地理编码服务都可以使用以任意格式输入的地址，同时使它们达到标准。 目前，我在市场上还没有找到任何完全免费的地理编码服务。 <br><br> 地理编码的典型应用是在地图上显示用户输入的地址，反之亦然（反向）-用户在地图上标记后，必须将其转换为地址。 <br><br><h3>  Geocoder Yandex.Map </h3><br><ul><li> 每天有不超过25,000个请求的免费费用。 </li><li> 除请求数量外，它还受到许可协议的限制-编码结果无法在没有卡的情况下保存和使用（但可以缓存），它们应仅在Yandex地图上显示，并且只能在公共服务框架内显示（所有人均可访问或进行免费开放注册）。 </li><li> 在俄罗斯可直接或反向使用。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tech.yandex.ru/maps/geocoder</a> </li></ul><br><h3> 来自DaData的提示 </h3><br><ul><li>  DaData具有“提示”服务，可让您实现用户输入地址的自动完成。 </li><li> 它包括地理编码器的功能（它可以按地址提供坐标，并按坐标提供地址）。 </li><li> 它仅在俄罗斯有效，涂层是la脚的-在百万富翁中水平为75-95％，在俄罗斯平均约为50％ </li><li> 每天有10,000个请求是免费的，但该报价不允许将其完全以自动模式使用-对于自动地理编码，您需要使用标准化服务。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">dadata.ru/api/建议/地址</a> </li></ul><br><h3>  Google Maps Geocoding API </h3><br><ul><li> 每1000个请求$ 5。 </li><li> 我没有使用它，因为有来自Yandex和dadata的免费类似物 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">developers.google.com/maps/documentation/geocoding/intro</a> </li></ul><br><br><h3>  Graphhopper </h3><br><ul><li> 每天最多可以免费查询500条。 </li><li> 许多其他有趣的功能。 </li><li> 与OpenStreetMaps一起使用 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">www.graphhopper.com/developers</a> </li></ul><br><h4> 地图框 </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">docs.mapbox.com/api/search</a> </li><li> 在俄罗斯，至少在喀山，我测试过的街道上的街道基础薄弱-找不到 </li><li> 每月最多释放100,000个请求 </li></ul><br><h3>  OpenStreetMaps命题 </h3><br><ul><li> 您可以在自己的服务器上部署的OpenSource解决方案。 </li><li> 未使用过，也许有人会在评论中写下他们的使用经验 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">nominatim.org/release-docs/develop/api/概述</a> </li></ul><br><h3>  2地理信息系统 </h3><br><ul><li>  Javascript API的文档声明了地址解析功能的存在，但实际上我没有在文档中找到如何使用它们。 也许正在开发中。 </li></ul><br><img src="https://habrastorage.org/webt/zf/vt/-4/zfvt-4myl-bujpmdet-49-br-h0.png"><br><a name="parsing"></a><br><h2> 解析和自动完成地址 </h2><br> 有时，有必要让用户以随机格式输入地址，然后将该地址转换为结构化数据-分别指定国家/地区，城市，街道和门牌号码的名称。 这对于使用房地产的所有服务都是必需的，必须确定重复的地址，填写邮件收据等。 <br><br> 原则上，以上列表中的所有地理编码服务都可以毫无问题地完成此任务。 使用直接地理编码，除了坐标外，它们还返回有关找到的地理对象的结构化信息。 <br><br> 另外，值得注意的是DaData的“标准化”服务-从俄罗斯返回的地址返回了许多不同的有用信息，每个地址10戈比： <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">dadata.ru/api/clean/地址</a> <br><br> 另外，我还将参考本节中有关地址的其他信息的任务。 特别是，如果我们按地址搜索广告，那么确定指定地址属于城市的哪个区域以及搜索最近的地铁站是重要的任务。 <br><br><h3> 城市内区域的定义 </h3><br> 目前，我找到了两种确定城市区域的解决方案。 两者都只对俄罗斯有效。 <br><br> 第一个也是最明显的是DaData。 关于此服务的文章很多，它对于使用俄语地址确实是一项很好的服务（这不是广告）。 自己尝试，确定。 <br><br> 如果您不想依赖第三方服务，那么我已经应用了另一种解决方案，并且至今仍在继续应用。 这是<abbr title="行政区域划分对象的全俄分类">OKATO</abbr>地址所定义的区域。 俄罗斯境内的每个地址都有其自己的OKATO代码-11位数字。 其中，前5-8位（视城市而定）清楚地指示了该区域。 <br><br> 对于我需要的那些城市，我只是编译了各地区的OKATO代码数据库，就得到了这样的数组： <br><br><div class="spoiler">  <b class="spoiler_title">OKATO代码示例</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/gl/vz/fk/glvzfkojdmgvtmmkbbzs1u4pydc.png"><br></div></div><br> 下一个问题是如何找出OKATO地址代码？  DaData将其作为“提示和标准化”服务的一部分返回。 有一个站点<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">okato-oktmo.rf</a> ，该站点的地址使用相同的数据显示OKATO代码。 我们的任务是独立于地址查找OKATO代码，而不考虑任何服务。 <br><br> 为此，我们需要下载最新的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">FIAS数据库</a>并在其上进行搜索。 该中心上已有一篇文章，提供了有关<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">如何在MSSQL中导入FIAS数据库</a>的示例。 通常，您可以通过FIASU配置搜索，在此处找到所需的地址，然后通过您知道该地区的地区列表中的OKATO代码找到其OKATO代码-就是这样，问题已解决。 <br><br> 如果您不希望花60兆字节的XML文件下载到数据库中，那不如使用dadata服务便宜，但功能少，可以使用FIAS数据库进行操作： <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">kladr-api.ru/docs</a> <br><br><h3> 搜索附近的地铁站 </h3><br> 当您需要在该地址查找最近的地铁站时，此功能非常必要，尤其是对于莫斯科居民而言。 目前，对于此任务，我知道两种解决方案： <br><br><h4>  Yandex地理编码器 </h4><br> 首先，您需要找出地址坐标。 然后，与反向地理编码一样，我们将这些坐标作为请求参数以及返回的地名的类型kind = Metro传递。 <br> 一个单独的参数设置需要搜索最近的电台的区域的大小。 根据经验，我根据城市选择从0.02到0.05度的值（在莫斯科，离地铁2公里的半径仍被视为步行距离，而在喀山，车站之间的距离为1.5公里）。 <br><br> 这种方法还有一个问题，有时坐标上最近的地铁实际上并不总是最接近的（例如，它在河的另一侧，或类似的东西）。 您只能使用建筑路线和距离矩阵服务来通过可访问性确定最近的地铁，这将在下面的文章中进行讨论。 粗略确定最近的电台-Yandex地理编码器非常适合，您每天最多可以免费执行25,000个请求。 <br><br><h4> 大数据 </h4><br> 是的，DaData可以帮助您完成此任务-作为“及时”或“标准化”服务的有偿资费的一部分，最近的3个地铁站及其附近的距离也会返回到每个地址。 <br><a name="places"></a><br><h2> 搜索组织 </h2><br> 如果您想向客户展示他所在城市的某种组织，这是一项常见的任务。 例如，您出售带有交货的货物，并且想要向某人显示某城市中某项服务的所有交货点。 或者，您可以制作要打印的布局，然后在地图上向用户显示所有印刷厂的用户，他可以去打印您的布局。 <br><br><h3>  Yandex按组织搜索 </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tech.yandex.ru/maps/geosearch</a> </li><li> 假设结果在公共地图上显示，则每天最多免费提供500个查询。 </li><li> 搜索结果无法保存或显示在Yandex以外的其他地图上。 </li></ul><br><h3>  Google Places API </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">developers.google.com/places/web-service/usage-and-billing</a> </li><li> 一个非常复杂的收费系统，我并不完全了解。 也许曾经使用过的人会在评论中写下。 </li><li> 据我了解，基本查询是免费的，但所有扩展都是免费的。 信息（联系方式，评论等）是单独收费的。 </li></ul><br><h3>  2地理信息系统 </h3><br> 有传言说他们有一个付费的私有API用于搜索组织。 我尚未设法访问它，并且从Yandex搜寻组织的人员已经足够我们的任务。 <br><a name="users"></a><br><h2>  IP用户位置 </h2><br> 网络上的一项常见任务是了解访问者来自哪个城市的站点。 对于那些不希望依赖第三方服务的人，可以使用联机服务或独立解决方案的形式来完成此任务。 <br><br> 通过IP确定城市的在线服务-在这里我可以再次建议（对于俄罗斯）DaData： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">dadata.ru/api/detect_address_by_ip</a> <br> 每天限制为10,000个请求。 如果每天的出勤人数超过10,000个唯一条目，则考虑服务器上安装的解决方案是有意义的。 您可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DaData评论中</a>了解有关它们如何选择使用内容的更多信息。 <br><br> 我将简要复制这些信息： <br>  <b>IpGeoBase-</b>曾经是一个不错的网站，每天进行更新，并以易于理解的机器可读格式提供ip地址及其所属城市的数据库，该数据库可轻松导入任何数据库中。 不幸的是，它于2017年停止更新。 <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ipgeobase.ru</a> <br><br>  <b>SypexGeo-</b>仍在更新中，它以其自身格式的php脚本和数据库的形式出现。 运作迅速，运作良好 <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">sypexgeo.net/zh/下载</a> <br><br>  <b>MaxMind</b>提供以较低的准确性下载免费的数据库，并以各种编程语言为它们提供单独的API。 作为付费产品的一部分，可以使用更准确的数据库。 <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">dev.maxmind.com/geoip/geoip2/geolite2</a> <br><br><h2> 通过坐标确定用户的位置 </h2><br> 该任务与反向地理编码的任务相似，但有细微差别。 <br><br> 有时，当我们确切地知道用户的坐标时，我们需要确定用户的位置（例如，使用设备的GPS传感器或浏览器中的Geolocation API获取用户的坐标）。 有两个选项-反向地理编码可返回用户所在位置的名称。 但是，如果用户位于城市之间的高速公路上，郊区或仅在干净的地方，并希望看到该领域出售土地的广告，会发生什么？ 反向地址解析器并不一定会对此进行处理。 <br><br> 在这种情况下，我本人就是这样做的-我在数据库中拥有我们有广告以及通常与之合作的俄罗斯城市的所有坐标。 根据用户的坐标，我只需通过一个简单的请求即可从我们的数据库中确定距离他最近的城市： <br><br><pre><code class="sql hljs">ORDER BY (|lng - :lng| + |lat - :lat|) ASC LIMIT 1</code> </pre> <br><a name="directions"></a><br><h2> 路线建设 </h2><br> 有时您需要构建从一个点到另一个点的路线。 例如，创建一个从用户位置到您办公室的位置图。  Yandex和Google提供了付费解决方案-它们的主要区别是Yandex出售按年付款的订阅服务，Google每月按件收费，并每月从卡中扣除款项。 <br>  Google还具有高级订阅，该订阅提供了一些附加功能（例如，增加Static API图像的最大大小）和限额存款。  2GIS还提供了一种解决方案-就建造1条路线而言，这是最昂贵的。 <br><br> 构建路线的任务分为几个子任务： <br><ol><li> 建立点到点的路线是可以理解的 </li><li> 距离矩阵-一种服务，可让您建立一组出发点和到达点之间的距离和运输时间矩阵。 例如，如果您需要为几个快递员计算最佳路线，这些快递员需要将货物从不同的仓库运送到不同的客户。 还是您提供清洁服务，您需要找出哪种清洁剂将更方便地从家中获取今天的每个订单，并为移动清洁剂制定最佳方案。 </li><li>  Isochrone API-围绕一个点区域构建，可以在同一时间到达。 例如，“在距离用户位置15分钟的步行路程内找到所有咖啡馆”。 </li></ol><br> 不同的提供者为所有这些任务提供不同的解决方案。 <br><br> 感谢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">3aiats</a> ，找到了免费的开源解决方案- <br><h3>  Graphhopper </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">www.graphhopper.com/open-source</a> </li><li> 安装在您的服务器上，使用OpenStreetMap构建路由，以Java运行 </li><li> 对于不想在服务器上安装此软件的用户，有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">免费的付费API</a> 。 </li><li> 有一个用于地理编码，构建路线，构建距离矩阵和优化路线的API，以及等时线 </li></ul><br><br><h3>  MapBox（感谢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">ne_kotin</a> ） </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">docs.mapbox.com/api/navigation</a> </li><li> 有一个用于地理编码，构建路线，构建距离矩阵和优化路线的API。 </li><li> 每月最多释放100,000个请求 </li></ul><br><br><h3>  Yandex </h3><br>  Yandex所有航线服务的一个共同特点是，它们在俄罗斯，阿布哈兹，阿塞拜疆，亚美尼亚，白俄罗斯，格鲁吉亚，哈萨克斯坦，吉尔吉斯斯坦，摩尔多瓦，塔吉克斯坦，土耳其，乌兹别克斯坦和乌克兰运营。 <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tech.yandex.ru/路由/路由器</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tech.yandex.ru/路由/ distance_matrix</a> </li><li> 每年120,000卢布起 </li><li> 有一个用于构建路线和距离矩阵的API </li><li> 包括交通堵塞，包括将来在给定时间预测的交通堵塞 </li><li> 能够在个人和公共交通工具上建立步行路线 </li></ul><br> 有一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">app.swizz.ru</a>服务，该服务使用Yandex API构建路线。 该服务没有自己的API，并且遇到了Yandex的限制问题，但从本质上讲，您可以看到Yandex路由构建器在那里的工作方式。 谢谢你的链接<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">3aiats</a> <br><br><h3> 谷歌 </h3><br> 与Yandex的主要区别在于即用即付定价，即针对每个请求。 对于小批量交易，与Google相比，大幅度增加关税-与Yandex相比，将更有利可图。 <br> 此外，Google对其建立路线的国家没有限制。 <br><br><h4>  Google Directions API </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">developers.google.com/maps/documentation/directions/intro</a> </li><li> 每1000个请求的费用为5美元或10美元。  10-如果使用优化来考虑交通拥堵和中间航路点。  5-如果只是2点之间的路线。 </li><li> 按功能，是Yandex服务的类似物，用于在2点之间构建路线，但具有更多设置 </li><li> 特别是，它能够提供多种替代路线 </li></ul><br><br><h4>  Google Distance Matrix API </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">developers.google.com/maps/documentation/distance-matrix/start</a> </li><li> 每1000个请求的费用为5美元或10美元，与指示类似 </li><li> 常规距离矩阵API </li></ul><br><br><h4>  Google Roads API </h4><br> 一项独特的Google服务，可让您处理车辆行驶的道路。 <br> 自动将路线的各个点链接到道路，显示最佳的交通方式以及关于您在途中遇到的路段的所有信息。 <br> 它知道如何将最近的路段绑定到这些点（例如，在GPS轨道上来回跳动以显示路线实际越过了哪些道路）。 <br> 能够显示路线上道路的速度限制。 <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">developers.google.com/maps/documentation/roads/intro</a> </li><li> 道路收费10美元，限速请求1000收费20美元 </li></ul><br><br><h3>  WikiRoutes </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">wikiroutes.info/开发人员</a> </li><li> 使用公共交通工具修建路线 </li><li> 有一个付费的API与网站集成 </li></ul><br><br><h3>  Azure地图 </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">azure.microsoft.com/en-us/services/azure-maps</a> </li><li> 大量服务，包括路线构建器 </li><li> 有免费限制和付费API </li></ul><br><br><h3>  2Gis物流 </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">logistics.2gis.ru</a> </li><li> 建设路线服务 </li><li> 每天5条路线，每月3,500卢布，准备讨论限额增加 </li><li> 只需花一些钱，就可以跟踪快递员的活动和其他附加功能 </li></ul><br><br><h3> 物流优化服务 </h3><br> 作为构建路线的单独服务类别，值得重点介绍现成的用于优化物流的解决方案，这些解决方案基于生产线上的快递员/车辆的数量来收费。 实际上，它们结合了路线构建工具和其他服务来尽可能优化您的物流。 这些是非常复杂且细分的解决方案，因此我将它们合并为一个列表。 <br> 感谢您<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">添加到</a>列表<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">3aiats</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tech.yandex.ru/路由/ vrp</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">zig-zag.org</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">quickrun.ru</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">maxoptra.ru</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">www.antor.ru</a> </li></ul><br><br><h2> 结论 </h2><br> 在当今世界，您几乎可以找到需要解决的任何任务的现成服务，也可以使用以上列表中的服务组合来解决它。 唯一的问题是该解决方案的成本，它将为您带来多少收益。 <br><br> 随着服务的普及，越来越多的服务开始转向更加严格的货币化系统-正如Google曾经免费的Google地图已完全支付费用一样，Yandex也正逐步朝着这一方向发展。 <br><br> 有开放的OpenStreetMaps，似乎可以使您解决列表中的所有问题，但是为此您需要自己部署它们，除了您的项目之外，还要单独维护整个地图基础设施-必要时，每个人都可以自己决定。 <br><br> 可能在该评论中，我没有指出您使用的某些优质服务，或者您使用了该评论中的服务，并且您可以在已编写的内容中添加一些内容-在评论中添加内容，我将在文字中添加内容。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN462011/">https://habr.com/ru/post/zh-CN462011/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN461999/index.html">WordPress开发环境的另一个版本（docker，wp-cli）</a></li>
<li><a href="../zh-CN462003/index.html">我如何在Google Play的Svelte上发布PWA</a></li>
<li><a href="../zh-CN462005/index.html">Google PageSpeed的功能：改进了网站评分和搜索排名</a></li>
<li><a href="../zh-CN462007/index.html">开发健壮的Python脚本</a></li>
<li><a href="../zh-CN462009/index.html">编程趋势：2020年可以期待什么？</a></li>
<li><a href="../zh-CN462013/index.html">Docker存储（Docker根）迁移问题历史记录</a></li>
<li><a href="../zh-CN462015/index.html">SAP Reporting Universe</a></li>
<li><a href="../zh-CN462021/index.html">如何停止做同一件事</a></li>
<li><a href="../zh-CN462023/index.html">Cascadeur：游戏动画的未来</a></li>
<li><a href="../zh-CN462025/index.html">关系网络数据模型</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>