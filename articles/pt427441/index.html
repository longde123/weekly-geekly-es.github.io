<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîπ üëáüèΩ ü¶í Converg√™ncia com Kubernetes üï° üëç üë®üèø‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Padroniza√ß√£o total 


 Preparei este material para o meu discurso na confer√™ncia e perguntei ao nosso diretor t√©cnico qual era a principal caracter√≠st...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Converg√™ncia com Kubernetes</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/427441/"><h3 id="totalnaya-standartizaciya">  Padroniza√ß√£o total </h3><br><p>  Preparei este material para o meu discurso na confer√™ncia e perguntei ao nosso diretor t√©cnico qual era a principal caracter√≠stica do Kubernetes para nossa organiza√ß√£o.  Ele respondeu: </p><br><blockquote>  Os pr√≥prios desenvolvedores n√£o entendem quanto trabalho extra fizeram. </blockquote><p>  Aparentemente, ele foi inspirado pelo livro recentemente lido <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">‚ÄúFactfulness‚Äù</a> - √© dif√≠cil perceber mudan√ßas menores e cont√≠nuas para melhor, e constantemente perdemos de vista nosso progresso. </p><br><p>  Mas a mudan√ßa para o Kubernetes definitivamente n√£o √© insignificante. </p><br><p><img src="https://habrastorage.org/webt/72/vu/bn/72vubnen7dnspn7tp9wmy2if9cu.png"></p><a name="habracut"></a><br><p> Quase 30 de nossas equipes executam todas ou algumas das cargas de trabalho nos clusters.  Cerca de 70% do nosso tr√°fego HTTP √© gerado por aplicativos em clusters Kubernetes.  Essa √© provavelmente a maior converg√™ncia de tecnologias desde que entrei na empresa depois que a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Forward comprou o uSwitch</a> em 2010, quando mudamos de .NET e servidores f√≠sicos para a AWS e de um sistema monol√≠tico para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">microsservi√ßos</a> . </p><br><p>  E tudo aconteceu muito rapidamente.  No final de 2017, todas as equipes usavam sua infraestrutura da AWS.  Eles configuram balanceadores de carga, inst√¢ncias do EC2, atualiza√ß√µes de cluster do ECS e coisas assim.  Pouco mais de um ano se passou e tudo mudou. </p><br><p>  Passamos um tempo m√≠nimo convergindo e, como resultado, o Kubernetes nos ajudou a resolver problemas prementes - nossa nuvem estava se expandindo, a organiza√ß√£o estava se tornando mais complicada e dificilmente pod√≠amos inserir novas pessoas nas equipes.  N√£o mudamos a organiza√ß√£o para usar o Kubernetes.  Pelo contr√°rio - usamos o Kubernetes para mudar a organiza√ß√£o. </p><br><p>  Os desenvolvedores podem n√£o ter notado grandes mudan√ßas, mas os dados falam por si.  Mais sobre isso mais tarde. </p><br><hr><br><p>  Muitos anos atr√°s, eu estava em uma confer√™ncia de Clojure e ouvi uma palestra de Michael Nygard <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sobre arquitetura que n√£o pode ser levada ao seu estado final</a> .  Ele abriu meus olhos.  Um sistema limpo e organizado parece caricaturado quando compara as lojas de TV com os produtos de cozinha e a arquitetura de software em larga escala - o sistema existente parece uma faca est√∫pida, e algum tipo de mingau sai em vez de fatias iguais.  Sem uma faca nova, n√£o h√° nada para pensar em salada. </p><br><p>  √â sobre como as organiza√ß√µes adoram projetos de tr√™s anos: o primeiro ano √© de desenvolvimento e prepara√ß√£o, o segundo ano √© de implementa√ß√£o e o terceiro √© retorno.  Em uma palestra, ele diz que esses projetos geralmente s√£o realizados de forma cont√≠nua e raramente chegam ao final do segundo ano (geralmente devido √† aquisi√ß√£o por outra empresa e a uma mudan√ßa de dire√ß√£o e estrat√©gia); portanto, a arquitetura usual √© </p><br><blockquote>  estratifica√ß√£o da mudan√ßa em alguma apar√™ncia de estabilidade. </blockquote><p>  E o uSwitch √© um √≥timo exemplo. </p><br><p>  Mudamos para a AWS por v√°rias raz√µes - nosso sistema n√£o suportava picos de carga e a organiza√ß√£o era prejudicada por um sistema muito r√≠gido e equipes estreitamente relacionadas, formadas para projetos espec√≠ficos e divididas por especializa√ß√£o. </p><br><p>  N√£o √≠amos parar de tudo, transferir todos os sistemas e come√ßar de novo.  Criamos novos servi√ßos com proxy por meio do balanceador de carga existente e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gradualmente sufocamos o</a> aplicativo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">antigo</a> .  Quer√≠amos mostrar imediatamente o retorno e, na primeira semana, realizamos testes A / B da primeira vers√£o do novo servi√ßo em produ√ß√£o.  Como resultado, pegamos produtos de longo prazo e come√ßamos a formar equipes para desenvolvedores, designers, analistas, etc. E vimos o resultado imediatamente.  Em 2010, isso pareceu uma verdadeira revolu√ß√£o. </p><br><p>  Ano ap√≥s ano, adicionamos novas equipes, servi√ßos e aplicativos e gradualmente "estrangulamos" o sistema monol√≠tico.  As equipes progrediram rapidamente - agora trabalhavam independentemente e consistiam em especialistas em todos os campos necess√°rios.  Minimizamos as intera√ß√µes da equipe para lan√ßamentos de produtos.  Alocamos v√°rios comandos apenas para a configura√ß√£o do balanceador de carga. </p><br><p>  As pr√≥prias equipes escolheram m√©todos, ferramentas e linguagens de desenvolvimento.  Estabelecemos uma tarefa para eles, e eles mesmos encontraram uma solu√ß√£o, porque eram os melhores versados ‚Äã‚Äãno assunto.  Com a AWS, essas altera√ß√µes se tornaram mais f√°ceis. </p><br><p>  Intuitivamente, seguimos os princ√≠pios de programa√ß√£o - as equipes que s√£o pouco conectadas entre si se comunicam com menos frequ√™ncia e n√£o precisamos gastar recursos preciosos na coordena√ß√£o de seu trabalho.  Tudo isso √© √≥timo descrito no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">livro</a> recentemente publicado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Accelerate</a> . </p><br><p>  Como resultado, como Michael Nygard descreveu, obtivemos um sistema de v√°rias camadas de mudan√ßas - alguns sistemas foram automatizados com Puppet, outros com Terraform, em algum lugar que usamos ECS, em algum lugar EC2. </p><br><p>  Em 2012, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">est√°vamos orgulhosos de nossa arquitetura, que poderia ser facilmente alterada para experimentar</a> , encontrar solu√ß√µes de sucesso e desenvolv√™-las. </p><br><p>  Mas em 2017, percebemos que muita coisa mudou. </p><br><hr><br><p>  Agora, a AWS √© muito mais complexa do que em 2010. Ela oferece v√°rias op√ß√µes e recursos - mas n√£o sem consequ√™ncias.  Hoje, qualquer equipe que trabalha com o EC2 precisa escolher uma VPC, configura√ß√£o de rede e muito mais. </p><br><p>  Experimentamos isso por conta pr√≥pria - as equipes come√ßaram a reclamar que estavam gastando cada vez mais tempo na manuten√ß√£o da infraestrutura, por exemplo, atualizando inst√¢ncias <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">em clusters AWS ECS</a> , m√°quinas EC2, alternando de balanceadores ELB para ALB, etc. </p><br><p>  Em meados de 2017, em um evento corporativo, pedi a todos que padronizassem seu trabalho para melhorar a qualidade geral dos sistemas.  Eu usei a met√°fora do iceberg hackneyed para mostrar como criamos e mantemos o software: </p><br><p><img src="https://habrastorage.org/webt/sn/ci/pt/sncipt6axzuuqa2pcqxrpbcwzh0.png"></p><br><p>  Eu disse que a maioria das equipes da nossa empresa deve criar servi√ßos ou produtos e se concentrar na solu√ß√£o de problemas, c√≥digo de aplicativos, plataformas e bibliotecas, etc. Nessa ordem.  Muito trabalho permanece debaixo d'√°gua - integra√ß√£o de toras, aumento da observabilidade, gerenciamento de segredos etc. </p><br><p>  Naquele momento, cada equipe de desenvolvedores de aplicativos lidou com quase todo o iceberg e tomou todas as decis√µes por si s√≥ - escolhendo a linguagem, o ambiente de desenvolvimento, a ferramenta de biblioteca e m√©tricas, o sistema operacional, o tipo de inst√¢ncia e o armazenamento. </p><br><p>  Na base da pir√¢mide, t√≠nhamos a infraestrutura do Amazon Web Services.  Mas nem todos os servi√ßos da AWS s√£o iguais.  Eles possuem um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">BaaS (back-end como servi√ßo)</a> , por exemplo, para autentica√ß√£o e armazenamento de dados.  E existem outros servi√ßos de n√≠vel relativamente baixo, como o EC2.  Eu queria estudar os dados e entender que as equipes t√™m motivos para reclamar e realmente gastam mais tempo trabalhando com servi√ßos de baixo n√≠vel e tomam muitas das decis√µes n√£o mais importantes. </p><br><p>  Dividi os servi√ßos em categorias, usando o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CloudTrail,</a> coletei todas as estat√≠sticas dispon√≠veis e depois usei o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">BigQuery</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Athena</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ggplot2</a> para ver como a situa√ß√£o dos desenvolvedores mudou recentemente.  Crescimento para servi√ßos como RDS, Redshift etc., consideramos desej√°vel (e esperado) e crescimento para EC2, CloudFormation etc. - pelo contr√°rio. </p><br><p><img src="https://habrastorage.org/webt/dd/bd/-f/ddbd-fy5t4wzicbekukgyx_lji0.png"></p><br><p>  Cada ponto do diagrama mostra os percentis 90 (vermelho), 80 (verde) e 50 (azul) para o n√∫mero de <strong>servi√ßos</strong> de <strong>baixo n√≠vel</strong> que nosso pessoal utilizava toda semana por um determinado per√≠odo.  Eu adicionei linhas de suaviza√ß√£o para mostrar a tend√™ncia. </p><br><p>  Embora tenhamos como objetivo abstra√ß√µes de alto n√≠vel ao implantar software, por exemplo, usando cont√™ineres e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Amazon ECS</a> , nossos desenvolvedores usavam regularmente cada vez mais servi√ßos da AWS e n√£o desconsideravam suficientemente as dificuldades de gerenciar sistemas.  Em dois anos, o n√∫mero de servi√ßos dobrou para 50% dos funcion√°rios e quase triplicou para 20%. </p><br><p>  Isso limitou o crescimento de nossa empresa.  As equipes buscavam autonomia, mas como contratar novas pessoas?  Precis√°vamos de fortes desenvolvedores de aplicativos e produtos e conhecimento do sistema AWS, cada vez mais sofisticado. </p><br><hr><br><p>  Quer√≠amos expandir nossas equipes e, ao mesmo tempo, preservar os princ√≠pios com os quais fomos bem-sucedidos: autonomia, coordena√ß√£o m√≠nima e infraestrutura de autoatendimento. </p><br><p>  Com o Kubernetes, conseguimos isso com abstra√ß√µes focadas em aplicativos e com a capacidade de manter e configurar clusters com o m√≠nimo de coordena√ß√£o da equipe. </p><br><h3 id="abstrakcii-s-fokusom-na-prilozheniya">  Abstra√ß√µes focadas em aplicativos </h3><br><p>  Os conceitos do Kubernetes s√£o f√°ceis de combinar com o idioma que o desenvolvedor do aplicativo usa.  Suponha que voc√™ esteja gerenciando vers√µes de aplicativos como uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">implanta√ß√£o</a> .  Voc√™ pode executar v√°rias r√©plicas atr√°s do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">servi√ßo</a> e mape√°-las para HTTP atrav√©s do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ingress</a> .  E atrav√©s dos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">recursos do usu√°rio,</a> voc√™ pode expandir e especializar esse idioma, dependendo do que voc√™ precisa. </p><br><p>  As equipes trabalham com mais efici√™ncia com essas abstra√ß√µes.  Basicamente, este exemplo tem tudo o que voc√™ precisa para implantar e executar um aplicativo Web.  O resto √© Kubernetes. </p><br><p>  Na foto com o iceberg, esses conceitos est√£o no n√≠vel da √°gua e combinam as tarefas do desenvolvedor de cima com a plataforma abaixo.  A equipe de gerenciamento de cluster pode tomar decis√µes insignificantes e de baixo n√≠vel (sobre o gerenciamento de m√©tricas, logs etc.) e, ao mesmo tempo, falar o mesmo idioma com os desenvolvedores acima da √°gua. </p><br><p>  Em 2010, o uSwitch possu√≠a equipes tradicionais para atender a um sistema monol√≠tico e, mais recentemente, t√≠nhamos um departamento de TI que gerenciava parcialmente nossa conta da AWS.  Parece-me que a falta de conceitos comuns dificultou seriamente o trabalho dessa equipe. </p><br><p>  Tente dizer algo √∫til se voc√™ tiver apenas inst√¢ncias do EC2 em seu vocabul√°rio, balanceadores de carga e sub-redes.  Era dif√≠cil ou mesmo imposs√≠vel descrever a ess√™ncia do aplicativo.  Pode ser um pacote Debian, implanta√ß√£o atrav√©s do Capistrano e assim por diante.  N√£o foi poss√≠vel descrever o aplicativo em um idioma comum a todos. </p><br><p>  No in√≠cio dos anos 2000, trabalhei na ThoughtWorks em Londres.  Na entrevista, fui aconselhado a ler o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Projeto Orientado a Problemas de</a> Eric Evans.  Comprei um livro a caminho de casa e comecei a ler no trem.  Desde ent√£o, lembro-me dela em quase todos os projetos e sistemas. </p><br><p>  Um dos principais conceitos do livro √© um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">idioma √∫nico</a> no qual diferentes equipes se comunicam.  O Kubernetes apenas fornece uma linguagem unificada para desenvolvedores e equipes de manuten√ß√£o de infraestrutura, e essa √© uma de suas principais vantagens.  Al√©m disso, ele pode ser expandido e complementado com outras √°reas e linhas de neg√≥cios. </p><br><p>  A comunica√ß√£o em um idioma comum √© mais produtiva, mas ainda precisamos limitar a intera√ß√£o entre as equipes o m√°ximo poss√≠vel. </p><br><h3 id="neobhodimyy-minimum-vzaimodeystviya">  M√≠nimo necess√°rio de intera√ß√£o </h3><br><p>  Os autores do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Accelerate</a> destacam as caracter√≠sticas de uma arquitetura pouco acoplada √† qual as equipes de TI trabalham com mais efici√™ncia: </p><br><blockquote>  Em 2017, o sucesso da entrega cont√≠nua dependia de a equipe poder: <br>  Altere seriamente a estrutura do seu sistema sem a permiss√£o do gerenciamento. <br>  Altere seriamente a estrutura do seu sistema, sem esperar que outras equipes mudem as deles e sem criar muito trabalho desnecess√°rio para outras equipes. <br>  Desempenhe suas tarefas sem comunicar ou coordenar seu trabalho com outras equipes. <br>  Implante e libere um produto ou servi√ßo sob demanda, independentemente de outros servi√ßos associados a ele. <br>  Fa√ßa a maioria dos testes sob demanda, sem um ambiente de teste integrado. </blockquote><p>  Precis√°vamos de clusters de multilocat√°rio de software centralizado para todas as equipes, mas, ao mesmo tempo, quer√≠amos manter essas caracter√≠sticas.  Ainda n√£o alcan√ßamos o ideal, mas estamos tentando da melhor maneira poss√≠vel: </p><br><ul><li>  Temos v√°rios clusters de trabalho e as pr√≥prias equipes escolhem onde executar o aplicativo.  Ainda n√£o usamos a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">federa√ß√£o</a> (estamos aguardando o suporte da AWS), mas temos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Envoy</a> para balanceamento de carga nos balanceadores do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ingress</a> em diferentes clusters.  Automatizamos a maioria dessas tarefas usando o pipeline de entrega cont√≠nua (temos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Drone</a> ) e outros servi√ßos da AWS. </li><li>  Todos os clusters t√™m o mesmo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">espa√ßo para nome</a> .  Cerca de um para cada equipe. </li><li>  Controlamos o acesso aos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">namespaces</a> por meio do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RBAC</a> (controle de acesso baseado em fun√ß√£o).  Para autentica√ß√£o e autoriza√ß√£o, usamos identidade corporativa no Active Directory. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Os clusters s√£o dimensionados automaticamente</a> e fazemos o poss√≠vel para otimizar o tempo de inicializa√ß√£o do n√≥.  Ainda leva alguns minutos, mas, em geral, mesmo com grandes cargas de trabalho, fazemos sem coordena√ß√£o. </li><li>  Os aplicativos s√£o dimensionados automaticamente com base nas m√©tricas no n√≠vel do aplicativo do Prometheus.  As equipes de desenvolvimento controlam o dimensionamento autom√°tico de seus aplicativos por m√©tricas de consulta por segundo, opera√ß√µes por segundo, etc. Gra√ßas ao dimensionamento autom√°tico do cluster, o sistema prepara os n√≥s quando a demanda exceder os recursos do cluster atual. </li><li>  Escrevemos o Go com uma ferramenta de linha de comando chamada <strong>u</strong> que padroniza a autentica√ß√£o de comandos no Kubernetes, usa o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Vault</a> , solicita√ß√µes de credenciais tempor√°rias da AWS e assim por diante. </li></ul><br><p><img src="https://habrastorage.org/webt/oy/qv/bm/oyqvbm7x1orfe2kpjxubpis6r60.png"></p><br><p>  N√£o tenho certeza de que com o Kubernetes tenhamos mais autonomia, mas ele definitivamente permaneceu em um n√≠vel alto e, ao mesmo tempo, nos livramos de alguns problemas. </p><br><hr><br><p>  A mudan√ßa para o Kubernetes foi r√°pida.  O diagrama mostra o n√∫mero total <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">de espa√ßos para nome</a> (aproximadamente igual ao n√∫mero de comandos) em nossos clusters de trabalho.  O primeiro apareceu em fevereiro de 2017. </p><br><p><img src="https://habrastorage.org/webt/ux/y_/q_/uxy_q_hravmwkjhead1bgzkspz4.png"></p><br><p>  T√≠nhamos motivos para nos apressar - quer√≠amos salvar as pequenas equipes focadas em seus produtos das preocupa√ß√µes com a infraestrutura. </p><br><p>  A primeira equipe concordou em mudar para o Kubernetes quando o servidor de aplicativos ficou sem espa√ßo devido a configura√ß√µes incorretas de rota√ß√£o do log.  A transi√ß√£o levou apenas alguns dias e eles voltaram aos neg√≥cios. </p><br><p>  Recentemente, as equipes mudaram para o Kubetnetes para obter ferramentas aprimoradas.  Os clusters Kubernetes simplificam a integra√ß√£o com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Hashicorp Vault</a> , o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Google Cloud Trace</a> e ferramentas semelhantes.  <em>Todas as</em> nossas equipes obt√™m recursos ainda mais eficazes. </p><br><hr><br><p>  Eu j√° mostrei um gr√°fico com percentis do n√∫mero de servi√ßos que nossos funcion√°rios usavam todas as semanas entre o final de 2014 e 2017.  E aqui est√° uma continua√ß√£o deste diagrama at√© hoje. </p><br><p><img src="https://habrastorage.org/webt/o7/fa/mu/o7famum8vaa0uuuw5e2ynah0-ay.png"></p><br><p>  Avan√ßamos no gerenciamento da complexa estrutura da AWS.  Fico feliz que agora metade dos funcion√°rios esteja fazendo a mesma coisa que no in√≠cio de 2015.  Temos 4-6 funcion√°rios na equipe de computa√ß√£o em nuvem, algo em torno de 10% do n√∫mero total - n√£o √© de surpreender que o percentil 90 quase n√£o tenha mudado.  Mas espero progredir aqui tamb√©m. </p><br><p>  Por fim, falarei sobre como nosso ciclo de desenvolvimento mudou e relembrarei novamente o livro Accelerate, lido recentemente. </p><br><p>  O livro menciona duas m√©tricas de desenvolvimento enxuto: lead time e tamanho do pacote.  O lead time √© considerado desde a solicita√ß√£o at√© a entrega da solu√ß√£o finalizada.  Tamanho do pacote √© a quantidade de trabalho.  Quanto menor o tamanho da embalagem, mais eficiente √© o trabalho: </p><br><blockquote>  Quanto menor o pacote, menor o ciclo de produ√ß√£o, menor variabilidade do processo, menor risco, despesa e custo, obtemos feedback mais rapidamente, trabalhamos com mais efici√™ncia, temos mais motiva√ß√£o, tentamos finalizar mais rapidamente e adiar a entrega com menos frequ√™ncia. </blockquote><p>  O livro sugere medir o tamanho dos pacotes pela frequ√™ncia de implanta√ß√£o - quanto mais freq√ºentemente a implanta√ß√£o, menores os pacotes. </p><br><p>  Temos dados para <em>algumas</em> implanta√ß√µes.  Os dados n√£o s√£o totalmente precisos - algumas equipes enviam releases diretamente para a ramifica√ß√£o principal do reposit√≥rio, outras usam outros mecanismos.  Isso n√£o inclui todos os aplicativos, mas os dados por 12 meses podem ser considerados indicativos. </p><br><p><img src="https://habrastorage.org/webt/dt/vt/53/dtvt53s-2o7-w9rs-7qx6dhnydc.png"></p><br><p>  O fracasso na trig√©sima semana √© o Natal.  Quanto ao resto, vemos que a frequ√™ncia de implanta√ß√£o aumenta, o que significa que o tamanho do pacote diminui.  De mar√ßo a maio de 2018, a frequ√™ncia de lan√ßamentos quase dobrou e, recentemente, √†s vezes fazemos mais de cem edi√ß√µes por dia. </p><br><p>  Mudar para o Kubernetes √© apenas parte de nossa estrat√©gia de padronizar, automatizar e aprimorar ferramentas.  Provavelmente, todos esses fatores influenciaram a frequ√™ncia dos lan√ßamentos. </p><br><p>  O Accelerate tamb√©m fala sobre o relacionamento entre a frequ√™ncia de implanta√ß√£o e o n√∫mero de funcion√°rios e a rapidez com que uma empresa pode trabalhar se a equipe aumentar.  Os autores enfatizam as limita√ß√µes da arquitetura e equipes relacionadas: </p><br><blockquote>  Tradicionalmente, acredita-se que expandir uma equipe aumenta a produtividade geral, mas diminui a produtividade de desenvolvedores individuais. </blockquote><p>  Se coletarmos os mesmos dados sobre a frequ√™ncia das implanta√ß√µes e fizermos um diagrama da depend√™ncia do n√∫mero de usu√°rios, podemos ver que podemos aumentar a frequ√™ncia das libera√ß√µes, mesmo se tivermos mais pessoas. </p><br><p><img src="https://habrastorage.org/webt/xc/ti/xf/xctixfjqbqgkbdooamerhtg3d_e.png"></p><br><p>  No come√ßo do artigo, mencionei o livro <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Factfulness</a> (que inspirou nosso CTO).  A transi√ß√£o para o Kubernetes se tornou para nossos desenvolvedores a converg√™ncia mais significativa e r√°pida da tecnologia.  N√≥s avan√ßamos em pequenos passos, e √© f√°cil n√£o perceber o quanto tudo mudou para melhor.  √â bom que tenhamos dados, e eles mostram que alcan√ßamos o que queremos - nosso pessoal est√° envolvido em seu produto e toma decis√µes importantes em seu campo. </p><br><p>  Costumava ser bom para n√≥s.  T√≠nhamos microsservi√ßos, AWS, equipes bem estabelecidas de produtos, desenvolvedores respons√°veis ‚Äã‚Äãpor seus servi√ßos de produ√ß√£o, equipes e arquitetura fracamente acopladas.  Eu falei sobre isso no relat√≥rio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">‚ÄúNossa Era da Ilumina√ß√£o‚Äù</a> (‚ÄúNossa Era da Ilumina√ß√£o‚Äù) em uma confer√™ncia em 2012.  Mas n√£o h√° limite para a perfei√ß√£o. </p><br><p>  No final, quero citar outro livro - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Scale</a> .  Eu o iniciei recentemente, e h√° um fragmento interessante sobre o consumo de energia em sistemas complexos: </p><br><blockquote>  Para manter a ordem e a estrutura em um sistema em desenvolvimento, √© necess√°rio um influxo constante de energia e isso cria desordem.  Portanto, para manter a vida, precisamos comer o tempo todo para derrotar a inevit√°vel entropia. <br>  Lutamos contra a entropia fornecendo mais energia para crescimento, inova√ß√£o, manuten√ß√£o e reparo, o que se torna mais dif√≠cil √† medida que o sistema envelhece, e essa batalha √© a base de qualquer discuss√£o s√©ria sobre envelhecimento, mortalidade, sustentabilidade e auto-sufici√™ncia de qualquer sistema, seja um organismo vivo , empresa ou sociedade. </blockquote><p>  Eu acho que voc√™ pode adicionar sistemas de TI aqui.  Espero que nossos √∫ltimos esfor√ßos mantenham a entropia por um tempo. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt427441/">https://habr.com/ru/post/pt427441/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt427431/index.html">Como o Android funciona, parte 4</a></li>
<li><a href="../pt427433/index.html">Balanceamento de tr√°fego nas redes IP da operadora</a></li>
<li><a href="../pt427435/index.html">STM32H7 - acerto do rel√≥gio sem HAL</a></li>
<li><a href="../pt427437/index.html">Configurando servidores vinculados: ms sql server e teradata</a></li>
<li><a href="../pt427439/index.html">Toda a verdade sobre o RTOS. Artigo 16. Signals</a></li>
<li><a href="../pt427443/index.html">Vivissec√ß√£o do sucesso</a></li>
<li><a href="../pt427447/index.html">PVS-Studio inclui suporte para o GNU Arm Embedded Toolchain</a></li>
<li><a href="../pt427449/index.html">Como entender o Tensorflow e n√£o morrer, e at√© ensinar algo sobre um carro</a></li>
<li><a href="../pt427451/index.html">Conectar tarefas do phpStorm ao Bitrix24</a></li>
<li><a href="../pt427453/index.html">Como eu fiz a transmiss√£o de som no Raspberry Pi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>