<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§öüèø üë©üèæ‚Äç‚öïÔ∏è üîΩ Cara mengotomatisasi pengumpulan KPI per bulan dan membuat pengguna hampir puas üñêÔ∏è üëö üë±üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Di banyak organisasi, evaluasi unit dilakukan dengan menggunakan KPI (Indikator Kinerja Utama). Dalam organisasi tempat saya bekerja, sistem seperti i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara mengotomatisasi pengumpulan KPI per bulan dan membuat pengguna hampir puas</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423919/"> Di banyak organisasi, evaluasi unit dilakukan dengan menggunakan KPI (Indikator Kinerja Utama).  Dalam organisasi tempat saya bekerja, sistem seperti itu disebut "sistem indikator kinerja", dan dalam artikel ini saya ingin berbicara tentang bagaimana kami berhasil mengotomatiskan bagian dari pekerjaan dengan indikator dalam sebulan.  Dengan semua ini, biaya tenaga kerja kami bukan yang terbesar, tetapi pada saat yang sama kami mencoba menerapkan beberapa Wishlist lama.  Dalam cerita saya tidak akan ada teknologi hype atau wahyu (setelah semua, pembangunan provinsi itu keras), tetapi akan ada beberapa sketsa pada topik yang akan membantu untuk memahami bagaimana kami memulai, apa yang kami lakukan, dan apa yang kami dapatkan dari pemikiran dari pengembangan.  Jika Anda belum bosan, saya minta kucing. <br><a name="habracut"></a><br><h3>  Latar belakang </h3><br>  Kembali pada tahun 2006, kami memperkenalkan sistem indikator kinerja: lima belas kriteria evaluasi dikembangkan, metodologi untuk menghitungnya, dan frekuensi triwulanan untuk menghitung indikator ini didirikan.  Penilaian dilakukan untuk dua puluh dua cabang organisasi yang berlokasi di semua wilayah di wilayah kami.  Dan agar indikator dapat dicapai dengan antusiasme yang besar, bonus dikaitkan dengan mereka - semakin tinggi jumlah indikator, semakin tinggi tempat di peringkat, semakin tinggi tempat di peringkat, semakin tinggi premi, dan seterusnya setiap triwulan dan setiap tahun. <br><br>  Seiring waktu, komposisi kriteria berubah: setiap kuartal, yang baru ditambahkan atau yang lama dikeluarkan.  Pada puncaknya, pada sekitar 2016, jumlah indikator melebihi empat puluh, dan sekarang hanya ada empat belas. <br><br>  Namun, selama ini proses perhitungannya sama.  Setiap kriteria dihitung oleh unit yang bertanggung jawab dari organisasi induk sesuai dengan algoritma yang disetujui secara khusus untuk kriteria ini.  Perhitungan dapat dilakukan baik dengan rumus sederhana maupun dengan sejumlah rumit, mungkin memerlukan pengumpulan data dari beberapa sistem, sementara itu sangat mungkin bahwa algoritma akan berubah cukup sering.  Dan kemudian semuanya sudah jauh lebih sederhana: indikator persentase yang dihitung dikalikan dengan koefisiennya, dengan demikian, suatu poin diperoleh dengan kriteria, maka poin-poin tersebut diberi peringkat dan masing-masing unit berlangsung sesuai dengan poin tersebut.  Hal yang sama dilakukan dengan jumlah poin untuk menghitung tempat terakhir. <br><br>  Sejak awal, Excel digunakan untuk memperhitungkan dan menghitung semua yang dijelaskan di atas.  Selama bertahun-tahun, serangkaian kriteria terakhir dan perhitungan lebih lanjut dari titik dan tempat dilakukan dalam piring yang bagus, yang sebagian ditunjukkan dalam gambar. <br><br><img src="https://habrastorage.org/webt/vg/wa/c6/vgwac6cdozzjztrpwhci_smaon4.png"><br><br>  Saya hanya mencatat bahwa di tablet yang bagus ini, sebagian besar pengeras suara disembunyikan, tetapi kenyataannya pada kuartal ke-4 tahun 2016 terlihat seperti ini <br><br><img src="https://habrastorage.org/webt/ku/8s/ah/ku8sah_m9zrjx3ozezxqvz2w9xq.png"><br><br>  Setuju, sejumlah indikator dan volume tabel seperti itu tidak menambah kesederhanaannya.  Selain itu, masing-masing kriteria dihitung secara terpisah, dan anak perempuan dari departemen umum membuat tabel ringkasan ini dengan tangan mereka.  Mempertimbangkan bahwa tidak hanya komposisi kriteria yang berubah, tetapi juga perhitungannya dapat diulang beberapa kali (karena berbagai alasan), hari-hari terakhir setiap kuartal, dengan kata lain, tidak bahagia.  Saya harus terus mengubah data dalam tabel, periksa dan periksa ulang: seperti ini, Anda lupa menambahkan kolom baru ke jumlah poin atau Anda tidak memperbarui koefisien, dan untuk beberapa orang tempat semakin rendah, dan dengan itu bonusnya kurang.  Oleh karena itu, setelah pengurangan heroik dari tabel, verifikasi heroik dimulai, semua orang yang mempertimbangkan setiap kriteria, manajer, dan bahkan seorang spesialis IT yang ditugaskan secara organisasi memeriksa dan menyetujui.  Mengingat bahwa semua pekerjaan dilakukan secara manual, dan perhitungan indikator untuk tabel pivot dikirim ke surat, cukup sering ada situasi ketika tabel pivot berisi kesalahan dalam rumus dan data versi yang tidak relevan.  Kapten bukti melaporkan bahwa setelah setiap kesalahan terdeteksi, proses verifikasi dimulai kembali. <br>  Ketika semua indikator dihitung, tablet disetujui dan dikirim ke cabang, di sana, di cabang itu diperiksa ulang: bagaimana jika Excel yang berbahaya berpikir ada sesuatu yang salah?  Saya pikir jelas bahwa menyusun laporan tahunan tentang kriteria atau menganalisis data historis ternyata menjadi pencarian yang tidak kalah menarik. <br><br>  Namun, dari sudut pandang manajerial, sistem seperti itu cukup efektif dan memungkinkan, jika perlu, untuk memperketat area kerja yang kendur, memantau dan memiliki gagasan tentang apa yang terjadi di masing-masing cabang di area kerja tertentu.  Selain itu, lokasi cabang, dihitung sesuai dengan kriteria, adalah indikator yang tidak terpisahkan. <br><br><h3>  Sistem harus berubah </h3><br>  Praktek telah membuktikan perlunya dan pentingnya sistem penilaian.  Pada awal 2017, menjadi jelas bahwa menghitung kriteria sekali seperempat memungkinkan untuk mengevaluasi pekerjaan yang dilakukan, tetapi pemantauan itu membuatnya menjadi lemah.  Rentang waktu terlalu lama.  Dalam hal ini, diputuskan bahwa perhitungan indikator akan dilakukan setiap dua minggu sekali, dan hasilnya akan diringkas semua setiap triwulan yang sama.  Peningkatan frekuensi perhitungan benar-benar memungkinkan manajer cabang untuk dengan cepat merespons perubahan dan meningkatkan kontrol atas proses dalam unit mereka. <br><br>  Tetapi hanya di organisasi induk, sedikit yang senang dengan prospek melakukan proses pengumpulan data yang dijelaskan di atas, tidak setiap kuartal, tetapi setiap dua minggu.  Karena tidak sulit ditebak, mereka memutuskan untuk mengotomatiskan prosesnya.  Tenggat waktu ternyata ketat: dari saat keputusan untuk beralih ke frekuensi perhitungan baru, ke transisi yang sebenarnya, hanya sebulan yang seharusnya berlalu.  Untuk periode ini, sangat diinginkan untuk menghasilkan sesuatu yang lebih baik daripada sekelompok Excel untuk kode dan perhitungan, dan surat untuk pengumpulan dan pemberitahuan. <br><br>  Pada awalnya ada sedikit diskusi panas tentang apa yang benar-benar perlu dilakukan secara otomatis dan perhitungan indikator itu sendiri, dengan mempertimbangkan semua formula dan sumber data mereka.  Tetapi mengingat tenggat waktu yang ketat, kompleksitas fungsi tersebut dan perlunya pemeliharaan konstan dalam keadaan saat ini berhasil memenuhi persyaratan berikut untuk sistem: <br><br><ul><li>  Manual referensi kriteria harus disimpan, menjaga sejarah perubahan mereka; </li><li>  Seharusnya dimungkinkan untuk memasukkan dan menyimpan indikator yang dihitung, serta konversi mereka ke poin seperti pada lempeng yang sama; </li><li>  Berdasarkan nilai-nilai indikator, laporan harus dihasilkan yang dapat diakses oleh semua pihak yang berkepentingan; </li><li>  Secara alami, semua ini harus disediakan dengan antarmuka web. </li></ul><br>  Fungsionalitasnya sangat kecil, tetapi tidak banyak waktu. <br><br><h3>  Pengembangan dimulai </h3><br>  Saya selalu tertarik dengan cara pengembangan yang cepat dan generasi antarmuka otomatis.  Dalam kasus di mana perlu untuk mengimplementasikan fungsionalitas CRUD, gagasan ketika antarmuka dan bagian dari logika bisnis akan disediakan di luar kotak, sehingga untuk berbicara, tampaknya sangat menggoda.  Tentu saja, antarmuka akan menjadi logika bersahaja dan canggung, tetapi untuk banyak tugas ini sudah cukup. <br><br>  Didorong oleh ide-ide ini, saya memutuskan untuk mencoba sesuatu seperti itu.  Ada Spring Roo, Kuba dan alat menarik lainnya, tetapi pilihannya jatuh pada OpenXava.  Pertama, sekali saya sudah membuat aplikasi yang sangat sederhana dan puas, dan kedua, kerangka kerja ini pada waktu itu cukup berhasil masuk ke tumpukan teknologi kami.  Selain itu, sangat menyenangkan untuk memiliki tutorial singkat dalam bahasa Rusia. <br><br>  Deskripsi singkat tentang fitur dan kemampuan OpenXava dapat ditemukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> .  OpenXava adalah kerangka kerja yang mengimplementasikan konstruksi otomatis antarmuka web yang terintegrasi dengan basis data berdasarkan JPA, dan menggunakan anotasi untuk menggambarkan aturan visualisasi.  Aplikasi ini didasarkan pada komponen bisnis - kelas Java yang berisi informasi yang diperlukan untuk membuat aplikasi.  Informasi tersebut termasuk struktur data, validator, representasi valid, pemetaan ke tabel database.  Operasi pada komponen bisnis dilakukan melalui pengontrol yang dapat CRUD dari kotak, pencarian, ekspor ke PDF, dll.  Aplikasi OpenXava menyajikan satu set modul.  Modul mengaitkan komponen bisnis dengan satu atau lebih pengontrol.  Representasi yang ditentukan untuk setiap komponen bisnis digunakan untuk menampilkan antarmuka.  Tidak ada yang aneh, MVC dengan sedikit atmosfernya sendiri. <br><br><h3>  Penyimpanan data </h3><br>  Di sebagian besar aplikasi, kami menggunakan DBMS IBM DB2.  Database kecil dibuat yang menyimpan buku referensi kelompok kriteria dan kriteria di mana cabang dievaluasi, direktori cabang dan piring di mana nilai-nilai terhitung dari kriteria dimasukkan.  Untuk setiap kriteria, pada titik waktu tertentu, sebuah koefisien ditetapkan yang akan digunakan dalam penilaian.  Setiap cabang, untuk setiap kriteria, menerima penilaian juga untuk tanggal tertentu.  Data tentang nilai-nilai kriteria disimpan secara historis, yaitu data yang relevan dengan tanggal apa pun adalah data yang dimasukkan pada tanggal terdekat di masa lalu.  Pendekatan ini, terinspirasi oleh register informasi dari 1C: Enterprise, tampaknya cukup nyaman bagi saya: ada sejarah dan masalah pengeditan / penghapusan tidak terlalu melonjak. <br><br><div class="spoiler">  <b class="spoiler_title">Struktur basis data</b> <div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> SUMMAR.CLS_DEPART ( <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GENERATED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>, PARENT_ID <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, IS_DELETED <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CLOB</span></span>, CODE <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>), PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> SUMMAR.CLS_CRITERIA ( <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GENERATED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>, IS_DELETED <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CLOB</span></span>, CODE <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>), PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> SUMMAR.CLS_GROUP_CRITERIA ( <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GENERATED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>, IS_DELETED <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CLOB</span></span>, CODE <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>), PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> SUMMAR.REG_STATE_CRITERIA ( <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GENERATED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>, ID_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, ID_GROUP_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, TIME_BEGIN <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CURRENT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, TIME_END <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'9999-12-31-23.59.59.000000000000'</span></span>, TIME_CREATE <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CURRENT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, KOEFFICIENT <span class="hljs-built_in"><span class="hljs-built_in">DECIMAL</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> FK_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (ID_CRITERIA) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> SUMMAR.CLS_CRITERIA(<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ACTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> RESTRICT, <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> FK_GROUP_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (ID_GROUP_CRITERIA) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> SUMMAR.CLS_GROUP_CRITERIA(<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ACTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> RESTRICT ); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> SUMMAR.REG_VALUE_CRITERIA ( <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GENERATED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>, ID_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, ID_GROUP_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, ID_DEPART <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, DATE_REG <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>(<span class="hljs-number"><span class="hljs-number">12</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CURRENT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, TIME_END <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'9999-12-31-23.59.59.000000000000'</span></span>, TIME_BEGIN <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CURRENT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">PERCENT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">DECIMAL</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>), VAL <span class="hljs-built_in"><span class="hljs-built_in">DECIMAL</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>), PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> FK_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (ID_CRITERIA) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> SUMMAR.CLS_CRITERIA(<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ACTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> RESTRICT, <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> FK_DEPART <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (ID_DEPART) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> SUMMAR.CLS_DEPART(<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ACTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> RESTRICT, <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> FK_GROUP_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (ID_GROUP_CRITERIA) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> SUMMAR.CLS_GROUP_CRITERIA(<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ACTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> RESTRICT );</code> </pre> <br></div></div><br>  Untuk mendapatkan laporan yang didambakan tentang kinerja cabang dari database, fungsi yang tersimpan dibuat, yang hasilnya sudah dipetakan ke kelas Java.  Fungsinya terlihat seperti ini. <br><div class="spoiler">  <b class="spoiler_title">Pertama, kami mendapatkan semua kriteria yang valid untuk tanggal tersebut, serta koefisien kriteria yang relevan untuk tanggal tersebut</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> SUMMAR.SLICE_STATE_ALL_CRITERIA ( PMAX_TIME <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">RETURNS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> ( ID_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span>, ID_GROUP_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span>, TIME_BEGIN <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, TIME_END <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, TIME_CREATE <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, KOEFFICIENT <span class="hljs-built_in"><span class="hljs-built_in">DECIMAL</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">LANGUAGE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SQL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> RSC.ID_CRITERIA, RSC.ID_GROUP_CRITERIA, RSC.TIME_BEGIN, RSC.TIME_END, RSC.TIME_CREATE, RSC.KOEFFICIENT <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SUMMAR.REG_STATE_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> RSC <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ID_CRITERIA, <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span>(TIME_BEGIN) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> TIME_BEGIN <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DISTINCT</span></span> ID_CRITERIA, TIME_BEGIN <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SUMMAR.REG_STATE_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TIME_BEGIN &lt; PMAX_TIME <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> TIME_END &gt; PMAX_TIME ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> SL <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ID_CRITERIA ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> MAX_SLICE <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> RSC.ID_CRITERIA = MAX_SLICE.ID_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> RSC.TIME_BEGIN = MAX_SLICE.TIME_BEGIN ;</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Sekarang kami akan menerima pada tanggal yang sama nilai dari semua kriteria untuk semua cabang</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> SUMMAR.SLICE_VALUE_ACTUAL_ALL_CRITERIA_ALL_DEPART_WITH_NAMES ( PMAX_TIME <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">RETURNS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> ( ID_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span>, ID_GROUP_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span>, ID_DEPART <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span>, DATE_REG <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">PERCENT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">DECIMAL</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), VAL <span class="hljs-built_in"><span class="hljs-built_in">DECIMAL</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), KOEFFICIENT <span class="hljs-built_in"><span class="hljs-built_in">DECIMAL</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), CRITERIA_NAME <span class="hljs-keyword"><span class="hljs-keyword">CLOB</span></span>, CRITERIA_CODE <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>), GROUP_CRITERIA_NAME <span class="hljs-keyword"><span class="hljs-keyword">CLOB</span></span>, GROUP_CRITERIA_CODE <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>), DEPART_NAME <span class="hljs-keyword"><span class="hljs-keyword">CLOB</span></span>, DEPART_CODE <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>), DEPART_CODE_INT <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">LANGUAGE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SQL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> CDEP.ID_CRITERIA, <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(VALS.ID_GROUP_CRITERIA, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ID_GROUP_CRITERIA, CDEP.ID_DEPART, VALS.DATE_REG, <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(VALS.PERCENT, <span class="hljs-number"><span class="hljs-number">0.0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">PERCENT</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(VALS.VAL, <span class="hljs-number"><span class="hljs-number">0.0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> VAL, <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(VALS.KOEFFICIENT, <span class="hljs-number"><span class="hljs-number">0.0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> KOEFFICIENT, CDEP.CRITERIA_NAME, CDEP.CRITERIA_CODE, <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(VALS.GROUP_CRITERIA_NAME, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> GROUP_CRITERIA_NAME, <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(VALS.GROUP_CRITERIA_CODE, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> GROUP_CRITERIA_CODE, CDEP.DEPART_NAME, CDEP.DEPART_CODE, CDEP.DEPART_CODE_INT <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> CCRT.ID <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ID_CRITERIA, CCRT.<span class="hljs-string"><span class="hljs-string">"NAME"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> CRITERIA_NAME, CCRT.CODE <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> CRITERIA_CODE, CDEP.ID <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ID_DEPART, CDEP.<span class="hljs-string"><span class="hljs-string">"NAME"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> DEPART_NAME, CDEP.CODE <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> DEPART_CODE, <span class="hljs-keyword"><span class="hljs-keyword">CAST</span></span> (CDEP.CODE <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> DEPART_CODE_INT <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SUMMAR.CLS_DEPART <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> CDEP, ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SUMMAR.CLS_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> CC <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span>(SUMMAR.SLICE_STATE_ALL_CRITERIA (PMAX_TIME)) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ACTC <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> CC.ID = ACTC.ID_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> CC.IS_DELETED = <span class="hljs-number"><span class="hljs-number">0</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> CCRT <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> CDEP.IS_DELETED = <span class="hljs-number"><span class="hljs-number">0</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> CDEP <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> VALS.ID_CRITERIA, VALS.ID_GROUP_CRITERIA, VALS.ID_DEPART, VALS.DATE_REG, VALS.PERCENT, VALS.VAL, VALS.KOEFFICIENT, CGRT.<span class="hljs-string"><span class="hljs-string">"NAME"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> GROUP_CRITERIA_NAME, CGRT.CODE <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> GROUP_CRITERIA_CODE <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span>(SUMMAR.SLICE_VALUE_ACTUAL_ALL_CRITERIA (PMAX_TIME)) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> VALS <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> SUMMAR.CLS_GROUP_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> CGRT <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> VALS.ID_GROUP_CRITERIA = CGRT.ID ) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> VALS <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> CDEP.ID_DEPART = VALS.ID_DEPART <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> CDEP.ID_CRITERIA = VALS.ID_CRITERIA ;</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Dalam kueri akhir, kami menomori nilai indikator, memberi peringkat, dan menemukan minimum dan maksimum, ini akan diperlukan untuk menghitung tempat nanti</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ROW_NUMBER() <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ID_NUM, <span class="hljs-keyword"><span class="hljs-keyword">RANK</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ID_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> VAL <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> RATING, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">RANK</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ID_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> VAL <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span> ) ) <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>() = <span class="hljs-keyword"><span class="hljs-keyword">RANK</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ID_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> VAL <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> MAX_RATING, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MIN</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">RANK</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ID_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> VAL <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span> ) ) <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>() = <span class="hljs-keyword"><span class="hljs-keyword">RANK</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ID_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> VAL <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> MIN_RATING, VALS.* <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span>(SUMMAR.SLICE_VALUE_ACTUAL_ALL_CRITERIA_ALL_DEPART_WITH_NAMES (?)) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> VALS <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> GROUP_CRITERIA_CODE, CRITERIA_CODE, DEPART_CODE_INT</code> </pre><br></div></div><br>  Transfer bagian dari logika bisnis ke DBMS cukup dibenarkan, terutama ketika harus menyiapkan data untuk laporan yang berbeda.  Ternyata operasi dapat ditulis dalam bentuk yang lebih ringkas dan alami, di Jawa, manipulasi dengan data akan memerlukan jumlah kode yang lebih besar dan beberapa upaya untuk menyusunnya.  Meskipun operasi yang relatif kompleks atau nontrivial masih lebih mudah untuk diprogram di Jawa.  Oleh karena itu, dalam aplikasi kami, berkenaan dengan pengambilan sampel data, suatu pendekatan digunakan di mana koneksi set data, kondisi kliping dan beberapa operasi yang dapat dilakukan oleh fungsi jendela dilakukan dalam fungsi dan prosedur yang tersimpan, dan logika yang lebih kompleks diterapkan dalam aplikasi. <br><br><h3>  Aplikasi </h3><br>  Seperti yang saya katakan, OpenXava digunakan untuk mengimplementasikan aplikasi.  Untuk mendapatkan antarmuka khas dan CRUD di luar kotak, Anda perlu melakukan beberapa tindakan. <br>  Untuk memulainya, di web.xml Anda perlu menjelaskan filter dan servlet dari addon yang menavigasi aplikasi: <br><br><div class="spoiler">  <b class="spoiler_title">web.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">web-app</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://java.sun.com/xml/ns/javaee"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-class</span></span></span><span class="hljs-tag">&gt;</span></span>com.openxava.naviox.web.NaviOXFilter<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span>*.jsp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span>/modules/*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dispatcher</span></span></span><span class="hljs-tag">&gt;</span></span>REQUEST<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dispatcher</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dispatcher</span></span></span><span class="hljs-tag">&gt;</span></span>FORWARD<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dispatcher</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span>module<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-class</span></span></span><span class="hljs-tag">&gt;</span></span>com.openxava.naviox.web.NaviOXServlet<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span>/m/*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">web-app</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Selanjutnya, dalam file controllers.xml, kami mendefinisikan controller yang digunakan dalam aplikasi.  Dalam kasus kami, yang paling sederhana sudah cukup: <br><br><div class="spoiler">  <b class="spoiler_title">controllers.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">controllers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">controller</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Typical_View"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extends</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">controller</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Navigation"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extends</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">controller</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CRUD"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extends</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">controller</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ExtendedPrint"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">controller</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">controllers</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Kontroler di atas menggabungkan fungsi-fungsi dari kontroler yang termasuk dalam OpenXava secara default, fungsi-fungsi yang mudah ditebak dari namanya. <br><br>  Dan akhirnya, dalam file application.xml kita akan menghubungkan controller yang dibuat dan modelnya.  Sesuatu seperti ini: <br><br><div class="spoiler">  <b class="spoiler_title">application.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"summar"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"RegValueCriteria"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">model</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"RegValueCriteria"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">controller</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Typical_View"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Seperti disebutkan di atas, aplikasi didasarkan pada komponen bisnis yang membentuk model aplikasi.  Misalnya, pertimbangkan komponen RegValueCriteria yang terkait dengan pengontrol di application.xml.  Komponen ini menjelaskan nilai kriteria untuk cabang (untuk singkatnya, hanya uraian bidang kelas yang tersisa, dan saya akan menghilangkan metode seperti getter dan setter): <br><br><div class="spoiler">  <b class="spoiler_title">Kelas komponen</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-meta"><span class="hljs-meta">@Table</span></span>(name = <span class="hljs-string"><span class="hljs-string">"REG_VALUE_CRITERIA"</span></span>, catalog = <span class="hljs-string"><span class="hljs-string">""</span></span>, schema = <span class="hljs-string"><span class="hljs-string">"SUMMAR"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@XmlRootElement</span></span> <span class="hljs-meta"><span class="hljs-meta">@Views</span></span>({ <span class="hljs-meta"><span class="hljs-meta">@View</span></span>(members = <span class="hljs-string"><span class="hljs-string">"idCriteria [idCriteria];"</span></span> + <span class="hljs-string"><span class="hljs-string">"idGroupCriteria [idGroupCriteria];"</span></span> + <span class="hljs-string"><span class="hljs-string">"idDepart [idDepart];"</span></span> + <span class="hljs-string"><span class="hljs-string">"data [dateReg, percent, val]"</span></span>), <span class="hljs-meta"><span class="hljs-meta">@View</span></span>(name=<span class="hljs-string"><span class="hljs-string">"massReg"</span></span>, members = <span class="hljs-string"><span class="hljs-string">"idDepart.name, percent, val"</span></span>) }) <span class="hljs-meta"><span class="hljs-meta">@Tab</span></span>(properties= <span class="hljs-string"><span class="hljs-string">"idDepart.name, idCriteria.name, idGroupCriteria.name, dateReg, percent, val"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RegValueCriteria</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serializable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> serialVersionUID = <span class="hljs-number"><span class="hljs-number">1L</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Id</span></span> <span class="hljs-meta"><span class="hljs-meta">@GeneratedValue</span></span>(strategy = GenerationType.IDENTITY) <span class="hljs-meta"><span class="hljs-meta">@Basic</span></span>(optional = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"ID"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Long id; <span class="hljs-meta"><span class="hljs-meta">@Basic</span></span>(optional = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-meta"><span class="hljs-meta">@NotNull</span></span> <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"DATE_REG"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Temporal</span></span>(TemporalType.TIMESTAMP) <span class="hljs-meta"><span class="hljs-meta">@DefaultValueCalculator</span></span>(CurrentDateCalculator.class) <span class="hljs-meta"><span class="hljs-meta">@Stereotype</span></span>(<span class="hljs-string"><span class="hljs-string">"DATETIME"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Date dateReg; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"PERCENT"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@OnChange</span></span>(OnChangePercentAction.class) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> BigDecimal percent; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"VAL"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> BigDecimal val; <span class="hljs-meta"><span class="hljs-meta">@JoinColumn</span></span>(name = <span class="hljs-string"><span class="hljs-string">"ID_CRITERIA"</span></span>, referencedColumnName = <span class="hljs-string"><span class="hljs-string">"ID"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@ManyToOne</span></span>(optional = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-meta"><span class="hljs-meta">@DescriptionsList</span></span>( descriptionProperties=<span class="hljs-string"><span class="hljs-string">"name"</span></span> ) <span class="hljs-meta"><span class="hljs-meta">@OnChange</span></span>(OnChangeClsCriteriaAction.class) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ClsCriteria idCriteria; <span class="hljs-meta"><span class="hljs-meta">@JoinColumn</span></span>(name = <span class="hljs-string"><span class="hljs-string">"ID_GROUP_CRITERIA"</span></span>, referencedColumnName = <span class="hljs-string"><span class="hljs-string">"ID"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@ManyToOne</span></span>(optional = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-meta"><span class="hljs-meta">@DescriptionsList</span></span>( descriptionProperties=<span class="hljs-string"><span class="hljs-string">"name"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ClsGroupCriteria idGroupCriteria; <span class="hljs-meta"><span class="hljs-meta">@JoinColumn</span></span>(name = <span class="hljs-string"><span class="hljs-string">"ID_DEPART"</span></span>, referencedColumnName = <span class="hljs-string"><span class="hljs-string">"ID"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@ManyToOne</span></span>(optional = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-meta"><span class="hljs-meta">@DescriptionsList</span></span>( descriptionProperties=<span class="hljs-string"><span class="hljs-string">"name"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ClsDepart idDepart; }</code> </pre> <br></div></div><br>  Selain anotasi JPA biasa.  Anda juga dapat melihat anotasi OpenXava.  Mereka harus dipertimbangkan secara lebih rinci. <br><br>  <code>@View</code> memungkinkan <code>@View</code> untuk mengontrol format presentasi bidang kelas, dan dengan bantuan sintaks khusus dalam bentuk tanda kurung, bidang dapat dikelompokkan dan diatur secara horizontal dan vertikal menggunakan simbol <code>,</code> dan <code>;</code>  .  Jika beberapa pemetaan perlu ditentukan untuk satu komponen, maka penjelasan <code>@View</code> dikelompokkan menggunakan penjelasan <code>@View</code> .  Dalam contoh kami, properti diatur sebagai berikut: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@View</span></span>(members = <span class="hljs-string"><span class="hljs-string">"idCriteria [idCriteria];"</span></span> + <span class="hljs-string"><span class="hljs-string">"idGroupCriteria [idGroupCriteria];"</span></span> + <span class="hljs-string"><span class="hljs-string">"idDepart [idDepart];"</span></span> + <span class="hljs-string"><span class="hljs-string">"data [dateReg, percent, val]"</span></span>)</code> </pre> <br>  Dan terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/nh/5m/ss/nh5msssvc0-xft3prl99emnw1-e.png"><br><br>  Bersahaja, tetapi dengan upaya minimal.  Namun, ada beberapa cara untuk "menghidupkan kembali" formulir itu sedikit. <br>  Agar tanggal registrasi diisi ketika membuat komponen, penjelasan <code>@DefaultValueCalculator</code> , yang memanggil objek kalkulator khusus.  Di sini, kalkulator dari OpenXava sendiri digunakan, tetapi Anda juga bisa membuatnya sendiri.  Anotasi <code>@Stereotype</code> digunakan untuk menampilkan tanggal menggunakan kontrol yang sesuai. <br><br>  Untuk mengonfigurasi daftar turun bawah yang berisi objek terkait, penjelasan <code>@DescriptionsList</code> , di mana Anda dapat menentukan properti mana yang akan ditampilkan dalam daftar. <br><br>  Menggunakan anotasi, Anda bisa menerapkan beberapa logika bisnis dari formulir itu sendiri.  Misalnya, sehingga ketika persentase berubah, nilai dihitung secara otomatis dengan mempertimbangkan koefisien kriteria, Anda dapat menerapkan anotasi <code>@OnChange</code> untuk bidang <code>BigDecimal val</code> .  Agar penjelasan <code>@OnChange</code> berfungsi, perlu menunjuk ke kelas yang mengimplementasikan antarmuka <code>OnChangePropertyBaseAction</code> .  Metode single <code>execute()</code> harus diimplementasikan di kelas, di mana input data diambil dari tampilan, perhitungan dilakukan dan nilai yang dihitung ditulis kembali ke tampilan: <br><br><div class="spoiler">  <b class="spoiler_title">Kelas anak OnChangePropertyBaseAction</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnChangePercentAction</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnChangePropertyBaseAction</span></span></span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ BigDecimal percent = (BigDecimal)getNewValue(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (percent != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>){ Map value = (Map)getView().getValue(<span class="hljs-string"><span class="hljs-string">"idCriteria"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>){ Long idCriteria = (Long)value.get(<span class="hljs-string"><span class="hljs-string">"id"</span></span>); Query query = XPersistence.getManager().createNativeQuery( <span class="hljs-string"><span class="hljs-string">"SELECT KOEFFICIENT FROM SUMMAR.SLCLA_STATE_CRITERIA WHERE ID_CRITERIA = ?"</span></span>); query.setParameter(<span class="hljs-number"><span class="hljs-number">1</span></span>, idCriteria); List&lt;?&gt; list = query.getResultList(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (list != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; !list.isEmpty()){ BigDecimal koef = (BigDecimal) list.get(<span class="hljs-number"><span class="hljs-number">0</span></span>); BigDecimal vl = koef.multiply(percent); getView().setValue(<span class="hljs-string"><span class="hljs-string">"val"</span></span>, vl); } } } } }</code> </pre> <br></div></div><br>  Untuk presentasi data tabular, anotasi <code>@Tab</code> , yang memungkinkan Anda untuk membuat daftar properti objek yang akan ditampilkan dalam representasi tabular.  Dalam contoh kami, anotasi diatur sebagai berikut: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Tab</span></span>(properties= <span class="hljs-string"><span class="hljs-string">"idDepart.name, idCriteria.name, idGroupCriteria.name, dateReg, percent, val"</span></span> )</code> </pre> <br>  Ini akan terlihat sebagai berikut <br><br><img src="https://habrastorage.org/webt/hb/ps/vs/hbpsvs9i46ue1abfxabexohsnni.png"><br><br>  Senang dengan ketersediaan filter, pagination dan ekspor di luar kotak, namun, banyak detail memerlukan penyempurnaan dengan file. <br><br>  Pekerjaan dengan komponen lain juga dibangun dengan cara yang sama.  Menggunakan OpenXava telah secara dramatis mengurangi biaya tenaga kerja untuk mengimplementasikan fungsi CRUD dan sebagian besar antarmuka pengguna.  Menggunakan tindakan dari pengontrol yang telah ditentukan dan anotasi untuk membangun formulir sangat menghemat waktu jika Anda tidak menemukan kesalahan dengan detail dan mencoba menerapkan sesuatu yang lebih rumit daripada formulir input dengan beberapa peristiwa.  Meskipun mungkin demikian pengalamannya. <br><br><h3>  Tentang apa itu semua </h3><br>  Ingat untuk apa aplikasi itu?  Ya, sehingga pelat dengan indikator tidak direduksi secara heroik di Excel, tetapi dibuat secara otomatis berdasarkan data yang dimasukkan.  Di jendela browser, tabel pivot mulai terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/sm/x_/v1/smx_v17og5oi-ube78ymyhosnie.png"><br><img src="https://habrastorage.org/webt/26/sz/45/26sz45etsyy1jldlfoqff7034zg.png"><br><br>  Saya tidak akan memberikan detail implementasi, karena semuanya tidak terlalu baik dengan itu dan campuran JSP dengan HTML yang dihasilkan ketika meminta data bukan sesuatu untuk dibagikan kepada masyarakat umum.  Pada saat yang sama, pengambilan sampel data itu sendiri ditunjukkan di atas. <br><br>  Namun, saya ingin membahas satu detail menarik.  Ketika persyaratan untuk aplikasi dikumpulkan, manajemen benar-benar menginginkan bahwa, di samping laporan ringkasan, nilai-nilai indikator individual dapat ditampilkan dalam bentuk peta wilayah, dibagi menjadi wilayah-wilayah dengan indikasi lokasi dan skor cabang terkait.  Siapa yang mengenali wilayah di peta - dilakukan dengan baik =) <br><br><img src="https://habrastorage.org/webt/ip/8t/a-/ip8ta-wuufxirkycdn_kohxqqkc.png"><br><br>  Di satu sisi, persyaratannya adalah opsional, tetapi di sisi lain, gambar berjanji untuk visual, dan dari sudut pandang implementasi itu menarik untuk dicoba.  Setelah beberapa pemikiran, muncul ide untuk menemukan gambar wilayah dalam format SVG dan membuat template XSLT darinya. <br><br>  Template yang dihasilkan mudah diisi dengan data, dan setelah itu dikonversi ke PNG. <br>  Pertama, menggunakan kueri yang dijelaskan di atas, data diambil sampelnya, data yang diterima dikonversi menjadi objek kelas ini: <br><br><div class="spoiler">  <b class="spoiler_title">Kelas untuk menghasilkan data ke peta</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@XmlRootElement</span></span> <span class="hljs-meta"><span class="hljs-meta">@XmlAccessorType</span></span>(XmlAccessType.FIELD) <span class="hljs-meta"><span class="hljs-meta">@XmlType</span></span>(name = <span class="hljs-string"><span class="hljs-string">"VisualisedValuesCriteria"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VisualisedValuesCriteria</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> XMLGregorianCalendar date; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String criteriaName; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String koefficient; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;VisualizedValueCriteria&gt; departValues; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> XMLGregorianCalendar </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> date; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setDate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(XMLGregorianCalendar date)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.date = date; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCriteriaName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> criteriaName; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setCriteriaName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String criteriaName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.criteriaName = criteriaName; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getKoefficient</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> koefficient; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setKoefficient</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String koefficient)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.koefficient = koefficient; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;VisualizedValueCriteria&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDepartValues</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (departValues == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>){ departValues = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> departValues; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setDepartValues</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;VisualizedValueCriteria&gt; departValues)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.departValues = departValues; } } <span class="hljs-meta"><span class="hljs-meta">@XmlRootElement</span></span> <span class="hljs-meta"><span class="hljs-meta">@XmlAccessorType</span></span>(XmlAccessType.FIELD) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VisualizedValueCriteria</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String departName; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String departCode; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String value; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String percent; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String colorCode; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDepartName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> departName; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setDepartName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String departName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.departName = departName; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDepartCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> departCode; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setDepartCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String departCode)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.departCode = departCode; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value = value; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPercent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> percent; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setPercent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String percent)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.percent = percent; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getColorCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> colorCode; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setColorCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String colorCode)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.colorCode = colorCode; } } }</code> </pre> <br></div></div><br>  Selanjutnya, konversikan objek ke XML; <br><br><div class="spoiler">  <b class="spoiler_title">Konversi</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">Private String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">marshal</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(VisualisedValuesCriteria obj)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Marshaller marshaller = JAXBContext.newInstance(VisualisedValuesCriteria.class).createMarshaller(); marshaller.setEventHandler(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DefaultValidationEventHandler()); marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); StringWriter writer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringWriter(); marshaller.marshal(obj, writer); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> writer.toString(); }</code> </pre> <br></div></div><br>  Sekarang, mari kita ambil XML yang dihasilkan, template XSLT yang telah disiapkan, terapkan konversi dan dapatkan svg di output: <br><br><div class="spoiler">  <b class="spoiler_title">Dapatkan svg</b> <div class="spoiler_text"><pre> <code class="java hljs"> String xml = marshal(obj); TransformerFactory factory = TransformerFactory.newInstance(); FileInputStream xsltFis = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileInputStream(<span class="hljs-string"><span class="hljs-string">"C:\\TEMP\\map_xsl.svg"</span></span>); InputStreamReader xsltIn = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InputStreamReader(xsltFis, <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>); Source xslt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StreamSource(xsltIn); Transformer transformer = factory.newTransformer(xslt); InputStream xmlIn = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ByteArrayInputStream( xml.getBytes( <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span> ) ); Source text = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StreamSource(xmlIn); String filename = <span class="hljs-string"><span class="hljs-string">"map"</span></span> + System.currentTimeMillis() + <span class="hljs-string"><span class="hljs-string">".svg"</span></span>; String filePath = <span class="hljs-string"><span class="hljs-string">"C:\\TEMP\\"</span></span> + filename; transformer.transform(text, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StreamResult(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(filePath)));</code> </pre> <br></div></div><br>  Pada prinsipnya, kita bisa berhenti di sini, browser menampilkan SVG tanpa masalah.  Tetapi laporan yang dijelaskan juga diperoleh melalui bot Telegram, jadi SVG harus dikonversi ke beberapa format seperti JPEG atau PNG.  Untuk melakukan ini, gunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Apache Batik</a> <br><br><div class="spoiler">  <b class="spoiler_title">Konversikan ke PNG</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convertToPNG</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> String svg, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> String filename, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> String filePath)</span></span></span></span>{ String png = filePath + filename + <span class="hljs-string"><span class="hljs-string">".png"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { PNGTranscoder trancoder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PNGTranscoder(); String svgURI = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(svg).toURL().toString(); TranscoderInput input = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TranscoderInput(svgURI); OutputStream ostream = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileOutputStream(png); TranscoderOutput output = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TranscoderOutput(ostream); trancoder.transcode(input, output); ostream.flush(); ostream.close(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> filename + <span class="hljs-string"><span class="hljs-string">".png"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (MalformedURLException ex) { Logger.getLogger(ActualCriteriaValueGraphicServlet.class.getName()).log(Level.SEVERE, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, ex); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (FileNotFoundException | TranscoderException ex) { Logger.getLogger(ActualCriteriaValueGraphicServlet.class.getName()).log(Level.SEVERE, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, ex); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException ex) { Logger.getLogger(ActualCriteriaValueGraphicServlet.class.getName()).log(Level.SEVERE, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, ex); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }</code> </pre><br></div></div><br>  Laporan dalam bentuk peta sudah siap.  Itu juga dapat dilihat melalui browser dan diminta dari bot telegram.  Menurut saya, tidak buruk. <br><br><h3>  Kesimpulan </h3><br>  Pada waktu yang ditentukan, kami memiliki waktu dan sudah pada bulan Maret 2017, indikator kinerja bukannya Excel mulai dimasukkan secara teratur ke dalam sistem yang dibuat.  Di satu sisi, masalah maksimum belum terpecahkan, bagian yang paling sulit dari penghitungan indikator dilakukan secara manual.  Namun di sisi lain, penerapan perhitungan ini membawa risiko peningkatan yang konstan.  Selain itu, bahkan antarmuka sederhana yang dibuat untuk mengumpulkan data menghapus sejumlah besar pertanyaan dengan perubahan konstan, kontrol versi, dan ringkasan lembar kerja Excel.  Sejumlah besar pekerjaan manual, cek dan cek silang telah dihapus. <br><br>  Tidak mungkin untuk tidak mengatakan bahwa antarmuka di Open Xav tidak terlalu menyenangkan bagi pengguna.  Pada awalnya, ada banyak pertanyaan pada fitur-fiturnya.  Di beberapa titik, pengguna mulai mengeluh bahwa butuh terlalu banyak waktu untuk memasukkan data dan, secara umum, "kami ingin, seperti di Excel, hanya sebuah program."  Saya bahkan harus memonitor kecepatan input berdasarkan data pada saat pembuatan catatan.  Pemantauan ini menunjukkan bahwa bahkan dalam kasus yang paling parah, pengguna tidak menghabiskan lebih dari 15 menit pada input, tetapi biasanya masuk dalam 5-7, meskipun fakta bahwa mereka perlu memasukkan data di 22 cabang.  Indikator seperti itu tampaknya cukup dapat diterima. <br><br>  Namun, saya ingin mencatat dua hal: <br><br><ol><li>  Open Xava terbukti menjadi alat yang baik untuk membuat antarmuka dengan cepat.  Saya bahkan akan mengatakan antarmuka prototipe.  Juga keuntungan yang tidak diragukan lagi adalah keteraturan dan keteraturan umum.  Semua bentuk dalam aplikasi dibuat sesuai dengan prinsip-prinsip yang seragam, yang memungkinkan pengembang untuk tidak datang dengan sepeda di mana ia tidak membutuhkannya, tetapi pengguna untuk berurusan dengan set formulir standar.  Namun, upaya untuk menerapkan logika yang lebih kompleks atau mengubah kontrol untuk diri kita sendiri membawa kita ke sejumlah masalah yang tidak dapat kita atasi dalam waktu yang ditentukan.  Kemungkinan besar, kami hanya tidak mengerti, dan tujuannya adalah untuk membuat antarmuka CRUD sederhana dengan upaya minimal.  Bagi saya sendiri, saya menyimpulkan bahwa Open Xava adalah alat yang menarik di mana mudah untuk melakukan hal-hal sederhana, tetapi jika Anda perlu melakukan sesuatu yang rumit, saya lebih suka menghabiskan lebih banyak waktu membuat bagian klien menggunakan ExtJS atau React, tetapi memiliki lebih banyak fleksibilitas . </li><li>  Bahkan pengguna yang percaya diri membuat antarmuka baru menjadi sulit.  Ini tentu saja bukan rahasia.  Menurut pendapat saya, ini terutama karena kurangnya pemahaman tentang sifat sistemik dari banyak antarmuka.  Bagi banyak orang, aplikasi apa pun memiliki seperangkat layar, yang masing-masing unik dan berfungsi sesuai dengan prinsipnya yang tidak diketahui: misalnya, ada formulir dengan daftar objek / garis (daftar formulir), tetapi bagi begitu banyak pengguna, sama sekali tidak jelas bahwa setiap formulir seperti itu dalam aplikasi dapat memiliki penyaringan seragam, pagination, fungsi penyortiran, dan umumnya perilaku yang sama, ditambah dengan fungsi spesifik.  Ini diperparah oleh kenyataan bahwa sejumlah besar perangkat lunak perusahaan adalah tumpukan tombol dan formulir yang hampir spontan, dibumbui dengan dokumentasi tidak jelas dalam gaya "Klik tombol ini."  Dari sudut pandang ini, antarmuka yang dibuat oleh pengembang pengguna disiplin Open Xav yang sama, membuat lebih banyak urutan di kepala.  Benar, dengan pendekatan ini, tombol ajaib tidak menghilang di mana pun, tetapi menjadi tertata rapi dalam bentuk. </li></ol><br>  Jika kita berbicara tentang manfaat bagi organisasi secara keseluruhan, maka setelah aplikasi diperkenalkan, seperti yang diharapkan, tingkat kontrol meningkat.  Pemimpin lapangan menerima alat untuk memantau indikator, yang dengannya mereka dapat mempengaruhi pekerjaan dalam mode yang lebih operasional, membandingkan indikator untuk periode yang berbeda, tanpa bingung dengan aliran file yang dikirim.  Kepentingan para pemimpin dalam pengawasan yang konstan dan waspada terhadap cabang mereka ditemukan oleh kami dengan cara yang sangat menarik: sambil melihat-lihat log bot Telegram, kami memperhatikan bahwa beberapa laporan diterima pada jam 4 atau 5 pagi.  Anda bisa langsung melihat siapa yang tertarik dengan pekerjaan. <br><br>  Itu saja.  Saya akan berterima kasih atas umpan balik yang membangun! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id423919/">https://habr.com/ru/post/id423919/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id423897/index.html">Kiat Berguna untuk Menggunakan HyperLynx DDR Wizard untuk Analisis QDR4</a></li>
<li><a href="../id423901/index.html">Saat kecepatan dan penskalaan diperlukan: server perangkat iOS yang didistribusikan</a></li>
<li><a href="../id423903/index.html">Perendaman dalam AD: kami menganalisis serangan lanjutan pada Microsoft Active Directory dan cara mendeteksi mereka</a></li>
<li><a href="../id423905/index.html">Pengembang tetap tidak dikenal. Kuliah Yandex</a></li>
<li><a href="../id423911/index.html">Photonics silikon tersandung pada meter terakhir</a></li>
<li><a href="../id423921/index.html">10 tahun Android: ingat semuanya</a></li>
<li><a href="../id423923/index.html">SAP Leonardo Hackathon dari velcom dan SAP untuk pengembang dari Belarus</a></li>
<li><a href="../id423925/index.html">Buka webinar "Templat rekursif aneh"</a></li>
<li><a href="../id423927/index.html">10 mesin pencari yang menjanjikan untuk meningkatkan SEO</a></li>
<li><a href="../id423931/index.html">Bagaimana cara memotong otentikasi SMS saat menghubungkan ke jaringan Wi-Fi publik?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>