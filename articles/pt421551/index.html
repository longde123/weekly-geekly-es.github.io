<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôèüèª üò∂ üïñ Dominando Vuex - De Zero a Her√≥i üêè üëáüèª üñ•Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° Habr! Apresento a voc√™ a tradu√ß√£o do artigo ‚ÄúMastering Vuex - Zero to Hero‚Äù, de Sanath Kumar. 


 A documenta√ß√£o oficial da Vuex define como um pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dominando Vuex - De Zero a Her√≥i</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421551/"><p>  Ol√° Habr!  Apresento a voc√™ a tradu√ß√£o do artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">‚ÄúMastering Vuex - Zero to Hero‚Äù,</a> de Sanath Kumar. </p><br><p>  A documenta√ß√£o oficial da Vuex define como um <b>padr√£o de gerenciamento de estado</b> + biblioteca para aplicativos Vue.js.  <i>Mas o que isso significa?</i>  <i>O que √© um padr√£o de gerenciamento de estado?</i> </p><br><p>  Imagine que voc√™ est√° trabalhando em um aplicativo Web grande com centenas de rotas e componentes.  N√£o seria mais f√°cil se pud√©ssemos armazenar todos os dados que precisar√≠amos em um aplicativo em um armazenamento centralizado? </p><br><img src="https://habrastorage.org/webt/dm/rc/t5/dmrct5ro7paby7tugthhzagynxw.jpeg"><a name="habracut"></a><br><p> Cada componente ou rota em nosso aplicativo solicitar√° dados do estado Vuex e transferir√° os dados alterados de volta ao estado. </p><br><p>  Em ess√™ncia, o estado da Vuex pode ser visto como a √∫nica fonte de verdade para toda a aplica√ß√£o. </p><br><p>  Os dados s√£o armazenados dentro do estado como um objeto JSON.  Por exemplo: </p><br><pre><code class="plaintext hljs">state: { name: "John Doe", age: "28" }</code> </pre> <br><p>  Mas como nossos componentes e rotas podem acessar dados armazenados em nosso estado?  Para fazer isso, precisamos definir <b>getters</b> dentro de nosso reposit√≥rio Vuex que retornar√£o dados do reposit√≥rio para nossos componentes.  Vamos ver como √© um <b>getter</b> simples, que recebe o nome do nosso reposit√≥rio: </p><br><pre> <code class="plaintext hljs">getters: { NAME: state =&gt; { return state.name; }, }</code> </pre> <br><p>  Observe que o nome do getter est√° em letras mai√∫sculas.  Esta √© apenas uma recomenda√ß√£o de estilo de c√≥digo.  N√£o √© necess√°rio segui-lo se voc√™ n√£o gostar. </p><br><p>  Agora que definimos um getter para o nome, √© incrivelmente f√°cil obter o valor do nome dentro do nosso componente.  O c√≥digo abaixo permite que voc√™ fa√ßa isso. </p><br><pre> <code class="plaintext hljs">let name = this.$store.getters.NAME;</code> </pre> <br><p>  N√≥s descobrimos como <b>obter</b> dados do armazenamento.  Agora vamos ver como podemos <b>definir os</b> dados no reposit√≥rio.  Vamos definir setters, certo?  Al√©m disso, os setters Vuex s√£o nomeados de maneira um pouco diferente.  Definimos uma <b>muta√ß√£o</b> para definir dados para o nosso estado Vuex. </p><br><pre> <code class="plaintext hljs">mutations: { SET_NAME: (state, payload) =&gt; { state.name = payload; }, }</code> </pre> <br><p>  O que mais √© carga √∫til?  <b>Carga √∫til</b> √© os dados transmitidos √† nossa muta√ß√£o a partir do componente que a produz.  Como podemos fazer isso?  Muito simples: </p><br><pre> <code class="plaintext hljs">this.$store.commit('SET_NAME', your_name);</code> </pre> <br><p>  Este trecho de c√≥digo mudar√° o estado do aplicativo e definir√° qualquer valor atribu√≠do ao <i>seu_nome</i> para a propriedade name dentro de nosso reposit√≥rio. </p><br><p>  MUTA√á√ïES SINCR√îNICAS </p><br><p>  Imagine que temos uma lista de nomes armazenados em um banco de dados em um servidor remoto.  O servidor nos fornece um terminal que retorna uma matriz de nomes que podem ser usados ‚Äã‚Äãem nosso Vue.js.  Obviamente, podemos usar o <b>Axios</b> para consultar o terminal e obter os dados. </p><br><pre> <code class="plaintext hljs">let {data} = await Axios.get('https://myapiendpoint.com/api/names');</code> </pre> <br><p>  Depois disso, podemos passar a matriz retornada para o estado Vuex da nossa loja usando uma muta√ß√£o.  F√°cil n√©?  Mas na verdade n√£o.  Muta√ß√µes s√£o s√≠ncronas e n√£o podemos executar opera√ß√µes ass√≠ncronas, como chamadas de API, dentro de uma muta√ß√£o. </p><br><p>  O que devemos fazer ent√£o?  Crie <b>a√ß√µes</b> . </p><br><p>  A√ß√µes s√£o como muta√ß√µes, mas em vez de mudar diretamente o estado, elas fazem uma muta√ß√£o.  Parece confuso?  Vejamos o an√∫ncio da a√ß√£o. </p><br><pre> <code class="plaintext hljs">actions: { SET_NAME: (context, payload) { context.commit('SET_NAME', payload); }, }</code> </pre> <br><p>  Definimos uma a√ß√£o chamada SET_NAME que leva o contexto e a <i>carga √∫til</i> como par√¢metros.  A a√ß√£o confirma a muta√ß√£o SET_NAME, criada anteriormente, com os dados passados ‚Äã‚Äãpara ela, ou seja, <b>seu_nome</b> . </p><br><p>  Agora, em vez de invocar a muta√ß√£o diretamente, nossos componentes acionam a a√ß√£o SET_NAME com um novo nome como dados, da seguinte maneira: </p><br><pre> <code class="plaintext hljs">this.$store.dispatch('SET_NAME', your_name);</code> </pre> <br><p>  Em seguida, a a√ß√£o inicia a muta√ß√£o com os dados passados ‚Äã‚Äãpara ela, ou seja, seu nome. </p><br><br><h2>  Mas porque? </h2><br><p>  Voc√™ pode estar se perguntando por que uma declara√ß√£o de a√ß√£o √© necess√°ria se podemos simplesmente iniciar muta√ß√µes com um novo valor diretamente de nossos componentes.  Como mencionado acima, as muta√ß√µes s√£o s√≠ncronas, mas nenhuma a√ß√£o. </p><br><p>  No exemplo acima, o caso √© considerado quando voc√™ precisa atualizar o valor do nome, mas n√£o apenas em seu estado, mas tamb√©m no banco de dados em execu√ß√£o no servidor remoto.  Estou certo de que √© assim que voc√™ pretende usar o Vuex em um projeto real em 99% dos casos.  D√™ uma olhada no seguinte trecho de c√≥digo: </p><br><pre> <code class="plaintext hljs">mutations: { SET_NAME: (state, name) =&gt; { state.name = name; }, }, actions: { SET_NAME: async (context, name) =&gt; { let {data} = await Axios.post('http://myapiendpoint.com/api/name', {name: name}); if (data.status == 200) { context.commit('SET_NAME', name); } }, }</code> </pre> <br><p>  O c√≥digo em si √© auto-explicativo.  Usamos o Axios para enviar o nome ao terminal.  Se a solicita√ß√£o POST foi bem-sucedida e o valor do nome do campo foi alterado com sucesso no servidor, iniciamos a muta√ß√£o SET_ NAME para atualizar o valor do nome dentro do nosso estado. </p><br><p>  TOMAR PR√ÅTICA NUNCA INICIAR MUTA√á√ïES DIRETAMENTE.  PARA ISSO SEMPRE USE A√á√ïES. </p><br><br><h2>  Configurando o armazenamento Vuex no Vue.JS </h2><br><p>  Vamos nos aprofundar e descobrir como podemos implementar o Vuex em um aplicativo real. </p><br><h3>  Etapa 1. Instale o Vuex </h3><br><pre> <code class="plaintext hljs">npm install --save vuex</code> </pre> <br><h3>  Etapa 2. Criando um reposit√≥rio Vuex </h3><br><ol><li>  Crie o diret√≥rio da <b>loja</b> na raiz do nosso aplicativo. </li><li>  Crie o arquivo <b>index.js</b> neste diret√≥rio e use o c√≥digo abaixo para criar um novo reposit√≥rio. </li></ol><br><pre> <code class="plaintext hljs">import Vue from 'vue'; import Vuex from 'vuex'; Vue.use(Vuex); export const store = new Vuex.Store({ state: {}, getters: {}, mutations: {}, actions: {}, });</code> </pre> <br><h3>  Etapa 3. Adicionando armazenamento Vuex ao aplicativo Vue.JS </h3><br><p>  1. Importe o <b>reposit√≥rio</b> para o arquivo main.js. </p><br><pre> <code class="plaintext hljs">import {store} from './store';</code> </pre> <br><p>  2. Adicione <b>armazenamento</b> √† inst√¢ncia do Vue, como mostrado abaixo: </p><br><pre> <code class="plaintext hljs">new Vue({ el: '#app', store, router, render: h =&gt; h(App), });</code> </pre> <br><p>  Agora podemos adicionar vari√°veis ‚Äã‚Äãde estado, getters, muta√ß√µes e a√ß√µes ao nosso reposit√≥rio Vuex. </p><br><br><h2>  Exemplo </h2><br><p>  D√™ uma olhada no reposit√≥rio Vuex de um aplicativo simples da lista de tarefas.  "N√£o √© apenas mais uma lista de tarefas !!!".  Hein?  N√£o se preocupe.  No final deste artigo, voc√™ aprender√° como usar toda a pot√™ncia do Vuex. </p><br><pre> <code class="plaintext hljs">import Vue from 'vue'; import Vuex from 'vuex'; import Axios from 'axios'; Vue.use(Vuex); export const store = new Vuex.Store({ state: { todos: null, }, getters: { TODOS: state =&gt; { return state.todos; }, }, mutations: { SET_TODO: (state, payload) =&gt; { state.todos = payload; }, ADD_TODO: (state, payload) =&gt; { state.todos.push(payload); }, }, actions: { GET_TODO: async (context, payload) =&gt; { let {data} = await Axios.get('http://yourwebsite.com/api/todo'); context.commit('SET_TODO', data); }, SAVE_TODO: async (context, payload) =&gt; { let {data} = await Axios.post('http://yourwebsite.com/api/todo'); context.commit('ADD_TODO', payload); }, }, });</code> </pre> <br><br><h2>  Adicionar um novo item √† lista de tarefas </h2><br><p>  Dentro do seu componente, inicie a a√ß√£o SAVE_TODO passando um novo item de tarefa, conforme mostrado no snippet de c√≥digo abaixo. </p><br><pre> <code class="plaintext hljs">let item = 'Get groceries'; this.$store.dispatch('SAVE_TODO', item);</code> </pre> <br><p>  A a√ß√£o <b>SAVE_TODO</b> faz uma solicita√ß√£o POST para o terminal e inicia a <b>muta√ß√£o ADD_TODO</b> , que adiciona um item de <b>tarefa</b> √† vari√°vel de estado <b>todos</b> . </p><br><br><h2>  Obtendo itens de tarefas </h2><br><p>  Dentro do bloco <b>mounted ()</b> do seu componente, inicie a segunda a√ß√£o <b>GET_TODO</b> , que recebe todos os itens de <b>pend√™ncias</b> do n√≥ de extremidade e os armazena na vari√°vel de estado <i>todos</i> , iniciando a muta√ß√£o SET_TODO: </p><br><pre> <code class="plaintext hljs">mounted() { this.$store.dispatch('GET_TODO'); }</code> </pre> <br><br><h2>  Acessar itens de tarefas pendentes dentro de um componente </h2><br><p>  Para acessar o elemento <i>todos</i> dentro de um componente, crie uma propriedade computada: </p><br><pre> <code class="plaintext hljs">computed: { todoList() { return this.$store.getters.TODOS; }, }</code> </pre> <br><p>  Dentro do componente, voc√™ pode acessar a propriedade computada: </p><br><pre> <code class="plaintext hljs">&lt;div class="todo-item" v-for="item in todoList"&gt;&lt;/div&gt;</code> </pre> <br><br><h2>  Usando o m√©todo mapGetters </h2><br><p>  Existe uma maneira ainda mais f√°cil de acessar itens de tarefas em um componente usando o m√©todo <b>mapGetters</b> fornecido pela Vuex. </p><br><pre> <code class="plaintext hljs">import {mapGetters} from 'vuex'; computed : { ...mapGetters(['TODOS']), //    }</code> </pre> <br><p>  Voc√™ j√° deve ter adivinhado que o c√≥digo dentro do modelo deve ser alterado, conforme mostrado no snippet abaixo. </p><br><pre> <code class="plaintext hljs">&lt;div class="todo-item" v-for="item in TODOS"&gt;&lt;/div&gt;</code> </pre> <br><p>  Observe como usamos o operador de distribui√ß√£o ES6 [...] dentro de nossas propriedades calculadas. </p><br><p>  O ARMAZENAMENTO VUEX N√ÉO √â APENAS A FONTE DO ESTADO ATUAL DO SEU APLICATIVO.  √â TAMB√âM O √öNICO PONTO QUE DEVE MUDAR ESTE ESTADO. </p><br><p>  Isso requer uma pequena explica√ß√£o.  J√° aprendemos como criar a√ß√µes para <b>receber</b> e <b>instalar</b> itens de <b>tarefas</b> em nosso reposit√≥rio.  E se precisarmos atualizar um elemento e marc√°-lo?  Onde executamos o c√≥digo para isso? </p><br><p>  Na Internet, voc√™ pode encontrar opini√µes diferentes sobre esse assunto.  A documenta√ß√£o tamb√©m n√£o possui orienta√ß√µes claras sobre isso. </p><br><p>  Eu recomendaria armazenar todas as chamadas de API dentro de a√ß√µes no seu reposit√≥rio Vuex.  Assim, cada altera√ß√£o de estado ocorre apenas dentro do reposit√≥rio, facilitando a depura√ß√£o e simplificando o entendimento do c√≥digo, al√©m de facilitar a edi√ß√£o do c√≥digo. </p><br><br><h2>  Organiza√ß√£o do c√≥digo </h2><br><p>  Salvar todas as vari√°veis ‚Äã‚Äãde estado, getters, a√ß√µes e muta√ß√µes em um arquivo rapidamente o tornar√° complicado assim que voc√™ come√ßar a trabalhar com aplicativos grandes.  Vamos ver como voc√™ pode organizar o armazenamento em v√°rios arquivos como m√≥dulos. </p><br><p>  Crie um novo diret√≥rio dentro do seu reposit√≥rio e denomine-o de <i>m√≥dulos</i> .  Adicione o arquivo <i>todos.js</i> ao diret√≥rio criado que cont√©m o seguinte c√≥digo: </p><br><pre> <code class="plaintext hljs">const state = {}; const getters = {}; const mutations = {}; const actions = {}; export default { state, getters, mutations, actions, };</code> </pre> <br><p>  Agora podemos mover as vari√°veis ‚Äã‚Äãde estado, getters, muta√ß√µes e a√ß√µes do arquivo <b>index.js</b> para o arquivo <b>todos.js</b> .  Lembre-se de importar o <b>Axios</b> .  Tudo o que precisamos fazer √© informar √† Vuex que criamos o m√≥dulo de armazenamento e onde encontr√°-lo.  O arquivo <i>index.js</i> atualizado deve ter a seguinte apar√™ncia: </p><br><pre> <code class="plaintext hljs">import Vue from 'vue'; import Vuex from 'vuex'; import Axios from 'axios'; import todos from './modules/todos'; Vue.use(Vuex); export const store = new Vuex.Store({ state: {}, getters: {}, mutations: {}, actions: {}, modules: { todos, }, });</code> </pre> <br><p>  O arquivo <b>todos.js</b> ficar√° assim: </p><br><pre> <code class="plaintext hljs">import Axios from 'axios'; state = { todos: null, }; getters = { TODOS: state =&gt; { return state.todos; }, }; mutations = { SET_TODO: (state, payload) =&gt; { state.todos = payload; }, ADD_TODO: (state, payload) =&gt; { state.todos.push(payload); }, }; actions = { GET_TODO: async (context, payload) =&gt; { let {data} = await Axios.get('http://yourwebsite.com/api/todo'); context.commit('SET_TODO', data); }, SAVE_TODO: async (context, payload) =&gt; { let {data} = await Axios.post('http://yourwebsite.com/api/todo'); context.commit('ADD_TODO', payload); }, }; export default { state, getters, mutations, actions, };</code> </pre> <br><br><h2>  Sum√°rio </h2><br><ol><li>  O estado do aplicativo √© armazenado como um objeto JSON grande. </li><li>  <b>Os getters</b> s√£o usados ‚Äã‚Äãpara acessar valores armazenados na loja. </li><li>  <b>Muta√ß√µes</b> atualizam sua condi√ß√£o.  Deve-se lembrar que as muta√ß√µes s√£o s√≠ncronas. </li><li>  Todas as opera√ß√µes ass√≠ncronas devem ser executadas em <b>a√ß√µes</b> .  As a√ß√µes mudam de estado, iniciando muta√ß√µes. </li><li>  Estabele√ßa uma regra para iniciar <b>muta√ß√µes</b> exclusivamente atrav√©s da <b>a√ß√£o</b> . </li><li>  <b>M√≥dulos</b> podem ser usados ‚Äã‚Äãpara organizar seu armazenamento em v√°rios arquivos pequenos. </li></ol><br><p>  O Vuex torna o trabalho com o Vue muito mais f√°cil e divertido.  Se voc√™ √© iniciante, pode haver situa√ß√µes em que √© dif√≠cil decidir se deve usar o Vuex em determinadas √°reas do seu aplicativo.  Siga seu instinto.  Voc√™ alcan√ßar√° a alta velocidade rapidamente. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt421551/">https://habr.com/ru/post/pt421551/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt421537/index.html">Fun√ß√µes de ordem superior em JS: curso de lutador jovem</a></li>
<li><a href="../pt421543/index.html">Clonar um cart√£o sem contato usando um aplicativo m√≥vel</a></li>
<li><a href="../pt421545/index.html">Revis√£o do PocketBook 616 - o bolso 2018 mais econ√¥mico com fun√ß√£o de luz de fundo</a></li>
<li><a href="../pt421547/index.html">Aceita√ß√£o independente do data center</a></li>
<li><a href="../pt421549/index.html">Estamos escrevendo documenta√ß√£o t√©cnica: um guia para o leigo</a></li>
<li><a href="../pt421553/index.html">Compartilhamos conte√∫do tecnol√≥gico: reunimos todos os nossos materiais em um site</a></li>
<li><a href="../pt421555/index.html">Projeto WideNES - v√° al√©m dos limites da tela do NES</a></li>
<li><a href="../pt421557/index.html">Li√ß√£o aberta "Programa√ß√£o ass√≠ncrona em Java"</a></li>
<li><a href="../pt421559/index.html">Arquitetura da interface do usu√°rio do componente no aplicativo iOS</a></li>
<li><a href="../pt421563/index.html">Pode ser necess√°rio sentar-se de maneira diferente para se livrar da dor nas costas.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>