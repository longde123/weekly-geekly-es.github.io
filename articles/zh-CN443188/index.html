<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>âŒ ğŸ‘ğŸ½ ğŸ’¾ ä¸‰åªçœ¼ç›å‚åœ¨æŸ±å­ä¸Šï¼Œæˆ–è€…ä¼ è¯´ATtiny13çš„äº”æ¡è…¿å°±è¶³å¤Ÿäº† â„¢ï¸ ğŸ¤µğŸ½ ğŸ¤µğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="KDPVâ€œå“¦ï¼Œå°±æ˜¯è¿™æ ·ã€‚â€ 


 è¿™ç§æ¼«é•¿çš„å†ç¨‹å‡ ä¹ä¸å¯èƒ½æˆä¸ºçŸ¥è¯†åˆ†å­çš„ç”Ÿå‘½ä¹‹æºï¼Œå› ä¸ºä»–ä»¬å¯¹å¡è¯ºï¼ˆCarnotï¼‰å¡å åœçš„ç§˜å¯†éå¸¸äº†è§£ï¼Œå¹¶ä¸”çŸ¥é“ç¬¬ä¸‰èŒƒå¼çš„ç§˜å¯†å«ä¹‰ã€‚ ä½†æ˜¯ï¼Œå¦‚æœç”±äºæŸç§åŸå› æ‚¨ç”¨æ‰‹è§¦æ‘¸äº†arduinoï¼Œç”µçƒ™é“æ­£åœ¨å¨æˆ¿ä¸­ç§¯èšç°å°˜ï¼Œæ‚¨æ˜ç™½äº†ä¸ºä»€ä¹ˆç”µæ± æœ‰ä¸€ä¸ªä¼˜ç‚¹ï¼Œè€ŒC ++æœ‰ä¸¤ä¸ªä¼˜ç‚¹ï¼Œé‚£ä¹ˆçœŸ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä¸‰åªçœ¼ç›å‚åœ¨æŸ±å­ä¸Šï¼Œæˆ–è€…ä¼ è¯´ATtiny13çš„äº”æ¡è…¿å°±è¶³å¤Ÿäº†</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443188/"><p><img src="https://habrastorage.org/webt/51/tw/-p/51tw-pewtw_nf5txookeohz5qga.jpeg"><br>  <em>KDPVâ€œå“¦ï¼Œå°±æ˜¯è¿™æ ·ã€‚â€</em> </p><br><p> è¿™ç§æ¼«é•¿çš„å†ç¨‹å‡ ä¹ä¸å¯èƒ½æˆä¸ºçŸ¥è¯†åˆ†å­çš„ç”Ÿå‘½ä¹‹æºï¼Œå› ä¸ºä»–ä»¬å¯¹å¡è¯ºï¼ˆCarnotï¼‰å¡å åœçš„ç§˜å¯†éå¸¸äº†è§£ï¼Œå¹¶ä¸”çŸ¥é“ç¬¬ä¸‰èŒƒå¼çš„ç§˜å¯†å«ä¹‰ã€‚ ä½†æ˜¯ï¼Œå¦‚æœç”±äºæŸç§åŸå› æ‚¨ç”¨æ‰‹è§¦æ‘¸äº†arduinoï¼Œç”µçƒ™é“æ­£åœ¨å¨æˆ¿ä¸­ç§¯èšç°å°˜ï¼Œæ‚¨æ˜ç™½äº†ä¸ºä»€ä¹ˆç”µæ± æœ‰ä¸€ä¸ªä¼˜ç‚¹ï¼Œè€ŒC ++æœ‰ä¸¤ä¸ªä¼˜ç‚¹ï¼Œé‚£ä¹ˆçœŸæ­£ç¥å¥‡å’Œä»¤äººæƒŠå¥‡çš„å¥‡è¿¹å°†ä¸ä¼šä»¤æ‚¨æ— åŠ¨äºè¡·ã€‚ æ‰€ä»¥ï¼Œæˆ‘å¾ˆé«˜å…´å‘æ‚¨æ¨èæµæµªé©¬æˆå›¢<abbr title="è¿™äº›ä¸æ˜¯è‰ºæœ¯å®¶çš„åå­—ï¼Œä¸æ˜¯åœŸå¯ï¼ˆç”¨æ ‘æï¼Œç²˜åœŸå’Œå…¶ä»–ä¸œè¥¿åˆ¶æˆçš„ç –å¤´ï¼‰ï¼Œè€Œæ˜¯é»„æ¨æœ¨ï¼ˆä¸€ç§çè´µçš„æ ‘ç§ï¼‰ã€‚">â€œè¨æ»¡ä¸é»„æ¨æœ¨â€</abbr>çš„ä»Šå¤©æ¼”å‡ºæ•°é‡ï¼š </p><br><ul><li> åœ¨ATtiny13ä¸­æ·»åŠ RAMå’ŒROMï¼ </li><li> å¾®å¤„ç†å™¨ä¸­çš„äººå·¥æ™ºèƒ½-ä¼˜ç¼ºç‚¹ï¼Œè¿˜æ˜¯ç†Ÿç¡ä¸­çš„ç¾å¥³-å¥½å§ï¼Œå¥¹ä¸æ˜¯å‚»ç“œå—ï¼Ÿ </li><li> è¿˜æ˜¯ä»ç„¶æ˜¯dura lex sed lexï¼Ÿ </li><li> å¦‚ä½•å¢åŠ è…¿åˆ°ATtiny13ï¼Ÿ </li><li> å…³äºç¬¬äº”ç»´çš„å‡ å¥è¯ï¼šå¦‚ä½•å¡æ»¡éš¾ä»¥å¿å—çš„ä¸œè¥¿ï¼Ÿ </li><li> å°†ä¸€åŠçš„å†…å®¹ç‰©æ··åˆåœ¨ä¸€èµ·ï¼Œä»¥åˆ‡æˆä¸¤åŠçš„éå¤„å¥³ï¼ˆä¿è¯æ¢å¤ï¼‰ã€‚ </li><li>  â€œä¸ºå—éš¾è€…æä¾›é£Ÿç‰©â€ï¼ˆè§å…ˆå‰çš„æ¡ˆä¾‹ï¼Œæœ‰äº”åƒä¸ªå¤§éº¦é¥¼å’Œä¸¤æ¡é±¼é¥±å’Œäº†äº”åƒäººï¼‰ã€‚ </li></ul><br><p> å¦‚æœå°†æ¥è‡³å°‘æœ‰ä¸€ä¸ªçªé—¨å¯¹æ‰€æœ‰äºŒåå²çš„è¯»è€…æ¥è¯´éƒ½æ´¾ä¸Šç”¨åœºï¼Œæˆ‘ä¼šæ„Ÿåˆ°æ»¡æ„çš„æ˜¯ï¼Œè¿™ç¯‡æ–‡ç« çš„æ’°å†™æ²¡æœ‰ç™½è´¹ã€‚ </p><a name="habracut"></a><br><h2 id="svetofor-pervyy-ili-kaa-prinimaet-boy"> ç¬¬ä¸€ä¸ªäº¤é€šä¿¡å·ç¯æˆ–Kaaå‚åŠ æˆ˜æ–—ã€‚ </h2><br><p> æ•…äº‹å¼€å§‹äºæ­¤ï¼Œå°±åƒç»å…¸çš„åœ£è¯èŠ‚å‰åœ£è¯èŠ‚å½•åƒä¸€æ ·ï¼Œå½“ç…§ç›¸æœºä»ç£¨ç ‚çš„çª—æˆ·æœ›è¿›ä¸€ä¸ªå°èˆ’é€‚çš„æˆ¿é—´æ—¶ï¼šä¸€ç›åœ£è¯æ ‘ç”¨é‡‘å±ä¸ï¼Œæ£‰ç»’å’Œç©å…·ï¼Œæ©˜å­å’Œç”œé…’çš„æ°”å‘³ï¼Œçƒ›å…‰ä¸‹çš„é˜´å½±æ¸©æš–çš„é¢¤æŠ–ã€‚ åœ¨å¤§æ²™å‘ä¸Šï¼Œå¥¹æ‹‰ç›´æ ¼å­ï¼Œè½»è½»åœ°å°†è„¸é¢ŠæŒ‰åœ¨ä»–çš„è‚©è†€ä¸Šï¼Œä¸ä¸“å¿ƒåœ°å¬ç€çƒ­æƒ…åœ°æ‰“æ‰‹åŠ¿çš„å¤©ä½¿èˆ¬çš„å°å¥³å­©â€¦â€¦ </p><br><p> é‚£äº›æœ‰çˆ¶æ¯ç»éªŒçš„äººéå¸¸æ¸…æ¥šæ‚¨åœ¨æ­¤æ—¶æ­¤åˆ»ä¼šå¬åˆ°ä»€ä¹ˆã€‚ æˆ‘å°†å‘é‚£äº›å°šæœªæŒæ¡è¿™ç§æŠ€èƒ½çš„äººè§£é‡Š-å¾ˆæœ‰å¯èƒ½çˆ¶æ¯ä¼šä¸ºè¯¸å¦‚â€œçˆ¸çˆ¸ï¼ æˆ‘ä»¬æ˜å¤©ï¼ ä¸Šå¹¼å„¿å›­ï¼ æˆ‘å¿…é¡»ï¼ å°†å·¥è‰ºå“å¸¦åˆ°åœ£è¯æ ‘æ¯”èµ›ä¸­ï¼ æˆ‘æƒ³è¦ç¬¬ä¸€åï¼â€ </p><br><p> è¿™æ˜¯å¿…è¦çš„ã€‚ æ˜å¤© ç»™æˆ‘ä»¬ å·¥è‰ºå“ã€‚ æœ€å¥½çš„ã€‚ </p><br><p> ä¸å®¢æˆ·è¿›è¡Œçš„è®¿è°ˆæ˜¾ç¤ºäº†å·¥ä½œé™ˆè¿°çš„è½®å»“ï¼šæˆ‘ä»¬éœ€è¦ä¸€ä¸ªäº¤é€šä¿¡å·ç¯ã€‚ å˜å¾—ç¾ä¸½å¹¶åƒçœŸå®çš„ä¸€æ ·å‘å…‰ã€‚ åœ¨è¿™ä¸ªé˜¶æ®µï¼ŒISUé¡¹ç›®çš„å€™é€‰äººé˜Ÿä¼å·²ç»å¤§å¤§å‡å°‘ï¼šçˆ¸çˆ¸æ— æ³•è¯å®æ¼‚äº®ï¼ŒæŸ”è½¯ï¼Œç¼åˆ¶çš„ï¼Œç¼–ç»‡çš„æˆ–é’©ç¼–çš„äº¤é€šä¿¡å·ç¯æ˜¯å®¢æˆ·æ¢¦sä»¥æ±‚çš„ä½“ç°çš„æƒ³æ³•ï¼šäº¤é€šä¿¡å·ç¯å¿…é¡»ç‚¹äº®-ä¸æ¸…æ¥šå—ï¼Ÿ </p><br><p> å¤œæ™šç¬¼ç½©ç€æ•´ä¸ªå›½å®¶ï¼Œå·¥ä½œåœ¨æˆ‘ä»¬å›½å®¶å¼€å§‹æ²¸è…¾ã€‚ </p><br><p> äº¤é€šä¿¡å·ç¯çš„ä¸»ä½“ææ–™æ˜¯å«ç”Ÿçº¸å¥—ï¼Œè¢«å‹ç¼©å½¢æˆä¸€ä¸ªç›’å­ã€‚ ç”¨é“…ç¬”å°†åå¢å¸ƒçš„ç¡¬å¸åŒ…å›´èµ·æ¥ï¼Œç„¶ååœ¨å…‰ä¿¡å·ç¯çš„ç…§è€€ä¸‹ç”¨ç¬”åˆ€å°†å­”åˆ‡æ‰ï¼ˆä¸ä¿¡ä»»å„¿ç«¥çš„åˆ›ä¼¤æ€§å·¥ä½œï¼‰ã€‚ </p><br><p><img src="https://habrastorage.org/webt/op/0f/az/op0fazb4pjg1z5mtam3hvudxve4.jpeg"></p><br><p> äº¤é€šä¿¡å·ç¯é¡¶éƒ¨å’Œåº•éƒ¨çš„ç›–å­æ˜¯ä»ç¡¬çº¸æ¿ä¸Šåˆ‡ä¸‹æ¥çš„ã€‚ å°†ç¯æ³¡ä¸Šçš„å³°é¡¶æŒ‰ç…§åˆ¶æˆçš„å›¾æ¡ˆåœ¨æ™®é€šçš„80å…‹çº¸ä¸Šåœˆå‡ºå¹¶æ‰‹åŠ¨åˆ‡å‡ºã€‚ </p><br><p><img src="https://habrastorage.org/webt/rm/ga/5u/rmga5uloolpi1di2umlqxn9lzmw.jpeg"></p><br><p> ç„¶åå°†å®ƒä»¬ç²˜åœ¨PVAä¸Šã€‚ </p><br><p><img src="https://habrastorage.org/webt/9x/ql/ff/9xqlfftsq_fphcorsj7nimjlqo8.jpeg"></p><br><p> å°†ç»„è£…å¥½çš„ç»“æ„æ‹–å…¥åº­é™¢ï¼Œå¹¶ç”¨ä¸™çƒ¯é…¸å–·æ¼†ä¸Šè‰²ï¼šæ…·æ…¨çš„é“¶è‰²ï¼Œç„¶åé¡¶éƒ¨ç•¥å¸¦é»‘è‰²ã€‚ </p><br><p><img src="https://habrastorage.org/webt/hh/bm/ha/hhbmhaz7bod1ntgplrtyfeu3bgq.jpeg"></p><br><p> ä¸‡ä¸€åœ¨ä»»ä½•é˜¶æ®µå‘ç”ŸæŸåï¼Œä¸€æ¬¡è¦åˆ¶ä½œä¸‰ä»½ã€‚ æœ€æˆåŠŸçš„æ˜¯åœ¨ä¸‰æ¡å½©è‰²çº¸ä¸Šç²˜è´´äº†æ»¤å…‰ç‰‡ï¼Œåˆ†åˆ«æ˜¯çº¢è‰²ï¼Œé»„è‰²å’Œç»¿è‰²ã€‚ </p><br><p> ä»å†…éƒ¨çªå‡ºæ˜¾ç¤ºæ˜¯ç”±æ¥è‡ªå›½åœŸæ…·æ…¨çš„åƒåœ¾ç®±ï¼ˆSHZRï¼‰çš„ä¸€å¯¹è¶…äº®ç™½è‰²LEDå†³å®šçš„ã€‚  KaptershchitskayaèŸ¾èœæ–­ç„¶æ‹’ç»å‘SCHRçš„çˆ¶äº²é€äº¤ä¸‰é¢—å¹³æ¿é”‚ç”µæ± ï¼Œå¹¶ä¸”LEDç¯ä¸åŒï¼Œå‘å…‰äºŒæç®¡ä¸ºç™½è‰²å’Œæ˜äº®ï¼Œç”µå‹é™ä¸º2.8è‡³3.9ä¼ã€‚ æˆ‘ä»¬è®¾æ³•ç”¨èŸ¾èœè®¨ä»·è¿˜ä»·çš„æœ€å¤§æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€å—AAç”µæ± ï¼Œçƒ§æ¯çš„ä¸»æ¿æ²¹é—¨å’ŒKT315æ™¶ä½“ç®¡ä¸Šçš„é“æ°§ä½“ç¯ã€‚ æ€è€ƒå’Œè°·æ­Œæœç´¢ï¼Œçˆ¸çˆ¸ä¸å¾—ä¸æ¥å—è¿™ä¸ªæè®®ã€‚ è€ƒè™‘åˆ°å¹¼å„¿å›­ä¸­æ¯ç»„çš„å¬‰æˆç¬”çš„æ•°é‡ï¼Œä½¿ç”¨é”‚ç”µæ± çš„æƒ³æ³•ä¼¼ä¹å¹¶ä¸ç‰¹åˆ«æœ‰å¸å¼•åŠ›ã€‚ </p><br><p> ç”µæ± ä¸Šäº¤é€šä¿¡å·ç¯çš„å¤–å£³ç”¨åˆºé¼»çš„æ²¹æ¼†æ°”å‘³ä»£æ›¿äº†é’ˆå¤´å’Œæ©˜å­çš„é¦™æ°”ï¼Œçˆ¶äº²è‹¥æœ‰æ‰€æ€åœ°åœ¨æ¾é¦™ä¸Šæˆ³äº†ä¸€ä¸‹çƒ™é“ï¼Œå­©å­ä»¬ç¼ ç»•äº†å˜å‹å™¨ä»¥å µå¡å‘ç”µæœºï¼ˆå¤åˆ¶ä»¶ï¼‰ï¼Œä¸€åˆ‡éƒ½æŒ‰è®¡åˆ’è¿›è¡Œäº†... </p><br><p> ä¸ï¼Œé‚£å¤©æ™šä¸Šæ²¡æœ‰â€œçªç„¶â€å‘ç”Ÿï¼šç¼ ç»•å˜å‹å™¨æ—¶ï¼Œæ‰€æœ‰çš„æŠ€å·§éƒ½æ˜¯ç«‹å³ç”¨åŒç»çº¿ç¼ ç»•æœ€å¤§å¯èƒ½çš„åŒæ•°ã€‚ è¯·å‹¿æ··æ·†LEDçš„é˜³æå’Œé˜´æä»¥åŠKT315æ™¶ä½“ç®¡çš„ç«¯å­ï¼Œå¹¶æ ¹æ®ç”µè·¯å›¾æ­£ç¡®è¿æ¥ç»•ç»„çš„ä¸¤ç«¯ï¼ˆå¦‚æœä¸äº®ï¼Œåˆ™å°†å®ƒä»¬äº’æ¢ï¼‰ã€‚  J1-æ¥è‡ªè®¡ç®—æœºè·³çº¿çš„ç”µæºå¼€å…³ï¼Œåæ¥æ˜¾ç¤ºåœ¨äº¤é€šä¿¡å·ç¯çš„â€œå±‹é¡¶ä¸Šâ€ã€‚ </p><br><p> é•¿æœŸä»¥æ¥ï¼Œäººä»¬ä¸€ç›´<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¹¿æ³›äº†è§£</a>ä¸€ç§å®Œå…¨ç®€å•çš„ç”µè·¯ï¼Œç”¨äºä»1.5V G1ç”µæ± äº§ç”Ÿ3-7Vå³°å€¼çš„äº¤æµç”µå‹ã€‚ </p><br><p><img src="https://habrastorage.org/webt/fx/on/h5/fxonh57exbpayjclrpo3k05sazg.png"></p><br><p> ä»ç‰©ç†ä¸Šè®²ï¼Œç”µè·¯å›¾ä½“ç°å¦‚ä¸‹ï¼š </p><br><p><img src="https://habrastorage.org/webt/tt/aq/4u/ttaq4unttq55rdeg-f0tr0ti3zq.png"></p><br><p> ç¹æ–‡tapeèŠ‚å¸¦æœ‰AAç¢±æ€§ç”µæ± ã€‚ </p><br><p> äº¤é€šä¿¡å·ç¯æœ¬èº«å°±æ˜¯è¿™æ ·ã€‚ </p><br><p><img src="https://habrastorage.org/webt/2s/5w/dd/2s5wddfdxjkcl34w1mgj_neduyg.jpeg"></p><br><p> æ—©æ™¨ï¼Œéª„å‚²çš„å­©å­å°†äº§å“æ‹–åˆ°å¹¼å„¿å›­ï¼Œåœ¨é‚£é‡Œï¼Œç©å…·å¼•èµ·äº†è½°åŠ¨ï¼Œå¹¶åœ¨åœ£è¯æ ‘ä¸Šå æ®äº†ä¸­å¿ƒä½ç½®ã€‚ </p><br><p><img src="https://habrastorage.org/webt/zz/fy/yc/zzfyyckk-i-jdncvaangd1cee8u.jpeg"></p><br><p> æ²¡é”™ï¼Œå®ƒæ²¡æœ‰åœ¨æ¯”èµ›ä¸­è·å¾—ç¬¬ä¸€å-äº‹å®è¯æ˜ï¼Œæäº¤ä½œå“çš„æˆªæ­¢æ—¥æœŸå·²ç»æ˜¯å‡ å¤©å‰äº†ã€‚ </p><br><p> åœ¨å®¶é‡Œï¼Œçª—å°ä¸Šæœ‰ä¸¤åº§å»ºç­‘ç‰©ï¼Œæˆ‘çˆ¶äº²å¯¹â€œæˆ‘è¦åƒä¸€ä¸ªçœŸæ­£çš„äº¤é€šä¿¡å·ç¯â€è¿™ä¸ªä»»åŠ¡çš„è§£å†³æ–¹æ¡ˆæ„Ÿåˆ°ä¸æ»¡ã€‚ ç„¶åæƒ³æ³•å°±æ—‹è½¬äº†ï¼šâ€œæ˜¯å¦æœ‰å¯èƒ½é€‚åˆä¸€ä¸ªå®Œæ•´çš„è§£å†³æ–¹æ¡ˆï¼Œæ¯”å¦‚è¯´åä¸‰å·èŸ¾èœå·²ç»åœ¨<abbr title="ç¥–å›½çš„æ…·æ…¨åƒåœ¾ç®±ï¼Œæˆ–è€…ç”¨ä»–çš„å¦»å­çš„è¯æ¥è¯´ï¼Œæ™®æŸ³ä»€é‡‘å¯ä»¥ä¿ç•™ã€‚">ShchZRä¸­æ”¾ç½®äº†</abbr>å¾ˆé•¿çš„æ—¶é—´äº†ï¼Ÿæ˜¯å¦ä¼šæœ‰è¶³å¤Ÿçš„5æ¡è…¿ï¼Œ1 KBçš„ä»£ç ç”¨äºå­˜å‚¨å’Œ64å­—èŠ‚çš„RAMï¼Œä»¥åŠæŒ‰é¡ºåºæ’åˆ—çš„åƒçœŸæ­£çš„RAMï¼Ÿâ€ </p><br><p> å› æ­¤ï¼Œæ‰€æœ‰è¿™ä¸€åˆ‡åªæ˜¯ä¸€å¥è¯ï¼Œä¸€ä¸ªå…³äºæœªæ¥äº¤é€šä¿¡å·ç¯é—®é¢˜æœ€ç»ˆè§£å†³æ–¹æ¡ˆçš„ç«¥è¯ã€‚ </p><br><h2 id="svetofor-vtoroy-kak-nastoyaschiy"> ç¬¬äºŒä¸ªäº¤é€šä¿¡å·ç¯ï¼Œå°±åƒä¸€ä¸ªçœŸæ­£çš„ </h2><br><h3 id="ispolzuemyy-instrumentariy-materialy-i-dokumentaciya"> äºŒæ‰‹å·¥å…·ï¼Œææ–™å’Œæ–‡æ¡£ </h3><br><p>  <em>è¯­è¨€/æ¡†æ¶</em> ï¼šC / Arduino 1.6 / 1.8ã€‚ <br>  <em>IDE</em> ï¼šMS Visual Studio 2012 + Visual Microæ’ä»¶+ gitã€‚ <br>  <em>CAD</em> ï¼šDipTraceã€‚ <br>  <em>ç¡¬ä»¶</em> ï¼šATtiny13 MKï¼ŒATmega328ä¸Šçš„Arduino Nanoå…‹éš†ï¼ŒFT232Rä¸Šçš„USB-UARTï¼Œä¸­å›½åUSBISPç¼–ç¨‹å™¨ã€‚ <br>  <em><abbr title="ç”µè·¯æ¿ã€‚">PP</abbr>æŠ€æœ¯</em> ï¼š <abbr title="æ¿€å…‰å’Œé“æŠ€æœ¯ã€‚">LUT</abbr> ã€‚ <br>  <em>å·¥å…·</em> ï¼šçƒ™é“ï¼Œèƒ¶æªï¼Œå¨æˆ¿çƒ¤ç®±ï¼Œåˆ€ï¼Œå‰ªåˆ€ï¼Œå‰ªçº¿é’³ã€‚ <br>  <em>ææ–™</em> ï¼šæ¥è‡ª<abbr title="éš¾å¤„ç†çš„ç”µå­å…ƒä»¶çš„å­˜å‚¨åº“-ç„Šæ¥ï¼Œä½¿ç”¨ï¼Œæ›¾ç»åœ¨Aliexpressä¸Šè´­ä¹°è¿‡çš„ç­‰">ShchZR</abbr> -4ä¸ª<abbr title="éš¾å¤„ç†çš„ç”µå­å…ƒä»¶çš„å­˜å‚¨åº“-ç„Šæ¥ï¼Œä½¿ç”¨ï¼Œæ›¾ç»åœ¨Aliexpressä¸Šè´­ä¹°è¿‡çš„ç­‰">æ— å</abbr>å“ç‰Œçš„çº¢è‰²ï¼Œé»„è‰²ï¼Œç»¿è‰²è¾“å‡ºLEDï¼ŒSMDé’½ç”µå®¹å™¨å’Œä¸€å¯¹ç”µé˜»1080ï¼ˆæ¯ä¸ª10kï¼‰ï¼ŒåŠæ‰“è¾“å‡º0.25Wé™æµç”µé˜»MF-25ï¼Œä¸­å›½å‡å‹å‹DC-DC 5Vè½¬æ¢å™¨ï¼Œå–·é›¾ç½ç”¨é“¶è‰²å’Œé»‘è‰²æ²¹æ¼†ï¼ŒA4çº¸ï¼Œèšåˆç‰©ç²˜åœŸå‡ºå”®ã€‚ </p><br><p>  <em>åœ¨MITè®¸å¯è¯ä¸‹ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Github</a>ä¸Šæä¾›äº†æºä»£ç å’Œæ–‡æ¡£ï¼Œæºä»£ç æäº¤ä¸ä¸‹é¢æè¿°çš„å›ºä»¶è¿­ä»£ä¸€è‡´ï¼Œæåˆ°çš„æ‰€æœ‰æ–‡ä»¶è·¯å¾„éƒ½ç›¸å¯¹äºå­˜å‚¨åº“çš„æ ¹ç›®å½•ã€‚</em> </p><br><p>  <em>è¯´æ˜æ–‡ä»¶</em> ï¼š <br>  ./docs/ATtiny13A datasheet.pdf [MK Atmel ATtiny13Aè§„èŒƒ] <br>  ./docs/ATmega328 datasheet.pdf [Atmel ATmega328 MKè§„æ ¼] <br>  ./docs/AVR4027-ä¼˜åŒ–Cä»£ç çš„æŠ€å·§å’Œçªé—¨.pdf [Atmel AVR4027ï¼šä¼˜åŒ–8ä½AVRå¾®æ§åˆ¶å™¨çš„Cä»£ç çš„æŠ€å·§å’Œçªé—¨] <br>  ./docs/AVR4013-PicoPower basics.pdf [å…³äºçœç”µæ¨¡å¼çš„æ³¨æ„äº‹é¡¹] </p><br><p> åœ¨Arduino <abbr title="è‹±æ–‡é›†æˆå¼€å‘ç¯å¢ƒ">IDEä¸­</abbr> ï¼Œå°±åƒä»äº‘ä¸­èµ°è¿‡çš„æ¯¯å­ä¸€æ ·ã€‚ ä»–ä»¬çš„Wizæ˜¯å¯¹è€¶ç¨£ä¼šå£«çš„å¾®å¦™å˜²å¼„ï¼Œæ˜¯åµŒå…¥å¼ç¨‹åºå‘˜ä¸­æ‰€æœ‰ç¥åœ£ä¸å¯ä¾µçŠ¯çš„ä¸œè¥¿ã€‚ ä½†æ˜¯ï¼Œä½œä¸ºç”Ÿæ€ç³»ç»Ÿçš„Arduinoèƒ½å¤Ÿç”Ÿå­˜ä¸‹å»ï¼Œè€Œä¸”ä¼šç”Ÿå­˜ä¸‹å»ï¼Œå¹¶ä¸”ç”±äºåœ¨å„ç§æ“ä½œç³»ç»Ÿä¸‹çš„è®¡ç®—æœºä¸Šå®‰è£…ç¯å¢ƒçš„ç®€ä¾¿æ€§ï¼Œå¹¶ä¸”ç”±äºå®ƒä»¬æ˜¯ç¬¬ä¸€ä¸ªå¯ç”¨è¯¥ç³»ç»Ÿçš„ï¼Œå¹¶ä¸”æ— éœ€ä½¿ç”¨ç¡¬ä»¶è°ƒè¯•å™¨çš„ä»»ä½•ç‰¹æ®Šè´¹ç”¨ï¼Œä¾¿ä½¿ç”¨äº†ä¾¿å£«çš„UARTå’Œä¸“æœ‰çš„å¼•å¯¼åŠ è½½ç¨‹åºï¼Œåœ¨ç›¸å½“ä¸¥é‡çš„å¡«å……MKä¸­è¿›è¡Œå¼€å‘ã€‚ å»–å”å”æ¥äº†ï¼Œå‡†å¤‡ä»¥åŸç‰ˆçš„ä»·æ ¼å‡ºå”®ä¸€äº›å…‹éš†ã€‚ åœ¨é«˜çº§atmegsä¸­ï¼Œæ‚¨å¯ä»¥è°ƒè¯•ç¨‹åºçš„é€»è¾‘å’Œæ“ä½œï¼Œç„¶ååªéœ€è¿›è¡Œæœ€å°çš„æ›´æ”¹å³å¯è½¬ç§»åˆ°åŒä¸€ä¸ªtinkaä¸Šï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªäº‹å®ã€‚ </p><br><p> åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MS VisualStudioä¸­</a>å·¥ä½œå¯¹æˆ‘æ¥è¯´æ˜¯æ­£å¸¸è€Œèˆ’é€‚çš„ï¼Œæˆ‘æ²¡æœ‰å¤ªå¤šç©ºé—´å¯ä»¥å®¹çº³AtmelStudioæˆ–WinAVRï¼Œå¹¶ä¸”æˆ‘ä¹Ÿä¸æƒ³æ‰¾åˆ°å®ƒï¼Œæ²¡æœ‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¡¬ä»¶è°ƒè¯•å™¨ï¼Œ</a>å®ƒä»¬æ²¡æœ‰ç»ˆæä¾¿åˆ©ã€‚ å…³äºVisualMicroæ’ä»¶ï¼Œå®ƒå°†Arduinoæ”¯æŒæ·»åŠ åˆ°MS VisualStudioä¸­<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ï¼Œå®ƒå·²ç»</a>è¶³å¤Ÿè¯¦ç»†åœ°ç¼–å†™äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ï¼Œå¹¶ä¸”å·²</a>åœ¨Haberä¸­æ™ºèƒ½ç¼–å†™äº†ã€‚ <br> å¾ˆä¹…ä»¥å‰ä¹Ÿ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åå¤</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è€ƒè™‘è¿‡</a>å°†â€œ Arduino on ATtiny13â€é›†ä¸­åœ¨é›†çº¿å™¨ä¸Šã€‚ </p><br><p> ç®€è¦åœ°è¯´ï¼Œå°†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MicroCore</a>æ¨¡å—æ·»åŠ åˆ°Arduinoç¯å¢ƒçš„å·²å®‰è£…å®‰è£…ä¸­ï¼Œç„¶åå¯ä»¥åœ¨ç›®æ ‡å¡ä¸­é€‰æ‹©ATtiny13 MKã€‚ </p><br><p><img src="https://habrastorage.org/webt/9f/rm/fe/9frmfek8wvpfsphvtyhedqiiuoy.png"></p><br><p>  Git-åˆ«æ— é€‰æ‹©ï¼Œå³ä½¿æ˜¯å¤§å¤šæ•°å®¶åº­é¡¹ç›®ã€‚ è¿™ä¸ªä¹ æƒ¯å¾ˆç®€å•ï¼Œä½†æ˜¯æ˜¯æ­£ç¡®çš„ï¼šåœ¨ä»»ä½•ç¨‹åºä¸Šå¼€å§‹å·¥ä½œæ—¶ï¼Œåªéœ€åœ¨å‘½ä»¤è¡Œç›®å½•ä¸­é”®å…¥â€œ git initâ€ã€‚  MS Visual Studioå¯¹æœ¬åœ°å­˜å‚¨åº“ä¸­æäº¤çš„å†…ç½®æ”¯æŒå°†èŠ‚çœä¸€æ¬¡åˆä¸€æ¬¡çš„æ—¶é—´ã€‚ </p><br><p>  DipTraceä¸ç”¨äºç”µè·¯å’Œå°åˆ·ç”µè·¯æ¿çš„CADä¸€æ ·æ–¹ä¾¿ï¼Œå®¶ç”¨ï¼Œç”µè·¯å’Œå¸ƒçº¿æ˜“äºä½¿ç”¨ï¼Œæ˜“äºæ·»åŠ è‡ªå®šä¹‰ç»„ä»¶ï¼ˆUGOï¼Œè§¦ç‚¹ï¼‰ï¼Œå¦‚æœéœ€è¦çš„è¯ï¼Œå¸¦æœ‰ç»„ä»¶çš„å°åˆ·ç”µè·¯æ¿å¯ä»¥3Dæ‰­æ›²ï¼ŒåŒ…æ‹¬é«˜è´¨é‡çš„å¸®åŠ©å’ŒåŸ¹è®­è¯¾ç¨‹ã€‚ æ­¤å¤–ï¼Œä»–ä»¬çš„è®¸å¯æ”¿ç­–ç»™æˆ‘ç•™ä¸‹äº†æ·±åˆ»çš„å°è±¡ï¼šéç›ˆåˆ©æ ‡å‡†è®¸å¯ï¼ˆ1000é’ˆï¼Œ4ä¸ªä¿¡å·å±‚ï¼‰çš„é™åˆ¶å¯¹ä¿„ç½—æ–¯ï¼Œä¹Œå…‹å…°å’Œç™½ä¿„ç½—æ–¯å…±å’Œå›½æ˜¯å…è´¹çš„ï¼Œåœ¨99ï¼…çš„æƒ…å†µä¸‹ï¼Œå®¶ç”¨å·¥è‰ºå“å°±è¶³å¤Ÿäº†ã€‚ </p><br><p> ä½œä¸ºç²¾å·§çš„ç¨‹åºå‘˜ï¼Œæˆ‘æ— æ³•ä½¿Arduino Nanoæ­£å¸¸å·¥ä½œï¼Œä½†æ˜¯ä½¿ç”¨USB ISPç¨‹åºå‘˜ï¼Œè¿™ä¸ªé—®é¢˜å¾ˆå®¹æ˜“è§£å†³ã€‚ å¿«é€Ÿè‰ç»˜çš„æ‰¹å¤„ç†æ–‡ä»¶ä»¥è¿›è¡Œç¼–è¯‘/å›ºä»¶-åœ¨é¡¹ç›®çš„./gccç›®å½•ä¸­ã€‚ </p><br><p> å¯ä»¥åœ¨å·¥ä½œå®¤â€œåœ¨ATtiny13ä¸‹çš„arduinoä¸‹â€æ­£ç¡®åœ°ç¼–è¯‘.inoæ–‡ä»¶ï¼ˆä½†å®é™…ä¸Šå®ƒæ˜¯C / C ++ï¼‰ï¼Œåªéœ€åœ¨å‘½ä»¤è¡Œä¸Šé€šè¿‡æ­¤æ‰¹å¤„ç†æ–‡ä»¶çš„å‚æ•°æ¥æä¾›è¯¥æ–‡ä»¶å³å¯ï¼š </p><br><pre><code class="plaintext">&gt;"./gcc/0_MAKE &amp; upload.cmd" MyArduinoFile.ino</code></pre><br>
<p>     ISP ,     ,      .</p><br>
<pre><code class="plaintext">&gt;"./gcc/0_MAKE &amp; asm.cmd" MyArduinoFile.ino</code></pre><br>
<p>   , ,     â€”   ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  AVR</a>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> . <strong></strong>: <em>         ,  </em>.</p><br>
<h3 id="dusha-svetofora"> </h3><br>
<h4 id="upgrade-romram-pod-arduino-dlya-attiny13">Upgrade ROM&amp;RAM  Arduino  ATtiny13</h4><br>
<p> Arduino  ( setup(){...}; loop(){...};)       ""   - int main(){setup(); loop();}, <em></em>        by Arduino. </p><br>
<pre><code class="cpp">uint8_t cnt;
void setup() {
    cnt=0;
}
void loop() {
  cnt++;
}
//Program size: 164 bytes (used 16% of a 1 024 byte maximum) (0,57 secs)
//Minimum Memory Usage: 5 bytes (8% of a 64 byte maximum)</code></pre><br>
<p>    ,       :</p><br>
<pre><code class="cpp">uint8_t cnt;
int main(){
    cnt=0;      // &lt; setup()
    while(1){
        cnt++;  // &lt; loop()
    }
}
//Program size: 60 bytes (used 6% of a 1 024 byte maximum) (1,23 secs)
//Minimum Memory Usage: 1 bytes (2% of a 64 byte maximum)</code></pre><br>
<p>   16%  6%   ,  ,  6%     .                   ,   â€”      64  . </p><br>
<h4 id="intellekt-spyaschey-krasavicy">  </h4><br>
<p>  , ,  :       .         ,     ,   ,    ,     .   , ,   ,     .         ,       :  <abbr title="   = -  +      +   + ">CPU</abbr>     ,       .    â€”   ,     N  .      ""-CPU     ,       (9.6     /    1024 = 9370 ,      ) 1/9370 = 0.0001067 .      8-   .  ,   ,    ,     " ".      ,   ,  ,           "".      37    (256  0.0001067 = 0.027315; 0.027315  37 = 1.01065 ~= 1s). </p><br>
<p>  :     - (HW ,     1024 ),   8   â€”    ,         ,    .</p><br>
<p><strong></strong>: <em> globalTimer   volatile,  ,         ,  ,     CPU        ,           </em>.</p><br>
<pre><code class="cpp">#include &lt;avr/io.h&gt;         //     IDE -  
#include &lt;avr/sleep.h&gt;      // ,  
#include &lt;avr/interrupt.h&gt;          //   
volatile uint16_t  globalTimer;     //     64   
//  -    globalTimer  1/37 
ISR(TIM0_OVF_vect){
    globalTimer++;  //       . , ,  while(1)   .
}
int main() {
    //     "  -". 
    set_sleep_mode(SLEEP_MODE_IDLE);    //   - .
    sleep_enable();                 //    
    TCCR0B = _BV(CS02) | _BV(CS00); //  0 - clock frequency / 1024
    TIMSK0 |= _BV(TOIE0);           //      overflow interrupt
    sei();                          //    
    while(1){
        //.........   
        sleep_cpu();    //     -   .
    }
}
//Program size: 128 bytes (used 13% of a 1 024 byte maximum) (0,86 secs)
//Minimum Memory Usage: 2 bytes (3% of a 64 byte maximum)</code></pre><br>
<h4 id="u-koshki-4-nogi-vhod-vyhod-zemlya-i-pitanies-zhalostlivaya-studencheskaya-pesnya">"  4 : , ,   "()   </h4><br>
<p> , ,       .<br>
   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a>,   ,    CPU,   /  /    .     <abbr title="General-Purpose Input/Output,  / (I/O)  ">GPIO</abbr>.</p><br>
<p>      Arduino   :     Arduino  pin_number      ( ):</p><br>
<pre><code class="cpp">pinMode(pin_number, OUTPUT); //   INPUT -   </code></pre><br>
<p>    /     ,   â€”       .</p><br>
<pre><code class="cpp">Value = digitalRead(pin_input_number);  //Value -  HIGH  LOW (1  0)
digitalWrite(pin_outpit_number, Value);       //   pin_outpit_number - HIGH  LOW</code></pre><br>
<p> ""  ,   Wiring    ,  ,    Arduino (        )     (  )     (  ) (    ).</p><br>
<p><img src="https://habrastorage.org/webt/fp/di/ni/fpdiniruiiujuodrtyzrcfyljr8.png"></p><br>
<p>..   Arduino 7    11  PD7 â€”    D.<br>
  digitalRead, digitalWrite, pinMode  ..,             ,   , ,      Wiring-      ,       .</p><br>
<p>   â€”   ,    . ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">DIHALT</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a>          .</p><br>
<p><img src="https://habrastorage.org/webt/rk/y8/sj/rky8sjzln3u1k3lndv0inksdxjm.jpeg"></p><br>
<p>   -    (<abbr title=" -  ">GPIO</abbr>)     ,  8-   â€”  8    .     ,   6     (. ATtiny13 pinout,   ),  PB0  PB5,      PB5 â€”     MK    .    -    : (     "B") <abbr title="Data Direction Register B,   -   ">DDRB</abbr>, <abbr title="Port B Input Pins Register,    0  1  ,  ">PINB</abbr>  <abbr title="Port B Data Register,      ">PORTB</abbr>.    â€”  ,    ,   .  PB0, PB1, PB2, PB3, PB4, PB5 â€”       B.      #include &lt;avr/io.h&gt; (   iotn13.h  ),      (PB0  0,..., PB5 â€” 5)      IDE,        Arduino. </p><br>
<p><strong></strong>: <em>      ,    ,       .  ,  -      , , ,   DDRx GPIO ,   â€” .       PORTx â€”    ,  "-    ",   ,      â€”   ,    PINx.       ,  50       0  1.        ,      </em>.</p><br>
<div class="spoiler"><b class="spoiler_title">, </b><div class="spoiler_text"><p>  PB2   HIGH, +5,   PB3  LOW, 0,    PB0 ,  â€”      .<br>
DDRB   ,    PB0,   ( ) = 0 (PB0   ),     = 1 (PB2, PB3 â€” ), ..     110,   â€”  ,  1  0 â€”    . </p><br>
<pre><code class="cpp">DDRB = 12;  //  000001100    - 12
//        (!)
//        pinMode().</code></pre><br>
<p>      â€”  PORTB ,    =1 (PB2  HIGH),   â€”  (PB3  LOW),  â€”  , 01</p><br>
<pre><code class="cpp">PORTB = 8;  //(dec)8 === (bin)000001000
//  -        .</code></pre><br>
<p>             PINB,   ,    â€”      .<br>
  ,          â€”  .<br>
    3 (PB3)  :   1   ,    3  .<br>
3&lt;&lt;00000001 === PB3&lt;&lt;1 //  â€” 00001000<br>
     , _BV(x),      (x&lt;&lt;1), .. _BV(PB3) â€”     1.<br>
 _BV(PB3) | _BV(PB2)      00001100 (| â€”   ).<br>
<strong></strong>: <em>      ,       ,     </em>.</p><br>
<pre><code class="cpp">PORTB |= _BV(PB3) | _BV(PB2); // 2  3   == 1,     PB2  PB3  HIGH,   PORTB  </code></pre><br>
<p>  0    ,          ,    .     0     1  .       ,  ,  1     ,   0 â€”   0 .</p><br>
<pre><code class="cpp">PORTB &amp;= ~(_BV(PB3) | _BV(PB2)); //   PORTB 2  3  -  , LOW,   .</code></pre></div></div><br>
<p>     HW , - 0, Timer0.   GPIO,    ,   ,      datasheet ATtiny13,  -     -,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> <abbr title="     328,     .">Ilya Ananev</abbr>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">- 0</a>   ATmega328. </p><br>
<p>   ,    ,   .</p><br>
<pre><code class="cpp">TCCR0B = _BV(CS02) | _BV(CS00);    //    CS02  CS00  1 -   0 = clock frequency / 1024
TIMSK0 |= _BV(TOIE0);           //   TOIE0  1 -     TIM0_OVF
//      TIMSK0 = _BV(TOIE0);</code></pre><br>
<h4 id="gost-ili-zakon-est-zakon">    .</h4><br>
<p>      ,       .    ,    ,          .    -  ,        ,      ,    (!)   . </p><br>
<p>    ,       .           "<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   27.02.13</a>"  7    52289-2004     ,          .<br>
     (  ): ,   , ,  , , .</p><br>
<p>"*    "  "     2 ,    â€” 3 . </p><br>
<p>               3        1 /.*"</p><br>
<p>   ,      (    ,      /  â€” PERIOD_0  PERIOD_4,    â€”  ).</p><br>
<pre><code class="cpp">#define ONE_SECOND  37      //     1 
#define QT_SECOND   9       //  

#define PERIOD_FLASH_GREEN  QT_SECOND           //    ( ) -    
#define PERIOD_FLASH_YELLOW ONE_SECOND * 1      //    -    - 
                                                        //  --- 
#define PERIOD_0    ONE_SECOND * 10 //R G R G   0.  ---   (10 )
#define PERIOD_1    ONE_SECOND * 3  //R g R g   1.  ---   (3 )     
#define PERIOD_2    ONE_SECOND * 1  //R Y R Y   2.  ---  (1 )
#define PERIOD_3    ONE_SECOND * 2  //RY Y RY Y 3. + ---  (2 ) 
#define PERIOD_4    ONE_SECOND * 7  //G R G R   4.  ---   (7 )
#define PERIOD_5    ONE_SECOND * 3  //g R g R   5.   --- (3 )
#define PERIOD_6    ONE_SECOND * 1  //Y R Y R   6.  ---  (1 )
#define PERIOD_7    ONE_SECOND * 2  //Y RY Y RY 7.  --- + (2 )</code></pre><br>
<p>  ,      ,    .</p><br>
<pre><code class="cpp">typedef struct{
    const uint8_t ddr_val_0;    // DDRB value -   
    const uint8_t port_val_0;   // PORTB value   -   
    const uint8_t ddr_val_1;    // DDRB value  -   "",   
    const uint8_t port_val_1;   // PORTB value - 
    const uint16_t flash_period;    // period of flashing -   _val_1  _val_0
    const uint16_t signal_period;   // period of this lighting state
}lightSignalization;            //   , _0  _1 -   , flash_long -   
// flash_period == 0,   ,   _val_0.
// signal_period == 0,         .</code></pre><br>
<p>  ,        128  â€”     ,      .</p><br>
<h4 id="kak-nayti-v-attiny13-vosem-ili-devyat-pinov-vvoda-vyvoda">   ATtiny13  ( ?)  -</h4><br>
<p>   ,  ,   -  -     ,  :       6  . -  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">denvo</a>   "<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> ?  RESET</a>"       5-     ,     ,      ,      ,   -   .</p><br>
<p>   -     :    --, ..      ,  7  .</p><br>
<p>     â€”   , ,  ,   8,  ? </p><br>
<p> ,  -,      "reset", PB5,      . </p><br>
<p>   ,  ? , ,   ,    . , , ,  ,   ,  .</p><br>
<p> ,  , 8  9  -  ,    8  â€”       .    ,    -,   , , ,   . </p><br>
<p>   â€”    .</p><br>
<p>   :           â€”         .           .</p><br>
<p>        :</p><br>
<p><img src="https://habrastorage.org/webt/hw/6_/6a/hw6_6aeekqqdlt7a0cqnk9kf2pa.png"></p><br>
<p> 1    PORTB |= _BV(GREEN_PIN) â€”    (  ) ,   0 .. PORTB &amp;= ~(_BV(GREEN_PIN)) â€”  (  ).<br>
  ,     ,      ?<br>
     (DDRB |= _BV(GREEN_PIN))   , DDRB &amp;= ~(_BV(GREEN_PIN)), GREEN_PIN   Hi-Z      .      (2.2 * 4)    5,   <abbr title=".  ,       ,        .">   </abbr>.</p><br>
<p>          .<br>
            â€” ..    ,     ,    .</p><br>
<div class="spoiler"><b class="spoiler_title">, ,      </b><div class="spoiler_text"><p>,               .   ,    â€”     ,   37/2=18      ,          ,    . :<br>
)   ,     ,  ,  ,     ;<br>
)   â€”        ,      " "       4  ;<br>
)  ,       4 ( PERIOD_2-&gt;PERIOD_3  PERIOD_6-&gt;PERIOD_7);<br>
)  4                 .</p></div></div><br>
<p>  .</p><br>
<p><img src="https://habrastorage.org/webt/35/in/ym/35inymyguij4kl6qnsuckgz_ukq.png"></p><br>
<pre><code class="cpp">// PINB === 0 0 0 g r y0 btt y1
#define RED_PIN     PB3     // OUT: 1 - "-" , 0 - "-" , IN -  , ,  (!) 
#define YELLOW0_PIN PB2     // OUT: 1 -  "-" 
#define YELLOW1_PIN PB0     // OUT: 1 -  "-" 
#define GREEN_PIN   PB4     // OUT: 1 - "-" , 0 - "-" , IN -  , ,  (!) 

#define RED     _BV(RED_PIN)        // _BV -     (), 1&lt;&lt;VALUE
#define YELL0   _BV(YELLOW0_PIN)        //    -
#define YELL1   _BV(YELLOW1_PIN)
#define GREEN   _BV(GREEN_PIN)      //    - (  0 -   -)  DDRB.GreenPin=1</code></pre><br>
<p> â€”  <abbr title=" ,      reset,     ISP "> </abbr> .    ,            ,   â€”      ,    .</p><br>
<pre><code class="cpp">#define BUTTON_PIN      PB1
#define BUTTON_ON  !(PINB &amp; _BV(BUTTON_PIN))    //( (PINB &amp; _BV(BUTTON_PIN)) == 0)  //  " " -   LOW
#define BUTTON_OFF (PINB &amp; _BV(BUTTON_PIN))     //  " " -    HIGH, (     )</code></pre><br>
<p><strong><em>       ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a>,   n   ( ) n(nâˆ’1) = nÂ²âˆ’n .  4   12  ,         .   <abbr title=" +  + ">Â« , Â»</abbr>  <abbr title=" + ">Â« ,   Â»</abbr>        .</em></strong></p><br>
<div class="spoiler"><b class="spoiler_title">    12 LED</b><div class="spoiler_text"><p><img src="https://habrastorage.org/webt/oq/sn/le/oqsnlertvho7jlbhqt5ehp_fcks.png"></p></div></div><br>
<p>*** â€”   ,         DDRx|PORTx,       , ..       .          â€”   ,        ,         . </p><br>
<p>                     .***</p><br>
<h4 id="paru-slov-o-pyatom-izmerenii-kak-vpihnut-nevpihuemoe">    :   ?</h4><br>
<p>         lightSignalization.    lightSignalization        .    0  7  , 8 â€”  ,  9 â€” ,   ""   .     ,         0  7,      . ,  ,      .     3    ( 0  7)  8   --             .   if-   ,    .     ,   .</p><br>
<pre><code class="cpp">lightSignalization traffic_signals[] = {//   
 // {DDRB0, PORTB0,   DDRB_when_flashingif, PORTB_when_flasingif (if flashing),   continous of half-period flashing,   continous curr mode runing}
    {RED|GREEN, RED,   0, 0,   0, PERIOD_0},                    // R G R G
    {RED, RED,  RED|GREEN, RED,   QT_SECOND, PERIOD_1},     // R g R g - flash east green
    {RED|YELL1, RED|YELL1,   0, 0,   0, PERIOD_2 },         // R Y1 R Y1
    {RED|YELL0|YELL1, RED|YELL0|YELL1,  0, 0,   0, PERIOD_3 },  // RY0 Y1 RY0 Y1
    {RED|GREEN, GREEN,   0, 0,   0, PERIOD_4},              // G R G R
    {RED|GREEN, GREEN,   RED, 0,    QT_SECOND, PERIOD_5 },  // g R g R - flash nord green
    {RED|YELL0, YELL0,   0, 0,   0, PERIOD_6},                  // Y0 R Y0 R
    {RED|YELL0|YELL1,  YELL0|YELL1,   0, 0,   0, PERIOD_7  },       // Y0 RY1 Y0 RY1

    {YELL0|YELL1, YELL0|YELL1,   YELL0|YELL1, 0,  ONE_SECOND, 0},   // y0 y1 y0 y1 - flash yellows lights 
    {0, 0,   0, 0,   0, 0}          // traffic lights off, DDR in, Hi-Z
};

//       lightSignalization traffic_signals[]
#define LIGHT_NUM_YELLOW_FLASH  8       //       -  - flash yellows lights
#define LIGHT_NUM_STD_START     0       //       
#define LIGHT_NUM_LIGHTS_OFF    9       //      -   - traffic lights off</code></pre><br>
<p>  lightSignalization  8   . ..     traffic_signals[]  10     80  (,  64  ,  2     ).  ,        .</p><br>
<p> ,  , ,          â€”    ROM,  ,    RAM   ,     .</p><br>
<p>-     </p><br>
<pre><code class="plaintext">const lightSignalization traffic_signals[] PROGMEM= {...</code></pre><br>
<p> ,           </p><br>
<pre><code class="plaintext">&lt;avr/pgmspace.h&gt; pgm_read_byte_near()  pgm_read_word_near()</code></pre><br>
<p> char  shortint .</p><br>
<p>     3   . </p><br>
<ol>
<li><p> ,   .<br>
   traffic_signals[] â€” <strong>LIGHT_NUM_LIGHTS_OFF</strong><br>
{0, 0, 0, 0, 0, 0} // traffic lights off<br>
   â€”  lightSignalization  ,     â€” ,   lightSignalization.signal_period==0 (.. ),   lightSignalization.flash_period==0, ..   . </p><br>
</li>
<li><p> ,  .<br>
   traffic_signals[] â€” <strong>LIGHT_NUM_YELLOW_FLASH</strong><br>
{YELL0|YELL1, YELL0|YELL1, YELL0|YELL1, 0, ONE_SECOND, 0}, // y0 y1 y0 y1 â€” flash yellows lights<br>
   : lightSignalization.signal_period==0.      lightSignalization.flash_period=ONE_SECOND,    :</p><br>
<pre><code class="cpp">DDRB = YELL0|YELL1;     // YELL0, YELL1 - 
PORTB = YELL0|YELL1;    // YELL0, YELL1 = HIGH -  </code></pre><br>
<p></p><br>
<pre><code class="cpp">DDRB = YELL0|YELL1;     // // YELL0, YELL1 -   
PORTB = 0;              // YELL0, YELL1 = LOW -  </code></pre><br>
</li>
<li><p> , --.</p><br>
</li>
</ol><br>
<p> ,   . </p><br>
<p>  traffic_signals[]     â€” <strong>LIGHT_NUM_STD_START</strong><br>
{RED|GREEN, RED, 0, 0, 0, PERIOD_0}, // R G R G<br>
   : lightSignalization.flash_period==0.<br>
DDRB = RED|GREEN; //RED  GREEN â€”  ,  .<br>
PORTB = RED; //  RED â€” HIGH (-      )<br>
//   GREEN â€” LOW (  ,  - â€”  )<br>
      lightSignalization.signal_period==PERIOD_0,       . </p><br>
<p>        current_signal.   2   â€”        ,     lightSignalization.</p><br>
<pre><code class="cpp">uint8_t current_signal;     // 1    ,   traffic_signals
uint16_t tl_flash_end;      // 2       ( !0), 
uint16_t tl_signal_end;     // 2            ( !0)</code></pre><br>
<p> tl_signal_end != 0,   globalTimer&gt;tl_signal_end  current_signal.     0   current_signal,  3, .<br>
current_signal = current_signal &amp; B00000111;<br>
  </p><br>
<pre><code class="plaintext">current_signal &amp;= LIGHT_NUM_STD_MASK ;   //current_signal &amp; B00000111;</code></pre><br>
<p>  current_signal  ,       0  7.<br>
   globalTimer â€”       . </p><br>
<div class="spoiler"><b class="spoiler_title">   </b><div class="spoiler_text"><pre><code class="cpp">#include &lt;limits.h&gt;         // USHRT_MAX
#include &lt;avr/sleep.h&gt;      // ,  
#include &lt;avr/interrupt.h&gt;  //   
#include &lt;avr/pgmspace.h&gt;   //    

#define ONE_SECOND  37      //     1 
#define QT_SECOND   9       //  
#define MAX_GLOBAL_TIMER_VALUE  (USHRT_MAX / 2)     // uint16_t globalTimer -   . 65535 /2 
//     ,  MAX_GLOBAL_TIMER_VALUE - 1
#define PERIOD_FLASH_GREEN  QT_SECOND           //    ( ) -    
#define PERIOD_FLASH_YELLOW ONE_SECOND * 1      //    -    - 
                                                        //  --- 
#define PERIOD_0        ONE_SECOND * 10     //R G R G   0.  ---   (15 )
#define PERIOD_1        ONE_SECOND * 3      //R g R g   1.  ---   (3 )     
#define PERIOD_2        ONE_SECOND * 1      //R Y R Y   2.  ---  (1 )
#define PERIOD_3        ONE_SECOND * 2      //RY Y RY Y 3. + ---  (2 ) 
#define PERIOD_4        ONE_SECOND * 7      //G R G R   4.  ---   (10 )
#define PERIOD_5        ONE_SECOND * 3      //g R g R   5.   --- (3 )
#define PERIOD_6        ONE_SECOND * 1      //Y R Y R   6.  ---  (1 )
#define PERIOD_7        ONE_SECOND * 2      //Y RY Y RY 7.  --- + (2 )

typedef struct{
    const uint8_t ddr_val_0;    // DDRB value    
    const uint8_t port_val_0;   // PORTB value  
    const uint8_t ddr_val_1;    // DDRB value    
    const uint8_t port_val_1;   // PORTB value
    const uint16_t flash_period;    // period of flashing -   _val_1  _val_0
    const uint16_t signal_period;   // period of this lighting state
}lightSignalization;            //   , _0  _1 -   , flash_long -   

//    (PINS === 0 0 0 g r y0 btt y1):
 //     ""     
#define BUTTON      PB1
#define RED_PIN     PB3     // OUT: 1 - "-" , 0 - "-" , IN -  , ,  (!) 
#define YELLOW0_PIN PB2     // OUT: 1 -  "-" 
#define YELLOW1_PIN PB0     // OUT: 1 -  "-" 
#define GREEN_PIN   PB4     // OUT: 1 - "-" , 0 - "-" , IN -  , ,  (!) 

#define BUTTON_ON  !(PINB &amp; _BV(BUTTON))    //( (PINB &amp; _BV(BUTTON)) == 0)  //  " "
#define BUTTON_OFF  (PINB &amp; _BV(BUTTON))    // ~(PINB &amp; _BV(BUTTON)) -\\- " "

#define RED     _BV(RED_PIN)            // _BV -     (), 1&lt;&lt;VALUE
#define YELL0   _BV(YELLOW0_PIN)        //
#define YELL1   _BV(YELLOW1_PIN)
#define GREEN   _BV(GREEN_PIN)

//       lightSignalization traffic_signals[]
#define LIGHT_NUM_YELLOW_FLASH  8       //       -  - flash yellows lights
#define LIGHT_NUM_STD_START     0       //       
#define LIGHT_NUM_LIGHTS_OFF    9       //      -   - traffic lights off
#define LIGHT_NUM_STD_MASK      7       // ___++ &amp;LIGHT_NUM_STD_MASK -    0  7   

//....................................  
// 
const lightSignalization traffic_signals[] PROGMEM= {   //   ,  ,   -, PINS === 0 0 0 g r y0 btt y1
 // {DDRB0, PORTB0,   DDRB_flashing, PORTB_flasinf (if flashing),   continuous of half-period flashing,   continuous id mode running}
    {RED|GREEN, RED,   0, 0,   0, PERIOD_0},                    // R G R G
    {RED, RED,  RED|GREEN, RED,   QT_SECOND, PERIOD_1},     // R g R g - flash east green
    {RED|YELL1, RED|YELL1,   0, 0,   0, PERIOD_2 },             // R Y1 R Y1
    {RED|YELL0|YELL1, RED|YELL0|YELL1,  0, 0,   0, PERIOD_3 },  // RY0 Y1 RY0 Y1
    {RED|GREEN, GREEN,   0, 0,   0, PERIOD_4},                  // G R G R
    {RED|GREEN, GREEN,   RED, 0,    QT_SECOND, PERIOD_5 },      // g R g R - flash nord green
    {RED|YELL0, YELL0,   0, 0,   0, PERIOD_6},                  // Y0 R Y0 R
    {RED|YELL0|YELL1,  YELL0|YELL1,   0, 0,   0, PERIOD_7  },   // Y0 RY1 Y0 RY1

    {YELL0|YELL1, YELL0|YELL1,   YELL0|YELL1, 0,  ONE_SECOND, 0},   // y0 y1 y0 y1 - flash yellows lights 
    {0, 0,   0, 0,   0, 0}              //  traffic lights off, 
};

volatile uint16_t  globalTimer;     //     64   
uint8_t current_signal;     // 1    ,   traffic_signals
uint16_t tl_flash_end;      // 2       ( !0), 
uint16_t tl_signal_end;     // 2            ( !0)

//....................................  
void setPeriods(uint8_t num, bool set_both_flash_and_signal);   //  tl_flash_end, tl_signal_end
void setPorts(uint8_t num, bool use_main_values);               //    

//....................................  
//
//  -    globalTimer  1/37 
ISR(TIM0_OVF_vect){
    globalTimer++;  //       . ,   while(1)   .
}

int main() {
//
bool use_main_values = true;            // lightSignalization._val_0 (1)  lightSignalization._val_1 (0)? -  
current_signal = LIGHT_NUM_STD_START;   //   .     .

    //     "  -". 
    set_sleep_mode(SLEEP_MODE_IDLE);    //   - .
    sleep_enable();                 //    

    TCCR0B = _BV(CS02) | _BV(CS00); //  0 - clock frequency / 1024
    TIMSK0 |= _BV(TOIE0);           //      overflow interrupt

    sei();      //    
    while(1){
        //   ? 
        if(globalTimer &gt; MAX_GLOBAL_TIMER_VALUE){
            globalTimer -= MAX_GLOBAL_TIMER_VALUE;          //   
            // 
            if(tl_flash_end){
                tl_flash_end -= MAX_GLOBAL_TIMER_VALUE;     //   ,  
            }
            if(tl_signal_end){
                tl_signal_end -= MAX_GLOBAL_TIMER_VALUE;    // //   ,  
            }
            // setPeriods(currentMode, false); //   12  ,  tl_.._end   ,     
        }

                //      (tl_flash_end !=0 )
        if(tl_flash_end){
            //     
            if(globalTimer &gt; tl_flash_end){
                use_main_values = !use_main_values;             // !use_main_values -      ))
                setPorts(current_signal, use_main_values);      //      
                setPeriods(current_signal, false);              //     ,   
            }
        }

        //         -    operating_std     - --
        if(tl_signal_end){
            //       (use_main_values -       -  )
            if((globalTimer &gt; tl_signal_end)  &amp;&amp; use_main_values){
                current_signal ++;                          //   
                current_signal &amp;= LIGHT_NUM_STD_MASK;       //    3-,        0  7
                use_main_values = true;                     //  -    
                setPorts(current_signal, use_main_values);  //        
                setPeriods(current_signal, true);           //       
            }
        }

        sleep_cpu();    //      -   .
    }
}

    //   
 void setPorts(uint8_t num, bool use_main_values){
    uint8_t val;
    DDRB = 0; PORTB = 0;
    //    () - ddr_val_0, else = ddr_val_1
//  val = (use_main_values) ? pgm_read_byte_near(&amp;(traffic_signals[num].ddr_val_0))
//                          : pgm_read_byte_near(&amp;(traffic_signals[num].ddr_val_1));

    //   ,  , ,  ,   ,   14 (!!!)   .
    val = pgm_read_byte_near(&amp;(traffic_signals[num].ddr_val_0)+( (use_main_values) ? 0 : 2) ); 
    val &amp;= ~_BV(BUTTON);    //     - 
    DDRB = val;             //    

    val = (use_main_values) ? pgm_read_byte_near(&amp;(traffic_signals[num].port_val_0)) 
                            : pgm_read_byte_near(&amp;(traffic_signals[num].port_val_1));
    val|= _BV(BUTTON);  //     -  -    
    PORTB = val;        //      
}

 //     ( 
void setPeriods(uint8_t num, bool set_both_flash_and_signal){
//  
    tl_flash_end = pgm_read_word_near (&amp;(traffic_signals[num].flash_period));   //  
    tl_flash_end = (tl_flash_end)? tl_flash_end + globalTimer : 0;  //    -      
    //if(tl_flash_end){         tl_flash_end += globalTimer;    } &lt;-     8  

    //     -    
    if(set_both_flash_and_signal){
        tl_signal_end = pgm_read_word_near(&amp;(traffic_signals[num].signal_period));  
        tl_signal_end = (tl_signal_end)? tl_signal_end + globalTimer : 0;           //     ,    
    }
}

//Program size: 610 bytes (used 60% of a 1 024 byte maximum) (0,58 secs)
//Minimum Memory Usage: 7 bytes (11% of a 64 byte maximum)</code></pre></div></div><br>
<h4 id="slozhnaya-logika-prostoy-knopki">   </h4><br>
<p>     ,          .         â€”   btn_cnt (     ),    (        )               .</p><br>
<pre><code class="cpp">#define PERIOD_PRESS_BUTTON_SHORT   QT_SECOND           //      -  
#define PERIOD_PRESS_BUTTON_LONG    QT_SECOND*6         //      - /
uint8_t scan_button_cnt;    //    
        //  
        if(BUTTON_ON){
            if(scan_button_cnt&lt;USHRT_MAX){
                scan_button_cnt++;      //   1/37     
            }
            if(scan_button_cnt &gt; PERIOD_PRESS_BUTTON_SHORT){
                    // ,     
            }
            if(scan_button_cnt &gt; PERIOD_PRESS_BUTTON_LONG){
                    //     
            }
        }
</code></pre><br>
<p>    â€”      .</p><br>
<p><img src="https://habrastorage.org/webt/fe/k6/6_/fek66_j4lcziqglnpmyudph1ujc.jpeg"></p><br>
<p>     SLEEP_MODE_IDLE (     CPU),   PwrDown    SLEEP_MODE_PWR_DOWN â€”         <del>  </del>   watchdog     INT0,   ,     â€”      INT0.</p><br>
<p><img src="https://habrastorage.org/webt/0w/82/0k/0w820klrlwg0enib-pznejydfp0.png"></p><br>
<p> <abbr title=""></abbr>      .   7.Power management and sleep modes   ATtiny13  ,      5-10 ,          . </p><br>
<p>             8- ,    â€” 2        . </p><br>
<pre><code class="cpp">//  uint8_t f_button_state_flags;       //        

//      MODES:  wakeup 11 -&gt; work 00 -&gt; tosleep 01 -&gt; pwrdown 11 -&gt; wakeup 11
#define MODE_LBIT 0
#define MODE_HBIT 1
#define FORCE_SET_NEW_SIGNAL_BIT        2   //             current_signal
//    3
#define LIGHT_SIGNAL_ALT_MODE_BIT       4   // =0 (--)  =1 ( )   
#define USE_FIRST_VALUES_LIGHT_BIT      5   //     -  lightSignalization  
#define SHORT_PRESS_FLAG_BIT    6   // , 1       
#define LONG_PRESS_FLAG_BIT     7 // , 1       </code></pre><br>
<p> ,       â€”    ,    â€”   CPU     .          ,         if-.</p><br>
<div class="spoiler"><b class="spoiler_title">   </b><div class="spoiler_text"><pre><code class="cpp">#include &lt;limits.h&gt;         // USHRT_MAX
#include &lt;avr/io.h&gt;         //     IDE
#include &lt;avr/sleep.h&gt;      // ,     
#include &lt;avr/interrupt.h&gt;  //   
#include &lt;avr/pgmspace.h&gt;   //    

#ifdef GIMSK    //  ATtiny13 -       
#define F_CPU 9600000UL     //      ,   
#define ONE_SECOND  37      //     1 
#define QT_SECOND   9       //  
// GIMSK &amp;= ~_BV(INT0); -   INT0  
#define DISABLE_EXTERNAL_INT0   GIMSK &amp;= ~(_BV(INT0)); GIFR  &amp;= ~(_BV(INTF0))   //EIMSK/EIFR  
//GIMSK |= _BV(INT0) -   INT0
#define ENABLE_EXTERNAL_INT0    GIMSK |= _BV(INT0)  ; GIFR  &amp;= ~(_BV(INTF0))
#else           // 328 -   
#define F_CPU 16000000UL
#define ONE_SECOND  64      //     1  - .   
#define QT_SECOND   16      //  
// 328 INT0 -  PD2...     ,       (,  ),            
#define DISABLE_EXTERNAL_INT0   EIMSK &amp;= ~(_BV(INT0)); EIFR  &amp;= ~(_BV(INTF0)) 
// ,   -  EICRA - ISC00-ISC01 == 00, lo level, EIMSK - INT0, EIFR-INTF0  
#define ENABLE_EXTERNAL_INT0    EIMSK |= _BV(INT0)  ; EIFR  &amp;= ~(_BV(INTF0))
#endif

#define MAX_GLOBAL_TIMER_VALUE  (USHRT_MAX / 2)     // uint16_t globalTimer -   . 65535 /2 
//     ,  MAX_GLOBAL_TIMER_VALUE - 1
#define PERIOD_PRESS_BUTTON_SHORT   QT_SECOND/2         //      ( - ) -  
#define PERIOD_PRESS_BUTTON_LONG    QT_SECOND*4         //      - /
#define PERIOD_FLASH_GREEN          QT_SECOND           //     ( ) -    
#define PERIOD_FLASH_YELLOW         ONE_SECOND * 1      //     -    - 

                                            //  --- 
#define PERIOD_0        ONE_SECOND * 5      // R G R G  0.  ---   (5 )
#define PERIOD_1        ONE_SECOND * 3      //R g R g   1.  ---   (3 )     
#define PERIOD_2        ONE_SECOND * 1      //R Y R Y   2.  ---  (1 )
#define PERIOD_3        ONE_SECOND * 2      //RY Y RY Y 3. + ---  (2 ) 
#define PERIOD_4        ONE_SECOND * 7      // G R G R  4.  ---   (7 )
#define PERIOD_5        ONE_SECOND * 3      //g R g R   5.   --- (3 )
#define PERIOD_6        ONE_SECOND * 1      //Y R Y R   6.  ---  (1 )
#define PERIOD_7        ONE_SECOND * 2      //Y RY Y RY 7.  --- + (2 )

//  /  .     -     
typedef struct{
    const uint8_t ddr_val_0;    // DDRB value    
    const uint8_t port_val_0;   // PORTB value  
    const uint8_t ddr_val_1;    // DDRB value    
    const uint8_t port_val_1;   // PORTB value
    const uint16_t flash_period;    // period of flashing -   _val_1  _val_0 ( =0,  )
    const uint16_t signal_period;   // period of this lighting state ( =0,       )
}lightSignalization;            //   , _0  _1 -   , flash_long -   

//    (PINS === 0 0 0 g r y0 btt y1):
 //     ""     
#define BUTTON_PIN  PB1     // ,   INT0. ,   ,  = LOW
#define RED_PIN     PB3     // OUT: 1 - "-" , 0 - "-" , IN -  , ,  (!) 
#define YELLOW0_PIN PB2     // OUT: 1 -  "-" 
#define YELLOW1_PIN PB0     // OUT: 1 -  "-" 
#define GREEN_PIN   PB4     // OUT: 1 - "-" , 0 - "-" , IN -  , ,  (!) 

#define BUTTON_ON  !(PINB &amp; _BV(BUTTON_PIN))    //( (PINB &amp; _BV(BUTTON)) == 0)  //  " "
#define BUTTON_OFF  (PINB &amp; _BV(BUTTON_PIN))    // ~(PINB &amp; _BV(BUTTON)) -\\- " "

#define RED     _BV(RED_PIN)            // _BV -     (), 1&lt;&lt;VALUE
#define YELL0   _BV(YELLOW0_PIN)        //    -
#define YELL1   _BV(YELLOW1_PIN)
#define GREEN   _BV(GREEN_PIN)          //    - (  0 -   -)  DDR=1

//      lightSignalization traffic_signals[]
#define LIGHT_NUM_YELLOW_FLASH  8       //       ( ) -  - flash yellows lights
#define LIGHT_NUM_STD_START     0       //        (--)
#define LIGHT_NUM_LIGHTS_OFF    9       //      -   - traffic lights off
#define LIGHT_NUM_START_SHOW    10      //         
#define LIGHT_NUM_ERR           11      //   -     

#define MASK_LIGHT_NUM_STD      7       // ___++ &amp;= LIGHT_NUM_STD_MASK -    0  7   

//....................................  
// 
const lightSignalization traffic_signals[] PROGMEM= {   //   ,  ,   -, PINS === 0 0 0 g r y0 btt y1
 // {DDRB0, PORTB0,   DDRB_flashing, PORTB_flasinf (if flashing),   continuous of half-period flashing,   continuous id mode running}
    {RED|GREEN, RED,   0, 0,   0, PERIOD_0},                    // R G R G
    {RED, RED,  RED|GREEN, RED,   QT_SECOND, PERIOD_1},         // R g R g - flash east green
    {RED|YELL1, RED|YELL1,   0, 0,   0, PERIOD_2 },             // R Y1 R Y1
    {RED|YELL0|YELL1, RED|YELL0|YELL1,  0, 0,   0, PERIOD_3 },  // RY0 Y1 RY0 Y1
    {RED|GREEN, GREEN,   0, 0,   0, PERIOD_4},                  // G R G R
    {RED|GREEN, GREEN,   RED, 0,    QT_SECOND, PERIOD_5 },      // g R g R - flash nord green
    {RED|YELL0, YELL0,   0, 0,   0, PERIOD_6},                  // Y0 R Y0 R
    {RED|YELL0|YELL1,  YELL0|YELL1,   0, 0,   0, PERIOD_7  },   // Y0 RY1 Y0 RY1

    {YELL0|YELL1, YELL0|YELL1,   YELL0|YELL1, 0,  ONE_SECOND, 0},   // y0 y1 y0 y1 - flash yellows lights 
    {0, 0,   0, 0,   0, 0},             //  traffic lights off, 
    {RED|GREEN|YELL0, RED|YELL0,   RED|GREEN|YELL1, GREEN|YELL1,   1, PERIOD_2},        //  PERIOD_2  -      ,     

    {YELL0|GREEN, YELL0,   YELL1|GREEN, YELL1|GREEN,  1, 0}     //  -     
};

volatile uint16_t  globalTimer; //      64   
uint8_t scan_button_cnt;        //      
uint16_t tl_flash_end;          // 2       ( !0), 
uint16_t tl_signal_end;         // 2            ( !0) 
uint8_t f_button_state_flags;   // 1,        
// , 8    

#pragma region bits_of_f_button_state_flags 
    //      MODES:  wakeup 11 -&gt; work 00 -&gt; tosleep 01 -&gt; pwrdown 11 -&gt; wakeup 11
#define MODE_LBIT 0
#define MODE_HBIT 1
#define MODE_VALUE          ( f_button_state_flags &amp; 3 )    //  -   MODE_
#define SET_MODE_WORK       f_button_state_flags &amp;= ~(_BV(MODE_HBIT) );  f_button_state_flags &amp;= ~(_BV(MODE_LBIT) );// 00 - work
//  f_button_state_flags &amp;= ~( _BV(MODE_HBIT) | _BV(MODE_LBIT) ) -    ,  
#define MODE_WORK_VALUE     0
#define SET_MODE_TOSLEEP    f_button_state_flags &amp;= ~(_BV(MODE_HBIT)); f_button_state_flags |= _BV(MODE_LBIT)   // 01 - tosleep
#define MODE_TOSLEEP_VALUE  1
#define SET_MODE_PWRDOWN    f_button_state_flags |= _BV(MODE_HBIT); f_button_state_flags &amp;= ~(_BV(MODE_LBIT))   // 10 - pwrdown 
#define MODE_PWRDOWN_VALUE  2
#define SET_MODE_WAKEUP     f_button_state_flags |= _BV(MODE_HBIT); f_button_state_flags |= _BV(MODE_LBIT)      // 11 - wakeup  
#define MODE_WAKEUP_VALUE   3

#define FORCE_SET_NEW_SIGNAL_BIT        2   //             current_signal
#define IF_FORCE_SET_SIGNAL_FLAG        ( f_button_state_flags &amp; _BV(FORCE_SET_NEW_SIGNAL_BIT) )    // IF_ -    
#define SET_FORCE_SET_SIGNAL_FLAG       f_button_state_flags |=  _BV(FORCE_SET_NEW_SIGNAL_BIT)      // SET_ -    1
#define RES_FORCE_SET_SIGNAL_FLAG       f_button_state_flags &amp;= ~( _BV(FORCE_SET_NEW_SIGNAL_BIT) )  // RES_ -    0

//  3   

#define LIGHT_SIGNAL_ALT_MODE_BIT       4   // =0 (--)  =1 ( )   
#define IF_LIGHT_SIGNAL_ALT_MODE_FLAG   ( f_button_state_flags &amp; _BV(LIGHT_SIGNAL_ALT_MODE_BIT) )   //1( )  0(--)   ?
#define SET_LIGHT_SIGNAL_ALT_MODE_FLAG  f_button_state_flags |=  _BV(LIGHT_SIGNAL_ALT_MODE_BIT)
#define RES_LIGHT_SIGNAL_ALT_MODE_FLAG  f_button_state_flags &amp;= ~( _BV(LIGHT_SIGNAL_ALT_MODE_BIT) )
#define FLIP_LIGHT_SIGNAL_ALT_MODE_FLAG f_button_state_flags ^= _BV(LIGHT_SIGNAL_ALT_MODE_BIT)

#define USE_FIRST_VALUES_LIGHT_BIT      5   //     -  lightSignalization  
#define IF_USE_FIRST_VALUES_LIGHT_FLAG  (f_button_state_flags &amp; _BV(USE_FIRST_VALUES_LIGHT_BIT)) // lightSignalization._val_0 (1)  lightSignalization._val_1 (0)? -  
#define SET_USE_FIRST_VALUES_LIGHT_FLAG     f_button_state_flags |= _BV(USE_FIRST_VALUES_LIGHT_BIT)
#define RES_USE_FIRST_VALUES_LIGHT_FLAG     f_button_state_flags &amp;= ~( _BV(USE_FIRST_VALUES_LIGHT_BIT))
#define FLIP_USE_FIRST_VALUES_LIGHT_FLAG    f_button_state_flags ^= _BV(USE_FIRST_VALUES_LIGHT_BIT)     //  

#define SHORT_PRESS_FLAG_BIT    6   // , 1       
#define IF_SHORT_PRESS_FLAG     ( f_button_state_flags &amp; _BV(SHORT_PRESS_FLAG_BIT) )        // -   == 1
#define SET_SHORT_PRESS_FLAG    f_button_state_flags |= _BV(SHORT_PRESS_FLAG_BIT)
#define RES_SHORT_PRESS_FLAG    f_button_state_flags &amp;= ~(_BV(SHORT_PRESS_FLAG_BIT))

#define LONG_PRESS_FLAG_BIT     7 // , 1       
#define IF_LONG_PRESS_FLAG      ( f_button_state_flags &amp; _BV(LONG_PRESS_FLAG_BIT) )     // -   == 1
#define SET_LONG_PRESS_FLAG     f_button_state_flags |= _BV(LONG_PRESS_FLAG_BIT)
#define RES_LONG_PRESS_FLAG     f_button_state_flags &amp;= ~(_BV(LONG_PRESS_FLAG_BIT))
#pragma endregion

//....................................  
void setPeriods(uint8_t num, bool set_both_flash_and_signal);   //  tl_flash_end, tl_signal_end
void setPorts(uint8_t num, bool use_main_values);               //    
void inline init_timer_clock(){     //     
#ifdef GIMSK    //  ATtiny13 - 
    TCCR0B = _BV(CS02) | _BV(CS00); //  0 - clock frequency / 1024
    TIMSK0 |= _BV(TOIE0);           //      overflow interrupt
#else           //   , 328/16
    // 100 - prescaler 64; Foverflow = 16M/64*256 ~=976.56Hz,
    TCCR2B = (1&lt;&lt;CS22) | (1&lt;&lt;CS21) | (1&lt;&lt;CS20) ;  // 111 - CLK/1024, 16M/1024*254 - 1/64 
    TIMSK2 |=(1&lt;&lt;TOIE0);  // interrupt ovfl enable
    //Serial.begin(115200);
#endif
}

//....................................  
//
//  -  -    globalTimer  1/37 
#ifdef GIMSK    //  ATtiny13
ISR(TIM0_OVF_vect){
    globalTimer++;  //       . ,   while(1)   .
}
#else
//   0 -     , -   - -     2
ISR(TIMER2_OVF_vect){
    globalTimer++;
}
#endif
//   -    (,  ,    0)
ISR(INT0_vect){
    DISABLE_EXTERNAL_INT0;
    SET_MODE_WAKEUP;        //      POWER DOWN
    globalTimer = 0;        //  -  
    scan_button_cnt = 0;    //   
    RES_SHORT_PRESS_FLAG;   //
    RES_LONG_PRESS_FLAG;    //  
}

/*
//   - 
void inline dbg(){
    DDRB |= YELL0; PORTB ^= YELL0;
}
*/

//....................................  
//
int main() {
    uint8_t current_signal;             // 1    ,   traffic_signals

#pragma region Initialisation&amp;setup
    //     "  -". 
    set_sleep_mode(SLEEP_MODE_IDLE);    //   - .
    sleep_enable();             //    

    init_timer_clock();         //     

    globalTimer = 0;            //  -  
    SET_MODE_WORK;              //    
    SET_USE_FIRST_VALUES_LIGHT_FLAG;    //  
    scan_button_cnt = 0;        //   

    //       
    current_signal = LIGHT_NUM_START_SHOW;  //     -   /
    SET_FORCE_SET_SIGNAL_FLAG;              //    current_signal

    sei();      //    

#pragma endregion
    while(1){

#pragma region TimerOVF
        //   ? 
        if(globalTimer &gt; MAX_GLOBAL_TIMER_VALUE){
            globalTimer -= MAX_GLOBAL_TIMER_VALUE;          //   
            // 
            if(tl_flash_end){
                tl_flash_end -= MAX_GLOBAL_TIMER_VALUE;     //   ,  
            }
            if(tl_signal_end){
                tl_signal_end -= MAX_GLOBAL_TIMER_VALUE;    // //   ,  
            }
            // setPeriods(currentMode, false); //   12  ,  tl_.._end   ,     
        }
#pragma endregion

#pragma region ButtonState
        //  
        if(BUTTON_ON){
            if(scan_button_cnt &lt; USHRT_MAX){
                scan_button_cnt++;              //   1/37     
            }
            //   -  ,    
            if(scan_button_cnt &gt; PERIOD_PRESS_BUTTON_SHORT){
                SET_SHORT_PRESS_FLAG;       // ,     , 
            }
            if(scan_button_cnt &gt; PERIOD_PRESS_BUTTON_LONG){
                SET_LONG_PRESS_FLAG;        //     
            }
        }
#pragma endregion
#pragma region LightWorkLogic
        //      (tl_flash_end !=0 )
        if(tl_flash_end){
            //     
            if(globalTimer &gt; tl_flash_end){
                FLIP_USE_FIRST_VALUES_LIGHT_FLAG;               // !use_main_values -      ))
                setPorts(current_signal, IF_USE_FIRST_VALUES_LIGHT_FLAG);       //      
                setPeriods(current_signal, false);          //     ,   
            }
        }

        //         
        // -    operating_std     - -- 
        //    ,   +1   7
        if(tl_signal_end){
            //       (use_main_values -       -  )
            if((globalTimer &gt; tl_signal_end)  &amp;&amp; IF_USE_FIRST_VALUES_LIGHT_FLAG){
                current_signal ++;                          //   
                current_signal &amp;= MASK_LIGHT_NUM_STD;       //    3-,        0  7
                SET_FORCE_SET_SIGNAL_FLAG;      //    current_signal
            }
        }
#pragma endregion

#pragma region MODE_VALUELogic
        //   , 2  f_button_state_flags
        //? MODE_VALUE === pwrdown -&gt; wakeup -&gt; work -&gt; tosleep -&gt; pwrdown
        switch (MODE_VALUE){
        case (MODE_WAKEUP_VALUE):
            set_sleep_mode(SLEEP_MODE_IDLE);        //  !
            //   ,       - IF_BUTTON_LONG_FLAG
            if(IF_LONG_PRESS_FLAG){
                //      ?   !
                if(current_signal == LIGHT_NUM_LIGHTS_OFF){
                    //          ? LIGHT_NUM_ERR
                    current_signal = (IF_LIGHT_SIGNAL_ALT_MODE_FLAG) ? LIGHT_NUM_YELLOW_FLASH : LIGHT_NUM_STD_START;
                    SET_FORCE_SET_SIGNAL_FLAG;      //    current_signal
                }
            }
            //,  ...
            if(BUTTON_OFF){
                //      ,   
                if(IF_LONG_PRESS_FLAG){
                    SET_MODE_WORK;
                }else{  
                    //  , ,   ,  
                    SET_MODE_PWRDOWN;   //        
                }
                scan_button_cnt = 0;    //       
                RES_SHORT_PRESS_FLAG;   //   , 
                RES_LONG_PRESS_FLAG;
            }
            break;

        case (MODE_WORK_VALUE):
            //  ?
            if(scan_button_cnt &gt; 0){
                //   ?
                if(IF_LONG_PRESS_FLAG){
                    current_signal = LIGHT_NUM_LIGHTS_OFF;      //  
                    SET_FORCE_SET_SIGNAL_FLAG;                  //   -   " "
                    SET_MODE_TOSLEEP;                           //   !
                }
                // ? 
                if(BUTTON_OFF){
                    //     ?
                    if(IF_SHORT_PRESS_FLAG){
                        FLIP_LIGHT_SIGNAL_ALT_MODE_FLAG;    //     
                        current_signal = (IF_LIGHT_SIGNAL_ALT_MODE_FLAG) ? LIGHT_NUM_YELLOW_FLASH : LIGHT_NUM_STD_START; //    . 
                        SET_FORCE_SET_SIGNAL_FLAG;          //      current_signal
                    }
                    scan_button_cnt=0;
                    RES_SHORT_PRESS_FLAG; //    
                    RES_LONG_PRESS_FLAG;
                }
            }
            break;

        case (MODE_TOSLEEP_VALUE):
            //    -    .
            if(BUTTON_OFF){
                SET_MODE_PWRDOWN;       //    
            }
            break;

        case (MODE_PWRDOWN_VALUE):
            // !  , !  ?
            if(BUTTON_ON){
                set_sleep_mode(SLEEP_MODE_IDLE);
                SET_MODE_WAKEUP;
            }else{  
                //  ?  .
                scan_button_cnt = 0;
                RES_LONG_PRESS_FLAG;
                RES_SHORT_PRESS_FLAG;
                current_signal = LIGHT_NUM_LIGHTS_OFF;      // 
                SET_FORCE_SET_SIGNAL_FLAG;
                set_sleep_mode(SLEEP_MODE_PWR_DOWN);    //    -   while(1)
                ENABLE_EXTERNAL_INT0;                   //     
            }
            break;

        default:
            //!       -    .  -      
            current_signal = LIGHT_NUM_ERR;
            SET_FORCE_SET_SIGNAL_FLAG;
            //setPorts(current_signal,true);
            //setPeriods(current_signal,true);
            break;
        }
#pragma endregion

        //   ,      - ?
        if(IF_FORCE_SET_SIGNAL_FLAG){       //       current_signal
            RES_FORCE_SET_SIGNAL_FLAG;      //  
            SET_USE_FIRST_VALUES_LIGHT_FLAG;    //   -   0-   -
            setPorts(current_signal, IF_USE_FIRST_VALUES_LIGHT_FLAG);   //      #current_signal  
            setPeriods(current_signal, true);
        }

        //    1/37 . , ,  .
        sleep_cpu();    //       -   .
        }
}

//.................................... 
//
//    
 void setPorts(uint8_t num, bool  use_main_values){
    uint8_t val;
    DDRB = 0; PORTB = 0;
    //    () - ddr_val_0, else = ddr_val_1
//  val = (use_main_values) ? pgm_read_byte_near(&amp;(traffic_signals[num].ddr_val_0))
//                          : pgm_read_byte_near(&amp;(traffic_signals[num].ddr_val_1));

    //   ,    ,  ,   ,   14 (!!!)   .
    val = pgm_read_byte_near(&amp;(traffic_signals[num].ddr_val_0)+( (use_main_values) ? 0 : sizeof(uint8_t)*2 ) ); 

    val &amp;= ~_BV(BUTTON_PIN);    //    ,    - 
    DDRB = val;                 //    

    val = (use_main_values) ? pgm_read_byte_near(&amp;(traffic_signals[num].port_val_0)) 
                            : pgm_read_byte_near(&amp;(traffic_signals[num].port_val_1));
    val|= _BV(BUTTON_PIN);  //     -  -    
    PORTB = val;        //      
}

 //     (    )
void setPeriods(uint8_t num, bool set_both_flash_and_signal){
//  
    tl_flash_end = pgm_read_word_near (&amp;(traffic_signals[num].flash_period));   //  
    tl_flash_end = (tl_flash_end)? tl_flash_end + globalTimer : 0;  //    -      
    //if(tl_flash_end){         tl_flash_end += globalTimer;    } &lt;-     8  

    //     -    
    if(set_both_flash_and_signal){
        tl_signal_end = pgm_read_word_near(&amp;(traffic_signals[num].signal_period));  
        tl_signal_end = (tl_signal_end)? tl_signal_end + globalTimer : 0;           //     ,    
    }
}
//Program size: 976 bytes (used 95% of a 1 024 byte maximum) (0,83 secs)
//Minimum Memory Usage: 8 bytes (13% of a 64 byte maximum)</code></pre></div></div><br>
<p><em>Program size: 976 bytes (used 95% of a 1 024 byte maximum) (0,83 secs)<br>
Minimum Memory Usage: 8 bytes (13% of a 64 byte maximum)</em></p><br>
<p>.</p><br>
<p>    <del>  </del>      ATtiny13 .</p><br>
<h3 id="anatomiya--samshitovo-samannogo-svetofora"> - </h3><br>
<p>  (    ?)   .   â€”   .           ,    ,  ,   .  ,     ,    .</p><br>
<div class="spoiler"><b class="spoiler_title">,  </b><div class="spoiler_text"><h4 id="mozgi"></h4><br>
<p> DipTrace       Â«Â»      Â«PCB LayoutÂ»,     .        ,    . </p><br>
<p><img src="https://habrastorage.org/webt/0j/vq/ag/0jvqagommqperqd6t4vsqpuywbg.png"></p><br>
<p>   â€”       .</p><br>
<p><img src="https://habrastorage.org/webt/ye/zr/b0/yezrb07pnfknal2yrkkkt8z24ew.jpeg"></p><br>
<p>,           ,    .</p><br>
<p>              (      ,      80-    ).</p><br>
<p><img src="https://habrastorage.org/webt/a-/vw/zq/a-vwzqrzc8ttmxfyidyx5gku_e0.jpeg"></p><br>
<p>       CD .</p><br>
<p><img src="https://habrastorage.org/webt/be/84/yr/be84yr9lcf5qr9xmhfubcc0xi-q.jpeg"></p><br>
<p>  , ,  ,  .</p><br>
<p><img src="https://habrastorage.org/webt/4w/4p/ed/4w4pedh-im9ttbm6uhngc24vpge.jpeg"></p><br>
<p>  â€”    .</p><br>
<p><strong></strong>: <em>        ,                 </em>.</p><br>
<p> ,  ,             .    â€”   ,    .</p><br>
<p><img src="https://habrastorage.org/webt/wd/mv/p_/wdmvp_puf54uysk-0og-9lhogvk.jpeg"></p><br>
<h4 id="vnutrennosti"></h4><br>
<p>       â€”  .  -  - "Craft&amp;Clay" 50-     70.    ,        .</p><br>
<p><img src="https://habrastorage.org/webt/v2/jw/q6/v2jwq6mmb4gvxkpljgamjqavhj4.jpeg"></p><br>
<p>          .</p><br>
<p><img src="https://habrastorage.org/webt/w9/jf/8f/w9jf8f1ze2h5lytg9rgy0c4yy8s.jpeg"></p><br>
<p>       15     130   .</p><br>
<p><img src="https://habrastorage.org/webt/a4/uf/n-/a4ufn-djsbpg3386o4pvqqcpjua.jpeg"></p><br>
<p>      â€”    .</p><br>
<p><img src="https://habrastorage.org/webt/ud/tf/nz/udtfnznphbnuq_wmaap31rafnuq.jpeg"></p><br>
<p><img src="https://habrastorage.org/webt/ex/7j/xb/ex7jxbgh1bhqsmzbep9t9fnrije.jpeg"></p><br>
<p>   â€”    .</p><br>
<p><img src="https://habrastorage.org/webt/5i/qs/1v/5iqs1v1pa6jqhnmjjfyuxmcqhgy.jpeg"></p><br>
<p>  â€”     .</p><br>
<p><img src="https://habrastorage.org/webt/8l/hs/8x/8lhs8xpxud7pcd-w9ixy-qg-9a0.jpeg"></p><br>
<p>     .</p><br>
<p><img src="https://habrastorage.org/webt/xj/se/tn/xjsetne6jay2dlqlk_3mgsq4ica.jpeg"></p><br>
<p>  4     ,   2-3  , <br>
  ,      .</p><br>
<p><img src="https://habrastorage.org/webt/xu/6y/pl/xu6yplqtnq8o2yhdtj2cyjcbd3e.jpeg"></p><br>
<p>  .  , ,   ,  "   ". </p><br>
<p><img src="https://habrastorage.org/webt/ck/w7/id/ckw7idpowfs9zlrxpok7gqrhsso.jpeg"></p><br>
<p>,          . </p><br>
<p><img src="https://habrastorage.org/webt/wo/jn/rj/wojnrj1diuqw5hf8h56sxjdxyzs.jpeg"></p><br>
<p>       KSP.        â€”    4  LED     5     .</p><br>
<p><img src="https://habrastorage.org/webt/kg/f7/qy/kgf7qyhiebdqb5seavzrvekyqaq.jpeg"></p><br>
<p>                ,    ,   DC-DC 0.9-5  ,     .</p><br>
<p><img src="https://habrastorage.org/webt/ol/5v/bz/ol5vbz1tlc-lmcmuczwf77obixc.jpeg"></p><br>
<p>     .  ,    ,         .</p><br>
<p><img src="https://habrastorage.org/webt/fb/jf/8-/fbjf8-u-p8gjm2u3ccnwfk9wzdk.jpeg"></p><br>
<h4 id="ozhivlenie"></h4><br>
<p>, ,  ,   .</p><br>
<p><img src="https://habrastorage.org/webt/wm/8v/ej/wm8vejbxienobpdzeretpbxp3yi.jpeg"></p><br>
<p>      ISP     10-   .</p><br>
<p><img src="https://habrastorage.org/webt/tn/eu/7u/tneu7uxc7bewhl9g_lfsajgx9ra.png"></p></div></div><br>
<h3 id="izuchenie-zhiznedeyatelnosti-svetofora">  </h3><br>
<p>     , ,  ,  -   .        ,     ,      "  ".      1.5 ,         â€”   .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  </a>     ,      .</p><br>
<table>
<thead>
<tr>
<th> </th>
<th>, </th>
<th>, %/</th>
<th> , </th>
</tr>
</thead>
<tbody>
<tr>
<td>CR1212</td>
<td>18</td>
<td>1</td>
<td>0.250</td>
</tr>
<tr>
<td>CR1620</td>
<td>68</td>
<td>1</td>
<td>0.950</td>
</tr>
<tr>
<td>CR2032</td>
<td>210</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>NiCD AAA</td>
<td>350</td>
<td>20</td>
<td>98</td>
</tr>
<tr>
<td>NiMH AAA</td>
<td>900</td>
<td>30</td>
<td>375</td>
</tr>
<tr>
<td>NiCd AA</td>
<td>1000</td>
<td>20</td>
<td>270</td>
</tr>
<tr>
<td>Alkaline AAA</td>
<td>1250</td>
<td>2</td>
<td>35</td>
</tr>
<tr>
<td>NiMH AA</td>
<td>2400</td>
<td>30</td>
<td>1000</td>
</tr>
<tr>
<td><strong>Alkaline AA</strong></td>
<td><strong>2890</strong></td>
<td><strong>2</strong></td>
<td><strong>80</strong></td>
</tr>
<tr>
<td>Li-Ion</td>
<td>4400</td>
<td>10</td>
<td>600</td>
</tr>
</tbody>
</table><br>
<p>     ,      . ,    ,     (2/100)<em>2890/(24</em>30) = 80 .  ,    2    ,  32      ATtiny13.</p><br>
<p>         :       ,    GPIO,      .    â€” ,        ( 4   14   ""),      ,        40 . </p><br>
<p>,        â€”    .      ,      .  ,      :      5      DC-DC ,   ,          DC-DC      1.5  -&gt; 5 .        , -       +-20%,   .</p><br>
<p><img src="https://habrastorage.org/webt/ab/3v/sb/ab3vsbnwkhp2rc9tvyzv6ltyypy.png"></p><br>
<p>  ,     ""   4-5 (5 ) ,    , 25 (1.5 ),    </p><br>
<p><img src="https://habrastorage.org/webt/wx/nl/q5/wxnlq5fnsspt1cpgsdpwngtbwos.png"></p><br>
<p>.. 2890       116 ,    .   ATtiny13    POWER DOWN        . ,       â€”       .         20-50 ,    , Hi-Z,   1 .  ,   DC-DC      .</p><br>
<p>         2  5 . :         .</p><br>
<h2 id="nekotorye-processy-mozhno-tolko-prekratit-no-ne-zakonchit">    ,   </h2><br>
<p>  ,      :</p><br>
<ul>
<li>   ,   â€” ,      R2,       ,    .     .</li>
<li>   .           â€”         1/37 ,          .</li>
<li>               ,      ,  .    POWER_DOWN     30 ,      ,     ,         .</li>
<li>  traffic_signals   8   4,   .   4 pin â€”  1     DDR  PORTB</li>
<li>  uint16_t  signal_period  flash_period â€”  ,     ,   1    .</li>
<li>   â€”  ROM    2 ,    â€”     -      .</li>
<li>             /UART.</li>
<li>   main   â€”      â€”  +50   ROM.</li>
<li>       9,6    128 ,       .</li>
</ul><br>
<p>.</p><br>
<p>       :    " ", ,  8 ,   ,    Â«Â»    .</p><br>
<p>         .</p><br>
<h2 id="video-raboty"> </h2><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/23ju4JVKMeA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<p>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Github</a>,   MIT.</p></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN443188/">https://habr.com/ru/post/zh-CN443188/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN443178/index.html">CrystalåŒºå—é“¾åˆ†æï¼šè°ƒæŸ¥é»‘å®¢å’Œç›—çªƒæ¡ˆ</a></li>
<li><a href="../zh-CN443180/index.html">èˆ¹å‘˜é¾™é™è½å’Œå°è¡Œæ˜Ÿè§†é¢‘æ‹æ‘„</a></li>
<li><a href="../zh-CN443182/index.html">ä»Commodore 64æ‹‰YPbPr</a></li>
<li><a href="../zh-CN443184/index.html">ä»çˆ±åˆ°æŒæ§ä¸€æ­¥</a></li>
<li><a href="../zh-CN443186/index.html">3CXæŠ€æœ¯æ”¯æŒå“åº”-5 IP PBXå®‰å…¨è§„åˆ™</a></li>
<li><a href="../zh-CN443190/index.html">å®‰å…¨ä¸“ä¸šäººå‘˜çš„Kubernetesç½‘ç»œç­–ç•¥ç®€ä»‹</a></li>
<li><a href="../zh-CN443192/index.html">Pythonä¸­æ²¡æœ‰ä¸‹åˆ’çº¿å’Œæ¥å£çš„ç§æœ‰æ–¹æ³•</a></li>
<li><a href="../zh-CN443194/index.html">WFIRMå·¥ç¨‹å¸ˆå‘æ˜äº†ä¸€ç§ç”Ÿç‰©æ‰“å°æœºï¼Œå¯ä»¥ç›´æ¥åœ¨ä¼¤å£ä¸Šæ‰“å°çš®è‚¤</a></li>
<li><a href="../zh-CN443196/index.html">ç¦»çº¿ä¸€åˆ†é’Ÿ-é€‰æ‹©å·¥ä¸šLTEè·¯ç”±å™¨</a></li>
<li><a href="../zh-CN443198/index.html">é©¬å…‹Â·æ‰å…‹ä¼¯æ ¼ï¼ˆMark Zuckerbergï¼‰è¯´ï¼ŒFacebookæ­£åœ¨ç ”ç©¶ä¸€ç§ç”¨äºé˜…è¯»æ€æƒ³çš„ç¥ç»æ¥å£</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>