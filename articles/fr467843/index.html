<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§æüèº ‚õπÔ∏è üòî Comment √©conomiser jusqu'√† un demi-million de dollars en AWS? üë©üèø‚Äçü§ù‚Äçüë©üèª üë∑üèº üåö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! Je vous pr√©sente la traduction de l'article ¬´Comment r√©duire vos co√ªts AWS? √âconomisez jusqu'√† 500 000 $ avec ces directives! ¬ª auteur ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment √©conomiser jusqu'√† un demi-million de dollars en AWS?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467843/"> Bonjour, Habr!  Je vous pr√©sente la traduction de l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´Comment r√©duire vos co√ªts AWS?</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√âconomisez jusqu'√† 500 000 $ avec ces directives! ¬ª</a>  auteur George Batschinski. <br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/0.png" alt="image"><br><br>  Dans cet article, nous d√©taillerons comment Back4App a r√©duit ses d√©penses AWS de 55 492 $ par mois √† 20 074 $ par mois et √©conomis√© 500 000 $ par an.  Nous d√©crirons les √©tapes pratiques bas√©es sur notre propre exp√©rience de r√©duction des co√ªts dans AWS et partagerons des conseils qui nous ont √©galement √©t√© utiles. <br><a name="habracut"></a><br>  AWS continue d'innover et de dominer le march√© du cloud.  Il a tellement grandi qu'il est devenu un √©l√©ment cl√© de la strat√©gie d'Amazon.  Je suis enthousiasm√© par AWS, mais les doutes sur la complexit√© et le co√ªt du cloud m'ont conduit √† optimiser l'utilisation du cloud.  Malgr√© le fait qu'AWS propose une liste sans cesse croissante de services sp√©cialis√©s pour divers types de d√©veloppement, ce n'est pas toujours le moyen le plus direct, le plus rapide ou le plus abordable.  Id√©alement, d√®s que vous acc√©dez au cloud, vous devez penser imm√©diatement √† l'architecture afin de r√©duire les co√ªts.  Ce mat√©riel aidera √† acc√©l√©rer l'optimisation des co√ªts et contient des cas r√©els que nous avons rencontr√©s lors de notre entreprise de r√©duction des co√ªts. <br><br>  Un bref aper√ßu de ce que vous trouverez dans cet article: <br><br><ul><li>  <b>Demandez des pr√™ts aupr√®s d'AWS et obtenez jusqu'√† 100 000 $;</b> </li><li>  <b>Transf√©rez le transfert de donn√©es vers Cloud Front et √©conomisez jusqu'√† 75%;</b> </li><li>  <b>Utilisez une adresse IP priv√©e (pas Elastic IP) et arr√™tez de payer pour le transfert de donn√©es entre les zones d'acc√®s;</b> </li><li>  <b>√âconomisez jusqu'√† 90% avec les instances ponctuelles;</b> </li><li>  <b>√âconomisez jusqu'√† 75% en achetant des instances r√©serv√©es sur AWS Marketplace;</b> </li><li>  <b>Obtenez des n≈ìuds Elastic Cache r√©serv√©s et √©conomisez jusqu'√† 77%;</b> </li><li>  <b>R√©servez vos donn√©es dans S3, mais pas dans EBS et √©conomisez jusqu'√† 75%;</b> </li><li>  <b>Configurer la mise √† l'√©chelle automatique pour les ressources inactives;</b> </li><li>  <b>Choisissez la r√©gion de la Virginie du Nord et √©loignez-vous de Sao Paulo;</b> </li><li>  <b>Mettez √† niveau vers de nouvelles g√©n√©rations d'instances et √©conomisez jusqu'√† 20%;</b> </li><li>  <b>Localisez le point de terminaison S3 dans votre VPC et activez le r√©seau am√©lior√© sur EC2.</b> </li></ul><br>  Voici √† quoi ressemblait notre compte AWS en janvier 2019. Le co√ªt total du cloud est de 55 492 $. <br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/1.png" alt="image"><br><br>  Voici √† quoi ressemblait notre compte AWS en mai 2019. Le co√ªt total √©tait de 20 074 $. <br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/2.png" alt="image"><br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/3.png" alt="image"><br><br><h2>  1. Pr√™ts AWS </h2><br>  Tout d'abord!  Avant de commencer quoi que ce soit, assurez-vous que votre entreprise est √©ligible aux pr√™ts AWS.  Voici comment vous pouvez obtenir ces pr√™ts: <br><br><h3>  Demandez des pr√™ts √† AWS </h3><br>  C'√©tait donc dans notre cas!  En 2016, notre entreprise a connu une croissance assez rapide.  Notre facture AWS a commenc√© √† augmenter et nous n'avions ni id√©e ni temps pour optimiser l'utilisation d'AWS.  Comme nous n'avions pas de financement, nous avons r√©alis√© que nous allions soit recevoir des pr√™ts d'AWS, soit dispara√Ætre.  Nous avons pr√©par√© notre dossier pour notre compte de gestionnaires dans AWS, d√©montrant √† quelle vitesse nous grandissons et les avantages pour AWS de nous soutenir sur notre site.  Nous lui avons montr√© que nous n'avions pas de financement et serions oblig√©s d'aller sur Google Cloud (ils nous ont offert 100 000 $ de pr√™ts pour la migration vers AWS) si nous ne recevions pas de pr√™ts d'AWS.  La r√©ponse a pris environ une semaine et AWS nous a fourni 100 000 $ pour une utilisation sur 12 mois.  C'√©tait √©galement une bonne affaire pour AWS!  Depuis l'expiration des pr√™ts, nous avons d√©pens√© plus de 750 000 $ avec AWS. <br><br><h3>  Cr√©dits pour tester et lancer Proof Of Concept </h3><br>  Si vous avez l'intention de tester un nouveau service d'AWS ou le type d'instance, demandez des pr√™ts √† votre responsable de compte.  Le nombre de pr√™ts d√©pendra de vos co√ªts mensuels et de l'effort global pour lancer POC.  Ces pr√™ts ne sont g√©n√©ralement valables que pour trois mois, et vous devez vous assurer de la vitesse du POC.  Dans notre cas, nous avons pu obtenir 3 000 $ de pr√™ts pour tester la famille d'instances i3. <br><br><h3>  Cr√©dits de d√©marrage </h3><br>  Si vous avez fond√© votre entreprise ou lanc√© une startup, c'est un excellent moyen d'avancer.  Le montant des pr√™ts varie de 1 000 $ √† 100 000 $, selon la fa√ßon dont vous pr√©sentez votre dossier AWS.  Il existe plusieurs fa√ßons d'obtenir ces pr√™ts. <br><br><h4>  Acc√©l√©rateurs </h4><br>  L'un des principaux avantages des acc√©l√©rateurs de d√©marrage dans les bonus qu'ils fournissent.  L'un de ces bonus est les pr√™ts des fournisseurs de cloud.  Le montant que vous pouvez recevoir d√©pend de l'acc√©l√©rateur dans lequel vous √™tes repr√©sent√©.  Certains des meilleurs, par exemple, YC, Alchemist, Wayra et 500 Startups vous offriront 100 000 $ en pr√™ts AWS.  Dans notre cas, nous avons √©t√© accept√©s par Alchemist Accelerator et √©mis 100 000 $ en pr√™ts.  Malheureusement, nous n'avons pas pu utiliser ces pr√™ts, car auparavant nous avions d√©j√† profit√© d'autres pr√™ts.  Par exemple, si vous acceptez deux acc√©l√©rateurs pour 100 000 $ chacun, vous ne pourrez pas utiliser 200 000 $, seulement 100 000 $. <br><br><h4>  Fonds de capital-risque et groupes d'anges </h4><br>  Certains groupes WF / Angel accordent des pr√™ts dans le cadre du programme de bonus.  Dans notre cas, nous avons r√©ussi √† obtenir 10 000 $ de pr√™ts √† la commercialisation, valables deux ans aupr√®s d'un de nos investisseurs.  Malheureusement, nous n'avons pas pu les utiliser.  Les entreprises ne peuvent pas utiliser les cr√©dits promotionnels AWS si elles ont d√©j√† re√ßu un montant de pr√™ts √©gal ou sup√©rieur. <br><br><h4>  Tous les principaux fournisseurs de cloud fournissent des pr√™ts aux startups </h4><br>  Tous les principaux acteurs du march√© du cloud proposent des pr√™ts aux startups.  Avec AWS / Google, les pr√™ts peuvent aller jusqu'√† 100 000 $.  Chez Azure, vous pouvez obtenir 360 000 $ pour trois ans. <br><br><h2>  2. R√©alisez des √©conomies sur AWS </h2><br>  La partie facile est termin√©e et passons maintenant aux d√©fis!  Il n'y a pas de pilule magique pour r√©duire les co√ªts dans AWS, vous devez travailler dur et suivre une proc√©dure r√©guli√®re pour surveiller les co√ªts!  R√©duire les co√ªts du cloud devrait √™tre votre routine quotidienne!  Imaginez combien vous √©conomisez en 365 jours!  Le temps que vous investissez d√©pend de la taille de votre organisation et de vos co√ªts AWS.  Je passe environ 30 minutes par jour √† surveiller mon compte et √† prioriser les actions de r√©duction des co√ªts.  De plus, les ing√©nieurs de Back4App consacrent au moins 1 heure par jour √† des initiatives de r√©duction des co√ªts. <br><br>  La premi√®re initiative que nous avons termin√©e: cr√©er une feuille de calcul simple dans Excel pour hi√©rarchiser les initiatives de r√©duction des co√ªts. <br><br>  Les principaux crit√®res par lesquels nous d√©terminons les √©conomies: <br><br><ul><li>  Potentiel d'√©conomies - Gains les plus √©lev√©s gr√¢ce aux √©conomies </li><li>  Difficult√© - √Ä quel point est-il difficile d'appliquer l'effort et le travail requis </li><li>  Propri√©taire - Qui ex√©cutera l'action </li></ul><br>  Dans notre cas, les plus grandes √©conomies sont l'utilisation d'Elastic Compute Cloud (EC2), et c'est le premier sujet que nous avons commenc√© √† comprendre. <br><br><h2>  3. EC2 - Elastic Compute Cloud </h2><br><h3>  D√©sactivez les instances inutilis√©es </h3><br>  Le premier point √† prendre pour r√©duire les co√ªts sur EC2 est de d√©sactiver les instances inutilis√©es.  Il n'y a rien de compliqu√©, et la plupart du travail est assez simple.  Il vous suffit de faire une liste de toutes les instances, de charger le fichier Excel de l'exemple et de les d√©finir.  Dans notre cas, nous avons divis√© nos instances en 3 cat√©gories principales: <br><br><ul><li>  Des instances qui doivent fonctionner en continu </li><li>  Instances pouvant √™tre arr√™t√©es </li><li>  Instances pouvant √™tre supprim√©es </li></ul><br>  <b>N'arr√™tez pas, mais supprimez les instances</b> <br><br>  Supprimez les instances inutilis√©es lorsque cela est possible!  Si vous les arr√™tez, vous continuerez √† payer pour utiliser EBS! <br><br><h3>  R√©duisez les ressources exc√©dentaires </h3><br>  Cette action est un peu plus compliqu√©e et il est absolument n√©cessaire de s√©lectionner correctement la taille de l'instance.  Veuillez vous assurer d'√©valuer au moins une semaine de donn√©es pour augmenter la probabilit√© d'un changement d'instance correct.  L'approche par laquelle nous avons contr√¥l√© ce processus √©tait de diviser les instances en 3 cat√©gories principales: <br><br><ul><li>  Taille correcte </li><li>  R√©duire la taille de l'instance </li><li>  Augmenter la taille de l'instance </li></ul><br>  La fa√ßon de v√©rifier les donn√©es historiques d'une instance est extr√™mement simple.  Dans le panneau de configuration AWS, acc√©dez √† Services&gt; EC2&gt; Instances&gt; Ex√©cution d'instances, s√©lectionnez Instance&gt; Surveillance.  Par exemple, vous pouvez v√©rifier la m√©trique d'utilisation du processeur. <br><br>  <b>R√©duisez la taille des instances de mani√®re s√©quentielle</b> <br><br>  R√©duisez progressivement la taille de votre instance.  Par exemple, ne r√©duisez pas la taille de t2.xlarge √† t2.medium.  Tout d'abord, r√©duisez-le de t2.2xlarge √† t2.xlarge.  Regardez une semaine, v√©rifiez combien de ressources sont utilis√©es et r√©p√©tez les √©tapes sur une nouvelle.  En effectuant ces √©tapes, vous minimiserez les risques d'erreurs ou de temps d'arr√™t. <br><br><h3>  Utiliser des instances r√©serv√©es </h3><br>  La r√©servation d'instances peut augmenter vos √©conomies jusqu'√† 70%.  Veuillez garder √† l'esprit que lorsque vous r√©servez une instance, vous payez 24/7 pour la dur√©e de la r√©servation.  Vous paierez, que vous utilisiez l'instance ou non. <br><br>  Il existe deux types de capacit√©s redondantes: <br><br>  Standard - que vous pouvez vendre sur AWS Marketplace, vous ne pouvez pas le convertir en un autre type d'instance, moins cher que les instances convertibles. <br><br>  Convertible - Vous ne pourrez pas le vendre sur AWS Marketplace, mais vous pouvez le convertir en une instance d'un type diff√©rent, plus cher que les instances standard. <br><br>  <b>Les instances convertibles peuvent pr√™ter √† confusion</b> <br><br>  Les instances convertibles sont tr√®s difficiles!  Chaque fois que vous convertissez des instances, vous ne pouvez qu'augmenter la taille de l'instance.  Consid√©rez la situation suivante: <br><br>  Vous acqu√©rez t3.medium, une instance r√©serv√©e convertible. <br>  Vous d√©cidez de convertir t3.medium en instance m5.large. <br><br>  Vous r√©ussirez certainement!  Apr√®s avoir utilis√© l'instance m5.large pendant un certain temps, vous souhaiterez revenir √† t3.medium. <br><br>  <b>Et c'est d√©j√† impossible!</b> <br><br>  Vous ne pourrez pas r√©duire la consommation de l'instance convertible, mais seulement augmenter le montant que vous payez pour cela.  Alors s'il vous pla√Æt, assurez-vous de commencer avec une petite instance r√©serv√©e et de l'augmenter au fil du temps.  Ne commencez pas avec une grande instance, car vous ne pouvez pas r√©duire sa consommation ou la vendre sur AWS Marketplace'e.  <b>Si vous faites une erreur avec une instance r√©serv√©e convertible, vous √™tes abonn√© √† un paiement mensuel de 12 ou 36 mois.</b>  Chez Back4App, nous obtenons toujours d'abord t2.nano et l'augmentons au besoin. <br><br>  Je pr√©f√®re les instances r√©serv√©es standard aux convertibles pour les raisons suivantes: <br><br><ul><li>  Ils sont moins chers </li><li>  Ils ont une liquidit√© plus √©lev√©e - ils peuvent √™tre vendus √† tout moment sur AWS Marketplace. </li><li>  Ils peuvent √™tre achet√©s sur le AWS Marketplace √† prix r√©duit. </li></ul><br><h3>  Utilisez AWS Marketplace pour les instances r√©serv√©es </h3><br>  Les instances r√©serv√©es sont excellentes, mais l'achat d'instances r√©serv√©es sur AWS Marketplace est encore mieux! <br><br><h3>  AWS Marketplace peut √™tre beaucoup moins cher </h3><br>  AWS Marketplace ressemble √† un march√© des valeurs mobili√®res!  Vous pouvez parfois acheter une instance r√©serv√©e standard √† un prix beaucoup plus abordable que d'acheter directement aupr√®s d'AWS.  La raison est simple;  Les entreprises poss√®dent parfois des instances redondantes qui ne sont plus utilis√©es, mais continuent de les payer.  La baisse du prix de l'h√©bergement acc√©l√®re le processus d'achat. <br><br>  Ici, je vais donner un exemple de ce qui s'est pass√© avec Back4App.  Je cherchais 4 instances r√©serv√©es r4.large.  J'ai r√©ussi √† trouver des instances sur AWS Marketplace avec un taux effectif de 75% moins cher par rapport aux prix √† la demande.  AWS a vendu le m√™me type d'instances r√©serv√©es, mais avec une remise de 62%. <br><br><h3>  AWS Marketplace propose des conditions d'achat flexibles </h3><br>  Un autre avantage d'AWS Marketplace est que vous pouvez acheter des instances avec une p√©riode d'utilisation flexible.  AWS lui-m√™me ne propose que des options pour 12 et 36 mois pour l'achat d'instances r√©serv√©es.  AWS Marketplace est beaucoup plus flexible!  Vous pouvez acheter, par exemple, des instances r√©serv√©es pour 15 mois pour le m√™me prix que pour 36 mois.  Certaines entreprises pr√©f√®rent les obligations √† long terme (36 mois) et avant l'expiration de l'obligation, elles les vendent sur AWS Marketplace.  Le nouveau client n'utilisera l'instance que pour la p√©riode restante, par exemple: <br><br><ul><li>  Dur√©e totale d'acquisition: 36 mois </li><li>  Acheteur initial: utilise l'instance pendant 21 mois </li><li>  Deuxi√®me acheteur: l'ach√®te sur la place de march√© et l'utilise pendant les 15 mois restants. </li></ul><br>  La principale difficult√© est de trouver les bonnes instances sur AWS Marketplace.  <b>Un excellent moyen de simplifier la recherche d'instances est de les rechercher dans plusieurs zones d'acc√®s, et pas seulement dans celle o√π vous vous trouvez.</b>  Une fois que vous avez acquis une instance, vous pouvez la modifier et l'affecter √† une autre zone d'accessibilit√©, ou la transformer en une instance r√©gionale.  Ce n'est pas du tout difficile √† faire, mais veuillez suivre les instructions ci-dessous: <br><br><ul><li>  √âtape 1 - Acc√©dez au tableau de bord des instances r√©serv√©es </li><li>  √âtape 2 - Cliquez sur Acheter des instances r√©serv√©es </li><li>  √âtape 3 - dans la cat√©gorie d'offre, s√©lectionnez Standard </li><li>  √âtape 4 - Dans le coin sup√©rieur droit de la fen√™tre contextuelle, s√©lectionnez ¬´Afficher uniquement les offres r√©servant de la capacit√©¬ª </li><li>  √âtape 5 - Cliquez sur Rechercher </li><li>  √âtape 6 - Obtenez une instance de la zone de disponibilit√© 1b </li><li>  √âtape 7 - Attendez que l'instance devienne active </li><li>  √âtape 8 - S√©lectionnez l'instance qui a √©t√© achet√©e </li><li>  √âtape 9 - Cliquez sur le bouton Actions </li><li>  √âtape 10 - Cliquez sur Modifier les instances r√©serv√©es </li><li>  √âtape 11 - Port√©e - Modifier la zone ou la r√©gion de disponibilit√© </li><li>  √âtape 12 - Cliquez sur Continuer </li><li>  √âtape 13 - Cliquez sur Soumettre les modifications </li></ul><br>  En suivant ces √©tapes, vous pourrez acheter des instances r√©serv√©es standard dans n'importe quelle zone de disponibilit√© et les modifier pour votre zone de disponibilit√©. <br><br><h3>  AWS Marketplace pour les entreprises en dehors des √âtats-Unis </h3><br>  Pr√©cision importante pour les utilisateurs en dehors de la juridiction am√©ricaine.  Vous ne pouvez pas vendre des instances r√©serv√©es standard sur la place de march√© √† moins d'avoir une entit√© juridique d'√âtat.  Si votre entreprise trouve en dehors des √âtats-Unis, vous pourrez acheter des instances sur Marketplace, mais vous ne pourrez pas les vendre. <br><br><h3>  Utiliser des instances ponctuelles </h3><br>  J'adore les instances Spot!  Vous pouvez √©conomiser jusqu'√† 90% en les utilisant, et cela ne n√©cessitera pas de gros investissements!  Le seul inconv√©nient des instances Spot est qu'AWS peut supprimer ces instances en un rien de temps ou apr√®s un avertissement de deux minutes.  √Ä cet √©gard, ce type d'instances ne peut √™tre utilis√© que pour des charges tol√©rantes aux pannes ou flexibles. <br><br>  <b>Utilisez SpotInst pour ex√©cuter des instances ponctuelles</b> <br><br>  Un moyen s√ªr d'ex√©cuter des instances Spot et de minimiser les risques d'indisponibilit√© consiste √† utiliser la plateforme SpotInst.  Ce service se connecte √† votre compte AWS et g√®re la distribution des instances Spot.  Si l'instance est d√©sactiv√©e, le service la remplace par On Demand et √©vite les temps d'arr√™t.  Les tarifs sont √©galement assez int√©ressants, ils facturent 20% de ce qui a √©t√© √©conomis√© (entre la diff√©rence de prix du On-demand et du Spot). <br><br>  Un excellent sc√©nario pour les instances Spot consiste √† utiliser une copie des serveurs pour les bases de donn√©es ou pour les extensions d'application flexibles.  Utilisez SpotInst pour contr√¥ler l'allocation des instances Spot, et vous ne rencontrerez probablement jamais de temps d'arr√™t associ√©s √† l'utilisation de cette classe d'instances. <br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/4.png" alt="image"><br><br><h3>  Mise √† l'√©chelle automatique (ressources inactives, automatisation des instances EC2 de d√©marrage / arr√™t) </h3><br>  AWS Auto Scaling surveille vos applications et ajuste automatiquement l'alimentation pour maintenir une alimentation stable et pr√©visible au moindre co√ªt.  Vous pouvez configurer la mise √† l'√©chelle automatique pour d√©marrer et arr√™ter automatiquement les instances EC2.  La mise √† l'√©chelle automatique prend en compte les m√©triques de ressources telles que le processeur, les demandes d'API et les heures d'activation / d√©sactivation. <br><br>  Pour minimiser les co√ªts, vous devez utiliser la mise √† l'√©chelle automatique + les instances Spot + les instances r√©serv√©es.  Regardons la situation r√©elle que nous avons rencontr√©e dans Back4App.  Les charges de travail changent tout au long de la journ√©e.  Le nombre de demandes que nous recevons n'est pas uniforme et a des charges d'utilisation de pointe √† certaines heures.  Pour r√©soudre ce probl√®me, nous allouons des instances r√©serv√©es √† la limite de consommation minimale et les adaptons avec des instances ponctuelles.  La figure ci-dessous vous aide √† comprendre la configuration.  Voici combien vous pouvez √©conomiser: <br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/5.png" alt="image"><br><br><ul><li>  Instances r√©serv√©es: Chez Back4App, nous utilisons un m√©lange d'instances r√©serv√©es standard mensuelles 12/36.  Nos √©conomies m√©dianes sont de 50% par rapport aux prix √† la demande. </li><li>  Mise √† l'√©chelle automatique: nous d√©marrons / arr√™tons les instances en fonction du nombre total de demandes d'API re√ßues par chaque instance.  Nous avons trois p√©riodes de pointe pendant la journ√©e, et les √©conomies par rapport aux ressources inactives qui fonctionneraient 24 heures √† charge maximale sont d'environ 75%. </li><li>  Instances Spot: nous avons un m√©lange de deux familles d'instances qui fonctionnent sur Spotinst pour une disponibilit√© maximale.  Nos √©conomies sont de 55% par rapport aux prix √† la demande.  Ce sont nos √©conomies, en tenant compte du montant total que nous payons SpotInst.  L'utilisation d'instances ponctuelles directement √† partir d'AWS pourrait nous faire √©conomiser environ 70%, mais augmenterait les risques.  Nous aimons jouer de fa√ßon mesur√©e et nous avons d√©cid√© de redonner une partie de nos √©conomies √† SpotInst. </li></ul><br>  <b>Ajuster l'√©chelle</b> <br><br>  Personnalisez votre mise √† l'√©chelle verticale et horizontale (Cloudformation) <br><br><h3>  Choisissez la bonne r√©gion AWS √† enregistrer </h3><br><ul><li>  Les prix varient selon les r√©gions!  Choisissez le mauvais et vous paierez trop. </li><li>  Les r√©gions les moins ch√®res sont la Virginie du Nord, l'Ohio et l'Oregon. </li></ul><br>  Les plus chers: Sao Paulo, Sydney et Hong Kong <br>  Prenons l'exemple suivant: <br><br><ul><li>  4 instances t3.medium </li><li>  EBS 30 Go d√©di√© √† chaque instance </li><li>  1 To total de trafic </li></ul><br>  La m√™me configuration sera 102% plus ch√®re √† Sao Paulo qu'en Virginie du Nord. <br><br><ul><li>  221,65 $ / mois en Virginie du Nord </li><li>  449,05 $ / mois √† Sao Paulo </li></ul><br>  La centralisation des op√©rations dans une r√©gion pr√©sente √©galement ses avantages. <br><br><ul><li>  Il est beaucoup plus facile de contr√¥ler l'allocation des instances r√©serv√©es. </li><li>  Les frais de trafic interr√©gionaux ne s'appliqueront pas </li></ul><br>  Chez Back4App, nous n'avons pas pu centraliser toutes les op√©rations en Virginie du Nord en raison de notre couverture commerciale et des exigences de nos clients.  Nous avons d√©cid√© de cr√©er un cluster aux USA, en Europe et en Asie.  Nous avons centralis√© nos op√©rations dans ces grappes et √©tendu chaque r√©gion autant que possible. <br><br><h3>  Mettre √† jour les g√©n√©rations pr√©c√©dentes de ressources </h3><br>  AWS lance occasionnellement de nouveaux types d'instances.  Les nouvelles g√©n√©rations sont plus puissantes et moins ch√®res. <br><br>  <b>L'ancienne g√©n√©ration d'instances</b> <br><br>  C4.large <br><br>  2 noyaux <br><br>  3,75 Go de m√©moire <br><br>  0,100 USD / heure <br><br>  <b>La nouvelle g√©n√©ration d'instances</b> <br><br>  C5.large <br><br>  2 noyaux <br><br>  4 Go de m√©moire <br><br>  0,085 USD / heure <br><br>  La nouvelle g√©n√©ration est 15% moins ch√®re et 6% plus puissante! <br><br>  <b>Autoriser un r√©seau am√©lior√©</b> <br><br>  Activez le r√©seau am√©lior√© pour de meilleures performances d'instance! <br><br><h2>  4. EBS - Elastic Block Store </h2><br>  EBS fournit des volumes de stockage s√©curis√©s √† utiliser avec les instances EC2 dans le cloud AWS.   EBS    ,      ,     .        ,    .     General Purpose SSD  Magnetic. <br><br> <b>General Purpose SSD</b> <br><br> $ 0.10/- <br><br> <b>Magnetic</b> <br><br> $ 0.05/- <br><br><h3> EBS  ‚Äì SSD x Magnetic </h3><br>        ,    . ,    Magnetic  SSD. <br><br><ul><li>  Magnetic  SSD ,   . </li><li>  SSD  ,   . </li></ul><br><h3> EBS  ‚Äì    </h3><br>  ,    EBS ‚Äì      .       . <br><br><h3>   ‚Äì      EBS </h3><br>         EBS!         !        ,  !      EC2  EBS. <br><br> AWS     EBS,     .  ,    ,  ,   EBS   . <br><br>  ,     .  ,    10  t3.small     50GB SSD EBS . <br><br>    : <br><br><ul><li> EC2   = 10 x $ 15.23 = 152.30 </li><li> EBS  : 10 x 50  = 500  </li><li>   : $ 0.10- </li><li> EBS  : $ 50.00 </li><li>  : $ 182.30 </li></ul><br>    ,  EBS    32%   EC2      .    ,   . <br><br> <b>   </b> <br><br>       (ephemeral storage).  ,        EBS,          Reserved .  , ,         (   ),   Spot    . <br><br><h3>    </h3><br>   ,    ‚Äì      . <br><br> <b> S3,    </b> <br><br> EBS    ,  S3!  ,      S3,    EBS. <b>,  ,     ,     .</b> <br><br><h2> 5.  Elastic Cache ‚Äì Reserved Nodes </h2><br>  ,    reserved   Elastic Cache.   : <br><br><ul><li> 1   ‚Äì 65%  </li><li> 3   ‚Äì 77%  </li></ul><br>     EC2 .   reserved node,   : <br><br><ul><li>   Elastic Cache ( EC2 Reserved instances) </li><li>   Reserved Nodes </li><li>     ¬´Purchase Reserved Node¬ª   </li><li>  Redis  Memcached </li><li>    </li><li>     </li><li>  Offering Type (1  3 ) </li><li>  Next </li></ul><br>     Elastic Cache   ,    EC2.          . <br><br> <b> Elastic Cache  AWS Marketplace'</b> <br><br>  ,    Marketplace  Reserved Nodes!   ,       . <br><br><h2> 6.   </h2><br>      -   !    ,     ,    .  ,     . ,    ,    ,     , S3  ,  .. <br><br>  ,  Back4App        ,    . <br><br><h3>        AWS? </h3><br>   ,       . <br><br><h3>  S3 endpoint  Cloudflare   CDN . </h3><br> CDN (Content Delivery Network    )             ,    ,    . <br><br><h3>  IP ‚Äì   IP     </h3><br>   !  AWS ,        EC2 ,       ¬´Public IP/ Elastic IP Data Transfer¬ª.       Public  Elastic IP ,  Elastic Load Balancer   ,                .       ,       (   ),    IP  ,   . <br><br><h3>     ‚Äì Availability Zone </h3><br>      ,    .       . <br><br><h3>  GraphQL API </h3><br>     GraphQL     ,  ,      .  REST    ,    ,    ; ,      .   ‚Äì  GraphQL      . <br><br><h3>      </h3><br>   ,        .          . <br><br><h3>  CloudFront! </h3><br>    ,    !              ‚Äì  .      . <br><br><h3>      ? </h3><br>          <br><br><ul><li> Cost Explorer </li><li>  </li></ul><br>  -   ,    ,   ,      . <br><br>      Cost Explorer,    My Billing Dashboard   Cost Explorer.   Spend by Service View    .      6 ,    . ,    Service     !        ,   . <br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/6.png" alt="image"><br><br>           : <br><br><ul><li>  More Filters,    </li><li>  Usage Type Group </li><li>      </li><li>  Data Transfer ‚Äì Inter AZ </li><li>  Data Transfer ‚Äì Internet Out </li><li>  Data Transfer ‚Äì Region to Region Out </li><li>  S3 Data Transfer Out </li><li>  Apply Filters </li></ul><br>        : <br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/7.png" alt="image"><br><br>            ,  S3  EC2.  ,              . <br><br>         billing report.   My Billing Dashboard   Bills . <br><br>     : <br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/8.png" alt="image"><br><br>  ,     ,      EC2.   Data Transfer     . <br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/9.png" alt="image"><br><br>  ,       ( ,   , ). <br><br><img src="https://s3.eu-central-1.amazonaws.com/ocs.mikhail.sokolov.files/habr/10.png" alt="image"><br><br><h2> 7. CloudFront </h2><br>  On-demand  Cloudfront     .    100 Tb .    $ 0.060 / Gb,    15%          ELB. <br><br><h3>   Cloud Front &amp;    </h3><br>        ! AWS     CloudFront     ,      CloudFront   $0.02/Gb.      ,      AWS    ,    .    ,           CloudFront Private Contract. <br><br><h3> Amazon CloudFront SSL-Cert-Custom </h3><br> ,     .   $20  ,       Cloudflare  $25  .   Private &amp; Volume Pricing,      CDN (Cloud Delivery Network) ,       . <br><br><h2> 8. S3 ‚Äì Simple Storage Service </h2><br>       S3 . <br><br><h3> S3 VPC endpoint </h3><br>   ,     ‚Äì   S3 VPC endpoint. <b> S3 endpoint   VPC (Virtual Private Cloud)      S3       ,  AWS     ,       .</b>    ,          . <br><br><h3>         </h3><br>     : <br> <b>S3 Standard</b> <br><br> $ 0.023 /  <br><br> <b>:</b> <br><br><ul><li>     </li><li>       </li><li>   ,      </li></ul><br> <b>S3 Infrequent Access</b> <br><br> $ 0.0125 /  <br><br> <b>:</b> <br><br><ul><li>    ,        </li><li>     </li><li>   ,         </li></ul><br> <b>S3 One-Zone Infrequent Access</b> <br><br> $ 0.010 /  <br><br> <b>:</b> <br><br><ul><li>    </li><li>    </li><li>       </li></ul><br> <b>S3 Glacier</b> <br><br> $ 0.004 /  <br><br> <b>:</b> <br><br><ul><li> , ,        </li><li>     </li><li>            </li></ul><br> <b>S3 Glacier Deep Archive</b> <br><br> $ 0.00099 /  <br><br> <b>:</b> <br><br><ul><li>              ,       . </li><li>     12  </li><li>     </li></ul><br> <b>  S3 API  </b> <br><br> <b> ,   ,      ,      .</b>     !   ,    Back4App.        ,    .       S3 Standard      S3 Glacier  .   !    ,  AWS  $ 0.05   1000   Glacier!   ,    ,       ! <b>     ,       S3    .</b> <br><br><h3>     S3 </h3><br>        S3       .       S3 .       . <br><br><h2> 9.       AWS </h2><br>   4   : <br><br><ul><li> Basic ‚Äì  </li><li> Developer ‚Äî $ 29 /   3%     </li><li> Business ‚Äî $ 100 /   10-3%  ,     </li><li> Enterprise ‚Äî $ 15.000   </li></ul><br>    Business    .            ,   .       Enterprise,      . ( Enterprise , ,        .) <br><br> <b>    AWS</b> <br><br>         !              .  AWS      ! ,          GDPR   !           .     ,      . <br><br><h2> 10.    </h2><br>         .              ,    .       365 ! <br><br>         .        : <br><br><ul><li>   </li><li>  ,  : </li><li>  Billing &amp; Cost Management </li><li>   </li><li> Cost Explorer ‚Äì     </li><li> Cost Explorer ‚Äì  RI </li><li> Cost Explorer ‚Äì  RI </li><li>  tag'  </li><li>  , ,    </li><li>        AWS </li><li>  CloudWatch  Trusted Advisor    </li><li>         </li></ul><br><h2> 11.   </h2><br>        .       ,      . <br>    Back4App ,      .  ,         .           . <br><br><h2> 12.  </h2><br>   ,      AWS!      ,  ,   ,    . <br><br>    ,       AWS. <br><br><ul><li> <b>  EC2 </b> </li><li> <b>  </b> </li><li> <b>    CloudFront</b> </li><li> <b>    </b> </li><li> <b>    enhanced network</b> </li><li> <b>   S3</b> </li><li> <b>   AWS Marketplace &amp; Elastic Cache Nodes</b> </li><li> <b>   Spot, Reserved  On-Demand </b> </li><li> <b> autoscaling</b> </li><li> <b>  S3 Standard,   Glacier</b> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr467843/">https://habr.com/ru/post/fr467843/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr467825/index.html">Algorithmes d'apprentissage automatique indispensables</a></li>
<li><a href="../fr467827/index.html">Comment nous avons fait notre petite unit√© √† partir de z√©ro</a></li>
<li><a href="../fr467831/index.html">La voie √©pineuse de la programmation</a></li>
<li><a href="../fr467837/index.html">MCU ¬´Terrible¬ª √† trois cents - un bref aper√ßu des microcontr√¥leurs co√ªtant moins de 0,1 $</a></li>
<li><a href="../fr467841/index.html">Rendez-vous plus facile: Entretien avec John Romero, d√©veloppeur de Doom</a></li>
<li><a href="../fr467847/index.html">¬´L'√©volution omnicanal de l'IoT¬ª ou comment l'Internet des objets peut affecter l'omnicanal</a></li>
<li><a href="../fr467849/index.html">Peloton: prochain Apple ou autre arnaque?</a></li>
<li><a href="../fr467851/index.html">V√©rifiez la qualit√© sans quitter la caisse</a></li>
<li><a href="../fr467853/index.html">Evolution de la carte de visite: de la carte √† l'application</a></li>
<li><a href="../fr467855/index.html">Nouveau 2GIS: une carte compl√®te de la Russie et la recherche de marchandises dans les magasins hors ligne</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>