<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§• üåµ üç´ VMware NSX para los m√°s peque√±os. Parte 5. Configurar el equilibrador de carga üèáüèº üêøÔ∏è ü¶ç</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Primera parte Introductorio 
 Segunda parte Configurar firewall y reglas NAT 
 Tercera parte Configuraci√≥n de DHCP 
 Parte cuatro Configuraci√≥n de enr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>VMware NSX para los m√°s peque√±os. Parte 5. Configurar el equilibrador de carga</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/448540/"><img src="https://habrastorage.org/webt/cs/bv/4v/csbv4vf7zldwjd6etj65xyw309o.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Primera parte</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Introductorio</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Segunda parte</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Configurar firewall y reglas NAT</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Tercera parte</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Configuraci√≥n de DHCP</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte cuatro</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Configuraci√≥n de enrutamiento</a> <br><br>  La √∫ltima vez que hablamos sobre las capacidades de NSX Edge en t√©rminos de enrutamiento est√°tico y din√°mico, y hoy trataremos con el equilibrador. <br><br>  Antes de continuar con la configuraci√≥n, me gustar√≠a recordar brevemente los principales tipos de equilibrio. <br><a name="habracut"></a><br><h3>  Teor√≠a </h3><br>  Todas las soluciones actuales de equilibrio de carga √∫til se dividen con mayor frecuencia en dos categor√≠as: equilibrio en el cuarto (transporte) y el s√©ptimo (aplicado) niveles del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">modelo OSI</a> .  El modelo OSI no es el mejor punto de referencia cuando se describen m√©todos de equilibrio.  Por ejemplo, si el equilibrador L4 tambi√©n admite la terminaci√≥n TLS, ¬øse convierte entonces en un equilibrador L7?  Pero eso es, eso es. <br><br><ul><li>  <b>El equilibrador L4 suele</b> ser el que se interpone entre el cliente y el conjunto de backends intermedios de proxy disponibles, que termina las conexiones TCP (es decir, responde independientemente a SYN), selecciona un backend e inicia una nueva sesi√≥n TCP en su direcci√≥n, enviando SYN.  Este tipo es uno de los b√°sicos, otras opciones son posibles. </li><li>  <b>El equilibrador L7</b> distribuye el tr√°fico a los backends disponibles "m√°s sofisticados" que el equilibrador L4.  Puede decidir un backend basado, por ejemplo, en el contenido de un mensaje HTTP (URL, cookie, etc.). </li></ul><br>  Independientemente del tipo, el equilibrador puede admitir las siguientes funciones: <br><br><ul><li>  El descubrimiento de servicios es el proceso de determinar el conjunto de backends disponibles (Est√°tico, DNS, C√≥nsul, Etcd, etc.). </li><li>  Comprobaci√≥n del estado de los backends detectados ("ping" activo del backend mediante una solicitud HTTP, detecci√≥n pasiva de problemas en las conexiones TCP, la presencia de varios c√≥digos HTTP 503 en las respuestas seguidas, etc.). </li><li>  Equilibrio en s√≠ mismo (round robin, selecci√≥n aleatoria, hash de IP de origen, URI). </li><li>  Terminaci√≥n de TLS y verificaci√≥n del certificado. </li><li>  Opciones relacionadas con la seguridad (autenticaci√≥n, prevenci√≥n de ataques DoS, l√≠mite de velocidad) y mucho m√°s. </li></ul><br>  NSX Edge ofrece soporte para dos modos de implementaci√≥n de balanceador: <br><br>  <b>Modo proxy, o un brazo</b> .  En este modo, cuando env√≠a una solicitud a uno de los servidores, NSX Edge usa su direcci√≥n IP como la direcci√≥n de origen.  Por lo tanto, el equilibrador realiza las funciones NAT de origen y de destino.  El backend ve todo el tr√°fico enviado desde el equilibrador y responde directamente a √©l.  En este esquema, el equilibrador debe estar en el mismo segmento de red con los servidores internos. <br><br>  As√≠ es como va: <br><br><ol><li>  El usuario env√≠a una solicitud a la direcci√≥n VIP (direcci√≥n equilibradora) que est√° configurada en Edge. </li><li>  Edge selecciona uno de los backends y realiza el NAT de destino, reemplazando la direcci√≥n VIP con la direcci√≥n del backend seleccionado. </li><li>  Edge ejecuta NAT de origen, reemplazando la direcci√≥n del usuario que envi√≥ la solicitud por la suya. </li><li>  El paquete se env√≠a al backend seleccionado. </li><li>  El backend no responde directamente al usuario, pero Edge, ya que la direcci√≥n original del usuario se ha cambiado a la direcci√≥n del equilibrador. </li><li>  Edge env√≠a la respuesta del servidor al usuario. </li></ol><br>  Esquema a continuaci√≥n. <br><br><img src="https://habrastorage.org/webt/ta/jx/m5/tajxm5nceoc5z9oeea0_apjftvs.png"><br><br>  <b>Modo transparente o en l√≠nea.</b>  En este escenario, el equilibrador tiene interfaces en la red interna y externa.  Sin embargo, no hay acceso directo a la red interna desde el externo.  El equilibrador de carga incorporado act√∫a como una puerta de enlace NAT para m√°quinas virtuales en la red interna. <br><br>  El mecanismo es el siguiente: <br><br><ol><li>  El usuario env√≠a una solicitud a la direcci√≥n VIP (direcci√≥n equilibradora) que est√° configurada en Edge. </li><li>  Edge selecciona uno de los backends y realiza el NAT de destino, reemplazando la direcci√≥n VIP con la direcci√≥n del backend seleccionado. </li><li>  El paquete se env√≠a al backend seleccionado. </li><li>  El backend recibe una solicitud con la direcci√≥n original del usuario (no se ejecut√≥ el NAT de origen) y responde directamente a ella. </li><li>  El equilibrador de carga acepta nuevamente el tr√°fico, ya que en el esquema en l√≠nea generalmente act√∫a como la puerta de enlace predeterminada para la granja de servidores. </li><li>  Edge ejecuta NAT de origen para enviar tr√°fico al usuario, utilizando su VIP como la direcci√≥n IP de origen. </li></ol><br>  Esquema a continuaci√≥n. <br><br><img src="https://habrastorage.org/webt/w0/su/z0/w0suz0nii_gq5r4qcmibzge0zja.png"><br><br><h3>  Practica </h3><br>  En mi banco de pruebas, se configuran 3 servidores con Apache, que est√° configurado para funcionar en HTTPS.  Edge equilibrar√° las solicitudes HTTPS utilizando el m√©todo round robin, enviando cada nueva solicitud a un nuevo servidor. <br><br>  Empecemos <br><br><h4>  Generando un certificado SSL que usar√° NSX Edge </h4><br>  Puede importar un certificado de CA v√°lido o usar uno autofirmado.  En esta prueba, usar√© autofirmado. <br><br><ol><li>  En la interfaz de vCloud Director, vaya a la configuraci√≥n de los servicios perimetrales. <br><br><img src="https://habrastorage.org/webt/i-/dq/th/i-dqthihewvxbuenqctf75z02nw.png"></li><li>  Vaya a la pesta√±a Certificados.  De la lista de acciones, seleccione la adici√≥n de una nueva CSR. <br><br><img src="https://habrastorage.org/webt/zw/jz/zy/zwjzzymdjpgwylcdi93pus7wmrk.png"></li><li>  Rellene los campos obligatorios y haga clic en Guardar. <br><br><img src="https://habrastorage.org/webt/c6/bj/zo/c6bjzodgmz0yepyhwdy00_dhoqg.png"></li><li>  Seleccione la CSR reci√©n creada y seleccione la opci√≥n de CSR autofirmado. <br><br><img src="https://habrastorage.org/webt/z2/2k/sg/z22ksgjo22tjo1dpgfr-gvutbhu.png"></li><li>  Seleccione el per√≠odo de validez del certificado y haga clic en Mantener <br><br><img src="https://habrastorage.org/webt/nl/wh/1w/nlwh1wu3amwefnuies4jxj0tiry.png"></li><li>  Un certificado autofirmado apareci√≥ en la lista de disponibles. <br><br><img src="https://habrastorage.org/webt/r9/u5/1q/r9u51qb5gt-rsf0ysyzx4byeezg.png"></li></ol><br><h4>  Configurar perfil de aplicaci√≥n </h4><br>  Los perfiles de aplicaci√≥n le brindan m√°s control sobre el tr√°fico de red y hacen que administrarlo sea simple y eficiente.  Con su ayuda, puede determinar el comportamiento para tipos espec√≠ficos de tr√°fico. <br><br><ol><li>  Vaya a la pesta√±a Load Balancer y encienda el balanceador.  La opci√≥n de aceleraci√≥n habilitada aqu√≠ permite que el equilibrador use un equilibrio L4 m√°s r√°pido en lugar de L7. <br><br><img src="https://habrastorage.org/webt/tr/gy/vb/trgyvbidsrd3xyyh-g6gis9igms.png"></li><li>  Vaya a la pesta√±a Perfil de la aplicaci√≥n para configurar el perfil de la aplicaci√≥n.  Haz clic en +. <br><br><img src="https://habrastorage.org/webt/nm/ng/aq/nmngaqjer2nwulb1mtrqttk0s0u.png"></li><li>  Establezca el nombre del perfil y seleccione el tipo de tr√°fico para el que se aplicar√° el perfil.  Explicar√© algunos par√°metros. <br><br>  <b>Persistencia</b> : guarda y rastrea los datos de la sesi√≥n, por ejemplo: qu√© servidor espec√≠fico del grupo atiende una solicitud del usuario.  Esto garantiza que las solicitudes de los usuarios se env√≠en al mismo miembro del grupo durante toda la vida de la sesi√≥n o las sesiones posteriores. <br><br>  <b>Habilitar paso a trav√©s de SSL</b> : cuando se selecciona esta opci√≥n, NSX Edge deja de terminar SSL.  En cambio, la terminaci√≥n se produce directamente en los servidores para los que se realiza el equilibrio. <br><br>  <b>Insertar encabezado HTTP X-Fordered-For</b> : le permite determinar la direcci√≥n IP de origen del cliente que se conecta al servidor web a trav√©s del equilibrador. <br><br>  <b>Habilitar SSL</b> del grupo de servidores: le permite especificar que el grupo seleccionado est√© formado por servidores HTTPS. <br><br><img src="https://habrastorage.org/webt/ah/bm/i9/ahbmi974xepvaiwrqwtxy4uio6u.png"></li><li>  Como equilibrar√© el tr√°fico HTTPS, necesito habilitar el SSL del lado del grupo y seleccionar el certificado generado previamente en la pesta√±a Certificados de servidor virtual -&gt; Certificado de servicio. <br><br><img src="https://habrastorage.org/webt/w2/ij/jn/w2ijjndohiaackavyj05iwjudpg.png"></li><li>  Del mismo modo para los certificados de grupo -&gt; Certificado de servicio. <br><br><img src="https://habrastorage.org/webt/hn/5j/sy/hn5jsy5-tnudpfdcpome_wqwu0i.png"></li></ol><br><h4>  Creamos un grupo de servidores, el tr√°fico al que se equilibrar√°n los grupos </h4><br><ol><li>  Vaya a la pesta√±a Grupos.  Haz clic en +. <br><br><img src="https://habrastorage.org/webt/1x/2c/e-/1x2ce--4asvoflplvlaiklfukhc.png"></li><li>  Establezca el nombre del grupo, seleccione el algoritmo (usar√© round robin) y el tipo de monitoreo para la verificaci√≥n del estado del backend. La opci√≥n Transparente indica si los clientes IP de origen iniciales son visibles para los servidores internos. <br><br><ul><li>  Si esta opci√≥n est√° desactivada, el tr√°fico para los servidores internos proviene de la IP de origen del equilibrador. <br></li><li>  Si esta opci√≥n est√° habilitada, los servidores internos ven los clientes IP de origen.  En esta configuraci√≥n, NSX Edge debe actuar como la puerta de enlace predeterminada para garantizar que los paquetes devueltos pasen por NSX Edge. </li></ul><br>  NSX admite los siguientes algoritmos de equilibrio: <br><br><ul><li>  <b>IP_HASH</b> : selecci√≥n del servidor basada en los resultados de la funci√≥n hash para la IP de origen y destino de cada paquete. </li><li>  <b>LEASTCONN</b> : equilibra las conexiones entrantes, dependiendo del n√∫mero de ya disponibles en un servidor en particular.  Las nuevas conexiones se dirigir√°n al servidor con el menor n√∫mero de conexiones. </li><li>  <b>ROUND_ROBIN</b> : se env√≠an nuevas conexiones a cada servidor por turno, de acuerdo con el peso especificado. </li><li>  <b>URI</b> : la parte izquierda del URI (antes del signo de interrogaci√≥n) se divide en hash y se divide por el peso total de los servidores en el grupo.  El resultado indica qu√© servidor recibe la solicitud, asegurando que la solicitud siempre se enruta al mismo servidor, siempre y cuando todos los servidores permanezcan disponibles. </li><li>  <b>HTTPHEADER</b> : equilibrio basado en un encabezado HTTP espec√≠fico, que se puede especificar como par√°metro.  Si falta el encabezado o no tiene ning√∫n significado, se utiliza el algoritmo ROUND_ROBIN. </li><li>  <b>URL</b> : cada solicitud HTTP GET busca el par√°metro URL especificado como argumento.  Si el par√°metro va seguido de un signo y un valor iguales, el valor se divide en hash y se divide por el peso total de los servidores en ejecuci√≥n.  El resultado indica qu√© servidor recibe la solicitud.  Este proceso se utiliza para rastrear los identificadores de usuario en las solicitudes y para garantizar que la misma identificaci√≥n de usuario se env√≠e siempre al mismo servidor, siempre que todos los servidores permanezcan disponibles. </li></ul><br><img src="https://habrastorage.org/webt/ru/a-/w1/rua-w1fjpzumfbu92ujeakfw0hm.png"></li><li>  En el bloque Miembros, haga clic en + para agregar servidores al grupo. <br><br><img src="https://habrastorage.org/webt/qd/io/cf/qdiocfo-f-kjw6aot0q9ekbd37i.png"><br><br>  Aqu√≠ debe especificar: <br><br><ul><li>  nombre del servidor </li><li>  Direcci√≥n IP del servidor; </li><li>  el puerto al que el servidor recibir√° tr√°fico; </li><li>  puerto para control de salud (Monitor de control de salud); </li><li>  Peso: con este par√°metro puede ajustar la cantidad proporcional de tr√°fico recibido para un miembro espec√≠fico del grupo; </li><li>  Conexiones m√°ximas: la cantidad m√°xima de conexiones al servidor; </li><li>  Conexiones m√≠n .: la cantidad m√≠nima de conexiones que el servidor debe procesar antes de que el tr√°fico se redirija al siguiente miembro del grupo. </li></ul><br><img src="https://habrastorage.org/webt/wi/re/hv/wirehvt2ivslsykeopxoeuvrhky.png"><br><br>  As√≠ es como se ve el grupo final de tres servidores. <br><br><img src="https://habrastorage.org/webt/u1/t1/xs/u1t1xsnzgp9-zs4odzuklgark30.png"></li></ol><br><h4>  Agregar servidor virtual </h4><br><ol><li>  Vaya a la pesta√±a Servidores virtuales.  Haz clic en +. <br><br><img src="https://habrastorage.org/webt/k5/pt/j0/k5ptj0t6ziwg25ec17vcjntpgzm.png"></li><li>  Activamos el servidor virtual usando Enable Virtual Server. <br><br>  Le asignamos un nombre, seleccionamos el Perfil de aplicaci√≥n, el Grupo creado anteriormente y especificamos la direcci√≥n IP a la que el Servidor virtual aceptar√° solicitudes externas.  Especifique el protocolo HTTPS y el puerto 443. <br>  Par√°metros opcionales aqu√≠: <br><br>  <b>L√≠mite de conexi√≥n</b> : el n√∫mero m√°ximo de conexiones simult√°neas que un servidor virtual puede manejar; <br>  <b>L√≠mite de velocidad de conexi√≥n (CPS)</b> : el n√∫mero m√°ximo de nuevas solicitudes entrantes por segundo. <br><br><img src="https://habrastorage.org/webt/xa/rp/xu/xarpxupxblhb_tt0qsatlfn5b-m.png"></li></ol><br><br>  Esto completa la configuraci√≥n del equilibrador, puede verificar su rendimiento.  Los servidores tienen la configuraci√≥n m√°s simple, lo que le permite comprender qu√© servidor del grupo proces√≥ la solicitud.  Durante la configuraci√≥n, seleccionamos el algoritmo de equilibrio Round Robin, y el par√°metro Peso para cada servidor es igual a uno, por lo que el pr√≥ximo servidor del grupo procesar√° cada solicitud siguiente. <br><br>  Ingrese la direcci√≥n externa del equilibrador en el navegador y vea: <br><br><img src="https://habrastorage.org/webt/nt/he/7u/nthe7uim5gmdqb9odzyub_hdkeq.png"><br><br>  Despu√©s de actualizar la p√°gina, la solicitud ser√° procesada por el siguiente servidor: <br><br><img src="https://habrastorage.org/webt/ke/d1/xf/ked1xfdi_nmdye9ci5nswvgzjaq.png"><br><br>  Y de nuevo, para verificar el tercer servidor del grupo: <br><br><img src="https://habrastorage.org/webt/nu/uo/8u/nuuo8uvhb1dq2tozx2nrtjwfo68.png"><br><br>  Al verificar, puede ver que el certificado que Edge nos env√≠a es el mismo que generamos al principio. <br><br>  Verifique el estado del equilibrador desde la consola de la puerta de enlace Edge.  Para hacer esto, ingrese <b>al grupo de carga del equilibrador de carga del servicio show</b> . <br><br><img src="https://habrastorage.org/webt/ba/_6/jq/ba_6jqyhlyemoguhvwshmhgabbq.png"><br><br><h4>  Configure el Monitor de servicio para verificar el estado de los servidores en el grupo </h4><br>  Con Service Monitor, podemos monitorear el estado de los servidores en el grupo de servidores.  Si la respuesta a la solicitud no coincide con lo esperado, el servidor puede retirarse del grupo para que no reciba ninguna solicitud nueva. <br><br>  Por defecto, se configuran tres m√©todos de verificaci√≥n: <br><br><ul><li>  Monitor TCP </li><li>  Monitor HTTP </li><li>  HTTPS-monitor. </li></ul><br>  Crea uno nuevo. <br><br><ol><li>  Vaya a la pesta√±a Supervisi√≥n del servicio, haga clic en +. <br><br><img src="https://habrastorage.org/webt/i_/ca/e4/i_cae4kdihjj0ewts1v1d-yeeog.png"></li><li>  Elegir: <br><br><ul><li>  nombre para el nuevo m√©todo; </li><li>  intervalo en el que se enviar√°n las solicitudes, </li><li>  tiempo de espera de respuesta </li><li>  el tipo de monitoreo es la solicitud HTTPS utilizando el m√©todo GET, el c√≥digo de estado esperado es 200 (OK) y la URL de solicitud. </li></ul></li><li>  Esto completa la configuraci√≥n del nuevo Service Monitor, ahora podemos usarlo al crear un grupo. <br><br><img src="https://habrastorage.org/webt/by/vj/ea/byvjea2dm23pabgtmueiedehzhq.png"></li></ol><br><h4>  Configurar reglas de aplicaci√≥n </h4><br>  Reglas de aplicaci√≥n es una forma de manipular el tr√°fico en funci√≥n de desencadenantes espec√≠ficos.  Con esta herramienta, podemos crear reglas avanzadas de equilibrio de carga, que pueden no ser posibles de configurar a trav√©s de los perfiles de la Aplicaci√≥n o utilizando otros servicios disponibles en Edge Gateway. <br><br><ol><li>  Para crear una regla, vaya a la pesta√±a Reglas de aplicaci√≥n del equilibrador. <br><br><img src="https://habrastorage.org/webt/lc/ff/uw/lcffuwfhhtf6nn1emi7_e-3cjdu.png"></li><li>  Elija un nombre, un script que usar√° la regla y haga clic en Conservar. <br><br><img src="https://habrastorage.org/webt/1y/a-/o0/1ya-o0rss2uga8gzuasij20yd70.png"></li><li>  Despu√©s de crear la regla, necesitamos editar el servidor virtual ya configurado. <br><br><img src="https://habrastorage.org/webt/xg/ha/jf/xghajfs-6ntwycerfn_nun0wvlq.png"></li><li>  En la pesta√±a Avanzado, agregue la regla que creamos. <br><br><img src="https://habrastorage.org/webt/le/zv/vs/lezvvste4xmuvdzj4l8jrp5trbq.png"></li></ol><br><br>  En el ejemplo anterior, hemos incluido soporte para tlsv1. <br><br>  Un par de ejemplos m√°s: <br><br>  Redirigir el tr√°fico a otro grupo. <br><br>  Con este script, podemos redirigir el tr√°fico a otro grupo de equilibrio si el grupo principal no funciona.  Para que la regla funcione, se deben configurar varios grupos en el equilibrador y todos los miembros del grupo principal deben estar en estado inactivo.  Especifique el nombre del grupo, no su ID. <br><br><pre><code class="plaintext hljs">acl pool_down nbsrv(PRIMARY_POOL_NAME) eq 0 use_backend SECONDARY_POOL_NAME if PRIMARY_POOL_NAME</code> </pre> <br>  Redirigir el tr√°fico a un recurso externo. <br><br>  Aqu√≠ redirigimos el tr√°fico a un sitio web externo si todos los miembros del grupo principal est√°n en estado inactivo. <br><br><pre> <code class="plaintext hljs">acl pool_down nbsrv(NAME_OF_POOL) eq 0 redirect location http://www.example.com if pool_down</code> </pre> <br>  M√°s ejemplos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br>  Eso es todo sobre el equilibrador.  Si tiene alguna pregunta, pregunte, estoy listo para responder. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/448540/">https://habr.com/ru/post/448540/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../448530/index.html">C√≥mo dorm√≠a Megaphone en suscripciones m√≥viles</a></li>
<li><a href="../448532/index.html">Centro de datos espaciales. Resumiendo el experimento</a></li>
<li><a href="../448534/index.html">¬øPor qu√© necesitamos interruptores industriales con EMC mejorado?</a></li>
<li><a href="../448536/index.html">Transparencia - La panacea de los Butcherts</a></li>
<li><a href="../448538/index.html">Cree una soluci√≥n de conmutaci√≥n por error basada en la arquitectura Oracle RAC y AccelStor Shared-Nothing</a></li>
<li><a href="../448544/index.html">Paquetes en acero. Como se forman</a></li>
<li><a href="../448546/index.html">UITableView tama√±os autom√°ticos de encabezado y pie de p√°gina con AutoLayout</a></li>
<li><a href="../448548/index.html">Construcci√≥n en el arte: de Brueghel a Vasya Lozhkin</a></li>
<li><a href="../448552/index.html">ProLiant Series 100 - El hermano menor perdido</a></li>
<li><a href="../448558/index.html">¬øEs posible renderizar im√°genes realistas sin n√∫meros de punto flotante?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>