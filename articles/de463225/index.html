<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêà ü§πüèª üßóüèø WiFi Enterprise. FreeRadius + FreeIPA + Ubiquiti üë®üèæ‚Äçü§ù‚Äçüë®üèª üî∫ ‚ú≥Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einige Beispiele f√ºr Unternehmens-WLAN wurden bereits beschrieben. Hier werde ich beschreiben, wie ich eine √§hnliche L√∂sung implementiert habe und wel...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>WiFi Enterprise. FreeRadius + FreeIPA + Ubiquiti</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463225/"><img src="https://habrastorage.org/webt/2w/tm/tw/2wtmtwbdgzq2u6yp-ujvywpl4rw.jpeg"><br><br>  Einige Beispiele f√ºr Unternehmens-WLAN wurden bereits beschrieben.  Hier werde ich beschreiben, wie ich eine √§hnliche L√∂sung implementiert habe und welche Probleme ich beim Anschlie√üen an verschiedene Ger√§te hatte.  Wir werden das vorhandene LDAP mit den etablierten Benutzern verwenden, FreeRadius erh√∂hen und WPA2-Enterprise auf dem Ubnt-Controller konfigurieren.  Es scheint, dass alles einfach ist.  Mal sehen ... <br><a name="habracut"></a><br><h2>  Ein bisschen √ºber EAP-Methoden </h2><br>  Bevor wir mit der Aufgabe fortfahren, m√ºssen wir entscheiden, welche Authentifizierungsmethode wir in unserer L√∂sung verwenden. <br><br>  <b>Aus Wikipedia:</b> <br><blockquote>  EAP ist ein Authentifizierungsframework, das h√§ufig in drahtlosen Netzwerken und Punkt-zu-Punkt-Verbindungen verwendet wird.  Das Format wurde zuerst in RFC 3748 beschrieben und in RFC 5247 aktualisiert. <br>  EAP wird verwendet, um eine Authentifizierungsmethode auszuw√§hlen, Schl√ºssel zu √ºbertragen und diese Schl√ºssel mit Plug-Ins zu verarbeiten, die als EAP-Methoden bezeichnet werden.  Es gibt viele EAP-Methoden, die sowohl mit EAP selbst als auch von einzelnen Herstellern definiert wurden.  EAP definiert nicht die Verbindungsschicht, sondern nur das Nachrichtenformat.  Jedes Protokoll, das EAP verwendet, verf√ºgt √ºber ein eigenes Protokoll zum Einkapseln von EAP-Nachrichten. </blockquote><br>  <b>Die Methoden selbst:</b> <br><br><ul><li>  LEAP ist ein propriet√§res Protokoll, das von CISCO entwickelt wurde.  Sicherheitsl√ºcken gefunden.  Derzeit nicht empfohlen </li><li>  EAP-TLS wird von Mobilfunkanbietern gut unterst√ºtzt.  Es ist ein sicheres Protokoll, da es der Nachfolger von SSL-Standards ist.  Das Einrichten des Clients ist ziemlich kompliziert.  Ben√∂tigen Sie zus√§tzlich zum Passwort ein Client-Zertifikat.  Wird auf vielen Systemen unterst√ºtzt </li><li>  EAP-TTLS - auf vielen Systemen weit verbreitet - bietet gute Sicherheit bei Verwendung von PKI-Zertifikaten nur auf dem Authentifizierungsserver </li><li>  EAP-MD5 ist ein weiterer offener Standard.  Bietet minimale Sicherheit.  Anf√§llig, unterst√ºtzt keine gegenseitige Authentifizierung und Schl√ºsselgenerierung </li><li>  EAP-IKEv2 - Basierend auf dem Internet Key Exchange Protocol Version 2. Bietet gegenseitige Authentifizierung und Sitzungsschl√ºsselerstellung zwischen Client und Server </li><li>  PEAP ist eine gemeinsame Sicherheitsl√∂sung von CISCO, Microsoft und RSA als offener Standard.  Weit verbreitet in Produkten, bietet sehr gute Sicherheit.  √Ñhnlich wie bei EAP-TTLS, f√ºr das nur ein serverseitiges Zertifikat erforderlich ist </li><li>  PEAPv0 / EAP-MSCHAPv2 - nach EAP-TLS ist es der zweitgr√∂√üte Standard der Welt.  Verwendete Client-Server-Beziehung in Microsoft, Cisco, Apple, Linux </li><li>  PEAPv1 / EAP-GTC - Erstellt von Cisco als Alternative zu PEAPv0 / EAP-MSCHAPv2.  Sch√ºtzt Authentifizierungsdaten in keiner Weise.  Wird unter Windows nicht unterst√ºtzt </li><li>  EAP-FAST ist eine von Cisco entwickelte Methode zur Behebung von LEAP-M√§ngeln.  Verwendet PAC (Protected Access Credential).  Nicht voll entwickelt </li></ul><br>  Von all dieser Vielfalt ist die Auswahl immer noch nicht gro√ü.  Die Authentifizierungsmethode war erforderlich: gute Sicherheit, Unterst√ºtzung auf allen Ger√§ten (Windows 10, MacOS, Linux, Android, iOS) und je einfacher, desto besser.  Daher fiel die Wahl auf EAP-TTLS in Verbindung mit dem PAP-Protokoll. <br>  Vielleicht stellt sich die Frage: Warum PAP verwenden?  weil es Passw√∂rter im Klartext √ºbertr√§gt? <br><br>  Ja, das ist richtig.  Die Kommunikation zwischen FreeRadius und FreeIPA erfolgt auf diese Weise.  Im Debug-Modus k√∂nnen Sie verfolgen, wie Benutzername und Passwort gesendet werden.  Ja, und lassen Sie sie los, nur Sie haben Zugriff auf den FreeRadius-Server. <br><br>  Lesen Sie hier mehr √ºber die Arbeit von EAP-TTLS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><br></a> <br><br><h2>  Freeradius </h2><br>  Wir werden FreeRadius unter CentOS 7.6 erh√∂hen.  Hier ist nichts kompliziertes, wie √ºblich eingestellt. <br><br><pre><code class="bash hljs">yum install freeradius freeradius-utils freeradius-ldap -y</code> </pre> <br>  <i>Ab Paketen wird Version 3.0.13 installiert.</i>  <i>Letzteres kann unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://freeradius.org/</a> abgerufen werden.</i> <br><br>  Danach funktioniert FreeRadius bereits.  Sie k√∂nnen die Zeile in / etc / raddb / users auskommentieren <br><br><pre> <code class="bash hljs">steve Cleartext-Password := <span class="hljs-string"><span class="hljs-string">"testing"</span></span></code> </pre> <br>  F√ºhren Sie den Server im Debug-Modus aus <br><br><pre> <code class="bash hljs">freeradius -X</code> </pre> <br>  Und stellen Sie eine Testverbindung mit localhost her <br><br><pre> <code class="bash hljs">radtest steve testing 127.0.0.1 1812 testing123</code> </pre> <br>  <i>Erhielt</i> eine Antwort <i>Received Access-Accept Id 115 von 127.0.0.1:1812 bis 127.0.0.1‚ñ∫6081 L√§nge 20</i> , dann ist alles in Ordnung.  Mach weiter. <br><br>  Wir verbinden das <i><b>ldap-</b></i> Modul. <br><br><pre> <code class="bash hljs">ln -s /etc/raddb/mods-available/ldap /etc/raddb/mods-enabled/ldap</code> </pre> <br>  Und sofort √§ndern.  Wir brauchen FreeRadius, um auf FreeIPA zugreifen zu k√∂nnen <br><br><div class="spoiler">  <b class="spoiler_title">mods-enabled / ldap</b> <div class="spoiler_text"><pre> <code class="bash hljs">ldap { server=<span class="hljs-string"><span class="hljs-string">"ldap://ldap.server.com"</span></span> port=636 start_tls=yes identity=<span class="hljs-string"><span class="hljs-string">"uid=admin,cn=users,dc=server,dc=com"</span></span> password=********** base_dn=<span class="hljs-string"><span class="hljs-string">"cn=users,dc=server,dc=com"</span></span> set_auth_type=yes ... user { base_dn=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${..base_dn}</span></span></span><span class="hljs-string">"</span></span> filter=<span class="hljs-string"><span class="hljs-string">"(uid=%{%{Stripped-User-Name}:-%{User-Name}})"</span></span> } ...</code> </pre> <br></div></div><br>  Wir starten den Radius-Server neu und √ºberpr√ºfen die Synchronisation der LDAP-Benutzer: <br><br><pre> <code class="bash hljs">radtest user_ldap password_ldap localhost 1812 testing123</code> </pre> <br>  Bearbeiten von eap in <i><b>mods-enabled / eap</b></i> <br>  F√ºgen Sie hier zwei eap-Instanzen hinzu.  Sie unterscheiden sich nur in Zertifikaten und Schl√ºsseln.  Ich werde gleich unten erkl√§ren, warum <br><br><div class="spoiler">  <b class="spoiler_title">mods-enabled / eap</b> <div class="spoiler_text"><pre> <code class="bash hljs">eap eap-client { default_eap_type = ttls timer_expire = 60 ignore_unknown_eap_types = no cisco_accounting_username_bug = no max_sessions = <span class="hljs-variable"><span class="hljs-variable">${max_requests}</span></span> tls-config tls-common { private_key_file = <span class="hljs-variable"><span class="hljs-variable">${certdir}</span></span>/fisrt.key certificate_file = <span class="hljs-variable"><span class="hljs-variable">${certdir}</span></span>/first.crt dh_file = <span class="hljs-variable"><span class="hljs-variable">${certdir}</span></span>/dh ca_path = <span class="hljs-variable"><span class="hljs-variable">${cadir}</span></span> cipher_list = <span class="hljs-string"><span class="hljs-string">"HIGH"</span></span> cipher_server_preference = no ecdh_curve = <span class="hljs-string"><span class="hljs-string">"prime256v1"</span></span> check_crl = no } ttls { tls = tls-common default_eap_type = md5 copy_request_to_tunnel = no use_tunneled_reply = yes virtual_server = <span class="hljs-string"><span class="hljs-string">"inner-tunnel"</span></span> } } eap eap-guest { default_eap_type = ttls timer_expire = 60 ignore_unknown_eap_types = no cisco_accounting_username_bug = no max_sessions = <span class="hljs-variable"><span class="hljs-variable">${max_requests}</span></span> tls-config tls-common { private_key_passwotd=blablabla private_key_file = <span class="hljs-variable"><span class="hljs-variable">${certdir}</span></span>/server.key certificate_file = <span class="hljs-variable"><span class="hljs-variable">${certdir}</span></span>/server.crt dh_file = <span class="hljs-variable"><span class="hljs-variable">${certdir}</span></span>/dh ca_path = <span class="hljs-variable"><span class="hljs-variable">${cadir}</span></span> cipher_list = <span class="hljs-string"><span class="hljs-string">"HIGH"</span></span> cipher_server_preference = no ecdh_curve = <span class="hljs-string"><span class="hljs-string">"prime256v1"</span></span> check_crl = no } ttls { tls = tls-common default_eap_type = md5 copy_request_to_tunnel = no use_tunneled_reply = yes virtual_server = <span class="hljs-string"><span class="hljs-string">"inner-tunnel"</span></span> } }</code> </pre> <br></div></div><br>  Bearbeiten Sie als N√§chstes <i><b>Site-f√§hig / Standard</b></i> .  Interessiert an den Abschnitten zum Autorisieren und Authentifizieren. <br><br><div class="spoiler">  <b class="spoiler_title">Site-f√§hig / Standard</b> <div class="spoiler_text"><pre> <code class="bash hljs">authorize { filter_username preprocess <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (&amp;User-Name == <span class="hljs-string"><span class="hljs-string">"guest"</span></span>) { eap-guest { ok = <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> } } elsif (&amp;User-Name == <span class="hljs-string"><span class="hljs-string">"client"</span></span>) { eap-client { ok = <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { eap-guest { ok = <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> } } ldap <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((ok || updated) &amp;&amp; User-Password) { update { control:Auth-Type := ldap } } expiration logintime pap } authenticate { Auth-Type LDAP { ldap } Auth-Type eap-guest { eap-guest } Auth-Type eap-client { eap-client } pap }</code> </pre> <br></div></div><br>  Im Autorisierungsbereich entfernen wir alle Module, die wir nicht ben√∂tigen.  Lass nur ldap.  Wir f√ºgen die Kunden√ºberpr√ºfung nach Benutzername hinzu.  Aus diesem Grund haben wir die beiden oben genannten eap-Instanzen hinzugef√ºgt. <br><br><div class="spoiler">  <b class="spoiler_title">Multi eap</b> <div class="spoiler_text">  Tatsache ist, dass wir durch das Anschlie√üen einiger Ger√§te Systemzertifikate verwenden und die Dom√§ne angeben.  Wir haben ein Zertifikat und einen Schl√ºssel von einer vertrauensw√ºrdigen Zertifizierungsstelle.  Pers√∂nlich ist ein solches Verbindungsverfahren meiner Meinung nach einfacher, als auf jedem Ger√§t ein selbstsigniertes Zertifikat zu erstellen.  Aber auch ohne selbstsignierte Zertifikate hat es nicht geklappt.  Samsung-Ger√§te und Android = &lt;6-Versionen wissen nicht, wie Systemzertifikate verwendet werden.  Daher erstellen wir f√ºr sie eine separate Instanz von eap-guest mit selbstsignierten Zertifikaten.  F√ºr alle anderen Ger√§te verwenden wir eap-client mit einem vertrauensw√ºrdigen Zertifikat.  Der Benutzername wird durch das Feld Anonym bestimmt, wenn das Ger√§t angeschlossen ist.  Es sind nur 3 Werte zul√§ssig: Gast, Client und leeres Feld.  Der Rest wird verworfen.  Dies ist in den Richtlinien konfiguriert.  Ich werde sp√§ter ein Beispiel geben <br></div></div><br>  Bearbeiten Sie autorisierte Abschnitte und authentifizieren Sie sie im <i><b>Site-f√§higen / inneren Tunnel</b></i> <br><br><div class="spoiler">  <b class="spoiler_title">Site-f√§hig / Innentunnel</b> <div class="spoiler_text"><pre> <code class="bash hljs">authorize { filter_username filter_inner_identity update control { &amp;Proxy-To-Realm := LOCAL } ldap <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((ok || updated) &amp;&amp; User-Password) { update { control:Auth-Type := ldap } } expiration digest logintime pap } authenticate { Auth-Type eap-guest { eap-guest } Auth-Type eap-client { eap-client } Auth-Type PAP { pap } ldap }</code> </pre> <br></div></div><br>  Als N√§chstes m√ºssen Sie in den Richtlinien angeben, welche Namen f√ºr die anonyme Anmeldung verwendet werden k√∂nnen.  Bearbeiten Sie <b><i>policy.d / filter</i></b> . <br><br>  Sie m√ºssen √§hnliche Zeilen finden: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (&amp;outer.request:User-Name !~ /^(anon|@)/) { update request { Module-Failure-Message = <span class="hljs-string"><span class="hljs-string">"User-Name is not anonymized"</span></span> } reject }</code> </pre> <br>  Und unten in elsif f√ºgen Sie die notwendigen Werte hinzu: <br><br><pre> <code class="bash hljs">elsif (&amp;outer.request:User-Name !~ /^(guest|client|@)/) { update request { Module-Failure-Message = <span class="hljs-string"><span class="hljs-string">"User-Name is not anonymized"</span></span> } reject }</code> </pre> <br>  Jetzt m√ºssen wir in das Verzeichnis <b><i>certs wechseln</i></b> .  Hier m√ºssen Sie den Schl√ºssel und das Zertifikat von einer vertrauensw√ºrdigen Zertifizierungsstelle ablegen, die wir bereits haben, und m√ºssen selbstsignierte Zertifikate f√ºr eap-guest generieren. <br><br>  √Ñndern Sie die Parameter in der Datei <b><i>ca.cnf</i></b> . <br><br><div class="spoiler">  <b class="spoiler_title">ca.cnf</b> <div class="spoiler_text"><pre> <code class="bash hljs">... default_days = 3650 default_md = sha256 ... input_password = blablabla output_password = blablabla ... countryName = RU stateOrProvinceNmae = State localityNmae = City organizationName = NONAME emailAddress = admin@admin.ru commonName = <span class="hljs-string"><span class="hljs-string">"CA FreeRadius"</span></span></code> </pre> <br></div></div><br>  Die gleichen Werte sind in der Datei <b><i><i>server.cnf</i></i></b> angegeben.  Wir √§ndern uns nur <br>  <b>commonName</b> : <br><br><div class="spoiler">  <b class="spoiler_title">server.cnf</b> <div class="spoiler_text"><pre> <code class="bash hljs">... default_days = 3650 default_md = sha256 ... input_password = blablabla output_password = blablabla ... countryName = RU stateOrProvinceNmae = State localityNmae = City organizationName = NONAME emailAddress = admin@admin.ru commonName = <span class="hljs-string"><span class="hljs-string">"Server Certificate FreeRadius"</span></span></code> </pre> <br></div></div><br>  Wir schaffen: <br><br><pre> <code class="bash hljs">make</code> </pre> <br>  Fertig.  Die resultierende <b><i>server.crt</i></b> und <b><i>server.key</i></b> sind bereits oben in eap-guest registriert. <br><br>  Zuletzt f√ºgen Sie unsere Zugangspunkte zur Datei <b><i>client.conf hinzu</i></b> .  Ich habe sie 7. Um nicht jeden Punkt einzeln hinzuzuf√ºgen, registrieren wir nur das Netzwerk, in dem sie sich befinden (meine Zugangspunkte befinden sich in einem separaten VLAN). <br><br><pre> <code class="bash hljs">client APs { ipaddr = 192.168.100.0/24 password = password_AP }</code> </pre> <br><h2>  Ubiquiti-Controller </h2><br>  Auf dem Controller erheben wir ein separates Netzwerk.  Sei es 192.168.2.0/24 <br>  Gehen Sie zu Einstellungen -&gt; Profil.  Erstellen Sie eine neue: <br><br><img src="https://habrastorage.org/webt/n4/mj/_s/n4mj_shukldt1eogoqnpphaal3e.png"><br><br>  Wir schreiben die Adresse und den Port des Radius-Servers und das Passwort, die in der Datei <b><i>clients.conf</i></b> registriert wurden: <br><br><img src="https://habrastorage.org/webt/6x/8e/km/6x8ekm2bbnrzghk0rv5qbdggnam.png"><br><br>  Erstellen Sie einen neuen drahtlosen Namen.  W√§hlen Sie als Authentifizierungsmethode WPA-EAP (Enterprise) aus und geben Sie das erstellte Radiusprofil an: <br><br><img src="https://habrastorage.org/webt/5i/ku/9n/5iku9n_j-r3fqsxvppyekim8aqi.png"><br><br>  Wir speichern, bewerben und gehen weiter. <br><br><h2>  Kundeneinrichtung </h2><br>  Beginnen wir mit dem Schwierigsten! <br><br><h3>  Windows 10 </h3><br>  Die Komplexit√§t beruht auf der Tatsache, dass Windows immer noch keine Verbindung zum Unternehmens-WLAN √ºber die Dom√§ne herstellen kann.  Daher m√ºssen Sie unser Zertifikat manuell in den Trust Store hochladen.  Hier k√∂nnen Sie sowohl selbstsigniert als auch von einer Zertifizierungsstelle verwenden.  Ich werde den zweiten verwenden. <br><br>  Als N√§chstes m√ºssen Sie eine neue Verbindung erstellen.  Gehen Sie dazu zu den Netzwerk- und Interneteinstellungen -&gt; Netzwerk- und Freigabecenter -&gt; Neue Verbindung oder neues Netzwerk erstellen und konfigurieren: <br><br><img src="https://habrastorage.org/webt/7d/9e/ix/7d9eixr7yfn94zmiv56f1kqpm_o.png"><br><br><img src="https://habrastorage.org/webt/-z/iy/dp/-ziydpjwwwqxkgisvkxmj4kpfse.png"><br><br><img src="https://habrastorage.org/webt/jg/hd/w3/jghdw32jkf-d-9gxs71ca2o-q9y.png"><br><br>  Registrieren Sie den Netzwerknamen manuell und √§ndern Sie die Art der Sicherheit.  Nachdem wir auf " <i>Verbindungseinstellungen √§ndern" geklickt haben</i> und im Abschnitt "Sicherheit" die Netzwerkauthentifizierung - EAP-TTLS - ausw√§hlen. <br><br><img src="https://habrastorage.org/webt/gq/tg/x6/gqtgx6svylvh5sqmxrcjmovj-10.png"><br><br><img src="https://habrastorage.org/webt/kn/7l/a8/kn7la8fhk6a2fh8vkjtwvsji1gu.png"><br><br><img src="https://habrastorage.org/webt/y1/tl/gv/y1tlgv2-xbwqn-lcupnyiwpxz3s.png"><br><br>  Wir gehen auf die Parameter ein, schreiben den Authentifizierungs-Datenschutz- <b>Client vor</b> .  Als vertrauensw√ºrdige Zertifizierungsstelle w√§hlen wir das Zertifikat aus, das wir hinzugef√ºgt haben, aktivieren das Kontrollk√§stchen "Geben Sie dem Benutzer keine Einladung, wenn der Server nicht autorisiert werden kann" und w√§hlen Sie die Authentifizierungsmethode - unverschl√ºsseltes Kennwort (PAP). <br><br><img src="https://habrastorage.org/webt/5x/ww/3j/5xww3jjmvmf1rhkdxcqvoxh0l18.png"><br><br>  Gehen Sie als N√§chstes zu den zus√§tzlichen Parametern und aktivieren Sie das Kontrollk√§stchen "Authentifizierungsmodus angeben".  W√§hlen Sie den Punkt "Benutzerauthentifizierung" und klicken Sie auf <i>Anmeldeinformationen speichern</i> .  Hier m√ºssen Sie username_ldap und password_ldap eingeben <br><br><img src="https://habrastorage.org/webt/e5/lv/xu/e5lvxualbxusv6ksq1iqwhiodyi.png"><br><br><img src="https://habrastorage.org/webt/om/he/tc/omhetcqvchjagt5mcqjo_e5hq0m.png"><br><br><img src="https://habrastorage.org/webt/2p/ni/oc/2pniocysbjtvvzgoa5yqw5ahl_g.png"><br><br>  Wir speichern, bewerben, schlie√üen alles.  Sie k√∂nnen eine Verbindung zum neuen Netzwerk herstellen. <br><br><h3>  Linux </h3><br>  Ich habe auf Ubuntu 18.04, 18.10, Fedora 29, 30 getestet. <br><br>  Laden Sie zun√§chst ein Zertifikat herunter.  Ich habe unter Linux nicht gefunden, ob es m√∂glich ist, Systemzertifikate zu verwenden und ob es dort √ºberhaupt einen solchen Speicher gibt. <br><br>  Wir werden uns nach Domain verbinden.  Daher ben√∂tigen Sie ein Zertifikat des Zertifizierungszentrums, von dem unser Zertifikat erworben wurde. <br><br>  Alle Verbindungen werden in einem Fenster hergestellt.  W√§hlen Sie unser Netzwerk: <br><br><img src="https://habrastorage.org/webt/_b/bv/ks/_bbvksnhgramkno1xteuugeiicu.png"><br><br>  <i>anonym - Client</i> <i><br></i>  <i>Domain - Domain, f√ºr die das Zertifikat ausgestellt wurde</i> <i><br></i> <br><h3>  Android </h3><br><h4>  Nicht-Samsung </h4><br>  Ab Version 7 k√∂nnen Sie beim Herstellen einer WLAN-Verbindung Systemzertifikate verwenden, indem Sie nur die Dom√§ne angeben: <br><br><img src="https://habrastorage.org/webt/ft/ma/cl/ftmaclvd6hgnr6l61f1ntqx4pho.png"><br><br>  <i>Domain - Domain, f√ºr die das Zertifikat ausgestellt wurde</i> <i><br></i>  <i>anonym - Client</i> <i><br></i> <br><h4>  Samsung </h4><br>  Wie bereits oben erw√§hnt, wissen Samsung-Ger√§te nicht, wie Systemzertifikate beim Herstellen einer WLAN-Verbindung verwendet werden, und sie k√∂nnen keine Verbindung nach Dom√§ne herstellen.  Daher m√ºssen Sie das Stammzertifikat der Zertifizierungsstelle manuell hinzuf√ºgen (ca.pem, wir nehmen es auf dem Radius-Server).  Hier wird selbstsigniert verwendet. <br><br>  Laden Sie das Zertifikat auf Ihr Ger√§t herunter und installieren Sie es. <br><br><div class="spoiler">  <b class="spoiler_title">Installation des Zertifikats</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/jw/vn/p6/jwvnp6k3hcvgr_-sxahbjjfwuma.png"><br><br><img src="https://habrastorage.org/webt/vw/-u/2c/vw-u2crpfqhzv2hewbw4fvcm0k8.png"><br><br><img src="https://habrastorage.org/webt/fn/n-/i6/fnn-i6gkkzzt6w9hxjpv5fgo_sk.png"><br><br><img src="https://habrastorage.org/webt/xk/pc/-2/xkpc-2wufsgnckjexjhmiv79avy.png"><br><br>  In diesem Fall m√ºssen Sie das Muster zum Entsperren des Bildschirms, den PIN-Code oder das Kennwort festlegen, falls es noch nicht installiert ist: <br><br><img src="https://habrastorage.org/webt/_w/aa/px/_waapxwklsloxwpvo3oe8mrdwek.png"><br><br><img src="https://habrastorage.org/webt/v6/nx/k1/v6nxk1ts6ej-j8sffb1kpqfx9ae.png"><br><br>  <i>Ich habe eine komplizierte Version der Zertifikatsinstallation gezeigt.</i>  <i>Klicken Sie auf den meisten Ger√§ten einfach auf das heruntergeladene Zertifikat.</i> <br></div></div><br>  Wenn das Zertifikat installiert ist, k√∂nnen Sie mit der Verbindung fortfahren: <br><br><img src="https://habrastorage.org/webt/rr/9l/vx/rr9lvx4jov8ohepj-hetehl4g1s.png"><br><br>  <i>Zertifikat - Geben Sie das installierte Zertifikat an</i> <i><br></i>  <i>anonymer Benutzer - Gast</i> <i><br></i> <br><h3>  macOS </h3><br>  Sofort einsatzbereite Apple-Ger√§te k√∂nnen nur eine Verbindung zu EAP-TLS herstellen, Sie m√ºssen jedoch noch ein Zertifikat an sie senden.  Um eine andere Verbindungsmethode anzugeben, m√ºssen Sie Apple Configurator 2 verwenden. Dementsprechend m√ºssen Sie diese zuerst auf die Mohnblume herunterladen, ein neues Profil erstellen und alle erforderlichen WLAN-Einstellungen hinzuf√ºgen. <br><br><div class="spoiler">  <b class="spoiler_title">Apple Konfigurator</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/tg/mj/zi/tgmjzi_qpkrel011yzj5q5h23qs.png"><br><br><img src="https://habrastorage.org/webt/dw/dd/dl/dwdddlobqibczjpygjt1f-cnbp8.png"><br><br>  <i>Hier geben wir den Namen Ihres Netzwerks an</i> <i><br></i>  <i>Sicherheitstyp - WPA2 Enterprise</i> <i><br></i>  <i>Akzeptierte EAP-Typen - TTLS</i> <i><br></i>  <i>Benutzername und Passwort - leer lassen</i> <i><br></i>  <i>Innere Authentifizierung - PAP</i> <i><br></i>  <i>√Ñu√üere Identit√§t - Client</i> <i><br></i> <br><br>  <i>Registerkarte "Vertrauen".</i>  <i>Hier geben wir unsere Domain an</i> <br><br>  Das ist alles.  Ein Profil kann gespeichert, signiert und an Ger√§te verteilt werden <br></div></div><br>  Nachdem das Profil fertig ist, muss es auf die Mohnblume heruntergeladen und installiert werden.  W√§hrend des Installationsvorgangs m√ºssen Sie den Benutzer usernmae_ldap und password_ldap angeben: <br><br><img src="https://habrastorage.org/webt/_z/um/7m/_zum7mpbqlszgaq5d9cm6k7-why.png"><br><br><img src="https://habrastorage.org/webt/hb/iq/ig/hbiqigx3cy7zdklsbnx22zmb0e4.png"><br><br><img src="https://habrastorage.org/webt/u4/tb/-8/u4tb-8v3jbt9t5gs9zz9tplbnt0.png"><br><br><h3>  iOS </h3><br>  Der Prozess ist √§hnlich wie bei macOS.  Sie m√ºssen ein Profil verwenden (Sie k√∂nnen genauso wie unter macOS. So erstellen Sie ein Profil in Apple Configurator, siehe oben). <br><br>  Laden Sie das Profil herunter, installieren Sie es, geben Sie die Anmeldeinformationen ein und verbinden Sie sich: <br><br><img src="https://habrastorage.org/webt/pi/gx/3m/pigx3mjskrdwyuk07xs0m6zh-v4.png"><br><br><img src="https://habrastorage.org/webt/y9/hk/6g/y9hk6gm7k5jkdrvms-stzkdmu9s.png"><br><br><img src="https://habrastorage.org/webt/ie/xt/a-/iexta-krrvub6rrozdvmk7adh_s.png"><br><br><img src="https://habrastorage.org/webt/ej/oo/wj/ejoowjqmtjojl31jmau1z3np7mi.png"><br><br><img src="https://habrastorage.org/webt/pw/s4/en/pws4enrdkqc97p009eglr3wpiy0.png"><br><br><img src="https://habrastorage.org/webt/zj/z_/5f/zjz_5f7hqthgj52z_nnigigrcm4.png"><br><br>  Das ist alles.  Wir haben einen Radius-Server eingerichtet, ihn mit FreeIPA synchronisiert und Ubiquiti Access Points angewiesen, WPA2-EAP zu verwenden. <br><br><h2>  M√∂gliche Fragen </h2><br>  <b>F:</b> Wie √ºbertrage ich ein Profil / Zertifikat an einen Mitarbeiter? <br><br>  <b>A:</b> Alle Zertifikate / Profile, die ich auf FTP mit Zugriff √ºber das Web speichere.  Es wurde ein Gastnetzwerk mit einer Geschwindigkeitsbegrenzung und nur Internetzugang erstellt, mit Ausnahme von FTP. <br>  Die Authentifizierung dauert 2 Tage. Danach wird sie zur√ºckgesetzt und der Client bleibt ohne Internet.  T.O.  Wenn ein Mitarbeiter eine Verbindung zu WLAN herstellen m√∂chte, stellt er zun√§chst eine Verbindung zum Gastnetzwerk her, besucht FTP, l√§dt das ben√∂tigte Zertifikat oder Profil herunter, installiert sie und kann dann eine Verbindung zum Unternehmensnetzwerk herstellen. <br><br>  <b>F:</b> Warum nicht ein Schema mit MSCHAPv2 verwenden?  Sie ist sicherer! <br><br>  <b>A:</b> Erstens funktioniert ein solches Schema gut unter NPS (Windows Network Policy System). In unserer Implementierung ist es erforderlich, zus√§tzlich LDAP (FreeIpa) zu konfigurieren und Kennwort-Hashes auf dem Server zu speichern.  Hinzuf√ºgen.  Einstellungen sind nicht ratsam, weil  Dies kann zu verschiedenen Problemen bei der Synchronisation von Ultraschall f√ºhren.  Zweitens ist der Hash MD4, was die Sicherheit nicht wirklich erh√∂ht. <br><br>  <b>F: Ist</b> es m√∂glich, Ger√§te √ºber Mac-Adressen zu autorisieren? <br><br>  <b>A:</b> NEIN, dies ist nicht sicher, ein Angreifer kann Mohnadressen f√§lschen, und au√üerdem wird die Autorisierung f√ºr Mohnadressen auf vielen Ger√§ten nicht unterst√ºtzt <br><br>  <b>F:</b> Warum alle diese Zertifikate verwenden?  Sie k√∂nnen ohne sie verbinden <br><br>  <b>A:</b> Zertifikate werden verwendet, um den Server zu autorisieren.  Das hei√üt,  Wenn das Ger√§t verbunden ist, pr√ºft es, ob der Server vertrauensw√ºrdig ist oder nicht.  Wenn dies der Fall ist, geht die Authentifizierung weiter. Wenn nicht, wird die Verbindung geschlossen.  Sie k√∂nnen eine Verbindung ohne Zertifikate herstellen. Wenn jedoch ein Angreifer oder ein Nachbar einen Radius-Server und einen Zugriffspunkt mit demselben Namen wie unseren abholt, kann er Benutzeranmeldeinformationen problemlos abfangen (vergessen Sie nicht, dass diese im Klartext √ºbertragen werden).  Und wenn das Zertifikat verwendet wird, sieht der Feind in unseren Protokollen nur unseren fiktiven Benutzernamen - Gast oder Client und einen Fehler vom Typ - Unbekanntes CA-Zertifikat <br><br><div class="spoiler">  <b class="spoiler_title">mehr √ºber macOS</b> <div class="spoiler_text">  Unter macOS erfolgt die Neuinstallation des Systems normalerweise √ºber das Internet.  Im Wiederherstellungsmodus muss die Mohnblume mit WLAN verbunden sein, und hier funktionieren weder unser Unternehmens-WLAN noch das Gastnetzwerk.  Pers√∂nlich habe ich ein anderes Netzwerk, das √ºbliche WPA2-PSK, versteckt, nur f√ºr technische Operationen.  Oder Sie k√∂nnen im Voraus ein bootf√§higes USB-Flash-Laufwerk mit dem System erstellen.  Aber wenn die Mohnblume nach 2015, m√ºssen Sie noch einen Adapter f√ºr dieses Flash-Laufwerk finden) <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de463225/">https://habr.com/ru/post/de463225/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de463205/index.html">Zun√§chst nicht funktionsf√§hig: Wie man mit einem Laptop unter Windows 10 und einem 32-Gigabyte-Laufwerk √ºberlebt</a></li>
<li><a href="../de463207/index.html">Chatbot-Entwicklung (Telegramm + Youtube)</a></li>
<li><a href="../de463215/index.html">Ingenieure und Architekten entwerfen bereits Mond-Siedlungen</a></li>
<li><a href="../de463221/index.html">Beobachten der Sonne: 5 Arten von Ger√§ten, von 5 bis 5.000 US-Dollar</a></li>
<li><a href="../de463223/index.html">Die Zusammenfassung interessanter Materialien f√ºr den mobilen Entwickler # 310 (vom 5. bis 11. August)</a></li>
<li><a href="../de463227/index.html">Probleml√∂sung mit pwnable.kr 19 - Verkn√ºpfung aufheben. Heap-Puffer√ºberlauf</a></li>
<li><a href="../de463229/index.html">Jetpacks in Kultur: Kino</a></li>
<li><a href="../de463231/index.html">Schulung Cisco 200-125 CCNA v3.0. Tag 14. VTP, Bereinigen und natives VLAN</a></li>
<li><a href="../de463233/index.html">Schulung Cisco 200-125 CCNA v3.0. Tag 15. Langsame Kommunikation und Port-Sicherheit</a></li>
<li><a href="../de463237/index.html">Wie wir Musik mit neuronalen Netzen v 2.0 gespielt haben</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>