<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçú üë©üèø‚Äçüíº üõµ Takashi Kokubun: comment acc√©l√©rer l'ex√©cution des applications Ruby üßë ‚ôèÔ∏è üë®üèº‚Äçü§ù‚Äçüë®üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La conf√©rence sur le rubis central russe du 28 septembre marque 10 ans. Cette ann√©e, RubyRussia a un nouveau lieu, autant que 4 flux de rapports s√©lec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Takashi Kokubun: comment acc√©l√©rer l'ex√©cution des applications Ruby</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/railsclub/blog/466305/"> La conf√©rence sur le rubis central russe du 28 septembre marque 10 ans.  Cette ann√©e, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RubyRussia a un</a> nouveau lieu, autant que 4 flux de rapports s√©lectionn√©s, la communication et, bien s√ªr, l'after-party l√©gendaire!  Parmi les conf√©renciers, il y a Yukihiro Matsumoto, Takashi Kokubun, Xavier Noria, Nick Sutterer, Genadi Samokovarov et plus encore! <br><br>  En pr√©paration, nous discutons avec des conf√©renciers de Ruby, du travail et de la vie.  Aujourd'hui, nous publions du mat√©riel dans lequel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dmitry Matveyev</a> (chef de projet √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Evrone</a> ) pose des questions √† <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Takashi Kokubun</a></b> . <br><br><img src="https://habrastorage.org/webt/ld/5d/ea/ld5deappknbod3tlj0kruqrj9d8.jpeg" alt="image"><br>  <i>Le haut-parleur RubyRussia 2019, un optimiseur pour le compilateur Ruby JIT, prend en charge Haml et ERB, un ing√©nieur backend pour ArmTreasure Data.</i> <br><a name="habracut"></a><br>  <b>Dites-moi ce qui sera discut√© dans votre rapport lors de la conf√©rence?</b> <br><br>  √Ä propos du travail sur le compilateur JIT.  Je voudrais me concentrer sur trois points.  Le premier est la fonction inline.  La fonction doit √™tre ¬´propre¬ª, sans effets secondaires, afin que son corps puisse √™tre en ligne.  S'il y a trop de fonctions, le compilateur commence √† fonctionner lentement.  Je vais d√©crire comment r√©soudre ce probl√®me. <br>  Le deuxi√®me point concerne l'optimisation du placement des objets en m√©moire.  Dans les applications volumineuses et complexes comme Rails, vous devez cr√©er de nombreux objets en une seule demande.  Si vous optimisez ce processus, vous pouvez am√©liorer les performances.  Habituellement, les objets sont cr√©√©s dans le tas.  Par cons√©quent, vous devez y g√©rer des structures de donn√©es complexes.  Vous devez √©galement appeler le garbage collector pour supprimer les objets inutilis√©s.  Et si nous devions placer des objets sur la pile, nous augmenterions simplement le pointeur de la pile lors de l'ajout d'un objet et le diminuerions lorsque l'objet doit √™tre supprim√©.  L'utilisation de la pile pour stocker des objets est plus rapide en soi, et le garbage collector commence √† fonctionner plus rapidement.  Mais pour utiliser la pile, nous devons nous assurer que les objets ne sont pas utilis√©s ailleurs.  Pour cela, nous utilisons une technique appel√©e ¬´analyse d'√©chappement¬ª.  Nous devons analyser chaque m√©thode et nous assurer que chacun de ses objets internes n'est pas utilis√© en externe et n'est pas renvoy√© comme r√©sultat de la m√©thode actuelle.  Si nous pouvons le faire, nous pouvons placer des objets sur la pile, ce qui augmentera la productivit√©.  Mon id√©e est d'ajouter des m√©tadonn√©es pour les instructions.  Maintenant, c'est une exp√©rience, mais je vais faire une demande de pull au ma√Ætre avec ce code dans un proche avenir. <br><br>  Le troisi√®me point concerne l'optimisation de la r√©partition des appels de fonction dans JIT.  Actuellement, ce processus g√©n√®re une forte ramification de la logique, ce qui affecte n√©gativement le m√©canisme de pr√©diction de branche du processeur.  Cela ralentit le processeur dans son ensemble.  Nous devons simplifier cette logique, c'est-√†-dire r√©duire le nombre de conditions.  J'examine actuellement comment faire cela. <br><br>  <b>Ceci est un rapport hardcore avec beaucoup de code et de concepts!</b>  <b>Cela semble difficile?</b> <br><br>  Je pense que la plupart des gens n'impl√©mentent pas de compilateurs par eux-m√™mes, et je comprends que comprendre cela peut √™tre difficile.  Mais je vais essayer de tout expliquer le plus simplement possible avec des exemples et des illustrations.  Autrement dit, mon rapport devrait √™tre compr√©hensible pour les personnes sans exp√©rience particuli√®re dans le d√©veloppement de compilateurs. <br><br>  <b>Est-il possible d'utiliser le nouveau compilateur en production maintenant, et dans quels cas?</b> <br><br>  L'id√©e est de rendre les applications RoR plus rapides.  Par exemple, mon entreprise actuelle en b√©n√©ficiera.  Mais je ne dirais pas que tout est pr√™t pour la production.  Il s'est av√©r√© que seules les applications RoR ne sont pas particuli√®rement acc√©l√©r√©es.  En effet, ces applications sont g√©n√©ralement volumineuses et g√©n√®rent beaucoup de code C, ce qui conduit √† une utilisation inefficace de la mise en cache dans le processeur.  J'ai quelques id√©es sur la fa√ßon de r√©soudre ce probl√®me.  C'est ce sur quoi je travaille en ce moment.  Mais maintenant, mon compilateur peut √™tre utile pour les petites applications.  Par exemple, je sais que la gemme karafka fonctionne plus vite avec elle que sans elle. <br><br>  <b>J'ai lu que le compilateur JIT est d√©j√† vers√© dans le ma√Ætre de brunch en langage Ruby et est disponible depuis la version 2.6.</b>  <b>En est-il ainsi?</b> <br><br>  Oui, ma demande de fusion a d√©j√† √©t√© accept√©e.  Mais c'est la premi√®re version, et beaucoup de travail reste √† faire.  Des am√©liorations seront d√©j√† pr√©sentes dans Ruby 2.7, et encore plus dans Ruby 3. <br><br>  <b>Dites-moi comment vous avez commenc√© √† √©crire en Ruby?</b> <br><br>  Au d√©but, je travaillais avec Objective-C, mais je n'aimais pas vraiment √ßa.  Une fois qu'il √©tait n√©cessaire d'√©crire une application dorsale, des amis ont recommand√© d'essayer Ruby On Rails.  C'est exactement ce que j'ai fait - et j'√©tais tr√®s satisfait du r√©sultat!  J'ai aim√© la syntaxe simple et compr√©hensible de la langue, et j'ai commenc√© √† l'√©tudier et √† l'utiliser plus profond√©ment. <br><br>  <b>√ätes-vous en train d'√©crire en Ruby au travail?</b> <br><br>  Je travaille avec Treasure Data depuis quelques ann√©es.  Il s'agit d'une plate-forme qui suit les donn√©es des utilisateurs dans les applications clientes.  Ce projet a √©t√© √† l'origine √©crit en Ruby On Rails, et mon message s'appelait "Ruby Developer".  J'ai donc beaucoup √©crit en Ruby.  Mais maintenant, je travaille sur certains services distribu√©s √©crits en Java et Kotlin, et j'utilise aussi parfois Python. <br><br>  <b>Le projet Treasure Data est associ√© √† une charge √©lev√©e et √† des m√©gadonn√©es.</b>  <b>Mais Ruby n'est pas la langue la plus rapide.</b>  <b>Comment avez-vous r√©ussi √† cr√©er une application √† haute charge qui fonctionne avec des donn√©es volumineuses sur la plate-forme RoR?</b> <br><br>  L'application enregistre les donn√©es utilisateur et les enregistre dans le stockage.  Il fournit √©galement une interface pour interroger des donn√©es dans des langues comme Hive et Presto, et un panneau d'administration.  Ce n'√©tait pas un probl√®me de tout √©crire sur des rails.  De plus, nous avons cr√©√© une infrastructure comp√©tente et avons la capacit√© d'augmenter les ressources de m√©moire et de processeur aux pics de charge.  Le principal probl√®me que nous avons avec Ruby est qu'il ne convient pas au calcul parall√®le.  Et nous devons utiliser Kotlin √† cet effet. <br><br>  <b>Pourquoi aimez-vous Ruby?</b>  <b>S'il y avait un projet qui pourrait √™tre impl√©ment√© √† la fois en Ruby et en Python, lequel choisiriez-vous?</b> <br><br>  J'aime la syntaxe propre de Ruby, elle est tr√®s lisible et intuitive.  Cela vous permet d'√©crire rapidement et facilement la logique d'application, ce qui est important d'un point de vue commercial.  C'est un langage purement objet, je l'appr√©cie vraiment.  J'ai de l'exp√©rience en Python, mais cela ne me semble pas aussi intuitif.  Je le choisirais uniquement pour les projets d'apprentissage automatique. <br><br>  <b>Une autre chose sur laquelle vous avez travaill√© r√©cemment est le moteur de mod√®le Haml ...</b> <br><br>  J'ai travaill√© sur Haml et ERB √† un emploi pr√©c√©dent.  Maintenant, je ne consacre pas trop de temps √† cela, mais parfois je regarde les pull-quests dans ces projets. <br><br>  <b>Que pensez-vous des perspectives des moteurs de mod√®les tels que Haml, Slim ou ERB, en g√©n√©ral, √©tant donn√© que dans le monde moderne, il y a une tendance √† s√©parer compl√®tement l'arri√®re et l'avant en deux applications diff√©rentes, et √† donner la formation de pages HTML compl√®tement √† JavaScript?</b>  <b>Autrement dit, dans une telle configuration, les moteurs de mod√®les deviennent compl√®tement inutiles?</b> <br><br>  Je suis d'accord que pour les t√¢ches avec une interface utilisateur complexe, il est logique de mettre cette logique dans une application distincte.  Cela doit √™tre fait afin de rivaliser avec d'autres entreprises, qui augmentent de plus en plus la complexit√© et la fonctionnalit√© de l'interface utilisateur.  Mais il y a toujours un besoin de solutions plus simples et, plus important encore, moins co√ªteuses qui ont du sens pour √©crire sur RoR avec des moteurs de mod√®les classiques.  Ainsi, ils sont toujours en fonctionnement et seront utilis√©s pendant longtemps. <br><br>  <b>Je vois que vous pouvez programmer dans de nombreux langages, au moins en Ruby, Python, Java, Kotlin et C. Un bon ensemble.</b>  <b>Pouvez-vous donner des conseils aux d√©butants sur la fa√ßon d'apprendre autant de langues?</b>  <b>Comment devenir un bon programmeur?</b> <br><br>  Je pense que l'efficacit√© de la formation sera √©lev√©e lorsque la langue sera adapt√©e aux t√¢ches auxquelles est confront√© un programmeur.  Ruby est bon pour √©crire des applications Web, car travailler avec des cha√Ænes est tr√®s facile par rapport √† Java.  Python est plus adapt√© √† l'apprentissage automatique (il dispose d'une infrastructure riche dans ce domaine).  Si vous voulez apprendre Python, je recommanderais de r√©soudre des t√¢ches d'apprentissage automatique plut√¥t que d'√©crire des applications Web.  Si vous √™tes plus int√©ress√© par Java, Kotlin ou d'autres langages bas√©s sur JVM, je sugg√®re d'√©crire des syst√®mes distribu√©s.  Ruby n'est actuellement pas bien adapt√© √† l'informatique exigeante ou parall√®le.  Pour r√©soudre de tels probl√®mes dans Ruby, nous avons besoin de nombreux processus qui consomment beaucoup de ressources, donc ils ne seront pas efficaces.  Ainsi, l'utilisation d'outils appropri√©s pour les probl√®mes pertinents aidera √† comprendre pourquoi cet outil est con√ßu de cette mani√®re.  Cela aidera √† mieux comprendre son essence. <br><br>  <b>Quels livres sont en haut de votre ¬´note¬ª personnelle?</b> <br><br>  Le premier est Ruby sous un microscope.  Il est √©crit tr√®s simplement et d√©crit les d√©tails de l'interpr√®te.  Une compr√©hension approfondie du fonctionnement de l'interpr√®te aidera √† r√©soudre des probl√®mes complexes et renforcera √©galement la confiance dans la propri√©t√© de l'outil, c'est-√†-dire  la langue.  Je recommande ce livre m√™me aux d√©butants. <br><br>  Le second est ¬´Code lisible¬ª.  Il s'agit de savoir comment √©crire du code clair, curieusement :).  Nous √©crivons beaucoup de code et lisons beaucoup de code, et nous devons √™tre capables d'√©crire du code que les autres comprendront.  Et pour cela, nous devons regarder le code sous l'angle de la perception de quelqu'un d'autre.  Des livres comme celui-ci aident.  Je le recommande √©galement m√™me aux d√©butants.  Eh bien, le troisi√®me livre ... C'est un livre en japonais, sur la fa√ßon dont le processeur est organis√©, sur son architecture, jusqu'aux transistors qui le composent.  Comprendre comment un ordinateur fonctionne √† un niveau aussi bas est parfois tr√®s utile m√™me lors de la r√©solution de probl√®mes √† des niveaux beaucoup plus √©lev√©s.  Je recommande de lire tout bon livre sur la conception des microprocesseurs, m√™me si √† premi√®re vue cela ne semble pas √©vident. <br><br>  <b>Qu'attendez-vous de la Russie et de la conf√©rence <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RubyRussia</a></b> ? <br><br>  Je ne suis jamais all√© en Russie auparavant.  Je m'attends √† voir beaucoup de tout beau, par exemple, de belles maisons, de beaux paysages ... De plus, en Russie, il devrait faire plus froid qu'au Japon.  Il sera int√©ressant pour moi de voir et de ressentir toutes ces diff√©rences entre nos pays. <br><br>  <b>Cool!</b>  <b>Je peux vous assurer que m√™me s'il fait froid (en fait, fin septembre il ne fait pas si froid avec nous), la conf√©rence et l'after-party seront quand m√™me chauds!</b> <br><br>  Nous vous attendons √©galement √† la conf√©rence!  Vous pouvez poser vos questions en personne (et √† la l√©gendaire afterparty :) le 28 septembre.  Le programme est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">l√†</a> et le billet co√ªte maintenant 9 000 roubles. <br><br>  Merci aux entreprises qui soutiennent <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RubyRussia</a> : <br><br>  Organisateur - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Evrone</a> <br>  Associ√© commandit√© - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Toptal</a> <br>  Partenaire Gold - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Gett</a> <br>  Partenaires Silver - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">JetBrains</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Bookmate</a> <br>  Partenaire Bronze - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">InSales</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr466305/">https://habr.com/ru/post/fr466305/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr466289/index.html">Initiatives l√©gislatives. √âtrange, mais pr√©sent√© √† la Douma d'√âtat</a></li>
<li><a href="../fr466291/index.html">Enqu√™te de durabilit√© des segments Internet nationaux pour 2019</a></li>
<li><a href="../fr466295/index.html">Cache de secours indolore sur Scala</a></li>
<li><a href="../fr466299/index.html">Des sociologues russes ont men√© le premier sondage mondial sur les chatbots</a></li>
<li><a href="../fr466301/index.html">Autre chose: des packages d'application Haiku?</a></li>
<li><a href="../fr466307/index.html">Comment concevoir SCS</a></li>
<li><a href="../fr466311/index.html">Atelier SLS 6 septembre</a></li>
<li><a href="../fr466315/index.html">@Pythonetc compilation, ao√ªt 2019</a></li>
<li><a href="../fr466317/index.html">Trucs et astuces de ma cha√Æne Telegram @pythonetc, ao√ªt 2019</a></li>
<li><a href="../fr466319/index.html">Deal: VMware ach√®te une startup bas√©e sur le cloud</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>