<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëä ‚ñ∂Ô∏è üö∏ Fuzzing im 2000er-Stil in modernen Windows 10-Anwendungen üåé üå©Ô∏è üé≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Abb. 1. Gequetscht, aber nicht gebrochen. Der Windows-Rechner, dessen Code k√ºrzlich auf Github ver√∂ffentlicht wurde , erwies sich als eine von zwei ge...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Fuzzing im 2000er-Stil in modernen Windows 10-Anwendungen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451816/"><img src="https://habrastorage.org/getpro/habr/post_images/cb6/3b4/ca2/cb63b4ca2a435ac151253934fcb775b6.png"><br>  <i><font color="gray">Abb.</font></i>  <i><font color="gray">1. Gequetscht, aber nicht gebrochen.</font></i>  <i><font color="gray">Der Windows-Rechner, dessen Code k√ºrzlich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">auf Github ver√∂ffentlicht wurde</a> , erwies sich als eine von zwei getesteten Anwendungen, die nicht h√§ngen blieben und nicht im Gegensatz zu dem im Jahr 2000 entwickelten Fuzzer von Fenstermeldungen standen.</font></i>  <i><font color="gray">Die Fenstergr√∂√üe wurde speziell vergr√∂√üert, um unscharfe Artefakte anzuzeigen</font></i> <br><br>  Es ist Zeit f√ºr den zweiten Teil unserer Bem√ºhungen, alte Fuzzing-Techniken auf modernen Systemen zu testen.  Wenn Sie verpasst haben, ist hier der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erste Teil</a> .  Dieses Mal werden wir Windows 10 mithilfe von Fuzzing-Techniken aus dem im Jahr 2000 ver√∂ffentlichten Artikel ‚ÄûEmpirische Untersuchung der Zuverl√§ssigkeit von Windows NT-Anwendungen mithilfe von Zufallstests‚Äú (auch bekannt als ‚ÄûNT Fuzzing Report‚Äú) von Justin Forrester und Barton Miller testen. <br><br>  Die Forscher testeten 33 Anwendungen von Windows NT und einer fr√ºheren Version von Windows 2000 auf Anf√§lligkeit f√ºr verzerrte Fenstermeldungen und zuf√§llige Maus- und Tastaturereignisse.  Seit Dr. Miller den Fuzzer-Code ver√∂ffentlicht hat, haben wir <b>genau dieselben Tools</b> wie die urspr√ºnglichen Autoren verwendet, um nach Fehlern in modernen Windows-Anwendungen zu suchen. <br><a name="habracut"></a><br>  Die Ergebnisse sind nahezu identisch: Vor 19 Jahren st√ºrzten 100% der getesteten Anwendungen ab oder st√ºrzten ab, wenn sie auf verzerrte Fenstermeldungen stie√üen.  Heute hat der gleiche Fuzzer 93% der getesteten Anwendungen fallen lassen oder aufgeh√§ngt.  Nur zwei standen, einschlie√ülich unseres alten Freundes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Calculator</a> (Abb. 1).  Wir haben auch einen Fehler (aber kein Sicherheitsproblem) unter Windows gefunden. <br><br><h1>  Eine kurze Einf√ºhrung in Windows </h1><br>  Was sind Fenstermeldungen und warum st√ºrzen sie ein Programm ab? <br><br>  Windows-GUI-Anwendungen sind ereignisgesteuert: Mausbewegungen, Tastendr√ºcke, Tastenanschl√§ge usw. Eine ereignisgesteuerte Anwendung unternimmt nichts, bis sie ein Ereignis empf√§ngt.  Sobald ein Ereignis empfangen wurde, f√ºhrt die Anwendung die Aktion basierend auf dem Ereignis aus und erwartet dann andere Ereignisse.  Kommt Ihnen das bekannt vor?  Diese Architektur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hat auf Plattformen wie node.js ein zweites Leben erhalten.</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fenstermeldungen sind eine Windows-Ereignisbenachrichtigungsmethode</a> .  Jeder von ihnen hat einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">numerischen Code, der einem bestimmten Ereignis zugeordnet ist</a> .  Jede Nachricht hat einen oder mehrere Parameter, die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√ºblicherweise als lParam und wParam bezeichnet werden</a> .  Sie definieren detailliertere Informationen √ºber das Ereignis.  Beispiele f√ºr solche Informationen sind die Koordinaten der Mausbewegung, welche Taste gedr√ºckt wird oder welcher Text im Fenster angezeigt werden soll.  Diese Nachrichten k√∂nnen vom Programm selbst, vom Betriebssystem oder von anderen Programmen gesendet werden.  Sie k√∂nnen jederzeit und in beliebiger Reihenfolge eintreffen und m√ºssen vom Antrag auf der Empf√§ngerseite bearbeitet werden. <br><br><h3>  Auswirkungen auf die Sicherheit </h3><br>  Vor Windows Vista konnte ein Prozess mit geringen Berechtigungen eine Nachricht an einen Prozess mit hohen Berechtigungen senden.  Mit der richtigen Kombination von Nachrichten k√∂nnen Sie in diesem Prozess Code ausf√ºhren.  In Vista wurden diese <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚Äûsubversiven Angriffe‚Äú</a> weitgehend durch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">UIPI</a> und durch die Isolierung von Systemdiensten in einer separaten Sitzung gesch√ºtzt. <br><br>  Eine falsche Verarbeitung von Fenstermeldungen beeintr√§chtigt die Sicherheit moderner Windows-Systeme aus zwei Gr√ºnden wahrscheinlich nicht.  Erstens k√∂nnen Fensternachrichten nicht √ºber das Netzwerk gesendet werden.  Zweitens ist es f√ºr einen Angreifer nicht sehr n√ºtzlich, eine Anwendung zum Absturz zu bringen oder Code mit derselben Berechtigungsstufe auszuf√ºhren.  Wahrscheinlich war es den Autoren des NT-Fuzzing-Berichts klar.  Sie geben keine Sicherheitserkl√§rungen ab, weisen jedoch zutreffend darauf hin, dass Fehler bei der Verarbeitung von Fenstermeldungen einen Mangel an strengen Tests implizieren. <br><br>  In einigen Bereichen kann die Ausf√ºhrung von Code mit denselben Berechtigungen die Sicherheit beeintr√§chtigen.  Einige Anwendungen kombinieren verschiedene Sicherheitsprimitive, um eine k√ºnstliche Berechtigungsstufe zu erstellen, die urspr√ºnglich nicht im Betriebssystem gefunden wurde.  Ein typisches Beispiel ist eine Sandbox zum Rendern in einem Browser.  Browserhersteller sind sich dieser Probleme bewusst und <a href="">haben Schritte unternommen, um sie zu beheben</a> .  Ein weiteres Beispiel sind Antivirenprodukte.  Dort arbeitet das Control Panel mit normalen Berechtigungen, ist jedoch von anderen Antivirenmodulen isoliert. <br><br><h1>  Testmethode </h1><br>  Um alle Anwendungen in der Testsuite zu fuzzeln, haben wir denselben grundlegenden Code und dieselbe Fuzzing-Technik verwendet, die im ersten NT-Bericht beschrieben wurden.  Insbesondere verwendete der Fazzer sowohl im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SendMessage-</a> als auch im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PostMessage-</a> Modus drei Iterationen von 500.000 Nachrichten mit 42 Seeds und drei Iterationen von 500.000 Nachrichten mit 1.337 Seeds.  Die Ergebnisse erschienen nach nur einer Iteration jeder Methode. <br><br>  Wir haben zuf√§llige Maus- und Tastatureingaben aus Zeitgr√ºnden und aus dem Wunsch heraus verpasst, uns ausschlie√ülich auf Fenstermeldungen zu konzentrieren.  Wir ermutigen auch diejenigen, die Tests wiederholen und die Ergebnisse best√§tigen m√∂chten. <br><br><h1>  Fallstricke </h1><br>  F√ºr Fuzzer in Windows 10 mussten zwei kleinere √Ñnderungen vorgenommen werden.  Passen Sie es zun√§chst f√ºr eine 64-Bit-Plattform an.  Mit der zweiten √Ñnderung konnte fuzzer mithilfe des Befehlszeilenarguments ein bestimmtes Fensterhandle ausw√§hlen.  Das Fuzzing eines bestimmten Deskriptors ist eine schnelle L√∂sung f√ºr das Fuzzing von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">UWP-</a> Anwendungen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">(Universal Windows Platform)</a> .  Das urspr√ºngliche Programm konzentriert sich auf das Fuzzing von Fenstern, die zu einem bestimmten Prozess geh√∂ren, aber alle UWP-Anwendungen zeigen ihre Benutzeroberfl√§che √ºber denselben Prozess an (Abb. 2).  Dies bedeutet, dass der Fuzzer nicht zum Hauptfenster der UWP-Anwendung geleitet werden kann. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a4f/7e8/8fb/a4f7e88fbbd79bdb92b2de8f1c48697a.png"><br>  <i><font color="gray">Abb.</font></i>  <i><font color="gray">2. Auf der UWP-Plattform geh√∂ren alle Anwendungen zu einem Prozess ( <code>ApplicationFrameHost.exe</code> ).</font></i>  <i><font color="gray">Um diese Anwendungen zu verwirren, musste ich den urspr√ºnglichen NT-Fuzzer √§ndern und ihn auf bestimmte Fenstergriffe richten</font></i> <br><br>  Bei der Fuzzer-Modifikation gab es einen schwerwiegenden Fehler: Die f√ºr die beiden Hauptquellen f√ºr zuf√§llige Eingaben ausgew√§hlten Werte, die Argumente <code>lParam</code> und <code>wParam</code> f√ºr <code>SendMessage</code> und <code>PostMessage</code> , sind auf 16-Bit-Ganzzahlen beschr√§nkt.  Beide Argumente sind 32-Bit unter 32-Bit-Windows und 64-Bit unter 64-Bit-Windows.  Das Problem tritt in <code>Fuzz.cpp</code> , wo <code>lParam</code> und <code>wParam</code> : <br><br><pre> <code class="cpp hljs"> wParam = (UINT) rand(); lParam = (LONG) rand();</code> </pre> <br>  Die Funktion rand () gibt eine Zahl im Bereich [0, 2 <sup>16</sup> ] zur√ºck, wodurch die Menge der getesteten Werte stark eingeschr√§nkt wird.  Wir haben diesen Fehler w√§hrend des Tests absichtlich gespeichert, damit die Ergebnisse genau mit der Originalarbeit √ºbereinstimmen. <br><br><h1>  Getestete Anwendungen </h1><br>  Im urspr√ºnglichen NT-Bericht wurden 33 Programme getestet.  Wir haben nur 28, da nur eine Version jedes Programms zum Testen verwendet wird.  Das Windows-Software-√ñkosystem hat sich seit 2000 erheblich ver√§ndert, obwohl √ºberraschend viel unver√§ndert bleibt.  Die Microsoft Office-Suite enth√§lt dieselben Programme wie in den urspr√ºnglichen Tests.  Netscape Communicator hat sich zu Firefox entwickelt.  Adobe Acrobat wurde in Adobe Reader umbenannt, ist aber weiterhin g√ºltig.  Sogar Winamp ver√∂ffentlichte 2018 eine neue Version, die einen fairen Vergleich mit dem urspr√ºnglichen Bericht erm√∂glicht.  Einige veraltete Programme mussten jedoch ersetzt werden.  Im Folgenden finden Sie eine Liste der √Ñnderungen und Gr√ºnde daf√ºr: <br><br><ul><li>  <b>CD-Player ‚á® Windows Media Player: Die</b> CD-Player-Funktionalit√§t ist im neuen Programm enthalten. <br></li><li>  <b>Eudora ‚á® Windows Mail:</b> Qualcomm befasst sich jetzt eher mit Chips als mit E-Mail-Clients.  Da Eudora nicht mehr vorhanden ist, wurde stattdessen der Standard-Windows-Mail-Client getestet. <br></li><li>  <b>Befehl AntiVirus ‚á® Avast Free Edition:</b> Befehl AntiVirus ist nicht mehr verf√ºgbar.  Es wurde durch Avast als beliebtestes Antivirenprogramm von Drittanbietern ersetzt. <br></li><li>  <b>GSView ‚á® Fotos:</b> GSView wird nicht mehr unterst√ºtzt.  Es wurde durch den Standard-Windows-Foto-Viewer ersetzt. <br></li><li>  <b>JavaWorkshop Net NetBeans-IDE: Die</b> JavaWorkshop-IDE wird nicht mehr unterst√ºtzt.  NetBeans scheint eine gute kostenlose Alternative zu sein, die dem Geist dessen entspricht, was √ºberpr√ºft werden muss. <br></li><li>  <b>Sichere CRT ‚á® BitVise SSH:</b> Sichere CRT ist noch vorhanden, zum Herunterladen der Testversion ist jedoch ein sehr langes Webformular erforderlich.  BitVise SSH bot einen Schnellstart an. <br></li><li>  <b>Telnet ‚á® Putty: Die</b> Telnet-Anwendung ist unter Windows noch vorhanden, jetzt ist sie jedoch eine Konsolenanwendung.  Um die GUI zu verwischen, haben wir sie durch Putty ersetzt, den beliebten Open-Source-Terminalemulator f√ºr Windows. <br></li><li>  Wir haben <b>Freecell und Solitaire</b> in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Microsoft Solitaire Collection</a> aus dem Windows App Store-Anwendungskatalog gefunden. </li></ul><br>  Die spezifische Version der Anwendung wird in der Ergebnistabelle angezeigt.  Das gesamte Fuzzing wurde auf einem 64-Bit-System Windows 10 Pro Version 1809 (Build 17763.253) durchgef√ºhrt. <br><br><h1>  Ergebnisse </h1><br>  Wie im urspr√ºnglichen Bericht erw√§hnt, sollten die Ergebnisse nicht als Sicherheitsl√ºcken angesehen werden, sondern als Indikator f√ºr die Zuverl√§ssigkeit und Qualit√§t von Software. <br><br><blockquote>  <i>"Schlie√ülich bilden unsere Ergebnisse einen quantitativen Ausgangspunkt, um die relative Verbesserung der Softwarezuverl√§ssigkeit zu beurteilen."</i> <br><br>  - Aus der ‚Äûempirischen Studie zur Zuverl√§ssigkeit von Windows NT-Anwendungen mithilfe von Zufallstests‚Äú von Justin Forrester und Barton Miller </blockquote><br>  Die Zahlen sind nicht besonders ermutigend, obwohl sich die Situation verbessert.  Im ersten NT-Bericht st√ºrzten alle Anwendungen ab oder hingen am Fuzzing.  Jetzt √ºberlebten zwei Programme: der Taschenrechner und Avast Antivirus die Phaseneinteilung von Fenstermeldungen ohne negative Konsequenzen.  Wir loben die Teams von Avast und Windows Calculator f√ºr ihren Ansatz bei fehlerhaften Fenstermeldungen.  Das Calculator-Team hat sich zus√§tzlichen Respekt verdient, wenn es darum geht, den Quellcode zu √∂ffnen und zu demonstrieren, wie eine hochwertige UWP-Anwendung erstellt wird.  In Tabelle 1 finden Sie alle Fuzzing-Ergebnisse sowie die spezifische Version der verwendeten Software. <br><br><div class="scrollable-table"><table><tbody><tr><td>  <b>Das Programm</b> </td><td>  <b>Version</b> </td><td>  <b>Nachricht senden</b> </td><td>  <b>Postnachricht</b> </td></tr><tr><td>  Microsoft Access </td><td>  1901 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  Adobe Reader DC </td><td>  2019.010.20098 </td><td>  Panne </td><td>  ok </td></tr><tr><td>  Rechner </td><td>  10.1812.10048.0 </td><td>  ok </td><td>  ok </td></tr><tr><td>  Windows Media Player </td><td>  12.0.17763.292 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  Visual Studio Code </td><td>  1.30.2 </td><td>  Panne </td><td>  ok </td></tr><tr><td>  Avast kostenlos </td><td>  19.2.2364 </td><td>  ok </td><td>  ok </td></tr><tr><td>  Windows Mail </td><td>  16005.11231.20182.0 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  Excel </td><td>  1901 </td><td>  Panne </td><td>  ok </td></tr><tr><td>  Adobe Framemaker </td><td>  15.0.2.503 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  Freecell </td><td>  4.3.2112.0 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  GhostScript </td><td>  9.26 </td><td>  Panne </td><td>  ok </td></tr><tr><td>  Fotos </td><td>  2019.18114.17710.0 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  GNU Emacs </td><td>  26.1 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  IE Edge </td><td>  44.17763.1.0 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  Netbeans </td><td>  10 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  Firefox </td><td>  64.0.2 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  Notizblock </td><td>  1809 </td><td>  Panne </td><td>  ok </td></tr><tr><td>  Malen </td><td>  1809 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  Paint Shop Pro 2019 </td><td>  21.1 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  Powerpoint </td><td>  1901 </td><td>  Panne </td><td>  ok </td></tr><tr><td>  Bitvise ssh </td><td>  8.23 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  Solitaire </td><td>  4.3.2112.0 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  Kitt </td><td>  0,70 </td><td>  h√§ngen </td><td>  h√§ngen </td></tr><tr><td>  VS Community 2017 </td><td>  15.9.5 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  WinAmp 5.8 </td><td>  5.8 Build 3660 </td><td>  Panne </td><td>  ok </td></tr><tr><td>  Wort </td><td>  1901 </td><td>  Panne </td><td>  ok </td></tr><tr><td>  Wordpad </td><td>  1809 </td><td>  Panne </td><td>  Panne </td></tr><tr><td>  WS_FTP </td><td>  12.7.0.1903 </td><td>  Panne </td><td>  Panne </td></tr></tbody></table></div>  <i><font color="gray">Tabelle 1. Ergebnisse der Wiedergabe des urspr√ºnglichen Fuzzing unter Windows 10. Nach 19 Jahren verarbeiten fast alle Anwendungen verzerrte Fenstermeldungen immer noch nicht richtig</font></i> <br><br><h1>  Windows Bug? </h1><br>  Leider herrschte Neugierde und wir mussten eine Ausnahme machen.  Es schien, dass mehrere nicht verwandte Anwendungen von einem gemeinsamen Problem betroffen waren.  Das Debuggen hat gezeigt, dass das Problem mit der Nachricht <code>WM_DEVICECHANGE</code> .  Als der Fuzzer diese Nachricht sendete, st√ºrzte sogar die einfachste Anwendung ab - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">HelloWorld, das offizielle Beispiel der Windows-API</a> (Abb. 3). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e6b/74b/cae/e6b74bcae36402b21b948256fe726315.png"><br>  <i><font color="gray">Abb.</font></i>  <i><font color="gray">3. Die 32-Bit-Datei HelloWorld.exe st√ºrzt ab, wenn eine Fenstermeldung von fuzzer empfangen wird.</font></i>  <i><font color="gray">Dies sollte nicht passieren, da das Programm v√∂llig einfach ist.</font></i>  <i><font color="gray">Es versteht sich, dass das Problem irgendwo in Windows liegt</font></i> <br><br>  Nach dem Fall von HelloWorld wurde uns sofort klar, dass das Problem nur 32-Bit-Anwendungen betrifft, nicht jedoch 64-Bit-Anwendungen.  Einige schnelle Fehlerbehebungen zeigten, dass der Absturz in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wow64win.dll auftritt, einer 32-Bit-Anwendungskompatibilit√§tsschicht f√ºr 64-Bit</a> .  Meine oberfl√§chliche (und m√∂glicherweise falsche) Analyse des Problems l√§sst <code>wow64win.dll!whcbfnINDEVICECHANGE</code> den Schluss ziehen, dass die <code>wow64win.dll!whcbfnINDEVICECHANGE</code> wParam als Zeiger auf die Struktur <code>DEV_BROADCAST_HANDLE64</code> im Zielprogramm betrachtet.  Die Funktion konvertiert diese Struktur zur Kompatibilit√§t mit 32-Bit-Anwendungen in die Struktur <code>DEV_BROADCAST_HANDLE32</code> .  Der Fehler tritt auf, weil der vom Fuzzer generierte <code>wParam</code> Wert einen ung√ºltigen Speicher anzeigt. <br><br>  <code>wParam</code> ist eine schlechte Idee, <code>wParam</code> als lokalen Zeiger zu behandeln, obwohl es wahrscheinlich eine bewusste Entwurfsentscheidung f√ºr Benachrichtigungen √ºber Wechselmedien war, um mit √§lteren 32-Bit-Windows-Anwendungen zu arbeiten.  Es ist jedoch immer noch falsch, dass Sie eine andere Anwendung problemlos zum Absturz bringen k√∂nnen.  Wir haben das Problem an MSRC gemeldet, obwohl die Sicherheitsgrenze nicht √ºberschritten wurde.  Sie best√§tigten, dass der Fehler kein Sicherheitsproblem war.  Wir hoffen, in einer zuk√ºnftigen Version von Windows eine L√∂sung f√ºr dieses allgemein akzeptierte seltsame Problem zu finden. <br><br><h1>  Fazit </h1><br>  Fenstermeldungen werden untersch√§tzt und h√§ufig als unzuverl√§ssige Eingabe f√ºr Windows-Programme ignoriert.  Selbst 19 Jahre nach dem Erscheinen des ersten Fuzzers von Open-Source-Fenstermeldungen frieren 93% der getesteten Anwendungen immer noch ein oder st√ºrzen ab, wenn dasselbe Programm gestartet wird.  Es ist jedoch ermutigend, dass einige Anwendungen diese verzerrten Eingaben ordnungsgem√§√ü verarbeiten: Dies bedeutet, dass einige Organisationen √ºber Frameworks und institutionelles Wissen verf√ºgen, um solche Fehler zu vermeiden. <br><br>  Nat√ºrlich kann Fuzzer auf viele Arten verbessert werden, aber selbst die einfachste Methode st√ºrzte 93% der Anwendungen ab.  In einigen F√§llen √ºberschreiten Fensternachrichten m√∂glicherweise sogar die eigentliche Sicherheitsgrenze.  Wenn Sie dieses Gebiet erkunden, hoffen wir, dass Sie die Ergebnisse teilen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de451816/">https://habr.com/ru/post/de451816/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de451800/index.html">Ein einfaches Sonarmodem herstellen</a></li>
<li><a href="../de451802/index.html">Die .Net Community der Raiffeisenbank l√§dt zu UPD mitap Broadcast ein</a></li>
<li><a href="../de451806/index.html">iOS Digest Nr. 5 (27. April - 16. Mai)</a></li>
<li><a href="../de451812/index.html">Jetzt werden gute Entwickler an Ansichten und Abonnenten gemessen - und das ist schlecht</a></li>
<li><a href="../de451814/index.html">RBKmoney Zahlungen unter der Haube - Infrastruktur der Zahlungsplattform</a></li>
<li><a href="../de451818/index.html">Turm oder nicht Turm - das ist die Frage</a></li>
<li><a href="../de451820/index.html">Thematisches Habramitap # 1: Backend-Entwicklung</a></li>
<li><a href="../de451822/index.html">Mieten und engagieren: Beantworten Sie Fragen von zwei Seiten</a></li>
<li><a href="../de451826/index.html">Steigerung der Marketing-Absurdit√§t: Bew√§hrte F√§lle</a></li>
<li><a href="../de451828/index.html">Das Hauptgeheimnis von Google I / O 2019, das im Internet nicht zu finden ist</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>