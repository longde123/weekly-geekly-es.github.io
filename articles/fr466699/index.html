<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò¢ üßùüèΩ üë©‚Äç‚öñÔ∏è Approbation des protocoles de confiance - Authentification OAuth avec InterSystems IRIS üòá üëµüèæ ü§∑üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Comment permettre aux ordinateurs de se faire confiance en votre absence, tout en pr√©servant la s√©curit√© et la confidentialit√©? 



 - Martini sec. Da...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Approbation des protocoles de confiance - Authentification OAuth avec InterSystems IRIS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/intersystems/blog/466699/">  <b>Comment permettre aux ordinateurs de se faire confiance en votre absence, tout en pr√©servant la s√©curit√© et la confidentialit√©?</b> <br><br><img src="https://habrastorage.org/webt/wn/au/eu/wnaueun6knwbjc4anclcexjbfwi.jpeg"><br><br>  - Martini sec.  Dans un grand verre. <br>  - Oui, monsieur.  [Oui, Monsieur (Fr.)] <br>  "Juste une seconde, pas tous."  Trois doigts de Gordon, un de vodka, demi-doigt de Kina Lyklet.  Bien battre dans un shaker, puis mettre une grosse tranche de citron.  Tu te souviens? <br><br>  Jan Fleming, Casino Royale, 1953 <br><br><h2>  Partie 1. Histoires d'OAuth 2.0 et d'OpenID Connect </h2><br>  Universel et, semble-t-il, aujourd'hui au 21e si√®cle, le groupe pr√©f√©r√© de protocoles de d√©l√©gation et d'authentification en acc√®s libre s'appelle OAuth + OIDC.  Mieux pour une utilisation de masse jusqu'√† pr√©sent, n'ont rien trouv√©.  Ils sont particuli√®rement populaires aupr√®s des fournisseurs frontaux car ils marchent au-dessus des protocoles HTTP (S) et utilisent le conteneur JWT ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">JSON Web Token</a> ).  OpenID Connect utilise OAuth pour son travail ou, en d'autres termes, OIDC est un wrapper pour OAuth. <br><br>  OpenID - un standard ouvert pour l'authentification et la cr√©ation de syst√®mes d'identification num√©rique n'est pas nouveau pour les d√©veloppeurs.  Cette ann√©e, il f√™te ses 14 ans.  Dans la troisi√®me version actuelle, le nom complet est OpenID Connect ou plus court que OIDC.  Il est populaire √† la fois dans le d√©veloppement Web et mobile et dans les syst√®mes d'entreprise. <br><a name="habracut"></a><br>  Son partenaire, l'OAuth Open Access D√©l√©gation Standard, a 12 ans.  Et 9 ans apr√®s l'apparition de la norme RFC 5849. Nous nous appuierons sur la version moderne du protocole OAuth 2.0 et la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 6749</a> actuelle.  N'oubliez pas qu'OAuth 2.0 n'est pas compatible avec son pr√©d√©cesseur OAuth 1.0. <br><blockquote> OAuth - un protocole ouvert (sch√©ma, transport) pour d√©l√©guer l'acc√®s, qui permet de fournir aux tiers un acc√®s limit√© aux ressources prot√©g√©es de l'utilisateur sans avoir √† leur transf√©rer (tiers) le login et le mot de passe de la RFC 6749 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">oauth.net</a> est le premier site Web OAuth h√©berg√© par Aaron Parecki <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">oauth.com</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Tutoriel</a> OAuth et environnement de test <br><br>  Open ID Connect (OIDC) est une norme ouverte pour les syst√®mes d'identification d√©centralis√©s qui permet √† l'utilisateur de cr√©er un compte unique pour l'identification sur une vari√©t√© de ressources Internet non li√©es √† l'aide de services tiers, utilise des messages OAuth et un conteneur JWT pour une communication s√©curis√©e. <br></blockquote>  √Ä strictement parler, OAuth n'est pas un protocole, mais un ensemble de r√®gles (sch√©ma) pour s√©parer et transf√©rer les op√©rations d'identification des utilisateurs vers un serveur de confiance distinct lors de la mise en ≈ìuvre de l'architecture de d√©limitation du contr√¥le d'acc√®s dans les syst√®mes logiciels. <br><br>  Et, attention, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OAuth ne peut rien dire sur un utilisateur sp√©cifique</a> !  Ni qui il est, ni o√π il est maintenant, ni m√™me s'il travaille sur l'ordinateur maintenant ou non.  Mais ensuite, il permet d'interagir avec des syst√®mes sans intervention de l'utilisateur, en utilisant des jetons d'acc√®s d√©j√† √©mis.  Ceci est un point important. <br><blockquote>  Cela peut √™tre utile: <br><br><ul><li>  OAuth se combine parfaitement avec l'utilisation du langage de description d'acc√®s aux attributs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">XACML</a> </li><li>  OAuth s'appuie √©galement sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">l'acc√®s g√©r√©</a> par l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">utilisateur</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">UMA</a> ) </li></ul><br>  L'utilisation conjointe d'OAuth + OIDC + UMA permet la mise en ≈ìuvre de syst√®mes d'identification et de contr√¥le d'acc√®s s√©curis√©s (Identity and Access Management - IdM, IAM) dans diff√©rents domaines, par exemple: <br><br><ul><li>  en utilisant le profil <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">HEART</a> (Health Relationship Trust) des donn√©es personnelles d'un patient en m√©decine </li><li>  sur les plateformes d'identification client CIAM (Consumer Identity and Access Management) pour les entreprises de fabrication et de n√©goce </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">personnalisation des certificats num√©riques des appareils intelligents</a> dans les syst√®mes IoT (Internet of Things) </li></ul></blockquote><img src="https://habrastorage.org/webt/pf/dt/vf/pfdtvf4d6obgfiom0tizekdsjis.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Un nouveau contr√¥le d'acc√®s pour l'√©conomie des API</a> <br><br>  Plus important encore, ne stockez pas de donn√©es personnelles au m√™me endroit que le reste du syst√®me.  Authentification et autorisation physiques distinctes.  Et encore mieux - donnez toutes les pi√®ces d'identit√© personnellement √† la personne et ne la gardez jamais avec vous.  Faites confiance au propri√©taire de l'appareil. <br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Apple a d√©clar√©</a> quelles donn√©es personnelles les Russes stockent en Russie.  Il s'agit du nom, de l'adresse, de l'e-mail, du num√©ro de t√©l√©phone.  Mais les messages, les photos, etc., les gens eux-m√™mes font confiance au cloud iCloud (qui n'est pas en Russie). <br></blockquote><h2>  Partie 2. Lecture courte "Confiance et authentification" </h2><br>  Nous avons donc d√©cid√© qu'il n'√©tait pas comme il faut de stocker les donn√©es personnelles de nos chers utilisateurs ni dans notre application, ni dans un seul stockage avec une base de donn√©es fonctionnelle.  Autrement dit, ils ont choisi un fiduciaire fiable qui nous fournira ce service.  Et donc, lorsque Sa Majest√© l'Utilisateur appara√Æt, alors nous fournissons le dialogue suivant. <br><br>  Acteurs: <br><br><ul><li>  Utilisateur </li><li>  Application client </li><li>  Service d'identit√© </li><li>  Serveur de ressources </li></ul><br>  L'action se d√©roule dans un navigateur sur l'ordinateur de l'utilisateur.  Tous les personnages se connaissent depuis longtemps.  L'utilisateur dispose d'un compte personnel sur le service d'identit√©.  L'application cliente a un contrat valide sign√© avec le service d'identification et les interfaces mutuelles.  Le serveur de ressources fait confiance au service d'identit√© dans la question de la d√©livrance des cl√©s d'acc√®s √† toute victime qu'il peut identifier. <br><br>  Utilisateur (P): (en lan√ßant une application client Web) Cher client, j'ai besoin de ¬´cette ressource¬ª. <br>  Application client (K): Cher utilisateur, pr√©sentez d'abord la cl√© de "cette ressource".  Sans cl√©, l'acc√®s √† "cette ressource" est ferm√©. <br>  P: Je n'ai pas une telle cl√©. <br>  K: Ensuite, je vais temporairement vous transf√©rer vers un service d'identification avec lequel nous avons un accord pour d√©livrer des cl√©s au serveur de ressources.  (redirige P. vers le service d'identification) <br>  Service d'identification (I): Cher utilisateur, dites-moi qui vous √™tes et quelles cl√©s vous avez besoin? <br>  P: Moi, Ytsuken User User, le mot de passe est tel ou tel, je veux avoir acc√®s √† "cette ressource". <br>  Et: Merci, camarade Jtsuken.  L'authentification a r√©ussi et votre identification est v√©rifi√©e.  Voici la cl√© de ¬´cette ressource¬ª (P. redirige vers K.) <br>  P: Client, je vous ai apport√© la cl√© de la ¬´ressource¬ª dont j'ai besoin. <br>  K: Merci utilisateur.  La cl√© est correcte.  Voici la "ressource" que vous avez demand√©e. <br><br>  Le rideau.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La symphonie d'ouverture de Richard Strauss</a> du film "Space Odyssey de 2001" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">joue</a> <br><br><h2>  Partie 3. Service d'autorisation r√©el </h2><br>  Passons maintenant aux choses s√©rieuses.  Nous avons trois t√¢ches √† l'ordre du jour: nommer les personnages, pr√©parer la sc√®ne et jouer la pi√®ce.  Et tout est d√©cid√© en m√™me temps sur la plateforme InterSystems IRIS.  Mais ce n'est pas n√©cessaire, vous pouvez assembler un design √† partir de diff√©rentes plateformes √† votre discr√©tion.  Par exemple, dans cette combinaison: serveur OAuth Keycloak + client OAuth et ressource OAuth sur IRIS.  En d'autres termes: <br><br><ol><li>  Configurez et lancez le serveur OAuth avec l'enregistrement de notre client de d√©monstration dessus. </li><li>  Configurez un client de d√©monstration OAuth en le connectant au serveur OAuth et aux ressources Web. </li><li>  D√©velopper des applications clientes pouvant utiliser OAuth.  Vous pouvez utiliser Java, Python, C #, NodeJS.  Voici un exemple de code d'application dans ObjectScript. </li></ol><br><blockquote>  Le site Web de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la communaut√© des d√©veloppeurs</a> contient une instruction d√©taill√©e de Daniel Kutak en trois parties avec des exemples d'utilisation d'OAuth dans IRIS pour diff√©rentes applications bas√©es sur CSP ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">partie 1</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">partie 2</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">partie 3</a> ). </blockquote>  Il existe de nombreux param√®tres dans OAuth.  Par cons√©quent, √©crivez-vous des listes de contr√¥le - c'est l'application la plus appropri√©e pour eux.  Exemples et blancs ci-dessous. <br><blockquote>  O√π obtenir InterSystems IRIS pr√™t √† l'emploi pour un √©chantillon?  Il y a au moins deux options disponibles pour tout le monde: <br><br>  Obtenez un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">serveur IRIS cloud pr√©configur√© pr√™t √† l'emploi</a> sur la plate-forme de formation InterSystems Learning Services dans la section InterSystems Learning Labs. <br><br>  Installez un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">conteneur docker pr√™t √† l'emploi</a> .  En savoir plus dans l'article - une instruction √©tape par √©tape pour les d√©butants du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lancement d'IRIS √† l'aide de</a> d√©veloppeurs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Docker</a> ou, qui pr√©f√®rent une vid√©o, une instruction de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">capture d'</a> √©cran de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©veloppement de solutions avec InterSystems IRIS √† l'aide de Docker et VSCode</a> </blockquote><h3>  1-1 Configuration du serveur OAuth </h3><br>  Nous allons dans le portail de gestion IRIS et s√©lectionnons la section: <br><br>  Administration syst√®me &gt;&gt; S√©curit√© &gt;&gt; OAuth 2.0 &gt;&gt; Serveur <br><br>  Ensuite, dans chaque paragraphe, il y aura un nom pour la ligne des param√®tres et, √† travers les deux points, un exemple ou une explication si n√©cessaire. <br><br><img src="https://habrastorage.org/webt/9g/k4/by/9gk4bywq0a0dkkkprpu5wbnempo.png"><br><br>  <b>Onglet Param√®tres g√©n√©raux:</b> <br>  Description: facultatif, par exemple, donc "Serveur d'autorisation" <br>  Le point de terminaison du g√©n√©rateur (ci-apr√®s CTG) est le nom d'h√¥te: nom DNS de votre serveur <br>  Types d'autorisation pris en charge (s√©lectionnez au moins un): <br>  Code d'autorisation <br>  Implicite <br>  Informations d'identification: ressource, propri√©taire, mot de passe <br>  Identifiants client <br>  Configuration SSL / TLS: oauthserver <br><br>  <b>Onglet Autorisations:</b> <br>  ajouter des volumes pris en charge: par exemple, scope1 et scope2 <br><br>  <b>Onglet Intervalles:</b> <br>  Intervalle de cl√© d'acc√®s: 3600 <br>  Intervalle de code d'autorisation: 60 <br>  Intervalle de mise √† jour des cl√©s: 86400 <br>  Intervalle d'interruption de session: 86400 <br>  P√©riode de validit√© de la cl√© client: 0 <br><br>  <b>Onglet Param√®tres JWT:</b> <br>  Algorithme d'entr√©e: RS512 <br>  Algorithme de gestion des cl√©s: RSA-OAEP <br>  Algorithme de chiffrement de contenu: A256CBC-HS512 <br><br>  <b>Onglet Personnalisation:</b> <br>  Identifier la classe:% OAuth2.Server.Authenticate <br>  V√©rifier la classe d'utilisateurs:% OAuth2.Server.Validate <br>  Classe de service de session: OAuth2.Server.Session <br>  G√©n√©rer une classe de cl√©s:% OAuth2.Server.JWT <br>  Espace de noms de personnalisation:% SYS <br>  R√¥les de personnalisation (s√©lectionnez au moins un):% DB_IRISSYS et% Manager <br><br>  Enregistrez. <br><br><h3>  1-2 Enregistrer le client sur le serveur OAuth </h3><br><img src="https://habrastorage.org/webt/ae/gu/pz/aegupzlmpoucnqfa4vu-f2gcgq0.png"><br><br>  Bouton Description du client &gt;&gt; Bouton Cr√©er une description du client: <br><br>  <b>Onglet Param√®tres g√©n√©raux:</b> <br>  Nom: CLIENT <br>  Description: arbitraire <br>  Type de client: confidentiel <br>  URL de redirection: l'adresse du point de retour dans notre application apr√®s l'authentification <br>  Types d'autorisations pris en charge <br>  Code d'autorisation: oui <br>  Implicite <br>  Informations d'identification: ressource, propri√©taire, mot de passe <br>  Identifiants client <br>  Autorisation JWT <br>  Types de r√©ponses pris en charge <br>  code <br>  id_token <br>  cl√© id_token <br>  jeton <br>  Type d'autorisation: Simple <br><br>  <b>Onglet</b> Informations d' <b>identification du client:</b> rempli automatiquement <br><br>  <b>Onglet Informations client:</b> <br>  URL de lancement: <br>  √âcran de connexion <br>  Nom du client <br>  URL du logo <br>  URL de la page d'accueil du client <br>  URL de strat√©gie <br>  Conditions d'URL de service <br><br><h3>  2-1 Configuration de la liaison sur le client du serveur OAuth </h3><br>  Administration syst√®me &gt;&gt; S√©curit√© &gt;&gt; OAuth 2.0 &gt;&gt; Client <br><br><img src="https://habrastorage.org/webt/xq/hu/3r/xqhu3rquzsfni1tsfgwtfkhzvew.png"><br><br>  Cr√©ez une description de serveur: <br>  Point de terminaison du g√©n√©rateur: prendre des param√®tres g√©n√©raux du serveur, voir ci-dessus <br>  Configuration SSL / TLS: s√©lectionnez dans la liste des pr√©configur√©s <br><br>  Le contenu des champs restants sera t√©l√©charg√© automatiquement √† partir du serveur, mais vous pouvez √©galement les configurer manuellement: <br><br>  Serveur d'autorisation <br>  Point de terminaison d'autorisation: CTG + / authorize <br>  Point de terminaison cl√©: CTG + / token <br>  Point de terminaison des informations utilisateur: CTG + / userinfo <br>  Crit√®re principal d'autodiagnostic: CTG + / r√©vocation <br>  Crit√®re principal de r√©vocation: CTG + / introspection <br>  Param√®tres de jeton Web JSON (JWT) <br>  Autre source que l'enregistrement dynamique: s√©lectionnez JWKS dans l'URL <br>  URL: CTG + / jwks <br><br><img src="https://habrastorage.org/webt/ic/7e/x4/ic7ex4khfgskgdqf_jpsdivgj_o.png"><br><br>  √Ä partir de cette liste, par exemple, on peut voir (scopes_supported et claims_supported) que le serveur peut fournir au client OAuth diff√©rentes informations sur l'utilisateur.  Et il vaut la peine de faire attention lors de la mise en ≈ìuvre de votre application, vous devrez demander √† l'utilisateur quelles donn√©es il est pr√™t √† partager.  De plus, dans notre exemple, nous ne demanderons l'autorisation que par scope1. <br><br>  Enregistrez. <br><br>  S'il y a une erreur indiquant SSL, alors allez dans les param√®tres: <br>  Administration syst√®me &gt;&gt; S√©curit√© &gt;&gt; Configuration SSL / TSL <br><br><h3>  2-2 Configuration du client OAuth </h3><br>  Administration syst√®me &gt;&gt; S√©curit√© &gt;&gt; OAuth 2.0 &gt;&gt; Client &gt;&gt; Configuration client &gt;&gt; Cr√©er une configuration client <br><br><img src="https://habrastorage.org/webt/kd/e_/4w/kde_4wyvqd60yomyyudfzdotu_q.png"><br><br>  <b>Onglet G√©n√©ral:</b> <br>  Nom de l'application: client de d√©monstration <br>  Nom du client: client de d√©monstration <br>  Description: facultatif <br>  Activ√©: Oui <br>  Type de client: confidentiel <br>  Configuration SSL / TCL: oauthclient <br>  URL de redirection client: nom DNS de votre serveur <br>  Types d'autorisation requis <br>  Code d'autorisation: oui <br>  Implicite <br>  Informations d'identification: ressource, propri√©taire, mot de passe <br>  Identifiants client <br>  Autorisation JWT <br>  Type d'autorisation: Simple <br><br>  <b>Onglet Informations client:</b> <br>  √âcran de connexion <br>  URL du logo <br>  URL de la page d'accueil du client <br>  URL de strat√©gie <br>  Conditions d'URL de service <br>  Volume par d√©faut: nous prenons ceux sp√©cifi√©s pr√©c√©demment sur le serveur, par exemple scope1 <br>  Adresses e-mail de contact (s√©par√©es par une virgule) <br>  √Çge maximum par d√©faut (en secondes) <br><br>  <b>Onglet Param√®tres JWT:</b> <br>  Param√®tres de jeton Web JSON (JWT) <br>  Cr√©ation de param√®tres JWT √† partir des informations d'identification X509 <br>  Algorithmes IDToken <br>  Signature: RS256 <br>  Cryptage: A256CBC <br>  Cl√©: RSA-OAEP <br>  Algorithmes Userinfo <br>  Algorithmes de jeton d'acc√®s <br>  Algorithmes de requ√™te <br><br>  <b>Onglet Informations d'identification du client:</b> <br>  Id  client: √† partir de celui √©mis lors de l'enregistrement du client sur le serveur (voir ci-dessus) <br>  Identifiant client √©mis <br>  Secret du client: celui √©mis lors de l'enregistrement du client sur le serveur (voir ci-dessus) <br>  Le secret client expire <br>  URI d'enregistrement du client <br><br>  Enregistrez. <br><br><h2>  Partie 4. Code </h2><br>  Cr√©ons une application web minimaliste avec autorisation OAuth et REST. <br><blockquote>  En travaillant, OAuth s'appuie sur le fait que les canaux de communication entre les participants √† l'interaction (serveur, clients, application web, navigateur utilisateur, serveur de ressources) sont en quelque sorte prot√©g√©s.  Le plus souvent, ce r√¥le est jou√© par SSL / TLS.  Mais OAuth fonctionnera √©galement sur les canaux non s√©curis√©s.  Par exemple, le serveur Keycloak, par d√©faut, utilise le protocole HTTP et va sans protection.  Cela simplifie le d√©veloppement et le d√©bogage pendant le d√©veloppement.  Avec l'utilisation r√©elle des services OAuth, la protection des canaux doit √™tre strictement activ√©e - cela est enregistr√© dans la documentation Keycloak.  Les d√©veloppeurs InterSystems IRIS adoptent une approche plus rigoureuse pour OAuth - SSL / TSL est requis.  La seule simplification est que vous pouvez utiliser des certificats auto-sign√©s ou utiliser le service PKI int√©gr√© √† IRIS (Administration syst√®me &gt;&gt; S√©curit√© &gt;&gt; Syst√®me de cl√© publique). </blockquote>  L'autorisation de l'utilisateur est v√©rifi√©e avec l'indication explicite de deux param√®tres - le nom de votre application et le volume pris en charge par le serveur OAuth et dans le client OAuth (port√©e - je me demande comment la nommer correctement en russe?): <br><br><pre><code class="plaintext hljs">Parameter OAUTH2APPNAME = "OAuthClient"; set isAuthorized = ##class(%SYS.OAuth2.AccessToken).IsAuthorized( ..#OAUTH2APPNAME, .sessionId, "scope1", .accessToken, .idtoken, .responseProperties, .error)</code> </pre> <br>  En l'absence d'autorisation, nous pr√©parons un lien vers une demande d'identification de l'utilisateur et obtenons de lui l'autorisation de travailler avec notre application.  Ici, nous devons indiquer non seulement le nom de l'application et le volume demand√© (√©tendue) enregistr√©s sur le serveur OAuth et dans le client OAuth, mais √©galement un lien de retour vers lequel l'application Web doit renvoyer l'utilisateur. <br><br><pre> <code class="plaintext hljs">Parameter OAUTH2CLIENTREDIRECTURI = "https://52773b-76230063.labs.learning.intersystems.com/oauthclient/" set url = ##class(%SYS.OAuth2.Authorization).GetAuthorizationCodeEndpoint( ..#OAUTH2APPNAME, "scope1", ..#OAUTH2CLIENTREDIRECTURI, .properties, .isAuthorized, .sc)</code> </pre><br>  Nous utilisons le service d'authentification IRIS int√©gr√© et, par cons√©quent, nous enregistrons les utilisateurs sur le serveur IRIS OAuth.  Par exemple, il suffit de d√©finir √† l'utilisateur uniquement un nom d'utilisateur et un mot de passe, vous n'aurez pas besoin de faire d'autres r√©glages dans le compte. <br><br>  Lors du transfert de l'utilisateur √† l'aide du lien re√ßu, le serveur ex√©cutera la proc√©dure d'identification de l'utilisateur et lui demandera l'autorisation de fonctionner avec les informations d'identification dans l'application Web, et enregistrera √©galement le r√©sultat dans son global OAuth2.Server.Session dans la zone% SYS: <br><br><img src="https://habrastorage.org/webt/dj/ih/ve/djihveewmoifbr9knths77mq-vi.png"><br><br><img src="https://habrastorage.org/webt/jb/ib/qz/jbibqzzejdf-gzo03bfcxdlkjjg.png"><br><br>  3. D√©montrez les donn√©es d'un utilisateur autoris√©.  Une fois les proc√©dures termin√©es, nous avons, par exemple, un jeton d'acc√®s.  Obtenons-le: <br><br><pre> <code class="plaintext hljs">set valid = ##class(%SYS.OAuth2.Validation).ValidateJWT( .#OAUTH2APPNAME, accessToken, "scope1", .aud, .JWTJsonObject, .securityParameters, .sc )</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Code de travail complet d'un exemple de travail avec OAuth:</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">Class OAuthClient.REST Extends %CSP.REST { Parameter OAUTH2APPNAME = "OAuthClient"; Parameter OAUTH2CLIENTREDIRECTURI = "https://52773b-76230063.labs.learning.intersystems.com/oauthclient/"; // to keep sessionId Parameter UseSession As Integer = 1; XData UrlMap [ XMLNamespace = "http://www.intersystems.com/urlmap" ] { &lt;Routes&gt; &lt;Route Method="GET" Url = "/" Call = "Do" /&gt; &lt;/Routes&gt; } ClassMethod Do() As %Status { // Check for accessToken set isAuthorized = ##class(%SYS.OAuth2.AccessToken).IsAuthorized( ..#OAUTH2APPNAME, .sessionId, "scope1", .accessToken, .idtoken, .responseProperties, .error) // to show accessToken if isAuthorized { set valid = ##class(%SYS.OAuth2.Validation).ValidateJWT( ..#OAUTH2APPNAME, accessToken, "scope1", .aud, .JWTJsonObject, .securityParameters, .sc ) &amp;html&lt; Hello!&lt;br&gt; &gt; w "You access token = ", JWTJsonObject.%ToJSON() &amp;html&lt; &lt;/html&gt; &gt; quit $$$OK } // perform the process of user and client identification and get accessToken set url = ##class(%SYS.OAuth2.Authorization).GetAuthorizationCodeEndpoint( ..#OAUTH2APPNAME, "scope1", ..#OAUTH2CLIENTREDIRECTURI, .properties, .isAuthorized, .sc) if $$$ISERR(sc) { w "error handling here" quit $$$OK } // url magic correction: change slashes in the query parameter to its code set urlBase = $PIECE(url, "?") set urlQuery = $PIECE(url, "?", 2) set urlQuery = $REPLACE(urlQuery, "/", "%2F") set url = urlBase _ "?" _ urlQuery &amp;html&lt; &lt;html&gt; &lt;h1&gt;  IRIS   OAuth2&lt;/h1&gt; &lt;a href = "#(url)#"&gt;  &lt;b&gt;IRIS&lt;/b&gt;&lt;/a&gt; &lt;/html&gt; &gt; quit $$$OK } }</code> </pre><br></div></div><br>  Si n√©cessaire, activez les messages de d√©bogage √©tendus sur le serveur OAuth et le client OAuth.  Les messages sont √©crits dans le global ISCLOG dans la zone% SYS.  Saisissez votre terminal IRIS (ou installez et utilisez un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">terminal Web</a> ): <br><br><pre> <code class="plaintext hljs">set ^%ISCLOG = 5 set ^%ISCLOG("Category", "OAuth2") = 5 set ^%ISCLOG("Category", "OAuth2Server") = 5</code> </pre><br>  Consultez la documentation IRIS <a href="">Utilisation d'OAuth 2.0 et d'OpenID Connect pour plus d'informations</a> . <br><br>  Conclusions: <br><br><ol><li>  OAuth permet de s√©parer physiquement et g√©ographiquement les services avec les informations d'identification de l'utilisateur et les bases de donn√©es ¬´fonctionnelles¬ª.  Et, ainsi, renforcer la protection des donn√©es d'identification et, si n√©cessaire, se conformer aux exigences des lois sur la protection des donn√©es personnelles des diff√©rents pays. </li><li>  En utilisant OAuth, l'utilisateur peut avoir la possibilit√© de travailler en toute s√©curit√© √† partir de plusieurs appareils en m√™me temps et de ¬´briller¬ª ses donn√©es personnelles de mani√®re minimale sur divers services et applications.  En plus de ne pas prendre d'informations ¬´redondantes¬ª sur les utilisateurs de leurs services, c'est-√†-dire d'effectuer un traitement de donn√©es d√©personnalis√© dans leurs services. </li><li>  Lorsque vous utilisez InterSystems IRIS, vous disposez d'un ensemble complet d'outils pr√™ts √† l'emploi pour tester et d√©ployer les services OAuth et OIDC de mani√®re autonome et en coop√©ration avec des produits logiciels tiers. </li></ol><br><blockquote>  Quelles industries utilisent le plus souvent la plate-forme InterSystems IRIS? <br>  Pour l'automatisation des soins de sant√©, dans le secteur financier, pour les projets de gouvernement √©lectronique, dans la logistique, le commerce de d√©tail et de nombreuses autres industries. <br><br>  Si vous √™tes int√©ress√© par les t√¢ches d'automatisation des soins de sant√©, faites attention √† la norme FHIR.  InterSystems IRIS for Health (une version sp√©ciale de la plate-forme InterSystems IRIS) prend en charge la norme FHIR pour l'int√©gration et le d√©veloppement d'applications </blockquote>  Comme vous pouvez le voir ci-dessus, toutes les fonctionnalit√©s OAuth sont facilement accessibles et enti√®rement pr√™tes √† l'emploi.  Si n√©cessaire, vous pouvez remplacer les classes de gestionnaire et les interfaces utilisateur par les v√¥tres.  Les param√®tres du serveur et du client OAuth peuvent √™tre d√©finis √† partir des fichiers de configuration, au lieu d'utiliser le portail de gestion. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr466699/">https://habr.com/ru/post/fr466699/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr466685/index.html">Voir l'argent</a></li>
<li><a href="../fr466689/index.html">Comment cr√©er des classes de personnages dans une action MMO mobile</a></li>
<li><a href="../fr466691/index.html">Donc tout de m√™me RAML ou OAS (Swagger)?</a></li>
<li><a href="../fr466693/index.html">Si vous entrez pas en informatique</a></li>
<li><a href="../fr466697/index.html">Monades √† Erlang</a></li>
<li><a href="../fr466701/index.html">Let's Encrypt dessert pr√®s de 30% des domaines</a></li>
<li><a href="../fr466705/index.html">Vivaldi Beta pour Android - Navigateur r√©el</a></li>
<li><a href="../fr466709/index.html">D√©veloppement d'un syst√®me d'exploitation monolithique de type Unix - Biblioth√®que C (2)</a></li>
<li><a href="../fr466711/index.html">Vuln√©rabilit√© DaOffice autoris√© √† supprimer tout utilisateur du r√©seau social</a></li>
<li><a href="../fr466713/index.html">Est-il possible en 1C de ne pas observer la technologie des composants externes? Ou Comment f√©liciter des coll√®gues utilisant 1C?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>