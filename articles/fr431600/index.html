<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöº üë™ üçó Augmenter IDS / NMS: Mikrotik et Suricata avec une interface Web üß¶ üêΩ ‚ùé</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Apparemment, j'ai un tel karma: peu importe comment j'entreprends la mise en ≈ìuvre d'un service sur une source ouverte, je trouverai certainement un t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Augmenter IDS / NMS: Mikrotik et Suricata avec une interface Web</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/431600/">  Apparemment, j'ai un tel karma: peu importe comment j'entreprends la mise en ≈ìuvre d'un service sur une source ouverte, je trouverai certainement un tas de manuels, chacun individuellement dans mon cas particulier ne fonctionnera pas, la solution pr√™te √† l'emploi ne d√©marrera pas ou comme √ßa, quoi d'autre se passera -Aucune digestibilit√©, et √† la fin vous devez vous-m√™me percer jusqu'au r√©sultat. <br><br>  Cette fois, tous les manuels √©taient sur ELK5 ou m√™me plus anciens, mais je ne voulais pas vraiment installer le logiciel des versions pr√©c√©dentes.  Je voulais prendre le logiciel avec les p√©riodes de support les plus prometteuses: de pr√©f√©rence la derni√®re de l'√©curie. <br><br>  Par cons√©quent, afin de pouvoir r√©p√©ter l'exploit parfait sans r√©p√©ter tous les tourments √† l'avenir, vous devez √©crire des feuilles de triche √©tape par √©tape que je partage avec vous. <br><br>  Aujourd'hui, Mikrotik (RouterOS), Suricata 4.1, Elasticsearch + Filebeat + Kibana 6.5. <br><a name="habracut"></a><br><h3>  Au lieu de rejoindre </h3><br>  Termes: <br><br><ul><li>  Mikrotik sur i386 dans une machine virtuelle sur l'h√¥te A. Toutes les interfaces sur Mikrotik sont dispers√©es sur des VLAN, l'h√¥te a une interface r√©seau physique. </li><li>  Ressources gratuites pour IDS / IPS / NMS sur l'h√¥te B avec une seule interface r√©seau physique. </li><li>  Sortie de 20 m√©gaoctets. </li><li>  Le d√©sir de recevoir des analyses sur le trafic passant par l'interface externe du Mikrotik. </li><li>  Le budget en roubles de raifort et kopecks FIG. </li><li>  Un certain temps libre de tracas. </li></ul><br>  Je ne parlerai pas ici de ce qu'est IDS / IPS / NMS, pourquoi il est n√©cessaire et ce qu'il se passe.  Tout le monde le sait sans moi, et celui qui ne le sait pas google. <br><br>  Aussi, je ne justifierai pas mon choix entre Snort et Suricata en faveur de cette derni√®re.  C'est une question de go√ªt. <br><br>  Mais expliquez superficiellement comment cela fonctionne: <br><br>  Suricata re√ßoit en quelque sorte du trafic.  Il y a trois options: a) passer par vous-m√™me en mode en ligne, b) recevoir une copie du trafic du port du commutateur et c) analyser les vidages avec le trafic.  Suricata analyse le trafic re√ßu et, sur la base de l'analyse, fournit des donn√©es sur ce qu'il y a trouv√© dans ce trafic. <br><br>  Suricata peut √©mettre des donn√©es en JSON.  En cons√©quence, ayant des donn√©es structur√©es, elles peuvent √™tre introduites dans un syst√®me pour le traitement, la syst√©matisation, l'analyse et la visualisation. <br>  Pour l'analyse et la visualisation des donn√©es, pour autant que je comprends, sans √™tre un sp√©cialiste dans ce domaine, la pile ELK est parfaite.  La pile ELK se composait √† l'origine d'Elasticsearch, Logstash, Kibana.  Maintenant, Beat y a √©t√© ajout√© (une famille de programmes d'interface qui servent d'interm√©diaire entre la source de donn√©es et Logstash ou Elasticsearch).  Pour l'avenir, je dirai qu'il n'y avait pas de Logstash, car Beat transmet parfaitement les donn√©es directement √† Elasticsearch, et Elasticsearch les mange parfaitement.  Elasticsearch transf√®re les donn√©es mordues √† Kibana, l'interface Web de l'ensemble de la pile ELK.  Kibana, en utilisant les mod√®les qui lui sont transmis par Filebeat, fournit √† l'utilisateur une visualisation des donn√©es, les soi-disant tableaux de bord.  Compte tenu du fait qu'Elasticsearch, Logstash, Beat et Kibana sont le fruit du travail d'un producteur, toute cette ferme est bien connect√©e les uns aux autres et le processus de liaison est bien document√© (selon les normes open source, bien s√ªr). <br><br>  Ainsi, sur la base de ce qui pr√©c√®de, la t√¢che peut √™tre d√©crite comme suit: obtenir une copie du trafic du port du routeur, le transf√©rer vers Suricata, recevoir des donn√©es au format JSON de Suricata, les transf√©rer vers Filebeat, de sorte que, √† son tour, il les transf√®re vers Elasticsearch et aid√© Kibana √† cr√©er leur affichage visuel. <br><br><h3>  Mikrotik RouterOS </h3><br>  Si j'avais un mat√©riel de routeur Mikrotik, le probl√®me de la mise en miroir des ports (mise en miroir des ports) ne serait pas du tout.  Tout serait d√©cid√© en permettant la mise en miroir du trafic passant par l'interface externe vers n'importe quel port libre de Mikrotik lui-m√™me.  S'il n'y avait pas de port libre sur Mikrotik, vous pouvez activer la mise en miroir des ports sur le commutateur.  Mais dans mon cas, Mikrotik n'avait pas de ports physiques du tout, et le port du commutateur recevait du trafic de l'h√¥te entier, sur lequel, en plus de Mikrotik, il y avait plusieurs autres machines virtuelles. <br><br>  Et puis j'ai encore une fois dit mentalement: "Merci, Mikrotik!".  Merci pour le renifleur int√©gr√© dans RouterOS.  Par tradition, nous nous passons de captures d'√©cran, uniquement des commandes de console. <br><br>  Ouvrez le terminal dans WinBox et activez le renifleur: <br><br> <code>/tool sniffer set filter-interface=if-out filter-stream=yes streaming-enabled=yes streaming-server=192.168.1.253 <br> /tool sniffer start</code> <br> <br>  Indiquez au lieu de <i>if-out le</i> nom de l'interface √† partir de laquelle vous pr√©voyez d'intercepter le trafic, et au lieu de <i>192.168.1.253</i> - l'adresse IP de la machine sur laquelle le trafic intercept√© sera envoy√© via <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">TZSP</a> . <br><br>  Avec Mikrotik'om all. <br><br><h3>  Suricata </h3><br>  En g√©n√©ral, je ne suis pas tr√®s orient√© Linux, donc surtout j'aime les distributions pop.  Eh bien, j'aime peut-√™tre la Debian plus asc√©tique.  J'ai donc commenc√© avec √ßa.  Eh bien, et bien s√ªr, en raison de l'en-t√™te non linux, je voulais √©galement installer des binaires √† partir du r√©f√©rentiel.  L'assemblage est toujours paresseux pour moi.  Donc, s'il sera possible de choisir Debian, - <u>ne choisissez pas</u> .  Je ne me souviens plus maintenant √† quel endroit j'avais le b√¢illon pour installer toute la ferme sous Debian, mais il l'√©tait.  Et toute l'histoire suivante sur l'installation de tout sous Ubunta. <br><br>  Une machine virtuelle √† 4 c≈ìurs avec 4 Go de RAM a √©t√© cr√©√©e, <a href="">Ubuntu Server 18.04.1 LTS (x64) a √©t√©</a> t√©l√©charg√© et install√© dessus <br><br><blockquote>  <b>Accord</b> : toutes les autres actions sont effectu√©es au nom du superutilisateur, alors connectez-vous en tant que root ou ajoutez <i>sudo</i> √† chaque commande. </blockquote><br>  √âtant donn√© qu'√† chaque √©tape, j'ai fait des instantan√©s, puis que je suis revenu √† plusieurs reprises sur eux, j'ai finalement allum√© beaucoup de probl√®mes avec un d√©lai de synchronisation dans une machine virtuelle en temps r√©el. <br>  Par cons√©quent, nous d√©finissons imm√©diatement le fuseau horaire et la synchronisation NTP corrects: <br><br> <code>systemctl start systemd-timesyncd <br> systemctl status systemd-timesyncd <br> dpkg-reconfigure tzdata</code> <br> <br>  Pour vous assurer qu'il n'y a aucun probl√®me de d√©pendance lors de l'installation de Suricata, ajoutez les r√©f√©rentiels d' <i>univers</i> √† <i><b>/etc/apt/sources.list</b></i> : <br><br> <code>nano /etc/apt/sources.list</code> <br> <blockquote>  ... <br>  deb <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">archive.ubuntu.com/ubuntu</a> univers principal bionique <br>  deb <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">archive.ubuntu.com/ubuntu</a> univers principal bionic-security <br>  deb <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">archive.ubuntu.com/ubuntu</a> bionic-updates univers principal </blockquote><br>  Nous ajoutons √©galement le r√©f√©rentiel, o√π nous obtiendrons Suricata: <br> <code>add-apt-repository ppa:oisf/suricata-stable</code> <br> <br>  Mise √† jour de la base de donn√©es des packages: <br> <code>apt-get update</code> <br> <br>  Installez Suricata: <br> <code>apt-get install -y suricata</code> <br> <br>  L'√©tape suivante consiste √† d√©finir les r√®gles pour Suricata et leur mise √† jour: <br> <code>apt-get install -y python-pip <br> pip install pyyaml <br> pip install https://github.com/OISF/suricata-update/archive/master.zip</code> <br> <br>  Nous commen√ßons la mise √† jour de <i>suricata-update elle-m√™me</i> : <br> <code>pip install --pre --upgrade suricata-update</code> <br> <br>  L'ex√©cution sans configuration suppl√©mentaire nous donnera un ensemble de r√®gles Open Emerging Threats: <br> <code>suricata-update</code> <br> <br>  Pour voir la liste des sources, faites: <br> <code>suricata-update list-sources</code> <br> <br>  Mise √† jour des sources de r√®gles: <br> <code>suricata-update update-sources</code> <br> <br>  Voyons ce qui a √©t√© mis √† jour dans les sources, ex√©cutez √† nouveau: <br> <code>suricata-update list-sources</code> <br> <br>  Nous incluons toutes les sources gratuites: <br> <code>suricata-update enable-source ptresearch/attackdetection <br> suricata-update enable-source oisf/trafficid <br> suricata-update enable-source sslbl/ssl-fp-blacklist</code> <br> <br>  Et encore une fois, nous mettons √† jour les r√®gles: <br> <code>suricata-update</code> <br> <br>  Suricata est install√©. <br><br>  Maintenant, vous devez obtenir du trafic. <br><br><h3>  Trafr </h3><br>  Trafr est une application √©crite par Mikrotik pour convertir le trafic TZSP en pcap.  L'application est 32 bits, donc pour la lancer, vous devrez activer la prise en charge des applications 32 bits dans Ubunta 64 bits: <br><br> <code>dpkg --add-architecture i386 <br> apt-get update &amp;&amp; apt-get install -y libc6:i386</code> <br> <br>  T√©l√©chargez et d√©compressez le <i><b>trafr</b></i> : <br><br> <code>wget http://www.mikrotik.com/download/trafr.tgz <br> tar xzf trafr.tgz</code> <br> <br>  V√©rifiez que le trafic est capt√©: <br><br> <code>./trafr -s</code> <br> <br>  Apr√®s un tel lancement, la sortie symbolique en mode graphique s'est cass√©e dans la console de la machine virtuelle, j'ai d√ª red√©marrer.  Il n'y a eu aucun probl√®me de connexion √† distance via ssh √† PuTTY. <br><br>  Si vous voyez un scintillement irr√©gulier sur l'√©cran, alors le trafic arrive et le <i><b>trafr le</b></i> rattrape.  Dans l'affirmative, transf√©rez le <i><b>trafr</b></i> √† la r√©sidence permanente et ex√©cutez-le avec la transmission du trafic captur√© par le pipeline imm√©diatement √† Suricata: <br><br> <code>mv trafr /usr/local/bin/ <br> /usr/local/bin/trafr -s | suricata -c /etc/suricata/suricata.yaml -r /dev/stdin <br></code> <br><br>  Maintenant, nous v√©rifions que le trafic arrive √† Suricata, pour cela, nous faisons ce qui suit dans le terminal voisin: <br><br> <code>tail -f /var/log/suricata/fast.log</code> <br> <br>  Vous devriez voir un d√©filement intelligent d'un texte significatif - un journal de r√©ception du trafic de suricates. <br><br>  Il ne sera pas non plus mal de s'assurer que le trafic Suricata non seulement re√ßoit, mais analyse √©galement: <br><br> <code>tail -f /var/log/suricata/eve.json</code> <br> <br>  Il s'agit exactement de la sortie des √©v√©nements de Suricata au format JSON que nous transmettrons √† Filebeat. <br><br><h3>  Elasticsearch + Filebeat + Kibana 6.5 </h3><br>  Nous installons la cl√© PGP n√©cessaire pour utiliser le r√©f√©rentiel Elastic et installons les d√©pendances n√©cessaires: <br><br> <code>wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add - <br> echo "deb https://artifacts.elastic.co/packages/6.x/apt stable main" | sudo tee -a /etc/apt/sources.list.d/elastic-6.x.list <br> apt-get update &amp;&amp; apt-get install -y openjdk-8-jre apt-transport-https wget nginx</code> <br> <br>  Veuillez noter que Java est la version 8. Tout ce qui est sup√©rieur √† 8 n'est pas pris en charge.  Par cons√©quent, si vous avez r√©ussi √† installer un Java plus r√©cent plus t√¥t, d√©molissez-le et mettez 8. <br><br>  Nous nous assurons que Java est install√© comme il se doit: <br><br> <code>java -version</code> <br> <br>  Nous obtenons approximativement la conclusion suivante: <br><blockquote>  version java "1.8.0_191" <br>  Environnement d'ex√©cution Java (TM) SE (build 1.8.0_191-b12) <br>  Machine virtuelle serveur Java HotSpot (TM) 64 bits (build 25.191-b12, mode mixte) </blockquote><br>  Cr√©ez un utilisateur et un mot de passe pour acc√©der √† Kibana.  Au lieu d' <i>admin,</i> choisissez quelque chose que vous pr√©f√©rez: <br><br> <code>echo "admin:`openssl passwd -apr1`" | sudo tee -a /etc/nginx/htpasswd.users</code> <br> <br>  Puisque l'ELK tournera sur localhost, configurez le proxy inverse dans nginx: <br><br> <code>nano /etc/nginx/sites-available/kibana</code> <br> <blockquote>  serveur { <br>  √©couter 80; <br><br>  nom_serveur suricata.server; <br><br>  auth_basic "Acc√®s restreint"; <br>  auth_basic_user_file /etc/nginx/htpasswd.users; <br><br>  emplacement / { <br>  proxy_pass <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">localhost</a> : 5601; <br>  proxy_http_version 1.1; <br>  proxy_set_header Upgrade $ http_upgrade; <br>  proxy_set_header Connection 'upgrade'; <br>  proxy_set_header Host $ host; <br>  proxy_cache_bypass $ http_upgrade; <br>  } <br>  } </blockquote><br> <code>rm /etc/nginx/sites-enabled/default <br> ln -s /etc/nginx/sites-available/kibana /etc/nginx/sites-enabled/kibana <br></code> <br><br>  Red√©marrez nginx: <br><br> <code>systemctl restart nginx</code> <br> <br>  Nous mettons Elasticsearch: <br><br> <code>apt-get install -y elasticsearch</code> <br> <br>  Activez l'ex√©cution automatique lors du chargement du syst√®me d'exploitation: <br><br> <code>systemctl daemon-reload <br> systemctl enable elasticsearch.service</code> <br> <br>  Nous lan√ßons: <br><br> <code>systemctl start elasticsearch.service</code> <br> <br>  V√©rifiez s'il a augment√©: <br><br> <code>curl -X GET "localhost:9200/"</code> <br> <br>  Selon les performances de votre mat√©riel, le d√©marrage d'ES peut prendre un certain temps.  Si la <i>connexion est refus√©e</i> , r√©p√©tez simplement la demande et attendez que nous obtenions quelque chose comme: <br><blockquote>  { <br>  "Nom": "lcZuxxm", <br>  "Cluster_name": "elasticsearch", <br>  "Cluster_uuid": "kmJHqJnlQe2Rk7F-CRi4EA", <br>  "Version": { <br>  "Num√©ro": "6.5.1", <br>  "Build_flavor": "par d√©faut", <br>  "Build_type": "deb", <br>  "Build_hash": "8c58350", <br>  "Build_date": "2018-11-16T02: 22: 42.182257Z", <br>  "Build_snapshot": faux, <br>  "Lucene_version": "7.5.0", <br>  "Minimum_wire_compatibility_version": "5.6.0", <br>  "Minimum_index_compatibility_version": "5.0.0" <br>  }, <br>  Slogan: Vous savez, pour la recherche <br>  } </blockquote><br>  Nous mettons Kibana: <br><br> <code>apt-get install -y kibana</code> <br> <br>  Activez l'ex√©cution automatique lors du chargement du syst√®me d'exploitation: <br><br> <code>systemctl daemon-reload <br> systemctl enable kibana.service</code> <br> <br>  Nous lan√ßons: <br><br> <code>systemctl start kibana.service</code> <br> <br>  Vous pouvez maintenant aller √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">192.168.1.253</a> (bien s√ªr, l'adresse IP est celle qui a √©t√© attribu√©e √† votre machine avec un suricate).  La page de garde de Kibana devrait s'ouvrir. <br><br>  Nous mettons Filebeat: <br><br> <code>apt-get install -y filebeat</code> <br> <br>  Activez l'ex√©cution automatique lors du chargement du syst√®me d'exploitation: <br><br> <code>systemctl daemon-reload <br> systemctl enable filebeat</code> <br> <br>  Nous activons le module Suricata, qui fait partie de l'ensemble de modules Filebeat: <br><br> <code>filebeat modules enable suricata</code> <br> <br>  Installez les plugins pour Suricata dans Elasticsearch: <br><br> <code><s>/usr/share/elasticsearch/bin/elasticsearch-plugin install ingest-geoip <br> /usr/share/elasticsearch/bin/elasticsearch-plugin install ingest-user-agent</s></code> <br>  <b>Voir UPD 22 mai 2019.</b> <br><br>  Red√©marrage d'Elasticsearch: <br><br> <code>systemctl restart elasticsearch.service</code> <br> <br>  Nous effectuons la configuration initiale de Filebeat, tout en chargeant des mod√®les dans Kibana: <br><br> <code>filebeat setup -e</code> <br> <br>  Nous v√©rifions que Filebeat a trouv√© <i>/var/log/suricata/eve.json</i> et le traite. Pour ce faire, ex√©cutez Filebeat en mode de sortie de donn√©es avec le marqueur de <i>publication</i> : <br><br> <code>filebeat -e -d "publish"</code> <br> <br>  Le premier est la sortie au format json de Filebeat lui-m√™me, puis la simple sortie texte de ses journaux, et seulement apr√®s un certain temps la sortie de Suricata, alors attendez et assurez-vous que tout fonctionne.  Apr√®s cela, abandonnez Filebeat et revenez √† bash. <br><br>  Activez l'ex√©cution automatique lors du chargement du syst√®me d'exploitation: <br><br> <code>systemctl daemon-reload <br> systemctl enable filebeat.service</code> <br> <br>  Ex√©cutez Filebeat: <br><br> <code>systemctl start filebeat.service</code> <br> <br>  Allez dans Kibana, s√©lectionnez Dashboard dans le menu de gauche, s√©lectionnez <i><b>filebeat- *</b></i> index.  S√©lectionnez √† nouveau Tableau de bord, s√©lectionnez <b>[Suricata] Aper√ßu des alertes</b> dans la liste, et vous devriez obtenir quelque chose comme ceci: <br><br><img src="https://habrastorage.org/webt/tb/5v/st/tb5vsthdvuyveyetcbba1p_asts.png" alt="image"><br><br><h3>  En option </h3><br>  N'oubliez pas de logrotate, et peu importe la capacit√© du disque dur, Suricata le marquera tr√®s rapidement: <br><br> <code>nano /etc/logrotate.d/suricata</code> <br> <blockquote>  /var/log/suricata/*.log /var/log/suricata/*.json <br>  { <br>  hebdomadaire <br>  tourner 3 <br>  missingok <br>  nocompress <br>  cr√©er <br>  sharedscripts <br>  post-rotation <br>  / bin / kill -HUP `cat /var/run/suricata.pid 2&gt; / dev / null` 2&gt; / dev / null ||  vrai <br>  script de fin <br>  } <br></blockquote><br>  De plus, selon certaines rumeurs, quelqu'un reniflerait r√©guli√®rement √† Mikrotik avec le statut de <i>course</i> √† <i>pied</i> cessant de donner du trafic.  Ensuite, nous √©crivons un script pour red√©marrer le renifleur et l'ex√©cuter selon le calendrier: <br><br> <code>/tool sniffer stop <br> :delay 30s <br> /tool sniffer start</code> <br> <br><h3>  Conclusion </h3><br>  Franchement, je ne suis pas tout √† fait satisfait de la stabilit√© du bundle ci-dessus.  A savoir: cela vaut la peine de red√©marrer, et les miracles commencent.  Une fois, tout sauf un couple a cess√© de traiter mes r√®gles.  J'ai d√ª tout r√©installer.  La deuxi√®me fois, Elasticsearch a g√©n√©ralement cess√© de recevoir des donn√©es de Filebeat et a d√ª revenir √† l'instantan√© de l'√©tat avant de red√©marrer. <br><br>  Je n'ai pas encore r√©solu ces probl√®mes. <br><br>  En outre, il est pr√©vu de mettre en ≈ìuvre l'IPS sur la base des adresses IP des m√©chants identifi√©s par Suricata transf√©r√©s √† Mikrotik. <br><br>  <b>UPD</b> : Les accusations d'instabilit√© sont abandonn√©es.  Ma conclusion sur la fin du traitement des r√®gles √©tait erron√©e.  En fait, la raison du vide dans le tableau de bord apr√®s le red√©marrage est due au fait que Filebeat et Elasticsearch ont besoin d'un temps tr√®s visible pour analyser un fichier json de plusieurs gigaoctets √† partir de meerkat.  Si vous ouvrez le tableau de bord avec des √©v√©nements pour une p√©riode qui inclut la date de <i>cr√©ation du</i> fichier <i>eve.json</i> , vous pouvez voir comment les colonnes du graphique augmentent au fur et √† mesure que le fichier est trait√©.  Parall√®lement aux √©v√©nements trait√©s, des alertes apparaissent dans le tableau de bord correspondant.  De plus, le renifleur dans RouterOS sur x86 n'a jamais √©t√© bloqu√©. <br><br>  <b>UPD 22 mai 2019</b> : √† partir de la version Elasticsearch 6.7, les plugins ingest-geoip et ingest-user-agent ont √©t√© convertis en modules.  Par cons√©quent, l'√©l√©ment avec son installation est ignor√©. <br><br>  De plus, lors de la mise √† niveau, vous obtenez une erreur de d√©marrage Elasticsearch.  Vous verrez une erreur dans les journaux: <br><br><blockquote>  la base de donn√©es attendue [GeoLite2-ASN.mmdb] n'existe pas dans [/ etc / elasticsearch / ingest-geoip] </blockquote><br>  Pour restaurer les performances, nous effectuons: <br><br> <code>/usr/share/elasticsearch/bin/elasticsearch-plugin remove --purge ingest-geoip <br></code> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr431600/">https://habr.com/ru/post/fr431600/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr431586/index.html">Comment g√©rer plus rapidement les erreurs sur la JVM</a></li>
<li><a href="../fr431588/index.html">Loi sur les travailleurs ind√©pendants. Informations √† consid√©rer</a></li>
<li><a href="../fr431590/index.html">La modernisation des parcs √©oliens britanniques obsol√®tes augmentera la production d'√©nergie de 171%</a></li>
<li><a href="../fr431596/index.html">Test de charge de sauvegarde et de r√©plication Veeam</a></li>
<li><a href="../fr431598/index.html">Nous apportons √† Internet une machine virtuelle publique QEMU sans carte r√©seau et essayons d'exploiter</a></li>
<li><a href="../fr431602/index.html">Les d√©veloppeurs russes ont pr√©sent√© √† Londres un syst√®me de r√©adaptation virtuel</a></li>
<li><a href="../fr431604/index.html">Localisation dans Go avec des packages de base</a></li>
<li><a href="../fr431608/index.html">La soci√©t√© am√©ricaine DriveSavers est la premi√®re au monde √† lancer un service de piratage iPhone pour les particuliers</a></li>
<li><a href="../fr431610/index.html">Chef de projet Lifehacks</a></li>
<li><a href="../fr431612/index.html">Bo√Æte √† musique et encodeur rotatif sur carte FPGA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>