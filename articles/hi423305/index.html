<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>тнРя╕П тЪ╛я╕П ЁЯОВ рдмрд░реНрдмрд╛рдж рдкреНрд░рджрд░реНрд╢рди ЁЯУЧ тд╡я╕П ЁЯСитАНЁЯСйтАНЁЯСзтАНЁЯСз</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдпрд╣ рдиреЛрдЯ JPoint 2018 рд╕рдореНрдореЗрд▓рди рд╕реЗ рдореЗрд░реА рд░рд┐рдкреЛрд░реНрдЯ "рдЕрдХреНрд╖рдо рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдХреИрд╕реЗ рдмрд░реНрдмрд╛рдж рдХрд░реЗрдВ" рдХрд╛ рдПрдХ рд▓рд┐рдЦрд┐рдд рд╕рдВрд╕реНрдХрд░рдг рд╣реИред рдЖрдк рд╕рдореНрдореЗрд▓рди рдкреГрд╖реНрда рдкрд░ рд╡реАрдбрд┐рдпреЛ рдФ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдмрд░реНрдмрд╛рдж рдкреНрд░рджрд░реНрд╢рди</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423305/"><p>  рдпрд╣ рдиреЛрдЯ JPoint 2018 рд╕рдореНрдореЗрд▓рди рд╕реЗ рдореЗрд░реА рд░рд┐рдкреЛрд░реНрдЯ "рдЕрдХреНрд╖рдо рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдХреИрд╕реЗ рдмрд░реНрдмрд╛рдж рдХрд░реЗрдВ" рдХрд╛ рдПрдХ рд▓рд┐рдЦрд┐рдд рд╕рдВрд╕реНрдХрд░рдг рд╣реИред рдЖрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдореНрдореЗрд▓рди рдкреГрд╖реНрда</a> рдкрд░ рд╡реАрдбрд┐рдпреЛ рдФрд░ рд╕реНрд▓рд╛рдЗрдб рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред  рдЕрдиреБрд╕реВрдЪреА рдореЗрдВ, рд░рд┐рдкреЛрд░реНрдЯ рдХреЛ рд╕реНрдореВрдереА рдХреЗ рдПрдХ рдЖрдХреНрд░рд╛рдордХ рдЧреНрд▓рд╛рд╕ рдХреЗ рд╕рд╛рде рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╕реБрдкрд░ рдЬрдЯрд┐рд▓ рдХреБрдЫ рднреА рдирд╣реАрдВ рд╣реЛрдЧрд╛, рд╢реБрд░реБрдЖрддреА рд▓реЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдпрд╣ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред </p><br><p>  рд░рд┐рдкреЛрд░реНрдЯ рдХрд╛ рд╡рд┐рд╖рдп: </p><br><ul><li>  рдЗрд╕рдореЗрдВ рдЕрдбрд╝рдЪрдиреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рдХреЛ рдХреИрд╕реЗ рджреЗрдЦреЗрдВ </li><li>  рдЖрдо рдПрдВрдЯреАрдкрд╛рд░реНрдЯрд░реНрди </li><li>  рдЧреИрд░-рд╕реНрдкрд╖реНрдЯ рд░реЗрдХ </li><li>  рд░реЗрдХ рдмрд╛рдпрдкрд╛рд╕ </li></ul><br><p>  рдХрд┐рдирд╛рд░реЗ рдкрд░, рдЙрдиреНрд╣реЛрдВрдиреЗ рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ рдХреБрдЫ рдЧрд▓рддрд┐рдпрд╛рдБ / рдЪреВрдХ рдмрддрд╛рдИ рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рдпрд╣рд╛рдБ рдиреЛрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдЯрд┐рдкреНрдкрдгрд┐рдпрд╛рдБ рднреА рд╕реНрд╡рд╛рдЧрдд рд╣реИред </p><a name="habracut"></a><br><h2 id="vliyanie-poryadka-ispolneniya-na-proizvoditelnost">  рдкреНрд░рджрд░реНрд╢рди рдкрд░ рдкреНрд░рднрд╛рд╡ </h2><br><p>  рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╡рд░реНрдЧ рд╣реИ: </p><br><pre><code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span></span>{ String name; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> age; }</code> </pre> <br><p>  рд╣рдореЗрдВ рд╡рд╕реНрддреБрдУрдВ рдХреА рдПрдХ рджреВрд╕рд░реЗ рд╕реЗ рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо <code>equals</code> рдФрд░ <code>hashCode</code> рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рдШреЛрд╖рдгрд╛ рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lombok.EqualsAndHashCode; <span class="hljs-meta"><span class="hljs-meta">@EqualsAndHashCode</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span></span>{ String name; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> age; }</code> </pre> <br><p>  рдХреЛрдб рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рд╣реИ, рд╕рд╡рд╛рд▓ рдЕрд▓рдЧ рд╣реИ: рдХреНрдпрд╛ рдЗрд╕ рдХреЛрдб рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╣реЛрдЧрд╛?  рдЗрд╕рдХрд╛ рдЙрддреНрддрд░ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдЗрдП <code>Object::equals</code> рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рдпрд╛рдж рдХрд░рддреЗ рд╣реИрдВ <code>Object::equals</code> рд╡рд┐рдзрд┐: рдпрд╣ рдХреЗрд╡рд▓ рддрднреА рд╕рдХрд╛рд░рд╛рддреНрдордХ рдкрд░рд┐рдгрд╛рдо рджреЗрддрд╛ рд╣реИ рдЬрдм рддреБрд▓рдирд╛ рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ рд╕рднреА рдлрд╝реАрд▓реНрдб рд╕рдорд╛рди рд╣реЛрдВ, рдЕрдиреНрдпрдерд╛ рдкрд░рд┐рдгрд╛рдо рдирдХрд╛рд░рд╛рддреНрдордХ рд╣реЛрдЧрд╛ред  рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рдПрдХ рдЕрдВрддрд░ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рдирдХрд╛рд░рд╛рддреНрдордХ рдкрд░рд┐рдгрд╛рдо рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред </p><br><p>  <code>@EqualsAndHashCode</code> рд▓рд┐рдП рдЬрдирд░реЗрдЯ рдХрд┐рдП рдЧрдП рдХреЛрдб рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ <code>@EqualsAndHashCode</code> рд╣рдо рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рджреЗрдЦреЗрдВрдЧреЗ: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object that)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//... if (name == null &amp;&amp; that.name != null) { return false; } if (name != null &amp;&amp; !name.equals(that.name)) { return false; } return age == that.age; }</span></span></code> </pre> <br><p>  рдЦреЗрддреЛрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░рдиреЗ рдХрд╛ рдХреНрд░рдо рдЙрдирдХреА рдШреЛрд╖рдгрд╛ рдХреЗ рдХреНрд░рдо рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ, рдЬреЛ рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╕рдорд╛рдзрд╛рди рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ <code>equals</code> рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реА рд╡рд╕реНрддреБрдУрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░рдирд╛ рд╕рд░рд▓ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ "рдХрдард┐рди" рд╣реИред </p><br><p>  рдареАрдХ рд╣реИ, рдЖрдЗрдП рдЖрдЗрдбрд┐рдпрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ <code>equals/hashCode</code> рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object o)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == o) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (o == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || getClass() != o.getClass()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } User that = (User) o; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> age == that.age &amp;&amp; Objects.equals(name, that.name); }</code> </pre> <br><p>  рдПрдХ рдЖрдЗрдбрд┐рдпрд╛ рд╕реНрдорд╛рд░реНрдЯ рдХреЛрдб рдмрдирд╛рддрд╛ рд╣реИ рдЬреЛ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдбреЗрдЯрд╛ рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреА рдЬрдЯрд┐рд▓рддрд╛ рдХреЛ рдЬрд╛рдирддрд╛ рд╣реИред  рдЦреИрд░, рд╣рдо <code>@EqualsAndHashCode</code> рдХреЛ <code>@EqualsAndHashCode</code> рдФрд░ рд╣рдо рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ <code>equals/hashCode</code> <code>@EqualsAndHashCode</code> рд▓рд┐рдЦреЗрдВрдЧреЗред  рдЕрдм рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдЬрдм рдХреНрд▓рд╛рд╕ рдмрдврд╝рддреА рд╣реИ рддреЛ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ: </p><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span></span>{ List&lt;T&gt; props; String name; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> age; }</code> </pre> <br><p>  <code>equals/hashCode</code> : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object o)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == o) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (o == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || getClass() != o.getClass()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } User that = (User) o; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> age == that.age &amp;&amp; Objects.equals(props, that.props) <span class="hljs-comment"><span class="hljs-comment">// &lt;---- &amp;&amp; Objects.equals(name, that.name); }</span></span></code> </pre> <br><p>  рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╕реВрдЪреА рдХреА рддреБрд▓рдирд╛ рдХреА рдЬрд╛рддреА рд╣реИ, рдЬреЛ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдЕрд▓рдЧ рд╣реЛрдиреЗ рдкрд░ рдХреЛрдИ рдорддрд▓рдм рдирд╣реАрдВ рд╣реИред  рдкрд╣рд▓реА рдирдЬрд╝рд░ рдореЗрдВ, рдмрд╣реБрдд рдЕрдВрддрд░ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╕рдорд╛рди рд▓рдВрдмрд╛рдИ рдХреЗ рддрд╛рд░реЛрдВ рдХреА рддреБрд▓рдирд╛ рд╕рдВрдХреЗрддреЛрдВ рджреНрд╡рд╛рд░рд╛ рдХреА рдЬрд╛рддреА рд╣реИ (рдпрд╛рдиреА, рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреА рд▓рдВрдмрд╛рдИ рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рд╕рдордп рдмрдврд╝рддрд╛ рд╣реИ): </p><br><div class="spoiler">  <b class="spoiler_title">рдПрдХ рдЕрд╢реБрджреНрдзрд┐ рдереА</b> <div class="spoiler_text"><p>  <code>java.lang.String::equals</code> <a href="">рд╡рд┐рдзрд┐ рдШреБрд╕рдкреИрда рд╣реИ</a> , рдЗрд╕рд▓рд┐рдП рдирд┐рд╖реНрдкрд╛рджрди рдкрд░ рддреБрд▓рдирд╛ рдкрд░ рдХреЛрдИ рд╕рдВрдХреЗрдд рдирд╣реАрдВ рд╣реИред </p></div></div><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//java.lang.String public boolean equals(Object anObject) { if (this == anObject) { return true; } if (anObject instanceof String) { String anotherString = (String) anObject; int n = value.length; if (n == anotherString.value.length) { char v1[] = value; char v2[] = anotherString.value; int i = 0; while (n-- != 0) { // &lt;---- if (v1[i] != v2[i]) return false; i++; } return true; } } return false; }</span></span></code> </pre> <br><p>  рдЕрдм рджреЛ <code>ArrayList</code> (рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕реВрдЪреА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рд░реВрдк рдореЗрдВ) рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред  <code>ArrayList</code> , рд╣рдо рдпрд╣ рдЬрд╛рдирдХрд░ рдЖрд╢реНрдЪрд░реНрдпрдЪрдХрд┐рдд рд╣реИрдВ рдХрд┐ рдЗрд╕рдореЗрдВ <code>equals</code> рдХрд╛ рдЕрдкрдирд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/d4/hn/yg/d4hnyguezlpyxz3pgunk22ha1cm.png"></p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//AbstractList::equals public boolean equals(Object o) { if (o == this) { return true; } if (!(o instanceof List)) { return false; } ListIterator&lt;E&gt; e1 = listIterator(); ListIterator&lt;?&gt; e2 = ((List&lt;?&gt;) o).listIterator(); while (e1.hasNext() &amp;&amp; e2.hasNext()) { // &lt;---- E o1 = e1.next(); Object o2 = e2.next(); if (!(o1 == null ? o2 == null : o1.equals(o2))) { return false; } } return !(e1.hasNext() || e2.hasNext()); }</span></span></code> </pre> <br><p>  рдпрд╣рд╛рдБ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рджреЛ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпреЛрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдФрд░ рдЙрдирдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬреЛрдбрд╝реАрджрд╛рд░ рдорд╛рд░реНрдЧред  рдорд╛рди рд▓реЗрдВ рдХрд┐ рджреЛ <code>ArrayList</code> : </p><br><ul><li>  1 рд╕реЗ 99 рддрдХ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ </li><li>  1 рд╕реЗ 100 рддрдХ рджреВрд╕рд░реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ </li></ul><br><p>  рдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ, рдпрд╣ рджреЛ рд╕реВрдЪрд┐рдпреЛрдВ рдХреЗ рдЖрдХрд╛рд░ рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрдЧрд╛ рдФрд░ рдпрджрд┐ рд╡реЗ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддреЗ рд╣реИрдВ, рддреЛ рддреБрд░рдВрдд рдПрдХ рдирдХрд╛рд░рд╛рддреНрдордХ рдкрд░рд┐рдгрд╛рдо рд▓реМрдЯрд╛рддреЗ рд╣реИрдВ (рдЬреИрд╕рд╛ рдХрд┐ <code>AbstractSet</code> рдХрд░рддрд╛ рд╣реИ), рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, 99 рддреБрд▓рдирд╛рдПрдВ рдХреА рдЬрд╛рдПрдВрдЧреА рдФрд░ рдХреЗрд╡рд▓ рд╕реМрд╡реЗрдВ рдкрд░ рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реЛ рдЬрд╛рдПрдЧрд╛ рдХрд┐ рд╕реВрдЪрд┐рдпрд╛рдВ рдЕрд▓рдЧ рд╣реИрдВред </p><br><h4 id="chyo-tam-u-kotlinovcev">  рдХреЛрдЯрд▓реАрдирд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдХреНрдпрд╛ рд╣реИ? </h4><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">data</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">val</span></span> name: String, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> age: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>);</code> </pre> <br><p>  рдпрд╣рд╛рдБ рд╕рдм рдХреБрдЫ рд▓реЛрдореНрдмреЛрдХ рдЬреИрд╕рд╛ рд╣реИ - рддреБрд▓рдирд╛ рдХреНрд░рдо рдШреЛрд╖рдгрд╛ рдХреЗ рдХреНрд░рдо рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object o)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == o) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (o <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> User) { User u = (User) o; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Intrinsics.areEqual(name, u.name) &amp;&amp; age == u.age) { <span class="hljs-comment"><span class="hljs-comment">// &lt;---- return true; } } return false; }</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдХреИрд╕реЗ рд╕реБрдзрд░реЗ рд╣рд╛рд▓рд╛рдд?</b>  <b class="spoiler_title">- рд╢рд┐рдХрд╛рдпрдд рдХрд░реЛ!</b> <div class="spoiler_text"><p>  IDEA-170178 рд╕рдВрдЧреНрд░рд╣ рдХреА рддреБрд▓рдирд╛ IDEA- рдЬрдирд┐рдд рдмрд░рд╛рдмрд░реА рдХреЗ рдЕрдВрдд рдореЗрдВ рдХреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП () <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-170178</a> </p><br><p>  рдмреЗрд╣рддрд░ рдкреНрд░рджрд░реНрд╢рди # 1543 рдХреЗ рд▓рд┐рдП @EqualsAndHashCode рдореЗрдВ рддреБрд▓рдирд╛ рдХрд╛ рдкреБрди: рдкрд░реАрдХреНрд╖рдг <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://github.com/rzwitserloot/lombok/issues/1543</a> </p><br><p>  рдбреЗрдЯрд╛ рд╡рд░реНрдЧ рдХрд╛ KT-23184 рдСрдЯреЛ-рдЬреЗрдирд░реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╕рдорд╛рди () рдЗрд╖реНрдЯрддрдо рдирд╣реАрдВ рд╣реИ <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://youtrack.jetbrains.com/issue/KT-23184</a> </p></div></div><br><p>  рд╡рд░реНрдХрдЕрд░рд╛рдЙрдВрдб рдХреЗ рд░реВрдк рдореЗрдВ, рдЖрдк рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдлрд╝реАрд▓реНрдб рдШреЛрд╖рдгрд╛рдУрдВ рдХреЛ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><h4 id="uslozhnim-zadachu">  рдЖрдЗрдП рдХрд╛рд░реНрдп рдХреЛ рдЬрдЯрд┐рд▓ рдХрд░рддреЗ рд╣реИрдВ </h4><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">check</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Dto dto)</span></span></span><span class="hljs-function"> </span></span>{ SomeEntity entity = jpaRepository.findOne(dto.getId()); <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> valid = dto.isValid(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (valid &amp;&amp; entity.hasGoodRating()) { <span class="hljs-comment"><span class="hljs-comment">// &lt;---- //do smth } }</span></span></code> </pre> <br><p>  рдХреЛрдб рдореЗрдВ рдбреЗрдЯрд╛рдмреЗрд╕ рддрдХ рдкрд╣реБрдВрдЪ рд╢рд╛рдорд┐рд▓ рд╣реИ, рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЬрдм рддреАрд░ рджреНрд╡рд╛рд░рд╛ рдЗрдВрдЧрд┐рдд рд╢рд░реНрддреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдЕрдЧреНрд░рд┐рдо рдореЗрдВ рдЕрдиреБрдорд╛рдирд┐рдд рд╣реИред  рдпрджрд┐ <code>valid</code> рдЪрд░ рдХрд╛ рдорд╛рди рдЧрд▓рдд рд╣реИ, рддреЛ <code>if</code> рдмреНрд▓реЙрдХ рдореЗрдВ рдХреЛрдб рдХрднреА рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдирд╣реАрдВ рд╣реЛрдЧрд╛, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдЖрдк рдЕрдиреБрд░реЛрдз рдХреЗ рдмрд┐рдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">check</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Dto dto)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> valid = dto.isValid(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (valid &amp;&amp; hasGoodRating(dto)) { <span class="hljs-comment"><span class="hljs-comment">//do smth } } //       ,    boolean hasGoodRating(Dto dto) { SomeEntity entity = jpaRepository.findOne(dto.getId()); return entity.hasGoodRating(); }</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдХрд┐рдирд╛рд░реЗ рд╕реЗ рдзреНрдпрд╛рди рджреЗрдВ</b> <div class="spoiler_text"><p>  рдЬрдм рдЗрдХрд╛рдИ <code>JpaRepository::findOne</code> рд╕реЗ рд╡рд╛рдкрд╕ рд▓реМрдЯрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддреЛ рдирд┐рд░рд░реНрдердХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ <code>JpaRepository::findOne</code> рдкрд╣рд▓реЗ <code>JpaRepository::findOne</code> рд╣реА рдкрд╣рд▓реЗ рд╕реНрддрд░ рдХреЗ рдХреИрд╢ рдореЗрдВ рд╣реИ - рдлрд┐рд░ рдХреЛрдИ рдЕрдиреБрд░реЛрдз рдирд╣реАрдВ рд╣реЛрдЧрд╛ред </p></div></div><br><p>  рд╕реНрдкрд╖реНрдЯ рд╢рд╛рдЦрд╛ рдХреЗ рдмрд┐рдирд╛ рдПрдХ рд╕рдорд╛рди рдЙрджрд╛рд╣рд░рдг: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkChild</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Dto dto)</span></span></span><span class="hljs-function"> </span></span>{ Long id = dto.getId(); Entity entity = jpaRepository.findOne(id); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dto.isValid() &amp;&amp; entity.hasChild(); }</code> </pre> <br><p>  рдПрдХ рддреНрд╡рд░рд┐рдд рд╡рд╛рдкрд╕реА рдЖрдкрдХреЛ рдЕрдиреБрд░реЛрдз рдореЗрдВ рджреЗрд░реА рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkChild</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Dto dto)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!dto.isValid()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> jpaRepository.findOne(dto.getId()).hasChild(); }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдПрдХ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рд╕реНрдкрд╖реНрдЯ рдЬреЛрдбрд╝ рдЬреЛ рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджрд┐рдпрд╛</b> <div class="spoiler_text"><p>  рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ рдХрд┐ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдЪреЗрдХ рдПрдХ рд╕рдорд╛рди рдЗрдХрд╛рдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ParentEntity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@ManyToOne</span></span>(fetch = LAZY) <span class="hljs-meta"><span class="hljs-meta">@JoinColumn</span></span>(name = <span class="hljs-string"><span class="hljs-string">"CHILD_ID"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ChildEntity child; <span class="hljs-meta"><span class="hljs-meta">@Enumerated</span></span>(EnumType.String) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SomeType type;</code> </pre> <br><p>  рдпрджрд┐ рдЪреЗрдХ рдПрдХ рд╣реА рдЗрдХрд╛рдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдкрд╣рд▓реЗ рд╕реЗ рд▓реЛрдб рдХрд┐рдП рдЧрдП рдлрд╝реАрд▓реНрдб рдореЗрдВ рдХреЙрд▓ рдХреЗ рдмрд╛рдж "рдЖрд▓рд╕реА" рдмрд╛рд▓ рд╕рдВрд╕реНрдерд╛рдУрдВ / рд╕рдВрдЧреНрд░рд╣ рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдкрд╣рд▓реА рдирдЬрд╝рд░ рдореЗрдВ, рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдЕрдиреБрд░реЛрдз рдХрд╛ рд╕рдордЧреНрд░ рдЪрд┐рддреНрд░ рдкрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рдкрдбрд╝реЗрдЧрд╛, рд▓реЗрдХрд┐рди рдЬрдм рдХреЛрдИ рдХрд╛рд░реНрдп рд▓реВрдк рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рд╕рдм рдХреБрдЫ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИред </p></div></div><br><p>  рдирд┐рд╖реНрдХрд░реНрд╖: рд╡реНрдпрдХреНрддрд┐рдЧрдд рдХрд╛рд░реНрдпреЛрдВ рдХреА рдмрдврд╝рддреА рдЬрдЯрд┐рд▓рддрд╛ рдХреЗ рдХреНрд░рдо рдореЗрдВ рдХрд╛рд░реНрдпреЛрдВ / рдЪреЗрдХреЛрдВ рдХреА рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рдЖрджреЗрд╢ рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рд╢рд╛рдпрдж рдЙрдирдореЗрдВ рд╕реЗ рдХреБрдЫ рдХреЛ рдкреНрд░рджрд░реНрд╢рди рдирд╣реАрдВ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред </p><br><h2 id="cikly-i-massovaya-obrabotka">  рдЪрдХреНрд░ рдФрд░ рдереЛрдХ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг </h2><br><p>  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдХреЛ рд╡рд┐рд╢реЗрд╖ рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">enrollStudents</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Set&lt;Long&gt; ids)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Long id : ids) { Student student = jpaRepository.findOne(id); <span class="hljs-comment"><span class="hljs-comment">// &lt;---- O(n) enroll(student); } }</span></span></code> </pre> <br><p>  рдХрдИ рдбреЗрдЯрд╛рдмреЗрд╕ рдкреНрд░рд╢реНрдиреЛрдВ рдХреЗ рдХрд╛рд░рдг, рдХреЛрдб рдзреАрдорд╛ рд╣реИред </p><br><div class="spoiler">  <b class="spoiler_title">рдЯрд┐рдкреНрдкрдгреА</b> <div class="spoiler_text"><p>  рдкреНрд░рджрд░реНрд╢рди рддрдм рдФрд░ рднреА рдЕрдзрд┐рдХ рдбреВрдм рд╕рдХрддрд╛ рд╣реИ, рдЬрдм рдХрд┐рд╕реА рд▓реЗрдирджреЗрди рдХреЗ рдмрд╛рд╣рд░ <code>enrollStudents</code> рд╡рд┐рдзрд┐ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХреА рдЬрд╛рддреА рд╣реИ: рддреЛ <code>osdjrJpaRepository::findOne</code> <strong>рдкреНрд░рддреНрдпреЗрдХ</strong> рдХреЙрд▓ <code>osdjrJpaRepository::findOne</code> рдХреЛ рдПрдХ рдирдП рд▓реЗрди-рджреЗрди ( <a href="">SimpleJpaRepository</a> рджреЗрдЦреЗрдВ) рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдХрдиреЗрдХреНрд╢рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдФрд░ рд╡рд╛рдкрд╕ рдХрд░рдирд╛, рд╕рд╛рде рд╣реА рд╕рд╛рде рдкреНрд░рдердо рд╕реНрддрд░ рдХреИрд╢ рдмрдирд╛рдирд╛ рдФрд░ рдлреНрд▓рд╢рд┐рдВрдЧ рдХрд░рдирд╛ред </p></div></div><br><p>  рдареАрдХ: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">enrollStudents</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Set&lt;Long&gt; ids)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ids.isEmpty()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Student student : jpaRepository.findAll(ids)) { enroll(student); } }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдЪрд▓реЛ рдЪрд╛рдмрд┐рдпреЛрдВ рдХреЗ рд╕рдВрдЧреНрд░рд╣ рдХреЗ рд▓рд┐рдП рд░рдирдЯрд╛рдЗрдо (рдорд╛рдЗрдХреНрд░реЛрд╕реЗрдХрдВрдб рдореЗрдВ) рдХреЛ рдорд╛рдкреЗрдВ (10 рдФрд░ 100 рдЯреБрдХрдбрд╝реЗ)</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/p2/0b/zq/p20bzq2tlnp3-mj8zlx8c96411e.png"></p></div></div><br><p>  <a href="">рдмреЗрдВрдЪрдорд╛рд░реНрдХ</a> </p><br><div class="spoiler">  <b class="spoiler_title">рдЯрд┐рдкреНрдкрдгреА</b> <div class="spoiler_text"><p>  рдпрджрд┐ рдЖрдк Oracle рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ <code>findAll</code> рд▓рд┐рдП 1000 рд╕реЗ рдЕрдзрд┐рдХ рдХреБрдВрдЬрд┐рдпрд╛рдБ рдкрд╛рд╕ <code>findAll</code> , рддреЛ рдЖрдкрдХреЛ рдЕрдкрд╡рд╛рдж <code>ORA-01795: maximum number of expressions in a list is 1000</code> <code>findAll</code> рдорд┐рд▓реЗрдЧрд╛ <code>ORA-01795: maximum number of expressions in a list is 1000</code> ред <br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдПрдХ рднрд╛рд░реА (рдХрдИ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде) -рд╕реАрд░реАрдЬ <code>in</code> рдкреНрд░рджрд░реНрд╢рди рдХрд░рдирд╛ рдПрди рдкреНрд░рд╢реНрдиреЛрдВ рд╕реЗ рднреА рдмрджрддрд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  рдпрд╣ рд╕рдм рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЪрдХреНрд░ рдХреЗ рдмрдбрд╝реЗ рдкреИрдорд╛рдиреЗ рдкрд░ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП рдпрд╛рдВрддреНрд░рд┐рдХ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдиреАрдЪрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИред </p></div></div><br><h4 id="bolee-slozhnyy-primer-na-tu-zhe-temu">  рдПрдХ рд╣реА рд╡рд┐рд╖рдп рдкрд░ рдПрдХ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рдЙрджрд╛рд╣рд░рдг </h4><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Long id : ids) { Region region = jpaRepository.findOne(id); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (region == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// &lt;----  region = new Region(); region.setId(id); } use(region); }</span></span></code> </pre> <br><p>  рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рд╣рдо рд▓реВрдк рдХреЛ <code>JpaRepository::findAll</code> рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ, <code>JpaRepository::findAll</code> рдпрд╣ рддрд░реНрдХ рдХреЛ рддреЛрдбрд╝ рджреЗрдЧрд╛: <code>JpaRepository::findAll</code> рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╕рднреА рдорд╛рди <code>JpaRepository::findAll</code> <code>null</code> рдирд╣реАрдВ рд╣реЛрдЧрд╛ рдФрд░ <code>if</code> рдмреНрд▓реЙрдХ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред </p><br><p>  рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреБрдВрдЬреА рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдЗрд╕ рдХрдард┐рдирд╛рдИ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧрд╛ <br>  рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдореВрд▓реНрдп рдпрд╛ рдЙрд╕рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдпрд╛ рддреЛ рджреЗрддрд╛ рд╣реИред  рдпрд╛рдиреА рдПрдХ рдЕрд░реНрде рдореЗрдВ, рдПрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рд╣реИред  рдмреЙрдХреНрд╕ рд╕реЗ рдЬрд╛рд╡рд╛ рд╣рдореЗрдВ рдбрд┐рдХреНрд╢рдирд░реА рдХрд╛ рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рд╣реБрдЖ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рджреЗрддрд╛ рд╣реИ - <code>HashMap</code> - рдЬрд┐рд╕рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд╣рдо рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рддрд░реНрдХ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░реЗрдВрдЧреЗ: </p><br><pre> <code class="java hljs">Map&lt;Long, Region&gt; regionMap = jpaRepository.findAll(ids) .stream() .collect(Collectors.toMap(Region::getId, Function.identity())); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Long id : ids) { Region region = map.get(id); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (region == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { region = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Region(); region.setId(id); } use(region); }</code> </pre> <br><h4 id="primer-v-obratnuyu-storonu">  рдЙрд▓реНрдЯрд╛ рдЙрджрд╛рд╣рд░рдг </h4><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// class Saver @Transactional(propagation = Propagation.REQUIRES_NEW) public void save(List&lt;AuditEntity&gt; entities) { jpaRepository.save(entities); }</span></span></code> </pre> <br><p>  рдпрд╣ рдХреЛрдб рд╣рдореЗрд╢рд╛ рд╕рдВрд╕реНрдерд╛рдУрдВ рдХреА рд╕реВрдЪреА рдХреЛ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдирдпрд╛ рд▓реЗрдирджреЗрди рдмрдирд╛рддрд╛ рд╣реИред  рдПрдХ рдирдП рд▓реЗрдирджреЗрди рдХреЛ рдЦреЛрд▓рдиреЗ рд╡рд╛рд▓реЗ рддрд░реАрдХреЗ рд╕реЗ рдХрдИ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ: </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//   @Transactional public void audit(List&lt;AuditDto&gt; inserts) { inserts.map(this::toEntities).forEach(saver::save); // &lt;---- } // class Saver @Transactional(propagation = Propagation.REQUIRES_NEW) // &lt;---- public void save(List&lt;AuditEntity&gt; entities) { jpaRepository.save(entities); }</span></span></code> </pre> <br><p>  рд╕рдорд╛рдзрд╛рди: <code>Saver::save</code> рд▓рд╛рдЧреВ рдХрд░реЗрдВ <code>Saver::save</code> рд╕рдВрдкреВрд░реНрдг рдбреЗрдЯрд╛ рд╕реЗрдЯ рдХреЗ рд▓рд┐рдП рддреБрд░рдВрдд рд╡рд┐рдзрд┐ <code>Saver::save</code> : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">audit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;AuditDto&gt; inserts)</span></span></span><span class="hljs-function"> </span></span>{ List&lt;AuditEntity&gt; bulk = inserts .map(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::toEntities) .flatMap(List::stream) <span class="hljs-comment"><span class="hljs-comment">// &lt;---- .collect(toList()); saver.save(bulk); }</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдмрд╣реБрдд рд╕рд╛рд░реЗ рд▓реЗрди-рджреЗрди рдПрдХ рдореЗрдВ рд╡рд┐рд▓рдп рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ, рдЬреЛ рдПрдХ рдареЛрд╕ рд╡реГрджреНрдзрд┐ (рдорд╛рдЗрдХреНрд░реЛрд╕реЗрдХрдВрдб рдореЗрдВ рд╕рдордп) рджреЗрддрд╛ рд╣реИ:</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/f7/3r/n9/f73rn9gtjw7fdgiqrfwkq7tfme4.png"></p></div></div><br><p>  <a href="">рдмреЗрдВрдЪрдорд╛рд░реНрдХ</a> </p><br><p>  рдХрдИ рд▓реЗрди-рджреЗрди рдХреЗ рд╕рд╛рде рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЛ рдФрдкрдЪрд╛рд░рд┐рдХ рдмрдирд╛рдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реИ, рдЬрд┐рд╕реЗ <code>JpaRepository::findOne</code> рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдирд╣реАрдВ рдХрд╣рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ <code>JpaRepository::findOne</code> рдПрдХ рд▓реВрдк рдореЗрдВред </p><br><div class="spoiler">  <b class="spoiler_title">рдЗрд╕рд▓рд┐рдП, рд╣рдо рдЙрдкрд╛рдп рдХрд░реЗрдВрдЧреЗ</b> <div class="spoiler_text"><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-165730</a> <br>  IDEA-165730 JpaRepository рдХреЗ рдЕрдХреНрд╖рдо рдЙрдкрдпреЛрдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЪреЗрддрд╛рд╡рдиреА </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-165942</a> <br><del>  рдЖрдИрдбрд┐рдпрд╛ -165 942 </del>  рдмрд▓реНрдХ рдСрдкрд░реЗрд╢рди рдХреЗ рд╕рд╛рде рд▓реВрдк рдореЗрдВ рд╡рд┐рдзрд┐ рдХреЙрд▓ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реАрдХреНрд╖рдг <br>  <strong>2017.1 рдореЗрдВ рддрдп рдХрд┐рдпрд╛ рдЧрдпрд╛</strong> </p></div></div><br><p>  рджреГрд╖реНрдЯрд┐рдХреЛрдг рди рдХреЗрд╡рд▓ рдбреЗрдЯрд╛рдмреЗрд╕ рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" class="user_link">рдЯреИрдЧрд┐рд░ рд▓рд╛рдиреА рд╡рд▓реЗрд╡</a> рдЖрдЧреЗ рдмрдврд╝ рдЧрдПред  рдФрд░ рдЕрдЧрд░ рдкрд╣рд▓реЗ рд╣рдордиреЗ рдРрд╕рд╛ рд▓рд┐рдЦрд╛ рдерд╛: </p><br><pre> <code class="java hljs">List&lt;Long&gt; list = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Long id : items) { list.add(id); }</code> </pre> <br><p>  рдФрд░ рд╕рдм рдХреБрдЫ рдареАрдХ рдерд╛, рдЕрдм "рдЖрдЗрдбрд┐рдпрд╛" рдЦреБрдж рдХреЛ рд╕рд╣реА рдХрд░рдиреЗ рдХрд╛ рд╕реБрдЭрд╛рд╡ рджреЗрддрд╛ рд╣реИ: </p><br><pre> <code class="java hljs">List&lt;Long&gt; list = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); list.addAll(items);</code> </pre> <br><p>  рд▓реЗрдХрд┐рди рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдпрд╣ рд╡рд┐рдХрд▓реНрдк рд╣рдореЗрд╢рд╛ рдЗрд╕реЗ рд╕рдВрддреБрд╖реНрдЯ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЖрдк рдЗрд╕реЗ рдФрд░ рднреА рдЫреЛрдЯрд╛ рдФрд░ рддреЗрдЬ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="java hljs">List&lt;Long&gt; list = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(items);</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рддреБрд▓рдирд╛ (рдПрдирдПрд╕ рдореЗрдВ рд╕рдордп)</b> <div class="spoiler_text"><p>  ArrayList рдХреЗ рд▓рд┐рдП, рдпрд╣ рд╕реБрдзрд╛рд░ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╡реГрджреНрдзрд┐ рджреЗрддрд╛ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/gi/6j/o8/gi6jo8xwigpdckqz6jtuw4cmane.png"></p><br><p>  рд╣реИрд╢рд╕реЗрдЯ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдЗрддрдирд╛ рд░рд╕рджрд╛рд░ рдирд╣реАрдВ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/u9/lo/fy/u9lofyf2wy2hffk8gd0uwvrmmke.png"></p></div></div><br><p>  <a href="">рдмреЗрдВрдЪрдорд╛рд░реНрдХ</a> </p><br><div class="spoiler">  <b class="spoiler_title">рдбреЗрд╡рд▓рдкрд░ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА:</b> <div class="spoiler_text"><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-138456</a> <br><del>  рдЖрдИрдбрд┐рдпрд╛-138,456 </del>  рдирдпрд╛ рдирд┐рд░реАрдХреНрд╖рдг: Collection.addAll () рдкреИрд░рд╛рдЯреНрд░рд╛рдЗрдЬреНрдб рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдХреЗ рд╕рд╛рде рдмрджрд▓реА рдЬрд╛рдиреЗ рдпреЛрдЧреНрдп <br>  <strong>142.1217 рдореЗрдВ рддрдп рдХрд┐рдпрд╛ рдЧрдпрд╛</strong> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-178761</a> <br><del>  рдЖрдИрдбрд┐рдпрд╛-178 761 </del>  рдирд┐рд░реАрдХреНрд╖рдг 'Collection.addAll () рдкреИрд░рд╛рдореАрд░рд┐рдЬреНрдб рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдХреЗ рд╕рд╛рде рдмрджрд▓реА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА' рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЪрд╛рд▓реВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП <br>  <strong>2017.3 рдореЗрдВ рддрдп рдХрд┐рдпрд╛ рдЧрдпрд╛</strong> </p></div></div><br><h4 id="udalenie-iz-arraylist-a">  <code>ArrayList</code> рд╕реЗ рд╣рдЯрд╛рдирд╛ </h4><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = from; i &lt; to; i++) { list.remove(from); }</code> </pre> <br><p>  рд╕рдорд╕реНрдпрд╛ <code>List::remove</code> рд╡рд┐рдзрд┐ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдореЗрдВ рд╣реИ: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> E </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">remove</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index)</span></span></span><span class="hljs-function"> </span></span>{ Objects.checkIndex(index, size); modCount++; E oldValue = elementData(index); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> numMoved = size - index - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numMoved &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { System.arraycopy(array, index + <span class="hljs-number"><span class="hljs-number">1</span></span>, array, index, numMoved); <span class="hljs-comment"><span class="hljs-comment">// &lt;---- } array[--size] = null; // clear to let GC do its work return oldValue; }</span></span></code> </pre> <br><p>  рд╕рдорд╛рдзрд╛рди: </p><br><pre> <code class="java hljs">list.subList(from, to).clear();</code> </pre> <br><p>  рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдпрджрд┐ рд╕реНрд░реЛрдд рдХреЛрдб рдореЗрдВ рджреВрд░рд╕реНрде рдореВрд▓реНрдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ? </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = from; i &lt; to; i++) { E removed = list.remove(from); use(removed); }</code> </pre> <br><p>  рдЕрдм рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рд╕рд╛рдл рдХреА рдЧрдИ рд╕реВрдЪреА рд╕реЗ рдЧреБрдЬрд░рдирд╛ рд╣реЛрдЧрд╛: </p><br><pre> <code class="java hljs">List&lt;String&gt; removed = list.subList(from, to); removed.forEach(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::use); removed.clear();</code> </pre> <br><p>  рдпрджрд┐ рдЖрдк рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЪрдХреНрд░ рдореЗрдВ рд╣рдЯрд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╕реВрдЪреА рд╕реЗ рдЧреБрдЬрд░рдиреЗ рдХреА рджрд┐рд╢рд╛ рдореЗрдВ рдмрджрд▓рд╛рд╡ рд╕реЗ рджрд░реНрдж рдХреЛ рдХрдо рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдорд┐рд▓реЗрдЧреАред  рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╕реЗрд▓ рдХреА рд╕рдлрд╛рдИ рдХреЗ рдмрд╛рдж рдХрдо рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рддрддреНрд╡реЛрдВ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдирд╛ рд╣реИ: </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//   , . .       for (int i = from; i &lt; to; i++) { E removed = list.remove(from); use(removed, i); } //  , . .    for (int i = to - 1; i &gt;= from; i--) { E removed = list.remove(i); use(removed, reverseIndex(i)); }</span></span></code> </pre> <br><p>  рд╕рднреА рддреАрди рддрд░реАрдХреЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВ (рдХреЙрд▓рдо рдХреЗ рддрд╣рдд 100 рдЖрдЗрдЯрдо рдХреА рд╕реВрдЪреА рд╕реЗ 100% рд╣рдЯрд╛рдП рдЧрдП рдЖрдЗрдЯрдо рд╣реИрдВ): </p><br><div class="spoiler">  <b class="spoiler_title">рдЬрд╛рд╡рд╛ 8</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/4h/ii/tq/4hiitqg5a7d3bk6lxi8od422yky.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">рдЬрд╛рд╡рд╛ реп</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ow/mo/ty/owmotysgwdqquagklf1yhlrquz0.png"></p></div></div><br><p>  рд╡реИрд╕реЗ, рдХреНрдпрд╛ рдХрд┐рд╕реА рдиреЗ рд╡рд┐рд╕рдВрдЧрддрд┐ рдХреЛ рдиреЛрдЯрд┐рд╕ рдХрд┐рдпрд╛? </p><br><div class="spoiler">  <b class="spoiler_title">рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/xm/ni/s9/xmnis9jllk8rozgh8xacdneyhd8.png"></p><br><p>  рдпрджрд┐ рд╣рдо рдЕрдВрдд рд╕реЗ рдЪрд▓ рд░рд╣реЗ рд╕рднреА рдбреЗрдЯрд╛ рдХреЛ рд╣рдЯрд╛ рджреЗрддреЗ рд╣реИрдВ, рддреЛ рдЕрдВрддрд┐рдо рддрддреНрд╡ рд╣рдореЗрд╢рд╛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдХреЛрдИ рдмрджрд▓рд╛рд╡ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ: </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// ArrayList public E remove(int index) { rangeCheck(index); modCount++; E oldValue = elementData(index); int numMoved = size - index - 1; if (numMoved &gt; 0) { // &lt;----     System.arraycopy(elementData, index+1, elementData, index, numMoved); } elementData[--size] = null; // clear to let GC do its work return oldValue; }</span></span></code> </pre> </div></div><br><p>  <a href="">рдмреЗрдВрдЪрдорд╛рд░реНрдХ</a> </p><br><div class="spoiler">  <b class="spoiler_title">рдбреЗрд╡рд▓рдкрд░ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИ</b> <div class="spoiler_text"><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-177466</a> <br><del>  рдЖрдИрдбрд┐рдпрд╛-177,466 </del>  рдПрдХ рд▓реВрдк рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз List.remove (рд╕реВрдЪрдХрд╛рдВрдХ) рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ <br>  <strong>2018.2 рдореЗрдВ рддрдп рдХрд┐рдпрд╛ рдЧрдпрд╛</strong> </p></div></div><br><p>  рдирд┐рд╖реНрдХрд░реНрд╖: рд╕рд┐рдВрдЧрд▓ рдСрдкрд░реЗрд╢рдВрд╕ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдорд╛рд╕ рдСрдкрд░реЗрд╢рди рдЕрдХреНрд╕рд░ рддреЗрдЬ рд╣реЛрддреЗ рд╣реИрдВред </p><br><h2 id="oblast-vidimosti-i-proizvoditelnost">  рд╕реНрдХреЛрдк рдФрд░ рдкреНрд░рджрд░реНрд╢рди </h2><br><p>  рдЗрд╕ рдХреЛрдб рдХреЛ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">leaveForTheSecondYear</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ List&lt;Student&gt; naughty = repository.findNaughty(); List&lt;Student&gt; underAchieving = repository.findUnderAchieving(); <span class="hljs-comment"><span class="hljs-comment">// &lt;---- if (settings.leaveBothCategories()) { leaveForTheSecondYear(naughty, underAchieving); // &lt;---- return; } leaveForTheSecondYear(naughty); }</span></span></code> </pre> <br><p>  рд╣рдо рдЧреБрдВрдЬрд╛рдЗрд╢ рдХреЛ рд╕рдВрдХреАрд░реНрдг рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рд╢реВрдиреНрдп рд╕реЗ 1 рдХреНрд╡реЗрд░реА рджреЗрддрд╛ рд╣реИ: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">leaveForTheSecondYear</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ List&lt;Student&gt; naughty = repository.findNaughty(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Settings.leaveBothCategories()) { List&lt;Student&gt; underAchieving = repository.findUnderAchieving(); <span class="hljs-comment"><span class="hljs-comment">// &lt;---- leaveForTheSecondYear(naughty, underAchieving); // &lt;---- return; } leaveForTheSecondYear(naughty); }</span></span></code> </pre> <br><p>  рдФрд░ рдпрд╣рд╛рдВ рдЪреМрдХрд╕ рдкрд╛рдардХ рдХреЛ рдкреВрдЫрдирд╛ рдЪрд╛рд╣рд┐рдП: рд╕реНрдереИрддрд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛?  рд╕рддрд╣ рдкрд░ рдкрдбрд╝реЗ рд╕реБрдзрд╛рд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЖрдЗрдбрд┐рдпрд╛ рдиреЗ рд╣рдореЗрдВ рдХреНрдпреЛрдВ рдирд╣реАрдВ рдмрддрд╛рдпрд╛? </p><br><p>  рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рд╕реНрдерд┐рд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреА рд╕рдВрднрд╛рд╡рдирд╛рдПрдВ рд╕реАрдорд┐рдд рд╣реИрдВ: рдпрджрд┐ рд╡рд┐рдзрд┐ рдЬрдЯрд┐рд▓ рд╣реИ (рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд) рдФрд░ рд╕рд╛рдорд╛рдиреНрдп рд╕реНрдерд┐рддрд┐ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддреА рд╣реИ, рддреЛ рдЗрд╕рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рд╕реЗ рдЖрд╡реЗрджрди рдЯреВрдЯ рд╕рдХрддрд╛ рд╣реИред  рд╕реНрдереИрддрд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рдмрд╣реБрдд рд╕рд░рд▓ рдирд┐рд╖реНрдкрд╛рджрди рдХреА рд░рд┐рдкреЛрд░реНрдЯ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИ, рдЬрд┐рд╕рдХреЗ рд╣рд╕реНрддрд╛рдВрддрд░рдг рдХрд╛ рдХрд╣рдирд╛ рд╣реИ рдХрд┐ рдмреНрд▓реЙрдХ рдХреЗ рдЕрдВрджрд░ рдХреБрдЫ рднреА рдирд╣реАрдВ рдЯреВрдЯреЗрдЧрд╛ред </p><br><p>  рдЖрдк рдПрдХ ersatz рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд░ рд╣рд╛рдЗрд▓рд╛рдЗрдЯрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдлрд┐рд░ рд╕реЗ, рдЗрд╕реЗ рд╕рд╛рд╡рдзрд╛рдиреА рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдХреНрдпреЛрдВрдХрд┐ рджреБрд╖реНрдкреНрд░рднрд╛рд╡ рд╣рдореЗрд╢рд╛ рд╕рдВрднрд╡ рд╣реИрдВред  рдЖрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕реНрдЯреЗрдЯрд┐рдХ</a> рддрд░реАрдХреЛрдВ рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрдВрдЧрд┐рдд</a> рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЬреЗрдЯрдмреНрд░рд┐рдВрд╕-рдПрдиреЛрдЯреЗрд╢рди</a> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╕реЗ рдЙрдкрд▓рдмреНрдз рдПрдиреЛрдЯреЗрд╢рди <code>@org.jetbrains.annotations.Contract(pure = true)</code> рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// com.intellij.util.ArrayUtil @Contract(pure = true) public static int find(@NotNull int[] src, int obj) { return indexOf(src, obj); }</span></span></code> </pre> <br><p>  рдирд┐рд╖реНрдХрд░реНрд╖: рдЕрдзрд┐рдХ рдмрд╛рд░ рдирд╣реАрдВ, рдЕрдзрд┐рдХ рдХрд╛рдо рдХреЗрд╡рд▓ рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдЦрд░рд╛рдм рдХрд░рддрд╛ рд╣реИред </p><br><h2 id="samyy-neobychnyy-primer">  рд╕рдмрд╕реЗ рдЕрд╕рд╛рдорд╛рдиреНрдп рдЙрджрд╛рд╣рд░рдг </h2><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Service</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RemoteService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ContractCounter contractCounter; <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span>(readOnly = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-comment"><span class="hljs-comment">// &lt;---- public int countContracts(Dto dto) { if (dto.isInvalid()) { return -1; // &lt;---- } return contractCounter.countContracts(dto); } }</span></span></code> </pre> <br><p>  рдпрд╣ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд▓реЗрди-рджреЗрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдиреЗ рдкрд░ рднреА рд▓реЗрдирджреЗрди рдЦреЛрд▓рддрд╛ рд╣реИ (рд╡рд┐рдзрд┐ рд╕реЗ рддреНрд╡рд░рд┐рдд рд░рд┐рдЯрд░реНрди -1)ред </p><br><p>  рдЖрдкрдХреЛ рдмрд╕ <code>ContractCounter::countContracts</code> рдЕрдВрджрд░ рдХреА рд▓реЗрди-рджреЗрди рдХреЛ рджреВрд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЬрд╣рд╛рдБ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ рдЗрд╕реЗ "рдмрд╛рд╣рд░реА" рд╡рд┐рдзрд┐ рд╕реЗ рд╣рдЯрд╛ рджреЗрдВред </p><br><div class="spoiler">  <b class="spoiler_title">рдорд╛рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВ рдЬрдм -1 (ns) рд▓реМрдЯрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/8k/uu/lp/8kuulppcl4vli1c5ir-txozcemi.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">рдореЗрдореЛрд░реА рдЦрдкрдд (рдмрд╛рдЗрдЯреНрд╕) рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВ:</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/xp/du/ke/xpdukewr4nnooj2vtaktok4ngnm.png"></p></div></div><br><p>  <a href="">рдмреЗрдВрдЪрдорд╛рд░реНрдХ</a> </p><br><p>  рдирд┐рд╖реНрдХрд░реНрд╖: рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдФрд░ "рдмрд╛рд╣рд░реА" рджрд┐рдЦрдиреЗ рд╡рд╛рд▓реА рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рд▓реЗрди-рджреЗрди рд╕реЗ рдореБрдХреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рдпрд╣ рдЙрдирдХреА рдЬрд┐рдореНрдореЗрджрд╛рд░реА рдирд╣реАрдВ рд╣реИ) рдФрд░ рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рд╕рддреНрдпрд╛рдкрди рдХреЗ рдкреВрд░реЗ рддрд░реНрдХ, рдЬрд┐рд╕реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдФрд░ рд▓реЗрди-рджреЗрди рдХреЗ рдШрдЯрдХреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдХреЛ рд╡рд╣рд╛рдВ рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред </p><br><h2 id="preobrazovanie-datyvremeni-v-stroku">  рдкрд░рд┐рд╡рд░реНрддрд┐рдд рджрд┐рдирд╛рдВрдХ / рд╕рдордп рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП </h2><br><p>  рд╢рд╛рд╢реНрд╡рдд рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рддрд╛рд░реАрдЦ / рд╕рдордп рдХреЛ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ рдмрджрд▓ рд░рд╣рд╛ рд╣реИред  G8 рд╕реЗ рдкрд╣рд▓реЗ, рд╣рдордиреЗ рдпрд╣ рдХрд┐рдпрд╛: </p><br><pre> <code class="java hljs">SimpleDateFormat formatter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleDateFormat(<span class="hljs-string"><span class="hljs-string">"dd.MM.yyyy"</span></span>); String dateAsStr = formatter.format(date);</code> </pre> <br><p>  JDK 8 рдХреА рд░рд┐рд▓реАрдЬрд╝ рдХреЗ рд╕рд╛рде, рд╣рдореЗрдВ <code>LocalDate/LocalDateTime</code> рдорд┐рд▓рд╛ рдФрд░, рддрджрдиреБрд╕рд╛рд░, <code>DateTimeFormatter</code> </p><br><pre> <code class="java hljs">DateTimeFormatter formatter = ofPattern(<span class="hljs-string"><span class="hljs-string">"dd.MM.yyyy"</span></span>); String dateAsStr = formatter.format(localDate);</code> </pre> <br><p>  рдЖрдЗрдП рдЗрд╕рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдорд╛рдкреЗрдВ: </p><br><pre> <code class="java hljs">Date date = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Date(); LocalDate localDate = LocalDate.now(); SimpleDateFormat sdf = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleDateFormat(<span class="hljs-string"><span class="hljs-string">"dd.MM.yyyy"</span></span>); DateTimeFormatter dtf = DateTimeFormatter.ofPattern(<span class="hljs-string"><span class="hljs-string">"dd.MM.yyyy"</span></span>); <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">simpleDateFormat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sdf.format(date); } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dateTimeFormatter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dtf.format(localDate); }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рд╕рдордп (рд╕рдВред):</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/zq/jq/sx/zqjqsxjevqpmuckdddvu4gysaoa.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">рдореЗрдореЛрд░реА (рдмрд╛рдЗрдЯреНрд╕):</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/9j/yq/sw/9jyqswjtyiwq3i8fkutenvyuj7g.png"></p></div></div><br><p>  рдкреНрд░рд╢реНрди: рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рд╣рдорд╛рд░реА рд╕реЗрд╡рд╛ рдХреЛ рдмрд╛рд╣рд░ рд╕реЗ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ рдФрд░ рд╣рдо <code>java.util.Date</code> рдордирд╛ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗред  рдХреНрдпрд╛ рдпрд╣ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдлрд╛рдпрджреЗрдордВрдж рд╣реЛрдЧрд╛ рдХрд┐ <code>Date</code> рдХреЛ <code>LocalDate</code> рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░реЗрдВ рдпрджрд┐ рдмрд╛рдж рд╡рд╛рд▓рд╛ рддреЗрдЬреА рд╕реЗ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╣реЛ рдЬрд╛рдП?  рдЖрдЗрдП рдЧрд┐рдирддреА: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">measureDateConverted</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Data data)</span></span></span><span class="hljs-function"> </span></span>{ LocalDate localDate = toLocalDate(data.date); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data.dateTimeFormatter.format(localDate); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> LocalDate </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toLocalDate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Date date)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> date.toInstant().atZone(ZoneId.systemDefault()).toLocalDate(); }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рд╕рдордп (рд╕рдВред):</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/j5/ob/mf/j5obmfec_kvfivo46wat9rmf8e8.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">рдореЗрдореЛрд░реА (рдмрд╛рдЗрдЯреНрд╕):</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/hx/hm/on/hxhmon8ss12qyv9s4is6byoy164.png"></p></div></div><br><p>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, "рдиреМ" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рд░реВрдкрд╛рдВрддрд░рдг <code>Date</code> -&gt; <code>LocalDate</code> рдлрд╛рдпрджреЗрдордВрдж рд╣реИред  G8 рдореЗрдВ, рд░реВрдкрд╛рдВрддрд░рдг рдХреА рд▓рд╛рдЧрдд <code>DateTimeFormatter</code> -a рдХреЗ рд╕рднреА рд▓рд╛рднреЛрдВ рдХреЛ <code>DateTimeFormatter</code> рдХрд░реЗрдЧреАред </p><br><p>  <a href="">рдмреЗрдВрдЪрдорд╛рд░реНрдХ</a> </p><br><p>  рдирд┐рд╖реНрдХрд░реНрд╖: рдирдП рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдПрдВред </p><br><h2 id="eschyo-vosmyorka">  рдПрдХ рдФрд░ "рдЖрда" </h2><br><p>  рдЗрд╕ рдХреЛрдб рдореЗрдВ, рд╣рдо рд╕реНрдкрд╖реНрдЯ рдЕрддрд┐рд░реЗрдХ рджреЗрдЦрддреЗ рд╣реИрдВ: </p><br><pre> <code class="java hljs">Iterator&lt;Long&gt; iterator = items <span class="hljs-comment"><span class="hljs-comment">// ArrayList&lt;Integer&gt; .stream() .map(Long::valueOf) .collect(toList()) // &lt;----    ? .iterator(); while (iterator.hasNext()) { bh.consume(iterator.next()); }</span></span></code> </pre> <br><p>  рд╣рдо рдЗрд╕реЗ рд╣рдЯрд╛ рджреЗрддреЗ рд╣реИрдВ: </p><br><pre> <code class="java hljs">Iterator&lt;Long&gt; iterator = items <span class="hljs-comment"><span class="hljs-comment">// ArrayList&lt;Integer&gt; .stream() .map(Long::valueOf) .iterator(); while (iterator.hasNext()) { bh.consume(iterator.next()); }</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рдкреНрд░рджрд░реНрд╢рди рдореЗрдВ рдХрд┐рддрдирд╛ рд╕реБрдзрд╛рд░ рд╣реБрдЖ рд╣реИ:</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/un/mp/pf/unmppfr6sd8ybi3k7r7jrdsdfty.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">рдиреМ рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░реЗрдВ:</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/hc/rb/p9/hcrbp98qezjcm5fegv27cywcadu.png"></p></div></div><br><p>  рдХрдорд╛рд▓ рд╣реИ рдирд╛?  рдореИрдВрдиреЗ рдКрдкрд░ рддрд░реНрдХ рджрд┐рдпрд╛ рд╣реИ рдХрд┐ рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рд░реНрдп рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдХрдо рдХрд░рддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдпрд╣рд╛рдВ рд╣рдо рдЕрддрд┐рд░рд┐рдХреНрдд рдХреЛ рд╣рдЯрд╛ рджреЗрддреЗ рд╣реИрдВ - рдФрд░ (рдЕрдЪрд╛рдирдХ) рдпрд╣ рдЦрд░рд╛рдм рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреНрдпрд╛ рд╣реЛ рд░рд╣рд╛ рд╣реИ, рджреЛ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпреЛрдВ рдХреЛ рд▓реЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдПрдХ рдЖрд╡рд░реНрдзрдХ рдХрд╛рдВрдЪ рдХреЗ рдиреАрдЪреЗ рджреЗрдЦреЗрдВ: </p><br><div class="spoiler">  <b class="spoiler_title">рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ</b> <div class="spoiler_text"><pre> <code class="java hljs">Iterator iterator1 = items.stream().collect(toList()).iterator(); Iterator iterator2 = items.stream().iterator();</code> </pre> <br><p><img src="https://habrastorage.org/webt/rn/ah/kf/rnahkfz2qdyuw0k_cjeorqawqki.png"></p></div></div><br><p>  рдкрд╣рд▓рд╛ рдкреБрдирд░рд╛рд╡реГрддреНрдд рдирд┐рдпрдорд┐рдд <code>ArrayList$Itr</code> ред </p><br><div class="spoiler">  <b class="spoiler_title">рдЗрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдорд╛рд░реНрдЧ рд╕рд░рд▓ рд╣реИ:</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hasNext</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cursor != size; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> E </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">next</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ checkForComodification(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = cursor; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i &gt;= size) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NoSuchElementException(); } Object[] elementData = ArrayList.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.elementData; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i &gt;= elementData.length) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcurrentModificationException(); } cursor = i + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (E) elementData[lastRet = i]; }</code> </pre> <br><p><img src="https://habrastorage.org/webt/ug/yb/pi/ugybpiiwmjj5-fbcazvmfdjd2tq.png"></p></div></div><br><p>  рджреВрд╕рд░рд╛ рдЕрдзрд┐рдХ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ, рдпрд╣ <code>Spliterators$Adapter</code> , рдЬреЛ <code>ArrayList$ArrayListSpliterator</code> рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИред </p><br><div class="spoiler">  <b class="spoiler_title">рд╡рд╣рд╛рдВ рд╕реЗ рдЧреБрдЬрд░рдирд╛ рдЬреНрдпрд╛рджрд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реИ</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// java.util.Spliterators$Adapter public boolean hasNext() { if (!valueReady) spliterator.tryAdvance(this); return valueReady; } public T next() { if (!valueReady &amp;&amp; !hasNext()) throw new NoSuchElementException(); else { valueReady = false; return nextElement; } }</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/pf/5p/gj/pf5pgjkfhhfw__h8ie7m6oflxqq.png"></p></div></div><br><p>  рдЖрдЗрдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">async-profiler рдХреЗ</a> рдорд╛рдзреНрдпрдо рд╕реЗ рдкреБрдирд░рд╛рд╡реГрддрд┐ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХреЛ рджреЗрдЦреЗрдВ: </p><br><pre> <code class="hljs mel"><span class="hljs-number"><span class="hljs-number">15.64</span></span>% juArrayList$ArrayListSpliterator.tryAdvance <span class="hljs-number"><span class="hljs-number">10.67</span></span>% jusSpinedBuffer.<span class="hljs-keyword"><span class="hljs-keyword">clear</span></span> <span class="hljs-number"><span class="hljs-number">9.86</span></span>% juSpliterators$1Adapter.hasNext <span class="hljs-number"><span class="hljs-number">8.81</span></span>% jusStreamSpliterators$AbstractWrappingSpliterator.fillBuffer <span class="hljs-number"><span class="hljs-number">6.01</span></span>% oojiBlackhole.consume <span class="hljs-number"><span class="hljs-number">5.71</span></span>% jusReferencePipeline$3$1.accept <span class="hljs-number"><span class="hljs-number">5.57</span></span>% jusSpinedBuffer.accept <span class="hljs-number"><span class="hljs-number">5.06</span></span>% cllbir.IteratorFromStreamBenchmark.iteratorFromStream <span class="hljs-number"><span class="hljs-number">4.80</span></span>% jlLong.valueOf <span class="hljs-number"><span class="hljs-number">4.53</span></span>% cllbiIteratorFromStreamBenchmark$$Lambda$8<span class="hljs-number"><span class="hljs-number">.885721577</span></span>.apply</code> </pre> <br><p>  рдпрд╣ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЕрдзрд┐рдХрд╛рдВрд╢ рд╕рдордп рдЗрдЯреНрд░реЗрдЯрд░ рд╕реЗ рдЧреБрдЬрд░рдиреЗ рдореЗрдВ рд╡реНрдпрддреАрдд рд╣реЛрддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдФрд░ рдмрдбрд╝реЗ рд╕реЗ, рд╣рдореЗрдВ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЦреЛрдЬ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ: </p><br><pre> <code class="java hljs">items .stream() .map(Long::valueOf) .forEach(bh::consume);</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдмрд╛рдХреА рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░реЗрдВ:</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/rf/is/i0/rfisi0vsfoezlcvtd43h2lhlvfi.png"></p></div></div><br><p>  <code>Stream::forEach</code> рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдПрдХ рд╡рд┐рдЬреЗрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдЕрдЬреАрдм рд╣реИ: рдпрд╣ рдЕрднреА рднреА <code>ArrayListSpliterator</code> рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рдЙрдкрдпреЛрдЧ рдореЗрдВ рдХрд╛рдлреА рд╕реБрдзрд╛рд░ рд╣реБрдЖ рд╣реИред </p><br><div class="spoiler">  <b class="spoiler_title">рдЖрдЗрдП рдкреНрд░реЛрдлрд╛рдЗрд▓ рджреЗрдЦреЗрдВ:</b> <div class="spoiler_text"><pre> <code class="hljs powershell"><span class="hljs-number"><span class="hljs-number">29.04</span></span>% oojiBlackhole.consume <span class="hljs-number"><span class="hljs-number">22.92</span></span>% juArrayList<span class="hljs-variable"><span class="hljs-variable">$ArrayListSpliterator</span></span>.forEachRemaining <span class="hljs-number"><span class="hljs-number">14.47</span></span>% jusReferencePipeline<span class="hljs-variable"><span class="hljs-variable">$3</span></span><span class="hljs-variable"><span class="hljs-variable">$1</span></span>.accept <span class="hljs-number"><span class="hljs-number">8.79</span></span>% jlLong.valueOf <span class="hljs-number"><span class="hljs-number">5.37</span></span>% cllbiIteratorFromStreamBenchmark<span class="hljs-variable"><span class="hljs-variable">$</span></span><span class="hljs-variable"><span class="hljs-variable">$Lambda</span></span><span class="hljs-variable"><span class="hljs-variable">$9</span></span>.<span class="hljs-number"><span class="hljs-number">617691115</span></span>.accept <span class="hljs-number"><span class="hljs-number">4.84</span></span>% cllbiIteratorFromStreamBenchmark<span class="hljs-variable"><span class="hljs-variable">$</span></span><span class="hljs-variable"><span class="hljs-variable">$Lambda</span></span><span class="hljs-variable"><span class="hljs-variable">$8</span></span>.<span class="hljs-number"><span class="hljs-number">1964917002</span></span>.apply <span class="hljs-number"><span class="hljs-number">4.43</span></span>% jusForEachOps<span class="hljs-variable"><span class="hljs-variable">$ForEachOp</span></span><span class="hljs-variable"><span class="hljs-variable">$OfRef</span></span>.accept <span class="hljs-number"><span class="hljs-number">4.17</span></span>% jusSink<span class="hljs-variable"><span class="hljs-variable">$ChainedReference</span></span>.end <span class="hljs-number"><span class="hljs-number">1.27</span></span>% jlInteger.longValue <span class="hljs-number"><span class="hljs-number">0.53</span></span>% jusReferencePipeline.map</code> </pre> </div></div><br><p>  рдЗрд╕ рдкреНрд░реЛрдлрд╛рдЗрд▓ рдореЗрдВ, рдЬреНрдпрд╛рджрд╛рддрд░ рд╕рдордп <code>Blackhole</code> рдЕрдВрджрд░ рдХреЗ рдореВрд▓реНрдпреЛрдВ рдХреЛ "рдирд┐рдЧрд▓рдиреЗ" рдореЗрдВ рдмрд┐рддрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдПрдХ рдЗрдЯрд░реЗрдЯрд░ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ, рд╕рдордп рдХрд╛ рдПрдХ рдмрдбрд╝рд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╕реАрдзреЗ рдЬрд╛рд╡рд╛ рдХреЛрдб рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдкрд░ рдЦрд░реНрдЪ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ рдорд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХрд╛рд░рдг рдХрдЪрд░рд╛ рд╕рдВрдЧреНрд░рд╣ рдХрд╛ рдХрдо рд╡рд┐рд╢рд┐рд╖реНрдЯ рднрд╛рд░ рд╣реИ, рдЗрд╕рдХреА рддреБрд▓рдирд╛ рдЗрдЯреНрд░реЗрдЯрд░ рдмреНрд░реВрдЯ рдмрд▓ рд╕реЗ рдХреА рдЬрд╛рддреА рд╣реИред  рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ: </p><br><pre> <code class="java hljs">forEach:┬╖gc.alloc.rate.norm <span class="hljs-number"><span class="hljs-number">100</span></span> avgt <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-number"><span class="hljs-number">216</span></span>,<span class="hljs-number"><span class="hljs-number">001</span></span> ┬▒ <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">002</span></span> B/op iteratorFromStream:┬╖gc.alloc.rate.norm <span class="hljs-number"><span class="hljs-number">100</span></span> avgt <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-number"><span class="hljs-number">416</span></span>,<span class="hljs-number"><span class="hljs-number">004</span></span> ┬▒ <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">006</span></span> B/op</code> </pre> <br><p>  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, <code>Stream::forEach</code> рд╕реНрдореГрддрд┐ рдХреА рдЖрдзреА рдЦрдкрдд рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред </p><br><div class="spoiler">  <b class="spoiler_title">рдпрд╣ рддреЗрдЬ рдХреНрдпреЛрдВ рд╣реИ?</b> <div class="spoiler_text"><p>  рдмреНрд▓реИрдХ рд╣реЛрд▓ рдореЗрдВ рд╢реБрд░реВ рд╕реЗ рд╣реА рдХреЙрд▓ рдХреА рд╢реНрд░реГрдВрдЦрд▓рд╛ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддреА рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/2f/5w/1y/2f5w1ydxlo5oomf8bfmhbqtynze.png"></p><br><p>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, <code>ArrayListSpliterator::tryAdvance</code> рдЪреЗрди рд╕реЗ рдЧрд╛рдпрдм рд╣реЛ рдЧрдпрд╛, рдФрд░ <code>ArrayListSpliterator::forEachRemaining</code> рджрд┐рдЦрд╛рдИ рджреА: </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// ArrayListSpliterator public void forEachRemaining(Consumer&lt;? super E&gt; action) { int i, hi, mc; // hoist accesses and checks from loop ArrayList&lt;E&gt; lst; Object[] a; if (action == null) throw new NullPointerException(); if ((lst = list) != null &amp;&amp; (a = lst.elementData) != null) { if ((hi = fence) &lt; 0) { mc = lst.modCount; hi = lst.size; } else mc = expectedModCount; if ((i = index) &gt;= 0 &amp;&amp; (index = hi) &lt;= a.length) { for (; i &lt; hi; ++i) { @SuppressWarnings("unchecked") E e = (E) a[i]; // &lt;---- action.accept(e); } if (lst.modCount == mc) return; } } throw new ConcurrentModificationException(); }</span></span></code> </pre> <br><p>  рдЙрдЪреНрдЪ рдЧрддрд┐ <code>ArrayListSpliterator::forEachRemaining</code> 1 рд╡рд┐рдзрд┐ рдХреЙрд▓ рдореЗрдВ рд╕рдВрдкреВрд░реНрдг рд╕рд░рдгреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╛рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрдЯрд░реЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, рдорд╛рд░реНрдЧ рдПрдХ рддрддреНрд╡ рддрдХ рд╕реАрдорд┐рдд рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рд╣рдореЗрд╢рд╛ <code>ArrayListSpliterator::tryAdvance</code> рдЦрд┐рд▓рд╛рдл рдЖрд░рд╛рдо <code>ArrayListSpliterator::tryAdvance</code> ред <br>  <code>ArrayListSpliterator::forEachRemaining</code> рдореЗрдВ рдкреВрд░реЗ рд╕рд░рдгреА рддрдХ рдкрд╣реБрдВрдЪ рд╣реИ рдФрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рдХреЙрд▓ рдХреЗ рдмрд┐рдирд╛ рдПрдХ рдЧрд┐рдирддреА рдЪрдХреНрд░ рдХреЗ рд╕рд╛рде рдЗрд╕ рдкрд░ <code>ArrayListSpliterator::forEachRemaining</code> рдХрд░рддрд╛ рд╣реИред </p></div></div><br><div class="spoiler">  <b class="spoiler_title">рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реВрдЪрдирд╛</b> <div class="spoiler_text"><p>  рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╛рдВрддреНрд░рд┐рдХ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди </p><br><pre> <code class="java hljs">Iterator&lt;Long&gt; iterator = items .stream() .map(Long::valueOf) .collect(toList()) .iterator(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (iterator.hasNext()) { bh.consume(iterator.next()); }</code> </pre> <br><p>  рдкрд░ </p><br><pre> <code class="java hljs">items .stream() .map(Long::valueOf) .forEach(bh::consume);</code> </pre> <br><p>  рдпрд╣ рд╣рдореЗрд╢рд╛ рд╕рдорддреБрд▓реНрдп рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдкрд╣рд▓реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд╣рдо рд╕реНрдЯреНрд░реАрдо рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд┐рдП рдмрд┐рдирд╛ рдкрд╛рд╕ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдХреА рдПрдХ рдкреНрд░рддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рджреВрд╕рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдбреЗрдЯрд╛ рдХреЛ рд╕реАрдзреЗ рд╕реНрдЯреНрд░реАрдо рд╕реЗ рд▓рд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p></div></div><br><p>  <a href="">рдмреЗрдВрдЪрдорд╛рд░реНрдХ</a> </p><br><p>  рдирд┐рд╖реНрдХрд░реНрд╖: рдЬрдм рдбреЗрдЯрд╛ рдХреЗ рдЬрдЯрд┐рд▓ рдЕрднреНрдпрд╛рд╡реЗрджрди рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕ рддрдереНрдп рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд░рд╣реЗрдВ рдХрд┐ "рд▓реЛрд╣реЗ" рдХреЗ рдирд┐рдпрдо (рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рд░реНрдп рд╣рд╛рдирд┐) рдХрд╛рдо рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рджреЗрдВред  рдКрдкрд░ рджрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдг рд╕реЗ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдкреНрд░рддреАрдд рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдмрд╣реБрдд рд╣реА рд╢рд╛рдирджрд╛рд░ рдордзреНрдпрд╡рд░реНрддреА рд╕реВрдЪреА рдЧрдгрдирд╛ рдХреЗ рддреЗрдЬреА рд╕реЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХрд╛ рд▓рд╛рдн рджреЗрддреА рд╣реИред </p><br><h4 id="dva-podvoha">  рджреЛ рдЯреЛрдЯрдХреЗ </h4><br><pre> <code class="java hljs">StackTraceElement[] trace = th.getStackTrace(); StackTraceElement[] newTrace = Arrays .asList(trace) .subList(<span class="hljs-number"><span class="hljs-number">0</span></span>, depth) .toArray(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StackTraceElement[newDepth]); <span class="hljs-comment"><span class="hljs-comment">// &lt;----</span></span></code> </pre> <br><p>  рдкрд╣рд▓реА рдЪреАрдЬ рдЬреЛ рдЖрдкрдХреА рдЖрдВрдЦ рдХреЛ рдкрдХрдбрд╝рддреА рд╣реИ, рд╡рд╣ рд╕рдбрд╝рд╛ рд╣реБрдЖ "рд╕реБрдзрд╛рд░" рд╣реИ, рдЕрд░реНрдерд╛рддреН, рдиреЙрдирдЬрд░реЛ рдХреА рд▓рдВрдмрд╛рдИ рдХреА рдПрдХ рд╕рд░рдгреА рдХреЛ <code>Collection::toArray</code> рдЧреБрдЬрд░рдирд╛ред  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣</a> рдмрд╣реБрдд рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдХреНрдпреЛрдВ рд╣реИред </p><br><p>  рджреВрд╕рд░реА рд╕рдорд╕реНрдпрд╛ рдЗрддрдиреА рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИ, рдФрд░ рдЗрд╕рдХреА рд╕рдордЭ рдХреЗ рд▓рд┐рдП рд╣рдо рд╕рдореАрдХреНрд╖рдХ рдФрд░ рдЗрддрд┐рд╣рд╛рд╕рдХрд╛рд░ рдХреЗ рдХрд╛рдо рдХреЗ рдмреАрдЪ рд╕рдорд╛рдирддрд╛ рд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВред </p><br><div class="spoiler">  <b class="spoiler_title">рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рд░реЙрдмрд┐рди рдХреЙрд▓рд┐рдВрдЧрд╡реБрдб рд▓рд┐рдЦрддреЗ рд╣реИрдВ:</b> <div class="spoiler_text"><p> , ,   []       тАУ  . <strong>             </strong> .   , <strong>    ,    </strong> ... </p></div></div><br><p>       <strong></strong>      .      : </p><br><p> 1)     <br> 2)    <br> 3)       </p><br><p>      ,      : </p><br><pre> <code class="java hljs">StackTraceElement[] trace = th.getStackTrace(); StackTraceElement[] newTrace = Arrays.copyOf(trace, depth); <span class="hljs-comment"><span class="hljs-comment">//    0 //  StackTraceElement[] newTrace = Arrays.copyOfRange(trace, 0, depth); //   0</span></span></code> </pre> <br><div class="spoiler"> <b class="spoiler_title"> ():</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/xg/ia/-8/xgia-8mdesgh-cpqm1cla0n8zz4.png"></p></div></div><br><p> <a href=""></a> </p><br><h4 id="strimoz-golovnogo-mozga">    </h4><br><pre> <code class="java hljs">List&lt;T&gt; list = getList(); Set&lt;T&gt; set = getSet(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> list.stream().allMatch(set::contains); <span class="hljs-comment"><span class="hljs-comment">//     ?</span></span></code> </pre> <br><p>       ,      ,    : </p><br><pre> <code class="java hljs">List&lt;T&gt; list = getList(); Set&lt;T&gt; set = getSet(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> set.containsAll(list);</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"> ():</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/3c/tc/pr/3ctcprq3scexhaaifc9hiywbj98.png"></p></div></div><br><p> <a href=""></a> </p><br><h4 id="nenuzhnye-obyortki">   </h4><br><p>  : </p><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FileNameLoader</span></span></span><span class="hljs-class"> </span></span>{ String[] loadFileNames(); }</code> </pre> <br><p>     : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> FileNameLoader loader; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (String str : asList(loader.loadFileNames())) { <span class="hljs-comment"><span class="hljs-comment">// &lt;----   use(str); } }</span></span></code> </pre> <br><p>   ,   <code>forEach</code>    ,      : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> FileNameLoader loader; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (String str : loader.loadFileNames()) { <span class="hljs-comment"><span class="hljs-comment">// &lt;----    use(str); } }</span></span></code> </pre> <br><div class="spoiler"> <b class="spoiler_title"> ():</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/pa/kn/hc/paknhcvrp1cf7g-fw3cn4euxrse.png"></p></div></div><br><p> <a href=""></a> </p><br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-182206</a> <br><del> IDEA-182206 </del> Simplification for Arrays.asList().subList().toArray() <br> <strong>  2018.1</strong> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-180847</a> <br><del> IDEA-180847 </del> Inspection 'Call to Collection.toArray with zero-length array argument' brings pessimization <br> <strong>  2018.1</strong> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-181928</a> <br><del> IDEA-181928 </del> Stream.allMatch(Collection::contains) can be simplified to Collection.containsAll() <br> <strong>  2018.1</strong> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-184240</a> <br><del> IDEA-184240 </del> Unnecessary array-to-collection wrapping should be detected <br> <strong>  2018.1</strong> </p></div></div><br><p> :       : </p><br><ul><li>  </li><li>  </li><li>    </li></ul><br><p>       ,   ,         ,     .  ,   :         "" (        ),       ""     (      ),        . </p><br><p> тЖТ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">   </a> </p><br><p> тЖТ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">  </a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi423305/">https://habr.com/ru/post/hi423305/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi423293/index.html">рдХреИрд╕реЗ рдПрдХ рд░рд╛рдЬреНрдп рдорд╢реАрди рдХреЗ рд╕рд╛рде рдкреИрд░ рдореЗрдВ рдЦреБрдж рдХреЛ рд╢реВрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ</a></li>
<li><a href="../hi423295/index.html">рд╕рдмрд╕реЗ рдЙрдкрдпреЛрдЧреА рдореЛрдмрд╛рдЗрд▓ рд╡рд┐рдХрд╛рд╕ рд╕рдореНрдореЗрд▓рди</a></li>
<li><a href="../hi423297/index.html">Android рдбреЗрд╡рд▓рдкрд░ рд╕реЗ DevOps рддрдХ</a></li>
<li><a href="../hi423299/index.html">IOS рдРрдкреНрд╕ рдореЗрдВ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕рдордиреНрд╡рдпрдХ</a></li>
<li><a href="../hi423303/index.html">рдПрдЖрдИ, рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдкрд╛рдареНрдпрдХреНрд░рдоред рднрд╛рд╡рдирд╛ рдЖрдзрд╛рд░рд┐рдд рд╕рдВрдЧреАрдд рдкрд░рд┐рд╡рд░реНрддрди</a></li>
<li><a href="../hi423307/index.html">рд╡рд┐рдЬреБрдЕрд▓ рд╕реНрдЯреВрдбрд┐рдпреЛ рдХреЛрдб рдореЗрдВ рдЧрд┐рдЯрд╣рдм рдкреБрд▓ рдЕрдиреБрд░реЛрдз</a></li>
<li><a href="../hi423309/index.html">DBMS рд▓реЗрдирджреЗрди</a></li>
<li><a href="../hi423311/index.html">рд╕рд╛рдЭреЗрджрд╛рд░реА рдирд╡реАрдбреНрд░реЗрд╕ рдФрд░ рдПрдХреНрдЯреБрдо</a></li>
<li><a href="../hi423313/index.html">I2C рдХреЛ рд╕реНрдкрд░реНрд╢ рдХрд░реЗрдВред рдПрдХ рд╕рд░рд▓ рддрд░реНрдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рдмрдирд╛рдПрдВ</a></li>
<li><a href="../hi423315/index.html">рдпреВрдирд┐рд╡рд░реНрд╕рд▓ рд▓рд┐рдВрдХреНрд╕ рдХрд╛ рд╕рд┐рджреНрдзрд╛рдВрдд</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>