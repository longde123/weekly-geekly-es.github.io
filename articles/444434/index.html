<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçÖ üë∞üèø ü•§ ¬°Ha llegado el momento de Java 12! Revisi√≥n de los JEP calientes ‚¨áÔ∏è üë®üèª‚Äçüé§ üõ∑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Han pasado seis meses, lo que significa que es hora de instalar Java nuevo . Fue un largo viaje, y pocos llegaron al final. Las l√≠neas sin procesar ca...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>¬°Ha llegado el momento de Java 12! Revisi√≥n de los JEP calientes</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/444434/"><p><img src="https://habrastorage.org/webt/k8/rn/qa/k8rnqagstd_wu4hezoj_bnjzfem.png"></p><br><p>  Han pasado seis meses, lo que significa que es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">hora de instalar Java nuevo</a> .  Fue un largo viaje, y pocos llegaron al final.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Las l√≠neas sin procesar</a> cayeron de JEP interesantes, pero hablaremos del resto bajo el corte. </p><a name="habracut"></a><br><h1 id="kak-vsyo-proishodit">  Como va todo </h1><br><p>  El lanzamiento de la nueva versi√≥n de Java se realiza de acuerdo con el nuevo ciclo de lanzamiento "acelerado" con una duraci√≥n de aproximadamente seis meses.  Las fechas exactas se definen en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">la p√°gina del proyecto</a> .  Hubo varias fases principales para JDK 12: </p><br><ul><li>  13/12/2018 - La primera fase de la desaceleraci√≥n (en este momento, se hace una bifurcaci√≥n desde la rama principal en el repositorio); </li><li>  2019/01/17 - La segunda fase de la desaceleraci√≥n (completa todo lo que sea posible); </li><li>  2019/02/07 - Release candidato (solo se corrigen los errores m√°s importantes); </li><li>  2019/03/19 - Lanzamiento, Disponibilidad general.  <strong>&lt;- est√°s aqu√≠</strong> </li></ul><br><p>  ¬øQu√© tenemos de este horario?  S√≠, de hecho, nada: acabamos de llegar a la l√≠nea de meta y observamos a los amantes del legado desde una altura del nuevo JDK 12 nuevo. </p><br><h1 id="bagi-panika-vse-na-dno">  Bichos!  P√°nico!  Todo al fondo! </h1><br><p><img src="https://habrastorage.org/webt/9j/jw/j8/9jjwj87t8vtlqyiv4zmox4xljem.jpeg"></p><br><p>  Cuando sale una nueva versi√≥n que no es LTS, generalmente a todos no les importan las nuevas caracter√≠sticas.  Es m√°s interesante si todo se vendr√° abajo al infierno. </p><br><p>  Por supuesto, hay muchos errores, pero no en JDK 12 :) A juzgar por el jir, todo es normal: </p><br><p><img src="https://habrastorage.org/webt/st/yr/cr/styrcrroe8hobgqc6jpxgv5hknw.jpeg"></p><br><p>  Citar√© la solicitud para que comprenda <em>exactamente</em> cu√°l es la "norma": </p><br><pre><code class="plaintext hljs">project = JDK AND issuetype = Bug AND status in (Open, "In Progress", New) AND priority in (P1) AND (fixVersion in (12) OR fixVersion is EMPTY AND affectedVersion in (12) AND affectedVersion not in regexVersion("11.*", "10.*", "9.*", "8.*", "7.*", "6.*")) AND (labels is EMPTY OR labels not in (jdk12-defer-request, noreg-demo, noreg-doc, noreg-self)) AND (component not in (docs, globalization, infrastructure) OR component = infrastructure AND subcomponent = build) AND reporter != "Shadow Bug" ORDER BY priority, component, subcomponent, assignee</code> </pre> <br><p>  Por supuesto, <em>en general los</em> errores tienen un lugar para estar, no ir√°n a ning√∫n lado en un proyecto tan grande.  Solo se afirma que en este momento no se han notado los errores P1. </p><br><p>  Una comunicaci√≥n m√°s formal con los errores se declara en un documento especial, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JEP 3: Proceso de lanzamiento de JDK</a> , que es propiedad de nuestro administrador inmortal en las turbulentas olas del Oc√©ano Java: Mark Reinhold. </p><br><p>  Y en particular, vale la pena <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">desenterrar un p√°rrafo que</a> diga <del>  qui√©n tiene la culpa y qu√© hacer </del>  c√≥mo transferir boletos si no tienes tiempo para el 12 ¬∞ lanzamiento.  Es necesario poner en el <code>jdk$N-defer-request</code> errores la etiqueta <code>jdk$N-defer-request</code> en la que N indica desde qu√© versi√≥n desea transferir y dejar un comentario, cuya primera l√≠nea es <em>Solicitud de aplazamiento</em> .  Adem√°s, la revisi√≥n de todas estas solicitudes es realizada por los l√≠deres de las √°reas y proyectos respectivos. </p><br><p>  Los problemas de pasar TCK no se pueden ignorar de esta manera: se garantiza que Java sigue siendo Java, y no algo parecido a una rana.  La <code>jdk$N-defer-request label</code> nunca desaparece.  Es interesante lo que hacen con las personas que violan la regla de no eliminar etiquetas: sugiero alimentar a los conejillos de indias. </p><br><p>  Sin embargo, de esta manera puede ver cu√°ntos errores se han portado a JDK 13. Probemos con esta consulta: </p><br><pre> <code class="plaintext hljs">project = JDK AND issuetype = Bug AND status in (Open, "In Progress", New) AND (labels in (jdk12-defer-request) AND labels not in (noreg-demo, noreg-doc, noreg-self)) AND (component not in (docs, globalization, infrastructure) OR component = infrastructure AND subcomponent = build) AND reporter != "Shadow Bug" ORDER BY priority, component, subcomponent, assignee</code> </pre> <br><p>  Solo 1 pieza, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JDK-8216039</a> : "TLS con BC y RSASSA-PSS rompe ECDHServerKeyExchange".  No es grueso.  Si este argumento a√∫n no ayuda, entonces, como su abogado, le recomiendo probar un sedante. </p><br><h1 id="i-chto-zhe-v-suhom-ostatke">  ¬øY cu√°l es el resultado final? </h1><br><p><img src="https://habrastorage.org/webt/ef/uf/mx/efufmx-2rdphagrcihuscp0cswo.png"></p><br><p>  Est√° claro que la mayor√≠a de las caracter√≠sticas no afectan a los usuarios (programadores de Java), sino a los desarrolladores de OpenJDK.  Por lo tanto, por si acaso, divido las caracter√≠sticas en <strong>externas</strong> e <strong>internas</strong> .  Puede omitir los internos, pero estoy ofendido, escrib√≠ mucho texto. </p><br><p>  <strong>189: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Shenandoah: un recolector de basura de bajo tiempo de pausa (experimental)</a></strong> </p><br><p>  <strong>Caracter√≠stica externa</strong>  En resumen, a la gente no le gusta cuando Java se ralentiza, especialmente si el SLA requiere una capacidad de respuesta del orden de 10-500 milisegundos.  Ahora tenemos un GC libre de bajo impacto que est√° tratando de trabajar m√°s cerca del borde izquierdo de este rango.  La compensaci√≥n es que intercambiamos la CPU y la RAM para reducir la latencia.  Las fases de etiquetado y compactaci√≥n de la cadera funcionan en paralelo con hilos de aplicaciones en vivo.  Las peque√±as pausas restantes se deben al hecho de que a√∫n necesita buscar y actualizar las ra√≠ces del gr√°fico de objetos. </p><br><p>  Si nada de lo anterior tiene sentido para usted, no importa, Shenandoah <em>simplemente funciona</em> , independientemente de comprender o no comprender los procesos subyacentes. </p><br><p>  Alexei Shipilev, Christina Flood y Roman Kennke est√°n trabajando en ello: debe esforzarse mucho para no saber acerca de estas personas.  Si generalmente comprende c√≥mo funciona GC pero no se imagina lo que un desarrollador puede hacer all√≠, le recomiendo que lea la maravillosa traducci√≥n del maravilloso art√≠culo de Leshina <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Recolector de basura casero para OpenJDK"</a> o la serie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JVM Anatomy Quarks</a> .  Esto es <strong>muy interesante</strong> </p><br><blockquote>  <strong>Extremadamente importante</strong>  Oracle decidi√≥ no enviar a Sheandoah con ninguna de sus versiones de lanzamiento, ni la de jdk.java.net ni la de oracle.com.  Dado que Shenandoah es una de las caracter√≠sticas m√°s importantes de JDK 12, vale la pena instalar alguna otra asamblea oficial, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">por ejemplo, de Azul</a> . </blockquote><br><hr><br><p>  <strong>230: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Suite Microbenchmark</a></strong> </p><br><p>  <strong>Caracter√≠stica interior</strong>  Si alguna vez trat√≥ de escribir microbenchmarks, entonces sabe que esto se hace en JMH.  JMH es un marco para crear, ensamblar, lanzar y analizar microbenchmarks para Java y otros lenguajes JVM, usted <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mismo comprende qui√©n lo</a> escribi√≥ (todas las coincidencias son aleatorias).  Desafortunadamente, no todo lo que se hace en el mundo de las aplicaciones "normales" se puede aplicar dentro del JDK.  Por ejemplo, es poco probable que veamos el c√≥digo normal de Spring Framework all√≠. </p><br><p>  Afortunadamente, a partir de la versi√≥n 12, puede usar al menos JMH, y ya hay un conjunto de pruebas escritas en √©l.  Puede verlo en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>jdk/jdk/test/micro/org/openjdk/bench</code></a> (puede mirar directamente en el navegador, esta ruta es un enlace). </p><br><p>  Por ejemplo, as√≠ es como se ve la <a href="">prueba de GC</a> . </p><br><blockquote>  Perm√≠tame recordarle que no tenemos StackOverflow aqu√≠, y est√° prohibido usar c√≥digo de copiar y pegar, aqu√≠ y en lo sucesivo, sin leer y observar todas las licencias del <a href="">archivo correspondiente</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">del proyecto OpenJDK</a> en general, de lo contrario, obtendr√° f√°cilmente los √∫ltimos calcetines para demandar. </blockquote><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@BenchmarkMode</span></span>(Mode.AverageTime) <span class="hljs-meta"><span class="hljs-meta">@OutputTimeUnit</span></span>(TimeUnit.NANOSECONDS) <span class="hljs-meta"><span class="hljs-meta">@State</span></span>(Scope.Thread) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Alloc</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> LENGTH = <span class="hljs-number"><span class="hljs-number">400</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ARR_LEN = <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> largeLen = <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> smalllen = <span class="hljs-number"><span class="hljs-number">6</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testLargeConstArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Blackhole bh)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> localArrlen = ARR_LEN; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; LENGTH; i++) { Object[] tmp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Object[localArrlen]; bh.consume(tmp); } } <span class="hljs-comment"><span class="hljs-comment">//... }</span></span></code> </pre> <br><hr><br><p>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">325: Cambiar expresiones (vista previa)</a></strong> </p><br><p>  <strong>Caracter√≠stica externa</strong>  Cambiar√° fundamentalmente su enfoque para escribir interruptores sin fin con una longitud de m√°s de dos pantallas.  Mira </p><br><h3 id="virgin-java-switch-vs-">  Virgin Java Switch vs ... </h3><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dayNum = -<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (day) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> MONDAY: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> FRIDAY: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> SUNDAY: dayNum = <span class="hljs-number"><span class="hljs-number">6</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> TUESDAY: dayNum = <span class="hljs-number"><span class="hljs-number">7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> THURSDAY: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> SATURDAY: dayNum = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> WEDNESDAY: dayNum = <span class="hljs-number"><span class="hljs-number">9</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }</code> </pre> <br><p>  <strong>Por qu√© es malo</strong> : hay muchas letras, puedes saltarte el descanso (especialmente si eres adicto a las drogas o est√°s enfermo de TDAH). </p><br><h3 id="-vs-chad-java-swtich-expression">  ... vs Chad Java Swtich Expression! </h3><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dayNum = <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (day) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> MONDAY -&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> TUESDAY -&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> k = day.toString().length(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> result = f(k); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> result; } };</code> </pre> <br><p>  <strong>Por qu√© bueno</strong> : pocas letras, seguro, conveniente, nueva caracter√≠stica genial. </p><br><p>  <strong>Bonificaci√≥n</strong> : si eres s√°dico, te dar√° la m√°s profunda satisfacci√≥n, ya que miles de desarrolladores de IDE ahora est√°n atormentados con el soporte de esta funci√≥n.  Si <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">lany</a> , si? <del>  Puede atraparlo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">despu√©s del informe el 6 de abril</a> y pedirle amablemente que revele todos los detalles sucios. </del></p><br><blockquote>  <strong>Esta es una funci√≥n de vista previa, ¬°simplemente no funcionar√°!</strong>  Al compilar, en <code>javac</code> debe pasar las opciones de l√≠nea de comandos <code>--enable-preview --release 12</code> , y ejecutar <code>java</code> - solo el indicador <code>--enable-preview</code> . </blockquote><br><hr><br><p>  <strong>334: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">API de constantes JVM</a></strong> </p><br><p>  <strong>Caracter√≠stica interior</strong>  Los desarrolladores quieren manipular archivos de clase.  Debe hacer esto convenientemente, y esta es la declaraci√≥n del problema.  Al menos, eso es lo que Brian Goetz, propietario de este JEP, dijo :-) Todo esto es parte de un campo de batalla m√°s grande, pero por ahora no profundizaremos. </p><br><p>  Cada clase de Java tiene un denominado "grupo constante" donde hay un volcado de algunos valores (como cadenas e ints), o entidades de tiempo de ejecuci√≥n como clases y m√©todos.  Puede profundizar en este volcado utilizando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">la instrucci√≥n ldc</a> - "load costant", por lo que toda esta basura se llama constantes cargables.  Todav√≠a hay un caso especial para invocarse din√°micamente, pero no importa. </p><br><p>  Si trabajamos con archivos de clase, entonces queremos simular convenientemente instrumentos de c√≥digo de bytes y, por lo tanto, constantes cargables.  El primer deseo es simplemente crear los tipos de Java correspondientes, pero ¬øc√≥mo presentarlos con una clase "viva", la estructura <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>CONSTANT_Class_info</code></a> ?  <code>Class</code> objetos de <code>Class</code> dependen de la exactitud y consistencia de la carga de clases, y con la carga de clases en Java, se crea una bacanal infernal.  Para empezar, no todas las clases se pueden cargar en la m√°quina virtual, ¬°pero a√∫n debe describirlas! </p><br><p>  Me gustar√≠a administrar de alguna manera cosas como clases, m√©todos y bestias menos conocidas como manejadores de m√©todos y constantes din√°micas, teniendo en cuenta todas estas sutilezas. </p><br><p>  Esto se resuelve introduciendo nuevos tipos de enlaces simb√≥licos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">basados ‚Äã‚Äãen valores</a> (en el sentido de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JVMS 5.1</a> ), cada uno de los cuales describe un tipo espec√≠fico de constante.  Describe puramente nominalmente, aislado de las clases de carga o problemas de acceso.  Viven en paquetes como <code>java.lang.invoke.constant</code> y no lo solicitan, pero puede <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">consultar</a> el parche <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . </p><hr><br><p>  <strong>340: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Un puerto AArch64, no dos</a></strong> <br>  <strong>Caracter√≠stica externa</strong>  Ya en JDK 9 hab√≠a una situaci√≥n extra√±a cuando Oracle y Red Hat pusieron simult√°neamente en alerta a sus puertos ARM.  Y ahora vemos el final de la historia: la parte de 64 bits del puerto de Oraklov se elimin√≥ de la corriente arriba. </p><br><p>  Podr√≠a haber profundizado en la historia durante mucho tiempo, pero hay una mejor manera.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">BellSoft</a> particip√≥ en el desarrollo de este JEP, y su oficina est√° ubicada en San Petersburgo, al lado de la antigua oficina de Oracle. </p><br><p>  Por lo tanto, inmediatamente recurr√≠ a Alexey Voitilov, CTO de BellSoft: </p><br><blockquote>  "BellSoft lanza Liberica JDK, que, adem√°s de x86 Linux / Windows / Mac y Solaris / SPARC, tambi√©n es compatible con ARM. Comenzando con JDK 9 para ARM, nos centramos en mejorar el rendimiento del puerto AARCH64 para aplicaciones de servidor y seguimos admitiendo el puerto ARM de 32 bits para Entonces, en el momento del lanzamiento de JDK 11, hab√≠a una situaci√≥n en la que nadie admit√≠a la parte del puerto de 64 bits de Oracle (incluido Oracle), y la comunidad OpenJDK decidi√≥ eliminarla para centrarse en el puerto AARCH64. v√©ase, por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PEC 315</a> , que nos  integrado en JDK 11) y, a partir de JDK 12, admite todas las caracter√≠sticas presentes en el puerto de Oracle (la √∫ltima, Minimal VM, que integr√© en septiembre). Por lo tanto, me complace ayudar a Bob Vandette a eliminar este rudimento en JDK 12. Como resultado, OpenJDK la comunidad recibi√≥ un puerto en AARCH64 y un puerto ARM32, lo que ciertamente los hace m√°s f√°ciles de soportar ". </blockquote><br><hr><br><p>  <strong>341: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Archivos CDS predeterminados</a></strong> </p><br><p>  <strong>Caracter√≠stica interior</strong>  El problema es que al comienzo de una aplicaci√≥n Java, se cargan miles de clases, lo que crea la sensaci√≥n de que Java se ralentiza significativamente al inicio.  Pero qui√©n est√° all√≠ para mentir, esto no es solo una "sensaci√≥n", es as√≠.  Para solucionar el problema desde la antig√ºedad, se practican varios rituales. </p><br><p>  Class Data Sharing es una caracter√≠stica que nos ha llegado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">desde tiempos inmemoriales</a> , como una caracter√≠stica comercial de JDK 8 Update 40. Le permite empacar toda esta basura de inicio en un archivo de alg√∫n formato propio (no necesita saber cu√°l), despu√©s de lo cual la velocidad de lanzamiento Las aplicaciones est√°n aumentando.  Y despu√©s de un tiempo, apareci√≥ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JEP 310</a> : Application Class-Data Sharing, que nos permiti√≥ trabajar de la misma manera no solo con las clases del sistema, sino tambi√©n con las clases de aplicaci√≥n. </p><br><p>  Para las clases JDK, se ve as√≠.  Primero, volcamos las clases con el comando <code>java -Xshare:dump</code> , y luego ejecutamos la aplicaci√≥n, dici√©ndole que use este cach√©: <code>java -Xshare:on -jar app.jar</code> .  Todo, la startup ha mejorado un poco.  ¬øSab√≠as sobre esta caracter√≠stica?  ¬°Muchos que a√∫n no lo saben! </p><br><p>  Parece extra√±o aqu√≠: ¬øpor qu√© cada vez escribe ritualmente <code>-Xshare:dump</code> si el resultado predeterminado de este comando es un poco predecible incluso en la etapa de creaci√≥n de la distribuci√≥n JDK?  De acuerdo con la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n</a> , si la distribuci√≥n de Java 8 se instal√≥ utilizando el instalador, justo en el momento de la instalaci√≥n deber√≠a ejecutar los comandos necesarios para usted.  Al igual, el instalador est√° minando silenciosamente en la esquina.  Pero por que?  ¬øY qu√© hacer con la distribuci√≥n, que se distribuye no como un instalador, sino como un archivo zip? </p><br><p>  Es simple: comenzando con JDK 12, el archivo CDS ser√° generado por los creadores del kit de distribuci√≥n, inmediatamente despu√©s del enlace.  Incluso para compilaciones nocturnas (siempre que sean de 64 bits y nativas, no para compilaci√≥n cruzada). </p><br><p>  Los usuarios ni siquiera necesitan saber acerca de la presencia de esta caracter√≠stica, porque, comenzando con JDK 11, <code>-Xshare:auto</code> habilitado de forma predeterminada, y dicho archivo se recuperar√° autom√°ticamente.  ¬°Por lo tanto, el simple <strong>hecho de actualizar a JDK 12 acelera el lanzamiento de la aplicaci√≥n!</strong> </p><hr><br><p>  <strong>344: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Colecciones mixtas abortables para G1</a></strong> </p><br><p>  <strong>Caracter√≠stica interior</strong>  Para ser honesto <del>  No entiendo nada en el trabajo de G1 </del>  Una explicaci√≥n de las caracter√≠sticas de GC es una tarea ingrata.  Requiere una comprensi√≥n de los detalles de su trabajo tanto del explicador como de la comprensi√≥n.  Para la mayor√≠a de las personas, GC es una especie de infierno fuera de una caja de rap√© que puedes enga√±ar en caso de algo.  Por lo tanto, el problema debe explicarse de alguna manera m√°s simple. </p><br><p>  <strong>Problema</strong> : G1 podr√≠a funcionar mejor. </p><br><p>  Bueno, el problema es que el GC es un compromiso de muchos par√°metros, uno de los cuales es la duraci√≥n de la pausa.  A veces, la pausa es demasiado larga, y luego es bueno poder cancelarla. </p><br><p>  ¬øCu√°ndo sucede esto?  G1 realmente analiza el comportamiento de la aplicaci√≥n y selecciona el frente del trabajo (expresado como un <em>conjunto de recopilaci√≥n</em> ) en funci√≥n de sus conclusiones.  Cuando se aprueba el alcance del trabajo, G1 se compromete a recoger todos los objetos vivos en el conjunto de colecci√≥n, obstinadamente y sin parar, en una sola sesi√≥n.  A veces lleva demasiado tiempo.  En esencia, esto significa que G1 calcul√≥ incorrectamente la cantidad de trabajo.  Puede enga√±arlo cambiando repentinamente el comportamiento de su aplicaci√≥n para que la heur√≠stica funcione adem√°s de los datos incorrectos cuando demasiadas regiones antiguas ingresan al conjunto de recopilaci√≥n. </p><br><p>  Para salir de la situaci√≥n, G1 se finaliz√≥ mediante el siguiente mecanismo: si la heur√≠stica selecciona regularmente la cantidad incorrecta de trabajo, G1 cambia a recolecci√≥n de basura incremental, paso a paso, y cada paso siguiente (si no encaja en el tiempo de ejecuci√≥n objetivo) puede cancelarse.  No tiene sentido recopilar algo de forma incremental (regiones j√≥venes), por lo tanto, todo ese trabajo se resalta en el bloque "obligatorio", que todav√≠a se lleva a cabo de forma continua. </p><br><p>  ¬øQu√© hacer con el usuario final?  Nada, necesita actualizar a JDK 12, todo mejorar√° por s√≠ solo. </p><hr><br><p>  <strong>346: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Devuelva r√°pidamente la memoria comprometida no utilizada de G1</a></strong> </p><br><p>  <strong>Caracter√≠stica interior</strong>  El problema es que si tenemos una gran cadera que nadie usa activamente, parece justo devolver toda esta memoria inactiva al sistema operativo.  Antes de JDK 12, sin embargo, esto no sucedi√≥. </p><br><p>  Para lograr su objetivo en t√©rminos de la longitud de pausa permitida, G1 realiza un conjunto de ciclos incrementales, paralelos y de etapas m√∫ltiples.  En JDK 11, proporciona memoria comprometida al sistema operativo solo con GC completo, o durante la fase de marcado paralelo.  Si conecta el registro (-Xloggc: /home/gc.log -XX: + PrintGCDetails -XX: + PrintGCDateStamps), esta fase se muestra de la siguiente manera: </p><br><pre> <code class="plaintext hljs">8801.974: [G1Ergonomics (Concurrent Cycles) request concurrent cycle initiation, reason: occupancy higher than threshold, occupancy: 12582912000 bytes, allocation request: 0 bytes, threshold: 12562779330 bytes (45.00 %), source: end of GC] 8804.670: [G1Ergonomics (Concurrent Cycles) initiate concurrent cycle, reason: concurrent cycle initiation requested] 8805.612: [GC concurrent-mark-start] 8820.483: [GC concurrent-mark-end, 14.8711620 secs]</code> </pre> <br><p>  Lo curioso es que G1, como puede, lucha con paradas completas, y el ciclo concurrente comienza solo con asignaciones frecuentes y un mont√≥n obstruido.  Nuestra situaci√≥n, cuando nadie toca la cadera, es todo lo contrario.  ¬°Las situaciones en que G1 se rasca para dar memoria al sistema operativo ocurrir√°n muy raramente! </p><br><p>  Por lo tanto, todos habr√≠an puntuado en este problema ("¬°compre a√∫n m√°s RAM, que es como un p√≠caro!"). Si no fuera por uno, hay todo tipo de nubes y contenedores en los que esto significa una utilizaci√≥n insuficiente y la p√©rdida de dinero serio.  Mira, qu√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">informe tan genial</a> , lleno hasta el borde de dolor. </p><br><p>  La soluci√≥n fue ense√±arle a G1 a comportarse bien en este caso particular, como ya saben Shenanda o GenCon de OpenJ9.  Es necesario determinar la utilizaci√≥n insuficiente de la cadera y, en consecuencia, reducir su uso.  En algunas pruebas en Tomcat, esto permiti√≥ reducir el consumo de memoria a casi la mitad. </p><br><p>  La conclusi√≥n es que la aplicaci√≥n se considera inactiva, o si el intervalo (en milisegundos) ha <code>getloadavg()</code> desde la √∫ltima compilaci√≥n y no hay un ciclo concurrente, o si <code>getloadavg()</code> durante un per√≠odo de un minuto mostr√≥ una carga por debajo de un cierto umbral.  Tan pronto como sucede esto, comienza la recolecci√≥n peri√≥dica de basura: ciertamente no limpiar√° tan bien como el ensamblaje completo, pero afectar√° la aplicaci√≥n de manera m√≠nima. </p><br><p>  Puede insertarlo en este registro: </p><br><pre> <code class="plaintext hljs">(1) [6.084s][debug][gc,periodic ] Checking for periodic GC. [6.086s][info ][gc ] GC(13) Pause Young (Concurrent Start) (G1 Periodic Collection) 37M-&gt;36M(78M) 1.786ms (2) [9.087s][debug][gc,periodic ] Checking for periodic GC. [9.088s][info ][gc ] GC(15) Pause Young (Prepare Mixed) (G1 Periodic Collection) 9M-&gt;9M(32M) 0.722ms (3) [12.089s][debug][gc,periodic ] Checking for periodic GC. [12.091s][info ][gc ] GC(16) Pause Young (Mixed) (G1 Periodic Collection) 9M-&gt;5M(32M) 1.776ms (4) [15.092s][debug][gc,periodic ] Checking for periodic GC. [15.097s][info ][gc ] GC(17) Pause Young (Mixed) (G1 Periodic Collection) 5M-&gt;1M(32M) 4.142ms (5) [18.098s][debug][gc,periodic ] Checking for periodic GC. [18.100s][info ][gc ] GC(18) Pause Young (Concurrent Start) (G1 Periodic Collection) 1M-&gt;1M(32M) 1.685ms (6) [21.101s][debug][gc,periodic ] Checking for periodic GC. [21.102s][info ][gc ] GC(20) Pause Young (Concurrent Start) (G1 Periodic Collection) 1M-&gt;1M(32M) 0.868ms (7) [24.104s][debug][gc,periodic ] Checking for periodic GC. [24.104s][info ][gc ] GC(22) Pause Young (Concurrent Start) (G1 Periodic Collection) 1M-&gt;1M(32M) 0.778ms</code> </pre> <br><p>  Resuelto?  Yo no  En JEP, hay una traducci√≥n detallada del lenguaje de se√±as de cada l√≠nea del registro, y c√≥mo funciona el algoritmo, y todo lo dem√°s. </p><br><p>  "Y qu√©, ¬øpor qu√© lo descubr√≠?"  - usted pregunta  Ahora tenemos dos identificadores adicionales: <code>G1PeriodicGCInterval</code> y <code>G1PeriodicGCSystemLoadThreshold</code> , que se puede torcer cuando se pone mal.  Es seguro que alg√∫n d√≠a ser√° malo, ¬°es Java, beb√©! </p><hr><br><h1 id="itogi">  Resumen </h1><br><p>  Como resultado, tenemos un fuerte lanzamiento en nuestras manos, no una revoluci√≥n, sino una evoluci√≥n centrada en mejorar el rendimiento.  Exactamente la mitad de las mejoras est√°n relacionadas con el rendimiento: tres JEP sobre GC y uno sobre CDS, que prometen activarse por s√≠ mismos, solo necesitan actualizarse a JDK 12. Adem√°s, obtuvimos una funci√≥n de idioma (expresiones de cambio), dos nuevas herramientas para desarrolladores de JDK ( Constantes API y pruebas JMH), y ahora la comunidad puede enfocarse mejor en un solo puerto de 64 bits en ARM. </p><br><p>  En general, actualice a JDK 12 ahora, y que la Fuerza lo acompa√±e.  Lo necesitar√°s </p><br><blockquote>  Minuto de publicidad.  Muy pronto, del 5 al 6 de abril, se llevar√° a cabo la conferencia JPoint, que reunir√° a una gran cantidad de personas que saben mucho sobre JDK y todo tipo de nuevas caracter√≠sticas.  Por ejemplo, seguramente habr√° Simon Ritter de Azul con una conferencia sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">‚ÄúJDK 12: trampas para los incautos‚Äù</a> .  ¬°El lugar m√°s apropiado para discutir la √∫ltima versi√≥n!  Puede obtener m√°s informaci√≥n sobre JPoint en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sitio web oficial</a> . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/444434/">https://habr.com/ru/post/444434/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../444424/index.html">AMD Radeon VII: Chip de gama alta (Parte 2)</a></li>
<li><a href="../444426/index.html">Lyft y Uber salen a bolsa p√∫blica. ¬øPor qu√© invertir en Lyft?</a></li>
<li><a href="../444428/index.html">Mountain Car: resolviendo el desaf√≠o cl√°sico con entrenamiento de refuerzo</a></li>
<li><a href="../444430/index.html">An√°lisis: c√≥mo usar Present Perfect en ingl√©s</a></li>
<li><a href="../444432/index.html">El uso de Linux y software de c√≥digo abierto en nuestra instituci√≥n educativa: ¬øser o no ser?</a></li>
<li><a href="../444436/index.html">¬øQu√© es una botnet Mirai y c√≥mo puedo proteger mis dispositivos?</a></li>
<li><a href="../444438/index.html">Una breve historia del c√≥digo abierto: c√≥mo el software libre luch√≥ con el propietario</a></li>
<li><a href="../444442/index.html">Jetson Nano: Nvidia Machine Learning Single Board</a></li>
<li><a href="../444444/index.html">Los mejores fracasos de nuestras conferencias (Joker, JPoint, DotNext, Mobius, TechTrain, etc.)</a></li>
<li><a href="../444446/index.html">Hacer una aplicaci√≥n web moderna desde cero</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>