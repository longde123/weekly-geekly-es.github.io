<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïµÔ∏è üö¨ üïµüèø Potente regulador de cuatro canales para LED üë®üèæ‚Äçüöí üëàüèº ‚õîÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En este art√≠culo hablar√© sobre el proyecto de un potente atenuador de cuatro canales para tiras LED y l√°mparas (hasta 200 vatios de potencia total, 50...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Potente regulador de cuatro canales para LED</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/402155/">  En este art√≠culo hablar√© sobre el proyecto de un potente atenuador de cuatro canales para tiras LED y l√°mparas (hasta 200 vatios de potencia total, 50..100 vatios por canal) con una alta frecuencia de regulaci√≥n PWM (1 kilohercio con una profundidad de color de 10 bits), para iluminaci√≥n de alta calidad .  Adem√°s, tiene una entrada para el sensor de luz, funciones de retroalimentaci√≥n (emisi√≥n de informaci√≥n al controlador sobre el voltaje de entrada, voltaje en las entradas de medici√≥n, etc.) e incluso aislamiento galv√°nico del puerto de control en serie. <br><br><img src="https://habrastorage.org/files/34a/40c/43c/34a40c43cea94d2c86d0a577633c5993.JPG"><br><a name="habracut"></a><br>  Sucedi√≥ que decid√≠ cambiar mi perfil y ocuparme de los microcontroladores y la automatizaci√≥n, y despu√©s de unos meses recib√≠ una oferta tentadora para hacer una "casa inteligente" en la Rep√∫blica Dominicana, de modo que casi todos los aspectos de la vida de una villa bastante grande de tres grandes sean administrados y automatizados. edificios, desde iluminaci√≥n y clima, hasta robots de jard√≠n y sistemas de riego.  Como estaba cansado de la nieve y las heladas durante mucho tiempo, era imposible rechazar tal oferta, m√°s a√∫n porque me ayudaron mucho con el movimiento y la adaptaci√≥n. <br><br>  Por supuesto, una de las tareas m√°s importantes es controlar la iluminaci√≥n, tanto en muchas habitaciones como en exteriores.  Para ahorrar energ√≠a que es costosa aqu√≠, se utilizar√°n tiras de LED y l√°mparas de 12 voltios en casi todas partes, que se deben controlar con atenuadores.  Los modelos de atenuador existentes no fueron muy satisfactorios en todos los aspectos (una frecuencia de regulaci√≥n lo suficientemente alta, para la ausencia de parpadeo; potencia, para controlar tiras largas brillantes o l√°mparas / focos; protocolos de intercambio cerrados, etc.).  Entonces decid√≠ hacer mi dimmer. <br><br>  Un punto muy doloroso en la etapa de dise√±o fue la elecci√≥n de obtener energ√≠a de bajo voltaje a partir de 110 voltios de corriente alterna.  Incluso se consider√≥ una opci√≥n ex√≥tica con una reducci√≥n sin transformador inmediatamente hasta 12 voltios, pero debido a consideraciones el√©ctricas y de seguridad contra incendios se rechaz√≥.  Las fuentes de alimentaci√≥n listas para usar 110-&gt; 12 no eran tan caras ($ 20 por 120 vatios y $ 40 por 200), aunque en general.  Pero, afortunadamente, hab√≠a mucho espacio para el equipo, as√≠ que me decid√≠ por esta opci√≥n. <br><br>  El circuito result√≥ ser relativamente simple (a excepci√≥n del nodo de aislamiento galv√°nico del puerto serie en cuatro optoacopladores): el microcontrolador STM32F030F4P6, dos controladores ADP3624 MOSFET y transistores de tecla IRLB8748, seleccionados con un gran margen (con una carga de 100 vatios por canal; apenas estaban calientes) , m√°s un m√≥dulo de reducci√≥n de pulsos chino ya preparado a 3,3 voltios.  Los controladores seleccionados le permiten controlar a frecuencias de hasta megahercios, lo que da la frecuencia del voltaje de salida en kilohercios, con un paso PWM de un microsegundo.  En la pr√°ctica, incluso se prob√≥ un modo con una frecuencia PWM de ocho kilohercios y un paso de 125 nanosegundos, pero en la pr√°ctica, una frecuencia de ajuste tan alta amenaza cierta inestabilidad en la salida: los transistores simplemente no tienen tiempo para cerrarse tan r√°pido y la calidad del ajuste "flotar√°". <br><br> <a href=""><img src="https://habrastorage.org/files/066/0b3/8bb/0660b38bbd6f408894a90839f6ce3407.png" width="900"></a> <br><br>  El cableado de la placa para corrientes tan altas fue un desaf√≠o bastante dif√≠cil para m√≠, nunca antes me hab√≠a encontrado con tales tareas.  Se decidi√≥ hacerlos lo m√°s anchos posible (un conductor con un ancho de al menos 10 mm en una capa de 70 micras de cobre), y cuando esto no sea posible, use la segunda capa, combin√°ndolas con una gran cantidad de v√≠as.  Quit√© la m√°scara de los conductores de alta carga para que, si fuera necesario, se pudiera aplicar un bus de cobre en la parte superior (pero esto no era necesario, incluso con una carga m√°xima de 200 vatios: la placa se calienta hasta solo 40 grados en una caja cerrada). <br><br>  El protocolo de intercambio, debido a la falta de memoria flash, se eligi√≥ extremadamente simple, los comandos se env√≠an l√≠nea por l√≠nea, en forma de texto "0: 512" (canal cero, PWM 512), los datos de salida se transmiten de la misma manera (voltaje, datos del primer fotorresistor, datos del segundo fotorresistor, voltaje de entrada a la entrada de ADC3, voltaje de entrada a la entrada de ADC5, voltaje del controlador, temperatura del chip).  Ser√≠a m√°s correcto usar el protocolo MQTT, pero tem√≠a que no encajara en flash (kilobytes de espacio libre permanec√≠an fuera de 16). <br><br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥digo fuente en github</a> <br><br>  Se parpadea un atenuador a trav√©s del mismo puerto de control (debe aplicar una unidad al 4 ¬∞ pin, luego el pulso al 5 ¬∞, despu√©s de lo cual el microcontrolador se puede cargar usando el protocolo serie est√°ndar STM32. Para controlar un atenuador ya parpadeado, tres cables son suficientes, + 3.3 / + 5V en el primer pin, datos en el tercero, en el sexto - la tierra. La configuraci√≥n del puerto de control en el firmware es 38400 baudios, 8n1. <br><br>  Por supuesto, la primera versi√≥n del dimmer no estuvo exenta de defectos.  Result√≥ que un condensador 470 microfaradios por 12 voltios no es suficiente, se calienta demasiado con una carga pesada (especialmente si los cables a la fuente de alimentaci√≥n son delgados para tales corrientes), necesitamos agregar un par m√°s m√°s potentes (de acuerdo con la corriente m√°xima permitida).  El m√≥dulo de alimentaci√≥n chino tambi√©n result√≥ ser una soluci√≥n fallida, uno de los m√≥dulos fall√≥ durante las pruebas sin raz√≥n aparente, lo reemplazar√© con un convertidor en TPS62177, adem√°s tambi√©n agregar√© otro convertidor opcional en AP1501 (24-&gt; 12), para el caso de la fuente de alimentaci√≥n del atenuador de 24 voltios  Bueno, necesitar√° un circuito de control para un ventilador de 120 mm para la fuente de alimentaci√≥n (en los casos en que la carga est√© cerca del m√°ximo), con control t√©rmico e infinitamente ajustable.  Tambi√©n decid√≠ reemplazar el complejo aislamiento galv√°nico del puerto de control con el chip SI8641. <br><br>  Hay problemas en la parte del software: a veces la lectura del puerto serie se bloquea, bloquea el control (la experiencia con STM32 todav√≠a no es muy grande para m√≠), y el protocolo result√≥ ser demasiado idiota, tal vez intente introducir un MQTT normal all√≠. <br><br>  Aqu√≠ hay un ejemplo del uso de un atenuador en un banco de pruebas (mi puerta de entrada), junto con un sensor de distancia IR (el color y el brillo de la tira RGBW es ajustable, dependiendo de la distancia, a trav√©s de openhab): <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/knXuq3a6p4M" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  En el pr√≥ximo art√≠culo hablar√© sobre una unidad de conmutaci√≥n de cuatro canales de cargas de CA de ocho kilovatios con rel√©s biestables (para reducir la energ√≠a consumida en vano) midiendo el consumo de corriente en cada canal. <br><br>  Bueno, terminar√© con una nota positiva.  Al final result√≥ que, en la Rep√∫blica Dominicana, el 99% del alcohol isoprop√≠lico o et√≠lico no se puede encontrar para lavar placas de circuito (y tambi√©n gasolina pura).  Puede encontrar un 70% mezclado, obviamente, no con agua destilada, dejando manchas.  Y a√∫n puede encontrar f√°cilmente el 99,6% de metilo (no s√© por qu√© lo venden en absoluto, incluso da miedo usarlo como solvente; puede respirar en pares).  Decid√≠ intentar enjuagar el primer tablero de dimmer con agua destilada, que compr√© en una tienda de art√≠culos para el hogar.  Afortunadamente, no me di cuenta de la idea de verificar el sabor del destilado.  Pero la placa de circuito y el fregadero galvanizado realmente no me gust√≥ cuando los vert√≠ con electrolito de bater√≠a (las botellas de agua estaban en el estante con √©l, obviamente agarr√© el equivocado cuando lo puse en la cesta) ... <br></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es402155/">https://habr.com/ru/post/es402155/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es402145/index.html">Continuando con el tema "C√°ncer. ¬øQu√© hacer con √©l ... "</a></li>
<li><a href="../es402147/index.html">IBM grab√≥ un solo bit de informaci√≥n en un √°tomo</a></li>
<li><a href="../es402149/index.html">Intel XMM 7560 - Gigabit por aire</a></li>
<li><a href="../es402151/index.html">Notario digital de blockchain: Emercoin DPO Antifake</a></li>
<li><a href="../es402153/index.html">"Clasificamos" la casa impresa</a></li>
<li><a href="../es402157/index.html">Chris Kaspersky muri√≥. La memoria de un verdadero hacker est√° dedicada</a></li>
<li><a href="../es402159/index.html">Ranking de febrero de los desarrollos cient√≠ficos m√°s medi√°ticos</a></li>
<li><a href="../es402161/index.html">Los fabricantes de software cierran masivamente las vulnerabilidades utilizadas por la CIA</a></li>
<li><a href="../es402163/index.html">Historia actualizada de Steve Jobs</a></li>
<li><a href="../es402165/index.html">La "c√∫pula" m√°s grande de la ciencia de Istra</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>