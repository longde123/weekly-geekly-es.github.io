<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßëüèø‚Äçü§ù‚Äçüßëüèæ üëéüèø üî† Disparamos en el pie, procesando los datos de entrada. üíÖüèΩ ü§¶üèæ üë®üèø‚Äçüöí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El enlace en el art√≠culo de hoy es diferente al habitual. Este no es un proyecto para el que se analiz√≥ el c√≥digo fuente, sino una serie de respuestas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Disparamos en el pie, procesando los datos de entrada.</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/433932/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/jh/iw/l-/jhiwl-y02cm4bhppsrj9flbpqsi.png"></div><br>  El enlace en el art√≠culo de hoy es diferente al habitual.  Este no es un proyecto para el que se analiz√≥ el c√≥digo fuente, sino una serie de respuestas de la misma regla de diagn√≥stico en varios proyectos diferentes.  ¬øCu√°l es el inter√©s aqu√≠?  El hecho es que algunos de los fragmentos de c√≥digo considerados contienen errores que son reproducibles cuando se trabaja con la aplicaci√≥n, mientras que otros contienen vulnerabilidades (CVE).  Adem√°s, al final del art√≠culo discutiremos un poco sobre el tema de los defectos de seguridad. <br><a name="habracut"></a><br><h2>  Breve Prefacio </h2><br>  Todos los errores que se considerar√°n hoy en el art√≠culo tienen un patr√≥n similar: <br><br><ul><li>  el programa recibe datos de la secuencia <i>stdin</i> ; </li><li>  se realiza una verificaci√≥n para el √©xito de la lectura de datos; </li><li>  Si los datos se leyeron con √©xito, el car√°cter de acarreo se elimina de la l√≠nea. </li></ul><br>  Sin embargo, todos los fragmentos que se considerar√°n contienen errores y son vulnerables a la entrada manipulada.  Dado que los datos se reciben de un usuario que puede violar la l√≥gica de ejecuci√≥n de la aplicaci√≥n, hubo una gran tentaci√≥n de intentar romper algo.  Lo cual hice. <br><br>  Todos los problemas a continuaci√≥n fueron descubiertos por el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">analizador est√°tico PVS-Studio</a> , que busca errores en el c√≥digo no solo para C, C ++, sino tambi√©n para C #, Java. <br><br>  Por supuesto, encontrar un problema con un analizador est√°tico es bueno, pero encontrar y reproducir es un nivel de placer completamente diferente.  :) <br><br><h2>  Freeswitch </h2><br>  El primer fragmento de c√≥digo sospechoso se encontr√≥ en el c√≥digo del m√≥dulo <i>fs_cli.exe</i> , que forma parte del kit de distribuci√≥n FreeSWITCH: <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">basic_gets</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *cnt)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c = getchar(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fgets(command_buf, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(command_buf) - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>) != command_buf) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } command_buf[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(command_buf)<span class="hljs-number"><span class="hljs-number">-1</span></span>] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* remove endline */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } .... }</code> </pre> <br>  <b>Advertencia de PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">V1010</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CWE-20 Los</a> datos contaminados no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">verificados</a> se usan en el √≠ndice: 'strlen (command_buf)'. <br><br>  El analizador advierte de una llamada sospechosa por √≠ndice a la matriz <i>command_buf</i> .  Se considera sospechoso porque los datos externos no verificados se utilizan como √≠ndice.  Externo: porque se obtienen a trav√©s de la funci√≥n <i>fgets</i> del flujo <i>est√°ndar</i> .  Sin verificar, ya que no se realiz√≥ ninguna verificaci√≥n antes del uso.  La expresi√≥n <i>fgets (command_buf, ....)! = Command_buf</i> no cuenta, porque de esta manera solo verificamos el hecho de recibir los datos, pero no su contenido. <br><br>  El problema con este c√≥digo es que, bajo ciertas condiciones, '\ 0' se escribir√° fuera de la matriz, lo que conducir√° a un comportamiento indefinido.  Para hacer esto, simplemente ingrese una cadena de longitud cero (una cadena de longitud cero desde el punto de vista del lenguaje C, es decir, uno en el que el primer car√°cter ser√° '\ 0'). <br><br>  Calculemos qu√© sucede si pasa una cadena de longitud cero a la entrada: <br><br><ul><li>  <i>fgets (command_buf, ....)</i> -&gt; <i>command_buf</i> ; </li><li>  <i>fgets (....)! = command_buf</i> -&gt; <i>false</i> ( <i>entonces la</i> rama de la <i>instrucci√≥n if se</i> ignora); </li><li>  <i>strlen (comando_buf)</i> -&gt; <i>0</i> ; </li><li>  <i>command_buf [strlen (command_buf) - 1]</i> -&gt; <i>command_buf [-1]</i> . </li></ul><br>  ¬°Uy! <br><br>  Lo interesante aqu√≠ es que esta advertencia del analizador se puede "sentir con las manos".  Para repetir el problema, necesita: <br><br><ul><li>  llevar el programa a esta funci√≥n; </li><li>  afine la entrada para que la llamada <i>getchar ()</i> devuelva un valor negativo; </li><li>  El paso para los <i>fgets</i> funciona una l√≠nea con un terminal cero al principio, que deber√≠a leer con √©xito. </li></ul><br>  Hurgando un poco en la fuente, invent√© una secuencia espec√≠fica para reproducir el problema: <br><br><ul><li>  Ejecute <i>fs_cli.exe</i> en modo por lotes ( <i>fs_cli.exe -b</i> ).  Observo que para realizar m√°s pasos, la conexi√≥n <i>fs_cli.exe</i> al servidor debe ser exitosa.  Para hacer esto, es suficiente, por ejemplo, ejecutar <i>FreeSwitchConsole.exe localmente</i> como administrador. </li><li>  Llevamos a cabo la entrada para que la llamada <i>getchar ()</i> devuelva un valor negativo. </li><li>  Ingrese una l√≠nea con un terminal cero al principio (por ejemplo, '\ 0Oooops'). </li><li>  .... </li><li>  BENEFICIOS! </li></ul><br>  La siguiente es una reproducci√≥n de video del problema: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/jSYJirPIK8E" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  Ncftp </h2><br>  Se descubri√≥ un problema similar en el proyecto NcFTP, pero ya se encontr√≥ en dos lugares.  Dado que el c√≥digo es similar, considere solo un lugar problem√°tico: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NcFTPConfirmResumeDownloadProc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fgets(newname, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(newname) - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>) == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) newname[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; newname[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(newname) - <span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; .... }</code> </pre> <br>  <b>Advertencia de PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">V1010</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CWE-20 Los</a> datos contaminados no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">verificados</a> se usan en el √≠ndice: 'strlen (newname)'. <br><br>  Aqu√≠, a diferencia del ejemplo de FreeSWITCH, el c√≥digo est√° escrito peor y m√°s propenso a problemas.  Por ejemplo, escribir '\ 0' ocurre independientemente de si la lectura fue exitosa usando <i>fgets</i> o no.  Es decir, hay a√∫n m√°s posibilidades de c√≥mo romper la l√≥gica normal de ejecuci√≥n.  Vayamos de una manera comprobada: a trav√©s de l√≠neas de longitud cero. <br><br>  El problema reproducido es un poco m√°s complicado que con FreeSWITCH.  La secuencia de pasos se describe a continuaci√≥n: <br><br><ul><li>  iniciando y conect√°ndose al servidor desde el cual puede descargar el archivo.  Por ejemplo, us√© <i>speedtest.tele2.net</i> (al final, el comando de inicio de la aplicaci√≥n se ve as√≠: <i>ncftp.exe <a href="">speedtest.tele2.net</a></i> ); </li><li>  descargando un archivo del servidor.  Localmente, un archivo con el mismo nombre pero con diferentes propiedades ya deber√≠a existir.  Puede, por ejemplo, descargar un archivo del servidor, cambiarlo e intentar ejecutar el comando de descarga nuevamente (por ejemplo, <i>obtener 512KB.zip</i> ); </li><li>  responda la pregunta sobre c√≥mo elegir una acci√≥n con una l√≠nea que comience con el car√°cter 'N' (por ejemplo, <i>ahora divirt√°monos</i> ); </li><li>  ingrese '\ 0' (o algo m√°s interesante); </li><li>  .... </li><li>  BENEFICIOS! </li></ul><br>  La reproducci√≥n del problema tambi√©n se graba en video: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/8DBQjvPQ7tk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  Openldap </h2><br>  En el proyecto OpenLDAP (m√°s precisamente, en una de las utilidades que lo acompa√±an) pisaron el mismo rastrillo que en FreeSWITCH.  Solo se intenta eliminar un car√°cter de salto de l√≠nea si la l√≠nea se ley√≥ con √©xito, pero tampoco hay protecci√≥n contra las l√≠neas de longitud cero. <br><br>  Fragmento de c√≥digo: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> **argv )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> buf[ <span class="hljs-number"><span class="hljs-number">4096</span></span> ]; FILE *fp = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { fp = <span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>; } .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( fp == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ((rc == <span class="hljs-number"><span class="hljs-number">0</span></span> || contoper) &amp;&amp; fgets(buf, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(buf), fp) != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { buf[ <span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>( buf ) - <span class="hljs-number"><span class="hljs-number">1</span></span> ] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* remove trailing newline */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( *buf != <span class="hljs-string"><span class="hljs-string">'\0'</span></span> ) { rc = dodelete( ld, buf ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( rc != <span class="hljs-number"><span class="hljs-number">0</span></span> ) retval = rc; } } } .... }</code> </pre> <br>  <b>Advertencia de PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">V1010</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CWE-20 Los</a> datos contaminados no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">verificados</a> se usan en el √≠ndice: 'strlen (buf)'. <br><br>  Tiramos el exceso para que la esencia del problema se vuelva m√°s obvia: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (.... &amp;&amp; fgets(buf, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(buf), fp) != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { buf[ <span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>( buf ) - <span class="hljs-number"><span class="hljs-number">1</span></span> ] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; .... }</code> </pre> <br>  Este c√≥digo es mejor que NcFTP, pero sigue siendo vulnerable.  Si en la solicitud se <i>olvida</i> pasar una cadena de longitud cero a la entrada: <br><br><ul><li>  <i>fgets (buf, ....)</i> -&gt; <i>buf</i> ; </li><li>  <i>fgets (....)! = NULL</i> -&gt; <i>true</i> (el cuerpo del <i>ciclo while</i> comienza a ejecutarse); </li><li>  <i>strlen (buf) - 1</i> -&gt; <i>0 - 1</i> -&gt; <i>-1</i> ; </li><li>  <i>buf [-1] = '\ 0'</i> . </li></ul><br><h2>  libidn </h2><br>  A pesar del hecho de que los errores discutidos anteriormente son bastante interesantes (se reproducen de manera estable y pueden ser "tocados" (excepto que no pude alcanzar el problema de OpenLDAP)), no se los puede llamar vulnerabilidades, solo porque Los problemas no tienen asignados identificadores CVE. <br><br>  Sin embargo, algunas vulnerabilidades reales tienen el mismo patr√≥n de problemas.  Los dos fragmentos de c√≥digo a continuaci√≥n se aplican al proyecto libidn. <br><br>  Fragmento de c√≥digo: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *argv[])</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fgets (readbuf, BUFSIZ, <span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>) == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (feof (<span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; error (EXIT_FAILURE, errno, _(<span class="hljs-string"><span class="hljs-string">"input error"</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (readbuf[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (readbuf) - <span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) readbuf[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (readbuf) - <span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; .... }</code> </pre> <br>  <b>Advertencia de PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">V1010</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CWE-20 Los</a> datos contaminados no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">verificados</a> se usan en el √≠ndice: 'strlen (readbuf)'. <br><br>  La situaci√≥n es similar, excepto que, a diferencia de los ejemplos anteriores, donde la grabaci√≥n se realiz√≥ en el √≠ndice <i>-1</i> , aqu√≠ se realiza la lectura.  Sin embargo, este sigue siendo un comportamiento indefinido.  A este error se le ha <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">asignado</a> su propio identificador <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CVE</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CVE-2015-8948</a> ). <br><br>  Despu√©s de detectar un problema, este c√≥digo se cambi√≥ de la siguiente manera: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *argv[])</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (getline (&amp;line, &amp;linelen, <span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (feof (<span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; error (EXIT_FAILURE, errno, _(<span class="hljs-string"><span class="hljs-string">"input error"</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (line[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (line) - <span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) line[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (line) - <span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; .... }</code> </pre> <br>  ¬øUn poco sorprendido?  Sucede  Nueva vulnerabilidad, identificador CVE correspondiente: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CVE-2016-6262</a> . <br><br>  <b>Advertencia de PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">V1010</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CWE-20 Los</a> datos contaminados no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">verificados</a> se usan en el √≠ndice: 'strlen (l√≠nea)'. <br><br>  En otro intento, el problema se solucion√≥ agregando una verificaci√≥n para la longitud de la cadena de entrada: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (line) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (line[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (line) - <span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) line[<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span> (line) - <span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>;</code> </pre> <br>  Echemos un vistazo a las fechas.  El compromiso de 'cierre' CVE-2015-8948 - 10/08/2015.  Comprometer el cierre CVE-2016-62-62 - 14/01/2016.  Es decir, la diferencia entre las correcciones anteriores es de <i>5 meses</i> .  Aqu√≠ recuerda la ventaja del an√°lisis est√°tico como la detecci√≥n de errores en las primeras etapas de la escritura de c√≥digo ... <br><br><h2>  An√°lisis est√°tico y seguridad </h2><br>  No habr√° m√°s ejemplos de c√≥digo; en cambio, estad√≠sticas y razonamiento.  En esta secci√≥n, la opini√≥n del autor puede no coincidir con la opini√≥n del lector mucho m√°s que antes en este art√≠culo. <br><br>  <b>Nota</b>  Le recomiendo que lea otro art√≠culo sobre un tema similar: " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">¬øC√≥mo puede ayudar PVS-Studio a encontrar vulnerabilidades?</a> ".  Hay ejemplos interesantes de vulnerabilidades que parecen simples errores.  Adem√°s, en ese art√≠culo habl√© un poco sobre la terminolog√≠a y por qu√© el an√°lisis est√°tico es imprescindible si le preocupa el tema de la seguridad. <br><br>  Veamos las estad√≠sticas sobre la cantidad de vulnerabilidades descubiertas en los √∫ltimos 10 a√±os para evaluar la situaci√≥n.  Tom√© los datos del sitio web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Detalles de CVE</a> . <br><br><p><img src="https://habrastorage.org/webt/lu/au/2i/luau2ik1aoqytidzblkeqjy8vhs.png" alt="Imagen 2"></p><br><br>  Se avecina una situaci√≥n interesante.  Hasta 2014, el n√∫mero de CVE registradas no super√≥ la marca de 6,000 unidades y, a partir de, no cay√≥ por debajo.  Pero lo m√°s interesante aqu√≠, por supuesto, son las estad√≠sticas para 2017: el l√≠der absoluto (14,714 unidades).  En cuanto al a√±o actual 2018, a√∫n no ha terminado, pero ya est√° batiendo r√©cords: 15.310 unidades. <br><br>  ¬øSignifica esto que todo el nuevo software est√° lleno de agujeros como un tamiz?  No lo creo, y he aqu√≠ por qu√©: <br><br><ul><li>  Mayor inter√©s en el tema de las vulnerabilidades.  Seguramente, incluso si no est√° muy cerca del tema de la seguridad, ha encontrado repetidamente art√≠culos, notas, informes y videos sobre el tema de la seguridad.  En otras palabras, se cre√≥ una especie de "bombo".  ¬øEs malo?  Probablemente no.  Al final, todo se reduce al hecho de que los desarrolladores est√°n m√°s preocupados por la seguridad de las aplicaciones, lo cual es bueno. </li><li>  Un aumento en el n√∫mero de aplicaciones desarrolladas.  M√°s c√≥digo: es m√°s probable que ocurra cualquier vulnerabilidad que reponga las estad√≠sticas. </li><li>  Herramientas de b√∫squeda de vulnerabilidades mejoradas y garant√≠a de calidad del c√≥digo.  M√°s demanda -&gt; m√°s oferta.  Los analizadores, fuzzers y otras herramientas son cada vez m√°s avanzados, lo que juega en manos de aquellos que desean buscar vulnerabilidades (independientemente de qu√© lado de las barricadas se encuentren). </li></ul><br>  Por lo tanto, la tendencia emergente no puede llamarse exclusivamente negativa: los editores est√°n m√°s preocupados por la seguridad de la informaci√≥n, se mejoran las herramientas para encontrar problemas y, sin duda, todo esto es positivo. <br><br>  ¬øEsto significa que puedes relajarte y no "ba√±arte"?  Creo que no  Si le preocupa el tema de seguridad de sus aplicaciones, debe tomar tantas medidas de seguridad como sea posible.  Esto es especialmente cierto si el c√≥digo fuente est√° en el dominio p√∫blico, ya que: <br><br><ul><li>  m√°s susceptible a incrustar vulnerabilidades externas; </li><li>  m√°s propensos a "sondear" por aquellos "caballeros" que est√©n interesados ‚Äã‚Äãen agujeros en su aplicaci√≥n con el prop√≥sito de explotarlos.  Aunque los simpatizantes en este caso podr√°n ayudarlo m√°s. </li></ul><br>  No quiero decir que no necesita traducir sus proyectos en c√≥digo abierto.  Solo tenga en cuenta los controles de calidad / seguridad adecuados. <br><br>  ¬øEs el an√°lisis est√°tico una medida tan adicional?  Si  El an√°lisis est√°tico hace un buen trabajo al detectar vulnerabilidades potenciales que podr√≠an volverse reales en el futuro. <br><br>  Me parece (admito que estoy equivocado) que muchos consideran las vulnerabilidades como un fen√≥meno de alto nivel.  Si y no  Los problemas de c√≥digo que parecen simples errores de programaci√≥n tambi√©n pueden ser vulnerabilidades graves.  Una vez m√°s, se proporcionan algunos ejemplos de tales vulnerabilidades en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo mencionado anteriormente</a> .  No subestimes los errores 'simples'. <br><br><h2>  Conclusi√≥n </h2><br>  No olvide que los datos de entrada pueden ser de longitud cero, y esto tambi√©n debe tenerse en cuenta. <br><br>  Conclusiones sobre si todo el bombo con vulnerabilidades es solo bombo, o si el problema existe, h√°galo usted mismo. <br><br>  Por mi parte, a menos que proponga probar su proyecto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PVS-Studio</a> , si a√∫n no lo ha hecho. <br><br>  Todo lo mejor! <br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/ts/z9/km/tsz9kmyjtteajhd4x1au60rsrvq.png" align="left"></a> </p><br><br>  Si desea compartir este art√≠culo con una audiencia de habla inglesa, utilice el enlace a la traducci√≥n: Sergey Vasiliev.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Disparate en el pie cuando manejes datos de entrada</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es433932/">https://habr.com/ru/post/es433932/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es433916/index.html">Ve comunidad en Kazan y nuestras reuniones</a></li>
<li><a href="../es433918/index.html">¬øPor qu√© la web es tan complicada?</a></li>
<li><a href="../es433922/index.html">Kubernetes Intensive: Empleos de soporte</a></li>
<li><a href="../es433926/index.html">Marcos Javascript: tendencias 2019</a></li>
<li><a href="../es433930/index.html">Perfiles separados para aut√≥nomos y clientes.</a></li>
<li><a href="../es433934/index.html">Marco √°gil SAFe o escalado</a></li>
<li><a href="../es433936/index.html">¬øBusca un regalo de alta tecnolog√≠a para un ni√±o? Piensa en un patio de recreo, no en un corralito</a></li>
<li><a href="../es433938/index.html">C√≥mo Yandex y Google resumen el a√±o</a></li>
<li><a href="../es433940/index.html">¬øCu√°nto cuesta la revisi√≥n en la AppStore?</a></li>
<li><a href="../es433944/index.html">Excepciones devastadoras</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>