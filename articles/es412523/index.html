<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïµüèø üëÇüèæ üê• ConvNets. Prototipo de un proyecto usando Mask R-CNN üàµ üè• üë®üèª‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola Habr! Finalmente, esperamos otra parte de la serie de materiales del graduado de nuestros programas de Big Data Specialist y Deep Learning , Cyri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ConvNets. Prototipo de un proyecto usando Mask R-CNN</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/newprolab/blog/412523/">  Hola Habr!  Finalmente, esperamos otra parte de la serie de materiales del graduado de nuestros programas de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Big Data Specialist</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Deep Learning</a> , Cyril Danilyuk, sobre el uso de Mask R-CNN, las redes neuronales actualmente populares, como parte de un sistema para clasificar im√°genes, a saber evaluar la calidad de un plato preparado utilizando un conjunto de datos de sensores. <br><br>  Despu√©s de examinar el conjunto de datos del juguete que consta de im√°genes de se√±ales de tr√°fico en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo anterior</a> , ahora podemos proceder a resolver el problema que enfrent√© en la vida real: <b>"¬øEs posible implementar el algoritmo de aprendizaje profundo, que podr√≠a distinguir los platos de alta calidad de los platos malos uno por uno? fotos?</b>  .  En resumen, el negocio quer√≠a esto: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fv/_o/vv/fv_ovvsls8uz-qdmfurmijy-qbk.png"></div>  <sub>Lo que representa una empresa cuando piensa en el aprendizaje autom√°tico:</sub> <br><a name="habracut"></a><br>  Este es un ejemplo de un problema planteado incorrectamente: en este caso es imposible determinar si existe una soluci√≥n, si es √∫nica y estable.  Adem√°s, la declaraci√≥n del problema en s√≠ es muy vaga, sin mencionar la implementaci√≥n de su soluci√≥n.  Por supuesto, este art√≠culo no est√° dedicado a la efectividad de las comunicaciones o la gesti√≥n de proyectos, pero es importante tener en cuenta: <b>nunca tome proyectos en los que el resultado final no est√© definido y registrado en los T√©rminos de Referencia.</b>  Una de las formas m√°s confiables para lidiar con tal incertidumbre es construir primero un prototipo y luego, utilizando nuevos conocimientos, estructurar el resto de la tarea.  Eso es lo que hicimos. <br><br><h3>  Declaraci√≥n del problema. </h3><br>  En mi prototipo, me concentr√© en un plato del men√∫, una tortilla, y constru√≠ una tuber√≠a escalable, que determina la "calidad" de la tortilla en la salida.  Esto se puede describir con m√°s detalle de la siguiente manera: <br><br><ul><li>  <b>Tipo de problema:</b> clasificaci√≥n multiclase con 6 clases de calidad discretas: <i>buena</i> (buena), <i>yema rota</i> (con yema para untar), <i>sobrecocida</i> (sobrecocida), dos huevos (dos huevos), cuatro huevos (cuatro huevos), piezas <i>mal colocadas</i> (con piezas esparcidas en un plato) . </li><li> <b>Conjunto de datos:</b> 351 fotograf√≠as recolectadas manualmente de varias tortillas.  Muestras de entrenamiento / validaci√≥n / prueba: 139/32/180 fotos mixtas. </li><li>  <b>Etiquetas de clase:</b> cada foto corresponde a una etiqueta de clase correspondiente a una evaluaci√≥n subjetiva de la calidad de la tortilla. </li><li>  <b>M√©trica:</b> entrop√≠a cruzada categ√≥rica. </li><li>  <b>Conocimiento m√≠nimo del dominio: una</b> tortilla de "calidad" deber√≠a tener este aspecto: consta de tres huevos, una peque√±a cantidad de tocino, una hoja de perejil en el centro, no tiene yemas y trozos demasiado cocidos.  Adem√°s, la composici√≥n general debe "verse bien", es decir, las piezas no deben esparcirse por todo el plato. </li><li>  <b>Criterio de finalizaci√≥n: el</b> mejor valor de la entrop√≠a cruzada en la muestra de prueba entre todos los posibles despu√©s de dos semanas de desarrollo del prototipo. </li><li>  <b>El m√©todo de visualizaci√≥n final:</b> t-SNE en el espacio de datos de una dimensi√≥n m√°s peque√±a. </li></ul><br><img src="https://habrastorage.org/webt/yb/8i/uk/yb8iuk0ics242w3vpztsjefgucg.png"><br>  <sub>Im√°genes de entrada</sub> <br><br>  El objetivo principal de la tuber√≠a es aprender a combinar varios tipos de se√±ales (por ejemplo, im√°genes desde diferentes √°ngulos, un mapa de calor, etc.), despu√©s de haber recibido una representaci√≥n precomprimida de cada una de ellas y pasar estas caracter√≠sticas a trav√©s del clasificador de red neuronal para la predicci√≥n final.  Por lo tanto, podemos realizar nuestro prototipo y hacerlo pr√°cticamente aplicable en futuros trabajos.  A continuaci√≥n se presentan algunas de las se√±ales utilizadas en el prototipo: <br><br><ul><li>  M√°scaras de ingredientes clave (M√°scara R-CNN): <i>Se√±al No. 1</i> . </li><li>  El n√∫mero de ingredientes clave en el marco., <i>Se√±al n√∫mero 2</i> . </li><li>  Cultivo RGB de platos con tortilla sin fondo.  Para simplificar, decid√≠ no agregarlos al modelo todav√≠a, aunque son la se√±al m√°s obvia: en el futuro, puede entrenar la red neuronal convolucional para la clasificaci√≥n utilizando alguna funci√≥n de <i>p√©rdida de triplete</i> adecuada, calcular incrustaciones de im√°genes y cortar la <i>distancia L2</i> de la corriente Im√°genes para perfeccionar.  Desafortunadamente, no tuve la oportunidad de probar esta hip√≥tesis, ya que la muestra de prueba constaba de solo 139 objetos. </li></ul><br><h3>  Vista general de la tuber√≠a. </h3><br>  Observo que tendr√© que omitir algunos pasos importantes, como el an√°lisis de datos exploratorios, la construcci√≥n de un clasificador b√°sico y el etiquetado activo (mi t√©rmino propuesto, que significa anotaci√≥n semiautom√°tica de objetos, inspirada en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">video de demostraci√≥n Polygon-RNN</a> ) para la m√°scara R-CNN (m√°s sobre esto en las pr√≥ximas publicaciones). <br><br>  Eche un vistazo a toda la tuber√≠a en general: <br><br><img src="https://habrastorage.org/webt/er/bd/m2/erbdm2blw4soc4vjtoabjlwbbrg.png"><br>  <sub>En este art√≠culo, estamos interesados ‚Äã‚Äãen las etapas de la m√°scara R-CNN y la clasificaci√≥n dentro de la tuber√≠a.</sub> <br><br>  A continuaci√≥n, consideraremos tres etapas: 1) usar la m√°scara R-CNN para construir m√°scaras de ingredientes de tortilla;  2) clasificador ConvNet basado en Keras;  3) visualizaci√≥n de resultados usando t-SNE. <br><br><h3>  Etapa 1: M√°scara R-CNN y m√°scaras de construcci√≥n </h3><br>  M√°scara R-CNN (MRCNN) ha estado recientemente en la cima de la popularidad.  A partir del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> original de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Facebook</a> y terminando con el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Data Science Bowl 2018</a> en Kaggle, Mask R-CNN se ha establecido como una arquitectura poderosa, por ejemplo, la segmentaci√≥n (es decir, no solo la segmentaci√≥n de im√°genes p√≠xel por p√≠xel, sino tambi√©n la separaci√≥n de varios objetos que pertenecen a la misma clase )  Adem√°s, es un placer trabajar con la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">implementaci√≥n de MRCNN de Matterport</a> en Keras.  El c√≥digo est√° bien estructurado, tiene buena documentaci√≥n y funciona de inmediato, aunque m√°s lentamente de lo esperado. <br><br>  En la pr√°ctica, especialmente cuando se desarrolla un prototipo, es fundamental contar con una red neuronal convolucional preformada.  En la mayor√≠a de los casos, el conjunto de datos etiquetados del cient√≠fico de datos es muy limitado o nada en absoluto, mientras que ConvNet requiere una gran cantidad de datos etiquetados para lograr la convergencia (por ejemplo, el conjunto de datos ImageNet contiene 1,2 millones de im√°genes etiquetadas).  Aqu√≠ el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aprendizaje de transferencia</a> viene al rescate: podemos arreglar el peso de las capas convolucionales y volver a entrenar solo el clasificador.  La fijaci√≥n de capas convolucionales es importante para peque√±os conjuntos de datos, ya que esta t√©cnica evita el reentrenamiento. <br><br>  Esto es lo que obtuve despu√©s de la primera era de reciclaje: <br><br><img src="https://habrastorage.org/webt/ru/g-/cv/rug-cvztg2vpv85obstkuvhl7-4.png"><br>  <sub>Resultado de segmentaci√≥n de objetos: todos los ingredientes clave reconocidos</sub> <br><br>  En la siguiente etapa de la tuber√≠a ( <i>Procesar datos inferidos para el clasificador</i> ), es necesario recortar la parte de la imagen que contiene la placa y extraer la m√°scara binaria bidimensional para cada ingrediente en esta placa: <br><br><img src="https://habrastorage.org/webt/qg/62/5p/qg625pze9oobq1ttlp0ryp6beuk.png"><br>  <sub>Imagen recortada con ingredientes clave en forma de m√°scaras binarias.</sub> <br><br>  Estas m√°scaras binarias se combinan en una imagen de 8 canales (ya que defin√≠ 8 clases de m√°scara para MRCNN), y obtenemos la <i>Se√±al No. 1</i> : <br><br><img src="https://habrastorage.org/webt/l7/3w/8p/l73w8p1ztuu_udp5mmq7ro9knsk.png"><br>  <sub><i>Se√±al No. 1</i> : imagen de 8 canales que consiste en m√°scaras binarias.</sub>  <sub>En color para una mejor visualizaci√≥n.</sub> <br><br>  Para obtener la <i>Se√±al No. 2</i> , cont√© la cantidad de veces que se encuentra cada ingrediente en el cultivo de la placa y obtuve un conjunto de vectores de caracter√≠sticas, cada uno de los cuales corresponde a su cultivo. <br><br><h3>  Etapa 2: Clasificador ConvNet en Keras </h3><br>  El clasificador CNN se implement√≥ desde cero utilizando Keras.  Quer√≠a combinar varias se√±ales ( <i>Se√±al No. 1</i> y <i>Se√±al No. 2</i> , as√≠ como la posible adici√≥n de datos en el futuro) y dejar que las redes neuronales las usen para hacer pron√≥sticos sobre la calidad del plato.  La arquitectura presentada a continuaci√≥n es de prueba y est√° lejos de ser ideal: <br><br><img src="https://habrastorage.org/webt/zb/ow/y4/zbowy4ebvcigyosde3wv3ni-ziq.jpeg"><br><br>  Algunas palabras sobre la arquitectura del clasificador: <br><br><ul><li>  <b>M√≥dulo convolucional multiescala</b> : inicialmente eleg√≠ un filtro de 5x5 para capas convolucionales, pero esto solo condujo a un resultado satisfactorio.  Se lograron mejoras aplicando <i>AveragePooling2D</i> a varias capas con diferentes filtros: 3x3, 5x5, 7x7, 11x11.  Se agreg√≥ una capa convolucional adicional de 1x1 frente a cada una de las capas para reducir la dimensi√≥n.  Este componente es un poco como un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">m√≥dulo de inicio</a> , aunque no plane√© construir una red demasiado profunda. </li><li>  <b>Filtros m√°s grandes</b> : utilic√© filtros m√°s grandes, porque ayudan a extraer f√°cilmente signos m√°s grandes de la imagen de entrada (que en s√≠ misma es esencialmente una capa de activaci√≥n con 8 filtros; la m√°scara de cada ingrediente puede considerarse como un filtro separado). </li><li>  <b>Combinaci√≥n de se√±ales</b> : en mi ingenua implementaci√≥n, solo se us√≥ una capa que conectaba dos conjuntos de atributos: m√°scaras binarias procesadas ( <i>Se√±al No. 1</i> ) e ingredientes contados ( <i>Se√±al No. 2</i> ).  Sin embargo, a pesar de su simplicidad, la adici√≥n de la <i>Se√±al No. 2</i> hizo posible reducir la m√©trica de entrop√≠a cruzada de <i>0.8</i> a <i>[0.7, 0.72]</i> . </li><li>  <b>Logits</b> : en t√©rminos de TensorFlow, logit es una capa en la que se aplica <i>tf.nn.softmax_cross_entropy_with_logits</i> para calcular la <i>p√©rdida de lote</i> . </li></ul><br><h3>  Etapa 3: visualizaci√≥n de resultados usando t-SNE </h3><br>  Para visualizar los resultados del clasificador en los datos de prueba, utilic√© t-SNE, un algoritmo que le permite transferir los datos de origen a un espacio de menor dimensi√≥n (para comprender el principio del algoritmo, le recomiendo leer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el art√≠culo original</a> , es extremadamente informativo y est√° bien escrito). <br><br>  Antes de la visualizaci√≥n, tom√© im√°genes de prueba, extraje la capa de logite del clasificador y apliqu√© el algoritmo t-SNE a este conjunto de datos.  Aunque no he probado diferentes valores del par√°metro de perplejidad, el resultado sigue siendo bastante bueno: <br><br><img src="https://habrastorage.org/webt/er/yk/ic/erykictzlrzdvhchpvli86c8lwi.gif"><br>  <sub>El resultado de t-SNE en datos de prueba con predicciones de clasificador</sub> <br><br>  Por supuesto, este enfoque es imperfecto, pero funciona.  Puede haber bastantes mejoras posibles: <br><br><ul><li>  <b>M√°s datos</b>  Las redes de convoluci√≥n requieren muchos datos, y solo ten√≠a 139 im√°genes para entrenamiento.  T√©cnicas como el aumento de datos funcionan bien (utilic√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">D4 o aumento di√©drico sim√©trico</a> , resultando en m√°s de 2 mil im√°genes), pero tener m√°s datos reales sigue siendo extremadamente importante. </li><li>  <b>Funci√≥n de p√©rdida m√°s adecuada.</b>  Para simplificar, utilic√© la entrop√≠a cruzada categ√≥rica, lo cual es bueno porque funciona de inmediato.  La mejor opci√≥n ser√≠a utilizar la funci√≥n de p√©rdida, que tiene en cuenta la variaci√≥n dentro de las clases, por ejemplo, la funci√≥n de p√©rdida de triplete (consulte el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo de FaceNet</a> ). </li><li>  <b>Mejora de la arquitectura del clasificador.</b>  El clasificador actual es esencialmente un prototipo, cuyo √∫nico prop√≥sito es construir m√°scaras binarias y combinar varios conjuntos de caracter√≠sticas para formar una sola tuber√≠a. </li><li>  <b>Dise√±o de imagen mejorado.</b>  Fui muy descuidado al marcar im√°genes manualmente: el clasificador hizo este trabajo mejor que yo en una docena de im√°genes de prueba. </li></ul><br>  <b>Conclusi√≥n</b>  Finalmente, debe reconocerse que el negocio no tiene datos, ni explicaciones, ni siquiera una tarea m√°s clara que deba resolverse.  Y esto es bueno (de lo contrario, ¬øpor qu√© lo necesitan?), Porque su trabajo consiste en utilizar varias herramientas, procesadores multin√∫cleo, modelos previamente capacitados y una combinaci√≥n de experiencia t√©cnica y comercial para crear valor adicional en la empresa. <br><br>  Comience con algo peque√±o: se puede crear un prototipo funcional a partir de varios bloques de c√≥digo de juguetes, y aumentar√° significativamente la productividad de futuras conversaciones con la administraci√≥n de la empresa.  Este es el trabajo de un cient√≠fico de datos: ofrecer a los negocios nuevos enfoques e ideas. <br><br><hr><br>  El 20 de septiembre de 2018, comienza el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Especialista en Big Data 9.0"</a> , donde, entre otras cosas, aprender√° c√≥mo visualizar datos y comprender la l√≥gica empresarial detr√°s de esta o aquella tarea, lo que ayudar√° a presentar de manera m√°s efectiva los resultados de su trabajo a colegas y gerencia. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es412523/">https://habr.com/ru/post/es412523/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es412513/index.html">¬øC√≥mo convertirse en un gerente de producto sin experiencia?</a></li>
<li><a href="../es412515/index.html">DJI Ronin-S lanza ventas</a></li>
<li><a href="../es412517/index.html">AGPM: como Git para la directiva de grupo. Casi</a></li>
<li><a href="../es412519/index.html">Videoc√°mara HD inal√°mbrica sin bater√≠a</a></li>
<li><a href="../es412521/index.html">SOC is People: Cursos de reentrenamiento Jedi</a></li>
<li><a href="../es412527/index.html">Crowdfunding para astron√°utica en el ejemplo del proyecto de 435 nm</a></li>
<li><a href="../es412529/index.html">Donde pagar m√°s a los programadores. Compara 22 pa√≠ses</a></li>
<li><a href="../es412531/index.html">Battle Space Laser "Skiff"</a></li>
<li><a href="../es412533/index.html">Localizaci√≥n de datos personales de no rusos.</a></li>
<li><a href="../es412535/index.html">Entrevista con el "cerebro principal de Alicia"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>