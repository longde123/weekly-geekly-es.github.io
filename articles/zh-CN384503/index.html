<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎇 🙀 👖 基于FAC的魔方机器 🥗 ⁉️ 🌓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="不久前，我们与Wilbert Swinkels一起完成了一台收集魔方的机器。他们在Raspberry Pi官方博客上写了关于我们的信息，我们收到了很多好评。然而，在俄罗斯网络中，该项目以某种方式没有引起注意。因此，我决定通过在此处发布原始帖子的翻译版和增强版来纠正此遗漏。
 
 
 
 在削减之后，...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>基于FAC的魔方机器</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/384503/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不久前，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Wilbert Swinkels</font></a><font style="vertical-align: inherit;">一起</font><font style="vertical-align: inherit;">完成了一台收集魔方的机器。</font><font style="vertical-align: inherit;">他们</font><font style="vertical-align: inherit;">在Raspberry Pi官方博客上</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">写了</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于我们的</font><font style="vertical-align: inherit;">信息，我们收到了很多好评。</font><font style="vertical-align: inherit;">然而，在俄罗斯网络中，该项目以某种方式没有引起注意。</font><font style="vertical-align: inherit;">因此，我决定通过在此处发布</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">原始帖子</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的翻译版和增强版来纠正此遗漏</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://www.youtube.com/embed/vpAKfSYueMI%3Ffeature%3Doembed&amp;usg=ALkJrhh5mBTX-VAyJQO-t1jvpcLf1j9I5w" frameborder="0" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在削减之后，我们将主要讨论该机器的软件部分，而机械部分可以</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">项目</font><font style="vertical-align: inherit;">的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">官方页面上</font></a><font style="vertical-align: inherit;">找到</font><font style="vertical-align: inherit;">（是的，我们知道这有点“老派”了）</font></font><br>
<a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TL; DR</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于不耐烦的人，有几个链接：</font></font><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">官方项目页面</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kotsemba两阶段算法（Python和C）的实现</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">威尔伯特的其他作品</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">威尔伯特FAC网站</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FAC系统的官方网站</font></font></a></li>
</ul><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一切始于今年5月，我偶然遇到了Wilbert Swinkels。当我看到他的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作品</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时，我感到非常震惊</font><font style="vertical-align: inherit;">：从小到大，每种机制都可以安全地称为艺术品。而且，您越仔细看他们的设备，就越会被他们的美丽所吸引。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当然，当威尔伯特邀请我帮助他使用魔方组装机时，我毫不犹豫地动了一下，尤其是因为那时我已经</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发现</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了对彩色立方体的热情。那时，他已经在机器上工作了4（！）年以上，但是软件部分仍需编写。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我没有为Raspberry Pi和Arduino进行编程的经验，但是总的来说，这项任务对我来说似乎很简单。</font><font style="vertical-align: inherit;">当然，我错了:)</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">硬件</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
机器本身是使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模块化FAC系统构建的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这有点像苏联设计师，但其创建目的是为原型建立严肃而复杂的机制。</font><font style="vertical-align: inherit;">在上世纪下半叶，它在飞利浦以及其他公司和大学的实验室中得到了非常积极的使用。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当我遇到威尔伯特时，他已经尝试过两次“复兴”汽车。</font><font style="vertical-align: inherit;">两次，阿姆斯特丹大学的学生都处理了这个案件，不幸的是，两次尝试都失败了，这两次他们都对该项目失去了兴趣。</font><font style="vertical-align: inherit;">尽管其中一个结果是机器无法收集立方体（将您的手举到此处认识自己的人），但其中一位甚至为该主题的学士学位辩护。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">微控制器</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先，我们决定使用Raspberry Pi代替Arduino。</font><font style="vertical-align: inherit;">这主要是由于用于解决Rubik's Cube的“智能”算法需要大量的内存和处理器功能。</font><font style="vertical-align: inherit;">在先前的尝试中，使用了原始</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的三层算法</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但是这次我们决定使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kotsemba算法</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">另外，我并不是真的想用C编写所有内容（尽管部分必须这样做）。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/53b/142/5d4/53b1425d42fca6feb8f98819c3f4ff39.jpg" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在Raspberry Pi的标准版本中，我们没有足够的引脚来连接所有可用的电机，因此我们订购了</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开发套件</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">顺便说一句，我强烈建议：不仅更多的引脚，而且在我看来，它们之间的逻辑距离更大。</font><font style="vertical-align: inherit;">此外，该板有两个用于相机的连接器，而不是一个。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">扫描仪的第一个版本</font></font></h3><br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/465/d0e/05d/465d0e05d87cd5c11a732f3d448ac6b4.jpg" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要读取多维数据集的初始配置，需要使用扫描设备。这个想法很简单：我们依次用三个LED照明立方体的表面：红色，绿色和蓝色。每次我们使用光敏电阻测量反射光。从理论上讲，我们应该获得可用于识别正方形颜色的RGB值。从以前的程序员那里，我们仍然有Arduino的概念验证代码，看起来甚至可以在某些条件下使用。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们遇到的第一个问题是电压不匹配。如您所知，Arduino引脚上的逻辑单元为5V，而Raspberry Pi为3.3V。幸运的是，尽管更改了脉冲幅度，但我们使用的步进电机驱动器控制器仍继续工作。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
事实证明，Raspberry Pi没有模拟输入更为重要。因此，Raspberry无法简单地获取并读取光敏电阻上的电压。这对于至少一次遇到此问题的人来说可能是显而易见的，但是起初我什至没有考虑过。在网上寻找解决方案时，我们偶然发现了</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这篇文章</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">简而言之，我们在电路中添加一个电容器，并测量其从零充电到逻辑单元的时间（我们可以使用数字引脚进行检测）。</font><font style="vertical-align: inherit;">充电时间将与光敏电阻的电阻成正比，因此我们可以判断光量。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/40a/8d9/d2b/40a8d9d2b30365e9e4fd4c3cf3615798.jpg" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这种方法不仅非常不可靠（在带有大量后台进程的Linux上的Python Python脚本中花费时间是一件令人不快的事情），而且它也不会长久。</font><font style="vertical-align: inherit;">为了消除读数中的随机偏差，我们必须阅读几次，排除</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">异常值</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后对剩余值取平均值。</font><font style="vertical-align: inherit;">但是，我们仍然设法使该扫描仪正常工作：</font></font><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://www.youtube.com/embed/z4iJ0hNQulo%3Ffeature%3Doembed&amp;usg=ALkJrhiGBPmO2PDLvVsjfXfnD5Nv5jUINQ" frameborder="0" allowfullscreen=""></iframe><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">扫描仪的第二个（最终）版本</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
电容扫描仪工作得很好，但是非常慢。扫描整个Rubik's Cube大约花了两分钟，到扫描完成时，观众已经失去了所有兴趣。因此，我们决定返回Arduino，并购买了一个专门用于控制扫描仪的小型Arduino Mini。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/21a/9e5/775/21a9e5775f5e15affb6792ae5f67b984.jpg" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
事实证明，使用Raspberry Pi与Arduino成为朋友非常简单：两条线，</font><font style="vertical-align: inherit;">它们之间</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的电压转换器</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和voila-我们有一个串行接口。而且，如果您将最简单的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Min</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">协议放在首位</font><font style="vertical-align: inherit;">，那么对该业务进行编程是一种乐趣。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我将所有扫描仪控制逻辑转移到了Arduino。</font><font style="vertical-align: inherit;">扫描速度大大提高。</font><font style="vertical-align: inherit;">得益于模拟输入，我们可以直接从光敏电阻读取电压，这些值非常准确。</font><font style="vertical-align: inherit;">另外，由于Arduino直接安装在扫描仪上，因此从扫描仪到Raspberry Pi的接线要少得多！</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成算法</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从数学的角度组装魔方是一项相当</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">艰巨的任务</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。当然，我们在谈论寻找最佳解决方案，而不是“一些”。当我发现神的数目（解决任意立方体所需的移动数的确切下限）</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅在2010年</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发现时，我感到惊讶</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这个项目中，我们希望减少计算解决方案和组装所需的总时间，因此既没有一种简单</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的三层算法</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（可以快速运行，但可以使解决方案长出一百步），也没有一种</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最佳算法</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（解决方案很短，但是在Raspberry上进行渲染的过程） Pi会永远拿走）。结果，我们选择了宏伟的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“两阶段”算法</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">德国数学家Herbert Kociemba。他能够做出次优的决定（平均20步），同时保持在合理的时间内。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在作者的网站上，您可以找到Java算法的实现。我要做的第一件事就是将这段代码翻译成Python。这一点都不困难，因为大多数程序都是数学运算和选项枚举。但是，我没有考虑到该算法</font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确实</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">需要</font><i><b><font style="vertical-align: inherit;">大量</font></b></i><font style="vertical-align: inherit;">资源。在我的笔记本电脑上，在首次启动时找到解决方案花费了超过一分钟（！）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pypy下</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在启用JIT的情况下，该解决方案在笔记本电脑上花费了1秒钟，但是在Raspberry Pi上仍然花费了大约一分钟。</font><font style="vertical-align: inherit;">经过几次尝试以加快Python程序的工作速度（numpy，多处理），我决定将算法重写为C。尽管如此，该解决方案现在需要1-2秒，甚至是Raspberry。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub上</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发布了算法的两种实现</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">机器控制</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
下一步是编写一个程序来控制机械部分：考虑齿轮比和机构限制来移动电动机（例如，仅当底部处于某个位置时才可以旋转侧支架，否则会产生干扰）。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/b89/c9b/3e0/b89c9b3e0780fae3e7dd5b28a8aa209d.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
除了主程序外，我还制作了一个交互式外壳程序，在调试时为我节省了很多时间。</font><font style="vertical-align: inherit;">通常，这部分在编程方面并不罕见。</font><font style="vertical-align: inherit;">为了调试扫描，我将结果生成为图片。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">扫描和色彩识别</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
到目前为止，一切都很有趣，但并不困难。</font><font style="vertical-align: inherit;">工作开始两周后，机器已经可以从给定状态收集多维数据集。</font><font style="vertical-align: inherit;">剩下的只是学习如何使用扫描仪读取多维数据集的初始配置。</font><font style="vertical-align: inherit;">我们已经有一个针对Arduino的“有效”程序，因此我们并不感到意外。</font><font style="vertical-align: inherit;">但是，该项目的这一部分最困难，又花了我们两个月的时间。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">光敏电阻指示</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
就像我在上面写的，我们从带电容器的扫描器电路开始。这种方法的错误非常可怕，因此要获得可用的值，我必须进行几次测量，然后再消除排放。之后，我们得到了类似的结果（这是在黑暗的房间中扫描组装好的立方体的结果）：</font></font><br>
<br>
<img src="https://habrastorage.org/files/d0d/0eb/467/d0d0eb4676f54a8c9319882658278664.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如您所见，结果远非理想。首先，同一颜色的值在不同位置不同，因为光敏电阻和LED沿不同的方向``看''。其次，某些颜色在颜色空间中彼此非常接近，有时值的范围重叠（例如，橙色和红色有时给出相同的值）。最后，读数非常依赖于外部照明。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
从视觉上看，电容器扫描仪的误差可以在下图中看到（一般来说，这里有</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个交互式版本</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）：</font></font><br>
<br>
<img src="https://habrastorage.org/files/8a6/489/4fd/8a64894fd9a249a1a297ac2743930120.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
回头看，我想知道我们如何设法使扫描得到这样的结果，尽管这需要仔细，棘手地校准有问题的值会降低一点。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正如我所说，电容器扫描仪可以工作，但是速度很慢。</font><font style="vertical-align: inherit;">当我们用内置的Arduino将它替换为另一个时，读数变得更加“拥挤”（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">交互式版本在此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）：</font></font><br>
<br>
<img src="https://habrastorage.org/files/c6e/0a8/8b5/c6e0a88b595747aa87ef2c35bdf634fe.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">读数的校准和聚类</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在我们有了来自光敏电阻的原始RGB读数，我们必须自己识别颜色，以便将立方体配置输入到构建算法中。此处立即提出了两种不同的方法：颜色间隔的使用和聚类算法。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第一种方法是``正面''解决方案：可以通过实验确定立方体每一侧的值的间隔（实际上是将颜色空间划分为不相交的区域），然后根据属于某个间隔的值简单地组合这些值。在这种情况下，应分别考虑立方体边缘上9个可能的位置中的每个位置。这种方法很容易编程，但是有两个明显的缺点。首先，它将我们绑定到特定的颜色，这意味着我们只能收集严格定义的魔方。其次，可能值的间隔在很大程度上取决于外部照明。此外，我们发现，取决于环境光，相同的读数可能对应于不同的颜色。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第二种方法需要对值进行初步校准，以使相同的颜色在立方体边缘的所有9个位置给出相同的结果。</font><font style="vertical-align: inherit;">在这种情况下，我们可以使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">聚类算法</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将值组合成6组。</font><font style="vertical-align: inherit;">同时，只要是不同的颜色，立方体所用的颜色就无关紧要。</font><font style="vertical-align: inherit;">不幸的是，由于聚类算法的概率性质，该方法也必须被“拒绝”：它们可以产生“良好”的结果，但不能保证其准确性。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
两种方法各有利弊，因此我们在两者之间使用了一些方法：</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先，我们对扫描仪读数进行人为校准，以将值归一化。</font><font style="vertical-align: inherit;">系数是通过实验获得的。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将生成的RGB值转换为HSV</font></font></li>
<li>   ,    S ()</li>
<li>     </li>
<li>    ,     .</li>
</ol><br>
<br>
<h3>   </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
即使使用了良好的聚类算法，由于环境条件，扫描通常也会失败。</font><font style="vertical-align: inherit;">在黑暗的房间中校准的算法无法在白天条件下完成任务，反之亦然。</font><font style="vertical-align: inherit;">此外，如果外部照明非常明亮（直射阳光），则扫描仪通常会停止工作，因为LED的影响几乎不明显。</font><font style="vertical-align: inherit;">威尔伯特做了非常艰苦的工作，将扫描仪与环境光隔离开。</font><font style="vertical-align: inherit;">我必须经历3次迭代：每次我们认为就足够了，并且每次我们都发现另一个缺口，外部照明通过该缺口落在光敏电阻上。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/d4c/a1e/795/d4ca1e795ba1c28d27a3fa8ebbc8c5cb.jpg" alt="图片"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结论</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这个项目的工作非常令人兴奋。看着汽车栩栩如生，真是太好了，看到汽车如何运转，证明自己的一切努力特别酷。但是，这不能与我们在此过程中设法获得的知识存储相提并论。我无法想象，我将不得不学习大量有关电子学，力学，代数甚至是数学统计的材料，并一路走来找到十二个有用的实用程序和库。这就是为什么我很高兴有机会从事这个项目的原因。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/238/e22/a67/238e22a6758025d7fbda1f52441b75a2.jpg" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
尽管如此，这辆车只是一个原型。</font><font style="vertical-align: inherit;">我们没有设定打破速度记录的目标，当然我们也没有意识到机械零件的全部潜力。</font><font style="vertical-align: inherit;">但是我们一定会在已经开始工作的机器的下一版本中尝试这样做。</font><font style="vertical-align: inherit;">在那里，我们将使用相机进行扫描，并且操纵器的设计已经发生了重大变化。</font><font style="vertical-align: inherit;">当然，如果您有任何疑问，建议或技巧，我会很高兴在评论中听到他们的声音。</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN384503/">https://habr.com/ru/post/zh-CN384503/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN384489/index.html">韩国制造商推出的新型最快固态硬盘-三星950 Pro</a></li>
<li><a href="../zh-CN384491/index.html">机器人比人类更好地停车</a></li>
<li><a href="../zh-CN384493/index.html">Qlocktwo型电子手表</a></li>
<li><a href="../zh-CN384499/index.html">Acer Revo One：具有多种功能的微型计算机</a></li>
<li><a href="../zh-CN384501/index.html">口袋里的声音达500 000r：Astell和Kern AK380 + Astell和Kern Layla</a></li>
<li><a href="../zh-CN384505/index.html">采用骨传导技术的耳机：它们是什么，为什么需要它们以及在哪里购买</a></li>
<li><a href="../zh-CN384507/index.html">Простой дата-центра Amazon повлек за собой сбой в работе Netflix, Heroku и других сервисов</a></li>
<li><a href="../zh-CN384509/index.html">NVIDIA将安装其顶级GeForce GTX 980板载笔记本电脑视频卡</a></li>
<li><a href="../zh-CN384511/index.html">开始耙-我们如何打开操场</a></li>
<li><a href="../zh-CN384513/index.html">移动式太阳能加油站EV ARC-现实与前景</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>