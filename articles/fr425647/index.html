<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè© üëü üê∂ Test de l'interface utilisateur: v√©rification du syst√®me √† diff√©rentes r√©solutions üîú üë®üèΩ‚Äçüé® üö£üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tester de longs formulaires Web dans divers navigateurs et dans des r√©solutions est non seulement extr√™mement n√©cessaire, mais aussi pour la troisi√®me...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Test de l'interface utilisateur: v√©rification du syst√®me √† diff√©rentes r√©solutions</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/true_engineering/blog/425647/">  Tester de longs formulaires Web dans divers navigateurs et dans des r√©solutions est non seulement extr√™mement n√©cessaire, mais aussi pour la troisi√®me ou la quatri√®me fois - un processus extr√™mement ennuyeux et tr√®s concentr√©.  C'est donc exactement le domaine qui demande lui-m√™me l'automatisation.  C'est ce que nous avons fait. <br><br>  Dans cet article sur Habr, nous parlerons de notre exp√©rience dans le test de grands √©crans avec des outils de grille Protractor, Zalenium et Selenium.  Comment nous avons progressivement introduit ces outils pour les tests automatiques de l'interface utilisateur et quelles difficult√©s nous avons d√ª traverser. <br><br><img src="https://habrastorage.org/webt/t0/ik/pi/t0ikpibqtt5stc-vmd8mm5ap7p0.jpeg"><br><a name="habracut"></a><br>  Nous cr√©ons et maintenons un syst√®me dans lequel 7 mille utilisateurs actifs.  Le plus souvent, ils utilisent ces navigateurs: <br><br><img src="https://habrastorage.org/webt/du/8h/qg/du8hqgm1ywysjlq_jnwovnu636m.png"><br><br>  Et les r√©solutions d'√©cran suivantes: <br><br><img src="https://habrastorage.org/webt/yh/qo/65/yhqo65fklkp6alt-rooirdebj0c.png"><br><br>  Chaque fois apr√®s la sortie d'une nouvelle version, vous devez v√©rifier les performances de ces navigateurs et autorisations. <br><br>  Pour mieux comprendre le fonctionnement habituel des tests d'interface utilisateur dans notre cas, consid√©rons un cas simple: tester la fonctionnalit√© d'une application pour la r√©cup√©ration de mot de passe.  En cons√©quence, il y a deux pages.  Sur l'un, vous devez sp√©cifier un nom d'utilisateur ou un e-mail o√π une lettre viendra avec un lien vers un changement de mot de passe.  Apr√®s l'envoi de la demande, l'utilisateur acc√®de √† la page avec confirmation que tout s'est bien pass√©. <br><br><img src="https://habrastorage.org/webt/ji/p2/1o/jip21ov8vewbempmrtgogko3lx4.png"><br>  <i>Formulaire de r√©cup√©ration de mot de passe</i> <br><br><img src="https://habrastorage.org/webt/1d/ce/-e/1dce-e0_bdinsyr_hlwidjceo6k.png"><br>  <i>La page vers laquelle la redirection se produit apr√®s la soumission r√©ussie de la demande</i> <br><br>  Le test de ce m√©canisme sous une forme simplifi√©e ressemble √† ceci: <br><br><img src="https://habrastorage.org/webt/io/yh/zn/ioyhzno2ibl6ijdwxszbszy0qrk.png"><br><br>  Le m√™me script que le code: <br><br><pre><code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">'    '</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>): </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Promise</span></span></span><span class="hljs-function">&lt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">boolean</span></span></span><span class="hljs-function"> | </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> browser.get(browser.baseUrl); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> element(by.name(<span class="hljs-string"><span class="hljs-string">'EmailOrLogin'</span></span>)).sendKeys(userLogin); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> element(by.buttonText(<span class="hljs-string"><span class="hljs-string">''</span></span>)).click(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> screenshot = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> browser.takeScreenshot(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> canonicalScreenshotPath = <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"></span></span></span></span><span class="xml"><span class="hljs-tag">   &gt;</span></span></span><span class="xml">; await compareScreenshot(screenshot, canonicalScreenshotPath); });</span></span></code> </pre> <br>  Comme vous pouvez le voir, le code de test semble assez simple, il r√©p√®te litt√©ralement ce qui √©tait montr√© sur le diagramme. <br><br>  Nous montrons maintenant quels outils ont √©t√© utiles pour impl√©menter ce sch√©ma √† diff√©rentes r√©solutions d'√©cran, et quelles difficult√©s nous avons rencontr√©es. <br><br><h2>  Bo√Æte √† outils s√©lectionn√©e </h2><br><h3>  Commenc√© avec le chrome </h3><br>  Pour l'automatisation des tests, nous avons choisi Protractor, un framework e2e pour tester les applications angulaires.  Notre application est juste sur Angular.  Avec Protractor, nous avons fait deux types de tests: <br><br><ol><li>  Sur la fonctionnalit√© g√©n√©rale: Un formulaire de soumission de candidature est ouvert, rempli avec des donn√©es et une candidature est envoy√©e, apr√®s quoi nous v√©rifions qu'une redirection vers le registre de toutes les candidatures s'est produite. </li><li>  Tests de capture d'√©cran: Protractor vous permet de prendre une capture d'√©cran √† tout moment.  En utilisant une biblioth√®que s√©par√©e de r√©colte bleue, nous avons compar√© deux captures d'√©cran: une r√©f√©rence et une vraie.  S'ils ne correspondent pas, une capture d'√©cran est imm√©diatement cr√©√©e sur laquelle toutes les diff√©rences sont visibles, tout comme dans Git. </li></ol><br>  Par exemple, si vous continuez d'analyser l'exemple d√©crit ci-dessus. <br><br><img src="https://habrastorage.org/webt/-k/op/c_/-kopc_riwo8xa6qsajn_ld-ynrk.png"><br>  <i>Capture d'√©cran avec un message de lien non valide</i> <br><br><img src="https://habrastorage.org/webt/gb/lp/uh/gblpuhvntxizhca6g1i0dk5ciqs.png"><br>  <i>Les diff√©rences (texte et disposition du bouton) dans les captures d'√©cran de r√©f√©rence et actuelles sont mises en √©vidence en lilas</i> <br><br>  Si la page contient des donn√©es √† changement dynamique (par exemple, la date ou le num√©ro de commande), vous devez les masquer - cette fonctionnalit√© se trouve dans la biblioth√®que de r√©colte bleue.  Sinon, la comparaison des captures d'√©cran donnera un r√©sultat n√©gatif. <br><br><h3>  Ajouter FF et diff√©rentes autorisations </h3><br>  Au fil du temps, nos exigences pour le syst√®me de test d'interface utilisateur existant ont augment√©: <br><br><ul><li>  ex√©cuter des tests non seulement dans Chrome, mais aussi dans FF, </li><li>  effectuer des tests de capture d'√©cran non pas sur une r√©solution, mais sur les plus populaires, </li><li>  ex√©cuter des tests en parall√®le. </li></ul><br>  Faisons donc ex√©cuter nos tests en parall√®le dans Chrome et FF. <br><br>  Pour ce faire, dans la configuration des capacit√©s de Protractor'a, remplacez-la par ceci: <br><br><pre> <code class="hljs powershell">multiCapabilities: [ { <span class="hljs-type"><span class="hljs-type">shardTestFiles</span></span>: <span class="hljs-type"><span class="hljs-type">true</span></span>, <span class="hljs-type"><span class="hljs-type">maxInstances</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-type"><span class="hljs-type">browserName</span></span>: <span class="hljs-string"><span class="hljs-string">'chrome'</span></span> }, { <span class="hljs-type"><span class="hljs-type">shardTestFiles</span></span>: <span class="hljs-type"><span class="hljs-type">true</span></span>, <span class="hljs-type"><span class="hljs-type">maxInstances</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-type"><span class="hljs-type">browserName</span></span>: <span class="hljs-string"><span class="hljs-string">'firefox'</span></span> } ]</code> </pre> <br>  Tout est √©vident ici, dont chaque cadre est responsable.  Ne m√©rite que l'attention <br> <code>shardTestFiles: true</code> <br> <code>/** * If this is set to be true, specs will be shared by file (ie all files to be run by this set of capabilities will run in parallel). * Default is false. */</code> <br> <br>  Avec cet indicateur, nous fournissons le lancement parall√®le de toutes les sp√©cifications dans tous les navigateurs qui sont sp√©cifi√©s dans multiCapabilities. <br><br>  Le param√®tre specs est cach√© sous le mot specs, qui d√©termine par quel mod√®le rechercher des fichiers avec des tests. <br><br><pre> <code class="javascript hljs">exports.config = { ... specs: [<span class="hljs-string"><span class="hljs-string">'./e2e/**/*.spec.ts'</span></span>], ... }</code> </pre> <br>  La th√©orie de la division de tous les tests en plusieurs fichiers de sp√©cifications semble assez logique.  la concurrence fonctionne sur eux (par exemple, cr√©ez un fichier de sp√©cifications pour chaque fonctionnalit√© de l'application). <br><br>  De plus, dans Protractor'e, il est possible de mettre en valeur les suites. <br><br><pre> <code class="javascript hljs">exports.config = { ... suites: { <span class="hljs-attr"><span class="hljs-attr">suite01</span></span>: <span class="hljs-string"><span class="hljs-string">'./e2e/**/suite01.*.spec.ts'</span></span>, <span class="hljs-attr"><span class="hljs-attr">suite02</span></span>: <span class="hljs-string"><span class="hljs-string">'./e2e/**/suite02.spec.ts'</span></span>, <span class="hljs-attr"><span class="hljs-attr">suite03</span></span>: <span class="hljs-string"><span class="hljs-string">'./e2e/**/suite03.spec.ts'</span></span> }, ... }</code> </pre> <br>  Comme vous pouvez le voir dans cette partie de la configuration, lors du d√©marrage d'une suite, les tests sont ex√©cut√©s √† partir d'un seul fichier de sp√©cification.  Ceci est probablement utile si vous souhaitez ex√©cuter des tests pour une seule partie de l'application. <br><br>  En ce qui concerne le test de l'application √† diff√©rentes r√©solutions, nous avons suivi le chemin suivant.  En tant qu'autorisations exp√©rimentales, l'une des plus populaires a √©t√© s√©lectionn√©e: 1920x1080, 1366x768, 1440x10900, 768x1024.  Lorsque vous ex√©cutez chaque test, toutes les actions n√©cessaires ont √©t√© initialement effectu√©es, puis une s√©rie de v√©rifications de capture d'√©cran est effectu√©e. <br><br><img src="https://habrastorage.org/webt/ht/fe/w4/htfew43t0zeewg0cg-odih_s_yq.png"><br><br><h3>  Nous connectons IE et des captures d'√©cran en taille r√©elle </h3><br>  Les tests de capture d'√©cran que nous avons obtenus, malheureusement, n'ont fonctionn√© que sur la base de la partie initialement visible de la page.  Et si le d√©filement √©tait pr√©sent sur la page, alors tout ce qui √©tait ci-dessous restait inexplor√© pour la mise en page. <br><br>  En plus de cela, nous devons √©galement prendre en charge IE, pour lequel nos tests n'ont pas encore √©t√© con√ßus.  Nous avons commenc√© √† chercher une opportunit√© ad√©quate pour ex√©cuter des tests dans IE et prendre des captures d'√©cran en taille r√©elle. <br><br><img src="https://habrastorage.org/webt/v7/ul/le/v7ulle2bbjnxzfyqc5vv_ps7due.png"><br><br>  Nous avons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">opt√©</a> pour deux solutions: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Zalenium</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Selenium-Grid</a> .  Nous omettons la description de ce que l'un d'eux se vante de quoi et racontons ce qu'il a trouv√© / n'a pas trouv√© dans l'une ou l'autre solution. <br><br>  <b>Zalenium</b> : cette solution s'ex√©cute dans un conteneur Docker et N autres conteneurs montent apr√®s le conteneur principal - pour lancer les navigateurs.  Vous permet de sp√©cifier screenWidth, screenHeight pendant l' <code>docker run</code> menu fixe et d'obtenir la taille de l'√©cran, par exemple, 1920x6000.  Il n'y a pas de support pour IE. <br><br><img src="https://habrastorage.org/webt/kz/wr/de/kzwrdeodk_9rbejq0srhhk5d3zq.png"><br>  <i>Deux navigateurs avec une taille d'√©cran de 1920x6000</i> <br><br>  <b>Grille de s√©l√©nium: les</b> tests dans IE ont commenc√© tr√®s facilement. <br>  Parmi les inconv√©nients: il n'y a aucun moyen de d√©finir la taille de la fen√™tre du navigateur de n'importe quelle taille. <br><br>  <b>Total: grille Zal√©nium + S√©l√©nium</b> <br>  Nous nous sommes install√©s sur un tas de grille Zalenium + Selenium: via Zalenium, il a √©t√© d√©cid√© d'ex√©cuter des tests dans Chrome et FF, et via Selenium-grid pour v√©rifier les performances minimales de l'application dans IE. <br><br><h2>  Ce qui √©tait int√©ressant √† rencontrer dans le processus </h2><br>  <b>1. Utilisation de formControlName comme localisateur d'√©l√©ment</b> <br><br>  En utilisant la recherche sur formControlName, vous pouvez facilement rechercher les champs requis sur le formulaire et les remplir avec des donn√©es de test.  Le localisateur de formControlName n'est pas int√©gr√©, mais il est facile d'ajouter: <br><br><pre> <code class="javascript hljs">exports.config = { ... onPrepare() { <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'ts-node'</span></span>).register({ <span class="hljs-attr"><span class="hljs-attr">project</span></span>: <span class="hljs-string"><span class="hljs-string">'e2e/tsconfig.e2e.json'</span></span> }); jasmine.getEnv().addReporter(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> specReporter({ <span class="hljs-attr"><span class="hljs-attr">spec</span></span>: { <span class="hljs-attr"><span class="hljs-attr">displayStacktrace</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } })); addFormControlNameLocator(protractor); } ... } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addFormControlNameLocator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">protractor</span></span></span><span class="hljs-function">) </span></span>{ protractor.by.addLocator(<span class="hljs-string"><span class="hljs-string">'formControlName'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value, optParentElement</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> using = optParentElement || <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> using.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'[formControlName="'</span></span> + value + <span class="hljs-string"><span class="hljs-string">'"]'</span></span>); }); }</code> </pre> <br>  <b>2. La diff√©rence dans le travail du webdriver-manager install√© globalement et localement dans Protractor</b> <br><br>  Lors de l'installation de Protractor dans le syst√®me (la documentation officielle conseille d'installer Protractor √† l'√©chelle mondiale), en plus du cadre de test lui-m√™me, nous obtenons le gestionnaire de pilotes Web install√©, qui fournit des pilotes aux navigateurs pour ex√©cuter des tests, avec lesquels l'un des probl√®mes a √©t√© d√©tect√©. <br><br>  Apr√®s avoir acc√©d√© au dossier du projet et ex√©cut√© la mise √† jour du gestionnaire de pilotes Web, les pilotes pour Chrome, FF, IE sont t√©l√©charg√©s.  Apr√®s cela, lors du d√©marrage des tests, ils ont d√©tect√© l'erreur: <br><br> <code>No update-config.json found. Run 'webdriver-manager update' to download binaries.</code> <br> <br>  Nous avons r√©alis√© que l'erreur dispara√Æt si nous emballons la mise √† jour du gestionnaire de pilotes Web dans un script npm: <br><br><pre> <code class="hljs powershell">{ ... scripts:{ ‚Äúwebdriver<span class="hljs-literal"><span class="hljs-literal">-update</span></span>‚Äù: ‚Äúwebdriver<span class="hljs-literal"><span class="hljs-literal">-manager</span></span> update‚Äù } ... }</code> </pre> <br>  et ex√©cutez via <code>npm run webdriver-update</code> , les sources du pilote et le fichier update-config.json mentionn√© ci-dessus entrent dans le dossier du projet. <br><br>  <b>3. Ex√©cuter Zalenium via docker-compose</b> <br><br>  La documentation de Zalenium est accompagn√©e d'exemples de la commande <code>docker run</code> et du fichier docker-compose.  Tout d√©colle presque comme par magie.  Le seul probl√®me que nous avons rencontr√© s'est produit lors du d√©marrage du fichier docker-compose <br>  <code>/var/run/docker.sock is not a valid windows path</code> .  La solution est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">l√†</a> . <br><br>  <b>4. Visibilit√© des √©l√©ments par le rapporteur</b> <br><br>  Au cours de nos exp√©riences, √† un moment, nous avons √©t√© confront√©s √† la t√¢che de percer un menu sur la page, c'est-√†-dire  allez √† chaque page du menu et faites une capture d'√©cran. <br><br><img src="https://habrastorage.org/webt/6u/sy/ol/6usyoljearsoj0ok6kgburgd_7e.png"><br><br>  Apr√®s avoir trait√© le premier √©l√©ment de la liste, les tests ont commenc√© √† tomber, lan√ßant une erreur selon laquelle il n'y avait rien √† cliquer sur certaines coordonn√©es.  Il s‚Äôest av√©r√© que, malgr√© le fait que tous les √©l√©ments de la liste aient √©t√© initialement s√©lectionn√©s, apr√®s qu‚Äôils soient devenus vraiment invisibles √† nos yeux, ils ont disparu aux yeux de Protractor. <br><br>  Nous avons r√©solu le probl√®me en d√©finissant une largeur d'√©cran suffisante pour que le menu r√©apparaisse avant de cliquer sur son √©l√©ment suivant. <br><br>  <b>5. Changement de r√©solution dans IE (grille de s√©l√©nium)</b> <br><br>  Comme vous vous en souvenez, dans Chrome et FF, nous avons affin√© le changement de r√©solution d'√©cran.  Lorsqu'il s'agit de cela dans IE, nous avons simplement d√©tect√© l'erreur: <code>Failed: java.io.IOException: Server returned HTTP response code: 405 for URL: http://localhost:21800/session/8d14426d-6483-4bbf-90b3-2a3ed46ebe9b/window/size</code> . <br><br>  Apr√®s un long d√©bogage, il a √©t√© possible de d√©couvrir que l'erreur vole exactement au moment o√π le code tente d'ex√©cuter: <code>browser.driver.manage().window().setSize(x, y)</code> .  Si vous essayez d'ex√©cuter <code>browser.driver.manage().window().setPosition(x, y)</code> , puis d√©tectez la m√™me erreur, seule la taille changera en position.  Cela nous am√®ne au fait qu'il est impossible de contr√¥ler la r√©solution d'√©cran lorsque les tests sont ex√©cut√©s dans IE.  La solution au probl√®me est des b√©quilles avec lesquelles vous devez superposer votre code afin de ne pas changer la r√©solution \ position lorsque IE est en cours d'ex√©cution. <br><br>  <b>6. Zalenium et WebSocket</b> <br><br>  Apr√®s avoir collect√© toutes les bosses localement, il a √©t√© d√©cid√© d'int√©grer Zalenium dans l'infrastructure de l'entreprise.  Le conteneur est ouvert, DNS est enregistr√©, maintenant tout le monde peut ex√©cuter des tests dans Zalenium, simplement en sp√©cifiant le chemin d'acc√®s dans sa configuration Protractor.  La beaut√©, hein?  Mais √ßa y √©tait. <br><br>  Dans ce cas, tout √©tait d√©j√† d√©ploy√© sur la machine Linux, Nginx √©tait utilis√© comme serveur.  Le conteneur avec Zalenium est mont√© sans probl√®me, suivi par un autre N conteneurs pour lancer les navigateurs, mais ... n'a pas pu √©tablir de connexion avec eux.  Il √©tait facile de constater que le conteneur parent tentait de communiquer avec les conteneurs des navigateurs via le protocole WebSocket, et Nginx ne pouvait pas le faire par d√©faut.  Le traitement est tr√®s simple. <br><br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">location</span></span> / { <span class="hljs-attribute"><span class="hljs-attribute">proxy_pass</span></span> some_url; <span class="hljs-attribute"><span class="hljs-attribute">proxy_set_header</span></span> Upgrade <span class="hljs-variable"><span class="hljs-variable">$http_upgrade</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_set_header</span></span> Connection ‚Äúupgrade‚Äù; }</code> </pre> <br>  <b>9. Lancement de Selenium-Grid</b> <br><br>  Pour ex√©cuter Selenium-Grid, nous avons besoin de: <br><br><ul><li>  <a href="">serveur s√©l√©nium</a> , </li><li>  Pilote IE, qui est facile √† obtenir via la mise √† jour du gestionnaire de pilotes Web --ie32. </li></ul><br>  lancement du serveur: <br><br> <code>java -jar selenium-server-standalone.jar -role hub -hubConfig selenium-server-config.json</code> <br> <br><pre> <code class="hljs pgsql">selenium-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>-config.json { "host": "127.0.0.1", "maxSessions": <span class="hljs-number"><span class="hljs-number">5</span></span>, "port": <span class="hljs-number"><span class="hljs-number">4445</span></span>, "cleanupCycle": <span class="hljs-number"><span class="hljs-number">5000</span></span>, "timeout": <span class="hljs-number"><span class="hljs-number">300000</span></span>, "newSessionWaitTimeout": <span class="hljs-number"><span class="hljs-number">-1</span></span>, "servlets": [], "prioritizer": <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, "capabilityMatcher": "org.openqa.grid.internal.utils.DefaultCapabilityMatcher", "throwOnCapabilityNotPresent": <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, "nodePolling": <span class="hljs-number"><span class="hljs-number">180000</span></span>, "platform": "WINDOWS" }</code> </pre> <br>  lancement du pilote IE: <br><br> <code>java -Dwebdriver.ie.driver=&lt;  &gt; -jar selenium-server-standalone.jar -role node -nodeConfig .\\ie-driver-config.json</code> <br> <br><pre> <code class="hljs powershell">ie<span class="hljs-literal"><span class="hljs-literal">-driver</span></span><span class="hljs-literal"><span class="hljs-literal">-config</span></span>.json { <span class="hljs-string"><span class="hljs-string">"capabilities"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"browserName"</span></span>: <span class="hljs-string"><span class="hljs-string">"internet explorer"</span></span>, <span class="hljs-string"><span class="hljs-string">"maxInstances"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"platform"</span></span>: <span class="hljs-string"><span class="hljs-string">"WINDOWS"</span></span>, <span class="hljs-string"><span class="hljs-string">"webdriver.ie.driver"</span></span>: <span class="hljs-string"><span class="hljs-string">"C:/Program Files (x86)/Internet Explorer/iexplore.exe"</span></span> } ], <span class="hljs-string"><span class="hljs-string">"cleanUpCycle"</span></span>: <span class="hljs-number"><span class="hljs-number">2000</span></span>, <span class="hljs-string"><span class="hljs-string">"timeout"</span></span>: <span class="hljs-number"><span class="hljs-number">30000</span></span>, <span class="hljs-string"><span class="hljs-string">"port"</span></span>: <span class="hljs-literal"><span class="hljs-literal">-1</span></span>, <span class="hljs-string"><span class="hljs-string">"role"</span></span>: <span class="hljs-string"><span class="hljs-string">"node"</span></span>, <span class="hljs-string"><span class="hljs-string">"hub"</span></span>: <span class="hljs-string"><span class="hljs-string">"http://127.0.0.1:4445/grid/register/"</span></span>, <span class="hljs-string"><span class="hljs-string">"register"</span></span>: true, <span class="hljs-string"><span class="hljs-string">"maxSessions"</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span> }</code> </pre> <br>  Faites attention √† l'utilisation des m√™mes ports lors du d√©marrage du serveur et dans l'URL du concentrateur du pilote.  En tant que seleniumAddress dans la configuration du rapporteur, nous utilisons <code>http://127.0.0.1:4445/wd/hub</code> . <br><br><h2>  Conclusions </h2><br>  Nous avons donc r√©solu notre t√¢che et √† chaque fois apr√®s la sortie d'une nouvelle version, nous pouvons v√©rifier les performances dans ces navigateurs et r√©solutions. <br><br><h3>  Comment int√©grer des tests dans un workflow </h3><br>  Il est important de comprendre qu‚Äôil ne suffit pas de soulever toute l‚Äôinfrastructure pour ex√©cuter des tests et les √©crire.  Vous devez r√©fl√©chir √† la fa√ßon dont vous les utiliserez dans votre vie quotidienne. <br><br>  Nous n'avons pas impl√©ment√© de tests d'interface utilisateur dans CI, car  ils sont ex√©cut√©s assez longtemps pour se permettre d'attendre leur ex√©cution pour chaque build. <br><br>  Pour tester la version locale de l'application ou install√©e sur l'un des environnements de test (interne ou client), il suffit de changer baseUrl dans la configuration Protractor'a.  Par cons√©quent, les tests peuvent √™tre ex√©cut√©s par le d√©veloppeur et le testeur. <br>  D√©veloppeur - lorsqu'il est n√©cessaire d'ex√©cuter des tests, par exemple, pour la version locale de l'application en cours de d√©veloppement d'une nouvelle fonctionnalit√©.  Sp√©cialiste en assurance qualit√© - par exemple, comme test de fum√©e apr√®s un d√©ploiement sur la prod, ou comme contr√¥le sur le dessus apr√®s un tas de refactoring. <br><br>  <b>En conclusion, nous voulons souligner:</b> <br><br><ul><li>  N'oubliez pas que les tests d'interface utilisateur ne vous √©viteront pas de devoir effectuer des tests manuels d√©taill√©s.  L'automatisation permet uniquement de couvrir des zones. </li><li>  Utilisez l'automatisation √† bon escient, principalement pour les tests de fum√©e.  Couvrir tout et tout n'a aucun sens - c'est cher et difficile de se tenir √† jour </li><li>  √âcrivez simplement.  si vos tests d'interface utilisateur semblent compliqu√©s, vous faites quelque chose de mal.  Battre simple et utiliser comme indiqu√© (voir point 2) </li></ul><br>  Nous pensons que l'automatisation des tests d'interface utilisateur est bonne lorsqu'elle est effectu√©e facilement.  Alors partagez avec nous vos observations et outils r√©ussis dans les commentaires. <br><br><h2>  Liens utiles de notre part: </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rapporteur: un nouvel espoir - Michael Giambalvo, Craig Nishina</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Zalenium vs selenoid</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cas de test de rapporteur en ceinture de s√©l√©nium dans Docker</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr425647/">https://habr.com/ru/post/fr425647/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr425635/index.html">Le condens√© de mati√®res fra√Æches du monde du front-end de la derni√®re semaine n ¬∞ 333 (1 - 7 octobre 2018)</a></li>
<li><a href="../fr425637/index.html">Algorithme d'√©tablissement de connexion SSH</a></li>
<li><a href="../fr425641/index.html">Les r√©sidents de la ville canadienne ont d√©velopp√© un "service Uber" avec des bus, pas des voitures</a></li>
<li><a href="../fr425643/index.html">√âv√©nements num√©riques √† Moscou du 8 au 14 octobre</a></li>
<li><a href="../fr425645/index.html">SpaceX et SAOCOM - 1A Nouvelle mission. Termin√©</a></li>
<li><a href="../fr425649/index.html">BDSM, Gore et la poursuite du d√©veloppeur Drupal</a></li>
<li><a href="../fr425653/index.html">Construire une architecture de microservices sur Golang et gRPC, partie 1</a></li>
<li><a href="../fr425657/index.html">L'in√©vitabilit√© de la punition, l'efficacit√© des contr√¥les brusques</a></li>
<li><a href="../fr425659/index.html">La conception interactive ne doit pas √™tre compliqu√©e.</a></li>
<li><a href="../fr425661/index.html">22 conseils pour un d√©veloppeur Angular. Partie 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>