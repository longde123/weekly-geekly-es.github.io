<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>тП║я╕П ЁЯТж ЁЯЩОЁЯП╝ RxJava to Coroutines: рдПрдВрдб-рдЯреВ-рдПрдВрдб рдлреАрдЪрд░ рдорд╛рдЗрдЧреНрд░реЗрд╢рди тЩОя╕П ЁЯСйЁЯП╗тАНЁЯдЭтАНЁЯСиЁЯП╛ ЁЯХ╡ЁЯП╜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="(рдореВрд▓ рд░реВрдк рд╕реЗ рдордзреНрдпрдо рдкрд░ рдкреНрд░рдХрд╛рд╢рд┐рдд) 

 Kotlin coroutines рдХреЗрд╡рд▓ рд╣рд▓реНрдХреЗ рдзрд╛рдЧреЛрдВ рд╕реЗ рдмрд╣реБрдд рдЕрдзрд┐рдХ рд╣реИрдВ - рд╡реЗ рдПрдХ рдирдП рдкреНрд░рддрд┐рдорд╛рди рд╣реИрдВ рдЬреЛ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЛ рдПрдХ рд╕рдВрд░рдЪрд┐рдд рдФрд░ рдореБрд╣рд╛рд╡рд░реЗрджрд╛рд░ рдд...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>RxJava to Coroutines: рдПрдВрдб-рдЯреВ-рдПрдВрдб рдлреАрдЪрд░ рдорд╛рдЗрдЧреНрд░реЗрд╢рди</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483832/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/jb/id/pq/jbidpqpivwqpagw9azop_fswram.png" alt="рдЫрд╡рд┐"></div><br>  (рдореВрд▓ рд░реВрдк рд╕реЗ <a href="https://link.medium.com/OJ7ed2RCd3" rel="nofollow">рдордзреНрдпрдо</a> рдкрд░ рдкреНрд░рдХрд╛рд╢рд┐рдд) <br><br>  Kotlin coroutines рдХреЗрд╡рд▓ рд╣рд▓реНрдХреЗ рдзрд╛рдЧреЛрдВ рд╕реЗ рдмрд╣реБрдд рдЕрдзрд┐рдХ рд╣реИрдВ - рд╡реЗ рдПрдХ рдирдП рдкреНрд░рддрд┐рдорд╛рди рд╣реИрдВ рдЬреЛ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЛ рдПрдХ <a href="https://medium.com/%40elizarov/structured-concurrency-722d765aa952" rel="nofollow">рд╕рдВрд░рдЪрд┐рдд</a> рдФрд░ рдореБрд╣рд╛рд╡рд░реЗрджрд╛рд░ рддрд░реАрдХреЗ рд╕реЗ рд╕рдВрдЧрд╛рдорд┐рддрд┐ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред <br><br>  рдПрдВрдбреНрд░реЙрдЗрдб рдРрдк рдХреЛ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рддреЗ рд╕рдордп рдХрд┐рд╕реА рдХреЛ рдХрдИ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЪреАрдЬреЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП: рдпреВрдЖрдИ рдереНрд░реЗрдб рд╕реЗ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдЪрд▓рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрдЪрд╛рд▓рди рдХреЛ рд▓реЗрдирд╛, рдЬреАрд╡рдирдЪрдХреНрд░ рдХреА рдШрдЯрдирд╛рдУрдВ рдХреЛ рд╕рдВрднрд╛рд▓рдирд╛, рд╕рджрд╕реНрдпрддрд╛ рд░рджреНрдж рдХрд░рдирд╛, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпреВрдЖрдИ рдереНрд░реЗрдб рдкрд░ рд╡рд╛рдкрд╕ рд╕реНрд╡рд┐рдЪ рдХрд░рдирд╛ред  рдкрд┐рдЫрд▓реЗ рдХреБрдЫ рд╡рд░реНрд╖реЛрдВ рдореЗрдВ RxJava рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рдЗрд╕ рд╕реЗрдЯ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдврд╛рдБрдЪреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдмрди рдЧрдпрд╛ред  рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдореИрдВ рдЖрдкрдХреЛ RxJava рд╕реЗ рдХреЛрд░рдЖрдЙрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдПрдВрдб-рдЯреВ-рдПрдВрдб рдлреАрдЪрд░ рдорд╛рдЗрдЧреНрд░реЗрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдорд╛рд░реНрдЧрджрд░реНрд╢рди рдХрд░рдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реВрдВред <br><a name="habracut"></a><br><h4>  рдлрд╝реАрдЪрд░ </h4><br>  рд╣рдо рдЬрд┐рд╕ рд╕реБрд╡рд┐рдзрд╛ рдХреЛ рдХреЛрд░рдЯрд╛рдЗрди рдореЗрдВ рдмрджрд▓рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ, рд╡рд╣ рдХрд╛рдлреА рд╕рд░рд▓ рд╣реИ: рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд┐рд╕реА рджреЗрд╢ рдХреЛ рд╕рдмрдорд┐рдЯ рдХрд░рддрд╛ рд╣реИ, рддреЛ рд╣рдо рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдкреАрдЖрдИ рдХреЙрд▓ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ <a href="https://www.gov.uk/government/organisations/companies-house" rel="nofollow">рдХрдВрдкрдиреА рд╣рд╛рдЙрд╕</a> рдЬреИрд╕реЗ рдХрд┐рд╕реА рдкреНрд░рджрд╛рддрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡реНрдпрд╛рдкрд╛рд░ рд╡рд┐рд╡рд░рдг рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рддреНрд░ рд╣реИред  рдпрджрд┐ рдХреЙрд▓ рд╕рдлрд▓ рдерд╛, рддреЛ рд╣рдо рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджрд┐рдЦрд╛рддреЗ рд╣реИрдВ, рдпрджрд┐ рдирд╣реАрдВ - рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ред <br><br><h4>  рдкреНрд░рд╡рд╛рд╕ </h4><br><img src="https://habrastorage.org/webt/j0/0h/kg/j00hkgwjgnuwnzz4lsgdf5ry_fa.png" align="left"><br>  рд╣рдо рдЕрдкрдиреЗ рдХреЛрдб рдХреЛ рд░рд┐рдЯреНрд░реЛрдлрд┐рдЯ рд╕реЗрд╡рд╛ рд╕реЗ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реБрдП рдПрдХ рдЕрдк-рдЕрдк рджреГрд╖реНрдЯрд┐рдХреЛрдг рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ, рдПрдХ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд▓реЗрдпрд░ рддрдХ, рдлрд┐рд░ рдПрдХ рдЗрдВрдЯрд░реЗрдХреНрдЯрд░ рд▓реЗрдпрд░ рддрдХ рдФрд░ рдЕрдВрдд рдореЗрдВ рдПрдХ ViewModel рдкрд░ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВред <br><br>  рд╡рд░реНрддрдорд╛рди рдореЗрдВ рд╕рд┐рдВрдЧрд▓ рд▓реМрдЯрд╛рдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рдВрдХреНрд╢рдВрд╕ рд╕рд╕реНрдкреЗрдВрдб рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рдВрдХреНрд╢рдВрд╕ рдФрд░ рдлрд╝рдВрдХреНрд╢рдВрд╕ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП, рдЬреЛ рдСрдмреНрдЬрд╝рд░реНрд╡реЗрдмрд▓ рдХреЛ рд▓реМрдЯрд╛рддреЗ рд╣реИрдВ, рдлрд╝реНрд▓реЛ рд▓реМрдЯрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЗрд╕ рд╡рд┐рд╢реЗрд╖ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╣рдо рдлреНрд▓реЛ рдХреЗ рд╕рд╛рде рдХреБрдЫ рднреА рдирд╣реАрдВ рдХрд░рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВред <br><br><h4>  рд░реЗрдЯреНрд░реЛрдлрд┐рдЯ рд╕реЗрд╡рд╛ </h4><br>  рдЪрд▓рд┐рдП рд╕реАрдзреЗ рдХреЛрдб рдореЗрдВ рдХреВрджрддреЗ рд╣реИрдВ рдФрд░ BusinessLookupService рдХреЛ BusinessLookupService рдореЗрдВ coroutines рдореЗрдВ рд░рд┐рдлрд▓реИрдХреНрдЯрд░ рдХрд░рддреЗ рд╣реИрдВред  рдпрд╣ рдЕрдм рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИред <br><br><pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessLookupService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@GET(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"v1/eligibility"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">businessLookupEligibility</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@Query(</span></span></span><span class="hljs-meta-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta"><span class="hljs-meta-string">"countryCode"</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">)</span></span></span></span><span class="hljs-function"><span class="hljs-params"> countryCode: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params"> )</span></span></span></span>: Single&lt;NetworkResponse&lt;BusinessLookupEligibilityResponse, ErrorResponse&gt;&gt; }</code> </pre> <br>  рд░рд┐рдлреИрдХреНрдЯрд░рд┐рдВрдЧ рдЪрд░рдг: <br><br><ol><li>  <a href="" rel="nofollow">рд╕рдВрд╕реНрдХрд░рдг рдХреЗ</a> рд╕рд╛рде рд╢реБрд░реВ <a href="" rel="nofollow">2.6.0</a> рд░реЗрдЯреНрд░реЛрдлрд╝рд┐рдЯ рд╕рд╕реНрдкреЗрдВрдб рд╕рдВрд╢реЛрдзрдХ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред  рдЪрд▓рд┐рдП BusinessLookupEligibility рд╡рд┐рдзрд┐ рдХреЛ рдПрдХ рдирд┐рд▓рдВрдмрд┐рдд рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдмрджрд▓рддреЗ рд╣реИрдВред </li><li>  рд╕рд┐рдВрдЧрд▓ рд░реИрдкрд░ рдХреЛ рд╡рд╛рдкрд╕реА рдкреНрд░рдХрд╛рд░ рд╕реЗ рдирд┐рдХрд╛рд▓реЗрдВред </li></ol><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessLookupService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@GET(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"v1/eligibility"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">businessLookupEligibility</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@Query(</span></span></span><span class="hljs-meta-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta"><span class="hljs-meta-string">"countryCode"</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">)</span></span></span></span><span class="hljs-function"><span class="hljs-params"> countryCode: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params"> )</span></span></span></span>: NetworkResponse&lt;BusinessLookupEligibilityResponse, ErrorResponse&gt; }</code> </pre><br>  NetworkResponse рдПрдХ рд╕реАрд▓рдмрдВрдж рд╡рд░реНрдЧ рд╣реИ рдЬреЛ BusinessLookupEligibilityResponse рдпрд╛ ErrorResponse рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИред  NetworkResponse рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдПрдХ рдХрд╕реНрдЯрдо рд░реЗрдЯреНрд░реЛрдлрд┐рдЯ рдХреЙрд▓ рдЕрдбреИрдкреНрдЯрд░ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕ рддрд░рд╣ рд╣рдо рдбреЗрдЯрд╛ рдкреНрд░рд╡рд╛рд╣ рдХреЛ рдХреЗрд╡рд▓ рджреЛ рд╕рдВрднрд╛рд╡рд┐рдд рдорд╛рдорд▓реЛрдВ рддрдХ рд╣реА рд╕реАрдорд┐рдд рд░рдЦрддреЗ рд╣реИрдВ - рд╕рдлрд▓рддрд╛ рдпрд╛ рддреНрд░реБрдЯрд┐, рдЗрд╕рд▓рд┐рдП BusinessLookupService рдХреЗ рдЙрдкрднреЛрдХреНрддрд╛рдУрдВ рдХреЛ рдЕрдкрд╡рд╛рдж рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреА рдЪрд┐рдВрддрд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред <br><br><h4>  рдХреЛрд╖ </h4><br>  рдЪрд▓реЛ рдЖрдЧреЗ рдмрдврд╝рддреЗ рд╣реИрдВ рдФрд░ рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ BusinessLookupRepository рдореЗрдВ рдХреНрдпрд╛ рд╣реИред  BusinessLookupEligibility method рдмреЙрдбреА рдореЗрдВ рд╣рдо businessLookupService.businessLookupEligibility (рдЬрд┐рд╕реЗ рд╣рдордиреЗ рдЕрднреА рд░рд┐рдлрд▓реЗрдХреНрдЯ рдХрд┐рдпрд╛ рд╣реИ) рдХрд╣рддреЗ рд╣реИрдВ рдФрд░ RxJava рдХреЗ рдореИрдк рдСрдкрд░реЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ NetworkResponse рдХреЛ рдПрдХ рдкрд░рд┐рдгрд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдбреЛрдореЗрди рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЙрдбрд▓ рдмрдирд╛рддреЗ рд╣реИрдВред  рдкрд░рд┐рдгрд╛рдо рдПрдХ рдЕрдиреНрдп рд╕реАрд▓ рд╡рд░реНрдЧ рд╣реИ рдЬреЛ Result.Success рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рдиреЗрдЯрд╡рд░реНрдХ рдХреЙрд▓ рд╕рдлрд▓ рд╣реЛрдиреЗ рдкрд░ TheBusinessLookupEligibility рдСрдмреНрдЬреЗрдХреНрдЯ рд╢рд╛рдорд┐рд▓ рд╣реИред  рдпрджрд┐ рдиреЗрдЯрд╡рд░реНрдХ рдХреЙрд▓ рдореЗрдВ рдХреЛрдИ рддреНрд░реБрдЯрд┐ рдереА, рдбрд┐рд╕реЗрд░рд┐рдПрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдЕрдкрд╡рд╛рдж рдпрд╛ рдХреБрдЫ рдФрд░ рдЧрд▓рдд рд╣реЛ рдЧрдпрд╛ рддреЛ рд╣рдо Result.Failure рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдПрдХ рд╕рд╛рд░реНрдердХ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдХреЗ рд╕рд╛рде рдХрд░рддреЗ рд╣реИрдВ (ErrorMessage <a href="https://kotlinlang.org/docs/reference/type-aliases.html" rel="nofollow">Stringealias</a> for String)ред <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessLookupRepository</span></span></span><span class="hljs-class"> </span><span class="hljs-meta"><span class="hljs-class"><span class="hljs-meta">@Inject</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">constructor</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupService: BusinessLookupService, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupApiToDomainMapper: BusinessLookupApiToDomainMapper, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> responseToString: Mapper, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> schedulerProvider: SchedulerProvider ) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">businessLookupEligibility</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(countryCode: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Single&lt;Result&lt;BusinessLookupEligibility, ErrorMessage&gt;&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> businessLookupService.businessLookupEligibility(countryCode) .map { response -&gt; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span><span class="hljs-symbol"><span class="hljs-symbol">@map</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (response) { <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> NetworkResponse.Success -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupEligibility = businessLookupApiToDomainMapper.map(response.body) Result.Success&lt;BusinessLookupEligibility, ErrorMessage&gt;(businessLookupEligibility) } <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> NetworkResponse.Error -&gt; Result.Failure&lt;BusinessLookupEligibility, ErrorMessage&gt;( responseToString.transform(response) ) } }.subscribeOn(schedulerProvider.io()) } }</code> </pre><br>  рд░рд┐рдлреИрдХреНрдЯрд░рд┐рдВрдЧ рдЪрд░рдг: <br><br><ol><li>  businessLookupEligibility рдПрдХ рдирд┐рд▓рдВрдмрд┐рдд рдХрд╛рд░реНрдп рдмрди рдЬрд╛рддрд╛ рд╣реИред </li><li>  рд╕рд┐рдВрдЧрд▓ рд░реИрдкрд░ рдХреЛ рд╡рд╛рдкрд╕реА рдкреНрд░рдХрд╛рд░ рд╕реЗ рдирд┐рдХрд╛рд▓реЗрдВред </li><li>  рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рд╡рд┐рдзрд┐рдпрд╛рдВ рдЖрдорддреМрд░ рдкрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЙрд▓ рдпрд╛ рдбреАрдмреА рдХреНрд╡реЗрд░реА рдЬреИрд╕реЗ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдЪрд▓рдиреЗ рд╡рд╛рд▓реЗ рдХрд╛рд░реНрдп рдХрд░ рд░рд╣реА рд╣реИрдВред  рдпрд╣ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдпрд╣ рдХрд╛рдо рдХрд┐рд╕ рдереНрд░реЗрдб рдкрд░ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреА рдЬрд┐рдореНрдореЗрджрд╛рд░реА рд╣реИред  SubscribeOn (рд╢реЗрдбреНрдпреВрд▓рд░рдкреНрд░реЛрд╡рд╛рдЗрдбрд░.рдЖрдИрдУ ()) рджреНрд╡рд╛рд░рд╛ рд╣рдо RxJava рдХреЛ рдмрддрд╛ рд░рд╣реЗ рд╣реИрдВ рдХрд┐ io рдереНрд░реЗрдб рдкрд░ рдХрд╛рдо рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЙрд╕реА рдХреЛ рдХреЛрд░рдЯрд╛рдЗрди рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ?  рд╣рдо рдмреНрд▓реЙрдХ рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдЕрд▓рдЧ рдереНрд░реЗрдб рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдбрд┐рд╕реНрдкреИрдЪрд░ рдХреЗ рд╕рд╛рде рдХреЙрдирдЯреЗрдХреНрд╕реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ рдФрд░ рдЬрдм рдирд┐рд╖реНрдкрд╛рджрди рдкреВрд░рд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдореВрд▓ рдбрд┐рд╕реНрдкреИрдЪрд░ рдореЗрдВ рд╡рд╛рдкрд╕ред  рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдЪреНрдЫрд╛ рдЕрднреНрдпрд╛рд╕ рд╣реИ рдХрд┐ withContext рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдореБрдЦреНрдп-рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИред  BusinessLookupRepository рдХреЗ рдЙрдкрднреЛрдХреНрддрд╛рдУрдВ рдХреЛ рдпрд╣ рдирд╣реАрдВ рд╕реЛрдЪрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ BusinessLookupEligibility рд╡рд┐рдзрд┐ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдиреНрд╣реЗрдВ рдХрд┐рд╕ рдзрд╛рдЧреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЗрд╕реЗ рдореБрдЦреНрдп рдзрд╛рдЧреЗ рд╕реЗ рдХреЙрд▓ рдХрд░рдирд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред </li><li>  рд╣рдореЗрдВ рдорд╛рдирдЪрд┐рддреНрд░ рдСрдкрд░реЗрдЯрд░ рдХреА рдЕрдм рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдПрдХ рдирд┐рд▓рдВрдмрд┐рдд рдХрд╛рд░реНрдп рдХреЗ рдПрдХ рд╢рд░реАрд░ рдореЗрдВ businessLookupService.businessLookupEligibility рдХреЗ рдкрд░рд┐рдгрд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </li></ol><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessLookupRepository</span></span></span><span class="hljs-class"> </span><span class="hljs-meta"><span class="hljs-class"><span class="hljs-meta">@Inject</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">constructor</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupService: BusinessLookupService, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupApiToDomainMapper: BusinessLookupApiToDomainMapper, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> responseToString: Mapper, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> dispatcherProvider: DispatcherProvider ) { <span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">businessLookupEligibility</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(countryCode: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Result&lt;BusinessLookupEligibility, ErrorMessage&gt; = withContext(dispatcherProvider.io) { <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">val</span></span> response = businessLookupService.businessLookupEligibility(countryCode)) { <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> NetworkResponse.Success -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupEligibility = businessLookupApiToDomainMapper.map(response.body) Result.Success&lt;BusinessLookupEligibility, ErrorMessage&gt;(businessLookupEligibility) } <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> NetworkResponse.Error -&gt; Result.Failure&lt;BusinessLookupEligibility, ErrorMessage&gt;( responseToString.transform(response) ) } } }</code> </pre><br><h4>  Interactor </h4><br>  рдЗрд╕ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ BusinessLookupEligibilityInteractor рдореЗрдВ рдХреЛрдИ рдЕрддрд┐рд░рд┐рдХреНрдд рддрд░реНрдХ рдирд╣реАрдВ рд╣реИ рдФрд░ BusinessLookupRepository рдХреЗ рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИред  рд╣рдо рдЗрдирд╡реЛрдХ <a href="https://kotlinlang.org/docs/reference/operator-overloading.html" rel="nofollow">рдСрдкрд░реЗрдЯрд░ рдХреЛ рдУрд╡рд░рд▓реЛрдбрд┐рдВрдЧ рдХреЗ</a> рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддрд╛рдХрд┐ рдЗрдВрдЯрд░реЗрдХреНрдЯрд░ рдХреЛ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд░реВрдк рдореЗрдВ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessLookupEligibilityInteractor</span></span></span><span class="hljs-class"> </span><span class="hljs-meta"><span class="hljs-class"><span class="hljs-meta">@Inject</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">constructor</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupRepository: BusinessLookupRepository ) { <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">invoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(countryCode: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Single&lt;Result&lt;BusinessLookupEligibility, ErrorMessage&gt;&gt; = businessLookupRepository.businessLookupEligibility(countryCode) }</code> </pre><br>  рд░рд┐рдлреИрдХреНрдЯрд░рд┐рдВрдЧ рдЪрд░рдг: <br><br><ol><li>  рдСрдкрд░реЗрдЯрд░ рдордЬрд╝рд╛ рдЪрд╛рд▓рд╛рди рдирд┐рд▓рдВрдмрд┐рдд рдСрдкрд░реЗрдЯрд░ рдордЬрд╝рд╛ рдЪрд╛рд▓рд╛рди рдмрди рдЬрд╛рддрд╛ рд╣реИред </li><li>  рд╕рд┐рдВрдЧрд▓ рд░реИрдкрд░ рдХреЛ рд╡рд╛рдкрд╕реА рдкреНрд░рдХрд╛рд░ рд╕реЗ рдирд┐рдХрд╛рд▓реЗрдВред </li></ol><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessLookupEligibilityInteractor</span></span></span><span class="hljs-class"> </span><span class="hljs-meta"><span class="hljs-class"><span class="hljs-meta">@Inject</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">constructor</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupRepository: BusinessLookupRepository ) { <span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">invoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(countryCode: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Result&lt;BusinessLookupEligibility, ErrorMessage&gt; = businessLookupRepository.businessLookupEligibility(countryCode) }</code> </pre><br><h4>  ViewModel </h4><br>  BusinessProfileViewModel рдореЗрдВ рд╣рдо BusinessLookupEligibilityInteractor рдХрд╣рддреЗ рд╣реИрдВ рдЬреЛ рд╕рд┐рдВрдЧрд▓ рджреЗрддрд╛ рд╣реИред  рд╣рдо рд╕реНрдЯреНрд░реАрдо рдХреЛ рд╕рдмреНрд╕рдХреНрд░рд╛рдЗрдм рдХрд░рддреЗ рд╣реИрдВ рдФрд░ UI рд╢реЗрдбреНрдпреВрд▓ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдХреЗ UI рдереНрд░реЗрдб рдкрд░ рдЗрд╕рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░рддреЗ рд╣реИрдВред  рд╕рдлрд▓рддрд╛ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рдПрдХ рдбреЛрдореЗрди рдореЙрдбрд▓ рд╕реЗ рдПрдХ рдмрд┐рдЬрдиреЗрд╕ рд╡реНрдпреВрд╕реНрдЯреЗрдЯ рд▓рд╛рдЗрд╡рдбреЗрдЯ рдкрд░ рдорд╛рди рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред  рд╡рд┐рдлрд▓рддрд╛ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд╣рдо рдПрдХ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рджреЗрддреЗ рд╣реИрдВред <br><br>  рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рд╕рджрд╕реНрдпрддрд╛ рдХреЛ рдПрдХ рдХрдВрдкреЛрдЬрд┐рдЯрдбрд┐рдЬрд╛рдЗрди рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдПрдХ ViewModel рдХреЗ рдЬреАрд╡рдирдЪрдХреНрд░ рдХреА рдСрдирдХреНрд▓реЗрдпрд░ () рд╡рд┐рдзрд┐ рдореЗрдВ рдбрд┐рд╕реНрдкреЛрдЬ рдХрд░рддреЗ рд╣реИрдВред <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessProfileViewModel</span></span></span><span class="hljs-class"> </span><span class="hljs-meta"><span class="hljs-class"><span class="hljs-meta">@Inject</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">constructor</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupEligibilityInteractor: BusinessLookupEligibilityInteractor, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> schedulerProvider: SchedulerProvider ) : ViewModel() { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> disposables = CompositeDisposable() <span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessViewState: MutableLiveData&lt;ViewState&gt; = LiveDataFactory.createDefault(<span class="hljs-string"><span class="hljs-string">"Loading..."</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCountrySubmit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(country: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Country</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { disposables.add(businessLookupEligibilityInteractor(country.countryCode) .observeOn(schedulerProvider.ui()) .subscribe { state -&gt; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span><span class="hljs-symbol"><span class="hljs-symbol">@subscribe</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (state) { <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> Result.Success -&gt; businessViewState.value = state.entity.provider <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> Result.Failure -&gt; businessViewState.value = state.failure } }) } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> void onCleared() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCleared(); disposables.clear(); } }</code> </pre><br>  рд░рд┐рдлреИрдХреНрдЯрд░рд┐рдВрдЧ рдЪрд░рдг: <br><br><ol><li>  рд▓реЗрдЦ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдореИрдВрдиреЗ рдХреЛрд░рдЖрдЙрдЯ рдХреЗ рдореБрдЦреНрдп рд▓рд╛рднреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рд╣реИ - рд╕рдВрд░рдЪрд┐рдд рд╕рдВрдЧрд╛рдорд┐рддрд┐ред  рдФрд░ рдпрд╣ рд╡рд╣ рдЬрдЧрд╣ рд╣реИ рдЬрд╣рд╛рдБ рдпрд╣ рдЦреЗрд▓ рдореЗрдВ рдЖрддрд╛ рд╣реИред  рд╣рд░ рдХреЛрд░рдЯрд╛рдЗрди рдореЗрдВ рдПрдХ рд╕реНрдХреЛрдк рд╣реЛрддрд╛ рд╣реИред  рдХрд╛рд░реНрдпрдХреНрд╖реЗрддреНрд░ рдХрд╛ рдирд┐рдпрдВрддреНрд░рдг рдЕрдкрдиреА рдиреМрдХрд░реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реЛрддрд╛ рд╣реИред  рдпрджрд┐ рдХреЛрдИ рдиреМрдХрд░реА рд░рджреНрдж рд╣реЛ рдЬрд╛рддреА рд╣реИ, рддреЛ рд╕рдВрдмрдВрдзрд┐рдд рджрд╛рдпрд░реЗ рдореЗрдВ рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдХреЛрд░рдЖрдЙрдЯ рдХреЛ рднреА рд░рджреНрдж рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдЖрдк рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рд╕реНрдХреЛрдк рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рддрдВрддреНрд░ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рд╣рдо theViewModel рдХреЗ рдЬреАрд╡рди-рдЪрдХреНрд░-рдЬрд╛рдЧрд░реВрдХ рджреГрд╢реНрдпModelScope рдХрд╛ рд▓рд╛рдн рдЙрдард╛ рд░рд╣реЗ рд╣реИрдВред  рд╣рдо viewModelScope.launch рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ viewModelScope рдореЗрдВ рдПрдХ рдирдпрд╛ coroutine рд╢реБрд░реВ рдХрд░реЗрдВрдЧреЗред  Coroutine рдХреЛ рдореБрдЦреНрдп рдереНрд░реЗрдб рдореЗрдВ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ viewModelScope рдореЗрдВ рдПрдХ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдбрд┐рд╕реНрдкреИрдЪрд░ рд╣реИ - Dispatchers.Mainред  рдбрд┐рд╕реНрдкреИрдЪрд░реНрд╕ рдкрд░ рдПрдХ рдХреЙрд░рдЖрдЙрдЯ рд╢реБрд░реВ рд╣реБрдЖред рдирд┐рд▓рдВрдмрд┐рдд рдХрд░рддреЗ рд╕рдордп рдореБрдЦреНрдп рдереНрд░реЗрдб рдХреЛ рдмреНрд▓реЙрдХ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рдЕрднреА рдПрдХ coroutine рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рд╣реИ, рд╣рдо businessLookupEligibilityInteractor рдХреЛ рдирд┐рд▓рдВрдмрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдСрдкрд░реЗрдЯрд░ рдХреЛ рдЖрдордВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  BusinessLookupEligibilityInteractor BusinessLookupRepository.businessLookupEligibility рдбрд┐рд╕реНрдкреИрдЪрд░рд░реНрд╕.рдЖрдИрдУ рдХреЛ рд╡рд╛рдкрд╕ рднреЗрдЬрддреА рд╣реИ рдФрд░ рдбрд┐рд╕реНрдкреИрдЪрд░реНрд╕ рдХреЛ рд╡рд╛рдкрд╕ рднреЗрдЬ рджреЗрддреА рд╣реИред рдореЗрдиред  рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо UI рдереНрд░реЗрдб рдореЗрдВ рд╣реИрдВ, рд╣рдо рдПрдХ рдорд╛рди рдмрддрд╛рдХрд░ businessViewState LiveData рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </li><li>  рд╣рдо рдбрд┐рд╕реНрдкреЛрдЬрд╝реЗрдмрд▓реНрд╕ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ viewModelScope рдПрдХ ViewModel рдЬреАрд╡рдирдЪрдХреНрд░ рдХреЗ рд▓рд┐рдП рдмрд╛рдзреНрдп рд╣реИред  рдЗрд╕ рджрд╛рдпрд░реЗ рдореЗрдВ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдХреЛрдИ рднреА рдХреЙрдЙрдВрдЯрдЗрди рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд░рджреНрдж рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдЕрдЧрд░ ViewModel рдХреНрд▓рд┐рдпрд░ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред </li></ol><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BusinessProfileViewModel</span></span></span><span class="hljs-class"> </span><span class="hljs-meta"><span class="hljs-class"><span class="hljs-meta">@Inject</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">constructor</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessLookupEligibilityInteractor: BusinessLookupEligibilityInteractor ) : ViewModel() { <span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> businessViewState: MutableLiveData&lt;ViewState&gt; = LiveDataFactory.createDefault(<span class="hljs-string"><span class="hljs-string">"Loading..."</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCountrySubmit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(country: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Country</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { viewModelScope.launch { <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">val</span></span> state = businessLookupEligibilityInteractor(country.countryCode)) { <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> Result.Success -&gt; businessViewState.value = state.entity.provider <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> Result.Failure -&gt; businessViewState.value = state.failure } } } }</code> </pre><br><h4>  рдореБрдЦреНрдп рдЯреЗрдХрдЕрд╡реЗ </h4><br>  рдХреЛрд░рдЯрд╛рдЗрди рдХреЗ рд╕рд╛рде рд▓рд┐рдЦреЗ рдЧрдП рдХреЛрдб рдХреЛ рдкрдврд╝рдирд╛ рдФрд░ рд╕рдордЭрдирд╛ рдХрд╛рдлреА рдЖрд╕рд╛рди рд╣реИ, рдлрд┐рд░ рднреА рдпрд╣ рдПрдХ рдРрд╕рд╛ рдмрджрд▓рд╛рд╡ рд╣реИ рдЬрд┐рд╕реЗ рд╕реАрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред <br><br>  рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдореИрдВрдиреЗ рдкрд░реАрдХреНрд╖рдг рдХреЛ рдХрд╡рд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ред  рдореИрдВрдиреЗ <a href="https://mockk.io/" rel="nofollow">рдореЙрдХрд┐рдЯ</a> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдХреНрдпреЛрдВрдХрд┐ рдореЗрд░реЗ рдкрд╛рд╕ <a href="https://mockk.io/" rel="nofollow">рдореЙрдХрд┐рдЯреЛ рдХрд╛</a> рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ <a href="https://mockk.io/" rel="nofollow">рдХреЛрд░рд╛рдЙрдЯреАрди рдХреЗ</a> рдкрд░реАрдХреНрд╖рдг рдХреЗ рдореБрджреНрджреЗ рдереЗред <br><br>  рдЖрд░рдПрдХреНрд╕ рдЬрд╛рд╡рд╛ рдХреЗ рд╕рд╛рде рдореИрдВрдиреЗ рдЬреЛ рдХреБрдЫ рднреА рд▓рд┐рдЦрд╛ рд╣реИ рдореБрдЭреЗ рдХреЛрд░рдЯрд╛рдЗрди, <a href="https://kotlinlang.org/docs/reference/coroutines/flow.html" rel="nofollow">рдлреНрд▓реЛ</a> рдФрд░ <a href="https://kotlinlang.org/docs/reference/coroutines/channels.html" rel="nofollow">рдЪреИрдирд▓ рдХреЗ</a> рд╕рд╛рде рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдХрд╛рдлреА рдЖрд╕рд╛рди рд▓рдЧрд╛ред  рдХреЛрд░рд╛рдЙрдЯреАрди рдХреЗ рд▓рд╛рднреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдпрд╣ рд╣реИ рдХрд┐ рд╡реЗ рдПрдХ рдХреЛрдЯрд▓рд┐рди рднрд╛рд╖рд╛ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИрдВ рдФрд░ рднрд╛рд╖рд╛ рдХреЗ рд╕рд╛рде рдорд┐рд▓рдХрд░ рд╡рд┐рдХрд╕рд┐рдд рд╣реЛ рд░рд╣реЗ рд╣реИрдВред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi483832/">https://habr.com/ru/post/hi483832/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi483820/index.html">рдХреНрд░реЗрдбрд┐рдЯ рдЬрд╛рд░реА рдХрд░рдиреЗ рдкрд░ рдХреНрдпрд╛ рдЕрд╕рд░ рдкрдбрд╝рддрд╛ рд╣реИред рд╣реЛрдо рдХреНрд░реЗрдбрд┐рдЯ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЬреЛрдЦрд┐рдо рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛ рдЕрд╡рд▓реЛрдХрди</a></li>
<li><a href="../hi483822/index.html">5 рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реБрд╡рд┐рдзрд╛рдПрдБ рдЬрд┐рд╕рдХреЗ рдмрд┐рдирд╛ рдореИрдВ рдХреЛрдб рдирд╣реАрдВ рд▓рд┐рдЦ рд╕рдХрддрд╛ рдерд╛</a></li>
<li><a href="../hi483824/index.html">рдЕрдкрдиреЗ рд╕рдкрдиреЛрдВ рдХрд╛ рдХрд╛рдо рдХреИрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ, рд╕рдХрд╛рд░рд╛рддреНрдордХ рд╕реЛрдЪреЗрдВ рдФрд░ рдЙрд╕ рдкрд░ рдЖрдЧреЗ рдмрдврд╝реЗрдВ, рдореЗрд░реЗ рдкрд╛рдВрдЪ рдирд┐рдпрдореЛрдВ рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд┐рдпрд╛ рд╣реИ ...</a></li>
<li><a href="../hi483826/index.html">Vo рдПрдирд╛рд▓реЙрдЧ рдЖрдЙрдЯрдкреБрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ CO2 рд╕реЗрдВрд╕рд░ рдореЙрдбрд▓ MH-Z19B рдХреЛ рдХрдиреЗрдХреНрдЯ рдХрд░рдирд╛</a></li>
<li><a href="../hi483828/index.html">рд╢рд╛рдЗрди рдФрд░ рдЧрд░реАрдмреА рдкрд░рдорд╛рдгреБ рд╕реНрд╡реИрдк</a></li>
<li><a href="../hi483834/index.html">рдбреЗрдмрд┐рдпрди: рдмрд╕ i386 рдХреЛ amd64 рдореЗрдВ рдмрджрд▓ рд░рд╣рд╛ рд╣реИ</a></li>
<li><a href="../hi483842/index.html">рд╣реЛрдо рдХреНрд▓рд╛рдЙрдб рдмрдирд╛рдиреЗ рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕ред рднрд╛рдЧ 5. рдЕрджреНрдпрддрди 2019 - PHP 7.2, MariaDB 10.4 рдФрд░ Nextcloud 17</a></li>
<li><a href="../hi483844/index.html">рд░реВрд╕реА рдЛрдг рдФрд░ рд╡рд┐рддреНрддреАрдп рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рд╕реВрдЪрдирд╛ рд╕рдВрд░рдХреНрд╖рдг рдкрд░ рдирд┐рдпрд╛рдордХ рджрд╕реНрддрд╛рд╡реЗрдЬреЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг</a></li>
<li><a href="../hi483846/index.html">рд▓рд┐рдирдХреНрд╕ рдкрд░ рд╡реИрдХрд▓реНрдкрд┐рдХ рд╡рд┐рдВрдбреЛ рдкреНрд░рдмрдВрдзрди</a></li>
<li><a href="../hi483850/index.html">рдХреЛрдИ рджреЗрд╡рддрд╛ рдмрд░реНрддрди рдирд╣реАрдВ рдЬрд▓рд╛рддреЗ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>