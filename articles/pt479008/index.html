<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🔧 👩🏼 🤛🏽 Como preparar o RTSP em seu site em 2020 ou por que os javalis não terão chance de fugir 👂🏾 🤵🏽 👩🏻‍🤝‍👨🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O RTSP é um protocolo simples de sinalização que eles não podem substituir por nada por muitos anos e é preciso admitir que eles não se esforçam muito...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como preparar o RTSP em seu site em 2020 ou por que os javalis não terão chance de fugir</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flashphoner/blog/479008/"><p><img src="https://habrastorage.org/webt/0o/qj/i7/0oqji7xkok-ssze_oqdnr2kmfcg.jpeg"></p><br><p>  O RTSP é um protocolo simples de sinalização que eles não podem substituir por nada por muitos anos e é preciso admitir que eles não se esforçam muito. </p><br><p>  Por exemplo, temos uma câmera IP que suporta RTSP.  Qualquer pessoa que já tenha testado o tráfego com um cabo Sharkwire lhe dirá que primeiro vem o DESCRIBE, depois o PLAY e, em seguida, o tráfego começa a vazar diretamente via RTP ou envolvido no canal TCP, por exemplo. </p><a name="habracut"></a><br><p>  Um esquema típico de estabelecer uma conexão RTSP se parece com isso: </p><br><p><img src="https://habrastorage.org/webt/yi/i9/kw/yii9kwulxpxxz1dywpppxqdy0ko.png"></p><br><p>  É concebível que o suporte ao protocolo RTSP seja desnecessário para navegadores e tenha tanto uso quanto a quinta roda; portanto, os navegadores não têm pressa em implementá-lo em grande escala, e isso quase nunca acontecerá.  Por outro lado, os navegadores poderiam criar conexões TCP diretas, o que resolveria a tarefa, mas agora se depara com problemas de segurança: você já viu um navegador que permitia que um script usasse protocolos de transporte diretamente? </p><br><p>  Mas as pessoas exigem que os fluxos estejam disponíveis em "qualquer navegador sem instalar nenhum software adicional" e os iniciantes escrevem em seus sites: "você não precisa instalar nada, ele funcionará em todos os navegadores prontos para uso", quando eles deseja mostrar um fluxo de uma câmera IP. </p><br><p>  Neste artigo, vamos explorar como isso pode ser alcançado.  E como o próximo ano contém uma cifra redonda, vamos adicionar um pouco de atualidade ao nosso artigo e colar um rótulo com 2020, especialmente porque é realmente assim. </p><br><p>  Então, quais tecnologias de exibição de vídeo para uma página da web precisam ser esquecidas no ano de 2020?  É o Flash no navegador.  Está morto.  Ele não existe mais, riscá-lo da lista. </p><br><h3 id="three-useful-methods">  Três métodos úteis </h3><br><p>  As ferramentas que permitirão assistir a um fluxo de vídeo no seu navegador hoje são: </p><br><ol><li>  WebRTC </li><li>  Hls </li><li>  Websocket + MSE </li></ol><br><h4 id="what-is-wrong-with-webrtc">  O que há de errado com o WebRTC </h4><br><p>  Em duas palavras: consome muitos recursos e é complicado. </p><br><p>  Você vai dizer: "O que você quer dizer com uso intensivo de recursos?", Como as CPUs são poderosas hoje em dia, a memória é barata, então qual é o problema?  Bem, primeiro, é a criptografia obrigatória de todo o tráfego, mesmo que você não precise.  Em segundo lugar, o WebRTC é uma complicada conexão bidirecional e troca de feedback ponto a ponto sobre a qualidade do canal (ponto a servidor, neste caso): a cada momento, há um bitrate calculado, perdas de pacotes detectadas, decisões sobre o redirecionamento realizado e a sincronização de áudio para vídeo são calculados com relação a tudo isso, o chamado sincronismo labial, que faz com que os lábios do interlocutor coincidam com suas palavras.  Todos esses cálculos, assim como o tráfego de entrada no servidor, alocam e liberam gigabytes de RAM em tempo real e, se algo der errado, um servidor de 256 gigabytes com uma CPU de 48 núcleos entrará em uma rotação fácil, apesar todos os gigaherzs, nanômetros e DDR 10 a bordo. </p><br><p>  Então, é como caçar esquilos com um míssil Iskander.  Tudo o que precisamos é de um fluxo RTSP e depois exibi-lo, e o que o WebRTC diz é: "Sim, vamos lá, mas você terá que pagar por isso". </p><br><h4 id="why-webrtc-is-good">  Por que o WebRTC é bom </h4><br><p>  A latência.  É muito baixo.  Se você está pronto para sacrificar o desempenho e a complexidade pela baixa latência, o WebRTC é a variante mais adequada para você. </p><br><h4 id="why-hls-is-good">  Por que o HLS é bom </h4><br><p>  Em duas palavras: ele pode funcionar em qualquer lugar </p><br><p>  O HLS é um veículo off-road lento no mundo da exibição de conteúdo ao vivo.  Ele pode funcionar em qualquer lugar devido a duas coisas: o transporte HTTP e o apoio da Apple.  De fato, o protocolo HTTP é onipresente, posso sentir sua presença mesmo quando estou escrevendo essas linhas.  Portanto, não importa onde você esteja e qual tablet antigo você usa para navegar na Internet, o HLS (HTTP Live Streaming) chegará até você e entregará o vídeo na tela com certeza. </p><br><p>  Está tudo bem o suficiente, mas ... </p><br><h4 id="why-hls-is-bad">  Por que o HLS é ruim </h4><br><p>  A latência.  Existem, por exemplo, projetos de videovigilância no canteiro de obras.  Há uma instalação em construção há anos e, durante todo esse tempo, a câmera ruim grava vídeos do canteiro de obras dia e noite, 24 horas por dia, 7 dias por semana.  Este é um exemplo de uma situação em que a baixa latência não é necessária. </p><br><p>  Outro exemplo são os javalis.  Javalis reais.  Os agricultores de Ohio sofrem com a invasão de javalis que se alimentam das plantações e as pisoteam como gafanhotos, ameaçando, assim, o bem-estar financeiro das fazendas.  Iniciantes empreendedores lançaram um sistema de vigilância por vídeo a partir de câmeras RTSP, que monitora o terreno em tempo real e desencadeia uma armadilha quando os invasores invadem.  Nesse caso, a baixa latência é extremamente importante e, se o HLS for usado (com uma latência de 15 segundos), os javalis irão fugir antes que a armadilha seja ativada. </p><br><p><img src="https://habrastorage.org/webt/g4/ha/iw/g4haiwkwu7jqrhh65c804phjt-q.jpeg"></p><br><p>  Aqui está mais um exemplo: apresentações em vídeo em que alguém demonstra um produto para você e espera uma resposta imediata.  No caso de uma alta latência, eles mostrarão o produto para você na câmera e perguntarão: “Então, como você gosta?”, E isso chegará a você em apenas 15 segundos.  Dentro de 15 segundos, o sinal pode viajar para a Lua e voltar 12 vezes.  Não, não queremos essa latência.  Parece mais um vídeo pré-gravado do que Live.  Porém, vídeo pré-gravado, como é o modo de funcionamento do HLS: ele grava partes de um vídeo em um disco ou na memória do servidor e o reprodutor baixa as partes gravadas.  É assim que o HTTP Live funciona, que não é Live. </p><br><p>  Por que isso acontece?  A presença global do protocolo HTTP e sua simplicidade resultam em sua lentidão, já que o HTTP não se destinava inicialmente ao download e exibição rápidos de milhares de grandes fragmentos de vídeo (segmentos HLS).  É claro que eles são baixados e reproduzidos com alta qualidade, mas muito lentamente: são necessários 15 segundos ou mais para serem baixados, armazenados em buffer e decodificados. </p><br><p>  Deve-se notar aqui que a Apple anunciou sua baixa latência HLS no outono de 2019, mas isso já é uma história diferente.  Vamos dar uma olhada mais detalhada em seus resultados posteriormente.  E agora também temos o MSE em estoque. </p><br><h4 id="why-mse-is-good">  Por que o MSE é bom </h4><br><p>  O Media Source Extension é um suporte nativo para a reprodução de vídeos em pacotes no navegador.  Ele pode ser chamado de player nativo para H.264 e AAC, no qual você pode alimentar segmentos de vídeo e que não está vinculado a um protocolo de transporte, diferente do HLS.  Por esse motivo, você pode escolher o transporte através do protocolo Websockets.  Em outras palavras, os segmentos não serão mais baixados usando a tecnologia antiga Request-Response (HTTP), mas serão enviados rapidamente através da conexão Websockets, que é quase um canal TCP direto.  Isso é de grande ajuda no que diz respeito à diminuição dos atrasos, que podem chegar a 3-5 segundos.  Essa latência não é fantástica, mas é adequada para a maioria dos projetos que não exigem muito tempo real.  A complexidade e a intensidade dos recursos também são relativamente baixas porque um canal TCP é aberto e quase os mesmos segmentos HLS passam por ele, que são coletados pelo jogador e enviados para serem reproduzidos. </p><br><h4 id="why-mse-is-bad">  Por que o MSE é ruim </h4><br><p>  Não pode funcionar em qualquer lugar.  O mesmo que com o WebRTC, sua penetração nos navegadores é menor.  Os iPhones (iOS) têm um histórico especialmente notável de falha ao reproduzir o MSE, o que o torna dificilmente adequado como a única solução para uma inicialização. <br>  Está totalmente disponível nos seguintes navegadores: Edge, Firefox, Chrome, Safari, Navegador Android, Opera Mobile, Chrome para Android, Firefox para Android, Navegador UC para Android. </p><br><p><img src="https://habrastorage.org/webt/xt/oq/wn/xtoqwnjdoosqb6fhopu9rvoxsxy.png"></p><br><p>  O suporte limitado do MSE apareceu no iOS Safari há pouco tempo, começando com o iOS 13. </p><br><p><img src="https://habrastorage.org/webt/fl/wd/-n/flwd-nksnux1tlprjriupeajyvm.png"></p><br><h3 id="rtsp-leg">  Perna RTSP </h3><br><p>  Discutimos a entrega na direção do navegador do servidor de vídeo.  Além disso, você também precisará destas duas coisas: </p><br><p>  1) Para entregar seu vídeo da câmera IP para o servidor. <br>  2) Para converter o vídeo em um dos formatos / protocolos descritos acima. </p><br><p>  É aqui que o lado do servidor entra. </p><br><p>  Ta-dah ... Conheça o <a href="https://flashphoner.com/">Web Call Server 5</a> (ou simplesmente o WCS para amigos).  Alguém precisa receber o tráfego RTSP, descompactar o vídeo corretamente, convertê-lo em WebRTC, HLS ou MSE, de preferência sem ser supercomprimido pelo transcodificador, e enviá-lo ao navegador na forma apresentável, não corrompida por artefatos e congelamentos. </p><br><p>  A tarefa não é complicada à primeira vista, mas pode haver tantas armadilhas ocultas, câmeras chinesas e nuances de conversão por trás dela que é realmente horrível.  Na verdade, não é possível sem hacks, mas funciona e funciona bem.  Em produção. </p><br><h4 id="the-delivery-scheme">  O esquema de entrega </h4><br><p>  Como resultado, um esquema completo de entrega de conteúdo RTSP com conversão em um servidor intermediário começa a tomar forma. </p><br><p><img src="https://habrastorage.org/webt/jm/7e/oj/jm7eojlfeztudqtrwzjebgu4t9e.png"></p><br><p>  Uma das perguntas mais freqüentes de nossos colegas indianos é: “É possível?  Diretamente, sem servidor? ”.  Não, não é;  você precisará do lado do servidor que fará o trabalho.  Na nuvem, no hardware, no corei7 na sua varanda, mas você não pode ficar sem ele. </p><br><h4 id="lets-get-back-to-our-year-2020">  Vamos voltar ao nosso ano de 2020 </h4><br><p>  Então, aqui está a receita para cozinhar um RTSP no seu navegador: </p><br><ol><li>  <a href="">Tome um novo WCS (servidor de chamadas na Web)</a> . </li><li>  Adicione WebRTC, HLS ou MSE a gosto. </li><li><p>  Sirva-os na página da web. </p><br><p>  Aproveite a sua refeição! </p><br></li></ol><br><h3 id="no-this-isnt-all-yet">  Não, isso ainda não é tudo. </h3><br><p>  Os neurônios inquiridores definitivamente querem fazer esta pergunta: “Como?  Realmente, <a href="https://flashphoner.com/embedding-html5-rtsp-player-into-a-web-page/">como isso pode ser feito</a> ?  Como será a aparência no navegador? ” </p><br><p>  Gostaríamos de chamar a atenção do jogador minimalista do WebRTC, reunido como um esforço na mesa da cozinha. </p><br><p>  1) Conecte o script principal da API flashphoner.js e o script my_player.js, que criaremos um pouco mais tarde, à página da web. </p><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../../../../flashphoner.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">my_player.js</span></span></span><span class="hljs-tag">"&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  2) Inicialize a API no corpo da página da web </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"init_api()"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  3) Adicione div à página, que servirá como um contêiner para os vídeos.  Defina os tamanhos e os limites para ele. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myVideo"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width:320px;height:240px;border: solid 1px"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  4) Adicione o botão Play, o clique no qual inicializará a conexão com o servidor e começará a reproduzir o vídeo </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"connect()"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PLAY"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br><p>  5) Agora vamos criar o script my_player.js que conterá o código principal do nosso player.  Descreva as constantes e variáveis </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> SESSION_STATUS = Flashphoner.constants.SESSION_STATUS; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> STREAM_STATUS = Flashphoner.constants.STREAM_STATUS; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> session;</code> </pre> <br><p>  6) Inicialize a API quando uma página HTML for carregada </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init_api</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"init api"</span></span>); Flashphoner.init({ }); }</code> </pre> <br><p>  7) Conecte-se ao servidor WCS via WebSocket.  Para que tudo funcione corretamente, substitua "wss: //demo.flashphoner.com" pelo seu endereço WCS </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connect</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ session = Flashphoner.createSession({<span class="hljs-attr"><span class="hljs-attr">urlServer</span></span>: <span class="hljs-string"><span class="hljs-string">"wss://demo.flashphoner.com"</span></span>}).on(SESSION_STATUS.ESTABLISHED, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">session</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"connection established"</span></span>); playStream(session); }); }</code> </pre> <br><p>  8) Depois disso, transmita os dois parâmetros a seguir, "nome" e "exibição", onde "nome" é a URL RTSP do fluxo que está sendo reproduzido e "exibição" é o elemento do myVideo no qual nosso player será instalado.  Defina aqui também o URL do seu stream, e não o nosso. </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">playStream</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> options = {<span class="hljs-attr"><span class="hljs-attr">name</span></span>:<span class="hljs-string"><span class="hljs-string">"rtsp://b1.dnsdojo.com:1935/live/sys2.stream"</span></span>,<span class="hljs-attr"><span class="hljs-attr">display</span></span>:<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"myVideo"</span></span>)}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stream = session.createStream(options).on(STREAM_STATUS.PLAYING, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">stream</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"playing"</span></span>); }); stream.play(); }</code> </pre> <br><p>  Salve os arquivos e tente iniciar o player.  O seu fluxo RTSP é reproduzido? </p><br><p>  Quando <a href="https://flashphoner.com/testing-rtsp-html5-player/">testamos</a> , este foi reproduzido: rtsp: //b1.dnsdojo.com: 1935 / live / sys2.stream. </p><br><p>  E é assim que se parece: </p><br><p>  O player antes de clicar no botão Play </p><br><p><img src="https://habrastorage.org/webt/pe/ej/6n/peej6nfw2lthkmmnsrypojl6bzq.png"></p><br><p>  O player com um vídeo lançado </p><br><p><img src="https://habrastorage.org/webt/w3/h8/yo/w3h8yozn6madl2tolxx_xg3yljs.png"></p><br><p>  Não há muito código: </p><br><p>  HTML </p><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../../../../flashphoner.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">my_player.js</span></span></span><span class="hljs-tag">"&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"init_api()"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myVideo"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width:320px;height:240px;border: solid 1px"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"connect()"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PLAY"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Javascript </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//Status constants var SESSION_STATUS = Flashphoner.constants.SESSION_STATUS; var STREAM_STATUS = Flashphoner.constants.STREAM_STATUS; //Websocket session var session; //Init Flashphoner API on page load function init_api() { console.log("init api"); Flashphoner.init({ }); } //Connect to WCS server over websockets function connect() { session = Flashphoner.createSession({urlServer: "wss://demo.flashphoner.com"}).on(SESSION_STATUS.ESTABLISHED, function(session){ console.log("connection established"); playStream(session); }); } //Playing stream with given name and mount the stream into myVideo div element function playStream() { var options = {"rtsp://b1.dnsdojo.com:1935/live/sys2.stream",display:document.getElementById("myVideo")}; var stream = session.createStream(options).on(STREAM_STATUS.PLAYING, function(stream) { console.log("playing"); }); stream.play(); }</span></span></code> </pre> <br><p>  demo.flashphoner.com é usado como o lado do servidor.  O código completo do exemplo está disponível abaixo, no rodapé da página que contém os links. <br>  Tenha uma transmissão agradável! </p><br><h3 id="links">  Ligações </h3><br><p>  <a href="https://github.com/flashphoner/flashphoner_client/tree/wcs_api-2.0/examples/demo/streaming/player">Código do jogador no github</a> </p><br><p>  <a href="https://flashphoner.com/ip-camera-streaming-via-rtsp-for-webrtc-and-websocket-browsers/">Integração de um player RTSP em uma página da web ou aplicativo móvel</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt479008/">https://habr.com/ru/post/pt479008/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt478998/index.html">Por que sempre queremos ver a proporção áurea? Tentativa (sem êxito) de análise evolutiva usando redes neurais C ++</a></li>
<li><a href="../pt479000/index.html">Estágio Parallels quando você tem 14 anos</a></li>
<li><a href="../pt479002/index.html">Gamificação de processos de negócios. Como isso funciona?</a></li>
<li><a href="../pt479004/index.html">É possível se proteger de recrutadores irritantes?</a></li>
<li><a href="../pt479006/index.html">As Crônicas da Fome do Livro II</a></li>
<li><a href="../pt479012/index.html">SviMik: “Existem duas opiniões opostas sobre isso no OSM”</a></li>
<li><a href="../pt479016/index.html">5 etapas para proteger segredos comerciais</a></li>
<li><a href="../pt479018/index.html">Docker para o front-end. Parte 2. O que você é?</a></li>
<li><a href="../pt479020/index.html">A história de como o Google Play cruzou dez anos do meu trabalho em uma hora</a></li>
<li><a href="../pt479022/index.html">TVs inteligentes Samsung, LG, Vizio e TCL a cada segundo pegam "impressões digitais" da tela e enviam para o servidor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>