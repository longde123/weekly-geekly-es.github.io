<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👌🏽 😑 🏂🏼 Menguji API menggunakan Postman dan Excel 🉐 📓 🍩</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya, saya adalah kepala departemen pengujian, dan baru-baru ini sebuah tugas untuk menguji API telah muncul. Untuk mengatasinya, saya mengua...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Menguji API menggunakan Postman dan Excel</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467127/">  Halo semuanya, saya adalah kepala departemen pengujian, dan baru-baru ini sebuah tugas untuk menguji API telah muncul.  Untuk mengatasinya, saya menguasai alat tukang pos dan JavaScript baru untuk saya. <br><br>  Awalnya, untuk setiap API, saya menulis koleksi saya dan menyiapkan data uji dalam format JSON.  Ini cukup nyaman, tetapi dengan sejumlah besar tes dan koleksi menjadi tidak menguntungkan untuk dipertahankan.  Dan tidak nyaman untuk memvalidasi data di JSON. <br><br>  Untuk mengatasi masalah ini, saya menulis makro untuk Excel dan koleksi di tukang pos.  Sekarang di tukang pos saya memiliki satu koleksi untuk semua API dan satu set fungsi standar untuk memproses data yang masuk dan memvalidasi hasil yang dikembalikan.  Saya berhasil mentransfer manajemen data uji dan urutan eksekusi permintaan ke Excel. <br><br><h4>  Apa itu </h4><br>  1. JSON dengan data <br><br><img src="https://habrastorage.org/webt/be/l-/78/bel-78hyknqwqra9c8qovryx9fm.png"><br>  <i>Sebelumnya, test kit disimpan dalam formulir ini</i> <br><a name="habracut"></a><br>  2. 2. Urutan eksekusi permintaan dengan penangan JS disimpan dalam koleksi tukang pos. <br><br><img src="https://habrastorage.org/webt/gi/tw/4j/gitw4j_h_todey0pzbyvou9sinc.png"><br><br><h4>  Apa yang telah terjadi </h4><br>  1. Test suite dipindahkan ke Excel <br><br><img src="https://habrastorage.org/webt/j5/0e/fv/j50efvyvp-dspfoobtcpjgjbemg.png"><br><br>  Semua data dimasukkan ke Excel (karakter tombol kontrol: R, H, I, dll. Saya akan menulis di bawah) dan kemudian, menggunakan makro, mereka ditransfer ke format json: <br><br><img src="https://habrastorage.org/webt/y9/dp/5q/y9dp5q9c_fdj7_zbxun6-ebl1tk.png"><br><br>  2. Di tukang pos <br><br><img src="https://habrastorage.org/webt/ry/mq/jl/rymqjl-zkqsqakx6fxuqkxpy110.png"><br><br>  Eksperimen dilakukan pada serangkaian standar operasi CRUD, yang dapat dikembangkan lebih lanjut. <br><br>  Karena di Postman semua operasi dilakukan hanya dalam kerangka permintaan, saya harus memasukkan permintaan kosong di akhir permintaan berikutnya dari urutan ditentukan.  Jalankan kode JS sebelum permintaan dan tentukan permintaan pertama tanpa gagal. <br><br>  Dalam semua permintaan, skrip Pra-permintaan dan bagian Uji kosong, semua kode disatukan untuk permintaan dan disimpan di bagian umum skrip Pra-permintaan dan Tes folder Koleksi API. <br><br><img src="https://habrastorage.org/webt/dz/jc/ao/dzjcaoa2elumolbw2wbp_d1dhe0.png"><br><br>  Dalam semua permintaan, penting untuk memperhatikan url dan bagian Tubuh dalam permintaan POST dan PUT, nilainya ditentukan oleh variabel, yang nilainya dimasukkan dari JSON dengan data. <br><br><img src="https://habrastorage.org/webt/gj/yu/y0/gjyuy08umwwocw2aayfgd0legtm.png"><br><br><h4>  Sekarang tentang tes itu sendiri </h4><br><img src="https://habrastorage.org/webt/zg/as/ah/zgasahcnnfy4uv3w2cijha956kq.png"><br><br>  <b>Cara membaca excel</b> .  Baris non-kosong pertama adalah jumlah test case, yaitu test case disimpan secara vertikal dan pada halaman ini terdapat 9 case pengujian.  Di set saat ini, di setiap kasus uji, permintaan POST akan dieksekusi terlebih dahulu, lalu Hapus. <br><br>  <b>Cara memulai generasi Json dari Excel</b> .  Di Excel, tekan F11 dan pergi ke "EtaBook", di sana jalankan makro. <br><br><h4>  Kata kunci </h4><br>  <b>R</b> -request, berarti awal dari permintaan baru, di sel kedua dari baris jenis permintaan disimpan, di ketiga adalah alamat yang harus Anda hubungi.  Harap dicatat bahwa di url Anda dapat menentukan variabel tukang pos <br><br><img src="https://habrastorage.org/webt/9o/ex/nq/9oexnqprk9duapwq6zcxoe5hsae.png"><br>  <i>Nilai dari variabel akan ditarik</i> <br><br>  <b>H</b> - Data untuk verifikasi di header, sejauh ini hanya kode respons yang dimasukkan, tukang pos hanya memeriksanya di tukang pos.  Penting bahwa di Excel nama adalah "kode respons" yang sama, atau diperbaiki di tukang pos <br><br><img src="https://habrastorage.org/webt/74/26/if/7426ifzzmp0fljuy6t0tgzww5oo.png"><br><br>  <b>I, I2 ...</b> - Bagian data input mendukung penyimpanan model data dari setiap sarang, angka di sebelah kanan I bertanggung jawab atas tingkat sarang.  Kumpulan data berikutnya dibungkus dalam JSON seperti ini.  Jika variabel yang menyimpan data kosong, maka itu tidak akan ditambahkan.  Artinya, jika tidak ada nilai dalam variabel inn, maka itu tidak akan ditambahkan, dan variabel utama akan ditambahkan, karena menyimpan model.  Apalagi, jika seluruh model kosong, maka tidak akan ditambahkan juga. <br><br><img src="https://habrastorage.org/webt/x-/ku/bg/x-kubguayoz-z57pewwztbltnsq.png"><br>  <i>Data di bagian ini akan diserahkan di badan permintaan.</i> <br><br><img src="https://habrastorage.org/webt/mu/og/ne/muognet9_l6pj_l5gbc9ugici6q.png"><br><br>  <b>O, O2 ...</b> - Bagian dari parameter output, mereka akan dibandingkan dengan yang dikembalikan oleh respons.  Seperti bagian Input, ini mendukung penyimpanan model. <br><br><img src="https://habrastorage.org/webt/i8/yz/xm/i8yzxm_jo-3bd5fgdvyfraz_g_u.png"><br>  <i>Ketika membandingkan, data dikonversi ke string, saya juga membatasi tingkat rekursi, ini dapat dihapus</i> <br><br>  <b>PO</b> - Output Postman, nilai-nilai dari bagian ini akan diambil dari tubuh respon permintaan dengan nama variabel dan ditulis ke variabel Postman. <br><br><img src="https://habrastorage.org/webt/vx/ho/fz/vxhofzpxvogjohpodrnu0zl9vvc.png"><br>  <i>Di Excel, cukup untuk menempatkan karakter apa pun, nilai dari respons, bukan unggul, ditulis ke variabel</i> <br><br><img src="https://habrastorage.org/webt/-j/e9/qg/-je9qgf4r93uv3nhj69fksobm0c.png"><br>  <i>Bagian ini diperlukan untuk menyimpan data di antara skrip, misalnya, untuk menghapus objek dengan id yang dibuat dalam permintaan sebelumnya</i> <br><br>  <b>PC</b> - Postman command, hanya memperkenalkan satu perintah “terminate”, digunakan untuk memaksa termination setelah mengeksekusi permintaan saat ini.  Berguna untuk tes negatif, agar tidak menyebabkan langkah untuk menghapus objek yang dibuat. <br><br><img src="https://habrastorage.org/webt/b4/c-/a-/b4c-a-z_r2b4t_icmwb2fpsaerq.png"><br>  <i>Memasukkan perintah ini memungkinkan menyimpan tes positif dan negatif pada satu lembar</i> <br><br><img src="https://habrastorage.org/webt/18/w3/o-/18w3o-70cys7nv7dulrifg5ja7s.png"><br><br>  <b>PI</b> - Input tukang pos, nilai-nilai dari bagian ini akan ditulis ke variabel tukang pos sebelum definisi url <br><br><img src="https://habrastorage.org/webt/kh/rc/vz/khrcvzvphiglyotfonirlen-hr8.png"><br>  Ini bisa berguna jika Anda perlu mengganti variabel yang ditentukan dalam url permintaan. <br><br>  Ngomong-ngomong, Anda dapat menggunakan data dari variabel Postman dalam data yang disediakan, untuk ini Anda perlu menggunakan desain khusus <br><br><img src="https://habrastorage.org/webt/v6/bv/8r/v6bv8r4dsxo3sslgpfnmqjk7cuy.png"><br><br>  Dalam kasus 1, kami memasukkan nilai yang diperoleh ke dalam variabel, dalam kasus 2 kami menggunakannya.  Ini dapat digunakan tidak hanya dalam kasus berikutnya, tetapi juga dalam yang sekarang pada permintaan berikutnya.  Misalnya, mungkin diperlukan jika definisi objek untuk perubahan tidak sesuai dengan url, tetapi dengan nilai variabel dalam permintaan. <br><br><h4>  Persiapan untuk lari </h4><br>  Dan sekarang, jalankan, jalankan Postman runner, pilih koleksi yang diinginkan di dalamnya dan unggah file dengan data uji: <br><br><img src="https://habrastorage.org/webt/qz/j7/v7/qzj7v7qfatkjb5qs9uanx8pj1gg.png"><br><br>  Kami akan melayani set berikut: <br><br><img src="https://habrastorage.org/webt/yr/rl/e0/yrrle0uje4xycw_yfhtnkuel9io.png"><br><br>  15 tes dijelaskan di sini, dengan langkah 1-11, 13, 15 positif dengan hasil 200 untuk permintaan POST, dan langkah 12, 14 negatif dengan hasil 400. Tidak ada informasi yang akan dimasukkan ke dalam database dan oleh karena itu bagian Output kosong, dan perintah ditunjukkan mengakhiri.  Perintah ini akan menghentikan eksekusi urutan dan permintaan untuk menghapus "Hapus" tidak akan dikirim. <br><br>  Setelah kasus 1-11, 13, 15, kita ingat id yang ditugaskan ke objek baru, lalu untuk menghapusnya. <br><br><h4>  Kami meluncurkan </h4><br><img src="https://habrastorage.org/webt/lv/i-/lp/lvi-lpm3jj-12nmimyar_tulyxu.png"><br>  <i>Semua 15 tes berhasil, gambar menunjukkan tes 14, di mana Hapus tidak dipanggil setelah POST</i> <br><br>  Dalam tes 1-11,13,15 setelah POST, penghapusan objek yang dibuat disebut: <br><br><img src="https://habrastorage.org/webt/vz/i9/e3/vzi9e3bm7n2xyadpllytq-s1czm.png"><br><br><h4>  Ringkasan </h4><br><ul><li>  Urutan permintaan untuk pengujian API dibuat di Excel dan diproses di tukang pos. </li><li>  Semua data uji juga diberikan dalam Excel, akan lebih mudah untuk mengelola dan memvalidasinya.  Setidaknya lebih nyaman daripada dalam format JSON. </li><li>  Koleksi Postman terstandarisasi dan tidak perlu ditingkatkan saat menguji API serupa. </li></ul><br><h4>  Referensi </h4><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">GitHub, ada Excel dan koleksi tukang pos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dalam pengembangan, alat VBA-JSON yang ditulis oleh Tim Hall digunakan.</a> </li></ol><br><br>  <b>Perbarui dari 10/15/2019</b> <br><br>  1. Meningkatkan kemampuan untuk menghasilkan file json tanpa menjalankan excel, letakkan di GenerateAll.cmd git, yang menjalankan skrip vb GenerateJsonFiles.vbs.  Script yang dipanggil akan melalui folder saat ini dan semua subfolder dan menghasilkan file json <br>  2. RunAll.cmd jalankan untuk menjalankan semua file data json yang dihasilkan, juga folder saat ini dan semua subfolder akan melalui.  Di sebelah masing-masing dari mereka akan menempatkan output-report.log dengan hasil proses. <br><br>  Sekarang mengacaukan ke CI seharusnya tidak menjadi masalah.  Anda juga dapat mempercepat generasi json untuk menggunakan git dan membandingkan data dalam excel untuk perubahan dalam file json. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id467127/">https://habr.com/ru/post/id467127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id467113/index.html">Bagaimana cara menjaga pengguna di situs? Rahasia kegunaan</a></li>
<li><a href="../id467115/index.html">“Ls” atipikal - Edisi Habr</a></li>
<li><a href="../id467117/index.html">Naskah tidak terbakar: rahasia umur panjang gulungan Laut Mati kembali ke 250 SM</a></li>
<li><a href="../id467119/index.html">Mainkan IT-Alias ​​dengan Badoo Engineers</a></li>
<li><a href="../id467125/index.html">Game NES modern ditulis dalam bahasa mirip Lisp</a></li>
<li><a href="../id467129/index.html">Penegakan Kognitif 2: Mempelajari Ilusi dan Distorsi</a></li>
<li><a href="../id467131/index.html">CLRium # 6: Pasangkan laporan tentang Lock-Free, banyak teori dan pengetahuan praktis</a></li>
<li><a href="../id467135/index.html">Pedal USB untuk beralih antar komputer</a></li>
<li><a href="../id467137/index.html">Memastikan operasi Tim Zextras yang andal dalam jaringan perusahaan yang kompleks</a></li>
<li><a href="../id467141/index.html">Mitapa Saint TeamLead Conf untuk topik yang lebih dalam</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>