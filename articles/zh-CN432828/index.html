<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ…°ï¸ ğŸ‘‰ğŸ¼ ğŸ’…ğŸ» æµ‹è¯•å’Œè°ƒè¯•MapReduce ğŸ’‰ ğŸ¥” ğŸ‘¨ğŸ¿â€ğŸ³</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨Rostelecomï¼Œæˆ‘ä»¬ä½¿ç”¨Hadoopæ¥å­˜å‚¨å’Œå¤„ç†ä½¿ç”¨Javaåº”ç”¨ç¨‹åºä»å¤šä¸ªæ¥æºä¸‹è½½çš„æ•°æ®ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬å·²è¿ç§»åˆ°å…·æœ‰Kerberosèº«ä»½éªŒè¯çš„hadoopçš„æ–°ç‰ˆæœ¬ã€‚ ç§»åŠ¨æ—¶ï¼Œæˆ‘é‡åˆ°äº†è®¸å¤šé—®é¢˜ï¼ŒåŒ…æ‹¬ä½¿ç”¨YARN APIã€‚ Hadoopä¸Kerberosèº«ä»½éªŒè¯çš„åˆä½œå€¼å¾—ä¸€æï¼Œä½†åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è®¨...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æµ‹è¯•å’Œè°ƒè¯•MapReduce</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rostelecom/blog/432828/">åœ¨Rostelecomï¼Œæˆ‘ä»¬ä½¿ç”¨Hadoopæ¥å­˜å‚¨å’Œå¤„ç†ä½¿ç”¨Javaåº”ç”¨ç¨‹åºä»å¤šä¸ªæ¥æºä¸‹è½½çš„æ•°æ®ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬å·²è¿ç§»åˆ°å…·æœ‰Kerberosèº«ä»½éªŒè¯çš„hadoopçš„æ–°ç‰ˆæœ¬ã€‚ ç§»åŠ¨æ—¶ï¼Œæˆ‘é‡åˆ°äº†è®¸å¤šé—®é¢˜ï¼ŒåŒ…æ‹¬ä½¿ç”¨YARN APIã€‚  Hadoopä¸Kerberosèº«ä»½éªŒè¯çš„åˆä½œå€¼å¾—ä¸€æï¼Œä½†åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºè°ƒè¯•Hadoop MapReduceã€‚ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/517/ccf/f7f/517ccff7f9688538cbffdd7ab838470e.png"><br><a name="habracut"></a><br> åœ¨é›†ç¾¤ä¸­æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œç”±äºä¸çŸ¥é“å“ªä¸ªèŠ‚ç‚¹å°†å¤„ç†è¾“å…¥æ•°æ®çš„è¿™ä¸€éƒ¨åˆ†æˆ–é‚£ä¸€éƒ¨åˆ†ï¼Œå› æ­¤å¯åŠ¨è°ƒè¯•å™¨éå¸¸å¤æ‚ï¼Œè€Œä¸”æˆ‘ä»¬æ— æ³•æå‰é…ç½®è°ƒè¯•å™¨ã€‚ <br><br> æ‚¨å¯ä»¥ä½¿ç”¨ç»è¿‡æ—¶é—´è€ƒéªŒçš„<code>System.out.println("message")</code> ã€‚ ä½†æ˜¯ï¼Œå¦‚ä½•åˆ†æåˆ†æ•£åœ¨è¿™äº›èŠ‚ç‚¹ä¸Šçš„<code>System.out.println("message")</code>çš„è¾“å‡ºå‘¢ï¼Ÿ <br><br> æˆ‘ä»¬å¯ä»¥å°†æ¶ˆæ¯è¾“å‡ºåˆ°æ ‡å‡†é”™è¯¯æµã€‚ ç”¨stdoutæˆ–stderrç¼–å†™çš„æ‰€æœ‰å†…å®¹ï¼Œ <br> å‘é€åˆ°é€‚å½“çš„æ—¥å¿—æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å¯åœ¨æ‰©å±•ä»»åŠ¡ä¿¡æ¯ç½‘é¡µæˆ–æ—¥å¿—æ–‡ä»¶ä¸­æ‰¾åˆ°ã€‚ <br><br> æˆ‘ä»¬è¿˜å¯ä»¥åœ¨ä»£ç ä¸­åŒ…å«è°ƒè¯•å·¥å…·ï¼Œæ›´æ–°ä»»åŠ¡çŠ¶æ€æ¶ˆæ¯ï¼Œå¹¶ä½¿ç”¨è‡ªå®šä¹‰è®¡æ•°å™¨æ¥å¸®åŠ©æˆ‘ä»¬äº†è§£ç¾éš¾çš„è§„æ¨¡ã€‚ <br><br> å¯ä»¥åœ¨Hadoopå·¥ä½œçš„æ‰€æœ‰ä¸‰ç§æ¨¡å¼ä¸‹è°ƒè¯•Hadoop MapReduceåº”ç”¨ç¨‹åºï¼š <br><br><ul><li> ç‹¬ç«‹çš„ <br></li><li> ä¼ªåˆ†å¸ƒå¼æ¨¡å¼ <br></li><li> å®Œå…¨åˆ†æ•£ <br></li></ul><br> æˆ‘ä»¬å°†æ›´è¯¦ç»†åœ°ä»‹ç»å‰ä¸¤ä¸ªã€‚ <br><br><h3> ä¼ªåˆ†å¸ƒå¼æ¨¡å¼ </h3><br> ä¼ªåˆ†å¸ƒå¼æ¨¡å¼ç”¨äºæ¨¡æ‹Ÿå®é™…ç¾¤é›†ã€‚ å®ƒå¯ä»¥ç”¨äºå°½å¯èƒ½æ¥è¿‘ç”Ÿäº§ç¯å¢ƒçš„æµ‹è¯•ã€‚ åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰Hadoopå®ˆæŠ¤ç¨‹åºéƒ½å°†åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œï¼ <br><br> å¦‚æœæ‚¨æœ‰å¼€å‘æœåŠ¡å™¨æˆ–å…¶ä»–æ²™ç®±ï¼ˆä¾‹å¦‚ï¼Œå…·æœ‰è‡ªå®šä¹‰å¼€å‘ç¯å¢ƒçš„è™šæ‹Ÿæœºï¼Œä¾‹å¦‚å¸¦æœ‰HDPçš„Hortonworks Sanboxï¼‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨è¿œç¨‹è°ƒè¯•å·¥å…·è°ƒè¯•æ§åˆ¶ç¨‹åºã€‚ <br><br> è¦å¼€å§‹è°ƒè¯•ï¼Œæ‚¨éœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡çš„å€¼ï¼š <code>YARN_OPTS</code> ã€‚ ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ã€‚ ä¸ºæ–¹ä¾¿èµ·è§ï¼Œæ‚¨å¯ä»¥åˆ›å»ºstartWordCount.shæ–‡ä»¶å¹¶å‘å…¶ä¸­æ·»åŠ å¿…è¦çš„å‚æ•°ä»¥å¯åŠ¨åº”ç”¨ç¨‹åºã€‚ <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash source /etc/hadoop/conf/yarn-env.sh export YARN_OPTS='-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=6000 ${YARN_OPTS}' yarn jar wordcount-0.0.1.jar ru.rtc.example.WordCount /input /output</span></span></code> </pre><br> ç°åœ¨ï¼Œè¿è¡Œè„šæœ¬<code>`./startWordCount.sh`</code> ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ä¸€æ¡æ¶ˆæ¯ <br><br><pre> <code class="plaintext hljs">Listening for transport dt_socket at address: 6000</code> </pre><br> ä»ç„¶éœ€è¦é…ç½®IDEè¿›è¡Œè¿œç¨‹è°ƒè¯•ã€‚ æˆ‘æ­£åœ¨ä½¿ç”¨intellij IDEAã€‚ è½¬åˆ°èœå•è¿è¡Œ-&gt;ç¼–è¾‘é…ç½®...æ·»åŠ æ–°çš„<code>Remote</code>é…ç½®ã€‚ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/344/574/fe7/344574fe735f992742437f5ba3660c31.png"><br><br> å°†æ–­ç‚¹è®¾ç½®ä¸ºmainå¹¶è¿è¡Œã€‚ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e8a/cc9/8f5/e8acc98f5739b25b54630170fcd3c057.png"><br><br> å°±æ˜¯è¿™æ ·ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥ç…§å¸¸è°ƒè¯•ç¨‹åºäº†ã€‚ <br><blockquote> æ³¨æ„äº‹é¡¹ æ‚¨å¿…é¡»ç¡®ä¿ä½¿ç”¨çš„æ˜¯æœ€æ–°ç‰ˆæœ¬çš„æºä»£ç ã€‚ å¦‚æœä¸æ˜¯ï¼Œåˆ™è°ƒè¯•å™¨åœæ­¢çš„è¡Œå¯èƒ½æœ‰æ‰€ä¸åŒã€‚ <br></blockquote><br> åœ¨Hadoopçš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼Œæä¾›äº†ä¸€ä¸ªç‰¹æ®Šçš„ç±»ï¼Œå®ƒä½¿æ‚¨å¯ä»¥é‡æ–°å¯åŠ¨å¤±è´¥çš„ä»»åŠ¡-IsolationRunnerã€‚ å¯¼è‡´æ•…éšœçš„æ•°æ®å·²ä¿å­˜åˆ°Hadoopç¯å¢ƒå˜é‡mapred.local.dirä¸­æŒ‡å®šçš„åœ°å€çš„ç£ç›˜ä¸Šã€‚ ä¸å¹¸çš„æ˜¯ï¼Œåœ¨æœ€æ–°ç‰ˆæœ¬çš„Hadoopä¸­ï¼Œä¸å†æä¾›æ­¤ç±»ã€‚ <br><br><h3> ç‹¬ç«‹ï¼ˆæœ¬åœ°å¯åŠ¨ï¼‰ </h3><br> ç‹¬ç«‹æ˜¯Hadoopå·¥ä½œçš„æ ‡å‡†æ¨¡å¼ã€‚ å®ƒé€‚ç”¨äºä¸ä½¿ç”¨HDFSçš„è°ƒè¯•ã€‚ é€šè¿‡è¿™ç§è°ƒè¯•ï¼Œæ‚¨å¯ä»¥é€šè¿‡æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä½¿ç”¨è¾“å…¥å’Œè¾“å‡ºã€‚ ç‹¬ç«‹æ¨¡å¼é€šå¸¸æ˜¯æœ€å¿«çš„Hadoopæ¨¡å¼ï¼Œå› ä¸ºå®ƒå°†æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿç”¨äºæ‰€æœ‰è¾“å…¥å’Œè¾“å‡ºæ•°æ®ã€‚ <br><br> å¦‚å‰æ‰€è¿°ï¼Œæ‚¨å¯ä»¥å°†è°ƒè¯•å·¥å…·æ’å…¥ä»£ç ä¸­ï¼Œä¾‹å¦‚è®¡æ•°å™¨ã€‚ è®¡æ•°å™¨ç”±Java <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æšä¸¾</a>å®šä¹‰ã€‚ æšä¸¾åç§°å®šä¹‰ç»„çš„åç§°ï¼Œè€Œæšä¸¾å­—æ®µç¡®å®šè®¡æ•°å™¨çš„åç§°ã€‚ è®¡æ•°å™¨å¯¹äºè¯„ä¼°é—®é¢˜å¾ˆæœ‰ç”¨ï¼Œ <br> å¹¶ä¸”å¯ä»¥ç”¨ä½œè°ƒè¯•è¾“å‡ºçš„è¡¥å……ã€‚ <br><br> æŸœå°çš„å£°æ˜å’Œä½¿ç”¨ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.rt.example; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.hadoop.io.IntWritable; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.hadoop.io.LongWritable; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.hadoop.io.Text; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.hadoop.mapreduce.Mapper; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Map</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Mapper</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LongWritable</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Text</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Text</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IntWritable</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Text word = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Text(); <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Word {   TOTAL_WORD_COUNT, } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">map</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(LongWritable key, Text value, Context context)</span></span></span><span class="hljs-function"> </span></span>{   String[] stringArr = value.toString().split(<span class="hljs-string"><span class="hljs-string">"\\s+"</span></span>);   <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (String str : stringArr) {     word.set(str);     context.getCounter(Word.TOTAL_WORD_COUNT).increment(<span class="hljs-number"><span class="hljs-number">1</span></span>);   } } } }</code> </pre><br> è¦é€’å¢è®¡æ•°å™¨ï¼Œè¯·ä½¿ç”¨<code>increment(1)</code>æ–¹æ³•ã€‚ <br><br><pre> <code class="java hljs">... context.getCounter(Word.TOTAL_WORD_COUNT).increment(<span class="hljs-number"><span class="hljs-number">1</span></span>); ...</code> </pre><br>  MapReduceæˆåŠŸå®Œæˆåï¼Œä»»åŠ¡å°†åœ¨æœ€åæ˜¾ç¤ºè®¡æ•°å™¨ã€‚ <br><br><pre> <code class="plaintext hljs">    Shuffle Errors           BAD_ID=0           CONNECTION=0           IO_ERROR=0           WRONG_LENGTH=0           WRONG_MAP=0           WRONG_REDUCE=0   ru.rt.example.Map$Word           TOTAL_WORD_COUNT=655</code> </pre><br> å¯ä»¥ä½¿ç”¨<code>MultipleOutputs</code>ç±»å°†é”™è¯¯çš„æ•°æ®è¾“å‡ºåˆ°stderræˆ–stdoutï¼Œæˆ–å°†è¾“å‡ºå†™åˆ°hdfsè¿›è¡Œè¿›ä¸€æ­¥åˆ†æã€‚ æ¥æ”¶åˆ°çš„æ•°æ®å¯ä»¥ä»¥ç‹¬ç«‹æ¨¡å¼æˆ–ç¼–å†™å•å…ƒæµ‹è¯•æ—¶ä¼ è¾“åˆ°åº”ç”¨ç¨‹åºçš„è¾“å…¥ã€‚ <br><br>  Hadoopå…·æœ‰MRUnitåº“ï¼Œè¯¥åº“å¯ä¸æµ‹è¯•æ¡†æ¶ï¼ˆä¾‹å¦‚JUnitï¼‰ç»“åˆä½¿ç”¨ã€‚ åœ¨ç¼–å†™å•å…ƒæµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬éªŒè¯å‡½æ•°æ˜¯å¦åœ¨è¾“å‡ºä¸­äº§ç”Ÿäº†é¢„æœŸçš„ç»“æœã€‚ æˆ‘ä»¬ä½¿ç”¨MRUnitåŒ…ä¸­çš„MapDriverç±»ï¼Œåœ¨å…¶å±æ€§ä¸­è®¾ç½®äº†æµ‹è¯•çš„ç±»ã€‚ ä¸ºæ­¤ï¼Œè¯·ä½¿ç”¨<code>withMapper()</code>æ–¹æ³•ï¼Œè¾“å…¥å€¼<code>withInputValue()</code>å’Œé¢„æœŸç»“æœ<code>withOutput()</code>æˆ–<code>withMultiOutput()</code>å¦‚æœä½¿ç”¨äº†å¤šä¸ªè¾“å‡ºï¼‰ã€‚ <br><br> è¿™æ˜¯æˆ‘ä»¬çš„æµ‹è¯•ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.rt.example; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.hadoop.io.IntWritable; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.hadoop.io.LongWritable; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.hadoop.io.Text; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.hadoop.mrunit.mapreduce.MapDriver; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.hadoop.mrunit.types.Pair; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.junit.Before; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.junit.Test; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestWordCount</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> MapDriver&lt;Object, Text, Text, IntWritable&gt; mapDriver;   <span class="hljs-meta"><span class="hljs-meta">@Before</span></span>  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setUp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{     Map mapper = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Map();     mapDriver.setMapper(mapper)  }   <span class="hljs-meta"><span class="hljs-meta">@Test</span></span>  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mapperTest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{     mapDriver.withInput(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LongWritable(<span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Text(<span class="hljs-string"><span class="hljs-string">"msg1"</span></span>));     mapDriver.withOutput(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Pair&lt;Text, IntWritable&gt;(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Text(<span class="hljs-string"><span class="hljs-string">"msg1"</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IntWritable(<span class="hljs-number"><span class="hljs-number">1</span></span>)));     mapDriver.runTest();  } }</code> </pre><br><h3> å…¨åˆ†å¸ƒå¼æ¨¡å¼ </h3><br> é¡¾åæ€ä¹‰ï¼Œè¿™æ˜¯ä¸€ç§ä½¿ç”¨Hadoopæ‰€æœ‰åŠŸèƒ½çš„æ¨¡å¼ã€‚ å¯åŠ¨çš„MapReduceç¨‹åºå¯ä»¥åœ¨1000å°æœåŠ¡å™¨ä¸Šè¿è¡Œã€‚ è°ƒè¯•MapReduceç¨‹åºæ€»æ˜¯å¾ˆå›°éš¾ï¼Œå› ä¸ºæ‚¨æœ‰åœ¨ä¸åŒè¾“å…¥æ•°æ®çš„ä¸åŒæœºå™¨ä¸Šè¿è¡Œçš„Mappersã€‚ <br><br><h2> ç»“è®º </h2><br> äº‹å®è¯æ˜ï¼Œæµ‹è¯•MapReduceå¹¶ä¸åƒä¹çœ‹èµ·æ¥é‚£æ ·å®¹æ˜“ã€‚ <br> ä¸ºäº†èŠ‚çœåœ¨MapReduceä¸­æŸ¥æ‰¾é”™è¯¯çš„æ—¶é—´ï¼Œæˆ‘ä½¿ç”¨äº†ä¸Šé¢åˆ—å‡ºçš„æ‰€æœ‰æ–¹æ³•ï¼Œå¹¶å»ºè®®æ‰€æœ‰äººä¹Ÿéƒ½ä½¿ç”¨å®ƒä»¬ã€‚ è¿™å¯¹äºå¤§å‹å®‰è£…ï¼ˆä¾‹å¦‚åœ¨Rostelecomä¸­è¿è¡Œçš„å®‰è£…ï¼‰å°¤å…¶æœ‰ç”¨ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN432828/">https://habr.com/ru/post/zh-CN432828/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN432818/index.html">è‡ªåˆ¶ç»˜å›¾ä»ªï¼šä½¿ç”¨grbl-firmwareçš„åˆå­¦è€…æç¤º</a></li>
<li><a href="../zh-CN432820/index.html">åŠ¨æ€æµ‹è¯•Androidåº”ç”¨ç¨‹åº</a></li>
<li><a href="../zh-CN432822/index.html">æˆ‘ä¸ºå¼€å‘äººå‘˜ç ´åäº†æˆ‘çš„ä¸€ç”Ÿçš„ä»£ç ï¼Œæˆ‘ä¸å†æƒ³è¦è¿™æ ·åšäº†</a></li>
<li><a href="../zh-CN432824/index.html">åŠ å¿«ConcurrentReferenceHashMapçš„åˆ›å»º</a></li>
<li><a href="../zh-CN432826/index.html">Kotlinä¸Šçš„ç°ä»£Androidå¼€å‘ã€‚ ç¬¬äºŒéƒ¨åˆ†</a></li>
<li><a href="../zh-CN432830/index.html">è‡ªåŠ¨åŒ–ç³»ç»Ÿå¯¹åºŸå¼ƒåƒåœ¾å¤„ä»¥ç½šæ¬¾</a></li>
<li><a href="../zh-CN432832/index.html">å¦‚ä½•â€œç²˜åˆâ€åŸºäºè‹±ç‰¹å°”çš„æœåŠ¡å™¨å¹¶å…‹æœ8ä¸ªå¤„ç†å™¨çš„æ‰©å±•ä¸Šé™</a></li>
<li><a href="../zh-CN432834/index.html">C ++ä¸­çš„å†…éƒ¨å’Œå¤–éƒ¨é“¾æ¥</a></li>
<li><a href="../zh-CN432836/index.html">Aliexpressçš„ç¬¬ä¸€ä¸ªä¼˜è´¨ç¯æ³¡</a></li>
<li><a href="../zh-CN432838/index.html">é€šè¿‡Milgramå®éªŒâ€œæäº¤æˆæƒâ€çš„æ£±é•œè¿›è¡Œè½¯ä»¶å¼€å‘</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>