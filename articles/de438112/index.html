<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßôüèº üëàüèº üö¢ Eine Silberkugel finden: Schauspieler + FRP in Reaktion üíÇüèº üë®üèæ‚Äçü§ù‚Äçüë®üèΩ ü§Æ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Heutzutage schreiben nur wenige Leute in Perl, aber Larry Walls ber√ºhmte Maxime "Einfache und schwierige Dinge m√∂glich halten" ist zur allgemein anerk...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Eine Silberkugel finden: Schauspieler + FRP in Reaktion</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438112/"><p>  Heutzutage schreiben nur wenige Leute in Perl, aber Larry Walls ber√ºhmte Maxime "Einfache und schwierige Dinge m√∂glich halten" ist zur allgemein anerkannten Formel f√ºr effektive Technologie geworden.  Es kann nicht nur im Hinblick auf die Komplexit√§t der Aufgaben, sondern auch auf den Ansatz interpretiert werden: Eine ideale Technologie sollte einerseits die schnelle Entwicklung mittlerer und kleiner Anwendungen (einschlie√ülich "Nur-Schreiben") erm√∂glichen und andererseits Werkzeuge f√ºr eine durchdachte Entwicklung bereitstellen komplexe Anwendungen, bei denen Zuverl√§ssigkeit, Wartbarkeit und Strukturiertheit von gr√∂√üter Bedeutung sind.  Oder sogar in die menschliche Ebene √ºbersetzen: f√ºr den Jones zug√§nglich sein und gleichzeitig die Anforderungen der Signyors erf√ºllen. </p><br><p>  Die mittlerweile beliebten Editoren k√∂nnen von beiden Seiten kritisiert werden - zumindest die Tatsache, dass das Schreiben selbst elementarer Funktionen zu vielen Zeilen f√ºhren kann, die √ºber mehrere Dateien verteilt sind -, aber wir werden nicht tief gehen, da bereits viel dar√ºber gesagt wurde. </p><br><blockquote> "Du sollst alle Tische in einem Raum und die St√ºhle in einem anderen aufbewahren." <br>  - Juha Paananen, Sch√∂pfer der Bacon.js-Bibliothek, √ºber den Herausgeber </blockquote><p>  Die Technologie, die heute diskutiert wird, ist keine Wunderwaffe, sondern behauptet, mit diesen Kriterien konsistenter zu sein. </p><a name="habracut"></a><br><p>  Mrr ist eine funktionale reaktive Bibliothek, die sich zum Prinzip "Alles ist Fluss" bekennt.  Die Hauptvorteile des funktional-reaktiven Ansatzes in mrr sind die Pr√§gnanz, die Ausdruckskraft des Codes sowie ein einheitlicher Ansatz f√ºr synchrone und asynchrone Datentransformationen. </p><br><p>  Auf den ersten Blick klingt dies nicht nach einer Technologie, die f√ºr Anf√§nger leicht zug√§nglich ist: Das Konzept eines Streams kann schwer zu verstehen sein, es ist im Front-End nicht so weit verbreitet, haupts√§chlich in Verbindung mit dummen Bibliotheken wie Rx.  Und vor allem ist nicht ganz klar, wie die Abl√§ufe auf der Grundlage des grundlegenden DOM-Schemas ‚ÄûAction-Reaction-Update DOM‚Äú zu erkl√§ren sind.  Aber ... wir werden nicht abstrakt √ºber Fl√ºsse sprechen!  Lassen Sie uns √ºber verst√§ndlichere Dinge sprechen: Ereignisse, Zustand. </p><br><h3 id="gotovim-po-receptu">  Kochen nach einem Rezept </h3><br><p>  Ohne in die Wildnis von FRP einzutauchen, folgen wir einem einfachen Schema zur Formalisierung des Themenbereichs: </p><br><ul><li>  Erstellen Sie eine Liste mit Daten, die den Status der Seite beschreiben und in der Benutzeroberfl√§che verwendet werden, sowie deren Typen. </li><li>  Erstellen Sie eine Liste der Ereignisse, die vom Benutzer auf der Seite auftreten oder generiert werden, und der Datentypen, die mit ihnen √ºbertragen werden </li><li>  Erstellen Sie eine Liste der Prozesse, die auf der Seite ausgef√ºhrt werden </li><li>  Bestimmen Sie die Abh√§ngigkeiten zwischen ihnen. </li><li>  Beschreiben Sie die Abh√§ngigkeiten mithilfe geeigneter Operatoren. </li></ul><br><p>  Gleichzeitig ben√∂tigen wir erst in der letzten Phase Kenntnisse der Bibliothek. </p><br><p>  Nehmen wir also ein vereinfachtes Beispiel eines Webshops, in dem eine Liste von Produkten mit Paginierung und Filterung nach Kategorien sowie ein Warenkorb vorhanden sind. </p><br><ol><li><p>  Daten, auf deren Grundlage die Schnittstelle aufgebaut wird: </p><br><ul><li>  Warenliste (Array) </li><li>  ausgew√§hlte Kategorie (Linie) </li><li>  Anzahl der Seiten mit Waren (Anzahl) </li><li>  Liste der Produkte, die sich im Warenkorb befinden (Array) </li><li>  aktuelle Seite (Nummer) </li><li>  die Anzahl der Produkte im Warenkorb (Anzahl) </li></ul><br></li><li><p>  Ereignisse (mit "Ereignissen" sind nur momentane Ereignisse gemeint. Aktionen, die f√ºr eine Weile stattfinden - Prozesse - m√ºssen in separate Ereignisse zerlegt werden): </p><br><ul><li>  Er√∂ffnungsseite (nichtig) </li><li>  Kategorieauswahl (Zeichenfolge) </li><li>  Waren in den Warenkorb legen (Objekt "Waren") </li><li>  Entnahme von Waren aus dem Warenkorb (ID der zu l√∂schenden Waren) </li><li>  Gehen Sie zur n√§chsten Seite der Produktliste (Nummer - Seitenzahl). </li></ul><br></li><li><p>  Prozesse: Dies sind Aktionen, die mit verschiedenen Ereignissen gleichzeitig oder nach einiger Zeit beginnen und dann enden k√∂nnen.  In unserem Fall ist dies das Laden von Produktdaten vom Server, was zwei Ereignisse zur Folge haben kann: erfolgreicher Abschluss und Abschluss mit einem Fehler. </p><br></li><li><p>  Abh√§ngigkeiten zwischen Ereignissen und Daten.  Beispielsweise h√§ngt die Produktliste vom Ereignis ab: "Erfolgreiches Laden der Produktliste".  Und "Starten Sie das Laden der Warenliste" - von "√ñffnen der Seite", "Ausw√§hlen der aktuellen Seite", "Ausw√§hlen einer Kategorie".  Erstellen Sie eine Liste der Form [Element]: [... Abh√§ngigkeiten]: </p><br><pre><code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">requestGoods</span></span>: [<span class="hljs-string"><span class="hljs-string">'page'</span></span>, <span class="hljs-string"><span class="hljs-string">'category'</span></span>, <span class="hljs-string"><span class="hljs-string">'pageLoaded'</span></span>], <span class="hljs-attr"><span class="hljs-attr">goods</span></span>: [<span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>], <span class="hljs-attr"><span class="hljs-attr">page</span></span>: [<span class="hljs-string"><span class="hljs-string">'goToPage'</span></span>, <span class="hljs-string"><span class="hljs-string">'totalPages'</span></span>], <span class="hljs-attr"><span class="hljs-attr">totalPages</span></span>: [<span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>], <span class="hljs-attr"><span class="hljs-attr">cart</span></span>: [<span class="hljs-string"><span class="hljs-string">'addToCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'removeFromCart'</span></span>], <span class="hljs-attr"><span class="hljs-attr">goodsInCart</span></span>: [<span class="hljs-string"><span class="hljs-string">'cart'</span></span>], <span class="hljs-attr"><span class="hljs-attr">category</span></span>: [<span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>] }</code> </pre> <br></li></ol><br><p>  Oh ... aber das ist fast der Code f√ºr mrr! </p><br><p><img src="https://habrastorage.org/webt/_x/jg/s7/_xjgs7dbqnztuaffvtgm96auncm.png"></p><br><p>  Es m√ºssen nur noch Funktionen hinzugef√ºgt werden, die die Beziehung beschreiben.  M√∂glicherweise haben Sie erwartet, dass Ereignisse, Daten und Prozesse in mrr unterschiedliche Entit√§ten sind - aber nein, all dies sind Threads!  Unsere Aufgabe ist es, sie richtig zu verbinden. </p><br><p>  Wie Sie sehen k√∂nnen, gibt es zwei Arten von Abh√§ngigkeiten: "Daten" aus dem "Ereignis" (z. B. Seite aus goToPage) und "Daten" aus den "Daten" (Wareneintrag aus dem Warenkorb).  F√ºr jeden von ihnen gibt es geeignete Ans√§tze. </p><br><p>  Am einfachsten geht es mit "Daten aus Daten": Hier f√ºgen wir einfach eine reine Funktion hinzu, die "Formel": </p><br><pre> <code class="javascript hljs">goodsInCart: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">arr</span></span></span><span class="hljs-function"> =&gt;</span></span> arr.length, <span class="hljs-string"><span class="hljs-string">'cart'</span></span>],</code> </pre> <br><p>  Jedes Mal, wenn das Warenkorb-Array ge√§ndert wird, wird der Wert von GoodsInCart neu gez√§hlt. </p><br><p>  Wenn unsere Daten von einem Ereignis abh√§ngen, ist auch alles ganz einfach: </p><br><pre> <code class="javascript hljs">category: <span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>, <span class="hljs-comment"><span class="hljs-comment">/*     category: [a =&gt; a, 'selectCategory'], */</span></span> goods: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resp</span></span></span><span class="hljs-function"> =&gt;</span></span> resp.data, <span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>], <span class="hljs-attr"><span class="hljs-attr">totalPages</span></span>: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resp</span></span></span><span class="hljs-function"> =&gt;</span></span> resp.totalPages, <span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>],</code> </pre> <br><p>  Das Design der Form [Funktion, ... Thread-Argumente] ist die Basis von mrr.  Zum intuitiven Verst√§ndnis einer Analogie mit Excel werden Fl√ºsse in mrr auch als Zellen bezeichnet, und die Funktionen, mit denen sie berechnet werden, werden als Formeln bezeichnet. </p><br><p>  Wenn unsere Daten von mehreren Ereignissen abh√§ngen, m√ºssen wir ihre Werte einzeln transformieren und sie dann mit dem Zusammenf√ºhrungsoperator zu einem Stream kombinieren: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* ,  merge -  ,   */</span></span> page: [<span class="hljs-string"><span class="hljs-string">'merge'</span></span>, [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a</span></span></span><span class="hljs-function"> =&gt;</span></span> a, <span class="hljs-string"><span class="hljs-string">'goToPage'</span></span>], [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, prev</span></span></span><span class="hljs-function">) =&gt;</span></span> a &lt; prev ? a : prev, <span class="hljs-string"><span class="hljs-string">'totalPages'</span></span>, <span class="hljs-string"><span class="hljs-string">'-page'</span></span>] ], <span class="hljs-attr"><span class="hljs-attr">cart</span></span>: [<span class="hljs-string"><span class="hljs-string">'merge'</span></span>, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item, arr</span></span></span><span class="hljs-function">) =&gt;</span></span> [...arr, item], <span class="hljs-string"><span class="hljs-string">'addToCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'-cart'</span></span>], [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id, arr</span></span></span><span class="hljs-function">) =&gt;</span></span> arr.filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> item.id !== id), <span class="hljs-string"><span class="hljs-string">'removeFromCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'-cart'</span></span>], ],</code> </pre> <br><p>  In beiden F√§llen beziehen wir uns auf den vorherigen Wert der Zelle.  Um eine Endlosschleife zu verhindern, verweisen wir <em>passiv</em> auf die Warenkorb- und <em>Seitenzellen</em> (Minuszeichen vor dem Zellennamen): Ihre Werte werden in die Formel eingesetzt, aber wenn sie sich √§ndern, wird die Neuberechnung nicht gestartet. </p><br><p>  Alle Threads werden entweder auf der Basis anderer Threads erstellt oder vom DOM ausgegeben.  Aber was ist mit dem Stream "Er√∂ffnungsseite"?  Gl√ºcklicherweise m√ºssen Sie componentDidMount nicht verwenden: In mrr gibt es einen speziellen Stream $ start, der signalisiert, dass die Komponente erstellt und gemountet wurde. </p><br><p>  "Prozesse" werden asynchron berechnet, w√§hrend wir bestimmte Ereignisse von ihnen ausgeben. Der "verschachtelte" Operator hilft uns hier: </p><br><pre> <code class="javascript hljs">requestGoods: [<span class="hljs-string"><span class="hljs-string">'nested'</span></span>, (cb, page, category) =&gt; { fetch(<span class="hljs-string"><span class="hljs-string">"..."</span></span>) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'success'</span></span>, res)) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'error'</span></span>, e)); }, <span class="hljs-string"><span class="hljs-string">'page'</span></span>, <span class="hljs-string"><span class="hljs-string">'category'</span></span>, <span class="hljs-string"><span class="hljs-string">'$start'</span></span>],</code> </pre> <br><p>  Bei Verwendung des verschachtelten Operators wird dem ersten Argument eine R√ºckruffunktion f√ºr die Emission bestimmter Ereignisse √ºbergeben.  In diesem Fall sind sie von au√üen √ºber den Namespace der Stammzelle zug√§nglich, z. </p><br><pre> <code class="javascript hljs">cb(<span class="hljs-string"><span class="hljs-string">'success'</span></span>, res)</code> </pre> <br><p>  Innerhalb der requestGoods-Formel wird die Aktualisierung der requestGoods.success-Zelle durchgef√ºhrt. </p><br><p>  Um die Seite korrekt zu rendern, bevor unsere Daten berechnet werden, k√∂nnen Sie ihre Anfangswerte angeben: </p><br><pre> <code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">goods</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">page</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">cart</span></span>: [], },</code> </pre> <br><p>  Markup hinzuf√ºgen.  Wir erstellen eine React-Komponente mit der withMrr-Funktion, die ein reaktives Verkn√ºpfungsdiagramm und eine Renderfunktion akzeptiert.  Um einen Wert in einen Stream zu "setzen", verwenden wir die $ -Funktion, die Ereignishandler erstellt (und zwischenspeichert).  Jetzt sieht unsere voll funktionsf√§hige Anwendung folgenderma√üen aus: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withMrr } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mrr'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> App = withMrr({ <span class="hljs-attr"><span class="hljs-attr">$init</span></span>: { <span class="hljs-attr"><span class="hljs-attr">goods</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">cart</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">page</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">requestGoods</span></span>: [<span class="hljs-string"><span class="hljs-string">'nested'</span></span>, (cb, page = <span class="hljs-number"><span class="hljs-number">1</span></span>, category = <span class="hljs-string"><span class="hljs-string">'all'</span></span>) =&gt; { fetch(<span class="hljs-string"><span class="hljs-string">'https://reqres.in/api/products?page='</span></span>, page, category).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.json()) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'success'</span></span>, res)) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'error'</span></span>, e)) }, <span class="hljs-string"><span class="hljs-string">'page'</span></span>, <span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>, <span class="hljs-string"><span class="hljs-string">'$start'</span></span>], <span class="hljs-attr"><span class="hljs-attr">goods</span></span>: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.data, <span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>], <span class="hljs-attr"><span class="hljs-attr">page</span></span>: [<span class="hljs-string"><span class="hljs-string">'merge'</span></span>, <span class="hljs-string"><span class="hljs-string">'goToPage'</span></span>, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, prev</span></span></span><span class="hljs-function">) =&gt;</span></span> a &lt; prev ? a : prev, <span class="hljs-string"><span class="hljs-string">'totalPages'</span></span>, <span class="hljs-string"><span class="hljs-string">'-page'</span></span>]], <span class="hljs-attr"><span class="hljs-attr">totalPages</span></span>: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.total_pages, <span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>], <span class="hljs-attr"><span class="hljs-attr">category</span></span>: <span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>, <span class="hljs-attr"><span class="hljs-attr">cart</span></span>: [<span class="hljs-string"><span class="hljs-string">'merge'</span></span>, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item, arr</span></span></span><span class="hljs-function">) =&gt;</span></span> [...arr, item], <span class="hljs-string"><span class="hljs-string">'addToCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'-cart'</span></span>], [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id, arr</span></span></span><span class="hljs-function">) =&gt;</span></span> arr.filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> item.id !== id), <span class="hljs-string"><span class="hljs-string">'removeFromCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'-cart'</span></span>], ], }, (state, props, $) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">&lt;section&gt; &lt;h2&gt;Shop&lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/h2&gt; &lt;div&gt; Category: &lt;select onChange={$('selectCategory')}&gt; &lt;option&gt;All&lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">option&gt; &lt;option&gt;Electronics&lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/option&gt; &lt;option&gt;Photo&lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">option&gt; &lt;option&gt;Cars&lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/option&gt; &lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">select&gt; &lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/div&gt; &lt;ul className="goods"&gt; { state.goods.map((item, i) =&gt; { const cartI = state.cart.findIndex(a =&gt; a.id === item.id); return (&lt;li key={i}&gt; { item.name } &lt;div&gt; { cartI === -1 &amp;&amp; &lt;button onClick={$("addToCart", item)}&gt;Add to cart&lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">button&gt; } { cartI !== </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-1</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &amp;&amp; &lt;button onClick={$(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"removeFromCart"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, item.id</span></span></span><span class="hljs-function">)}&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Remove</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">from</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cart</span></span></span><span class="hljs-function">&lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">button</span></span></span><span class="hljs-function">&gt; } &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">div</span></span></span><span class="hljs-function">&gt; &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">li</span></span></span><span class="hljs-function">&gt;); }) } &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ul</span></span></span><span class="hljs-function">&gt; &lt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ul</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">className</span></span></span><span class="hljs-function">="</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">pages</span></span></span><span class="hljs-function">"&gt; { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">new</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Array</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state.totalPages</span></span></span><span class="hljs-function">).</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fill</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span></span><span class="hljs-function">).</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">map</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_, p</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> page = <span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>(p) + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;li className=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"page"</span></span></span></span><span class="hljs-function"><span class="hljs-params"> onClick={$(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'goToPage'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, page</span></span></span><span class="hljs-function">)} </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">key</span></span></span><span class="hljs-function">={</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">p</span></span></span><span class="hljs-function">}&gt; { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">page</span></span></span><span class="hljs-function"> } &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">li</span></span></span><span class="hljs-function">&gt; ); }) } &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ul</span></span></span><span class="hljs-function">&gt; &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">section</span></span></span><span class="hljs-function">&gt; &lt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">section</span></span></span><span class="hljs-function">&gt; &lt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">h2</span></span></span><span class="hljs-function">&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Cart</span></span></span><span class="hljs-function">&lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">h2</span></span></span><span class="hljs-function">&gt; &lt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ul</span></span></span><span class="hljs-function">&gt; { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cart</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">map</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(item, i</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{i}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> { item.name } </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{$(</span></span></span></span><span class="xml"><span class="hljs-tag">"</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">removeFromCart</span></span></span></span><span class="xml"><span class="hljs-tag">", </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">item.id</span></span></span></span><span class="xml"><span class="hljs-tag">)}&gt;</span></span></span><span class="xml">Remove from cart</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>); }) } &lt;<span class="hljs-regexp"><span class="hljs-regexp">/ul&gt; &lt;/</span></span>section&gt;); }); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> App;</code> </pre><br><p>  Bau </p><br><pre> <code class="javascript hljs">&lt;select onChange={$(<span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>)}&gt;</code> </pre> <br><p>  bedeutet, dass beim √Ñndern des Felds der Wert in den selectCategory-Stream "verschoben" wird.  Aber was ist die Bedeutung?  Standardm√§√üig ist dies event.target.value, aber wenn wir etwas anderes pushen m√ºssen, geben wir es mit dem zweiten Argument an, wie hier: </p><br><pre> <code class="javascript hljs">&lt;button onClick={$(<span class="hljs-string"><span class="hljs-string">"addToCart"</span></span>, item)}&gt;</code> </pre> <br><p>  Alles hier - Ereignisse, Daten und Prozesse - das sind Fl√ºsse.  Das Ausl√∂sen eines Ereignisses f√ºhrt zu einer Neuberechnung von Daten oder Ereignissen in Abh√§ngigkeit davon usw. entlang der Kette.  Der Wert des abh√§ngigen Streams wird mithilfe einer Formel berechnet, die einen Wert oder ein Versprechen zur√ºckgeben kann (dann wartet mrr auf seine Aufl√∂sung). </p><br><p>  Die mrr-API ist sehr pr√§zise und pr√§gnant - in den meisten F√§llen ben√∂tigen wir nur 3-4 grundlegende Operatoren, und viele Dinge k√∂nnen ohne sie ausgef√ºhrt werden.  F√ºgen Sie eine Fehlermeldung hinzu, wenn die Liste der Produkte nicht erfolgreich geladen wurde. Diese wird eine Sekunde lang angezeigt: </p><br><pre> <code class="javascript hljs">hideErrorMessage: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> setTimeout(res, <span class="hljs-number"><span class="hljs-number">1000</span></span>)), <span class="hljs-string"><span class="hljs-string">'requestGoods.error'</span></span>], <span class="hljs-attr"><span class="hljs-attr">errorMessageShown</span></span>: [ <span class="hljs-string"><span class="hljs-string">'merge'</span></span>, [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">'requestGoods.error'</span></span>], [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">'hideErrorMessage'</span></span>], ],</code> </pre> <br><h3 id="sol-perec-sahar---po-vkusu"><del>  Salz, Pfeffer </del>  Zucker nach Geschmack </h3><br><p>  Es gibt auch syntaktischen Zucker in mrr, der f√ºr die Entwicklung optional ist, ihn aber beschleunigen kann.  Zum Beispiel der Umschaltoperator: </p><br><pre> <code class="javascript hljs">errorMessageShown: [<span class="hljs-string"><span class="hljs-string">'toggle'</span></span>, <span class="hljs-string"><span class="hljs-string">'requestGoods.error'</span></span>, [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> setTimeout(res, <span class="hljs-number"><span class="hljs-number">1000</span></span>)), <span class="hljs-string"><span class="hljs-string">'showErrorMessage'</span></span>]],</code> </pre> <br><p>  Eine √Ñnderung im ersten Argument setzt die Zelle auf true und im zweiten auf false. <br>  Der Ansatz, die Ergebnisse einer asynchronen Aufgabe in Erfolgs- und Fehlerunterzellen zu "zerlegen", ist ebenfalls so weit verbreitet, dass Sie den speziellen Versprechungsoperator verwenden k√∂nnen (der die Rennbedingung automatisch beseitigt): </p><br><pre> <code class="javascript hljs"> requestGoods: [ <span class="hljs-string"><span class="hljs-string">'promise'</span></span>, (page = <span class="hljs-number"><span class="hljs-number">1</span></span>, category = <span class="hljs-string"><span class="hljs-string">'all'</span></span>) =&gt; fetch(<span class="hljs-string"><span class="hljs-string">'https://reqres.in/api/products?page='</span></span>, page, category).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.json()), <span class="hljs-string"><span class="hljs-string">'page'</span></span>, <span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>, <span class="hljs-string"><span class="hljs-string">'$start'</span></span> ],</code> </pre> <br><p>  Viele Funktionen passen in nur ein paar Dutzend Zeilen.  Unser bedingter Juni ist zufrieden - er hat es geschafft, Arbeitscode zu schreiben, der sich als ziemlich kompakt herausstellte: Die gesamte Logik passte in eine Datei und auf einen Bildschirm.  Aber der Unterzeichner blinzelt ungl√§ubig: Eka ist unsichtbar ... Sie k√∂nnen dies auf Hooks schreiben / neu komponieren / etc. </p><br><p>  Ja, tats√§chlich ist es das!  Es ist nat√ºrlich unwahrscheinlich, dass der Code noch kompakter und strukturierter ist, aber darum geht es nicht.  Stellen wir uns vor, das Projekt entwickelt sich und wir m√ºssen die Funktionalit√§t in zwei separate Seiten aufteilen: eine Produktliste und einen Warenkorb.  Dar√ºber hinaus m√ºssen die Warenkorbdaten nat√ºrlich f√ºr beide Seiten global gespeichert werden. </p><br><h3 id="odin-podhod-odin-interfeys">  Ein Ansatz, eine Schnittstelle </h3><br><p>  Hier kommen wir zu einem weiteren Problem der Reaktionsentwicklung: der Existenz heterogener Ans√§tze zur Verwaltung des Zustands lokal (innerhalb einer Komponente) und global auf der Ebene der gesamten Anwendung.  Ich bin sicher, viele standen vor einem Dilemma: eine Logik lokal oder global zu implementieren?  Oder eine andere Situation: Es stellte sich heraus, dass einige lokale Daten global gespeichert werden m√ºssen und Sie einen Teil der Funktionalit√§t neu schreiben m√ºssen, z. B. von Neuzusammenstellungen bis zum Editor ... </p><br><p>  Der Kontrast ist nat√ºrlich k√ºnstlich und in mrr nicht: es ist gleich gut und vor allem - einheitlich!  - Geeignet f√ºr lokales und globales Staatsmanagement.  Im Allgemeinen ben√∂tigen wir keinen globalen Status. Wir k√∂nnen lediglich Daten zwischen den Komponenten austauschen, sodass der Status der Stammkomponente "global" ist. </p><br><p>  Das Schema unserer Anwendung lautet nun wie folgt: Die Stammkomponente, die die Liste der Waren im Warenkorb enth√§lt, und zwei Unterkomponenten: die Waren und der Warenkorb, und die globale Komponente "lauscht" den Fl√ºssen "In den Warenkorb hinzuf√ºgen" und "Aus dem Warenkorb entfernen" aus untergeordneten Komponenten. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> App = withMrr({ <span class="hljs-attr"><span class="hljs-attr">$init</span></span>: { <span class="hljs-attr"><span class="hljs-attr">cart</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">currentPage</span></span>: <span class="hljs-string"><span class="hljs-string">'goods'</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">cart</span></span>: [<span class="hljs-string"><span class="hljs-string">'merge'</span></span>, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item, arr</span></span></span><span class="hljs-function">) =&gt;</span></span> [...arr, item], <span class="hljs-string"><span class="hljs-string">'addToCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'-cart'</span></span>], [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id, arr</span></span></span><span class="hljs-function">) =&gt;</span></span> arr.filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> item.id !== id), <span class="hljs-string"><span class="hljs-string">'removeFromCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'-cart'</span></span>], ], }, (state, props, $, connectAs) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;div&gt; &lt;menu&gt; &lt;li onClick={$('currentPage', 'goods')}&gt;Goods&lt;/li&gt; &lt;li onClick={$('currentPage', 'cart')}&gt;Cart{ state.cart &amp;&amp; state.cart.length ? '(' + state.cart.length + ')' : '' }&lt;/li&gt; &lt;/menu&gt; &lt;div&gt; { state.currentPage === 'goods' &amp;&amp; &lt;Goods {...connectAs('goods', ['addToCart', 'removeFromCart'], ['cart'])}/&gt; } { state.currentPage === 'cart' &amp;&amp; &lt;Cart {...connectAs('cart', { 'removeFromCart': 'remove' }, ['cart'])}/&gt; } &lt;/div&gt; &lt;/div&gt; ); })</code> </pre> <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Goods = withMrr({ <span class="hljs-attr"><span class="hljs-attr">$init</span></span>: { <span class="hljs-attr"><span class="hljs-attr">goods</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">page</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">goods</span></span>: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.data, <span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>], <span class="hljs-attr"><span class="hljs-attr">requestGoods</span></span>: [ <span class="hljs-string"><span class="hljs-string">'promise'</span></span>, (page = <span class="hljs-number"><span class="hljs-number">1</span></span>, category = <span class="hljs-string"><span class="hljs-string">'all'</span></span>) =&gt; fetch(<span class="hljs-string"><span class="hljs-string">'https://reqres.in/api/products?page='</span></span>, page, category).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.json()), <span class="hljs-string"><span class="hljs-string">'page'</span></span>, <span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>, <span class="hljs-string"><span class="hljs-string">'$start'</span></span> ], <span class="hljs-attr"><span class="hljs-attr">page</span></span>: [<span class="hljs-string"><span class="hljs-string">'merge'</span></span>, <span class="hljs-string"><span class="hljs-string">'goToPage'</span></span>, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, prev</span></span></span><span class="hljs-function">) =&gt;</span></span> a &lt; prev ? a : prev, <span class="hljs-string"><span class="hljs-string">'totalPages'</span></span>, <span class="hljs-string"><span class="hljs-string">'-page'</span></span>]], <span class="hljs-attr"><span class="hljs-attr">totalPages</span></span>: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.total, <span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>], <span class="hljs-attr"><span class="hljs-attr">category</span></span>: <span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>, <span class="hljs-attr"><span class="hljs-attr">errorShown</span></span>: [<span class="hljs-string"><span class="hljs-string">'toggle'</span></span>, <span class="hljs-string"><span class="hljs-string">'requestGoods.error'</span></span>, [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> setTimeout(res, <span class="hljs-number"><span class="hljs-number">1000</span></span>)), <span class="hljs-string"><span class="hljs-string">'requestGoods.error'</span></span>]], }, (state, props, $) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ... </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>); });</code> </pre><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Cart = withMrr({}, (state, props, $) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">&lt;div&gt; &lt;h2&gt;Cart&lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/h2&gt; &lt;ul&gt; { state.cart.map((item, i) =&gt; { return (&lt;div&gt; { item.name } &lt;div&gt; &lt;button onClick={$('remove', item.id)}&gt;Remove from cart&lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">button&gt; &lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/div&gt; &lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">div&gt;</span></span></span><span class="hljs-function">); }) } &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ul</span></span></span><span class="hljs-function">&gt; &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">div</span></span></span><span class="hljs-function">&gt;); });</span></span></code> </pre><br><p>  Es ist erstaunlich, wie wenig sich ge√§ndert hat!  Wir haben einfach die Str√∂me in die entsprechenden Komponenten ausgelegt und ‚ÄûBr√ºcken‚Äú zwischen ihnen gelegt!  Durch Verbinden der Komponenten mit der Funktion mrrConnect legen wir die Zuordnung f√ºr Downstream- und Upstream-Flows fest: </p><br><pre> <code class="javascript hljs">connectAs( <span class="hljs-string"><span class="hljs-string">'goods'</span></span>, <span class="hljs-comment"><span class="hljs-comment">/*  */</span></span> [<span class="hljs-string"><span class="hljs-string">'addToCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'removeFromCart'</span></span>], <span class="hljs-comment"><span class="hljs-comment">/*  */</span></span> [<span class="hljs-string"><span class="hljs-string">'cart'</span></span>] )</code> </pre> <br><p>  Hier werden die Streams addToCart und removeFromCart aus der untergeordneten Komponente an die √ºbergeordnete Komponente gesendet, und der Warenkorb-Stream wird zur√ºckgegeben.  Es ist nicht erforderlich, dieselben Stream-Namen zu verwenden. Wenn diese nicht √ºbereinstimmen, verwenden wir die Zuordnung: </p><br><pre> <code class="javascript hljs">connectAs(<span class="hljs-string"><span class="hljs-string">'cart'</span></span>, { <span class="hljs-string"><span class="hljs-string">'removeFromCart'</span></span>: <span class="hljs-string"><span class="hljs-string">'remove'</span></span> })</code> </pre> <br><p>  Der Stream zum Entfernen aus der untergeordneten Komponente ist die Quelle f√ºr den Stream "removeFromCart" im √ºbergeordneten Stream. </p><br><p>  Wie Sie sehen, ist das Problem der Auswahl eines Datenspeicherorts bei mrr vollst√§ndig beseitigt: Sie speichern Daten dort, wo sie logisch bestimmt sind. </p><br><p>  Auch hier kann man den Nachteil des Editors nicht √ºbersehen: darin m√ºssen Sie alle Daten in einem einzigen zentralen Repository speichern.  Sogar die Daten, die nur von einer separaten Komponente oder ihrem Teilbaum angefordert und verwendet werden d√ºrfen!  Wenn wir im "redaktionellen Stil" schreiben w√ºrden, w√ºrden wir auch das Laden und Paginieren von Waren auf die globale Ebene bringen (fairerweise ist dieser Ansatz dank der Flexibilit√§t von mrr auch m√∂glich und hat das Recht auf Leben, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quellcode</a> ). </p><br><p>  Dies ist jedoch nicht erforderlich.  Die geladenen Waren werden nur in der Komponente der Waren verwendet. Wenn wir sie auf die globale Ebene bringen, verstopfen wir nur den globalen Zustand und blasen ihn auf.  Au√üerdem m√ºssen wir veraltete Daten (z. B. eine Paginierungsseite) l√∂schen, wenn der Benutzer wieder zur Produktseite zur√ºckkehrt.  Durch die Auswahl der richtigen Datenspeicherebene vermeiden wir solche Probleme automatisch. </p><br><p>  Ein weiterer Vorteil dieses Ansatzes besteht darin, dass die Anwendungslogik mit der Pr√§sentation kombiniert wird, sodass wir einzelne React-Komponenten als voll funktionsf√§hige Widgets und nicht als ‚Äûdumme‚Äú Vorlagen wiederverwenden k√∂nnen.  Indem wir ein Minimum an Informationen auf globaler Ebene halten (im Idealfall sind dies nur Sitzungsdaten) und den gr√∂√üten Teil der Logik in separate Seitenkomponenten zerlegen, verringern wir die Koh√§renz des Codes erheblich.  Nat√ºrlich ist dieser Ansatz nicht immer anwendbar, aber es gibt eine gro√üe Anzahl von Aufgaben, bei denen der globale Zustand extrem klein ist und die einzelnen ‚ÄûBildschirme‚Äú fast v√∂llig unabh√§ngig voneinander sind: zum Beispiel verschiedene Arten von Administratoren usw.  Im Gegensatz zum Editor, der uns dazu bringt, alles, was ben√∂tigt und nicht ben√∂tigt wird, auf die globale Ebene zu bringen, k√∂nnen Sie mit mrr Daten in separaten Teilb√§umen speichern, die Kapselung f√∂rdern und erm√∂glichen und so unsere Anwendung von einem monolithischen "Kuchen" in einen geschichteten "Kuchen" verwandeln. </p><br><p>  Erw√§hnenswert ist nat√ºrlich, dass der vorgeschlagene Ansatz nichts Revolution√§res enth√§lt!  Komponenten, in sich geschlossene Widgets, sind seit dem Aufkommen von js Frameworks einer der grundlegenden Ans√§tze.  Der einzige signifikante Unterschied besteht darin, dass mrr dem deklarativen Prinzip folgt: Komponenten k√∂nnen nur auf die Fl√ºsse anderer Komponenten h√∂ren, diese aber nicht beeinflussen (was muss sie von unten nach oben oder von oben nach unten tun, was sich vom Fluss unterscheidet? Ansatz).  Intelligente Komponenten, die nur Nachrichten mit den zugrunde liegenden und √ºbergeordneten Komponenten austauschen k√∂nnen, entsprechen dem beliebten, aber wenig bekannten Akteurmodell in der Front-End-Entwicklung (das Thema der Verwendung von Akteuren und Threads im Front-End wird im Artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Einf√ºhrung in die reaktive Programmierung ausf√ºhrlich behandelt</a> ). <br>  Dies ist nat√ºrlich weit entfernt von der kanonischen Implementierung von Akteuren, aber das Wesentliche ist genau das: Die Rolle von Akteuren wird von Komponenten gespielt, die Nachrichten √ºber MPP-Streams austauschen.  Eine Komponente kann (deklarativ!) dank des virtuellen DOM und React untergeordnete Komponentenakteure erstellen und l√∂schen: Die Renderfunktion bestimmt im Wesentlichen die Struktur untergeordneter Akteure. </p><br><p>  Anstelle der Standardsituation f√ºr die Reaktion sollten wir, wenn wir die √ºbergeordnete Komponente √ºber Requisiten in einen bestimmten R√ºckruf "fallen lassen", den Fluss der untergeordneten Komponente vom √ºbergeordneten Element abh√∂ren.  Das Gleiche ist in die entgegengesetzte Richtung, von Eltern zu Kind.  Zum Beispiel k√∂nnten Sie fragen: Warum die Warenkorbdaten als Stream an die Warenkorbkomponente √ºbertragen, wenn wir sie ohne weiteres einfach als Requisiten √ºbergeben k√∂nnen?  Was ist der Unterschied?  In der Tat kann dieser Ansatz auch verwendet werden, jedoch nur, bis auf √Ñnderungen an den Requisiten reagiert werden muss.  Wenn Sie jemals die componentWillReceiveProps-Methode verwendet haben, wissen Sie, worum es geht.  Dies ist eine Art "Reaktivit√§t f√ºr die Armen": Sie h√∂ren absolut alle √Ñnderungen der Requisiten, bestimmen, was sich ge√§ndert hat, und reagieren.  Diese Methode wird jedoch bald aus React verschwinden, und es kann die Notwendigkeit einer Reaktion auf "Signale von oben" entstehen. </p><br><p>  In mrr ‚Äûflie√üt‚Äú nicht nur die Komponentenhierarchie nach oben, sondern auch nach unten, sodass die Komponenten unabh√§ngig auf Status√§nderungen reagieren k√∂nnen.  Auf diese Weise k√∂nnen Sie die volle Leistung von mrr jet tools nutzen. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Cart = withMrr({ <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">items</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">// -  }, 'cart'], }, (state, props, $) =&gt; { ... })</span></span></code> </pre> <br><h3 id="dobavlyaem-nemnozhko-byurokratii">  F√ºgen Sie ein wenig B√ºrokratie hinzu </h3><br><p>  Das Projekt w√§chst, es wird schwierig, die Namen der Fl√ºsse im Auge zu behalten, die - oh, Horror!  - werden in Zeilen gespeichert.  Nun, wir k√∂nnen Konstanten sowohl f√ºr Stream-Namen als auch f√ºr mrr-Anweisungen verwenden.  Jetzt wird es schwieriger, eine Anwendung durch einen kleinen Tippfehler zu brechen. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withMrr } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mrr'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { merge, toggle, promise } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mrr/operators'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { cell, nested, $start$, passive } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mrr/cell'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> goods$ = cell(<span class="hljs-string"><span class="hljs-string">'goods'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> page$ = cell(<span class="hljs-string"><span class="hljs-string">'page'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> totalPages$ = cell(<span class="hljs-string"><span class="hljs-string">'totalPages'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> category$ = cell(<span class="hljs-string"><span class="hljs-string">'category'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> errorShown$ = cell(<span class="hljs-string"><span class="hljs-string">'errorShown'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> addToCart$ = cell(<span class="hljs-string"><span class="hljs-string">'addToCart'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> removeFromCart$ = cell(<span class="hljs-string"><span class="hljs-string">'removeFromCart'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> selectCategory$ = cell(<span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> goToPage$ = cell(<span class="hljs-string"><span class="hljs-string">'goToPage'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Goods = withMrr({ <span class="hljs-attr"><span class="hljs-attr">$init</span></span>: { [goods$]: [], [page$]: <span class="hljs-number"><span class="hljs-number">1</span></span>, }, [goods$]: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.data, requestGoods$.success], [requestGoods$]: promise(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">page, category</span></span></span><span class="hljs-function">) =&gt;</span></span> fetch(<span class="hljs-string"><span class="hljs-string">'https://reqres.in/api/products?page='</span></span>, page).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.json()), page$, category$, $start$), [page$]: merge(goToPage$, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, prev</span></span></span><span class="hljs-function">) =&gt;</span></span> a &lt; prev ? a : prev, totalPages$, passive(page$)]), [totalPages$]: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.total, requestGoods$.success], [category$]: selectCategory$, [errorShown$]: toggle(requestGoods$.error, [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> setTimeout(res, <span class="hljs-number"><span class="hljs-number">1000</span></span>)), requestGoods$.error]), }, ...);</code> </pre><br><h3 id="chto-v-chernom-yaschike">  Was ist in der Black Box? </h3><br><p>  Was ist mit Testen?  Die in der mrr-Komponente beschriebene Logik l√§sst sich leicht von der Vorlage trennen und anschlie√üend testen. </p><br><p>  Lassen Sie uns die mrr-Struktur getrennt von unserer Datei erstellen. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> GoodsStruct = { <span class="hljs-attr"><span class="hljs-attr">$init</span></span>: { [goods$]: [], [page$]: <span class="hljs-number"><span class="hljs-number">1</span></span>, }, ... } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Goods = withMrr(GoodsStruct, (state, props, $) =&gt; { ... }); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> { GoodsStruct }</code> </pre><br><p>  und dann importieren wir es in unseren Tests.  Mit einem einfachen Wrapper k√∂nnen wir <br>  F√ºgen Sie den Wert in den Stream ein (als ob er aus dem DOM stammt) und √ºberpr√ºfen Sie dann die Werte anderer Threads, die davon abh√§ngen. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { simpleWrapper} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mrr'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { GoodsStruct } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../src/components/Goods'</span></span>; describe(<span class="hljs-string"><span class="hljs-string">'Testing Goods component'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'should update page if it\'s out of limit '</span></span>, () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = simpleWrapper(GoodsStruct); a.set(<span class="hljs-string"><span class="hljs-string">'page'</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); assert.equal(a.get(<span class="hljs-string"><span class="hljs-string">'page'</span></span>), <span class="hljs-number"><span class="hljs-number">10</span></span>); a.set(<span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">data</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">total</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>}); assert.equal(a.get(<span class="hljs-string"><span class="hljs-string">'page'</span></span>), <span class="hljs-number"><span class="hljs-number">5</span></span>); a.set(<span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">data</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">total</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>}); assert.equal(a.get(<span class="hljs-string"><span class="hljs-string">'page'</span></span>), <span class="hljs-number"><span class="hljs-number">5</span></span>); }) })</code> </pre> <br><h3 id="blesk-i-nischeta-reaktivnosti">  Glanz und Armut der Reaktivit√§t </h3><br><p>  Es ist erw√§hnenswert, dass Reaktivit√§t eine Abstraktion auf einer h√∂heren Ebene ist als die ‚Äûmanuelle‚Äú Bildung eines Zustands basierend auf Ereignissen im Editor.  Die Erleichterung der Entwicklung schafft einerseits die M√∂glichkeit, sich in den Fu√ü zu schie√üen.  Stellen Sie sich dieses Szenario vor: Der Benutzer wechselt zu Seite 5 und wechselt dann den Filter "Kategorie".  Wir m√ºssen die Liste der Produkte der ausgew√§hlten Kategorie auf der f√ºnften Seite laden, aber es kann sich herausstellen, dass die Waren in dieser Kategorie nur drei Seiten haben.  Im Fall des "dummen" Backends lautet der Algorithmus unserer Aktionen wie folgt: </p><br><ul><li>  Anforderungsdatenseite = 5 &amp; Kategorie =% Kategorie% </li><li>  Nehmen Sie aus der Antwort den Wert der Anzahl der Seiten </li><li>  Wenn eine Anzahl von Datens√§tzen von Null zur√ºckgegeben wird, fordern Sie die gr√∂√üte verf√ºgbare Seite an </li></ul><br><p>  Wenn wir dies im Editor implementieren w√ºrden, m√ºssten wir eine gro√üe asynchrone Aktion mit der beschriebenen Logik erstellen.  Bei Reaktivit√§t auf mrr muss dieses Szenario nicht separat beschrieben werden.  Alles ist bereits in diesen Zeilen enthalten: </p><br><pre> <code class="javascript hljs"> [requestGoods$]: [<span class="hljs-string"><span class="hljs-string">'nested'</span></span>, (cb, page, category) =&gt; { fetch(<span class="hljs-string"><span class="hljs-string">'https://reqres.in/api/products?page='</span></span>, page).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.json()) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'success'</span></span>, res)) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'error'</span></span>, e)) }, page$, category$, $start$], [totalPages$]: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.total, requestGoods$.success], [page$]: merge(goToPage$, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, prev</span></span></span><span class="hljs-function">) =&gt;</span></span> a &lt; prev ? a : prev, totalPages$, passive(page$)]),</code> </pre> <br><p>  Wenn der neue totalPages-Wert kleiner als die aktuelle Seite ist, aktualisieren wir den Seitenwert und initiieren dadurch eine zweite Anforderung an den Server. <br>  Wenn unsere Funktion jedoch denselben Wert zur√ºckgibt, wird dies weiterhin als √Ñnderung des Seitenstroms wahrgenommen, gefolgt von einer Neuberechnung aller abh√§ngigen Streams.  Um dies zu vermeiden, hat mrr eine besondere Bedeutung - √ºberspringen.  Wenn wir es zur√ºckgeben, signalisieren wir: Es sind keine √Ñnderungen aufgetreten, es muss nichts aktualisiert werden. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withMrr, skip } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mrr'</span></span>; [requestGoods$]: nested(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb, page, category</span></span></span><span class="hljs-function">) =&gt;</span></span> { fetch(<span class="hljs-string"><span class="hljs-string">'https://reqres.in/api/products?page='</span></span>, page).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.json()) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'success'</span></span>, res)) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'error'</span></span>, e)) }, page$, category$, $start$), [totalPages$]: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.total, requestGoods$.success], [page$]: merge(goToPage$, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, prev</span></span></span><span class="hljs-function">) =&gt;</span></span> a &lt; prev ? a : skip, totalPages$, passive(page$)]),</code> </pre> <br><p>  Ein kleiner Fehler kann uns also zu einer Endlosschleife f√ºhren: Wenn wir nicht "√ºberspringen", sondern "prev" zur√ºckgeben, √§ndert sich die Seitenzelle und es erfolgt eine zweite Anforderung usw. in einem Kreis.  Die M√∂glichkeit einer solchen Situation ist nat√ºrlich kein ‚Äûfehlerhafter Nachteil‚Äú von FRP oder mrr, da die M√∂glichkeit einer unendlichen Rekursion oder einer Schleife nicht auf die fehlerhaften Ideen der strukturellen Programmierung hinweist.  Es versteht sich jedoch, dass mrr noch ein gewisses Verst√§ndnis des Reaktivit√§tsmechanismus erfordert.  Zur√ºck zur bekannten Metapher der Messer: mrr ist ein sehr scharfes Messer, das die Arbeitseffizienz verbessert, aber auch einen unf√§higen Arbeiter verletzen kann. </p><br><p>  √úbrigens ist die Abbuchung von mrr sehr einfach, ohne Erweiterungen zu installieren: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> GoodsStruct = { <span class="hljs-attr"><span class="hljs-attr">$init</span></span>: { ... }, <span class="hljs-attr"><span class="hljs-attr">$log</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, ... }</code> </pre> <br><p>  F√ºgen Sie einfach $ log: true zur mrr-Struktur hinzu, und alle √Ñnderungen an den Zellen werden an die Konsole ausgegeben, sodass Sie sehen k√∂nnen, welche √Ñnderungen und wie. </p><br><p>  Konzepte wie passives Zuh√∂ren oder die Bedeutung von √úberspringen sind keine spezifischen ‚ÄûKr√ºcken‚Äú: Sie erweitern die M√∂glichkeiten der Reaktivit√§t, sodass die gesamte Logik der Anwendung leicht beschrieben werden kann, ohne auf zwingende Ans√§tze zur√ºckgreifen zu m√ºssen.  √Ñhnliche Mechanismen gibt es zum Beispiel in Rx.js, aber ihre Schnittstelle dort ist weniger bequem.            : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mrr:  FRP  </a> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   .</a> </p><br><h3 id="itogi">  Zusammenfassung </h3><br><ul><li>   FRP,     mrr          ,      </li><li>           :    ,         </li><li>     ,        ,            </li><li>         ,    ,         - (   - !) </li><li>            </li><li>  mrr : "  ,   !"            </li><li>      ,       </li><li>   ,          ,    (        ).     ! </li><li>     : ,   ,  ,    TMTOWTDI:          , -              . </li></ul><br><h3 id="ps">  PS </h3><br><p>        .  ,  mrr      ,    ,    : </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> useMrr <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mrr/hooks'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Foo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [state, $, connectAs] = useMrr(props, { <span class="hljs-attr"><span class="hljs-attr">$init</span></span>: { <span class="hljs-attr"><span class="hljs-attr">counter</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">counter</span></span>: [<span class="hljs-string"><span class="hljs-string">'merge'</span></span>, [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a</span></span></span><span class="hljs-function"> =&gt;</span></span> a + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'-counter'</span></span>, <span class="hljs-string"><span class="hljs-string">'incr'</span></span>], [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a</span></span></span><span class="hljs-function"> =&gt;</span></span> a - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'-counter'</span></span>, <span class="hljs-string"><span class="hljs-string">'decr'</span></span>] ], }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> Counter: { state.counter } </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag"> $('</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">incr</span></span></span></span><span class="xml"><span class="hljs-tag">') }&gt;</span></span></span><span class="xml">increment</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag"> $('</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">decr</span></span></span></span><span class="xml"><span class="hljs-tag">') }&gt;</span></span></span><span class="xml">decrement</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Bar</span></span></span></span><span class="xml"><span class="hljs-tag"> {</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...connectAs</span></span></span></span><span class="xml"><span class="hljs-tag">('</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bar</span></span></span></span><span class="xml"><span class="hljs-tag">')} /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ); }</span></span></code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de438112/">https://habr.com/ru/post/de438112/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de438100/index.html">Wo Daten hingehen: 12 Angriffe, Hacks und Lecks</a></li>
<li><a href="../de438104/index.html">Keine Blockchain</a></li>
<li><a href="../de438106/index.html">Blinkt mit Vintage-LEDs oder warnt vor ‚ÄûBr√§nden‚Äú im Projekt</a></li>
<li><a href="../de438108/index.html">SEO und Kontext: Was soll ich w√§hlen und ob soll ich w√§hlen?</a></li>
<li><a href="../de438110/index.html">Schienen + Postgres + Bindungen</a></li>
<li><a href="../de438116/index.html">Umweltvertr√§glichkeitspr√ºfung von Musikmedien: digitale Musik, analoge Aufnahmen und CDs</a></li>
<li><a href="../de438118/index.html">Mit Dex-Net 4.0 k√∂nnen Ambidextro-Roboter das Beste heraussuchen</a></li>
<li><a href="../de438120/index.html">Die Zusammenfassung der Ereignisse f√ºr HR-Experten im Bereich IT f√ºr Februar 2019</a></li>
<li><a href="../de438122/index.html">Numerologie zu MS SQL - ein unterhaltsames Experiment</a></li>
<li><a href="../de438124/index.html">Piter GraphQL: Videos von Mitap in Wrike</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>