<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌯 🤚🏻 🎨 Radio WiFi WOLNA. Cómo se creó una pequeña startup 🎉 🧒 🧑🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No hace mucho tiempo, puse en un tribunal público un dispositivo de mi propio diseño, que se desarrolló el año pasado. Esta es una radio por internet ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Radio WiFi WOLNA. Cómo se creó una pequeña startup</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/403239/"> No hace mucho tiempo, puse en un tribunal público un dispositivo de mi propio diseño, que se desarrolló el año pasado.  Esta es una radio por internet con wifi. <br><br><img src="https://habrastorage.org/files/f54/afe/69e/f54afe69e5d844a494f9a0dfec8604c4.png" alt="imagen"><br><br>  Se propone votar a favor o en contra de las personas en rublos en uno de los sitios de crowdfunding.  El dispositivo no causó gran revuelo, aunque ya hay patrocinadores.  Pero desde entonces ha habido muchas preguntas técnicas y solicitudes para diseñar los circuitos y el firmware.  Todos los que estén interesados ​​en cómo nació el dispositivo y de qué está hecho, son bienvenidos. <br>  <i>Spoiler:</i> no habrá firmware. <br><a name="habracut"></a><br>  Entonces, todo comenzó con la necesidad de tener una radio en casa en la cocina.  Por supuesto, como desarrollador de electrónica, inmediatamente descarté la opción de ir a la tienda y comprar.  Por cierto, por esta razón, todavía no tengo un timbre normal. <br><br>  La radio FM se abandonó debido a la implementación aburrida.  Y se decidió hacer una radio por Internet.  Mirando hacia el futuro, quiero mostrar que tal receptor resultó aquí. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/wiW4ZcnPw18" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  <b>Selección de hierro</b> <br><br>  Primero, era necesario elegir una plataforma en la que pudiera construir una radio por Internet.  Hay muchas opciones, pero elegí lo que estaba a la mano: <br><br>  1. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Odroid W</a> + LCD <br>  2. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">STM32F4DISCOVERY</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ESP8266</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">VS1053B</a> <br><br>  En una odroid, el proceso de desarrollo llevaría menos tiempo, pero los inconvenientes, en mi caso particular (muchos no están de acuerdo conmigo), prevalecieron: <br><br>  - el proceso de carga del sistema operativo lleva algo de tiempo <br>  - Una tendencia creciente a infectar dispositivos IoT con virus <br>  - Tengo poco conocimiento del desarrollo de Linux <br>  - precio <br><br>  Sin embargo, le pedí a uno de mis buenos amigos que escribiera un softink para Odroid W, que comenzaría desde el inicio del sistema y reproduciría la radio por Internet.  Pero la incapacidad de editar correctamente el proyecto sin sacudir a un compañero enterró esta opción y me empujó a la segunda. <br><br>  Y puse el siguiente diagrama en una placa de pruebas: <br><br><img src="https://habrastorage.org/files/c09/207/c4d/c09207c4d0bb40d589c165e8493d4d7e.png" alt="imagen"><br><br>  <b>Cómo trabajar con radio por internet</b> <br><br>  Después de eso, comencé a ver cómo funciona la radio por Internet.  Resultó que la gran mayoría de las estaciones usan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Icecast</a> para transmitir.  Gira en algún lugar de un servidor con una IP fija y espera una conexión.  Como regla, en el puerto 8000 o 8080.  Aunque hay muchas excepciones.  Después de conectarse, debe enviar una solicitud de este tipo, sustituyendo el nombre de la secuencia y el servidor: <br><br><pre><code class="hljs powershell">GET /stream HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Icy<span class="hljs-literal"><span class="hljs-literal">-MetaData</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> User<span class="hljs-literal"><span class="hljs-literal">-Agent</span></span>: Mozilla/<span class="hljs-number"><span class="hljs-number">5.0</span></span> (X11; U; Linux i686; en<span class="hljs-literal"><span class="hljs-literal">-US</span></span>; rv:<span class="hljs-number"><span class="hljs-number">1.6</span></span>) Gecko/<span class="hljs-number"><span class="hljs-number">20040413</span></span> Epiphany/<span class="hljs-number"><span class="hljs-number">1.2</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> Host: internetradioserver.ru Cache<span class="hljs-literal"><span class="hljs-literal">-Control</span></span>: no<span class="hljs-literal"><span class="hljs-literal">-cache</span></span></code> </pre> <br>  En respuesta, comienza a caer un flujo <s>interminable de</s> mp3, que ya puede decodificarse y reproducirse. <br><br>  La apertura de una conexión TCP y otras alegrías de trabajar con el ESP8266 se realizan mediante comandos AT.  No me detendré en ellos, la información está completa en Internet.  Todo está muy bien pintado en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">comunidad de habla rusa esp8266</a> .  El procedimiento para trabajar con él es simple: <br><br>  1. Estamos esperando una conexión WiFi, si no está allí, seleccione una red, ingrese la contraseña. <br>  2. Abrimos la conexión TCP con el servidor de la estación de radio.  Las direcciones de los servidores, los puertos y los nombres de las secuencias se almacenan directamente en la memoria flash del microcontrolador, pero más sobre eso más adelante. <br>  3. Envíe la solicitud GET arriba. <br>  4. Recibimos en respuesta un flujo continuo de mp3. <br>  5. Si necesita cambiar la estación, cierre la conexión TCP y repita desde el paso 2. <br><br>  Te contaré un poco sobre cómo las estaciones entran en la memoria flash del microcontrolador.  Inicialmente, en la etapa de verificación, simplemente escribí direcciones, números de puerto y nombres de flujo en una de las páginas de memoria del programa.  Pero con el tiempo, cuando los dispositivos se dispersaron entre familiares y amigos, tuve que agregar la capacidad de actualizar centralmente la lista.  Se decidió crear un servidor con una IP fija, en la que se almacenaría un archivo con una lista de estaciones.  Cuando se conecta a través de TCP, el servidor espera una contraseña y emite un archivo, y el microcontrolador lo escribe en su memoria flash.  Desde que encontré por primera vez la creación de "algo en Internet", me sorprendió gratamente que resulta que alquilar una máquina virtual con una IP fija cuesta solo 100 rublos al mes.  Milagros :) <br><br>  <b>Circuitería</b> <br><br>  Después de jugar lo suficiente con STM32F4Discovery, decidí hacer mi propia tarjeta, en la que se ubicarían todos los elementos del receptor, y no necesitaré tirar de los cables ni a la pantalla ni a los conectores.  Esto mejora enormemente la fiabilidad y la capacidad de fabricación <s>y todos lo sueñan</s> . <br><br>  El esquema se puede descargar aquí.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">[DIAGRAMA]</a>  No la adorné ni la peiné específicamente para su publicación.  Esta es una opción de trabajo, y debería ser suficiente para aquellos que están realmente interesados. <br><br>  El esquema consta de las partes principales: <br><br>  1. MK STM32F415 con arnés: dos de cuarzo y una batería para un reloj en tiempo real. <br>  2. ESP8266 <br>  3. VS1053 con flejes estrictamente en la hoja de datos.  Comenzó en MK a través de SPI. <br>  4. Potencia: dos reguladores lineales LM1117 a 3.3 y 1.8 voltios. <br>  5. Pantalla, conectores, botones, potenciómetro.  Todo esto está instituido en el microcontrolador GPIO. <br><br>  Además, el amplificador <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PAM8403</a> clase D no se muestra en el diagrama, ya que cuesta un módulo comprado por separado. <br><br>  <b>Tarifa</b> <br><br>  Para bien, antes de hacer el tablero, debe determinar la ubicación de los elementos que sobresalen del cuerpo: botones, conectores, pantalla.  Así lo hice, pero sobre el caso más tarde. <br><br>  El tablero resultó así.  ¡Cuidado geek fresa! <br><br><img src="https://habrastorage.org/files/2b5/487/9d8/2b54879d8f6d4bf98a54004cccaf298b.JPG" alt="imagen"><br><br><img src="https://habrastorage.org/files/c9b/e26/4f7/c9be264f79f147428eed3b0bab40d95b.JPG" alt="imagen"><br><br><img src="https://habrastorage.org/files/819/d14/f09/819d14f09d91481785ce9787f32160a2.JPG" alt="imagen"><br><br>  El tablero es de dos capas, un espesor de 1,5 mm.  Todos los componentes smd están ubicados en un lado, lo que facilita la instalación automática.  Sin embargo, el asunto aún no le ha llegado. <br><br>  Varios expertos ya me regañaron en pikabu por pequeños defectos en el cableado.  Sin embargo, el tablero funciona, y funciona como debería.  No veo el valor en los dibujos del tablero, así que no lo publico.  Si hay solicitudes, lo publicaré.  De todos modos, lo rehaceré.  Y, por supuesto, ¡las críticas bien fundadas son bienvenidas! <br><br>  <b>Vivienda</b> <br><br>  El caso es un dolor de todos los ingenieros electrónicos aficionados.  E incluso si no eres un aficionado, haciendo un caso por tu dinero te conviertes en él. <br><br>  En lotes pequeños, la opción más económica es el fresado o el corte por láser.  Con las opciones de metal, todavía se puede doblar chapa, pero este no es mi caso.  Por lo tanto, elegí el fresado de piezas de madera + corte láser de paneles.  En términos de sonido, una caja de madera también es una gran ventaja. <br><br>  El resultado fue este conjunto de partes: <br><br><img src="https://habrastorage.org/files/0a9/510/970/0a9510970e2d4339982a28f32bdf729a.JPG" alt="imagen"><br><br>  Especial atención merece la inscripción.  Después de mucho pensar, cómo aplicarlos, se decidió realizarlos mediante lechada.  Es decir, primero, con un molino delgado, la inscripción se selecciona en el panel y luego se vierte pintura allí.  Después de que la pintura se seque, se elimina su exceso.  Una operación muy costosa, pero ya no me detenía.  Además, una de las formas más duraderas.  Si alguien tiene experiencia con otras formas de aplicar etiquetas, por favor comparta. <br><br>  Así es como se ven las inscripciones resultantes. <br><br><img src="https://habrastorage.org/files/05b/6e7/48c/05b6e748cb9e43aa9df7d02b72686eb8.JPG" alt="imagen"><br><br>  Y aquí está la radio ensamblada desde adentro: <br><br><img src="https://habrastorage.org/files/02e/abe/567/02eabe56732143659518590266241998.JPG" alt="imagen"><br><br>  Y una foto más afuera: <br><br><img src="https://habrastorage.org/files/e3c/f6b/ab8/e3cf6bab85ca4789ae85310c6257eee8.JPG" alt="imagen"><br><br>  Conclusión  Este artículo describió los detalles del desarrollo del dispositivo con trazos amplios.  Es bastante difícil escribir sobre los detalles, por un lado, por el hecho de que su mar, por otro lado, todos individualmente parecen obvios.  Podría escribir en un artículo separado sobre circuitos, una placa de circuito impreso, firmware, trabajando con esp8266 y vs1053b, si tengo suficiente interés definitivamente escribiré.  Porque realmente quiero que la radio por Internet se vuelva popular. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es403239/">https://habr.com/ru/post/es403239/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es403229/index.html">Juegos de cartas de computadora: Streamers para ver</a></li>
<li><a href="../es403231/index.html">Invasores de retroceso o cómo conectar una pantalla LED de 64x64 a Arduino</a></li>
<li><a href="../es403233/index.html">NASA: Encelado tiene todas las condiciones para el origen y mantenimiento de la vida.</a></li>
<li><a href="../es403235/index.html">¿Por qué el segundo es más interesante que el primero? Una nota sobre las nuevas escalas de Xiaomi</a></li>
<li><a href="../es403237/index.html">Agregar un contador SDM-220 a OpenHab</a></li>
<li><a href="../es403241/index.html">Pregúntele a Ethan: ¿Cómo interactúa la materia oscura con los agujeros negros?</a></li>
<li><a href="../es403245/index.html">Cómo comenzar a ensamblar un quadrocopter ZMR250 / QAV250 con Aliexpress (1 parte)</a></li>
<li><a href="../es403247/index.html">Microsoft corrigió vulnerabilidades de día cero en su software mucho antes de que fueran reveladas por Shadow Brokers</a></li>
<li><a href="../es403249/index.html">Los planes de la NASA están cambiando: los lanzamientos de cohetes pesados ​​de la NASA probablemente sufrirán</a></li>
<li><a href="../es403253/index.html">Es razonable: ¿por qué el problema principal de la neurobiología se refleja en la física?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>