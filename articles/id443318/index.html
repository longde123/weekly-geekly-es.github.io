<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤜🏼 🤾🏿 👨‍🚀 Menulis loader wasm untuk Ghidra. Bagian 1: Pernyataan masalah dan pengaturan lingkungan 🎼 👩🏽‍🎓 🔜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Minggu ini, NSA ( Badan Keamanan Nasional ) tiba-tiba memberikan hadiah kepada umat manusia, membuka sumber kerangka kerja rekayasa balik perangkat lu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Menulis loader wasm untuk Ghidra. Bagian 1: Pernyataan masalah dan pengaturan lingkungan</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443318/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/xy/1q/jm/xy1qjmpn0nactzdrq1laun9brhm.png"></div><br>  Minggu ini, NSA ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Badan Keamanan Nasional</a> ) tiba-tiba memberikan hadiah kepada umat manusia, membuka sumber kerangka kerja rekayasa balik perangkat lunak mereka.  Komunitas para insinyur terbalik dan pakar keamanan dengan antusiasme yang besar mulai mengeksplorasi mainan baru.  Menurut umpan balik, itu alat yang sangat luar biasa, mampu bersaing dengan solusi yang ada, seperti IDA Pro, R2 dan JEB.  Alat itu disebut Ghidra dan sumber daya profesional penuh dengan kesan dari para peneliti.  Sebenarnya, mereka punya alasan bagus: tidak setiap hari organisasi pemerintah menyediakan akses ke alat internal mereka.  Saya sendiri sebagai insinyur balik profesional dan analis malware tidak bisa lewat juga.  Saya memutuskan untuk menghabiskan satu atau dua akhir pekan dan mendapatkan kesan pertama dari alat ini.  Saya telah bermain sedikit dengan pembongkaran dan memutuskan untuk memeriksa ekstensibilitas alat.  Dalam seri artikel ini, saya akan menjelaskan pengembangan tambahan Ghidra, yang memuat format khusus, yang digunakan untuk menyelesaikan tugas KKP.  Karena ini adalah kerangka kerja yang besar dan saya telah memilih tugas yang cukup rumit, saya akan memecah artikel menjadi beberapa bagian. <br><br>  Pada akhir bagian ini saya berharap untuk mengatur lingkungan pengembangan dan membangun modul minimal, yang akan dapat mengenali format file WebAssembly dan akan menyarankan disassembler yang tepat untuk memprosesnya. <br><a name="habracut"></a><br>  Mari kita mulai dengan deskripsi tugas.  Tahun lalu perusahaan keamanan FireEye menyelenggarakan kontes CTF, bernama flare-on.  Selama kontes, para peneliti harus menyelesaikan dua belas tugas, yang berkaitan dengan rekayasa balik.  Salah satu tugas adalah untuk meneliti aplikasi web, yang dibangun dengan WebAssembly.  Ini format yang dapat dieksekusi yang relatif baru, dan sejauh yang saya tahu, tidak ada alat yang sempurna untuk menghadapinya.  Selama tantangan, saya mencoba beberapa alat yang mencoba untuk mengalahkannya.  Itu adalah skrip sederhana dari github dan dekompiler yang dikenal, seperti IDA pro dan JEB.  Anehnya, saya sudah berhenti di chrome, yang menyediakan disassembler dan debugger yang cukup bagus untuk WebAssembly.  Tujuan saya adalah untuk menyelesaikan tantangan dengan ghidra.  Saya akan menjelaskan studi ini selengkap mungkin dan memberikan semua informasi yang mungkin untuk mereproduksi langkah saya.  Mungkin, sebagai orang, yang tidak memiliki banyak pengalaman dengan instrumen, saya mungkin masuk ke beberapa detail yang tidak perlu, tetapi begitulah adanya. <br><br>  Tugas yang akan saya gunakan untuk belajar dapat diunduh dari <a href="">situs</a> tantangan flareon5.  Ada file 05_web2point0.7z: arsip dienkripsi dengan kata menakutkan yang <b>terinfeksi</b> .  Ada tiga file dalam arsip: index.html, main.js dan test.wasm.  Mari kita buka file index.html di browser dan periksa hasilnya: <br><br><img src="https://habrastorage.org/webt/5z/o2/fd/5zo2fdf7jjndo2tmhesju4go7io.png"><br><br>  Nah, itulah yang akan saya kerjakan.  Mari kita mulai dengan belajar html, terutama karena ini adalah bagian termudah dari tantangan.  Kode html tidak mengandung apa pun kecuali memuat skrip main.js. <br><br><pre><code class="javascript hljs">&lt;!DOCTYPE html&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">html</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">body</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"./main.js"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">body</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">html</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Script tidak melakukan hal yang rumit juga, meskipun terlihat sedikit lebih bertele-tele.  Itu hanya memuat file test.wasm dan menggunakannya untuk membuat instance WebAssembly.  Kemudian ia membaca parameter "q" dari url dan meneruskannya ke metode match, diekspor oleh instance.  Jika string dalam parameter tidak benar, skrip menunjukkan gambar yang telah kita lihat di atas, dalam hal pengembang FireEye disebut "Tumpukan kotoran". <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> b = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Uint8Array</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TextEncoder().encode(getParameterByName(<span class="hljs-string"><span class="hljs-string">"q"</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pa = wasm_alloc(instance, <span class="hljs-number"><span class="hljs-number">0x200</span></span>); wasm_write(instance, pa, a); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pb = wasm_alloc(instance, <span class="hljs-number"><span class="hljs-number">0x200</span></span>); wasm_write(instance, pb, b); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (instance.exports.Match(pa, a.byteLength, pb, b.byteLength) == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// PARTY POPPER document.getElementById("container").innerText = "ðŸŽ‰"; } else { // PILE OF POO document.getElementById("container").innerText = "ðŸ'"; }</span></span></code> </pre><br>  Solusi dari tugas ini adalah menemukan nilai dari parameter q yang membuat fungsi "cocok" mengembalikan "Benar".  Untuk melakukan ini, saya akan membongkar file test.wasm dan menganalisis algoritma fungsi Match. <br><br>  Tidak ada kejutan, dan saya akan mencoba melakukannya di Ghidra.  Tetapi pertama-tama saya harus menginstalnya.  Instalasi dapat (dan harus) diunduh dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://ghidra-sre.org/</a> .  Karena ini ditulis dalam Java, hampir tidak ada persyaratan khusus untuk instalasi, itu tidak memerlukan upaya khusus untuk menginstal.  Semua yang Anda butuhkan adalah membongkar arsip dan menjalankan aplikasi.  Satu-satunya hal yang diperlukan adalah memperbarui JDK dan JRE ke versi 11. <br><br>  Mari kita buat proyek ghidra baru ( <b>File-&gt; Proyek Baru</b> ), dan menyebutnya "wasm" / <br><br><img src="https://habrastorage.org/webt/yt/1j/2s/yt1j2sgpytbsoyhsschjdit4v7m.png"><br><br>  Kemudian tambahkan untuk memproyeksikan file test.wasm ( <b>File → Impor file</b> ) dan lihat bagaimana ghidra dapat menghadapinya <br><br><img src="https://habrastorage.org/webt/up/wq/jq/upwqjqan-5cooznznqw5pcks-pw.png"><br><br>  Yah, itu tidak bisa apa-apa.  Ia tidak mengenali format dan tidak dapat membongkar apa pun, karena itu sama sekali tidak berdaya untuk menangani tugas ini.  Akhirnya kita sampai pada pokok bahasan artikel.  Tidak ada yang tersisa untuk dilakukan, tetapi menulis modul, yang dapat memuat file wasm, menganalisisnya dan membongkar kode-kodenya. <br><br>  Pertama-tama saya telah mempelajari semua dokumentasi yang tersedia.  Sebenarnya, hanya ada satu dokumen yang cocok, menunjukkan proses pengembangan add-ons: slide GhidraAdvancedDevelopment.  Saya akan mengikuti dokumen, memberikan deskripsi pukulan demi pukulan. <br><br>  Sayangnya, pengembangan add-on membutuhkan penggunaan gerhana.  Semua pengalaman saya dengan gerhana adalah pengembangan dua game gdx untuk Android pada tahun 2012. Sudah dua minggu penuh rasa sakit dan penderitaan, setelah itu saya menghapusnya dari pikiran saya.  Harapan setelah 7 tahun pembangunan itu lebih baik daripada dulu. <br><br>  Mari mengunduh dan menginstal gerhana dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">situs</a> resmi. <br><br>  Kemudian, instal ekstensi untuk pengembangan ghidra: <br><br>  <b>Bantuan</b> Goto eclipse <b>→ Instal</b> menu <b>Perangkat Lunak Baru</b> , klik tombol <b>Tambah</b> dan pilih GhidraDev.zip dari / Extensions / Eclipse / GhidraDev /.  Instal dan mulai ulang ekstensi.  Ekstensi, menambahkan templat ke menu proyek baru, memungkinkan untuk men-debug modul dari gerhana dan mengkompilasi modul ke paket distribusi. <br><br>  Seperti berikut dari dokumen pengembang langkah-langkah berikut harus dilakukan untuk menambahkan modul untuk memproses format biner baru: <br><br><ul><li>  Buat kelas, jelaskan struktur data </li><li>  Kembangkan loader.  Loader harus diwarisi dari kelas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">AbstractLibrarySupportLoader</a> .  Itu membaca semua data yang diperlukan dari file, memeriksa integritas data dan mengkonversi data biner ke representasi internal, mempersiapkannya untuk analisis <br></li><li>  Kembangkan analisa.  Analyzer diwarisi dari kelas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">AbstractAnalyzer</a> .  Dibutuhkan struktur data yang disiapkan oleh loader dan menjelaskannya (saya tidak benar-benar yakin apa artinya, tapi saya berharap untuk mengerti selama pengembangan) <br></li><li>  Tambahkan prosesor.  Ghidra memiliki abstraksi: Prosesor.  Ini ditulis dalam bahasa deklaratif internal dan menjelaskan set instruksi, tata letak memori dan fitur arsitektur lainnya.  Saya akan membahas topik ini, menulis disassembler. <br></li></ul><br>  Sekarang, ketika kita memiliki semua teori yang diperlukan, saatnya untuk membuat proyek modul.  Berkat GhidraDev, ekstensi gerhana yang dipasang sebelumnya, kami memiliki templat modul di menu <b>File-&gt; New project</b> . <br><br><img src="https://habrastorage.org/webt/ir/z3/77/irz377yf_rcsginnfb-e8-ee-ga.png"><br><br>  Wizard menanyakan komponen apa yang diperlukan.  Seperti yang sudah dijelaskan sebelumnya, kita membutuhkan dua di antaranya: loader dan analyzer. <br><br><img src="https://habrastorage.org/webt/vf/cc/j1/vfccj1djknkxefjuc1bg9pysycs.png"><br><br>  Wizard membuat kerangka proyek dengan semua bagian yang diperlukan: penganalisis kosong dalam file WasmAnalyzer.java, pemuat kosong dalam file WasmLoader.java dan kerangka bahasa dalam direktori / data / bahasa. <br><br><img src="https://habrastorage.org/webt/bu/3q/uw/bu3quwuupe-0heogbta81hrub7c.png"><br><br>  Mari kita mulai dengan loader.  Seperti yang disebutkan, itu harus diwarisi dari kelas AbstractLibrarySupportLoader dan memiliki tiga metode yang akan kelebihan beban: <br><br><ul><li>  getName - metode ini harus nama internal loader.  Ghidra menggunakannya di berbagai tempat, misalnya, untuk mengikat loader ke prosesor </li><li>  findSupportedLoadSpecs - callback, dieksekusi, ketika pengguna memilih file untuk diimpor.  Dalam pemanggil panggil balik ini harus memutuskan apakah ia dapat memproses file dan mengembalikan instance dari kelas LoadSpec, memberi tahu pengguna bagaimana file dapat diproses </li><li>  load - callback, dieksekusi, setelah pengguna memuat file.  Dalam metode ini loader mem-parsing struktur file dan memuat ke ghidra.  Akan menggambarkannya lebih detail di artikel selanjutnya </li></ul><br>  Metode pertama dan paling sederhana adalah getName, itu hanya mengembalikan nama loader <br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"WebAssembly"</span></span>; }</code> </pre><br>  Metode kedua untuk mengimplementasikan adalah findSupportedLoadSpecs.  Itu disebut oleh alat selama impor file dan harus memverifikasi apakah loader dapat memproses file.  Jika metode ini dapat mengembalikan objek dari kelas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">LoadSpec</a> , mengatakan objek apa yang digunakan untuk memuat file dan prosesor apa yang akan membongkar kodenya. <br><br>  Metode dimulai dari verifikasi format.  Seperti berikut dari <a href="">spec</a> , delapan byte pertama dari file wasm harus berupa tanda tangan “\ 0asm” dan versi. <br><br>  Untuk mengurai header, saya membuat kelas WasmHeader, mengimplementasikan antarmuka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">StructConverter</a> , yang merupakan antarmuka dasar untuk menggambarkan data terstruktur.  Konstruktor WasmHeader menerima objek <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">BinaryReader</a> - abstraksi, yang digunakan untuk membaca data dari sumber biner yang sedang dianalisis.  Konstruktor menggunakannya untuk membaca header dari file input <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] magic; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> [] version; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WasmHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(BinaryReader reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ magic = reader.readNextByteArray(WASM_MAGIC_BASE.length()); version = reader.readNextByteArray(WASM_VERSION_LENGTH); }</code> </pre><br>  Loader menggunakan objek ini untuk memverifikasi tanda tangan file.  Kemudian, jika berhasil, cari prosesor yang sesuai.  Itu panggilan metode permintaan kelas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">QueryOpinionService</a> , dan memberikannya nama loader ("Webassembly").  OpinionService mencari prosesor yang terkait dengan loader ini dan mengembalikannya. <br><br><pre> <code class="java hljs">List&lt;QueryResult&gt; queries = QueryOpinionService.query(getName(), MACHINE, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>);</code> </pre><br>  Tentu hal itu tidak menghasilkan apa-apa, karena ghidra tidak tahu prosesor, disebut WebAssembly dan itu perlu mendefinisikannya.  Seperti yang saya katakan sebelumnya, wizard membuat kerangka bahasa dalam data direktori / bahasa. <br><br><img src="https://habrastorage.org/webt/ck/hq/0d/ckhq0d4gena4dbalhjufpwv9kbs.png"><br><br>  Pada tahap saat ini ada dua file yang mungkin menarik: Webassembly.opinion dan Wbassembly.ldefs.  File .opinon mengatur korespondensi antara loader dan prosesor. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">opinions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constraint</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">loader</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"WebAssembly"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">compilerSpecID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constraint</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">primary</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Webassembly"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constraint</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">opinions</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Ini berisi xml sederhana dengan beberapa atribut.  Itu perlu mengatur nama loader ke atribut "loader" dan nama prosesor menjadi atribut "prosesor", keduanya adalah "Webassembly".  Pada langkah ini saya akan mengisi parameter lain dengan nilai acak.  Segera setelah saya tahu lebih banyak tentang prosesor prosesor Webassembly, saya akan mengubahnya menjadi nilai yang benar. <br><br>  File .ldefs menjelaskan fitur prosesor, yang harus menjalankan kode dari file. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language_definitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Webassembly"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">endian</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"little"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">variant</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">slafile</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Webassembly.sla"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorspec</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Webassembly.pspec"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wasm:LE:16:default"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Webassembly Language Module<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">compiler</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">spec</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Webassembly.cspec"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language_definitions</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Atribut “prosesor” harus sama dengan prosesor atribut dari file .opinion.  Mari kita biarkan bidang lain tidak tersentuh.  Tetapi ingat lain kali bahwa mungkin untuk mengatur bittness registri (atribut "ukuran"), file yang menggambarkan arsitektur prosesor "processorspec" dan file, yang berisi deskripsi kode dalam bahasa deklaratif khusus "slafile".  Ini akan berguna untuk bekerja pada pembongkaran. <br><br>  Sekarang, saatnya untuk kembali ke loader dan mengembalikan spesifikasi loader. <br><br>  Semuanya siap untuk uji coba.  Plugin untuk GhidraDev telah menambahkan opsi jalankan “ <b>Jalankan → Jalankan Sebagai → Ghidra</b> ” ke gerhana: <br><br><img src="https://habrastorage.org/webt/j5/z-/ft/j5z-ft7xxiy1equy99ahzrt6d7a.png"><br><br>  Ini menjalankan ghidra dalam mode debug dan menyebarkan modul di sana, memberikan peluang besar untuk bekerja dengan alat ini dan pada saat yang sama menggunakan debugger untuk memperbaiki kesalahan dalam modul yang sedang dikembangkan.  Tetapi pada tahap sederhana ini tidak ada alasan untuk menggunakan debugger.  Seperti sebelumnya, saya akan membuat proyek baru, mengimpor file dan melihat apakah upaya saya terbayar.  Tidak seperti yang terakhir kali, file dikenali sebagai WebAssembly, dan loader mengusulkan prosesor yang sesuai untuk itu.  Itu berarti semuanya berfungsi, dan modul saya dapat mengenali format. <br><br><img src="https://habrastorage.org/webt/zs/np/vd/zsnpvdvzqx5ecg7xdlz86dzres0.png"><br><br>  Pada artikel selanjutnya saya akan memperluas loader, dan membuatnya tidak hanya mengenali, tetapi juga menggambarkan struktur file wasm.  Saya pikir pada tahap ini, setelah lingkungan diatur, itu akan mudah dilakukan. <br><br>  Kode modul tersedia di repositori <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">github</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id443318/">https://habr.com/ru/post/id443318/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id443306/index.html">Delapan Hukum Penamaan dalam Desain UX (Bagian 1)</a></li>
<li><a href="../id443308/index.html">Mitos fisika modern. Hukum konservasi</a></li>
<li><a href="../id443310/index.html">Ulasan Gadget Kesehatan Wanita Bellabeat</a></li>
<li><a href="../id443312/index.html">Manajemen memori python</a></li>
<li><a href="../id443316/index.html">Pengujian ReactJS: Seberapa Dalam Lubang Kelinci itu</a></li>
<li><a href="../id443320/index.html">Sistem manajemen dokumen elektronik "Wazir"</a></li>
<li><a href="../id443322/index.html">GitLab 11.8 dirilis dengan SAST untuk JavaScript, GitLab Pages untuk subkelompok dan pelacakan bug</a></li>
<li><a href="../id443324/index.html">Python vs. Scala for Apache Spark - benchmark yang diharapkan dengan hasil yang tidak terduga</a></li>
<li><a href="../id443326/index.html">Python & Arduino. Sederhana, cepat dan cantik</a></li>
<li><a href="../id443330/index.html">Minggu Keamanan 11: RSA 2019 dan masa depan yang lebih cerah</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>