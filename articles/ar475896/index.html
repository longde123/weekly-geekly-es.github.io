<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ธ๐ฝ ๐ ๐๐ผ ูุงูู I / O ุนุงุฑูุฉ C ููุงุนู ๐ ๐ถ๏ธ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฏูุฉ 


 ููุงุนู I / O ( ุญููุฉ ุญุฏุซ ููุฑุฏุฉ ุงูุชุฑุงุจุท) ูู ููุท ููุชุงุจุฉ ุงูุจุฑุงูุฌ ุงููุญููุฉ ุจุฏุฑุฌุฉ ุนุงููุฉ ุ ููุณุชุฎุฏู ูู ุงูุนุฏูุฏ ูู ุงูุญููู ุงูุดุงุฆุนุฉ: 


- ููุฏ.ุฌู ุฅุณ 
- ุชูุฑ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูุงูู I / O ุนุงุฑูุฉ C ููุงุนู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475896/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/2g/w7/vr/2gw7vrlwgzkro-gf3hkbj7jxqzu.png"></p><br><h1 id="vvedenie" style=";text-align:right;direction:rtl">  ููุฏูุฉ </h1><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ููุงุนู I / O</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุญููุฉ ุญุฏุซ</a> ููุฑุฏุฉ ุงูุชุฑุงุจุท) ูู ููุท ููุชุงุจุฉ ุงูุจุฑุงูุฌ ุงููุญููุฉ ุจุฏุฑุฌุฉ ุนุงููุฉ ุ ููุณุชุฎุฏู ูู ุงูุนุฏูุฏ ูู ุงูุญููู ุงูุดุงุฆุนุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ููุฏ.ุฌู ุฅุณ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุชูุฑ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ููู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุงููุฑูู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุฃุนุทูุง</a> </li><li style=";text-align:right;direction:rtl">  ... </li></ul><br><p style=";text-align:right;direction:rtl">  ูู ูุฐู ุงูููุงูุฉ ุ ุณููุธุฑ ูู ุฎุตูุตูุงุช ูุนููููุงุช ููุงุนู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ููุจุฏุฃ ุชุดุบููู ุ ููุชุงุจุฉ ุชุทุจูู ูุฃูู ูู 200 ุณุทุฑ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ููุฑุถ ุฎุงุฏู HTTP ุจุณูุท ููุนุงูุฌุฉ ุฃูุซุฑ ูู 40 ููููู ุทูุจ / ุฏูููุฉ. </p><a name="habracut"></a><br><h1 id="predislovie" style=";text-align:right;direction:rtl">  ููุฏูุฉ </h1><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชูุช ูุชุงุจุฉ ุงูููุงู ุจูุฏู ุงููุณุงุนุฏุฉ ูู ููู ุนูู ููุงุนู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุ ูุจุงูุชุงูู ุฅุฏุฑุงู ุงููุฎุงุทุฑ ุนูุฏ ุงุณุชุฎุฏุงูู. </li><li style=";text-align:right;direction:rtl">  ูุฅุชูุงู ุงูููุงู ุ ููุฒู ูุนุฑูุฉ ุฃุณุงุณูุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุงููุบุฉ C</a> ูุชุฌุฑุจุฉ ุตุบูุฑุฉ ูู ุชุทููุฑ ุชุทุจููุงุช ุงูุดุจูุฉ. </li><li style=";text-align:right;direction:rtl">  ุชุชู ูุชุงุจุฉ ุฌููุน ุงูุดูุฑุงุช ูู ูุบุฉ C ุจุฏูุฉ ููููุง ูู ( <strong>ุจุนูุงูุฉ: PDF ุทููู</strong> ) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ูุนูุงุฑ C11</a> ููุธุงู Linux ููู ูุชุงุญ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">GitHub</a> . </li></ul><br><h1 id="zachem-eto-nuzhno" style=";text-align:right;direction:rtl">  ููุงุฐุง ูุฐุง ูุทููุจุ </h1><br><p style=";text-align:right;direction:rtl">  ูุน ุงุฒุฏูุงุฏ ุดุนุจูุฉ ุงูุฅูุชุฑูุช ุ ุชุญุชุงุฌ ุฎูุงุฏู ุงูููุจ ุฅูู ูุนุงูุฌุฉ ุนุฏุฏ ูุจูุฑ ูู ุงูุงุชุตุงูุงุช ูู ููุณ ุงูููุช ุ ูุจุงูุชุงูู ุชูุช ุชุฌุฑุจุฉ ุทุฑููุชูู: ุญุธุฑ ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุนูู ุนุฏุฏ ูุจูุฑ ูู ุณูุงุณู ุนูููุงุช OS ูุฅุฏุฎุงู / ุฅุฎุฑุงุฌ ุบูุฑ ูุญุธูุฑ ูุน ูุธุงู ุฅุฎุทุงุฑ ุงูุฃุญุฏุงุซ ุ ูุงูุฐู ูุณูู ุฃูุถูุง "system" ูุญุฏุฏ "( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">epoll</a> / <a href="" rel="nofollow">kqueue</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">IOCP</a> / etc). </p><br><p style=";text-align:right;direction:rtl">  ุชุชุถูู ุงูุทุฑููุฉ ุงูุฃููู ุฅูุดุงุก ูุคุดุฑ ุชุฑุงุจุท ูุธุงู ุชุดุบูู ุฌุฏูุฏ ููู ุงุชุตุงู ูุงุฑุฏ.  ุงูุนูุจ ูู ุถุนู ูุงุจููุฉ ุงูุชูุณุน: ุณูุชุนูู ุนูู ูุธุงู ุงูุชุดุบูู ุฅุฌุฑุงุก ุงูุนุฏูุฏ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุงูุชูุงูุงุช ุงูุณูุงู</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ูููุงููุงุช ุงููุธุงู</a> .  ุฅููุง ุนูููุงุช ุจุงูุธุฉ ุงูุซูู ููููู ุฃู ุชุคุฏู ุฅูู ููุต ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุงููุฌุงููุฉ ูุน ูุฌูุฏ ุนุฏุฏ ูุจูุฑ ูู ุงูุงุชุตุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ูุฎุตุต ุงูุฅุตุฏุงุฑ ุงููุนุฏู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุนุฏุฏูุง ุซุงุจุชูุง ูู ูุคุดุฑุงุช</a> ุงูุชุฑุงุจุท (ุชุฌูุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ูุคุดุฑุงุช</a> ุงูุชุฑุงุจุท) ุ ูุจุงูุชุงูู ูููุน ุงููุธุงู ูู ุฅููุงู ุงูุชูููุฐ ุจุดูู ุบูุฑ ุทุจูุนู ุ ูููู ูู ููุณ ุงูููุช ููุฏู ูุดููุฉ ุฌุฏูุฏุฉ: ุฅุฐุง ูุงู ุชุฌูุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ูุคุดุฑุงุช</a> ุงูุชุฑุงุจุท ูุญุธูุฑูุง ูู ุงูููุช ุงููุญุฏุฏ ูู ุฎูุงู ุนูููุงุช ุงููุฑุงุกุฉ ุงูุทูููุฉ ุ ูุฅู ูุขุฎุฐ ุงูุชูุตูู ุงูุฃุฎุฑู ุงูุชู ูููููุง ุจุงููุนู ุชููู ุงูุจูุงูุงุช ูู ุชููู ูุงุฏุฑุฉ ุนูู ุงูููุงู ุจุฐูู. </p><br><p style=";text-align:right;direction:rtl">  ูุณุชุฎุฏู ุงูุฃุณููุจ ุงูุซุงูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ูุธุงู ุฅุนูุงู ุงูุฃุญุฏุงุซ</a> (ูุญุฏุฏ ุงููุธุงู) ุงูุฐู ูููุฑู ูุธุงู ุงูุชุดุบูู.  ุชุชูุงูู ูุฐู ุงูููุงูุฉ ุงูููุน ุงูุฃูุซุฑ ุดููุนูุง ูู ูุญุฏุฏ ุงููุธุงู ุงุณุชูุงุฏูุง ุฅูู ุงูุชูุจููุงุช (ุงูุฃุญุฏุงุซ ูุงูุฅุดุนุงุฑุงุช) ุญูู ุงูุงุณุชุนุฏุงุฏ ูุนูููุงุช ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุ ุจุฏูุงู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุงูุชูุจููุงุช ุญูู ุงูุชูุงููุง</a> .  ูููู ุชูุซูู ูุซุงู ูุจุณุท ูุงุณุชุฎุฏุงูู ุจูุงุณุทุฉ ุงููุฎุทุท ุงูุงูุณูุงุจู ุงูุชุงูู: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/rw/kb/yo/rwkbyokmirpu7hpd6yzc47-k4va.png"></p><br><p style=";text-align:right;direction:rtl">  ุงููุฑู ุจูู ูุฐู ุงูุฃุณุงููุจ ูุงูุชุงูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุคุฏู ุญุธุฑ ุนูููุงุช ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุฅูู <strong>ุชุนููู</strong> ุฏูู ุงููุณุชุฎุฏู <strong>ุญุชู ูููู</strong> ูุธุงู ุงูุชุดุบูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุจุฅูุบุงุก ุชุฌุฒุฆุฉ</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุญุฒู IP</a> ุงููุงุฑุฏุฉ ุจุดูู ุตุญูุญ ูู ุฏูู ุงูุจุงูุช ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">TCP</a> ุ ุงุณุชูุจุงู ุงูุจูุงูุงุช) ุฃู ุชุญุฑูุฑ ูุณุงุญุฉ ูุงููุฉ ูู ูุฎุงุฒู ุงููุชุงุจุฉ ุงูุฏุงุฎููุฉ ุงููุคูุชุฉ ููุฅุฑุณุงู ุงููุงุญู ุนุจุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">NIC</a> (ุฅุฑุณุงู ุงูุจูุงูุงุช). </li><li style=";text-align:right;direction:rtl">  <strong>ุจุนุฏ ูุชุฑุฉ ูู ุงูููุช ุ</strong> ูููู ูุญุฏุฏ ุงููุธุงู ุจุฅุฎุทุงุฑ ุงูุจุฑูุงูุฌ ุจุฃู ูุธุงู ุงูุชุดุบูู <strong>ูุงู ุจุงููุนู</strong> ุจุฅูุบุงุก ุชุฌุฒุฆุฉ ุญุฒู IP (TCP ุ ุงุณุชูุจุงู ุงูุจูุงูุงุช) ุฃู ุฃู ูุณุงุญุฉ ูุงููุฉ ูู ูุฎุงุฒู ุงูุชุฎุฒูู ุงูุฏุงุฎููุฉ ููุชุณุฌูู ูุชุงุญุฉ <strong>ุจุงููุนู</strong> (ุฅุฑุณุงู ุงูุจูุงูุงุช). </li></ul><br><p style=";text-align:right;direction:rtl">  ููุชูุฎูุต ุ ูุนุฏ ุญุฌุฒ ูุคุดุฑ ุชุฑุงุจุท ูุธุงู ุงูุชุดุบูู ููู ุฅุฏุฎุงู / ุฅุฎุฑุงุฌ ูุถูุนุฉ ูููุฉ ุงูุญูุณุจุฉ ุ ูุฃูู ูู ุงููุงูุน ุ ูุง ุชุดุบู ูุคุดุฑุงุช ุงูุชุฑุงุจุท ุนูููุง ูููุฏูุง (ูุตุทูุญ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">"ููุงุทุนุฉ ุงูุจุฑูุงูุฌ"</a> ูู ุฌุฐูุฑู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ููู</a> ).  ูุนูู ูุญุฏุฏ ุงููุธุงู ุนูู ุญู ูุฐู ุงููุดููุฉ ุนู ุทุฑูู ุงูุณูุงุญ ูุจุฑูุงูุฌ ุงููุณุชุฎุฏู ุจุงุณุชููุงู ููุงุฑุฏ ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุจุทุฑููุฉ ุฃูุซุฑ ุงูุชุตุงุฏุง. </p><br><h1 id="model-io-reaktora" style=";text-align:right;direction:rtl">  ููุงุนู I / O ูููุฐุฌ </h1><br><p style=";text-align:right;direction:rtl">  ูุนูู ููุงุนู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ูุทุจูุฉ ุจูู ูุญุฏุฏ ุงููุธุงู ูุฑูุฒ ุงููุณุชุฎุฏู.  ูุชู ูุตู ูุจุฏุฃ ุนูููุง ูู ุฎูุงู ุงููุฎุทุท ุงูุงูุณูุงุจู ุงูุชุงูู: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/6j/v9/-m/6jv9-mplsvirwimvaej1zzyu2oa.png"></p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณูุญูุง ูู ุฃู ุฃุฐูุฑู ุจุฃู ูุฐุง ุงูุญุฏุซ ูู ุฅุฎุทุงุฑ ุจุฃู ูุฃุฎุฐ ุชูุตูู ูุนูู ูุงุฏุฑ ุนูู ุฅุฌุฑุงุก ุนูููุฉ ุฅุฏุฎุงู / ุฅุฎุฑุงุฌ ุบูุฑ ูุญุธูุฑุฉ. </li><li style=";text-align:right;direction:rtl">  ูุนุงูุฌ ุงูุฃุญุฏุงุซ ูู ูุธููุฉ ูุทูู ุนูููุง ููุงุนู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุนูุฏ ุชููู ุญุฏุซ ุ ูุงูุฐู ูููู ุจุนุฏ ุฐูู ุจุฅุฌุฑุงุก ุนูููุฉ ุฅุฏุฎุงู / ุฅุฎุฑุงุฌ ุบูุฑ ูุญุธูุฑุฉ. </li></ul><br><p style=";text-align:right;direction:rtl">  ูู ุงูููู ุฃู ููุงุญุธ ุฃู ููุงุนู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ูู ุจุญูู ุงูุชุนุฑูู ูุชุฑุงุจุท ูุงุญุฏ ุ ูููู ูุง ุดูุก ูููุน ุงุณุชุฎุฏุงู ุงูููููู ูู ุจูุฆุฉ ูุชุนุฏุฏุฉ ุงูุฎููุท ูููุง ูุชุนูู ุจุชูุงุฑ ูุงุญุฏ: 1 ููุงุนู ุ ูุจุงูุชุงูู ูุณุชุฎุฏู ุฌููุน ุงูููู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ. </p><br><h1 id="realizaciya" style=";text-align:right;direction:rtl">  ุชุทุจูู </h1><br><p style=";text-align:right;direction:rtl"> ูุถุน ุงููุงุฌูุฉ ุงูุนุงูุฉ ูู ููู <a href="" rel="nofollow"><code>reactor.h</code></a> ุ ูุงูุชุทุจูู ูู <a href="" rel="nofollow"><code>reactor.c</code></a> .  ุณูู ุชุชููู <code>reactor.h</code> ูู ุงูุชุตุฑูุญุงุช ุงูุชุงููุฉ: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุนุฑุถ ุงูุฅุนูุงูุงุช ูู reactor.h</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reactor</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Reactor</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-comment"><span class="hljs-comment">/* *   ,    I/O    *    . */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">typedef</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*Callback)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *arg, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fd, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> events)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/* *  `NULL`   , -`NULL`   `Reactor`  *  . */</span></span> <span class="hljs-function"><span class="hljs-function">Reactor *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reactor_new</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/* *   ,       *    I/O . * *    -1   , 0   . */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reactor_destroy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Reactor *reactor)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reactor_register</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Reactor *reactor, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fd, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> interest, Callback callback, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *callback_arg)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reactor_deregister</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Reactor *reactor, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fd)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reactor_reregister</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Reactor *reactor, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fd, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> interest, Callback callback, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *callback_arg)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/* *     - `timeout`. * *           * /    . */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reactor_run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Reactor *reactor, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">time_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> timeout)</span></span></span></span>;</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุชุชููู ุจููุฉ I / O ุงูุฎุงุตุฉ ุจุงูููุงุนู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ูุงุตู ููู</a> ูุญุฏุฏ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">epoll</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><code>GHashTable</code></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุชุฌุฒุฆุฉ</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><code>GHashTable</code></a> ุ ูููู ูู ููุจุณ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><code>GHashTable</code></a> ุฅูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><code>GHashTable</code></a> (ุจููุฉ ูู ูุนุงูุฌ ุญุฏุซ ูุณูุทุฉ ูุณุชุฎุฏู ูู). </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุธูุงุฑ ููุงุนู ู CallbackData</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reactor</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> epoll_fd; GHashTable *table; <span class="hljs-comment"><span class="hljs-comment">// (int, CallbackData) }; typedef struct { Callback callback; void *arg; } CallbackData;</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุฑุฌู ููุงุญุธุฉ ุฃููุง ุงุณุชุฎุฏููุง ุงููุฏุฑุฉ ุนูู ุงูุชุนุงูู ูุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ููุน ุบูุฑ ููุชูู</a> ุนู ุทุฑูู ุงููุคุดุฑ.  ูู <code>reactor.h</code> ูุนูู ุนู ุจููุฉ <code>reactor</code> ุ ู ูู <code>reactor.c</code> ุจุชุนุฑููู ุ ูุจุงูุชุงูู ูููุน ุงููุณุชุฎุฏู ูู ุชุบููุฑ ุญูููู ุจุดูู ุตุฑูุญ.  ูุฐุง ูู ูุงุญุฏ ูู ุฃููุงุท <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุฅุฎูุงุก ุงูุจูุงูุงุช</a> ุงูุชู ุชูุงุณุจ ุนุถููุง ูู ุฏูุงูุงุช C. </p><br><p style=";text-align:right;direction:rtl">  ุชููู <code>reactor_register</code> <code>reactor_deregister</code> ู <code>reactor_deregister</code> ู <code>reactor_reregister</code> ุจุชุญุฏูุซ ูุงุฆูุฉ ูุขุฎุฐ ุงูุงูุชูุงู ููุนุงูุฌุงุช ุงูุฃุญุฏุงุซ ุงูููุงุธุฑุฉ ูู ูุญุฏุฏ ุงููุธุงู ููู ุฌุฏูู ุงูุชุฌุฒุฆุฉ. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุธูุงุฑ ููุฒุงุช ุงูุชุณุฌูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> REACTOR_CTL(reactor, op, fd, interest) \ </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (epoll_ctl(reactor-&gt;epoll_fd, op, fd, \ &amp;(struct epoll_event){.events = interest, \ .data = {.fd = fd}}) == -1) { \ perror(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"epoll_ctl"</span></span></span><span class="hljs-meta">); \ return -1; \ } int reactor_register(const Reactor *reactor, int fd, uint32_t interest, Callback callback, void *callback_arg) { REACTOR_CTL(reactor, EPOLL_CTL_ADD, fd, interest) g_hash_table_insert(reactor-&gt;table, int_in_heap(fd), callback_data_new(callback, callback_arg)); return 0; } int reactor_deregister(const Reactor *reactor, int fd) { REACTOR_CTL(reactor, EPOLL_CTL_DEL, fd, 0) g_hash_table_remove(reactor-&gt;table, &amp;fd); return 0; } int reactor_reregister(const Reactor *reactor, int fd, uint32_t interest, Callback callback, void *callback_arg) { REACTOR_CTL(reactor, EPOLL_CTL_MOD, fd, interest) g_hash_table_insert(reactor-&gt;table, int_in_heap(fd), callback_data_new(callback, callback_arg)); return 0; }</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุงุนุชุฑุงุถ ููุงุนู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุงูุญุฏุซ ูุน ูุงุตู <code>fd</code> ุ ูุฅูู ูุณุชุฏุนู ูุนุงูุฌ ุงูุญุฏุซ ุงูููุงุจู ุ ูุงูุฐู ููุฑุฑ ููู <code>fd</code> ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ูููุงุน ุจุช</a> ุงูุฃุญุฏุงุซ ุงูุชู ุชู ุฅูุดุงุคูุง ุ ููุคุดุฑ ุงููุณุชุฎุฏู ููุชู <code>void</code> . </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุธูุงุฑ ูุธููุฉ reactor_run ()</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reactor_run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Reactor *reactor, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">time_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> timeout)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> result; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">epoll_event</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">events</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((events = <span class="hljs-built_in"><span class="hljs-built_in">calloc</span></span>(MAX_EVENTS, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(*events))) == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">abort</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">time_t</span></span> start = time(<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">time_t</span></span> passed = time(<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) - start; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> nfds = epoll_wait(reactor-&gt;epoll_fd, events, MAX_EVENTS, timeout - passed); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (nfds) { <span class="hljs-comment"><span class="hljs-comment">//  case -1: perror("epoll_wait"); result = -1; goto cleanup; //   case 0: result = 0; goto cleanup; //   default: //    for (int i = 0; i &lt; nfds; i++) { int fd = events[i].data.fd; CallbackData *callback = g_hash_table_lookup(reactor-&gt;table, &amp;fd); callback-&gt;callback(callback-&gt;arg, fd, events[i].events); } } } cleanup: free(events); return result; }</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุชูุฎูุต ุ ุณุชุชุฎุฐ ุณูุณูุฉ ุงุณุชุฏุนุงุกุงุช ุงููุธุงุฆู ูู ููุฏ ุงููุณุชุฎุฏู ุงูุดูู ุงูุชุงูู: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/5r/zj/wu/5rzjwuyiu4e3f-wfvtumltvuz3i.png"></p><br><h1 id="odnopotochnyy-server" style=";text-align:right;direction:rtl">  ุฎุงุฏู ูุงุญุฏ ูุชุฑุงุจุทุฉ </h1><br><p style=";text-align:right;direction:rtl">  ูู ุฃุฌู ุงุฎุชุจุงุฑ ููุงุนู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุชุญุช ุชุญููู ุนุงูู ุ ุณููุชุจ ุฎุงุฏู ููุจ HTTP ุจุณูุท ููุฑุฏ ุนูู ุฃู ุทูุจ ูุน ุตูุฑุฉ. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุฑุฌุน ุจุฑูุชูููู HTTP ุงูุณุฑูุน</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">HTTP</a> ูู ุจุฑูุชูููู ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ูุณุชูู ุงูุชุทุจูู</a> ูุณุชุฎุฏู ุจุดูู ุฃุณุงุณู ูุชูุงุนู ุงูุฎุงุฏู ูุน ุงููุณุชุนุฑุถ. </p><br><p style=";text-align:right;direction:rtl">  ูููู ุจุณูููุฉ ุงุณุชุฎุฏุงู HTTP ุฃุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุจุฑูุชูููู</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ููู</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">TCP</a> ุ ูุฅุฑุณุงู ูุงุณุชูุจุงู ุฑุณุงุฆู ุจุงูุชูุณูู ุงููุญุฏุฏ ุจูุงุณุทุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุงูููุงุตูุงุช</a> . </p><br><h3 id="format-zaprosa" style=";text-align:right;direction:rtl">  ุทูุจ ุชูุณูู </h3><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">&lt;&gt; &lt;URI&gt; &lt; HTTP&gt;CRLF &lt; 1&gt;CRLF &lt; 2&gt;CRLF &lt; N&gt;CRLF CRLF &lt;&gt;</code> </pre> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>CRLF</code> ุนุจุงุฑุฉ ุนู ุณูุณูุฉ ูู ุญุฑููู: <code>\r</code> ู <code>\n</code> ุ ุชูุตู ุงูุณุทุฑ ุงูุฃูู ูู ุงูุงุณุชุนูุงู ูุงูุฑุคูุณ ูุงูุจูุงูุงุช. </li><li style=";text-align:right;direction:rtl">  <code>&lt;&gt;</code> ูู ูุงุญุฏุฉ ูู <code>CONNECT</code> ู <code>DELETE</code> ู <code>GET</code> ู <code>HEAD</code> ู <code>OPTIONS</code> ู <code>PATCH</code> ู <code>POST</code> ู <code>PUT</code> ู <code>TRACE</code> .  ุณูุฑุณู ุงููุชุตูุญ ุฃูุฑ <code>GET</code> ุฅูู ุฎุงุฏููุง ุ ุจูุนูู "ุฃุฑุณู ูู ูุญุชููุงุช ุงูููู". </li><li style=";text-align:right;direction:rtl">  <code>&lt;URI&gt;</code> ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ูุนุฑู ุงูููุฑุฏ ุงูููุญุฏ</a> .  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู URI = <code>/index.html</code> ุ <code>/index.html</code> ุงูุนููู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ูููููุน. </li><li style=";text-align:right;direction:rtl">  <code>&lt; HTTP&gt;</code> - ุฅุตุฏุงุฑ ุจุฑูุชูููู <code>HTTP/XY</code> ุจุชูุณูู <code>HTTP/XY</code> .  ุงูุฅุตุฏุงุฑ ุงูุฃูุซุฑ ุงุณุชุฎุฏุงููุง ุญุชู ุงูุขู ูู <code>HTTP/1.1</code> . </li><li style=";text-align:right;direction:rtl">  <code>&lt; N&gt;</code> ูู ุฒูุฌ ุฐู ูููุฉ <code>&lt;&gt;: &lt;&gt;</code> ุจุงูุชูุณูู <code>&lt;&gt;: &lt;&gt;</code> ุ ุชู ุฅุฑุณุงูู ุฅูู ุงูุฎุงุฏู ููุฒูุฏ ูู ุงูุชุญููู. </li><li style=";text-align:right;direction:rtl">  <code>&lt;&gt;</code> - ุงูุจูุงูุงุช ุงููุทููุจุฉ ูู ูุจู ุงูุฎุงุฏู ูุฅููุงู ุงูุนูููุฉ.  ุบุงูุจูุง ูุง ูููู ูุฌุฑุฏ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">JSON</a> ุฃู ุฃู ุชูุณูู ุขุฎุฑ. </li></ul><br><h3 id="format-otveta" style=";text-align:right;direction:rtl">  ุชูุณูู ุงูุงุณุชุฌุงุจุฉ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">&lt; HTTP&gt; &lt; &gt; &lt; &gt;CRLF &lt; 1&gt;CRLF &lt; 2&gt;CRLF &lt; N&gt;CRLF CRLF &lt;&gt;</code> </pre> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>&lt; &gt;</code> ูู ุฑูู ููุซู ูุชูุฌุฉ ุงูุนูููุฉ.  ุณูุฑุฌุน ุฎุงุฏููุง ุฏุงุฆููุง ุฅูู ุงูุญุงูุฉ 200 (ุงูุชุดุบูู ุงููุงุฌุญ). </li><li style=";text-align:right;direction:rtl">  <code>&lt; &gt;</code> - ุชูุซูู ุณูุณูุฉ ูุฑูุฒ ุงูุญุงูุฉ.  ูุฑูุฒ ุงูุญุงูุฉ 200 ุ ูุฐุง <code>OK</code> . </li><li style=";text-align:right;direction:rtl">  <code>&lt; N&gt;</code> - ุฑุฃุณ ุจููุณ ุงูุชูุณูู ููุง ูู ุงูุทูุจ.  ุณูููู ุจุฅุฑุฌุงุน ุฑุคูุณ <code>Content-Length</code> (ุญุฌู ุงูููู) ูููุน <code>Content-Type: text/html</code> (ุจูุงูุงุช ููุน ุงูุฅุฑุฌุงุน). </li><li style=";text-align:right;direction:rtl">  <code>&lt;&gt;</code> - ุงูุจูุงูุงุช ุงููุทููุจุฉ ูู ูุจู ุงููุณุชุฎุฏู.  ูู ุญุงูุชูุง ุ ูุฐุง ูู ุงููุณุงุฑ ุฅูู ุงูุตูุฑุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">HTML</a> . </li></ul></div></div><br><p style=";text-align:right;direction:rtl">  ูุชุถูู <a href="https://github.com/Hippolot/reactor-c/blob/master/" rel="nofollow"><code>http_server.c</code></a> (ุฎุงุฏู ุฐู <a href="https://github.com/Hippolot/reactor-c/blob/master/" rel="nofollow"><code>http_server.c</code></a> ูุฑุฏูุฉ) ููู <a href="" rel="nofollow"><code>common.h</code></a> ุ ูุงูุฐู ูุญุชูู ุนูู ููุงุฐุฌ ุฃูููุฉ ูููุธููุฉ ุงูุชุงููุฉ: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุธูุงุฑ ุงูููุงุฐุฌ ุงูุฃูููุฉ ูููุธููุฉ ูู common.h</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/* *  ,    ,    *    . */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_accept</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *arg, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fd, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> events)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/* *  ,    ,    *   HTTP . */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_send</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *arg, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fd, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> events)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/* *  ,    ,    *    HTTP . */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_recv</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *arg, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fd, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> events)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/* *      . */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set_nonblocking</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fd)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/* *     stderr      *  `EXIT_FAILURE`. */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> noreturn </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fail</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *format, ...)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">/* *    ,    * TCP . */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new_server</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> reuse_port)</span></span></span></span>;</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  <code>SAFE_CALL()</code> ุงููุงูุฑู ุงูุฏุงูุฉ <code>SAFE_CALL()</code> ุฃูุถูุง ูุชุนุฑู ุงูุฏุงูุฉ <code>fail()</code> .  ููุงุฑู ุงููุงูุฑู ูููุฉ ุงูุชุนุจูุฑ ูุน ุงูุฎุทุฃ ุ ูุฅุฐุง ุชู ุงุณุชููุงุก ุงูุดุฑุท ุ ูุฅูู ูุณุชุฏุนู ุงูุฏุงูุฉ <code>fail()</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SAFE_CALL(call, </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">error</span></span></span><span class="hljs-meta">) \ do { \ </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ((call) == </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">error</span></span></span><span class="hljs-meta">) { \ fail(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"%s"</span></span></span><span class="hljs-meta">, #call); \ } \ } while (false)</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชููู ุงูุฏุงูุฉ <code>fail()</code> ุจุทุจุงุนุฉ ุงููุณุงุฆุท ุงูุชู ุชู ุชูุฑูุฑูุง ุฅูู ุงูุฌูุงุฒ ุงูุทุฑูู (ูุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><code>printf()</code></a> ) ูุชููู ุงูุจุฑูุงูุฌ ุจุฑูุฒ <code>EXIT_FAILURE</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> noreturn </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fail</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *format, ...)</span></span></span><span class="hljs-function"> </span></span>{ va_list args; va_start(args, format); <span class="hljs-built_in"><span class="hljs-built_in">vfprintf</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">stderr</span></span>, format, args); va_end(args); <span class="hljs-built_in"><span class="hljs-built_in">fprintf</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">stderr</span></span>, <span class="hljs-string"><span class="hljs-string">": %s\n"</span></span>, strerror(errno)); <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>(EXIT_FAILURE); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุฑุฌุน ุงูุฏุงูุฉ <code>new_server()</code> ูุงุตู ููู ูุฃุฎุฐ ุชูุตูู "ุงูุฎุงุฏู" ุงูุฐู ุชู ุฅูุดุงุคู ุจูุงุณุทุฉ ุงุณุชุฏุนุงุก ุงููุธุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><code>socket()</code></a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><code>bind()</code></a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><code>listen()</code></a> ููุงุฏุฑุฉ ุนูู ูุจูู ุงูุงุชุตุงูุงุช ุงููุงุฑุฏุฉ ูู ูุถุน ุนุฏู ุงูุญุธุฑ. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุธูุงุฑ ุงููุธููุฉ new_server ()</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new_server</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> reuse_port)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> fd; SAFE_CALL((fd = socket(AF_INET, SOCK_STREAM | SOCK_NONBLOCK, IPPROTO_TCP)), <span class="hljs-number"><span class="hljs-number">-1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reuse_port) { SAFE_CALL( setsockopt(fd, SOL_SOCKET, SO_REUSEPORT, &amp;(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>){<span class="hljs-number"><span class="hljs-number">1</span></span>}, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)), <span class="hljs-number"><span class="hljs-number">-1</span></span>); } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sockaddr_in</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">addr</span></span></span><span class="hljs-class"> = {</span></span>.sin_family = AF_INET, .sin_port = htons(SERVER_PORT), .sin_addr = {.s_addr = inet_addr(SERVER_IPV4)}, .sin_zero = {<span class="hljs-number"><span class="hljs-number">0</span></span>}}; SAFE_CALL(bind(fd, (struct sockaddr *)&amp;addr, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(addr)), <span class="hljs-number"><span class="hljs-number">-1</span></span>); SAFE_CALL(listen(fd, SERVER_BACKLOG), <span class="hljs-number"><span class="hljs-number">-1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fd; }</code> </pre> </div></div><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุงุญุธ ุฃูู ูุชู ุฅูุดุงุก ูุฃุฎุฐ ุงูุชูุตูู ูุจุฏุฆููุง ูู ูุถุน ุนุฏู ุงูุญุธุฑ ุจุงุณุชุฎุฏุงู ุนูุงูุฉ <code>SOCK_NONBLOCK</code> ุ ุจุญูุซ ูู <code>on_accept()</code> (ููุฒูุฏ ูู ุงููุฑุงุกุฉ) ุ ูุง ูุชููู ุงุณุชุฏุนุงุก ูุธุงู <code>accept()</code> ุนู ุชูููุฐ ุงูุฏูู. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู <code>reuse_port</code> <code>true</code> ุ <code>reuse_port</code> ูุฐู ุงููุธููุฉ ุจุชููุฆุฉ ุงูููุจุณ ุจุงุณุชุฎุฏุงู ุฎูุงุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><code>SO_REUSEPORT</code></a> ุจุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><code>setsockopt()</code></a> ูุงุณุชุฎุฏุงู ููุณ ุงููููุฐ ูู ุจูุฆุฉ ูุชุนุฏุฏุฉ ุงูุฎููุท (ุงูุธุฑ ุงููุณู "ุฎุงุฏู ูุชุนุฏุฏ ุงูุฎููุท"). </li></ul><br><p style=";text-align:right;direction:rtl">  ูุชู <code>on_accept()</code> ูุนุงูุฌ ุงูุฃุญุฏุงุซ <code>on_accept()</code> ุจุนุฏ ููุงู ูุธุงู ุงูุชุดุบูู ุจุฅูุดุงุก ุญุฏุซ <code>EPOLLIN</code> ุ ููุง ูุนูู ูู ูุฐู ุงูุญุงูุฉ ุฃูู ูููู ูุจูู ุงุชุตุงู ุฌุฏูุฏ.  ููุจู <code>on_accept()</code> ุงุชุตุงููุง ุฌุฏูุฏูุง ุ <code>on_accept()</code> ุจุงูุชุจุฏูู ุฅูู ูุถุน ุนุฏู ุงูุญุธุฑ ููุณุฌู ุจุงุณุชุฎุฏุงู ูุนุงูุฌ ุงูุฃุญุฏุงุซ <code>on_recv()</code> ูู ููุงุนู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุธูุงุฑ ูุธููุฉ on_accept ()</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_accept</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *arg, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fd, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> events)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> incoming_conn; SAFE_CALL((incoming_conn = accept(fd, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>)), <span class="hljs-number"><span class="hljs-number">-1</span></span>); set_nonblocking(incoming_conn); SAFE_CALL(reactor_register(reactor, incoming_conn, EPOLLIN, on_recv, request_buffer_new()), <span class="hljs-number"><span class="hljs-number">-1</span></span>); }</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุชู <code>on_recv()</code> ูุนุงูุฌ ุงูุฃุญุฏุงุซ <code>on_recv()</code> ุจุนุฏ ููุงู ูุธุงู ุงูุชุดุบูู ุจุฅูุดุงุก ุญุฏุซ <code>EPOLLIN</code> ุ ููุง ูุนูู ูู ูุฐู ุงูุญุงูุฉ ุฃู ุงูุงุชุตุงู ุงููุณุฌู <code>on_accept()</code> ุฌุงูุฒ ูุงุณุชูุจุงู ุงูุจูุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  <code>on_recv()</code> ุจูุฑุงุกุฉ ุงูุจูุงูุงุช ูู ุงูุงุชุตุงู ุญุชู ูุชู ุงุณุชูุงู ุทูุจ HTTP ุงููุงูู ุ ุซู ูููู ุจุชุณุฌูู ูุนุงูุฌ <code>on_send()</code> ูุฅุฑุณุงู ุงุณุชุฌุงุจุฉ HTTP.  ูู ุญุงูุฉ ูุทุน ุงุชุตุงู ุงูุนููู ุ ูุชู ุฅูุบุงุก ุชุซุจูุช ูุฃุฎุฐ ุงูุชูุตูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><code>close()</code></a> . </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุธูุงุฑ ูุธููุฉ on_recv ()</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_recv</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *arg, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fd, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> events)</span></span></span><span class="hljs-function"> </span></span>{ RequestBuffer *buffer = arg; <span class="hljs-comment"><span class="hljs-comment">//      ,  recv  0   ssize_t nread; while ((nread = recv(fd, buffer-&gt;data + buffer-&gt;size, REQUEST_BUFFER_CAPACITY - buffer-&gt;size, 0)) &gt; 0) buffer-&gt;size += nread; //    if (nread == 0) { SAFE_CALL(reactor_deregister(reactor, fd), -1); SAFE_CALL(close(fd), -1); request_buffer_destroy(buffer); return; } // read  ,   ,     //  if (errno != EAGAIN &amp;&amp; errno != EWOULDBLOCK) { request_buffer_destroy(buffer); fail("read"); } //   HTTP   .    //     if (request_buffer_is_complete(buffer)) { request_buffer_clear(buffer); SAFE_CALL(reactor_reregister(reactor, fd, EPOLLOUT, on_send, buffer), -1); } }</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุชู <code>on_send()</code> ูุนุงูุฌ ุงูุฃุญุฏุงุซ <code>on_send()</code> ุจุนุฏ ููุงู ูุธุงู ุงูุชุดุบูู ุจุฅูุดุงุก ุญุฏุซ <code>EPOLLOUT</code> ุ ููุง ูุนูู ุฃู ุงูุงุชุตุงู ุงููุณุฌู ุจูุงุณุทุฉ <code>on_recv()</code> ุฌุงูุฒ ูุฅุฑุณุงู ุงูุจูุงูุงุช.  ุชุฑุณู ูุฐู ุงููุธููุฉ ุงุณุชุฌุงุจุฉ HTTP ุชุญุชูู ุนูู HTML ูุน ุงูุตูุฑุฉ ุฅูู ุงูุนููู ุ ุซู ุชููู ุจุชุบููุฑ ูุนุงูุฌ ุงูุฃุญุฏุงุซ ุฅูู <code>on_recv()</code> ูุฑุฉ ุฃุฎุฑู. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุธูุงุฑ ูุธููุฉ on_send ()</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_send</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *arg, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fd, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> events)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *content = <span class="hljs-string"><span class="hljs-string">"&lt;img "</span></span> <span class="hljs-string"><span class="hljs-string">"src=\"https://habrastorage.org/webt/oh/wl/23/"</span></span> <span class="hljs-string"><span class="hljs-string">"ohwl23va3b-dioerobq_mbx4xaw.jpeg\"&gt;"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> response[<span class="hljs-number"><span class="hljs-number">1024</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(response, <span class="hljs-string"><span class="hljs-string">"HTTP/1.1 200 OK"</span></span> CRLF <span class="hljs-string"><span class="hljs-string">"Content-Length: %zd"</span></span> CRLF <span class="hljs-string"><span class="hljs-string">"Content-Type: "</span></span> <span class="hljs-string"><span class="hljs-string">"text/html"</span></span> DOUBLE_CRLF <span class="hljs-string"><span class="hljs-string">"%s"</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(content), content); SAFE_CALL(send(fd, response, <span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(response), <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-number"><span class="hljs-number">-1</span></span>); SAFE_CALL(reactor_reregister(reactor, fd, EPOLLIN, on_recv, arg), <span class="hljs-number"><span class="hljs-number">-1</span></span>); }</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุฃุฎูุฑูุง ุ ูู ุงูููู <code>http_server.c</code> ุ ูู ุงููุธููุฉ <code>main()</code> ุ ูููู ุจุฅูุดุงุก ููุงุนู <code>reactor_new()</code> / ุฅุฎุฑุงุฌ ุจุงุณุชุฎุฏุงู <code>reactor_new()</code> ุ ูุฅูุดุงุก ููุจุณ ุฎุงุฏู ูุชุณุฌููู ุ ูุจุฏุก ุชุดุบูู ุงูููุงุนู ุจุงุณุชุฎุฏุงู <code>reactor_run()</code> ุฏูููุฉ ูุงุญุฏุฉ ุจุงูุถุจุท ุ ุซู ุชุญุฑูุฑ ุงูููุงุฑุฏ ูุงูุฎุฑูุฌ ูู ุงูุจุฑูุงูุฌ. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุนุฑุถ http_server.c</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"reactor.h"</span></span></span><span class="hljs-meta"> static Reactor *reactor; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"common.h"</span></span></span><span class="hljs-meta"> int main(void) { SAFE_CALL((reactor = reactor_new()), NULL); SAFE_CALL( reactor_register(reactor, new_server(false), EPOLLIN, on_accept, NULL), -1); SAFE_CALL(reactor_run(reactor, SERVER_TIMEOUT_MILLIS), -1); SAFE_CALL(reactor_destroy(reactor), -1); }</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุชุญูู ูู ุฃู ูู ุดูุก ูุนูู ููุง ูู ูุชููุน.  ูุญู ูุฌูุน ( <code>chmod a+x compile.sh &amp;&amp; ./compile.sh</code> ูู ุฌุฐุฑ ุงููุดุฑูุน) ูุจุฏุก ุชุดุบูู ุงูุฎุงุฏู ุงูููุชูุจ ุฐุงุชููุง ุ ุงูุชุญ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">http://127.0.0.1:18470</a> ูู ุงููุณุชุนุฑุถ ููุงุญุธ ูุง ูู ูุชููุน: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/i0/za/5u/i0za5um7tbcnzqt2x7sp_vey0p8.png"></p><br><h1 id="zamer-proizvoditelnosti" style=";text-align:right;direction:rtl">  ููุงุณ ุงูุฃุฏุงุก </h1><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุนุฑุถ ุฎุตุงุฆุต ุณูุงุฑุชู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ screenfetch MMMMMMMMMMMMMMMMMMMMMMMMMmds+. OS: Mint 19.1 tessa MMm----::-://////////////oymNMd+` Kernel: x86_64 Linux 4.15.0-20-generic MMd /++ -sNMd: Uptime: 2h 34m MMNso/` dMM `.::-. .-::.` .hMN: Packages: 2217 ddddMMh dMM :hNMNMNhNMNMNh: `NMm Shell: bash 4.4.20 NMm dMM .NMN/-+MMM+-/NMN` dMM Resolution: 1920x1080 NMm dMM -MMm `MMM dMM. dMM DE: Cinnamon 4.0.10 NMm dMM -MMm `MMM dMM. dMM WM: Muffin NMm dMM .mmd `mmm yMM. dMM WM Theme: Mint-Y-Dark (Mint-Y) NMm dMM` ..` ... ydm. dMM GTK Theme: Mint-Y [GTK2/3] hMM- +MMd/-------...-:sdds dMM Icon Theme: Mint-Y -NMm- :hNMNNNmdddddddddy/` dMM Font: Noto Sans 9 -dMNs-``-::::-------.`` dMM CPU: Intel Core i7-6700 @ 8x 4GHz [52.0ยฐC] `/dMNmy+/:-------------:/yMMM GPU: NV136 ./ydNMMMMMMMMMMMMMMMMMMMMM RAM: 2544MiB / 7926MiB \.MMMMMMMMMMMMMMMMMMM</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูููุณ ุฃุฏุงุก ุฎุงุฏู ุฐู ุณูุณูุฉ ูุงุญุฏุฉ.  ุฏุนูุง ููุชุญ ูุญุทุชูู: ูู ุฃุญุฏููุง ูุฑูุถ <code>./http_server</code> ุ ูู ุงูุขุฎุฑ - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุถุนูู</a> .  ุจุนุฏ ุฏูููุฉ ุ ุณูุชู ุนุฑุถ ุงูุฅุญุตุงุกุงุช ุงูุชุงููุฉ ูู ุงููุญุทุฉ ุงูุซุงููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ wrk -c100 -d1m -t8 http://127.0.0.1:18470 -H "Host: 127.0.0.1:18470" -H "Accept-Language: en-US,en;q=0.5" -H "Connection: keep-alive" Running 1m test @ http://127.0.0.1:18470 8 threads and 100 connections Thread Stats Avg Stdev Max +/- Stdev Latency 493.52us 76.70us 17.31ms 89.57% Req/Sec 24.37k 1.81k 29.34k 68.13% 11657769 requests in 1.00m, 1.60GB read Requests/sec: 193974.70 Transfer/sec: 27.19MB</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชููู ุฎุงุฏููุง ุฐู ุงูุฎููุท ุงูููุฑุฏุฉ ูู ูุนุงูุฌุฉ ุฃูุซุฑ ูู 11 ููููู ุทูุจ ูู ุงูุฏูููุฉ ุ ุงูุทูุงููุง ูู 100 ุงุชุตุงู.  ููุณุช ูุชูุฌุฉ ุณูุฆุฉ ุ ูููู ูู ูููู ุชุญุณูููุงุ </p><br><h1 id="mnogopotochnyy-server" style=";text-align:right;direction:rtl">  ุฎุงุฏู ูุชุนุฏุฏ ูุคุดุฑุงุช ุงูุชุฑุงุจุท </h1><br><p style=";text-align:right;direction:rtl">  ููุง ุฐูุฑ ุฃุนูุงู ุ ูููู ุฅูุดุงุก ููุงุนู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ูู ุชุฏููุงุช ูููุตูุฉ ุ ูุจุงูุชุงูู ุงูุงุณุชูุงุฏุฉ ูู ุฌููุน ุงูููู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ.  ููุทุจู ูุฐุง ุงูููุฌ ูู ุงูููุงุฑุณุฉ: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุนุฑุถ http_server_multithreaded.c</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"reactor.h"</span></span></span><span class="hljs-meta"> static Reactor *reactor; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> omp threadprivate(reactor) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"common.h"</span></span></span><span class="hljs-meta"> int main(void) { #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> omp parallel { SAFE_CALL((reactor = reactor_new()), NULL); SAFE_CALL(reactor_register(reactor, new_server(true), EPOLLIN, on_accept, NULL), -1); SAFE_CALL(reactor_run(reactor, SERVER_TIMEOUT_MILLIS), -1); SAFE_CALL(reactor_destroy(reactor), -1); } }</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูู ุฎูุท <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ูููู ููุงุนูู ุงูุฎุงุต</a> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Reactor *reactor; <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> omp threadprivate(reactor)</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุงุญุธ ุฃู ุงููุณูุทุฉ ุฅูู <code>new_server()</code> <code>true</code> .  ูุฐุง ูุนูู ุฃููุง ูููู ุจุชุนููู ููุจุณ ุงูุฎุงุฏู ุนูู ุฎูุงุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><code>SO_REUSEPORT</code></a> ูุงุณุชุฎุฏุงูู ูู ุจูุฆุฉ ูุชุนุฏุฏุฉ ุงูุฎููุท.  ููููู ูุฑุงุกุฉ ุงููุฒูุฏ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ููุง</a> . </p><br><h1 id="vtoroy-zahod" style=";text-align:right;direction:rtl">  ุงููุฏู ุงูุซุงูู </h1><br><p style=";text-align:right;direction:rtl">  ุงูุขู ููุงุณ ุฃุฏุงุก ุฎุงุฏู ูุชุนุฏุฏ ูุคุดุฑุงุช ุงูุชุฑุงุจุท: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ wrk -c100 -d1m -t8 http://127.0.0.1:18470 -H "Host: 127.0.0.1:18470" -H "Accept-Language: en-US,en;q=0.5" -H "Connection: keep-alive" Running 1m test @ http://127.0.0.1:18470 8 threads and 100 connections Thread Stats Avg Stdev Max +/- Stdev Latency 1.14ms 2.53ms 40.73ms 89.98% Req/Sec 79.98k 18.07k 154.64k 78.65% 38208400 requests in 1.00m, 5.23GB read Requests/sec: 635876.41 Transfer/sec: 89.14MB</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฒุงุฏ ุนุฏุฏ ุงูุทูุจุงุช ุงูุชู ุชูุช ูุนุงูุฌุชูุง ูู ุฏูููุฉ ูุงุญุฏุฉ ุจูุณุจุฉ 3.28 ูุฑุฉ ุชูุฑูุจูุง!  ูููู ุญุชู ุงูุฑูู ุงููุณุชุฏูุฑ ุ ูู ููู ูููู ุณูู ูููููู ุดุฎุต ุ ูููุญุงูู ุฅุตูุงุญู. </p><br><p style=";text-align:right;direction:rtl">  ุฃููุงู ุ ุฅููุงุก ูุธุฑุฉ ุนูู ุงูุฅุญุตุงุกุงุช ุงููุงุชุฌุฉ ุนู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">perf</a> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ sudo perf stat -B -e task-clock,context-switches,cpu-migrations,page-faults,cycles,instructions,branches,branch-misses,cache-misses ./http_server_multithreaded Performance counter stats for './http_server_multithreaded': 242446,314933 task-clock (msec) # 4,000 CPUs utilized 1 813 074 context-switches # 0,007 M/sec 4 689 cpu-migrations # 0,019 K/sec 254 page-faults # 0,001 K/sec 895 324 830 170 cycles # 3,693 GHz 621 378 066 808 instructions # 0,69 insn per cycle 119 926 709 370 branches # 494,653 M/sec 3 227 095 669 branch-misses # 2,69% of all branches 808 664 cache-misses 60,604330670 seconds time elapsed</code> </pre> <br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุจุงุณุชุฎุฏุงู ุชูุงุฑุจ ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ (CPU)</a> ุ ูุฅู ุงูุชุญููู ุงูุจุฑูุฌู ุจุงุณุชุฎุฏุงู <code>-march=native</code> ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">PGO</a> ุ ูุฒูุงุฏุฉ ุนุฏุฏ ูุฑุงุช ุงูุฏุฎูู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช</a> ุ ูุฒูุงุฏุฉ <code>MAX_EVENTS</code> ูุงุณุชุฎุฏุงู <code>EPOLLET</code> ูู ูููุฑ ุฒูุงุฏุฉ ูุจูุฑุฉ ูู ุงูุฃุฏุงุก.  ูููู ูุงุฐุง ูุญุฏุซ ุฅุฐุง ููุช ุจุฒูุงุฏุฉ ุนุฏุฏ ุงูุงุชุตุงูุงุช ุงููุชุฒุงููุฉุ </p><br><p style=";text-align:right;direction:rtl">  ุฅุญุตุงุฆูุงุช 352 ุงุชุตุงู ูุชุฒุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ wrk -c352 -d1m -t8 http://127.0.0.1:18470 -H "Host: 127.0.0.1:18470" -H "Accept-Language: en-US,en;q=0.5" -H "Connection: keep-alive" Running 1m test @ http://127.0.0.1:18470 8 threads and 352 connections Thread Stats Avg Stdev Max +/- Stdev Latency 2.12ms 3.79ms 68.23ms 87.49% Req/Sec 83.78k 12.69k 169.81k 83.59% 40006142 requests in 1.00m, 5.48GB read Requests/sec: 665789.26 Transfer/sec: 93.34MB</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชู ุงูุญุตูู ุนูู ุงููุชูุฌุฉ ุงููุฑุบูุจุฉ ุ ููุนูุง ุฑุณู ุจูุงูู ูุซูุฑ ููุงูุชูุงู ููุถุญ ุนุฏุฏ ุทูุจุงุช ุงููุนุงูุฌุฉ ูู ุฏูููุฉ ูุงุญุฏุฉ ุนูู ุนุฏุฏ ุงูุงุชุตุงูุงุช: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/od/8c/lv/od8clvvdlprsdcmslba9fz_rmmq.png"></p><br><p style=";text-align:right;direction:rtl">  ูุฑู ุฃูู ุจุนุฏ ุจุถุน ูุฆุงุช ูู ุงูุงุชุตุงูุงุช ุ ุงูุฎูุถ ุนุฏุฏ ุงูุทูุจุงุช ุงูุชู ุชูุช ูุนุงูุฌุชูุง ูู ููุง ุงูุฎุงุฏููู ุจุดูู ุญุงุฏ (ูู ุฅุตุฏุงุฑ ูุชุนุฏุฏ ุงูุฎููุท ุ ูููู ูุฐุง ุฃูุซุฑ ูุถูุญูุง).  ูู ูุฐุง ูุฑุชุจุท ุจุชูููุฐ ููุฏุณ Linux TCP / IPุ  ูุง ุชุชุฑุฏุฏ ูู ูุชุงุจุฉ ุงูุชุฑุงุถุงุชู ุญูู ูุซู ูุฐุง ุงูุณููู ุงูุจูุงูู ูุชุญุณููุงุช ุฐุงุช ูุคุดุฑุงุช ุชุฑุงุจุท ูุชุนุฏุฏุฉ ูุฎูุท ูุงุญุฏ ูู ุงูุชุนูููุงุช. </p><br><hr><br><p style=";text-align:right;direction:rtl">  ููุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุถุญ</a> ูู ุงูุชุนูููุงุช ุ ูุง ููุธูุฑ ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก ูุฐุง ุณููู ููุงุนู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุนูุฏ ุงูุชุญููู ุงูุญูููู ุ ูุฃู ุงูุฎุงุฏู ูุชูุงุนู ุฏุงุฆููุง ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฏุงุฆููุง ุ ููุนุฑุถ ุงูุณุฌูุงุช ุ ููุณุชุฎุฏู ุงูุชุดููุฑ ูุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">TLS</a> ุ ููุง ุฅูู ุฐูู ุ ููุชูุฌุฉ ูุฐูู ูุตุจุญ ุงูุญูู ุบูุฑ ูุชุฌุงูุณ (ุฏููุงูููู).  ุณูุชู ุฅุฌุฑุงุก ุงูุงุฎุชุจุงุฑุงุช ุฌูุจูุง ุฅูู ุฌูุจ ูุน ููููุงุช ุงูุทุฑู ุงูุซุงูุซ ูู ููุงู ุนู ูููู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ. </p><br><h1 id="nedostatki-io-reaktora" style=";text-align:right;direction:rtl">  ูุณุงูุฆ I / O ููุงุนู </h1><br><p style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ุชููู ุฃู ููุงุนู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ูุง ูุฎูู ูู ุงูุนููุจ ุ ููู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏุงู ููุงุนู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ูู ุจูุฆุฉ ูุชุนุฏุฏุฉ ุงูุฎููุท ูู ุฃูุซุฑ ุตุนูุจุฉ ุฅูู ุญุฏ ูุง ุ ูุฃูู  ูุฏูู ูุฅุฏุงุฑุฉ ุงูุชุฏููุงุช ูุฏููุง. </li><li style=";text-align:right;direction:rtl">  ุชุฏู ุงูููุงุฑุณุฉ ุนูู ุฃู ุงูุญูู ุบูุฑ ูุชุฌุงูุณ ูู ูุนุธู ุงูุญุงูุงุช ุ ููุง ูุฏ ูุคุฏู ุฅูู ุญูููุฉ ุฃู ุฃุญุฏ ุงูุฎููุท ุณูุชู ุฅุฎูุงุฏู ุจูููุง ูุชู ุชุญููู ุงูุขุฎุฑ ูุน ุงูุนูู. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู ูุนุงูุฌ ุญุฏุซ ูุงุญุฏ ุจุญุธุฑ ุงูุจุซ ุ ูุณูุชู ุฃูุถูุง ุญุธุฑ ูุญุฏุฏ ุงููุธุงู ููุณู ุ ููุง ูุฏ ูุคุฏู ุฅูู ุฃุฎุทุงุก ูุตุนุจ ุตูุฏูุง. </li></ul><br><p style=";text-align:right;direction:rtl">  ูุชู ุญู ูุฐู ุงููุดููุงุช ุนู ุทุฑูู ุจุฑูุงูุฌ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ</a> ุ ูุบุงูุจูุง ูุง ูููู ููุงู ุจุฑูุงูุฌ ุฌุฏููุฉ ูููู ุจุชูุฒูุน ุงูุชุญููู ุจุงูุชุณุงูู ุนูู ุชุฌูุน ูุคุดุฑุงุช ุงูุชุฑุงุจุท ุ ููุง ูุญุชูู ุนูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ุฃูุซุฑ ููุงุกูุฉ.  ุณูุชู ููุงูุดุชู ูุงุญููุง ูู ููุงูุชู ุงูุฃุฎุฑู. </p><br><h1 id="zaklyuchenie" style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h1><br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ุ ุงูุชูุช ุฑุญูุชูุง ูู ุงููุธุฑูุฉ ูุจุงุดุฑุฉ ุฅูู ููู ุชุนุฑูู ุงูุนุงุฏู. </p><br><p style=";text-align:right;direction:rtl">  ูุง ุชูุตู ูู ูุฐุง ุงูุฃูุฑ ุ ูุฃู ููุงู ุงูุนุฏูุฏ ูู ุงูุฃุณุงููุจ ุงูุฃุฎุฑู ุงููุซูุฑุฉ ููุงูุชูุงู ุจููุณ ุงููุฏุฑ ููุชุงุจุฉ ุจุฑุงูุฌ ุงูุดุจูุฉ ุจูุณุชููุงุช ูุฎุชููุฉ ูู ุงูุฑุงุญุฉ ูุงูุณุฑุนุฉ.  ูุซูุฑุฉ ููุงูุชูุงู ุ ูู ุฑุฃูู ุ ูุชู ุฅุนุทุงุก ุงูุฑูุงุจุท ุฃุฏูุงู. </p><br><p style=";text-align:right;direction:rtl">  ุงุฑุงู ูุฑูุจุง! </p><br><h1 id="interesnye-proekty" style=";text-align:right;direction:rtl">  ูุดุงุฑูุน ูุซูุฑุฉ ููุงูุชูุงู </h1><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  B <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">libevent</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">libev</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">libuv</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">libevhtp</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">liburing</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">DPDK</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">netmap</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">PF_RING</a> </li></ul></li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุตุฏุฃ</a> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ููู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุทูููู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">smoltcp</a> </li></ul></li></ul><br><h1 id="chto-eschyo-pochitat" style=";text-align:right;direction:rtl">  ูุงุฐุง ุชูุฑุฃุ </h1><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">https://linux.die.net/man/7/socket</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">https://stackoverflow.com/questions/1050222/what-is-the-difference-between-concurrency-and-parallelism</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">http://www.kegel.com/c10k.html</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">https://kernel.dk/io_uring.pdf</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">https://aturon.github.io/blog/2016/09/07/futures-design/</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">https://tokio.rs/blog/2019-10-scheduler/</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">https://www.artima.com/articles/io_design_patterns.html</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://habr.com/en/post/183832/</a> </li></ul><br></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar475896/">https://habr.com/ru/post/ar475896/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar475884/index.html">ุญู ูุดููุฉ ุงูุฎุทูุท ุงููุณููุฉ ูู ุงูุชุฏุฑุฌุงุช</a></li>
<li><a href="../ar475886/index.html">ูุฌุนู ูุธุงู Amazon AI ูู ุงูุณูู ูุนุงูุฌุฉ ุงููุญุชูู ุงููุงุญุด ูููุณุชุฎุฏู</a></li>
<li><a href="../ar475888/index.html">ููุงุฆุฏ ุงูุชุนุฑู ุนูู ุงููุฌูู ุงูุณุญุงุจูุฉ</a></li>
<li><a href="../ar475892/index.html">ููู ูููุง ุจุชุญุณูู ุชุฑุชูุจ ุงูุบุฏุงุก ูู ุงูููุชุจ (ุฏูู ุงููุตูู ุฅูู ุงูุฎุงุฏู)</a></li>
<li><a href="../ar475894/index.html">ุซูุงุซุฉ ุจุฑูุชููููุงุช ุชูุฑูุฑ</a></li>
<li><a href="../ar475900/index.html">ุงูุฏูุฑุงุช ุงู 6 ุงูุฃุฎูุฑุฉ ุฃุฒูุฑ</a></li>
<li><a href="../ar475902/index.html">ุณูุฑ ุงูุนูู - ูุญุฑู ุงูุนูููุงุช ุงูุชุฌุงุฑูุฉ ู. ุตุงูู ููุฑ</a></li>
<li><a href="../ar475904/index.html">5 ููุงุญุธุงุช ูููุฏูุฑ ุงูุฌุฏูุฏ</a></li>
<li><a href="../ar475908/index.html">10 ุฏูุฑุงุช Microsoft ุงูุฃูุซุฑ ุดุนุจูุฉ ุจุงููุบุฉ ุงูุฑูุณูุฉ</a></li>
<li><a href="../ar475912/index.html">ููููุฉ ุชูููู ูููุงุฑูุฉ ุฃุฌูุฒุฉ ุงูุชุดููุฑ ูุดุจูุงุช Ethernet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>