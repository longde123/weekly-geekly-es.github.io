<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ•¦ ğŸ¤°ğŸ¿ ğŸ§ å¯åŠ¨Reactå’ŒTypeScriptç»„ä»¶åº“ âœˆï¸ ğŸ¤ğŸ¼ ğŸ§‘ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æˆ‘çš„å¤§éƒ¨åˆ†å·¥ä½œæ˜¯å†™åç«¯ï¼Œä½†æ˜¯å‰ä¸€å¤©æœ‰ä¸€é¡¹ä»»åŠ¡è¦åœ¨Reactä¸Šå¯åŠ¨ç»„ä»¶åº“ã€‚ å‡ å¹´å‰ï¼Œå½“Reactç‰ˆæœ¬ä¸æˆ‘åœ¨å‰ç«¯å¼€å‘ä¸­çš„ç»éªŒä¸€æ ·å°æ—¶ï¼Œæˆ‘å·²ç»å¯¹å¼¹ä¸¸é‡‡å–äº†ä¸€ç§æ–¹æ³•ï¼Œç»“æœå˜å¾—ç¬¨æ‹™è€Œç¬¨æ‹™ã€‚ è€ƒè™‘åˆ°å½“å‰Reactç”Ÿæ€ç³»ç»Ÿçš„æˆç†Ÿåº¦ä»¥åŠæˆ‘ä¸æ–­å¢é•¿çš„ç»éªŒï¼Œè¿™æ¬¡æˆ‘å—åˆ°å¯å‘ï¼Œå¯ä»¥è½»æ¾ä¾¿æ·åœ°å®Œæˆæ‰€æœ‰å·¥ä½œã€‚ ç»“æœï¼Œæˆ‘å¯¹æœªæ¥çš„...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>å¯åŠ¨Reactå’ŒTypeScriptç»„ä»¶åº“</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461439/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/nc/57/zc/nc57zcknvdousryimpgxxqsiz1i.jpeg"></div><br><p> æˆ‘çš„å¤§éƒ¨åˆ†å·¥ä½œæ˜¯å†™åç«¯ï¼Œä½†æ˜¯å‰ä¸€å¤©æœ‰ä¸€é¡¹ä»»åŠ¡è¦åœ¨Reactä¸Šå¯åŠ¨ç»„ä»¶åº“ã€‚ å‡ å¹´å‰ï¼Œå½“Reactç‰ˆæœ¬ä¸æˆ‘åœ¨å‰ç«¯å¼€å‘ä¸­çš„ç»éªŒä¸€æ ·å°æ—¶ï¼Œæˆ‘å·²ç»å¯¹å¼¹ä¸¸é‡‡å–äº†ä¸€ç§æ–¹æ³•ï¼Œç»“æœå˜å¾—ç¬¨æ‹™è€Œç¬¨æ‹™ã€‚ è€ƒè™‘åˆ°å½“å‰Reactç”Ÿæ€ç³»ç»Ÿçš„æˆç†Ÿåº¦ä»¥åŠæˆ‘ä¸æ–­å¢é•¿çš„ç»éªŒï¼Œè¿™æ¬¡æˆ‘å—åˆ°å¯å‘ï¼Œå¯ä»¥è½»æ¾ä¾¿æ·åœ°å®Œæˆæ‰€æœ‰å·¥ä½œã€‚ ç»“æœï¼Œæˆ‘å¯¹æœªæ¥çš„å›¾ä¹¦é¦†æ„Ÿåˆ°ä¸€ç‰‡ç©ºç™½ï¼Œå¹¶ä¸”ä¸ºäº†é¿å…å¿˜è®°ä»»ä½•ä¸œè¥¿å¹¶å°†æ‰€æœ‰ä¸œè¥¿æ”¶é›†åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œæ’°å†™äº†è¿™ç¯‡å¤‡å¿˜å•æ–‡ç« ï¼Œè¿™ä¹Ÿåº”è¯¥å¸®åŠ©é‚£äº›ä¸çŸ¥é“ä»å“ªé‡Œå¼€å§‹çš„äººã€‚ è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘åšäº†ä»€ä¹ˆã€‚ </p><a name="habracut"></a><br><p>  <strong><em>TL / DRï¼šå¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github</a>ä¸ŠæŸ¥çœ‹å‡†å¤‡å¯åŠ¨çš„åº“çš„ä»£ç </em></strong> </p><br><p> è¿™ä¸ªé—®é¢˜å¯ä»¥ä»ä¸¤ä¸ªæ–¹é¢è§£å†³ï¼š </p><br><ol><li> æŸ¥æ‰¾ç°æˆçš„å…¥é—¨å¥—ä»¶ï¼Œæ ·æ¿æˆ–CLIç”Ÿæˆå™¨ </li><li> è‡ªå·±æ”¶é›†ä¸€åˆ‡ </li></ol><br><p> å½“æ‚¨ç»å¯¹ä¸æƒ³å¤„ç†é…ç½®å’Œè¿æ¥å¿…è¦çš„ç¨‹åºåŒ…æ—¶ï¼Œç¬¬ä¸€ç§æ–¹æ³•å¯¹äºå¿«é€Ÿå…¥é—¨éå¸¸æœ‰ç”¨ã€‚ å¦å¤–ï¼Œæ­¤é€‰é¡¹é€‚ç”¨äºä¸çŸ¥é“ä»å“ªé‡Œå¼€å§‹ä»¥åŠåº“ä¸å¸¸è§„åº”ç”¨ç¨‹åºä¹‹é—´åº”è¯¥æœ‰ä»€ä¹ˆåŒºåˆ«çš„åˆå­¦è€…ã€‚ </p><br><p> æœ€åˆï¼Œæˆ‘é‡‡ç”¨ç¬¬ä¸€ç§æ–¹æ³•ï¼Œä½†æ˜¯åæ¥æˆ‘å†³å®šæ›´æ–°ä¾èµ–å…³ç³»ï¼Œå¹¶å›ºå®šå‡ ä¸ªå…¶ä»–çš„ç¨‹åºåŒ…ï¼Œç„¶åå„ç§é”™è¯¯å’Œä¸ä¸€è‡´æ€§é€æ¸å‡å°‘ã€‚ ç»“æœï¼Œä»–å·èµ·è¢–å­ï¼Œè‡ªå·±åšäº†ä¸€åˆ‡ã€‚ ä½†æ˜¯æˆ‘ä¼šæåˆ°åº“ç”Ÿæˆå™¨ã€‚ </p><br><h2 id="create-react-library"> åˆ›å»ºååº”åº“ </h2><br><p> å¤§å¤šæ•°å¤„ç†Reactçš„å¼€å‘äººå‘˜éƒ½å¬è¯´è¿‡ä¾¿æ·çš„Reactåº”ç”¨ç¨‹åºå¯åŠ¨å™¨ï¼Œè¯¥å¯åŠ¨å™¨å¯è®©æ‚¨æœ€å°åŒ–é¡¹ç›®é…ç½®å¹¶æä¾›åˆç†çš„é»˜è®¤å€¼- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åˆ›å»ºReact App</a> ï¼ˆCRAï¼‰ã€‚ åŸåˆ™ä¸Šï¼Œå®ƒå¯ä»¥ç”¨äºå›¾ä¹¦é¦†ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœ‰å…³HabrÃ©çš„æ–‡ç« </a> ï¼‰ã€‚ ä½†æ˜¯ï¼Œui-kitå¼€å‘çš„é¡¹ç›®ç»“æ„å’Œæ–¹æ³•ä¸é€šå¸¸çš„SPAç•¥æœ‰ä¸åŒã€‚ æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå•ç‹¬çš„ç›®å½•ï¼Œå…¶ä¸­åŒ…å«ç»„ä»¶çš„æºä»£ç ï¼ˆsrcï¼‰ï¼Œç”¨äºå…¶å¼€å‘å’Œè°ƒè¯•çš„æ²™ç®±ï¼ˆç¤ºä¾‹ï¼‰ï¼Œæ–‡æ¡£å’Œæ¼”ç¤ºå·¥å…·ï¼ˆâ€œå±•ç¤ºæŸœâ€ï¼‰ä»¥åŠä¸€ä¸ªå•ç‹¬çš„ç›®å½•ï¼Œå…¶ä¸­åŒ…å«å‡†å¤‡å¯¼å‡ºçš„æ–‡ä»¶ï¼ˆdistï¼‰ã€‚ åŒæ ·ï¼Œåº“ç»„ä»¶ä¸ä¼šæ·»åŠ åˆ°SPAåº”ç”¨ç¨‹åºä¸­ï¼Œè€Œæ˜¯é€šè¿‡ç´¢å¼•æ–‡ä»¶å¯¼å‡ºã€‚ è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘å»æœç´¢å¹¶è¿…é€Ÿå‘ç°äº†ä¸€ä¸ªç±»ä¼¼çš„CRAè½¯ä»¶åŒ…<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-Creat React Library</a> ï¼ˆCRLï¼‰ã€‚ </p><br><p> ä¸CRAä¸€æ ·ï¼ŒCRLæ˜¯ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„CLIå®ç”¨ç¨‹åºã€‚ ä½¿ç”¨å®ƒï¼Œæ‚¨å¯ä»¥ç”Ÿæˆä¸€ä¸ªé¡¹ç›®ã€‚ å®ƒå°†åŒ…å«ï¼š </p><br><ul><li> é…ç½®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ±‡æ€»</a>ä»¥æ„å»ºcjså’Œesæ¨¡å—ä»¥åŠå…·æœ‰å¯¹CSSæ¨¡å—çš„æ”¯æŒçš„æºæ˜ å°„ </li><li> åœ¨ES5ä¸­è¿›è¡Œè½¬è¯‘çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é€šå¤©</a>å¡” </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¼€ç©ç¬‘</a> </li><li> æˆ‘ä»¬å¸Œæœ›ä½¿ç”¨TypeScriptï¼ˆTSï¼‰ä½œä¸ºé€‰é¡¹ </li></ul><br><p> è¦ç”Ÿæˆåº“é¡¹ç›®ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æˆ‘ä»¬</a>å¯ä»¥åšåˆ°ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">npx</a>å…è®¸æˆ‘ä»¬ä¸å…¨å±€å®‰è£…è½¯ä»¶åŒ…ï¼‰ï¼š </p><br><pre><code class="bash hljs">npx create-react-library</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">æˆ‘ä»¬å›ç­”æå‡ºçš„é—®é¢˜ã€‚</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/wd/ql/qq/wdqlqqfmjrgntiqz6zphcdyccdw.png" alt="CLRé—®é¢˜"></p></div></div><br><p> é€šè¿‡è¯¥å®ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªå·²ç”Ÿæˆä¸”å¯ä»¥ç«‹å³ä½¿ç”¨çš„ç»„ä»¶åº“é¡¹ç›®ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">å…·æœ‰ä¸€å®šçš„ç»“æ„</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/vs/d4/l2/vsd4l2o2g1wn3n0folb_yr30ui8.png" alt="Clræ ‘"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">ç„¶åå‡ºäº†ç‚¹é—®é¢˜...</b> <div class="spoiler_text"><p> ä»Šå¤©çš„ä¾èµ–å…³ç³»æœ‰äº›è¿‡æ—¶ï¼Œå› æ­¤æˆ‘å†³å®šä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">npm-check</a>å°†æ‰€æœ‰ä¾èµ–å…³ç³»æ›´æ–°ä¸ºæœ€æ–°ç‰ˆæœ¬ï¼š </p><br><pre> <code class="bash hljs">npx npm-check -u</code> </pre> <br><p> å¦ä¸€ä¸ªå¯æ‚²çš„äº‹å®æ˜¯ï¼Œ <code>example</code>ç›®å½•ä¸­çš„æ²™ç®±åº”ç”¨ç¨‹åºæ˜¯ç”¨jsç”Ÿæˆçš„ã€‚ æ‚¨å°†å¿…é¡»æ‰‹åŠ¨å°†å…¶é‡å†™ä¸ºTypeScriptï¼Œæ·»åŠ <code>tsconfig.json</code>å’Œä¸€äº›ä¾èµ–é¡¹ï¼ˆä¾‹å¦‚ï¼Œ <code>@types</code>æœ¬èº«å’ŒåŸºæœ¬çš„<code>@types</code> ï¼‰ã€‚ </p><br><p> å¦å¤–ï¼Œ <code>react-scripts-ts</code>åŒ…è¢«å£°æ˜ä¸º<code>deprecated</code> ï¼Œä¸å†å—æ”¯æŒã€‚ ç›¸åï¼Œæ‚¨åº”è¯¥å®‰è£…<code>react-scripts</code> ï¼Œå› ä¸ºä¸€æ®µæ—¶é—´ä»¥æ¥ï¼ŒCRAï¼ˆå…¶è½¯ä»¶åŒ…ä¸º<code>react-scripts</code> ï¼‰ä»æ¡†ä¸­å¼€å§‹æ”¯æŒTypeScriptï¼ˆä½¿ç”¨Babel 7ï¼‰ã€‚ </p><br><p> ç»“æœï¼Œæˆ‘å¯¹åº“çš„æƒ³æ³•æ²¡æœ‰æŒæ¡æ‹‰åŠ¨<code>react-scripts</code> ã€‚ æ®æˆ‘æ‰€çŸ¥ï¼Œæ­¤ç¨‹åºåŒ…ä¸­çš„Jestéœ€è¦<code>isolatedModules</code>ç¼–è¯‘å™¨é€‰é¡¹ï¼Œè¿™ä¸æˆ‘ä»åº“ç”Ÿæˆå’Œå¯¼å‡º<code>d.ts</code>æ„¿æœ›<code>d.ts</code> ï¼ˆæ‰€æœ‰è¿™äº›éƒ½ä¸Babel 7çš„å±€é™æ€§æœ‰å…³ï¼Œ <code>d.ts</code>å’Œ<code>react-scripts</code>ä½¿ç”¨Babel 7çš„å±€é™æ€§æ¥ç¼–è¯‘TS ï¼‰ å› æ­¤ï¼Œæˆ‘<code>eject</code>äº†<code>react-scripts</code> ï¼ŒæŸ¥çœ‹äº†ç»“æœå¹¶ç”¨æ‰‹é‡åšäº†æ‰€æœ‰å†…å®¹ï¼Œç¨åå°†è¿›è¡Œä»‹ç»ã€‚ </p></div></div><br><h2 id="tsdx">  tsdx </h2><br><p> æ„Ÿè°¢ç”¨æˆ·<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">StanEgo</a> ï¼Œä»–è°ˆåˆ°äº†åˆ›å»ºReactåº“<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-tsdx</a>çš„ç»ä½³æ›¿ä»£æ–¹æ³•ã€‚ æ­¤cli-utilityä¹Ÿç±»ä¼¼äºCRAï¼Œå¹¶ä¸”åœ¨ä¸€ä¸ªå‘½ä»¤ä¸­å°†ä½¿ç”¨é…ç½®çš„Rollupï¼ŒTSï¼ŒPrettierï¼Œhuskyï¼ŒJestå’ŒReactä¸ºæ‚¨çš„åº“åˆ›å»ºåŸºç¡€ã€‚  Reactæ˜¯ä¸€ä¸ªé€‰é¡¹ã€‚ åšèµ·æ¥å¾ˆç®€å•ï¼š </p><br><pre> <code class="bash hljs">npx tsdx create mytslib</code> </pre> <br><p> å› æ­¤ï¼Œå°†å®‰è£…è½¯ä»¶åŒ…çš„å¿…è¦æ–°ç‰ˆæœ¬å¹¶è¿›è¡Œæ‰€æœ‰è®¾ç½®ã€‚ è·å¾—ä¸€ä¸ªç±»ä¼¼CRLçš„é¡¹ç›®ã€‚ ä¸CRLçš„ä¸»è¦åŒºåˆ«åœ¨äºé›¶é…ç½®ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨tsdxä¸­å¯¹æˆ‘ä»¬éšè—äº†æ±‡æ€»é…ç½®ï¼ˆå°±åƒCRAä¸€æ ·ï¼‰ã€‚ </p><br><p> åœ¨å¿«é€Ÿæµè§ˆæ–‡æ¡£åï¼Œæˆ‘æ²¡æœ‰æ‰¾åˆ°æ¨èçš„æ–¹æ³•æ¥è¿›è¡Œæ›´ç²¾ç»†çš„é…ç½®æˆ–åœ¨CRAä¸­å¼¹å‡ºä¹‹ç±»çš„æ–¹æ³•ã€‚ çœ‹äº†è¿™ä¸ªé¡¹ç›®çš„é—®é¢˜ä¹‹åï¼Œæˆ‘å‘ç°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åˆ°ç›®å‰ä¸ºæ­¢æ²¡æœ‰è¿™ç§å¯èƒ½æ€§</a> ã€‚ å¯¹äºæŸäº›é¡¹ç›®ï¼Œè¿™å¯èƒ½å¾ˆå…³é”®ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å°†éœ€è¦åŠ¨æ‰‹ä¸€ç‚¹ã€‚ å¦‚æœæ‚¨ä¸éœ€è¦å®ƒï¼Œé‚£ä¹ˆtsdxæ˜¯å¿«é€Ÿå…¥é—¨çš„å¥½æ–¹æ³•ã€‚ </p><br><h2 id="beryom-upravlenie-v-svoi-ruki"> æŒæ¡æ§åˆ¶æƒ </h2><br><p> ä½†æ˜¯ï¼Œå¦‚æœæ‚¨èµ°ç¬¬äºŒç§æ–¹å¼è‡ªå·±æ”¶é›†æ‰€æœ‰ä¸œè¥¿ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ å› æ­¤ï¼Œè®©æˆ‘ä»¬ä»å¤´å¼€å§‹ã€‚ è¿è¡Œ<code>npm init</code>å¹¶ä¸ºè¯¥åº“ç”Ÿæˆ<code>package.json</code> ã€‚ åœ¨æ­¤å¤„æ·»åŠ æœ‰å…³æˆ‘ä»¬è½¯ä»¶åŒ…çš„ä¸€äº›ä¿¡æ¯ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨<code>engines</code>å­—æ®µä¸­ç¼–å†™nodeå’Œnpmçš„æœ€ä½ç‰ˆæœ¬ã€‚ æ”¶é›†å’Œå¯¼å‡ºçš„æ–‡ä»¶å°†æ”¾ç½®åœ¨<code>dist</code>ç›®å½•ä¸­ã€‚ æˆ‘ä»¬åœ¨<code>files</code>å­—æ®µä¸­æŒ‡å‡ºè¿™ä¸€ç‚¹ã€‚ æˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ä¸ªReactç»„ä»¶åº“ï¼Œå› æ­¤æˆ‘ä»¬å¸Œæœ›ç”¨æˆ·æ‹¥æœ‰å¿…è¦çš„è½¯ä»¶åŒ…-æˆ‘ä»¬åœ¨<code>peerDependencies</code>å­—æ®µä¸­<code>peerDependencies</code> <code>react</code>å’Œ<code>react-dom</code> <code>peerDependencies</code>æœ€ä½è¦æ±‚ç‰ˆæœ¬ã€‚ </p><br><p> ç°åœ¨ï¼Œå°†<code>react</code>å’Œ<code>react-dom</code>è½¯ä»¶åŒ…ä»¥åŠå¿…è¦çš„ç±»å‹ï¼ˆå› ä¸ºæˆ‘ä»¬å°†åœ¨TypeScriptä¸Šçœ‹åˆ°ç»„ä»¶ï¼‰å®‰è£…ä¸ºdevDependenciesï¼ˆç±»ä¼¼äºæœ¬æ–‡ä¸­çš„æ‰€æœ‰è½¯ä»¶åŒ…ï¼‰ï¼š </p><br><pre> <code class="bash hljs">npm install --save-dev react react-dom @types/react @types/react-dom</code> </pre> <br><p> å®‰è£…TypeScriptï¼š </p><br><pre> <code class="bash hljs">npm install --save-dev typescript</code> </pre> <br><p> è®©æˆ‘ä»¬ä¸ºä¸»è¦ä»£ç å’Œæµ‹è¯•åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š <code>tsconfig.json</code>å’Œ<code>tsconfig.test.json</code> ã€‚ æˆ‘ä»¬çš„<code>target</code>å°†åœ¨<code>es5</code> ï¼Œæˆ‘ä»¬å°†ç”Ÿæˆ<code>sourceMap</code>ç­‰ã€‚ å¯èƒ½çš„é€‰é¡¹åŠå…¶å«ä¹‰çš„å®Œæ•´åˆ—è¡¨å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡æ¡£ä¸­</a>æ‰¾åˆ°ã€‚ ä¸è¦å¿˜è®°åœ¨<code>include</code>æºç›®å½•ï¼Œå¹¶åœ¨<code>node_modules</code>æ·»åŠ <code>node_modules</code>å’Œ<code>dist</code>ç›®å½•ã€‚ åœ¨<code>package.json</code>æˆ‘ä»¬åœ¨ç±»å‹å­—æ®µä¸­æŒ‡ç¤ºè·å–åº“ç±»å‹çš„ä½ç½®<code>dist/index</code> ã€‚ </p><br><p> ä¸ºåº“çš„æºç»„ä»¶åˆ›å»º<code>src</code>ç›®å½•ã€‚ æ·»åŠ å„ç§å„æ ·çš„å°ä¸œè¥¿ï¼Œä¾‹å¦‚<code>.gitignore</code> ï¼Œ <code>.editorconfig</code> ï¼Œå…·æœ‰è®¸å¯è¯çš„æ–‡ä»¶å’Œ<code>README.md</code> ã€‚ </p><br><h3 id="rollup"> æ±‡æ€» </h3><br><p> æ ¹æ®CRLçš„å»ºè®®ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ±‡æ€»è¿›è¡Œç»„è£…ã€‚ å¿…éœ€çš„ç¨‹åºåŒ…å’Œé…ç½®ï¼Œæˆ‘è¿˜ç›‘è§†äº†CRLã€‚ æ€»çš„æ¥è¯´ï¼Œæˆ‘å¬åˆ°è¿™æ ·çš„è§‚ç‚¹ï¼Œå³æ±‡æ€»å¯¹äºåº“å’ŒWebpackå¯¹äºåº”ç”¨ç¨‹åºéƒ½æ˜¯æœ‰ç›Šçš„ã€‚ ä½†æ˜¯ï¼Œæˆ‘æ²¡æœ‰é…ç½®Webpackï¼ˆCRAä¸ºæˆ‘åšäº†ä»€ä¹ˆï¼‰ï¼Œä½†æ˜¯Rollupç¡®å®éå¸¸å¥½ï¼Œç®€å•ä¸”ç¾è§‚ã€‚ </p><br><p> å®‰è£…ï¼š </p><br><pre> <code class="bash hljs">npm install --save-dev rollup rollup-plugin-babel rollup-plugin-commonjs rollup-plugin-node-resolve rollup-plugin-peer-deps-external rollup-plugin-postcss rollup-plugin-typescript2 rollup-plugin-url @svgr/rollup</code> </pre> <br><p> åœ¨<code>package.json</code>æŒ‰ç…§<code>rollup</code>æ¨èç»™æˆ‘ä»¬çš„å­—æ®µæ·»åŠ æ”¶é›†çš„åº“åŒ…åˆ†å‘çš„å­—æ®µ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-pkg.module</a> ï¼š </p><br><pre> <code class="json hljs"> <span class="hljs-string"><span class="hljs-string">"main"</span></span>: <span class="hljs-string"><span class="hljs-string">"dist/index.js"</span></span>, <span class="hljs-string"><span class="hljs-string">"module"</span></span>: <span class="hljs-string"><span class="hljs-string">"dist/index.es.js"</span></span>, <span class="hljs-string"><span class="hljs-string">"jsnext:main"</span></span>: <span class="hljs-string"><span class="hljs-string">"dist/index.es.js"</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">åˆ›å»ºé…ç½®æ–‡ä»¶rollup.config.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> typescript <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-typescript2'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> commonjs <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-commonjs'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> external <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-peer-deps-external'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> postcss <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-postcss'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> resolve <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-node-resolve'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> url <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-url'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> svgr <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@svgr/rollup'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pkg <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./package.json'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> { <span class="hljs-attr"><span class="hljs-attr">input</span></span>: <span class="hljs-string"><span class="hljs-string">'src/index.tsx'</span></span>, <span class="hljs-attr"><span class="hljs-attr">output</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">file</span></span>: pkg.main, <span class="hljs-attr"><span class="hljs-attr">format</span></span>: <span class="hljs-string"><span class="hljs-string">'cjs'</span></span>, <span class="hljs-attr"><span class="hljs-attr">exports</span></span>: <span class="hljs-string"><span class="hljs-string">'named'</span></span>, <span class="hljs-attr"><span class="hljs-attr">sourcemap</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">file</span></span>: pkg.module, <span class="hljs-attr"><span class="hljs-attr">format</span></span>: <span class="hljs-string"><span class="hljs-string">'es'</span></span>, <span class="hljs-attr"><span class="hljs-attr">exports</span></span>: <span class="hljs-string"><span class="hljs-string">'named'</span></span>, <span class="hljs-attr"><span class="hljs-attr">sourcemap</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [ external(), postcss({ <span class="hljs-attr"><span class="hljs-attr">modules</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">extract</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">minimize</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">sourceMap</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }), url(), svgr(), resolve(), typescript({ <span class="hljs-attr"><span class="hljs-attr">rollupCommonJSResolveHack</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">clean</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }), commonjs() ] };</code> </pre> </div></div><br><p> é…ç½®æ˜¯ä¸€ä¸ªjsæ–‡ä»¶ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå¯¼å‡ºçš„å¯¹è±¡ã€‚ åœ¨<code>input</code>å­—æ®µä¸­ï¼ŒæŒ‡å®šç”¨äºæ³¨å†Œæˆ‘ä»¬çš„åº“å¯¼å‡ºæ–‡ä»¶çš„æ–‡ä»¶ã€‚  <code>output</code> -æè¿°æˆ‘ä»¬å¯¹<code>output</code>çš„æœŸæœ›-åœ¨å“ªä¸ªæ¨¡å—ä¸­ä»¥æ ¼å¼è¿›è¡Œç¼–è¯‘ä»¥åŠå°†å…¶æ”¾ç½®åœ¨ä½•å¤„ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">æ¥ä¸‹æ¥æ˜¯å¸¦æœ‰æ’ä»¶åˆ—è¡¨å’Œé…ç½®çš„å­—æ®µ</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">rollup-plugin-peer-deps-external-</a>å…è®¸æ‚¨ä»<code>bundle</code>æ’é™¤<code>peerDependencies</code>ä»¥å‡å°å…¶å¤§å°ã€‚ è¿™æ˜¯åˆç†çš„ï¼Œå› ä¸ºæœŸæœ›åº“ç”¨æˆ·ä½¿ç”¨<code>peerDependencies</code> ã€‚ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">rollup-plugin-postcss-</a>é›†æˆ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PostCss</a>å’ŒRollupã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç¦ç”¨css-modulesï¼Œå°†cssåŒ…å«åœ¨åº“ä¸­çš„exportåŒ…ä¸­ï¼Œå°†å…¶æœ€å°åŒ–å¹¶å¯ç”¨sourceMapçš„åˆ›å»ºã€‚ å¦‚æœä¸å¯¼å‡ºåº“ç»„ä»¶ä½¿ç”¨çš„CSSä»¥å¤–çš„ä»»ä½•CSSï¼Œåˆ™å¯ä»¥é¿å…<code>extract</code> -ç»„ä»¶ä¸­å¿…è¦çš„CSSå°†æ ¹æ®éœ€è¦æœ€ç»ˆæ·»åŠ åˆ°é¡µé¢çš„headæ ‡ç­¾ä¸­ã€‚ ä½†æ˜¯ï¼Œåœ¨æˆ‘çš„æƒ…å†µä¸‹ï¼Œæœ‰å¿…è¦åˆ†å‘ä¸€äº›å…¶ä»–çš„CSSï¼ˆç½‘æ ¼ï¼Œé¢œè‰²ç­‰ï¼‰ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯å°†å¿…é¡»å°†CSSæ†ç»‘åº“æ˜¾å¼è¿æ¥åˆ°å…¶è‡ªèº«ã€‚ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">rollup-plugin-url-</a>å…è®¸æ‚¨å¯¼å‡ºå„ç§èµ„æºï¼Œä¾‹å¦‚å›¾ç‰‡ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">svgr-</a>å°†svgè½¬æ¢ä¸ºReactç»„ä»¶ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">rollup-plugin-node-</a> resolve-å®šä¹‰ç¬¬ä¸‰æ–¹æ¨¡å—åœ¨node_modulesä¸­çš„ä½ç½® </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">rollup-plugin-typescript2-</a>è¿æ¥TypeScriptç¼–è¯‘å™¨å¹¶æä¾›å¯¹å…¶è¿›è¡Œé…ç½®çš„åŠŸèƒ½ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">rollup-plugin-commonjs-</a>å°†commonjsä¾èµ–é¡¹æ¨¡å—è½¬æ¢ä¸ºesæ¨¡å—ï¼Œä»¥ä¾¿å¯ä»¥å°†å®ƒä»¬åŒ…å«åœ¨bundleä¸­ </li></ul></div></div><br><p> åœ¨<code>scripts</code> <code>package.json</code>å­—æ®µä¸­æ·»åŠ ä¸€ä¸ªå‘½ä»¤ä»¥è¿›è¡Œæ„å»ºï¼ˆ <code>"build": "rollup -c"</code> ï¼‰å¹¶åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä»¥ç›‘è§†æ¨¡å¼å¯åŠ¨è¯¥ç¨‹åºé›†ï¼ˆ <code>"start": "rollup -c -w &amp;&amp; npm run prettier-watch"</code> ï¼‰ ã€‚ </p><br><h3 id="pervyy-komponent-i-eksportnyy-fayl"> ç¬¬ä¸€ä¸ªç»„ä»¶å’Œå¯¼å‡ºæ–‡ä»¶ </h3><br><p> ç°åœ¨ï¼Œæˆ‘ä»¬å°†ç¼–å†™æœ€ç®€å•çš„reactç»„ä»¶æ¥æ£€æŸ¥æˆ‘ä»¬çš„ç¨‹åºé›†å¦‚ä½•å·¥ä½œã€‚ åº“ä¸­çš„æ¯ä¸ªç»„ä»¶éƒ½å°†æ”¾ç½®åœ¨çˆ¶ç›®å½•<code>src/components/ExampleComponent</code>çš„å•ç‹¬ç›®å½•ä¸­ã€‚ è¯¥ç›®å½•å°†åŒ…å«ä¸ç»„ä»¶ç›¸å…³çš„æ‰€æœ‰æ–‡ä»¶<code>test.tsx</code> ï¼Œ <code>css</code> ï¼Œ <code>test.tsx</code>ç­‰ã€‚ <br> è®©æˆ‘ä»¬ä¸ºç»„ä»¶åˆ›å»ºä¸€äº›æ ·å¼æ–‡ä»¶ï¼Œå¹¶ä¸ºç»„ä»¶æœ¬èº«åˆ›å»º<code>tsx</code>æ–‡ä»¶ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">ExampleComponent.tsx</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** * @class ExampleComponent */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'./ExampleComponent.css'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface Props { <span class="hljs-comment"><span class="hljs-comment">/** * Simple text prop **/</span></span> text: string; } <span class="hljs-comment"><span class="hljs-comment">/** My First component */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ExampleComponent</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Props</span></span></span><span class="hljs-class">&gt; </span></span>{ render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { text } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"test"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> Example Component: {text} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Coool!</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> ExampleComponent;</code> </pre> </div></div><br><p> åŒæ ·åœ¨<code>src</code>æ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªå…·æœ‰åº“é€šç”¨ç±»å‹çš„æ–‡ä»¶ï¼Œå…¶ä¸­å°†å£°æ˜csså’Œsvgçš„ç±»å‹ï¼ˆåœ¨CRLå¤„çª¥è§†ï¼‰ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">æ‰“å­—</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Default CSS definition for typescript, * will be overridden with file-specific definitions by rollup */</span></span> declare <span class="hljs-built_in"><span class="hljs-built_in">module</span></span> <span class="hljs-string"><span class="hljs-string">'*.css'</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> content: { [className: string]: string }; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> content; } interface SvgrComponent extends React.FunctionComponent&lt;React.SVGAttributes&lt;SVGElement&gt;&gt; {} declare <span class="hljs-built_in"><span class="hljs-built_in">module</span></span> <span class="hljs-string"><span class="hljs-string">'*.svg'</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> svgUrl: string; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> svgComponent: SvgrComponent; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> svgUrl; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> { svgComponent <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ReactComponent }; }</code> </pre> </div></div><br><p> å¿…é¡»åœ¨å¯¼å‡ºæ–‡ä»¶ä¸­æŒ‡å®šæ‰€æœ‰å¯¼å‡ºçš„ç»„ä»¶å’ŒCSSã€‚ æˆ‘ä»¬æœ‰<code>src/index.tsx</code> ã€‚ å¦‚æœé¡¹ç›®ä¸­æœªä½¿ç”¨æŸäº›cssï¼Œå¹¶ä¸”æœªå°†å…¶åˆ—ä¸ºå¯¼å…¥<code>src/index.tsx</code>çš„é‚£äº›<code>src/index.tsx</code> ï¼Œé‚£ä¹ˆå®ƒå°†è¢«æ‰”å‡ºç¨‹åºé›†ï¼Œè¿™å¾ˆå¥½ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">src / index.tsx</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { ExampleComponent, Props } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./ExampleComponent'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'./export.css'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> { ExampleComponent, Props };</code> </pre> </div></div><br><p> ç°åœ¨ï¼Œæ‚¨å¯ä»¥å°è¯•æ„å»ºåº“<code>npm run build</code> ã€‚ ç»“æœï¼Œ <code>rollup</code>å¼€å§‹ï¼Œå¹¶å°†æˆ‘ä»¬çš„åº“æ”¶é›†åˆ°åŒ…ä¸­ï¼Œè¿™äº›åŒ…å°†åœ¨<code>dist</code>ç›®å½•ä¸­æ‰¾åˆ°ã€‚ </p><br><p> æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€äº›å·¥å…·æ¥æ”¹å–„æˆ‘ä»¬çš„å¼€å‘è¿‡ç¨‹åŠå…¶ç»“æœçš„è´¨é‡ã€‚ </p><br><h3 id="zabyvaem-o-formatirovanii-koda-s-prettier"> å¿˜è®°ä½¿ç”¨Prettierè¿›è¡Œä»£ç æ ¼å¼åŒ– </h3><br><p> æˆ‘è®¨åŒåœ¨ä»£ç å®¡æŸ¥ä¸­æŒ‡å‡ºæ ¼å¼åŒ–å¯¹äºé¡¹ç›®æ¥è¯´æ˜¯ç²—å¿ƒçš„æˆ–éæ ‡å‡†çš„ï¼Œç”šè‡³å¯¹æ­¤äº‰è®ºä¸ä¼‘ã€‚ è¿™äº›ç¼ºé™·è‡ªç„¶åº”è¯¥å¾—åˆ°ä¿®å¤ï¼Œä½†æ˜¯å¼€å‘äººå‘˜åº”è¯¥ä¸“æ³¨äºä»£ç çš„åŠŸèƒ½å’Œæ–¹å¼ï¼Œè€Œä¸æ˜¯å¤–è§‚ã€‚ è¿™äº›ä¿®è¡¥ç¨‹åºæ˜¯è‡ªåŠ¨åŒ–çš„ç¬¬ä¸€ä¸ªå€™é€‰å¯¹è±¡ã€‚ è¿™ä¸ªæ¼‚äº®çš„ç¨‹åºåŒ…éå¸¸<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¼‚äº®</a> ã€‚ å®‰è£…å®ƒï¼š </p><br><pre> <code class="bash hljs">npm install --save-dev prettier</code> </pre> <br><p> æ·»åŠ é…ç½®ä»¥ç•¥å¾®å®Œå–„æ ¼å¼è®¾ç½®è§„åˆ™ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">.prettierrc.json</b> <div class="spoiler_text"><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"tabWidth"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-attr"><span class="hljs-attr">"singleQuote"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"jsxBracketSameLine"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"arrowParens"</span></span>: <span class="hljs-string"><span class="hljs-string">"always"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"printWidth"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"semi"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"bracketSpacing"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre> </div></div><br><p> æ‚¨å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡æ¡£ä¸­</a>çœ‹åˆ°å¯ç”¨è§„åˆ™çš„â€‹â€‹å«ä¹‰ã€‚ åˆ›å»ºé…ç½®æ–‡ä»¶æœ¬èº«åï¼ŒWebStromå°†åœ¨é€šè¿‡IDEå¼€å§‹æ ¼å¼åŒ–æ—¶å»ºè®®ä½¿ç”¨<code>prettier</code>æ ·å¼ã€‚ ä¸ºé¿å…æ ¼å¼åŒ–æµªè´¹æ—¶é—´ï¼Œè¯·ä½¿ç”¨<code>.prettierignore</code>æ–‡ä»¶ï¼ˆæ ¼å¼ç±»ä¼¼äº<code>.gitignore</code> ï¼‰å°†<code>/node_modules</code>å’Œ<code>/dist</code>ç›®å½•æ·»åŠ åˆ°å¼‚å¸¸ä¸­ã€‚ ç°åœ¨ï¼Œæ‚¨å¯ä»¥é€šè¿‡å°†æ ¼å¼åŒ–è§„åˆ™åº”ç”¨äºæºä»£ç æ¥<code>prettier</code>è¿è¡Œï¼š </p><br><pre> <code class="bash hljs">prettier --write <span class="hljs-string"><span class="hljs-string">"**/*"</span></span></code> </pre> <br><p> ä¸ºäº†é¿å…æ¯æ¬¡éƒ½ç”¨æ‰‹åŠ¨æ–¹å¼æ˜¾å¼è¿è¡Œå‘½ä»¤å¹¶ç¡®ä¿å…¶ä»–é¡¹ç›®å¼€å‘äººå‘˜çš„ä»£ç ä¹Ÿå°†è¢«æ ¼å¼åŒ–ï¼Œè¯·åœ¨<code>precommit-hook</code>ä¸ºæ ‡è®°ä¸º<code>staged</code>çš„æ–‡ä»¶æ·»åŠ <code>prettier</code>è¿è¡Œï¼ˆé€šè¿‡<code>git add</code> ï¼‰ã€‚ å¯¹äºè¿™æ ·çš„äº‹æƒ…ï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªå·¥å…·ã€‚ é¦–å…ˆï¼Œå®ƒæ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">hasky</a> ï¼Œè´Ÿè´£åœ¨æäº¤ï¼Œæ¨é€ç­‰ä¹‹å‰æ‰§è¡Œä»»ä½•å‘½ä»¤ã€‚ å…¶æ¬¡ï¼Œå®ƒæ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">lint-stagedçš„</a> ï¼Œå¯ä»¥åœ¨å·²<code>staged</code>æ–‡ä»¶ä¸Šè¿è¡Œä¸åŒçš„linterã€‚ æˆ‘ä»¬åªéœ€è¦æ‰§è¡Œä¸€è¡Œå°±å¯ä»¥äº¤ä»˜è¿™äº›è½¯ä»¶åŒ…å¹¶å°†å¯åŠ¨å‘½ä»¤æ·»åŠ åˆ°<code>package.json</code> ï¼š </p><br><pre> <code class="bash hljs">npx mrm lint-staged</code> </pre> <br><p> æˆ‘ä»¬ä¸èƒ½åœ¨æäº¤ä¹‹å‰ç­‰å¾…æ ¼å¼ï¼Œä½†æ˜¯è¯·ç¡®ä¿åœ¨æˆ‘ä»¬çš„å·¥ä½œè¿‡ç¨‹ä¸­ï¼Œ <code>prettier</code>æ–‡ä»¶åœ¨ä¿®æ”¹åçš„æ–‡ä»¶ä¸­å§‹ç»ˆæœ‰æ•ˆã€‚ æ˜¯çš„ï¼Œæˆ‘ä»¬éœ€è¦å¦ä¸€ä¸ªpackage- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">onchange</a> ã€‚ å®ƒä½¿æ‚¨å¯ä»¥ç›‘è§†é¡¹ç›®ä¸­æ–‡ä»¶çš„æ›´æ”¹ï¼Œå¹¶ç«‹å³å¯¹å…¶æ‰§è¡Œå¿…è¦çš„å‘½ä»¤ã€‚ å®‰è£…ï¼š </p><br><pre> <code class="bash hljs">npm install --save-dev --save-exact onchange</code> </pre> <br><p> ç„¶åï¼Œåœ¨<code>package.json</code>æ·»åŠ åˆ°<code>scripts</code>å­—æ®µå‘½ä»¤ï¼š </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"prettier-watch"</span></span>: <span class="hljs-string"><span class="hljs-string">"onchange 'src/**/*' -- prettier --write {{changed}}"</span></span></code> </pre> <br><p> å› æ­¤ï¼Œæœ‰å…³é¡¹ç›®æ ¼å¼çš„æ‰€æœ‰äº‰è®®éƒ½å¯ä»¥è§†ä¸ºå·²è§£å†³ã€‚ </p><br><h3 id="izbegaem-oshibok-s-eslint"> é¿å…ESLinté”™è¯¯ </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ESLint</a>æ—©å·²æˆä¸ºä¸€ç§æ ‡å‡†ï¼Œå‡ ä¹å¯ä»¥åœ¨æ‰€æœ‰jså’Œtsé¡¹ç›®ä¸­æ‰¾åˆ°ã€‚ ä»–ä¹Ÿä¼šå¸®åŠ©æˆ‘ä»¬ã€‚ åœ¨ESLinté…ç½®ä¸­ï¼Œæˆ‘ä¿¡ä»»CRAï¼Œå› æ­¤åªéœ€ä»CRAä¸­è·å–å¿…è¦çš„è½¯ä»¶åŒ…å¹¶å°†å…¶æ’å…¥æˆ‘ä»¬çš„åº“å³å¯ã€‚ å¦å¤–ï¼Œä¸ºTSå’Œ<code>prettier</code>é…ç½®æ·»åŠ é…ç½®ï¼ˆä»¥é¿å…<code>ESLint</code>å’Œ<code>prettier</code>å†²çªï¼‰ï¼š </p><br><pre> <code class="bash hljs">npm install --save-dev eslint eslint-config-react-app eslint-loader eslint-plugin-flowtype eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react eslint-plugin-react-hooks @typescript-eslint/eslint-plugin @typescript-eslint/parser babel-eslint eslint-config-prettier eslint-plugin-prettier</code> </pre> <br><p> ä½¿ç”¨é…ç½®æ–‡ä»¶<code>ESLint</code> ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">.eslintrc.json</b> <div class="spoiler_text"><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"extends"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"plugin:@typescript-eslint/recommended"</span></span>, <span class="hljs-string"><span class="hljs-string">"react-app"</span></span>, <span class="hljs-string"><span class="hljs-string">"prettier"</span></span>, <span class="hljs-string"><span class="hljs-string">"prettier/@typescript-eslint"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"plugins"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"@typescript-eslint"</span></span>, <span class="hljs-string"><span class="hljs-string">"react"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"rules"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@typescript-eslint/no-empty-interface"</span></span>: <span class="hljs-string"><span class="hljs-string">"off"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@typescript-eslint/explicit-function-return-type"</span></span>: <span class="hljs-string"><span class="hljs-string">"off"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@typescript-eslint/explicit-member-accessibility"</span></span>: <span class="hljs-string"><span class="hljs-string">"off"</span></span> } }</code> </pre> </div></div><br><p> å°†å‘½ä»¤<code>lint</code> <code>eslint src/**/* --ext .ts,.tsx --fix</code>åˆ°<code>package.json</code>çš„<code>scripts</code>å­—æ®µã€‚ ç°åœ¨æ‚¨å¯ä»¥é€šè¿‡<code>npm run lint</code>è¿è¡Œeslintã€‚ </p><br><h3 id="testiruem-s-jest"> ç”¨ç¬‘è¯æµ‹è¯• </h3><br><p> è¦ç¼–å†™åº“ç»„ä»¶çš„å•å…ƒæµ‹è¯•ï¼Œè¯·å®‰è£…å¹¶é…ç½®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Jest</a> ï¼ˆæ¥è‡ªFacebookçš„æµ‹è¯•åº“ï¼‰ã€‚ ä½†æ˜¯ï¼Œç”±äº æˆ‘ä»¬ä¸æ˜¯é€šè¿‡babel 7è€Œæ˜¯é€šè¿‡tscç¼–è¯‘TSï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿéœ€è¦å®‰è£…<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ts-jest</a>è½¯ä»¶åŒ…ï¼š </p><br><pre> <code class="bash hljs">npm install --save-dev jest ts-jest @types/jest</code> </pre> <br><p> ä¸ºäº†ä½¿Jestæ­£ç¡®æ¥å—cssæˆ–å…¶ä»–æ–‡ä»¶çš„å¯¼å…¥ï¼Œæ‚¨éœ€è¦å°†å…¶æ›¿æ¢ä¸ºmokamiã€‚ åˆ›å»º<code>__mocks__</code>ç›®å½•ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ã€‚ <br>  <code>styleMock.ts</code> ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = {};</code> </pre> <br><p>  <code>fileMock.ts</code> ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-string"><span class="hljs-string">'test-file-stub'</span></span>;</code> </pre> <br><p> ç°åœ¨åˆ›å»ºJesté…ç½®ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">jest.config.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = { <span class="hljs-attr"><span class="hljs-attr">preset</span></span>: <span class="hljs-string"><span class="hljs-string">'ts-jest'</span></span>, <span class="hljs-attr"><span class="hljs-attr">testEnvironment</span></span>: <span class="hljs-string"><span class="hljs-string">'node'</span></span>, <span class="hljs-attr"><span class="hljs-attr">moduleNameMapper</span></span>: { <span class="hljs-string"><span class="hljs-string">'\\.(css|less|sass|scss)$'</span></span>: <span class="hljs-string"><span class="hljs-string">'&lt;rootDir&gt;/__mocks__/styleMock.ts'</span></span>, <span class="hljs-string"><span class="hljs-string">'\\.(gif|ttf|eot|svg)$'</span></span>: <span class="hljs-string"><span class="hljs-string">'&lt;rootDir&gt;/__mocks__/fileMock.ts'</span></span> } };</code> </pre> </div></div><br><p> æˆ‘ä»¬å°†åœ¨å…¶ç›®å½•ä¸­ä¸º<code>ExampleComponent</code>ç¼–å†™æœ€ç®€å•çš„æµ‹è¯•ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">ExampleComponent.test.tsx</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { ExampleComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./ExampleComponent'</span></span>; describe(<span class="hljs-string"><span class="hljs-string">'ExampleComponent'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'is truthy'</span></span>, () =&gt; { expect(ExampleComponent).toBeTruthy(); }); });</code> </pre> </div></div><br><p> å°†<code>test</code> <code>npm run lint &amp;&amp; jest</code>å‘½ä»¤æ·»åŠ åˆ°<code>package.json</code>çš„<code>scripts</code>å­—æ®µã€‚ ä¸ºäº†æé«˜å¯é æ€§ï¼Œæˆ‘ä»¬è¿˜å°†é©¾é©¶çŸ­ç»’ã€‚ ç°åœ¨ï¼Œæ‚¨å¯ä»¥è¿è¡Œæˆ‘ä»¬çš„æµ‹è¯•ï¼Œå¹¶ç¡®ä¿å®ƒä»¬é€šè¿‡<code>npm run test</code> ã€‚ ä¸ºäº†ä½¿æµ‹è¯•ä¸ä¼šåœ¨æ±‡ç¼–è¿‡ç¨‹ä¸­æ‰å…¥<code>dist</code> ï¼Œè¯·å°†<code>Rollup</code> configæ’ä»¶ä¸­çš„<code>exclude</code>å­—æ®µæ·»åŠ åˆ°<code>exclude</code>å­—æ®µ- <code>['src/**/*.test.(tsx|ts)']</code> ã€‚ åœ¨è¿è¡Œ<code>lint-staged</code>ä¹‹å‰ï¼Œåœ¨<code>husky pre-commit hook</code>æŒ‡å®šè¿è¡Œæµ‹è¯•- <code>"pre-commit": "npm run test &amp;&amp; lint-staged"</code> ã€‚ </p><br><h3 id="razrabatyvaem-dokumentiruem-i-lyubuemsya-komponentami-s-storybook"> ä½¿ç”¨æ•…äº‹ä¹¦è®¾è®¡ï¼Œè®°å½•å’Œæ¬£èµç»„ä»¶ </h3><br><p> æ¯ä¸ªå›¾ä¹¦é¦†éƒ½éœ€è¦è‰¯å¥½çš„æ–‡æ¡£æ‰èƒ½æˆåŠŸä¸”å¯Œæœ‰æˆæ•ˆåœ°ä½¿ç”¨ã€‚ è‡³äºç•Œé¢ç»„ä»¶åº“ï¼Œæˆ‘ä¸ä»…è¦é˜…è¯»å®ƒä»¬ï¼Œè€Œä¸”è¦çœ‹å®ƒä»¬çš„å¤–è§‚ï¼Œæœ€å¥½è§¦æ‘¸å’Œæ›´æ”¹å®ƒä»¬ã€‚ ä¸ºäº†æ”¯æŒè¿™æ ·çš„å¿ƒæ„¿å•ï¼Œæœ‰å‡ ç§è§£å†³æ–¹æ¡ˆã€‚ æˆ‘æ›¾ç»ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Styleguidist</a> ã€‚ è¿™ä¸ªåŒ…å…è®¸æ‚¨ä»¥markdownæ ¼å¼ç¼–å†™æ–‡æ¡£ï¼Œå¹¶å°†æ‰€æè¿°çš„Reactç»„ä»¶çš„ç¤ºä¾‹æ’å…¥å…¶ä¸­ã€‚ æ­¤å¤–ï¼Œè¿˜æ”¶é›†äº†æ–‡æ¡£ï¼Œå¹¶ä»ä¸­è·å¾—äº†site-showcase-catalogï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­æ‰¾åˆ°è¯¥ç»„ä»¶ï¼Œé˜…è¯»æœ‰å…³è¯¥ç»„ä»¶çš„æ–‡æ¡£ï¼Œäº†è§£å…¶å‚æ•°ä»¥åŠå‘å…¶ä¸­æˆ³å…¥ä¸€æ ¹é­”æ–ã€‚ </p><br><p> ä½†æ˜¯ï¼Œè¿™æ¬¡æˆ‘å†³å®šä»”ç»†çœ‹çœ‹ä»–çš„ç«äº‰å¯¹æ‰‹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-Storybook</a> ã€‚ å¦‚ä»Šï¼Œå…¶æ’ä»¶ç³»ç»Ÿä¼¼ä¹æ›´åŠ å¼ºå¤§ã€‚ æ­¤å¤–ï¼Œå®ƒä¸æ–­å‘å±•ï¼Œæ‹¥æœ‰ä¸€ä¸ªåºå¤§çš„ç¤¾åŒºï¼Œå¹¶ä¸”<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸ä¹…</a>è¿˜å°†å¼€å§‹ä½¿ç”¨markdownæ–‡ä»¶ç”Ÿæˆå…¶æ–‡æ¡£é¡µé¢ã€‚ æ•…äº‹ä¹¦çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯å®ƒæ˜¯ä¸€ä¸ªæ²™ç®±-ç”¨äºéš”ç¦»ç»„ä»¶å¼€å‘çš„ç¯å¢ƒã€‚ è¿™æ„å‘³ç€æˆ‘ä»¬ä¸éœ€è¦ä»»ä½•å®Œæ•´çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºæ¥è¿›è¡Œç»„ä»¶å¼€å‘ï¼ˆå¦‚CRLæ‰€å»ºè®®çš„ï¼‰ã€‚ åœ¨æ•…äº‹ä¹¦ä¸­ï¼Œæˆ‘ä»¬ç¼–å†™<code>stories</code> -tsæ–‡ä»¶ï¼Œåœ¨å…¶ä¸­å°†å¸¦æœ‰ä¸€äº›è¾“å…¥<code>props</code>ç»„ä»¶è½¬ç§»åˆ°ç‰¹æ®ŠåŠŸèƒ½ï¼ˆæœ€å¥½æŸ¥çœ‹ä»£ç ä»¥ä½¿å…¶æ›´æ¸…æ¥šï¼‰ã€‚ ç»“æœï¼Œä»è¿™äº›<code>stories</code>æ„å»ºäº†ä¸€ä¸ªå±•ç¤ºåº”ç”¨ç¨‹åºã€‚ </p><br><p> è¿è¡Œåˆå§‹åŒ–æ•…äº‹ä¹¦çš„è„šæœ¬ï¼š </p><br><pre> <code class="bash hljs">npx -p @storybook/cli sb init</code> </pre> <br><p> ç°åœ¨ä¸TSäº¤æœ‹å‹ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ›´å¤šè½¯ä»¶åŒ…ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬å°†æ·»åŠ å‡ ä¸ªæœ‰ç”¨çš„é™„åŠ ç»„ä»¶ï¼š </p><br><pre> <code class="bash hljs">npm install --save-dev awesome-typescript-loader @types/storybook__react @storybook/addon-info react-docgen-typescript-loader @storybook/addon-actions @storybook/addon-knobs @types/storybook__addon-info @types/storybook__addon-knobs webpack-blocks</code> </pre> <br><p> è¯¥è„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªå¸¦æœ‰<code>storybook</code>é…ç½®çš„ç›®å½•<code>.storybook</code>å¹¶åˆ›å»ºäº†ä¸€ä¸ªæˆ‘ä»¬æ— æƒ…åˆ é™¤çš„ç¤ºä¾‹ç›®å½•ã€‚ åœ¨é…ç½®ç›®å½•ä¸­ï¼Œæˆ‘ä»¬å°†æ‰©å±•<code>addons</code>å’Œ<code>config</code>æ›´æ”¹ä¸º<code>ts</code> ã€‚ æˆ‘ä»¬å°†addonsæ·»åŠ åˆ°<code>addons.ts</code>æ–‡ä»¶ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-actions/register'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-links/register'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-knobs/register'</span></span>;</code> </pre> <br><p> ç°åœ¨ï¼Œæ‚¨éœ€è¦ä½¿ç”¨<code>.storybook</code>ç›®å½•ä¸­çš„webpacké…ç½®æ¥å¸®åŠ©æ•…äº‹ä¹¦ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">webpack.config.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ config }</span></span></span><span class="hljs-function">) =&gt;</span></span> { config.module.rules.push({ <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.(ts|tsx)$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">use</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>.resolve(<span class="hljs-string"><span class="hljs-string">'awesome-typescript-loader'</span></span>) }, <span class="hljs-comment"><span class="hljs-comment">// Optional { loader: require.resolve('react-docgen-typescript-loader') } ] }); config.resolve.extensions.push('.ts', '.tsx'); return config; };</span></span></code> </pre> </div></div><br><p> è®©æˆ‘ä»¬å¯¹<code>config.ts</code>é…ç½®è¿›è¡Œä¸€äº›è°ƒæ•´ï¼Œæ·»åŠ è£…é¥°å™¨ä»¥å°†é™„åŠ ç»„ä»¶è¿æ¥åˆ°æˆ‘ä»¬æ‰€æœ‰çš„æ•…äº‹ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">é…ç½®æ–‡ä»¶</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { configure } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { addDecorator } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withInfo } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-info'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withKnobs } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-knobs'</span></span>; <span class="hljs-comment"><span class="hljs-comment">// automatically import all files ending in *.stories.tsx const req = require.context('../src', true, /\.stories\.tsx$/); function loadStories() { req.keys().forEach(req); } configure(loadStories, module); addDecorator(withInfo); addDecorator(withKnobs);</span></span></code> </pre> </div></div><br><p> æˆ‘ä»¬å°†åœ¨ç»„ä»¶ç›®å½•<code>ExampleComponent</code>ç¼–å†™ç¬¬ä¸€ä¸ª<code>story</code> </p><br><div class="spoiler">  <b class="spoiler_title">ExampleComponent.stories.tsx</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { storiesOf } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { ExampleComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./ExampleComponent'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { text } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-knobs/react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> stories = storiesOf(<span class="hljs-string"><span class="hljs-string">'ExampleComponent'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>); stories.add(<span class="hljs-string"><span class="hljs-string">'ExampleComponent'</span></span>, () =&gt; &lt;ExampleComponent text={text('text', 'Some text')} /&gt;, { info: { inline: true }, text: ` ### Notes Simple example component ### Usage ~~~js &lt;ExampleComponent text="Some text" /&gt; ~~~ ` });</code> </pre> <br><p> æˆ‘ä»¬ä½¿ç”¨äº†æ’ä»¶ï¼š </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ—‹é’®</a> -å¯ä»¥å®æ—¶æ›´æ”¹æ•…äº‹ä¹¦ä¸­æ˜¾ç¤ºçš„ç»„ä»¶ä¸­çš„é“å…·ã€‚ ä¸ºæ­¤ï¼Œå°†é“å…·åŒ…è£…åœ¨æ•…äº‹çš„ç‰¹æ®ŠåŠŸèƒ½ä¸­ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¿¡æ¯</a> -å…è®¸æ‚¨å‘æ•…äº‹é¡µé¢æ·»åŠ é“å…·çš„æ–‡æ¡£å’Œæè¿° </li></ul></div></div><br><p> ç°åœ¨æ³¨æ„ï¼Œæ•…äº‹ä¹¦åˆå§‹åŒ–è„šæœ¬å°†storybookå‘½ä»¤æ·»åŠ åˆ°äº†æˆ‘ä»¬çš„<code>package.json</code> ã€‚ ä½¿ç”¨å®ƒæ¥è¿è¡Œ<code>npm run storybook</code> ã€‚ æ•…äº‹ä¹¦å°†åœ¨<code>http://localhost:6006</code>å¤„ç»„è£…å¹¶è¿è¡Œã€‚ ä¸è¦å¿˜è®°åœ¨<code>Rollup</code> config- <code>'src/**/*.stories.tsx'</code>ä¸º<code>typescript</code>æ¨¡å—æ·»åŠ ä¾‹å¤–ã€‚ </p><br><h3 id="razrabatyvaem"> æˆ‘ä»¬æ­£åœ¨å‘å±• </h3><br><p> å› æ­¤ï¼Œåœ¨ä¸ºè‡ªå·±å‡†å¤‡äº†è®¸å¤šæ–¹ä¾¿çš„å·¥å…·å¹¶ä¸ºå·¥ä½œåšå¥½å‡†å¤‡ä¹‹åï¼Œå°±å¯ä»¥å¼€å§‹å¼€å‘æ–°çš„ç»„ä»¶äº†ã€‚ æ¯ä¸ªç»„ä»¶å°†ä»¥<code>src/components</code>åç§°æ”¾åœ¨<code>src/components</code>ç›®å½•ä¸­ã€‚ å®ƒå°†åŒ…å«ä¸ä¹‹å…³è”çš„æ‰€æœ‰æ–‡ä»¶-cssï¼Œtsxæ–‡ä»¶ä¸­çš„ç»„ä»¶æœ¬èº«ï¼Œæµ‹è¯•ï¼Œæ•…äº‹ã€‚ æˆ‘ä»¬å¯åŠ¨æ•…äº‹ä¹¦ï¼Œä¸ºç»„ä»¶åˆ›å»ºæ•…äº‹ï¼Œç„¶ååœ¨å…¶ä¸­ç¼–å†™æ–‡æ¡£ã€‚ æˆ‘ä»¬åˆ›å»ºæµ‹è¯•å¹¶è¿›è¡Œæµ‹è¯•ã€‚ å®Œæˆç»„ä»¶çš„è¿›å‡ºå£è®°å½•åœ¨<code>index.ts</code> ã€‚ </p><br><p> æ­¤å¤–ï¼Œæ‚¨å¯ä»¥ç™»å½•<code>npm</code>å¹¶å°†åº“ä½œä¸ºæ–°çš„npmè½¯ä»¶åŒ…å‘å¸ƒã€‚ æ‚¨å¯ä»¥ç›´æ¥ä»masterå’Œå…¶ä»–åˆ†æ”¯çš„gitå­˜å‚¨åº“ä¸­å°†å…¶è¿æ¥ã€‚ ä¾‹å¦‚ï¼Œå¯¹äºæˆ‘çš„å·¥ä»¶ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š </p><br><pre> <code class="bash hljs">npm i -s git+https://github.com/jmorozov/react-library-example.git</code> </pre> <br><p> å› æ­¤ï¼Œåœ¨åº“ä½¿ç”¨è€…åº”ç”¨ç¨‹åºçš„<code>node_modules</code>ç›®å½•ä¸­ï¼Œåªæœ‰<code>dist</code>ç›®å½•çš„å†…å®¹å¤„äºç»„è£…çŠ¶æ€ï¼Œæ‚¨éœ€è¦åœ¨<code>scripts</code>å­—æ®µä¸­æ·»åŠ <code>"prepare": "npm run build"</code>å‘½ä»¤<code>"prepare": "npm run build"</code> ã€‚ </p><br><p> å¦å¤–ï¼Œç”±äºæœ‰äº†TSï¼ŒIDEä¸­çš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½å°±å¯ä»¥ä½¿ç”¨äº†ã€‚ </p><br><h2 id="podvodim-itogi"> æ€»ç»“ä¸€ä¸‹ </h2><br><p> åœ¨2019å¹´ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¾¿æ·çš„å¼€å‘å·¥å…·è¿…é€Ÿå¼€å§‹åœ¨Reactå’ŒTypeScriptä¸Šå¼€å‘ç»„ä»¶åº“ã€‚ å€ŸåŠ©è‡ªåŠ¨åŒ–å®ç”¨ç¨‹åºå’Œæ‰‹åŠ¨æ¨¡å¼å‡å¯è·å¾—æ­¤ç»“æœã€‚ å¦‚æœéœ€è¦å½“å‰ç¨‹åºåŒ…å’Œæ›´å¤šæ§åˆ¶æƒï¼Œåˆ™é¦–é€‰ç¬¬äºŒç§æ–¹æ³•ã€‚ æœ€ä¸»è¦çš„æ˜¯è¦çŸ¥é“åœ¨å“ªé‡Œè¿›è¡ŒæŒ–æ˜ï¼Œå¹¶å¸Œæœ›å€ŸåŠ©æœ¬æ–‡ä¸­çš„ç¤ºä¾‹ï¼Œè¿™å˜å¾—æœ‰äº›å®¹æ˜“ã€‚ </p><br><p> æ‚¨ä¹Ÿå¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„</a>å–å‡ºç”Ÿæˆçš„å·¥ä»¶ã€‚ </p><br><p> é™¤å…¶ä»–å¤–ï¼Œæˆ‘ä¸å‡è£…æ˜¯ç»ˆæçœŸç†ï¼Œå¹¶ä¸”é€šå¸¸æ¥è¯´ï¼Œæˆ‘ä»äº‹å‰ç«¯å·¥ä½œã€‚ æ‚¨å¯ä»¥é€‰æ‹©å…¶ä»–è½¯ä»¶åŒ…å’Œé…ç½®é€‰é¡¹ï¼Œä¹Ÿå¯ä»¥æˆåŠŸåˆ›å»ºç»„ä»¶åº“ã€‚ å¦‚æœæ‚¨åœ¨è¯„è®ºä¸­åˆ†äº«æ‚¨çš„é£Ÿè°±ï¼Œæˆ‘ä¼šå¾ˆé«˜å…´ã€‚ ç¼–ç æ„‰å¿«ï¼ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN461439/">https://habr.com/ru/post/zh-CN461439/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN461425/index.html">å¦‚ä½•æˆä¸ºäº§å“ç»ç†å¹¶è¿›ä¸€æ­¥å‘å±•</a></li>
<li><a href="../zh-CN461431/index.html">â€œå–œæ¬¢å’Œä¸å–œæ¬¢â€ï¼šé€šè¿‡HTTPSè¿›è¡ŒDNS</a></li>
<li><a href="../zh-CN461433/index.html">åœ¨Net Core 3.0ä¸­ä½¿ç”¨Identity Server 4</a></li>
<li><a href="../zh-CN461435/index.html">ä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œè¿›è¡Œæƒ…æ„Ÿè¯†åˆ«</a></li>
<li><a href="../zh-CN461437/index.html">370ä¸ªç¯æ³¡</a></li>
<li><a href="../zh-CN461441/index.html">ä½¿ç”¨R.å¹¶è¡Œè®¡ç®—ï¼Œå›¾å½¢ï¼Œxlsxï¼Œç”µå­é‚®ä»¶å’Œæ‰€æœ‰è¿™äº›æŠ¥å‘Šå­˜å‚¨çŠ¶æ€</a></li>
<li><a href="../zh-CN461443/index.html">åˆ†æåï¼šæœ‰å…³SKS KeyserveråŠ å¯†å¯†é’¥æœåŠ¡å™¨ç½‘ç»œçš„æœ€æ–°æ”»å‡»çš„å·²çŸ¥ä¿¡æ¯</a></li>
<li><a href="../zh-CN461447/index.html">å…³äºç³»ç»Ÿç®¡ç†å‘˜æ˜¯æ¿’ä¸´ç­ç»çš„ç‰©ç§çš„å²è¯—</a></li>
<li><a href="../zh-CN461449/index.html">PhpStorm 2019.2ï¼šPHP 7.4é”®å…¥çš„å±æ€§ï¼Œé‡å¤çš„Finderï¼ŒEditorConfigï¼ŒShellè„šæœ¬ç­‰</a></li>
<li><a href="../zh-CN461451/index.html">æˆ‘ä¸Haikuçš„ç¬¬äºŒå¤©ï¼šå¾ˆé«˜å…´ï¼Œä½†è¿˜æ²¡å‡†å¤‡å¥½èµ°</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>