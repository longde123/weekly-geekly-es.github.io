<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ôüèø ü§® üë®‚Äçüë©‚Äçüëß‚Äçüëß Automatisierung von End-2-End-Tests eines integrierten Informationssystems. Teil 2. Technische ‚è™ üòç üë´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mit diesem Artikel setzen wir eine Reihe von Ver√∂ffentlichungen fort, die beschreiben, wie wir in einem der wichtigsten LANIT-Projekte den automatisch...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatisierung von End-2-End-Tests eines integrierten Informationssystems. Teil 2. Technische</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lanit/blog/477044/">  Mit diesem Artikel setzen wir eine Reihe von Ver√∂ffentlichungen fort, die beschreiben, wie wir in einem der wichtigsten LANIT-Projekte den automatischen Prozess des manuellen Testens (im Folgenden als Autotests bezeichnet) eines gro√üen Informationssystems (im Folgenden als Systeme bezeichnet) automatisiert haben und was daraus entstanden ist. <br><br>  Der zweite Teil der Ver√∂ffentlichung befasst sich haupts√§chlich mit den Leitern der UI-End-2-End-Tests der Automatisierungsgruppen und der f√ºhrenden Testautomatisierung.  Hier finden sie spezifische Rezepte f√ºr die architektonische Organisation von Code und Deployment, die die massenparallele Entwicklung gro√üer Testgruppen bei st√§ndiger Variabilit√§t der Testspezifikationen unterst√ºtzen.  Dieser Teil enth√§lt die vollst√§ndige Liste der f√ºr UI-Tests erforderlichen Funktionen mit einigen Implementierungsdetails sowie eine Liste der m√∂glichen √úberraschungen. <br><br>  <i>Hier finden Sie <a href="https://habr.com/ru/company/lanit/blog/473426/"><b>Teil 1. (Warum brauchten wir Automatisierung? Organisation des Entwicklungs- und Verwaltungsprozesses. Organisation der Nutzung)</b></a></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e47/985/776/e4798577680ae78fcb67f4c6c8976800.jpg"></div>  <i><a href="https://www.dreamstime.com/">Quelle</a></i> <br><a name="habracut"></a><br><h1>  Architektur- und Technologie-Stapel </h1><br><h3>  Allgemeine Struktur des Systems und seiner Umgebung - High Level Design </h3><br>  Die wichtigsten im Projekt verwendeten Technologien und Bibliotheken: <br><br><ul><li>  JavaSE8 &amp; maven &amp; JUnit - Entwicklungsstapel; </li><li>  <a href="https://www.seleniumhq.org/">Selen</a> - eine Bibliothek zur Automatisierung der Aktionen eines Webbrowsers; </li><li>  <a href="https://ru.selenide.org/">Selenide</a> - ein Add-On f√ºr Selenium mit einer eleganten API, die die Interaktion mit dem Browser und den Seitenelementen erheblich vereinfacht. </li><li>  <a href="https://aerokube.com/selenoid/latest/">Selenoid &amp; GGR</a> - Implementierung von Selenium Grid und eines Lastenausgleichs f√ºr die Ausf√ºhrung von Tests auf einem CI-Server + vorkonfigurierte Container mit Browsern; </li><li>  <a href="http://allure.qatools.ru/">Yandex Allure</a> - f√ºr Berichte auf dem CI-Server. </li></ul><br>  In den folgenden Diagrammen ist ein allgemeines Diagramm der Komponenten der Autotests und der Selenoid-Infrastruktur mit Erl√§uterungen dargestellt: <br><br>  <b>Autotests-Framework</b> <br>  Anwendung zur Automatisierung der Regression von Benutzeroberfl√§chen. <br>  Lieferung im Quellcode.  Verwendet JUnit4 <br><br>  <b>run.properties</b> <br>  Konfigurationsdatei zum Ausf√ºhren von Autotests.  Definiert den bedingten Namen des verwendeten Standes und die Art der Ausf√ºhrung - lokal oder √ºber externe Container und andere Variablen. <br><br>  <b>Allure Plugin</b> <br>  Eine spezielle ausf√ºhrbare Datei, die auf einem Bamboo-Server installiert wird. <br>  Erstellt einen Test-HTML-Bericht, auf den √ºber einen Bamboo-Server zugegriffen werden kann. <br><br>  <b>Testbericht</b> <br>  Test-HTML-Bericht √ºber Bamboo Server verf√ºgbar. <br>  Es wird auf dem Bamboo-Server im Plan gespeichert, was zu einer separaten Registerkarte f√ºhrt. <br><br>  <b>Bambus</b> <br>  Bietet den Start von Integrationstests im automatischen und manuellen Modus. <br>  Speichert Testberichte im Allure-Format. <br><br>  <b>ggr-server</b> <br>  Server-Balancer von Selenoid-Servern. <br>  Erm√∂glicht den Ausgleich von Anforderungen von Autotests (RemoteWebDriver) an mehrere Instanzen von Selenservern. <br><br>  <b>Docker</b> <br>  Docker-Server zum Ausf√ºhren von Selenoid-Server-Containern und -Browsern. <br><br>  <b>Selenoid-Server</b> <br>  Remote-Testserver <br>  Erm√∂glicht den Start von Tests in speziellen Docker-Containern mit einem "kopflosen" Browser. <br>  F√ºhrt Tests im parallelen Modus entsprechend der angegebenen Anzahl gleichzeitiger Threads durch. <br><br>  <b>Selenoid-ui</b> <br>  Server-Benutzeroberfl√§che zum Selenoid-Server. <br>  Erm√∂glicht die direkte √úberwachung des Testfortschritts √ºber VNC. <br><br>  <b>Selenoid-Webtreiber</b> <br>  Ein spezialisierter Container mit einem headless Browser zum Ausf√ºhren von Remote-Tests. <br>  Wird aus dem Selenoid-Repository bereitgestellt. <br><br>  <b>Gitlab</b> <br>  Speichert den Quellcode der Autotests-Anwendung. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c5d/cac/f81/c5dcacf817e4aa1529d7cc4d64be740d.png"></div><br><h3>  Arbeitsschema </h3><br>  Das folgende Diagramm zeigt das allgemeine Schema des AutoTests-Dienstes auf der Entwurfsebene. <br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/webt/ye/e8/ue/yee8uexl8oqy5spoqirropxglha.png"></a> </div><br><h3>  Installation und Bereitstellung </h3><br>  Autotests basieren auf vier Servern, von denen einer der Ausf√ºhrungsserver ist und die anderen drei den Start von Headless-Browsern in Containern erm√∂glichen.  Die aktuelle Leistung von Autotests bietet 60 simultane Streams und kann bei Bedarf erweitert werden. <br><br>  Das aktuelle Bereitstellungsdiagramm ist im folgenden Diagramm dargestellt.  Wenn Sie nicht mehr als 20 Browser gleichzeitig ben√∂tigen (Testthreads), ist es durchaus m√∂glich, alles auf einen Server 12 Kernel + 24 RAM zu setzen.  Wir begannen mit dieser Konfiguration, aber als die Anforderungen an die Leistung von Autotests zunahmen, stellten wir empirisch fest, dass die stabilste und kosteng√ºnstigste Konfiguration ein ‚Äûtypischer‚Äú 12-Kernel + 24-RAM-Server ist. <br><br>  Nach unserer Erfahrung sollte f√ºr Testsysteme mit einer Webschnittstelle auf Angular die akzeptable Konfiguration des Containers mit dem Browser der Kernelboden + GB Arbeitsspeicher sein.  Eine kleinere Konfiguration verlangsamt den Browser und kann sogar zu nicht identifizierbaren Abst√ºrzen f√ºhren. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/152/65f/095/15265f09560a8abd9a744e5c06da1f61.png"></div><br><h1>  Code Struktur und Organisation </h1><br>  Bevor ich zur Struktur und Organisation des Codes √ºbergehe, werde ich noch einmal die Richtlinien und Einschr√§nkungen auflisten, die letztendlich die Richtung f√ºr die Entwicklung der Architektur bestimmt haben: <br><br><ul><li>  Eine gro√üe Anzahl komplexer End-to-End-Testskripte.  Hohe Entwicklungsintensit√§t; </li><li>  hohe Volatilit√§t der Testszenarien (deren Variabilit√§t); </li><li>  hohe kontinuierliche Geschwindigkeit der Szenariobereitstellung (Entwicklung und √úberarbeitung); </li><li>  Erstqualifikation von Entwicklern von Autotests; </li><li>  Hohe geplante Entwicklung von Entwicklern. </li></ul><br>  Auf der Grundlage des Vorstehenden sind die wichtigsten architektonischen Treiber die folgenden: <br><br><ul><li>  Sicherstellung eines stark strukturierten Codes f√ºr einfache Lesbarkeit und Verwaltbarkeit; </li><li>  maximale Trennung und Isolation zwischen Anwendungsimplementierungen spezifischer Tests und √ºbergreifenden Klassen gemeinsamer Funktionalit√§t; </li><li>  Maximale Reduzierung der erforderlichen Abh√§ngigkeiten zur Erleichterung des Wechsels; </li><li>  Angemessene Wiederverwendung von Code auf der Ebene √ºbergreifender Klassen mit akzeptabler m√∂glicher Code-Duplizierung auf der Ebene unabh√§ngiger Testgruppen (funktionale Subsysteme), um Abh√§ngigkeiten zu verringern und Konflikte auf Entwicklungsebene zusammenzuf√ºhren; </li><li>  Ablehnung komplexer Frameworks wie spring, aspectJ, um die Zeit f√ºr den "Einstieg" neuer Entwickler in das Projekt zu verk√ºrzen. </li></ul><br>  Im Allgemeinen erm√∂glichte dieser Architekturansatz die Implementierung einer unabh√§ngigen schnellen Entwicklung unter Bedingungen hoher Variabilit√§t von Szenarien mit einem praktisch kontinuierlichen Prozess der Bereitstellung neuer Tests f√ºr das Produktivsystem.  Architektur und jetzt erfolgreich die "Last und Verfeinerung" trotz der Tatsache, dass das System bereits mehr als 1.500 Gesch√§ftsszenarien implementiert hat. <br><br>  Die allgemeine Codestruktur und Beschreibungen der wichtigsten spezifischen L√∂sungen sind nachstehend aufgef√ºhrt. <br><br><h3>  Allgemeine Codestruktur und Entwicklungsmuster </h3><br>  Die allgemeine Struktur der Codeorganisation basiert auf einer ‚Äûgeschichteten‚Äú Architektur (siehe Diagramm), die im Allgemeinen das von Selenium-Entwicklern empfohlene Seitenmuster √ºbernimmt.  Wir haben dieses Muster erweitert, indem wir der Basis eine Ebene von Webelementen hinzugef√ºgt und die Ebene des Testszenarios hervorgehoben haben: <br><br><ul><li>  Testklassenstufe </li><li>  Test-Szenario-Ebene </li><li>  Webseitenebene </li><li>  Webelementebene </li><li>  Test-Framework (durch Dimmen im Diagramm dargestellt). </li></ul><br>  Jede Ebene in diesem Schema hat bestimmte Verantwortlichkeiten und Funktionen.  Funktionale √úberschneidungen zwischen Layern oder unzul√§ssige Abh√§ngigkeiten zwischen ihnen waren nicht zul√§ssig und waren der Hauptgrund f√ºr die R√ºckgabe des Commits zur √úberarbeitung im Rahmen einer Code√ºberpr√ºfung vor der Zusammenf√ºhrungsanforderung. <br><br>  Zus√§tzlich wurde bei der Aufteilung des Codes in Pakete eine ‚Äûgeschichtete‚Äú Struktur festgelegt (siehe Abbildung unten). <br><br>  Ein solches Schema erm√∂glichte es, alle Subsysteme (von denen es wesentlich mehr als im Schema gab) zwischen Entwicklern aufzuteilen, und infolgedessen war es m√∂glich, mit einer praktisch verschwindenden Anzahl von Zusammenf√ºhrungskonflikten unabh√§ngig voneinander zu entwickeln. <br><br>  Das folgende Diagramm zeigt die allgemeine Struktur der Implementierung der Testklasse und das Verteilungsschema f√ºr die Implementierung der Projektpakete. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c26/582/00e/c2658200ed322c07b65492aef2479074.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/caf/528/329/caf52832908c9f9d739b891d1aafb29d.png"></div><br><h3>  Testklassenstufe </h3><br>  Die Testklassenstufe enth√§lt eine einzelne Klasse f√ºr einen bestimmten Einzeltest (der Test wird im Testmanagementsystem als lineare Folge von Testskripten beschrieben).  Die Testklasse ist eine Junit-Klasse mit der @ Test-Annotation der entsprechenden Methode.  Im Allgemeinen implementiert eine Testklasse nur eine Testmethode. <br><br>  Jede Testklasse erbt von einer Basisklasse, deren Aufgabe es ist, alle TestRules in RuleChain zu initialisieren, dh eine Testinfrastruktur zu initialisieren, z. B. einen Webtreiber zu initialisieren, tempor√§re Verzeichnisse festzulegen und andere universelle Util-Handler. <br><br>  Die Testklasse ist verantwortlich f√ºr die Organisation der Ausf√ºhrung des Testszenarios durch: <br><br><ol><li>  Initialisierung von Testgesch√§ftsdaten (Testszene), </li><li>  sequentieller Aufruf einzelner Testskripte (Actions) gem√§√ü dem gew√ºnschten Szenario mit √úbertragung initialisierter Testdaten ab Schritt 2. </li></ol><br>  Dar√ºber hinaus sollte in Schritt 2 eine lineare Sequenz ohne Verzweigungen oder Entscheidungspunkte vorhanden sein.  Die Klassenimplementierungsvorlage ist unten dargestellt. <br><br><h3>  Testfallstufe </h3><br>  Die Testfallstufe ist f√ºr die Implementierung spezifischer Testf√§lle wie beschrieben verantwortlich.  Ein Testszenario ist in diesem Zusammenhang eine Folge von Vorg√§ngen, die ein Benutzer auf einem System durch Interaktion mit Elementen auf Anwendungswebseiten ausf√ºhrt. <br><br>  Das Hauptziel der Testfallklasse: <br><br><ul><li>  F√ºhren Sie die angegebene Sequenz des Testskripts aus, indem Sie auf die Methoden der unteren Klassen von Page zugreifen <br><br>  o √ºbertragene Testszenendaten, <br>  o Von Webseiten empfangene Daten (aus Seitenklassen); </li><li>  F√ºhren Sie die erforderlichen Gesch√§ftstests f√ºr den Testerfolg im Kontext des Gesch√§ftsmodells und der Testszene durch.  <b>Mit anderen Worten, die Testfallklasse pr√ºft NICHT das Markup, die Verf√ºgbarkeit und die Zug√§nglichkeit von Elementen, sondern arbeitet nach dem Gesch√§ftsmodell der Testszene und f√ºhrt tats√§chlich Gesch√§ftstests durch.</b> </li></ul><br>  Die Testfallklasse ist als "funktionale Schnittstelle" organisiert: <br><br><ul><li>  enth√§lt nur eine √∂ffentliche Methode "apply" (@ Step), die: <br><br>  o Bereitstellung der Implementierung des Skripts als Aufruf einer Folge von "Aktionen" (Methoden, die von den Page-Klassen bereitgestellt werden), <br>  o akzeptiert alle erforderlichen Gesch√§ftsobjekte als Eingabe, erstellt jedoch KEINE Gesch√§ftsobjekte selbst und interagiert NICHT direkt mit etwas anderem als Page-Klassen. </li><li>  enth√§lt X private Methoden (@ Step), von denen jede einen bestimmten separaten Schritt des Testskripts implementiert (wie in TMS - Test Management System beschrieben); </li><li>  Interagiert nicht mit anderen Aktivit√§ten (ruft keine Methoden auf), auch nicht mit Aktivit√§ten eines √§hnlichen Subsystems. </li><li>  akzeptiert keine Eingaben und verarbeitet keine Anmeldedaten.  Mit anderen Worten, wei√ü nichts √ºber die Rollen, von denen es gestartet wird. </li></ul><br>  Mit dieser Klassenorganisation k√∂nnen Sie: <br><br><ul><li>  Bereitstellen eines selbstdokumentierenden Berichts.  Jede Methode entspricht einem bestimmten Punkt in der Testspezifikation und ist mit der Allure-Annotation @ Step versehen. </li><li>  Verwenden Sie die Testskriptklassen in verschiedenen Tests erneut, da das Testskript 1) keine Testszene erstellt und 2) nicht vom Login des Benutzers abh√§ngt (der Login-Relogin-Vorgang wird auf Testklassenebene durchgef√ºhrt). 3) Der Test ist nicht von anderen Klassen abh√§ngig Scripting. </li></ul><br><h3>  Webseitenebene </h3><br>  Die Webseitenebene ist ein klassisches Seitenmuster zum Testen in Selen.  Die Seitenklasse enth√§lt Definitionen bestimmter Webelemente und eine Reihe √∂ffentlicher Methoden zum Ausf√ºhren bestimmter Gruppenaktionen im Kontext von Testfallschritten. <br><br>  Die Seitenklasse ist direkt daf√ºr verantwortlich, Gesch√§ftsdaten in bestimmte Oberfl√§chenelemente einzugeben, mit dem Webtreiber zusammenzuarbeiten (z. B. JS zu starten) und dementsprechend Formate zu testen und das Layout und die Struktur der Webseite auf grundlegende √úberpr√ºfungen zu √ºberpr√ºfen, z gefunden / nicht verf√ºgbar und der Artikel enth√§lt nicht den erforderlichen Wert. <br><br>  Die Seitenklasse enth√§lt auch keine anderen Seiten und deren Methoden und kann nicht auf diese zugreifen.  Au√üerdem f√ºhren die Seitenklassen keine Gesch√§fts√ºberpr√ºfungen durch, sondern beschr√§nken sich im Allgemeinen nur auf strukturelle √úberpr√ºfungen auf der Ebene der Webelemente und stellen die von den Seiten empfangenen Daten auf der Ebene des Testskripts bereit. <br><br><h3>  Webelementebene </h3><br>  Die Webelementschicht enth√§lt eine Bibliothek von finiten Elementen, die sich auf einer Webseite befinden k√∂nnen.  Es enth√§lt sowohl spezifische Grundelemente als auch komplexere Konglomerate, die aus mehreren Elementen bestehen, die wir Widgets nennen.  Beispiele f√ºr Widgets k√∂nnen Konstruktionen wie "Pajinatoren", globale Men√ºs, verschiedene Frames und modale Fenster, komplexe Elemente wie YandexMap oder Youtube Player sein.  Webelemente organisieren die Komposition mit bestimmten Seitenklassen und wissen auch nichts √ºber andere Elemente. <br><br>  Wenn das Projekt eine Art globale eindeutige Identifikation aller Schnittstellenelemente mit ihrer ID aufweist, ist es im Allgemeinen sinnvoll, die Ebene der Webelemente als globale Bibliothek mit der Anforderung bestimmter Elemente nach ihrer ID √ºber die Factory- oder \ xml-Konfigurationsklassen in der Spring-Bibliothek zu organisieren.  Dies ist aber nicht in jedem Projekt m√∂glich. <br><br><h3>  Testframework </h3><br>  Das Konzept der Entwicklung von Autotests, wie es in der obigen Abbildung dargestellt ist, basiert auf der Idee eines Frameworks, in dem eine Reihe von Systemfunktionen f√ºr alle Autotests bereitgestellt wird. Sie sind nahtlos integriert und erm√∂glichen Autotest-Entwicklern, sich auf bestimmte Aspekte der Gesch√§ftsimplementierung von Testklassen zu konzentrieren. <br><br>  Das Framework enth√§lt die folgenden Funktionsbl√∂cke: <br><br><ul><li>  Regeln - Initialisierung und Finalisierung von Testinfrastrukturkomponenten als Initialisierung von WebDriver und Empfang eines Videotests (nachstehend ausf√ºhrlicher beschrieben); </li><li>  WebDriverHandlers - Hilfsfunktionen f√ºr die Arbeit mit einem Webtreiber wie das Ausf√ºhren von Java Script oder den Zugriff auf Browser-Protokolle.  Implementiert als eine Reihe statischer zustandsloser Methoden; </li><li>  WebElements - eine Bibliothek typischer Webelemente oder ihrer Gruppen, enth√§lt die erforderliche funktions√ºbergreifende Funktionalit√§t und das typische Verhalten.  In unserem Fall beinhaltet diese Funktionalit√§t eine m√∂gliche √úberpr√ºfung des Abschlusses von asynchronen Vorg√§ngen auf der Seite des Webbrowsers.  Implementiert als Erweiterung von Webelementen aus den Bibliotheken Selenium und Selenide. </li></ul><br><h3>  Initialisierung der Testumgebung.  Regeln </h3><br>  Die Schl√ºsselklasse f√ºr alle Testklassen ist BaseTest, von der alle Testklassen geerbt werden.  Die BaseTest-Klasse definiert den Junit-Test-Runner und die verwendete RuleChain, wie unten gezeigt.  Der Zugriff von Anwendungstestklassen auf Funktionen, die von Regelklassen bereitgestellt werden, erfolgt √ºber die statischen Methoden von Regelklassen unter Verwendung der Thread-ID "thread" als Schl√ºssel. <br><br>  Details zur Implementierung von Basisklassen f√ºr das Autotest-Framework werden im n√§chsten Teil des Artikels gezeigt: siehe Teil 2-1.  Basisklassenimplementierung f√ºr alle Tests und JUnit ChainRule. <br><br><h3>  Ergebnisse √ºber Allure-Berichte dokumentieren. </h3><br>  F√ºr detaillierte Berichte zu den durchgef√ºhrten Tests wird das Allure Framework verwendet, das √ºber das <a href="https://docs.qameta.io/allure/">Allure Plugin in</a> Bamboo integriert ist.  Dies bietet bestimmten Testkonsumenten (Funktionstest-Team) die M√∂glichkeit, nicht nur Daten √ºber einen bestimmten Testabsturz zu erhalten, sondern auch einen fallengelassenen Test im manuellen Modus einfach wiederherzustellen und gegebenenfalls zu wiederholen. <br><br>  Zur Dokumentation des Pr√ºfberichts wird folgende Funktionalit√§t verwendet: <br><br><ul><li>  Allure- und Junit-Anmerkungen zum Markieren des Berichts anhand der Schritte des Testskripts sowie eine statische Beschreibung der Metadaten f√ºr den Test; </li><li>  Bieten Sie Anh√§nge an, um dem Bericht zus√§tzliche Informationen wie einen Videotest, einen Screenshot, die Ergebnisse zus√§tzlicher Diagnosetests zu den Ursachen des Absturzes sowie Webbrowser-Protokolle hinzuzuf√ºgen, die in den / aus dem Dateibrowser heruntergeladen wurden. </li></ul><br>  Die folgenden Allure- und Junit-Annotationen werden zum Markieren des Berichts verwendet. <br><br><ul><li>  Auf der Testklassenebene: <br><br>  o @ Feature - der Name des funktionalen Subsystems, zu dem der Test geh√∂rt; <br>  o @ Story - der Name eines bestimmten Testfalls; <br>  o @ Owner - der Name des Entwicklers, der zuletzt √Ñnderungen am Test vorgenommen hat; <br>  o @ TmsLink - Link zur Testbeschreibung im verwendeten ‚ÄûTest Management System‚Äú. </li><li>  Auf der Testmethodenebene (@ Test) der Testklasse: <br><br>  o @ DisplayName - vollst√§ndiger Name des Testskripts.  Es unterscheidet sich von @ Story dadurch, dass Sie dieselben Skripte verwenden k√∂nnen, die sich nur in der Zusammensetzung der Testszene unterscheiden. </li><li>  Auf der Ebene der Methoden, die den spezifischen Schritten des Testszenarios entsprechen: <br><br>  o @ Step - Der aussagekr√§ftige Name des Testschritts, der die gesch√§ftliche Essenz des Geschehens widerspiegelt. </li></ul><br>  Die Benennung der Testschritte durch @ Step erm√∂glicht es Ihnen, einen detaillierten Bericht zu erstellen, der alle im Testszenario beschriebenen Schritte und Elemente vollst√§ndig wiederholt.  Auf diese Weise k√∂nnen Benutzer von Autotests den Verlauf des Testszenarios auf einfache Weise nachverfolgen und den Inzidenzpunkt bestimmen. <br><br>  Im Allgemeinen erwies sich die Verwendung des Allure Frameworks als sehr n√ºtzlich und einfach, mit Ausnahme einiger Funktionen, die sich auf die enorme Datenmenge beziehen, die in unserem Fall f√ºr eine gro√üe Anzahl langer komplexer Testskripten generiert wird (weiter unten im Abschnitt "R√ºckblick" beschrieben). <br><br><h3>  Was h√§tte auf Anhieb anders gemacht werden k√∂nnen?  Verwenden Sie Spring Framework </h3><br>  Obwohl wir uns bei der Implementierung von Autotests absichtlich geweigert haben, Spring Core zu verwenden, halte ich seine Verwendung im Allgemeinen f√ºr gerechtfertigt und funktionsf√§hig.  Der implementierte Prototyp zeigte, dass die Verwendung von Spring Core f√ºr die folgenden Aufgaben funktioniert (obwohl wir es nat√ºrlich nicht vollst√§ndig getestet haben): <br><br><ul><li>  Initialisierung der Testszene; </li><li>  Initialisierung von Webseiten und Elementen. </li></ul><br>  Das einzige Merkmal ist die Notwendigkeit, den "Standard" -Umfangskontext der Prototypebene zu verwenden. <br><br>  Initialisierung der Testszene.  In Autotests wird die Testszene durch die klassische Methode initialisiert, Klasseninstanzen direkt in der Testklasse √ºber eine einfache neue oder Objektfactory zu erstellen.  Hier ist es durchaus sinnvoll, die Initialisierung entweder √ºber Konfigurationsklassen oder √ºber externe XML- oder Dateidateien zu verwenden.  Die Vorteile sind folgende: 1) Vereinfacht den √úberpr√ºfungscode, da √Ñnderungen an der Testszene nicht mehr f√ºr Schl√ºsselklassen gelten. 2) Erm√∂glicht das Anschlie√üen verschiedener Testszenen f√ºr verschiedene St√§nde oder andere Bedingungen.  Jetzt wird Punkt 2 bei uns nicht verwendet. <br><br>  Initialisierung von Webseiten und Elementen.  Das Einf√ºgen von Web-Klassen und Web-Elementen funktioniert aufgrund der verz√∂gerten Initialisierung von Selenid-Web-Elementen. <br><br>  Somit wird es m√∂glich, eine Bibliothek von Webelementen und -seiten gem√§√ü einer bestimmten globalen Spezifikation der Benutzeroberfl√§che zu erstellen und im Code Links zu diesen Elementen nicht √ºber den absoluten Pfad und die ID, sondern √ºber die Projekt-ID gem√§√ü der Spezifikation zu erhalten. <br><br>  Ich muss gleich sagen, dass ich dies nicht sehr sorgf√§ltig getestet habe, sondern mich auf eine Testimplementierung der "Seiten" des Logins und der "Infoseite" des Nutzers nach diesem Prinzip beschr√§nkt habe. <br><br><h1>  R√ºckblick.  √úberraschungen </h1><br>  Hier habe ich die unerwarteten √úberraschungen beschrieben, die w√§hrend der Entwicklung des Projekts aufgetreten sind, sowie einige √úberlegungen dar√ºber, was h√§tte besser gemacht werden k√∂nnen, wenn ‚Äûnicht‚Äú. <br><br><h3>  Selen-freundliches Frontend-Markup (Angular) </h3><br>  Eine der schwerwiegendsten √úberraschungen war das ‚Äûschwebende‚Äú Seitenlayout, das dazu f√ºhrte, dass die Tests nach der Aktualisierung von Angular-Anwendungen zur√ºckgingen, weil Selen die Elemente aufgrund ihrer ID (ID, Klasse oder ID) nicht finden konnte ng-Modell) oder Pfade (f√ºr XPath).  Dies f√ºhrte zu einer Instabilit√§t der Tests und der Mehrdeutigkeit der Gr√ºnde f√ºr den Sturz. <br><br>  Leider stellte sich heraus, dass dieses Problem im Allgemeinen nicht l√∂sbar ist.  Wir haben dies mit organisatorischen Ma√ünahmen umgangen: 1) Zu Beginn des Tests eines neuen Kandidaten f√ºr die Freigabe konzentrieren sich alle Entwickler von Autotests auf die schnelle Eliminierung und Verfeinerung hinsichtlich der Bearbeitung der Werte von Webelement-Locators.  2) Am Ende haben wir relativen XPath verwendet, der leider die Leistung √ºberhaupt nicht verbessert. <br><br>       ‚Äì            ,         -        . <br><br><h3>     ¬´download¬ª  </h3><br>  ¬´¬ª        : <br><br><ul><li>  ¬´¬ª   (    ) ‚Äì   ¬´¬ª          .          ; </li><li>  ¬´¬ª  ( Bamboo)  ¬´¬ª       solenoid : <a href="http://selenoid-host.example.com:4444/download/%257BSESSION_ID%257D/%257BFILE_NAME%257D">selenoid-host.example.com:4444/download/{SESSION_ID}/{FILE_NAME}</a> </li></ul><br>    <a href="https://aerokube.com/selenoid/latest/"></a> . <br><br>            .     ,      ,         .           ,       . <br><br><h3>     </h3><br>         .        ,   ¬´¬ª          . ,                  ,  ,  ,     ,       - (    )  -     . <br><br>  ,       ,    ,       .             . <br><br>    ,    .         ¬´¬ª ,          ,     ,            . <br><br><h3>    </h3><br>              . ,      .      (~ 1000  )       6 . <br><br>          <a href="https://aerokube.com/ggr/latest/">Selenoid-ggr</a> .        junit  20 ( Selenoid-)  60 ( ),        . ¬´¬ª ,          60  . <br><br> ,    ,  ,         3-4 ,        preQA-.    . , ,   AWS c   ,    Selenoid-     ,         AWS   Selenoid,     in/out . <br>   ,       ,             E2E      .              preQA. <br><br><h3>  ¬´¬ª       </h3><br>        ,         60     60 . <br><br>    ¬´Timeline¬ª    ¬´ ¬ª (  ). ,             . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/580/84e/60b/58084e60b239a6157b54db4e8b9c496c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gab zwei Gr√ºnde. </font><font style="vertical-align: inherit;">Der beginnende ‚ÄûPlug‚Äú wurde durch den Massenappell an den Autorisierungsdienst und das pers√∂nliche Konto verursacht. </font><font style="vertical-align: inherit;">Alle Browser starten gleichzeitig die Anmeldung und √ºberlasten den Dienst auf der Pr√ºfstandsseite. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die folgenden ‚ÄûSpalten‚Äú standen in Zusammenhang mit der Tatsache, dass unsere Testklassen nach Subsystemen in Ordnern abgelegt und von junit fast gleichzeitig ausgef√ºhrt wurden, wodurch ein bestimmtes funktionales Subsystem des Standes geladen und die Leistungsgrenze der Standkonfiguration √ºberschritten wurde. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben das erste Problem gel√∂st, indem wir die Anmeldeskriptmethode in den Balancer eingebunden haben, wodurch die maximale Anzahl der Anmeldevorg√§nge auf eine bestimmte Konstante begrenzt wurde.</font></font><br><br><pre><script type="text/javascript">function gtElInit() {var lib = new google.translate.TranslateService();lib.translatePage('ru', 'de', function () {});}</script><script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=gtElInit&amp;client=wt"></script><code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Step</span></span>(<span class="hljs-string"><span class="hljs-string">":    "</span></span>)     <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">apply</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(User user)</span></span></span><span class="hljs-function"> </span></span>{     <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {         LoadCounter.get(); <span class="hljs-comment"><span class="hljs-comment">//   .              try {                 applyLogin(user); //          } catch (Throwable t) {             throw t; //                   } finally {             LoadCounter.release(); //            }         } catch (LoadCounterException e) { //                  throw new StandRuntimeException("Can not get loadcounter for Login action.", e);     }     }</span></span></code> </pre> <br>  Das zweite Problem wurde gel√∂st, indem die Option f√ºr zuf√§llige Testl√§ufe aktiviert wurde, √ºber die das junit maven-Plugin verf√ºgt. <br><br><pre> <code class="java hljs">   &lt;plugin&gt;               &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;                &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;         &lt;version&gt;‚Ä¶.&lt;/version&gt;            &lt;configuration&gt;                &lt;!-- Defines the order the tests will be run in. Supported values are <span class="hljs-string"><span class="hljs-string">"alphabetical"</span></span>,                     <span class="hljs-string"><span class="hljs-string">"reversealphabetical"</span></span>, <span class="hljs-string"><span class="hljs-string">"random"</span></span>,<span class="hljs-string"><span class="hljs-string">"hourly"</span></span>, <span class="hljs-string"><span class="hljs-string">"failedfirst"</span></span>, <span class="hljs-string"><span class="hljs-string">"balanced"</span></span> and <span class="hljs-string"><span class="hljs-string">"filesystem"</span></span>. --&gt;                &lt;runOrder&gt;random&lt;/runOrder&gt;                ‚Ä¶</code> </pre><br>  Es muss angemerkt werden, dass diese Probleme damit zusammenh√§ngen, dass wir aufgrund begrenzter Ressourcen nicht die M√∂glichkeit hatten, die Leistung des Pr√ºfstands zu steigern, und auch, weil diese Ressourcen die meiste Zeit im Leerlauf waren. <br><br>  Im Allgemeinen hat sich herausgestellt, dass das eingebaute E2E-System der Web-UI-Selbsttests gut zum Testen der Ersatzlast und zum √úberpr√ºfen der Leistung und Stabilit√§t des gesamten getesteten Systems verwendet werden kann. <br><br><h3>  Hohe Belastung des Bamboo-Servers und seines Speichers </h3><br>  Wenn Sie viele Tests mit einer gro√üen Anzahl von Vorg√§ngen haben (z. B. die Anzahl der durch <a href="https://habr.com/ru/users/step/" class="user_link">Step</a> protokollierten Vorg√§nge zwischen 200 und 2000 mit einer Anzahl von Tests von etwa 1300), wird das Volumen des Allure-Berichts mehr als bedeutend.  Wenn Sie hier auch verschiedene Anh√§nge wie Screenshots und hochgeladene / hochgeladene Dateien hinzuf√ºgen, dann geht das Volumen schon auf Hunderte von Megabyte.  Beispiel: Bei einer n√§chtlichen Regression von 900 Tests betr√§gt die Datenmenge, die allein in Bamboo Allure hochgeladen wird, ungef√§hr 600 MB. <br><br>  Es ist klar, dass die Entwickler von DevOps nicht begeistert sind von einer solchen Intensit√§t, bei der Speicherplatz verbraucht wird, und aktiv Unzufriedenheit ausdr√ºcken, insbesondere im Zusammenhang mit der Notwendigkeit, Daten f√ºr mindestens ein Jahr zu speichern. <br><br>  Wir sehen einen Ausweg aus dieser Situation, indem wir einen externen Server zum Speichern und Verarbeiten von Berichten verwenden, z. B. Allure Enterprise.  Dieser Server ist bereits bezahlt, aber wir k√∂nnen dieses Problem l√∂sen.  Wir arbeiten derzeit daran, Allure Enterprise zu testen und in unser Projekt zu integrieren. <br><br><h1>  Fortsetzung folgt </h1><br>  Im n√§chsten Artikel werden meine Kollegen die Geschichte fortsetzen und die faszinierende Geschichte des Testens von Webdiensten mit Smartbear SoapUI Pro beschreiben.  Den Kr√§ften zweier Automatisierungsingenieure gelang es, rund 500 Testskripte zu automatisieren, wozu ich ein zus√§tzliches Framework implementieren musste, das die Funktionalit√§t der Standard-SOAP-UI-Funktionen erheblich erweitert, aber dazu sp√§ter mehr. <br><br>  <b><i>Dieser Artikel wurde in Zusammenarbeit mit dem Projektmanager und dem Eigent√ºmer des <a href="https://habr.com/ru/users/kotalesssk/" class="user_link">kotalesssk-</a> Produkts verfasst.</i></b> <br><br>  <a href="https://habr.com/ru/company/lanit/blog/473426/">Teil 1. Organisatorisch und leitend.</a>  <a href="https://habr.com/ru/company/lanit/blog/473426/">Warum brauchten wir Automatisierung?</a>  <a href="https://habr.com/ru/company/lanit/blog/473426/">Organisation des Entwicklungs- und Managementprozesses.</a>  <a href="https://habr.com/ru/company/lanit/blog/473426/">Organisation der Nutzung</a> <br>  Teil 2. Technische.  Architektur und technischer Stapel.  Implementierungsdetails und technische √úberraschungen <br>  Teil 2-1.  Basisklassenimplementierung f√ºr alle Tests und JUnit ChainRule <br>  Teil 2-2.  Implementierung des Vorgangs zum Hochladen einer Datei aus einem Container mit einem Browser in ein Testframework.  Suchen Sie nach dem Namen der vom Browser heruntergeladenen Datei <br><br><div class="spoiler">  <b class="spoiler_title">Wir haben freie Stellen, kommen Sie zu uns!</b> <div class="spoiler_text"><ul><li>  <a href="https://job.lanit.ru/young/programs/Pages/dks2019testir.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2019-12-03%26utm_campaign%3Ddks">Praktikumsprogramm "Automatisiertes Testen"</a> </li><li>  <a href="https://job.lanit.ru/young/programs/Pages/dks-2019.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2019-12-03%26utm_campaign%3Ddks">Praktikumsprogramm "Belastungstests"</a> </li><li>  <a href="https://job.lanit.ru/vacancy/Pages/CH-165.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2019-12-03%26utm_campaign%3Ddks">Test Engineer Trainee</a> </li><li>  <a href="https://job.lanit.ru/vacancy/Pages/BS-72.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2019-12-03%26utm_campaign%3Ddks">F√ºhrender Spezialist f√ºr Funktionstests</a> </li><li>  <a href="https://job.lanit.ru/vacancy/Pages/BS-46.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2019-12-03%26utm_campaign%3Ddks">Lead Automated Testing Engineer</a> </li></ul></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de477044/">https://habr.com/ru/post/de477044/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de477026/index.html">Siebter j√§hrlicher JetBrains Hackathon</a></li>
<li><a href="../de477032/index.html">Von der Blockchain zur DAG: Zwischenh√§ndler loswerden</a></li>
<li><a href="../de477038/index.html">Die beste Programmiersprache f√ºr Anf√§nger</a></li>
<li><a href="../de477040/index.html">Gartner Chart 2019: Worum geht es bei all diesen Schlagworten?</a></li>
<li><a href="../de477042/index.html">Monte Carlo Blackjack Strategieoptimierung</a></li>
<li><a href="../de477046/index.html">.Net Meetup bei der Raiffeisenbank 28/11 + Broadcast</a></li>
<li><a href="../de477048/index.html">Warum hat ein Unternehmen mit einem Kapital von 55 Milliarden US-Dollar daran gedacht, die B√∂rse zu verlassen?</a></li>
<li><a href="../de477050/index.html">Black Friday 2019 f√ºr Video√ºberwachung und Wolken.</a></li>
<li><a href="../de477052/index.html">Reactor, WebFlux, Kotlin Coroutines oder Asynchrony anhand eines einfachen Beispiels</a></li>
<li><a href="../de477054/index.html">Webasto k√ºndigt modulares Fahrzeugbatteriesystem an</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>