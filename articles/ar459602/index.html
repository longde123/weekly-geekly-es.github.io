<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐๐ฝ โ๐ผ ูููุง ุจุชุถููู ูุชุฑุฌู Lua ูู ูุดุฑูุน ุงููุชุญูู ุงูุฏููู (stm32) ๐ฉ ๐ป ๐๐ฟ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ุงูุชุทุจููุงุช ุงููุจูุฑุฉ ุฅูู ุญุฏ ูุง ุ ุฌุฒุก ูุจูุฑ ูู ุงููุดุฑูุน ูู ููุทู ุงูุฃุนูุงู. ูู ุงููุฑูุญ ุชุตุญูุญ ูุฐุง ุงูุฌุฒุก ูู ุงูุจุฑูุงูุฌ ุนูู ุงูููุจููุชุฑ ุ ุซู ุชุถูููู ูู ุงููุดุฑูุน ุงูุฎุงุต...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูููุง ุจุชุถููู ูุชุฑุฌู Lua ูู ูุดุฑูุน ุงููุชุญูู ุงูุฏููู (stm32)</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459602/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/p6/9j/kz/p69jkzome873c4rbil8fftedrxs.png"><br><br>  ูู ุงูุชุทุจููุงุช ุงููุจูุฑุฉ ุฅูู ุญุฏ ูุง ุ ุฌุฒุก ูุจูุฑ ูู ุงููุดุฑูุน ูู ููุทู ุงูุฃุนูุงู.  ูู ุงููุฑูุญ ุชุตุญูุญ ูุฐุง ุงูุฌุฒุก ูู ุงูุจุฑูุงูุฌ ุนูู ุงูููุจููุชุฑ ุ ุซู ุชุถูููู ูู ุงููุดุฑูุน ุงูุฎุงุต ุจุงููุฑุงูุจ ุงูุฏููู ุ ูุชููุนูุง ุฃู ูุชู ุชูููุฐ ูุฐุง ุงูุฌุฒุก ุชูุงููุง ููุง ูุงู ุงูุบุฑุถ ููู ุฏูู ุฃู ุชุตุญูุญ (ุญุงูุฉ ูุซุงููุฉ). <br><br>  ูุธุฑูุง ูุฃู ูุนุธู ุจุฑุงูุฌ ุงููุชุญููุงุช ุงูุฏูููุฉ ููุชูุจุฉ ุจูุบุฉ C / C ++ ุ ูููุฐู ุงูุฃุบุฑุงุถ ุ ุนุงุฏุฉู ูุง ูุณุชุฎุฏููู ูุฆุงุช ูุฌุฑุฏุฉ ุชููุฑ ูุงุฌูุงุช ููููุงูุงุช ููุฎูุถุฉ ุงููุณุชูู (ุฅุฐุง ูุงู ุงููุดุฑูุน ููุชูุจูุง ููุท ุจุงุณุชุฎุฏุงู C ุ ูุบุงูุจูุง ูุง ุชุณุชุฎุฏู ููุงูู ูุคุดุฑ ุงููุธุงุฆู).  ูููุฑ ูุฐุง ุงูููุฌ ุงููุณุชูู ุงููุทููุจ ูู ุงูุชุฌุฑูุฏ ุนูู ุงูุญุฏูุฏ ุ ููุน ุฐูู ุ ูุฅูู ูุญููู ุจุงูุญุงุฌุฉ ุฅูู ุฅุนุงุฏุฉ ุงูุชุฌููุน ุงููุณุชูุฑ ูููุดุฑูุน ุ ูููู ุจุฑูุฌุฉ ุงูุฐุงูุฑุฉ ุบูุฑ ุงููุชุทุงูุฑุฉ ูููุฑุงูุจ ุงููุชุญูู ูุน ููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุจุฑูุงูุฌ ุงูุซุงุจุช</a> ุงูุซูุงุฆู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุจูุฑ</a> . <br><br>  ููุน ุฐูู ุ ููุงู ุทุฑููุฉ ุฃุฎุฑู - ุงุณุชุฎุฏุงู ูุบุฉ ุงูุจุฑูุฌุฉ ุงููุตูุฉ ุงูุชู ุชุณูุญ ูู ุจุชุตุญูุญ ููุทู ุงูุนูู ูู ุงูููุช ุงููุนูู ุนูู ุงูุฌูุงุฒ ููุณู ุฃู ุชุญููู ุงูุจุฑุงูุฌ ุงููุตูุฉ ููุนูู ูุจุงุดุฑุฉ ูู ุงูุฐุงูุฑุฉ ุงูุฎุงุฑุฌูุฉ ุ ุฏูู ุชุถููู ูุฐุง ุงูุฑูุฒ ูู ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ ููุชุญูู ุงูุฏููู. <br><br>  ุงุฎุชุฑุช ููุง ููุบุฉ ุงูุจุฑูุฌุฉ. <a name="habracut"></a><br><br><h2 style=";text-align:right;direction:rtl">  ููุงุฐุง ููุงุ </h2><br>  ููุงู ุงูุนุฏูุฏ ูู ูุบุงุช ุงูุจุฑูุฌุฉ ุงููุตูุฉ ุงูุชู ููููู ุชุถููููุง ูู ูุดุฑูุน ูุชุญูู ุฏููู.  ููุฌุฏ ุนุฏุฏ ูููู ุจุณูุท ูุซู BASIC ุ PyMite ุ Pawn ... ููู ูููุง ุฅูุฌุงุจูุงุช ูุณูุจูุงุช ุ ูู ูุชู ุชุถููู ููุงูุดุฉ ููุง ูู ูุงุฆูุฉ ุงููุถุงูุง ุงูุชู ุชูุช ููุงูุดุชูุง ูู ูุฐู ุงูููุงูุฉ. <br><br>  ุจุงุฎุชุตุงุฑ ุญูู ูุง ูู ุฌูุฏ ุนูู ูุฌู ุงูุชุญุฏูุฏ ููุง - ูููู ุงูุนุซูุฑ ุนูููุง ูู ููุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"ููุง ูู 60 ุฏูููุฉ</a> . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"</a>  ุฃููููู ูุฐุง ุงูููุงู ูุซูุฑูุง ุ ููุฃุบุฑุงุถ ุฏุฑุงุณุฉ ุฃูุซุฑ ุชูุตูููุง ููุฐู ุงููุณุฃูุฉ ุ ูุฑุฃุช ูุชุงุจ ุงูุฏููู ุงูุฑุณูู ูู ูุคูู ูุชุงุจ Robert Jeruzalimsky ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุจุฑูุฌุฉ ูู ููุง</a> " (ูุชููุฑ ูู ุงูุชุฑุฌูุฉ ุงูุฑูุณูุฉ ุงูุฑุณููุฉ). <br><br>  ุฃูุฏ ุฃูุถูุง ุฃู ุฃุฐูุฑ ูุดุฑูุน eLua.  ูู ุญุงูุชู ุ ูุฏู ุจุงููุนู ุทุจูุฉ ููุฎูุถุฉ ุงููุณุชูู ูู ุงูุจุฑูุฌูุงุช ุงูุฌุงูุฒุฉ ููุชูุงุนู ูุน ูู ูู ุงูุฃุฌูุฒุฉ ุงูุทุฑููุฉ ูุฌูุงุฒ ุงูุชุญูู ุงูุฏููู ูุงูุฃุฌูุฒุฉ ุงูุทุฑููุฉ ุงูุฃุฎุฑู ุงููุทููุจุฉ ุงูููุฌูุฏุฉ ุนูู ููุญุฉ ุงูุฌูุงุฒ.  ูุฐูู ุ ูู ุฃููุฑ ูู ูุฐุง ุงููุดุฑูุน (ูุฃูู ูู ุงููุนุชุฑู ุจู ุชูููุฑ ุงูุทุจูุงุช ููุณูุง ูุฑุจุท ุฌููุฑ Lua ุจุงูุฃุฌูุฒุฉ ุงูุทุฑููุฉ ูู ูุชุญูู ุฏููู). <br><br><h2 style=";text-align:right;direction:rtl">  ุญูู ุงููุดุฑูุน ุงูุฐู ุณูุชู ุชุถููู Lua ููู </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุญุณุจ ุงูุชูุงููุฏ</a> ุ ุณูุชู ุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุดุฑูุน ุตูุฏูู ุงูุญูุงูุฉ ุงูุฎุงุต</a> ุจู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฌูุฏุฉ</a> ููุญูู ููุชุฌุงุฑุจ (ุงุฑุชุจุท ุจุงูุงูุชุฒุงู ูุน ููุง ุงููุฏูุฌุฉ ุจุงููุนู ูุน ูู ุงูุชุญุณููุงุช ุงููุงุฒูุฉ ุงูููุถุญุฉ ุฃุฏูุงู). <br><br>  ูุนุชูุฏ ุงููุดุฑูุน ุนูู ูุชุญูู stm32f405rgt6 ูุน 1 ููุบุงุจุงูุช ุบูุฑ ูุชููุจุฉ ู 192 ูููู ุจุงูุช ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู (ุงููุชู ุงููุฏููุฉ ุงูุฃูุฏู ุจุณุนุฉ 128 ููููุจุงูุช ุงููุณุชุฎุฏูุฉ ุญุงูููุง). <br><br>  ูุญุชูู ุงููุดุฑูุน ุนูู ูุธุงู ุชุดุบูู ูู ุงูููุช ุงููุนูู ูู FreeRTOS ูุฏุนู ุงูุจููุฉ ุงูุชุญุชูุฉ ููุฃุฌูุฒุฉ ุงูุทุฑููุฉ.  ูุชู ุชุฎุตูุต ุฌููุน ุงูุฐุงูุฑุฉ ููููุงู ูุงูุฅุดุงุฑุงุช ูุบูุฑูุง ูู ูุงุฆูุงุช FreeRTOS ุจุดูู ุซุงุจุช ูู ูุฑุญูุฉ ุงูุฑุจุท (ุงูููุฌูุฏุฉ ูู ููุทูุฉ .bss ูู RAM).  ุฌููุน ููุงูุงุช FreeRTOS (ุงูุฅุดุงุฑุงุช ุ ูููุงุฆู ุงูุงูุชุธุงุฑ ุ ูุฃููุงู ุงูููุงู ุ ููุง ุฅูู ุฐูู) ูู ุฃุฌุฒุงุก ูู ูุงุฆูุงุช ุนููููุฉ ูู ุงูููุงุทู ุงูุฎุงุตุฉ ูู ูุตูููุง.  ููุน ุฐูู ุ ูุง ูุฒุงู ูุชู ุชุฎุตูุต ูููุฉ FreeRTOS ูุฏุนู ูุธุงุฆู <i>malloc</i> ุ <i>free</i> ุ <i>calloc</i> (ุงููุทููุจุฉ ูููุธุงุฆู ูุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">printf</a> ) ุงูุชู ุชู ุฅุนุงุฏุฉ ุชุนุฑูููุง ููุนูู ูุนูุง.  ููุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ูุฑุชูุนุฉ ููุนูู ูุน ุจุทุงูุงุช MicroSD (FatFS) ุ ููุฐูู ุชุตุญูุญ ุฃุฎุทุงุก UART (115200 ุ 8N1). <br><br><h2 style=";text-align:right;direction:rtl">  ุญูู ููุทู ุงุณุชุฎุฏุงู Lua ูุฌุฒุก ูู ุงููุดุฑูุน </h2><br>  ูุบุฑุถ ุชุตุญูุญ ููุทู ุงูุฃุนูุงู ุ ูู ุงูููุชุฑุถ ุฃู ูุชู ุฅุฑุณุงู ุงูุฃูุงูุฑ ุจูุงุณุทุฉ UART ุ ูุนุจุฃุฉ (ููุงุฆู ูููุตู) ูู ุงูุฃุณุทุฑ ุงูููุงุฆูุฉ (ุชูุชูู ุจุงูุญุฑู "\ n" + 0 ูุงุตู) ูุชุฑุณู ุฅูู ุขูุฉ lua.  ูู ุญุงูุฉ ุงูุชูููุฐ ุบูุฑ ุงููุงุฌุญ ุ ุงูุฅุฎุฑุงุฌ ุนู ุทุฑูู printf (ูุฃูู ูุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชูุฑุทูุง</a> ูู ุงููุดุฑูุน ุณุงุจููุง).  ุนูุฏูุง ูุชู ุชุตุญูุญ ุงูููุทู ุ ุณูููู ูู ุงููููู ุชูุฒูู ููู ููุทู ุงูุฃุนูุงู ุงูููุงุฆู ูู ุงูููู ูู ุจุทุงูุฉ microSD (ุบูุฑ ูุฏุฑุฌุฉ ูู ูุงุฏุฉ ูุฐู ุงูููุงูุฉ).  ุฃูุถูุง ุ ูุบุฑุถ ุชุตุญูุญ ุฃุฎุทุงุก Lua ุ ุณูุชู ุชูููุฐ ุงูุฌูุงุฒ ุฏุงุฎู ูุคุดุฑ ุชุฑุงุจุท FreeRTOS ูููุตู (ูู ุงููุณุชูุจู ุ ุณูุชู ุชุฎุตูุต ูุคุดุฑ ุชุฑุงุจุท ูููุตู ููู ุจุฑูุงูุฌ ูุตู ููุทู ุฃุนูุงู ุชู ุชุตุญูุญู ูุงูุฐู ุณูุชู ุชูููุฐู ูุน ุจูุฆุชู). <br><br><h2 style=";text-align:right;direction:rtl">  ุฅุฏุฑุงุฌ ุงููุญุฏุฉ ุงููุฑุนูุฉ ููุง ูู ุงููุดุฑูุน </h2><br>  ุณูุชู ุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุฑุขุฉ ุงูุฑุณููุฉ ูููุดุฑูุน ุนูู github</a> ููุตุฏุฑ ูููุชุจุฉ lua (ุญูุซ ูุชู ูุดุฑ ูุดุฑูุนู ุฃูุถูุง ููุงู. ููููู ุงุณุชุฎุฏุงู ุงููุตุงุฏุฑ ูุจุงุดุฑุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููููุน ุงูุฑุณูู</a> ).  ูุธุฑูุง ูุฃู ุงููุดุฑูุน ูุญุชูู ุนูู ูุธุงู ุซุงุจุช ูุชุฌููุน ูุญุฏุงุช ูุฑุนูุฉ ูุฌุฒุก ูู ุงููุดุฑูุน ุ ููุงุฆู CMake ูุฑุฏูุฉ ููู ูุญุฏุฉ ูุฑุนูุฉ ุ ููุฏ ููุช ุจุฅูุดุงุก ูุญุฏุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฑุนูุฉ ูููุตูุฉ</a> ุชุถููุช ูููุง ูุฐู ุงูุดููุฉ ูููุงุฆู CMake ููุญูุงุธ ุนูู ููุท ุจูุงุก ูุงุญุฏ. <br><br>  ุชููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CMakeLists</a> ุจุฅูุดุงุก ูุตุงุฏุฑ ูุณุชูุฏุน lua ูููุชุจุฉ ุซุงุจุชุฉ ุชุญุชูู ุนูู ุฃุนูุงู ุชุฌููุน ุงููุญุฏุงุช ุงููุฑุนูุฉ ุงูุชุงููุฉ (ูุฃุฎูุฐุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููู ุชูููู ูุญุฏุฉ ูุฑุนูุฉ</a> ูู ุงููุดุฑูุน ุงูุฑุฆูุณู): <br><br><pre style=";text-align:right;direction:rtl"><code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">SET</span></span>(C_COMPILER_FLAGS <span class="hljs-string"><span class="hljs-string">"-std=gnu99;-fshort-enums;-fno-exceptions;-Wno-type-limits;-ffunction-sections;-fdata-sections;"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span>(MODULE_LUA_COMP_FLAGS <span class="hljs-string"><span class="hljs-string">"-O0;-g3;${C_COMPILER_FLAGS}"</span></span></code> </pre> <br>  ูุฃุนูุงู ููุงุตูุงุช ุงููุนุงูุฌ ุงููุณุชุฎุฏู (ุชุนููููุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงุฆู CMake ุงูุฌุฐุฑ</a> ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">SET</span></span>(HARDWARE_FLAGS -mthumb; -mcpu=cortex-m4; -mfloat-abi=hard; -mfpu=fpv4-sp-d16;)</code> </pre> <br>  ูู ุงูููู ุงูุฅุดุงุฑุฉ ุฅูู ุถุฑูุฑุฉ ููุงู CMakeLists ุงูุฌุฐุฑ ุจุชุญุฏูุฏ ุชุนุฑูู ูุณูุญ ุจุนุฏู ุงุณุชุฎุฏุงู ุงูููู ุงููุฒุฏูุฌุฉ (ูุธุฑูุง ูุฃู ุงููุชุญูู ุงูุฏููู ูุง ูุญุชูู ุนูู ุฏุนู ููุฃุฌูุฒุฉ ุงููุถุงุนูุฉ. ุชุนููู ููุท): <br><br><pre style=";text-align:right;direction:rtl"> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">add_definitions</span></span>(-DLUA_32BITS)</code> </pre> <br>  ุญุณููุง ุ ูุจูู ููุท ูุฅุจูุงุบ ุงูุฑุงุจุท ุจุงูุญุงุฌุฉ ุฅูู ุชุฌููุน ูุฐู ุงูููุชุจุฉ ูุฅุฏุฑุงุฌ ุงููุชูุฌุฉ ูู ุชุฎุทูุท ุงููุดุฑูุน ุงูููุงุฆู: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุฎุทุท CMakeLists ูุฑุจุท ูุดุฑูุน ุจููุชุจุฉ lua</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">add_subdirectory</span></span>(<span class="hljs-variable"><span class="hljs-variable">${CMAKE_SOURCE_DIR}</span></span>/bsp/submodules/module_lua) ... <span class="hljs-keyword"><span class="hljs-keyword">target_link_libraries</span></span>(<span class="hljs-variable"><span class="hljs-variable">${PROJECT_NAME}</span></span>.elf PUBLIC <span class="hljs-comment"><span class="hljs-comment"># -Wl,--start-group       #      . #  Lua    ,      #  . "-Wl,--start-group" ..._... MODULE_LUA ..._... "-Wl,--end-group")</span></span></code> </pre> </div></div><br><h2 style=";text-align:right;direction:rtl">  ุชุญุฏูุฏ ูุธุงุฆู ููุนูู ูุน ุงูุฐุงูุฑุฉ </h2><br>  ูุธุฑูุง ูุฃู Lua ููุณูุง ูุง ุชุชุนุงูู ูุน ุงูุฐุงูุฑุฉ ุ ูุชู ููู ูุฐู ุงููุณุคูููุฉ ุฅูู ุงููุณุชุฎุฏู.  ููุน ุฐูู ุ ุนูุฏ ุงุณุชุฎุฏุงู ููุชุจุฉ <i>lauxlib</i> ุงููุฌูุนุฉ <i>ููุธููุฉ</i> <i>luaL_newstate</i> ูููุง ุ ุชููู ุฏุงูุฉ <i>l_alloc ูุฑุชุจุทุฉ</i> ููุธุงู ุฐุงูุฑุฉ.  ูุชู ุชุนุฑูููุง ุนูู ุงููุญู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l_alloc</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *ud, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *ptr, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> osize, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> nsize)</span></span></span><span class="hljs-function"> </span></span>{ (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)ud; (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)osize; <span class="hljs-comment"><span class="hljs-comment">/* not used */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nsize == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">free</span></span>(ptr); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">realloc</span></span>(ptr, nsize); }</code> </pre> <br>  ููุง ูู ูุฐููุฑ ูู ุจุฏุงูุฉ ุงูููุงู ุ ูุฅู ุงููุดุฑูุน ูุฏ ุชุฌุงูุฒ ุจุงููุนู ูุธุงุฆู <i>malloc</i> ูุงููุธุงุฆู <i>ุงููุฌุงููุฉ</i> ุ ููู ูุง ุชูุฌุฏ ูุธููุฉ ุฅุนุงุฏุฉ <i>ุชุฎุตูุต</i> .  ูุญู ุจุญุงุฌุฉ ุฅูู ุฅุตูุงุญู. <br><br>  ูู ุงูุขููุฉ ุงูููุงุณูุฉ ููุนูู ูุน ูููุฉ FreeRTOS ุ ูุง ูุญุชูู ููู heap_4.c ุงููุณุชุฎุฏู ูู ุงููุดุฑูุน ุนูู ูุธููุฉ ูุชุบููุฑ ุญุฌู ูุชูุฉ ุฐุงูุฑุฉ ูุฎุตุตุฉ ูุณุจููุง.  ูู ูุฐุง ุงูุตุฏุฏ ุ ูู ุงูุถุฑูุฑู ุฌุนู ุชูููุฐู ุนูู ุฃุณุงุณ <i>malloc</i> <i>ููุฌุงูู</i> . <br><br>  ูุธุฑูุง ูุฃูู ูู ุงููููู ูู ุงููุณุชูุจู ุชุบููุฑ ูุธุงู ุชุฎุตูุต ุงูุฐุงูุฑุฉ (ุจุงุณุชุฎุฏุงู ููู heap_x.c ุขุฎุฑ) ุ ููุฏ ุชูุฑุฑ ุนุฏู ุงุณุชุฎุฏุงู ุงูุชุตูููุงุช ุงูุฏุงุฎููุฉ ูููุฎุทุท ุงูุญุงูู (heap_4.c) ุ ูููู ูุฅูุดุงุก ูุธููุฉ ุฅุถุงููุฉ ุฐุงุช ูุณุชูู ุฃุนูู.  ุนูู ุงูุฑุบู ูู ุฃู ุฃูู ูุนุงููุฉ. <br><br>  ูู ุงูููู ุฃู ููุงุญุธ ุฃู ุทุฑููุฉ ุฅุนุงุฏุฉ <i>ุงูุชุฎุตูุต</i> ูุง ุชุญุฐู ุงููุชูุฉ ุงููุฏููุฉ ููุท (ุฅุฐุง ูุงูุช ููุฌูุฏุฉ) ูุชููู ุจุฅูุดุงุก ูุชูุฉ ุฌุฏูุฏุฉ ุ ูููู ุฃูุถูุง ุชููู ุงูุจูุงูุงุช ูู ุงููุชูุฉ ุงููุฏููุฉ ุฅูู ุงูุฌุฏูุฏุฉ.  ุนูุงูุฉ ุนูู ุฐูู ุ ุฅุฐุง ูุงูุช ุงููุชูุฉ ุงููุฏููุฉ ุชุญุชูู ุนูู ุจูุงูุงุช ุฃูุซุฑ ูู ุงูุฌุฏูุฏุฉ ุ ูุณูุชู ุชุนุจุฆุฉ ุงููุชูุฉ ุงูุฌุฏูุฏุฉ ุจุงูุจูุงูุงุช ุงููุฏููุฉ ุฅูู ุงูุญุฏ ุงูุฃูุตู ุ ููุชู ุชุฌุงูู ุงูุจูุงูุงุช ุงููุชุจููุฉ. <br><br>  ุฅุฐุง ูู ุชุคุฎุฐ ูุฐู ุงูุญูููุฉ ูู ุงูุงุนุชุจุงุฑ ุ ูุณูุชููู ุฌูุงุฒู ูู ุชูููุฐ ูุซู ูุฐุง ุงูุจุฑูุงูุฌ ุงููุตู ุซูุงุซ ูุฑุงุช ูู ุงูุณุทุฑ " <i>a = 3 \ n</i> " ุ ูุจุนุฏ ุฐูู ููุน ูู ุฎุทุฃ ูุจูุฑ.  ูููู ุญู ุงููุดููุฉ ุจุนุฏ ุฏุฑุงุณุฉ ุงูุตูุฑุฉ ุงููุชุจููุฉ ููุณุฌูุงุช ูู ูุนุงูุฌ ุงูุฃุฎุทุงุก ุงูุซุงุจุชุฉ ุ ูุงูุชู ุณูููู ูู ุงููููู ุจูุง ูุนุฑูุฉ ุฃู ุงูุญุงุฏุซ ูุฏ ููุน ุจุนุฏ ูุญุงููุฉ ุชูุณูุน ุงูุฌุฏูู ูู ุฃุญุดุงุก ุฑูุฒ ุงููุชุฑุฌู ุงูุดููู ูููุชุจุงุชู.  ุฅุฐุง ุงุชุตูุช ุจุจุฑูุงูุฌ ูุตู ูุซู " <i>print" test "</i> " ุ ูุณูู ูุชุบูุฑ ุงูุณููู ุจูุงุกู ุนูู ููููุฉ ุชุฌููุน ููู ุงูุจุฑูุงูุฌ ุงูุซุงุจุช (ุจูุนูู ุขุฎุฑ ุ ุงูุณููู ุบูุฑ ูุนุฑู). <br><br>  ูู ุฃุฌู ูุณุฎ ุงูุจูุงูุงุช ูู ุงููุชูุฉ ุงููุฏููุฉ ุฅูู ุงูุฌุฏูุฏุฉ ุ ูุญุชุงุฌ ุฅูู ูุนุฑูุฉ ุญุฌู ุงููุชูุฉ ุงููุฏููุฉ.  FreeRTOS heap_4.c (ูุซู ุงููููุงุช ุงูุฃุฎุฑู ุงูุชู ุชููุฑ ุฃุณุงููุจ ูุนุงูุฌุฉ ูููุฉ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ) ูุง ูููุฑ API ููุฐุง.  ูุฐูู ุ ุนููู ุงูุงูุชูุงุก ูู ูู.  ูุฃุณุงุณ ุ ุฃุฎุฐุช ูุธููุฉ <i>vPortFree</i> ููุทุนุช ูุธุงุฆููุง ุฅูู ุงููููุฐุฌ ุงูุชุงูู: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">VPortGetSizeBlock ุฑูุฒ ุงููุธููุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vPortGetSizeBlock</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *pv)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> *puc = (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> *)pv; BlockLink_t *pxLink; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pv != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { puc -= xHeapStructSize; pxLink = (BlockLink_t *)puc; configASSERT((pxLink-&gt;xBlockSize &amp; xBlockAllocatedBit) != <span class="hljs-number"><span class="hljs-number">0</span></span>); configASSERT(pxLink-&gt;pxNextFreeBlock == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> pxLink-&gt;xBlockSize &amp; ~xBlockAllocatedBit; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> </div></div><br>  ุงูุขู ุฃุตุจุญ ุตุบูุฑูุง ุ ุงูุชุจ <i>realloc</i> ุงุณุชูุงุฏูุง ุฅูู <i>malloc</i> ุ <i>ูุฌุงููุง</i> ุ ู <i>vPortGetSizeBlock</i> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Realloc ุฑูุฒ ุงูุชูููุฐ ุนูู ุฃุณุงุณ malloc ุ ูุฌุงูู ุ ู vPortGetSizeBlock</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">realloc</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *ptr, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> new_size)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ptr == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">malloc</span></span>(new_size); } <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* p = <span class="hljs-built_in"><span class="hljs-built_in">malloc</span></span>(new_size); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (p == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> p; } <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> old_size = vPortGetSizeBlock(ptr); <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> cpy_len = (new_size &lt; old_size)?new_size:old_size; <span class="hljs-built_in"><span class="hljs-built_in">memcpy</span></span>(p, ptr, cpy_len); <span class="hljs-built_in"><span class="hljs-built_in">free</span></span>(ptr); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> p; }</code> </pre> </div></div><br><h2 style=";text-align:right;direction:rtl">  ุฅุถุงูุฉ ุฏุนู ููุนูู ูุน stdout </h2><br>  ููุง ุฃุตุจุญ ูุนุฑูููุง ูู ุงููุตู ุงูุฑุณูู ุ ูุฅู ูุชุฑุฌู lua ููุณู ุบูุฑ ูุงุฏุฑ ุนูู ุงูุนูู ูุน I / O.  ููุฐู ุงูุฃุบุฑุงุถ ุ ูุชู ุชูุตูู ุฅุญุฏู ุงูููุชุจุงุช ุงูููุงุณูุฉ.  ููุฅุฎุฑุงุฌ ุ ูุฅูู ูุณุชุฎุฏู ุฏูู <i>stdout</i> .  ูุธููุฉ <i>luaopen_io</i> ูู ุงูููุชุจุฉ ุงูููุงุณูุฉ ูุณุคููุฉ ุนู ุงูุงุชุตุงู <i>ุจุงูุฏูู</i> .  ูุฏุนู ุงูุนูู ูุน <i>stdout</i> (ุนูู ุนูุณ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">printf</a> ) ุ ุณุชุญุชุงุฌ ุฅูู ุชุฌุงูุฒ ูุธููุฉ <i>fwrite</i> .  ุฃุนุฏุช ุชุนุฑููู ุจูุงุกู ุนูู ุงููุธุงุฆู ุงูููุถุญุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงูุฉ ุงูุณุงุจูุฉ</a> . <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุธููุฉ ุงููุชุงุจุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> fwrite(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> *buf, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> size, <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> count, FILE *stream) { stream = stream; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> len = size * count; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *s = <span class="hljs-keyword"><span class="hljs-keyword">reinterpret_cast</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>*&gt;(buf); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; len; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_write_char((s[i])) != <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> len; }</code> </pre> </div></div><br>  ุจุฏูู ุชุนุฑูููุง ุ ุณูุชู ุชูููุฐ ูุธููุฉ <i>ุงูุทุจุงุนุฉ</i> ูู lua ุจูุฌุงุญ ุ ูููู ูู ูููู ููุงู ุฅุฎุฑุงุฌ.  ุนูุงูุฉ ุนูู ุฐูู ุ ูู ูููู ููุงู ุฃู ุฃุฎุทุงุก ูู ููุฏุณ Lua ุงูุฎุงุต ุจุงูุฌูุงุฒ (ุญูุซ ุชู ุชูููุฐ ุงููุธููุฉ ุฑุณูููุง ุจูุฌุงุญ). <br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ูุฐู ุงููุธููุฉ ุ ุณูุญุชุงุฌ ุฅูู ูุธููุฉ <i>fflush</i> (ุญุชู ูุนูู ุงููุถุน ุงูุชูุงุนูู ุ ูุงูุฐู ุณูุชู <i>ููุงูุดุชู</i> ูุงุญููุง).  ูุธุฑูุง ูุฃูู ูุง ูููู ุชุฌุงูุฒ ูุฐู ุงููุธููุฉ ุ ูุณูุชุนูู ุนููู ุชุณููุชูุง ุจุดูู ูุฎุชูู ููููุงู.  ุงููุธููุฉ ุนุจุงุฑุฉ ุนู ูุณุฎุฉ ูุฌุฑุฏุฉ ูู ูุธููุฉ <i>fwrite</i> ูุชูุฏู ุฅูู ุฅุฑุณุงู ูุง ูู ููุฌูุฏ ุงูุขู ูู ุงููุฎุฒู ุงููุคูุช ูุน ุงูุชูุธูู ุงููุงุญู (ุจุฏูู ููู ุฅุถุงูู ููุนุฑุจุฉ). <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุธููุฉ Mc_fflush</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mc_fflush</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> len = buf_p; buf_p = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (uart_1.tx(tx_buf, len, <span class="hljs-number"><span class="hljs-number">100</span></span>) != mc_interfaces::res::ok) { errno = EIO; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br></div></div><br><h2 style=";text-align:right;direction:rtl">  ุงุณุชุฑุฏุงุฏ ุณูุงุณู ูู ูููุฐ ุชุณูุณูู </h2><br>  ููุญุตูู ุนูู ุณูุงุณู ูุขูุฉ lua ุ ูุฑุฑุช ูุชุงุจุฉ ูุฆุฉ ุจุณูุทุฉ ูู ูุญุทุงุช uart ุ ููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชููู ุงูุจูุงูุงุช ุนูู ุจุงูุช ุงููููุฐ ุงูุชุณูุณูู ุจุงูุช (ูู ุงูููุงุทุนุฉ) ุ </li><li style=";text-align:right;direction:rtl">  ูุถูู ุงูุจุงูุช ุงููุณุชููุฉ ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุ ุญูุซ ูุณุชูุจููุง ุงูุฏูู ุ </li><li style=";text-align:right;direction:rtl">  ูู ุฏูู ูู ุงูุจุงูุชุงุช ุ ุฅุฐุง ูู ููู ูุฐุง ุนุจุงุฑุฉ ุนู ุชุบุฐูุฉ ุณุทุฑ ุ ูุชู ุฅุฑุณุงููุง ูุฑุฉ ุฃุฎุฑู ุจุงูุดูู ุงูุฐู ูุตูุช ุฅููู ุ </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุตูุช ุชุบุฐูุฉ ุงูุณุทุฑ (' <i>\ r</i> ') ุ ูุณูุชู ุฅุฑุณุงู ูุญุฏุชู ุจุงูุช ูู ุฅุฑุฌุงุน ุงูููู ุงูุทุฑูู (" <i>\ n \ r</i> ") ุ </li><li style=";text-align:right;direction:rtl">  ุจุนุฏ ุฅุฑุณุงู ุงูุงุณุชุฌุงุจุฉ ุ ูุชู ุงุณุชุฏุนุงุก ูุนุงูุฌ ุงูุจุงูุช ุงูุฐู ูุตู (ูุงุฆู ุชุฎุทูุท ุงูุณุทุฑ) ุ </li><li style=";text-align:right;direction:rtl">  ูุชุญูู ูู ุงูุถุบุท ุนูู ููุชุงุญ ุญุฐู ุงูุฃุญุฑู (ูุชุฌูุจ ุญุฐู ุฃุญุฑู ุงูุฎุฏูุฉ ูู ูุงูุฐุฉ ุงููุญุทุฉ ุงูุทุฑููุฉ) ุ </li></ul><br>  ุฑูุงุจุท ุฅูู ุงููุตุงุฏุฑ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุงุฌูุฉ ูุฆุฉ UART <a href="">ููุง</a> ุ </li><li style=";text-align:right;direction:rtl">  ุงูุทุจูุฉ ุงูุฃุณุงุณูุฉ UART <a href="">ููุง</a> <a href="">ูููุง</a> ุ </li><li style=";text-align:right;direction:rtl">  ูุฆุฉ uart_terminal <a href="">ููุง</a> <a href="">ูููุง</a> ุ </li><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูุงุฆู ูุฆุฉ ูุฌุฒุก ูู ุงููุดุฑูุน <a href="">ููุง</a> . </li></ul><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุงุญุธุช ุฃูู ููู ูุนูู ูุฐุง ุงููุงุฆู ุจุดูู ุตุญูุญ ุ ุชุญุชุงุฌ ุฅูู ุชุนููู ุฃููููุฉ ุฅูู ููุงุทุนุฉ UART ูู ุงููุทุงู ุงููุณููุญ ุจู ููุนูู ูุน ูุธุงุฆู FreeRTOS ูู ุงูููุงุทุนุฉ.  ุฎูุงู ุฐูู ุ ููููู ุงูุญุตูู ุนูู ุฃุฎุทุงุก ุตุนุจุฉ ูุตุนุจ ุชุตุญูุญูุง.  ูู ุงููุซุงู ุงูุญุงูู ุ ูุชู ุชุนููู ุงูุฎูุงุฑุงุช ุงูุชุงููุฉ ููููุงุทุนุงุช ูู ููู <a href="">FreeRTOSConfig.h</a> . <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุฅุนุฏุงุฏุงุช ูู FreeRTOSConfig.h</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> configPRIO_BITS 4 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> configKERNEL_INTERRUPT_PRIORITY 0XF0 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//   FreeRTOS API   //   0x8 - 0xF. #define configMAX_SYSCALL_INTERRUPT_PRIORITY 0x80</span></span></span></span></code> </pre> </div></div><br>  ูู ุงููุดุฑูุน ููุณู ุ ูุนูู ูุงุฆู ุงููุฆุฉ <i>nvic</i> ุฃููููุฉ ุงูููุงุทุนุฉ 0x9 ุ ูุงูุชู ูุชู ุชุถููููุง ูู ุงููุทุงู ุงูุตุญูุญ (ูุชู ูุตู ุงููุฆุฉ nvic <a href="">ููุง</a> <a href="">ูููุง</a> ). <br><br><h2 style=";text-align:right;direction:rtl">  ุชุดููู ุณูุณูุฉ ูุขูุฉ ููุง </h2><br>  ูุชู ููู ูุญุฏุงุช ุงูุจุงูุช ุงููุชููุงุฉ ูู ูุงุฆู uart_terminal ุฅูู ูุซูู ููุฆุฉ ุจุณูุทุฉ serial_cli ุ ูุงูุชู ุชููุฑ ุงูุญุฏ ุงูุฃุฏูู ูู ุงููุงุฌูุฉ ูุชุญุฑูุฑ ุงูุณูุณูุฉ ูููููุง ูุจุงุดุฑุฉ ุฅูู ุณูุณูุฉ ุงูุนูููุงุช ุงูุชู ูุชู ูููุง ุชูููุฐ lua-machine (ุนู ุทุฑูู ุงุณุชุฏุนุงุก ูุธููุฉ ุฑุฏ ุงูุงุชุตุงู).  ุนูุฏ ูุจูู ุงูุญุฑู '\ r' ุ ูุชู ุงุณุชุฏุนุงุก ูุธููุฉ ุฑุฏ ุงูุงุชุตุงู.  ูุฌุจ ุฃู ุชููู ูุฐู ุงููุธููุฉ ุจูุณุฎ ุงูุฎุท ุฅูู ููุณูุง ู "ุชุญุฑูุฑ" ุนูุตุฑ ุงูุชุญูู (ุญูุซ ูุชู ุญุธุฑ ุงุณุชูุจุงู ูุญุฏุงุช ุงูุจุงูุช ุงูุฌุฏูุฏุฉ ุฃุซูุงุก ุงูููุงููุฉ. ูุฐู ููุณุช ูุดููุฉ ูู ุงูุชุฏููุงุช ุฐุงุช ุงูุฃููููุฉ ุจุดูู ุตุญูุญ ูุณุฑุนุฉ UART ุงูููุฎูุถุฉ ุจุดูู ูุงูู). <br><br>  ุฑูุงุจุท ุฅูู ุงููุตุงุฏุฑ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูููุงุช ูุตู serial_cli <a href="">ููุง</a> <a href="">ูููุง</a> ุ </li><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูุงุฆู ูุฆุฉ ูุฌุฒุก ูู ุงููุดุฑูุน <a href="">ููุง</a> . </li></ul><br>  ูู ุงูููู ููุงุญุธุฉ ุฃู ูุฐู ุงููุฆุฉ ุชุนุชุจุฑ ุณูุณูุฉ ุฃุทูู ูู 255 ุญุฑููุง ุบูุฑ ุตุงูุญุฉ ูุชุชุฌุงูููุง.  ูุฐุง ููุตูุฏ ูุฃู ุงููุชุฑุฌู lua ูุณูุญ ูู ุจุฅุฏุฎุงู ุจููุงุช ุณุทุฑุงู ุชูู ุงูุขุฎุฑ ุ ูู ุงูุชุธุงุฑ ููุงูุฉ ุงููุชูุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุชูุฑูุฑ ุณูุณูุฉ ุฅูู ูุชุฑุฌู Lua ูุชูููุฐู </h2><br>  ูุง ูุนุฑู ูุชุฑุฌู Lua ููุณู ููููุฉ ูุจูู ุฑูุฒ ุงูููุฏ ุจุณุทุฑ ุ ุซู ุชูููุฐ ุงููุชูุฉ ุจุงููุงูู ูู ุชููุงุก ููุณูุง.  ููุน ุฐูู ุ ุฅุฐุง ููุช ุจุชุซุจูุช Lua ุนูู ุฌูุงุฒ ููุจููุชุฑ ูููุช ุจุชุดุบูู ุงููุชุฑุฌู ุงูููุฑู ูู ุงููุถุน ุงูุชูุงุนูู ุ ููููููุง ุฃู ูุฑู ุฃู ุงูุชูููุฐ ูุชู ุชูููุฐู ุณุทุฑุงู ูุน ุงูุชุฑููุฒ ุงูููุงุจู ุฃุซูุงุก ุงููุชุงุจุฉ ุ ูุฃู ุงูุญุธุฑ ูู ููุชูู ุจุนุฏ.  ูุธุฑูุง ูุฃู ุงููุถุน ุงูุชูุงุนูู ูู ูุง ูุชู ุชูููุฑู ูู ุงูุญุฒูุฉ ุงูููุงุณูุฉ ุ ูููููุง ุฃู ูุฑู ุงูููุฏ ุงูุฎุงุต ุจู.  ููู ููุฌูุฏ ูู ููู <a href="">lua.c.</a>  ูุญู ููุชููู ุจูุธููุฉ <i>doREPL</i> ููู ูุง ูุณุชุฎุฏูู.  ูู ุฃุฌู ุนุฏู ุงูุฎุฑูุฌ ุจุงูุฏุฑุงุฌุฉ ุ ููุญุตูู ุนูู ูุธุงุฆู ุงููุถุน ุงูุชูุงุนูู ูู ุงููุดุฑูุน ุ ููุช ุจุฅูุดุงุก ูููุฐ ูู ูุฐุง ุงูุฑูุฒ ูู ูุตู ูููุตู ุ ููุช ุจุชุณููุฉ <i>lua_repl</i> ุจู ุจุงุณู ุงููุธููุฉ ุงูุฃุตููุฉ ุ ูุงูุชู ุชุณุชุฎุฏู printf ูุทุจุงุนุฉ ุงููุนูููุงุช ุฅูู ูุญุฏุฉ ุงูุชุญูู ููุฏููุง ุทุฑููุฉ ุนุงูุฉ <i>add_lua_string</i> ูุฅุถุงูุฉ ุฎุท ุชู ุงุณุชูุงูู ูู ูุงุฆู ุงููุตู ุงูุฏุฑุงุณู serial_cli ุงููุฐููุฑุฉ ุฃุนูุงู. <br><br>  ุงููุฑุงุฌุน: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุตู ุงููุฆุฉ lua_repl <a href="">ููุง</a> ุ </li><li style=";text-align:right;direction:rtl">  ููุฏ <a href="">ููุง</a> ุ <a href="">ููุง</a> <a href="">ูููุง</a> ุ </li></ul><br>  ุชู ุชุตููู ุงููุตู ููููุง ูููุท singleton Myers ุ ุญูุซ ูุง ุชูุฌุฏ ุญุงุฌุฉ ูุฅุนุทุงุก ุนุฏุฉ ุฃูุถุงุน ุชูุงุนููุฉ ุฏุงุฎู ููุณ ุงูุฌูุงุฒ.  ูุณุชูุจู ูุงุฆู ุงููุฆุฉ lua_repl ุงูุจูุงูุงุช ูู ูุงุฆู ุงููุฆุฉ serial_cli <a href="">ููุง</a> . <br><br>  ูุธุฑูุง ูุฃู ุงููุดุฑูุน ูุญุชูู ุจุงููุนู ุนูู ูุธุงู ููุญุฏ ูุชููุฆุฉ ุงููุงุฆูุงุช ุงูุนุงูููุฉ ูุตูุงูุชูุง ุ ูุชู ุชูุฑูุฑ ุงููุคุดุฑ ุฅูู ูุงุฆู ุงููุฆุฉ lua_repl ุฅูู ูุงุฆู <a href="">ูุดุบู</a> ุงููุฆุฉ ุงูุนุงูููุฉ <a href="">:: base</a> <a href="">ููุง</a> .  ูู ุทุฑููุฉ <i>ุจุฏุก</i> ูุงุฆู ูู class <a href="">player :: base</a> (ุชู ุฅุนูุงููุง <a href="">ููุง</a> . ูุทูู ุนูููุง ุฃูุถูุง ูู main) ุ ูุชู ุงุณุชุฏุนุงุก ุทุฑููุฉ <i>init</i> ุงูุฎุงุตุฉ ุจุงููุงุฆู ูู ูุฆุฉ lua_repl ุจุฃููููุฉ ูููุฉ FreeRTOS 3 (ูู ุงููุดุฑูุน ุ ููููู ุชุนููู ุฃููููุฉ ุงููููุฉ ูู 1 ุฅูู 4. ุญูุซ 1 ูู ุฃุฏูู ุฃููููุฉ ุ ู 4 ูู ุงูุฃุนูู).  ุจุนุฏ ุงูุชููุฆุฉ ุงููุงุฌุญุฉ ุ ุชุจุฏุฃ ุงููุฆุฉ ุงูุนุงูููุฉ ูู ุฌุฏููุฉ FreeRTOS ููุจุฏุฃ ุงููุถุน ุงูุชูุงุนูู ุนููู. <br><br><h2 style=";text-align:right;direction:rtl">  ูุถุงูุง ุชุฑููุฉ </h2><br>  ูููุง ููู ูุงุฆูุฉ ุจุงููุดููุงุช ุงูุชู ูุงุฌูุชูุง ุฃุซูุงุก ูููุฐ Lua ุจุงูุฌูุงุฒ. <br><br><h4 style=";text-align:right;direction:rtl">  ูุชู ุชูููุฐ ุงูุจุฑุงูุฌ ุงููุตูุฉ 2-3 ุณุทุฑ ูุงุญุฏ ูู ูุชุบูุฑ ุงูุงุญุงูุฉ ุ ุซู ูู ุดูุก ููุน ูู ุฎุทุฃ ุงูุซุงุจุช </h4><br>  ูุงูุช ุงููุดููุฉ ูู ุทุฑููุฉ ุฅุนุงุฏุฉ ุงูุชุฎุตูุต.  ูุง ููุฒู ุฅุนุงุฏุฉ ุชุญุฏูุฏ ุงููุชูุฉ ูุญุณุจ ุ ูููู ุฃูุถูุง ูุณุฎ ูุญุชููุงุช ุงูุนูุตุฑ ุงููุฏูู (ููุง ูู ููุถุญ ุฃุนูุงู). <br><br><h4 style=";text-align:right;direction:rtl">  ุนูุฏ ูุญุงููุฉ ุทุจุงุนุฉ ูููุฉ ุ ููุน ุงููุชุฑุฌู ูู ุฎุทุฃ ูุงุฏุญ </h4><br>  ูุงู ูู ุงูุตุนุจ ุจุงููุนู ุงูุชุดุงู ุงููุดููุฉ ุ ููู ูู ุงูููุงูุฉ ุชูููุช ูู ูุนุฑูุฉ ุฃู snprintf ูุงู ูุณุชุฎุฏู ููุทุจุงุนุฉ.  ูุธุฑูุง ูุฃู lua ุชุฎุฒู ุงูููู ุจูุถุงุนูุฉ (ุฃู ุชุทูู ูู ุญุงูุชูุง) ุ ูุฅู printf (ููุดุชูุงุชู) ูุน ุฏุนู ุงูููุทุฉ ุงูุนุงุฆูุฉ ูุทููุจ (ูุชุจุช ุนู ุชุนููุฏุงุช printf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> ). <br><br><h2 style=";text-align:right;direction:rtl">  ูุชุทูุจุงุช ุงูุฐุงูุฑุฉ ุบูุฑ ุงููุชุทุงูุฑุฉ (ููุงุด) </h2><br>  ูููุง ููู ุจุนุถ ุงูููุงุณุงุช ุงูุชู ุฃุฌุฑูุชูุง ููุญูู ุนูู ููุฏุงุฑ ุงูุฐุงูุฑุฉ ุบูุฑ ุงููุชุทุงูุฑุฉ (ููุงุด) ุงูุชู ูุฌุจ ุชุฎุตูุตูุง ูุฏูุฌ ุฌูุงุฒ Lua ูู ุงููุดุฑูุน.  ุชู ุฅุฌุฑุงุก ุงูุชุฌููุน ุจุงุณุชุฎุฏุงู gcc-arm-none-eabi-8-2018-q4-major.  ุชู ุงุณุชุฎุฏุงู ูุณุฎุฉ ููุง 5.4.  ุฃุฏูุงู ูู ุงูููุงุณุงุช ุ ุชุนูู ุนุจุงุฑุฉ "ุจุฏูู ููุง" ุนุฏู ุฅุฏุฑุงุฌ ุงููุชุฑุฌู ุงูุดููู ูุทุฑู ุงูุชูุงุนู ูุนู ููุน ููุชุจุงุชู ุ ูุถูุงู ุนู ูุงุฆู ูู ูุฆุฉ lua_repl ูู ุงููุดุฑูุน.  ุชุจูู ุฌููุน ุงูููุงูุงุช ุฐุงุช ุงููุณุชูู ุงูููุฎูุถ (ุจูุง ูู ุฐูู <i>ุงูุชุฎุทูุงุช</i> ููุธุงุฆู <i>printf</i> ู <i>fwrite</i> ) ูู ุงููุดุฑูุน.  ุญุฌู ูููุฉ FreeRTOS ูู 1024 * 25 ุจุงูุช.  ูุดุบู ุงูุจุงูู ููุงูุงุช ูุดุงุฑูุน ุนุงูููุฉ. <br><br>  ุฌุฏูู ููุฎุต ุงููุชุงุฆุฌ ููุง ููู (ุฌููุน ุงูุฃุญุฌุงู ุจุงูุจุงูุช): <br><table border="1" style=";text-align:right;direction:rtl"><tbody><tr><th>  ุจูุงุก ุงูุฎูุงุฑุงุช </th><th>  ุจุฏูู ููุง </th><th>  ุงูุฃุณุงุณูุฉ ููุท </th><th>  ููุง ูุน ููุชุจุฉ ูุงุนุฏุฉ </th><th>  ููุง ูุน ูุงุนุฏุฉ ุงูููุชุจุงุช ุ coroutine ุ ุงูุฌุฏูู ุ ุณูุณูุฉ </th><th>  luaL_openlibs </th></tr><tr><td>  -O0 -g3 </td><td>  103028 </td><td>  220924 </td><td>  236124 </td><td>  262652 </td><td>  308372 </td></tr><tr><td>  -O1 -g3 </td><td>  74940 </td><td>  144732 </td><td>  156916 </td><td>  174452 </td><td>  213068 </td></tr><tr><td>  -Os -g0 </td><td>  71172 </td><td>  134228 </td><td>  145756 </td><td>  161428 </td><td>  198400 </td></tr></tbody></table><br><h2 style=";text-align:right;direction:rtl">  ูุชุทูุจุงุช ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู </h2><br>  ูุธุฑูุง ูุฃู ุงุณุชููุงู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ูุนุชูุฏ ุชูุงููุง ุนูู ุงููููุฉ ุ ุณุฃูุฏู ุฌุฏูููุง ููุฌุฒูุง โโููุฐุงูุฑุฉ ุงููุณุชูููุฉ ููุฑ ุชุดุบูู ุงูุฌูุงุฒ ุจูุฌููุนุฉ ูุฎุชููุฉ ูู ุงูููุชุจุงุช (ูุชู ุนุฑุถู ุจูุงุณุทุฉ ุฃูุฑ <i>ุงูุทุจุงุนุฉ (collectgarbage ("count") * 1024</i> ). <br><table border="1" style=";text-align:right;direction:rtl"><tbody><tr><td>  ูููู </td><td>  ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุงููุณุชุฎุฏูุฉ </td></tr><tr><td>  ููุง ูุน ููุชุจุฉ ูุงุนุฏุฉ </td><td>  4809 </td></tr><tr><td>  ููุง ูุน ูุงุนุฏุฉ ุงูููุชุจุงุช ุ coroutine ุ ุงูุฌุฏูู ุ ุณูุณูุฉ </td><td>  6407 </td></tr><tr><td>  luaL_openlibs </td><td>  12769 </td></tr></tbody></table><br>  ูู ุญุงูุฉ ุงุณุชุฎุฏุงู ุฌููุน ุงูููุชุจุงุช ุ ูุชู ุฒูุงุฏุฉ ุญุฌู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุงููุทููุจุฉ ุจุดูู ูุจูุฑ ููุงุฑูุฉ ุจุงููุฌููุนุงุช ุงูุณุงุจูุฉ.  ููุน ุฐูู ุ ุงุณุชุฎุฏุงูู ูู ุฌุฒุก ูุจูุฑ ูู ุงูุชุทุจููุงุช ููุณุช ุถุฑูุฑูุฉ. <br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุชู ุชุฎุตูุต 4 ููููุจุงูุช ุฃูุถูุง ูููุฏุณ ุงูููุงู ุ ุญูุซ ูุชู ุชูููุฐ Lua-machine. <br><br><h2 style=";text-align:right;direction:rtl">  ูุฒูุฏ ูู ุงูุงุณุชุฎุฏุงู </h2><br>  ูู ุฃุฌู ุงูุงุณุชุฎุฏุงู ุงููุงูู ููุฌูุงุฒ ูู ุงููุดุฑูุน ุ ุณุชุญุชุงุฌ ุฅูู ูุฒูุฏ ูู ูุตู ุฌููุน ุงููุงุฌูุงุช ุงููุทููุจุฉ ูู ูุจู ุฑูุฒ ููุทู ุงูุนูู ููุฃุฌูุฒุฉ ุฃู ูุงุฆูุงุช ุงูุฎุฏูุฉ ูู ุงููุดุฑูุน.  ููุน ุฐูู ุ ูุฐุง ูู ููุถูุน ููุงูุฉ ูููุตูุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุงููุชุงุฆุฌ </h2><br>  ูุตู ูุฐุง ุงูููุงู ููููุฉ ุชูุตูู ุฌูุงุฒ Lua ุจูุดุฑูุน ูุชุญูู ุฏููู ุ ููุฐูู ุชุดุบูู ูุชุฑุฌู ุชูุงุนูู ูุชูุงูู ูุณูุญ ูู ุจุชุฌุฑุจุฉ ููุทู ุงูุนูู ูุจุงุดุฑุฉู ูู ุณุทุฑ ุงูุฃูุงูุฑ ุงูุฎุงุต ุจุงููุญุทุฉ ุงูุทุฑููุฉ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชู ุงููุธุฑ ูู ูุชุทูุจุงุช ุงูุฃุฌูุฒุฉ ูู ูุชุญูู ูุชููููุงุช ูุฎุชููุฉ ูู ุขูุฉ ููุง. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar459602/">https://habr.com/ru/post/ar459602/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar459590/index.html">ุงูุชุงุจุนุฉ ูุจุฑูุงูุฌ ููุชูุญ ุงููุตุฏุฑ ุงููุงูุฑูุฒูุฉ ุนูู blockchain ุงูุฃููุงุฌ</a></li>
<li><a href="../ar459592/index.html">ุซูุงุซ ูุตุงุฆุญ ูุฅุฏุงุฑุฉ ุงูููุช ูุฃููุฆู ุงูุฐูู ุฌุฑุจูุง ูู ุดูุก.</a></li>
<li><a href="../ar459594/index.html">ูุฑุงุกุฉ ุจูู ุงูููุงุญุธุงุช: ูุธุงู ููู ุงูุจูุงูุงุช ุฏุงุฎู ุงูููุณููู</a></li>
<li><a href="../ar459596/index.html">iOS Digest No. 9 (28 ููููู - 11 ููููู)</a></li>
<li><a href="../ar459598/index.html">ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ ุญูู SELinux (FAQ)</a></li>
<li><a href="../ar459604/index.html">ุจุฑููุฉ - ุจูุช | ุงููุงุฆูุฉ ุงููุงููุฉ</a></li>
<li><a href="../ar459606/index.html">ุงูุดุจูุงุช ุงูุงุฌุชูุงุนูุฉ ุงูููุฒุนุฉ</a></li>
<li><a href="../ar459610/index.html">ูุฐู ุงูููุฌูุงุช ุงูุฎุทุฑุฉ: ุงููุฑุตูุฉ ุงูุฃูุซุฑ ุงูุชุดุงุฑูุง ููุนุฏุงุช ุงูุดุจูุฉ ุงูุญุฏูุซุฉ ูุฃุณุงููุจ ุงูุญูุงูุฉ</a></li>
<li><a href="../ar459612/index.html">ููู ุงููุตู ููุงูููู ุนู ุตูุงุนุฉ ุงููุญููู ููุฏุฉ 20 ุนุงููุง ุนูู ุงูุชูุงูู</a></li>
<li><a href="../ar459614/index.html">ุจุทุฉ ุงูุฑูุจูุช ุชุซูุฑ ุญููู ุงูุฃุฑุฒ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>