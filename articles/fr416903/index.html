<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÖ üçÄ ‚òéÔ∏è Contribuez √† Go avec l'analyseur-critique ü§ß üçÄ üêõ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vous vous souvenez peut-√™tre de l' annonce r√©cente d'un nouvel analyseur statique pour Go appel√© Go -Critic . 


 J'ai v√©rifi√© le projet golang / go a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Contribuez √† Go avec l'analyseur-critique</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/416903/"><p><img src="https://habrastorage.org/webt/fp/k0/rn/fpk0rncwtlo5ozovjev4yi_gok8.png"></p><br><p>  Vous vous souvenez peut-√™tre de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">annonce</a> r√©cente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d'un nouvel analyseur statique pour Go</a> appel√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Go</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">-Critic</a> . </p><br><p>  J'ai v√©rifi√© le projet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">golang / go</a> avec lui et envoy√© des correctifs qui corrigent certains probl√®mes trouv√©s l√†-bas. </p><br><p>  Dans cet article, nous analyserons le code corrig√© et nous serons √©galement motiv√©s √† envoyer encore plus de telles modifications √† Go. </p><br><p>  Pour les plus impatients: une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">liste actualis√©e des troph√©es</a> . </p><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Aller analyser la liste</b> <div class="spoiler_text"><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">net: combiner les appels d'ajout dans reverseaddr</a> <code>appendCombine</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cmd / link / internal / ld: √©viter les copies de relocalisation dans les boucles de plage</a> <code>rangeValCopy</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cmd / compile / internal / ssa: correction de la m√©thode</a> <code>dupSubExpr</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">runtime: supprimer le deref explicite redondant dans trace.go</a> <code>underef</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cmd / link / internal / sym: d√©commenter le code pour les cas ELF dans RelocName</a> <code>commentedOutCode</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">runtime: simplifier l'expression de tranche pour que la valeur en tranches se</a> <code>unslice</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">html / template: utilisez des consts nomm√©s au lieu de leurs valeurs</a> <code>namedConst</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cmd / internal / obj / arm64: simplifier certaines expressions bool</a> <code>boolExprSimplify</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">math, net: omettre la vraie balise explicite expr dans le commutateur</a> <code>switchTrue</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">archive / tar: remore les parens redondants dans les expressions de type</a> <code>typeUnparen</code> </li></ol></div></div><br><h1 id="dupsubexpr">  dupSubExpr </h1><br><p>  Nous faisons tous des erreurs et, bien souvent, par inattention.  Go, √©tant une langue dans laquelle vous devez parfois √©crire du code ennuyeux et passe-partout, contribue parfois aux erreurs de frappe et / ou de copier / coller. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CL122776</a> contient un correctif pour un bogue trouv√© par <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dupSubExpr</a> : </p><br><pre> <code class="diff hljs">func (a partsByVarOffset) Less(i, j int) bool { - return varOffset(a.slots[a.slotIDs[i]]) &lt; varOffset(a.slots[a.slotIDs[i]]) + return varOffset(a.slots[a.slotIDs[i]]) &lt; varOffset(a.slots[a.slotIDs[j]]) // ^__________________________________^ }</code> </pre> <br><p>  Faites attention √† l'index √† gauche et √† droite.  Avant la correction, les LHS et RHS de l'op√©rateur <code>&lt;</code> √©taient identiques, et <code>dupSubExpr</code> travaill√© pour <code>dupSubExpr</code> . </p><br><h1 id="commentedoutcode">  commentedOutCode </h1><br><p>  Si votre projet est parrain√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">par un syst√®me de contr√¥le de version</a> , au lieu de d√©sactiver le code en l'enveloppant dans un commentaire, il vaut la peine de le supprimer compl√®tement.  Il existe des exceptions, mais le plus souvent, un tel code "mort" interf√®re, confond et peut masquer des erreurs. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">commentedOutCode a</a> pu trouver un tel fragment int√©ressant ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CL122896</a> ): </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> arch.Family { <span class="hljs-comment"><span class="hljs-comment">// ...  case clause. case sys.I386: return elf.R_386(nr).String() case sys.MIPS, sys.MIPS64: // return elf.R_MIPS(nr).String() // &lt;- 1 case sys.PPC64: // return elf.R_PPC64(nr).String() // &lt;- 2 case sys.S390X: // return elf.R_390(nr).String() // &lt;- 3 default: panic("unreachable") }</span></span></code> </pre> <br><p>  Il y a un commentaire un peu plus haut: </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// We didn't have some relocation types at Go1.4. // Uncomment code when we include those in bootstrap code.</span></span></code> </pre> <br><p>  Si vous basculez vers la branche <code>go1.4</code> et supprimez ces 3 lignes du commentaire, le code ne sera pas compil√©, mais si vous les d√©commentez sur l'assistant, tout fonctionnera. </p><br><p>  En r√®gle g√©n√©rale, le code cach√© dans un commentaire n√©cessite la suppression ou l'activation inverse. </p><br><p>  Il est utile, de temps en temps, de visiter ces √©chos du pass√© dans votre code. </p><br><div class="spoiler">  <b class="spoiler_title">A propos des difficult√©s de d√©tection</b> <div class="spoiler_text"><p>  C'est l'un de mes ch√®ques pr√©f√©r√©s, mais c'est l'un des plus "bruyants". </p><br><p>  Beaucoup de faux positifs pour les paquets qui utilisent <code>math/big</code> et √† l'int√©rieur du compilateur.  Dans le premier cas, il s'agit g√©n√©ralement de commentaires explicatifs sur les op√©rations effectu√©es, et dans le second, d'une description du code qui d√©crit le fragment AST.  Distinguer de tels commentaires d'un vrai code ¬´mort¬ª sans introduire de faux n√©gatifs n'est pas anodin. </p><br><p>  Cela donne naissance √† l'id√©e: que se passe-t-il si nous acceptons de sp√©cialiser le code dans les commentaires, ce qui est explicatif?  Ensuite, l'analyse statique sera simplifi√©e.  Il peut s'agir de n'importe quelle bagatelle qui facilitera la d√©finition d'un tel commentaire explicatif ou rendra le code Go non valide (par exemple, si vous ajoutez un signe di√®se, <code>#</code> au d√©but de la ligne). </p><br><p>  Une autre cat√©gorie comprend les commentaires avec des <code>TODO</code> explicites.  Si le code est supprim√© pour commentaire, mais qu'il y a une description claire de la raison pour laquelle cela est fait et quand il est pr√©vu de corriger ce morceau de code, il est pr√©f√©rable de ne pas donner d'avertissement.  Cela a d√©j√† √©t√© mis en ≈ìuvre, mais pourrait fonctionner de mani√®re plus fiable. </p></div></div><br><h1 id="boolexprsimplify">  boolExprSimplify </h1><br><p>  Parfois, les gens √©crivent du code bizarre.  Cela me semble peut-√™tre, mais <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">les</a> expressions logiques ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bool√©ennes</a> ) semblent parfois particuli√®rement √©tranges. </p><br><p>  Go a un excellent backend assembleur x86 (ici une d√©chirure est tomb√©e), mais ARM a vraiment mal fait: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !(o1 != <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> }</code> </pre> <br><p>  "Si non o1 n'est pas √©gal √† 0" ... La double n√©gation est un classique.  Si cela vous a plu, je vous invite √† vous familiariser avec le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CL123377</a> .  L√†, vous pouvez voir la version corrig√©e. </p><br><div class="spoiler">  <b class="spoiler_title">Option corrig√©e (pour ceux qui ne peuvent pas √™tre attir√©s pour passer en revue)</b> <div class="spoiler_text"><pre> <code class="diff hljs"><span class="hljs-deletion"><span class="hljs-deletion">- if !(o1 != 0) { + if o1 == 0 {</span></span></code> </pre> </div></div><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">boolExprSimplify</a> vise des simplifications qui augmentent la lisibilit√© (et l'optimiseur Go aurait r√©solu le probl√®me des performances sans lui). </p><br><h1 id="underef">  underef </h1><br><p>  Si vous utilisez Go √† partir de ses versions ant√©rieures, vous pouvez vous souvenir des points-virgules obligatoires, de l'absence de d√©r√©f√©rencement automatique des pointeurs et d'autres fonctionnalit√©s qui sont aujourd'hui presque impossibles √† voir dans le nouveau code. </p><br><p>  Dans l'ancien code, vous pouvez toujours voir quelque chose comme ceci: </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// -    : buf := (*bufp).ptr() // ...     : buf := bufp.ptr()</span></span></code> </pre> <br><p>  Plusieurs d√©clencheurs d'analyseurs sous- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">correctifs</a> corrig√©s dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CL122895</a> . </p><br><h1 id="appendcombine">  appendCombine </h1><br><p>  Vous savez peut-√™tre que l' <code>append</code> peut prendre plusieurs arguments comme √©l√©ments √† ajouter √† la tranche cible.  Dans certaines situations, cela vous permet d'am√©liorer l√©g√®rement la lisibilit√© du code, mais, ce qui peut √™tre plus int√©ressant, cela peut √©galement acc√©l√©rer votre programme, car le compilateur ne supprime pas les appels d' <code>append</code> compatibles ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cmd / compile: combiner les appels d'ajout</a> ). </p><br><p>  Dans Go, la v√©rification <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">appendCombine a</a> trouv√© la section suivante: </p><br><pre> <code class="diff hljs"><span class="hljs-deletion"><span class="hljs-deletion">- for i := len(ip) - 1; i &gt;= 0; i-- { - v := ip[i] - buf = append(buf, hexDigit[v&amp;0xF]) - buf = append(buf, '.') - buf = append(buf, hexDigit[v&gt;&gt;4]) - buf = append(buf, '.') - } + for i := len(ip) - 1; i &gt;= 0; i-- { + v := ip[i] + buf = append(buf, hexDigit[v&amp;0xF], + '.', + hexDigit[v&gt;&gt;4], + '.') + }</span></span></code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-built_in"><span class="hljs-built_in">old</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op delta ReverseAddress<span class="hljs-number"><span class="hljs-number">-8</span></span> <span class="hljs-number"><span class="hljs-number">4.10</span></span>¬µs ¬± <span class="hljs-number"><span class="hljs-number">3</span></span>% <span class="hljs-number"><span class="hljs-number">3.94</span></span>¬µs ¬± <span class="hljs-number"><span class="hljs-number">1</span></span>% <span class="hljs-number"><span class="hljs-number">-3.81</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">9</span></span>)</code> </pre> <br><p>  D√©tails dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CL117615</a> . </p><br><h1 id="rangevalcopy">  rangeValCopy </h1><br><p>  Ce n'est un secret pour personne que les valeurs r√©p√©t√©es dans une boucle de <code>range</code> sont copi√©es.  Pour les petits objets, disons, moins de 64 octets, vous ne remarquerez peut-√™tre m√™me pas cela.  Cependant, si un tel cycle se trouve sur un chemin ¬´chaud¬ª ou, que vous parcourez, contient un tr√®s grand nombre d'√©l√©ments, la surcharge peut √™tre tangible. </p><br><p>  Go a un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©diteur de liens</a> plut√¥t lent (cmd / link), et sans changements importants dans son architecture, un gain de performances √©lev√© ne peut pas √™tre atteint.  Mais vous pouvez alors r√©duire l√©g√®rement son inefficacit√© √† l'aide de microoptimisations.  Chaque pourcentage ou deux compte. </p><br><p>  La v√©rification <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rangeValCopy a</a> trouv√© plusieurs cycles avec la copie de donn√©es ind√©sirables √† la fois.  Voici les plus int√©ressants d'entre eux: </p><br><pre> <code class="diff hljs"><span class="hljs-deletion"><span class="hljs-deletion">- for _, r := range exports.R { - d.mark(r.Sym, nil) - } + for i := range exports.R { + d.mark(exports.R[i].Sym, nil) + }</span></span></code> </pre> <br><p>  Au lieu de copier <code>R[i]</code> √† chaque it√©ration, nous nous tournons uniquement vers le seul membre qui nous int√©resse, <code>Sym</code> . </p><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-built_in"><span class="hljs-built_in">old</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op delta Linker<span class="hljs-number"><span class="hljs-number">-4</span></span> <span class="hljs-number"><span class="hljs-number">530</span></span>ms ¬± <span class="hljs-number"><span class="hljs-number">2</span></span>% <span class="hljs-number"><span class="hljs-number">521</span></span>ms ¬± <span class="hljs-number"><span class="hljs-number">3</span></span>% <span class="hljs-number"><span class="hljs-number">-1.80</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">17</span></span>+<span class="hljs-number"><span class="hljs-number">20</span></span>)</code> </pre> <br><p>  La version compl√®te du patch est disponible sur: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CL113636</a> . </p><br><h1 id="namedconst">  namedConst </h1><br><p>  Dans Go, malheureusement, les constantes nomm√©es, m√™me assembl√©es en groupes, ne sont pas interconnect√©es et ne forment pas une √©num√©ration ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">proposition: spec: ajouter un support d'√©num√©ration typ√©</a> ). </p><br><p>  Un probl√®me est de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">transposer des constantes non typ√©es</a> dans le type que vous souhaitez utiliser comme √©num√©ration. </p><br><p>  Supposons que vous d√©finissiez un type de <code>Color</code> , sa valeur est <code>const ColDefault Color = 0</code> . <br>  Lequel de ces deux extraits de code pr√©f√©rez-vous? </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// (A) if color == 0 { return colorBlack } // (B) if color == colorDefault { return colorBlack }</span></span></code> </pre> <br><p>  Si <code>(B)</code> semble plus appropri√©, la v√©rification de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">namedConst</a> vous aidera √† suivre l'utilisation des valeurs constantes nomm√©es, en contournant la constante nomm√©e elle-m√™me. </p><br><p>  Voici comment la m√©thode <a href=""><code>context.mangle</code></a> du package <code>html/template</code> √©t√© transform√©e: </p><br><pre> <code class="diff hljs"> s := templateName + "$htmltemplate_" + c.state.String() - if c.delim != 0 { + if c.delim != delimNone { s += "_" + c.delim.String() } - if c.urlPart != 0 { + if c.urlPart != urlPartNone { s += "_" + c.urlPart.String() } - if c.jsCtx != 0 { + if c.jsCtx != jsCtxRegexp { s += "_" + c.jsCtx.String() } - if c.attr != 0 { + if c.attr != attrNone { s += "_" + c.attr.String() } - if c.element != 0 { + if c.element != elementNone { s += "_" + c.element.String() } return s</code> </pre> <br><p>  Soit dit en passant, parfois sur les liens vers les correctifs, vous pouvez trouver des discussions int√©ressantes ... <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CL123376 en</a> est un exemple. </p><br><h1 id="unslice">  couper </h1><br><p>  Une caract√©ristique de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">expression</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tranche</a> est que <code>x[:]</code> toujours identique √† <code>x</code> si le type <code>x</code> est une tranche ou une cha√Æne.  Dans le cas des tranches, cela fonctionne pour tout type d'√©l√©ment <code>[]T</code> </p><br><p>  Tout dans la liste ci-dessous est le m√™me ( <code>x</code> - tranche): </p><br><ul><li> <code>x</code> </li> <li> <code>x[:]</code> </li> <li> <code>x[:][:]</code> </li> <li>  ... </li></ul><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">unslice</a> trouve des expressions de tranche redondantes similaires.  Ces expressions sont nuisibles, tout d'abord, avec une charge cognitive suppl√©mentaire.  <code>x[:]</code> a une s√©mantique assez importante dans le cas de la prise d'une tranche du tableau.  Une tranche avec des plages par d√©faut ne fait que du bruit. </p><br><p>  Je demande un patch en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CL123375</a> . </p><br><h1 id="switchtrue">  switchTrue </h1><br><p>  Dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CL123378</a> , " <code>switch true {...}</code> " est remplac√© par " <code>switch {...}</code> ". <br>  Les deux formes sont √©quivalentes, mais la seconde est plus idiomatique. <br>  Trouv√© en v√©rifiant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">switchTrue</a> . </p><br><p>  La plupart des v√©rifications stylistiques r√©v√®lent pr√©cis√©ment de tels cas o√π les deux options sont acceptables, mais l'une d'entre elles est plus courante et famili√®re √† davantage de programmeurs Go.  V√©rifiez ensuite de la m√™me s√©rie. </p><br><h1 id="typeunparen">  typeUnparen </h1><br><p>  Go, comme beaucoup d'autres langages de programmation, aime les parenth√®ses.  √Ä tel point que je suis pr√™t √† en accepter un nombre quelconque: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> ( t0 <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> t1 (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) t2 ((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)) <span class="hljs-comment"><span class="hljs-comment">// ... ,  . )</span></span></code> </pre> <br><p>  Mais que se passe-t-il si vous ex√©cutez <code>gofmt</code> ? </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> ( t0 <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> t1 (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) <span class="hljs-comment"><span class="hljs-comment">// &lt;- !   . t2 (int) // &lt;-    ... )</span></span></code> </pre> <br><p>  C'est pourquoi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">typeUnparen</a> existe.  Il trouve dans le programme toutes les expressions de type dans lesquelles vous pouvez r√©duire le nombre de crochets.  J'ai essay√© d'envoyer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CL123379</a> , voyons comment la communaut√© l'acceptera. </p><br><div class="spoiler">  <b class="spoiler_title">Lisp n'aime pas les accolades</b> <div class="spoiler_text"><p>  Contrairement aux langages de type C, en Lisp, il n'est pas si facile d'ins√©rer des crochets inutiles en aucun endroit.  Ainsi, dans les langages dont la syntaxe est bas√©e sur les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">expressions S</a> , √©crire un programme qui ne fait rien d'autre que d'avoir un grand nombre de crochets est plus difficile que dans certains autres langages. </p></div></div><br><h1 id="go-critic-na-sluzhbe-go">  critique en d√©placement </h1><br><p> <a href="" title="Cliquer pour agrandir"><img src="https://habrastorage.org/webt/bq/0a/ig/bq0aigrftmrocldewkgzuhiycdo.jpeg"></a> </p><br><p>  Nous n'avons examin√© qu'une petite partie des contr√¥les mis en ≈ìuvre.  Dans le m√™me temps, leur quantit√© et leur qualit√© n'√©volueront qu'avec le temps, notamment gr√¢ce aux personnes qui ont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rejoint le d√©veloppement</a> . </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">go-critique est</a> absolument gratuit pour toute utilisation ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">licence MIT</a> ), et √©galement ouvert √† votre participation au d√©veloppement du projet.  Envoyez-nous des id√©es de v√©rifications, vous pouvez imm√©diatement avec la mise en ≈ìuvre, rapporter les bugs et lacunes constat√©s, partager vos impressions.  Vous pouvez √©galement proposer des projets √† auditer ou faire rapport sur votre revue de code Go, cette exp√©rience nous est pr√©cieuse. </p><br><h2 id="tema-kontribyutinga-v-go">  Aller Contribuer Th√®me </h2><br><p>  Avez-vous vu l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Go Contribution Workshop en Russie</a> ?  Cet automne sera le deuxi√®me tour.  Et cette fois, en plus d'un format et de sponsors plus performants, nous aurons une arme secr√®te - un merveilleux analyseur statique.  Il y aura suffisamment de contributions! </p><br><p>  Mais en fait, vous pouvez commencer d√®s maintenant (bien que ce soit mieux - un peu plus tard, apr√®s le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gel du code</a> ).  Si vous parvenez √† vous mettre √† l'aise avant le prochain atelier, ce sera tr√®s cool, car nous manquons de mentors en Russie. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr416903/">https://habr.com/ru/post/fr416903/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr416891/index.html">Aux √âtats-Unis, ils √©taient toujours autoris√©s √† distribuer des mod√®les 3D et des dessins num√©riques pour les armes de bricolage.</a></li>
<li><a href="../fr416893/index.html">Vaadin Flow - un √©trange cerf</a></li>
<li><a href="../fr416897/index.html">Comment faire un syst√®me de paiement √† faire soi-m√™me</a></li>
<li><a href="../fr416899/index.html">Nous indiquons au maire o√π aller (√† l'aide de l'Open Street Map)</a></li>
<li><a href="../fr416901/index.html">Comment les professionnels de l'informatique et de la s√©curit√© se prot√®gent: cas r√©els avec Cisco Connect, BlackHat, RSAC et MWC</a></li>
<li><a href="../fr416905/index.html">Pr√©sentation de Boston Dynamics SpotMini</a></li>
<li><a href="../fr416907/index.html">Th√©orie du bonheur. Z√®bre de loi et file d'attente extraterrestre</a></li>
<li><a href="../fr416909/index.html">Historique des sessions actives de PostgreSQL - nouvelle extension pgsentinel</a></li>
<li><a href="../fr416911/index.html">Les chatbots √©taient cens√©s √™tre la prochaine perc√©e: qu'est-ce qui a mal tourn√©?</a></li>
<li><a href="../fr416913/index.html">Qu'est-ce que l'administrateur doit oublier lors du passage au cloud - et ce qu'il faut apprendre</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>