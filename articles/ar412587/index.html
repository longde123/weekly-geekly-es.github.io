<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>โซ๏ธ ๐ฃ๐ป ๐ ุฏููุฉ + ููุฑุง. ุงุถุบุท ุนูู ุงูุญุฏ ุงูุฃูุตู ๐๐ป ๐ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ูุฐู ุงูููุงูุฉ ุ ุฃูุฏ ุฃู ุฃุชุญุฏุซ ุนู ููููุฉ ุงุณุชุฎุฏุงู Puppet ู Hiera ูุชูููู ุงูุญุฏูุฏ ูุงูุฎูุงุฏู ุงูุงูุชุฑุงุถูุฉ. ูู ุงูุฃุณุงุณ ุ ุณูููู ุงูุฃูุฑ ูุชุนูููุง ุจุงูุนูุงุฑุฉ ูุงูุชุณูุณู ุงูู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฏููุฉ + ููุฑุง. ุงุถุบุท ุนูู ุงูุญุฏ ุงูุฃูุตู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/semrush/blog/412587/" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/vq/z-/bj/vqz-bjm4yx2wvhzcf-frffyuh04.png"></div><br><p style=";text-align:right;direction:rtl">  ูู ูุฐู ุงูููุงูุฉ ุ ุฃูุฏ ุฃู ุฃุชุญุฏุซ ุนู ููููุฉ ุงุณุชุฎุฏุงู <strong>Puppet</strong> ู <strong>Hiera</strong> ูุชูููู ุงูุญุฏูุฏ ูุงูุฎูุงุฏู ุงูุงูุชุฑุงุถูุฉ.  ูู ุงูุฃุณุงุณ ุ ุณูููู ุงูุฃูุฑ ูุชุนูููุง ุจุงูุนูุงุฑุฉ ูุงูุชุณูุณู ุงููุฑูู ุงูุฐู ุงุฎุชุฑุนูุงู ุ ููุง ูุณูู ูููุธู ุชูููู ุงูุฎูุงุฏู. </p><br><p style=";text-align:right;direction:rtl">  ููุฏ ุทููุจ ููู ูุชุงุจุฉ ูุฐู ุงูููุงูุฉ ุจุญูููุฉ ุฃููู ูู ุฃุฌุฏ ุนูู ุงูุฅูุชุฑูุช ุฃูุซูุฉ ุฌูุฏุฉ ูุนูููุฉ ุญููุง ูููููุฉ ุงูุนูู ูุน hiera ููุง ุงูุบุฑุถ ููู.  ูู ุงูุฃุณุงุณ ุ ูุฐู ุฏุฑูุณ ูุน ุฃูุซูุฉ ูู ุฃุฌู ุฅุฏุฎุงู ุงูููุถูุน.  ููู ุงูุชุทุจูู ุงูุนููู ุงูุญูููู ููููุฑุง ูู ููุชุจ ููุงู.  ุฑุจูุง ูู ุฃุจุฏู ุจุดูู ุฌูุฏ ุ ูููู ููุง ูุซุงู ุญูููู ูู ุงููุญุชูู ุฃู ูุณุงุนุฏู ุนูู ูุถุน ุฌููุน ุงูููุงุท ูููู ุ ููุง ูุนูุช ูุฑุฉ ูุงุญุฏุฉ. </p><br><h3 id="dlya-kogo-byla-by-polezna-dannaya-statya" style=";text-align:right;direction:rtl">  ููู ุณุชููู ูุฐู ุงูููุงูุฉ ูููุฏุฉ </h3><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฃูุช ุชุนุฑู ูุง ูู Puppet ู Hiera ุ ูููู ูุง ุชุณุชุฎุฏูููุง ูุนูุง ุญููุง ุ ูุฃูู ููุณ ูู ุงููุงุถุญ ููููุฉ ุงูููุงู ุจุฐูู ูููุงุฐุง </li><li style=";text-align:right;direction:rtl">  ูุฏูู ุงููุซูุฑ ูู ุงููุฑู ูู ุดุฑูุชู ูุชุญุชุงุฌ ุฅูู ุงูุชูููุฒ ุจูู ุชูููู ุงูุฎุงุฏู ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ุนูู ูุณุชูู ุงูุฃูุฑ </li><li style=";text-align:right;direction:rtl">  ููููู ุงุณุชุฎุฏุงู ููุญุฉ ุ ููููุงุช ุงูุนูุฏุฉ ุงูุชู ููุช ุฅูู ุฃุญุฌุงู ูุง ุชุตุฏู </li><li style=";text-align:right;direction:rtl">  ูู ุชุญุจ ูุฑุงุกุฉ ุชูููู ุงูุฎุงุฏู ุจุชูุณูู yaml ุงูุฅููู :) </li><li style=";text-align:right;direction:rtl">  ุฃูุช ููุชู ุจุดูู ุฃุณุงุณู ุจููุถูุน ุฅุฏุงุฑุฉ ุงูุชููุฆุฉ ูุฅุฏุงุฑุฉ ุงููุธุงู. </li></ul><br><p style=";text-align:right;direction:rtl">  ูุฐู ุงูููุงูุฉ ูู. </p><a name="habracut"></a><br><h3 id="prezhde-chem-nachat" style=";text-align:right;direction:rtl">  ูุจู ุฃู ุชุจุฏุฃ </h3><br><p style=";text-align:right;direction:rtl">  ุณุฃุญุฐุฑู ุนูู ุงูููุฑ ุ ุชุจูู ุฃู ุงูููุงูุฉ ุทูููุฉ ุ ูููู ุขูู ุฃู ุชููู ูููุฏุฉ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูู ุงูููููู ุฃูู ููุช ุจุงููุนู ุจุชูุตูู ููุฑุง ุจุงูุฏูู ุ ูุฃูู ุนูู ุงูุฃูู ุนูู ุฏุฑุงูุฉ ุจุทุฑููุฉ ูุง ุจุงูุฏูู.  ุฅุฐุง ูู ุชูู ุงูุญูุฑุฉ ูุชุตูุฉ ุ ูููุณ ูู ุงูุตุนุจ ุงูููุงู ุจุฐูู. </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุฑุฃ ุงููุฒูุฏ ุนู ุฏูู ุงูุนุฑุงุฆุณ ููุง: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุนุฑุงุฆุณ ูููุจุชุฏุฆูู</a> . </li><li style=";text-align:right;direction:rtl">  ููู ุชุนูู ููุฑุง - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุฏูุฉ ูู ููุฑุง</a> . </li></ul><br><h3 id="vvodnye-dannye" style=";text-align:right;direction:rtl">  ุจูุงูุงุช ุงูุฅุฏุฎุงู </h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฏููุง ุญูุงูู 30 ูุฑูู ุชุทููุฑ ูู SEMrush ุ ููู ูููุง ุฎูุงุฏููุง ุงูุฎุงุตุฉ </li><li style=";text-align:right;direction:rtl">  ูุนูู ูู ูุฑูู ูุน ูุฌููุนุชู ุงูุฎุงุตุฉ ูู ุงูุชูููุงุช (PL ุ DBMS ุ ุฅูุฎ.) </li><li style=";text-align:right;direction:rtl">  ูููู ูููุฑู ููุฌุจ ุนูููุง (ุจุดูู ูุซุงูู) ุงุณุชุฎุฏุงู ุงูุชูููู ุงููุดุชุฑู ููุดุงุฑูุน ูุญุฏุฏุฉ (ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ) </li><li style=";text-align:right;direction:rtl">  ุชุฏูุฑ ุงููุฑู ููุณูุง ูุดุฑ ุงูุชุทุจููุงุช ุนูู ุฎูุงุฏููุง (ูุง ูุชู ุฐูู ูู ุฎูุงู ุงูุชุทุจูู) </li></ul><br><h3 id="nemnogo-istorii" style=";text-align:right;direction:rtl">  ุงููููู ูู ุงูุชุงุฑูุฎ </h3><br><p style=";text-align:right;direction:rtl">  ูู ุงูุจุฏุงูุฉ ุ ูุงู ูุฏููุง ูู ุดูุก ูู ุงูุฅุตุฏุงุฑ 3 ูู pappet ุ ุซู ูุฑุฑูุง ุชูููุฐ ุงูููุญุฉ ุงูุฑุงุจุนุฉ ุ ูุจุฏุฃุช ุฌููุน ุงูุฎูุงุฏู ุงูุฌุฏูุฏุฉ ูู ูุถุนูุง ุ ูุชู ููู ุงูุฎูุงุฏู ุงููุฏููุฉ ุจุจุทุก ุฅูู ุงูุฑุงุจุน. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูุฌุฒุก ุงูุซุงูุซ ุ ุงุนุชุฏูุง ุนูู ุงุณุชุฎุฏุงู ุงููุธุงู ุงูููุงุณููู ููููุงุช ุงูุนูุฏุฉ ูุงููุญุฏุงุช ุงูููุทูุฉ.  ุชู ุฅูุดุงุก ุงููุญุฏุงุช ุงูููุทูุฉ ูู ูุฌููุนุฉ ุฎุงุตุฉ ูู ุงููุดุงุฑูุน ูู Gitlab ุ ูุชู ุงุณุชูุณุงุฎูุง ุฅูู ุฎุงุฏู ุจุงุจูุช (ุจุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">r10k</a> ) ุ ุซู ุฌุงุก ูููุงุก pappet ุฅูู ุงููุนุงูุฌ ูุชูููุง ุฏูููุงู ูุชุทุจููู ุนูู ุงูุฎุงุฏู. </p><br><p style=";text-align:right;direction:rtl">  ุซู ุจุฏุฃูุง ูุญุงูููู ุนุฏู ุงูููุงู ุจุฐูู ูุนุฏู ุงุณุชุฎุฏุงู ุงููุญุฏุงุช ุงููุญููุฉ ุ ูููู ูุถุน ุฑูุงุจุท ูููุญุฏุงุช ุงูุถุฑูุฑูุฉ ูุงููุณุชูุฏุนุงุช ุงูุฎุงุตุฉ ุจูู ูู Puppetfile.  ููุงุฐุงุ  ูุฃู ูุฐู ุงููุญุฏุงุช ูุชู ุฏุนููุง ูุชุญุณูููุง ุจุงุณุชูุฑุงุฑ (ุฌูุฏูุง ุ ุจุดูู ูุซุงูู) ูู ูุจู ุงููุฌุชูุน ูุงููุทูุฑูู ุ ูุงููุญุฏุงุช ุงููุญููุฉ ูุฏููุง ููุณุช ูุฐูู.  ูู ููุช ูุงุญู ุฃุฏุฎููุง ููุฑุง ูุชุญูููุง ุฅูููุง ุจุงููุงูู ุ ููุฏ ุบุฑูุช ูููุงุช ุงูุนูุฏุฉ (ูุซู nodes.pp) ูู ุทู ุงููุณูุงู. </p><br><p style=";text-align:right;direction:rtl"> ูู ุงูุฌุฒุก ุงูุฑุงุจุน ุ ุญุงูููุง ุงูุชุฎูู ุชูุงููุง ุนู ุงููุญุฏุงุช ุงููุญููุฉ ูุงุณุชุฎุฏุงู ุงููุญุฏุงุช ุงูุจุนูุฏุฉ ููุท.  ูุณูุก ุงูุญุธ ุ ูุฌุจ ุฅุฏุฑุงุฌ ุงูุญุฌุฒ ููุง ูุฑุฉ ุฃุฎุฑู ุ ูุฃูู "ูู ููุฌุญ ุชูุงููุง" ุ ูู ุจุนุถ ุงูุฃุญูุงู ูุง ูุฒุงู ุนููู ุฅูุงูุฉ ูุฅููุงุก ุดูุก ุจููุณู.  ุจุงูุทุจุน ุ ูุง ููุฌุฏ ุณูู hiera ููุง ุชูุฌุฏ ูููุงุช ุนูุฏุฉ. </p><br><p style=";text-align:right;direction:rtl">  <strong>ุนูุฏูุง ูููู ูุฏูู 30 ูุฑูููุง ูุน ุญุฏููุฉ ุญููุงูุงุช ุชูููููุฌูุฉ ุ ูุฅู ูุดููุฉ ููููุฉ ุงูุญูุงุธ ุนูู ูุฐุง ุงููุฏูุฑ ูุน ุฃูุซุฑ ูู 1000 ุฎุงุฏู ุชุตุจุญ ุญุงุฏุฉ ุจุดูู ุฎุงุต.</strong>  <strong>ุนูุงูุฉ ุนูู ุฐูู ุ ุณุฃุฎุจุฑูุง ููู ุชุณุงุนุฏูุง ููุฑุง ูู ุฐูู.</strong> </p><br><h3 id="ierarhiya" style=";text-align:right;direction:rtl">  ุงูุชุณูุณู ุงููุฑูู </h3><br><p style=";text-align:right;direction:rtl">  ููุฑุง (ุงูุชู ุญุตูุช ุนูู ุงุณููุง ูู ุงููุงูุน) ุชุดูู ุชุณูุณูุงู ูุฑูููุง.  ูุนูุง ุ ูุจุฏู ูุฐุง: </p><br><pre style=";text-align:right;direction:rtl"><code class="hljs axapta">--- :hierarchy: - <span class="hljs-string"><span class="hljs-string">"nodes/%{::fqdn}"</span></span> - <span class="hljs-string"><span class="hljs-string">"teams/%{::team}_team/nodes/%{::fqdn}"</span></span> - <span class="hljs-string"><span class="hljs-string">"teams/%{::team}_team/projects/%{::project}/tiers/%{::tier}"</span></span> - <span class="hljs-string"><span class="hljs-string">"teams/%{::team}_team/projects/%{::project}/%{::role}"</span></span> - <span class="hljs-string"><span class="hljs-string">"teams/%{::team}_team/projects/%{::project}"</span></span> - <span class="hljs-string"><span class="hljs-string">"teams/%{::team}_team/roles/%{::role}"</span></span> - <span class="hljs-string"><span class="hljs-string">"teams/%{::team}_team/%{::team}"</span></span> - <span class="hljs-string"><span class="hljs-string">"projects/%{::project}/tiers/%{::tier}/%{::role}"</span></span> - <span class="hljs-string"><span class="hljs-string">"projects/%{::project}/tiers/%{::tier}"</span></span> - <span class="hljs-string"><span class="hljs-string">"projects/%{::project}/%{::role}"</span></span> - <span class="hljs-string"><span class="hljs-string">"projects/%{::project}"</span></span> - <span class="hljs-string"><span class="hljs-string">"tiers/%{::tier}"</span></span> - <span class="hljs-string"><span class="hljs-string">"virtual/%{::virtual}"</span></span> - <span class="hljs-string"><span class="hljs-string">"os/%{::operatingsystem}/%{::operatingsystemmajrelease}"</span></span> - <span class="hljs-string"><span class="hljs-string">"os/%{::operatingsystem}"</span></span> - users - <span class="hljs-keyword"><span class="hljs-keyword">common</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃููุงู ุ ุฏุนูุง ูุชุนุงูู ูุน ุงููุชุบูุฑุงุช ุงูุบุงูุถุฉ (ุงูุญูุงุฆู). </p><br><p style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูุญุชูู ูู ุฎุงุฏู ูู SEMrush ุจุดูู ูุซุงูู ุนูู 4 ุญูุงุฆู ุฎุงุตุฉ ููุดููุฉ ุชุตู ุงูุชูุงุฆู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุญูููุฉ <strong><code>team</code></strong> - ุฃู ูุฑูู ููุชูู ุฅููู </li><li style=";text-align:right;direction:rtl">  <strong><code>project</code></strong> ุญูููุฉ - ุฃู ูุดุฑูุน ูุชุนูู ุจู </li><li style=";text-align:right;direction:rtl">  ุญูููุฉ <strong><code>role</code></strong> - ูุง ูู ุฏูุฑ ูุฐุง ุงููุดุฑูุน </li><li style=";text-align:right;direction:rtl">  ุญูููุฉ <strong><code>tier</code></strong> - ุฃู ููุน ูู ุงููุฑุงุญู ูุฏููุง (ููุฒ ุ ุงุฎุชุจุงุฑ ุ ุฏูู) </li></ul><br><p style=";text-align:right;direction:rtl">  ููู ูุนููุ  ูุฃุชู ูููู Pappet ุฅูู ุณูุฏ Pappet ุ ูุงุณุชูุงุฏูุง ุฅูู ูุฐู ุงูุญูุงุฆู ุ ูุจุญุซ ุนู ุงููููุงุช ูููุณู ุ ูููุฑ ุนุจุฑ ุงููุฌูุฏุงุช ููููุง ูุชุณูุณููุง ุงููุฑูู.  ูุง ุญุงุฌุฉ ููุฅุดุงุฑุฉ ุฅูู ุฃู ูููุงุช ุงูุชูููู ุชูุชูู ุฅูู ุงูุฎูุงุฏู.  ุจุฏูุงู ูู ุฐูู ุ ุชุนุฑู ุงูุฎูุงุฏู ููุณูุง ุงููููุงุช ุงูุชู ุชูุชูู ุฅูููุง ุ ูุชูุธุฑ ููุท ุฅูู ูุณุงุฑูุง ูุญูุงุฆููุง. </p><br><p style=";text-align:right;direction:rtl">  ุฃุซูุงุก ุฅุนุฏุงุฏ ุงูุฎุงุฏู ุ ูุชุตู ุงููุดุฑููู ุจุงููุทูุฑูู ููุญุฏุฏูู ูุฐู ุงููุนููุงุช (ุบุงูุจูุง ุ ุนูู ุงูุนูุณ ูู ุฐูู ุ ูุชุตู ุงูุฃุดุฎุงุต ุงููุทูุนูู ุจุงููุณุคูููู ุฃููุณูู) ูู ุฃุฌู ุจูุงุก ุชุณูุณู ูุฑูู ูู hiera ูู ุงููุณุชูุจู ุ ุนูู ุฃุณุงุณู ูุตู ุชูููู ุงูุฎุงุฏู.  ูุณุงุนุฏ ูุฐุง ุงููุธุงู ุนูู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ููููู ุฃูุซุฑ ูุฑููุฉ ูู ุญูุซ ุชูููู ุงูุฎุงุฏู. </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุณุจูู ุงููุซุงู ุ ูุฏููุง ูุดุฑูุน <em>ุฎุงุต</em> .  ูู ูุฐุง ุงููุดุฑูุน ุ ูุฏ ูููู ููุงู ุจุนุถ ุฎุงุฏู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ูุน nginx ุ ุฎุงุฏู ุงููุงุฌูุฉ ุงูุฎูููุฉ ูุน ุงูุซุนุจุงู ุ ูุชูุฉ db ูุน ุงูุฎููุฉ ุ ุฎุงุฏู redis ููุชุฎุฒูู ุงููุคูุช.  ูุฌุจ ูุถุน ุฌููุน ูุฐู ุงูุฎูุงุฏู ูู ูุดุฑูุน ูุงุญุฏ ูุณูู <strong>ุฎุงุต</strong> ุ ุซู ุชุนููู <strong>ุงูุฃุฏูุงุฑ</strong> ููุฎูุงุฏู. </p><br><p style=";text-align:right;direction:rtl">  ูู ููู ุงููุดุฑูุน ุ ูููู ุจูุตู ุงููุนููุงุช ุงููุดุชุฑูุฉ ูููุดุฑูุน ุจุฃูููู.  ุฃูู ูุง ูุชุจุงุฏุฑ ุฅูู ุงูุฐูู ูู ุงูุฅูุดุงุก ุนูู ุฌููุน ุฎูุงุฏู ุงููุณุชุฎุฏู ูููุดุฑ ูุน ูุถูุฉ ุงูุญููู ุงููุงุฒูุฉ ูู ูุทุฑุญ ููุงุชูุญ ssh ุงูุฎุงุตุฉ ุจู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุฏูุฑ ูู ุฎุงุฏู ุ ุนุงุฏุฉ ูุง ูุชู ูุตู ุงูุฎุฏูุฉ ูุชุฎุตูุตูุง - ููุง ููุตุฏ ุจู ูุฐุง ุงูุฎุงุฏู (nginx ุ python ุ mysql ุ ุฅูุฎ.) ุงูุทุจูุฉ ูู ูุฐู ุงูุญุงูุฉ ุณูุญุชุงุฌ ุจุงูุชุฃููุฏ ุฅุฐุง ููุง ุจุญุงุฌุฉ ุฃูุถูุง ุฅูู ูุดุฑ ูุณุฎุฉ ูู ุจูุฆุฉ ุงูุฅูุชุงุฌ ุนูู ููุตุฉ dev ุ ูููู ุชุบููุฑ ุดูุก ููู (ูููุงุช ุงููุฑูุฑ ุ ุนูู ุณุจูู ุงููุซุงู).  ูู ูุฐู ุงูุญุงูุฉ ุ ุณูุฎุชูู ุฎุงุฏู dev ูุฎุงุฏู prod ููุท ูู ุญูููุฉ ุฃูู ุชู ุชุนููู ุงูุทุจูุฉ ุนูู "ุงูููุถุน" ุงููุทููุจ (prod ุฃู dev).  ุซู ุงููููู ูู ุงูุณุญุฑ ูุงูููุฑุง ุณููุนูุงู ุงูุฎุฏุนุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ููุง ุจุญุงุฌุฉ ุฅูู ูุดุฑ ุฎุงุฏููู ูุชุทุงุจููู ูู ููุณ ุงูุฏูุฑ ุ ูููู ูุฌุจ ุฃู ูุฎุชูู ุดูุก ููููุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ุจุนุถ ุงูุฎุทูุท ูู ุงูุชูููู ุ ูุณูุฃุชู ุฌุฒุก ุขุฎุฑ ูู ุงูุชุณูุณู ุงููุฑูู ุฅูู ุงูุฅููุงุฐ.  ูุถุน ุงููููุงุช ุจุงุณู ุงูุชูุณูู <strong><code>{fqdn }.yaml</code></strong> ูู ุงูููุงู ุงูุตุญูุญ (ุนูู ุณุจูู ุงููุซุงู ุ <strong><code>nodes/myserver.domain.net</code></strong> ) ุ ููุนูู ุงูููู ุงููุงุฒูุฉ ูููุชุบูุฑุงุช ุนูู ูุณุชูู ุฎุงุฏู ูุนูู ุ ูุณูุทุจู ุงูุจุงุจูุช ููุณ ุงูุชูููู ููู ูู ุงูุฎูุงุฏู ููุฏูุฑ ุ ููุฑูุฏูุง ููู ููููุง ูู ุงูุฎูุงุฏู. </p><br><p style=";text-align:right;direction:rtl">  ูุซุงู: ููุฌุฏ ุฎูููุชุงู ุจุฑูุฒ php ูู ููุณ ุงูุฏูุฑ ูููุง ูุชุทุงุจูุงู ุชูุงููุง.  ูู ุงููุงุถุญ ุฃููุง ูุง ูุฑูุฏ ุนูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ููุง ุงูุฎุงุฏููู - ููุง ูุนูู ูุฐูู.  ูููููุง ุฅูุดุงุก ุฏูุฑ ููุตู ููุณ ุงูุชูููู ูููุง ุงูุฎุงุฏููู ุ ุซู ุฅูุดุงุก ููู <strong><code>nodes/backend1.semrush.net</code></strong> ููุถุน ุงูุชูููู ูููุณุฎ ุงูุงุญุชูุงุทู. </p><br><p style=";text-align:right;direction:rtl">  ุชุดูุฑ <strong><code>teams/team-name.yaml</code></strong> ุงูููู ุงูุฏูุนู <strong><code>teams/team-name.yaml</code></strong> ุฅูู ุงูุชูููู ููุงูุฉ ุงูุฎูุงุฏู ุงูุชู ุชูุชูู ุฅูู ุงููุฑูู.  ูู ุฃุบูุจ ุงูุฃุญูุงู ุ ูุตู ุงููุณุชุฎุฏููู ุงูุฐูู ูููููู ุงูุชูุงุนู ูุน ูุฐู ุงูุฎูุงุฏู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุญููู ุงููุตูู ุงูุฎุงุตุฉ ุจูู. </p><br><p style=";text-align:right;direction:rtl">  ุจูุงุกู ุนูู ูุฐู ุงููุชุบูุฑุงุช ุ ูููุง ุจุจูุงุก ูุฐุง <strong>ุงูุชุณูุณู ุงููุฑูู</strong> .  ูููุง ุฒุงุฏ ุญุฌู ุงูููู ุงูููุฌูุฏ ูู ุงูุชุณูุณู ุงููุฑูู ุ ุฒุงุฏุช ุฃููููุฉ ุงูุชูููู ุงููุญุฏุฏ ููู. </p><br><p style=";text-align:right;direction:rtl">  ููุชุฑุชุจ ุนูู ุฐูู ุฃู ุงููุชุบูุฑุงุช ูููู <strong>ุชุฌุงูุฒูุง</strong> ุจูุงุกู ุนูู ูุฐุง ุงูุชุณูุณู ุงููุฑูู.  ุฃู ุฃู ุงููุชุบูุฑ ูู ููู ุงูุฏูุฑ " <strong><code>projects/%{::project}/%{::role}</code></strong> " ูู ุงูุฃุณุจููุฉ ุนูู ุงููุชุบูุฑ ูู ููู ุงููุดุฑูุน " <strong><code>projects/%{::project}</code></strong> ".  ูููู ุฃูุถูุง ุฏูุฌ ุงููุชุบูุฑุงุช ูู ุฌููุน ูุณุชููุงุช ุงูุชุณูุณู ุงููุฑูู ุฅุฐุง ูุงู ูุฏูู ูุญุฏุฉ ู / ุฃู ููู ุชุนุฑูู / ุฏูุฑ ููุชูุจ ุจุทุฑููุฉ ูููู ุงูููุงู ุจูุง.  ูู ุฎูุงู ุชุญุฏูุฏ ุงูุฌุฒุก ุงููุดุชุฑู ูู mysql config ูุฌููุน ุฎูุงุฏู ุงููุดุฑูุน ุ ููููู ุฅุถุงูุฉ ุฃุฌุฒุงุก ุฎุงุตุฉ ููุง ูุฒู ููุฐุง ุงูุฏูุฑ ุฅูู ููุณ ุงููุชุบูุฑ ูู ุงููุณุชููุงุช ุงูุฃุฎุฑู ูู ุงูุชุณูุณู ุงููุฑูู (ุณูููู ููุงู ูุณู ุฅุถุงูู ูู ุงูุชูููู ููุนุจุฏ). </p><br><p style=";text-align:right;direction:rtl">  ูุชุจูู ุฃู ููู ุงูุนูุฏุฉ ุงููุญุฏุฏุฉ ุงูููุฌูุฏุฉ ุนูู ุงููุณุงุฑ " <strong><code>hieradata/nodes/%{::fqdn}</code></strong> " ูู ุงูุฃููููุฉ ุงููุตูู.  ุจุนุฏ ุฐูู ูุฃุชู ููู ุงูุนูุฏุฉ ุ ูููู ุจุงููุนู ุนูู ูุณุชูู ุงูุฃูุฑ.  ููุฌุฏ ุฃุฏูุงู ุงููุชูุฉ ุงูุชู ุชุตู ุญูุงุฆู ุฃุฎุฑู ุฃูุซุฑ ุนููููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs axapta"> - <span class="hljs-string"><span class="hljs-string">"virtual/%{::virtual}"</span></span> - <span class="hljs-string"><span class="hljs-string">"os/%{::operatingsystem}/%{::operatingsystemmajrelease}"</span></span> - <span class="hljs-string"><span class="hljs-string">"os/%{::operatingsystem}"</span></span> - users - <span class="hljs-keyword"><span class="hljs-keyword">common</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููููุง ูุฐูู ุ ูู ุงูููู <strong><code>common.yaml</code></strong> ูุฏููุง ุชูููู ูุฌุจ ุฃู ูุฃุชู ุจุงูุชุฃููุฏ ุฅูู <strong>ุฌููุน</strong> ุงูุฎูุงุฏู ุ ูู ููู ุงููุณุชุฎุฏููู. ูุชู ูุตู ุฌููุน ุงููุณุชุฎุฏููู (ูููู ูุง ูุชู ุฅูุดุงุคูุง ุฌููุนูุง ุนูู ุงูุฎูุงุฏู ุ ุจุงูุทุจุน) ุ ูู <strong><code>os/%{::operatingsystem}</code></strong> ุงูุชูููู ุงูุนุงู ุงููููุฐุฌู ููุฎูุงุฏู ุฐุงุช ูุธุงู ุชุดุบูู ูุนูู ( <code>::operatingsystem</code> fact <code>::operatingsystem</code> ) ููุง ุฅูู ุฐูู. </p><br><p style=";text-align:right;direction:rtl">  ุฃุนุชูุฏ ุ ุจุงููุธุฑ ุฅูู ูุฐุง ุงูุชุณูุณู ุงููุฑูู ุ ูุตุจุญ ูู ุดูุก ูุงุถุญูุง.  ุฃุฏูุงู ุณูู ุฃุนุชุจุฑ ูุซุงูุง ูุงุณุชุฎุฏุงู ูุซู ูุฐุง ุงูุชุณูุณู ุงููุฑูู.  ูููู ุนููู ุฃููุงู ุงูุชุญุฏุซ ุนู ูููุงุช ุงูุชุนุฑูู. </p><br><h3 id="profili" style=";text-align:right;direction:rtl">  ุงูููุงูุญ </h3><br><p style=";text-align:right;direction:rtl">  ูุนุฏ ุงุณุชุฎุฏุงู ูููุงุช ุงูุชุนุฑูู ููุทุฉ ูููุฉ ูู ุชูููู ุงูุฎูุงุฏู ุจุงุณุชุฎุฏุงู ุงููุญุฏุงุช.  ููู ุชูุน ุนูู <strong><code>site/profiles</code></strong> ุงููุณุงุฑ ููู ููุงุท ุงูุฏุฎูู ุฅูู ุงููุญุฏุงุช.  ุจูุถููุง ุ ููููู ุชูููู ุงููุญุฏุงุช ุงููุนููุฉ ุนูู ุงูุฎุงุฏู ุจุดูู ุฃูุซุฑ ุฏูุฉ ูุฅูุดุงุก ุงูููุงุฑุฏ ุงููุงุฒูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููุฑ ูู ูุซุงู ุจุณูุท.  ููุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุญุฏุฉ</a> ุชููู ุจุชุซุจูุช ูุชูููู redis.  ููุฑูุฏ ุฃูุถูุง ุชุนููู ูุนููุฉ <code>vm.overcommit_memory</code> ุนูู 1 ุนูุฏ ุชูุตูู ูุฐู ุงููุญุฏุฉ ุ ูุฃูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> .  ุซู ููุชุจ ููููุง ุดุฎุตููุง ุตุบูุฑูุง ูููุฑ ูุฐู ุงููุธููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs lua"># standalone redis server class profiles::db::redis ( Hash $<span class="hljs-built_in"><span class="hljs-built_in">config</span></span> = {}, String $output_buffer_limit_slave = <span class="hljs-string"><span class="hljs-string">'256mb 64mb 60'</span></span>, ) { # https://redis.<span class="hljs-built_in"><span class="hljs-built_in">io</span></span>/topics/faq#background-saving-fails-with-a-fork-<span class="hljs-built_in"><span class="hljs-built_in">error</span></span>-under-linux-even-<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-i-have-a-lot-of-free-ram sysctl { <span class="hljs-string"><span class="hljs-string">'vm.overcommit_memory'</span></span>: ensure =&gt; present, value =&gt; <span class="hljs-string"><span class="hljs-string">'1'</span></span>, } class { <span class="hljs-string"><span class="hljs-string">'::redis'</span></span>: * =&gt; $<span class="hljs-built_in"><span class="hljs-built_in">config</span></span>, } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง ุฐูุฑ ุฃุนูุงู ุ ูุฅู ุงููููุงุช ุงูุดุฎุตูุฉ ูู ุฃุฏุงุฉ ุชุณูุญ ูู ุจุชุบููุฑ / ุชุญุณูู ุณููู ุงููุญุฏุฉ ุ ููุฐูู ุชูููู ุนุฏุฏ ุงูุชููููุงุช ูู hiera.  ุฅุฐุง ููุช ุชุณุชุฎุฏู ูุญุฏุงุช ุนู ุจูุนุฏ ุ ูุบุงูุจูุง ูุง ุชูุงุฌู ูุดููุฉ ุชุชูุซู ูู ุฃู ุงููุญุฏุงุช "ุงููุนุชูุฏุฉ" ุบุงูุจูุง ูุง ูุง ุชุญุชูู ุนูู ุงููุธุงุฆู ุงูุชู ุชุญุชุงุฌูุง ุ ุฃู ูุฏูู ุจุนุถ ุงูุฃุฎุทุงุก / ุงูุนููุจ.  ุซู ุ ูู ุญูุซ ุงููุจุฏุฃ ุ ููููู ุงุณุชูุณุงุฎ ูุฐู ุงููุญุฏุฉ ูุชุตุญูุญ / ุฅุถุงูุฉ ูุธุงุฆู.  ูููู ุงููุฑุงุฑ ุงูุตุญูุญ ุณูููู ุ ุฅู ุฃููู ุ ูุชุงุจุฉ ููู ุชุนุฑูู ุฌูุฏ ููููู "ุฅุนุฏุงุฏ" ุงููุญุฏุฉ ุจุงูุทุฑููุฉ ุงูุชู ุชุฑูุฏูุง.  ูููุง ููู ุจุนุถ ุงูุฃูุซูุฉ ุนู ุงููููุงุช ุงูุดุฎุตูุฉ ุ ูููููู ููู ุณุจุจ ุงูุญุงุฌุฉ ุฅูููุง ุจุดูู ุฃูุถู. </p><br><h3 id="sokrytie-sekretov-v-hiera" style=";text-align:right;direction:rtl">  ุฅุฎูุงุก ุงูุฃุณุฑุงุฑ ูู ุงูุญูุฑู </h3><br><p style=";text-align:right;direction:rtl">  ูุงุญุฏุฉ ูู ุงููุฒุงูุง ุงููุงูุฉ ููููุฑุง ููุงุฑูุฉ ูุน ููุญุฉ ุงูุนุงุฑูุฉ ูู ูุฏุฑุชูุง ุนูู ุชุฎุฒูู ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูู ูููุงุช ุงูุชูููู ูู ุดูู ูุดูุฑ ูู ุงููุณุชูุฏุน.  ุณุชููู ูููุงุช ุงููุฑูุฑ ุงูุฎุงุตุฉ ุจู ุขููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุจุงุฎุชุตุงุฑ ุ ููููู ุงุณุชุฎุฏุงู ุงูููุชุงุญ ุงูุนุงู ูุชุดููุฑ ุงููุนูููุงุช ุงูุชู ุชุญุชุงุฌูุง ููุถุนูุง ุจูุซู ูุฐุง ุงูุฎุท ูู ููู hiera.  ูุชู ุชุฎุฒูู ุงูุฌุฒุก ุงูุฎุงุต ูู ุงูููุชุงุญ ุนูู ุณูุฏ pappet ุ ูุงูุฐู ูุณูุญ ูู ุจูู ุชุดููุฑ ูุฐู ุงูุจูุงูุงุช.  ูููู ุงูุนุซูุฑ ุนูู ูุฒูุฏ ูู ุงูุชูุงุตูู ูู ุตูุญุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุดุฑูุน</a> . </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุงูุนููู (ุงูููุจููุชุฑ ุงูุนุงูู) ุ ูุชู ุชุซุจูุช ุงูุฃุฏุงุฉ ุจุจุณุงุทุฉ ุจุงุณุชุฎุฏุงู <strong><code>gem install hiera-eyaml</code></strong> .  ุนูุงูุฉ ุนูู ุฐูู ุ ุจุงุณุชุฎุฏุงู ุฃูุฑ ุดูู <strong><code>eyaml encrypt --pkcs7-public-key=/path/to/public_key.pkcs7.pem -s 'hello'</code></strong> ููููู ุชุดููุฑ ุงูุจูุงูุงุช ููุตููุง ูู ููู ุจุงูููุญู eyaml ุฃู yaml ููุท ุ ุงุนุชูุงุฏูุง ุนูู ููููุฉ ุชูููู ุ ููู ุซู ุณูู pappet ูุนุฑูุฉ ุฐูู.  ุชุญุตู ุนูู ุดูุก ูุซู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">roles::postrgresql::<span class="hljs-symbol"><span class="hljs-symbol">password:</span></span> <span class="hljs-string"><span class="hljs-string">'ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAbIz1ihQlThMWa9T+Lq194Y6QdElMD1XTev5y+VPSHtkPTu6Al6TJaSrXF+7phJIjue+NF4ZVtJCLkHxUR6nJJqks0fcGS1vF2+6mmM9cy69sIU1A3HqpOHZLuqHAc7jUqljYxpwWSIGOK6I2FygdAp5FfOTewqfcVVmXj97EJdcv3DKrbAlSrIMO2iZRYwQvyv+qnptnZ7pilR2veOCPW2UMm6zagDLutX9Ft5vERbdaiCiEfTOpVa9Qx0GqveNRVJLV/5lfcL5ajdNBJXkvKqDbx8d3ZBtEVAAqeKlw0LqzScgmCbWQx2kUzukX5LSxbTpT0Th984Vp1sl7iPk7UTA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBCp5GcwidcEMA+0wjAMblkKgBCR/f9KGXUgLh3/Ok60OIT5]'</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃู ุณูุณูุฉ ูุชุนุฏุฏุฉ ุงูุฃุณุทุฑ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">roles::postgresql::password: &gt; ENC[<span class="hljs-type"><span class="hljs-type">PKCS7</span></span>,<span class="hljs-type"><span class="hljs-type">MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEw</span></span> <span class="hljs-type"><span class="hljs-type">DQYJKoZIhvcNAQEBBQAEggEAbIz1ihQlThMWa9T</span></span>+<span class="hljs-type"><span class="hljs-type">Lq194Y6QdElMD1XTev5y</span></span> +<span class="hljs-type"><span class="hljs-type">VPSHtkPTu6Al6TJaSrXF</span></span>+<span class="hljs-number"><span class="hljs-number">7</span></span><span class="hljs-type"><span class="hljs-type">phJIjue</span></span>+<span class="hljs-type"><span class="hljs-type">NF4ZVtJCLkHxUR6nJJqks0fcGS1vF</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>+<span class="hljs-number"><span class="hljs-number">6</span></span><span class="hljs-type"><span class="hljs-type">mmM9cy69sIU1A3HqpOHZLuqHAc7jUqljYxpwWSIGOK6I2FygdAp5FfOTe</span></span> <span class="hljs-type"><span class="hljs-type">wqfcVVmXj97EJdcv3DKrbAlSrIMO2iZRYwQvyv</span></span>+<span class="hljs-type"><span class="hljs-type">qnptnZ7pilR2veOCPW2UM</span></span> <span class="hljs-type"><span class="hljs-type">m6zagDLutX9Ft5vERbdaiCiEfTOpVa9Qx0GqveNRVJLV</span></span>/<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-type"><span class="hljs-type">lfcL5ajdNBJXkv</span></span> <span class="hljs-type"><span class="hljs-type">KqDbx8d3ZBtEVAAqeKlw0LqzScgmCbWQx2kUzukX5LSxbTpT0Th984Vp1sl7</span></span> <span class="hljs-type"><span class="hljs-type">iPk7UTA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBCp5GcwidcEMA</span></span>+<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-type"><span class="hljs-type">wjAM</span></span> <span class="hljs-type"><span class="hljs-type">blkKgBCR</span></span>/<span class="hljs-type"><span class="hljs-type">f9KGXUgLh3</span></span>/<span class="hljs-type"><span class="hljs-type">Ok60OIT5</span></span>]</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุจุฏู ุฃููุง ุงูุชูููุง ูู ุงูุชุญุถูุฑ ุ ุงูุขู ูููููุง ุฃู ูููุฑ ูู ูุซุงู. </p><br><h3 id="primer-na-palcah" style=";text-align:right;direction:rtl">  ูุซุงู ุงูุฅุตุจุน </h3><br><p style=";text-align:right;direction:rtl">  <strong>ุงูููุณุฏ</strong> : <em>ุณูููู</em> ููุงู <em>ุงูุนุฏูุฏ ูู ุงูุชููููุงุช ุ ูุฐูู ูููู ูุฃููุฆู ุงูููุชููู ุจูุฐู ุงูููุงูุฉ ุฐุงุช ุงูุฃูููุฉ ุงููุธุฑูุฉ ุงูุจุญุชุฉ ุชุฎุทู ูุฐุง ุงููุณู ูุงูุฐูุงุจ ุฅูู ุงูููุงูุฉ.</em> </p><br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ุงูุขู ูููู ูุธุฑุฉ ุนูู ูุซุงู ูููููุฉ ุชูููู ุฎุงุฏู ุจุงุณุชุฎุฏุงู hiera ูู ุฏููุฉ 4.  ูู ุฃูุดุฑ ุงูุฑูุฒ ูุฌููุน ุงููููุงุช ุงูุดุฎุตูุฉ ุ ูุฅูุง ูุณูููู ุงูููุดูุฑ ูุจูุฑูุง ุฌุฏูุง.  ุณุฃุฑูุฒ ุนูู ุงูุชุณูุณู ุงููุฑูู ูุชูููู ุงูุญูุฑุฉ. </p><br><p style=";text-align:right;direction:rtl">  <strong>ุงููููุฉ ูู:</strong> ูุญู ุจุญุงุฌุฉ ุฅูู ูุดุฑ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฎุงุฏูู db ูุชุทุงุจููู ูุชู ูุดุฑ postgresql ุนููููุง </li><li style=";text-align:right;direction:rtl">  ุฎุงุฏูุงู ุขุฎุฑุงู - ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ูุน nginx </li><li style=";text-align:right;direction:rtl">  ุงูุฎุงุฏู ุงูุฎุงูุณ ูุงูุณุงุฏุณ - backth python in docker </li><li style=";text-align:right;direction:rtl">  ูู ุดูุก ูู ููุณู ูู ุจูุฆุฉ ูุทูุฑ ุงูุจุฑุงูุฌ ุ ุจุงุณุชุซูุงุก ุจุนุถ ุฅุนุฏุงุฏุงุช ุงูุฎุงุฏู </li></ul><br><p style=";text-align:right;direction:rtl">  ุณููุดุฆ ุงูุชุณูุณู ุงููุฑูู ุงูุฎุงุต ุจูุง ุจุงูุชุฑุชูุจ ูุณูุจุฏุฃ ุจููู ุงููุดุฑูุน. </p><br><h4 id="proekt" style=";text-align:right;direction:rtl">  ุงููุดุฑูุน </h4><br><p style=";text-align:right;direction:rtl">  ูู <strong><code>projects/kicker.yaml</code></strong> ููู ุงููุดุฑูุน <strong><code>projects/kicker.yaml</code></strong> .  ูุถุน ููู ูุง ูู ูุดุชุฑู ุจูู ุฌููุน ุงูุฎูุงุฏู: ูุญุชุงุฌ ุฅูู ุจุนุถ ุงููุณุชูุฏุนุงุช ูุงููุฌูุฏุงุช ูููุดุฑ ุ ุจุงูุฅุถุงูุฉ ุฅูู ูุณุชุฎุฏู ุงููุดุฑ ููุณู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">--- <span class="hljs-symbol"><span class="hljs-symbol">classes:</span></span> - apt::debian::semrush <span class="hljs-symbol"><span class="hljs-symbol">files:</span></span> <span class="hljs-string"><span class="hljs-string">"/srv/data"</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">ensure:</span></span> <span class="hljs-string"><span class="hljs-string">'directory'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">owner:</span></span> <span class="hljs-string"><span class="hljs-string">'deploy'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">group:</span></span> <span class="hljs-string"><span class="hljs-string">'www-data'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">mode:</span></span> <span class="hljs-string"><span class="hljs-string">'0755'</span></span> <span class="hljs-string"><span class="hljs-string">'/srv/data/shared_temp'</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">ensure:</span></span> <span class="hljs-string"><span class="hljs-string">'directory'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">owner:</span></span> <span class="hljs-string"><span class="hljs-string">'deploy'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">group:</span></span> <span class="hljs-string"><span class="hljs-string">'www-data'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">mode:</span></span> <span class="hljs-string"><span class="hljs-string">'0775'</span></span> user_management::<span class="hljs-symbol"><span class="hljs-symbol">present:</span></span> - deploy</code> </pre> <br><h4 id="rol-db" style=";text-align:right;direction:rtl">  ุฏูุฑ ุฏูุณูุจู </h4><br><p style=";text-align:right;direction:rtl">  ุฅูุดุงุก ููู ุฏูุฑ <strong><code>projects/kicker/db.yaml</code></strong> ูุงุนุฏุฉ ุจูุงูุงุช <strong><code>projects/kicker/db.yaml</code></strong> .  ุญุชู ุงูุขู ุ ุณููุนู ุฐูู ุฏูู ุชูุณูู ุงูุฎูุงุฏู ุฅูู ุจูุฆุงุช: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">--- <span class="hljs-symbol"><span class="hljs-symbol">classes:</span></span> - profiles::db::postgresql profiles::db::postgresql::<span class="hljs-symbol"><span class="hljs-symbol">globals:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">manage_package_repo:</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-symbol"><span class="hljs-symbol">version:</span></span> <span class="hljs-string"><span class="hljs-string">'10'</span></span> profiles::db::postgresql::<span class="hljs-symbol"><span class="hljs-symbol">db_configs:</span></span> <span class="hljs-string"><span class="hljs-string">'listen_addresses'</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">value:</span></span> <span class="hljs-string"><span class="hljs-string">'*'</span></span> profiles::db::postgresql::<span class="hljs-symbol"><span class="hljs-symbol">databases:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">kicker:</span></span> {} profiles::db::postgresql::<span class="hljs-symbol"><span class="hljs-symbol">hba_rules:</span></span> <span class="hljs-string"><span class="hljs-string">'local connect to kicker'</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">type:</span></span> <span class="hljs-string"><span class="hljs-string">'local'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">database:</span></span> <span class="hljs-string"><span class="hljs-string">'kicker'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">user:</span></span> <span class="hljs-string"><span class="hljs-string">'kicker'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">auth_method:</span></span> <span class="hljs-string"><span class="hljs-string">'md5'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">order:</span></span> <span class="hljs-string"><span class="hljs-string">'001'</span></span> <span class="hljs-string"><span class="hljs-string">'allow connect from 192.168.1.100'</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">type:</span></span> <span class="hljs-string"><span class="hljs-string">'host'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">database:</span></span> <span class="hljs-string"><span class="hljs-string">'kicker'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">user:</span></span> <span class="hljs-string"><span class="hljs-string">'kicker'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">auth_method:</span></span> <span class="hljs-string"><span class="hljs-string">'md5'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">address:</span></span> <span class="hljs-string"><span class="hljs-string">'192.168.1.100/32'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">order:</span></span> <span class="hljs-string"><span class="hljs-string">'002'</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููู ููุง ุจุชูุตูู ููู ุชุนุฑูู ูุงุญุฏ ููุชูุจ ููุงุณุชุฎุฏุงู ุงูุนุงู ูู ูุจู ูู ูู ูุฑูุฏ ุชุซุจูุช postgres ุนูู ุฎุงุฏููู.  ุงูููู ุงูุดุฎุตู ูุงุจู ููุชููุฆุฉ ููุณูุญ ูู ุจุชููุฆุฉ ุงููุญุฏุฉ ุจูุฑููุฉ ูุจู ุชุทุจูููุง. </p><br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ุฅูู ุงูุฃูุซุฑ ูุถูููุง ุ ุฃุณูู ุฑูุฒ ุงููุท ููุฐุง ุงูููู ุงูุดุฎุตู: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูููู ุงูุดุฎุตู :: ุฏูุณูุจู :: postgresql</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="hljs mel">class profiles::db::postgresql ( Hash $globals = {}, Hash $params = {}, Hash $recovery = {}, Hash[String, Hash[String, Variant[String, Boolean, Integer]]] $roles = {}, Hash[String, Hash[String, Variant[String, Boolean]]] $db_configs = {}, Hash[String, Hash[String, Variant[String, Boolean]]] $databases = {}, Hash[String, String] $db_grants = {}, Hash[String, Hash[String, String]] $extensions = {}, Hash[String, String] $table_grants = {}, Hash[String, Hash[String, String]] $hba_rules = {}, Hash[String, String] $indent_rules = {}, Optional[String] $role = undef, # <span class="hljs-string"><span class="hljs-string">'master'</span></span>, <span class="hljs-string"><span class="hljs-string">'slave'</span></span> Optional[String] $master_host = undef, Optional[String] $replication_password = undef, Integer $master_port = <span class="hljs-number"><span class="hljs-number">5432</span></span>, String $replication_user = <span class="hljs-string"><span class="hljs-string">'repl'</span></span>, String $trigger_file = <span class="hljs-string"><span class="hljs-string">'/tmp/pg_trigger.file'</span></span>, ){ <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> $role { <span class="hljs-string"><span class="hljs-string">'slave'</span></span>: { $_params = { manage_recovery_conf =&gt; true, } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $globals[<span class="hljs-string"><span class="hljs-string">'datadir'</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> { <span class="hljs-string"><span class="hljs-string">"${globals['datadir']}/recovery.done"</span></span>: ensure =&gt; absent, } } $_recovery = { <span class="hljs-string"><span class="hljs-string">'recovery config'</span></span> =&gt; { standby_mode =&gt; <span class="hljs-string"><span class="hljs-string">'on'</span></span>, primary_conninfo =&gt; <span class="hljs-string"><span class="hljs-string">"host=${master_host} port=${master_port} user=${replication_user} password=${replication_password}"</span></span>, trigger_file =&gt; $trigger_file, } } $_conf = { <span class="hljs-string"><span class="hljs-string">'hot_standby'</span></span> =&gt; { value =&gt; <span class="hljs-string"><span class="hljs-string">'on'</span></span>, }, } <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> { $trigger_file: ensure =&gt; absent, } } <span class="hljs-string"><span class="hljs-string">'master'</span></span>: { $_conf = { <span class="hljs-string"><span class="hljs-string">'wal_level'</span></span> =&gt; { value =&gt; <span class="hljs-string"><span class="hljs-string">'replica'</span></span>, }, <span class="hljs-string"><span class="hljs-string">'max_wal_senders'</span></span> =&gt; { value =&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>, }, <span class="hljs-string"><span class="hljs-string">'wal_keep_segments'</span></span> =&gt; { value =&gt; <span class="hljs-number"><span class="hljs-number">32</span></span>, }, } <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> { $trigger_file: ensure =&gt; present, } } <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: { $_params = {} $_recovery = {} $_conf = {} } } class { <span class="hljs-string"><span class="hljs-string">'::postgresql::globals'</span></span>: * =&gt; $globals, } class { <span class="hljs-string"><span class="hljs-string">'::postgresql::server'</span></span>: * =&gt; deep_merge($_params, $params), } create_resources(<span class="hljs-string"><span class="hljs-string">'::postgresql::server::config_entry'</span></span>, deep_merge($_conf, $db_configs)) create_resources(<span class="hljs-string"><span class="hljs-string">'::postgresql::server::role'</span></span>, $roles) create_resources(<span class="hljs-string"><span class="hljs-string">'::postgresql::server::database'</span></span>, $databases) create_resources(<span class="hljs-string"><span class="hljs-string">'::postgresql::server::database_grant'</span></span>, $db_grants) create_resources(<span class="hljs-string"><span class="hljs-string">'::postgresql::server::extension'</span></span>, $extensions) create_resources(<span class="hljs-string"><span class="hljs-string">'::postgresql::server::table_grant'</span></span>, $table_grants) create_resources(<span class="hljs-string"><span class="hljs-string">'::postgresql::server::pg_hba_rule'</span></span>, $hba_rules) create_resources(<span class="hljs-string"><span class="hljs-string">'::postgresql::server::pg_indent_rule'</span></span>, $indent_rules) create_resources(<span class="hljs-string"><span class="hljs-string">'::postgresql::server::recovery'</span></span>, deep_merge($_recovery, $recovery)) }</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุจุงูุชุงูู ุ ูููู ุจุชุซุจูุช <code>Postgresql 10</code> ุถุฑุจุฉ ูุงุญุฏุฉ ุ ูุชูููู ุงูุชูููู ( <code>listen</code> ) ุ ูุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช <code>kicker</code> ุ ููุฐูู ูุชุงุจุฉ ูุงุนุฏุชูู ูููุตูู ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฐู ูู <code>pg_hba.conf</code> .  ุฑุงุฆุน! </p><br><h4 id="rol-frontend" style=";text-align:right;direction:rtl">  ุฏูุฑ ุงููุงุฌูุฉ </h4><br><p style=";text-align:right;direction:rtl">  ูุชุฎุฐ <code>frontend</code> .  ูู <strong><code>projects/kicker/frontend.yaml</code></strong> ููู <strong><code>projects/kicker/frontend.yaml</code></strong> ุจุงููุญุชููุงุช ุงูุชุงููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">--- <span class="hljs-symbol"><span class="hljs-symbol">classes:</span></span> - profiles::webserver::nginx profiles::webserver::nginx::<span class="hljs-symbol"><span class="hljs-symbol">servers:</span></span> <span class="hljs-string"><span class="hljs-string">'kicker.semrush.com'</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">use_default_location:</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-symbol"><span class="hljs-symbol">listen_port:</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-symbol"><span class="hljs-symbol">server_name:</span></span> - <span class="hljs-string"><span class="hljs-string">'kicker.semrush.com'</span></span> profiles::webserver::nginx::<span class="hljs-symbol"><span class="hljs-symbol">locations:</span></span> <span class="hljs-string"><span class="hljs-string">'kicker-root'</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">location:</span></span> <span class="hljs-string"><span class="hljs-string">'/'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">server:</span></span> <span class="hljs-string"><span class="hljs-string">'kicker.semrush.com'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">proxy:</span></span> <span class="hljs-string"><span class="hljs-string">'http://kicker-backend.semrush.com:8080'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">proxy_set_header:</span></span> - <span class="hljs-string"><span class="hljs-string">'X-Real-IP $remote_addr'</span></span> - <span class="hljs-string"><span class="hljs-string">'X-Forwarded-for $remote_addr'</span></span> - <span class="hljs-string"><span class="hljs-string">'Host kicker.semrush.com'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">location_cfg_append:</span></span> <span class="hljs-string"><span class="hljs-string">'proxy_next_upstream'</span></span>: <span class="hljs-string"><span class="hljs-string">'error timeout invalid_header http_500 http_502 http_503 http_504'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">proxy_connect_timeout:</span></span> <span class="hljs-string"><span class="hljs-string">'5'</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุดูุก ุจุณูุท ููุง.  ูููู ุจุชูุตูู <strong><code>profiles::webserver::nginx</code></strong> ุงูุดุฎุตูุฉ ุ ุงูุชู ุชุนุฏ ุงูุฏุฎูู ุฅูู ูุญุฏุฉ nginx ุ ููุง ูุญุฏุฏ ุงููุชุบูุฑุงุช ุ ูุชุญุฏูุฏูุง <code>server</code> <code>location</code> ููุฐุง ุงููููุน. </p><br><p style=";text-align:right;direction:rtl">  ุณููุงุญุธ ุงููุงุฑุฆ ุงูููุธ ุฃูู ุณูููู ูู ุงูุฃูุณุจ ูุถุน ูุตู ุงููููุน ุฃุนูู ูู ุงูุชุณูุณู ุงููุฑูู ุ ูุฃูู ูุง ูุฒุงู ูุฏููุง ุจูุฆุฉ <code>server_name</code> ุ ูุณูุชู ุงุณุชุฎุฏุงู ุงููุชุบูุฑุงุช ุงูุฃุฎุฑู ( <code>server_name</code> <code>proxy</code> ุ <code>proxy</code> ) ุ ูููู ูุฐุง ููุณ ููููุง ุฌุฏูุง.  ููุตู ุงูุฏูุฑ ุจูุฐู ุงูุทุฑููุฉ ุ ูููููุง ุฃู ูุฑู ููู ูุชู ุฅุนุงุฏุฉ ุชุนุฑูู ูุฐู ุงููุชุบูุฑุงุช ููุท ูู ุฎูุงู ุงูุชุณูุณู ุงููุฑูู. </p><br><h4 id="rol-docker" style=";text-align:right;direction:rtl">  ุฏูุฑ ุนุงูู ุงููููุงุก </h4><br><p style=";text-align:right;direction:rtl">  ุฏูุฑ <strong><code>projects/kicker/docker.yaml</code></strong> <code>docker</code> <strong><code>projects/kicker/docker.yaml</code></strong> </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">--- <span class="hljs-symbol"><span class="hljs-symbol">classes:</span></span> - profiles::docker profiles::docker::<span class="hljs-symbol"><span class="hljs-symbol">params:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">version:</span></span> <span class="hljs-string"><span class="hljs-string">'17.05.0~ce-0~debian-stretch'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">packages:</span></span> <span class="hljs-string"><span class="hljs-string">'python3-pip'</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">provider:</span></span> apt <span class="hljs-string"><span class="hljs-string">'Fabric3'</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">provider:</span></span> pip3 <span class="hljs-symbol"><span class="hljs-symbol">ensure:</span></span> <span class="hljs-number"><span class="hljs-number">1.12</span></span>.post1 user_management::<span class="hljs-symbol"><span class="hljs-symbol">users:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">deploy:</span></span> <span class="hljs-symbol"><span class="hljs-symbol">groups:</span></span> - docker</code> </pre> <br><p style=";text-align:right;direction:rtl">  <strong><code>profiles/docker.pp</code></strong> ุจุณูุท ููุบุงูุฉ ูุฃููู.  ุณุฃูุฏู ุฑูุฒู: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูููู ุงูุดุฎุตู :: ุนุงูู ุงููููุงุก</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">profiles</span></span></span><span class="hljs-class">:</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">:docker </span></span></span></span>( Hash $params = {}, <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> $install_kernel = <span class="hljs-literal"><span class="hljs-literal">false</span></span>, ){ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-string"><span class="hljs-string">'docker'</span></span>: * =&gt; $params, } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($install_kernel) { include profiles::docker::kernel } }</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูู ุดูุก ุฌุงูุฒ.  ูุฐุง ูููู ุจุงููุนู ููุดุฑ ุงูููุชุฌ ุงูุฐู ูุญุชุงุฌู ุนูู ุงูุนุฏูุฏ ูู ุงูุฎูุงุฏู ุ ุจุจุณุงุทุฉ ุชุนููู ูุดุฑูุน ูุฏูุฑ ูุนูู ููู (ุนูู ุณุจูู ุงููุซุงู ุ ูุถุน ุงูููู ุจุงูุชูุณูู ุงููุทููุจ ูู ุฏููู facts.d ุ ูุงูุฐู ูุนุชูุฏ ูููุนู ุนูู ุทุฑููุฉ ุชุซุจูุช ุงูุนููู). </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูุฏููุง ูููู ุงูููู ุงูุชุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">. โโโ kicker โ โโโ db.yaml โ โโโ docker.yaml โ โโโ frontend.yaml โโโ kicker.yaml 1 directory, 4 files</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุณูุชุนุงูู ุงูุขู ูุน ุงูุจูุฆุงุช ูุชุนุฑูู ุงูุชููุฆุฉ ุงููุฑูุฏุฉ ูุฏูุฑ ุนูู ูููุน ูุนูู. </p><br><h4 id="okruzheniya-i-override" style=";text-align:right;direction:rtl">  ุงูุจูุฆุฉ ูุชุฌุงูุฒ </h4><br><p style=";text-align:right;direction:rtl">  ูููู ุจุฅูุดุงุก ุงูุชูููู ุงูุนุงู ูุฌููุน ุงููุจูุนุงุช.  ูุญุชูู ููู <strong><code>projects/kicker/tiers/prod.yaml</code></strong> ุนูู ุฅุดุงุฑุฉ ุฅูู ุฃููุง ุจุญุงุฌุฉ ุฅูู ุชูุตูู ูุฆุฉ ุจุฌุฏุงุฑ ุญูุงูุฉ ุจูุฐู ุงูุจูุฆุฉ (ุญุณููุง ุ ูู ููุณ ุงูุดูุก) ุ ุจุงูุฅุถุงูุฉ ุฅูู ูุฆุฉ ูุนููุฉ ุชููุฑ ูุณุชูู ุฃุนูู ูู ุงูุฃูุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-comment"><span class="hljs-comment">--- classes: - semrush_firewall - strict_security_level</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ูุจูุฆุฉ ุงูุชุทููุฑ ุ ุฅุฐุง ููุง ุจุญุงุฌุฉ ุฅูู ูุตู ุดูุก ูุญุฏุฏ ุ ูุชู ุฅูุดุงุก ููุณ ุงูููู ููุชู ุฅุฏุฎุงู ุงูุชูููู ุงูุถุฑูุฑู ููู. </p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ูุง ุฒูุช ุจุญุงุฌุฉ ุฅูู ุฅุนุงุฏุฉ ุชุนุฑูู ุงููุชุบูุฑุงุช ูุชูููู nginx ูุฏูุฑ <code>frontend</code> ูู ุจูุฆุฉ ุงูุชุทููุฑ.  ููููุงู ุจุฐูู ุ ุชุญุชุงุฌ ุฅูู ุฅูุดุงุก ููู <strong><code>projects/kicker/tiers/dev/frontend.yaml</code></strong> .  ุงูุชุจู ุฅูู ูุณุชูู ุฌุฏูุฏ ูู ุงูุชุณูุณู ุงููุฑูู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">--- profiles::webserver::nginx::<span class="hljs-symbol"><span class="hljs-symbol">servers:</span></span> <span class="hljs-string"><span class="hljs-string">'kicker-dev.semrush.com'</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">use_default_location:</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-symbol"><span class="hljs-symbol">listen_port:</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-symbol"><span class="hljs-symbol">server_name:</span></span> - <span class="hljs-string"><span class="hljs-string">'kicker-dev.semrush.com'</span></span> profiles::webserver::nginx::<span class="hljs-symbol"><span class="hljs-symbol">locations:</span></span> <span class="hljs-string"><span class="hljs-string">'kicker-root'</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">location:</span></span> <span class="hljs-string"><span class="hljs-string">'/'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">server:</span></span> <span class="hljs-string"><span class="hljs-string">'kicker-dev.semrush.com'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">proxy:</span></span> <span class="hljs-string"><span class="hljs-string">'http://kicker-backend-dev.semrush.com:8080'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">proxy_set_header:</span></span> - <span class="hljs-string"><span class="hljs-string">'X-Real-IP $remote_addr'</span></span> - <span class="hljs-string"><span class="hljs-string">'X-Forwarded-for $remote_addr'</span></span> - <span class="hljs-string"><span class="hljs-string">'Host kicker-dev.semrush.com'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">location_cfg_append:</span></span> <span class="hljs-string"><span class="hljs-string">'proxy_next_upstream'</span></span>: <span class="hljs-string"><span class="hljs-string">'error timeout invalid_header http_500 http_502 http_503 http_504'</span></span> <span class="hljs-symbol"><span class="hljs-symbol">proxy_connect_timeout:</span></span> <span class="hljs-string"><span class="hljs-string">'5'</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุชุนุฏ ุจุญุงุฌุฉ ุฅูู ุชุญุฏูุฏ ูุฆุฉ ุ ููู ููุฑูุซุฉ ูู ุงููุณุชููุงุช ุงูุณุงุจูุฉ ููุชุณูุณู ุงููุฑูู.  ููุง ูููุง ุจุชุบููุฑ <code>server_name</code> <code>proxy_pass</code> ู <code>proxy_pass</code> .  ุงูุฎุงุฏู ุงูุฐู ูู ุฏูุฑ ุงูุญูุงุฆู = frontend ู tier = dev ุณูุฌุฏ ุฃููุงู ููู <strong><code>projects/kicker/frontend.yaml</code></strong> ูููุณู ุ ูููู ุจุนุฏ ุฐูู ุณูุชู ุชุฌุงูุฒ ุงููุชุบูุฑุงุช ูู ูุฐุง ุงูููู ุจููู <strong><code>projects/kicker/tiers/dev/frontend.yaml</code></strong> ุจุฃููููุฉ ุฃุนูู . </p><br><h4 id="sokrytie-parolya-dlya-postgresql" style=";text-align:right;direction:rtl">  ุฅุฎูุงุก ูููุฉ ุงููุฑูุฑ ูู PostgreSQL </h4><br><p style=";text-align:right;direction:rtl">  ูููุฐุง ูุฏููุง ุงูุจูุฏ ุงูุฃุฎูุฑ ูู ุฌุฏูู ุงูุฃุนูุงู - ุชุนููู ูููุงุช ุงููุฑูุฑ ูู PostgreSQL. </p><br><p style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ุชุฎุชูู ูููุงุช ุงููุฑูุฑ ูู ุงูุจูุฆุงุช.  ุณูุณุชุฎุฏู Eyaml ูุชุฎุฒูู ูููุงุช ุงููุฑูุฑ ุจุดูู ุขูู.  ุฅูุดุงุก ูููุงุช ุงููุฑูุฑ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">eyaml encrypt -s <span class="hljs-string"><span class="hljs-string">'verysecretpassword'</span></span> eyaml encrypt -s <span class="hljs-string"><span class="hljs-string">'testpassword'</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููู ุจูุตู ุงูุฎุทูุท ุงููุงุชุฌุฉ ูู ุงููููุงุช <code>**projects/kicker/tiers/prod/db.yaml**</code> ู <code>**projects/kicker/tiers/prod/db.yaml**</code> <code>**projects/kicker/tiers/dev/db.yaml**</code> (ุฃู ููููู ุงุณุชุฎุฏุงู ุงูุชุฏุงุฏ eyaml ุ ูุฐุง ูุงุจู ููุชุฎุตูุต) ุ ุนูู ุงูุชูุงูู.  ููุง ูุซุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">--- profiles::db::postgresql::<span class="hljs-symbol"><span class="hljs-symbol">roles:</span></span> <span class="hljs-string"><span class="hljs-string">'kicker'</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">password_hash:</span></span> &gt; <span class="hljs-string"><span class="hljs-string">'ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAsdpb2P0axUJzyWr2duRKAjh0WooGYUmoQ5gw0nO9Ym5ftv6uZXv25DRMKh7vsbzrrOR5/lLesx/pAVmcs2qbhd/y0Vr1oc2ohHlZBBKtCSEYwem5VN+kTMhWPvlt93x/S9ERoBp8LrrsIvicSYZByNfpS2DXCFbogSXCfEPxTTmCOtlOnxdjidIc9Q1vfAXv7FRQanYIspr2UytScm56H/ueeAc/8RYK51/nXDMtdPOiAP5VARioUKyTDSk8FqNvdUZRqA3cl+hA+xD5PiBHn5T09pnH8HyE/39q09gE0pXRe5+mOnU/4qfqFPc/EvAgAq5mVawlCR6c/cCKln5wJTA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBDNKijGHBLPCth0sfwAjfl/gBAaPsfvzZQ/Umgjy1n+im0s]'</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ุณุชุฃุชู ูููุฉ ูุฑูุฑ ุฏูุฑ <code>kicker</code> ุ ูุณูุชู ูู ุชุดููุฑูุง ูุชุทุจูููุง ุนูู ุฎุงุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู PostgreSQL. </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ุ ูู ุงููุงูุน ุ ูู ุดูุก.  ูุนู ุ ุงุชุถุญ ุฃู ุงููุซุงู ุถุฎู ุ ูููู ุขูู ุฃู ูููู ุนููููุง ุ ูุง ูุชุฑู ุฃุณุฆูุฉ ุ ูุงุถุญุฉ ููููุฏุฉ.  ุงูุชุณูุณู ุงููุฑูู ุงููุงุชุฌ ูู ุงูุญูุฑุฉ ูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">. โโโ db.yaml โโโ docker.yaml โโโ frontend.yaml โโโ tiers โโโ dev โ โโโ db.yaml โ โโโ frontend.yaml โโโ prod โ โโโ db.yaml โโโ prod.yaml 3 directories, 7 files</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููููู ูุดุงูุฏุฉ ูุฐู ุงููููุงุช ูุจุงุดุฑุฉ ุนู ุทุฑูู ุงุณุชูุณุงุฎ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุณุชูุฏุน</a> ุชู ุฅูุดุงุคู ุฎุตูุตูุง </p><br><h3 id="zaklyuchenie" style=";text-align:right;direction:rtl">  ุงูุฎูุงุตุฉ </h3><br><p style=";text-align:right;direction:rtl">  ุฏููุฉ ุฌูุฏุฉ ูุณููุฉ ุงูุงุณุชุฎุฏุงู ูุน ููุฑุง.  ูู ุฃุณูููุง ุฃุฏุงุฉ ุชูููู ูุซุงููุฉ ูู ุงูุนุงูู ุงูุญุฏูุซ ุ ุนูู ุงูุฅุทูุงู ุ ูููููุง ุชุณุชุญู ุงูุงูุชูุงู.  ูุชุนุงูู ูุน ุจุนุถ ุงูููุงู ุจุดูู ุฌูุฏ ููุบุงูุฉ ุ ู "ููุณูุชู" ูู ุงูุญูุงุธ ุนูู ุญุงูุฉ ูุชุทุงุจูุฉ ุจุงุณุชูุฑุงุฑ ูู ุงูููุงุฑุฏ ูุงูุชูููู ูููู ุฃู ุชูุนุจ ุฏูุฑูุง ููููุง ูู ุถูุงู ุฃูุงู ูุงุชุณุงู ุงูุชููููุงุช. </p><br><p style=";text-align:right;direction:rtl">  ูุชุนุงูู ุงูุนุงูู ุงูุญุฏูุซ ููุชุทูุฑ ุชุฏุฑูุฌูุงู.  ูููู ูู ุงููุงุณ ูุณุชุฎุฏููู ุงูุขู ูุธุงู ุชูููู ูุงุญุฏูุง ููุท ุ ูุบุงูุจูุง ูุง ูููู ูู ุชุฑุณุงูุฉ ุงูุฃุฌูุฒุฉ ูุงููุฏูุฑูู ุงูุนุฏูุฏ ูู ุงูุฃูุธูุฉ ูู ููุช ูุงุญุฏ.  ููุฐุง ุฃูุฑ ุฌูุฏ ุ ูุฃู ููุงู ุงููุซูุฑ ููุงุฎุชูุงุฑ ูู ุจูููุง.  ุงูุดูุก ุงูุฑุฆูุณู ูู ุฃู ูู ุดูุก ูุฌุจ ุฃู ูููู ููุทูููุง ูููููููุง ุ ูููู ูุฃูู ูููู ุชููููู. </p><br><p style=";text-align:right;direction:rtl">  ูุชูุฌุฉ ูุฐูู ุ ูุฏููุง ููุณุคูููู ูู ุชูููู ุฃู ุดูุก ุจุฃููุณูุง.  ูู ูุฐุง ูุฌุจ ุฃู ูุชู ุจุดูู ูุซุงูู ูู ูุจู ุงููุฑู ููุณูุง.  ููุฌุจ ุฃู ูููุญูู ุฃุฏุงุฉ ุฃู ููุชุฌูุง ูุชูุญ ููุง ุงูููุงู ุจุฐูู ุจุฃูุงู ูุณูููุฉ ูุฃูู ูู ุฐูู ุ ูุน ูุชูุฌุฉ ุฏูููุฉ.  ุญุณููุง ุ ูุงููุณุงุนุฏุฉ ูู ุญู ุงููุดููุงุช ุงููุนูุงุฑูุฉ ูุงูุฃูุซุฑ ุฎุทูุฑุฉ ูู "ุชุญุชุงุฌ ุฅูู ุชุซุจูุช PostgreSQL ุนูู ุงูุฎุงุฏู ูุฅูุดุงุก ูุณุชุฎุฏู".  ูุงููู ุ 2018 ูู ุงูููุงุก! <del>  ูุฐุง ูู ุจุฑูู ุงูุนุฑุงุฆุณ ูุงูุฃูู ูุงูุชูู ุฅูู ุงููุณุชูุจู ุจุฏูู ุฎุงุฏู. </del></p><br><p style=";text-align:right;direction:rtl">  ูุน ุชุทูุฑ ุฃูุธูุฉ ุงูุณุญุจ ูุชูุธูู ุงูุญุงููุงุช ูุชูุธูู ุงูุญุงููุงุช ุ ุชุชุฑุงุฌุน ุฃูุธูุฉ ุฅุฏุงุฑุฉ ุงูุชูููู ุจุจุทุก ูู ุงูุฎูููุฉ ูููุณุชุฎุฏููู ูุงูุนููุงุก.  ููููู ุฃูุถูุง ุฑูุน ูุฌููุนุฉ ูู ุงูุญุงููุงุช ุงูุขููุฉ ูู ุงููุดู ูู ุงูุณุญุงุจุฉ ูุงูุงุญุชูุงุธ ุจุชุทุจููุงุชู ูู ุญุงููุงุช ูุน ุงูุชุนุฑูุฉ ุงูุชููุงุฆูุฉ ูุงููุณุฎ ุงูุงุญุชูุงุทู ูุงููุณุฎ ูุงูุงูุชุดุงู ุงูุชููุงุฆู ุ ููุง ุฅูู ุฐูู ุ ุฏูู ูุชุงุจุฉ ุณุทุฑ ูุงุญุฏ ูู ansible ุ ุฏููุฉ ุ ุทุงู ุ ุฅูุฎ.  ูุณุช ูุถุทุฑูุง ูุฑุนุงูุฉ ุฃู ุดูุก (ุญุณููุง ุ ุชูุฑูุจูุง).  ูู ูุงุญูุฉ ุฃุฎุฑู ุ ููุงู ุนุฏุฏ ุฃูู ูู ุฎูุงุฏู ุงูุญุฏูุฏ ุจุณุจุจ ุงูุณุญุจ.  ูู ูุง ูู ุงูุฃูุฑ ุฃูู ูู ุชุนุฏ ุจุญุงุฌุฉ ุฅูู ุชููุฆุชูุง ุ ูุฅู ูุฐุง ุงูุฅุฌุฑุงุก ูู ูุณุคูููุฉ ูุฒูุฏ ุงูุฎุฏูุฉ ุงูุณุญุงุจูุฉ.  ููู ูู ุบูุฑ ุงููุฑุฌุญ ุฃู ูุณุชุฎุฏููุง ููุณ ุงูุฃูุธูุฉ ุงูุชู ูุณุชุฎุฏููุง ุงูุจุดุฑ ุงูุนุงุฏููู. </p><br><h4 id="credits" style=";text-align:right;direction:rtl">  ุงุฆุชูุงูุงุช </h4><br><p style=";text-align:right;direction:rtl">  ุดูุฑุง: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฏููุชุฑู ุชูุจูุชุณูู ุ ุฏููุชุฑู ููุฌูููู ุ ุณุชูุจุงู ููุฏูุฑูู ูุงููุฑูู ุจุฃูููู ูู ูุณุคููู ุงููุธุงู ููุณุงุนุฏุชูู ูู ุฅุนุฏุงุฏ ูุฐู ุงูููุงูุฉ </li><li style=";text-align:right;direction:rtl">  ููุงุฏูููุฑ ููุฌููุณุชูุจูู ููุตูุฑุฉ </li><li style=";text-align:right;direction:rtl">  ูุงูุง ุชุงุจุงูููุง ูุชูุธูู ูู ูุฐุง ูุงููุณุงุนุฏุฉ ูู ุงุฌุชูุงุฒ ุฌููุน ูุฑุงุญู ูุง ูุจู ุงููุดุฑ </li><li style=";text-align:right;direction:rtl">  ููููุชุง ุฒุงุฎุงุฑูู ูููุณุงุนุฏุฉ ูู ูุณุงุฆู ุงูุชุฑุฎูุต </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar412587/">https://habr.com/ru/post/ar412587/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar412573/index.html">ูุง ูู ุงูุฎุทุฃ ูู Geektimes ุงูุนูุฏุฉ ุฅูู ูุจุฑ</a></li>
<li><a href="../ar412575/index.html">ูู ูู ุนุงู ุ ุชุตุจุญ ููุณููู ุงูุจูุจ โโุฑุชูุจุฉ ุฃูุซุฑ ูุฃูุซุฑ ุ ูุฃู ููุณ ุงูุฃุดุฎุงุต ูุคูููููุง</a></li>
<li><a href="../ar412579/index.html">Marvel: Infinity War ุฃู ููููุฉ ุฌูุน ุงูุจูุงูุงุช ููุดุฑูุนู ูู ุจุถุน ุฏูุงุฆู</a></li>
<li><a href="../ar412581/index.html">ูู ุงูุนุตุฑ ุงูุญุฌุฑู ุฅูู ุงูุญุฑุจ ุงูุนุงูููุฉ ุงูุซุงููุฉ: ููู ูุชู ุงุณุชุฎุฏุงู ุงูุฑูุจูุชุงุช ููุจุญุซ ุนู ุงููุทุน ุงูุฃุซุฑูุฉ ุงูุชุงุฑูุฎูุฉ</a></li>
<li><a href="../ar412583/index.html">ูููู ุจุชูููู ุจุฑูุชูููู ุบูุงูุฉ Redmond G200S ูุชูุตููู ุจู HomeAssistant</a></li>
<li><a href="../ar412589/index.html">25 ููุชุจุฉ ุฃูุฏุฑููุฏ ูุณููุฉ. ุฑุจูุน 2018</a></li>
<li><a href="../ar412591/index.html">ุจูุงุก jetpack: 29 ูุงูู ูู ููู ูููุฏู ููุฑ ุงูุชุฐูุงุฑู</a></li>
<li><a href="../ar412593/index.html">ุงูููุชุฌุงุช ุงูุฌุฏูุฏุฉ ูุงูููุตุงุช ูุฌููุน ุงูุฎุฏูุงุช: HPE Webinars</a></li>
<li><a href="../ar412595/index.html">ุชูุฑูุฑ ูุงุฏู ุฑููุง 2018 ุ ุงููุตู 1.1.2: "ุงูุชูููู"</a></li>
<li><a href="../ar412597/index.html">ุณูููู ุฌูู ุจูุฒูุณ ุจุจูุงุก ูุณุชุนูุฑุฉ ุนูู ุณุทุญ ุงูููุฑ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>