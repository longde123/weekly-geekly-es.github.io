<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŒ¶ï¸ ğŸŒ¬ï¸ ğŸ‘ ç¼–ç¨‹ç†è®ºï¼šå˜ä½“ ğŸ›… ğŸ§’ ğŸ¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æ‚¨å¥½ï¼Œæˆ‘å«Dmitry Karlovskyï¼Œæˆ‘...æƒ³å‘Šè¯‰æ‚¨ç±»å‹ç³»ç»Ÿçš„åŸºæœ¬ç‰¹æ€§ï¼Œè¿™ç§ç±»å‹ç‰¹æ€§é€šå¸¸æ˜¯æˆ–æ ¹æœ¬ä¸è¢«ç†è§£ï¼Œæˆ–è€…ç”±äºç‰¹å®šè¯­è¨€çš„å®ç°è€Œè¢«è¯¯è§£äº†ï¼Œç”±äºå‘å±•çš„æ¼”å˜ï¼Œè¯¥è¯­è¨€å…·æœ‰è®¸å¤šç¼ºé™·ã€‚ å› æ­¤ï¼Œå³ä½¿æ‚¨è®¤ä¸ºè‡ªå·±çŸ¥é“ä»€ä¹ˆæ˜¯â€œå˜å¼‚â€ï¼Œä¹Ÿè¯·å°è¯•ä»¥å…¨æ–°çš„æ–¹å¼çœ‹å¾…é—®é¢˜ã€‚ æˆ‘ä»¬å°†ä»æœ€åŸºç¡€çš„å†…å®¹å…¥æ‰‹ï¼Œå› æ­¤å³ä½¿æ˜¯åˆå­¦è€…...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ç¼–ç¨‹ç†è®ºï¼šå˜ä½“</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477448/"><p>æ‚¨å¥½ï¼Œæˆ‘å«Dmitry Karlovskyï¼Œæˆ‘...æƒ³å‘Šè¯‰æ‚¨ç±»å‹ç³»ç»Ÿçš„åŸºæœ¬ç‰¹æ€§ï¼Œè¿™ç§ç±»å‹ç‰¹æ€§é€šå¸¸æ˜¯æˆ–æ ¹æœ¬ä¸è¢«ç†è§£ï¼Œæˆ–è€…ç”±äºç‰¹å®šè¯­è¨€çš„å®ç°è€Œè¢«è¯¯è§£äº†ï¼Œç”±äºå‘å±•çš„æ¼”å˜ï¼Œè¯¥è¯­è¨€å…·æœ‰è®¸å¤šç¼ºé™·ã€‚ å› æ­¤ï¼Œå³ä½¿æ‚¨è®¤ä¸ºè‡ªå·±çŸ¥é“ä»€ä¹ˆæ˜¯â€œå˜å¼‚â€ï¼Œä¹Ÿè¯·å°è¯•ä»¥å…¨æ–°çš„æ–¹å¼çœ‹å¾…é—®é¢˜ã€‚ æˆ‘ä»¬å°†ä»æœ€åŸºç¡€çš„å†…å®¹å…¥æ‰‹ï¼Œå› æ­¤å³ä½¿æ˜¯åˆå­¦è€…ä¹Ÿå¯ä»¥ç†è§£æ‰€æœ‰å†…å®¹ã€‚ è€Œä¸”æˆ‘ä»¬ä¼šç»§ç»­ç”¨æ°´ï¼Œå› æ­¤ï¼Œå³ä½¿ä¸“ä¸šäººå£«ä¹Ÿå°†å¯¹ä»–ä»¬çš„çŸ¥è¯†æ„æˆæœ‰ç”¨ã€‚ ä»£ç ç¤ºä¾‹å°†ä½¿ç”¨ç±»ä¼¼äºTypeScriptçš„ä¼ªè¯­è¨€ã€‚ ç„¶åå°†ç ”ç©¶å‡ ç§å®é™…è¯­è¨€çš„æ–¹æ³•ã€‚ è€Œä¸”ï¼Œå¦‚æœæ‚¨æ­£åœ¨å¼€å‘è‡ªå·±çš„è¯­è¨€ï¼Œé‚£ä¹ˆæœ¬æ–‡å°†å¸®åŠ©æ‚¨ä¸è¦è¸©åˆ«äººçš„è€™å­ã€‚ </p><br><p><img src="https://habrastorage.org/webt/uz/yw/ly/uzywlybdb47qium0-khvukslzwc.png" alt="å¦‚æœæœ‰ç‹ç‹¸æ€ä¹ˆåŠï¼Ÿ"></p><a name="habracut"></a><br><h1 id="argumenty-i-parametry"> å‚æ•°å’Œå‚æ•° </h1><br><p>  <strong>å‚æ•°</strong>æ˜¯æˆ‘ä»¬æ¥å—çš„ã€‚ æè¿°å‚æ•°çš„ç±»å‹æ—¶ï¼Œæˆ‘ä»¬å¯¹å¯ä»¥ä¼ é€’ç»™æˆ‘ä»¬çš„ç±»å‹é›†è®¾ç½®äº†é™åˆ¶ã€‚ ä¸€äº›ä¾‹å­ï¼š </p><br><pre><code class="plaintext hljs">//   function log( id : string | number ) {} //   class Logger { constructor( readonly id : Natural ) {} } //   class Node&lt; Id extends Number &gt; { id : Id }</code> </pre> <br><p>  <strong>ä¸€ä¸ªè®ºç‚¹</strong>å°±æ˜¯æˆ‘ä»¬ä¼ é€’çš„ã€‚ åœ¨ä¼ è¾“æ—¶ï¼Œå‚æ•°å§‹ç»ˆå…·æœ‰æŸäº›ç‰¹å®šç±»å‹ã€‚ ä½†æ˜¯ï¼Œåœ¨é™æ€åˆ†æä¸­ï¼Œå¯èƒ½ä¸çŸ¥é“ç‰¹å®šç±»å‹ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆç¼–è¯‘å™¨ä¼šå†æ¬¡åœ¨ç±»å‹é™åˆ¶ä¸‹è¿è¡Œã€‚ ä¸€äº›ä¾‹å­ï¼š </p><br><pre> <code class="plaintext hljs">log( 123 ) //   new Logger( promptStringOrNumber( 'Enter id' ) ) //       new Node( 'root' ) //   ,  </code> </pre> <br><h1 id="podtipy"> äºšå‹ </h1><br><p> ç±»å‹å¯ä»¥å½¢æˆå±‚æ¬¡ç»“æ„ã€‚  <em>å­ç±»å‹</em>æ˜¯<em>è¶…ç±»å‹</em>çš„ç‰¹ä¾‹ã€‚ å¯ä»¥é€šè¿‡<strong>ç¼©å°</strong>è¶…ç±»å‹çš„å¯èƒ½å€¼<strong>çš„</strong>é›†åˆæ¥å½¢æˆå­ç±»å‹ã€‚ ä¾‹å¦‚ï¼Œè‡ªç„¶ç±»å‹æ˜¯æ•´æ•°å’Œæ­£æ•°çš„å­ç±»å‹ã€‚ å¹¶ä¸”è¿™ä¸‰ä¸ªéƒ½æ˜¯åŒæ—¶çš„Realçš„å­ç±»å‹ã€‚  Primeç±»å‹æ˜¯ä¸Šè¿°æ‰€æœ‰ç±»å‹çš„å­ç±»å‹ã€‚ åŒæ—¶ï¼ŒPositiveå’ŒIntegerç±»å‹æ˜¯é‡å çš„ï¼Œä½†æ˜¯æ²¡æœ‰ä¸€ä¸ªä¼šçº¦æŸå¦ä¸€ä¸ªã€‚ </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ca8/220/c10/ca8220c10205146b59dc7f9b4a479c4b.png" alt="å›¾ç‰‡"></p><br><p> å½¢æˆå­ç±»å‹çš„å¦ä¸€ç§æ–¹æ³•æ˜¯é€šè¿‡å°†å…¶ä¸ä¸å®ƒæ­£äº¤çš„å¦ä¸€ç§ç±»å‹ç»„åˆ<strong>æ¥æ‰©å±•</strong>å®ƒã€‚ ä¾‹å¦‚ï¼Œå­˜åœ¨ä¸€ä¸ªå…·æœ‰â€œé¢œè‰²â€å±æ€§çš„â€œå½©è‰²å›¾å½¢â€ï¼Œè€Œå­˜åœ¨ä¸€ä¸ªå…·æœ‰â€œé«˜åº¦â€å±æ€§çš„â€œæ­£æ–¹å½¢â€ã€‚ é€šè¿‡ç»„åˆè¿™äº›ç±»å‹ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªâ€œé¢œè‰²æ–¹å—â€ã€‚ åŠ ä¸Šä¸€ä¸ªå¸¦æœ‰â€œåŠå¾„â€çš„â€œåœ†â€ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªâ€œè‰²ç­’â€ã€‚ </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/484/181/21d/48418121d846dc7aa19d4cd7472638c6.png" alt="å›¾ç‰‡"></p><br><h1 id="ierarhii"> å±‚æ¬¡ç»“æ„ </h1><br><p> ä¸ºäº†è¿›ä¸€æ­¥å™è¿°ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå°çš„åŠ¨ç‰©å±‚æ¬¡ç»“æ„å’Œä¸€ä¸ªç±»ä¼¼çš„ç»†èƒå±‚æ¬¡ç»“æ„ã€‚ </p><br><pre> <code class="plaintext hljs">abstract class Animal {} abstract class Pet extends Animal {} class Cat extends Pet {} class Dog extends Pet {} class Fox extends Animal {} class AnimalCage { content : Animal } class PetCage extends AnimalCage { content : Pet } class CatCage extends PetCage { content : Cat } class DogCage extends PetCage { content : Dog } class FoxCage extends AnimalCage { content : Fox }</code> </pre> <br><p> ä¸‹é¢çš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯ä¸Šé¢ç±»å‹çš„ç¼©å°èŒƒå›´ã€‚ å¸¦å® ç‰©çš„ç¬¼å­åªèƒ½å®¹çº³å®¶ç•œï¼Œè€Œä¸èƒ½å®¹çº³é‡ç”ŸåŠ¨ç‰©ã€‚ å¸¦ç‹—çš„ç¬¼å­åªèƒ½å®¹çº³ç‹—ã€‚ </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/397/a01/046/397a01046371d0316d2231db9771de24.png" alt="å›¾ç‰‡"></p><br><h1 id="kovariantnost"> åæ–¹å·® </h1><br><p> æœ€ç®€å•å’Œæœ€å®¹æ˜“ç†è§£çš„æ˜¯å¯¹<strong>è¶…ç±»å‹</strong>æˆ–åæ–¹å·®çš„<strong>é™åˆ¶</strong> ã€‚ åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼ŒåŠŸèƒ½å‚æ•°ä¸ä¸ºå…¶æŒ‡å®šçš„ç±»å‹åå˜ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡½æ•°æ—¢å¯ä»¥æ¥å—æ­¤ç±»å‹æœ¬èº«ä¹Ÿå¯ä»¥æ¥å—å…¶ä»»ä½•å­ç±»å‹ï¼Œä½†ä¸èƒ½æ¥å—è¶…ç±»å‹æˆ–å…¶ä»–ç±»å‹ã€‚ </p><br><pre> <code class="plaintext hljs">function touchPet( cage : PetCage ) : void { log( `touch ${cage.content}` ) } touchPet( new AnimalCage ) // forbid touchPet( new PetCage ) // allow touchPet( new CatCage ) // allow touchPet( new DogCage ) // allow touchPet( new FoxCage ) // forbid</code> </pre> <br><p><img src="https://habrastorage.org/getpro/habr/post_images/a68/94b/667/a6894b667d46336844466ff63a972011.png" alt="å›¾ç‰‡"></p><br><p> ç”±äºæˆ‘ä»¬ä¸æ›´æ”¹ç¬¼å­ä¸­çš„ä»»ä½•ä¸œè¥¿ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å®‰å…¨åœ°å°†åŠŸèƒ½è½¬ç§»ç»™å¸¦çŒ«çš„ç¬¼å­ï¼Œå› ä¸ºè¿™åªä¸è¿‡æ˜¯å¸¦å® ç‰©ç¬¼å­çš„ç‰¹æ®Šæƒ…å†µã€‚ </p><br><h1 id="kontravariantnost"> é€†å·® </h1><br><p> å¾ˆéš¾ç†è§£<strong>äºšå‹çš„é™åˆ¶</strong>æˆ–çŸ›ç›¾ã€‚ åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼ŒåŠŸèƒ½å‚æ•°ä¸ä¸ºå…¶æŒ‡å®šçš„ç±»å‹ç›¸åã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡½æ•°æ—¢å¯ä»¥æ¥å—æ­¤ç±»å‹æœ¬èº«ä¹Ÿå¯ä»¥æ¥å—å…¶ä»»ä½•è¶…ç±»å‹ï¼Œä½†ä¸èƒ½æ¥å—å­ç±»å‹æˆ–å…¶ä»–ç±»å‹ã€‚ </p><br><pre> <code class="plaintext hljs">function pushPet( cage : PetCage ) : void { const Pet = random() &gt; .5 ? Cat : Dog cage.content = new Pet } pushPet( new AnimalCage ) // allow pushPet( new PetCage ) // allow pushPet( new CatCage ) // forbid pushPet( new DogCage ) // forbid pushPet( new FoxCage ) // forbid</code> </pre> <br><p><img src="https://habrastorage.org/getpro/habr/post_images/e9b/a03/b2d/e9ba03b2d3e4f0b82a6f3d9a4f85c05f.png" alt="å›¾ç‰‡"></p><br><p> æˆ‘ä»¬ä¸èƒ½å°†çŒ«å¸¦è¿›ç¬¼å­ï¼Œå› ä¸ºè¯¥åŠŸèƒ½å¯ä»¥å°†ç‹—æ”¾åœ¨é‚£é‡Œï¼Œè¿™æ˜¯ä¸å…è®¸çš„ã€‚ ä½†æ˜¯å¯ä»¥å°†ä»»ä½•åŠ¨ç‰©çš„ç¬¼å­å®‰å…¨åœ°è½¬ç§»ï¼Œå› ä¸ºçŒ«å’Œç‹—éƒ½å¯ä»¥æ”¾åœ¨é‚£é‡Œã€‚ </p><br><h1 id="invariantnost"> ä¸å˜æ€§ </h1><br><p>  <strong>é™åˆ¶å­ç±»å‹å’Œè¶…ç±»å‹</strong>å¯ä»¥åŒæ—¶å­˜åœ¨ã€‚ è¿™ç§æƒ…å†µç§°ä¸ºä¸å˜æ€§ã€‚ åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼ŒåŠŸèƒ½å‚æ•°å¯¹äºä¸ºå…¶æŒ‡å®šçš„ç±»å‹æ˜¯ä¸å˜çš„ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥å‡½æ•°åªèƒ½æ¥å—æŒ‡å®šçš„ç±»å‹ï¼Œä¸èƒ½å†æ¥å—å…¶ä»–ç±»å‹ã€‚ </p><br><pre> <code class="plaintext hljs">function replacePet( cage : PetCage ) : void { touchPet( cage ) pushPet( cage ) } replacePet( new AnimalCage ) // forbid replacePet( new PetCage ) // allow replacePet( new CatCage ) // forbid replacePet( new DogCage ) // forbid replacePet( new FoxCage ) // forbid</code> </pre> <br><p><img src="https://habrastorage.org/getpro/habr/post_images/3c3/bec/d6d/3c3becd6de5faa045963dc7c45774d19.png" alt="å›¾ç‰‡"></p><br><p>  <code>replacePet</code>å‡½æ•°ç»§æ‰¿äº†å…¶å†…éƒ¨ä½¿ç”¨çš„é‚£äº›å‡½æ•°çš„é™åˆ¶ï¼šå®ƒä»<code>pushPet</code>æ¥å—äº†å¯¹ç±»å‹çš„é™åˆ¶ï¼Œå¹¶é€šè¿‡<code>pushPet</code>æ¥å—äº†<code>pushPet</code>ç±»å‹çš„<code>pushPet</code> ã€‚ å¦‚æœæˆ‘ä»¬ç»™å¥¹æ”¾ä¸Šä»»ä½•åŠ¨ç‰©çš„ç¬¼å­ï¼Œå¥¹å°†æ— æ³•å°†å…¶è½¬ç§»åˆ°touchPetå‡½æ•°ä¸­ï¼Œåè€…ä¸çŸ¥é“å¦‚ä½•å¤„ç†ç‹ç‹¸ï¼ˆé‡ç”ŸåŠ¨ç‰©åªä¼šå’¬æ–­æ‰‹æŒ‡ï¼‰ã€‚ è€Œä¸”ï¼Œå¦‚æœæˆ‘ä»¬å°†ç¬¼å­ä¸çŒ«ä¸€èµ·è½¬ç§»ï¼Œåˆ™æ— æ³•è°ƒç”¨<code>pushPet</code> ã€‚ </p><br><h1 id="bivariantnost"> åŒæ–¹å·® </h1><br><p> äººä»¬ä¸èƒ½ä¸æåˆ°å¼‚å›½æƒ…è°ƒçš„<strong>ç¼ºä¹é™åˆ¶</strong> -åŒæ–¹å·®ã€‚ åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œå‡½æ•°å¯ä»¥æ¥å—å­ç±»å‹æˆ–å­ç±»å‹çš„ä»»ä½•ç±»å‹ã€‚ </p><br><pre> <code class="plaintext hljs">function enshurePet( cage : PetCage ) : void { if( cage.content instanceof Pet ) return pushPet( cage ) } replacePet( new AnimalCage ) // allow replacePet( new PetCage ) // allow replacePet( new CatCage ) // allow replacePet( new DogCage ) // allow replacePet( new FoxCage ) // forbid</code> </pre> <br><p><img src="https://habrastorage.org/getpro/habr/post_images/8b8/b85/66f/8b8b8566f8c6db9cd3959f1152202957.png" alt="å›¾ç‰‡"></p><br><p> æ‚¨å¯ä»¥åœ¨å…¶ä¸­éšåŠ¨ç‰©ä¸€èµ·è½¬ç§»ç¬¼å­ã€‚ ç„¶åï¼Œå¥¹å°†æ£€æŸ¥ç¬¼å­ä¸­æ˜¯å¦æœ‰å® ç‰©ï¼Œå¦åˆ™ï¼Œå°†å…¶æ”¾å…¥éšæœºå® ç‰©ä¸­ã€‚ ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥è½¬ç§»å¸¦çŒ«çš„ç¬¼å­ï¼Œç„¶åå¥¹ä»€ä¹ˆä¹Ÿä¸ä¼šåšã€‚ </p><br><h1 id="obobscheniya"> æ¦‚è®º </h1><br><p> æœ‰äº›äººè®¤ä¸ºæ–¹å·®æŸç§ç¨‹åº¦ä¸Šä¸æ¦‚æ‹¬æœ‰å…³ã€‚ é€šå¸¸æ˜¯å› ä¸ºé€šå¸¸ä½¿ç”¨é€šç”¨å®¹å™¨ä½œä¸ºç¤ºä¾‹æ¥è§£é‡Šå·®å¼‚ã€‚ ä½†æ˜¯ï¼Œåœ¨æ•´ä¸ªæ•…äº‹ä¸­ï¼Œæˆ‘ä»¬ä»ç„¶æ²¡æœ‰ä¸€ä¸ªå•ä¸€çš„æ¦‚æ‹¬-å®Œå…¨æ˜¯å…·ä½“çš„ç±»ï¼š </p><br><pre> <code class="plaintext hljs">class AnimalCage { content : Animal } class PetCage extends AnimalCage { content : Pet } class CatCage extends PetCage { content : Cat } class DogCage extends PetCage { content : Dog } class FoxCage extends AnimalCage { content : Fox }</code> </pre> <br><p> è¿™æ ·åšæ˜¯ä¸ºäº†è¯æ˜æ–¹å·®é—®é¢˜ä¸æ¦‚åŒ–æ— å…³ã€‚ ä»…éœ€è¦æ³›åŒ–ä»¥å‡å°‘å¤åˆ¶ç²˜è´´ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥é€šè¿‡ç®€å•çš„æ¦‚æ‹¬æ¥é‡å†™ä¸Šé¢çš„ä»£ç ï¼š </p><br><pre> <code class="plaintext hljs">class Cage&lt;Animal&gt; { content : Animal }</code> </pre> <br><p> ç°åœ¨ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä»»ä½•å•å…ƒçš„å®ä¾‹ï¼š </p><br><pre> <code class="plaintext hljs">const animalCage = new Cage&lt;Animal&gt;() const petCage = new Cage&lt;Pet&gt;() const catCage = new Cage&lt;Cat&gt;() const dogCage = new Cage&lt;Dog&gt;() const foxCage = new Cage&lt;Fox&gt;()</code> </pre> <br><h1 id="deklaraciya-ogranicheniy"> é™åˆ¶å£°æ˜ </h1><br><p> è¯·æ³¨æ„ï¼Œå‰é¢åˆ—å‡ºçš„æ‰€æœ‰å››ä¸ªåŠŸèƒ½çš„ç­¾åéƒ½å®Œå…¨ç›¸åŒï¼š </p><br><pre> <code class="plaintext hljs">( cage : PetCage )=&gt; void</code> </pre> <br><p> ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹å‡½æ•°æ¥å—å‚æ•°çš„è¿™ç§æè¿°ä¸å®Œæ•´-ä»ä¸­ä¸èƒ½è¯´å¯ä»¥å°†å…¶ä¼ é€’ç»™å‡½æ•°ã€‚ å¥½å§ï¼Œé™¤éå¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œå°†ç‹ç‹¸ç¬¼å­æ”¾è¿›å»ç»å¯¹ä¸å€¼å¾—ã€‚ </p><br><p> å› æ­¤ï¼Œåœ¨ç°ä»£è¯­è¨€ä¸­ï¼Œæœ‰ä¸€ç§æ–¹æ³•å¯ä»¥æ˜ç¡®æŒ‡ç¤ºå‚æ•°å…·æœ‰å“ªäº›ç±»å‹é™åˆ¶ã€‚ ä¾‹å¦‚ï¼ŒCï¼ƒä¸­çš„<a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/in-generic-modifier">in</a>å’Œ<a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/out-generic-modifier">out</a>ä¿®é¥°ç¬¦ï¼š </p><br><pre> <code class="plaintext hljs">interface ICageIn&lt;in T&gt; { T content { set; } } // contravariant generic parameter interface ICageOut&lt;out T&gt; { T content { get; } } // covariant generic parameter interface ICageInOut&lt;T&gt; { T content { get; set; } } // invariant generic parameter</code> </pre> <br><p> ä¸å¹¸çš„æ˜¯ï¼Œåœ¨Cï¼ƒä¸­ï¼Œä¿®é¥°ç¬¦çš„æ¯ä¸ªå˜ä½“éƒ½å¿…é¡»åœ¨å•ç‹¬çš„æ¥å£ä¸Šå¯åŠ¨ã€‚ å¦å¤–ï¼Œæ®æˆ‘äº†è§£ï¼ŒCï¼ƒä¸­çš„åŒæ–¹å·®é€šå¸¸æ˜¯æ— æ³•è¡¨è¾¾çš„ã€‚ </p><br><h1 id="vyhodnye-parametry"> è¾“å‡ºå‚æ•° </h1><br><p> å‡½æ•°ä¸ä»…å¯ä»¥æ¥å—ï¼Œè¿˜å¯ä»¥è¿”å›å€¼ã€‚ é€šå¸¸ï¼Œè¿”å›å€¼ä¸èƒ½ä¸º1ã€‚ ä¾‹å¦‚ï¼Œé‡‡å–å¸¦å® ç‰©çš„ç¬¼å­å¹¶å½’è¿˜ä¸¤åªå® ç‰©çš„åŠŸèƒ½ã€‚ </p><br><pre> <code class="plaintext hljs">function getPets( input : PetCage ) : [ Pet , Pet ] { return [ input.content , new Cat ] }</code> </pre> <br><p> è¿™ç§åŠŸèƒ½ç­‰æ•ˆäºé™¤ä¸€ä¸ªè¾“å…¥å‚æ•°å¤–è¿˜å…·æœ‰å¦å¤–ä¸¤ä¸ªè¾“å‡ºçš„åŠŸèƒ½ã€‚ </p><br><pre> <code class="plaintext hljs">function getPets( input : PetCage , output1 : PetCage , output2 : PetCage ) : void { output1.content = input.content output2.content = new Cat }</code> </pre> <br><p> å¤–éƒ¨ä»£ç åœ¨å †æ ˆä¸Šåˆ†é…äº†é¢å¤–çš„å†…å­˜ï¼Œä»¥ä¾¿è¯¥å‡½æ•°å°†å…¶è¦è¿”å›çš„æ‰€æœ‰å†…å®¹æ”¾å…¥å…¶ä¸­ã€‚ å®Œæˆåï¼Œè°ƒç”¨ä»£ç å°†å·²ç»èƒ½å¤Ÿå°†è¿™äº›å®¹å™¨ç”¨äºè‡ªå·±çš„ç›®çš„ã€‚ </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/2c3/292/0b5/2c32920b5a5aeb4ed22923ac97de9267.png" alt="å›¾ç‰‡"></p><br><p> ä»è¿™ä¸¤ä¸ªå‡½æ•°çš„ç­‰ä»·å…³ç³»å¯ä»¥å¾—å‡ºï¼Œä¸å‚æ•°ç›¸æ¯”ï¼Œå‡½æ•°è¿”å›çš„å€¼å§‹ç»ˆä¸æŒ‡å®šçš„è¾“å‡ºç±»å‹ç›¸åã€‚ ä¸€ä¸ªå‡½æ•°å¯ä»¥å‘å®ƒä»¬å†™å…¥ï¼Œä½†ä¸èƒ½ä»å®ƒä»¬è¯»å–ã€‚ </p><br><h1 id="metody-obektov"> å¯¹è±¡æ–¹æ³• </h1><br><p> å¯¹è±¡æ–¹æ³•æ˜¯å°†æŒ‡å‘å¯¹è±¡çš„é™„åŠ æŒ‡é’ˆä½œä¸ºéšå¼å‚æ•°çš„å‡½æ•°ã€‚ å³ï¼Œä»¥ä¸‹ä¸¤ä¸ªåŠŸèƒ½æ˜¯ç­‰æ•ˆçš„ã€‚ </p><br><pre> <code class="plaintext hljs">class PetCage { pushPet() : void { const Pet = random() &gt; .5 ? Cat : Dog this.content = new Pet } }</code> </pre> <br><pre> <code class="plaintext hljs">function pushPet( this : PetCage ) : void { const Pet = random() &gt; .5 ? Cat : Dog this.content = new Pet }</code> </pre> <br><p> ä½†æ˜¯ï¼Œå¿…é¡»æ³¨æ„ï¼Œä¸å¸¸è§„å‡½æ•°ä¸åŒçš„æ˜¯ï¼Œæ–¹æ³•ä¹Ÿæ˜¯è¯¥ç±»çš„æˆå‘˜ï¼Œè¯¥ç±»æ˜¯è¯¥ç±»å‹çš„æ‰©å±•ã€‚ è¿™å¯¼è‡´ä»¥ä¸‹äº‹å®ï¼šè°ƒç”¨æ­¤æ–¹æ³•çš„å‡½æ•°ä¼šå‡ºç°ä¸€ä¸ªé™„åŠ çš„è¶…ç±»å‹é™åˆ¶ï¼š </p><br><pre> <code class="plaintext hljs">function fillPetCage( cage : PetCage ) { cage.pushPet() }</code> </pre> <br><p><img src="https://habrastorage.org/getpro/habr/post_images/44e/f44/c67/44ef44c670ebef55ab1d8f248da44b11.png" alt="å›¾ç‰‡"></p><br><p> åœ¨<code>pushPet</code>æ–¹æ³•å°šæœªå®šä¹‰çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸èƒ½å‘å…¶ä¼ é€’è¿™æ ·çš„<code>pushPet</code> ã€‚ è¿™ä¸ä¸å˜çš„æƒ…å†µç›¸ä¼¼ï¼Œå› ä¸ºä»ä¸‹æ–¹å’Œä¸Šæ–¹éƒ½æœ‰é™åˆ¶ã€‚ ä½†æ˜¯ï¼Œ <code>pushPet</code>æ–¹æ³•çš„ä½ç½®åœ¨å±‚æ¬¡ç»“æ„ä¸­å¯èƒ½æ›´é«˜ã€‚ è¿™å°±æ˜¯æ”¹å‹é™åˆ¶æ‰€åœ¨ã€‚ </p><br><h1 id="princip-podstanovki--barbary-liskov-lsp"> èŠ­èŠ­æ‹‰Â·é‡Œæ–¯å…‹ï¼ˆBarbara Liskï¼‰æ¢äººåŸåˆ™ï¼ˆLSPï¼‰ </h1><br><p> è®¸å¤šäººè®¤ä¸ºï¼Œå­ç±»å‹ä¸å­ç±»å‹çš„æ¯”ç‡ä¸æ˜¯åŸºäºå‰é¢æåˆ°çš„ç¼©å°å’Œæ‰©å±•ç±»å‹çš„æ–¹æ³•æ¥ç¡®å®šçš„ï¼Œè€Œæ˜¯é€šè¿‡åœ¨ä½¿ç”¨è¶…ç±»å‹çš„ä»»ä½•ä½ç½®æ›¿æ¢å­ç±»å‹çš„å¯èƒ½æ€§æ¥ç¡®å®šçš„ã€‚ æ˜¾ç„¶ï¼Œæ­¤é”™è¯¯çš„åŸå› æ­£æ˜¯åœ¨LSPä¸­ã€‚ ä½†æ˜¯ï¼Œè®©æˆ‘ä»¬ä»”ç»†é˜…è¯»è¯¥åŸç†çš„å®šä¹‰ï¼Œæ³¨æ„ä»€ä¹ˆæ˜¯ä¸»è¦çš„ï¼Œä»€ä¹ˆæ˜¯æ¬¡è¦çš„ï¼š </p><br><blockquote> ä½¿ç”¨åŸºæœ¬ç±»å‹çš„å‡½æ•°åº”è¯¥èƒ½å¤Ÿä½¿ç”¨åŸºæœ¬ç±»å‹çš„å­ç±»å‹è€Œä¸çŸ¥é“å®ƒï¼Œä¹Ÿä¸ä¼šç ´åç¨‹åºçš„æ­£ç¡®æ€§ã€‚ </blockquote><p> å¯¹äºä¸å¯å˜çš„å¯¹è±¡ï¼ˆåŒ…æ‹¬é‚£äº›ä¸å¼•ç”¨å¯å˜å¯¹è±¡çš„å¯¹è±¡ï¼‰ï¼Œç”±äºæ²¡æœ‰åœ°æ–¹å¯ä»¥æ¥å—å­ç±»å‹é™åˆ¶ï¼Œå› æ­¤è‡ªåŠ¨æ‰§è¡Œæ­¤åŸç†ã€‚ </p><br><p> å¯¹äºå¯å˜å˜é‡ï¼Œå®ƒå˜å¾—è¶Šæ¥è¶Šå›°éš¾ï¼Œå› ä¸ºä»¥ä¸‹ä¸¤ç§æƒ…å†µå¯¹äºLSPåŸç†æ˜¯äº’æ–¥çš„ï¼š </p><br><ol><li> ç±»<code>A</code>æœ‰ä¸€ä¸ª<code>B</code>çš„å­ç±»ï¼Œå…¶ä¸­å­—æ®µ<code>B::foo</code>æ˜¯<code>A::foo</code>çš„å­ç±»å‹ã€‚ </li><li> ç±»<code>A</code>çš„æ–¹æ³•å¯ä»¥æ›´æ”¹<code>A::foo</code>å­—æ®µã€‚ </li></ol><br><p> å› æ­¤ï¼Œåªå‰©ä¸‹ä¸‰ç§æ–¹å¼ï¼š </p><br><ol><li> é˜²æ­¢å¯¹è±¡ç»§æ‰¿ç¼©å°å…¶å­—æ®µç±»å‹ã€‚ ä½†æ˜¯éšåæ‚¨å¯ä»¥å°†å¤§è±¡æ¨å…¥ç¬¼å­é‡Œå…»çŒ«ã€‚ </li><li> ä¸æ˜¯ç”±LSPæŒ‡å¯¼ï¼Œè€Œæ˜¯ç”±æ¯ä¸ªå‡½æ•°çš„æ¯ä¸ªå‚æ•°çš„å¯å˜æ€§åˆ†åˆ«æŒ‡å¯¼ã€‚ ä½†æ˜¯éšåæ‚¨å¿…é¡»è€ƒè™‘å¾ˆå¤šï¼Œå¹¶å‘ç¼–è¯‘å™¨è¯´æ˜ç±»å‹é™åˆ¶åœ¨å“ªé‡Œã€‚ </li><li> åä¸Šä¸€åˆ‡å» <del> ä¿®é“é™¢ </del> å‡½æ•°å¼ç¼–ç¨‹ï¼Œå…¶ä¸­æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ä¸å¯å˜çš„ï¼Œè¿™æ„å‘³ç€å®ƒä»¬æ¥å—çš„å‚æ•°ä¸å£°æ˜çš„ç±»å‹åå˜ã€‚ </li></ol><br><h1 id="typescript"> æ‰“å­—ç¨¿ </h1><br><p> åœ¨æ—¶é—´è„šæœ¬ä¸­ï¼Œé€»è¾‘å¾ˆç®€å•ï¼šå°†å‡½æ•°çš„æ‰€æœ‰å‚æ•°è§†ä¸ºåå˜çš„ï¼ˆä¸æ­£ç¡®ï¼‰ï¼Œå°†è¿”å›å€¼è§†ä¸ºåå˜çš„ï¼ˆæ­£ç¡®çš„ï¼‰ã€‚ å…ˆå‰å·²è¯æ˜ï¼Œå‡½æ•°çš„å‚æ•°å¯ä»¥æœ‰ä»»ä½•å˜åŒ–ï¼Œå…·ä½“å–å†³äºæ­¤å‡½æ•°å¯¹è¿™äº›å‚æ•°çš„ä½œç”¨ã€‚ å› æ­¤ï¼Œè¿™äº›æ˜¯ä»¥ä¸‹äº‹ä»¶ï¼š </p><br><pre> <code class="plaintext hljs">abstract class Animal { is! : 'cat' | 'dog' | 'fox' } abstract class Pet extends Animal { is! : 'cat' | 'dog' } class Cat extends Pet { is! : 'cat' } class Dog extends Pet { is! : 'dog' } class Fox extends Animal { is! : 'fox' } class Cage&lt;Animal&gt; { content! : Animal } function pushPet( cage : Cage&lt;Pet&gt; ) : void { const Pet = Math.random() &gt; .5 ? Cat : Dog cage.content = new Pet } pushPet( new Cage&lt;Animal&gt;() ) // forbid to push Pet to Animal Cage :-( pushPet( new Cage&lt;Cat&gt;() ) // allow to push Dog to Cat Cage :-(</code> </pre> <br><p> è¦è§£å†³æ­¤é—®é¢˜ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨ä¸å¹³å‡¡çš„ä»£ç æ¥å¸®åŠ©ç¼–è¯‘å™¨ï¼š </p><br><pre> <code class="plaintext hljs">function pushPet&lt; PetCage extends Cage&lt;Animal&gt; &gt;( cage: Cage&lt;Pet&gt; extends PetCage ? PetCage : never ): void { const Pet = Math.random() &gt; .5 ? Cat : Dog cage.content = new Pet } pushPet( new Cage&lt;Animal&gt;() ) // allow :-) pushPet( new Cage&lt;Pet&gt;() ) // allow :-) pushPet( new Cage&lt;Cat&gt;() ) // forbid :-) pushPet( new Cage&lt;Dog&gt;() ) // forbid :-) pushPet( new Cage&lt;Fox&gt;() ) // forbid :-)</code> </pre> <br><p>  <a href="https://tinyurl.com/uesu87y"><strong>åœ¨çº¿å°è¯•</strong></a> </p><br><h1 id="flowjs">  Flowjs </h1><br><p>  FlowJSå…·æœ‰æ›´é«˜çº§çš„ç±»å‹ç³»ç»Ÿã€‚ ç‰¹åˆ«åœ°ï¼Œåœ¨<a href="https://flow.org/en/docs/types/generics/">ç±»å‹æè¿°ä¸­å¯ä»¥æŒ‡å‡ºå…¶</a>å¯¹äºé€šç”¨å‚æ•°å’Œå¯¹è±¡å­—æ®µçš„<a href="https://flow.org/en/docs/types/generics/">å¯å˜æ€§</a> ã€‚ åœ¨æˆ‘ä»¬çš„å•å…ƒæ ¼ç¤ºä¾‹ä¸­ï¼Œå®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š </p><br><pre> <code class="plaintext hljs">class Animal {} class Pet extends Animal {} class Cat extends Pet {} class Dog extends Pet {} class Fox extends Animal {} class Cage&lt; Animal &gt; { content : Animal } function touchPet( cage : { +content : Pet } ) : void { console.log( `touch ${typeof cage.content}` ) } function pushPet( cage: { -content: Pet } ): void { const Pet = Number((0: any)) &gt; .5 ? Cat : Dog cage.content = new Pet } function replacePet( cage : { content : Pet } ) : void { touchPet( cage ) pushPet( cage ) } touchPet( new Cage&lt;Animal&gt; ) // forbid :-) touchPet( new Cage&lt;Pet&gt; ) // allow :-) touchPet( new Cage&lt;Cat&gt; ) // allow :-) touchPet( new Cage&lt;Dog&gt; ) // allow :-) touchPet( new Cage&lt;Fox&gt; ) // forbid :-) pushPet( new Cage&lt;Animal&gt; ) // allow :-) pushPet( new Cage&lt;Pet&gt; ) // allow :-) pushPet( new Cage&lt;Cat&gt; ) // forbid :-) pushPet( new Cage&lt;Dog&gt; ) // forbid :-) pushPet( new Cage&lt;Fox&gt; ) // forbid :-) replacePet( new Cage&lt;Animal&gt; ) // forbid :-) replacePet( new Cage&lt;Pet&gt; ) // allow :-) replacePet( new Cage&lt;Cat&gt; ) // forbid :-) replacePet( new Cage&lt;Dog&gt; ) // forbid :-) replacePet( new Cage&lt;Fox&gt;) // forbid :-)</code> </pre> <br><p>  <a href="https://tinyurl.com/uak4hne"><strong>åœ¨çº¿å°è¯•</strong></a> </p><br><p> è¿™é‡Œçš„åŒæ–¹å·®æ˜¯æ— æ³•è¡¨è¾¾çš„ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œåœ¨æ²¡æœ‰æ˜ç¡®æè¿°æ‰€æœ‰å­—æ®µçš„ç±»å‹çš„æƒ…å†µä¸‹ï¼Œæˆ‘æ‰¾ä¸åˆ°æ›´æ–¹ä¾¿åœ°è®¾ç½®æ–¹å·®çš„æ–¹æ³•ã€‚ ä¾‹å¦‚ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="plaintext hljs">function pushPet( cage: Contra&lt; Cage&lt;Pet&gt; , 'content' &gt; ): void { const Pet = Number((0: any)) &gt; .5 ? Cat : Dog cage.content = new Pet }</code> </pre> <br><h1 id="c-sharp">  Cé” </h1><br><p>  Cï¼ƒæœ€åˆè®¾è®¡æ—¶å¯¹å˜åŒ–æ²¡æœ‰ä»»ä½•äº†è§£ã€‚ ä½†æ˜¯ï¼Œç¨ååˆæ·»åŠ äº†å‚æ•°ä¿®é¥°ç¬¦ï¼Œè¿™ä½¿ç¼–è¯‘å™¨å¯ä»¥æ­£ç¡®æ£€æŸ¥ä¼ é€’çš„å‚æ•°ç±»å‹ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œå†æ¬¡ä½¿ç”¨è¿™äº›ä¿®é¥°ç¬¦ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚ </p><br><pre> <code class="plaintext hljs">using System; abstract class Animal {} abstract class Pet : Animal {} class Cat : Pet {} class Dog : Pet {} class Fox : Animal {} interface ICageIn&lt;in T&gt; { T content { set; } } interface ICageOut&lt;out T&gt; { T content { get; } } interface ICageInOut&lt;T&gt; { T content { get; set; } } class Cage&lt;T&gt; : ICageIn&lt;T&gt;, ICageOut&lt;T&gt;, ICageInOut&lt;T&gt; { public T content { get; set; } } public class Program { static void touchPet( ICageOut&lt;Pet&gt; cage ) { Console.WriteLine( cage.content ); } static void pushPet( ICageIn&lt;Pet&gt; cage ) { cage.content = new Dog(); } static void replacePet( ICageInOut&lt;Pet&gt; cage ) { touchPet( cage as ICageOut&lt;Pet&gt; ); pushPet( cage as ICageIn&lt;Pet&gt; ); } void enshurePet( Cage&lt;Pet&gt; cage ) { if( cage.content is Pet ) return; pushPet( cage as ICageIn&lt;Pet&gt; ); } public static void Main() { var animalCage = new Cage&lt;Animal&gt;(); var petCage = new Cage&lt;Pet&gt;(); var catCage = new Cage&lt;Cat&gt;(); var dogCage = new Cage&lt;Dog&gt;(); var foxCage = new Cage&lt;Fox&gt;(); touchPet( animalCage ); // forbid :-) touchPet( petCage ); // allow :-) touchPet( catCage ); // allow :-) touchPet( dogCage ); // allow :-) touchPet( foxCage ); // forbid :-) pushPet( animalCage ); // allow :-) pushPet( petCage ); // allow :-) pushPet( catCage ); // forbid :-) pushPet( dogCage ); // forbid :-) pushPet( foxCage ); // forbid :-) replacePet( animalCage ); // forbid :-) replacePet( petCage ); // allow :-) replacePet( catCage ); // forbid :-) replacePet( dogCage ); // forbid :-) replacePet( foxCage ); // forbid :-) } }</code> </pre> <br><p>  <a href="https://dotnetfiddle.net/jAx53p"><strong>åœ¨çº¿å°è¯•</strong></a> </p><br><h1 id="java"> çˆªå“‡ </h1><br><p> åœ¨Javaä¸­ï¼Œåˆ‡æ¢å˜ä½“çš„åŠŸèƒ½æ·»åŠ å¾—å¾ˆæ™šï¼Œå¹¶ä¸”ä»…é€‚ç”¨äºé€šç”¨å‚æ•°ï¼Œè€Œè¿™äº›å‚æ•°æœ¬èº«æ˜¯ç›¸å¯¹è¾ƒæ–°çš„ã€‚ å¦‚æœè¯¥å‚æ•°ä¸é€šç”¨ï¼Œé‚£å°±éº»çƒ¦äº†ã€‚ </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Animal</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Pet</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Animal</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cat</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Pet</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Dog</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Pet</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Fox</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Animal</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cage</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> T content; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Main</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">touchPet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( Cage&lt;? extends Pet&gt; cage )</span></span></span><span class="hljs-function"> </span></span>{ System.out.println( cage.content ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pushPet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( Cage&lt;? </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">super</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Pet&gt; cage )</span></span></span><span class="hljs-function"> </span></span>{ cage.content = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dog(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">replacePet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Cage&lt;Pet&gt; cage )</span></span></span><span class="hljs-function"> </span></span>{ touchPet( cage ); pushPet( cage ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">enshurePet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( Cage&lt;Pet&gt; cage )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( cage.content <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> Pet ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; pushPet( cage ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ Cage&lt;Animal&gt; animalCage = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Cage&lt;Animal&gt;(); Cage&lt;Pet&gt; petCage = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Cage&lt;Pet&gt;(); Cage&lt;Cat&gt; catCage = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Cage&lt;Cat&gt;(); Cage&lt;Dog&gt; dogCage = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Cage&lt;Dog&gt;(); Cage&lt;Fox&gt; foxCage = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Cage&lt;Fox&gt;(); touchPet( animalCage ); <span class="hljs-comment"><span class="hljs-comment">// forbid :-) touchPet( petCage ); // allow :-) touchPet( catCage ); // allow :-) touchPet( dogCage ); // allow :-) touchPet( foxCage ); // forbid :-) pushPet( animalCage ); // allow :-) pushPet( petCage ); // allow :-) pushPet( catCage ); // forbid :-) pushPet( dogCage ); // forbid :-) pushPet( foxCage ); // forbid :-) replacePet( animalCage ); // forbid :-) replacePet( petCage ); // allow :-) replacePet( catCage ); // forbid :-) replacePet( dogCage ); // forbid :-) replacePet( foxCage ); // forbid :-) } }</span></span></code> </pre> <br><p>  <a href="https://paiza.io/projects/pIBVVcjarSB0j0RJY8iNTw%3Flanguage%3Djava"><strong>åœ¨çº¿å°è¯•</strong></a> </p><br><h1 id="c">  C ++ </h1><br><p>  C ++å‡­å€Ÿå…¶å¼ºå¤§çš„æ¨¡æ¿ç³»ç»Ÿï¼Œå¯ä»¥è¡¨è¾¾å„ç§å˜ä½“ï¼Œä½†æ˜¯å½“ç„¶æœ‰å¾ˆå¤šä»£ç ã€‚ </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; #include &lt;typeinfo&gt; #include &lt;type_traits&gt; class Animal {}; class Pet: public Animal {}; class Cat: public Pet {}; class Dog: public Pet {}; class Fox: public Animal {}; template&lt;class T&gt; class Cage { public: T *content; }; template&lt;class T, class = std::enable_if_t&lt;std::is_base_of&lt;Pet, T&gt;::value&gt;&gt; void touchPet(const Cage&lt;T&gt; &amp;cage) { std::cout &lt;&lt; typeid(T).name(); } template&lt;class T, class = std::enable_if_t&lt;std::is_base_of&lt;T, Pet&gt;::value&gt;&gt; void pushPet(Cage&lt;T&gt; &amp;cage) { cage.content = new Dog(); } void replacePet(Cage&lt;Pet&gt; &amp;cage) { touchPet(cage); pushPet(cage); } int main(void) { Cage&lt;Animal&gt; animalCage {new Fox()}; Cage&lt;Pet&gt; petCage {new Cat()}; Cage&lt;Cat&gt; catCage {new Cat()}; Cage&lt;Dog&gt; dogCage {new Dog()}; Cage&lt;Fox&gt; foxCage {new Fox()}; touchPet( animalCage ); // forbid :-) touchPet( petCage ); // allow :-) touchPet( catCage ); // allow :-) touchPet( dogCage ); // allow :-) touchPet( foxCage ); // forbid :-) pushPet( animalCage ); // allow :-) pushPet( petCage ); // allow :-) pushPet( catCage ); // forbid :-) pushPet( dogCage ); // forbid :-) pushPet( foxCage ); // forbid :-) replacePet( animalCage ); // forbid :-) replacePet( petCage ); // allow :-) replacePet( catCage ); // forbid :-) replacePet( dogCage ); // forbid :-) replacePet( foxCage ); // forbid :-) return 0; }</span></span></span></span></code> </pre> <br><p>  <a href="http://cpp.sh/8aqxm"><strong>åœ¨çº¿å°è¯•</strong></a> </p><br><h1 id="d">  d </h1><br><p>  Dæ²¡æœ‰ä»»ä½•æ˜æ™ºçš„æ–¹å¼æ¥æ˜ç¡®æŒ‡ç¤ºæ–¹å·®ï¼Œä½†æ˜¯ä»–çŸ¥é“å¦‚ä½•æ ¹æ®ä½¿ç”¨æƒ…å†µæ¥æ¨æ–­ç±»å‹ã€‚ </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>.stdio, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>.random; abstract <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Animal</span></span></span><span class="hljs-class"> {</span></span>} abstract <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Pet</span></span></span><span class="hljs-class"> :</span></span> Animal { <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> name; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cat</span></span></span><span class="hljs-class"> :</span></span> Pet {} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Dog</span></span></span><span class="hljs-class"> :</span></span> Pet {} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Fox</span></span></span><span class="hljs-class"> :</span></span> Animal {} <span class="hljs-function"><span class="hljs-function">class </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Cage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T)</span></span></span><span class="hljs-function"> </span></span>{ T content; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">touchPet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( PetCage )</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( PetCage cage )</span></span></span><span class="hljs-function"> </span></span>{ writeln( cage.content.name ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pushPet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( PetCage )</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( PetCage cage )</span></span></span><span class="hljs-function"> </span></span>{ cage.content = ( uniform(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ) ? <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dog() : <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Cat(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">replacePet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( PetCage )</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( PetCage cage )</span></span></span><span class="hljs-function"> </span></span>{ touchPet( cage ); pushPet( cage); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Cage!Animal animalCage; Cage!Pet petCage; Cage!Cat catCage; Cage!Dog dogCage; Cage!Fox foxCage; animalCage.touchPet(); <span class="hljs-comment"><span class="hljs-comment">// forbid :-) petCage.touchPet(); // allow :-) catCage.touchPet(); // allow :-) dogCage.touchPet(); // allow :-) foxCage.touchPet(); // forbid :-) animalCage.pushPet(); // allow :-) petCage.pushPet(); // allow :-) catCage.pushPet(); // forbid :-) dogCage.pushPet(); // forbid :-) foxCage.pushPet(); // forbid :-) animalCage.replacePet(); // forbid :-) petCage.replacePet(); // allow :-) catCage.replacePet(); // forbid :-) dogCage.replacePet(); // forbid :-) foxCage.replacePet(); // forbid :-) }</span></span></code> </pre> <br><p>  <a href="https://tinyurl.com/qwxwzqg"><strong>åœ¨çº¿å°è¯•</strong></a> </p><br><h1 id="epilog"> ç»“è¯­ </h1><br><p> ç°åœ¨å°±è¿™äº›äº†ã€‚ æˆ‘å¸Œæœ›ä»‹ç»çš„ææ–™å¯ä»¥å¸®åŠ©æ‚¨æ›´å¥½åœ°ç†è§£ç±»å‹çš„é™åˆ¶ï¼Œä»¥åŠå¦‚ä½•ä»¥ä¸åŒçš„è¯­è¨€å®ç°å®ƒä»¬ã€‚ æ€»çš„æ¥è¯´ï¼ŒæŸå¤„æ›´å¥½ï¼ŒæŸå¤„æ›´ç³Ÿï¼ŒæŸå¤„æ²¡æœ‰åŠæ³•ï¼Œä½†æ€»ä¹‹ã€‚ ä¹Ÿè®¸æ˜¯æ‚¨å°†å¼€å‘ä¸€ç§è¯­è¨€ï¼Œä½¿æ‰€æœ‰è¿™äº›è¯­è¨€éƒ½å¯ä»¥æ–¹ä¾¿åœ°å®ç°å¹¶ä¸”æ˜¯ç±»å‹å®‰å…¨çš„ã€‚ åŒæ—¶ï¼ŒåŠ å…¥æˆ‘ä»¬çš„<a href="https://teleg.run/lang_idioms">ç”µæŠ¥èŠå¤©ï¼Œæœ‰æ—¶æˆ‘ä»¬è®¨è®ºç¼–ç¨‹è¯­è¨€çš„ç†è®ºæ¦‚å¿µ</a> ã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN477448/">https://habr.com/ru/post/zh-CN477448/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN477434/index.html">å¾®æœåŠ¡çš„æœåŠ¡ç½‘æ ¼ã€‚ ç¬¬äºŒéƒ¨åˆ†ï¼Œä½¿ç”¨Istioçš„åŸºç¡€çŸ¥è¯†</a></li>
<li><a href="../zh-CN477436/index.html">å¦‚ä½•ç¼–å†™ä¸€ä¸ªç®€å•çš„å®¢æˆ·ç«¯-æœåŠ¡å™¨è®¡ç®—å™¨ï¼ˆJavaFX + EJB + WildFlyï¼‰</a></li>
<li><a href="../zh-CN477438/index.html">å¦‚ä½•é‡æ–°æ§åˆ¶å¹¶å‡å°‘å¯¹æ™ºèƒ½æ‰‹æœºå’Œé€šçŸ¥çš„ä¾èµ–</a></li>
<li><a href="../zh-CN477440/index.html">Flipper Zero-æˆŠé…¯tomagotchi patsanå¤šåŠŸèƒ½å·¥å…·</a></li>
<li><a href="../zh-CN477442/index.html">56ä¸ªå¼€æºPythoné¡¹ç›®</a></li>
<li><a href="../zh-CN477450/index.html">9ç§æ£€æµ‹å¼‚å¸¸çš„æ–¹æ³•</a></li>
<li><a href="../zh-CN477452/index.html">ç¬¬äºŒå±Šç¼–ç¨‹å† å†›ï¼šæˆ‘ä»¬åˆ†æMLè½¨é“çš„ä»»åŠ¡</a></li>
<li><a href="../zh-CN477454/index.html">é…ç½®æ–‡ä»¶ã€‚ Libconfigåº“å’Œæœªä½¿ç”¨è®¾ç½®çš„å®šä¹‰</a></li>
<li><a href="../zh-CN477458/index.html">è‹æ ¼å…°ITç”Ÿæ´»çš„åˆ©ä¸å¼Š</a></li>
<li><a href="../zh-CN477460/index.html">ç¬¬26æœŸï¼šITåŸ¹è®­-é¢†å…ˆå…¬å¸çš„å½“å‰é—®é¢˜å’ŒæŒ‘æˆ˜</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>