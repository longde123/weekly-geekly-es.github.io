<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐜 🤬 👨🏻‍🚀 JavaScript en 3D: une introduction à Three.js 👵🏼 💆🏿 👨‍👩‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! Je vous présente la traduction de l' article "JavaScript en 3D: une introduction à Three.js" par Bret Cameron. 

 Présentation  
 Three...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>JavaScript en 3D: une introduction à Three.js</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477956/">  <i>Bonjour, Habr!</i>  <i>Je vous présente la traduction de l' <a href="https://medium.com/javascript-in-plain-english/javascript-in-3d-an-introduction-to-three-js-780f1e4a2e6d">article</a> "JavaScript en 3D: une introduction à Three.js" par Bret Cameron.</i> <br><br><h2>  Présentation </h2> <br>  Three.js est un outil puissant.  Il aide à utiliser la conception 3D dans un navigateur avec des performances acceptables.  Mise en route Three.js peut être délicat, surtout si vous n'avez jamais plongé dans le monde de la programmation 3D auparavant. <br><br>  J'ai une certaine expérience de base avec le moteur de jeu Unity et C #, mais bon nombre des concepts sont nouveaux pour moi.  J'en suis venu à la conclusion que maintenant il y a très peu de ressources pour les développeurs débutants, j'ai donc décidé d'écrire cet article.  Dans ce document, nous examinerons les éléments de base des scènes Three.js, des maillages polygonaux et des matériaux à la géométrie, aux chargeurs et bien plus encore. <br><a name="habracut"></a><br>  À la fin de cet article, vous aurez une solide compréhension des aspects de base nécessaires pour ajouter une dimension supplémentaire à votre futur projet Web. <br><br>  Exemples Three.js de <a href="https://threejs.org/examples/">Ben Houston</a> , <a href="https://threejs.org/examples/">Thomas Diewald</a> et <a href="https://threejs.org/examples/">StrykerDoesAnimation</a> . <br><br><h3>  Vecteurs et conteneurs - blocs de construction de base </h3><br>  Il y a souvent deux classes principales dans Three.js - <i>Vector3</i> et <i>Box3</i> .  Si vous êtes nouveau dans la 3D, cela peut sembler un peu abstrait, mais vous les rencontrerez beaucoup plus de fois. <br><br><h3>  Vector3 </h3><br>  La classe 3D la plus basique contenant trois nombres: <i>x, y et z</i> .  Les nombres sont les coordonnées d'un point dans l'espace 3D ou la direction et la longueur.  Par exemple: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> vect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.Vector3(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> <br>  La plupart des constructeurs de Three.js acceptent des objets de type <i>Vector3</i> comme arguments d'entrée, par exemple <i>Box3</i> <br><br><h3>  Box3 </h3><br>  Cette classe représente cuboïde (conteneur 3D).  Sa tâche principale est de créer un conteneur autour d'autres objets - et c'est tout, le plus petit cuboïde dans lequel un objet 3D s'insérera.  Chaque <i>Box3 est</i> aligné autour des axes <i>x, y et z.</i>  Un exemple de création d'un conteneur à l'aide de <i>Vector3</i> : <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> vect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.Vector3(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> box = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.Box3(vect);</code> </pre> <br>  Un exemple de création d'un conteneur autour d'un objet 3D existant: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> box = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.Box3(); box.setFromObject(object);</code> </pre> <br>  Vous pouvez créer des grilles sans cette connaissance approfondie, mais dès que vous commencerez à concevoir ou à modifier vos modèles, ces classes seront certainement utiles.  Nous allons maintenant nous éloigner des abstractions pour des choses plus visibles. <br><br><h3>  Maillage polygonal </h3><br>  Dans Three.js, l'élément visuel principal de la scène est <i>Mesh</i> .  Il s'agit d'un objet 3D composé de rectangles triangulaires (maillage polygonal).  Il est construit à l'aide de deux objets: <br>  <i>La géométrie</i> - détermine sa forme, le <i>matériau</i> - détermine l'apparence. <br><br>  Leurs définitions peuvent sembler un peu déroutantes (par exemple, la classe <i>Geometry</i> peut contenir des informations sur la couleur), mais la principale différence est exactement cela. <br><br><h3>  Géométrie </h3><br>  En fonction de la tâche que vous souhaitez réaliser, vous pouvez définir la géométrie à l'intérieur de Three.js ou en importer une autre à partir d'un fichier. <br><br>  En utilisant des fonctions comme <i>THREE.TorusKnotGeometry</i> , nous pouvons créer des objets complexes avec une seule ligne de code.  Nous y reviendrons bientôt, mais considérons d'abord des formulaires plus simples. <br>  La figure 3D la plus simple, cuboïde ou contenant, peut être spécifiée par les paramètres de <i>largeur</i> , <i>hauteur</i> et <i>profondeur</i> . <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> geometry = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.BoxGeometry( <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span> );</code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://codepen.io/BretCameron/embed/preview/eYOxYZL" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Pour une sphère, la valeur des paramètres <i>radius</i> , <i>widthSegments</i> et <i>heightSegments</i> est <i>minimale</i> .  Les deux dernières variables indiquent le nombre de triangles que le modèle doit utiliser pour représenter la sphère: plus le nombre est grand, plus il sera lisse. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> geometry = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.SphereGeometry( <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">64</span></span> );</code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://codepen.io/BretCameron/embed/preview/KKPJKgQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Si nous voulons créer des formes nettes ou triangulaires, nous pouvons utiliser un cône.  Ses arguments sont une combinaison des arguments des deux figures précédentes.  Ci-dessous, nous prescrivons <i>radius</i> , <i>widthSegments</i> et <i>radialSegments</i> . <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> geometry = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.ConeBufferGeometry( <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span> );</code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://codepen.io/BretCameron/embed/preview/MWgLWJB" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Ce n'est qu'une partie des chiffres les plus courants.  Three.js a beaucoup de formes à l'intérieur de la boîte, qui peuvent être trouvées dans la documentation.  Dans cet article, nous examinerons des formes plus intéressantes construites sur la base de la méthode <i>TorusKnotGeometry</i> . <br><br>  Pourquoi ces formes ressemblent-elles exactement à leur apparence?  Cette question dépasse le cadre de cet article, mais je vous invite à expérimenter avec les valeurs des paramètres, car vous pouvez obtenir des formes très intéressantes avec une seule ligne de code! <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> geometry = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.TorusKnotGeometry(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">1.3</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>);</code> </pre> <br>  <a href="https://codepen.io/BretCameron/pen/gOYqORg">https://codepen.io/BretCameron/pen/gOYqORg</a> <br><br><h3>  Matériaux </h3><br>  La géométrie définit la forme de nos objets 3D, mais pas leur apparence.  Pour résoudre ce problème, nous avons besoin de matériaux. <br><br>  Three.js propose 10 matériaux prêts à l'emploi, chacun ayant ses propres avantages et paramètres personnalisables.  Nous ne considérerons qu'une partie des plus utiles. <br><br><img src="https://habrastorage.org/webt/7o/1r/av/7o1rav-we2n9_hn6e74l-6ivo6q.png"><br><br><h4>  MeshNormalMaterial </h4><br>  <i>Utile pour un démarrage et un démarrage rapides.</i> <br><br>  Nous allons commencer avec <i>MeshNormalMaterial</i> , le matériau multicolore que nous avons utilisé dans les exemples ci-dessus.  Il correspond aux vecteurs normaux dans le panneau RVB, en d'autres termes, les couleurs sont utilisées pour déterminer la position du vecteur dans l'espace 3D. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> material = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.MeshNormalMaterial();</code> </pre> <br>  Notez que si vous souhaitez changer la couleur du matériau, vous pouvez utiliser le filtre CSS et changer la saturation: <pre> <code class="javascript hljs"> filter: hue-rotate(<span class="hljs-number"><span class="hljs-number">90</span></span>deg) .</code> </pre> <br><br>  D'après mon expérience, ce matériel est plus utile pour une stratification et un lancement rapides.  Pour mieux contrôler vos objets, il vaut mieux utiliser autre chose. <br><br><h4>  Meshbasicmaterial </h4><br>  <i>Utile pour afficher uniquement le squelette.</i> <br><br>  Si vous souhaitez donner à la figure une seule couleur, vous ne pouvez utiliser <i>MeshBasicMaterial</i> que si l'éclairage n'est pas appliqué.  J'ai trouvé utile d'utiliser ce matériau pour rendre le squelette du modèle.  Pour dessiner uniquement le squelette, vous devez passer <i>{wireframe: true}</i> comme paramètre. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> material = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.MeshBasicMaterial({ <span class="hljs-attr"><span class="hljs-attr">wireframe</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">color</span></span>: <span class="hljs-number"><span class="hljs-number">0xdaa520</span></span> });</code> </pre> <br>  Le principal inconvénient de ce matériau est que les informations sur la profondeur du matériau sont complètement perdues.  Chaque matériau a la possibilité d'afficher uniquement le squelette, mais un seul matériau résout le problème du manque de profondeur - <i>MeshDepthMaterial</i> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://codepen.io/BretCameron/embed/preview/ZEzwERw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h4>  Meshhambertmaterial </h4><br>  <i>Utile pour des performances élevées mais une faible précision.</i> <br><br>  C'est le premier matériau qui prend en compte la lumière, vous devez donc ajouter un peu de lumière à notre scène.  Dans le code ci-dessous, nous ajoutons des spots avec une teinte jaune pour créer un effet plus chaud. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> scene = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.Scene(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> frontSpot = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.SpotLight(<span class="hljs-number"><span class="hljs-number">0xeeeece</span></span>); frontSpot.position.set(<span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>); scene.add(frontSpot); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> frontSpot2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.SpotLight(<span class="hljs-number"><span class="hljs-number">0xddddce</span></span>); frontSpot2.position.set(<span class="hljs-number"><span class="hljs-number">-500</span></span>, <span class="hljs-number"><span class="hljs-number">-500</span></span>, <span class="hljs-number"><span class="hljs-number">-500</span></span>); scene.add(frontSpot2);</code> </pre> <br>  Maintenant, ajoutez du matériel pour notre figure.  Puisque notre silhouette est comme une décoration, je suggère d'ajouter une couleur plus dorée.  Un autre paramètre, <i>émissif</i> , est la couleur de l'objet provenant de l'objet lui-même (sans source lumineuse).  Souvent, cela fonctionne mieux comme une couleur sombre - par exemple, comme des nuances de gris foncées, comme dans l'exemple ci-dessous <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> material = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.MeshLambertMaterial({ <span class="hljs-attr"><span class="hljs-attr">color</span></span>: <span class="hljs-number"><span class="hljs-number">0xdaa520</span></span>, <span class="hljs-attr"><span class="hljs-attr">emissive</span></span>: <span class="hljs-number"><span class="hljs-number">0x111111</span></span>, });</code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://codepen.io/BretCameron/embed/preview/OJLdJGz" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Comme vous pouvez le voir dans l'exemple ci-dessous, la couleur est plus ou moins correcte, mais la façon dont elle interagit avec la lumière n'ajoute pas de réalisme.  Pour résoudre ce problème, nous devons utiliser <i>MeshPhongMaterial</i> ou <i>MeshStandardMaterial.</i> <br><br><h4>  MeshPhongMaterial </h4><br>  <i>Utile pour des performances moyennes et une précision moyenne.</i> <br><br>  Ce matériau offre un compromis entre performances et précision de rendu, ce matériau est donc une bonne option pour une application qui doit être productive avec un rendu plus précis qu'avec <i>MeshLambertMaterial.</i> <br><br>  Maintenant, nous pouvons changer la propriété <i>spéculaire</i> qui affecte la luminosité et la couleur de la réflexion de la surface.  Si la propriété émissive est généralement sombre, le <i>spéculaire</i> fonctionne mieux pour les couleurs claires.  Ci-dessous, nous utilisons du gris clair. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> material = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.MeshPhongMaterial({ <span class="hljs-attr"><span class="hljs-attr">color</span></span>: <span class="hljs-number"><span class="hljs-number">0xdaa520</span></span>, <span class="hljs-attr"><span class="hljs-attr">emissive</span></span>: <span class="hljs-number"><span class="hljs-number">0x000000</span></span>, <span class="hljs-attr"><span class="hljs-attr">specular</span></span>: <span class="hljs-number"><span class="hljs-number">0xbcbcbc</span></span>, });</code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://codepen.io/BretCameron/embed/preview/YzKBwwQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Visuellement, l'image d'en haut reflète la lumière de manière plus convaincante, mais toujours pas parfaite.  La lumière blanche est trop brillante et le matériau semble plus nervuré que métallique (et nous nous efforçons de le faire).  Nous pouvons obtenir un meilleur résultat en utilisant <i>MeshStandardMaterial.</i> <br><br><h4>  MeshStandartMaterial </h4><br>  <i>Utile pour une grande précision mais une faible productivité.</i> <br><br>  C'est le matériau le plus précis de tous, bien que son utilisation entraîne des coûts d'utilisation de plus d'énergie.  <i>MeshStandartMaterial est</i> utilisé avec des paramètres de <i>métal</i> et de <i>rugosité</i> supplémentaires, chacun prenant une valeur comprise entre 0 et 1. <br><br>  Le paramètre de <i>métal</i> affecte la façon dont l'objet se reflète, se rapprochant de la nature du métal.  En effet, les matériaux conducteurs comme les métaux ont des propriétés réfléchissantes différentes, contrairement aux diélectriques tels que la céramique. <br><br>  <i>La rugosité</i> ajoute une couche supplémentaire pour la personnalisation.  Vous pouvez l'imaginer comme l'opposé du brillant: 0 - très brillant, 1 - très mat. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> material = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.MeshStandardMaterial({ <span class="hljs-attr"><span class="hljs-attr">color</span></span>: <span class="hljs-number"><span class="hljs-number">0xfcc742</span></span>, <span class="hljs-attr"><span class="hljs-attr">emissive</span></span>: <span class="hljs-number"><span class="hljs-number">0x111111</span></span>, <span class="hljs-attr"><span class="hljs-attr">specular</span></span>: <span class="hljs-number"><span class="hljs-number">0xffffff</span></span>, <span class="hljs-attr"><span class="hljs-attr">metalness</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">roughness</span></span>: <span class="hljs-number"><span class="hljs-number">0.55</span></span>, });</code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://codepen.io/BretCameron/embed/preview/gOYqPMv" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  C'est le matériel le plus réaliste de tous présenté dans Three.js, mais aussi le plus consommateur de ressources <br><br>  Les matériaux dont nous avons discuté ci-dessous sont ceux que j'ai rencontrés le plus souvent et vous pouvez voir toutes les options dans le dock. <br><br><h3>  Chargeurs </h3><br>  Comme nous l'avons vu ci-dessus, vous pouvez définir manuellement la géométrie et les maillages polygonaux.  En pratique, les gens chargent souvent leurs géométries à partir de fichiers.  Heureusement, Three.js a peu de téléchargeurs pris en charge qui prennent en charge de nombreux formats 3D. <br><br>  L' <i>ObjectLoader</i> principal charge le fichier JSON en utilisant le <i>format d'objet / scène JSON</i> .  La plupart des chargeurs de démarrage doivent être importés manuellement.  Vous pouvez trouver une liste complète des chargeurs de démarrage pris en charge ici et les importer.  Vous trouverez ci-dessous une petite liste de ce que vous pouvez importer. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// GLTF import { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js'; // OBJ import { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader.js'; // STL import { STLLoader } from 'three/examples/jsm/loaders/STLLoader.js'; // FBX import { FBXLoader } from 'three/examples/jsm/loaders/FBXLoader.js'; // 3MF import { 3MFLoader } from 'three/examples/jsm/loaders/3MFLoader.js';</span></span></code> </pre> <br>  Le format recommandé pour la visualisation en ligne est GLTF, car le format est «destiné à fournir des actifs en runtime, compact pour le transfert et rapide pour le téléchargement». <br><br>  Bien sûr, il peut y avoir de nombreuses raisons de préférer un certain type de fichier (par exemple, si la qualité est une priorité ou si la précision est nécessaire pour l'impression 3D).  Les meilleures performances en ligne seront lors de l'importation de GLTF. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { GLTFLoader } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'three/examples/jsm/loaders/GLTFLoader.js'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> model <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../models/sample.gltf'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> loader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GLTFLoader(); loader.load(model, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">geometry</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// if the model is loaded successfully, add it to your scene here }, undefined, function (err) { console.error(err); });</span></span></code> </pre> <br><h3>  Tout mettre ensemble </h3><br>  L'une des raisons pour lesquelles Three.js peut sembler intimidante est que vous pouvez créer quelque chose à partir de zéro avec seulement quelques lignes de code.  Dans chaque exemple ci-dessus, nous devions créer une scène et une caméra.  Pour simplifier, j'ai gardé ce code en dehors de la portée de la revue, mais pour l'instant nous allons voir à quoi il ressemblera. <br><br>  La façon dont vous organisez votre code dépend de vous.  Dans des exemples plus simples, comme dans cet article, il est logique d'écrire tout le code en un seul endroit.  Mais en pratique, il est utile de séparer les éléments individuels pour la possibilité d'étendre la base de code et sa gestion. <br><br>  Par souci de simplicité, nous considérerons les éléments qui sont dessinés comme un seul objet, nous allons donc mettre tout le code dans un seul fichier. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Import dependencies import * as THREE from 'three'; import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js'; //   const scene = new THREE.Scene(); scene.background = new THREE.Color(0x282c34); //  ,       const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 10000); camera.position.z = 5; //  ""      const renderer = new THREE.WebGLRenderer(); renderer.setSize(window.innerWidth, window.innerHeight); //   DOM   renderer.domElement   document.getElementById('threejs').appendChild(renderer.domElement); //  ,      DOM  let controls = new OrbitControls(camera, document.getElementById('threejs')); controls.target.set(0, 0, 0); controls.rotateSpeed = 0.5; controls.update(); //  ( )   const geometry = new THREE.TorusKnotGeometry(10, 1.3, 500, 6, 6, 20); //    const material = new THREE.MeshStandardMaterial({ color: 0xfcc742, emissive: 0x111111, specular: 0xffffff, metalness: 1, roughness: 0.55, }); //   ,       const mesh = new THREE.Mesh(geometry, material); mesh.scale.x = 0.1; mesh.scale.y = 0.1; mesh.scale.z = 0.1; scene.add(mesh); //  ,       const frontSpot = new THREE.SpotLight(0xeeeece); const frontSpot2 = new THREE.SpotLight(0xddddce); frontSpot.position.set(1000, 1000, 1000); frontSpot2.position.set(-500, -500, -500); scene.add(frontSpot); scene.add(frontSpot2); //   ,           const animate = function () { requestAnimationFrame(animate); mesh.rotation.x += 0.005; mesh.rotation.y += 0.005; mesh.rotation.z += 0.005; renderer.render(scene, camera); }; //    animate();</span></span></code> </pre> <br><h3>  Dois-je utiliser un framework? </h3><br>  Enfin, il est temps de discuter de l'opportunité d'utiliser Three.js avec votre framework préféré?  À l'heure actuelle, il existe un bon package de réactif à <i>trois fibres</i> pour React.  Pour les utilisateurs de React, l'utilisation d'un package comme celui-ci présente des avantages évidents: vous conservez une structure de travail avec des composants qui vous permet de réutiliser du code. <br><br>  Pour les débutants, je vous conseille de commencer avec le <i>Vanila JS</i> habituel, car la plupart des documents en ligne écrits sur Three.js concernent Three.js sur Vanila JS.  Sur la base de mon expérience d'apprentissage, cela peut être déroutant et difficile à apprendre via un package - par exemple, vous devrez traduire des objets et des méthodes Three.js en composants et accessoires.  (dès que vous apprenez Three.js, vous pouvez utiliser n'importe quel package). <br><br><h3>  Comment ajouter Three.js au framework </h3><br>  Three.js fournit un objet HTML (le plus souvent appelé <i>renderer.domElement</i> ) qui peut être ajouté à n'importe quel objet HTML de votre application.  Par exemple, si vous avez un <i>div</i> avec <i>id = "threejs",</i> vous pouvez simplement inclure le code suivant dans votre code Three.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'threejs'</span></span>).appendChild(renderer.domElement);</code> </pre> <br>  Certains frameworks ont des chemins préférés pour accéder aux nœuds DOM de l'arborescence.  Par exemple, <i>ref</i> dans React, <i>$ ref</i> dans Vue ou <i>ngRef</i> dans Angular et cela ressemble à un énorme avantage sur fond d'accès direct aux éléments DOM.  À titre d'exemple, regardons une implémentation rapide de React. <br><br><h3>  Stratégie pour React </h3><br>  Si vous utilisez React, il existe un moyen d'incorporer des fichiers Three.js dans l'un de vos composants.  Dans le fichier <i>ThreeEntryPoint.js,</i> nous écrirons le code suivant: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ThreeEntryPoint</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sceneRef</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> renderer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> THREE.WebGLRenderer(); <span class="hljs-comment"><span class="hljs-comment">// ... sceneRef.appendChild(renderer.domElement); }</span></span></code> </pre><br>  Nous l'exportons en tant que fonction qui prend un argument: une référence à un élément de notre composant.  Nous pouvons maintenant créer notre composant <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ThreeEntryPoint <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./threejs/ThreeEntryPoint'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ThreeContainer</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ componentDidMount() { ThreeEntryPoint(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.scene); } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;&gt; &lt;div ref={element =&gt; this.scene = element} /&gt; &lt;/&gt; ); } }</code> </pre> <br>  La fonction <i>ThreeEntryPoint</i> importée <i>doit</i> être appelée dans la méthode <i>componentDidMount</i> et passer le nouveau <i>div</i> comme argument en utilisant des références <br>  Comme exemple de cette approche en action, vous pouvez cloner le référentiel et l'essayer vous-même: <a href="https://github.com/BretCameron/three-js-sample">https://github.com/BretCameron/three-js-sample</a> . <br><br><h2>  Conclusion </h2><br>  Il y a encore beaucoup de choses que je peux parler de Three.js, mais j'espère que cet article vous a donné suffisamment d'informations pour commencer à utiliser cette technologie puissante.  Quand j'ai commencé à apprendre Three.js, je n'ai pas pu trouver une seule ressource comme cet article, j'espère donc avoir aidé à rendre cette technologie plus accessible pour les débutants. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr477956/">https://habr.com/ru/post/fr477956/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr477938/index.html">Le marché des serveurs d'occasion en Russie: tout a commencé avec Habr</a></li>
<li><a href="../fr477940/index.html">Benchmarking ORM utilisé lors de la création d'applications Android</a></li>
<li><a href="../fr477944/index.html">Situation: prise en charge de Python 2.7 interrompue depuis 2020</a></li>
<li><a href="../fr477946/index.html">«Couvrez vos traces et partez pour le week-end»: comment vous retirer des services les plus populaires</a></li>
<li><a href="../fr477950/index.html">La première règle d'antifraude est de ne parler à personne d'antifraude</a></li>
<li><a href="../fr477958/index.html">Top 10 des tendances du nouveau rapport High-Tech-Tech Crime Trends 2019/2020 Group-IB</a></li>
<li><a href="../fr477964/index.html">Deux mois de l'idée à la première vente: l'expérience de l'équipe Genesis</a></li>
<li><a href="../fr477968/index.html">Falling into a Rabbit Hole: A Story about One Varnish Reboot Error - Partie 1</a></li>
<li><a href="../fr477974/index.html">Vivado: mode Picasso</a></li>
<li><a href="../fr477976/index.html">Visualisation et analyse de la structure de la communauté à l'aide de graphiques</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>