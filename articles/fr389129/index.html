<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëá üôèüèº ‚õ∑Ô∏è Nouveau microcontr√¥leur domestique de contr√¥le moteur K1921VK01T de OJSC NIIET üë©üèæ‚Äçüîß üå± üç§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="D'une mani√®re ou d'une autre, la nouvelle de l'apparition d'un nouveau microcontr√¥leur K1921VK01T de OJSC NIIET a √©t√© pass√©e . Comment est-il remarqua...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nouveau microcontr√¥leur domestique de contr√¥le moteur K1921VK01T de OJSC NIIET</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/npf_vektor/blog/389129/"><img src="https://habrastorage.org/files/a97/a7f/0cf/a97a7f0cf9454cfb9f64cdb540e00f40.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'une mani√®re ou d'une autre, la nouvelle de l'apparition d'un nouveau microcontr√¥leur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">K1921VK01T de OJSC NIIET a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √©t√© pass√©e </font><font style="vertical-align: inherit;">. Comment est-il remarquable? Ses p√©riph√©riques destin√©s √† contr√¥ler les moteurs √©lectriques (motocontr√¥le). Ce ne sont pas seulement quelques canaux PWM. Il s'agit de neuf modules PWM sophistiqu√©s √† deux canaux (PWM), dont trois modules (HRPWM) avec un mode de r√©solution ¬´haute¬ª. Il s'agit de six modules de capture CAP 32 bits distincts. Vingt-quatre (!) Canaux d'ADC 12 bits avec un gestionnaire de lancement flexible, un moyenneur int√©gr√© et des comparateurs num√©riques. Deux d√©codeurs en quadrature (QEP), un tas d'interfaces de communication, une m√©moire utilisateur interne, des horloges - tout cela sur le c≈ìur ARM Cortex-M4F avec un m√©gaoctet de m√©moire flash ¬´√† bord¬ª et une performance de 100 MIPS! Int√©ressant?</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, afin de ne pas lister toutes les caract√©ristiques techniques du produit dans l‚Äôarticle, je l‚Äôenvoie sur la page du site </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">du fabricant</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il y a √† la fois une courte liste et une fiche technique compl√®te (m√™me si elle se cache toujours dans diff√©rents coins du site et au moment de la r√©daction, vous pouvez la t√©l√©charger ... √† partir du tableau des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©veloppements en cours</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Et dans l'article, je ferais mieux de vous dire quelque chose qui n'est pas √©crit dans les fiches techniques.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un peu d'histoire</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les travaux sur le microcontr√¥leur (ci-apr√®s d√©nomm√© MK) ont d√©but√© en 2012 par la soci√©t√© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NPP Digital Solutions,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur ordre d' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OJSC NIIET</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Voronej.). Des licences ont √©t√© acquises pour le c≈ìur ARM Cortex-M4F et certains modules p√©riph√©riques de communication, et certains des modules ont √©t√© d√©velopp√©s par cette soci√©t√© ind√©pendamment: modules PWM, un contr√¥leur ADC (pas l'ADC lui-m√™me, mais un gestionnaire pour sa gestion), un module de capture CAP et un module d√©codeur en quadrature QEP. NPP Digital Solutions a d'abord produit une maquette de microcontr√¥leur sur le FPGA Kintex7, qui a impl√©ment√© toute la logique du futur microcontr√¥leur, y compris le c≈ìur ARM. Mais FPGA est un produit librement reprogrammable qui vous permet de corriger les erreurs dans la logique MK si elles sont d√©tect√©es apr√®s avoir pass√© les tests (ceci en plus des tests sur simulateur). Mais comment tester un microcontr√¥leur Motorcontrol? En plus des tests synth√©tiques, bien s√ªr, sur la vraie t√¢che de contr√¥ler un moteur √©lectrique! Pour cela, NPP "Digital Solutions" s'est tourn√© vers nous - en</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NPF Vector LLC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car nous avons beaucoup d'exp√©rience dans le domaine des entra√Ænements √©lectriques bas√©s sur MK Texas Instruments </font></font><strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mais plut√¥t parce que nous sommes assis dans un b√¢timent voisin</font></font></strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Lors de discussions conjointes lors de la conception de p√©riph√©riques pour la commande de moteurs √©lectriques, il a √©t√© d√©cid√© de prendre TMS320F28335 Texas Instruments (TI) comme mod√®le, car ce microcontr√¥leur poss√®de probablement les p√©riph√©riques de commande de motocyclette les plus puissants et flexibles, √† juste titre respect√©s dans le monde entier. Par cons√©quent, arm√© de fiches techniques TI, ¬´Digital Solutions¬ª a cr√©√© sur leur base la logique interne des modules PWM, CAP et QEP pour le K1921VK01T. En outre, sur la base de notre exp√©rience avec TI MK, nous avons √©galement propos√© certaines am√©liorations qui manquent √† TI. Il s'agit d'un filtre d'impulsions courtes dans un module PWM (tous les pilotes de touches d'alimentation comme l'ouverture / la fermeture pendant une tr√®s courte p√©riode de temps, l'IGBT peut passer en mode lin√©aire), ce sont certaines des nuances du module de d√©codeur en quadrature, qui vous permettent de vous d√©barrasser des probl√®mes de commutation des diviseurs de compteur sur le pouce etc.Les ¬´solutions num√©riques¬ª les ont prises en compte et ont √©tendu les fonctionnalit√©s p√©riph√©riques en cons√©quence par rapport aux modules TI.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alors que NPP Digital Solutions a d√©velopp√© la logique interne des modules, NPF Vector a organis√© un stand pour tester le futur microcontr√¥leur. C'√©tait un petit convertisseur de fr√©quence avec six transistors ("servo amplificateur"), qui √©tait connect√© par des circuits de commande au microcontr√¥leur prototype sur le FPGA, et la partie puissance √©tait connect√©e √† un petit servomoteur avec des capteurs de position Hall (pour v√©rifier le module CAP) et un capteur de position en quadrature (pour v√©rifier le module QEP ) Notre objectif √©tait le suivant: √©crire un logiciel pour le microcontr√¥leur pour assurer un contr√¥le vectoriel √† part enti√®re du moteur √©lectrique en utilisant n'importe quel capteur de position de votre choix ou les deux √† la fois. Et, bien s√ªr, de signaler tous les probl√®mes d√©tect√©s dans la p√©riph√©rie √† ¬´Digital Solutions¬ª.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malgr√© de nombreux tests de MK √† Digital Solutions, de nombreuses erreurs ont √©t√© trouv√©es lors des tests sur un moteur √©lectrique sous tension. Fondamentalement, ils √©taient associ√©s √† une impl√©mentation inexacte de la logique de bloc interne, qui n'√©tait pas explicitement d√©crite dans les fiches techniques de Texas Instruments. Par exemple, que devrait produire le module PWM si le point de consigne de comparaison est d√©fini au-dessus de la p√©riode de temporisation? Ou si un diviseur de signal d'entr√©e est inclus pour un d√©codeur en quadrature, le module doit-il d√©tecter un changement dans le sens de rotation par un signal divis√© ou par l'entr√©e d'origine? Les r√©ponses √† ces questions peuvent √™tre √©videntes pour l'entra√Ænement √©lectrique, mais pas √©videntes pour l'architecte de la logique du microcontr√¥leur. Dans la mesure du possible, nous avons d√©tect√© des bogues similaires avec Digital Solutions. Le variateur a fonctionn√© avec succ√®s en contr√¥le vectoriel sans aucun probl√®me.Cependant, bien s√ªr, nous n'avons pas pu couvrir tous les bogues avec de tels tests - √† coup s√ªr, dans d'autres t√¢ches, les erreurs recommenceront √† appara√Ætre. Mais pour cela, il y a des errata et de nouvelles r√©visions de microcontr√¥leurs: pour corriger les bugs, il faut d'abord les collecter. Apr√®s avoir d√©bogu√© la logique MK sur le FPGA avec "Digital Solutions", le "c√¢blage" du MK (ou autre) a √©t√© fait</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s'appelle-t-il des</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> microcontr√¥leurs? </font><font style="vertical-align: inherit;">Topologie?), Apr√®s quoi tous les r√©sultats des travaux ont √©t√© transf√©r√©s au NIIET. </font><font style="vertical-align: inherit;">Soit dit en passant, nous avons d√©j√† trouv√© plusieurs erreurs apr√®s la sortie de MK dans la "pierre", mais NIIET les a consid√©r√©es suffisamment critiques pour changer la disposition de MK: elles s'accumulent davantage - elles vont la r√©parer.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Titre</font></font></h1><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/086/09f/ff5/08609fff50fd4295ba078743bb8a0811.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je dois aussi dire que le microcontr√¥leur a surv√©cu √† plusieurs noms. </font><font style="vertical-align: inherit;">Au d√©but, pendant le d√©veloppement, il avait le nom de code ¬´MS01¬ª, puis le lot exp√©rimental de pierres s'appelait NT32M4F1, puis il est devenu K1921VK01T (en outre, √† certains endroits, les lettres sont √©crites en russe, dans d'autres lettres anglaises). </font><font style="vertical-align: inherit;">Par cons√©quent, si vous voyez ces noms dans les premiers articles et publications sur ce MK, ne soyez pas surpris.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combien cher?</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Actuellement (d√©but 2016), le NIIET est pr√™t √† vendre le premier lot de microcontr√¥leurs, qui a d√©j√† commenc√© √† arriver chez les clients. Les cristaux sont en </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">partie</font></a><font style="vertical-align: inherit;"> en plastique, en </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">partie</font></a><font style="vertical-align: inherit;"> en c√©ramique (de sorte que dans les applications critiques, cela ne fonctionne pas comment vous </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-m√™me_vous savez_ce_</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) Il semble que le prix de la pierre en plastique √† la fin de 2015 soit l√©g√®rement inf√©rieur √† 3 tr, ce qui est sup√©rieur au prix du TI TMS320F28335 lors de l'achat en Russie (au moment de la r√©daction du pr√©sent document, le coefficient de conversion de ¬´leurs¬ª prix en ¬´les n√¥tres¬ª √©tait de 76). Cependant, dans le TMS320F28335, il n'y a pas de m√©moire utilisateur et d'heures, vous devez en d√©finir des externes, car le co√ªt devient finalement comparable. Cela rend K1921VK01T prometteur non seulement en termes de substitution des importations, mais aussi pour de simples ¬´int√©r√™ts commerciaux¬ª. Bien que cette comparaison, bien s√ªr, ne soit pas tout √† fait correcte - vous pouvez trouver un tas d'exemples de cristaux moins chers sur le Cortex-M4F et avec une fr√©quence d'horloge plus √©lev√©e, mais avec moins de p√©riph√©riques. Par cons√©quent, pour des t√¢ches simples, le K1921VK01T sera excessivement grand et co√ªteux. Mais pour l'application principale (contr√¥le des moteurs √©lectriques et √©lectronique de puissance complexe) - elle est comp√©titive.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'avons-nous des performances?</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Nous avons fait une pr√©sentation √† l'exposition √† ce sujet il y a un an, la pr√©sentation peut √™tre trouv√©e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nos tests, bien s√ªr, ne pr√©tendent pas √™tre particuli√®rement pr√©cis - apr√®s tout, nous n'avons pas ex√©cut√© de v√©ritables rep√®res, mais nous avons ¬´enroul√©¬ª le m√™me syst√®me de contr√¥le vectoriel dans le test (et quoi d'autre peut exciter les entra√Ænements √©lectriques?). Mais une br√®ve relecture de la pr√©sentation est la suivante: l'architecture ARM Cortex-M4F est en retard sur le DSP de base C28 TI dans les calculs moyens requis pour les t√¢ches d'entra√Ænement. Si vous r√©duisez la pr√©cision des calculs, lorsque cela est possible, en utilisant des fonctions trigonom√©triques approximatives, etc., vous pouvez r√©duire cet √©cart √† environ 15%. Mais en m√™me temps, la fr√©quence d'horloge des c≈ìurs C28 sup√©rieurs (le m√™me TMS320F28335) est de 150 MHz, et la fr√©quence de K1921VK01T est de 100 MHz. Par cons√©quent, avec toutes les optimisations de biblioth√®que, le K1921VK01T est √©quivalent en puissance de calcul quelque part √† la s√©rie TI piccolo MK avec une fr√©quence de 90 MHz. Ce qui peut √™tre interpr√©t√© comme ... tr√®s bien, √† notre avis,car si vous utilisez correctement toutes les cloches et sifflets mat√©riels du nouveau MK comme le DMA et les mesures ADC auto-filtrantes, vous pouvez √©conomiser beaucoup sur les cycles d'horloge. D'une mani√®re ou d'une autre, nous avons r√©ussi √† ¬´bourrer¬ª dans K1921VK01T notre projet de performance le plus exigeant, bas√© sur le TMS320F2810 (150 MHz, c≈ìur C28), qui tombe d√©j√† dans ce m√™me 2810.</font></font><br>
<br>
<h1>     ?</h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et qu'est-ce qui pourrait leur arriver, c'est ARM! Normal, sans "mais". Prenez n'importe quel JTAG, n'importe quel environnement de d√©veloppement, mais ... non, apr√®s tout, aucun ne fonctionnera. ¬´Mais¬ª est le firmware de la m√©moire flash. Malgr√© le fait que le noyau ARM lui-m√™me soit normalis√© et que tout JTAG et environnement se connecte au K1921VK01T, ce n'est pas si simple avec le firmware flash. Il semble que chaque fabricant de microcontr√¥leurs consid√®re qu'il est de son devoir de faire ses propres registres pour travailler avec le firmware de sa m√©moire flash, donc les cr√©ateurs d'outils de d√©veloppement sont tourment√©s avec le soutien de tout ce zoo. Le K1921VK01T n'est pas loin derri√®re √† cet √©gard non plus - il existe √©galement des m√©thodes de travail avec le flash. Mais si pour les √©minents fabricants, les programmeurs de m√©moire flash (pilote, clignotant ou comment dois-je l'appeler?) Dans les environnements de d√©veloppement sont √©crits et fonctionnent pr√™ts √† l'emploi, alors pour K1921VK01T, tout ne fonctionne que pour ces environnementspour lequel les programmeurs ont √©crit au NIIET. Heureusement, pour IAR et Keil, tout est pr√™t et des exemples de projets avec des instructions de firmware peuvent √™tre trouv√©s sur</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Forum NIIET</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ainsi que dans le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©f√©rentiel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ouvert </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">sur Bitbucket</font></a><font style="vertical-align: inherit;"> , qui est maintenu par NIIET. De plus, chez NPF Vector, nous avons √©crit la prise en charge de la programmation du flash K1921VK01T pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenOCD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Ouvrir le d√©bogueur sur puce). C'est une telle couche entre le d√©bogueur GDB et le fer sous la forme de diff√©rents √©mulateurs JTAG et de diff√©rentes pierres. Mais pendant que nous tirions la ¬´r√©vision de code¬ª dans le r√©f√©rentiel OpenOCD avec la r√©solution des conflits, les d√©veloppeurs NIIET ont √©crit la m√™me chose, mais la leur √©tait meilleure (ils ont √©galement ajout√© la fonction de gravure utilisateur en plus de graver la m√©moire flash principale), mais ... ce sont toutes les paroles. Que donne cet OpenOCD? Il s'agit d'une sorte de couche d'abstraction du fer, qui vous permet de cr√©er votre propre environnement de d√©veloppement gratuit et gratuit pour K1921VK01T bas√© sur n'importe quel IDE populaire. Nous, dans le ¬´Vector¬ª, aimons Eclipse (parce que l'environnement TI Code Composer Studio, bas√© sur la v4, est bas√© sur lui, nous y sommes habitu√©s </font></font><strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et g√©n√©ralement, il n'y a pas de meilleur IDE au monde qu'Eclipse</font></font></strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) Et les d√©veloppeurs de NIIET ont cr√©√© un environnement de d√©veloppement sur Qt Creator. Mais, en g√©n√©ral, le sens est le m√™me ici et l√†: il prend l'environnement, prend l'ensemble des outils de d√©veloppement crois√© gratuits pour GCC, prend le plug-in pour travailler avec OpenOCD, OpenOCD lui-m√™me, quelques configurations, un peu de magie ... et vous travaillez d√©j√† pleinement avec K1921VK01T, en oubliant IAR et Keil. Au moment d'√©crire ces lignes, nous avons </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publi√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> notre assemblage Eclipse (nous l'avons nomm√© VectorIDE) pour K1921VK01T </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">sur notre site Web</font></a><font style="vertical-align: inherit;"> , voir la recette de Qt Creator sur le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forum NIIET</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Personnellement, nous menons tous les projets pour K1921VK01T dans un environnement gratuit et nous vous conseillons - l'ensemble des compilateurs GCC n'est pas vraiment √† la tra√Æne des IAR de marque (voir notre m√™me </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr√©sentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), mais si vous √™tes une entreprise r√©put√©e, vous n'avez pas besoin d'acheter des logiciels import√©s co√ªteux (d√©j√† avec un facteur de conversion de </font></font><strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">76, Karl!</font></font></strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 78!). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ah oui. Il y a encore une chose. Il s'appelle </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Codemaster ++ [ARM]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Il s'agit d'un environnement de d√©veloppement 100% national, y compris les compilateurs, et √©galement con√ßu pour K1921VK01T. Nous avons examin√© ses premi√®res versions il y a un an, mais nous avons constat√© qu'il n'√©tait pas encore pr√™t, un peu en termes de compilateurs et beaucoup en termes de facilit√© d'√©dition de code (bien que cela puisse rivaliser avec l'IAR, qui sait ce que je veux dire). Mais il est petit et rapide, et sur l'interface, il ressemble √† une sorte de d√©bogueur "hacker" comme OllyDbg (comparer: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). En g√©n√©ral, quelqu'un sera peut-√™tre int√©ress√©. Je dois dire que les d√©veloppeurs (entreprise</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´Fiton¬ª</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) a fait de gros efforts, a m√™me demand√© √† un moment donn√© notre benchmark √† la ¬´vector engine control¬ª afin d'optimiser ses compilateurs.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'avons-nous avec les kits de d√©bogage?</font></font></h1><br>
<img src="https://habrastorage.org/files/8ec/122/5f7/8ec1225f7ca24599a4a47bb25091e9f1.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D√©but 2016, quatre cartes de d√©bogage sur K1921VK01T sont connues dans la nature. Il s'agit de notre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VectorCARD K1921BK01T</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et d'autres ... de concurrents. Ok, tant </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , voici les liens </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">LDM-HELPER-K1921BK01T</font></a><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MBS-K1921VK01T</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Il semble √©galement que le NIIET lui-m√™me ait sa propre carte NIIET_1921BK01T, mais sur son site, il me semble que je me cache - si quelqu'un trouve un lien, je serai heureux de compl√©ter l'article. Quelle est la diff√©rence entre eux? Nous ne vendons pas une carte nue, mais un kit avec un onduleur, un moteur √©lectrique, un contr√¥le vectoriel dans les codes source C (bas√© sur ce que nous avons √©crit √† l'√©poque pour Digital Solutions), ainsi qu'un programme de haut niveau et un pilote CANopen pour surveiller tous les processus √† l'int√©rieur du lecteur - voir notre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">premier article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Par cons√©quent, si vous voulez simplement jouer avec le nouveau MK, faire clignoter une LED ou envoyer des donn√©es via diverses interfaces de communication, il est pr√©f√©rable d'acheter des cartes de d√©bogage concurrentes (bien que nous ayons √©galement une option de carte nue pour 15 tr, mais elle est compl√®tement "nue" - quelques conclusions). Cependant, si vous souhaitez cr√©er un entra√Ænement √©lectrique sur le nouveau MK, notre kit et logiciel de d√©bogage peuvent vous faire √©conomiser une demi-ann√©e ou un an de temps de d√©veloppement (ou peut-√™tre plus, selon que vous connaissez la th√©orie de l'entra√Ænement √©lectrique et si vous avez vos propres outils de d√©bogage et d'oscilloscope). similaire au n√¥tre). Si vous lisez attentivement le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">premier article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, alors, souvenez-vous probablement que le d√©bogage d'un syst√®me de commande pour un entra√Ænement √©lectrique sans moyen de visualiser les processus √† l'int√©rieur est impossible. Et si chez Texas Instruments l'environnement de d√©veloppement est capable d'afficher des oscillogrammes ¬´pr√™ts √† l'emploi¬ª bas√©s sur les donn√©es de la matrice de m√©moire de MK, pour ARM dans des environnements de d√©veloppement universels (pas d'un fabricant sp√©cifique de MK), une telle fonction n'a pas encore √©t√© observ√©e (si les d√©veloppeurs Fiton l'ont lu - Souhaitez-vous finaliser votre Codemaster ++ [ARM] avec le g√©n√©rateur d'oscilloscope? C'est facile √† faire!). Dans notre kit de d√©bogage, de tels moyens de visualisation des formes d'onde sont pr√©sents, vous pouvez donc voir imm√©diatement tout ce qui est cens√© contr√¥ler les moteurs √©lectriques: la forme des courants de phase, les tensions, les entr√©es / sorties de tous les r√©gulateurs, etc. Le prix de notre kit est important, environ 130 tr.(un seul moteur √©lectrique avec tous les capteurs de position co√ªte actuellement environ 30 tr). Mais pour une organisation souhaitant apprendre un nouveau produit, cela ne devrait pas √™tre critique - un environnement de d√©veloppement commercial pour ARM seul peut co√ªter plus cher.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inconv√©nients de K1921VK01T</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quels sont les principaux inconv√©nients du nouveau K1921VK01T? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Premi√®rement, il s'agit sans aucun doute d'un produit brut, car il a √©t√© r√©ellement programm√© jusqu'√† pr√©sent par 10 √† 20 personnes. </font><font style="vertical-align: inherit;">Lorsque plus de d√©veloppeurs y seront install√©s, des bugs seront d√©tect√©s - de nouvelles r√©visions seront publi√©es. </font><font style="vertical-align: inherit;">Alors pr√©parez-vous. </font><font style="vertical-align: inherit;">Mais, n√©anmoins, ils peuvent tordre les moteurs - tordus personnellement. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Pour le moment, la documentation est √©galement humide. </font><font style="vertical-align: inherit;">Il y a peu d'erreurs, mais certaines choses sont expliqu√©es ... ce n'est pas tout √† fait clair. </font><font style="vertical-align: inherit;">On pourrait peindre un peu plus en d√©tail, donner des exemples. </font><font style="vertical-align: inherit;">Je pense qu'avec le temps, ce sera finalis√©.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Le microcontr√¥leur est tr√®s grand et sophistiqu√©. C'est pour quelqu'un un plus, pour quelqu'un un moins. Tr√®s peu d'applications couvrent la gamme compl√®te de ses capacit√©s. NIIET pense d√©j√† √† une s√©rie de MK bas√©e sur lui, avec diff√©rents b√¢timents et un ensemble de p√©riph√©riques. Mais pour l'instant - il n'y a que K1921VK01T.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Il a un ADC sp√©cifique. Souvent, les fabricants MK installent un module ADC rapide (12 MS / s) et le multiplexent sur plusieurs canaux - par exemple, cela a √©t√© fait par Texas Instruments dans la s√©rie C2000. Mais dans le K1921VK01T, il y a 12 modules ADC lents (1.7MS / s) √† deux canaux fonctionnant en parall√®le. Pourquoi est-ce mauvais en plus de l'incapacit√© de mesurer quelque chose tr√®s rapidement? S'il y a un ADC dans le MK, alors sur la carte contr√¥leur, vous pouvez envoyer des signaux de r√©f√©rence calibr√©s, disons 1V et 2V, √† deux canaux inutilis√©s, et les utiliser pour calculer et compenser l'erreur multiplicative et l'erreur de biais de cet ADC, √©tendant la correction √† tous les canaux (l'ADC en est un ) Quand il y a beaucoup d'ADC dans MK, une telle astuce ne fonctionnera pas - ils auront tous leurs propres erreurs personnelles. Nous avons utilis√© l'astuce d'√©talonnage sur le Texas Instruments MK type TMS320F2810 (cela est d√©crit dans la fiche technique et recommand√©),ici dans K1921VK01T sans √©talonnage, nous avons obtenu une pr√©cision inf√©rieure de l'ADC par rapport au TMS320F2810 √©talonn√©. Nous avons d√ª cr√©er un support sp√©cial pour calibrer chaque module ADC K1921VK01T ind√©pendamment et assembler la table de calibrage dans la m√©moire utilisateur int√©gr√©e. Ensuite, la pr√©cision des mesures analogiques s'est av√©r√©e comparable (l'√©talonnage ne flotte presque pas loin de la temp√©rature - il a √©t√© v√©rifi√©). Probablement, NIIET devrait flasher une telle table en usine, ce serait pratique. Mais alors que le flash est vide.Ensuite, la pr√©cision des mesures analogiques s'est av√©r√©e comparable (l'√©talonnage ne flotte presque pas loin de la temp√©rature - il a √©t√© v√©rifi√©). Probablement, NIIET devrait flasher une telle table en usine, ce serait pratique. Mais alors que le flash est vide.Ensuite, la pr√©cision des mesures analogiques s'est av√©r√©e comparable (l'√©talonnage ne flotte presque pas loin de la temp√©rature - il a √©t√© v√©rifi√©). Probablement, NIIET devrait flasher une telle table en usine, ce serait pratique. Mais alors que le flash est vide.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ La fr√©quence de 100 MHz, bien s√ªr, est plut√¥t basse, je voudrais qu'elle soit plus rapide. Mais c'est-√†-dire. Bien qu'√† certains endroits, ils √©crivent la fr√©quence de 125 MHz - tout d√©pend de la temp√©rature ambiante. "Digital Solutions" a rapport√© de telles informations non officielles: l'int√©rieur du cristal est con√ßu pour un maximum de 125 degr√©s. La temp√©rature est d'environ 15 degr√©s sup√©rieure √† celle de l'environnement. Selon le projet, K1921VK01T devrait fonctionner √† 85 degr√©s de l'environnement + r√©serve, ce qui est garanti d'√™tre atteint √† 100 MHz. En fait, MK peut √™tre acc√©l√©r√© au-dessus de 100 MHz, les √©chantillons individuels fonctionnaient √† 140-170 MHz, mais cela d√©pend de l'√©chantillon. Par cons√©quent, si le cristal n'est pas surchauff√©, il peut √™tre dispers√© si quelqu'un en a besoin. Mais si dans votre application il fait chaud (+85), alors il vaut mieux ne pas intimider au dessus de 100 MHz.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Il n'y a pas de chargeur de d√©marrage officiel (programmeur) via les interfaces de communication (CAN, RS). </font><font style="vertical-align: inherit;">La couture MK n'est possible que via JTAG / SWD. </font><font style="vertical-align: inherit;">Par cons√©quent, si le contr√¥leur de produit est dans un bo√Ætier ferm√©, vous devez √©crire votre chargeur de d√©marrage pour l'interface de communication souhait√©e. </font><font style="vertical-align: inherit;">Ou attendez que NIIET √©crive. </font><font style="vertical-align: inherit;">Jusqu'√† pr√©sent, non, mais je pense que cela appara√Ætra.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que quoi d'autre soit la conclusion? </font><font style="vertical-align: inherit;">Tout ne fait que commencer! </font><font style="vertical-align: inherit;">Enfin, il y a un microcontr√¥leur domestique sur lequel vous pouvez vraiment faire un entra√Ænement √©lectrique! </font><font style="vertical-align: inherit;">Avant cela, tous les MK nationaux existants √©taient soit faibles par le noyau, soit faibles par la p√©riph√©rie afin de faire face aux t√¢ches de contr√¥le de la motocyclette. </font><font style="vertical-align: inherit;">Mais maintenant - libert√© totale pour les structures de contr√¥le les plus complexes et l'unit√© de puissance la plus complexe. </font><font style="vertical-align: inherit;">Je voudrais surtout noter les perspectives de ce microcontr√¥leur pour servo variateurs de machine. </font><font style="vertical-align: inherit;">Jusqu'√† pr√©sent, en Russie, il n'√©tait pas possible de fabriquer une machine de pr√©cision multiaxes enti√®rement domestique, car (l'une des raisons) il n'y avait rien pour faire fonctionner un servomoteur de haute qualit√©. </font><font style="vertical-align: inherit;">Il existe maintenant un tel microcontr√¥leur.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr389129/">https://habr.com/ru/post/fr389129/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr389119/index.html">Ajout et configuration de la base de donn√©es 1C sur le serveur</a></li>
<li><a href="../fr389121/index.html">Firefox 46 prendra en charge plusieurs moniteurs avec diff√©rentes densit√©s de pixels</a></li>
<li><a href="../fr389123/index.html">M√©thodes de d√©bogage d'un logiciel de microcontr√¥leur dans un entra√Ænement √©lectrique</a></li>
<li><a href="../fr389125/index.html">Galactosismologie: comment les galaxies naines compos√©es de mati√®re noire laissent des traces dans le gaz interstellaire</a></li>
<li><a href="../fr389127/index.html">Marketing agressif ou en quoi la motivation d'un arc lumineux au poignet ("babioles") diff√®re de la motivation d'un bracelet de fitness</a></li>
<li><a href="../fr389133/index.html">Les chiens reconnaissent les √©motions humaines √† travers plusieurs sens</a></li>
<li><a href="../fr389139/index.html">Drinky est un robot copain qui est toujours l√†</a></li>
<li><a href="../fr389141/index.html">Discussion: m√©lomanes et audiophiles, lecteurs r√©seau et acoustique int√©gr√©e</a></li>
<li><a href="../fr389143/index.html">Google Street View atteint le pays des merveilles miniature</a></li>
<li><a href="../fr389145/index.html">Comment emp√™cher les terroristes d'utiliser des drones</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>