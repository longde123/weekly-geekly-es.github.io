<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🏫 ♾ 🤤 Telegram-bot + Google Analytics 👞 📻 🍉</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salam untuk para Habravite. Saya ingin berbicara tentang bagaimana kami mengacaukan Google Analytics ke bot telegram, masalah apa yang kami temui, dan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Telegram-bot + Google Analytics</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442610/">  Salam untuk para Habravite.  Saya ingin berbicara tentang bagaimana kami mengacaukan Google Analytics ke bot telegram, masalah apa yang kami temui, dan apa yang akhirnya gagal dikonfigurasi. <br><br>  Dengan cara lama, Google Analytics diinstal di situs dengan domain atau aplikasi dengan SDK.  Googling topik, menjadi jelas bahwa tidak ada contoh, jadi kami memutuskan untuk melakukannya sendiri.  Dalam kasus kami, tidak ada situs web atau aplikasi seluler, tetapi ada keinginan untuk melacak acara di bot Telegram.  Dan sebagian itu ternyata dilakukan. <br><br><h4>  Masalah nomor 1 </h4><br>  Bot secara fisik terletak di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">t.me/benice_tools_bot</a> .  Ini mirip dengan situs biasa, tetapi tanpa akses langsung ke file root, untuk mengatur kode penghitung, dan mengkonfigurasi acara. <br>  Frontend dalam hal ini adalah Telegram itu sendiri, di mana kita tidak memiliki akses. <br><br>  Bot kami bekerja dengan API Binance dan API Telegram, dan karenanya ada backend yang memungkinkan manuver dengan pengaturan analitik. <br><a name="habracut"></a><br>  Di Google Analytics, mereka membuat penghitung "untuk situs", dan acara yang terdaftar dengan parameter "Tindakan, Label, Kategori".  Pengaturan terperinci dijelaskan di banyak situs.  Dan setelah itu, masalah pertama muncul. <br><br>  Dengan metode Google standar, tidak mungkin untuk menempatkan target di bot, tidak ada akses ke depan. <br><br>  Sebuah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">perpustakaan datang ke</a> penyelamatan, yang memungkinkan pengiriman dan pemrosesan parameter acara dari backend. <br><br>  Setelah menyiapkan, kami mulai menguji kapasitas kerja metode ini, dan mendapatkan kesuksesan pertama.  Peristiwa yang diselesaikan mulai ditampilkan di Google Analytics, dalam mode "waktu nyata" terlihat berapa banyak orang yang online di bot, dan data lainnya. <br><br><img src="https://habrastorage.org/webt/8o/ev/ob/8oevobwe99rx7dxi9pl8uvvbaqg.png" alt="gambar"><img src="https://habrastorage.org/webt/t2/2n/uf/t22nuf8ontvrxjnq9edjj-_8nf4.png" alt="gambar"><br><br>  Setelah pengujian independen, dan pengguna dari lalu lintas iklan, menjadi jelas bahwa informasi yang kami butuhkan adalah 100% dapat diandalkan.  Menjadi jelas berapa banyak orang yang online, dan acara spesifik apa yang sedang dilakukan. <br><br>  Namun masih ada beberapa kesalahan.  Misalnya, jenis perangkat tidak terdeteksi dengan benar, "Komputer desktop" ditampilkan, bahkan jika Anda menggunakan Telegram dari perangkat seluler.  Lokasi hanya mengindikasikan Yunani, karena server dengan bot berada di negara ini.  Demografi, minat, browser, dan OS ditampilkan sebagai "(tidak disetel)". <br><br><h4>  Masalah nomor 2 </h4><br>  Kami membuat tautan promosi yang, ketika diaktifkan, memberikan akses ke fitur berbayar selama 7 hari.  Dan klik pada tautan ini harus ditautkan dengan Google Analytics untuk menganalisis kampanye iklan. <br><br>  Secara default, Google Analytics sendiri menghasilkan id pengguna atau membiarkannya tanpa parameter ini.  Namun, Anda dapat membuat id khusus Anda sendiri, dan mengirimkannya ke Google. <br><br>  Kami menggunakan metode ini.  Kami menciptakan akuntansi pengguna melalui userId terenkripsi dari sistem kami. <br><br>  Telegram mentransmisikan meta-data saat bot mulai.  Ini bekerja dengan cara yang sama seperti tag utm yang sudah dikenal <br>  Di tautan, untuk kampanye iklan, label dimasukkan setelah mulai. <br><br>  Sebagai contoh: <br><br><pre><code class="plaintext hljs">http://t.me/benice_tools_bot?start=habrahabr</code> </pre> <br>  Saat bot dimulai, kami menguraikan parameter untuk memulai, dan mengambilnya untuk kampanye tertentu. <br>  Di backend, di profil pengguna, akan ada informasi bahwa ia datang untuk kampanye campaign_habrahabr tertentu. <br><br>  Tetap menentukan pengunjung kami dalam kode: <br><br><pre> <code class="plaintext hljs">if (!code) code = "organic"; const visitor = ua(googleAnalyticsProjectId, `token:${code};CLIENTID:${saltUserId}`, { strictCidFormat: false }); visitor.event(category, action, label).send();</code> </pre> <br>  Jika pengguna datang sendiri, tanpa kampanye iklan, maka sumber ini dikenali sebagai "organik". <br><br>  Jadi, ternyata menganalisis pemicu tujuan dari pengguna tertentu yang berasal dari kampanye iklan. <br><br><img src="https://habrastorage.org/webt/5t/gw/ia/5tgwial2j4ofjbg_vj6cl62clro.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/tl/sp/in/tlspin0eyxsnh9vkeeuaiadzrzm.png" alt="gambar"><br><br><h4>  PS </h4><br>  Semua panggilan ke Google Analytics berakhir dengan kebingungan dari sisi dukungan.  Pada panggilan pertama, ketika tidak ada lagi yang berhasil, tidak ada tips yang bisa diperoleh.  Dan ketika acara sudah ditransfer ke analytics, dukungan mengambil istirahat 15 menit untuk "memperjelas rincian" dari pertanyaan, dan ketika mereka kembali, mereka sendiri mulai mengajukan pertanyaan: "Bagaimana Anda melakukan ini?" </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id442610/">https://habr.com/ru/post/id442610/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id442598/index.html">Apakah Headhunter dibutuhkan?</a></li>
<li><a href="../id442600/index.html">Sistem otomasi rumah saya</a></li>
<li><a href="../id442602/index.html">Apakah kecepatan penurunan kecepatan berkurang?</a></li>
<li><a href="../id442606/index.html">Objek Domain dengan Lombok: Battle Classic</a></li>
<li><a href="../id442608/index.html">Dompet dingin pertukaran cryptocurrency QuadrigaCX, pendiri yang meninggal, ternyata kosong</a></li>
<li><a href="../id442612/index.html">Mesin kardus untuk permainan papan listrik. Bagaimana kami membawanya lebih dekat dengan kenyataan</a></li>
<li><a href="../id442614/index.html">CI / CD menggunakan Jenkins di Kubernetes</a></li>
<li><a href="../id442616/index.html">Kami mempercepat pemrosesan acara menjadi 1,6 juta per detik</a></li>
<li><a href="../id442618/index.html">Tidak untuk selfie: uji immunosorbent terkait-enzim digital menggunakan chip baru yang tertanam dalam smartphone</a></li>
<li><a href="../id442620/index.html">Pembelajaran mesin dalam pemantauan TI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>