<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîî üë®üèΩ‚Äçüåæ üóúÔ∏è PHP asynchrone. Pourquoi? üßõüèΩ üåÇ üå©Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La programmation asynchrone est aujourd'hui tr√®s demand√©e, en particulier dans le d√©veloppement Web, o√π la r√©activit√© des applications est particuli√®r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PHP asynchrone. Pourquoi?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skyeng/blog/448968/"><img src="https://habrastorage.org/webt/vr/yd/zc/vrydzcqx0ogo5vfy-a2uzf0wmgs.jpeg" alt="image"><br><br>  La programmation asynchrone est aujourd'hui tr√®s demand√©e, en particulier dans le d√©veloppement Web, o√π la r√©activit√© des applications est particuli√®rement importante.  Personne ne veut attendre que l'application ¬´s'affaisse¬ª, m√™me si √† ce moment-l√† elle ex√©cute une requ√™te dans la base de donn√©es, envoie un e-mail ou travaille sur d'autres t√¢ches qui peuvent prendre beaucoup de temps.  Le client veut une r√©ponse √† son action, le meilleur de tous - tout de suite.  Si votre application est lente, vous perdez des clients.  Face √† une application en vol stationnaire, le plus souvent l'utilisateur la ferme simplement et ne revient jamais.  Du point de vue de l'utilisateur, l'application vient de se bloquer, il ne peut pas comprendre pourquoi cela s'est produit: effectue-t-il une op√©ration complexe ou a-t-il cess√© de fonctionner en principe. <br><br>  <i>Pr√©sentation de la traduction d'un article du d√©veloppeur back-end de Skyeng, Sergey Zhuk.</i> <br><a name="habracut"></a><br><h3>  R√©activit√© des applications </h3><br>  Les applications modernes sont souvent r√©actives, mais certaines t√¢ches ou op√©rations, telles que l'√©change de donn√©es sur un r√©seau, les E / S de fichiers ou l'interrogation d'une base de donn√©es, peuvent prendre du temps et ralentir consid√©rablement l'application.  Pour emp√™cher de telles op√©rations de bloquer l'application, vous pouvez les ex√©cuter en arri√®re-plan, masquant ainsi le retard qu'elles provoquent.  Dans le m√™me temps, l'application reste sensible car elle peut continuer √† effectuer d'autres t√¢ches, par exemple, renvoyer le flux de contr√¥le √† l'interface utilisateur ou r√©pondre √† d'autres √©v√©nements. <br><br><h3>  Concurrence et asynchronie </h3><br>  Lorsque les gens voient du code asynchrone, le plus souvent, ils pensent imm√©diatement: "G√©nial, je peux parall√©liser les processus!".  Je peux vous d√©cevoir, mais en fait ce n'est pas le cas.  L'asynchronie et la concurrence ne sont pas la m√™me chose.  Il peut √™tre difficile de saisir cette diff√©rence, alors essayons de le comprendre. <br><br>  Si les t√¢ches sont ex√©cut√©es de mani√®re asynchrone, elles ne se bloquent pas et l'ex√©cution d'une t√¢che ne d√©pend pas de l'ach√®vement d'une autre.  La concurrence, √† son tour, implique le lancement de plusieurs t√¢ches distinctes simultan√©ment en tant qu'unit√©s de travail ind√©pendantes. <br><br>  Asynchronie: <br><blockquote>  Allez terminer la t√¢che <b>vous-m√™me</b> .  Faites-moi savoir quand vous avez termin√© et montrez-moi le r√©sultat.  En ce moment, je peux continuer √† faire mon travail. </blockquote><br>  Le code asynchrone n√©cessite le traitement des d√©pendances qui surviennent lors de l'ex√©cution des t√¢ches, et cela est impl√©ment√© √† l'aide de rappels.  Lorsqu'une t√¢che est termin√©e, le code notifie une autre t√¢che.  Le code asynchrone concerne essentiellement le temps n√©cessaire √† la t√¢che (ordre des √©v√©nements). <br><img src="https://habrastorage.org/webt/zu/np/3h/zunp3hgp9rim8pbath4tidi_icu.png" alt="image"><br>  Acc√®s simultan√©: <br><blockquote>  <b>Embauchez autant de travailleurs que vous le souhaitez</b> et partagez la t√¢che entre eux pour la terminer plus rapidement et pr√©venez-moi lorsque vous avez termin√©.  Je peux continuer √† faire d'autres choses ou, si la t√¢che est urgente, je vais rester et attendre que vous reveniez avec les r√©sultats.  Ensuite, je peux composer le r√©sultat final de tous les employ√©s.  L'ex√©cution parall√®le n√©cessite souvent plus de ressources, donc ici cela d√©pend essentiellement du mat√©riel. </blockquote><br><img src="https://habrastorage.org/webt/o9/ty/fp/o9tyfphmymspkaemitwjnhrikx0.png" alt="image"><br>  Pour comprendre la diff√©rence entre une ex√©cution asynchrone et parall√®le en utilisant un exemple r√©el, nous comparons deux serveurs Web populaires: Apache et Nginx.  Ils illustrent parfaitement cette diff√©rence.  Nginx utilise un mod√®le asynchrone bas√© sur les √©v√©nements tandis qu'Apache utilise des threads parall√®les.  Apache cr√©e de nouveaux threads pour chaque connexion suppl√©mentaire, donc ici le nombre maximum de connexions autoris√©es d√©pend de la quantit√© de m√©moire disponible dans le syst√®me.  Lorsque la limite de connexion est atteinte, Apache cesse de cr√©er des connexions suppl√©mentaires.  Le facteur limitant lors de la configuration d'Apache est la m√©moire (rappelez-vous que l'ex√©cution parall√®le d√©pend souvent du mat√©riel).  Si le thread s'arr√™te, le client attend une r√©ponse jusqu'√† ce que le thread soit libre et peut envoyer une r√©ponse. <br><br>  Nginx ne fonctionne pas comme Apache - il ne cr√©e pas de nouveaux threads pour chaque demande entrante.  Nginx a un flux de travail principal (ou plusieurs travailleurs, souvent pour un processeur il y a un flux de travail), qui est monothread.  Ce travailleur peut traiter des milliers de connexions "simultan√©ment" et le fait de mani√®re asynchrone, dans un thread, et non en parall√®le dans plusieurs threads. <br><br>  Ainsi, ¬´l'asynchronie¬ª est la fa√ßon dont nous construisons le syst√®me, c'est une composition de processus ind√©pendants les uns des autres.  Par ¬´ex√©cution parall√®le¬ª, on entend l'ex√©cution de plusieurs processus en m√™me temps, alors qu'ils peuvent √™tre li√©s ou non.  En ex√©cution asynchrone, nous traitons plusieurs t√¢ches √† la fois et en ex√©cution parall√®le, nous d√©marrons plusieurs processus en m√™me temps.  Cela peut sembler √™tre la m√™me chose, mais ce n'est pas le cas.  L'asynchronie d√©crit une structure, le parall√©lisme d√©crit une fa√ßon de le faire. <br><br>  L'ex√©cution asynchrone peut √™tre compar√©e aux p√©riph√©riques d'E / S de votre ordinateur (souris, clavier, √©cran).  Ils sont tous g√©r√©s par le syst√®me d'exploitation, mais chacun d'eux est une partie ind√©pendante du noyau.  Ces processus sont asynchrones, ils peuvent √™tre parall√®les, mais ce n'est pas n√©cessaire.  Ainsi, afin d'assurer la coh√©rence, vous devez cr√©er un lien entre ces pi√®ces ind√©pendantes afin de les coordonner. <br><br><h3>  Et ce backend? </h3><br>  Vous pouvez dire que la r√©activit√© n'est pas si importante sur le backend.  Toutes ces choses asynchrones sympas avec JavaScript se produisent sur un freeend, et votre serveur r√©pond simplement aux demandes, donc un freeend devrait √™tre responsable de la r√©activit√© de l'application, mais pas vous.  Oui, c'est vrai, mais la t√¢che du serveur ne se limite pas aux r√©ponses de l'API.  Parfois, vous devez g√©rer des t√¢ches complexes, par exemple, t√©l√©charger une vid√©o.  Dans ce cas, la r√©activit√© n'est peut-√™tre pas un facteur cl√©, mais son manque de ressources est gaspill√© car l'application doit √™tre inactive.  Il peut attendre la fin des op√©rations du syst√®me de fichiers, des interactions r√©seau, des requ√™tes de base de donn√©es, etc.  Souvent, ces op√©rations d'E / S sont tr√®s lentes par rapport aux calculs du processeur, par exemple lorsque nous convertissons des fichiers vid√©o.  Et tandis que nous enregistrons ou lisons lentement le fichier, le processeur est oblig√© de se mettre en veille au lieu de faire un travail utile.  Comme nous l'avons d√©j√† d√©couvert, au lieu d'attendre, nous pouvons ex√©cuter ces t√¢ches en arri√®re-plan.  Comment?  Allez-y. <br><br><h3>  PHP asynchrone </h3><br>  En JavaScript, pr√™t √† l'emploi, un support int√©gr√© et des solutions pour l'√©criture de code asynchrone sont disponibles.  Il existe √©galement Node.js, qui vous permet d'√©crire des applications serveur asynchrones.  En JavaScript, nous pouvons utiliser la fonction setTimeout () pour illustrer un exemple de code asynchrone: <br><img src="https://habrastorage.org/webt/j-/tx/mt/j-txmtg4lym_eu5fwk2qakt_s08.png" alt="image"><br><br>  Lorsque nous ex√©cuterons ce code, nous verrons ce qui suit: <br><img src="https://habrastorage.org/webt/bk/fk/2r/bkfk2r_onqq6_yhyqzqbzsuqod8.png" alt="image"><br><br>  La fonction setTimeout () envoie le code √† la file d'attente et l'ex√©cute √† la fin de la pile d'appels actuelle.  Cela signifie que nous interrompons le flux synchrone de code et retardons l'ex√©cution.  Le deuxi√®me appel √† console.log () est effectu√© avant l'appel √† la file d'attente √† l'int√©rieur de l'appel setTimeout (). <br><br>  Et PHP?  En PHP, nous n'avons pas d'outils adapt√©s adapt√©s pour √©crire du code vraiment asynchrone.  Il n'y a pas d'√©quivalent √† setTimeout (), et nous ne pouvons pas simplement retarder ou mettre en file d'attente n'importe quel code.  C'est pourquoi des frameworks et des biblioth√®ques comme Amp et ReactPHP ont commenc√© √† appara√Ætre.  Leur id√©e est de masquer les d√©tails du langage de bas niveau et de donner √† l'utilisateur des outils de haut niveau qui vous permettent d'√©crire du code asynchrone et de contr√¥ler l'ex√©cution comp√©titive de processus comme JavaScript et Node.js. <br><br><h3>  Pourquoi devrais-je utiliser PHP s'il y a Node.js et Go? </h3><br>  Cette question se pose souvent quand il s'agit de PHP asynchrone.  Pour une raison quelconque, beaucoup sont contre l'utilisation de PHP pour √©crire du code asynchrone.  Quelqu'un sugg√®re toujours d'utiliser Go ou Node.js. au lieu de PHP. <br><br>  Le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tweet</a> assertchris d√©crit parfaitement ces situations: <br><br><img src="https://habrastorage.org/webt/hz/gd/gs/hzgdgsarcixle4sahqsvummqkvs.png" alt="image"><br><br>  Bien s√ªr, lorsque PHP venait juste d'√™tre cr√©√©, il n'y avait aucun but d'en faire un langage de programmation pouvant √™tre utilis√© pour cr√©er de grandes applications complexes.  A cette √©poque, personne ne pensait √† JavaScript ou √† l'asynchronie.  Mais maintenant, nous avons un PHP compl√®tement diff√©rent qui a d√©j√† ses propres fonctions pour √©crire du code asynchrone (par exemple, la fonction stream_select ()). <br><br>  Oui, vous pouvez utiliser Go ou Node.js pour cr√©er des applications de serveur asynchrones, mais cela ne r√©sout pas toujours le probl√®me.  Si vous avez d√©j√† une vaste exp√©rience de PHP, il vous sera beaucoup plus facile d'apprendre simplement les biblioth√®ques et les outils qui conviennent √† votre situation que d'apprendre un nouveau langage et un nouvel √©cosyst√®me.  Des outils comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ReactPHP</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Amp</a> vous permettent d'√©crire du code asynchrone comme vous le faites dans Node.js.  Ces outils sont assez d√©velopp√©s et ont des versions stables, vous pouvez donc les utiliser en toute s√©curit√© en production. <br><br><h3>  Pas seulement CLI </h3><br><blockquote>  Je ne vais pas √©crire un chat, un serveur ou quelque chose comme √ßa.  Je veux juste acc√©l√©rer le site. </blockquote><br>  Il est g√©n√©ralement admis que le code asynchrone ne peut √™tre utilis√© que dans les scripts CLI.  Il est absolument normal d'int√©grer certains composants asynchrones dans un environnement synchrone traditionnel, m√™me dans une application Web traditionnelle.  Par exemple, vous pouvez recevoir une demande, puis appeler plusieurs ressources diff√©rentes de mani√®re asynchrone, et lorsque ces appels sont termin√©s, vous pouvez continuer le cycle de vie r√©ponse-demande et, par cons√©quent, la page s'affiche plus rapidement. <br><br>  Ou vous devez effectuer des appels API externes - par exemple, lorsqu'un utilisateur effectue un paiement, vous souhaitez envoyer un e-mail ou une notification push.  Vous pouvez effectuer ces appels d'API de mani√®re asynchrone, puis poursuivre votre flux de code synchrone traditionnel.  Il n'est pas n√©cessaire de r√©√©crire compl√®tement l'application et de supprimer tout ce qui ralentit.  Identifiez simplement les goulots d'√©tranglement qui interf√®rent avec les performances, et il est possible qu'ils puissent √™tre corrig√©s √† l'aide de code asynchrone. <br><br>  Oui, le code asynchrone est dans la plupart des cas toujours utilis√© dans les scripts CLI, mais il n'est pas limit√© aux chats et serveurs en temps r√©el.  Si vous voulez simplement acc√©l√©rer votre site, vous n'avez pas besoin de renoncer √† votre framework Symfony ou Laravel et de cr√©er votre propre serveur d'applications compl√®tement asynchrone. <br><br><h3>  Conclusion </h3><br>  N'ayez pas peur d'apprendre un nouveau paradigme.  PHP est bien plus que ¬´ex√©cuter un script, ex√©cuter du code et mourir¬ª.  Vous serez surpris lorsque vous r√©aliserez que vous pouvez utiliser le PHP familier d'une mani√®re compl√®tement nouvelle, comme vous ne l'avez jamais utilis√©!  Le code asynchrone et la programmation orient√©e √©v√©nement vous permettront de mieux comprendre PHP et les possibilit√©s d'utilisation de ce langage.  Vous n'avez pas besoin d'apprendre un nouveau langage pour √©crire des applications asynchrones simplement parce que "PHP est un outil inappropri√©" ou "J'ai toujours fait cela, il ne peut pas √™tre am√©lior√©."  Essayez-le! <br><br>  Eh bien, nous vous rappelons √©galement que nous avons toujours beaucoup de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">postes vacants int√©ressants</a> pour les d√©veloppeurs! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr448968/">https://habr.com/ru/post/fr448968/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr448958/index.html">Comment Amazon choisit ses offres apparemment al√©atoires de la journ√©e. Et pourquoi les vendeurs les poursuivent-ils</a></li>
<li><a href="../fr448960/index.html">La technologie XR illimit√©e √† l'√®re de l'informatique distribu√©e</a></li>
<li><a href="../fr448962/index.html">L'efficacit√© de l'entonnoir marketing AARRR</a></li>
<li><a href="../fr448964/index.html">Le grille-pain donne aux utilisateurs plus de droits</a></li>
<li><a href="../fr448966/index.html">Application Android en m√©moire. Rapport d'optimisation pour Yandex.Luncher</a></li>
<li><a href="../fr448970/index.html">Authentification √† deux facteurs pour SSH</a></li>
<li><a href="../fr448974/index.html">Approche sans serveur pour le d√©veloppement rapide d'un service vid√©o fonctionnel</a></li>
<li><a href="../fr448976/index.html">Les √©v√©nements du printemps de Gamedev au HSE</a></li>
<li><a href="../fr448980/index.html">Notre premier d√©jeuner ensemble: pourquoi et comment nous passons notre journ√©e de test</a></li>
<li><a href="../fr448982/index.html">CMS sans t√™te. Pourquoi j'√©cris le mien</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>