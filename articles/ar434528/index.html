<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฆ ๐คฌ ๐ฉ ุจุญุฌู ุจุทุงูุฉ ุจุฑูุฏูุฉ ูู ุชุดููุฑ ุงูุชุชุจุน ๐ ๐จ๐ฝโ๐ณ ๐ง</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""ููุฏ ูุนู ุฐูู ูุฑุฉ ุฃุฎุฑู!" - ูุฐุง ูู ูุง ุญุฏุซ ูู ุฃูู ุดูุก ุนูุฏูุง ูุธุฑุช ุฅูู ุงูุฌุฒุก ุงูุฎููู ูู ูุดุฑุฉ Pixar [1] ุ ุงููููุฆุฉ ุจุงููุงูู ุจุงูููุฏ. ุชู ุชูููุน ูุฌููุนุฉ ูู ุงูุฅูุดุงุกุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุจุญุฌู ุจุทุงูุฉ ุจุฑูุฏูุฉ ูู ุชุดููุฑ ุงูุชุชุจุน</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434528/" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/cr/xz/vj/crxzvjqqbw5gl4mv3wxxx2zw6wa.png"></div><br>  "ููุฏ ูุนู ุฐูู ูุฑุฉ ุฃุฎุฑู!" - ูุฐุง ูู ูุง ุญุฏุซ ูู ุฃูู ุดูุก ุนูุฏูุง ูุธุฑุช ุฅูู ุงูุฌุฒุก ุงูุฎููู ูู ูุดุฑุฉ Pixar <sup>[1]</sup> ุ ุงููููุฆุฉ ุจุงููุงูู ุจุงูููุฏ.  ุชู ุชูููุน ูุฌููุนุฉ ูู ุงูุฅูุดุงุกุงุช ูุงูุนุจุงุฑุงุช ูู ุงูุฒุงููุฉ ุงููููู ุงูุณููู ูู ูุจู ุฃูุฏุฑู ูููุณูุฑ.  ุจุงููุณุจุฉ ูุฃููุฆู ุงูุฐูู ูุง ูุนุฑูููู ุ ุณุฃููู: ุฃูุฏุฑู ูู ูุจุฑูุฌ ุงุฎุชุฑุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฌูุงุฒ ุชุชุจุน ุจุญุฌู</a> 1337 ุจุงูุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุญุฌู ุจุทุงูุฉ ุงูุนูู</a> ูู ุนุงู 2009. <br><br>  ูุฐู ุงููุฑุฉ ุ ุชูุตู ุฃูุฏุฑู ุฅูู ุดูุก ุฃูุซุฑ ุถุฎุงูุฉ ุ ูููู ุจูุชูุฌุฉ ูุฑุฆูุฉ ุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู.  ููุฐ ุฃู ุฃูููุช ูุชุงุจุชู Game Engine Black Books ุนู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Wolf3D</a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DOOM</a> ุ ูุงู ูุฏู ููุช ูุชุนูู ุงูุฏูุงููู ุงูุดูุฑุฉ ุงููุดูุฑุฉ.  ูุนูู ุงูููุฑ ุชูุฑูุจูุง ุ ููุช ููุชูููุง ุญููุง ุจุงูุชูููุงุช ุงูููุชุดูุฉ ููู.  ูุงูุช ูุฎุชููุฉ ุชูุงููุง ุนู ุนูู ุฃูุฏุฑู ุงูุณุงุจู ุ ุจูุงุกู ุนูู ุฌูุงุฒ ุชุชุจุน ุดุนุงุน "ููุงุณู".  ููุฏ ููุช ููุชููุง ุจุงูุชุนุฑู ุนูู ูุณูุฑุฉ ุงูุดุนุงุน ุ ูุฎุตุงุฆุต ุงูููุฏุณุฉ ุงูุญุฌุฑูุฉ ุงูุจููุงุกุฉ ุ ูุชูุฏูู / ูุณุงุฑ ูููุช ูุงุฑูู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุงูุนุฏูุฏ ูู ุงูุญูู ุงูุฃุฎุฑู ุงูุชู ุงุณุชุฎุฏููุง ููุถุบุท ุนูู ุงูููุฏ ูู ูุทุนุฉ ุตุบูุฑุฉ ูู ุงููุฑู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/yc/z4/nt/ycz4ntg3qh91i6m2wymfccaekvk.png"></div><a name="habracut"></a><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/lf/2o/qv/lf2oqvd5d39pyfwxyixvjnrmlqq.png"></div><br><h2 style=";text-align:right;direction:rtl">  ุดูุฑุฉ ุงููุตุฏุฑ </h2><br><hr><br>  ุงูุฌุฒุก ุงูุฃูุงูู ูู ุงูููุดูุฑ ูู ุฅุนูุงู ููุณู ุงูุชูุธูู ูู ุจููุณุงุฑ.  ุนูู ุงูุฌุงูุจ ุงูุนูุณู ุ ุชุชู ุทุจุงุนุฉ 2037 ุจุงูุช ูู ุฑูุฒ C ++ ุ ูุนุชููุง ุจุญูุซ ุชุดุบู ุฃุตุบุฑ ุณุทุญ ูููู. <br><br><pre style=";text-align:right;direction:rtl"><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdlib.h&gt; // card &gt; pixar.ppm #include &lt;stdio.h&gt; #include &lt;math.h&gt; #define R return #define O operator typedef float F;typedef int I;struct V{F x,y,z;V(F v=0){x=y=z=v;}V(F a,F b,F c=0){x=a;y=b;z=c;}V O+(V r){RV(x+rx,y+ry,z+rz);}VO*(V r){RV(x*rx,y*r. y,z*rz);}FO%(V r){R x*r.x+y*r.y+z*rz;}VO!(){R*this*(1/sqrtf(*this%*this) );}};FL(F l,F r){R l&lt;r?l:r;}FU(){R(F)rand()/RAND_MAX;}FB(V p,V l,V h){l=p +l*-1;h=h+p*-1;RL(L(L(lx,hx),L(ly,hy)),L(lz,hz));}FS(V p,I&amp;m){F d=1\ e9;V f=p;fz=0;char l[]="5O5_5W9W5_9_COC_AOEOA_E_IOQ_I_QOUOY_Y_]OWW[WaOa_aW\ eWa_e_cWiO";for(I i=0;i&lt;60;i+=4){V b=V(l[i]-79,l[i+1]-79)*.5,e=V(l[i+2]-79,l [i+3]-79)*.5+b*-1,o=f+(b+e*L(-L((b+f*-1)%e/(e%e),0),1))*-1;d=L(d,o%o);}d=sq\ rtf(d);V a[]={V(-11,6),V(11,6)};for(I i=2;i--;){V o=f+a[i]*-1;d=L(d,ox&gt;0?f\ absf(sqrtf(o%o)-2):(o.y+=oy&gt;0?-2:2,sqrtf(o%o)));}d=powf(powf(d,8)+powf(pz, 8),.125)-.5;m=1;F r=L(-L(B(p,V(-30,-.5,-30),V(30,18,30)),B(p,V(-25,17,-25),V (25,20,25))),B(V(fmodf(fabsf(px),8),py,pz),V(1.5,18.5,-25),V(6.5,20,25))) ;if(r&lt;d)d=r,m=2;F s=19.9-py;if(s&lt;d)d=s,m=3;R d;}IM(V o,V d,V&amp;h,V&amp;n){I m,s= 0;F t=0,c;for(;t&lt;100;t+=c)if((c=S(h=o+d*t,m))&lt;.01||++s&gt;99)R n=!V(S(h+V(.01,0 ),s)-c,S(h+V(0,.01),s)-c,S(h+V(0,0,.01),s)-c),m;R 0;}VT(V o,V d){V h,n,r,t= 1,l(!V(.6,.6,1));for(I b=3;b--;){I m=M(o,d,h,n);if(!m)break;if(m==1){d=d+n*( n%d*-2);o=h+d*.1;t=t*.2;}if(m==2){F i=n%l,p=6.283185*U(),c=U(),s=sqrtf(1-c), g=nz&lt;0?-1:1,u=-1/(g+nz),v=nx*ny*u;d=V(v,g+ny*ny*u,-ny)*(cosf(p)*s)+V( 1+g*nx*nx*u,g*v,-g*nx)*(sinf(p)*s)+n*sqrtf(c);o=h+d*.1;t=t*.2;if(i&gt;0&amp;&amp;M(h +n*.1,l,h,n)==3)r=r+t*V(500,400,100)*i;}if(m==3){r=r+t*V(50,80,100);break;}} R r;}I main(){I w=960,h=540,s=16;V e(-22,5,25),g=!(V(-3,4,0)+e*-1),l=!V(gz, 0,-gx)*(1./w),u(gy*lz-gz*ly,gz*lx-gx*lz,gx*ly-gy*lx);printf("P\ 6 %d %d 255 ",w,h);for(I y=h;y--;)for(I x=w;x--;){V c;for(I p=s;p--;)c=c+T(e ,!(g+l*(xw/2+U())+u*(yh/2+U())));c=c*(1./s)+14./241;V o=c+1;c=V(cx/ox,c. y/oy,cz/oz)*255;printf("%c%c%c",(I)cx,(I)cy,(I)cz);}}// Andrew Kensler</span></span></span></span></code> </pre> <br><h2 style=";text-align:right;direction:rtl">  ูู ูู ุญุชู ุงูุนููุ </h2><br><hr><br>  ูุน ุฑูุฒ ููุงู ุชุนูููุงุช ูุฅุทูุงููุง.  ุงูููุฑุฉ ูู ุฅุนุงุฏุฉ ุชูุฌูู ุงูุฅุฎุฑุงุฌ ุงูููุงุณู ุฅูู ููู.  ุจุงูุงูุชุฏุงุฏ ุ ูููููุง ุฃู ููุชุฑุถ ุฃู ุชูุณูู ุงูุฅุฎุฑุงุฌ ูู ุชูุณูู ุตูุฑุฉ ูุตูุฉ ูุณูู NetPBM <sup>[2]</sup> . <br><br><pre style=";text-align:right;direction:rtl">  $ clang -o card2 -O3 raytracer.cpp
 $ time ./card&gt; pixar.ppm<font></font>
<font></font>
 2m58.524s ุงูุญูููู
 ุงููุณุชุฎุฏู 2m57.567s
 ุชููุฒ ุงููููุฉ 0m0.415s </pre><br>  ุจุนุฏ ุฏูููุชูู ูุซูุงููุฉ ูุฎูุณูู ุซุงููุฉ <sup>[3]</sup> ุ ูุชู ุฅูุดุงุก ุงูุตูุฑุฉ ุงูุชุงููุฉ.  ุฅูู ูุฃูุฑ ูุฏูุด ูู ูู ูุทููุจ ุฑูุฒ ูุฐูู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/cae/b34/b5c/caeb34b5c6c57c4598adc8f6b3f28f38.webp"></div><br>  ููููู ุงุณุชุฎุฑุงุฌ ุงููุซูุฑ ูู ุงูุตูุฑุฉ ุฃุนูุงู.  ุญุตู ูู ุนูุงูุฉ ูุงุถุญุฉ ุนูู "ูุณุงุฑ ุงูุชุชุจุน".  ูุฐุง ุงูููุน ูู ุงูุนุงุฑุถ ูุฎุชูู ุนู ุงูุชุตููุฑ ุงูุดุนุงุนู ูุฃูู ูุง ูุชู ุชุชุจุน ุงูุฃุดุนุฉ ูุฑุฉ ุฃุฎุฑู ุฅูู ูุตุงุฏุฑ ุงูุถูุก.  ูู ูุฐู ุงูุทุฑููุฉ ุ ุชูุจุนุซ ุขูุงู ุงูุฃุดุนุฉ ููู ุจูุณู ูู ุงููุตุงุฏุฑ ููููู ุงูุจุฑูุงูุฌ ุจูุฑุงูุจุชูุง ุ ุนูู ุฃูู ุฃู ูุนุซุฑูุง ุนูู ูุตุฏุฑ ุงูุถูุก.  ูุฐู ุชูููุฉ ูุซูุฑุฉ ููุงูุชูุงู ุ ุฃูุถู ุจูุซูุฑ ูู ุชุชุจุน ุงูุดุนุงุน ุ ูุงูุชู ูููููุง ุงูุชุนุงูู ูุน ุงูุชุฌุณูุฏ ุงููุญูุท ุ ูุงูุธูุงู ุงููุงุนูุฉ ุ ูุงูููุงุฏ ุงููุงููุฉ ุ ูุงูุฅุดุนุงุน. <br><br><h2 style=";text-align:right;direction:rtl">  ุณูููู ุจุชูุณูู ุงูููุฏ ุฅูู ุฃุฌุฒุงุก </h2><br><hr><br>  ูุคุฏู ุชูุฑูุฑ ุงูุฅุฏุฎุงู ุฅูู CLion ุฅูู ุชููุฆุฉ ุงูุฑูุฒ (ุงูุธุฑ ุงูุฅุฎุฑุงุฌ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> ) ูููุณูู ุฅูู ุฃุฌุฒุงุก / ููุงู ุฃุตุบุฑ. <br><br><pre style=";text-align:right;direction:rtl">  <font color="grey">#include &lt;stdlib.h&gt; // card&gt; pixar.ppm</font> <font color="grey">
</font>  <font color="grey"># ุชุถููู &lt;stdio.h&gt;</font> <font color="grey">
</font>  <font color="grey"># ุชุชุถูู &lt;math.h&gt;</font> </pre><br><pre style=";text-align:right;direction:rtl">  <font color="fuchsia"># ุญุฏุฏ ุนูุฏุฉ R</font> <font color="fuchsia">
</font>  <font color="fuchsia"># ุชุนุฑูู ุนุงูู ุงูุชุดุบูู O</font> <font color="fuchsia">
</font>  <font color="fuchsia">typedef ุชุนููู F ุ typedef int Iุ</font> </pre><pre style=";text-align:right;direction:rtl">  <font color="blue">ุงูุจููุฉ V {F xุ yุ zุ V (F v = 0) {x = y = z = vุ} V (F aุ F bุ F</font> <font color="blue">
</font>  <font color="blue">c = 0) {x = aุ y = bุ z = cุ} V O + (V r) {RV (x + rxุ y + ryุ z + rz)ุ} VO * (V r) {RV ( ุณ * ุต ุ ุต * ุต.</font> <font color="blue">
</font>  <font color="blue">yุ z * rz)ุ} FOูช (V r) {R x * r.x + y * r.y + z * rzุ} VO! () {R * this * (1 / sqrtf (* thisูช * ูุฐุง)</font> <font color="blue">
</font>  <font color="blue">) ุ}} ุ</font> </pre><pre style=";text-align:right;direction:rtl">  <font color="orange">FL (F lุ F r) {R l &lt;rุ L: rุ} FU () {R (F) rand () / RAND_MAXุ} FB (V pุ V lุ V h) {l = p</font> <font color="orange">
</font>  <font color="orange">+ l * -1 ุ h = h + p * -1 ุ RL (L (L (L (L (lxุ hx) ู L (lyุ hy))ุ L (lzุ hz))ุ}</font> </pre><pre style=";text-align:right;direction:rtl">  <font color="LimeGreen">FS (V p ุ I &amp; m) {F d = 1 \</font> <font color="LimeGreen">
</font>  <font color="LimeGreen">e9 ุ V f = p ุ fz = 0ุ char l [] = "5O5_5W9W5_9_COC_AOEOA_E_IOQ_I_QOUOY_Y_] OWW [WaOa_aW \</font> <font color="LimeGreen">
</font>  <font color="LimeGreen">eWa_e_cWiO "ุ ูู (I i = 0ุ i &lt;60ุ i + = 4) {V b = V (l [i] -79ุ l [i + 1] -79) *. 5ุ e = V (l [ i + 2] -79 ุ ู</font> <font color="LimeGreen">
</font>  <font color="LimeGreen">[i + 3] -79) *. 5 + b * -1 ุ o = f + (b + e * L (-L ((b + f * -1)ูช e / (eูช e) ุ 0) ุ 1)) * - 1 ุ d = L (d ุ oูช o) ุ} d = sq \</font> <font color="LimeGreen">
</font>  <font color="LimeGreen">rtf (d) ุ V a [] = {V (-11.6) ุ V (11.6)} ุ ูู ุฃุฌู (I i = 2 ุ i - ุ) {V o = f + a [i] * -1 ุ ุฏ = L (ุฏ ุ ุซูุฑ&gt; 0ุ F \</font> <font color="LimeGreen">
</font>  <font color="LimeGreen">absf (sqrtf (oูช o) -2) :( o.y + = oy&gt; 0ุ -2: 2ุ sqrtf (oูช o)))ุ} d = powf (powf (dุ 8) + powf (pz ุ</font> <font color="LimeGreen">
</font>  <font color="LimeGreen">8) ุ 125) - .5 ุ ู = 1 ุ F r = L (-L (B (p ุ V (-30 ุ -. 5 ุ -30) ุ V (30ุ18ุ30)) ุ B (ุต ุ ุงูุฎุงูุณ (-25.17 ุ -25) ุ ุงูุฎุงูุณ</font> <font color="LimeGreen">
</font>  <font color="LimeGreen">(25ุ20ุ25))) ุ B (V (fmodf (fabsf (px) ุ 8) ุ py ุ pz) ุ V (1.5ุ18.5ุ -25)ุ V (6.5ุ20ุ25)))</font> <font color="LimeGreen">
</font>  <font color="LimeGreen">ุ ุฅุฐุง (r &lt;d) d = r ุ m = 2 ุ F s = 19.9-py ุ ุฅุฐุง (s &lt;d) d = sุ m = 3ุ R dุ}</font> </pre><pre style=";text-align:right;direction:rtl">  <font color="black">IM (V o ู V d ู V &amp; h ู V &amp; n) {I mุ s =</font> <font color="black">
</font>  <font color="black">0 ุ F t = 0 ุ c ุ ูู (ุ t &lt;100 ุ t + = c) if ((c = S (h = o + d * tุ m)) &lt;. 01 || ++ s&gt; 99) R n =! V (S (h + V (.01ุ0</font> <font color="black">
</font>  <font color="black">)ุ s) -cุ S (h + V (0ุ .01)ุ s) -cุ S (h + V (0ุ0ุ .01)ุ s) -c)ุ mุ R 0ุ}</font> </pre><pre style=";text-align:right;direction:rtl">  <font color="SkyBlue">VT (V oุ V d) {V hุ nุ rุ t =</font> <font color="SkyBlue">
</font>  <font color="SkyBlue">1 ุ l (! V (.6 ุ .6 ุ 1)) ุ ูู ุฃุฌู (I b = 3 ุ b - ุ) {I m = M (o ุ d ุ h ุ n) ุ ุฅุฐุง ูุณุฑ (! M) ุ ุฅุฐุง (ู == 1) {ุฏ = ุฏ + ู * (</font> <font color="SkyBlue">
</font>  <font color="SkyBlue">nูช d * -2) ุ o = h + d * .1 ุ t = t * .2ุ} ุฅุฐุง (m == 2) {F i = nูช lุ p = 6.283185 * U ()ุ c = U () ุ s = sqrtf (1-c) ุ</font> <font color="SkyBlue">
</font>  <font color="SkyBlue">g = nz &lt;0ุ -1: 1ุ u = -1 / (g + nz)ุ v = nx * ny * uุ d = V (vุ g + ny * ny * uุ -ny) * (cosf (ุน) * s) + V (</font> <font color="SkyBlue">
</font>  <font color="SkyBlue">1 + g * nx * nx * uุ g * vุ -g * nx) * (sinf (p) * s) + n * sqrtf (c)ุ o = h + d * .1ุ t = t *. 2 ุ ุฅุฐุง (i&gt; 0 &amp;&amp; M (h</font> <font color="SkyBlue">
</font>  <font color="SkyBlue">+ n * .1 ุ l ุ h ุ n) == 3) r = r + t * V (500ุ400ุ100) * iุ} ุฅุฐุง (m == 3) {r = r + t * V (50ุ80ุ100) ุ break ุ}}</font> <font color="SkyBlue">
</font>  <font color="SkyBlue">ุต ุต ุ}</font> </pre><pre style=";text-align:right;direction:rtl">  <font color="red">I main () {I w = 960ุ h = 540ุ s = 16ุ V e (-22ุ5ุ25)ุ g =! (V (-3ุ4ุ0) + e * -1)ุ l =! V (gz ุ</font> <font color="red">
</font>  <font color="red">0ุ -xx) * (1./w) ุ u (gy * lz-gz * ly ุ gz * lx-gx * lz ุ gx * ly-gy * lx) ุ printf ("P \</font> <font color="red">
</font>  <font color="red">6ูช dูช d 255 "ุ w ุ h) ุ ูู ุฃุฌู (I y = h ุ y - ุ) ูู (I x = w ุ x - ุ) {V c ุ ูู ุฃุฌู (I p = sุ p- - ุ) ุฌ = ุฌ + T (ู</font> <font color="red">
</font>  <font color="red">ุ! (g + l * (xw / 2 + U ()) + u * (yh / 2 + U ()))) ุ c = c * (1./s) + 14. / 241 ุ V o = c + 1 ุ c = V (cx / ox ุ c.</font> <font color="red">
</font>  <font color="red">y / oุ cz / oz) * 255ุ printf ("ูช cูช cูช c"ุ (I) cxุ (I) cyุ (I) cz)ุ}}</font> </pre><pre style=";text-align:right;direction:rtl">  <font color="LightGray">// ุฃูุฏุฑู ูููุณูุฑ</font> </pre><br>  ููุตู ูู ูุณู ุจุงูุชูุตูู ูู ุจููุฉ ุงูููุงู: <br>  <font color="fuchsia">t</font> - ุงูุญูู ุงูุนุงุฏูุฉ ุ <font color="blue">โ</font> - ูุฆุฉ ุงููุชุฌูุงุช ุ code - ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุณุงุนุฏุฉ ุ database - ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ <font color="black">mar</font> - ูุณูุฑุฉ ุฑุงู ุ <font color="SkyBlue">โ</font> - ุฃุฎุฐ ุงูุนููุงุช ุ main - ุงูููุฏ ุงูุฑุฆูุณู. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุญูู ุงููุดุชุฑูุฉ ูุน #define ู typedef </h2><br><hr><br>  ุชุณุชุฎุฏู ุงูุญูู ุงูุดุงุฆุนุฉ #define ู typedef ูุชูููู ููุฏุงุฑ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุจุดูู ููุญูุธ.  ููุง ูุดูุฑ ุฅูู F = float ู I = int ู R = return ู O = ุนุงูู ุงูุชุดุบูู.  ุงูููุฏุณุฉ ุงูุนูุณูุฉ ุชุงููุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฏุฑุฌุฉ ุงูุฎุงูุณุฉ </h2><br><hr><br>  ุจุนุฏ ุฐูู ุชุฃุชู ุงููุฆุฉ V ุ ุงูุชู ููุช ุจุฅุนุงุฏุฉ ุชุณููุชูุง ุฅูู Vec (ุนูู ุงูุฑุบู ูู ุฐูู ุ ููุง ุณูุฑู ุฃุฏูุงู ุ ูุชู ุงุณุชุฎุฏุงูู ุฃูุถูุง ูุชุฎุฒูู ูููุงุช RGB ุจุชูุณูู ุนุงุฆู). <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Vec</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> x, y, z; Vec(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> v = <span class="hljs-number"><span class="hljs-number">0</span></span>) { x = y = z = v; } Vec(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> a, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> b, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> c = <span class="hljs-number"><span class="hljs-number">0</span></span>) { x = a; y = b; z = c;} Vec <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>+(Vec r) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Vec(x + rx, y + ry, z + rz); } Vec <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>*(Vec r) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Vec(x * rx, y * ry, z * rz); } <span class="hljs-comment"><span class="hljs-comment">// dot product float operator%(Vec r) { return x * rx + y * ry + z * rz; } // inverse square root Vec operator!() {return *this * (1 / sqrtf(*this % *this) );} };</span></span></code> </pre> <br>  ูุงุญุธ ุฃูู ูุง ููุฌุฏ ุนุงูู ุทุฑุญ (-) ุ ูุฐุง ุจุฏูุงู ูู ูุชุงุจุฉ "X = A - B" ุ ูุชู ุงุณุชุฎุฏุงู "X = A + B * -1".  ูุฃุชู ุงูุฌุฐุฑ ุงูุชุฑุจูุนู ุงูุนูุณู ูููุฏูุง ูู ููุช ูุงุญู ูุชุทุจูุน ุงููุชุฌูุงุช. <br><br><h2 style=";text-align:right;direction:rtl">  ุงููุธููุฉ ุงูุฑุฆูุณูุฉ </h2><br><hr><br>  main () ูู ุงูุญุฑู ุงููุญูุฏ ุงูุฐู ูุง ูููู ุญุฌุจู ูุฃูู ูุชู ุงุณุชุฏุนุงุคู ุจูุงุณุทุฉ ุงูุฏุงูุฉ _start ูููุชุจุฉ libc.  ุนุงุฏุฉู ูุง ูุณุชุญู ุงูุจุฏุก ุจู ุ ูุฃูู ุณูููู ูู ุงูุฃุณูู ุงูุนูู ุจูุฐู ุงูุทุฑููุฉ.  ุงุณุชุบุฑู ุงูุฃูุฑ ููู ุจุนุถ ุงูููุช ููุนุฑูุฉ ูุนุงูู ุงูุญุฑูู ุงูุฃููู ุ ูููู ูุง ูุฒุงู ุจุฅููุงูู ุฅูุดุงุก ุดูุก ูููู ูุฑุงุกุชู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> w = <span class="hljs-number"><span class="hljs-number">960</span></span>, h = <span class="hljs-number"><span class="hljs-number">540</span></span>, samplesCount = <span class="hljs-number"><span class="hljs-number">16</span></span>; <span class="hljs-function"><span class="hljs-function">Vec </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">position</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-22</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">5</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">25</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; Vec goal = !(Vec(<span class="hljs-number"><span class="hljs-number">-3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + position * <span class="hljs-number"><span class="hljs-number">-1</span></span>); Vec left = !Vec(goal.z, <span class="hljs-number"><span class="hljs-number">0</span></span>, -goal.x) * (<span class="hljs-number"><span class="hljs-number">1.</span></span> / w); <span class="hljs-comment"><span class="hljs-comment">// Cross-product to get the up vector Vec up(goal.y * left.z - goal.z * left.y, goal.z * left.x - goal.x * left.z, goal.x * left.y - goal.y * left.x); printf("P6 %d %d 255 ", w, h); for (int y = h; y--;) for (int x = w; x--;) { Vec color; for (int p = samplesCount; p--;) color = color + Trace(position, !(goal + left * (x - w / 2 + randomVal())+ up * (y - h / 2 + randomVal()))); // Reinhard tone mapping color = color * (1. / samplesCount) + 14. / 241; Vec o = color + 1; color = Vec(color.x / ox, color.y / oy, color.z / oz) * 255; printf("%c%c%c", (int) color.x, (int) color.y, (int) color.z); } }</span></span></code> </pre> <br>  ูุงุญุธ ุฃู ุงูููู ุงูุญุฑููุฉ ุงูุนุงุฆูุฉ ูุง ุชุญุชูู ุนูู ุงูุญุฑู "f" ุ ููุชู ุชุฌุงูู ุงูุฌุฒุก ุงููุณุฑู ูุชูููุฑ ุงููุณุงุญุฉ.  ูุชู ุงุณุชุฎุฏุงู ููุณ ุงูุฎุฏุนุฉ ุฃุฏูุงู ุ ุญูุซ ูุชู ุฅุณูุงุท ุงูุฌุฒุก ุงูุตุญูุญ (ุชุนููู x = 0.5).  ูู ุบูุฑ ุงููุฃููู ุฃูุถูุง ุฅูุดุงุก "for" ูุน ุชุนุจูุฑ ุงูุชูุฑุงุฑ ุงูุฐู ูุชู ุฅุฏุฑุงุฌู ุฏุงุฎู ุดุฑุท ุงูุงุณุชุฑุงุญุฉ. <br><br>  ูุฐู ูู ุงููุธููุฉ ุงูุฑุฆูุณูุฉ ุงูููุงุณูุฉ ุฌุฏุง ูุชุชุจุน ุงูุฃุดุนุฉ / ุงููุณุงุฑ.  ูุชู ุชุนููู ูุชุฌูุงุช ุงููุงููุฑุง ููุง ูุชูุจุนุซ ุงูุฃุดุนุฉ ููู ุจูุณู.  ุงููุฑู ุจูู ุฌูุงุฒ ุชุชุจุน ุงูุดุนุงุน ูุฌูุงุฒ ุชุชุจุน ุงููุณุงุฑ ูู ุฃู ุงูุนุฏูุฏ ูู ุงูุฃุดุนุฉ ุชูุจุนุซ ููู ุจูุณู ูู TP ุ ูุงูุชู ุชุญููุช ุจุดูู ุนุดูุงุฆู ููููุงู.  ุซู ูุชู ุชุฌููุน ุงูููู ุงููุงุชุฌ ููู ุดุนุงุน ูู ุงูุจููุณู ูู ุซูุงุซ ูููุงุช ุนุงุฆูุฉ R ู B ู G.  ูู ุงูููุงูุฉ ุ ูุชู ุฅุฌุฑุงุก ุชุตุญูุญ ุงูุฏุฑุฌุฉ ุงูููููุฉ ููุชุงุฆุฌ ุทุฑููุฉ ุฑุงูููุงุฑุช. <br><br>  ุงูุฌุฒุก ุงูุฃูุซุฑ ุฃูููุฉ ูู sampleCount ุ ูุงูุฐู ูููู ูู ุงููุงุญูุฉ ุงููุธุฑูุฉ ุชุนูููู ุนูู 1 ูุชุณุฑูุน ุงูุชูุฏูู ูุงูุชูุฑุงุฑ.  ูููุง ููู ููุงุฐุฌ ูููุชุงุฆุฌ ูุน ููู ุนููุฉ ูู 1 ุฅูู 2048. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูููุณุฏ ุงูุนููุงู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/550/e66/b2b/550e66b2b1347f8cafdf18c50d89e40d.png"><br><br>  1 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f49/724/1f0/f497241f0e3bb43fcc9913d8a2745419.png"><br><br>  2 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f71/3f3/35c/f713f335c2842b995936db1499e307e5.png"><br><br>  4 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b4f/6d4/f56/b4f6d4f56198a64b8e569a62f7159e8a.png"><br><br>  8 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a70/200/3c6/a702003c61d4080c2f92fe84844238cd.png"><br><br>  16 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bcf/0d6/43c/bcf0d643c501839c2506c7c026bc445c.png"><br><br>  32 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8f0/5cf/569/8f05cf5690fa3265a1a4fa6f60a35749.png"><br><br>  64 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ebd/c87/660/ebdc87660263ff14eb6bf03a95865f34.png"><br><br>  128 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d17/0d3/1ae/d170d31aed20aeafc54d877ed447a1cc.png"><br><br>  256 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fb9/52c/4df/fb952c4dfd0a4cb14245cedd060dcf05.png"><br><br>  512 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/460/50f/715/46050f71582834ddebbeb29dd86940fc.png"><br><br>  1024 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/947/ea8/88b/947ea888b63c32f0892cc1e25b187bf8.png"><br><br>  2048 </div></div><br><h2 style=";text-align:right;direction:rtl">  ููุฏ ุงููุณุงุนุฏ </h2><br><hr><br>  ุขุฎุฑ ูุทุนุฉ ุจุณูุทุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู ูุธุงุฆู ุงููุณุงุนุฏ.  ูู ูุฐู ุงูุญุงูุฉ ุ ูุฏููุง ุฏุงูุฉ ุชุงููุฉ min () ุ ููููุฏ ูููุฉ ุนุดูุงุฆูุฉ ูู ุงููุงุตู ุงูุฒููู [0ุ1] ู boxTest () ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู ุ ููู ุฌุฒุก ูู ูุธุงู Constructive Solid Geometry (CSG) ุงููุณุชุฎุฏู ููุทุน ุงูุนุงูู.  ุชูุช ููุงูุดุฉ CSG ูู ุงููุณู ุงูุชุงูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">min</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> l, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> r)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> l &lt; r ? l : r; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">randomVal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) rand() / RAND_MAX; } <span class="hljs-comment"><span class="hljs-comment">// Rectangle CSG equation. Returns minimum signed distance from // space carved by lowerLeft vertex and opposite rectangle // vertex upperRight. float BoxTest(Vec position, Vec lowerLeft, Vec upperRight) { lowerLeft = position + lowerLeft * -1; upperRight = upperRight + position * -1; return -min( min( min(lowerLeft.x, upperRight.x), min(lowerLeft.y, upperRight.y) ), min(lowerLeft.z, upperRight.z)); }</span></span></code> </pre> <br><h2 style=";text-align:right;direction:rtl">  ูุธุงุฆู ุงูููุฏุณุฉ ุงูุญุฌุฑูุฉ ุงูุจูุงุกุฉ </h2><br><hr><br>  ูุง ุชูุฌุฏ ุฑุคูุณ ูู ุงูููุฏ.  ูู ุดูุก ูุชู ุจุงุณุชุฎุฏุงู ูุธุงุฆู CSG.  ุฅุฐุง ููุช ุบูุฑ ูุนุชุงุฏูุง ุนูููุง ุ ููู ุจุจุณุงุทุฉ ุฃู ูุฐู ูุธุงุฆู ุชุตู ูุง ุฅุฐุง ูุงู ุงูุฅุญุฏุงุซู ุฏุงุฎู ุงููุงุฆู ุฃู ุฎุงุฑุฌู.  ุฅุฐุง ุฃุฑุฌุนุช ุงูุฏุงูุฉ ูุณุงูุฉ ููุฌุจุฉ ุ ูุณุชููู ุงูููุทุฉ ุฏุงุฎู ุงููุงุฆู.  ุชุดูุฑ ุงููุณุงูุฉ ุงูุณุงูุจุฉ ุฅูู ุฃู ุงูููุทุฉ ุชูุน ุฎุงุฑุฌ ุงููุงุฆู.  ููุงู ุงูุนุฏูุฏ ูู ุงููุธุงุฆู ููุตู ุงููุงุฆูุงุช ุงููุฎุชููุฉ ุ ูููู ูู ุฃุฌู ุงูุชุจุณูุท ุ ููุฃุฎุฐ ุนูู ุณุจูู ุงููุซุงู ูุฑุฉ ูููุทุชูู ุ A ู B. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/56f/424/13a/56f42413a77c51a3d06e12fd4b4b385e.svg" alt="ุงูุตูุฑุฉ"></div><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Signed distance point(p) to sphere(c,r) float testSphere(Vec p, Vec c, float r) { Vec delta = c - p; float distance = sqrtf(delta%delta); return radius - distance; } Vec A {4, 6}; Vec B {3, 2}; Vec C {4, 2}; float r = 2.; testSphere(A, C, r); // == -1 (outside) testSphere(B, C, r); // == 1 (inside)</span></span></code> </pre> <br>  ุชุฑุฌุน ุงูุฏุงูุฉ testSphere () -1 ููููุทุฉ A (ุฃู ุ ูู ุฎุงุฑุฌ) ู 1 ูู B (ุฃู ุ ูู ุฏุงุฎู).  ุชุนุชุจุฑ ุงูุนูุงูุงุช ุนูู ุงููุณุงูุงุช ูุฌุฑุฏ ุฎุฏุนุฉ ุ ุญูุซ ุชุชูุญ ูู ุงูุญุตูู ุนูู ูุณููู ูู ุงููุนูููุงุช ุจุฏูุงู ูู ูุงุญุฏุฉ ูู ุญุงูุฉ ูููุฉ ูุงุญุฏุฉ.  ูููู ุฃูุถูุง ูุชุงุจุฉ ููุน ููุงุซู ูู ุงููุธุงุฆู ููุตู ูุชูุงุฒู ุงูุงุถูุงุน (ูุฐุง ูู ุจุงูุถุจุท ูุง ูุชู ุชูููุฐู ูู ุงูุฏุงูุฉ BoxTest). <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/757/1cd/25b/7571cd25baa7d2f9cfbd01f62e84aef1.svg"></div><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// Signed distance point(p) to Box(c1,c2) float testRectangle(Vec p, Vec c1, Vec c2) { c1 = p + c1 * -1; c2 = c2 + position * -1; return min( min( min(c1.x, c2.x), min(c1.y, c2.y)), min(c1.z, c2.z)); } Vec A {3, 3}; Vec B {4, 6}; Vec C1 {2, 2}; Vec C2 {5, 4}; testRectangle(A, C1, C2); // 1.41 (inside) testRectangle(B, C1, C2); // -2.23 (outside)</span></span></code> </pre> <br>  ุงูุขู ุฏุนููุง ูุฑู ูุง ูุญุฏุซ ุฅุฐุง ููุจุช ุนูุงูุฉ ุงููููุฉ ุงููุฑุฌุนุฉ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/dcd/017/bd8/dcd017bd89a9e9d3955c94be3645aa20.svg"></div><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// Signed distance point(p) to carved box(c1,c2) float testCarveBox(Vec p, Vec c1, Vec c2) { c1 = p + c1 * -1; c2 = c2 + position * -1; return -min( min( min(c1.x, c2.x), min(c1.y, c2.y)), min(c1.z, c2.z)); } Vec A {3, 3}; Vec B {4, 6}; Vec C1 {2, 2}; Vec C2 {5, 4}; testCarveBox(A, C1, C2); // == -1.41 (outside) testCarveBox(B, C1, C2); // == 2.23 (inside)</span></span></code> </pre> <br>  ุงูุขู ูุญู ูุง ูุตู ูุงุฆููุง ุตูุจูุง ุ ูููููุง ุฃุนููุง ุงูุนุงูู ููู ุตูุจูุง ูููุทุน ูุณุงุญุฉ ูุงุฑุบุฉ ููู.  ูููู ุงุณุชุฎุฏุงู ุงููุธุงุฆู ูุทูุจ ุจูุงุก ุ ูุงูุชู ูููู ุนูุฏ ุงูุฌูุน ุจูููุง ูุตู ุฃุดูุงู ุฃูุซุฑ ุชุนููุฏูุง.  ุจุงุณุชุฎุฏุงู ุนุงูู ุงูุฅุถุงูุฉ ุงูููุทููุฉ (ุฏุงูุฉ ุฏูููุฉ) ุ ูููููุง ูุทุน ุฒูุฌ ูู ุงููุณุชุทููุงุช ูุงุญุฏูุง ููู ุงูุขุฎุฑ ูุณุชุจุฏู ุงููุชูุฌุฉ ููุฐุง. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/48b/f78/615/48bf786150f9d37af1f51fd12987162e.svg"></div><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// Signed distance point to room float testRoom(Vec p) { Vec C1 {2, 4}; Vec C2 {5, 2}; // Lower room Vec C3 {3, 5}; Vec C4 {4, 4}; // Upper room // min() is the union of the two carved volumes. return min(testCarvedBox(p, C1, C2), testCarvedBox(p, C3, C4)); } Vec A {3, 3}; Vec B {4, 6}; testRoom(A, C1, C2); // == -1.41 (outside) testRoom(B, C1, C2); // == 1.00 (inside)</span></span></code> </pre> <br>  ุฅุฐุง ููุช ุชููุฑ ูู ุงูุฃูุฑ ุ ูุฅูู ูุจุฏู ููุฃูู ุงูุบุฑูุฉ ุงูุชู ูุฏุฑุณูุง ุ ูุฃูู ูุชู ุงูุชุนุจูุฑ ุนู ุงูุบุฑูุฉ ุงูุณูููุฉ ุจูุฐู ุงูุทุฑููุฉ ุจุงูุถุจุท - ุจูุณุงุนุฏุฉ ุงุซููู ูู ูุชูุงุฒู ุงูุฃุถูุงุน. <br><br>  ุงูุขู ุ ุจุนุฏ ุฅุชูุงู ุงููุนุฑูุฉ ุงููููุฉ ูู CSG ุ ูููููุง ุงูุนูุฏุฉ ุฅูู ุงูููุฏ ูุงููุธุฑ ูู ูุธููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูุงูุชู ูู ุงูุฃุตุนุจ ูู ุงูุชุนุงูู ูุนูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> HIT_NONE 0 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> HIT_LETTER 1 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> HIT_WALL 2 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> HIT_SUN 3 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// Sample the world using Signed Distance Fields. float QueryDatabase(Vec position, int &amp;hitType) { float distance = 1e9; Vec f = position; // Flattened position (z=0) fz = 0; char letters[15*4+1] = // 15 two points lines "5O5_" "5W9W" "5_9_" // P (without curve) "AOEO" "COC_" "A_E_" // I "IOQ_" "I_QO" // X "UOY_" "Y_]O" "WW[W" // A "aOa_" "aWeW" "a_e_" "cWiO"; // R (without curve) for (int i = 0; i &lt; sizeof(letters); i += 4) { Vec begin = Vec(letters[i] - 79, letters[i + 1] - 79) * .5; Vec e = Vec(letters[i + 2] - 79, letters[i + 3] - 79) * .5 + begin * -1; Vec o = f + (begin + e * min(-min((begin + f * -1) % e / (e % e), 0), 1) ) * -1; distance = min(distance, o % o); // compare squared distance. } distance = sqrtf(distance); // Get real distance, not square distance. // Two curves (for P and R in PixaR) with hard-coded locations. Vec curves[] = {Vec(-11, 6), Vec(11, 6)}; for (int i = 2; i--;) { Vec o = f + curves[i] * -1; distance = min(distance, ox &gt; 0 ? fabsf(sqrtf(o % o) - 2) : (oy += oy &gt; 0 ? -2 : 2, sqrtf(o % o)) ); } distance = powf(powf(distance, 8) + powf(position.z, 8), .125) - .5; hitType = HIT_LETTER; float roomDist ; roomDist = min(// min(A,B) = Union with Constructive solid geometry //-min carves an empty space -min(// Lower room BoxTest(position, Vec(-30, -.5, -30), Vec(30, 18, 30)), // Upper room BoxTest(position, Vec(-25, 17, -25), Vec(25, 20, 25)) ), BoxTest( // Ceiling "planks" spaced 8 units apart. Vec(fmodf(fabsf(position.x), 8), position.y, position.z), Vec(1.5, 18.5, -25), Vec(6.5, 20, 25) ) ); if (roomDist &lt; distance) distance = roomDist, hitType = HIT_WALL; float sun = 19.9 - position.y ; // Everything above 19.9 is light source. if (sun &lt; distance)distance = sun, hitType = HIT_SUN; return distance; }</span></span></span></span></code> </pre> <br>  ููููู ุฃู ุชุฑู ููุง ูุธููุฉ "ุงูุงุณุชุบูุงุก" ุนู ูุชูุงุฒู ุงูุงุถูุงุน ุ ุญูุซ ูุชู ุงุณุชุฎุฏุงู ูุณุชุทูููู ููุท ูุจูุงุก ุงูุบุฑูุฉ ุจุฃููููุง (ูุนูู ุนููููุง ุจุงูุจุงูู ุ ูููุซู ุงูุฌุฏุฑุงู).  ุงูุณูู ุงูุฃููู ุนุจุงุฑุฉ ุนู ูุธููุฉ CSG ุฃูุซุฑ ุชุนููุฏูุง ุจุงุณุชุฎุฏุงู ุชูุณูู ุงูุจุงูู.  ูุฃุฎูุฑูุง ุ ุชุชููู ุฃุญุฑู ูููุฉ PIXAR ูู 15 ุณุทุฑูุง ูุน ุฒูุฌ "ุฃุตู / ุฏูุชุง" ูุญุงูุชูู ุฎุงุตุชูู ูููุญููุงุช ูู ุงูุญุฑููู P ู R. <br><br><h2 style=";text-align:right;direction:rtl">  ุฑุงู ูุณูุฑ </h2><br><hr><br>  ุงูุชูุงู ูุงุนุฏุฉ ุจูุงูุงุช ููุธุงุฆู CSG ุงูุชู ุชุตู ุงูุนุงูู ุ ูููู ุฃู ูุชุฎุทู ุฌููุน ุงูุฃุดุนุฉ ุงูููุจุนุซุฉ ูู ุงููุธููุฉ ุงูุฑุฆูุณูุฉ ().  ุฑุงู ูุณูุฑุฉ ูุณุชุฎุฏู ูุธููุฉ ุงููุณุงูุฉ.  ูุฐุง ูุนูู ุฃู ููุถุน ุฃุฎุฐ ุงูุนููุงุช ููุชูู ููุฃูุงู ูุณุงูุฉ ุฅูู ุฃูุฑุจ ุนูุจุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Perform signed sphere marching // Returns hitType 0, 1, 2, or 3 and update hit position/normal int RayMarching(Vec origin, Vec direction, Vec &amp;hitPos, Vec &amp;hitNorm) { int hitType = HIT_NONE; int noHitCount = 0; float d; // distance from closest object in world. // Signed distance marching for (float total_d=0; total_d &lt; 100; total_d += d) if ((d = QueryDatabase(hitPos = origin + direction * total_d, hitType)) &lt; .01 || ++noHitCount &gt; 99) return hitNorm = !Vec(QueryDatabase(hitPos + Vec(.01, 0), noHitCount) - d, QueryDatabase(hitPos + Vec(0, .01), noHitCount) - d, QueryDatabase(hitPos + Vec(0, 0, .01), noHitCount) - d) , hitType; // Weird return statement where a variable is also updated. return 0; }</span></span></code> </pre> <br>  ุฅู ููุฑุฉ ูุณูุฑุฉ ุงูุดุนุงุน ุนูู ุฃุณุงุณ ุงููุณุงูุฉ ูู ุงููุถู ูุฏููุง ุฅูู ุฃูุฑุจ ูุงุฆู.  ูู ุงูููุงูุฉ ุ ุณุชูุชุฑุจ ุงูุญุฒูุฉ ูู ุงูุณุทุญ ูุฏุฑุฌุฉ ุฃูู ูููู ุงุนุชุจุงุฑูุง ููุทุฉ ูููุน. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/e99/774/398/e997743989aa1cb22fb65e6d5d8e93f2.svg"></div><br>  ูุงุญุธ ุฃู ูุณูุฑุฉ ุงูุดุนุงุน ูุง ุชูุฑุฌุน ุชูุงุทุนูุง ุญูููููุง ูุน ุงูุณุทุญ ุ ูููู ุชูุฑูุจูุง.  ูุฐุง ูู ุงูุณุจุจ ูู ุชููู ุงููุณูุฑุฉ ูู ุงูููุฏ ุนูุฏ d &lt;0.01f. <br><br><h2 style=";text-align:right;direction:rtl">  ูุถุน ูู ุฐูู ูุนุง: ุฃุฎุฐ ุงูุนููุงุช </h2><br><hr><br>  ุงูุชุญููู ูู ูุณุงุฑ ุงูุชุชุจุน ูุฏ ุงูุชูู ุชูุฑูุจูุง.  ูุญู ููุชูุฏ ุงูุฌุณุฑ ุงูุฐู ูุฑุจุท ุงููุธููุฉ ุงูุฑุฆูุณูุฉ () ุจูุณูุฑุฉ ุงูุดุนุงุน.  ูุฐุง ุงูุฌุฒุก ุงูุฃุฎูุฑ ุ ุงูุฐู ููุช ุจุชุณููุชู "ุชุชุจุน" ุ ูู "ุงูุฏูุงุบ" ุงูุฐู ุชุฑุชุฏ ููู ุงูุฃุดุนุฉ ุฃู ุชุชููู ุ ุญุณุจ ูุง ุชูุงุฌูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">Vec </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Trace</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Vec origin, Vec direction)</span></span></span><span class="hljs-function"> </span></span>{ Vec sampledPosition, normal, color, attenuation = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-function"><span class="hljs-function">Vec </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lightDirection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(!Vec(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">.6</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">.6</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">))</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">// Directional light for (int bounceCount = 3; bounceCount--;) { int hitType = RayMarching(origin, direction, sampledPosition, normal); if (hitType == HIT_NONE) break; // No hit. This is over, return color. if (hitType == HIT_LETTER) { // Specular bounce on a letter. No color acc. direction = direction + normal * ( normal % direction * -2); origin = sampledPosition + direction * 0.1; attenuation = attenuation * 0.2; // Attenuation via distance traveled. } if (hitType == HIT_WALL) { // Wall hit uses color yellow? float incidence = normal % lightDirection; float p = 6.283185 * randomVal(); float c = randomVal(); float s = sqrtf(1 - c); float g = normal.z &lt; 0 ? -1 : 1; float u = -1 / (g + normal.z); float v = normal.x * normal.y * u; direction = Vec(v, g + normal.y * normal.y * u, -normal.y) * (cosf(p) * s) + Vec(1 + g * normal.x * normal.x * u, g * v, -g * normal.x) * (sinf(p) * s) + normal * sqrtf(c); origin = sampledPosition + direction * .1; attenuation = attenuation * 0.2; if (incidence &gt; 0 &amp;&amp; RayMarching(sampledPosition + normal * .1, lightDirection, sampledPosition, normal) == HIT_SUN) color = color + attenuation * Vec(500, 400, 100) * incidence; } if (hitType == HIT_SUN) { // color = color + attenuation * Vec(50, 80, 100); break; // Sun Color } } return color; }</span></span></code> </pre> <br>  ููุฏ ุฌุฑุจุช ููููุงู ูุน ูุฐู ุงููุธููุฉ ูุชุบููุฑ ุงูุญุฏ ุงูุฃูุตู ูุนุฏุฏ ุงูุนูุงุณุงุช ุงูุญุฒูุฉ ุงููุณููุญ ุจูุง.  ุงููููุฉ "2" ุชุนุทู ุงูุญุฑูู ููู Vantablack ุงููุทูู ุจุดูู ุฌููู ุจุดูู ูุฏูุด <sup>[4]</sup> . <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/d10/940/a3e/d10940a3ed7efab3271097904ce50d77.png"></div><br>  <i>1</i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/e0c/8b2/c3b/e0c8b2c3b249057b1f5fd0d166e12014.png"></div><br>  <i>2</i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/fb9/52c/4df/fb952c4dfd0a4cb14245cedd060dcf05.png"></div><br>  <i>3</i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/65c/2f5/716/65c2f5716578caaa2fcc454a49376578.png"></div><br>  <i>4</i> <br><br><h2 style=";text-align:right;direction:rtl">  ุชูุธูููุง ุชูุงูุง ุดูุฑุฉ ุงููุตุฏุฑ </h2><br><hr><br>  ููุถุน ูู ุดูุก ูุนูุง ุ ููุช ุจุฅูุดุงุก <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุดูุฑุฉ ูุตุฏุฑ</a> ูุธููุฉ ุชูุงููุง. <br><br><h2 style=";text-align:right;direction:rtl">  ุงููุฑุงุฌุน </h2><br><hr><br>  [1] ุงููุตุฏุฑ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุดูุฑ Twitter lexfrench ูู 8 ุฃูุชูุจุฑ 2018.</a> <br><br>  [2] ุงููุตุฏุฑ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุณูู ุตูุฑุฉ NetPBM</a> <br><br>  [3] ุงููุตุฏุฑ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃุฏุงุก ุงูุชุตูุฑ ุนูู ุฃููู ุฌูุงุฒ MacBook Pro ุ 2017</a> <br><br>  [4] ุงููุตุฏุฑ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููููุจูุฏูุง: ูุงูุชุงุจูุงู</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar434528/">https://habr.com/ru/post/ar434528/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar434514/index.html">"ุงูุฃุณุฑุงุฑ" DPAPI ุฃู DPAPI ูู Pentesters</a></li>
<li><a href="../ar434516/index.html">ุทุฑููุฉ ุณููุฉ ููุชุนุงูู ูุน ุทููุญุงุชู ุงูููููุฉ.</a></li>
<li><a href="../ar434518/index.html">ุงูุชุตููู ูุงููุชุงูุงุช: ุงูุฏุฑุงูุง ุงูุชู ุชุณูุทุฑ ุนูููุง ุจุนูุงูุฉ ูู ูุชุงุฌุฑ ุฃุจู</a></li>
<li><a href="../ar434522/index.html">ุฃููุงุท ุชุจุฑูุฑ ุงูููุงู ู antipatterns</a></li>
<li><a href="../ar434524/index.html">Kubernetes ุชุฏุฎู ูู ุฎูุงู ุนููู ุงููุจุชุฏุฆูู</a></li>
<li><a href="../ar434530/index.html">ุงูุชูููู ุงูุงูุชุฑุงุถู ุ ุฅุตูุงุญุงุช ูู LDAP ูุงูุงุจุชูุงุฑุงุช ุงูุฃุฎุฑู ูู Zimbra 8.8.11</a></li>
<li><a href="../ar434532/index.html">ูุตุฉ ูุดุฑูุน ูุงุญุฏ: ุนูุฏูุง ูุง ูููู ูุฏู ูุฑูู ูุทูุฑ ูุจูุฑ</a></li>
<li><a href="../ar434534/index.html">ONYX BOOX "ูุชุงุจู ุงูุฃูู": ูุฑุงุกุฉ ุบูุฑ ูุคุฐูุฉ ูุฃูู ูุงูุทูู</a></li>
<li><a href="../ar434538/index.html">ุงูููุงุญ ูู ุฃุฌู ุงููุถุงุก: ูุง ูุญุฏุซ ูู ุณูู ุงูุฅูุชุฑูุช ุนุจุฑ ุงูุฃููุงุฑ ุงูุตูุงุนูุฉ</a></li>
<li><a href="../ar434540/index.html">ูุงุฐุง ุชูุนู ูุน ุงูุฃุดุฎุงุต ุงูุฐูู ุณูุชู ุงุณุชุจุฏุงููู ุจุงูุฑูุจูุชุงุชุ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>