<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>◼️ 🤸 ✍🏽 Comment ouvrir un lien en Python. Travailler avec WebBrowser et résoudre un problème avec Internet Explorer ⚖️ 🕵️ 🔎</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Au cours du travail sur le curseur uni, je suis tombé sur un module Python standard - WebBrowser . A travers ce module, j'ai voulu implémenter le trav...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment ouvrir un lien en Python. Travailler avec WebBrowser et résoudre un problème avec Internet Explorer</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470938/">  Au cours du travail sur le curseur uni, je suis tombé sur un module Python standard - <b>WebBrowser</b> .  A travers ce module, j'ai voulu implémenter le travail de l'assistant vocal avec le navigateur par défaut, mais tout ne s'est pas passé aussi bien que prévu.  Voyons d'abord ce qu'est ce module et comment il fonctionne généralement. <br><a name="habracut"></a><br>  <b>WebBrowser</b> est un module intégré à Python qui fournit une interface de haut niveau pour afficher des documents Web. <br><br>  Pour commencer, importez le module avec la commande: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> webbrowser</code> </pre> <br>  Il y a maintenant un choix sur la façon d'ouvrir le lien.  Il y a deux chaises: <br><br>  1. Écrivez en une seule ligne: <br><br><pre> <code class="python hljs">webbrowser.open(url, new=<span class="hljs-number"><span class="hljs-number">0</span></span>, autoraise=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br>  Par exemple: <br><br><pre> <code class="python hljs">webbrowser.open(<span class="hljs-string"><span class="hljs-string">'https://vk.com'</span></span>, new=<span class="hljs-number"><span class="hljs-number">2</span></span>)</code> </pre> <br>  Si new = 0, l'URL s'ouvre, si possible, dans la même fenêtre de navigateur.  Si la variable new = 1, une nouvelle fenêtre de navigateur s'ouvre, si possible.  Si nouveau = 2, une nouvelle page de navigateur («onglet») s'ouvre, si possible. <br><br>  Vous pouvez ignorer la valeur autoraise en toute sécurité, car cela ouvre le navigateur au-dessus de toutes les fenêtres, et la plupart des navigateurs modernes crachent sur cette variable même si elle est fausse. <br><br>  2. Ne souffrez pas de vous souvenir des nouveaux paramètres et écrivez humainement: <br><br><pre> <code class="python hljs">webbrowser.open_new(url)</code> </pre> <br>  Cette conception ouvre l'URL dans une nouvelle fenêtre de navigateur <b>par défaut</b> , si possible, sinon il ouvre l'URL dans une seule fenêtre de navigateur. <br><br><pre> <code class="python hljs">webbrowser.open_new_tab(url)</code> </pre> <br>  Dans ce cas, l'URL s'ouvrira sur une nouvelle page de navigateur ("tab") par défaut, si possible, sinon équivalent à open_new (). <br><br>  Supposons que vous n'ayez pas besoin d'un navigateur par défaut.  Il y a une commande cool .get () pour sélectionner un navigateur <br><br><pre> <code class="python hljs">webbrowser.get(using=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>)</code> </pre> <br>  En gros, vous indiquez simplement le navigateur que vous utilisez. <br><br>  Par exemple, ouvrir un nouvel onglet dans Google Chrome: <br><br><pre> <code class="python hljs">webbrowser.get(using=<span class="hljs-string"><span class="hljs-string">'google-chrome'</span></span>).open_new_tab(<span class="hljs-string"><span class="hljs-string">'https://vk.com'</span></span>)</code> </pre> <br>  Tableau des noms de navigateur: <br><div class="scrollable-table"><table><tbody><tr><th>  <b>Tapez le nom</b> </th><th>  <b>Nom de classe</b> </th></tr><tr><td>  «mozilla» </td><td>  Mozilla («mozilla») </td></tr><tr><td>  'firefox' </td><td>  Mozilla («mozilla») </td></tr><tr><td>  «netscape» </td><td>  Mozilla ('netscape') </td></tr><tr><td>  «galeon» </td><td>  Galeon («galeon») </td></tr><tr><td>  'épiphanie' ' </td><td>  Galeon («épiphanie») </td></tr><tr><td>  «skipstone» </td><td>  BackgroundBrowser («skipstone») </td></tr><tr><td>  «kfmclient» </td><td>  Konqueror () </td></tr><tr><td>  'konqueror' ' </td><td>  Konqueror () </td></tr><tr><td>  «kfm» </td><td>  Konqueror () </td></tr><tr><td>  «mosaïque» </td><td>  BackgroundBrowser («mosaïque») </td></tr><tr><td>  «opéra» </td><td>  Opéra () </td></tr><tr><td>  «graal» </td><td>  Graal () </td></tr><tr><td>  «liens» </td><td>  GenericBrowser («liens») </td></tr><tr><td>  «elinks» </td><td>  Elinks («elinks») </td></tr><tr><td>  «lynx» </td><td>  GenericBrowser ('lynx') </td></tr><tr><td>  «w3m» </td><td>  GenericBrowser ('w3m') </td></tr><tr><td>  'windows-default' </td><td>  Windowsdefault </td></tr><tr><td>  «macosx» </td><td>  MacOSX ('par défaut') </td></tr><tr><td>  «safari» </td><td>  MacOSX («safari») </td></tr><tr><td>  «google-chrome» </td><td>  Chrome («google-chrome») </td></tr><tr><td>  'chrome' ' </td><td>  Chrome («chrome») </td></tr><tr><td>  'chrome' ' </td><td>  Chrome («chrome») </td></tr><tr><td>  'chrome-browser' </td><td>  Chrome («navigateur chrome») </td></tr></tbody></table></div><br>  Mais il n'est pas toujours possible de se débrouiller avec .get () seul, et dans ce cas la fonction .register () vient à la rescousse, par exemple: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> webbrowser webbrowser.register(<span class="hljs-string"><span class="hljs-string">'Chrome'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, webbrowser.BackgroundBrowser(<span class="hljs-string"><span class="hljs-string">'C:\Program Files (x86)\Google\Chrome\Application\chrome.exe'</span></span>)) webbrowser.get(<span class="hljs-string"><span class="hljs-string">'Chrome'</span></span>).open_new_tab(<span class="hljs-string"><span class="hljs-string">'vk.com'</span></span>)</code> </pre> <br>  Nous avons indiqué le chemin vers Google Chrome, l'avons nommé, et maintenant tous les liens ne s'ouvrent que dans celui-ci.  J'espère que nous avons un peu réglé le module WebBrowser et passons maintenant à mon petit problème. <br><br><h1>  Le problème </h1><br>  Comme mentionné précédemment, pour le projet de cours, j'ai choisi de créer un assistant vocal.  Je voulais lui apprendre à suivre les liens et à rechercher des informations dans un moteur de recherche.  Bien sûr, il serait possible de «bourrer» beaucoup de bibliothèques pour cela, mais en gros, je voulais l'implémenter via le module <b>WebBrowser</b> standard. <br><br>  Étant donné que la plupart des navigateurs modernes ont une ligne d'entrée de lien et une ligne de recherche de la même chose, il semblerait que vous pouvez simplement transférer la demande au même endroit où le lien est envoyé. <br><br>  Par exemple: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> webbrowser webbrowser.open_new_tab(<span class="hljs-string"><span class="hljs-string">'https://vk.com'</span></span>) webbrowser.open_new_tab(<span class="hljs-string"><span class="hljs-string">''</span></span>)</code> </pre> <br>  Selon la logique de ce code, deux onglets devraient s'ouvrir: <br><br><ol><li>  Site Web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vk.com</a> </li><li>  Requête de moteur de recherche - Pommes </li></ol><br>  Mais en fait, deux navigateurs différents s'ouvrent.  Le lien est ouvert par notre navigateur par défaut, et la demande est faite par Internet Explorer (bien que cela coûte Windows 10, IE s'ouvre toujours à la place d'Edge).  Comment y faire face?  Les vrais gourous peuvent entrer dans le module WebBrowser et y remédier, mais nous évaluerons sobrement nos chances et suivrons le flux. <br><br>  Étant donné que nous ne pouvons ouvrir que des liens dans le navigateur par défaut, nous n'ouvrirons que des liens. <br><br><h4>  Étapes de la solution </h4><br><ol><li>  Nous effectuons une requête de recherche dans notre moteur de recherche (Yandex, Google, etc., etc.) <br><img src="https://habrastorage.org/webt/mo/yq/sq/moyqsqsk7rsjztvo5_s8kklslg4.jpeg"></li><li>  Nous obtenons le lien <br><br><img src="https://habrastorage.org/webt/x9/if/hp/x9ifhptmb9t3iwa98yuq7mkoi5y.jpeg"></li><li>  Et, comme beaucoup l'ont déjà deviné, il suffit d'insérer notre lien sans ce qui vient après "text =" <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> webbrowser webbrowser.open_new_tab(<span class="hljs-string"><span class="hljs-string">'https://vk.com'</span></span>) webbrowser.open_new_tab(<span class="hljs-string"><span class="hljs-string">'https://yandex.ru/search/?lr=10735&amp;text='</span></span>)</code> </pre> </li><li>  Vous devez maintenant ajouter le texte de la requête lui-même via "+" ou via "% s" <br><br><ul><li>  Par "+" <br><br><pre> <code class="python hljs">webbrowser.open_new_tab(<span class="hljs-string"><span class="hljs-string">'https://yandex.ru/search/?lr=10735&amp;text='</span></span>+<span class="hljs-string"><span class="hljs-string">''</span></span>)</code> </pre> </li><li>  Par "%" <br><br><pre> <code class="python hljs">webbrowser.open_new_tab(<span class="hljs-string"><span class="hljs-string">'https://yandex.ru/search/?lr=10735&amp;text=%s'</span></span>%<span class="hljs-string"><span class="hljs-string">''</span></span>)</code> </pre> </li><li>  <b>Mais il vaut mieux l'implémenter via le <i>format</i></b> <br><br><pre> <code class="python hljs">webbrowser.open_new_tab(<span class="hljs-string"><span class="hljs-string">'https://yandex.ru/search/?lr=10735&amp;text={}'</span></span>.format(<span class="hljs-string"><span class="hljs-string">''</span></span>))</code> </pre> </li></ul><br></li></ol><br>  Faisons maintenant l'utilisateur entrer un lien ou une demande, et le programme lui-même comprend la méthode à utiliser (appelez le lien ou insérez-le dans le lien de demande). <br><br>  Pour commencer, nous comprenons qu'un lien porte un domaine (.ru, .com, etc.), dans la demande, en règle générale, ils ne mettent pas fin à (acheter une voiture, un film en ligne, etc.), mais dans le lien barre d'espace <br><br>  Par conséquent, nous chercherons une période et un espace dans ce que l'utilisateur a entré.  Nous pouvons le faire grâce au module re, qui est également nativement intégré à Python.  Python propose deux opérations basées sur des expressions régulières primitives différentes: <i>match</i> recherche un modèle au début d'une chaîne, tandis que la <i><b>recherche</b></i> recherche la chaîne entière.  Nous utiliserons l'opération de <i><b>recherche</b></i> . <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> webbrowser <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> re call = input(<span class="hljs-string"><span class="hljs-string">'   : '</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> re.search(<span class="hljs-string"><span class="hljs-string">r'\.'</span></span>, call): webbrowser.open_new_tab(<span class="hljs-string"><span class="hljs-string">'https://'</span></span> + call) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> re.search(<span class="hljs-string"><span class="hljs-string">r'\ '</span></span>, call): webbrowser.open_new_tab(<span class="hljs-string"><span class="hljs-string">'https://yandex.ru/search/?text='</span></span>+call) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: webbrowser.open_new_tab(<span class="hljs-string"><span class="hljs-string">'https://yandex.ru/search/?text='</span></span> + call)</code> </pre> <br>  Je vais expliquer un peu le code. <br><br>  L'utilisateur entre un lien ou un texte de demande dans la variable d'appel. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> re.search(<span class="hljs-string"><span class="hljs-string">r'\.'</span></span>, call): webbrowser.open_new_tab(<span class="hljs-string"><span class="hljs-string">'https://'</span></span> + call)</code> </pre> <br>  La première condition vérifie la variable d'appel pour un point à l'intérieur.  Le caractère «\» est requis, sinon le module ne comprend pas que le caractère est un point devant lui. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> re.search(<span class="hljs-string"><span class="hljs-string">r'\ '</span></span>, call):</code> </pre> <br>  Dans cet état, tout est le même que dans le premier, mais la vérification est déjà en cours pour un espace.  Un espace indique que nous avons une requête de recherche. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: webbrowser.open_new_tab(<span class="hljs-string"><span class="hljs-string">'https://yandex.ru/search/?text='</span></span> + call)</code> </pre> <br>  Et <i>sinon</i> , à son tour, attribue tout ce que l'utilisateur a écrit sans espaces ni points dans la requête de recherche. <br><br>  Il est nécessaire de rechercher un espace, sinon WebBrowser ouvre Internet Explorer. <br><br><h4>  Merci à tous pour votre attention!  J'espère que cet article sera utile à quelqu'un. </h4></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr470938/">https://habr.com/ru/post/fr470938/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr470924/index.html">Pourquoi pour le nouveau projet, j'ai pris Robot Framework</a></li>
<li><a href="../fr470926/index.html">«Nous nous faisons confiance. Par exemple, nous n'avons aucun salaire du tout »- une grande interview avec Tim Lister, auteur de Peopleware</a></li>
<li><a href="../fr470928/index.html">Meilleures pratiques pour exécuter Buildah dans un conteneur</a></li>
<li><a href="../fr470930/index.html">Gamification du produit. Historique Ratatype</a></li>
<li><a href="../fr470934/index.html">Guérit avant le mariage: prolifération cellulaire et capacités régénératrices des méduses</a></li>
<li><a href="../fr470940/index.html">Meetup MSK VUE.JS # 3 au groupe Mail.ru: matériaux de mitap</a></li>
<li><a href="../fr470942/index.html">Du débutant aux icônes de style: comment nous avons remporté des prix dans 2GIS</a></li>
<li><a href="../fr470950/index.html">bear_hug: jeux en art ASCII en Python3.6 +</a></li>
<li><a href="../fr470952/index.html">Trucs et astuces de Digital Forensics: Forensics de l'application «Votre téléphone»</a></li>
<li><a href="../fr470954/index.html">Installez Zimbra OSE 8.8.15 et Zextras Suite Pro sur Ubuntu 18.04 LTS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>