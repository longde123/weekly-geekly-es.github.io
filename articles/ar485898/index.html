<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ถ ๐ค๐ฟ ุชุตุฏูุฑ ููุงุฐุฌ Google + ุชูุฒูู Google Script ุนุจุฑ REST API (Python) ๐จ๐ฟโโ๏ธ ๐ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุงู ูุฏููุง ูููุฐุฌุงู ูู google ุ ู 75 ุณุคุงููุง ูู ูู ููููุง ุ ู 5 ูู ูุณุชุฎุฏูู ุงูุฃุนูุงู ุงูุฐูู ูุงููุง ุจุชุญุฑูุฑ ูุฐู ุงูููุงุฐุฌ ุจุดูู ูุดุท ุ ูุฃูุถูุง ุจุฑูุงูุฌ ูุตู ูู google ู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชุตุฏูุฑ ููุงุฐุฌ Google + ุชูุฒูู Google Script ุนุจุฑ REST API (Python)</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485898/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/gi/tl/nl/gitlnlklzpbmybk3jz3utl4_uow.png"><br><br>  ูุงู ูุฏููุง ูููุฐุฌุงู ูู google ุ ู 75 ุณุคุงููุง ูู ูู ููููุง ุ ู 5 ูู ูุณุชุฎุฏูู ุงูุฃุนูุงู ุงูุฐูู ูุงููุง ุจุชุญุฑูุฑ ูุฐู ุงูููุงุฐุฌ ุจุดูู ูุดุท ุ ูุฃูุถูุง ุจุฑูุงูุฌ ูุตู ูู google ูุชุตุฏูุฑ ุงููููุฐุฌ ุฅูู JSON.  ููุณ ูู ุงูุตุนุจ ุชุดุบููู ูู ูู ูุฑุฉ ุจูุฏูู ุ ูููู ุจูุฌุฑุฏ ุงูุจุฏุก ูู ุฃุชูุชุฉ ุนููู ุ ุซู ุงูุชูู ุฅูู ูุฐู ุงูููุงูุฉ. <br><br>  ูู ุงููุซุงุฆู ุงูุฑุณููุฉ ุ ุณูู ููุณุฑ ุงูุดูุทุงู ุณุงูู ุ ูุฐูู ุชุญุช ุงููุท ุณูููู ูุธุฑุฉ ูุงุญุตุฉ ุนูู ุงูุชูุฒูู ุนู ุจูุนุฏ ูุฅุทูุงู Google Apps Script ูู ุฎูุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช REST ุจุงุณุชุฎุฏุงู Python. <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ููุฏูุฉ </h2><br>  ูู Doctor Near ุ ูููู ุจุชุทููุฑ ูุธุงู ุฃุณุงุณู ูุจุฑุงูุฌ ุงูุฏุฑุฏุดุฉ ุ ุญูุซ ูุชู ุงุณุชุฎุฏุงู ููุงุฐุฌ Google ููุตู ุงูุณููุงุฑูููุงุช.  ููููุง ูุฐูู ุ ุฃุฑุบุจ ูู ุงูุญุตูู ุนูู JSON ูู ุงูููุงุฐุฌ ุจููุฑุฉ ุฒุฑ ูุงุญุฏุฉ ุชุญุชูู ุนูู ุงูุนูุฏ (ููุงุท ุงููููุฐุฌ) ูุงูุจูุงูุงุช ุงููุตููุฉ ููุง (ุงูุงูุชูุงู ุจูู ุงูุนูุฏ ูุฃููุงุน ุงูุนูุฏ ูุงุณููุง).  ูุจุฏู ุฃู ุงูุฑุบุจุฉ ุจุณูุทุฉ ุ ููู Google ูุง ุชุฏุนู ูุฐู ุงููุธููุฉ ูุนููู ุชุฌููุน ูุฐุง "ุงููุตุฏุฑ" ุจูุฏูู.  ุงููุธุฑ ูู ุงูุฎุทูุงุช ุงููุงุฒูุฉ ูุฅูุดุงุฆู. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎุทูุฉ 1. ุงููุต ุงูุจุฑูุฌู ูุชุทุจููุงุช Google </h2><br>  ููุฑุช Google ุงููุฏุฑุฉ ุนูู ุงูุชูุงุนู ูุน ุฎุฏูุงุชูุง (ุงูุฃูุฑุงู ูุงููุณุชูุฏุงุช ูุงูููุงุฐุฌ) ูู ุฎูุงู Google Apps Script - ุงูุจุฑุงูุฌ ุงููุตูุฉ ุงูููุชูุจุฉ ุจูุบุฉ google script (.gs).  ูุง ุชูุฏู ูุฐู ุงูููุงูุฉ ุชุญููููุง ููุบุฉ ุงููุต ุงูุจุฑูุฌู ูู google ุ ูุฐุง ุณุฃูุฏู ูุซุงููุง ุนูู ุจุฑูุงูุฌ ูุตู ุฌุงูุฒ ูููู ุจุฅูุดุงุก JSON ูู ูููุฐุฌ Google ููุฌูุฏ.  ุชู ุฃุฎุฐ <a href="" rel="nofollow">ุฑูุฒ</a> ุงููุณุชุฎุฏู <a href="https://github.com/stevenschmatz" rel="nofollow">Steven Schmatz</a> ูู github ูุฃุณุงุณ ุ ูุงูุฐู ุฃุนุฑุจ ุนู ุงูุชูุงูู ูู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฑูุฒ ุงูุจุฑูุงูุฌ ุงููุตู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Steven Schmatz // Humanitas Labs // 13 October, 2016. // Roman Shekhovtsov // dr-telemed.ru // Autumn 2019 // Nikita Orekhov // dr-telemed.ru // Autumn 2019 /** * Converts the given form URL into a JSON object. */ function main() { form_url = "&lt;YOUR_FORM_URL&gt;" var form = FormApp.openByUrl(form_url); var items = form.getItems(); var result = { "metadata": getFormMetadata(form), "items": items.map(itemToObject), "count": items.length }; // sendEmail("&lt;YOUR_EMAIL&gt;", result) return result; } /** If we want to receive data by email * Sends JSON as text to recipient email * @param recipient: String * @param result: JSON */ function sendEmail(recipient, json_file){ var subject = "google form json import" var body = JSON.stringify(json_file); Logger.log(body); MailApp.sendEmail(recipient, subject, body); } /** * Returns the form metadata object for the given Form object. * @param form: Form * @returns (Object) object of form metadata. */ function getFormMetadata(form) { return { "title": form.getTitle(), "id": form.getId(), "description": form.getDescription(), "publishedUrl": form.getPublishedUrl(), "editorEmails": form.getEditors().map(function(user) { return user.getEmail() }), "count": form.getItems().length, "confirmationMessage": form.getConfirmationMessage(), "customClosedFormMessage": form.getCustomClosedFormMessage() }; } /** * Returns an Object for a given Item. * @param item: Item * @returns (Object) object for the given item. */ function itemToObject(item) { var data = {}; data.type = item.getType().toString(); // Downcast items to access type-specific properties var itemTypeConstructorName = snakeCaseToCamelCase("AS_" + item.getType().toString() + "_ITEM"); var typedItem = item[itemTypeConstructorName](); // Keys with a prefix of "get" have "get" stripped var getKeysRaw = Object.keys(typedItem).filter(function(s) {return s.indexOf("get") == 0}); getKeysRaw.map(function(getKey) { var propName = getKey[3].toLowerCase() + getKey.substr(4); // Image data, choices, and type come in the form of objects / enums if (["image", "choices", "type", "alignment"].indexOf(propName) != -1) {return}; // Skip feedback-related keys if ("getFeedbackForIncorrect".equals(getKey) || "getFeedbackForCorrect".equals(getKey) || "getGeneralFeedback".equals(getKey)) {return}; var propValue = typedItem[getKey](); data[propName] = propValue; }); // Bool keys are included as-is var boolKeys = Object.keys(typedItem).filter(function(s) { return (s.indexOf("is") == 0) || (s.indexOf("has") == 0) || (s.indexOf("includes") == 0); }); boolKeys.map(function(boolKey) { var propName = boolKey; var propValue = typedItem[boolKey](); data[propName] = propValue; }); // Handle image data and list choices switch (item.getType()) { case FormApp.ItemType.LIST: case FormApp.ItemType.CHECKBOX: data.choices = typedItem.getChoices().map(function(choice) { return choice.getValue() }); case FormApp.ItemType.MULTIPLE_CHOICE: data.choices = typedItem.getChoices().map(function(choice) { gotoPage = choice.getGotoPage() if (gotoPage == null) return choice.getValue() else return { "value": choice.getValue(), "gotoPage":choice.getGotoPage().getId() }; }); break; case FormApp.ItemType.IMAGE: data.alignment = typedItem.getAlignment().toString(); if (item.getType() == FormApp.ItemType.VIDEO) { return; } var imageBlob = typedItem.getImage(); data.imageBlob = { "dataAsString": "", //imageBlob.getDataAsString(), - BLOB too big "name": imageBlob.getName(), "isGoogleType": imageBlob.isGoogleType() }; break; case FormApp.ItemType.PAGE_BREAK: data.pageNavigationType = typedItem.getPageNavigationType().toString(); break; default: break; } // Have to do this because for some reason Google Scripts API doesn't have a // native VIDEO type if (item.getType().toString() === "VIDEO") { data.alignment = typedItem.getAlignment().toString(); } return data; } /** * Converts a SNAKE_CASE string to a camelCase string. * @param s: string in snake_case * @returns (string) the camelCase version of that string */ function snakeCaseToCamelCase(s) { return s.toLowerCase().replace(/(\_\w)/g, function(m) {return m[1].toUpperCase();}); }</span></span></code> </pre> <br></div></div><br>  ูุง ูุญุฏุซ ูู ุงูููุฏ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฏุงูุฉ <i>getFormMetadata</i> - ุชููู ุจุฅุฑุฌุงุน JSON ูุน ุจูุงูุงุช ุชุนุฑูู ุงููููุฐุฌ </li><li style=";text-align:right;direction:rtl">  ุฏุงูุฉ <i>itemToObject</i> - ุชุญูู ุงููุงุฆู <i>form.item</i> ุฅูู JSON ูุน ุงูุญููู ุงููุทููุจุฉ </li><li style=";text-align:right;direction:rtl">  ูุธููุฉ <i>sendEmail</i> - ุชุฑุณู ููู JSON ุฅูู ุงูุจุฑูุฏ ุงููุญุฏุฏ ูู ุงููุต </li><li style=";text-align:right;direction:rtl">  ุงููุธููุฉ <i>ุงูุฑุฆูุณูุฉ</i> - ุฅุฑุฌุงุน ุงููุงุชุฌ JSON </li><li style=";text-align:right;direction:rtl">  ุงููุชุบูุฑ <i>form_url</i> ูู ุงููุธููุฉ <i>ุงูุฑุฆูุณูุฉ</i> ูู ุนููุงู ูููุฐุฌ google ุงูุฎุงุต ุจูุง </li></ul><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎุทูุฉ 2. ุงุฎุชุจุงุฑ ุงูุจุฑูุงูุฌ ุงููุตู </h2><br>  ูู ุงูููุช ุงูุญุงูู ุ ูููู ุงูุชุญูู ูู ุฃุฏุงุก ุงูุจุฑูุงูุฌ ุงููุตู ุนูู ุงููุญู ุงูุชุงูู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://script.google.com/home/start" rel="nofollow">ุฅูุดุงุก</a> ูุดุฑูุน ุงูุจุฑูุงูุฌ ุงููุตู ุงูุชุทุจูู ุงูุฎุงุต ุจู </li><li style=";text-align:right;direction:rtl">  ุงูุณุฎ ุงูููุฏ ููู </li><li style=";text-align:right;direction:rtl">  ุจุฏูุงู ูู <i>&lt;YOUR_FORM_URL&gt; ูุณุชุจุฏู</i> ุนููุงู ุงููููุฐุฌ ุงูุฎุงุต ุจูุง ูููููุฐุฌ <i><a href="https://docs.google.com/forms/d/FORM_IDENTIFICATOR/edit" rel="nofollow">docs.google.com/forms/d/FORM_IDENTIFICATOR/edit</a></i> </li><li style=";text-align:right;direction:rtl">  uncomment ุงูุฏุนูุฉ <i>ูุฅุฑุณุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</i> ูู ุงููุธููุฉ <i>ุงูุฑุฆูุณูุฉ</i> </li><li style=";text-align:right;direction:rtl">  ุจุฏูุงู ูู <i>&lt;YOUR_EMAIL&gt; ูุณุชุจุฏู</i> ุนููุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุงูุฐู ูุฑูุฏ ุงุณุชูุงู JSON ุฅููู </li><li style=";text-align:right;direction:rtl">  ุงุญูุธ ุงููุดุฑูุน </li><li style=";text-align:right;direction:rtl">  ุชุดุบูู ุงููุธููุฉ <i>ุงูุฑุฆูุณูุฉ</i> </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงูุช ูุฐู ูู ุงููุฑุญูุฉ ุงูุฃููู ูู ุงูุจุฑูุงูุฌ ุงููุตู ุ ูุณูุนููู ุงููุธุงู ุจุงูุญุงุฌุฉ ุฅูู ููุญ ุงูุจุฑูุงูุฌ ุงููุตู ุฅุฐููุง ูุฅุฑุณุงู ุจุฑูุฏ ุฅููุชุฑููู ูู ุนููุงูู.  ูุง ุชุฎู.  ูุฐุง ูู ุงูุฅุฌุฑุงุก ุงูููุงุณู ุงููุทููุจ ูุงุฎุชุจุงุฑ ุงูุจุฑูุงูุฌ ุงููุตู.  ุงูุชูู ุฅูู "ุฃุฐููุงุช ุงููุฑุงุฌุนุฉ" -&gt; ุญุฏุฏ ุญุณุงุจู -&gt; "ุฎูุงุฑุงุช ูุชูุฏูุฉ" -&gt; "ุงูุชูู ุฅูู ูุดุฑูุน PROJECT_NAME (ุบูุฑ ุขูู)" -&gt; "ุงูุณูุงุญ" </li><li style=";text-align:right;direction:rtl">  ูู ุงูุชุธุงุฑ ุงูุจุฑูุงูุฌ ุงููุตู ููุนูู </li><li style=";text-align:right;direction:rtl">  ุงุจุญุซ ูู ุตูุฏูู ุงูุจุฑูุฏ ูุดุงูุฏ ููู JSON ูู ูููุฐุฌ ูุตู </li></ol><br>  ุณูููู ูู ุดูุก ุนูู ูุง ูุฑุงู ุ ูููู ุงูุงุณุชุฎุฏุงู ุงูุฅุถุงูู ููุจูุงูุงุช ุงูุชู ุชู ุงูุญุตูู ุนูููุง ูุชุถูู ุงููุณุฎ ุงููุฏูู ูู ุงูุจุฑูุฏ ุ ููุนุงูุฌุฉ ูุฐุง ุงููุต (ูู ุจูุซูู ุ ุนูู ุณุจูู ุงููุซุงู) ูุญูุธ ุงูููู ุงููุงุชุฌ.  ูุง ูุจุฏู ุฌุงูุฒูุง ุฌุฏูุง ููุฅูุชุงุฌ.  ูุญู ูุชูููู ูู ุชุดุบูู ูุฐุง ุงูุจุฑูุงูุฌ ุงููุตู ุชููุงุฆููุง ูุงูุญุตูู ุนูู ูุชุงุฆุฌู ูู ุฎูุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Google Apps Script ุ ููู ุฃููุงู ุฃูุดุฃูุง ูุดุฑูุน Google ููููุง ูุฐูู. <br><br>  <b>ุงูุชุจุงู:</b> ูุชูููุฑ ุงูุฑุงุญุฉ ูููู ูุง ูุญุฏุซ ุ ุณุฃุดูุฑ ุฃุฏูุงู ุฅูู ุตูุญุชูู ููุท ุ ูุฐูู ููุตู ุจูุชุญูุง ูู ุนูุงูุงุช ุชุจููุจ ูุชุฌุงูุฑุฉ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://script.google.com/home" rel="nofollow">ุตูุญุฉ</a> ุชุญุฑูุฑ ุงููุต / ุงูุจุฑูุงูุฌ ุงููุตู - <i>"ุงูุตูุญุฉ 1"</i> </li><li style=";text-align:right;direction:rtl">  ุตูุญุฉ Google Cloud Platform - <i>"ุงูุตูุญุฉ 2"</i> </li></ol><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎุทูุฉ 3. ุชูููู Google Cloud Platform </h2><br>  ูุฐูุจ ุฅูู Google Cloud Platform (ุตูุญุฉ 2) ุ ูุฅูุดุงุก ูุดุฑูุน ุฌุฏูุฏ.  ูู ุงูุถุฑูุฑู ุฅูุดุงุก ูุดุฑูุน ุฌุฏูุฏ ุ ูุฃู ุญุงูุฉ ุงููุดุฑูุน ูู ุงูุชุฑุงุถู ุ ูุณุชุงูุฏุงุฑุช ูุทููุจุฉ ูุฃุบุฑุงุถูุง.  ูููู ุงูุนุซูุฑ ุนูู ูุฒูุฏ ูู ุงูุชูุงุตูู <a href="https://developers.google.com/apps-script/guides/cloud-platform-projects" rel="nofollow">ููุง</a> (ุงูููุทุฉ 3). <br><br>  ูุนูุฏ ุฅูู ุงูุตูุญุฉ 2 ุ ุงูุชูู ุฅูู ุนูุงูุฉ ุงูุชุจููุจ "API ูุงูุฎุฏูุงุช" ุ ุซู "ูุงูุฐุฉ ุทูุจ ูุตูู OAuth".  ุงุถุจุท ููุน ุงููุณุชุฎุฏู ุนูู "ุฎุงุฑุฌู". <br><br>  ูู ุงููุงูุฐุฉ ุงูุชู ุชุธูุฑ ุ ุงููุฃ "ุงุณู ุงูุชุทุจูู". <br><br>  ุงูุชุญ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ุนูู Google Cloud Platform.  ูู ูุชูุฉ "ูุนูููุงุช ุงููุดุฑูุน" ูุณุฎ ุฑูู ุงููุดุฑูุน. <br><br>  ุงูุชูู ุฅูู ุงูุตูุญุฉ 1. ุงูุชุญ ุงูุจุฑูุงูุฌ ุงููุตู ุงูุฐู ุชู ุฅูุดุงุคู ูุณุจููุง.  ูู ูุงูุฐุฉ ุชุญุฑูุฑ ุงููุตูุต ุงูููุชูุญุฉ ุ ุงูุชูู ุฅูู "ุงูููุงุฑุฏ" -&gt; "ูุดุฑูุน ููุตุฉ ุงูุณุญุงุจ".  ูู ุญูู "ุชุบููุฑ ุงููุดุฑูุน" ุ ุฃุฏุฎู ุฑูู ุงููุดุฑูุน ุงูุฐู ุชู ูุณุฎู ูุณุจููุง.  ุงูุขู ูุฑุชุจุท ูุฐุง ุงูุจุฑูุงูุฌ ุงููุตู ุจุงููุดุฑูุน ุงูุฐู ุชู ุฅูุดุงุคู. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎุทูุฉ 4. ุจูุซูู REST API </h2><br>  ุญุงู ุงูููุช ูุฃุชูุชุฉ ุงูุจุฑูุงูุฌ ุงููุตู ุจุงุณุชุฎุฏุงู <a href="https://developers.google.com/apps-script/api/reference/rest" rel="nofollow">REST API</a> .  ุชู ุงุณุชุฎุฏุงู ุจุงูุซูู ููุบุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุชุทุจููุงุช API ุณููุงุฑูู ุชุณุฌูู ุงูุฏุฎูู </h3><br>  ูุฌุจ ุฃู ูููู ููุฑูุฒ ุญู ุงููุตูู ุฅูู ุงููุดุฑูุน ุ ูุจุงูุชุงูู ูุฅู ุงูุฅุฌุฑุงุก ุงูุฃูู ูุงูููู ููุบุงูุฉ ูู ุชุณุฌูู ุงูุฏุฎูู ูู Apps Script API.  ุงูุชุญ ุงูุตูุญุฉ 2 -&gt; "API ูุงูุฎุฏูุงุช" -&gt; "ุจูุงูุงุช ุงูุงุนุชูุงุฏ" -&gt; "ุฅูุดุงุก ุจูุงูุงุช ุงุนุชูุงุฏ" -&gt; "ูุนุฑู ุนููู OAuth" -&gt; "ุฃููุงุน ุฃุฎุฑู".  ูุญู ูุณูู ูุนุฑููุง ุ ุงูุชูู ุฅููู.  ูู ุนูุงูุฉ ุงูุชุจููุจ "ุจูุงูุงุช ุงูุงุนุชูุงุฏ" ุ ุญุฏุฏ "ุชูุฒูู ููู JSON".  ุณูุคุฏู ูุฐุง ุฅูู ุชุญููู ููู ุงูููุชุงุญ ูููุตูู ูู ุงูุฑูุฒ ุฅูู ุงููุดุฑูุน ูู Google.  ูุถุน ูุฐุง ุงูููู ูู ูุฌูุฏ ุจูุงูุงุช ุงูุงุนุชูุงุฏ. <br><br>  ุชุญุชุงุฌ ุงูุขู ุฅูู ููุญ ุฅุฐู ูุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (ูู ุญุงูุชูุง ุ ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Apps) ูุฌุฒุก ูู ูุฐุง ุงููุดุฑูุน.  ููููุงู ุจุฐูู ุ ุงูุชูู ุฅูู "API ูุงูุฎุฏูุงุช" -&gt; "ุงูููุชุจุฉ" -&gt; ุงูุชุจ "Apps Script API" ูู ุงูุจุญุซ ูุงููุฑ ุนูู "ุชูููู". <br><br>  ุชุญุชูู ุงูุชุทุจููุงุช ุงูุชู ุชุชูุงุนู ูุน Google ุนูู ูุฌููุนุฉ ูู ุงูุฃุฐููุงุช ุงูุชู ูุฌุจ ุนูู ุงููุณุชุฎุฏู ููุญูุง ุนูุฏ ุชุดุบููู.  ุชุนุชูุฏ ูุฐู ุงููุณุฎุฉ ุนูู ุงููุธุงุฆู ุงูุชู ูุณุชุฎุฏููุง ุจุฑูุงูุฌ ูุตู ูุนูู ูููููู ุงูุนุซูุฑ ุนูููุง ุจุงูุงูุชูุงู ุฅูู ุงูุตูุญุฉ 1 ูู ูุงูุฐุฉ ุชุญุฑูุฑ ุงูุจุฑูุงูุฌ ุงููุตู ูู "ููู" -&gt; "ุฎุตุงุฆุต ุงููุดุฑูุน" -&gt; "ุงููุทุงูุงุช".  ูุฌุจ ุญูุธ ูุฐู ุงูุฃุฐููุงุช ููุงุณุชุฎุฏุงู ุงููุณุชูุจูู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ. <br><br>  ูู ูุฐู ุงูุญุงูุฉ ุ ุณุชุจุฏู ูุธููุฉ ุชุณุฌูู ุงูุฏุฎูู ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pickle <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os.path <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> googleapiclient.discovery <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> build <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> google_auth_oauthlib.flow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> InstalledAppFlow <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> google.auth.transport.requests <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Request <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">login</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(config)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: creds = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-comment"><span class="hljs-comment"># The file token.pickle stores the user's access and refresh tokens, and is # created automatically when the authorization flow completes for the first # time. token_file = config['credentials_path'] + config['token_file'] credentials_file = config['credentials_path'] + config['credentials_file'] if os.path.exists(token_file): with open(token_file, 'rb') as token: creds = pickle.load(token) # If there are no (valid) credentials available, let the user log in. if not creds or not creds.valid: if creds and creds.expired and creds.refresh_token: creds.refresh(Request()) else: flow = InstalledAppFlow.from_client_secrets_file(credentials_file, config['SCOPES']) creds = flow.run_local_server(port=0) # Save the credentials for the next run with open(token_file, 'wb') as token: pickle.dump(creds, token) service = build('script', 'v1', credentials=creds) pprint('Login successful') return service except Exception as e: pprint(f'Login failure: {e}') return None</span></span></code> </pre><br>  ุชุนุชุจุฑ ูุฌููุนุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุฐู ุงูุฅุฌุฑุงุก ุงูููุงุณู ูุจุฏุก ุงุณุชุฎุฏุงู Google App Script. <br>  ูุณุชุฎุฏู ุฑูุฒ ุงููุตุงุฏูุฉ ุ ููู ุฎูุงู ุชุณุฌูู ุงูุฏุฎูู ุ ุฅูุง ุฅูุดุงุก ุฑูุฒ ูููุฒ ุฌุฏูุฏ ุฃู ุงุณุชุฎุฏุงู ุฑูุฒ ููุฌูุฏ. <br><br>  ููุฑุงุญุฉ ุ ุชู ุฅูุดุงุก ููู ุชูููู JSON ุ ูุงูุฐู ูุญุชูู ุนูู ุงููููุฐุฌ ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"SCOPES"</span></span>: [<span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/auth/forms"</span></span>, <span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/auth/script.send_mail"</span></span>], <span class="hljs-attr"><span class="hljs-attr">"credentials_path"</span></span>: <span class="hljs-string"><span class="hljs-string">"credentials/"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"credentials_file"</span></span>: <span class="hljs-string"><span class="hljs-string">"google_test_project.json"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"token_file"</span></span>: <span class="hljs-string"><span class="hljs-string">"token.pickle"</span></span> }</code> </pre><br>  <b>ูุงู:</b> ูุชู ุฅูุดุงุก ุงูุฑูุฒ ุงููููุฒ ูููุตุงุฏูุฉ ูุน ูุทุงู ูุนูู ูู ุงูุฃุฐููุงุช.  ุจูุนูู ุขุฎุฑ ุ ุนูุฏ ุชุบููุฑ ูุทุงู ุงูุฃุฐููุงุช ุ ูุฌุจ ุนููู ุญุฐู ุงูุฑูุฒ ุงููููุฒ ูุฅูุดุงุก ุฑูุฒ ุฌุฏูุฏ ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู. <br><br><h3 style=";text-align:right;direction:rtl">  ุฑูุฒ ุงูุจุฑูุงูุฌ ุงููุตู ููุชุญุฏูุซ ุนู ุจุนุฏ </h3><br>  ุงูุขู ุณูู ูุชุนูู ููููุฉ ุชุญุฏูุซ ุฑูุฒ ุงูุจุฑูุงูุฌ ุงููุตู ุนู ุจุนุฏ ุ ุซู ุชุดุบูู ูุฐุง ุงูุฑูุฒ ูุงูุญุตูู ุนูู ุงููุชูุฌุฉ.  ูู ุงููุงูุน ุ ุจุงูุฅุถุงูุฉ ุฅูู ุงูุดูุฑุฉ ุงูุชู ูุฏูุฑูุง ูู ูุญุฑุฑ Google ุ ููุฌุฏ ุฃูุถูุง <a href="https://developers.google.com/apps-script/concepts/manifests" rel="nofollow">ููู ุจูุงู</a> ูุญุชูู ุนูู ุญููู ุงูุชุดุบูู ุ ูุฅุนุฏุงุฏุงุช ุงููุดุฑ ุ ุฅูุฎ.  ูุฒูุฏ ูู ุงููุนูููุงุช ุญูู ูููููุง ูููู ุงูุนุซูุฑ ุนูููุง <a href="https://developers.google.com/apps-script/manifest/" rel="nofollow">ููุง</a> . <br>  ููุงุทูุงุน ุนูู ููู ุงูุจูุงู ุงูุงูุชุฑุงุถู ุงูุฐู ุฃูุดุฃุชู Google ูููุต ุงูุฎุงุต ุจู ุ ุงูุชูู ุฅูู ูุญุฑุฑ ุงููุต ูู "ุนุฑุถ" -&gt; "ุฅุธูุงุฑ ููู ุงูุจูุงู".  ุณูุธูุฑ ุงูุจูุงู ูู ูุงุฆูุฉ ุงููููุงุช ุงููุชุนููุฉ ุจูุฐุง ุงูุจุฑูุงูุฌ ุงููุตู. <br><br>  ูู ููู ุงูููุงู ุนู ุงูุจูุงู ุจุฏูู ุณุจุจ: ูุชุทูุจ ุชุญุฏูุซ ุงูุจุฑูุงูุฌ ุงููุตู ุนู ุจูุนุฏ ุชูุฒูู ุฑูุฒ ุงูููููู (* .gs) ูุจูุงู ุงูุจูุงู (appscript.json). <br><br>  ุฃููุงู ุ ุงูุฑุฃ ุฑูุฒ ููู .gs ุงูุฐู ูุฑูุฏ ูุดุฑู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'export-google-form.gs'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: sample_code = f.read()</code> </pre><br>  ุงูุขู ูู ุจูุณุฎ ุงูุจูุงู ุงูุฐู ุชู ุฅูุดุงุคู ุชููุงุฆููุง ููู ุจุชุนุฏููู ููููุงู ูุฃุบุฑุงุถูุง.  ุชุตู ุงููุซุงุฆู ุจุดูู ุดุงูู ูููู ููู ุงูุจูุงู ุ ูุฐูู ูู ุฃุชูุงูู ูุฐู ุงูููุทุฉ.  ููู ูุนูู ุงูุจุฑูุงูุฌ ุงููุตู ุ ุชุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ูุณู "implementationApi" ุฅูู ุงูุจูุงู ุงูุงูุชุฑุงุถู ุงููุทููุจ ูุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู ุนู ุจูุนุฏ ูู ุฎูุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช.  ูู ูุฐุง ุงููุณู ุ ูุดูุฑ ุฅูู ุฏุงุฆุฑุฉ ุงูุฃุดุฎุงุต ุงูุฐูู ูุฏููู ุงููุฏุฑุฉ ุนูู ุชุดุบูููุง.  ููุฏ ุณูุญุช ุจุงูุชุดุบูู ูุฌููุน ุงูุฐูู ุญุตููุง ุนูู ุชุฑุฎูุต ุ ูุงูุฐู ูุชูุงูู ูุน ูุนุฑู "ุฃู ุดุฎุต": <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">MANIFEST = <span class="hljs-string"><span class="hljs-string">''' { "timeZone": "America/New_York", "exceptionLogging": "STACKDRIVER", "executionApi": { "access": "ANYONE" } } '''</span></span>.strip()</code> </pre><br>  ูุฌุจ ุฃู ูุญุชูู ูุต ุทูุจ ุงูุชุญุฏูุซ ุนูู ูุฌููุนุฉ ูู ุงููููุงุช ุจุงููููู ุงูุชุงูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>ุงูุงุณู</i> : ุงุณู ุงูููู ุงููุฑุงุฏ ุฅูุดุงุคู ุนูู ุงูุฎุงุฏู ุ ุฏูู ุงูุชุฏุงุฏ </li><li style=";text-align:right;direction:rtl">  <i>ุงูููุน</i> : <i>ููุน</i> ุงูููู (JSON ููุจูุงู ุ SERVER_JS for .gs) </li><li style=";text-align:right;direction:rtl">  <i>ุงููุตุฏุฑ</i> : ุฑูุฒ ุงูููู </li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">request = { <span class="hljs-string"><span class="hljs-string">'files'</span></span>: [{ <span class="hljs-string"><span class="hljs-string">'name'</span></span>: <span class="hljs-string"><span class="hljs-string">'hello'</span></span>, <span class="hljs-string"><span class="hljs-string">'type'</span></span>: <span class="hljs-string"><span class="hljs-string">'SERVER_JS'</span></span>, <span class="hljs-string"><span class="hljs-string">'source'</span></span>: sample_code }, { <span class="hljs-string"><span class="hljs-string">'name'</span></span>: <span class="hljs-string"><span class="hljs-string">'appsscript'</span></span>, <span class="hljs-string"><span class="hljs-string">'type'</span></span>: <span class="hljs-string"><span class="hljs-string">'JSON'</span></span>, <span class="hljs-string"><span class="hljs-string">'source'</span></span>: MANIFEST } ] }</code> </pre><br>  ุฃุฎูุฑูุง ุ ูุฌุจ ุฃู ูุญุชูู ุทูุจ ุงูุชุญุฏูุซ ููุณู ุนูู ุงููุต ุงูุฃุณุงุณู (ุงูุทูุจ ุงูููุถุญ ุฃุนูุงู) ููุนุฑู ุงูุจุฑูุงูุฌ ุงููุตู.  ูููู ุงูุญุตูู ุนูู ุงูุฃุฎูุฑ ูู ุฎูุงู ุงูุงูุชูุงู ุฅูู "ุงูููู" -&gt; "ุฎุตุงุฆุต ุงููุดุฑูุน" ูู ูุญุฑุฑ ุงููุตูุต ููุณุฎ "ูุนุฑู ุงูุจุฑูุงูุฌ ุงููุตู": <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">script_id = <span class="hljs-string"><span class="hljs-string">'qwertyuiopQWERTYUIOPasdfghjkl123456789zxcvbnmASDFGHJKL54'</span></span></code> </pre><br>  ุจุงููุณุจุฉ ููุงุฆู ุงูุฎุฏูุฉ ุงูุฐู ุชู ุงูุญุตูู ุนููู ูุชูุฌุฉ ูุชุณุฌูู ุงูุฏุฎูู ุ ูุญุตู ุนูู ุญูู ุงููุดุงุฑูุน () ููุณุชุฏุนู ุทุฑููุฉ updateContent () ุ ูุจุนุฏ ุฐูู ูุณูู ุทุฑููุฉ execute () ููุงุฆู HttpRequest ุงููุณุชูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">service.projects().updateContent( body=request, scriptId=script_id ).execute()</code> </pre><br>  ููุน ุฐูู ุ ูู ุงูููุช ุงูุญุงูู ุ ุณูุคุฏู ุชุดุบูู ุงูุฑูุฒ ุฅูู ุญุฏูุซ ุฎุทุฃ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"error"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"code"</span></span>: <span class="hljs-number"><span class="hljs-number">403</span></span>, <span class="hljs-attr"><span class="hljs-attr">"message"</span></span>: <span class="hljs-string"><span class="hljs-string">"Request had insufficient authentication scopes."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"PERMISSION_DENIED"</span></span> }</code> </pre><br>  ููุง ุชุฑูู ุ ูุง ุชูุฌุฏ ุฃุฐููุงุช ูุงููุฉ ูู ูุตุงุฏูุฉ osprey ุ ูุงูุชู ุฃุดุฑูุง ุฅูููุง ุณุงุจููุง.  ููุชูู ุฅูู ุงููุซุงุฆู ุงูุฑุณููุฉ ุนูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุ ููู ุทุฑููุฉ <a href="https://developers.google.com/apps-script/api/reference/rest/v1/projects/updateContent" rel="nofollow">updateContent</a> ุ ูุงูุชู ุงุณุชุฎุฏููุงูุง ูุชุญุฏูุซ ุงูุจุฑูุงูุฌ ุงููุตู ุนู ุจูุนุฏ.  ุชููู ุงููุซุงุฆู ุฃู ุงุณุชุฎุฏุงู ูุฐู ุงูุทุฑููุฉ ูุชุทูุจ ุชูููู ุงููุตูู ุฅูู script.projects: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">https://www.googleapis.com/auth/script.projects</code> </pre> <br>  ูู ุจุฅุถุงูุชู ุฅูู ููู ุงูุชูููู ุงูุฎุงุต ุจูุง ูู ูุณู SCOPES.  ููุง ูุชุจุช ุฃุนูุงู ุ ุนูุฏ ุชุบููุฑ osprey ุ ูู ุงูุถุฑูุฑู ุญุฐู ุงูุฑูุฒ ุงููููุฒ ุงูุฐู ุชู ุฅูุดุงุคู ุชููุงุฆููุง. <br><br>  ! ููุชุงุฒ  ูู ุงูููุช ุงูุญุงูู ุ ุชุนูููุง ุชุญุฏูุซ ุจุฑูุงูุฌ Google ุงููุตู ุนู ุจูุนุฏ.  ูุจูู ูุชุดุบููู ูุงูุญุตูู ุนูู ูุชูุฌุฉ ุงูุชูููุฐ. <br><br><h3 style=";text-align:right;direction:rtl">  ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู </h3><br>  ูุญุชูู ุทูุจ <a href="https://developers.google.com/apps-script/api/reference/rest/v1/scripts/run" rel="nofollow">ุจุฏุก ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู</a> ุนูู scriptID ูุงููุตูุต ุจุงููููู ุงูุชุงูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>ุงููุธููุฉ</i> : ุงุณู ุงููุธููุฉ ุงูุชู ูุฑูุฏ ุชุดุบูููุง </li><li style=";text-align:right;direction:rtl">  <i>ุงููุนููุงุช</i> : <i>(ุงุฎุชูุงุฑู)</i> ูุฌููุนุฉ ูู ุงููุนููุงุช ูู ุงูููุน ุงูุจุฏุงุฆู (ุณูุณูุฉ ุ ุตููู ...) ุชูุชูู ุฅูู ุงููุธููุฉ </li><li style=";text-align:right;direction:rtl">  <i>sessionState</i> : <i>(ุงุฎุชูุงุฑู)</i> ูุทููุจ ููุท ูุชุทุจููุงุช Android </li><li style=";text-align:right;direction:rtl">  <i>devMode</i> : <i>(ุงุฎุชูุงุฑู)</i> ุตุญูุญ ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูู ูุงูู ุงูุจุฑูุงูุฌ ุงููุตู ุ ุซู ุณูุชู ุฅุทูุงู ุงูุฅุตุฏุงุฑ ุงูุฃุญุฏุซ ูู ุงูุฅุตุฏุงุฑ ุงูุฐู ุชู ูุดุฑู ุจุงุณุชุฎุฏุงู Apps Script API.  (ุงูุชุฑุงุถูุง - ุฎุทุฃ) </li></ul><br>  ูู ุฃุฌู ุนุฏู ุฎูุงุทุฉ ุนููุงู URL ููููุฐุฌ Google ูู ุงูุจุฑูุงูุฌ ุงููุตู ุ ุณูููู ุจุชูุฑูุฑ <i>form_url</i> ุฅูู ุงููุธููุฉ <i>ุงูุฑุฆูุณูุฉ</i> ููุณูุทุฉ. <br><br>  <b>ุชุญุฐูุฑ.</b>  ุนูุฏูุง ุงุฎุชุจุฑูุง ุงูุจุฑูุงูุฌ ุงููุตู ุ ูู ุชูุจู ุงููุธููุฉ <i>ุงูุฑุฆูุณูุฉ</i> ุฃู ุดูุก ุ ูุฐูู ุณูููู ุจุชุบููุฑ ุงูุฃุณุทุฑ ุงูุฃููู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู ููู .gs ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">form_url</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> form = FormApp.openByUrl(form_url); .......</code> </pre><br>  ูุธุฑูุง ูุฃู ุชุทุจูููุง ููุณ ููุธุงู Android ููุญู ุฃุตุญุงุจ ุงูุจุฑูุงูุฌ ุงููุตู ุ ูุณูุจุฏู ุงูุฌุณู ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">body = { <span class="hljs-string"><span class="hljs-string">"function"</span></span>: <span class="hljs-string"><span class="hljs-string">"main"</span></span>, <span class="hljs-string"><span class="hljs-string">"devMode"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">"parameters"</span></span>: form_url }</code> </pre><br>  ูู ุจุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู ูุงูุชุจ ูุชูุฌุฉ ุงูุชูููุฐ ุฅูู ูุชุบูุฑ resp: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">resp = service.scripts().run(scriptId=script_id, body=body).execute()</code> </pre><br>  ุญูุธ resp ุฅูู ููู ุจุชูุณูู JSON ููุงุณุจ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> json <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'habr_auto.json'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>, encoding=<span class="hljs-string"><span class="hljs-string">'utf-8'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: json.dump(resp[<span class="hljs-string"><span class="hljs-string">'response'</span></span>][<span class="hljs-string"><span class="hljs-string">'result'</span></span>], f, ensure_ascii=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, indent=<span class="hljs-number"><span class="hljs-number">4</span></span>)</code> </pre><br>  <b>ุชุญุฐูุฑ.</b>  ุจุณุจุจ ุญูููุฉ ุฃู ุทูุจ script.run () ููุชุธุฑ ุงููุชูุฌุฉ ุนุจุฑ ูุฃุฎุฐ ุงูุชูุตูู ุ ุนูุฏูุง ูุชู ุชุฌุงูุฒ ุงููููุฉ ุจุญููู ููุช ุงูุชูููุฐ ุ ุณูุญุฏุซ ุฎุทุฃ ูู ุงูููุน ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">socket.timeout: The read operation timed out</code> </pre><br>  ูุชุฌูุจ ูุฐุง ุงูุณููู ุ ุฃูุตู ูู ุจุฏุงูุฉ ุงูุจุฑูุงูุฌ ุจุชุนููู ุญุฏ ูููุช ูุฃุฎุฐ ุงูุชูุตูู ุงูููุชูุญ ุ ููู ูุง ูููู ุจูุถูุญ ูุงูุชุธุงุฑ ุงูุชูุงุก ุงูุจุฑูุงูุฌ ุงููุตู ููุชูููุฐ.  ูู ุญุงูุชู ุ 120 ุซุงููุฉ ุชููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> socket socket.setdefaulttimeout(<span class="hljs-number"><span class="hljs-number">120</span></span>)</code> </pre><br>  ููููุง!  ุฎุท ุฃูุงุจูุจ ููุงุณุจ ููุชุญุฏูุซ ุนู ุจุนุฏ ูุฅุทูุงู ุงูุจุฑุงูุฌ ุงููุตูุฉ ูู Google ุฌุงูุฒ.  ููุฑุฏ ุฑูุฒ ูุงูู ุชูููููุง ูุงุทูุงู ูู ุงููุญุทุฉ ูู <a href="https://github.com/nikanor97/habr_google_script_api" rel="nofollow">ุฌูุซุจ</a> ุจูุฏู. <br><br>  ุฃูุถุง ุ ุณุฃูุฏู ุฑูุฒ ุงููุธุงุฆู ุงูุฑุฆูุณูุฉ ุฃุฏูุงู <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">login.py</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pprint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pprint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pickle <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os.path <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> googleapiclient.discovery <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> build <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> google_auth_oauthlib.flow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> InstalledAppFlow <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> google.auth.transport.requests <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Request <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">login</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(config)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: creds = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-comment"><span class="hljs-comment"># The file token.pickle stores the user's access and refresh tokens, and is # created automatically when the authorization flow completes for the first # time. token_file = config['credentials_path'] + config['token_file'] credentials_file = config['credentials_path'] + config['credentials_file'] if os.path.exists(token_file): with open(token_file, 'rb') as token: creds = pickle.load(token) # If there are no (valid) credentials available, let the user log in. if not creds or not creds.valid: if creds and creds.expired and creds.refresh_token: creds.refresh(Request()) else: flow = InstalledAppFlow.from_client_secrets_file(credentials_file, config['SCOPES']) creds = flow.run_local_server(port=0) # Save the credentials for the next run with open(token_file, 'wb') as token: pickle.dump(creds, token) service = build('script', 'v1', credentials=creds) pprint('Login successful') return service except Exception as e: pprint(f'Login failure: {e}') return None</span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">update_script.py</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pprint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pprint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> json <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> googleapiclient <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> errors <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> google_habr_login <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> login MANIFEST = <span class="hljs-string"><span class="hljs-string">''' { "timeZone": "America/New_York", "exceptionLogging": "STACKDRIVER", "executionApi": { "access": "ANYONE" } } '''</span></span>.strip() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update_project</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(service, script_id, script_file_name)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># Read from file code we want to deploy with open(script_file_name, 'r') as f: sample_code = f.read() # Upload two files to the project request = { 'files': [{ 'name': 'hello', 'type': 'SERVER_JS', 'source': sample_code }, { 'name': 'appsscript', 'type': 'JSON', 'source': MANIFEST } ] } # Update files in the project service.projects().updateContent( body=request, scriptId=script_id ).execute() pprint('Project was successfully updated') def main(): try: args = sys.argv if len(args) != 4: raise TypeError('Wrong number of arguments. Three argument required: &lt;config_file_name&gt;, &lt;script_id&gt; and ' '&lt;script_file_name&gt;') config_file_name = args[1] script_id = args[2] script_file_name = args[3] with open(config_file_name, "r") as f: config = json.load(f) service = login(config) update_project(service, script_id, script_file_name) except (errors.HttpError, ) as error: # The API encountered a problem. pprint(error.content.decode('utf-8')) if __name__ == '__main__': main()</span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">export_form.py</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pprint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pprint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> socket <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> json <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> googleapiclient <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> errors <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> google_habr_login <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> login socket.setdefaulttimeout(<span class="hljs-number"><span class="hljs-number">120</span></span>) <span class="hljs-comment"><span class="hljs-comment"># Get JSON, which is returned by script def get_json(service, file_name, script_id, form_url): pprint('Exporting form...') body = { "function": "main", "devMode": True, "parameters": form_url } # Get JSON from script resp = service.scripts().run(scriptId=script_id, body=body).execute() # Write out JSON to file with open(file_name, 'w', encoding='utf-8') as f: json.dump(resp['response']['result'], f, ensure_ascii=False, indent=4) pprint('Form was successfully exported') def main(): try: args = sys.argv if len(args) != 5: raise TypeError('Wrong number of arguments. Four arguments required: &lt;config_file_name&gt;, ' '&lt;result_file_name&gt;, &lt;script_id&gt; and &lt;google_form_url&gt;') config_file_name = args[1] file_name = args[2] script_id = args[3] form_url = args[4] with open(config_file_name, "r") as f: config = json.load(f) service = login(config) get_json(service, file_name, script_id, form_url) except (errors.HttpError, ) as error: # The API encountered a problem. pprint(error.content.decode('utf-8')) if __name__ == '__main__': main()</span></span></code> </pre><br></div></div><br>  ููุจุฏุก ุ ุชุญุชุงุฌ ุฅูู ูุถุน ููู JSON ูุน ููุงุชูุญ ุงููุตูู ุฅูู Google ูู ูุฌูุฏ ุจูุงูุงุช ุงูุงุนุชูุงุฏ ุ ูุชููุฆุฉ JSON ูู ููุณ ุงูุฏููู ูุซู ุงูุจุฑุงูุฌ ุงููุตูุฉ. <br><br>  ุซู ุ ุฅุฐุง ููุง ูุฑูุฏ ุชุญุฏูุซ ุงูุจุฑูุงูุฌ ุงููุตู ุนู ุจูุนุฏ ุ ูุนูุฏ ุงุชุตุงู ุงููุญุทุฉ ุงูุทุฑููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">python update_script.py &lt;config_file_name&gt; &lt;script_id&gt; &lt;script_file_name&gt;</code> </pre><br>  ูู ูุฐู ุงูุญุงูุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>config_file_name</i> - ุงุณู ููู ุงูุชูููู JSON </li><li style=";text-align:right;direction:rtl">  <i>script_id</i> - ูุนุฑู ุงูุจุฑูุงูุฌ ุงููุตู </li><li style=";text-align:right;direction:rtl">  <i>script_file_name</i> - ุงุณู ููู .gs ุงูุฐู ุณูุชู ุชุญูููู ุฅูู google </li></ul><br>  ูุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู ุ ุงุชุตู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">python export_form.py &lt;config_file_name&gt; &lt;result_file_name&gt; &lt;script_id&gt; &lt;google_form_url&gt;</code> </pre><br>  ูู ูุฐู ุงูุญุงูุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>config_file_name</i> - ุงุณู ููู ุงูุชูููู JSON </li><li style=";text-align:right;direction:rtl">  <i>result_file_name</i> - ุงุณู ููู JSON ุงูุฐู ุณูุชู ููู ุฅูุบุงุก ุชุญููู ุงููููุฐุฌ </li><li style=";text-align:right;direction:rtl">  <i>script_id</i> - ูุนุฑู ุงูุจุฑูุงูุฌ ุงููุตู </li><li style=";text-align:right;direction:rtl">  <i>google_form_url</i> - google form url </li></ul><br>  ุดูุฑุง ูุงูุชูุงููู ุ ูู ุงูุชุธุงุฑ ุงูุชุฑุงุญุงุชูู ูุชุนูููุงุชูู :) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar485898/">https://habr.com/ru/post/ar485898/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar485878/index.html">ุณูุณูุฉ ูู ุงูุฎุทูุงุช ูุชูุธูู ุงููุญุงุณุจุฉ ุงูุฅุฏุงุฑูุฉ ุนูู ููุตุฉ JetCalc</a></li>
<li><a href="../ar485884/index.html">ููููุฉ ุฅุนุฏุงุฏ Levitron ุงูุตูููุฉ</a></li>
<li><a href="../ar485886/index.html">ููู (ูููุงุฐุง) ุชุญููู ููุงุชูุญ ูุฅุนูุงูุงุช ุงูููุงูุณูู ูู Yandex.Direct ูุฅุนูุงูุงุช Google ูุฌุงููุง</a></li>
<li><a href="../ar485888/index.html">ุฎุงุฏู ุทูุจ ุชุฒููุฑ ุ ุนูููุฉ ุฃุนูู SSRF</a></li>
<li><a href="../ar485896/index.html">ูุงุนุฏุฉ ุจูุงูุงุช ูุชูุงุฒูุฉ ุจุดูู ูุจูุฑ Greenplum - ุจุฑูุงูุฌ ุชุนูููู ูุตูุฑ</a></li>
<li><a href="../ar485908/index.html">ุจูุถู ุฎูู ูุฐูู ูู Ocarina of Time ุ ูุงู ูู ุงููููู ุฅุถุงูุฉ ููุงุฐุฌ ูู Star Fox 64</a></li>
<li><a href="../ar485910/index.html">ูุดุฑ ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุน AWS ูุฑู ุดุฌุฑุฉ ุงููุงุตูููุงุก</a></li>
<li><a href="../ar485912/index.html">ููุงุฐุง ุชุนุฏ ุงูุชุฑุฌูุฉ ูู ุงูุชุณููุฉ ุฃูุฑูุง ุณูุฆูุง ูุบูุฑ ุฐูู ูู ุงูููุฒุงุช ุงููุซูุฑุฉ ููุงูุชูุงู ูุชุตูุฑูุง ููุฑูุฒ</a></li>
<li><a href="../ar485914/index.html">ูุฏุนูู ูู ZeroTier. ุฏููู ุนููู ูุจูุงุก ุงูุดุจูุงุช ุงูุงูุชุฑุงุถูุฉ. ุงูุฌุฒุก 1</a></li>
<li><a href="../ar485916/index.html">ุฅุฒุงูุฉ ุบูุฑ ุถุฑูุฑู [ุงูุณุญ ุงูุฌุฏูู ูู ุบูุฑ ุงูุถุฑูุฑู]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>