<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ∏Ô∏è ü•© üçß SNA Hackathon 2019: Simplify Architecture - Simplify Features üë®‚Äçüë®‚Äçüëß‚Äçüë¶ ü§ôüèΩ üçö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En este art√≠culo, hablar√© sobre mi soluci√≥n a la parte de texto de la tarea SNA Hackathon 2019 . Algunas de las ideas propuestas ser√°n √∫tiles para los...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SNA Hackathon 2019: Simplify Architecture - Simplify Features</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/445348/"><img src="https://habrastorage.org/webt/g7/n-/lw/g7n-lwqhzzuabg1ul4kaexfouhg.png"><br><br>  En este art√≠culo, hablar√© sobre mi soluci√≥n a la parte de texto de la tarea <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SNA Hackathon 2019</a> .  Algunas de las ideas propuestas ser√°n √∫tiles para los participantes de la parte de tiempo completo del hackathon, que se llevar√° a cabo en la oficina de Mosc√∫ del Grupo Mail.ru del 30 de marzo al 1 de abril.  Adem√°s, esta historia puede ser de inter√©s para los lectores que resuelven los problemas pr√°cticos del aprendizaje autom√°tico.  Como no puedo reclamar premios (trabajo en Odnoklassniki), trat√© de ofrecer la soluci√≥n m√°s simple, pero al mismo tiempo efectiva e interesante. <br><br>  Al leer sobre nuevos modelos de aprendizaje autom√°tico, quiero entender c√≥mo razon√≥ el autor mientras trabajaba en una tarea.  Por lo tanto, en este art√≠culo intentar√© sustanciar en detalle todos los componentes de mi soluci√≥n.  En la primera parte hablar√© sobre el planteamiento del problema y las limitaciones.  En el segundo, sobre la evoluci√≥n del modelo.  La tercera parte est√° dedicada a los resultados y al an√°lisis del modelo.  Finalmente, en los comentarios intentar√© responder cualquier pregunta que haya surgido.  Los lectores impacientes pueden mirar de inmediato la <a href="">arquitectura final</a> . <br><a name="habracut"></a><br><h2>  Desaf√≠o </h2><br>  Los organizadores de Hackathon sugirieron que resolvamos el problema de formar una cinta inteligente.  Para cada usuario, es necesario ordenar el conjunto de publicaciones para que el n√∫mero m√°ximo de publicaciones en el que el usuario establezca la "clase" est√© en la parte superior de la lista.  Para configurar el algoritmo de clasificaci√≥n, se supon√≠a que deb√≠a usar datos hist√≥ricos del formulario (usuario, publicaci√≥n, comentarios).  La tabla proporciona una breve descripci√≥n de los datos de la parte del texto y la notaci√≥n que usar√© en este art√≠culo. <br><br><table><tbody><tr><th width="130">  Fuente <br></th><th width="150">  Designaci√≥n <br></th><th width="160">  Tipo <br></th><th>  Descripci√≥n <br></th></tr><tr><td>  el usuario <br></td><td>  ID_usuario <br></td><td>  categ√≥rico <br></td><td>  ID de usuario <br></td></tr><tr><td>  publicar <br></td><td>  post_id <br></td><td>  categ√≥rico <br></td><td>  ID de publicaci√≥n <br></td></tr><tr><td>  publicar <br></td><td>  texto <br></td><td>  lista categ√≥rica <br></td><td>  lista de palabras normalizadas <br></td></tr><tr><td>  publicar <br></td><td>  caracter√≠sticas <br></td><td>  categ√≥rico <br></td><td>  grupo de caracter√≠sticas de la publicaci√≥n (autor, idioma, etc.) <br></td></tr><tr><td>  retroalimentaci√≥n <br></td><td>  retroalimentaci√≥n <br></td><td>  lista binaria <br></td><td>  Diversas acciones que el usuario podr√≠a realizar con la publicaci√≥n (vista, clase, comentario, etc.) <br></td></tr></tbody></table><br>  Antes de comenzar a construir el modelo, introduje varias restricciones en la soluci√≥n futura.  Esto era necesario para satisfacer los requisitos de simplicidad y practicidad, mis intereses y para reducir el n√∫mero de opciones posibles.  Aqu√≠ est√°n las m√°s importantes de estas limitaciones. <br><br>  <b>Predicci√≥n de la probabilidad de "clase"</b> .  Inmediatamente decid√≠ que resolver√≠a este problema como un problema de clasificaci√≥n.  Se podr√≠an aplicar los m√©todos utilizados en la clasificaci√≥n, por ejemplo, para predecir el orden en pares de publicaciones.  Pero me decid√≠ por una formulaci√≥n m√°s simple, en la que las publicaciones se ordenan seg√∫n la probabilidad pronosticada de obtener una "clase".  Vale la pena se√±alar que el enfoque que se describe a continuaci√≥n se puede ampliar para formular la clasificaci√≥n. <br><br>  <b>Modelo monol√≠tico</b> .  A pesar del hecho de que los conjuntos de modelos tienden a ganar competencias, mantener un conjunto en un sistema de combate es m√°s dif√≠cil que un solo modelo.  Adem√°s, quer√≠a tener al menos algunas capacidades de interpretaci√≥n de caja no negra. <br><br>  <b>Gr√°fico computacional diferenciable</b> .  En primer lugar, los modelos de esta clase (redes neuronales) determinan el estado del arte en muchas tareas, incluidas las relacionadas con el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">an√°lisis de</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">datos</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">de</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">texto</a> .  En segundo lugar, los marcos modernos, en mi caso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Apache MXNet</a> , le permiten implementar arquitecturas muy diversas.  Por lo tanto, puede experimentar con diferentes modelos cambiando solo unas pocas l√≠neas de c√≥digo. <br><br>  <b>Trabajo m√≠nimo con letreros</b> .  Quer√≠a que el modelo se expandiera f√°cilmente con nuevos datos.  Esto puede ser necesario en la parte de tiempo completo, donde habr√° poco tiempo para preparar las se√±ales.  Por lo tanto, me decid√≠ por el enfoque m√°s simple para identificar atributos: <br><br><ul><li>  Los datos binarios est√°n representados por una etiqueta con un valor de 1 o 0; </li><li>  los datos num√©ricos permanecen tal cual o se discretizan en categor√≠as; </li><li>  Los datos categ√≥ricos se presentan mediante incrustaciones. </li></ul><br>  Habiendo decidido la estrategia general, comenc√© a probar diferentes modelos. <br><br><h2>  Modelo de evoluci√≥n </h2><br>  El punto de partida fue el enfoque de factorizaci√≥n matricial, a menudo utilizado en tareas de recomendaci√≥n: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-msubsup" id="MJXp-Span-2"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">i</span><span class="MJXp-mo" id="MJXp-Span-6">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-9">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">a</span><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-18" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-20">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">t</span><span class="MJXp-msubsup" id="MJXp-Span-25"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-27" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> p_ {i, j} = \ sigma (u_ {i} \ cdot v_ {j}) </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-30"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">P</span><span class="MJXp-mrow" id="MJXp-Span-32"><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0em; margin-right: 0em;">√©</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">a</span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-40"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-42" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">i</span><span class="MJXp-mo" id="MJXp-Span-44">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-49" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">i</span><span class="MJXp-mo" id="MJXp-Span-51">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-54">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">i</span><span class="MJXp-msubsup" id="MJXp-Span-67"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-69" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">u</span><span class="MJXp-mo" id="MJXp-Span-71">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">v</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> P√©rdida (y_ {i, j}, p_ {i, j}) \ rightarrow min_ {u, v} </script></p><br>  En el lenguaje de los gr√°ficos computacionales, esto significa que la estimaci√≥n de la probabilidad de que el usuario <i>i</i> ponga una "clase" en la publicaci√≥n <i>j</i> es el sigmoide del producto escalar de incrustar el identificador de usuario y el identificador de publicaci√≥n.  Lo mismo se puede expresar mediante un diagrama: <br><br><img src="https://habrastorage.org/webt/dk/ac/1u/dkac1uzffso-cinlnzwefakma_s.png"><br><br>  Tal modelo no es muy interesante: no utiliza todas las caracter√≠sticas, no es demasiado √∫til para identificadores de baja frecuencia y sufre el problema de un arranque en fr√≠o.  Pero, habiendo formulado la tarea en forma de un gr√°fico computacional, "desatamos nuestras manos" y ahora podemos resolver problemas por etapas.  En primer lugar, para valores de baja frecuencia, crearemos la √∫nica incrustaci√≥n fuera del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">vocabulario</a> .  A continuaci√≥n, elimine la necesidad de tener incrustaciones de la misma dimensi√≥n.  Para hacer esto, reemplazamos el producto escalar con un perceptr√≥n poco profundo, que recibe caracter√≠sticas concatenadas como entrada.  El resultado se presenta en el diagrama: <br><br><img src="https://habrastorage.org/webt/c6/uk/-m/c6uk-mxjwwnwcx7trljgrelygq4.png"><br><br>  Una vez que nos deshacemos de una dimensi√≥n fija, nada nos impide comenzar a agregar nuevos atributos.  Representando la publicaci√≥n con todo tipo de caracter√≠sticas (idioma, autor, texto, ...), resolveremos el problema del inicio en fr√≠o de las publicaciones.  El modelo aprender√°, por ejemplo, que un usuario con <i>user_id = 42</i> coloca "clases" en publicaciones en ruso que contienen la palabra "alfombra".  En el futuro, podremos recomendar a este usuario todas las publicaciones en ruso sobre alfombras, incluso si no aparecen en los datos de capacitaci√≥n.  Para la incrustaci√≥n de texto, por ahora, simplemente promediaremos las incrustaciones de las palabras incluidas en √©l.  Como resultado, el modelo se ve as√≠: <br><br><img src="https://habrastorage.org/webt/6s/mq/ul/6smqulw3mslpoddknuyoigwkpgy.png"><br><br>  Finalmente, me gustar√≠a lidiar con el arranque en fr√≠o de los usuarios.  Ser√≠a posible construir caracter√≠sticas a partir de datos hist√≥ricos sobre las vistas de publicaciones de los usuarios.  Este enfoque no satisface la estrategia elegida: decidimos minimizar la creaci√≥n manual de atributos.  Por lo tanto, proporcion√© al modelo la oportunidad de aprender de forma independiente la presentaci√≥n del usuario a partir de la secuencia de publicaciones vistas antes de esa publicaci√≥n para la que se eval√∫a la probabilidad de la "clase".  A diferencia de la publicaci√≥n que se est√° evaluando, todos los comentarios se conocen para cada publicaci√≥n de la secuencia.  Esto significa que el modelo tendr√° acceso a informaci√≥n sobre si el usuario ha establecido las "publicaciones" en publicaciones anteriores o, por el contrario, las ha eliminado del feed. <br><br><img src="https://habrastorage.org/webt/qk/k0/6m/qkk06mydcetsmnd1roumkqigtm4.png"><br><br>  Queda por decidir c√≥mo combinar secuencias de publicaciones de diferentes longitudes en una representaci√≥n de un ancho fijo.  Como tal combinaci√≥n, utilic√© la suma ponderada de las representaciones de cada una de las publicaciones.  En el gr√°fico, el peso posterior <i>j se</i> denota por <i>Œ±_j</i> .  Los pesos se calcularon utilizando el mecanismo de atenci√≥n de valor clave-consulta, similar al utilizado en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">transformador</a> o <a href="">NMT</a> .  Por lo tanto, la presentaci√≥n aprendida del usuario tambi√©n se configura para la publicaci√≥n para la que se realiza la evaluaci√≥n.  Aqu√≠ hay una parte del gr√°fico responsable de calcular <i>Œ±_j</i> : <br><br><img src="https://habrastorage.org/webt/pq/dh/en/pqdhen_hrmrwsicjsokis3a6a_y.png"><br><br>  Despu√©s de <s>sentir un canto de juerga, me</s> convenc√≠ de la efectividad del enfoque de atenci√≥n, se decidi√≥ utilizar la atenci√≥n en la presentaci√≥n de textos.  En aras de ahorrar tiempo y hierro, decid√≠ no usar la auto-atenci√≥n como en el mismo transformador, sino entrenar directamente los pesos de las palabras en el texto, as√≠: <br><br><img src="https://habrastorage.org/webt/xw/nl/i5/xwnli58eyq6udoihpvpkjur5918.png"><br><br>  Sobre esto, se complet√≥ el desarrollo de la arquitectura del modelo.  Como resultado, pas√© de la factorizaci√≥n cl√°sica de matrices a un modelo de secuencia bastante complejo. <br><br><h2>  Resultados y an√°lisis </h2><br>  Desarroll√© y depur√© mi soluci√≥n en un s√©ptimo de los datos en una computadora port√°til con 16 GB de memoria y una tarjeta gr√°fica GeForce 930MX.  Se realizaron experimentos de datos completos en un servidor dedicado con 256 GB de memoria y una tarjeta Tesla T4.  Para la optimizaci√≥n, se utiliz√≥ el algoritmo Adam con los par√°metros predeterminados de MXNet.  La tabla muestra los resultados para un modelo simplificado: la longitud de la secuencia de publicaciones se limit√≥ a diez.  En el concurso presentado, utilic√© secuencias de longitud cincuenta. <br><br><table><tbody><tr><th width="120">  Modelo <br></th><th width="120">  P√©rdida de registro <br></th><th width="200">  Mejora de la l√≠nea anterior. <br></th><th width="100">  Tiempo de entrenamiento <br></th></tr><tr><td>  Al azar <br></td><td>  0.4374 ¬± 0.0009 <br></td><td></td><td></td></tr><tr><td>  Perceptr√≥n <br></td><td>  0.4330 ¬± 0.0010 <br></td><td>  0.0043 ¬± 0.0002 <br></td><td>  7 min <br></td></tr><tr><td>  Perceptr√≥n con signos <br></td><td>  0.4119 ¬± 0.0008 <br></td><td>  0.0212 ¬± 0.0003 <br></td><td>  44 min <br></td></tr><tr><td>  Perceptr√≥n con una secuencia de publicaciones <br></td><td>  0.3873 ¬± 0.0008 <br></td><td>  0.0247 ¬± 0.0003 <br></td><td>  4 horas 16 minutos <br></td></tr><tr><td>  Perceptr√≥n con una secuencia de publicaciones y atenci√≥n en los textos. <br></td><td>  0.3874 ¬± 0.0008 <br></td><td>  0.0001 ¬± 0.0001 <br></td><td>  4 horas 43 minutos <br></td></tr></tbody></table><br>  La √∫ltima l√≠nea result√≥ ser la m√°s inesperada para m√≠: usar la atenci√≥n en la presentaci√≥n de textos no proporciona una mejora visible en el resultado.  Esperaba que la red de atenci√≥n aprendiera el peso de las palabras en los textos, algo as√≠ como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">idf</a> .  Quiz√°s esto no sucedi√≥, porque los organizadores eliminaron las palabras de detenci√≥n por adelantado y las palabras de la misma importancia permanecieron en las listas preparadas.  Por lo tanto, el pesaje "inteligente" no dio una ventaja tangible en comparaci√≥n con el promedio simple.  Otra posible raz√≥n es que la red de atenci√≥n para las palabras era bastante peque√±a: conten√≠a solo una capa oculta estrecha.  Quiz√°s carec√≠a de capacidad de representaci√≥n para aprender algo √∫til. <br><br>  El mecanismo de atenci√≥n de consulta-valor-clave le permite mirar dentro del modelo y descubrir a qu√© "presta atenci√≥n" al tomar una decisi√≥n.  Para ilustrar esto, <b>seleccion√©</b> algunos ejemplos: <br><br><pre><code class="plaintext hljs">,       http://ollston.ru/2018/02/10/uznajte-kakogo-cveta-vasha - [0.02] PADDING - [0.02] PADDING - [0.02] PADDING - [0.02] PADDING - [0.16]        2016        2016 GZ8btjgY_Q0 https: - [0.16]  . Nike http://ollston.ru/2018/02/04/istorii-yspeha-nike/   -  : - [0.09]    - 5      - 5   O3qAop0A5Qs https://ww - [0.09] ...      ,          - [0.22] Microsoft Windows ‚Äî   http://ollston.ru/2018/02/06/microsoft-windows-istoriia-yspeha/  - [0.20]  ,   6  . ,   ? http://ollston.ru/2018/02/08/buddisty-g</code> </pre> <br>  La primera l√≠nea muestra el texto de la publicaci√≥n que debe evaluarse, luego las publicaciones vistas anteriormente y el puntaje de atenci√≥n correspondiente.  Con alivio, notamos que el modelo ha aprendido a ignorar el relleno.  El modelo consideraba las publicaciones como las m√°s importantes sobre los tipos de almas y sobre Windows.  Debe tenerse en cuenta que la atenci√≥n puede ser positiva (el usuario responder√° a una publicaci√≥n sobre un aura de la misma manera que una publicaci√≥n sobre tipos de almas) o negativa (evaluamos una publicaci√≥n sobre un aura; por lo tanto, la reacci√≥n no ser√° la misma que la reacci√≥n a la publicaci√≥n sobre tecnolog√≠a).  El siguiente ejemplo es la atenci√≥n "en todo su esplendor": <br><br><pre> <code class="plaintext hljs">          - [0.20]      2018    (),  ,    .     - [0.08]       ...  !!!        - [0.04]  )))  - [0.18]      !    ,   .  10   - [0.18]   2-    ,  5 , , 2 , . .   - [0.07]     !   -   ()       - [0.03]     "".   .       - [0.13]   ,    - [0.05] ,    ... - [0.05]     ...</code> </pre> <br>  Aqu√≠, la modelo vio claramente el tema de las vacaciones de verano.  Incluso los ni√±os y los gatitos fueron por el camino.  El siguiente ejemplo muestra que interpretar la atenci√≥n no siempre es posible.  A veces, incluso nada est√° claro: <br><br><pre> <code class="plaintext hljs">        ! - [0.02] PADDING - [0.02] PADDING - [0.02] PADDING - [0.02] PADDING - [0.02] PADDING - [0.15] , !   !!! - [0.16]  ! http://gifok.ru/dobryj-vecher/ - [0.20] http://gifq.ru/aforizmy/ - [0.25]     .  . - [0.15] ,      . : 800   250-300  </code> </pre> <br>  Despu√©s de mirar varias de esas listas, llegu√© a la conclusi√≥n de que el modelo pudo aprender lo que esperaba.  Lo siguiente que hice fue mirar la incrustaci√≥n de palabras.  En nuestro problema, no podemos esperar que las incrustaciones resulten tan hermosas como cuando se aprende un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">modelo de lenguaje</a> : estamos tratando de predecir una variable bastante ruidosa, adem√°s, no tenemos una peque√±a ventana de contexto: las incrustaciones de todas las palabras simplemente se promedian sin tener en cuenta su orden en el texto.  Ejemplos de tokens y sus vecinos m√°s cercanos en el espacio de incrustaci√≥n: <br><br><pre> <code class="plaintext hljs"> -  : , , , ,  -  : , , , ,  -  : , , , ,  -  : , , , ,  -  : , , , , </code> </pre> <br>  Parte de esta lista es f√°cil de explicar (programa - bl), algo es desconcertante (iPhone - youki), pero en general, el resultado volvi√≥ a cumplir mis expectativas. <br><br><h2>  Conclusi√≥n </h2><br>  Me gusta el enfoque para construir modelos basados ‚Äã‚Äãen gr√°ficos diferenciables ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">muchos</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">est√°n de acuerdo</a> ).  Le permite alejarse de la tediosa selecci√≥n manual de caracter√≠sticas y centrarse en la formulaci√≥n correcta del problema y dise√±ar arquitecturas interesantes.  Y aunque mi modelo ocup√≥ solo el segundo lugar en la tarea de texto SNA Hackathon 2019, estoy bastante satisfecho con este resultado, dada su simplicidad y sus opciones de expansi√≥n casi ilimitadas.  Estoy seguro de que en el futuro habr√° modelos cada vez m√°s interesantes y aplicables en los sistemas de combate basados ‚Äã‚Äãen ideas similares. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/445348/">https://habr.com/ru/post/445348/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../445336/index.html">FlexiRemap¬Æ vs RAID</a></li>
<li><a href="../445338/index.html">Servidor DHCP + Mysql en Python</a></li>
<li><a href="../445340/index.html">Aumente la seguridad de la red utilizando un analizador en la nube</a></li>
<li><a href="../445344/index.html">Plataforma de comunicaciones unificadas OpenVox</a></li>
<li><a href="../445346/index.html">C√≥mo escribir una API incorrecta</a></li>
<li><a href="../445350/index.html">Sonata: servidor de aprovisionamiento SIP</a></li>
<li><a href="../445352/index.html">Spark Structured Streaming Applications en Kubernetes. Experimenta FASTEN RUS</a></li>
<li><a href="../445354/index.html">Encontrar objetos en im√°genes</a></li>
<li><a href="../445356/index.html">Descripci√≥n general de la secci√≥n M√≥vil en DUMP-2019: m√°xima aplicada y √∫til en el trabajo diario</a></li>
<li><a href="../445358/index.html">Organizaci√≥n del sistema de eventos en Unity - a trav√©s de los ojos de un dise√±ador de juegos.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>