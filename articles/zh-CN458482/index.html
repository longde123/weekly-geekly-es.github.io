<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â˜®ï¸ ğŸ§—ğŸ¼ ğŸ¤½ ç¬¬3éƒ¨åˆ†ï¼šå‡ ä¹å°†Linuxä»SDå¡åŠ è½½åˆ°RocketChip ğŸ‘‰ğŸ¿ ğŸ‘¼ğŸ¾ ğŸˆº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨ä¸Šä¸€éƒ¨åˆ†ä¸­ ï¼Œå®ç°äº†æˆ–å¤šæˆ–å°‘å¯ä»¥å·¥ä½œçš„å­˜å‚¨å™¨æ§â€‹â€‹åˆ¶å™¨ï¼Œæˆ–è€…è¯´æ˜¯Quartusä¸ŠIP Coreçš„åŒ…è£…å™¨ï¼Œå®ƒæ˜¯TileLinkçš„é€‚é…å™¨ã€‚ ä»Šå¤©ï¼Œåœ¨â€œæˆ‘ä»¬å°†RocketChipç§»æ¤åˆ°å¸¦æœ‰Cycloneçš„é²œä¸ºäººçŸ¥çš„ä¸­å›½ä¸»æ¿â€æ ‡é¢˜ä¸‹ï¼Œæ‚¨å°†çœ‹åˆ°ä¸€ä¸ªå·¥ä½œæ§åˆ¶å°ã€‚ è¿™ä¸ªè¿‡ç¨‹æ‹–äº†ä¸€ç‚¹ç‚¹ï¼šæˆ‘å·²ç»ä»¥ä¸ºæˆ‘ä¼šå¿«é€Ÿå¯åŠ¨Li...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ç¬¬3éƒ¨åˆ†ï¼šå‡ ä¹å°†Linuxä»SDå¡åŠ è½½åˆ°RocketChip</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/458482/"><p><img src="https://habrastorage.org/webt/4j/fu/lu/4jfulumeapi32exqv7d6vnseaho.png" width="45%" align="left"> åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸Šä¸€éƒ¨åˆ†ä¸­</a> ï¼Œå®ç°äº†æˆ–å¤šæˆ–å°‘å¯ä»¥å·¥ä½œçš„å­˜å‚¨å™¨æ§â€‹â€‹åˆ¶å™¨ï¼Œæˆ–è€…è¯´æ˜¯Quartusä¸ŠIP Coreçš„åŒ…è£…å™¨ï¼Œå®ƒæ˜¯TileLinkçš„é€‚é…å™¨ã€‚ ä»Šå¤©ï¼Œåœ¨â€œæˆ‘ä»¬å°†RocketChipç§»æ¤åˆ°å¸¦æœ‰Cycloneçš„é²œä¸ºäººçŸ¥çš„ä¸­å›½ä¸»æ¿â€æ ‡é¢˜ä¸‹ï¼Œæ‚¨å°†çœ‹åˆ°ä¸€ä¸ªå·¥ä½œæ§åˆ¶å°ã€‚ è¿™ä¸ªè¿‡ç¨‹æ‹–äº†ä¸€ç‚¹ç‚¹ï¼šæˆ‘å·²ç»ä»¥ä¸ºæˆ‘ä¼šå¿«é€Ÿå¯åŠ¨Linuxå¹¶ç»§ç»­å‰è¿›ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰ã€‚ åœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘å»ºè®®çœ‹ä¸€ä¸‹å¯åŠ¨U-Bootï¼ŒBBLå’Œèƒ†å°çš„Linuxå†…æ ¸å°è¯•åˆå§‹åŒ–çš„è¿‡ç¨‹ã€‚ ä½†æ˜¯æœ‰ä¸€ä¸ªæ§åˆ¶å°-U-Boot-ovskyï¼Œå®ƒéå¸¸å…ˆè¿›ï¼Œå…·æœ‰æ‚¨ä»åŠŸèƒ½å®Œå–„çš„æ§åˆ¶å°ä¸­è·å¾—çš„å¾ˆå¤šæœŸæœ›ã€‚ </p><br><p>åœ¨ç¡¬ä»¶ä¸­ï¼Œå°†æ·»åŠ é€šè¿‡SPIå’ŒUARTè¿æ¥çš„SDå¡ã€‚ åœ¨è½¯ä»¶éƒ¨åˆ†ï¼ŒBootROMå°†ç”±<code>xip</code>æ›¿æ¢ä¸º<code>sdboot</code> ï¼Œå®é™…ä¸Šï¼Œå°†æ·»åŠ ä»¥ä¸‹å¼•å¯¼é˜¶æ®µï¼ˆåœ¨SDå¡ä¸Šï¼‰ã€‚ </p><a name="habracut"></a><br><h2 id="dopilivanie-apparatnoy-chasti"> æºæ‚ç¡¬ä»¶ </h2><br><p> å› æ­¤ï¼Œä»»åŠ¡æ˜¯ï¼šæ‚¨éœ€è¦åˆ‡æ¢åˆ°â€œå¤§â€å†…æ ¸ï¼Œå¹¶è¿æ¥UARTï¼ˆæ¥è‡ªRaspberryï¼‰å’ŒSDé€‚é…å™¨ï¼ˆä½¿ç”¨äº†å…·æœ‰å…­ä¸ªå¼•è„šçš„Catalexæ¿ï¼šGNDï¼ŒVCCï¼ŒMISOï¼ŒMOSIï¼ŒSCKï¼ŒCSï¼‰ã€‚ </p><br><p> åŸåˆ™ä¸Šï¼Œä¸€åˆ‡éƒ½éå¸¸ç®€å•ã€‚ ä½†æ˜¯åœ¨æ„è¯†åˆ°è¿™ä¸€ç‚¹ä¹‹å‰ï¼Œæˆ‘æœ‰ç‚¹<code>HasPeripheryUART</code> ï¼šåœ¨ä¸Šä¸€æ¬¡ä¹‹åï¼Œæˆ‘å†³å®šå†æ¬¡éœ€è¦å°†ç±»ä¼¼<code>HasPeripheryUART</code>ä¸œè¥¿<code>HasPeripheryUART</code> <code>System</code> ï¼ˆä»¥åŠç›¸åº”çš„å®ç°ï¼‰ä¸­ï¼Œå°±åƒSDå¡ä¸€æ ·-å°±æ˜¯è¿™æ ·å‡†å¤‡å¥½äº†ã€‚ ç„¶åï¼Œæˆ‘å†³å®šçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•åœ¨â€œä¸¥è‚ƒçš„â€è®¾è®¡ä¸­å®ç°çš„ã€‚ é‚£ä¹ˆæˆ‘ä»¬ä»ä¸¥è‚ƒä¸­å¾—åˆ°äº†ä»€ä¹ˆï¼Ÿ æ˜¾ç„¶ï¼Œ <code>unleahshed.DevKitConfigs</code> Artyï¼‰ä¸é€‚åˆ-æ€ªç‰©ä»æœª<code>unleahshed.DevKitConfigs</code> ã€‚ çªç„¶å‘ç°ï¼Œåˆ°å¤„éƒ½æ˜¯é€šè¿‡é”®é€šè¿‡å‚æ•°æ·»åŠ æŸç§ç±»å‹çš„å åŠ å±‚ã€‚ æˆ‘æƒ³è¿™å¯èƒ½æ˜¯éå¸¸çµæ´»å’Œå¯é…ç½®çš„ï¼Œä½†æ˜¯æˆ‘æƒ³ä»å¤´å¼€å§‹... <em>ä½†æ˜¯æ‚¨æ²¡æœ‰ç›¸åŒçš„ä¸œè¥¿ï¼Œåªæ˜¯</em> <code>vera.iofpga.FPGAChip</code> <em>ï¼Ÿ..</em>ç„¶åæˆ‘é‡åˆ°äº†<code>vera.iofpga.FPGAChip</code>ç”¨äºFPGA Microsemiå’Œ <del> é©¬ä¸ŠæŠŠå¼•å· </del> æˆ‘å°è¯•ç±»æ¨å®ç°ï¼Œè¿™é‡Œçš„å¥½å¤„æˆ–å¤šæˆ–å°‘æ˜¯åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­æ•´ä¸ªâ€œä¸»æ¿å¸ƒå±€â€ã€‚ </p><br><p> åŸæ¥ï¼Œå®é™…ä¸Šï¼Œæ‚¨åªéœ€è¦å‘<code>System.scala</code>æ·»åŠ è¡Œ </p><br><pre> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">System</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">implicit p: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Parameters</span></span></span></span></span><span class="hljs-class">) </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RocketSubsystem</span></span></span><span class="hljs-class"> ... </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HasPeripherySPI</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HasPeripheryUART</span></span></span><span class="hljs-class"> ... </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> tlclock = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">FixedClockResource</span></span>(<span class="hljs-string"><span class="hljs-string">"tlclk"</span></span>, p(<span class="hljs-type"><span class="hljs-type">DevKitFPGAFrequencyKey</span></span>)) ... } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SystemModule</span></span></span><span class="hljs-class">[+</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">L</span></span></span><span class="hljs-class"> &lt;: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">System</span></span></span><span class="hljs-class">](</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">_outer: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">L</span></span></span></span></span><span class="hljs-class">) </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RocketSubsystemModuleImp</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">_outer</span></span></span><span class="hljs-class">) ... </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HasPeripheryUARTModuleImp</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HasPeripheryGPIOModuleImp</span></span></span><span class="hljs-class"> ...</span></span></code> </pre> <br><p>  <code>System</code>ç±»æ­£æ–‡ä¸­çš„ä¸€è¡Œå°†æœ‰å…³SoCè¿™éƒ¨åˆ†å·¥ä½œé¢‘ç‡çš„ä¿¡æ¯æ·»åŠ åˆ°dtsæ–‡ä»¶ä¸­ã€‚ æ®æˆ‘äº†è§£ï¼ŒDTS / DTBæ˜¯åµŒå…¥å¼è®¾å¤‡å³æ’å³ç”¨æŠ€æœ¯çš„é™æ€æ¨¡æ‹Ÿï¼šdtsæè¿°æ ‘è¢«ç¼–è¯‘æˆäºŒè¿›åˆ¶dtbæ–‡ä»¶ï¼Œå¹¶ç”±åŠ è½½ç¨‹åºä¼ è¾“åˆ°å†…æ ¸ï¼Œä»¥ä¾¿å®ƒå¯ä»¥æ­£ç¡®é…ç½®ç¡¬ä»¶ã€‚ æœ‰è¶£çš„æ˜¯ï¼Œæ²¡æœ‰<code>tlclock</code>è¡Œï¼Œæ‰€æœ‰å†…å®¹éƒ½å¯ä»¥å®Œç¾åœ°åˆæˆï¼Œä½†æ˜¯æ— æ³•ç¼–è¯‘BootROMï¼ˆæˆ‘ä¼šæé†’æ‚¨ï¼Œç°åœ¨å®ƒå°†æ˜¯<code>sdboot</code> ï¼‰-åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œå®ƒè§£ædtsæ–‡ä»¶å¹¶åˆ›å»ºå¸¦æœ‰<code>TL_CLK</code>å®çš„æ ‡å¤´ï¼Œè¿™å¯ä»¥ä¸ºå…¶æ­£ç¡®åœ°é…ç½®åˆ†é¢‘å™¨å¤–éƒ¨æ¥å£ã€‚ </p><br><p> æ‚¨è¿˜éœ€è¦ç¨å¾®ä¿®æ­£ä¸€ä¸‹â€œæ¥çº¿â€ï¼š </p><br><p>  <strong>Platform.scalaï¼š</strong> </p><br><pre> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PlatformIO</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">implicit val p: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Parameters</span></span></span></span></span><span class="hljs-class">) </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bundle</span></span></span><span class="hljs-class"> </span></span>{ ... <span class="hljs-comment"><span class="hljs-comment">// UART io.uart_tx := sys.uart(0).txd sys.uart(0).rxd := RegNext(RegNext(io.uart_rx)) // SD card io.sd_cs := sys.spi(0).cs(0) io.sd_sck := sys.spi(0).sck io.sd_mosi := sys.spi(0).dq(0).o sys.spi(0).dq(0).i := false.B sys.spi(0).dq(1).i := RegNext(RegNext(io.sd_miso)) sys.spi(0).dq(2).i := false.B sys.spi(0).dq(3).i := false.B }</span></span></code> </pre> <br><p> å¦ç‡åœ°è¯´ï¼Œå¯„å­˜å™¨é“¾åªæ˜¯é€šè¿‡ä¸æºä»£ç ä¸­çš„å…¶ä»–ä¸€äº›åœ°æ–¹ç±»ä¼¼çš„æ–¹å¼æ·»åŠ çš„ã€‚ ä»–ä»¬å¾ˆå¯èƒ½åº”è¯¥é˜²æ­¢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">äºšç¨³</a> ã€‚ ä¹Ÿè®¸<em>æŸäº›</em>å—å·²ç»æœ‰è‡ªå·±çš„ä¿æŠ¤ï¼Œä½†æ˜¯é¦–å…ˆæˆ‘æƒ³è‡³å°‘â€œé«˜æ°´å¹³â€è¿è¡Œã€‚ å¯¹æˆ‘æ¥è¯´æ›´æœ‰è¶£çš„é—®é¢˜æ˜¯ï¼Œä¸ºä»€ä¹ˆMISOå’ŒMOSIæŒ‚åœ¨ä¸åŒçš„<code>dq</code> ï¼Ÿ æˆ‘ä»ç„¶æ²¡æœ‰æ‰¾åˆ°ç­”æ¡ˆï¼Œä½†æ˜¯ä¼¼ä¹å…¶ä½™çš„ä»£ç éƒ½ä¾é è¿™æ ·çš„è¿æ¥ã€‚ </p><br><p> åœ¨ç‰©ç†ä¸Šï¼Œæˆ‘åªæ˜¯å°†è®¾è®¡ç»“è®ºåˆ†é…ç»™æ¨¡å—ä¸Šçš„æ¾åŠ¨è§¦ç‚¹ï¼Œç„¶åå°†ç”µå‹é€‰æ‹©è·³çº¿é‡æ–°æ’åˆ—ä¸º3.3Vã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">SDé€‚é…å™¨</b> <div class="spoiler_text"><p> é¡¶è§†å›¾ï¼š </p><br><img src="https://habrastorage.org/webt/su/zf/q4/suzfq4lwejcelmwt3rpk5w_min0.jpeg"><br><p> åº•è§†å›¾ï¼š </p><br><img src="https://habrastorage.org/webt/y0/__/qq/y0__qqavfhkikpsorvmzqhbamlw.jpeg"></div></div><br><h2 id="otladka-programmnoy-chasti-instrumenty"> è°ƒè¯•è½¯ä»¶éƒ¨åˆ†ï¼šå·¥å…· </h2><br><p> é¦–å…ˆï¼Œè®©æˆ‘ä»¬è°ˆè°ˆå¯ç”¨çš„è°ƒè¯•å·¥å…·åŠå…¶é™åˆ¶ã€‚ </p><br><h3 id="minicom"> è¿·ä½ é€š </h3><br><p> é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä»¥æŸç§æ–¹å¼è¯»å–å¼•å¯¼åŠ è½½ç¨‹åºå’Œå†…æ ¸è¾“å‡ºã€‚ ä¸ºæ­¤ï¼Œåœ¨Linuxä¸Šï¼ˆæœ¬ä¾‹ä¸­ä¸ºRaspberryPiä¸Šçš„ä¸€ä¸ªï¼‰ï¼Œæˆ‘ä»¬éœ€è¦Minicomç¨‹åºã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œé€‚ç”¨äºä¸²è¡Œç«¯å£çš„ä»»ä½•ç¨‹åºå‡é€‚ç”¨ã€‚ </p><br><p> è¯·æ³¨æ„ï¼Œåœ¨å¯åŠ¨æ—¶ï¼Œå¿…é¡»åœ¨<code>-D</code>é€‰é¡¹ä¹‹åå°†ç«¯å£è®¾å¤‡åç§°æŒ‡å®šä¸º<code>-D /dev/ttyS0</code> ã€‚ å¥½å§ï¼Œä¸»è¦ä¿¡æ¯ï¼šè¦é€€å‡ºï¼Œè¯·ä½¿ç”¨<code>Ctrl-A, X</code> æˆ‘ç¡®å®é‡åˆ°äº†è¿™ç§ç»„åˆä¸èµ·ä½œç”¨çš„æƒ…å†µ-ç„¶åæ‚¨å¯ä»¥ä»ç›¸é‚»çš„SSHä¼šè¯ä¸­ç®€å•åœ°è¯´å‡º<code>killall -KILL minicom</code> ã€‚ </p><br><p> è¿˜æœ‰å¦ä¸€ä¸ªåŠŸèƒ½ã€‚ å…·ä½“æ¥è¯´ï¼ŒRaspberryPiä¸Šæœ‰ä¸¤ä¸ªUARTï¼Œå¹¶ä¸”ä¸¤ä¸ªç«¯å£éƒ½å·²ç»å¯ä»¥é€‚åº”æŸç§æƒ…å†µï¼šä¸€ä¸ªç”¨äºè“ç‰™ï¼Œå¦ä¸€ä¸ªé€šè¿‡å†…æ ¸ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šæ˜¾ç¤ºå†…æ ¸æ§åˆ¶å°ã€‚ å¹¸è¿çš„æ˜¯ï¼Œå¯ä»¥<a href="">æ ¹æ®æœ¬æ‰‹å†Œ</a>é‡æ–°é…ç½®æ­¤è¡Œä¸ºã€‚ </p><br><h3 id="perepisyvanie-pamyati"> æ”¹å†™å†…å­˜ </h3><br><p> åœ¨è°ƒè¯•æ—¶ï¼Œä¸ºäº†æ£€éªŒå‡è®¾ï¼Œæœ‰æ—¶æˆ‘ä¸å¾—ä¸ç›´æ¥ä»ä¸»æœº<em>å°†å¼•å¯¼åŠ è½½ç¨‹åº</em> ï¼ˆæŠ±æ­‰ï¼‰ <em>åŠ è½½</em>åˆ°RAMä¸­ã€‚ ä¹Ÿè®¸å¯ä»¥ç›´æ¥ä»GDBå®Œæˆï¼Œä½†æ˜¯æœ€åæˆ‘é‡‡ç”¨äº†ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼šæˆ‘å°†å¿…éœ€çš„æ–‡ä»¶å¤åˆ¶åˆ°Raspberryï¼Œè¿˜é€šè¿‡SSHå‘é€äº†ç«¯å£4444ï¼ˆæ¥è‡ªOpenOCDçš„telnetï¼‰å¹¶ä½¿ç”¨äº†<code>load_image</code>å‘½ä»¤ã€‚ å½“æ‚¨æ‰§è¡Œå®ƒæ—¶ï¼Œä¼¼ä¹æ‰€æœ‰å†…å®¹éƒ½è¢«å†»ç»“äº†ï¼Œä½†å®é™…ä¸Š<em>â€œå®ƒä¸ä¼‘çœ ï¼Œå®ƒåªæ˜¯ç¼“æ…¢é—ªçƒâ€</em> ï¼šå®ƒåŠ è½½æ–‡ä»¶ï¼Œå®ƒä»¥æ¯ç§’å‡ åƒå­—èŠ‚çš„é€Ÿåº¦è¿è¡Œã€‚ </p><br><h3 id="osobennosti-ustanovki-breakpoint-ov"> å®‰è£…æ–­ç‚¹çš„åŠŸèƒ½ </h3><br><p> å¯èƒ½ï¼Œè®¸å¤šäººåœ¨è°ƒè¯•å¸¸è§„ç¨‹åºæ—¶ä¸å¿…è€ƒè™‘è¿™ä¸€ç‚¹ï¼Œä½†æ˜¯æ–­ç‚¹å¹¶ä¸æ€»æ˜¯åœ¨ç¡¬ä»¶ä¸­è®¾ç½®çš„ã€‚ æœ‰æ—¶è®¾ç½®æ–­ç‚¹æ¶‰åŠ<strong>ç›´æ¥åœ¨æœºå™¨ä»£ç ä¸­</strong>ä¸´æ—¶å°†ç‰¹æ®ŠæŒ‡ä»¤ä¸´æ—¶å†™åˆ°æ­£ç¡®çš„ä½ç½®ã€‚ ä¾‹å¦‚ï¼Œè¿™å°±æ˜¯æˆ‘åœ¨GDBä¸­çš„æ ‡å‡†<code>b</code>å‘½ä»¤çš„å·¥ä½œæ–¹å¼ã€‚ è¿™æ˜¯ä»ä¸­å¾—å‡ºçš„ç»“æœï¼š </p><br><ul><li> ä½ ä¸èƒ½åœ¨BootROMé‡Œé¢æ”¾ä¸€ç‚¹ï¼Œå› ä¸ºROM </li><li> æ‚¨å¯ä»¥åœ¨ä»SDå¡åŠ è½½åˆ°RAMçš„ä»£ç ä¸Šè®¾ç½®ä¸€ä¸ªæ–­ç‚¹ï¼Œä½†æ˜¯éœ€è¦ç­‰åˆ°å®ƒè¢«åŠ è½½åæ‰èƒ½è®¾ç½®ã€‚ å¦åˆ™ï¼Œæˆ‘ä»¬å°†ä¸ä¼šé‡å†™ä¸€æ®µä»£ç ï¼Œä½†æ˜¯åŠ è½½å™¨ä¼šé‡å†™æˆ‘ä»¬çš„æ–­ç‚¹ </li></ul><br><p> æˆ‘æ•¢è‚¯å®šï¼Œæ‚¨å¯ä»¥æ˜ç¡®è¦æ±‚ä½¿ç”¨ç¡¬ä»¶æ–­ç‚¹ï¼Œä½†æ˜¯æ— è®ºå¦‚ä½•å®ƒä»¬æ•°é‡æœ‰é™ã€‚ </p><br><h3 id="bystraya-podmena-bootrom"> å¿«é€ŸBootROMäº¤æ¢ </h3><br><p> åœ¨è°ƒè¯•çš„åˆå§‹é˜¶æ®µï¼Œé€šå¸¸éœ€è¦ä¿®å¤BootROMå¹¶é‡è¯•ã€‚ ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼šBootROMæ˜¯è½½å…¥FPGAçš„è®¾è®¡çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒçš„åˆæˆè¿‡ç¨‹å¤§çº¦éœ€è¦å‡ åˆ†é’Ÿï¼ˆè¿™æ˜¯åœ¨å‡ ä¹ç«‹å³ä»Cå’ŒAssemblerç¼–è¯‘BootROMæ˜ åƒæœ¬èº«ä¹‹åå®Œæˆçš„ï¼‰ã€‚ å¹¸è¿çš„æ˜¯ï¼Œå®é™…ä¸Šï¼Œä¸€åˆ‡éƒ½<strong>å¿«å¾—å¤š</strong> ï¼šæ“ä½œé¡ºåºå¦‚ä¸‹ï¼š </p><br><ul><li> é‡æ–°ç”Ÿæˆbootrom.mifï¼ˆæˆ‘åˆ‡æ¢åˆ°MIFè€Œä¸æ˜¯HEXï¼Œå› ä¸ºä½¿ç”¨HEXæ—¶æˆ‘æ€»æ˜¯é‡åˆ°ä¸€äº›é—®é¢˜ï¼Œå¹¶ä¸”MIFæ˜¯æœ¬æœºçš„Alteræ ¼å¼ï¼‰ </li><li> åœ¨Quartusä¸­è¯´<code>Processing -&gt; Update Memory Initialization File</code> </li><li> åœ¨æ±‡ç¼–å™¨ä¸Šï¼ˆåœ¨â€œä»»åŠ¡â€çš„å·¦åˆ—ä¸­ï¼‰ï¼Œå†æ¬¡å‘½ä»¤â€œå¯åŠ¨â€ </li></ul><br><p> å¯¹äºä¸€åˆ‡çš„ä¸€åˆ‡-å‡ åç§’ã€‚ </p><br><h2 id="podgotovka-sd-karty">  SDå¡å‡†å¤‡ </h2><br><p> è¿™é‡Œçš„ä¸€åˆ‡éƒ½ç›¸å¯¹ç®€å•ï¼Œä½†æ˜¯æ‚¨éœ€è¦è€å¿ƒç­‰å¾…ï¼Œå¹¶å…·æœ‰å¤§çº¦14Gbçš„ç£ç›˜ç©ºé—´ï¼š </p><br><pre> <code class="plaintext hljs">git clone https://github.com/sifive/freedom-u-sdk git submodule update --recursive --init make</code> </pre> <br><p> ç„¶åï¼Œæ‚¨éœ€è¦æ’å…¥ä¸€ä¸ªå¹²å‡€çš„ï¼Œæˆ–è€…è¯´ä¸åŒ…å«ä»»ä½•æ‰€éœ€å†…å®¹çš„SDå¡ï¼Œç„¶åæ‰§è¡Œ </p><br><pre> <code class="plaintext hljs">sudo make DISK=/dev/sdX format-boot-loader</code> </pre> <br><p>  ...å…¶ä¸­<code>sdX</code>æ˜¯åˆ†é…ç»™å¡çš„è®¾å¤‡ã€‚  <strong>æ³¨æ„ï¼šå¡ä¸Šçš„æ•°æ®é€šå¸¸ä¼šè¢«åˆ é™¤ï¼Œè¦†ç›–ï¼</strong> ä»<code>sudo</code>ä¸‹è¿›è¡Œæ•´ä¸ªç¨‹åºé›†å‡ ä¹ä¸å€¼å¾—ï¼Œå› ä¸ºè¿™æ ·æ‰€æœ‰ç¨‹åºé›†å·¥ä»¶å°†ç”±<code>root</code>æ‹¥æœ‰ï¼Œå¹¶ä¸”ç¨‹åºé›†å¿…é¡»å§‹ç»ˆåœ¨<code>sudo</code>ä¸‹è¿›è¡Œã€‚ </p><br><p> ç»“æœæ˜¯åœ¨GPTä¸­æ ‡è®°çš„å¡åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯å¸¦æœ‰<code>uEnv.txt</code> FATå’Œä¸€ä¸ªFITæ ¼å¼çš„å¯ä¸‹è½½å›¾åƒï¼ˆå®ƒåŒ…å«å‡ ä¸ªå­å›¾åƒï¼Œæ¯ä¸ªå­å›¾åƒéƒ½æœ‰è‡ªå·±çš„ä¸‹è½½åœ°å€ï¼‰ï¼Œå¦ä¸€éƒ¨åˆ†ä¸ºç©ºç™½ï¼Œåº”è¯¥åœ¨Ext4ä¸­æ ¼å¼åŒ–ã€‚å¯¹äºLinuxã€‚ è¿˜æœ‰ä¸¤ä¸ªéƒ¨åˆ†æ˜¯<em>ç¥ç§˜çš„</em> ï¼šU-Booté©»ç•™åœ¨ä¸€ä¸ªä½ç½®ï¼ˆæ®æˆ‘æ‰€çŸ¥ï¼Œå®ƒçš„åç§»é‡è¿æ¥åœ¨BootROMä¸­ï¼‰ï¼Œå¦ä¸€æ–¹é¢ï¼Œå®ƒçš„ç¯å¢ƒå˜é‡ä¼¼ä¹å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œä½†æˆ‘å°šæœªä½¿ç”¨å®ƒä»¬ã€‚ </p><br><h2 id="uroven-pervyy-bootrom"> ä¸€çº§ï¼ŒBootROM </h2><br><p> æ°‘é—´æ™ºæ…§è¯´ï¼šâ€œåœ¨ç¼–ç¨‹ä¸­ï¼Œå¦‚æœè¦ç”¨é“ƒé¼“è·³èˆï¼Œé‚£ä¹ˆåœ¨ç”µå­äº§å“ä¸­ä¹Ÿè¦ç”¨ç­ç«å™¨è·³èˆã€‚â€ ç”šè‡³è¿˜æ²¡æœ‰ä¸€æ¬¡ï¼Œæˆ‘å‡ ä¹çƒ§æ¯äº†ç”µè·¯æ¿ï¼Œå¹¶ç¡®å®šâ€œå¥½ï¼ŒGNDå¤„äºç›¸åŒçš„ä½ç”µå¹³â€ <em>ï¼ˆæ˜¾ç„¶ï¼Œç”µé˜»å™¨ä»ç„¶ä¸ä¼šä¼¤å®³...ï¼‰</em>æ›´å¤šçš„æ˜¯ï¼Œå¦‚æœåŒæ‰‹ä¸ä¼šä»é‚£é‡Œä¼¸å‡ºæ¥ï¼Œç„¶åç”µå­è®¾å¤‡å°±ä¸ä¼šåœæ­¢å¸¦æ¥æƒŠå–œï¼šå½“æˆ‘å°†è¿æ¥å™¨ç„Šæ¥åˆ°æ¿ä¸Šæ—¶ï¼Œæˆ‘ä»ç„¶æ— æ³•æ­£å¸¸æº¶è§£è§¦ç‚¹-è§†é¢‘æ˜¾ç¤ºäº†ç„Šæ–™å¦‚ä½•ç›´æ¥åœ¨æ•´ä¸ªè¿æ¥ä¸­æ‰©æ•£ï¼Œåªéœ€å°†çƒ™é“æ”¾å…¥ï¼Œå®ƒå°±è½åœ¨æˆ‘èº«ä¸Šæ— è®ºå¦‚ä½•ã€‚ å¥½å§ï¼Œä¹Ÿè®¸ç„Šé”¡ä¸é€‚åˆçƒ™é“çš„æ¸©åº¦ï¼Œä¹Ÿè®¸è¿˜æœ‰å…¶ä»–ä¸œè¥¿â€¦â€¦æ€»çš„æ¥è¯´ï¼Œå½“æˆ‘çœ‹åˆ°å·²ç»æœ‰åå‡ ä¸ªè§¦ç‚¹æ—¶ï¼Œæˆ‘åå£æ°´å¹¶å¼€å§‹è°ƒè¯•ã€‚ ç„¶å<em>ç¥ç§˜çš„</em>äº‹æƒ…å¼€å§‹äº†ï¼šæˆ‘ä»UARTè¿æ¥äº†RX / TXï¼Œæˆ‘åŠ è½½äº†å›ºä»¶-å®ƒå†™ </p><br><pre> <code class="plaintext hljs">INIT CMD0 ERROR</code> </pre> <br><p> å¥½å§ï¼Œä¸€åˆ‡éƒ½æ˜¯åˆä¹é€»è¾‘çš„-æˆ‘æ²¡æœ‰è¿æ¥SDå¡æ¨¡å—ã€‚ æˆ‘ä»¬è§£å†³äº†è¿™ç§æƒ…å†µï¼ŒåŠ è½½äº†å›ºä»¶â€¦â€¦ç„¶åä¿æŒæ²‰é»˜â€¦â€¦æˆ‘åªæ˜¯æ²¡æœ‰æ”¹å˜ä¸»æ„ï¼Œåªæ˜¯æ‰“å¼€äº†æ£ºæï¼šå¿…é¡»å°†æ¨¡å—è¾“å‡ºä¹‹ä¸€è¿æ¥åˆ°VCCã€‚ å°±æˆ‘è€Œè¨€ï¼Œè¯¥æ¨¡å—æ”¯æŒ5Vç”µæºï¼Œå› æ­¤ï¼Œæˆ‘ä¸‰æ€è€Œåè¡Œï¼Œå°†ä¸€æ ¹ä»æ¨¡å—å»¶ä¼¸åˆ°æ¿å­å¦ä¸€ä¾§çš„ç”µçº¿ç²˜äº†èµ·æ¥ã€‚ ç»“æœï¼Œå¼¯æ›²çš„ç„Šæ¥è¿æ¥å™¨æ‰­æ›²äº†ï¼Œè€Œ<strong>UARTçš„è§¦ç‚¹å®Œå…¨ä¸¢å¤±äº†ã€‚</strong>  <em>facepalm.jpg</em>ä¸€èˆ¬æ¥è¯´ï¼Œâ€œå¤´åä¸èƒ½ä½¿è…¿å¾—åˆ°ä¼‘æ¯â€ï¼Œè€Œå¼¯æ›²çš„æ‰‹-å¤´... </p><br><p> æœ€åï¼Œæˆ‘çœ‹åˆ°äº†æœŸå¾…å·²ä¹…çš„Minicom </p><br><pre> <code class="plaintext hljs">INIT CMD0 CMD8 ACMD41 CMD58 CMD16 CMD18 LOADING /</code> </pre> <br><p> è€Œä¸”ï¼Œ <del> å®ƒç§»åŠ¨ </del> åŠ è½½æŒ‡ç¤ºç¯æ­£åœ¨æ—‹è½¬ã€‚ æˆ‘ç›´æ¥å›æƒ³èµ·å­¦å¹´å’Œä»è½¯ç›˜è½»æ¾å¯åŠ¨MinuetOSã€‚ é™¤éé©±åŠ¨å™¨æ‰“ç£¨ã€‚ </p><br><p> é—®é¢˜æ˜¯BOOTæ¶ˆæ¯åä»€ä¹ˆä¹Ÿæ²¡å‘ç”Ÿã€‚ å› æ­¤ï¼Œæ˜¯æ—¶å€™é€šè¿‡Raspberryä¸Šçš„OpenOCDï¼Œä¸»æœºä¸Šçš„GDBè¿æ¥åˆ°å®ƒäº†ï¼Œçœ‹çœ‹å®ƒæ˜¯ä»€ä¹ˆäº†ã€‚ </p><br><p> é¦–å…ˆï¼Œç«‹å³ä¸GDBè¿æ¥è¡¨æ˜<code>$pc</code> ï¼ˆç¨‹åºè®¡æ•°å™¨ï¼Œå½“å‰æŒ‡ä»¤çš„åœ°å€ï¼‰é£åˆ°<code>0x0</code>è¿™å¯èƒ½æ˜¯åœ¨å¤šæ¬¡é”™è¯¯ä¹‹åå‘ç”Ÿçš„ã€‚ å› æ­¤ï¼Œåœ¨å‘å‡º<code>BOOT</code>æ¶ˆæ¯åï¼Œç«‹å³æ·»åŠ æ— é™å¾ªç¯ã€‚  <em>è¿™å°†ä½¿ä»–å»¶è¿Ÿä¸€ä¼šå„¿...</em> </p><br><pre> <code class="diff hljs">diff --git a/bootrom/sdboot/sd.cb/bootrom/sdboot/sd.c index c6b5ede..bca1b7f 100644 --- a/bootrom/sdboot/sd.c +++ b/bootrom/sdboot/sd.c @@ -224,6 +224,8 @@ int main(void) kputs("BOOT"); + while(*(volatile char *)0x10000){} + __asm__ __volatile__ ("fence.i" : : : "memory"); return 0; }</code> </pre> <br><p> æ­¤ç±»æ£˜æ‰‹çš„ä»£ç ç”¨äºâ€œå¯é æ€§â€ï¼šæˆ‘åœ¨æŸå¤„å¬è¯´ï¼Œæ— é™å¾ªç¯æ˜¯æœªå®šä¹‰è¡Œä¸ºï¼Œåœ¨è¿™é‡Œç¼–è¯‘å™¨ä¸å¤ªå¯èƒ½çŒœæµ‹ï¼ˆæˆ‘è®°å¾—BootROMä½äº<code>0x10000</code> ï¼‰ã€‚ </p><br><p><img src="https://habrastorage.org/webt/wj/xw/a9/wjxwa9m9hqoghtvy79zsbysctr0.png" alt="æœ‰è°ƒè¯•å™¨ï¼Œæ— æº"></p><br><p> çœ‹èµ·æ¥ï¼Œä½†è¿˜æœ‰ä»€ä¹ˆæœŸæœ›-è‹›åˆ»çš„åµŒå…¥å¼æŠ€æœ¯ï¼Œé‚£é‡Œæœ‰ä»€ä¹ˆæ ·çš„èµ„æºã€‚ ä½†æ˜¯æ¯•ç«Ÿï¼Œåœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é‚£ç¯‡æ–‡ç« ä¸­ï¼Œ</a>ä½œè€…è°ƒè¯•äº†ä»£ç ... Krex-fex-pexï¼š </p><br><pre> <code class="plaintext hljs">(gdb) file builds/zeowaa-e115/sdboot.elf A program is being debugged already. Are you sure you want to change the file? (y or n) y Reading symbols from builds/zeowaa-e115/sdboot.elf...done.</code> </pre> <br><p><img src="https://habrastorage.org/webt/ya/08/zp/ya08zpufla55qz02j5fhwcoijy4.png" alt="æœ‰æºä»£ç ï¼"></p><br><p> ä»…æ‚¨ä¸éœ€è¦åŠ è½½MIFæ–‡ä»¶å’Œbinæ–‡ä»¶ï¼Œè€Œæ˜¯ELFæ ¼å¼çš„åŸå§‹ç‰ˆæœ¬ã€‚ </p><br><p> ç°åœ¨ï¼Œé€šè¿‡ç¬¬næ¬¡å°è¯•çŒœæµ‹å°†ç»§ç»­æ‰§è¡Œçš„åœ°å€ï¼ˆè¿™æ˜¯ç¼–è¯‘å™¨ä¸åº”è¯¥çŒœæµ‹å¾ªç¯æ˜¯æ— é™çš„å¦ä¸€ä¸ªåŸå› ï¼‰ã€‚ å›¢é˜Ÿ </p><br><pre> <code class="plaintext hljs">set variable $pc=0xADDR</code> </pre> <br><p> å…è®¸æ‚¨éšæ—¶æ›´æ”¹å¯„å­˜å™¨çš„å€¼ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯å½“å‰æŒ‡ä»¤çš„åœ°å€ï¼‰ã€‚ å€ŸåŠ©å®ƒçš„å¸®åŠ©ï¼Œæ‚¨å¯ä»¥æ›´æ”¹è®°å½•åœ¨å†…å­˜ï¼ˆå’Œå†…å­˜æ˜ å°„å¯„å­˜å™¨ï¼‰ä¸­çš„å€¼ã€‚ </p><br><p> æœ€åï¼Œæˆ‘å¾—å‡ºçš„ç»“è®ºï¼ˆä¸ç¡®å®šä»€ä¹ˆæ˜¯æ­£ç¡®çš„ï¼‰æ˜¯ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªâ€œé”™è¯¯ç³»ç»Ÿçš„sdå¡æ˜ åƒâ€ï¼Œæˆ‘ä»¬ä¸å¿…èµ°åˆ°ä¸‹è½½æ•°æ®çš„æœ€å¼€å§‹ï¼Œè€Œæ˜¯èµ°<code>0x89800</code>å­—èŠ‚ï¼š </p><br><pre> <code class="diff hljs">diff --git a/bootrom/sdboot/head.S b/bootrom/sdboot/head.S index 14fa740..2a6c944 100644 --- a/bootrom/sdboot/head.S +++ b/bootrom/sdboot/head.S @@ -13,7 +13,7 @@ _prog_start: smp_resume(s1, s2) csrr a0, mhartid la a1, dtb - li s1, PAYLOAD_DEST + li s1, (PAYLOAD_DEST + 0x89800) jr s1 .section .rodata</code> </pre> <br><p> ä¹Ÿè®¸è¿™è¿˜å—åˆ°ä»¥ä¸‹äº‹å®çš„å½±å“ï¼šæˆ‘æ‰‹å¤´æ²¡æœ‰å¤šä½™çš„4Gbå¡ï¼Œæˆ‘å°†å…¶å¸¦åˆ°2Gbï¼Œç„¶åå°†å…¶æ›¿æ¢ä¸ºMakefileä¸­çš„<code>DEMO_END=11718750</code> ï¼Œ <code>DEMO_END=3078900</code> ï¼ˆä¸è¦æŸ¥æ‰¾ç‰¹å®šå€¼çš„å«ä¹‰-å®ƒä¸å­˜åœ¨ï¼Œåªæ˜¯ç°åœ¨æ”¾ç½®äº†å›¾åƒå¡ï¼‰ã€‚ </p><br><h2 id="uroven-vtoroy-u-boot"> ç¬¬äºŒçº§ï¼ŒU-Boot </h2><br><p> ç°åœ¨æˆ‘ä»¬ä»ç„¶åœ¨â€œä¸‹é™â€ï¼Œä½†æ˜¯æˆ‘ä»¬å·²ç»åœ¨åœ°å€<code>0x0000000080089a84</code> ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä¸å¾—ä¸æ‰¿è®¤ï¼šå®é™…ä¸Šï¼Œæ¼”ç¤ºæ–‡ç¨¿å¹¶æ²¡æœ‰â€œå…¨åŠ›ä»¥èµ´â€ï¼Œè€Œæ˜¯éƒ¨åˆ†åœ°å†™åœ¨â€œä¹‹åâ€ï¼Œå› æ­¤åœ¨è¿™é‡Œï¼Œæˆ‘å·²ç»è®¾æ³•ä»SoCä¸­æ”¾å…¥æ­£ç¡®çš„dtbæ–‡ä»¶ï¼Œåœ¨<code>HiFive_U-Boot</code> <code>CONFIG_SYS_TEXT_BASE=0x80089800</code>è°ƒæ•´<code>CONFIG_SYS_TEXT_BASE=0x80089800</code>å˜é‡ã€‚ ï¼ˆè€Œä¸æ˜¯<code>0x08000000</code> ï¼‰ï¼Œä»¥ä¾¿ä¸‹è½½åœ°å€ä¸å®é™…åœ°å€åŒ¹é…ã€‚ ç«‹å³ä¸‹è½½ <del> ä¸‹ä¸€çº§åœ°å›¾ </del> å¦ä¸€å¼ å›¾ç‰‡ï¼š </p><br><pre> <code class="plaintext hljs">(gdb) file ../freedom-u-sdk/work/HiFive_U-Boot/u-boot (gdb) tui en</code> </pre> <br><p> æˆ‘ä»¬çœ‹åˆ°ï¼š </p><br><pre> <code class="plaintext hljs"> â”‚304 /* â”‚ â”‚305 * trap entry â”‚ â”‚306 */ â”‚ â”‚307 trap_entry: â”‚ â”‚308 addi sp, sp, -32*REGBYTES â”‚ &gt;â”‚309 SREG x1, 1*REGBYTES(sp) â”‚ â”‚310 SREG x2, 2*REGBYTES(sp) â”‚ â”‚311 SREG x3, 3*REGBYTES(sp) â”‚</code> </pre> <br><p> æˆ‘ä»¬åœ¨ç¬¬308è¡Œå’Œç¬¬309è¡Œä¹‹é—´è·³è½¬ã€‚è¿™å¹¶ä¸å¥‡æ€ªï¼Œå› ä¸º<code>$sp</code>åŒ…å«å€¼<code>0xfffffffe31cdc0a0</code> ã€‚  <code>trap_entry</code> ï¼Œç”±äº307è¡Œï¼Œå®ƒä¹Ÿä¼šä¸æ–­â€œæ¶ˆå¤±â€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†å°è¯•åœ¨<code>trap_entry</code>ä¸Šè®¾ç½®ä¸€ä¸ªæ–­ç‚¹ï¼Œç„¶åå†æ¬¡åˆ‡æ¢åˆ°<code>0x80089800</code> ï¼ˆU-Bootå…¥å£ç‚¹ï¼‰ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒåœ¨è¿‡æ¸¡ä¹‹å‰ä¸éœ€è¦æ­£ç¡®è®¾ç½®å¯„å­˜å™¨...ä¼¼ä¹æœ‰æ•ˆï¼š </p><br><pre> <code class="plaintext hljs">(gdb) b trap_entry Breakpoint 1 at 0x80089a80: file /hdd/trosinenko/fpga/freedom-u-sdk/HiFive_U-Boot/arch/riscv/cpu/HiFive/start.S, line 308. (gdb) set variable $pc=0x80089800 (gdb) c Continuing. Breakpoint 1, trap_entry () at /hdd/trosinenko/fpga/freedom-u-sdk/HiFive_U-Boot/arch/riscv/cpu/HiFive/start.S:308 (gdb) p/x $sp $4 = 0x81cf950</code> </pre> <br><p> ä¸€èˆ¬è€Œè¨€ï¼Œè®©æˆ‘ä»¬ç›´è¨€ä¸è®³åœ°è¯´å †æ ˆæŒ‡é’ˆï¼šå®ƒé€šå¸¸æŒ‡å‘RAMä¹‹å¤–ï¼ˆå½“ç„¶ï¼Œé™¤éæˆ‘ä»¬ä»ç„¶æœ‰åœ°å€è½¬æ¢ï¼Œä½†æˆ‘ä»¬å¸Œæœ›æœ‰ä¸€ä¸ªç®€å•çš„é€‰æ‹©ï¼‰ã€‚ </p><br><p> è®©æˆ‘ä»¬å°è¯•å°†æŒ‡é’ˆæ›¿æ¢ä¸º<code>0x881cf950</code> ã€‚ ç»“æœï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªäº‹å®ï¼Œå³è°ƒç”¨å¹¶è°ƒç”¨äº†<code>_exit_trap</code> ï¼Œè€Œåœ¨<code>_exit_trap</code>ä¸­<code>_exit_trap</code>äº†å‚æ•°<code>epc=2148315240</code> ï¼ˆåè¿›åˆ¶ï¼‰ï¼š </p><br><pre> <code class="plaintext hljs">(gdb) x/10i 2148315240 0x800cb068 &lt;strnlen+12&gt;: lbu a4,0(a5) 0x800cb06c &lt;strnlen+16&gt;: bnez a4,0x800cb078 &lt;strnlen+28&gt; 0x800cb070 &lt;strnlen+20&gt;: sub a0,a5,a0 0x800cb074 &lt;strnlen+24&gt;: ret 0x800cb078 &lt;strnlen+28&gt;: addi a5,a5,1 0x800cb07c &lt;strnlen+32&gt;: j 0x800cb064 &lt;strnlen+8&gt; 0x800cb080 &lt;strdup&gt;: addi sp,sp,-32 0x800cb084 &lt;strdup+4&gt;: sd s0,16(sp) 0x800cb088 &lt;strdup+8&gt;: sd ra,24(sp) 0x800cb08c &lt;strdup+12&gt;: li s0,0</code> </pre> <br><p> æˆ‘ä»¬åœ¨<code>strnlen</code>ä¸Šè®¾ç½®æ–­ç‚¹ï¼Œç»§ç»­æŸ¥çœ‹ï¼š </p><br><pre> <code class="plaintext hljs">(gdb) bt #0 strnlen (s=s@entry=0x10060000 "", count=18446744073709551615) at lib/string.c:283 #1 0x00000000800cc14c in string (buf=buf@entry=0x881cbd4c "", end=end@entry=0x881cc15c "", s=0x10060000 "", field_width=&lt;optimized out&gt;, precision=&lt;optimized out&gt;, flags=&lt;optimized out&gt;) at lib/vsprintf.c:265 #2 0x00000000800cc63c in vsnprintf_internal (buf=buf@entry=0x881cbd38 "exception code: 5 , ", size=size@entry=1060, fmt=0x800d446e "s , epc %08x , ra %08lx\n", fmt@entry=0x800d4458 "exception code: %d , %s , epc %08x , ra %08lx\n", args=0x881cc1a0, args@entry=0x881cc188) at lib/vsprintf.c:619 #3 0x00000000800cca54 in vsnprintf (buf=buf@entry=0x881cbd38 "exception code: 5 , ", size=size@entry=1060, fmt=fmt@entry=0x800d4458 "exception code: %d , %s , epc %08x , ra %08lx\n", args=args@entry=0x881cc188) at lib/vsprintf.c:710 #4 0x00000000800cca68 in vscnprintf (buf=buf@entry=0x881cbd38 "exception code: 5 , ", size=size@entry=1060, fmt=fmt@entry=0x800d4458 "exception code: %d , %s , epc %08x , ra %08lx\n", args=args@entry=0x881cc188) at lib/vsprintf.c:717 #5 0x00000000800ccb50 in printf (fmt=fmt@entry=0x800d4458 "exception code: %d , %s , epc %08x , ra %08lx\n") at lib/vsprintf.c:792 #6 0x000000008008a9f0 in _exit_trap (regs=&lt;optimized out&gt;, epc=2148315240, code=&lt;optimized out&gt;) at arch/riscv/lib/interrupts.c:92 #7 handle_trap (mcause=&lt;optimized out&gt;, epc=&lt;optimized out&gt;, regs=&lt;optimized out&gt;) at arch/riscv/lib/interrupts.c:55 #8 0x0000000080089b10 in trap_entry () at /hdd/trosinenko/fpga/freedom-u-sdk/HiFive_U-Boot/arch/riscv/cpu/HiFive/start.S:343 Backtrace stopped: frame did not save the PC</code> </pre> <br><p> ä¼¼ä¹<code>_exit_trap</code>å¸Œæœ›æä¾›æœ‰å…³å‘ç”Ÿçš„å¼‚å¸¸çš„è°ƒè¯•ä¿¡æ¯ï¼Œ <em>ä½†æ˜¯å®ƒå¤±è´¥</em> ã€‚ å› æ­¤ï¼Œå¸¦æœ‰æˆ‘ä»¬æºä»£ç çš„å†…å®¹ä¸ä¼šå†æ¬¡æ˜¾ç¤ºã€‚  <code>set directories ../freedom-u-sdk/HiFive_U-Boot/</code>å“¦ï¼ ç°åœ¨æ˜¾ç¤ºï¼ </p><br><p> å¥½å§ï¼Œå†æ¬¡è¿è¡Œå®ƒï¼Œå¹¶åœ¨å †æ ˆä¸ŠæŸ¥çœ‹å¯¼è‡´ç¬¬ä¸€ä¸ªé”™è¯¯çš„åŸå§‹é—®é¢˜çš„åŸå› ï¼ˆ <code>mcause == 5</code> ï¼‰ã€‚ å¦‚æœæˆ‘æ­£ç¡®ç†è§£ç¬¬37é¡µçš„å†…å®¹ï¼Œåˆ™æ­¤å¼‚å¸¸è¡¨ç¤º<code>Load access fault</code> ã€‚ æ˜¾ç„¶æ˜¯å› ä¸ºè¿™é‡Œ </p><br><p>  <strong>arch / riscv / cpu / HiFive / start.Sï¼š</strong> </p><br><pre> <code class="plaintext hljs">call_board_init_f: li t0, -16 li t1, CONFIG_SYS_INIT_SP_ADDR and sp, t1, t0 /* force 16 byte alignment */ #ifdef CONFIG_DEBUG_UART jal debug_uart_init #endif call_board_init_f_0: mv a0, sp jal board_init_f_alloc_reserve mv sp, a0 jal board_init_f_init_reserve mv a0, zero /* a0 &lt;-- boot_flags = 0 */ la t5, board_init_f jr t5 /* jump to board_init_f() */</code> </pre><br><p>  <code>$sp</code>å…·æœ‰ç›¸åŒçš„ä¸æ­£ç¡®å€¼ï¼Œå¹¶ä¸”<code>board_init_f_init_reserve</code>å†…éƒ¨å‘ç”Ÿé”™è¯¯ã€‚ ç½ªé­ç¥¸é¦–ï¼šä¸€ä¸ªæ˜¾å¼åç§°ä¸º<code>CONFIG_SYS_INIT_SP_ADDR</code>çš„å˜é‡ã€‚ å®ƒåœ¨æ–‡ä»¶<code>HiFive_U-Boot/include/configs/HiFive-U540.h</code> ã€‚ åœ¨æŸä¸ªæ—¶å€™ï¼Œæˆ‘ä»€è‡³è®¤ä¸ºï¼Œæˆ–è€…ä¹Ÿè®¸å¾ˆå¥½ï¼Œå®Œæˆäº†å¤„ç†å™¨çš„å¼•å¯¼ç¨‹åº-ä¹Ÿè®¸ç¨å¾®ä¿®å¤ä¸€ä¸‹å¤„ç†å™¨ä¼šæ›´å®¹æ˜“ï¼Ÿ ä½†æ˜¯åæ¥æˆ‘çœ‹åˆ°ï¼Œå®ƒæ›´åƒæ˜¯æ¥è‡ªå¦ä¸€ä¸ªå†…å­˜é…ç½®ä¸å®Œå…¨çš„<code>#if 0</code>è®¾ç½®ä¸­çš„å·¥ä»¶ï¼Œæ‚¨å¯ä»¥å°è¯•æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š </p><br><pre> <code class="diff hljs">diff --git a/include/configs/HiFive-U540.hb/include/configs/HiFive-U540.h index ca89383..245542c 100644 --- a/include/configs/HiFive-U540.h +++ b/include/configs/HiFive-U540.h @@ -65,12 +65,9 @@ #define CONFIG_SYS_SDRAM_BASE PHYS_SDRAM_0 #endif #if 1 -/*#define CONFIG_NR_DRAM_BANKS 1*/ +#define CONFIG_NR_DRAM_BANKS 1 #define PHYS_SDRAM_0 0x80000000 /* SDRAM Bank #1 */ -#define PHYS_SDRAM_1 \ - (PHYS_SDRAM_0 + PHYS_SDRAM_0_SIZE) /* SDRAM Bank #2 */ -#define PHYS_SDRAM_0_SIZE 0x80000000 /* 2 GB */ -#define PHYS_SDRAM_1_SIZE 0x10000000 /* 256 MB */ +#define PHYS_SDRAM_0_SIZE 0x40000000 /* 1 GB */ #define CONFIG_SYS_SDRAM_BASE PHYS_SDRAM_0 #endif /* @@ -81,7 +78,7 @@ #define CONSOLE_ARG "console=ttyS0,115200\0" /* Init Stack Pointer */ -#define CONFIG_SYS_INIT_SP_ADDR (0x08000000 + 0x001D0000 - \ +#define CONFIG_SYS_INIT_SP_ADDR (0x80000000 + 0x001D0000 - \ GENERATED_GBL_DATA_SIZE) #define CONFIG_SYS_LOAD_ADDR 0xa0000000 /* partway up SDRAM */</code> </pre> <br><p> åœ¨æŸä¸ªæ—¶å€™ï¼Œæ•°é‡ <del> æ‹æ– </del>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æŠ€æœ¯ç´§å›ºä»¶</a>è¾¾åˆ°äº†ä¸´ç•Œç‚¹ã€‚ ç»è¿‡ä¸€ç•ªæŠ˜ç£¨ä¹‹åï¼Œæˆ‘å¼€å§‹éœ€è¦åœ¨æ¿ä¸Šæ”¾ç½®æ­£ç¡®çš„ç«¯å£ã€‚ ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦ä¸ºæˆ‘ä»¬çš„é…ç½®å¤åˆ¶å¹¶æ›´æ­£ä¸€å®šæ•°é‡çš„æ–‡ä»¶ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">å¥½å§ï¼Œå¤§æ¦‚è¿™æ˜¯ä¸€å¼ å°æ¡Œå­</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">trosinenko@trosinenko-pc:/hdd/trosinenko/fpga/freedom-u-sdk/HiFive_U-Boot$ git show --name-status commit 39cd67d59c16ac87b46b51ac1fb58f16f1eb1048 (HEAD -&gt; zeowaa-1gb) Author: Anatoly Trosinenko &lt;anatoly.trosinenko@gmail.com&gt; Date: Tue Jul 2 17:13:16 2019 +0300 Initial support for Zeowaa A-E115FB board M arch/riscv/Kconfig A arch/riscv/cpu/zeowaa-1gb/Makefile A arch/riscv/cpu/zeowaa-1gb/cpu.c A arch/riscv/cpu/zeowaa-1gb/start.S A arch/riscv/cpu/zeowaa-1gb/timer.c A arch/riscv/cpu/zeowaa-1gb/u-boot.lds M arch/riscv/dts/Makefile A arch/riscv/dts/zeowaa-1gb.dts A board/Zeowaa/zeowaa-1gb/Kconfig A board/Zeowaa/zeowaa-1gb/MAINTAINERS A board/Zeowaa/zeowaa-1gb/Makefile A board/Zeowaa/zeowaa-1gb/Zeowaa-A-E115FB.c A configs/zeowaa-1gb_defconfig A include/configs/zeowaa-1gb.h</code> </pre> <br><p> è¯¦ç»†ä¿¡æ¯å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å­˜å‚¨åº“ä¸­</a>æ‰¾åˆ°ã€‚ </p></div></div><br><p> äº‹å®è¯æ˜ï¼Œåœ¨æ­¤SiFiveæ¿ä¸Šï¼ŒæŸäº›è®¾å¤‡çš„å¯„å­˜å™¨å…·æœ‰ä¸åŒçš„åœ°å€ã€‚ äº‹å®è¯æ˜ï¼ŒU-Bootæ˜¯ç”±Linuxå†…æ ¸å·²ç»ç†Ÿæ‚‰çš„Kconfigæœºåˆ¶é…ç½®çš„ï¼Œä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å‘½ä»¤<code>make menuconfig</code> ï¼Œæ‚¨å°†çœ‹åˆ°ä¸€ä¸ªæ–¹ä¾¿çš„æ–‡æœ¬ç•Œé¢ï¼Œå¸¦æœ‰å‚æ•°è¯´æ˜ï¼Œå¦‚<code>?</code>æ‰€ç¤º<code>?</code> ç­‰ é€šå¸¸ï¼Œä»ä¸¤å—æ¿çš„æè¿°ä¸­çœ‹ä¸åˆ°ç¬¬ä¸‰å—çš„æè¿°ï¼Œç„¶åä»é‚£é‡Œæ‰”æ‰ä»»ä½•å¯æ€œçš„PLLé‡æ–°é…ç½®ï¼ˆæ˜¾ç„¶ï¼Œè¿™ä¸ä¸»æœºçš„PCIeæ§åˆ¶æœ‰å…³ï¼Œä½†è¿™ä¸å‡†ç¡®ï¼‰ï¼Œæˆ‘å¾—åˆ°äº†ä¸€äº›å›ºä»¶ï¼Œå¦‚æœåœ¨ç«æ˜Ÿä¸Šå¤©æ°”åˆé€‚çš„è¯å®ƒç»™äº†æˆ‘ä¸€æ¡UARTæ¶ˆæ¯ï¼Œå…³äºè¯¥æ¶ˆæ¯æ˜¯ä»å“ªä¸ªæäº¤å“ˆå¸Œä¸­æ”¶é›†çš„ï¼Œä»¥åŠæˆ‘æœ‰å¤šå°‘DRAMï¼ˆä½†æˆ‘ä¹Ÿå°†æ­¤ä¿¡æ¯æ³¨å†Œåœ¨äº†æ ‡å¤´ä¸­ï¼‰ã€‚ </p><br><p> é—æ†¾çš„æ˜¯ï¼Œæ­¤åä¸»æ¿é€šå¸¸åœæ­¢å¯¹å¤„ç†å™¨JTAGçš„å“åº”ï¼Œè€Œä»SDå¡ä¸‹è½½çš„é€Ÿåº¦åœ¨æˆ‘çš„é…ç½®ä¸­å¹¶ä¸å¿«ã€‚ å¦ä¸€æ–¹é¢ï¼Œæœ‰æ—¶BootROMä¼šæ˜¾ç¤ºä¸€æ¡<code>ERROR</code>æ¶ˆæ¯ï¼šæ— æ³•å¯åŠ¨<code>ERROR</code> ï¼Œå¹¶ä¸”U-Bootç«‹å³å¼¹å‡ºã€‚ é‚£æ˜¯æˆ‘çš„æ›™å…‰ï¼šæ˜¾ç„¶ï¼Œé‡æ–°å¯åŠ¨æ¯”ç‰¹æµåï¼ŒFPGAä¸­çš„å†…å­˜æ²¡æœ‰ç£¨æŸï¼Œæ²¡æœ‰æ—¶é—´â€œè¢«æ’•æ¯â€ï¼Œç­‰ç­‰ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œæ‚¨å¯ä»¥ç®€å•åœ°åœ¨å‡ºç°<code>LOADING /</code>æ¶ˆæ¯æ—¶ï¼Œè¿æ¥è°ƒè¯•å™¨å’Œå‘½ä»¤<code>set variable $pc=0x80089800</code> ï¼Œä»è€Œç»•è¿‡è¿™ç§æ¼«é•¿çš„ä¸‹è½½è¿‡ç¨‹ï¼ˆå½“ç„¶ï¼Œå‡è®¾ä¸Šæ¬¡ä¸­æ–­å¾ˆæ—©ï¼Œå¹¶ä¸”æ²¡æœ‰æ—¶é—´åœ¨åŸå§‹ä»£ç ä¸Šä¸‹è½½ï¼‰ã€‚ </p><br><p> é¡ºä¾¿è¯´ä¸€å¥ï¼Œé€šå¸¸æƒ…å†µæ˜¯å¤„ç†å™¨å®Œå…¨æŒ‚èµ·ï¼Œå¹¶ä¸”å¸¦æœ‰æ¶ˆæ¯çš„JTAGè°ƒè¯•å™¨æ— æ³•è¿æ¥åˆ°å®ƒï¼Œè¿™æ˜¯æ­£å¸¸çš„ã€‚ </p><br><pre> <code class="plaintext hljs">Error: unable to halt hart 0 Error: dmcontrol=0x80000001 Error: dmstatus =0x00030c82</code> </pre> <br><p> æ‰€ä»¥ç­‰ç­‰ï¼ æˆ‘å·²ç»çœ‹åˆ°äº†ï¼ -     TileLink,      -   â€”   â€¦ ,           : </p><br><pre> <code class="plaintext hljs">INIT CMD0 CMD8 ACMD41 CMD58 CMD16 CMD18 LOADING BOOT U-Boot 2018.09-g39cd67d-dirty (Jul 03 2019 - 13:50:33 +0300) DRAM: 1 GiB MMC: BEFORE LOAD ENVBEFORE FDTCONTROLADDRBEFORE LOADADDRIn: serial Out: serial Err: serial Hit any key to stop autoboot: 3</code> </pre> <br><p>      <code>In: serial</code>    â€”       ,      environment.  , Â«    Â»?          !  :  U-Boot      2^24   SD-, ,    <del>   </del>  ,      ,        ,   ELF-,    .  : ,       ,     . </p><br><p> ,    ? ,    -  ... </p><br><pre> <code class="plaintext hljs">(gdb) x/x 0x0200bff8 0x200bff8: 0x00000000</code> </pre> <br><p>  ,    ? </p><br><pre> <code class="plaintext hljs">(gdb) set variable *0x0200bff8=310000000 (gdb) c</code> </pre> <br><p> : </p><br><pre> <code class="plaintext hljs">Hit any key to stop autoboot: 0 MMC_SPI: 0 at 0:1 hz 20000000 mode 0</code> </pre> <br><p> :   . , -        : </p><br><p> <strong>HiFive_U-Boot/cmd/bootmenu.c:</strong> </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bootmenu_loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(struct bootmenu_data *menu, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">enum</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bootmenu_key *key, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *esc)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!tstc()) { WATCHDOG_RESET(); mdelay(<span class="hljs-number"><span class="hljs-number">10</span></span>); } c = getc(); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (*esc) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-comment"><span class="hljs-comment">/* First char of ANSI escape sequence '\e' */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c == <span class="hljs-string"><span class="hljs-string">'\e'</span></span>) { *esc = <span class="hljs-number"><span class="hljs-number">1</span></span>; *key = KEY_NONE; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-comment"><span class="hljs-comment">/* Second char of ANSI '[' */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c == <span class="hljs-string"><span class="hljs-string">'['</span></span>) { ...</code> </pre> <br><p>  <abbr title="å®é™…ä¸Šä¸æ˜¯ï¼Œè‡³å°‘ä¸ä»…å¦‚æ­¤ï¼Œè¿›ä¸€æ­¥">  </abbr> ,    :      : </p><br><pre> <code class="scala hljs"> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-type"><span class="hljs-type">DTSTimebase</span></span> =&gt; <span class="hljs-type"><span class="hljs-type">BigInt</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br><p> â€¦   ,      Â«   â€”  0Â».   <code>WithNBigCores</code>      1MHz (, ,      U-Boot).   , ,   :    ,  25MHz!     .   Â«Â» ... </p><br><pre> <code class="plaintext hljs">Hit any key to stop autoboot: 0 MMC_SPI: 0 at 0:1 hz 20000000 mode 0 ## Unknown partition table type 0 libfdt fdt_path_offset() returned FDT_ERR_NOTFOUND ** No partition table - mmc 0 ** ## Info: input data size = 34 = 0x22 Running uEnv.txt boot2... ## Error: "boot2" not defined HiFive-Unleashed #</code> </pre> <br><p>    ! ,  , , ,   <code>mmc_spi 1 10000000 0; mmc part</code> ,   SPI  20MHz  10MHz. æ€ä¹ˆäº† ,       20MHz,      . ,   , ,    ,  :      (  â€”  25MHz)  ,           .   ,    115200Hz UART-   ,  ,     25000000  20000000  1, ..     25MHz. ,   ,    , ,  -  (   )â€¦  ,      â€”  , , . 25MHz â€”    Core i9. </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="plaintext hljs">HiFive-Unleashed # env edit mmcsetup edit: mmc_spi 1 10000000 0; mmc part HiFive-Unleashed # boot MMC_SPI: 1 at 0:1 hz 10000000 mode 0 Partition Map for MMC device 0 -- Partition Type: EFI Part Start LBA End LBA Name Attributes Type GUID Partition GUID 1 0x00000800 0x0000ffde "Vfat Boot" attrs: 0x0000000000000000 type: ebd0a0a2-b9e5-4433-87c0-68b6b72699c7 type: data guid: 76bd71fd-1694-4ff3-8197-bfa81699c2fb 2 0x00040800 0x002efaf4 "root" attrs: 0x0000000000000000 type: 0fc63daf-8483-4772-8e79-3d69d8477de4 type: linux guid: 9f3adcc5-440c-4772-b7b7-283124f38bf3 3 0x0000044c 0x000007e4 "uboot" attrs: 0x0000000000000000 type: 5b193300-fc78-40cd-8002-e86c45580b47 guid: bb349257-0694-4e0f-9932-c801b4d76fa3 4 0x00000400 0x0000044b "uboot-env" attrs: 0x0000000000000000 type: a09354ac-cd63-11e8-9aff-70b3d592f0fa guid: 4db442d0-2109-435f-b858-be69629e7dbf libfdt fdt_path_offset() returned FDT_ERR_NOTFOUND 2376 bytes read in 0 ms Running uEnv.txt boot2... 15332118 bytes read in 0 ms ## Loading kernel from FIT Image at 90000000 ... Using 'config-1' configuration Trying 'bbl' kernel subimage Description: BBL/SBI/riscv-pk Type: Kernel Image Compression: uncompressed Data Start: 0x900000d4 Data Size: 74266 Bytes = 72.5 KiB Architecture: RISC-V OS: Linux Load Address: 0x80000000 Entry Point: 0x80000000 Hash algo: sha256 Hash value: 28972571467c4ad0cf08a81d9cf92b9dffc5a7cb2e0cd12fdbb3216cf1f19cbd Verifying Hash Integrity ... sha256+ OK ## Loading fdt from FIT Image at 90000000 ... Using 'config-1' configuration Trying 'fdt' fdt subimage Description: unavailable Type: Flat Device Tree Compression: uncompressed Data Start: 0x90e9d31c Data Size: 6911 Bytes = 6.7 KiB Architecture: RISC-V Load Address: 0x81f00000 Hash algo: sha256 Hash value: 10b0244a5a9205357772ea1c4e135a4f882409262176d8c7191238cff65bb3a8 Verifying Hash Integrity ... sha256+ OK Loading fdt from 0x90e9d31c to 0x81f00000 Booting using the fdt blob at 0x81f00000 ## Loading loadables from FIT Image at 90000000 ... Trying 'kernel' loadables subimage Description: Linux kernel Type: Kernel Image Compression: uncompressed Data Start: 0x900123e8 Data Size: 10781356 Bytes = 10.3 MiB Architecture: RISC-V OS: Linux Load Address: 0x80200000 Entry Point: unavailable Hash algo: sha256 Hash value: 72a9847164f4efb2ac9bae736f86efe7e3772ab1f01ae275e427e2a5389c84f0 Verifying Hash Integrity ... sha256+ OK Loading loadables from 0x900123e8 to 0x80200000 ## Loading loadables from FIT Image at 90000000 ... Trying 'ramdisk' loadables subimage Description: buildroot initramfs Type: RAMDisk Image Compression: gzip compressed Data Start: 0x90a5a780 Data Size: 4467411 Bytes = 4.3 MiB Architecture: RISC-V OS: Linux Load Address: 0x82000000 Entry Point: unavailable Hash algo: sha256 Hash value: 883dfd33ca047e3ac10d5667ffdef7b8005cac58b95055c2c2beda44bec49bd0 Verifying Hash Integrity ... sha256+ OK Loading loadables from 0x90a5a780 to 0x82000000</code> </pre> </div></div><br><p> ,     ,     .      .  mcause ,      <code>$pc</code>   <code>si</code>   <code>trap_entry</code> .    U-Boot     mcause = 0..4,      .     ,  ,    ,  :    <code>conf/rvboot-fit.txt</code> : </p><br><pre> <code class="plaintext hljs">fitfile=image.fit # below much match what's in FIT (ugha)</code> </pre> <br><p>  ,     ,      ,   ,  <code>SIF0</code> â€”  <abbr title="å…¶å®ä¸è¡Œï¼Œå› ä¸ºåæ¥è¯æ˜"> -  PCIe</abbr> : </p><br><pre> <code class="diff hljs"><span class="hljs-deletion"><span class="hljs-deletion">-bootargs=console=ttySIF0,921600 debug +bootargs=console=ttyS0,125200 debug</span></span></code> </pre> <br><p>        SHA-256  MD5:     ( ,  ),    ,         MD5 â€”  . ç»“æœå¦‚ä½•ï¼Ÿ        (    ),   : </p><br><pre> <code class="plaintext hljs">... Verifying Hash Integrity ... md5+ OK Loading loadables from 0x90a5a758 to 0x82000000 libfdt fdt_check_header(): FDT_ERR_BADMAGIC chosen { linux,initrd-end = &lt;0x00000000 0x83000000&gt;; linux,initrd-start = &lt;0x00000000 0x82000000&gt;; riscv,kernel-end = &lt;0x00000000 0x80a00000&gt;; riscv,kernel-start = &lt;0x00000000 0x80200000&gt;; bootargs = "debug console=tty0 console=ttyS0,125200 root=/dev/mmcblk0p2 rootwait"; }; libfdt fdt_path_offset() returned FDT_ERR_NOTFOUND chosen { linux,initrd-end = &lt;0x00000000 0x83000000&gt;; linux,initrd-start = &lt;0x00000000 0x82000000&gt;; riscv,kernel-end = &lt;0x00000000 0x80a00000&gt;; riscv,kernel-start = &lt;0x00000000 0x80200000&gt;; bootargs = "debug console=tty0 console=ttyS0,125200 root=/dev/mmcblk0p2 rootwait"; }; Loading Kernel Image ... OK Booting kernel in 3</code> </pre> <br><p>     ... </p><br><pre> <code class="plaintext hljs">(gdb) x/x 0x0200bff8 0x200bff8: 0x00000000</code> </pre> <br><p> , ,     ,     ,  . , ,  ,         ,  : </p><br><pre> <code class="plaintext hljs">0x00000000bff6dbb0 in ?? () (gdb) set variable *0x0200bff8=1000000 (gdb) c Continuing. ^C Program received signal SIGINT, Interrupt. 0x00000000bff6dbb0 in ?? () (gdb) set variable *0x0200bff8=2000000 (gdb) c Continuing. ^C Program received signal SIGINT, Interrupt. 0x00000000bff6dbb0 in ?? () (gdb) set variable *0x0200bff8=3000000 (gdb) c Continuing.</code> </pre> <br><p>  ... </p><br><pre> <code class="plaintext hljs"> Loading Kernel Image ... OK Booting kernel in 3 2 1 0 ## Starting application at 0x80000000 ...</code> </pre> <br><p>  ,     â€”  , ,     ! </p><br><p>        -  </p><br><pre> <code class="plaintext hljs">0000000080001c20 &lt;poweroff&gt;: 80001c20: 1141 addi sp,sp,-16 80001c22: e022 sd s0,0(sp) 80001c24: 842a mv s0,a0 80001c26: 00005517 auipc a0,0x5 80001c2a: 0ca50513 addi a0,a0,202 # 80006cf0 &lt;softfloat_countLeadingZeros8+0x558&gt; 80001c2e: e406 sd ra,8(sp) 80001c30: f7fff0ef jal ra,80001bae &lt;printm&gt; 80001c34: 8522 mv a0,s0 80001c36: 267000ef jal ra,8000269c &lt;finisher_exit&gt; 80001c3a: 00010797 auipc a5,0x10 80001c3e: 41e78793 addi a5,a5,1054 # 80012058 &lt;htif&gt; 80001c42: 639c ld a5,0(a5) 80001c44: c399 beqz a5,80001c4a &lt;poweroff+0x2a&gt; 80001c46: 72c000ef jal ra,80002372 &lt;htif_poweroff&gt; 80001c4a: 45a1 li a1,8 80001c4c: 4501 li a0,0 80001c4e: dc7ff0ef jal ra,80001a14 &lt;send_ipi_many&gt; 80001c52: 10500073 wfi 80001c56: bff5 j 80001c52 &lt;poweroff+0x32&gt;</code> </pre> <br><p>   Berkeley Boot Loader.       <code>htif</code> â€” host interface,   tethered-  (      ARM), -  standalone. ,      ,  ,     : </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">poweroff</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> code)</span></span></span><span class="hljs-function"> </span></span>{ printm(<span class="hljs-string"><span class="hljs-string">"Power off\r\n"</span></span>); finisher_exit(code); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (htif) { htif_poweroff(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { send_ipi_many(<span class="hljs-number"><span class="hljs-number">0</span></span>, IPI_HALT); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">asm</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">volatile</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"wfi\n"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; } } }</code> </pre> <br><h2 id="kvest-zapusti-chasy"> :   </h2><br><p>    CLINT    </p><br><pre> <code class="scala hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> io = <span class="hljs-type"><span class="hljs-type">IO</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Bundle</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> rtcTick = <span class="hljs-type"><span class="hljs-type">Bool</span></span>(<span class="hljs-type"><span class="hljs-type">INPUT</span></span>) }) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> time = <span class="hljs-type"><span class="hljs-type">RegInit</span></span>(<span class="hljs-type"><span class="hljs-type">UInt</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, width = timeWidth)) when (io.rtcTick) { time := time + <span class="hljs-type"><span class="hljs-type">UInt</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) }</code> </pre> <br><p>    RTC,    MockAON,     : Â«,     ? ? !Â»      ,       ,       <code>System.scala</code> : </p><br><pre> <code class="scala hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> rtcDivider = <span class="hljs-type"><span class="hljs-type">RegInit</span></span>(<span class="hljs-number"><span class="hljs-number">0.</span></span>asUInt(<span class="hljs-number"><span class="hljs-number">16.</span></span><span class="hljs-type"><span class="hljs-type">W</span></span>)) <span class="hljs-comment"><span class="hljs-comment">//      16,   :) val mhzInt = p(DevKitFPGAFrequencyKey).toInt // ,      rtcDivider := Mux(rtcDivider === (mhzInt - 1).U, 0.U, rtcDivider + 1.U) outer.clintOpt.foreach { clint =&gt; clint.module.io.rtcTick := rtcDivider === 0.U }</span></span></code> </pre> <br><h2 id="probirayas-k-linux-kernel">   Linux kernel </h2><br><p>           ,    : </p><br><p> BBL   FDT   <code>0xF0000000</code> ,     !   ,  â€¦   <strong>HiFive_U-Boot/arch/riscv/lib/boot.c</strong> ,   <code>0x81F00000</code> ,     U-Boot. </p><br><p>  BBL ,   .      <code>mem_prop</code> ,   <strong>riscv-pk/machine/fdt.c</strong> :   ,     fdt ram  <code>device_type = "memory"</code> â€” , ,     ,      â€”       . </p><br><p>     (   ,   ): </p><br><pre> <code class="plaintext hljs">This is bbl's dummy_payload. To boot a real kernel, reconfigure bbl with the flag --with-payload=PATH, then rebuild bbl. Alternatively, bbl can be used in firmware-only mode by adding device-tree nodes for an external payload and use QEMU's -bios and -kernel options.</code> </pre> <br><p> ,      <code>riscv,kernel-start</code>  <code>riscv,kernel-end</code>  DTB,   .  <code>query_chosen</code> ,  BBL   32- ,     <code>&lt;0x0 0xADDR&gt;</code> ,   , ,  .    <code>chosen</code> </p><br><pre> <code class="plaintext hljs">chosen { #address-cells = &lt;1&gt;; #size-cells = &lt;0&gt;; ... }</code> </pre> <br><p>    : <abbr title="ä½†æ˜¯æœ‰æ›´å¥½çš„è§£å†³æ–¹æ¡ˆ">  <code>0x0</code>  </abbr> . </p><br><p>  100500       ,   : </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> Verifying Hash Integrity ... md5+ OK Loading loadables from 0x90a5a758 to 0x82000000 libfdt fdt_check_header(): FDT_ERR_BADMAGIC chosen { linux,initrd-end = &lt;0x83000000&gt;; linux,initrd-start = &lt;0x82000000&gt;; riscv,kernel-end = &lt;0x80a00000&gt;; riscv,kernel-start = &lt;0x80200000&gt;; #address-cells = &lt;0x00000001&gt;; #size-cells = &lt;0x00000000&gt;; bootargs = "debug console=tty0 console=ttyS0,125200 root=/dev/mmcblk0p2 rootwait"; stdout-path = "uart0:38400n8"; }; libfdt fdt_path_offset() returned FDT_ERR_NOTFOUND chosen { linux,initrd-end = &lt;0x83000000&gt;; linux,initrd-start = &lt;0x82000000&gt;; riscv,kernel-end = &lt;0x80a00000&gt;; riscv,kernel-start = &lt;0x80200000&gt;; #address-cells = &lt;0x00000001&gt;; #size-cells = &lt;0x00000000&gt;; bootargs = "debug console=tty0 console=ttyS0,125200 root=/dev/mmcblk0p2 rootwait"; stdout-path = "uart0:38400n8"; }; Loading Kernel Image ... OK Booting kernel in 3 2 1 0 ## Starting application at 0x80000000 ... bbl loader SIFIVE, INC. 5555555555555555555555555 5555 5555 5555 5555 5555 5555 5555 5555555555555555555555 5555 555555555555555555555555 5555 5555 5555 5555 5555 5555 5555555555555555555555555555 55555 55555 555555555 55555 55555 55555 55555 55555 5 55555 55555 55555 55555 55555 55555 55555 55555 55555 55555 55555 555555555 55555 5 SiFive RISC-V Core IP [ 0.000000] OF: fdt: Ignoring memory range 0x80000000 - 0x80200000 [ 0.000000] Linux version 4.19.0-sifive-1+ (trosinenko@trosinenko-pc) (gcc version 8.3.0 (Buildroot 2019.02-07449-g4eddd28f99)) #1 SMP Wed Jul 3 21:29:21 MSK 2019 [ 0.000000] bootconsole [early0] enabled [ 0.000000] Initial ramdisk at: 0x(____ptrval____) (16777216 bytes) [ 0.000000] Zone ranges: [ 0.000000] DMA32 [mem 0x0000000080200000-0x00000000bfffffff] [ 0.000000] Normal [mem 0x00000000c0000000-0x00000bffffffffff] [ 0.000000] Movable zone start for each node [ 0.000000] Early memory node ranges [ 0.000000] node 0: [mem 0x0000000080200000-0x00000000bfffffff] [ 0.000000] Initmem setup node 0 [mem 0x0000000080200000-0x00000000bfffffff] [ 0.000000] On node 0 totalpages: 261632 [ 0.000000] DMA32 zone: 3577 pages used for memmap [ 0.000000] DMA32 zone: 0 pages reserved [ 0.000000] DMA32 zone: 261632 pages, LIFO batch:63 [ 0.000000] software IO TLB: mapped [mem 0xbb1fc000-0xbf1fc000] (64MB)</code> </pre> </div></div><br><p> (  BBL,       â€” ). </p><br><p>  ,  ,  ,   RocketChip     JTAG   trap-   â€”      . </p><br><pre> <code class="plaintext hljs">Program received signal SIGTRAP, Trace/breakpoint trap. 0xffffffe0000024ca in ?? () (gdb) bt #0 0xffffffe0000024ca in ?? () Backtrace stopped: previous frame identical to this frame (corrupt stack?) (gdb) file work/linux/vmlinux A program is being debugged already. Are you sure you want to change the file? (y or n) y Reading symbols from work/linux/vmlinux...done. (gdb) bt #0 0xffffffe0000024ca in setup_smp () at /hdd/trosinenko/fpga/freedom-u-sdk/linux/arch/riscv/kernel/smpboot.c:75 #1 0x0000000000000000 in ?? () Backtrace stopped: frame did not save the PC</code> </pre> <br><p> <strong>freedom-u-sdk/linux/arch/riscv/kernel/smpboot.c:</strong> </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> __<span class="hljs-function"><span class="hljs-function">init </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup_smp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">device_node</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dn</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NULL</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> hart; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> found_boot_cpu = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> cpuid = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ((dn = of_find_node_by_type(dn, <span class="hljs-string"><span class="hljs-string">"cpu"</span></span>))) { hart = riscv_of_processor_hartid(dn); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hart &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hart == cpuid_to_hartid_map(<span class="hljs-number"><span class="hljs-number">0</span></span>)) { BUG_ON(found_boot_cpu); found_boot_cpu = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } cpuid_to_hartid_map(cpuid) = hart; set_cpu_possible(cpuid, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); set_cpu_present(cpuid, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); cpuid++; } BUG_ON(!found_boot_cpu); <span class="hljs-comment"><span class="hljs-comment">// &lt;    }</span></span></code> </pre> <br><p>     , <em>CPU not found, running software emulation</em> .    running.     . </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/* The lucky hart to first increment this variable will boot the other cores */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">atomic_t</span></span> hart_lottery; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> boot_cpu_hartid;</code> </pre> <br><p>    <strong>linux/arch/riscv/kernel/setup.c</strong> â€”       .  ,   -  ,     ... </p><br><p>         . </p><br><p>  .       ,   ,      singlestep-. </p><br><p>    ( ): <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://asciinema.org/a/h22F5eCMXYF9n7n89CY6NJNEi.svg" alt="èˆªå¤©å‘˜"></a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN458482/">https://habr.com/ru/post/zh-CN458482/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN458464/index.html">æ¿€å…‰è°ƒåˆ¶è§£è°ƒå™¨ä¸Šçš„3 kmåƒå…†é“¾è·¯</a></li>
<li><a href="../zh-CN458468/index.html">å¦‚ä½•ä¸¾åŠä»¤äººå°è±¡æ·±åˆ»çš„çœ‹æ¿ç«™ç«‹ä¼šè®®ï¼Ÿ</a></li>
<li><a href="../zh-CN458470/index.html">çº¹ç†ï¼Œæˆ–æˆä¸ºSurface Artistæ‰€éœ€è¦äº†è§£çš„çŸ¥è¯†ã€‚ ç¬¬2éƒ¨åˆ†ã€‚è’™ç‰ˆå’Œçº¹ç†</a></li>
<li><a href="../zh-CN458472/index.html">ä½¿ç”¨å…¬å¼€æ•°æ®é€šè¿‡çƒ­åŠ¿æ–¹æ³•ç¼–åˆ¶é¢†åœŸç­‰çº§</a></li>
<li><a href="../zh-CN458474/index.html">HighLoad ++ 2018çš„æœ€ä½³æŠ¥å‘Š</a></li>
<li><a href="../zh-CN458486/index.html">åœ¨Alan Wakeæ¸¸æˆä¸­ä½¿ç”¨å¸ƒæ–™çš„ç§˜å¯†</a></li>
<li><a href="../zh-CN458488/index.html">æ•°æ®ç§‘å­¦æ–‡æ‘˜ï¼ˆ2019å¹´7æœˆï¼‰</a></li>
<li><a href="../zh-CN458490/index.html">ç´§ç´§æŠ“ä½æ–¹å‘ç›˜...æˆ‘ä»¬çš„é¡¹ç›®å¯ä»¥ç›‘æ§é©¾é©¶å‘˜çš„çŠ¶å†µ</a></li>
<li><a href="../zh-CN458492/index.html">â€œæˆ‘ä»¬å§‹ç»ˆç›¸ä¿¡ç«äº‰å’Œé€‰æ‹©ç”¨æˆ·çš„æƒåˆ©â€Â©Yandex</a></li>
<li><a href="../zh-CN458494/index.html">ä½¿ç”¨Vueæ¸²æŸ“åŠŸèƒ½çš„å®é™…ç¤ºä¾‹ï¼šä¸ºè®¾è®¡ç³»ç»Ÿåˆ›å»ºå°åˆ·ç½‘æ ¼</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>