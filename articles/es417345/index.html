<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçÅ ü¶ê ü§∏üèø B√∫squeda de amenazas con visibilidad de Cisco üë©üèª‚Äç‚öñÔ∏è ü•É ‚õ¥Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Imagina que lees un art√≠culo en Kommersant que un paquete completo para ataques contra bancos Pegasus se puso a disposici√≥n del p√∫blico en Internet. P...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>B√∫squeda de amenazas con visibilidad de Cisco</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/cisco/blog/417345/"> Imagina que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">lees</a> un art√≠culo en Kommersant que un paquete completo para ataques contra bancos Pegasus se puso a disposici√≥n del p√∫blico en Internet.  Probablemente querr√° saber si tambi√©n qued√≥ atrapado en la distribuci√≥n y si hay c√≥digo malicioso en su red.  Por un lado, tiene un mont√≥n de registros y eventos de seguridad de diversos medios de protecci√≥n, y por otro, puede recibir informaci√≥n sobre amenazas como parte de una suscripci√≥n a cualquier servicio de Inteligencia de Amenazas gratuito o de pago (por ejemplo, de BI.ZONE, Servicio de Seguridad del Estado o FinCERT).  Por un lado, tiene muchos datos para analizar, pero no sabe si tienen rastros de lo que est√° buscando.  Por otro lado, tiene informaci√≥n sobre los rastros (es decir, indicadores de compromiso), pero no sabe qu√© tan aplicables son para usted.  Debe combinar estos dos conjuntos de datos implementando lo que com√∫nmente se llama B√∫squeda de amenazas o encontrar rastros de ataques en su infraestructura.  Veamos c√≥mo puede automatizar esta tarea con la soluci√≥n gratuita Cisco Visibility, recientemente lanzada. <br><br><img src="https://habrastorage.org/webt/ri/tn/jd/ritnjduwd50csjcb8tqkx-gxzqk.png" alt="imagen"><a name="habracut"></a><br><br>  ¬øNo sabes por d√≥nde empezar?  ¬øD√≥nde buscar rastros de una amenaza que le interese?  Aqu√≠ hay una hoja en blanco y en Cisco Visibility se ve as√≠: <br><br><img src="https://habrastorage.org/webt/hz/ql/ie/hzqlieayft079i9gry1wg5jmjzw.png" alt="imagen"><br><br>  En esta ventana, carga todo lo que buscar√°.  Tomemos a TeslaCrypt como ejemplo (en la vida real, en lugar de TeslaCrypt, sustituir√° cualquier otra amenaza que necesite para encontrar rastros o demostrar su ausencia durante la Caza de amenazas).  Primero, necesita reunir todos los indicadores de compromiso para los que utiliza los servicios de inteligencia de amenazas existentes.  Por ejemplo, obtiene datos de TeslaCrypt del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">blog de Cisco Talos</a> .  Tienes 9 indicadores frente a ti: direcciones IP, hash de archivos de malware y dominios que el encriptador implementado contacta para recibir comandos adicionales y pagar el rescate en criptomoneda.  Cargue todos estos indicadores en Cisco Visibility: <br><br><img src="https://habrastorage.org/webt/sq/vr/v1/sqvrv1qyfiqbw6jiwvlamctaxlg.png" alt="imagen"><br><br>  Aqu√≠ necesitas hacer una peque√±a digresi√≥n.  Cisco Visibility ahora funciona con datos de Cisco AMP para Endpoints, es decir, con una soluci√≥n de clase EDR (Endpoint Detection and Response) que se instala en computadoras personales y m√≥viles con Windows, Linux, MacOS, Android e iOS.  Por lo tanto, Threat Hunting con Cisco Visibility ahora se lleva a cabo en dispositivos de punto final, que son atacados en un 70% por los atacantes. <br><br><img src="https://habrastorage.org/webt/km/fw/iu/kmfwiu5ky9hdr11hrqxiuwrpsao.png" alt="imagen"><br><br>  ¬øQu√© vemos despu√©s de cargar los indicadores en Cisco Visibility?  El √°rea principal de la pantalla est√° ocupada por el gr√°fico de relaciones, que refleja las interacciones entre los indicadores de compromiso, los eventos de seguridad que se recopilan de la infraestructura del cliente y el entorno externo.  Puede escalar la imagen para tener una idea general de la imagen de lo que est√° sucediendo. <br><br><img src="https://habrastorage.org/webt/ad/kz/kk/adkzkkzagihootdjg2_kalsyabe.png" alt="imagen"><br><br>  Sobre el gr√°fico de interacciones hay un panel que muestra un resumen de todos los puntos de inter√©s para nosotros: <br><br><ul><li>  Objetivos o sacrificios.  Al hacer clic en este campo, recibir√° de inmediato una lista de todos los nodos de su red en los que se encuentran las pistas que est√° buscando.  Esto es exactamente lo que necesita para comprender la magnitud del desastre y cu√°nto ha sufrido.  Si no se muestran nodos aqu√≠, entonces no tiene nodos involucrados en el ataque. </li><li>  Huellas  Al hacer clic en este campo, obtendr√° una lista de las pistas que est√° buscando, con resaltado de color que refleja el hecho de que estas pistas est√°n en las bases de datos de Cisco Threat Intelligence. </li><li>  Indicadores  Al hacer clic en este campo, ver√° los patrones de comportamiento que se encontraron en su infraestructura que coinciden con los rastros que est√° buscando. </li><li>  Dominios, hashes, direcciones IP y URL.  Estos campos muestran las trazas correspondientes. </li><li>  M√≥dulos  Este elemento del men√∫ refleja la lista de m√≥dulos con la ayuda de los cuales se enriquecieron los datos y se detectaron rastros de ataques.  Existen varios m√≥dulos de este tipo e incluyen soluciones de Cisco (por ejemplo, Cisco ThreatGrid, Cisco Umbrella, Cisco AMP Global Intelligence, Talos Intelligence) y soluciones de terceros (por ejemplo, VirusTotal).  La lista de estos m√≥dulos se expandir√°. </li></ul><br><br><img src="https://habrastorage.org/webt/2c/gc/d_/2cgcd_-ebsbncdvvjipkwvorxny.png" alt="imagen"><br><br>  Teniendo en cuenta que los agentes AMP4E pueden instalarse en cientos y miles de computadoras, no estamos interesados ‚Äã‚Äãen todos ellos, sino solo en aquellos que "se pusieron bajo la distribuci√≥n" (si es que lo hicieron, por supuesto).  Al hacer clic en el campo Objetivo, obtenemos una lista de los nodos donde se encontraron rastros de la amenaza.  En nuestro caso, este es solo un nodo. <br><br><img src="https://habrastorage.org/webt/xb/dy/ir/xbdyirqf-1ga43virsmb8i9rbmk.png" alt="imagen"><br><br>  Al hacer clic en el nombre de este nodo, obtenemos de inmediato el √°rea del gr√°fico de interacciones, que refleja todas las conexiones entre las trazas deseadas y el nodo comprometido. <br><br><img src="https://habrastorage.org/webt/4g/kh/yb/4gkhybixr3knbccch9sy-3eq7ro.png" alt="imagen"><br><br>  Est√° claro de inmediato que solo una peque√±a parte de la infraestructura se ha visto afectada, en la que puede concentrarse. <br><br><img src="https://habrastorage.org/webt/ri/tn/jd/ritnjduwd50csjcb8tqkx-gxzqk.png" alt="imagen"><br><br>  Las trazas encontradas se enriquecieron con varios m√≥dulos, incluidas soluciones de terceros (en este caso, VirusTotal).  Esto nos permite tener m√°s confianza en los resultados del an√°lisis, ya que la confirmaci√≥n de los rastros encontrados se obtuvo de varias fuentes de Inteligencia de amenazas.  En este caso, la investigaci√≥n se enriqueci√≥ con datos de TI de 5 fuentes: <br><br><img src="https://habrastorage.org/webt/al/y5/rm/aly5rmv0lqhgzsn6wajemvfymvu.png" alt="imagen"><br><br>  Se han encontrado muchos indicadores de compromiso, es decir, patrones de comportamiento, con respecto a las huellas buscadas (19): <br><br><img src="https://habrastorage.org/webt/md/px/07/mdpx07llwqdd8bbajl2djtijqom.png" alt="imagen"><br><br>  El √°rea de la pantalla "L√≠nea de tiempo de avistamientos" nos muestra una l√≠nea de tiempo que refleja dos cuestiones importantes: cu√°ndo se encontraron los rastros en nuestra infraestructura local y cu√°ndo se encontraron fuera de la empresa, en el mundo (los √∫ltimos 30 d√≠as se muestran para no llevar a los analistas demasiado lejos del momento actual )  Dicha comparaci√≥n de las dos l√≠neas de tiempo nos permite concluir si la actividad maliciosa es global (y simplemente nos encontramos bajo distribuciones como muchas otras) o si fue focal, dise√±ada espec√≠ficamente para nosotros. <br><br><img src="https://habrastorage.org/webt/bg/7t/el/bg7telzembuqnsjn2tsb_ok-pk8.png" alt="imagen"><br><br>  En la parte inferior de la pantalla, veremos una secci√≥n donde puede obtener los detalles de cada pista, artefacto, indicador de compromiso encontrado e ir a un an√°lisis m√°s detallado.  Tenga en cuenta que de todos los rastros que estamos buscando, solo tenemos uno en nuestra red: el hash del archivo malicioso. <br><br><img src="https://habrastorage.org/webt/iq/k1/7b/iqk17bn0jjq1phhsycrhsjwum9e.png" alt="imagen"><br><br>  Por ejemplo, as√≠ es como se ve la informaci√≥n sobre archivos maliciosos detectados en nuestra infraestructura con el hash correspondiente.  Sin embargo, vale la pena prestar atenci√≥n a un punto tan importante.  Para cada pista, vemos varias pesta√±as.  El primero de estos son los juicios.  En √©l vemos referencias a varios m√≥dulos que "vieron" estos rastros en alg√∫n momento.  Por ejemplo, vemos que en la base de datos VirusTotal hay un hash correspondiente y es reconocido por diferentes motores antivirus.  ¬øEsto significa que esta amenaza est√° en nuestra red?  A√∫n no  Quiz√°s este es un viejo malware que ya no es v√°lido.  Por ejemplo, en el campo Caducidad puede haber una nota de que este rastro se registr√≥ por √∫ltima vez "en estado salvaje" hace dos meses. <br><br><img src="https://habrastorage.org/webt/ia/yw/ds/iaywdsihkz8zhjjwb17hav3qpfc.png" alt="imagen"><br><br>  La pesta√±a Veredicto (oraci√≥n final) es mucho m√°s importante, lo que nos permite sacar una conclusi√≥n final (mediante la evaluaci√≥n de diferentes datos, cuyo resultado ponderado se muestra en la pesta√±a Veredicto) sobre la presencia o ausencia de una amenaza en nuestra infraestructura. <br><br><img src="https://habrastorage.org/webt/li/kb/n4/likbn4bx17o9cq1uyozhayjyxjk.png" alt="imagen"><br><br>  La pesta√±a Avistamientos nos muestra artefactos por amenaza y d√≥nde fueron descubiertos: <br><br><img src="https://habrastorage.org/webt/ti/gv/de/tigvdeoqymwnpirye-snmwama9s.png" alt="imagen"><br><br>  La pesta√±a Indicadores muestra una descripci√≥n detallada de cada indicador inherente a las trazas detectadas: <br><br><img src="https://habrastorage.org/webt/qw/8t/f_/qw8tf_j1jbaqvtqasvf_qyeayfw.png" alt="imagen"><br><br>  Tenga en cuenta que tenemos interacci√≥n con Tor, eliminaci√≥n de copias de seguridad, reconocimiento de antivirus y la creaci√≥n de una gran cantidad de artefactos, etc.  En nuestras bases de datos de Threat Intelligence, analizamos alrededor de 1000 indicadores diferentes. <br><br><img src="https://habrastorage.org/webt/x6/qm/og/x6qmogkcwjcc-tiotzjnzgvajxc.png" alt="imagen"><br><br>  Despu√©s de recibir informaci√≥n sobre los rastros de un ataque encontrado en nuestra infraestructura, podemos realizar una investigaci√≥n m√°s detallada utilizando las herramientas que proporcionaron los datos iniciales a Cisco Visibility.  Por ejemplo, podemos ejecutar AMP para puntos finales con el fin de obtener un an√°lisis detallado de un evento espec√≠fico, lo que condujo a la posibilidad de detectar una amenaza. <br><br><img src="https://habrastorage.org/webt/ap/zd/s8/apzds89cfirq4mbtiqopzjzim-k.png" alt="imagen"><br><br>  Vemos la imagen completa de lo que est√° sucediendo.  Archivo malicioso creado por el proceso explorer.exe a las 20:00:00 hora de Mosc√∫ el 15 de julio.  Vemos d√≥nde se encuentra este archivo y los valores de sus valores hash de acuerdo con varios algoritmos (SHA1 y MD5). <br><br><img src="https://habrastorage.org/webt/dk/a8/6g/dka86gxg9965skwqvay02uehgyw.png" alt="imagen"><br><br>  Utilizando la tecnolog√≠a de seguridad retrospectiva y el mecanismo de visualizaci√≥n de Device Trajectory, podemos visualizar todas las acciones realizadas o realizadas por el archivo que nos interesa.  En este caso, vemos que el objeto de archivo t.exe creado por el proceso explorer.exe lanz√≥ la utilidad completamente legal de Windows: vssadmin.exe, que administra las instant√°neas y, entre otras cosas, a menudo es utilizado por los encriptadores para eliminarlas (de modo que no se pueda restaurar) datos encriptados).  Si nos fijamos en la descripci√≥n de TeslaCrypt, veremos que este encriptador usa vssadmin en sus actividades. <br><br><img src="https://habrastorage.org/webt/dr/se/pu/drsepug7_ofjtv-4usydyseb4dq.png" alt="imagen"><br><br>  Por cierto, recientemente actualizamos el mecanismo de trayectoria del dispositivo y ahora se ve un poco diferente: <br><br><img src="https://habrastorage.org/webt/eg/bi/zt/egbiztnnll_m0roakbxmb44iztq.png" alt="imagen"><br><br>  En el ejemplo anterior, el archivo t.exe no se bloque√≥ y no se puso en cuarentena, aunque esto es exactamente lo que hace AMP for Endpoints en la vida real.  Pero para los fines de este art√≠culo, AMP4E funciona en modo auditor√≠a, que le permite monitorear eventos, pero no bloquearlos.  Por cierto, si se iniciara PowerShell (tambi√©n una herramienta de administraci√≥n del sistema completamente legal) en lugar de vssadmin, entonces ver√≠amos esto y los par√°metros de l√≠nea de comando utilizados en PowerShell. <br><br>  En resumen, parece que funciona con Cisco Visibility mientras busca rastros de amenazas en la infraestructura local y enriquece los eventos de seguridad existentes con datos de varias fuentes de inteligencia de amenazas. <br><br>  PD: Cisco Visibility se basa en el Modelo de inteligencia de amenazas de Cisco (CTIM) que desarrollamos, que, a su vez, se basa en el est√°ndar de comunicaci√≥n de Inteligencia de amenazas: STIX.  Pero a diferencia de STIX, el modelo CTIM no se centra en formalizar el formato de los datos de amenazas, sino en el proceso de recopilaci√≥n, almacenamiento y an√°lisis de estos datos.  Confiando en la API de Cisco Threat Intelligence (este es un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">proyecto de c√≥digo abierto</a> y puede usarse en sus soluciones), planeamos expandir la lista de fuentes con las que trabajaremos, tanto en t√©rminos de recibir eventos de seguridad como en t√©rminos de recibir datos de Threat Intelligence.  Adem√°s, planeamos agregar a Cisco Visibility la capacidad de trabajar no solo con indicadores at√≥micos de compromiso (IP, hash, dominio, URL), sino tambi√©n con datos de vulnerabilidad (CVE), programas de configuraci√≥n (CWE) y base de datos de patrones de ataque (CAPEC) y una base de conocimientos sobre m√©todos, t√°cticas y procedimientos de los atacantes (ATT y CK).  Este trabajo est√° en curso. <br><br>  PPS: Al comienzo de la nota, era un poco astuto.  Cisco Visibility es de hecho una soluci√≥n gratuita, pero para usarla, debe tener al menos Cisco AMP for Endpoints instalado en su organizaci√≥n (¬øy de d√≥nde obtener los datos para la b√∫squeda de amenazas?).  Tambi√©n es deseable (pero no necesario) tener acceso a los servicios de Cisco Threat Grid (sandbox) y Cisco Umbrella (an√°lisis de DNS).  En estos casos, ser√° posible realizar un an√°lisis m√°s profundo de las amenazas (trazas e indicadores) que ya se encuentran dentro de los servicios especificados lanzados desde Cisco Visibility.  Y, por supuesto, debe tener acceso a los servicios externos de Inteligencia de amenazas que se integran con Cisco Visibility.  Hasta ahora, esto es solo VirusTotal (pero no estamos quietos y ampliaremos su n√∫mero), acceso al que cualquiera puede acceder. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es417345/">https://habr.com/ru/post/es417345/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es417329/index.html">Usted y Brad Pitt son 99%</a></li>
<li><a href="../es417331/index.html">Semana de la seguridad 26: espectro actualizado, ahora grabaci√≥n de buen gusto</a></li>
<li><a href="../es417333/index.html">Calificaci√≥n social</a></li>
<li><a href="../es417337/index.html">Principios de funcionamiento y caracter√≠sticas de aplicaci√≥n del intercambio at√≥mico</a></li>
<li><a href="../es417339/index.html">3DTouch - Escalas en iPhone: finalizaci√≥n</a></li>
<li><a href="../es417349/index.html">Intercambio de datos y ecuaciones diferenciales</a></li>
<li><a href="../es417353/index.html">Alemania aprueba el uso de trenes de celdas de combustible de hidr√≥geno</a></li>
<li><a href="../es417355/index.html">Calvicie: teor√≠a y pr√°ctica del tratamiento, parte 2 "Incluso la pr√≥stata tiene am√≠gdalas, prostaglandinas"</a></li>
<li><a href="../es417357/index.html">Equipos de escritorio "Acerca de TI". Historia de los juegos de configuraci√≥n de computadora</a></li>
<li><a href="../es417359/index.html">Seguridad de la informaci√≥n? No no escuchado</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>