<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ôüèø üò≠ üö∑ Beste Testtechniken in JavaScript und Node.js. üõ†Ô∏è üî≠ ‚ûó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dies ist eine umfassende Anleitung zur Bereitstellung von Zuverl√§ssigkeit in JavaScript und Node.js. Hier werden Dutzende der besten Beitr√§ge, B√ºcher ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Beste Testtechniken in JavaScript und Node.js.</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/466879/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/t2/fe/u-/t2feu-mapmlc7txb2ith9futkie.jpeg"></div><br>  Dies ist eine umfassende Anleitung zur Bereitstellung von Zuverl√§ssigkeit in JavaScript und Node.js.  Hier werden Dutzende der besten Beitr√§ge, B√ºcher und Tools gesammelt. <br><br>  Behandeln Sie zun√§chst allgemein anerkannte Testmethoden, die jeder Anwendung zugrunde liegen.  Und dann k√∂nnen Sie sich mit dem Bereich befassen, der Sie interessiert: Frontend und Schnittstellen, Backend, CI oder alle oben genannten Bereiche. <br><a name="habracut"></a><br><h1>  Inhalt </h1><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abschnitt 0. Die goldene Regel.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ein Ratschlag, der die treibende Kraft hinter allen anderen Ratschl√§gen ist (1 spezielles Kapitel).</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abschnitt 1. Anatomie des Tests.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Grundlagen: Verst√§ndliche Tests erstellen (12 Kapitel).</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abschnitt 2. Das Backend.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schreiben Sie effektiv Tests f√ºr das Backend und die Microservices (8 Kapitel).</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abschnitt 3. Frontend, Schnittstelle, E2E.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wir schreiben Tests f√ºr das Webinterface, einschlie√ülich Komponenten- und E2E-Tests (11 Kapitel).</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abschnitt 4. Messung der Testwirksamkeit.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beobachter beobachten: Bewertung der Testqualit√§t (4 Kapitel).</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abschnitt 5. Kontinuierliche Integration.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CI-Empfehlungen in der JS-Welt (9 Kapitel).</a> </li></ul><br><a name="1"></a><h1>  Abschnitt 0. Goldene Regel </h1><br><h2>  0. Goldene Regel: Halten Sie sich an Lean Testing </h2><br>  <b>Was soll ich tun.</b>  Der Testcode unterscheidet sich von dem, was in Betrieb genommen wird.  Machen Sie es so einfach wie m√∂glich, kurz, frei von Abstraktionen, einzeln, wunderbar bei der Arbeit und sparsam.  Eine andere Person sollte sich den Test ansehen und sofort verstehen, was sie tut. <br><br>  Unsere K√∂pfe sind mit dem Produktionscode besch√§ftigt, sie haben keinen freien Speicherplatz f√ºr zus√§tzliche Komplexit√§t.  Wenn wir einen neuen Teil des komplexen Codes in unseren armen Verstand schieben, verlangsamt dies die Arbeit des gesamten Teams an der Aufgabe, f√ºr die wir testen.  Aus diesem Grund meiden viele Teams Tests einfach. <br><br>  Tests - dies ist eine Gelegenheit, einen freundlichen und l√§chelnden Assistenten zu finden, mit dem es sehr gut zu arbeiten ist und der eine enorme Rendite f√ºr kleine Investitionen bringt.  Wissenschaftler glauben, dass es in unserem Gehirn zwei Systeme gibt: eines f√ºr Aktionen, die keine Anstrengung erfordern, wie das Fahren auf einer leeren Stra√üe, und das zweite f√ºr komplexe Operationen, die Bewusstsein erfordern, wie das L√∂sen mathematischer Gleichungen.  Erstellen Sie Ihre Tests f√ºr das erste System, damit Sie beim Betrachten des Codes ein Gef√ºhl der Einfachheit erhalten, das mit dem Bearbeiten eines HTML-Dokuments vergleichbar ist, und nicht mit einer <code>2X(17 √ó 24)</code> L√∂sung <code>2X(17 √ó 24)</code> . <br><br>  Dies kann durch sorgf√§ltige Auswahl von Methoden, Werkzeugen und Testzielen erreicht werden, so dass diese wirtschaftlich sind und einen hohen ROI erzielen.  Testen Sie nur so viel wie n√∂tig, versuchen Sie flexibel zu sein.  Manchmal lohnt es sich sogar, einige Tests zu verwerfen und die Zuverl√§ssigkeit f√ºr Geschwindigkeit und Einfachheit zu opfern. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f27/bc3/5f9/f27bc35f96e79037157cea807ac5be23.png"><br><br>  Die meisten der folgenden Empfehlungen leiten sich aus diesem Prinzip ab. <br>  <b>Bist du bereit</b> <br><br><a name="2"></a><h1>  Abschnitt 1. Anatomie des Tests </h1><br><h2>  1.1 Der Name jeder Pr√ºfung sollte aus drei Teilen bestehen </h2><br>  <b>Was soll ich tun.</b>  Aus dem Testbericht sollte hervorgehen, ob die aktuelle Version der Anwendung den Anforderungen derjenigen Personen entspricht, die mit dem Code nicht vertraut sind: Tester, die an der Bereitstellung von DevOps-Ingenieuren beteiligt sind, sowie Sie selbst in zwei Jahren.  Es ist am besten, wenn die Tests Informationen in der Sprache der Anforderungen melden und ihre Namen aus drei Teilen bestehen: <br><br><ol><li>  Was genau wird getestet?  Zum Beispiel die <code>ProductsService.addNewProduct</code> Methode. </li><li>  Unter welchen Bedingungen und Szenarien?  Beispielsweise wird der Preis nicht an die Methode √ºbergeben. </li><li>  Was ist das erwartete Ergebnis?  Beispielsweise wird ein neues Produkt nicht genehmigt. </li></ol><br>  <b>Sonst.</b>  Die Bereitstellung schl√§gt fehl, der Test mit dem Namen "Produkt hinzuf√ºgen" schl√§gt fehl.  Verstehst du was genau falsch funktioniert? <br><br>  <b>Hinweis</b>  Jedes Kapitel enth√§lt einen Beispielcode und manchmal eine Abbildung.  Siehe Spoiler. <br><br><div class="spoiler">  <b class="spoiler_title">Codebeispiele</b> <div class="spoiler_text">  <b>Wie man es richtig macht.</b>  Der Name des Tests besteht aus drei Teilen. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//1. unit under test describe('Products Service', function() { describe('Add new product', function() { //2. scenario and 3. expectation it('When no price is specified, then the product status is pending approval', ()=&gt; { const newProduct = new ProductService().add(...); expect(newProduct.status).to.equal('pendingApproval'); }); }); });</span></span></code> </pre> <br></div></div><br><h2>  1.2 Strukturieren Sie die Tests nach dem AAA-Muster </h2><br>  <b>Was soll ich tun.</b>  Jeder Test sollte aus drei klar getrennten Abschnitten bestehen: Anordnen (Vorbereitung), Handeln (Aktion) und Best√§tigen (Ergebnis).  Das Festhalten an einer solchen Struktur stellt sicher, dass der Leser Ihres Codes nicht den Gehirnprozessor verwenden muss, um den Testplan zu verstehen: <br><br>  Anordnen: Der gesamte Code, der das System gem√§√ü dem Testszenario in einen Zustand versetzt.  Dies kann das Erstellen einer Instanz des Moduls im Testdesigner, das Hinzuf√ºgen von Datens√§tzen zur Datenbank, das Erstellen von Stubs anstelle von Objekten und anderen Code umfassen, der das System auf den Testlauf vorbereitet. <br><br>  Act: Codeausf√ºhrung als Teil eines Tests.  Normalerweise nur eine Zeile. <br>  Behauptung: Stellen Sie sicher, dass der erzielte Wert den Erwartungen entspricht.  Normalerweise nur eine Zeile. <br><br>  <b>Sonst.</b>  Sie werden nicht nur viele Stunden mit dem Hauptcode arbeiten, sondern Ihr Gehirn wird auch von dem anschwellen, was ein einfacher Job sein sollte - vom Testen. <br><br><div class="spoiler">  <b class="spoiler_title">Codebeispiele</b> <div class="spoiler_text">  <b>Wie man es richtig macht.</b>  Ein nach dem AAA-Muster strukturierter Test. <br><br><pre> <code class="javascript hljs">describe.skip(<span class="hljs-string"><span class="hljs-string">'Customer classifier'</span></span>, () =&gt; { test(<span class="hljs-string"><span class="hljs-string">'When customer spent more than 500$, should be classified as premium'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//Arrange const customerToClassify = {spent:505, joined: new Date(), id:1} const DBStub = sinon.stub(dataAccess, "getCustomer") .reply({id:1, classification: 'regular'}); //Act const receivedClassification = customerClassifier.classifyCustomer(customerToClassify); //Assert expect(receivedClassification).toMatch('premium'); }); });</span></span></code> </pre><br>  <b>Ein Beispiel f√ºr Antimuster.</b>  Keine Trennung in einem St√ºck ist schwieriger zu interpretieren. <br><br><pre> <code class="javascript hljs">test(<span class="hljs-string"><span class="hljs-string">'Should be classified as premium'</span></span>, () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> customerToClassify = {<span class="hljs-attr"><span class="hljs-attr">spent</span></span>:<span class="hljs-number"><span class="hljs-number">505</span></span>, <span class="hljs-attr"><span class="hljs-attr">joined</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>(), <span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> DBStub = sinon.stub(dataAccess, <span class="hljs-string"><span class="hljs-string">"getCustomer"</span></span>) .reply({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">classification</span></span>: <span class="hljs-string"><span class="hljs-string">'regular'</span></span>}); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> receivedClassification = customerClassifier.classifyCustomer(customerToClassify); expect(receivedClassification).toMatch(<span class="hljs-string"><span class="hljs-string">'premium'</span></span>); });</code> </pre> <br></div></div><br><h2>  1.3 Beschreiben Sie die Erwartungen in der Sprache des Produkts: Geben Sie im Stil von BDD an </h2><br>  <b>Was soll ich tun.</b>  Das Programmieren von Tests in einem deklarativen Stil erm√∂glicht es dem Benutzer, die Essenz sofort zu verstehen, ohne einen einzelnen Gehirnprozessorzyklus zu verbringen.  Wenn Sie imperativen Code schreiben, der in bedingte Logik gepackt ist, muss der Leser viel Aufwand betreiben.  Unter diesem Gesichtspunkt m√ºssen Sie Erwartungen in einer menschen√§hnlichen Sprache in einem deklarativen BDD-Stil beschreiben, indem Sie erwarten / sollten und keinen benutzerdefinierten Code verwenden.  Wenn es in Chai und Jest keine notwendige Behauptung gibt, die oft wiederholt wird, k√∂nnen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den Matcher Jest erweitern</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ihr eigenes Plugin f√ºr Chai</a> schreiben. <br><br>  <b>Sonst.</b>  Das Team wird weniger Tests schreiben und nervige Tests <code>with .skip()</code> dekorieren. <br><br><div class="spoiler">  <b class="spoiler_title">Codebeispiele</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ein Beispiel mit Mokka</a> . <br><br>  <b>Ein Beispiel f√ºr Antimuster.</b>  Um das Wesentliche des Tests zu verstehen, muss der Benutzer einen ziemlich langen imperativen Code durchlaufen. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When asking for an admin, ensure only ordered admins in results"</span></span> , ()={ <span class="hljs-comment"><span class="hljs-comment">//assuming we've added here two admins "admin1", "admin2" and "user1" const allAdmins = getUsers({adminOnly:true}); const admin1Found, adming2Found = false; allAdmins.forEach(aSingleUser =&gt; { if(aSingleUser === "user1"){ assert.notEqual(aSingleUser, "user1", "A user was found and not admin"); } if(aSingleUser==="admin1"){ admin1Found = true; } if(aSingleUser==="admin2"){ admin2Found = true; } }); if(!admin1Found || !admin2Found ){ throw new Error("Not all admins were returned"); } });</span></span></code> </pre><br>  <b>Wie man es richtig macht.</b>  Das Lesen dieses deklarativen Tests ist unkompliziert. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When asking for an admin, ensure only ordered admins in results"</span></span> , ()={ <span class="hljs-comment"><span class="hljs-comment">//assuming we've added here two admins const allAdmins = getUsers({adminOnly:true}); expect(allAdmins).to.include.ordered.members(["admin1" , "admin2"]) .but.not.include.ordered.members(["user1"]); });</span></span></code> </pre> <br></div></div><br><h2>  1.4 Black-Box-Tests einhalten: Testen Sie nur √∂ffentliche Methoden </h2><br>  <b>Was soll ich tun.</b>  Das Testen der Innenseiten f√ºhrt zu einem enormen Overhead und bringt fast nichts.  Wenn Ihr Code oder Ihre API die richtigen Ergebnisse liefert, lohnt es sich, drei Stunden lang zu testen, wie es intern funktioniert, und dann auch diese fragilen Tests zu unterst√ºtzen?  Wenn Sie das √∂ffentliche Verhalten √ºberpr√ºfen, √ºberpr√ºfen Sie gleichzeitig implizit die Implementierung selbst. Ihre Tests schlagen nur fehl, wenn ein bestimmtes Problem vorliegt (z. B. falsche Ausgabe).  Dieser Ansatz wird auch als Verhaltenstest bezeichnet.  Wenn Sie dagegen die Interna testen (die ‚ÄûWhite-Box‚Äú -Methode), konzentrieren Sie sich statt der Planung der Ausgabe der Komponenten auf kleine Details, und Ihre Tests k√∂nnen aufgrund kleiner √Ñnderungen des Codes unterbrochen werden, auch wenn die Ergebnisse in Ordnung sind Eskorte wird viel mehr Ressourcen in Anspruch nehmen. <br><br>  <b>Sonst.</b>  Ihre Tests werden sich wie ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Junge</a> verhalten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">, der "Wolf!"</a>  : Falsch positive Ergebnisse melden (z. B. schl√§gt der Test aufgrund einer √Ñnderung des Namens einer privaten Variablen fehl).  Es ist nicht verwunderlich, dass die Leute bald anfangen werden, CI-Benachrichtigungen zu ignorieren, und eines Tages werden sie einen echten Fehler verpassen ... <br><br><div class="spoiler">  <b class="spoiler_title">Codebeispiele</b> <div class="spoiler_text">  <b>Ein Beispiel f√ºr Antimuster.</b>  Testen der Innenseiten ohne guten Grund. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ein Beispiel mit Mokka</a> . <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductService</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">//this method is only used internally //Change this name will make the tests fail calculateVAT(priceWithoutVAT){ return {finalPrice: priceWithoutVAT * 1.2}; //Change the result format or key name above will make the tests fail } //public method getPrice(productId){ const desiredProduct= DB.getProduct(productId); finalPrice = this.calculateVATAdd(desiredProduct.price).finalPrice; } } it("White-box test: When the internal methods get 0 vat, it return 0 response", async () =&gt; { //There's no requirement to allow users to calculate the VAT, only show the final price. Nevertheless we falsely insist here to test the class internals expect(new ProductService().calculateVATAdd(0).finalPrice).to.equal(0); });</span></span></code> </pre> <br></div></div><br><h2>  1.5 W√§hlen Sie die richtige simulierte Implementierung: Vermeiden Sie gef√§lschte Objekte zugunsten von Stubs und Spionen </h2><br>  <b>Was soll ich tun.</b>  Simulierte Implementierungen (Test-Doubles) sind ein notwendiges √úbel, da sie mit den Interna der Anwendung verkn√ºpft sind und einige von gro√üem Wert sind ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aktualisieren Sie den Speicher nachgeahmter Implementierungen: gef√§lschte Objekte (Mocks), Stubs (Stubs) und Spionageobjekte (Spione)</a> )  Es sind jedoch nicht alle Techniken gleichwertig.  Spione und Stummel wurden entwickelt, um Anforderungen zu testen, haben jedoch unvermeidliche Nebenwirkungen - sie wirken sich auch geringf√ºgig auf das Innere aus.  Und gef√§lschte Objekte dienen zum Testen der Innenseiten, was zu einem enormen Overhead f√ºhrt, wie in Kapitel 1.4 beschrieben. <br><br>  Stellen Sie sich vor der Verwendung simulierter Implementierungen die einfachste Frage: "Verwenden Sie diese Option, um die Funktionalit√§t zu testen, die in der Dokumentation mit den Anforderungen angezeigt wurde oder m√∂glicherweise angezeigt wird."  Wenn nicht, riecht es nach White-Box-Tests. <br><br>  Wenn Sie beispielsweise herausfinden m√∂chten, ob sich die Anwendung ordnungsgem√§√ü verh√§lt, wenn der Zahlungsdienst nicht verf√ºgbar ist, k√∂nnen Sie stattdessen einen Stub erstellen und "Keine Antwort" zur√ºckgeben, um zu √ºberpr√ºfen, ob das zu testende Modul den richtigen Wert zur√ºckgibt.  So k√∂nnen Sie unter bestimmten Szenarien das Verhalten / die Reaktion / die Ausgabe der Anwendung √ºberpr√ºfen.  Sie k√∂nnen auch mit Hilfe eines Spions best√§tigen, dass der Brief gesendet wurde, wenn der Dienst nicht verf√ºgbar war. Es handelt sich auch um Verhaltenstests, die sich besser in der Dokumentation mit den Anforderungen widerspiegeln ("Senden Sie einen Brief, wenn Zahlungsinformationen nicht gespeichert werden k√∂nnen").  Wenn Sie einen gef√§lschten Zahlungsdienst ausf√ºhren und sicherstellen, dass dieser mit den richtigen JS-Typen aufgerufen wird, richtet sich Ihr Test gleichzeitig an Interna, die nicht mit der Funktionalit√§t der Anwendung zusammenh√§ngen und sich wahrscheinlich h√§ufig √§ndern. <br><br>  <b>Sonst.</b>  Bei jedem Code-Refactoring werden alle gef√§lschten Objekte im Code gefunden und aktualisiert.  Tests von einem Assistenten werden zur Belastung. <br><br><div class="spoiler">  <b class="spoiler_title">Codebeispiele</b> <div class="spoiler_text">  <b>Ein Beispiel f√ºr Antimuster.</b>  Gef√§lschte Objekte sind f√ºr Mut. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiel mit Sinon</a> . <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When a valid product is about to be deleted, ensure data access DAL was called once, with the right product and right config"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//Assume we already added a product const dataAccessMock = sinon.mock(DAL); //hmmm BAD: testing the internals is actually our main goal here, not just a side-effect dataAccessMock.expects("deleteProduct").once().withArgs(DBConfig, theProductWeJustAdded, true, false); new ProductService().deletePrice(theProductWeJustAdded); mock.verify(); });</span></span></code> </pre><br>  <b>Wie man es richtig macht.</b>  Spione wurden entwickelt, um Anforderungen zu testen, aber es gibt einen Nebeneffekt - sie wirken sich unweigerlich auf das Innere aus. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When a valid product is about to be deleted, ensure an email is sent"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//Assume we already added here a product const spy = sinon.spy(Emailer.prototype, "sendEmail"); new ProductService().deletePrice(theProductWeJustAdded); //hmmm OK: we deal with internals? Yes, but as a side effect of testing the requirements (sending an email) });</span></span></code> </pre> <br></div></div><br><h2>  1.6 Verwenden Sie nicht "foo", sondern realistische Eingaben </h2><br>  <b>Was soll ich tun.</b>  Oft treten Produktionsfehler mit sehr spezifischen und √ºberraschenden Eingabedaten auf.  Je realistischer die Daten w√§hrend des Tests sind, desto wahrscheinlicher ist es, dass Fehler rechtzeitig erkannt werden.  Verwenden Sie spezielle Bibliotheken, z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Faker,</a> um pseudoreale Daten zu generieren, die die Vielfalt und Art der Produktionsdaten simulieren.  Solche Bibliotheken k√∂nnen realistische Telefonnummern, Benutzernamen, Bankkarten, Firmennamen und sogar den Text ‚Äûlorem ipsum‚Äú generieren.  Sie k√∂nnen Tests erstellen (zus√§tzlich zu Unit-Tests und nicht stattdessen), die gef√§lschte Daten randomisieren, um das Modul in einen Test zu integrieren, oder sogar echte Daten aus einer Produktionsumgebung importieren.  Willst du noch weiter gehen?  Lesen Sie das n√§chste Kapitel (√ºber eigenschaftsbasierte Tests). <br><br>  <b>Sonst.</b>  Ihre Entwicklungstests werden mit synthetischen Eingaben wie ‚ÄûFoo‚Äú erfolgreich aussehen, und Produktionsdaten k√∂nnen fehlschlagen, wenn ein Hacker <code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code> knifflige Zeile wie <code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code> <code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code>  <code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code> . <br><br><div class="spoiler">  <b class="spoiler_title">Codebeispiele</b> <div class="spoiler_text">  <b>Ein Beispiel f√ºr Antimuster.</b>  Eine Testsuite, die aufgrund der Verwendung unrealistischer Daten erfolgreich ausgef√ºhrt wird. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ein Beispiel mit Jest</a> . <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> addProduct = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name, price</span></span></span><span class="hljs-function">) =&gt;</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> productNameRegexNoSpace = <span class="hljs-regexp"><span class="hljs-regexp">/^\S*$/</span></span>;<span class="hljs-comment"><span class="hljs-comment">//no white-space allowed if(!productNameRegexNoSpace.test(name)) return false;//this path never reached due to dull input //some logic here return true; }; test("Wrong: When adding new product with valid properties, get successful confirmation", async () =&gt; { //The string "Foo" which is used in all tests never triggers a false result const addProductResult = addProduct("Foo", 5); expect(addProductResult).to.be.true; //Positive-false: the operation succeeded because we never tried with long //product name including spaces });</span></span></code> </pre><br>  <b>Wie man es richtig macht.</b>  Zuf√§llige realistische Eingabe. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"Better: When adding new valid product, get successful confirmation"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> addProductResult = addProduct(faker.commerce.productName(), faker.random.number()); <span class="hljs-comment"><span class="hljs-comment">//Generated random input: {'Sleek Cotton Computer', 85481} expect(addProductResult).to.be.true; //Test failed, the random input triggered some path we never planned for. //We discovered a bug early! });</span></span></code> </pre> <br></div></div><br><h2>  1.7 Verwenden Sie eigenschaftsbasierte Tests, um mehrere Eingabekombinationen zu validieren </h2><br>  <b>Was soll ich tun.</b>  Normalerweise w√§hlen wir f√ºr jeden Test mehrere Stichproben von Eingabedaten aus.  Auch wenn das Eingabeformat den realen Daten √§hnlich ist (siehe Kapitel ‚ÄûVerwenden Sie nicht‚Äû foo ‚Äú)), werden nur einige Kombinationen von Eingabedaten behandelt (Methode <code>('', true, 1)</code> , Methode <code>("string" , false" , 0)</code> ). Im Betrieb kann eine API, die mit f√ºnf Parametern aufgerufen wird, mit Tausenden verschiedener Kombinationen aufgerufen werden, von denen eine zu einem Prozessabsturz ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fuzzing</a> ) f√ºhren kann. Was w√§re, wenn Sie einen Test schreiben k√∂nnten, der automatisch 1000 Kombinationen von Eingabedaten und Daten sendet Festlegen, bei welchen Kombinationen der Code nicht die richtige Antwort zur√ºckgibt? Dasselbe machen wir mit m  todike Test basierte auf Eigenschaften: durch alle m√∂glichen Kombinationen von Eingangsdaten in die Testeinheit zu senden wir die Chance auf eine Fehlererkennung erh√∂hen, zum Beispiel, haben wir eine Methode. <code>addNewProduct(id, name, isDiscount)</code> diese Methode seine Bibliothek Unterst√ºtzung mit einer Reihe von Kombinationen nennen. <code>(,  ,  )</code> , z. B. <code>(1, "iPhone", false)</code> , <code>(2, "Galaxy", true)</code> usw. Sie k√∂nnen anhand der Eigenschaften mit Ihrem bevorzugten Testl√§ufer (Mocha, Jest) testen etc.) und Bibliotheken wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">js-verify</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">testcheck</a> (es hat eine viel bessere Dokumentation).  Sie k√∂nnen auch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die Fast-Check-Bibliothek ausprobieren</a> , die zus√§tzliche Funktionen bietet und vom Autor aktiv begleitet wird. <br><br>  <b>Sonst.</b>  Sie w√§hlen gedankenlos Eingabedaten f√ºr den Test aus, die nur gut funktionierende Codeausf√ºhrungspfade abdecken.  Leider verringert dies die Effektivit√§t des Testens als Mittel zum Erkennen von Fehlern. <br><br><div class="spoiler">  <b class="spoiler_title">Codebeispiele</b> <div class="spoiler_text">  <b>Wie man es richtig macht.</b>  Testen Sie zahlreiche Kombinationen mit dem Mokka-Testcheck. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'mocha-testcheck'</span></span>).install(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {expect} = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'chai'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> faker = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'faker'</span></span>); describe(<span class="hljs-string"><span class="hljs-string">'Product service'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">'Adding new'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//this will run 100 times with different random properties check.it('Add new product with random yet valid properties, always successful', gen.int, gen.string, (id, name) =&gt; { expect(addNewProduct(id, name).status).to.equal('approved'); }); }) });</span></span></code> </pre> <br></div></div><br><h2>  1.8 Verwenden Sie bei Bedarf nur kurze und Inline-Aufnahmen. </h2><br>  <b>Was soll ich tun.</b>  Wenn Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">basierend auf Snapshots testen m√ºssen</a> , verwenden Sie nur kurze Snapshots ohne zus√§tzliche Informationen (z. B. in 3-7 Zeilen), einschlie√ülich dieser als Teil des Tests ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Inline-Snapshot</a> ) und nicht als externe Dateien.  Wenn Sie diese Empfehlung befolgen, bleiben Ihre Tests selbstverst√§ndlich und zuverl√§ssiger. <br><br>  Auf der anderen Seite veranlassen uns die ‚Äûklassischen Snapshot‚Äú -Handb√ºcher und -Tools, gro√üe Dateien (z. B. Markup zum Rendern von Komponenten oder JSON-API-Ergebnisse) auf externen Medien zu speichern und die Ergebnisse bei jeder Testausf√ºhrung mit der gespeicherten Version zu vergleichen.  Es kann beispielsweise implizit unseren Test mit 1000 Zeilen mit 3000 Werten verkn√ºpfen, die der Autor des Tests nie gesehen hat, von denen er nicht erwartet hatte.  Warum ist das so schlimm?  Weil es 1000 Gr√ºnde gibt, warum der Test fehlschl√§gt.  Schon eine Zeile kann einen Schnappschuss ung√ºltig machen, und dies kann h√§ufig vorkommen.  Wie viel  Nach jedem Leerzeichen, Kommentar oder geringf√ºgigen √Ñnderungen in CSS oder HTML.  Dar√ºber hinaus gibt der Name des Tests keinen Aufschluss √ºber den Fehler, da nur √ºberpr√ºft wird, ob sich 1000 Zeilen nicht ge√§ndert haben, und der Autor des Tests aufgefordert wird, ein langes Dokument, das er nicht analysieren und √ºberpr√ºfen konnte, so lange wie gew√ºnscht zu nehmen.  All dies sind Symptome eines obskuren und hastigen Tests, der keine klare Aufgabe hat und versucht, zu viel zu erreichen. <br><br>  Es ist anzumerken, dass es mehrere Situationen gibt, in denen es akzeptabel ist, lange und externe Bilder zu verwenden, beispielsweise wenn das Schema best√§tigt wird und nicht die Daten (Werte extrahieren und sich auf die Felder konzentrieren) oder wenn sich die empfangenen Dokumente selten √§ndern. <br><br>  <b>Sonst.</b>  UI-Tests schlagen fehl.  Der Code sieht gut aus, ideale Pixel werden auf dem Bildschirm angezeigt. Was passiert also?  Ihre Tests mit Schnappsch√ºssen haben nur den Unterschied zwischen dem Originaldokument und dem gerade erhaltenen Dokument ergeben - ein Leerzeichen wurde dem Markup hinzugef√ºgt ... <br><br><div class="spoiler">  <b class="spoiler_title">Codebeispiele</b> <div class="spoiler_text">  <b>Ein Beispiel f√ºr Antimuster.</b>  Verkn√ºpfen eines Tests mit unbekannten 2000 Codezeilen. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">'TestJavaScript.com is renderd correctly'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//Arrange //Act const receivedPage = renderer .create( &lt;DisplayPage page = "http://www.testjavascript.com" &gt; Test JavaScript &lt; /DisplayPage&gt;) .toJSON(); //Assert expect(receivedPage).toMatchSnapshot(); //We now implicitly maintain a 2000 lines long document //every additional line break or comment - will break this test });</span></span></code> </pre><br>  <b>Wie man es richtig macht.</b>  Erwartungen sind sichtbar und im Rampenlicht. <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">'When visiting TestJavaScript.com home page, a menu is displayed'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//Arrange //Act receivedPage tree = renderer .create( &lt;DisplayPage page = "http://www.testjavascript.com" &gt; Test JavaScript &lt; /DisplayPage&gt;) .toJSON(); //Assert const menu = receivedPage.content.menu; expect(menu).toMatchInlineSnapshot(` &lt;ul&gt; &lt;li&gt;Home&lt;/li&gt; &lt;li&gt; About &lt;/li&gt; &lt;li&gt; Contact &lt;/li&gt; &lt;/ul&gt; `); });</span></span></code> </pre> <br></div></div><br><h2>  1.9 Vermeiden Sie globale Pr√ºfst√§nde und Anfangsdaten und f√ºgen Sie jedem Test Daten separat hinzu </h2><br>  <b>Was soll ich tun.</b>  Gem√§√ü der goldenen Regel (Kapitel 0) sollte jeder Test einen eigenen Satz von Zeilen in der Datenbank hinzuf√ºgen und bearbeiten, um Bindungen zu vermeiden, und es war f√ºr Benutzer einfacher, den Test zu verstehen.  In der Realit√§t versto√üen Tester h√§ufig gegen diese Regel, bevor sie Tests ausf√ºhren, bei denen die Datenbank mit Anfangsdaten (Seeds) ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">auch als ‚ÄûPr√ºfstand‚Äú bezeichnet</a> ) gef√ºllt wird, um die Produktivit√§t zu steigern.       ,     (.  ¬´ ¬ª),              .                .    ,           ,     (, ). <br><br> <b>  .</b>   ,  ,     ,   ?  , , ,         . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b> .</b>       -        . <br><br><pre> <code class="javascript hljs">before(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">//adding sites and admins data to our DB. Where is the data? outside. At some external json or migration framework await DB.AddSeedDataFromJson('seed.json'); }); it("When updating site name, get successful confirmation", async () =&gt; { //I know that site name "portal" exists - I saw it in the seed files const siteToUpdate = await SiteService.getSiteByName("Portal"); const updateNameResult = await SiteService.changeName(siteToUpdate, "newName"); expect(updateNameResult).to.be(true); }); it("When querying by site name, get the right site", async () =&gt; { //I know that site name "portal" exists - I saw it in the seed files const siteToCheck = await SiteService.getSiteByName("Portal"); expect(siteToCheck.name).to.be.equal("Portal"); //Failure! The previous test change the name :[ });</span></span></code> </pre><br> <b>  .</b>     ,       . <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When updating site name, get successful confirmation"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//test is adding a fresh new records and acting on the records only const siteUnderTest = await SiteService.addSite({ name: "siteForUpdateTest" }); const updateNameResult = await SiteService.changeName(siteUnderTest, "newName"); expect(updateNameResult).to.be(true); });</span></span></code> </pre><br></div></div><br><h2> 1.10   ,    </h2><br> <b> .</b>  ,  -     ,     try-catch-finally  ,      .        ( ),        . <br><br>        Chai: <code>expect(method).to.throw</code> (  Jest: <code>expect(method).toThrow()</code> ).      ,    ,    . ,     ,        . <br><br> <b>  .</b>     (, CI-)   ,    . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b> .</b>   ,     try-catch   . <br><br><pre> <code class="javascript hljs">/it(<span class="hljs-string"><span class="hljs-string">"When no product name, it throws error 400"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>() =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> errorWeExceptFor = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> addNewProduct({<span class="hljs-attr"><span class="hljs-attr">name</span></span>:<span class="hljs-string"><span class="hljs-string">'nest'</span></span>});} <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (error) { expect(error.code).to.equal(<span class="hljs-string"><span class="hljs-string">'InvalidInput'</span></span>); errorWeExceptFor = error; } expect(errorWeExceptFor).not.to.be.null; <span class="hljs-comment"><span class="hljs-comment">//if this assertion fails, the tests results/reports will only show //that some value is null, there won't be a word about a missing Exception });</span></span></code> </pre><br> <b>  .</b>     ,   , ,   QA    . <br><br><pre> <code class="javascript hljs">it.only(<span class="hljs-string"><span class="hljs-string">"When no product name, it throws error 400"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>() =&gt; { expect(addNewProduct)).to.eventually.throw(AppError).with.property(<span class="hljs-string"><span class="hljs-string">'code'</span></span>, <span class="hljs-string"><span class="hljs-string">"InvalidInput"</span></span>); });</code> </pre><br></div></div><br><h2> 1.11    </h2><br> <b> .</b>       : <br><br><ul><li>  smoke-, <br></li><li> IO-less, <br></li><li> ,   ,      , <br></li><li>   ,       pull request',   . <br></li></ul><br>   ,     , , #cold #api #sanity.            . ,     Mocha     : <code>mocha ‚Äî grep 'sanity'</code> . <br><br> <b>  .</b>   ,    ,   ,   ,  ,       ,      ,      . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>   '#cold-test'      (Cold=== ,     -    ,     ). <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//this test is fast (no DB) and we're tagging it correspondingly //now the user/CI can run it frequently describe('Order service', function() { describe('Add new order #cold-test #sanity', function() { it('Scenario - no currency was supplied. Expectation - Use the default currency #sanity', function() { //code logic here }); }); });</span></span></code> </pre> <br></div></div><br><h2> 1.12      </h2><br> <b> .</b>    ,    Node.js       .          ,    Node. <br><br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> TDD</a> .     ,   ,       ,      .         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">--</a> ,       - .   ,      ,      .       ,    .       ,  ,     ,    ,     (,   ..). <br><br> <b>  .</b>   ,    . <br><br><a name="3"></a><h1>  2:   </h1><br><h2> Ô∏è2.1    :        </h2><br> <b> .</b>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a>  10 ,                 .         .   ,      10  (, ,   ),   ,   ,      <i></i>  ?         ? <br><br>    :  2019-  , TDD        , , ,      . ,     ,    , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   </a> .  IoT-,         Kafka  RabbitMQ,     ,       -  .          ,  ,         ?      (, ,  ),      ,      - . <br><br>             (    )    ,        ,    (¬´   API,    ,  !¬ª (consumer-driven contracts)).     ,      : ,    ,  ,     . <br><br> :   TDD      - .    TDD ,     .  ,     . <br><br> <b>  .</b>       ROI,  Fuzz,   ,      10 . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> Cindy Sridharan        'Testing Microservices ‚Äî the sane way' <br><br><img src="https://habrastorage.org/getpro/habr/post_images/375/7ab/6f0/3757ab6f02f3bad93c7235ad2ee0ad95.png"><br><br>  Ein Beispiel: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/-2zP494wdUY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br><h2> 2.2        </h2><br> <b> .</b>       ,     .        ,     .          ,   ,   ?   ‚Äî   .        :      TDD-,     . <br><br>      ¬´¬ª,    API,   ,     (,   ,     in-memory ),      , ,   .     ,  ,      ¬´   ¬ª,        . <br><br> <b>  .</b>         ,   ,       20 %. <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>     Express API   (     ). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/625/d5d/7c1/625d5d7c195e640bacb1b4f50d8a0cdc.png"><br></div></div><br><h2> 2.3 ,       API </h2><br> <b> .</b>     ,        (   ).    - ,  ! ‚Äî    ,       , .  ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">-22</a> ¬ª   :          ,       ,      .           <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   (consumer-driven contracts)   PACT</a> :       , ‚Ä¶ ! PACT           ‚Äî ¬´¬ª,          .   PACT-      ‚Äî    .  ,   API           CI,       . <br><br> <b>  .</b>  ‚Äî       . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/308/385/2ff/3083852ffe6faa62f826bc9c131027d7.png"><br></div></div><br><h2> 2.4     </h2><br> <b> .</b>     ,           Express-.   .   ,         ,        ,  JS- {req,res}.     ,      (,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sinon</a> )    {req,res},  ,     .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.npmjs.com/package/node-mocks-">node-mock-http</a>       {req,res}    . ,   ,    HTTP-,  res- (.  ). <br><br> <b>  .</b>   Express- ===        . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>    ,         Express-. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//the middleware we want to test const unitUnderTest = require('./middleware') const httpMocks = require('node-mocks-http'); //Jest syntax, equivalent to describe() &amp; it() in Mocha test('A request without authentication header, should return http status 403', () =&gt; { const request = httpMocks.createRequest({ method: 'GET', url: '/user/42', headers: { authentication: '' } }); const response = httpMocks.createResponse(); unitUnderTest(request, response); expect(response.statusCode).toBe(403); });</span></span></code> </pre><br></div></div><br><h2> 2.5         </h2><br> <b> .</b>                   .    CI-   ,         .                  (,   ),     (,   ),          .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sonarqube</a> (2600+ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> )  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Code Climate</a> (1500+ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> ). :: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Keith Holliday</a> <br><br> <b>  .</b>            ,            . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>   CodeClimate,    : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c63/a0c/6d2/c63a0c6d207ab1fc67f540db7b2d6259.png"><br></div></div><br><h2> 2.6 ,      Node </h2><br> <b> .</b>   ,         .     (   )   . ,  - ,      ?      ?      ,  API    50 % ?      ,  Netflix   - ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Chaos Engineering</a> ).  :   ,              . ,     Netflix, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">chaos monkey</a> ,    ,  ,     ,     -   (   Kubernetes   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">kube-monkey</a> ,   ).         ,         . , ,   Node-     ,   ,    v8    1,7 ,    UX ,     ?   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">node-chaos</a> (-),        ,   Node. <br><br> <b>  .</b>      ,     production   . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> Node-chaos     ,   Node.js,          . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/39d/46d/fc1/39d46dfc17d7bc4a6d50735681bd1025.png"><br></div></div><br><h2> 2.7       ,        </h2><br> <b> .</b>    ( 0),              ,   ,        .       ,        (seeds) ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   ¬´ ¬ª</a> )   .       ,     (.  ¬´ ¬ª),     ,         .                .    ,           ,     (, ). <br><br> <b>  .</b>   ,  ,     ,   ?  , , ,         . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b> .</b>       -        . <br><br><pre> <code class="javascript hljs">before(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">//adding sites and admins data to our DB. Where is the data? outside. At some external json or migration framework await DB.AddSeedDataFromJson('seed.json'); }); it("When updating site name, get successful confirmation", async () =&gt; { //I know that site name "portal" exists - I saw it in the seed files const siteToUpdate = await SiteService.getSiteByName("Portal"); const updateNameResult = await SiteService.changeName(siteToUpdate, "newName"); expect(updateNameResult).to.be(true); }); it("When querying by site name, get the right site", async () =&gt; { //I know that site name "portal" exists - I saw it in the seed files const siteToCheck = await SiteService.getSiteByName("Portal"); expect(siteToCheck.name).to.be.equal("Portal"); //Failure! The previous test change the name :[ });</span></span></code> </pre><br> <b>  .</b>     ,       . <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When updating site name, get successful confirmation"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//test is adding a fresh new records and acting on the records only const siteUnderTest = await SiteService.addSite({ name: "siteForUpdateTest" }); const updateNameResult = await SiteService.changeName(siteUnderTest, "newName"); expect(updateNameResult).to.be(true); });</span></span></code> </pre><br></div></div><br><a name="4"></a><h1>  3:   </h1><br><h2>  3.1.  UI   </h2><br> <b> .</b>      ,      ,   ,        .        ,         ,      (    HTML  CSS)    . ,                (, , , ),      ,         ,         . <br><br> <b>  .</b>          10 ,     500  (100  = 1 ) - -    . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>    . <br><br><pre> <code class="javascript hljs">test(<span class="hljs-string"><span class="hljs-string">'When users-list is flagged to show only VIP, should display only VIP members'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// Arrange const allUsers = [ { id: 1, name: 'Yoni Goldberg', vip: false }, { id: 2, name: 'John Doe', vip: true } ]; // Act const { getAllByTestId } = render(&lt;UsersList users={allUsers} showOnlyVIP={true}/&gt;); // Assert - Extract the data from the UI first const allRenderedUsers = getAllByTestId('user').map(uiElement =&gt; uiElement.textContent); const allRealVIPUsers = allUsers.filter((user) =&gt; user.vip).map((user) =&gt; user.name); expect(allRenderedUsers).toEqual(allRealVIPUsers); //compare data with data, no UI here });</span></span></code> </pre><br> <b><b> .</b>     UI  .</b> <br><pre> <code class="javascript hljs">test(<span class="hljs-string"><span class="hljs-string">'When flagging to show only VIP, should display only VIP members'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// Arrange const allUsers = [ {id: 1, name: 'Yoni Goldberg', vip: false }, {id: 2, name: 'John Doe', vip: true } ]; // Act const { getAllByTestId } = render(&lt;UsersList users={allUsers} showOnlyVIP={true}/&gt;); // Assert - Mix UI &amp; data in assertion expect(getAllByTestId('user')).toEqual('[&lt;li data-testid="user"&gt;John Doe&lt;/li&gt;]'); });</span></span></code> </pre><br></div></div><br><h2> 3.2  HTML-   ,     </h2><br> <b> .</b>  HTML-   ,     . ,  ,   CSS-.      ,      'test-id-submit-button'.              .   ,    ,           . <br><br> <b>  .</b>     ,    ,   .    ‚Äî , ,  Ajax .   .    ,      CSS  'thick-border'  'thin-border' <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>     ,    . <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// the markup code (part of React component) &lt;b&gt; &lt;Badge pill className="fixed_badge" variant="dark"&gt; &lt;span data-testid="errorsLabel"&gt;{value}&lt;/span&gt; &lt;!-- note the attribute data-testid --&gt; &lt;/Badge&gt; &lt;/b&gt; // this example is using react-testing-library test('Whenever no data is passed to metric, show 0 as default', () =&gt; { // Arrange const metricValue = undefined; // Act const { getByTestId } = render(&lt;dashboardMetric value={undefined}/&gt;); expect(getByTestId('errorsLabel')).text()).toBe("0"); });</span></span></code> </pre><br> <b> .</b>   CSS-. <br><br><pre> <code class="javascript hljs">&lt;!-- the markup code (part <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> React component) --&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"metric"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"d-flex-column"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">{value}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;!-- what <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> the designer changes the classs? --&gt; <span class="hljs-comment"><span class="hljs-comment">// this exammple is using enzyme test('Whenever no data is passed, error metric shows zero', () =&gt; { // ... expect(wrapper.find("[className='d-flex-column']").text()).toBe("0"); });</span></span></code> </pre><br></div></div><br><h2> 3.3           </h2><br> <b> .</b>   ,   ,     .   ,    ,      .   ,     ‚Äî  -       ,       (.  <i>    ¬´ ¬ª</i> ).      (, )     ,     . <br><br>  ,  :        ,      .            (  )     .           ,       . <br><br> <b>  .</b>               ,           .         ? <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>        . <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Calendar</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> defaultProps = {<span class="hljs-attr"><span class="hljs-attr">showFilters</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>} render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;div&gt; A filters panel </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">with</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a button to hide</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/show filters &lt;FiltersPanel showFilter={showFilters} title='Choose Filters'/</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; &lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/div&gt; ) } } /</span></span></span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/Examples use React &amp; Enzyme test('Realistic approach: When clicked to show filters, filters are displayed', () =&gt; { /</span></span></span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/ Arrange const wrapper = mount(&lt;Calendar showFilters={false} /</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;</span></span></span><span class="hljs-function">) // </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Act</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">wrapper</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">find</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'button'</span></span></span></span></span><span class="hljs-function">).</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">simulate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'click'</span></span></span></span></span><span class="hljs-function">); // </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Assert</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">expect</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">wrapper.text(</span></span></span><span class="hljs-function">).</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">includes</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'Choose Filter'</span></span></span></span></span><span class="hljs-function">)); // </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">This</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">is</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">how</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">the</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">user</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">will</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">approach</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">this</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">element</span></span></span><span class="hljs-function">: </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">by</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">text</span></span></span><span class="hljs-function"> })</span></span></code> </pre><br> <b> .</b>      . <br><br><pre> <code class="javascript hljs">test(<span class="hljs-string"><span class="hljs-string">'Shallow/mocked approach: When clicked to show filters, filters are displayed'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// Arrange const wrapper = shallow(&lt;Calendar showFilters={false} title='Choose Filter'/&gt;) // Act wrapper.find('filtersPanel').instance().showFilters(); // Tap into the internals, bypass the UI and invoke a method. White-box approach // Assert expect(wrapper.find('Filter').props()).toEqual({title: 'Choose Filter'}); // what if we change the prop name or don't pass anything relevant? })</span></span></code> </pre><br></div></div><br><h2> 3.4          .     </h2><br> <b> .</b>        (,    ).      (, <code>setTimeOut</code> )     ,   .       (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cypress cy.request('url')</a> ),     API,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> wait(expect(element))  @testing-library/DOM</a> .       ,    API,      ,    .      ,   ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hurry-up the clock</a> .  ‚Äî  ,   ,          (      ).        ,       ,    - npm-   , , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wait-for-expect</a> . <br><br> <b>  .</b>   ,    .          ,      .           . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> E2E API       (Cypress). <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// using Cypress cy.get('#show-products').click()// navigate cy.wait('@products')// wait for route to appear // this line will get executed only when the route is ready</span></span></code> </pre><br> <b>  .  ,  DOM- (@testing-library/dom).</b> <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// @testing-library/dom test('movie title appears', async () =&gt; { // element is initially not present... // wait for appearance await wait(() =&gt; { expect(getByText('the lion king')).toBeInTheDocument() }) // wait for appearance and return the element const movie = await waitForElement(() =&gt; getByText('the lion king')) })</span></span></code> </pre><br> <b> .</b>    . <br><br><pre> <code class="javascript hljs">test(<span class="hljs-string"><span class="hljs-string">'movie title appears'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// element is initially not present... // custom wait logic (caution: simplistic, no timeout) const interval = setInterval(() =&gt; { const found = getByText('the lion king'); if(found){ clearInterval(interval); expect(getByText('the lion king')).toBeInTheDocument(); } }, 100); // wait for appearance and return the element const movie = await waitForElement(() =&gt; getByText('the lion king')) })</span></span></code> </pre><br></div></div><br><h2>  3.5.      </h2><br> <b> .</b>   -   ,        .    ,    ,      .      :    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">pingdom</a> , AWS CloudWatch  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gcp StackDriver</a>    ,  ,          SLA.          ,     ,    (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">lighthouse</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">pagespeed</a> ),   .    ‚Äî ,      :     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   </a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">       (TTI)</a> .  ,      ,   ,     ,  ,   DOM, SSL   .      ,   CI,     247     CDN. <br><br> <b>  .</b>   ,  ,       ,       ,       -    CDN. <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>  Lighthouse   . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/857/732/c2c/857732c2c3976c167757a9da12d81e05.png"><br></div></div><br><h2> 3.6         API  </h2><br> <b> .</b>     ( 2),    ,         ,      (  ).      API    (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sinon</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Test doubles</a> ),    API.         .    API      ,           (         ).      API,     . ,     ,   API  .  ,    :     . <br><br> <b>  .</b>       ,   API   100 ,     20  . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>    API-. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// unit under test export default function ProductsList() { const [products, setProducts] = useState(false) const fetchProducts = async() =&gt; { const products = await axios.get('api/products') setProducts(products); } useEffect(() =&gt; { fetchProducts(); }, []); return products ? &lt;div&gt;{products}&lt;/div&gt; : &lt;div data-testid='no-products-message'&gt;No products&lt;/div&gt; } // test test('When no products exist, show the appropriate message', () =&gt; { // Arrange nock("api") .get(`/products`) .reply(404); // Act const {getByTestId} = render(&lt;ProductsList/&gt;); // Assert expect(getByTestId('no-products-message')).toBeTruthy(); });</span></span></code> </pre><br></div></div><br><h2> 3.7     ,    </h2><br> <b> .</b>  E2E (end-to-end,  )      UI   (.  3.6).       ,    ,  .     ,         ,    -     .  ,   ‚Äî        (,        ),      .   -   ,      ,  UI-  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cypress</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Pupeteer</a> .           ,    :    50 ,    ,       .           10  .   ,         ,    , ‚Äî    .     ,   . <br><br> <b>  .</b> UI        ,     ,      ( ,     UI)    . <br><br><h2> 3.8            </h2><br> <b> .</b>   ,       API   ,     ,           .          (before-all),    -        .   ,       :       .     ,      .  - API-         .      ,          .      (,    ),  ,      ,       .  ,    :      ,       API  (.  3.6). <br><br> <b>  .</b> ,   200  ,     100 ,         20    . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>      (before-all),       (before-each) (,   Cypress). <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   Cypress</a> . <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> authenticationToken; <span class="hljs-comment"><span class="hljs-comment">// happens before ALL tests run before(() =&gt; { cy.request('POST', 'http://localhost:3000/login', { username: Cypress.env('username'), password: Cypress.env('password'), }) .its('body') .then((responseFromLogin) =&gt; { authenticationToken = responseFromLogin.token; }) }) // happens before EACH test beforeEach(setUser =&gt; () { cy.visit('/home', { onBeforeLoad (win) { win.localStorage.setItem('token', JSON.stringify(authenticationToken)) }, }) })</span></span></code> </pre><br></div></div><br><h2> 3.9    smoke-,       </h2><br> <b> .</b>  production-          ,         ,    .    ,       ,       ,    ,     .   smoke-        .         production,  ,    ,       . , smoke-    ,      . <br><br> <b>  .</b>    ,   ,    production  .             /Payment. <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> Smoke-    . <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">'When doing smoke testing over all page, should load them all successfully'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// exemplified using Cypress but can be implemented easily // using any E2E suite cy.visit('https://mysite.com/home'); cy.contains('Home'); cy.contains('https://mysite.com/Login'); cy.contains('Login'); cy.contains('https://mysite.com/About'); cy.contains('About'); })</span></span></code> </pre><br></div></div><br><h2> 3.10        </h2><br> <b> .</b>    ,     .    ¬´¬ª   ,        , ,   ,          . ,        (   )   ,     ,  -,  ,      ,     .      ¬´ ¬ª,         . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   </a>   .       , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cucumber   JavaScript</a> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">StoryBook</a>   UI-    ,           (,      ,        ,  ..)  ,    .      ,           ,   . <br><br> <b>  .</b>     ,        . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>        cucumber-js. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// this is how one can describe tests using cucumber: plain language that allows anyone to understand and collaborate Feature: Twitter new tweet I want to tweet something in Twitter @focus Scenario: Tweeting from the home page Given I open Twitter home Given I click on "New tweet" button Given I type "Hello followers!" in the textbox Given I click on "Submit" button Then I see message "Tweet saved"</span></span></code> </pre><br> <b>  .</b>   Storybook  ,      . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/135/d4c/6c5/135d4c6c5dcf2758cfd90bc20dbad939.png"><br></div></div><br><h2> 3.11        </h2><br> <b> .</b>   ,                 .       ,     .    ,     .            ,     -    .         ,     .      , ,      ,       .   ,        -   .      UI        ¬´ ¬ª.     ,      (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wraith</a> , PhantomCSS),        .   (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Applitools</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Perci.io</a> )          , ,     ¬´ ¬ª (, ),      DOM/CSS,    . <br><br> <b>  .</b>   ,    (   )   ,       ? <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b> .</b>   :  ,   . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b00/b82/ad7/b00b82ad77c637eb6e00742f38780216.png"><br><br> <b>  </b> .  wraith      UI. <br><br><pre> <code class="javascript hljs">‚Äã# Add <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> many domains <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> necessary. Key will act <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> a label‚Äã domains: english: <span class="hljs-string"><span class="hljs-string">"http://www.mysite.com"</span></span>‚Äã ‚Äã# Type screen widths below, here are a couple <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> examples‚Äã screen_widths: - <span class="hljs-number"><span class="hljs-number">600</span></span>‚Äã - <span class="hljs-number"><span class="hljs-number">768</span></span>‚Äã - <span class="hljs-number"><span class="hljs-number">1024</span></span>‚Äã - <span class="hljs-number"><span class="hljs-number">1280</span></span>‚Äã ‚Äã# Type page URL paths below, here are a couple <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> examples‚Äã paths: about: path: <span class="hljs-regexp"><span class="hljs-regexp">/about selector: '.about'‚Äã subscribe: selector: '.subscribe'‚Äã path: /</span></span>subscribe</code> </pre><br></div></div><br><a name="5"></a><h1>  4:    </h1><br><h2> 4.1    (~80 %),      </h2><br> <b> .</b>   ‚Äî   ,   .    ,     .  ‚Äî     (,    ),  .    ? ,  10-30 %      .  100 %  ,                .      . ,   :         Airbus,     ;     ,   50 %   .     ,       ,       80 % ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fowler: ¬´in the upper 80s or 90s¬ª</a> ), ,  ,    . <br><br> :      (CI),     ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Jest</a> )     ,    .       ,   .  ,       (      ) ‚Äî           .  ,  ‚Äî   ,      ,     .       ,    . <br><br> <b>  .</b>       .    ,     ,     .     . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>    .</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d94/db1/8bf/d94db18bf89f833800bf8234c40f095c.png"><br><br> <b>  </b> .       (  Jest). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b97/d73/d8b/b97d73d8b66e627b8fee40d9fa940d7f.png"><br></div></div><br><h2> 4.2    ,        </h2><br> <b> .</b>    ,       .   , , ,   ,     . ,   ,  -     ,   .     <code>PricingCalculator</code>    ,  ,     ,     10 000    ‚Ä¶     ,     ,  .  ,      .   80-     ,    .   :             ,    ,  ,      .      ,    - . <br><br> <b>  .</b>    ,     ,    ,    . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b> .</b>      ?   ,        QA       . :     , -   . ,   -    API  . </div></div><br><br><img src="https://habrastorage.org/getpro/habr/post_images/18e/7d7/2dc/18e7d72dcf5440fe964269002529b69c.png"><br><br><h2> 4.3        </h2><br> <b> .</b>     :       100 %,        .  Wie so?      ,  ,   ,    .       .    -          :    ,    ,   ,       . <br><br>        ,    .        JavaScript- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Stryker</a> : <br><br><ol><li>      ¬´ ¬ª. ,  <code>newOrder.price===0</code>   <code>newOrder.price!=0</code> .  ¬´¬ª  . <br></li><li>    ,     ,    :      ,  .    ,   ,   . <br></li></ol><br>   ,     ,       ,     . <br><br> <b>  .</b>   ,  85-     85 %   . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b> .</b>  100 %,  0 %. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addNewOrder</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newOrder</span></span></span><span class="hljs-function">) </span></span>{ logger.log(<span class="hljs-string"><span class="hljs-string">`Adding new order </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${newOrder}</span></span></span><span class="hljs-string">`</span></span>); DB.save(newOrder); Mailer.sendMail(newOrder.assignee, <span class="hljs-string"><span class="hljs-string">`A new order was places </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${newOrder}</span></span></span><span class="hljs-string">`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">approved</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}; } it(<span class="hljs-string"><span class="hljs-string">"Test addNewOrder, don't use such test names"</span></span>, () =&gt; { addNewOrder({<span class="hljs-attr"><span class="hljs-attr">asignee</span></span>: <span class="hljs-string"><span class="hljs-string">"John@mailer.com"</span></span>,<span class="hljs-attr"><span class="hljs-attr">price</span></span>: <span class="hljs-number"><span class="hljs-number">120</span></span>}); });<span class="hljs-comment"><span class="hljs-comment">//Triggers 100% code coverage, but it doesn't check anything</span></span></code> </pre><br> <b>  .</b> Stryker reports,   ,       (). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/880/047/5ed/8800475ed27d8c632aa2fb7a0372da68.png"><br></div></div><br><h2> 4.4      - </h2><br> <b> .</b>             ESLint.  , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eslint-plugin-mocha</a>  ,       (     <code>describe()</code> ),    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> ,           .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eslint-plugin-jest</a>  ,       (    ). <br><br> <b>  .</b>   90-     ,    ,   ,          . ,          . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b> .</b>    ,  ,   . <br><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">"Too short description"</span></span>, () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> userToken = userService.getDefaultToken() <span class="hljs-comment"><span class="hljs-comment">// *error:no-setup-in-describe, use hooks (sparingly) instead it("Some description", () =&gt; {});//* error: valid-test-description. Must include the word "Should" + at least 5 words }); it.skip("Test name", () =&gt; {// *error:no-skipped-tests, error:error:no-global-tests. Put tests only under describe or suite expect("somevalue"); // error:no-assert }); it("Test name", () =&gt; {*//error:no-identical-title. Assign unique titles to tests });</span></span></code> </pre><br></div></div><br><a name="6"></a><h1>  5: CI     </h1><br><h2> 5.1      ,      </h2><br> <b> .</b>  ‚Äî   .        ,           .  ,        (   !).     ,         .      ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ESLint standard</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> Airbnb</a> ),     . , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eslint-plugin-chai-expect</a>   ,    . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Eslint-plugin-promise</a>     (    ). <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Eslint-plugin-security</a>     ,     DOS-.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eslint-plugin-you-dont-need-lodash-underscore</a>  ,      ,      V8, , <code>Lodash._map(‚Ä¶)</code> . <br><br> <b>  .</b>    ,      ,     .  Was ist los?      ,   ,     .      .          ,    ,      . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b> .</b>   ,        .  , ESLint   production-. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2ec/386/b94/2ec386b943b21f0dee093e6c50e5ae75.png"><br></div></div><br><h1> 5.2            </h1><br> <b> .</b>   CI         , ,    ..?      ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> .  Warum?        : (1)  -&gt; (2)   -&gt; (3) .    ,          ,     . <br><br>             ,       ,   ,         ,   -   . <br><br>  CI- ( , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CircleCI local CLI</a> )     .   ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wallaby</a> ,      (  )    .    npm-  package.json,    ,     (, , , ).       (non-zero exit code)           <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">concurrently</a> .             ‚Äî , <code>npm run quality</code> .             githook ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">husky </a> ). <br><br> <b>  .</b>           ,           . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> Npm-,   ,  ,        . <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">"scripts"</span></span>: { <span class="hljs-string"><span class="hljs-string">"inspect:sanity-testing"</span></span>: <span class="hljs-string"><span class="hljs-string">"mocha **/**--test.js --grep \"sanity\""</span></span>, <span class="hljs-string"><span class="hljs-string">"inspect:lint"</span></span>: <span class="hljs-string"><span class="hljs-string">"eslint ."</span></span>, <span class="hljs-string"><span class="hljs-string">"inspect:vulnerabilities"</span></span>: <span class="hljs-string"><span class="hljs-string">"npm audit"</span></span>, <span class="hljs-string"><span class="hljs-string">"inspect:license"</span></span>: <span class="hljs-string"><span class="hljs-string">"license-checker --failOn GPLv2"</span></span>, <span class="hljs-string"><span class="hljs-string">"inspect:complexity"</span></span>: <span class="hljs-string"><span class="hljs-string">"plato ."</span></span>, <span class="hljs-string"><span class="hljs-string">"inspect:all"</span></span>: <span class="hljs-string"><span class="hljs-string">"concurrently -c \"bgBlue.bold,bgMagenta.bold,yellow\" \"npm:inspect:quick-testing\" \"npm:inspect:lint\" \"npm:inspect:vulnerabilities\" \"npm:inspect:license\""</span></span> }, <span class="hljs-string"><span class="hljs-string">"husky"</span></span>: { <span class="hljs-string"><span class="hljs-string">"hooks"</span></span>: { <span class="hljs-string"><span class="hljs-string">"precommit"</span></span>: <span class="hljs-string"><span class="hljs-string">"npm run inspect:all"</span></span>, <span class="hljs-string"><span class="hljs-string">"prepush"</span></span>: <span class="hljs-string"><span class="hljs-string">"npm run inspect:all"</span></span> } }</code> </pre><br></div></div><br><h2> 5.3     production- </h2><br> <b> .</b>   ‚Äî     CI-.                .   ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Docker-compose</a>           .     (,  )     production-.   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AWS Local</a>      AWS-.     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a>  ,    serverless  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AWS SAM</a>    Faas-. <br><br>   Kubernetes           CI-,        . ,   ¬´ Kubernetes¬ª     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Minikube</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MicroK8s</a> ,    ,     .       ¬´ Kubernetes¬ª:   CI- (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Codefresh</a> )     Kubernetes-,     CI-   ;          . <br><br> <b>  .</b>                    . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b></b> : CI-,     Kubernetes- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">(Dynamic-environments Kubernetes</a> ) <br><br><pre> <code class="javascript hljs">deploy: stage: deploy image: registry.gitlab.com/gitlab-examples/kubernetes-deploy script: - ./configureCluster.sh $KUBE_CA_PEM_FILE $KUBE_URL $KUBE_TOKEN - kubectl create ns $NAMESPACE - kubectl create secret -n $NAMESPACE docker-registry gitlab-registry --docker-server=<span class="hljs-string"><span class="hljs-string">"$CI_REGISTRY"</span></span> --docker-username=<span class="hljs-string"><span class="hljs-string">"$CI_REGISTRY_USER"</span></span> --docker-password=<span class="hljs-string"><span class="hljs-string">"$CI_REGISTRY_PASSWORD"</span></span> --docker-email=<span class="hljs-string"><span class="hljs-string">"$GITLAB_USER_EMAIL"</span></span> - mkdir .generated - echo <span class="hljs-string"><span class="hljs-string">"$CI_BUILD_REF_NAME-$CI_BUILD_REF"</span></span> - sed -e <span class="hljs-string"><span class="hljs-string">"s/TAG/$CI_BUILD_REF_NAME-$CI_BUILD_REF/g"</span></span> templates/deals.yaml | tee <span class="hljs-string"><span class="hljs-string">".generated/deals.yaml"</span></span> - kubectl apply --namespace $NAMESPACE -f .generated/deals.yaml - kubectl apply --namespace $NAMESPACE -f templates/my-sock-shop.yaml environment: name: test-<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>-ci</code> </pre><br></div></div><br><h2> 5.4    </h2><br> <b> .</b>    ,      ,     .  ,     500  ,   ,     .  ,      CI- ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Jest</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AVA</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> Mocha</a> )      ,     .  CI-      (!),       .  ,          CLI   ,    ,        . <br><br> <b>  .</b>      ‚Äî         ,       . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> Mocha parallel  Jest    Mocha    ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">JavaScript Test-Runners Benchmark</a> ) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d87/ff4/d2e/d87ff4d2e1664df527d8a69d4403e8e9.png"><br></div></div><br><h2> 5.5             </h2><br> <b> .</b> ,           .         10 ?       CI-  npm-  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">license check</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">plagiarism check</a> (   ),        ,    ,   Stackoveflow     . <br><br> <b>  .</b>  ,       ,     . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//install license-checker in your CI environment or also locally npm install -g license-checker //ask it to scan all licenses and fail with exit code other than 0 if it found unauthorized license. The CI system should catch this failure and stop the build license-checker --summary --failOn BSD</span></span></code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/09b/b9b/2ad/09bb9b2ad230b17b0006bd137f480606.png"><br></div></div><br><h2> 5.6        </h2><br> <b> .</b>    ,  Express,   .           <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">npm audit</a> ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">snyk</a> (     ).       CI   . <br><br> <b>  .</b>              .   . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>:</b>   NPM Audit <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a89/b1a/ed3/a89b1aed3ab2301c3f4d077e0a259c60.png"><br></div></div><br><h2> 5.7    </h2><br> <b> .</b>  package-lock.json  Yarn  npm    (     ):       .           <code>npm install</code>  <code>npm update</code> ,     .         ,    ‚Äî   .         ,    package.json     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ncu</a> . <br><br>       ,    .   : <br><br><ul><li> CI   ,   ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">npm outdated</a>  npm-check-updates (ncu).     . <br></li><li>    ,      pull request'   . <br></li></ul><br>    :      ?       ,          (          ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  eslint-scope</a> ).       ¬´ ¬ª:        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">latest</a> ,    ,     (,   1.3.1,     ‚Äî 1.3.8). <br><br> <b>  .</b>     ,     . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b></b> :  ,       ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ncu</a>     CI-. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c09/9c2/640/c099c264012f534b4bf8dc8ef83d2f4b.png"><br></div></div><br><h2> 5.8  CI-,    Node </h2><br> <b> .</b>      ,   Node     .         ,    Node. <br><br><ol><li>   .      ,    Jenkins     . <br></li><li>      Docker. <br></li><li>     ,  .     .   smoke-,       (, ,  )       . <br></li><li>  ,       ,    ,   ,   ,    . <br></li><li>        ,      . ,            -.           -  (       ). <br></li><li>        .        . <br></li><li>      ,    ,    . <br></li><li>            (, Docker-). <br></li><li>    ,      .      <code>node_modules</code> . <br></li></ol><br> <b>  .</b>    ,   . <br><br><h2> 5.9  :      CI-,    Node </h2><br> <b> .</b>    ,     ,     .                Node,   CI        . ,      MySQL,    Postgres.  CI-     ¬´¬ª,        MySQl, Postgres    Node.      ,  -   (,        ).   CI,    ,      . <br><br> <b>  .</b>              -   ? <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>:</b>   Travis ( CI)             Node. <br><br><pre> <code class="javascript hljs">language: node_js node_js: - <span class="hljs-string"><span class="hljs-string">"7"</span></span> - <span class="hljs-string"><span class="hljs-string">"6"</span></span> - <span class="hljs-string"><span class="hljs-string">"5"</span></span> - <span class="hljs-string"><span class="hljs-string">"4"</span></span> install: - npm install script: - npm run test</code> </pre> <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de466879/">https://habr.com/ru/post/de466879/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de466863/index.html">Asymptote einrichten</a></li>
<li><a href="../de466865/index.html">Warten auf den ersten November: Verbot oder Legalisierung von Kryptow√§hrungen</a></li>
<li><a href="../de466873/index.html">5 Dinge, die JavaScript am meisten nicht versteht</a></li>
<li><a href="../de466875/index.html">Das traurige Schicksal von Printf-Funktionsformatbezeichnern f√ºr Unicode-Zeichen in Visual C ++</a></li>
<li><a href="../de466877/index.html">Malicious Sustes wurde aktualisiert und verbreitet sich nun √ºber die Sicherheitsl√ºcke von Exim (CVE-2019-10149).</a></li>
<li><a href="../de466881/index.html">Ivan Shamatov: wie man Geld schreibt</a></li>
<li><a href="../de466887/index.html">Nur Teilung oder wie man eine mathematische Theorie erstellt und 400.000 Dollar damit verdient</a></li>
<li><a href="../de466889/index.html">Status der baltischen Domainzone f√ºr August 2019</a></li>
<li><a href="../de466899/index.html">Warum alles fallen lassen und jetzt Swift und Kotlin lernen?</a></li>
<li><a href="../de466903/index.html">Pr√§sentieren Sie immer Ihre Arbeit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>