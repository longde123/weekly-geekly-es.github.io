<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤛🏻 🐚 🤾🏻 Démarrage de SAP GUI à partir d'un navigateur 👃🏽 👩🏽‍🔬 👽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="J'ai d'abord écrit cet article sur mon blog , pour que plus tard je ne regarde plus et ne me souvienne plus, mais comme personne ne lit le blog, je vo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Démarrage de SAP GUI à partir d'un navigateur</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446998/"> <i>J'ai d'abord écrit cet article sur mon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">blog</a> , pour que plus tard je ne regarde plus et ne me souvienne plus, mais comme personne ne lit le blog, je voulais partager cette information avec tout le monde, tout d'un coup je pouvais l'utiliser.</i> <br><br>  Tout en travaillant sur l'idée d'un service de réinitialisation de mot de passe dans les systèmes SAP R / 3, la question s'est posée - comment démarrer l'interface graphique SAP avec les paramètres nécessaires à partir du navigateur?  Étant donné que cette idée impliquait l'utilisation d'un service Web qui répond d'abord à une demande SOAP de l'interface graphique SAP et envoie un e-mail avec un lien vers une page Web avec un script de réinitialisation de mot de passe à l'initial, puis affiche un message à l'utilisateur sur la réinitialisation réussie du mot de passe et affiche ce mot de passe très initial , alors je voudrais que sur cette page il y ait aussi un lien pour lancer SAP GUI.  De plus, pour que ce lien ouvre le système souhaité, et même, de préférence, immédiatement avec les champs de login et de mot de passe renseignés: l'utilisateur n'aurait qu'à renseigner deux fois un mot de passe productif. <br><br>  Le démarrage de SAP Logon n'était pas intéressant pour nous, et lors du démarrage de sapgui.exe, il était impossible de spécifier le client et le nom d'utilisateur, mais il était possible de démarrer le système non défini dans SAP Logon.  D'un autre côté, le démarrage de SAP GUI avec des paramètres de serveur arbitraires n'était pas particulièrement pertinent: si nous résolvons le problème de réinitialisation du mot de passe de l'utilisateur, alors il a probablement déjà la bonne ligne dans SAP Logon, avec les paramètres dont il a besoin et n'a pas à se soucier des siens.  Mais la technologie SAP GUI Shortcut et le programme réel sapshcut.exe, qui permettaient de démarrer SAP GUI à l'aide d'un certain «raccourci», répondaient aux exigences spécifiées. <br><a name="habracut"></a><br>  La solution au problème sur le front: exécuter sapshcut.exe directement à partir du navigateur à l'aide de l'objet ActiveX: <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">openSAPGui</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sid, client, user, password</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shell = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ActiveXObject(<span class="hljs-string"><span class="hljs-string">"WScript.Shell"</span></span>); shell.run(<span class="hljs-string"><span class="hljs-string">'sapshcut.exe -system="'</span></span>+sid+<span class="hljs-string"><span class="hljs-string">'" -client='</span></span>+client+<span class="hljs-string"><span class="hljs-string">' -user="'</span></span>+user+<span class="hljs-string"><span class="hljs-string">'" -pw="'</span></span>+password+<span class="hljs-string"><span class="hljs-string">'" -language=RU'</span></span>); }</code> </pre> <br>  La solution est mauvaise: premièrement, cela ne fonctionne que dans Internet Explorer, et deuxièmement, cela nécessite des paramètres de sécurité appropriés dans le navigateur, ce qui peut être interdit au niveau du domaine dans l'organisation, et même s'il est activé, le navigateur donne à l'utilisateur une fenêtre avec un avertissement effrayant: <br><br><img src="https://habrastorage.org/webt/ta/wg/i0/tawgi0nixqmmuxehbtyeqpmmabw.png"><br><br>  J'ai déterré la solution n ° 2 sur Internet: <a href="">créer mon propre protocole web</a> .  Il vous permet d'exécuter l'application dont nous avons besoin en utilisant le lien indiquant le protocole que nous enregistrons nous-mêmes dans Windows dans le registre de la section HKEY_CLASSES_ROOT.  Étant donné que le raccourci SAP GUI dans cette section a sa propre sous-section, vous pouvez ajouter le paramètre de chaîne de protocole URL avec une valeur vide: <br><br><img src="https://habrastorage.org/webt/cp/gn/rs/cpgnrseqoua-yjn_cuoazf9ili4.png"><br><br>  Ce protocole lance <b>sapgui.exe</b> avec le paramètre <b>/ SHORTCUT</b> , ce dont nous avons besoin: <br><br><img src="https://habrastorage.org/webt/cu/63/th/cu63thnkw3vqtjrokx1xhpckkom.png"><br><br>  Eh bien, ou si nous voulons créer un protocole arbitraire en général (par exemple, <b>sapshcut</b> ), vous pouvez l'enregistrer en utilisant le fichier reg suivant: <br><br> <code>Windows Registry Editor Version 5.00 <br> [HKEY_CLASSES_ROOT\sapshcut] <br> @="sapshcut Handler" <br> "URL Protocol"="" <br> [HKEY_CLASSES_ROOT\sapshcut\DefaultIcon] <br> @="sapshcut.exe" <br> [HKEY_CLASSES_ROOT\sapshcut\shell] <br> [HKEY_CLASSES_ROOT\sapshcut\shell\open] <br> [HKEY_CLASSES_ROOT\sapshcut\shell\open\command] <br> @="sapshcut.exe \"%1\"" <br></code> <br>  Maintenant, si nous faisons un lien sur la page Web indiquant le protocole <b>Sapgui.Shortcut.File de la</b> même manière: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'Sapgui.Shortcut.File: -system=SID -client=200'</span></span></span><span class="hljs-tag">&gt;</span></span>SID200<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  nous devrions voir une fenêtre comme: <br><br><img src="https://habrastorage.org/webt/cc/xn/d6/ccxnd6jigmmqx7ydiaiei0qeh18.png"><br><br>  Et tout semble aller bien, mais lorsque vous cliquez sur le bouton "Autoriser", nous voyons: <br><br><img src="https://habrastorage.org/webt/3a/lm/hc/3almhctej9kj3haxogtmrajza-i.png"><br><br>  Oups, le navigateur a transformé l'espace en% 20.  Eh bien, d'autres caractères seront également encodés dans leur code numérique avec un symbole de pourcentage.  Et le plus désagréable est que rien ne peut être fait ici au niveau du navigateur (tout est fait selon la norme) - le navigateur n'aime pas ces caractères et le shell Windows ne fonctionne pas avec de telles valeurs codées.  Et encore un moins - la chaîne entière est passée en paramètre, y compris le nom du protocole et même les deux points ( <i>sapgui.shortcut.file :)</i> .  De plus, bien que le même <b>sapshcut.exe</b> puisse éliminer tout ce qui n'est pas un paramètre pour lui (il commence par le symbole «-», puis le nom, «=» et la valeur), c'est-à-dire  une ligne de la forme " <i>sapgui.shortcut.file: -system = SID</i> " continue de rouler, puis sans espace " <i>sapgui.shortcut.file: -system = SID</i> " ne fonctionne plus. <br><br>  Il s'avère que, en principe, il existe deux options pour utiliser le protocole URI: <br><br><ol><li>  Utilisation sans paramètres: nous créons tout un tas de protocoles pour tous nos systèmes de type <i>SIDMANDT</i> , tels que <i>AAA200</i> , <i>BBB200</i> , etc.  Si vous avez juste besoin de démarrer le système souhaité, l'option fonctionne tout à fait, mais dans notre cas, cela ne fonctionne pas, car au moins vous souhaitez également transférer la connexion de l'utilisateur, mais vous ne pouvez pas le faire de cette façon. <br></li><li>  Utilisation d'un wrapper pour appeler <b>sapshcut.exe</b> ou <b>sapgui.exe</b> .  L'essence de ce programme est simple - il doit prendre la ligne que le navigateur lui transmettra via le protocole Web et le transformer en la représentation que Windows accepte, c'est-à-dire  retour transforme tous les codes de caractères en caractères (peut-être même analyse la chaîne par paramètres) et appelle déjà l'interface graphique SAP garantie par la commande correcte.  Dans notre cas, cela ne convient pas non plus (donc je ne l'ai même pas écrit), car il ne nous suffit pas d'ajouter un protocole sur tous les PC des utilisateurs (dans le domaine, cela ne va toujours nulle part, même s'il vaut mieux éviter cette pratique), mais ici il faudra en plus placez le programme sur un PC, et même surveillez-le constamment afin qu'il ne disparaisse pas lors de la réinstallation du logiciel sur un PC. <br></li></ol><br>  C'est-à-dire  cette option est également rejetée car elle ne nous convient pas. <br><br>  Ensuite, j'ai commencé à penser que je devrais dire au revoir à l'idée de démarrer l'interface graphique SAP avec les paramètres nécessaires à partir du navigateur, mais j'ai eu l'idée que vous pouvez créer un raccourci dans SAP Logon et le copier sur le bureau.  J'ai utilisé cette méthode une fois, mais avant cela, je n'avais pas examiné spécifiquement le fichier de raccourci.  Et il s'est avéré que ce raccourci est un fichier texte brut avec l'extension <b>.sap</b> .  Et si vous l'exécutez sous Windows, l'interface graphique SAP démarre avec les paramètres spécifiés dans ce fichier.  "Bingo!" <br><br>  Le format de ce fichier est approximativement le suivant (il se peut qu'une transaction soit toujours lancée au démarrage, mais je l'ai omise): <br><br> <code>[System] <br> Name=SID <br> Client=200 <br> [User] <br> Name= <br> Language=RU <br> Password= <br> [Function] <br> Title= <br> [Configuration] <br> GuiSize=Maximized <br> [Options] <br> Reuse=0 <br></code> <br>  Il semble que ce soit tout ce qui est nécessaire: un identifiant système, un client, un nom d'utilisateur et même un mot de passe.  Et même des paramètres supplémentaires: <i>Titre</i> - le titre de la fenêtre, <i>GuiSize</i> - la taille de la fenêtre lancée (plein écran ou non) et <i>Réutiliser</i> - que ce soit pour ouvrir une nouvelle fenêtre ou utiliser une fenêtre déjà ouverte avec le même système.  Mais immédiatement une nuance est sortie - il s'est avéré qu'il était impossible de définir un mot de passe dans SAP Logon, la ligne a été bloquée.  Il s'est avéré que cela a été fait pour des raisons de sécurité: il stocke tous les raccourcis créés dans SAP Logon dans le fichier <b>sapshortcut.ini</b> (à côté de <b>saplogon.ini</b> dans le profil utilisateur Windows) et bien qu'ils y soient cryptés, ils peuvent être trop cryptés et si vous le souhaitez. décoder.  Mais vous pouvez également résoudre ce problème en modifiant la valeur d'un paramètre dans le Registre (la valeur par défaut est <b>0</b> ): <br><br> <code>Windows Registry Editor Version 5.00 <br> [HKEY_CURRENT_USER\Software\SAP\SAPShortcut\Security] <br> "EnablePassword"="1" <br></code> <br>  Cela déverrouille le champ Mot de passe du formulaire de raccourci dans SAP Logon pour entrer: <br><br><img src="https://habrastorage.org/webt/bo/p1/jf/bop1jfux8jdbqbkdedhzsodor9s.png"><br><br>  Et lors de la saisie d'un mot de passe dans ce champ, il sera placé dans la ligne correspondante <br>  <b>sapshortcut.ini</b> , mais lorsque vous faites glisser un raccourci vers le bureau, il n'y apparaît pas - mais vous pouvez l'ajouter manuellement.  Le mot de passe est crypté, pour 111111 il sera de la forme suivante: PW_49B02219D1F6, pour 222222 - PW_4AB3211AD2F5.  Mais nous sommes plus intéressés par le fait que ce mot de passe est crypté d'une manière indépendante du PC spécifique, et si nous réinitialisons le mot de passe au mot de passe initial, nous pouvons utiliser une valeur précédemment connue dans ce champ.  Eh bien, si nous voulons utiliser un mot de passe généré aléatoirement, nous devrons comprendre l'algorithme de ce chiffre.  Mais à en juger par les exemples ci-dessus, cela ne sera pas difficile.  Soit dit en passant, dans SAP GUI 7.40, ce champ a généralement disparu du formulaire, mais il perçoit correctement le fichier avec le mot de passe rempli. <br><br>  Autrement dit, il s'avère que dans le navigateur, il suffit de cliquer sur le lien vers le fichier avec l'extension .sap et avec le format souhaité - et il proposera de l'ouvrir en tant que fichier de type SAP GUI Shortcut (naturellement sur un PC avec SAP GUI installé) et ouvrira la fenêtre SAP GUI avec le spécifié (si le SID et la paire de clients figurent dans la liste de connexion SAP sur ce PC). <br><br>  Mais il est clair que personne ne créera et ne stockera des fichiers sur le site simplement au préalable - ils doivent être générés en fonction des paramètres nécessaires.  Par exemple, vous pouvez créer un script en PHP pour générer des raccourcis ( <b>sapshcut.php</b> ): <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $queries = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); parse_str($_SERVER[<span class="hljs-string"><span class="hljs-string">'QUERY_STRING'</span></span>], $queries); $Title = $queries[<span class="hljs-string"><span class="hljs-string">'Title'</span></span>]; $Size = $queries[<span class="hljs-string"><span class="hljs-string">'Size'</span></span>]; $SID = $queries[<span class="hljs-string"><span class="hljs-string">'SID'</span></span>]; $Client = $queries[<span class="hljs-string"><span class="hljs-string">'Client'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Client == <span class="hljs-string"><span class="hljs-string">''</span></span>) { $Client=<span class="hljs-number"><span class="hljs-number">200</span></span>; }; $Lang = $queries[<span class="hljs-string"><span class="hljs-string">'Language'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Lang==<span class="hljs-string"><span class="hljs-string">''</span></span>) { $Lang = <span class="hljs-string"><span class="hljs-string">'RU'</span></span>; }; $User = $queries[<span class="hljs-string"><span class="hljs-string">'Username'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($User&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) { $Password = $queries[<span class="hljs-string"><span class="hljs-string">'Password'</span></span>]; }; $filename = $SID.$Client.<span class="hljs-string"><span class="hljs-string">'.sap'</span></span>; header(<span class="hljs-string"><span class="hljs-string">'Content-disposition: attachment; filename='</span></span>.$filename); header(<span class="hljs-string"><span class="hljs-string">'Content-type: application/sap'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[System]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Name="</span></span>.$SID.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Client="</span></span>.$Client.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[User]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Name="</span></span>.$Username.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Language="</span></span>.$Lang.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Password&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Password="</span></span>.$Password.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[Function]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Title&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) {<span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Title="</span></span>.$Title.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Title=  \r\n"</span></span>;}; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[Configuration]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Size==<span class="hljs-string"><span class="hljs-string">'max'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"GuiSize=Maximized\r\n"</span></span>; }; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[Options]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Reuse=0\r\n"</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  Si vous ne spécifiez pas de nom d'utilisateur et de mot de passe, nous obtenons la fenêtre suivante à partir des invites de connexion et de mot de passe: <br><br><img src="https://habrastorage.org/webt/4v/tz/_-/4vtz_-d9nva1ivhohfdtrxlfv7q.png"><br><br>  Si vous transférez uniquement la connexion, le champ de connexion sera rempli et le champ de mot de passe est vide.  Si nous donnons à l'utilisateur à la fois le nom d'utilisateur et le mot de passe, mais que la clé EnablePassword de l'utilisateur dans la section [HKEY_CURRENT_USER \ Software \ SAP \ SAPShortcut \ Security] est définie sur 0 sur le PC de l'utilisateur, nous obtiendrons la même chose.  Et seulement si cette clé est définie sur 1 et que nous transférons à la fois le nom et le mot de passe initial, le système vous demandera immédiatement d'entrer deux fois le nouveau mot de passe permanent.  Ce qui était nécessaire pour recevoir. <br><br>  Par conséquent, nous avons l'ensemble d'options suivant considéré comme une illustration de tout ce qui précède: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="actionscript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="actionscript"><span class="hljs-function"><span class="hljs-title">openSAPGui</span></span></span></span><span class="hljs-params"><span class="actionscript"><span class="hljs-function"><span class="hljs-params">(sid, client, user, password)</span></span></span></span><span class="actionscript"><span class="hljs-function"> </span></span></span><span class="actionscript">{ </span><span class="hljs-keyword"><span class="actionscript"><span class="hljs-keyword">var</span></span></span><span class="actionscript"> shell = </span><span class="hljs-keyword"><span class="actionscript"><span class="hljs-keyword">new</span></span></span><span class="actionscript"> ActiveXObject(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"WScript.Shell"</span></span></span><span class="actionscript">); shell.run(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'sapshcut.exe -system="'</span></span></span><span class="actionscript">+sid+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'" -client='</span></span></span><span class="actionscript">+client+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">' -user="'</span></span></span><span class="actionscript">+user+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'" -pw="'</span></span></span><span class="actionscript">+password+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'" -language=RU'</span></span></span><span class="actionscript">); } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">''</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript:openSAPGui('SID', '200', 'test', '');"</span></span></span><span class="hljs-tag">/&gt;</span></span>Example 1: Execute sapshcut.exe (ActiveX)<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'Sapgui.Shortcut.File: -system=SID -client=200'</span></span></span><span class="hljs-tag">&gt;</span></span>Example 2: Open sapshcut.exe (URI)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'sapshcut.php?SID=SID&amp;Client=200&amp;User=test'</span></span></span><span class="hljs-tag">&gt;</span></span>Example 3: Open file .sap (SAP GUI Shortcut)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  La dernière option m'est venue.  Mais vous pouvez également utiliser, par exemple, la génération de fichiers CMD au lieu de générer des raccourcis SAP qui, lorsqu'ils sont ouverts à partir d'un navigateur, ouvriront également la fenêtre SAP GUI.  Voici un exemple ( <b>sapguicmd.php</b> ) de démarrage direct de l'interface graphique SAP avec la chaîne de connexion complète, sans avoir à configurer SAP Logon: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $queries = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); parse_str($_SERVER[<span class="hljs-string"><span class="hljs-string">'QUERY_STRING'</span></span>], $queries); $Title = $queries[<span class="hljs-string"><span class="hljs-string">'Title'</span></span>]; $ROUTER = $queries[<span class="hljs-string"><span class="hljs-string">'ROUTER'</span></span>]; $ROUTERPORT = $queries[<span class="hljs-string"><span class="hljs-string">'ROUTERPORT'</span></span>]; $HOST = $queries[<span class="hljs-string"><span class="hljs-string">'HOST'</span></span>]; $PORT = $queries[<span class="hljs-string"><span class="hljs-string">'PORT'</span></span>]; $MESS = $queries[<span class="hljs-string"><span class="hljs-string">'MESS'</span></span>]; $LG = $queries[<span class="hljs-string"><span class="hljs-string">'LG'</span></span>]; $filename = <span class="hljs-string"><span class="hljs-string">'SAPGUI_'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($MESS&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) $filename = $filename.$MESS; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($HOST&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) $filename = $filename.$HOST; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($PORT&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) $filename = $filename.<span class="hljs-string"><span class="hljs-string">'_'</span></span>.$PORT; $filename = $filename.<span class="hljs-string"><span class="hljs-string">'.cmd'</span></span>; header(<span class="hljs-string"><span class="hljs-string">'Content-disposition: attachment; filename='</span></span>.$filename); header(<span class="hljs-string"><span class="hljs-string">'Content-type: application/cmd'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"@echo off\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"chcp 1251\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"echo   "</span></span>.$Title.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"set SAP_CODEPAGE=1504\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'if exist "%ProgramFiles(x86)%\SAP\FrontEnd\SapGui\sapgui.exe" set gui=%ProgramFiles(x86)%\SAP\FrontEnd\SapGui\sapgui.exe'</span></span>.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'if exist "%ProgramFiles%\SAP\FrontEnd\SapGui\sapgui.exe" set gui=%ProgramFiles%\SAP\FrontEnd\SapGui\sapgui.exe'</span></span>.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"set logon="</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($ROUTER&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/H/"</span></span>.$ROUTER; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($ROUTERPORT&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/S/"</span></span>.$ROUTERPORT; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($MESS&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/M/"</span></span>.$MESS; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($HOST&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/H/"</span></span>.$HOST; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($PORT&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/S/"</span></span>.$PORT; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($LG&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/G/"</span></span>.$LG; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'"%gui%" %logon%'</span></span>.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr446998/">https://habr.com/ru/post/fr446998/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr446988/index.html">Comment j'ai enseigné Scala</a></li>
<li><a href="../fr446990/index.html">Délai d'entrée sur les consoles et émulateurs rétro</a></li>
<li><a href="../fr446992/index.html">John Maeda: «En fait, le design n'est pas si important»</a></li>
<li><a href="../fr446994/index.html">L'espace comme un vague souvenir</a></li>
<li><a href="../fr446996/index.html">La méthode Pomodoro n'est pas aussi cool qu'elle pourrait l'être</a></li>
<li><a href="../fr447000/index.html">Guerres du format audio: 10 matériaux sur supports numériques et analogiques</a></li>
<li><a href="../fr447002/index.html">Visite de coworking photo du Cabinet Lounge</a></li>
<li><a href="../fr447004/index.html">Chien de garde universel sur ATtiny13</a></li>
<li><a href="../fr447006/index.html">Guide: comment créer un bot simple pour JS Telegram pour un débutant en programmation</a></li>
<li><a href="../fr447008/index.html">Comment prendre le contrôle de votre infrastructure réseau. Table des matières</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>