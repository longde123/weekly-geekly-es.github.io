<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§õüèª üêö ü§æüèª D√©marrage de SAP GUI √† partir d'un navigateur üëÉüèΩ üë©üèΩ‚Äçüî¨ üëΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="J'ai d'abord √©crit cet article sur mon blog , pour que plus tard je ne regarde plus et ne me souvienne plus, mais comme personne ne lit le blog, je vo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>D√©marrage de SAP GUI √† partir d'un navigateur</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446998/"> <i>J'ai d'abord √©crit cet article sur mon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">blog</a> , pour que plus tard je ne regarde plus et ne me souvienne plus, mais comme personne ne lit le blog, je voulais partager cette information avec tout le monde, tout d'un coup je pouvais l'utiliser.</i> <br><br>  Tout en travaillant sur l'id√©e d'un service de r√©initialisation de mot de passe dans les syst√®mes SAP R / 3, la question s'est pos√©e - comment d√©marrer l'interface graphique SAP avec les param√®tres n√©cessaires √† partir du navigateur?  √âtant donn√© que cette id√©e impliquait l'utilisation d'un service Web qui r√©pond d'abord √† une demande SOAP de l'interface graphique SAP et envoie un e-mail avec un lien vers une page Web avec un script de r√©initialisation de mot de passe √† l'initial, puis affiche un message √† l'utilisateur sur la r√©initialisation r√©ussie du mot de passe et affiche ce mot de passe tr√®s initial , alors je voudrais que sur cette page il y ait aussi un lien pour lancer SAP GUI.  De plus, pour que ce lien ouvre le syst√®me souhait√©, et m√™me, de pr√©f√©rence, imm√©diatement avec les champs de login et de mot de passe renseign√©s: l'utilisateur n'aurait qu'√† renseigner deux fois un mot de passe productif. <br><br>  Le d√©marrage de SAP Logon n'√©tait pas int√©ressant pour nous, et lors du d√©marrage de sapgui.exe, il √©tait impossible de sp√©cifier le client et le nom d'utilisateur, mais il √©tait possible de d√©marrer le syst√®me non d√©fini dans SAP Logon.  D'un autre c√¥t√©, le d√©marrage de SAP GUI avec des param√®tres de serveur arbitraires n'√©tait pas particuli√®rement pertinent: si nous r√©solvons le probl√®me de r√©initialisation du mot de passe de l'utilisateur, alors il a probablement d√©j√† la bonne ligne dans SAP Logon, avec les param√®tres dont il a besoin et n'a pas √† se soucier des siens.  Mais la technologie SAP GUI Shortcut et le programme r√©el sapshcut.exe, qui permettaient de d√©marrer SAP GUI √† l'aide d'un certain ¬´raccourci¬ª, r√©pondaient aux exigences sp√©cifi√©es. <br><a name="habracut"></a><br>  La solution au probl√®me sur le front: ex√©cuter sapshcut.exe directement √† partir du navigateur √† l'aide de l'objet ActiveX: <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">openSAPGui</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sid, client, user, password</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shell = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ActiveXObject(<span class="hljs-string"><span class="hljs-string">"WScript.Shell"</span></span>); shell.run(<span class="hljs-string"><span class="hljs-string">'sapshcut.exe -system="'</span></span>+sid+<span class="hljs-string"><span class="hljs-string">'" -client='</span></span>+client+<span class="hljs-string"><span class="hljs-string">' -user="'</span></span>+user+<span class="hljs-string"><span class="hljs-string">'" -pw="'</span></span>+password+<span class="hljs-string"><span class="hljs-string">'" -language=RU'</span></span>); }</code> </pre> <br>  La solution est mauvaise: premi√®rement, cela ne fonctionne que dans Internet Explorer, et deuxi√®mement, cela n√©cessite des param√®tres de s√©curit√© appropri√©s dans le navigateur, ce qui peut √™tre interdit au niveau du domaine dans l'organisation, et m√™me s'il est activ√©, le navigateur donne √† l'utilisateur une fen√™tre avec un avertissement effrayant: <br><br><img src="https://habrastorage.org/webt/ta/wg/i0/tawgi0nixqmmuxehbtyeqpmmabw.png"><br><br>  J'ai d√©terr√© la solution n ¬∞ 2 sur Internet: <a href="">cr√©er mon propre protocole web</a> .  Il vous permet d'ex√©cuter l'application dont nous avons besoin en utilisant le lien indiquant le protocole que nous enregistrons nous-m√™mes dans Windows dans le registre de la section HKEY_CLASSES_ROOT.  √âtant donn√© que le raccourci SAP GUI dans cette section a sa propre sous-section, vous pouvez ajouter le param√®tre de cha√Æne de protocole URL avec une valeur vide: <br><br><img src="https://habrastorage.org/webt/cp/gn/rs/cpgnrseqoua-yjn_cuoazf9ili4.png"><br><br>  Ce protocole lance <b>sapgui.exe</b> avec le param√®tre <b>/ SHORTCUT</b> , ce dont nous avons besoin: <br><br><img src="https://habrastorage.org/webt/cu/63/th/cu63thnkw3vqtjrokx1xhpckkom.png"><br><br>  Eh bien, ou si nous voulons cr√©er un protocole arbitraire en g√©n√©ral (par exemple, <b>sapshcut</b> ), vous pouvez l'enregistrer en utilisant le fichier reg suivant: <br><br> <code>Windows Registry Editor Version 5.00 <br> [HKEY_CLASSES_ROOT\sapshcut] <br> @="sapshcut Handler" <br> "URL Protocol"="" <br> [HKEY_CLASSES_ROOT\sapshcut\DefaultIcon] <br> @="sapshcut.exe" <br> [HKEY_CLASSES_ROOT\sapshcut\shell] <br> [HKEY_CLASSES_ROOT\sapshcut\shell\open] <br> [HKEY_CLASSES_ROOT\sapshcut\shell\open\command] <br> @="sapshcut.exe \"%1\"" <br></code> <br>  Maintenant, si nous faisons un lien sur la page Web indiquant le protocole <b>Sapgui.Shortcut.File de la</b> m√™me mani√®re: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'Sapgui.Shortcut.File: -system=SID -client=200'</span></span></span><span class="hljs-tag">&gt;</span></span>SID200<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  nous devrions voir une fen√™tre comme: <br><br><img src="https://habrastorage.org/webt/cc/xn/d6/ccxnd6jigmmqx7ydiaiei0qeh18.png"><br><br>  Et tout semble aller bien, mais lorsque vous cliquez sur le bouton "Autoriser", nous voyons: <br><br><img src="https://habrastorage.org/webt/3a/lm/hc/3almhctej9kj3haxogtmrajza-i.png"><br><br>  Oups, le navigateur a transform√© l'espace en% 20.  Eh bien, d'autres caract√®res seront √©galement encod√©s dans leur code num√©rique avec un symbole de pourcentage.  Et le plus d√©sagr√©able est que rien ne peut √™tre fait ici au niveau du navigateur (tout est fait selon la norme) - le navigateur n'aime pas ces caract√®res et le shell Windows ne fonctionne pas avec de telles valeurs cod√©es.  Et encore un moins - la cha√Æne enti√®re est pass√©e en param√®tre, y compris le nom du protocole et m√™me les deux points ( <i>sapgui.shortcut.file :)</i> .  De plus, bien que le m√™me <b>sapshcut.exe</b> puisse √©liminer tout ce qui n'est pas un param√®tre pour lui (il commence par le symbole ¬´-¬ª, puis le nom, ¬´=¬ª et la valeur), c'est-√†-dire  une ligne de la forme " <i>sapgui.shortcut.file: -system = SID</i> " continue de rouler, puis sans espace " <i>sapgui.shortcut.file: -system = SID</i> " ne fonctionne plus. <br><br>  Il s'av√®re que, en principe, il existe deux options pour utiliser le protocole URI: <br><br><ol><li>  Utilisation sans param√®tres: nous cr√©ons tout un tas de protocoles pour tous nos syst√®mes de type <i>SIDMANDT</i> , tels que <i>AAA200</i> , <i>BBB200</i> , etc.  Si vous avez juste besoin de d√©marrer le syst√®me souhait√©, l'option fonctionne tout √† fait, mais dans notre cas, cela ne fonctionne pas, car au moins vous souhaitez √©galement transf√©rer la connexion de l'utilisateur, mais vous ne pouvez pas le faire de cette fa√ßon. <br></li><li>  Utilisation d'un wrapper pour appeler <b>sapshcut.exe</b> ou <b>sapgui.exe</b> .  L'essence de ce programme est simple - il doit prendre la ligne que le navigateur lui transmettra via le protocole Web et le transformer en la repr√©sentation que Windows accepte, c'est-√†-dire  retour transforme tous les codes de caract√®res en caract√®res (peut-√™tre m√™me analyse la cha√Æne par param√®tres) et appelle d√©j√† l'interface graphique SAP garantie par la commande correcte.  Dans notre cas, cela ne convient pas non plus (donc je ne l'ai m√™me pas √©crit), car il ne nous suffit pas d'ajouter un protocole sur tous les PC des utilisateurs (dans le domaine, cela ne va toujours nulle part, m√™me s'il vaut mieux √©viter cette pratique), mais ici il faudra en plus placez le programme sur un PC, et m√™me surveillez-le constamment afin qu'il ne disparaisse pas lors de la r√©installation du logiciel sur un PC. <br></li></ol><br>  C'est-√†-dire  cette option est √©galement rejet√©e car elle ne nous convient pas. <br><br>  Ensuite, j'ai commenc√© √† penser que je devrais dire au revoir √† l'id√©e de d√©marrer l'interface graphique SAP avec les param√®tres n√©cessaires √† partir du navigateur, mais j'ai eu l'id√©e que vous pouvez cr√©er un raccourci dans SAP Logon et le copier sur le bureau.  J'ai utilis√© cette m√©thode une fois, mais avant cela, je n'avais pas examin√© sp√©cifiquement le fichier de raccourci.  Et il s'est av√©r√© que ce raccourci est un fichier texte brut avec l'extension <b>.sap</b> .  Et si vous l'ex√©cutez sous Windows, l'interface graphique SAP d√©marre avec les param√®tres sp√©cifi√©s dans ce fichier.  "Bingo!" <br><br>  Le format de ce fichier est approximativement le suivant (il se peut qu'une transaction soit toujours lanc√©e au d√©marrage, mais je l'ai omise): <br><br> <code>[System] <br> Name=SID <br> Client=200 <br> [User] <br> Name= <br> Language=RU <br> Password= <br> [Function] <br> Title= <br> [Configuration] <br> GuiSize=Maximized <br> [Options] <br> Reuse=0 <br></code> <br>  Il semble que ce soit tout ce qui est n√©cessaire: un identifiant syst√®me, un client, un nom d'utilisateur et m√™me un mot de passe.  Et m√™me des param√®tres suppl√©mentaires: <i>Titre</i> - le titre de la fen√™tre, <i>GuiSize</i> - la taille de la fen√™tre lanc√©e (plein √©cran ou non) et <i>R√©utiliser</i> - que ce soit pour ouvrir une nouvelle fen√™tre ou utiliser une fen√™tre d√©j√† ouverte avec le m√™me syst√®me.  Mais imm√©diatement une nuance est sortie - il s'est av√©r√© qu'il √©tait impossible de d√©finir un mot de passe dans SAP Logon, la ligne a √©t√© bloqu√©e.  Il s'est av√©r√© que cela a √©t√© fait pour des raisons de s√©curit√©: il stocke tous les raccourcis cr√©√©s dans SAP Logon dans le fichier <b>sapshortcut.ini</b> (√† c√¥t√© de <b>saplogon.ini</b> dans le profil utilisateur Windows) et bien qu'ils y soient crypt√©s, ils peuvent √™tre trop crypt√©s et si vous le souhaitez. d√©coder.  Mais vous pouvez √©galement r√©soudre ce probl√®me en modifiant la valeur d'un param√®tre dans le Registre (la valeur par d√©faut est <b>0</b> ): <br><br> <code>Windows Registry Editor Version 5.00 <br> [HKEY_CURRENT_USER\Software\SAP\SAPShortcut\Security] <br> "EnablePassword"="1" <br></code> <br>  Cela d√©verrouille le champ Mot de passe du formulaire de raccourci dans SAP Logon pour entrer: <br><br><img src="https://habrastorage.org/webt/bo/p1/jf/bop1jfux8jdbqbkdedhzsodor9s.png"><br><br>  Et lors de la saisie d'un mot de passe dans ce champ, il sera plac√© dans la ligne correspondante <br>  <b>sapshortcut.ini</b> , mais lorsque vous faites glisser un raccourci vers le bureau, il n'y appara√Æt pas - mais vous pouvez l'ajouter manuellement.  Le mot de passe est crypt√©, pour 111111 il sera de la forme suivante: PW_49B02219D1F6, pour 222222 - PW_4AB3211AD2F5.  Mais nous sommes plus int√©ress√©s par le fait que ce mot de passe est crypt√© d'une mani√®re ind√©pendante du PC sp√©cifique, et si nous r√©initialisons le mot de passe au mot de passe initial, nous pouvons utiliser une valeur pr√©c√©demment connue dans ce champ.  Eh bien, si nous voulons utiliser un mot de passe g√©n√©r√© al√©atoirement, nous devrons comprendre l'algorithme de ce chiffre.  Mais √† en juger par les exemples ci-dessus, cela ne sera pas difficile.  Soit dit en passant, dans SAP GUI 7.40, ce champ a g√©n√©ralement disparu du formulaire, mais il per√ßoit correctement le fichier avec le mot de passe rempli. <br><br>  Autrement dit, il s'av√®re que dans le navigateur, il suffit de cliquer sur le lien vers le fichier avec l'extension .sap et avec le format souhait√© - et il proposera de l'ouvrir en tant que fichier de type SAP GUI Shortcut (naturellement sur un PC avec SAP GUI install√©) et ouvrira la fen√™tre SAP GUI avec le sp√©cifi√© (si le SID et la paire de clients figurent dans la liste de connexion SAP sur ce PC). <br><br>  Mais il est clair que personne ne cr√©era et ne stockera des fichiers sur le site simplement au pr√©alable - ils doivent √™tre g√©n√©r√©s en fonction des param√®tres n√©cessaires.  Par exemple, vous pouvez cr√©er un script en PHP pour g√©n√©rer des raccourcis ( <b>sapshcut.php</b> ): <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $queries = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); parse_str($_SERVER[<span class="hljs-string"><span class="hljs-string">'QUERY_STRING'</span></span>], $queries); $Title = $queries[<span class="hljs-string"><span class="hljs-string">'Title'</span></span>]; $Size = $queries[<span class="hljs-string"><span class="hljs-string">'Size'</span></span>]; $SID = $queries[<span class="hljs-string"><span class="hljs-string">'SID'</span></span>]; $Client = $queries[<span class="hljs-string"><span class="hljs-string">'Client'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Client == <span class="hljs-string"><span class="hljs-string">''</span></span>) { $Client=<span class="hljs-number"><span class="hljs-number">200</span></span>; }; $Lang = $queries[<span class="hljs-string"><span class="hljs-string">'Language'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Lang==<span class="hljs-string"><span class="hljs-string">''</span></span>) { $Lang = <span class="hljs-string"><span class="hljs-string">'RU'</span></span>; }; $User = $queries[<span class="hljs-string"><span class="hljs-string">'Username'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($User&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) { $Password = $queries[<span class="hljs-string"><span class="hljs-string">'Password'</span></span>]; }; $filename = $SID.$Client.<span class="hljs-string"><span class="hljs-string">'.sap'</span></span>; header(<span class="hljs-string"><span class="hljs-string">'Content-disposition: attachment; filename='</span></span>.$filename); header(<span class="hljs-string"><span class="hljs-string">'Content-type: application/sap'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[System]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Name="</span></span>.$SID.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Client="</span></span>.$Client.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[User]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Name="</span></span>.$Username.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Language="</span></span>.$Lang.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Password&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Password="</span></span>.$Password.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[Function]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Title&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) {<span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Title="</span></span>.$Title.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Title=  \r\n"</span></span>;}; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[Configuration]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Size==<span class="hljs-string"><span class="hljs-string">'max'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"GuiSize=Maximized\r\n"</span></span>; }; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[Options]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Reuse=0\r\n"</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  Si vous ne sp√©cifiez pas de nom d'utilisateur et de mot de passe, nous obtenons la fen√™tre suivante √† partir des invites de connexion et de mot de passe: <br><br><img src="https://habrastorage.org/webt/4v/tz/_-/4vtz_-d9nva1ivhohfdtrxlfv7q.png"><br><br>  Si vous transf√©rez uniquement la connexion, le champ de connexion sera rempli et le champ de mot de passe est vide.  Si nous donnons √† l'utilisateur √† la fois le nom d'utilisateur et le mot de passe, mais que la cl√© EnablePassword de l'utilisateur dans la section [HKEY_CURRENT_USER \ Software \ SAP \ SAPShortcut \ Security] est d√©finie sur 0 sur le PC de l'utilisateur, nous obtiendrons la m√™me chose.  Et seulement si cette cl√© est d√©finie sur 1 et que nous transf√©rons √† la fois le nom et le mot de passe initial, le syst√®me vous demandera imm√©diatement d'entrer deux fois le nouveau mot de passe permanent.  Ce qui √©tait n√©cessaire pour recevoir. <br><br>  Par cons√©quent, nous avons l'ensemble d'options suivant consid√©r√© comme une illustration de tout ce qui pr√©c√®de: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="actionscript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="actionscript"><span class="hljs-function"><span class="hljs-title">openSAPGui</span></span></span></span><span class="hljs-params"><span class="actionscript"><span class="hljs-function"><span class="hljs-params">(sid, client, user, password)</span></span></span></span><span class="actionscript"><span class="hljs-function"> </span></span></span><span class="actionscript">{ </span><span class="hljs-keyword"><span class="actionscript"><span class="hljs-keyword">var</span></span></span><span class="actionscript"> shell = </span><span class="hljs-keyword"><span class="actionscript"><span class="hljs-keyword">new</span></span></span><span class="actionscript"> ActiveXObject(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"WScript.Shell"</span></span></span><span class="actionscript">); shell.run(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'sapshcut.exe -system="'</span></span></span><span class="actionscript">+sid+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'" -client='</span></span></span><span class="actionscript">+client+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">' -user="'</span></span></span><span class="actionscript">+user+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'" -pw="'</span></span></span><span class="actionscript">+password+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'" -language=RU'</span></span></span><span class="actionscript">); } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">''</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript:openSAPGui('SID', '200', 'test', '');"</span></span></span><span class="hljs-tag">/&gt;</span></span>Example 1: Execute sapshcut.exe (ActiveX)<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'Sapgui.Shortcut.File: -system=SID -client=200'</span></span></span><span class="hljs-tag">&gt;</span></span>Example 2: Open sapshcut.exe (URI)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'sapshcut.php?SID=SID&amp;Client=200&amp;User=test'</span></span></span><span class="hljs-tag">&gt;</span></span>Example 3: Open file .sap (SAP GUI Shortcut)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  La derni√®re option m'est venue.  Mais vous pouvez √©galement utiliser, par exemple, la g√©n√©ration de fichiers CMD au lieu de g√©n√©rer des raccourcis SAP qui, lorsqu'ils sont ouverts √† partir d'un navigateur, ouvriront √©galement la fen√™tre SAP GUI.  Voici un exemple ( <b>sapguicmd.php</b> ) de d√©marrage direct de l'interface graphique SAP avec la cha√Æne de connexion compl√®te, sans avoir √† configurer SAP Logon: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $queries = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); parse_str($_SERVER[<span class="hljs-string"><span class="hljs-string">'QUERY_STRING'</span></span>], $queries); $Title = $queries[<span class="hljs-string"><span class="hljs-string">'Title'</span></span>]; $ROUTER = $queries[<span class="hljs-string"><span class="hljs-string">'ROUTER'</span></span>]; $ROUTERPORT = $queries[<span class="hljs-string"><span class="hljs-string">'ROUTERPORT'</span></span>]; $HOST = $queries[<span class="hljs-string"><span class="hljs-string">'HOST'</span></span>]; $PORT = $queries[<span class="hljs-string"><span class="hljs-string">'PORT'</span></span>]; $MESS = $queries[<span class="hljs-string"><span class="hljs-string">'MESS'</span></span>]; $LG = $queries[<span class="hljs-string"><span class="hljs-string">'LG'</span></span>]; $filename = <span class="hljs-string"><span class="hljs-string">'SAPGUI_'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($MESS&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) $filename = $filename.$MESS; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($HOST&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) $filename = $filename.$HOST; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($PORT&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) $filename = $filename.<span class="hljs-string"><span class="hljs-string">'_'</span></span>.$PORT; $filename = $filename.<span class="hljs-string"><span class="hljs-string">'.cmd'</span></span>; header(<span class="hljs-string"><span class="hljs-string">'Content-disposition: attachment; filename='</span></span>.$filename); header(<span class="hljs-string"><span class="hljs-string">'Content-type: application/cmd'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"@echo off\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"chcp 1251\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"echo   "</span></span>.$Title.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"set SAP_CODEPAGE=1504\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'if exist "%ProgramFiles(x86)%\SAP\FrontEnd\SapGui\sapgui.exe" set gui=%ProgramFiles(x86)%\SAP\FrontEnd\SapGui\sapgui.exe'</span></span>.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'if exist "%ProgramFiles%\SAP\FrontEnd\SapGui\sapgui.exe" set gui=%ProgramFiles%\SAP\FrontEnd\SapGui\sapgui.exe'</span></span>.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"set logon="</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($ROUTER&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/H/"</span></span>.$ROUTER; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($ROUTERPORT&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/S/"</span></span>.$ROUTERPORT; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($MESS&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/M/"</span></span>.$MESS; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($HOST&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/H/"</span></span>.$HOST; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($PORT&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/S/"</span></span>.$PORT; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($LG&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/G/"</span></span>.$LG; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'"%gui%" %logon%'</span></span>.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr446998/">https://habr.com/ru/post/fr446998/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr446988/index.html">Comment j'ai enseign√© Scala</a></li>
<li><a href="../fr446990/index.html">D√©lai d'entr√©e sur les consoles et √©mulateurs r√©tro</a></li>
<li><a href="../fr446992/index.html">John Maeda: ¬´En fait, le design n'est pas si important¬ª</a></li>
<li><a href="../fr446994/index.html">L'espace comme un vague souvenir</a></li>
<li><a href="../fr446996/index.html">La m√©thode Pomodoro n'est pas aussi cool qu'elle pourrait l'√™tre</a></li>
<li><a href="../fr447000/index.html">Guerres du format audio: 10 mat√©riaux sur supports num√©riques et analogiques</a></li>
<li><a href="../fr447002/index.html">Visite de coworking photo du Cabinet Lounge</a></li>
<li><a href="../fr447004/index.html">Chien de garde universel sur ATtiny13</a></li>
<li><a href="../fr447006/index.html">Guide: comment cr√©er un bot simple pour JS Telegram pour un d√©butant en programmation</a></li>
<li><a href="../fr447008/index.html">Comment prendre le contr√¥le de votre infrastructure r√©seau. Table des mati√®res</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>