<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ô®Ô∏è üç´ üë® LDAP - "autentica√ß√£o" √© um antipadr√£o üë¶üèª ü§µ üíπ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoje, qualquer organiza√ß√£o possui um diret√≥rio LDAP preenchido com os usu√°rios desta organiza√ß√£o. Se voc√™ olhar atentamente, encontrar√° um ou mais apl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>LDAP - "autentica√ß√£o" √© um antipadr√£o</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/avanpost/blog/484186/"><img src="https://habrastorage.org/webt/z4/t7/pc/z4t7pcdsbu94_dfp79cpkjk88te.png" alt="imagem"><br><br>  Hoje, qualquer organiza√ß√£o possui um diret√≥rio LDAP preenchido com os usu√°rios desta organiza√ß√£o.  Se voc√™ olhar atentamente, encontrar√° um ou mais aplicativos que usam o mesmo diret√≥rio para "autentica√ß√£o".  E as aspas n√£o s√£o acidentais aqui, porque LDAP √© um protocolo de acesso a diret√≥rios desenvolvido para leitura, grava√ß√£o e pesquisa no servi√ßo de diret√≥rio.  Este n√£o √© um protocolo de autentica√ß√£o.  O termo ‚Äúautentica√ß√£o LDAP‚Äù, em vez disso, refere-se √† parte do protocolo (opera√ß√£o de liga√ß√£o), que determina quem voc√™ √© e quais direitos de acesso voc√™ possui √†s informa√ß√µes do diret√≥rio. <br><a name="habracut"></a><br>  Com o tempo, o LDAP se tornou um servi√ßo de autentica√ß√£o de fato.  Servi√ßos LDAP generalizados e acess√≠veis, como o Active Directory, tornaram-se um petisco para desenvolvedores de software que desejam integrar a autentica√ß√£o em seus produtos.  As bibliotecas cliente LDAP est√£o dispon√≠veis para praticamente qualquer estrutura e a integra√ß√£o √© relativamente f√°cil de implementar. <br><br>  Mas, apesar do uso do LDAP poder ajudar a resolver o problema de implementar a autentica√ß√£o do usu√°rio em v√°rios aplicativos da empresa, ele cria muitos problemas.  Diferentemente dos protocolos de autentica√ß√£o especialmente projetados, o uso do LDAP causa v√°rias vulnerabilidades de seguran√ßa da informa√ß√£o. <br><br>  Para entender o que s√£o essas vulnerabilidades, primeiro voc√™ precisa entender como a autentica√ß√£o LDAP funciona. <br><br><h2>  Como funciona a autentica√ß√£o LDAP </h2><br>  Imagine a seguinte situa√ß√£o (est√° longe da realidade, mas transmite a ess√™ncia perfeitamente). <br><br>  Suponha que eu fa√ßa um pedido em uma loja online para que seja entregue em minha casa na minha aus√™ncia.  O correio chega e deixa um bilhete embaixo da porta com o texto "Sinto muito, mas n√£o o encontramos" e me pede para pegar o pedido no ponto de coleta mais pr√≥ximo, em um hor√°rio conveniente.  No ponto de coleta, o funcion√°rio pede meu nome, endere√ßo e pede as chaves da casa para confirmar minha identidade.  Ent√£o o oficial do servi√ßo de entrega chega √† minha casa e abre a porta com a minha chave.  Ele entra para garantir que eu moro l√°, por exemplo, de fotografias na parede ou pelo nome do destinat√°rio na correspond√™ncia.  Depois disso, o funcion√°rio retorna ao ponto de emiss√£o e me informa que confirmou com sucesso minha identidade e que posso receber meu pacote!  Viva! <br><br>  Al√©m de problemas com a log√≠stica, essa situa√ß√£o est√° cheia de outros problemas.  E se um revisor inescrupuloso fizesse uma c√≥pia da minha chave?  Ou ele deixou a chave por um longo tempo sem vigil√¢ncia e mais algu√©m?  E se o testador foi atacado e minha chave foi retirada?  Quando dou a chave do meu apartamento a um estranho, n√£o posso ter certeza da dec√™ncia dele e da minha seguran√ßa. <br><br>  Felizmente, no mundo real, temos documentos de identifica√ß√£o, por exemplo, uma carteira de motorista ou passaporte, emitidos por ag√™ncias governamentais, e sua autenticidade n√£o est√° em d√∫vida.  Posso fornecer esses documentos ao correio para minha pr√≥pria identifica√ß√£o sem entregar as chaves. <br><br>  No mundo LDAP, ainda precisamos passar nossas chaves para abrir a porta em nosso nome.  Transferimos nossa senha para terceiros, e ele est√° tentando penetrar no servidor LDAP com ela.  Se ele conseguir obter acesso, n√£o podemos ter certeza de que nossas credenciais n√£o sejam comprometidas.  Nesse caso, o invasor ter√° n√£o apenas a capacidade de desbloquear a porta LDAP, mas tamb√©m o acesso a qualquer aplicativo que use as mesmas credenciais. <br><br>  Felizmente, em um mundo mais completo de autentica√ß√£o, tamb√©m temos passaportes e carteiras de motorista!  Protocolos de autentica√ß√£o como Kerberos, SAML e OpenID Connect emitem tokens para terceiros.  Os tokens confirmam que voc√™ √© quem afirma ser e n√£o h√° necessidade de transferir suas chaves para ningu√©m.  Como o LDAP nunca foi projetado como um protocolo de autentica√ß√£o, ele n√£o possui os mecanismos apropriados. <br><br><h2>  Desvantagens do LDAP como um sistema de autentica√ß√£o </h2><br>  Em 2007, Shumon Hack lan√ßou um artigo de fic√ß√£o cient√≠fica ( <a href="https://www.huque.com/talks/2007-10-LDAP-Authn.html">Fraquezas do LDAP como um sistema central de autentica√ß√£o</a> ) no qual descreve tr√™s problemas espec√≠ficos ao usar o LDAP como um sistema de autentica√ß√£o. <br><br><h4>  1. O aplicativo provavelmente n√£o √© seguro o suficiente para manipular credenciais </h4><br>  O autor enfatiza que proteger um pequeno conjunto de servidores de autentica√ß√£o contra ataques √© muito mais f√°cil do que proteger um grande n√∫mero de servidores de aplicativos. <br><br>  Na maioria das vezes, os servidores de autentica√ß√£o, em geral, est√£o sob a supervis√£o rigorosa de especialistas com experi√™ncia significativa no campo da seguran√ßa da informa√ß√£o. <br><br>  Por outro lado, os servidores de aplicativos t√™m um n√≠vel de seguran√ßa completamente diferente e correm maior risco de comprometimento.  Eles s√£o menos seguros, trabalham com pilhas de software mais complexas e t√™m maior probabilidade de ter vulnerabilidades.  E, mais frequentemente, s√£o gerenciados por pessoas que n√£o t√™m um conhecimento profundo de seguran√ßa.  Construir o sistema de seguran√ßa certo √© um processo complicado, no qual √© muito f√°cil cometer um erro. <br><br>  O problema √© que, se um servidor de aplicativos estiver comprometido, todas as credenciais usadas por seus propriet√°rios durante o ataque tamb√©m ser√£o comprometidas.  Qualquer outro sistema que use o mesmo diret√≥rio LDAP para autentica√ß√£o est√° em risco. <br><br><h4>  2. O servidor LDAP n√£o pode proteger o mecanismo de autentica√ß√£o usado para obter credenciais </h4><br>  Um servidor LDAP n√£o pode garantir a seguran√ßa da transa√ß√£o.  Embora um servidor LDAP, por exemplo, possa impor a liga√ß√£o ao TLS para garantir que as credenciais n√£o sejam transmitidas em texto n√£o criptografado, o pr√≥prio servidor nunca assumiu nenhum papel na obten√ß√£o de credenciais do usu√°rio.  Existe o risco de o aplicativo receber uma senha por meio de um canal n√£o seguro. <br><br><h4>  3. O usu√°rio √© for√ßado a compartilhar seu segredo de autentica√ß√£o com terceiros </h4><br>  A senha do usu√°rio ou o segredo de autentica√ß√£o deve permanecer em <i>segredo</i> .  Deve ser conhecido apenas pelo usu√°rio e pelo sistema de autentica√ß√£o.  Ao usar a autentica√ß√£o LDAP, o usu√°rio √© for√ßado a compartilhar seu segredo com terceiros, para que possa us√°-lo para interagir com o diret√≥rio LDAP em nome do usu√°rio. <br><br>  √â importante mencionar que, ao usar protocolos de autentica√ß√£o especialmente projetados, como o Kerberos, e mesmo a partir do NTLM anterior, o segredo do usu√°rio nunca √© transmitido pela rede.  O dispositivo cliente e o servidor usam opera√ß√µes criptogr√°ficas para provar um ao outro que eles t√™m o mesmo segredo e nem trocam o pr√≥prio segredo. <br><br>  Para os pontos de Shumon Hook, adicionarei uma descri√ß√£o de v√°rias nuances da autentica√ß√£o LDAP, com base em minha pr√≥pria experi√™ncia.  Primeiro de tudo, o t√≥pico se refere ao uso do Active Directory. <br><br><h4>  4. Muitos desenvolvedores n√£o sabem o suficiente sobre os mecanismos LDAP para us√°-lo corretamente </h4><br>  Uma das minhas postagens anteriores do <a href="https://blog.lithnet.io/">blog</a> descreve como a liga√ß√£o an√¥nima e n√£o autenticada permitiu enganar os desenvolvedores de aplicativos e fez os usu√°rios n√£o autorizados pularem.  A capacidade de executar uma opera√ß√£o de liga√ß√£o sem autentica√ß√£o √© uma das sutilezas do protocolo que nem os especialistas em LDAP mais experientes conhecem. <br><br>  Os diret√≥rios n√£o s√£o f√°ceis de organizar e s√£o capazes de armazenar uma enorme quantidade de informa√ß√µes organizacionais e fornecem muitas maneiras personaliz√°veis ‚Äã‚Äãde armazen√°-las.  Vi muitos casos em que o desenvolvedor do aplicativo assumiu que havia uma certa classe ou atributo de objeto e, quando n√£o foram detectados, o aplicativo travou.  Para autentica√ß√£o do usu√°rio, o conhecimento da estrutura dos dados armazenados no diret√≥rio n√£o deve ser necess√°rio e aplicado.  O protocolo de autentica√ß√£o deve ser abstra√≠do dos detalhes do reposit√≥rio de objetos localizado em um n√≠vel inferior. <br><br><h4>  5. Os administradores de aplicativos geralmente n√£o configuram clientes LDAP corretamente </h4><br>  Ao gerenciar o Active Directory em um grande ambiente distribu√≠do, h√° uma nuance desagrad√°vel: √© dif√≠cil determinar quais aplicativos espec√≠ficos usam o Active Directory como o diret√≥rio LDAP e como exatamente os administradores de aplicativos configuraram o cliente LDAP. <br><br>  A seguir, exemplos dos horrores da configura√ß√£o incorreta. <br><br><ul><li>  DN codificado em aplicativos ou usando DN em uma opera√ß√£o de liga√ß√£o.  Os problemas acontecem constantemente ao renomear ou mover objetos dentro de um diret√≥rio e tudo porque algu√©m em algum lugar codifica o DN.  (Observa√ß√£o para aqueles que realizam opera√ß√µes simples de liga√ß√£o com o Active Directory: n√£o h√° necessidade de usar um DN. O Active Directory tamb√©m fornece formatos DN alternativos que s√£o mais confi√°veis ‚Äã‚Äãdo que usar um formato tradicional). </li><li>  Para a opera√ß√£o de liga√ß√£o, n√£o √© usada uma conta de servi√ßo, mas uma conta pessoal do desenvolvedor ou administrador (imagine o que acontecer√° quando o propriet√°rio da conta deixar a empresa). </li><li>  Enviar senhas em texto n√£o criptografado para a porta 389. </li><li>  Existem aplicativos em que a caixa de sele√ß√£o "Validar certificado" n√£o √© necess√°ria ao se conectar ao AD usando TLS (porta 636).  Por que isso geralmente √© aceit√°vel?  Como posso passar a senha para um servi√ßo de terceiros sem estar convencido de sua autenticidade? </li></ul><br>  √â f√°cil fazer o cliente LDAP funcionar.  Mas apenas o fato de funcionar n√£o significa que a configura√ß√£o esteja correta. <br><br><h4>  6. A autentica√ß√£o LDAP e os modernos servi√ßos de autentica√ß√£o s√£o mutuamente exclusivos </h4><br>  Um aplicativo que usa LDAP para autentica√ß√£o sempre ter√° que confiar em nomes de usu√°rio e senhas.  Tentar implementar tecnologias modernas, como autentica√ß√£o multifatorial e logon √∫nico, √© praticamente imposs√≠vel (a menos que voc√™ implemente suas pr√≥prias tecnologias, o que por si s√≥ √© uma m√° id√©ia).  A Alian√ßa FIDO est√° comprometida em tornar as senhas uma rel√≠quia do passado, e todo aplicativo que usa autentica√ß√£o LDAP ser√° um obst√°culo para uma pol√≠tica sem senha. <br><br><h2>  Quais s√£o as op√ß√µes? </h2><br>  Atualmente, os aplicativos da Web podem realmente ficar sem autentica√ß√£o LDAP.  Existem muitos protocolos excelentes de autentica√ß√£o da Web, como SAML, WS-Federation e OpenID Connect, que n√£o exigem credenciais de usu√°rio para trabalhar com aplicativos de terceiros.  In√∫meros produtos fornecem esses servi√ßos, incluindo o Servi√ßo de Federa√ß√£o do Active Directory (incorporado no Windows Server) ou servi√ßos de terceiros, como o Microsoft Azure AD, Okta, Ping e outros.  Se sua organiza√ß√£o n√£o possui um IdP federado, a primeira coisa a fazer √© implement√°-lo. <br><br>  A principal coisa que voc√™ deve prestar aten√ß√£o ao escolher um novo software √© o suporte a protocolos de autentica√ß√£o modernos.  Mesmo que a empresa precise do aplicativo aqui e agora, n√£o se apresse em escolher uma solu√ß√£o, especialmente se essa op√ß√£o for limitada apenas a produtos com autentica√ß√£o LDAP.  Vale a pena tentar transmitir ao fornecedor selecionado a necessidade de refinar o produto usando protocolos de autentica√ß√£o mais modernos.  Talvez ele ou√ßa e revise seu plano de desenvolvimento. <br><br>  O n√∫mero de aplicativos de desktop com um "cliente espesso" que suporta protocolos de autentica√ß√£o modernos est√° crescendo, e essa √© realmente uma tend√™ncia alegre.  Esses aplicativos geralmente eram um reduto da autentica√ß√£o LDAP.  Um n√∫mero crescente de SDKs, como o MSAL (Microsoft Authentication Library), facilita aos desenvolvedores adicionar suporte para servi√ßos de autentica√ß√£o modernos em seus aplicativos m√≥veis e de desktop. <br><br>  Por fim, vale a pena reconhecer que, na realidade de hoje, nem todos os aplicativos suportam protocolos de autentica√ß√£o modernos, e talvez nunca o sejam.  A implementa√ß√£o de uma proibi√ß√£o completa da autentica√ß√£o LDAP provavelmente n√£o √© poss√≠vel em nenhuma organiza√ß√£o.  No entanto, de nenhuma maneira a autentica√ß√£o LDAP deve ser incentivada dentro da organiza√ß√£o.  O uso do LDAP deve ser considerado apenas na aus√™ncia de outras op√ß√µes. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt484186/">https://habr.com/ru/post/pt484186/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt484174/index.html">Beber em castelo em condi√ß√µes "extremas" ou como participamos do show "DOZOR"</a></li>
<li><a href="../pt484176/index.html">Implementando o modelo de status no Unity</a></li>
<li><a href="../pt484178/index.html">Switch Ethernet inteligente para o planeta Terra</a></li>
<li><a href="../pt484180/index.html">PBX virtual Rostelecom: o que e como pode ser feito atrav√©s da API</a></li>
<li><a href="../pt484182/index.html">Xenobots: nanorob√¥s vivos de c√©lulas de sapo</a></li>
<li><a href="../pt484188/index.html">Padr√µes de Design de Banco de Dados</a></li>
<li><a href="../pt484192/index.html">F√°cil e f√°cil de implantar aplicativos no cartucho Tarantool (parte 2)</a></li>
<li><a href="../pt484194/index.html">Kubernetes traduzido em crian√ßas</a></li>
<li><a href="../pt484196/index.html">Gravando som JS de um microfone ou coment√°rios de voz</a></li>
<li><a href="../pt484198/index.html">Verso da moeda: quem ganhou e perdeu com o crescimento das a√ß√µes da Tesla</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>