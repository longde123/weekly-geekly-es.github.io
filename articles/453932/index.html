<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤱🏾 🔟 💇🏾 Unas palabras en defensa del monolito ➡️ 🧙🏽 👰🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Comparamos las características del microservicio y la arquitectura monolítica, sus ventajas y desventajas. El artículo fue preparado para Habr basado ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Unas palabras en defensa del monolito</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/simbirsoft/blog/453932/">  Comparamos las características del microservicio y la arquitectura monolítica, sus ventajas y desventajas.  El artículo fue preparado para Habr basado en los materiales de nuestro meta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Hot Backend</a> , que se celebró en Samara el 9 de febrero de 2019.  Consideramos los factores de la elección de la arquitectura en función de la tarea específica. <a name="habracut"></a><br><br>  Incluso hace 5 años, nadie había oído hablar de microservicios.  Sin embargo, su popularidad aumenta de año en año, según las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">estadísticas de</a> Google Trends. <br><br><img src="https://habrastorage.org/webt/1_/of/jd/1_ofjdwx6pauxathtq1srtfdsas.png"><br><br><h2>  Monolito y microservicios: ejemplos </h2><br>  Si el proyecto usa una arquitectura monolítica, entonces el desarrollador solo tiene una aplicación, cuyos componentes y módulos funcionan con una sola base. <br><br><img src="https://habrastorage.org/webt/8q/pt/px/8qptpxklg15wtydbx847sqk2c9o.jpeg"><br><br>  La arquitectura de microservicios implica la descomposición en módulos que se ejecutan como procesos separados y pueden tener servidores separados.  Cada microservicio funciona con su propia base de datos y todos estos servicios pueden comunicarse entre sí de forma síncrona (http) y asíncrona.  Además, para optimizar la arquitectura, es deseable minimizar la relación entre los servicios. <br><br>  El siguiente diagrama está simplificado, refleja, en primer lugar, los componentes del negocio. <br><br><img src="https://habrastorage.org/webt/q2/gi/y-/q2giy-br8pq2amiqihkrkzmn2e4.jpeg"><br><br><h2>  Microservicios: beneficios </h2><br>  Existen al menos cuatro ventajas de la arquitectura de microservicios: <br><br>  <b>Escalado e implementación independientes</b> <br><br>  Se proporciona una implementación independiente para cada microservicio, y esto es conveniente al actualizar módulos individuales.  Si la carga en el módulo aumenta, el microservicio correspondiente se puede escalar sin afectar a los demás.  Esto le permite distribuir de manera flexible la carga y ahorrar recursos. <br><br>  <b>Desarrollo independiente</b> <br><br>  Cada microservicio (por ejemplo, un módulo de memoria) puede ser desarrollado por un equipo para aumentar la velocidad de creación de un producto de software. <br><br>  <b>Sostenibilidad</b> <br><br>  La falla de un microservicio no afecta el desempeño de otros módulos. <br><br>  <b>Heterogeneidad</b> <br><br>  Cada equipo es libre de elegir su propio idioma y tecnología para implementar microservicios, sin embargo, es deseable que tengan interfaces compatibles. <br><br>  Entre los desarrolladores, puede escuchar la opinión de que la arquitectura monolítica está desactualizada, es difícil de mantener y escalar, crece rápidamente en un "gran trozo de tierra" y es prácticamente antipatrón, es decir, su presencia en el código es indeseable.  Las grandes empresas, como Netflix, que cambiaron a la arquitectura de microservicios en sus proyectos, a menudo se citan como evidencia de esta opinión. <br><br>  ¿Veamos si todos realmente deberían cambiar de un monolito a microservicios siguiendo el ejemplo de las marcas más grandes? <br><br><h2>  Cambiar a microservicios: posibles dificultades </h2><br>  <b>Problema uno: descomposición</b> <br><br>  Idealmente, la aplicación debe dividirse en microservicios para que interactúen entre sí lo menos posible, de lo contrario, la aplicación será difícil de mantener.  Al mismo tiempo, la descomposición es difícil de implementar al comienzo del desarrollo, cuando los problemas comerciales y el área temática aún pueden cambiar con la llegada de nuevos requisitos.  Refactorizar es costoso. <br><br>  Si se hace necesario transferir parte de las funciones del servicio A al servicio B, puede haber dificultades: por ejemplo, los servicios se ejecutan en diferentes idiomas, las llamadas internas a los servicios se convierten en red, necesita conectar otras bibliotecas.  Podemos verificar la corrección de la refactorización solo con la ayuda de las pruebas. <br><br><img src="https://habrastorage.org/webt/ms/sb/zd/mssbzdbu2gw0mkt3xxsxd7cozuo.jpeg"><br><br>  <b>Problema dos: transacciones</b> <br><br>  Otro problema es que los microservicios no tienen el concepto de transacciones distribuidas.  Podemos garantizar la integridad arquitectónica de una operación comercial solo dentro de un microservicio.  Si la operación involucra varios microservicios, se pueden usar diferentes bases de datos allí, y dicha transacción tendrá que ser abandonada.  Para resolver este problema, existen varios métodos utilizados en los negocios cuando la accesibilidad es más importante que la integridad.  Al mismo tiempo, se proporcionan mecanismos de compensación en caso de que algo salga mal.  Por ejemplo, si los productos no están en stock, debe realizar un reembolso en la cuenta del comprador. <br><br>  Si un monolito nos da integridad arquitectónica automáticamente, entonces con microservicios debe crear su propio mecanismo y usar bibliotecas con soluciones listas para usar.  Al distribuir una operación entre servicios, es mejor solicitar datos sincrónicamente y realizar acciones posteriores de forma asincrónica.  Si es imposible acceder a uno de los servicios, el equipo se pondrá en cola tan pronto como esté disponible nuevamente. <br><br>  En este sentido, es necesario revisar el enfoque de la interfaz de usuario.  Se debe notificar al usuario que algunas acciones no se realizan de inmediato, sino dentro de un tiempo determinado.  Cuando se procesa la solicitud, recibe una invitación para ver los resultados. <br><br><img src="https://habrastorage.org/webt/j3/ms/1m/j3ms1mf_jzbabdwangp62th2uru.jpeg"><br><br>  <b>Problema tres: informes</b> <br><br>  Si utilizamos una arquitectura monolítica con una sola base de datos, para crear un informe complejo puede escribir seleccionar y extraer varias etiquetas de datos: tarde o temprano se mostrarán.  Sin embargo, en microservicios, estos datos se pueden dispersar en diferentes bases. <br><br>  Por ejemplo, necesitamos enumerar compañías con métricas específicas.  Con una simple lista de empresas, todo funciona.  ¿Y si necesita agregar métricas que se encuentran en otra base de datos?  Sí, podemos hacer una solicitud adicional y solicitar métricas por TIN.  ¿Y si esta lista necesita ser filtrada y ordenada?  La lista de empresas puede ser muy grande, y luego tenemos que introducir un servicio adicional con su propia base de datos: informes. <br><br><img src="https://habrastorage.org/webt/lz/kq/sn/lzkqsn07kbbjovz9_rttgfqbfmg.jpeg"><br><br>  <b>Problema cuatro: alta complejidad de desarrollo</b> <br><br>  El trabajo en servicios distribuidos es más complicado: todas las solicitudes se realizan a través de la red y se pueden desactivar, debe proporcionar un mecanismo de devolución de llamada (¿volverá a hacer la llamada? ¿Cuántas veces?).  Estos son los "ladrillos" que se acumulan gradualmente y contribuyen a aumentar la complejidad del proyecto. <br><br>  Los servicios pueden ser desarrollados por varios equipos diferentes, y debe documentarlos, mantener la documentación actualizada y advertir a otros equipos cuando cambie la versión.  Estos son costos laborales adicionales. <br><br>  Si cada equipo tiene una implementación independiente, debe mantener al menos la versión anterior y deshabilitarla solo después de que todos los consumidores del servicio hayan cambiado a la nueva API. <br>  Por supuesto, podemos llevar todas las API a algún tipo de artefacto que estará disponible públicamente.  Pero, en primer lugar, los servicios se pueden escribir en diferentes idiomas y, en segundo lugar, esto no se recomienda.  Por ejemplo, en uno de nuestros proyectos, rechazamos esto a pedido del cliente, relacionado con consideraciones de seguridad.  Cada microservicio tiene un repositorio separado y el cliente no les da acceso. <br><br>  En el proceso de desarrollo, todo puede funcionar correctamente, y luego, no.  Sucede que, en caso de excepciones, la aplicación intenta procesarlos infinitamente, y esto genera una gran carga: todo el sistema "se despliega".  Para evitar tales situaciones, debe configurar todo, por ejemplo, para limitar el número de intentos, no devolver esta llamada a la cola en el mismo segundo, etc. <br><br><img src="https://habrastorage.org/webt/_w/jd/oj/_wjdoj3ln-k7ysfb6wuh8kz1ycg.jpeg"><br><br><img src="https://habrastorage.org/webt/ae/rr/xc/aerrxc3udwi9pgafnmkzc7xy2du.jpeg"><br><br>  <b>El quinto problema: la complejidad de las pruebas, el rastreo y la depuración</b> <br><br>  Para probar un problema, debe descargar todos los microservicios involucrados.  La depuración se convierte en una tarea no trivial, y todos los registros deben recopilarse en algún lugar en un solo lugar.  En este caso, necesita tantos registros como sea posible para descubrir qué sucedió.  Para rastrear el problema, debe comprender todo el camino que ha recorrido el mensaje.  Las pruebas unitarias no son suficientes aquí, ya que es probable que haya errores en la unión de los servicios.  Al realizar cambios, es posible verificar la operatividad solo después de ejecutar en el soporte.  Podemos limitar cada microservicio a una cierta cantidad de memoria (por ejemplo, 500 megabytes), pero hay momentos de carga máxima cuando se necesitan hasta dos gigabytes.  Hay momentos en que el sistema comienza a ralentizarse.  Como resultado, los recursos se pueden gastar en algo que no pertenece a las tareas inmediatas del cliente: por ejemplo, solo hay dos microservicios comerciales, y la mitad de los recursos se gastan en tres microservicios adicionales que respaldan el trabajo de los demás. <br><br><img src="https://habrastorage.org/webt/pl/bn/36/plbn36qdp9gnyslu-b0xbecfo7c.jpeg"><br><br><h2>  Microservicio o monolito: criterios de selección </h2><br>  Al elegir entre arquitectura monolítica y microservicio, en primer lugar, debe proceder de la complejidad del área temática y la necesidad de escalar. <br><br>  Si el área temática es simple y no se espera un aumento global en el número de usuarios, entonces los microservicios se pueden usar sin ninguna duda.  En otros casos, es mejor comenzar el desarrollo en un monolito y ahorrar recursos si no se requiere escalar.  Si el área temática es compleja, y en la etapa inicial no se definen los requisitos finales, también es mejor comenzar con un monolito, para no volver a hacer los microservicios varias veces.  Con el desarrollo posterior del proyecto, es posible distinguir sus partes individuales en microservicios. <br><br><img src="https://habrastorage.org/webt/bl/5c/9e/bl5c9elyajqq00pivozpby_yauy.jpeg"><br><br>  Una ventaja es la presencia de límites al comienzo del proyecto, ya que esto ayudará a no romperlos durante el proceso de desarrollo.  También tiene sentido comenzar con una base de datos, pero definir un esquema para cada módulo (por ejemplo, un esquema de pago).  Posteriormente, esto ayudará a simplificar la división de módulos en microservicios.  En este caso, observamos los límites de los módulos y podemos usar microservicios. <br><br>  Cada módulo debe tener su propia API, para que luego se pueda asignar y convertir el módulo en un microservicio. <br><br><img src="https://habrastorage.org/webt/6i/rp/b9/6irpb9ewnkmgleylittjhh5z-f8.jpeg"><br><br>  Una vez determinados los límites de los módulos, puede proceder a la descomposición en microservicios, si es necesario.  En aproximadamente el 90% de los casos será posible permanecer en el monolito, pero si es necesario, será más fácil y económico cambiar la arquitectura. <br><br>  En nuestra práctica de trabajar con monolitos y microservicios, llegamos a las siguientes conclusiones: <br><ul><li>  No cambie a microservicios solo porque los usa Netflix, Twitter, Facebook </li><li>  Comience con dos o tres microservicios que interactúen entre sí, resuelva en detalle todos los requisitos no funcionales (seguridad, tolerancia a fallas, escalabilidad, etc.) y solo luego pase a otros servicios </li><li>  Automatiza todo lo posible </li><li>  Configurar monitoreo </li><li>  Escribir autotests </li><li>  No utilice transacciones distribuidas (pero esta no es una razón para rechazar la garantía de integridad de los datos). </li><li>  Si desea utilizar la arquitectura de microservicios, prepárese para el hecho de que el desarrollo puede costarle aproximadamente 3 veces más que en un monolito.  Sin embargo, ambas tecnologías tienen sus propias desventajas y ventajas; cada una de ellas tiene su propio nicho. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/453932/">https://habr.com/ru/post/453932/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../453914/index.html">Instrucciones de instalación del cliente de prueba TON</a></li>
<li><a href="../453916/index.html">Cómo protegerse de los estafadores móviles</a></li>
<li><a href="../453920/index.html">Cómo tomar el control de su infraestructura de red. Capítulo cuatro Automatización Plantillas</a></li>
<li><a href="../453926/index.html">Cómo funciona y funciona el servicio de coche compartido</a></li>
<li><a href="../453930/index.html">Comparación y selección de sistemas de migración de datos.</a></li>
<li><a href="../453934/index.html">11 preguntas para discutir antes de comenzar a trabajar</a></li>
<li><a href="../453938/index.html">Seguimiento de bicicletas robadas NB-IoT</a></li>
<li><a href="../453942/index.html">Acerca de la ética con el ejemplo de PMI Codex</a></li>
<li><a href="../453944/index.html">Errores enmascarados en embedd</a></li>
<li><a href="../453950/index.html">Se supone que debes estar aquí! 22 años del lanzamiento del legendario juego Duke Nukem 3D</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>