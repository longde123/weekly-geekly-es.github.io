<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💳 👤 💤 Ir aplicación en sistemas de producción. Validadores 🔸 👧🏼 👡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Buenas tardes, Habr! 

 A menudo comienzo la mañana mirando al Habr y finalmente decidí contribuir a este proceso de aprendizaje de cosas interesantes...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ir aplicación en sistemas de producción. Validadores</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/445044/">  <i>Buenas tardes, Habr!</i> <br><br>  A menudo comienzo la mañana mirando al Habr y finalmente decidí contribuir a este proceso de aprendizaje de cosas interesantes.  Si todo va bien, entonces este es mi primer artículo del ciclo de uso del lenguaje <b>GO</b> en sistemas de producción.  Quiero contarles algunas de las sutilezas de la creación de aplicaciones y servidores, la conveniencia del lenguaje y la velocidad de desarrollo del mismo.  Quizás para los profesionales, este artículo parecerá aburrido y no interesante, pero al leer la literatura no encontré una imagen general de la resolución de problemas de producción.  Aunque la mayoría de las tareas se resuelven de la misma manera.  En este artículo describiré los principios generales de la construcción de un servidor y, como ejemplo, usaré el servidor para validar y ver los códigos postales de Russian Post.  Este artículo cubrirá problemas y sutilezas metodológicas más generales que encontré al crear este sistema.  No describiré la configuración general, hay muchos de estos en la red, solo quiero centrarme en las pequeñas cosas que impidieron el lanzamiento del proyecto. <br><br><img src="https://habrastorage.org/webt/mb/5n/pv/mb5npvjcxey7an1ybccpsgu9odw.jpeg"><br><a name="habracut"></a><br><h3>  En lugar de unirse </h3><br>  Leyendo a Habr, a menudo me enfrentaba a la tarea de validación: verificar la exactitud de la entrada de información del usuario.  Cada autor resolvió este problema a su manera.  Usé un servicio externo o escribí mi servidor.  Propongo otra solución a este problema: la creación de un servicio de directorio.  Los directorios son servidores que contienen información de una determinada dirección y que se pueden distinguir en un subsistema separado e independiente.  Por lo general, los directorios se utilizan para ayudar al usuario a completar y validar la información ingresada.  Como ejemplo de dichos directorios, se pueden citar los servicios de regiones solicitantes, solicitudes de ciudades, KLADR, códigos postales y directorios de GAIS (sistemas de información automatizados estatales).  Casi todos los sistemas existentes intercambian datos REST utilizando json o soap.  Intentaré contar una plantilla para el desarrollo de dichos directorios, que creará rápidamente dichos sistemas.  Y poner en github las fuentes de mi proyecto interno. <br><br><h3>  La elección de los sistemas.  La pregunta surge de inmediato por qué ir?  ¿Por qué Linux?  ¿Y qué Linux? </h3><br>  Y entonces comencemos en orden.  Nuestro sistema actual se basa en productos de 1C, a saber, el BUS y el portal corporativo.  Para unificar el sistema operativo, elegimos entre la instalación recomendada de 1C, a saber, Linux OS CentOS.  Las secuencias de comandos para iniciar el entorno web 1C se ejecutan en este sistema operativo.  El sistema operativo Windows no fue considerado.  No puedo decir que me gusta la elección, elegiría Debian, pero sucedió.  Necesitábamos la unificación, porque históricamente tenemos un gran sistema operativo de zoológico, varias compilaciones de SO Linux, OS FreeBSD, OS VxWorks.  Y, en mi opinión, el sistema operativo Linux CRUX más rápido. <br><br>  Como muchos proyectos, el sistema creado en 1C se ha convertido en un gran portal y se hizo necesario aislar el sistema y / o complementar el sistema con varios servicios: libros de referencia.  Analizando las ofertas y capacidades de los servicios ya creados, así como nuestras necesidades para estos directorios, llegamos a la conclusión de que el directorio: <br><br><ul><li>  Servicio de servidor autónomo; </li><li>  El intercambio de datos ocurre en REST; </li><li>  Tiene la capacidad de escalar horizontalmente; </li><li>  Debe proporcionar rápidamente datos, aunque sean redundantes, procesados ​​en productos 1C; </li><li>  Reconstruya rápidamente la lógica basada en nuevos desafíos comerciales; </li></ul><br>  De acuerdo con los criterios anteriores y su facilidad de entrada, Go fue elegido para escribir libros de referencia.  Opcional: <br><br><ul><li>  Vaya a lenguaje con un compilador y le permite incluir fragmentos de código en C; </li><li>  El programa es un archivo único con todas las bibliotecas (no hay problema con la compatibilidad de las bibliotecas después del ensamblaje); </li><li>  comunidad grande (muchos ejemplos y soluciones llave en mano); </li></ul><br>  Es decir, Go es muy adecuado para crear directorios.  Por mi parte, agregaré que php y Go son un poco similares, lo que le permite admitir sistemas escritos en estos idiomas.  Go también tiene una gran cantidad de soluciones que le permiten ensamblar rápidamente estas soluciones para sus tareas, es decir, cómo ensamblar un modelo de la casa a partir de los cubos en el diseñador.  Y entonces pasemos a practicar. <br><br><h3>  Ir  Instalar y buscar bibliotecas o soluciones </h3><br><cut></cut>  Para instalar, debe descargar el archivo de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">página de descarga</a> y descomprimirlo en la carpeta de instalación, <b>usaré / usr / local</b> . <br><br><pre><code class="plaintext hljs">wget https://dl.google.com/go/go1.12.1.linux-amd64.tar.gz tar -C /usr/local -xvzf go1.12.1.linux-amd64.tar.gz</code> </pre> <br>  Quiero prestar atención, Go se divide en dos categorías, la primera, el lenguaje de compilación en sí y las bibliotecas incluidas en el ensamblaje ( <b>GOROOT</b> ), la segunda, estas son bibliotecas adicionales que instaló y donde creará su proyecto ( <b>GOPATH</b> ).  Configurando el entorno y preparando la carpeta de desarrollo, <b>usaré / home / gouser /</b> .  Agregue <b>/ etc / profile</b> o a su <b>perfil</b> personalizado. <br><br><pre> <code class="plaintext hljs">export GOPATH=/home/gouser export GOROOT= /user/local/go/ export PATH=$PATH:/usr/local/go/bin</code> </pre> <br>  Preparando una carpeta para su proyecto: <br><br><pre> <code class="plaintext hljs">mkdir -p /home/gouser/{bin,pkg,src}</code> </pre> <br>  Entonces todo es simple para nuestro proyecto, cree una carpeta en src, cree archivos con la extensión go y compile el proyecto: <br><br><pre> <code class="plaintext hljs">go build</code> </pre> <br><h3>  Recomendaciones para crear un proyecto.  Recomendaciones generales </h3><br><ul><li>  Para un proyecto github, es más fácil crear una carpeta para el proyecto src / github.com / &lt;nombre del proyecto&gt;; </li><li>  diseñando el proyecto como un paquete, comentando cada procedimiento es la manera de obtener de manera muy conveniente la documentación del programa preparada en godoc; </li><li>  Saque las variables globales en un módulo separado y conéctelo si es necesario (se asemeja a una plantilla sola); </li></ul><br>  Tanto los ejemplos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">precompilados</a> como las bibliotecas se pueden encontrar en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">libs.garden</a> .  Instalación de ejemplos encontrados <br><br><pre> <code class="plaintext hljs">go get &lt;  &gt; ,  github.com/labstack/echo</code> </pre> <br><h3>  Código postal  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Enlace al proyecto</a> </h3><br>  Después de instalar <b>Go,</b> pasemos a un ejemplo.  Puede descargarlo e instalarlo para compilarlo usando los comandos: <br><br><pre> <code class="plaintext hljs">go get github.com/julienschmidt/httprouter go get github.com/LindsayBradford/go-dbf/godbf go get github.com/go-sql-driver/mysql go get github.com/julienschmidt/httprouter cd /home/gouser/go/src/github.com/ git clone https://github.com/Theo730/postcode.git postcode</code> </pre> <br><h3>  Declaración del problema. </h3><br>  Es necesario crear un directorio para trabajar con códigos postales por correo ruso, que resolverá los siguientes problemas: <br><br><ul><li>  Validación de códigos postales; </li><li>  La capacidad de obtener una lista de todos los objetos contables (regiones, ciudades, etc.); </li><li>  Obtención de todos los índices en el objeto contable de ciudades, regiones, regiones ... </li><li>  De lo anterior, para intercambiar datos a través de REST en forma de json. </li></ul><br><h3>  Tarea de investigación </h3><br>  Primero debe inicializar la base de datos y luego crear un servidor de solicitudes para esta base de datos.  Necesita una base de datos de código postal.  La búsqueda es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">vinfo.russianpost.ru/database/ops.html</a> .  Base en FoxPro y en archivo zip.  Los siguientes objetos contables se encuentran en la base de datos: <br><br><ul><li>  región </li><li>  obla autónoma; </li><li>  distrito </li><li>  asentamiento </li><li>  código postal </li></ul><br>  Para la inicialización en <b>libs.garden</b> , encontramos componentes y ejemplos de trabajo con la base de datos y zip.  Tomamos <b>httprouter</b> como un <b>enrutador de</b> solicitud.  Nos conectamos al proyecto. <br>  Al examinar el archivo de la base de datos, se encontró que <u>no todos los objetos contables están especificados</u> , es decir, los valores cero están presentes en la muestra. <br><br><h3>  Solución e implementación </h3><br>  Configuré objetos de contabilidad en una jerarquía cuando se inicializa la base de datos, si el objeto de contabilidad es cero, entonces el nombre se toma del padre.  Ideología del servidor: las solicitudes llegan a <b>main</b> (aquí el enrutador de solicitudes) y se redirigen a los <b>controladores</b> (aquí todas las comprobaciones de datos, conversión, etc.).  Desde los <b>manejadores,</b> todas las solicitudes a la <b>base de datos</b> y los cálculos se llevan a cabo y los manejadores realizan el retiro de la información recibida.  Tal <u>descomposición le</u> permite separar las consultas en la base de datos, los cálculos, la verificación de la información ingresada y la salida encontrada.  En principio, todo. <br><br><h3>  En lugar de un total </h3><br>  La referencia funcional resultó ser más complicada que <b>KLADR</b> .  No solo le permite crear un validador o directorio en el sitio, sino también crear un algoritmo para negocios regionales. <br><br>  Si hay un negocio regional distribuido que vende servicios o bienes.  Los distribuidores en las regiones están registrados en el portal, indican el área donde prestarán el servicio o venderán los productos y se les asignará una variedad de códigos postales.  Cuando solicita un servicio o producto, el cliente indica el código postal y su aplicación se envía a su distribuidor regional (aquí puede crear un algoritmo complejo).  Una lista de solicitudes <b>REST</b> está en <b>github</b> en la documentación del proyecto. <br><br><h3>  Y un poco de bitrix </h3><br>  Esta referencia se puede conectar a cualquier proyecto o marco, pero como tenemos bitrix, puse un módulo para agregar un validador a los formularios web de componentes estándar. <br><br>  La instalación del servidor <b>PS</b> se divide especialmente en 3 etapas.  Esto se hace debido a la obsolescencia de la base de datos del sitio vinfo.russianpost.ru y debido a restricciones de licencia.  La base de datos en sí no es de mi propiedad. Al usarla, usted acepta la política de licencia sobre el sitio anunciado. <br><br>  Los servidores <b>PSS</b> creados en mis proyectos para el segmento corporativo y bajo estas condiciones no deberían conectarse.  El código se puede modificar para sus tareas específicas.  No utilizamos acceso externo para nuestros proyectos.  Los siguientes proyectos que me gustaría describir son un CLADR completo y un analizador de protocolo de radio de flujo.  El siguiente en la línea es Bitrix24 + asterisco.  Por favor comente sobre quién es más interesante. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/445044/">https://habr.com/ru/post/445044/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../445034/index.html">LockerGoga: que sucedió exactamente con Norsk Hydro</a></li>
<li><a href="../445036/index.html">¿Cuál fue el primer iPhone?</a></li>
<li><a href="../445038/index.html">Fugas de información clasificada encontradas en 100,000 repositorios en GitHub</a></li>
<li><a href="../445040/index.html">Creamos modelos, "vendemos" la gestión del conocimiento a la gerencia y corregimos el error del sobreviviente</a></li>
<li><a href="../445042/index.html">Delphic historia de éxito de un programador de Ulan-Ude</a></li>
<li><a href="../445048/index.html">Algoritmo de triangulación de Delaunay por método de línea de barrido</a></li>
<li><a href="../445052/index.html">¿Por qué no puedo configurar el tamaño de fuente del enlace visitado?</a></li>
<li><a href="../445054/index.html">La IA ahora clasifica el cáncer de pulmón y los diagnósticos de laboratorio.</a></li>
<li><a href="../445056/index.html">Descripción general de los cursos de desarrollo web</a></li>
<li><a href="../445058/index.html">El piloto automático de Tesla aprendió a determinar los cambios de carril en los autos vecinos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>