<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💵 👩🏼‍🔬 💼 使用蓝牙LE开发物联网设备 🤙🏾 🍺 ✋🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="蓝牙 技术正在大力打破其在物联网中的地位。一些这方面的技术，被称为蓝牙的LE （蓝牙低能量，这是蓝牙智能，又名BLE）直接将自己定位为理想的选择物联网（物联网）。很难不同意。BLE已经知道如何路由Internet通信，确定房间中的坐标，连接工业可编程逻辑控制器，支持WEB服务器，连接体重秤，温度计，...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>使用蓝牙LE开发物联网设备</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/394757/"><a href=""><div style="text-align:center;"><img width="1010" src="https://habrastorage.org/getpro/geektimes/post_images/054/28f/426/05428f4260bd302f20e5a277359c591e.png"></div></a> <br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蓝牙</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
技术正在</font><font style="vertical-align: inherit;">大力打破其在物联网中的地位。一些这方面的技术，被称为</font></font><font color="#C00000"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蓝牙</font></font></b><font color="#C00000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的LE</font></font></font> </font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蓝牙低能量</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这是</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蓝牙智能</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，又名</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）直接将自己定位为理想的选择</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">物联网</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">物联网</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。很难不同意。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已经知道如何路由Internet通信，确定房间中的坐标，连接工业可编程逻辑控制器，支持</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WEB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务器，连接体重秤，温度计，心率监测器，血氧仪，血压监测器以及许多其他东西。的C </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE</font></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wi-Fi</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解决方案固有的许多问题都会自动解决</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用类似于</font><b><font style="vertical-align: inherit;">ZigBee</font></b><font style="vertical-align: inherit;">的技术，</font><font style="vertical-align: inherit;">不久</font><font style="vertical-align: inherit;">就可以在</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">MESH网络中</font></a><font style="vertical-align: inherit;">组织</font><font style="vertical-align: inherit;">具有</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE的</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设备</font><font style="vertical-align: inherit;">。这已经反映在</font><b><font style="vertical-align: inherit;">蓝牙</font></b><font style="vertical-align: inherit;">规范</font><b><font style="vertical-align: inherit;">5.0中。</font></b></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，在开发</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IoT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模块时，</font><font style="vertical-align: inherit;">与使用</font><b><font style="vertical-align: inherit;">Wi-Fi</font></b><font style="vertical-align: inherit;">相比</font><font style="vertical-align: inherit;">，我无条件地偏爱</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">我将以</font><b><font style="vertical-align: inherit;">K66BLEZ</font></b><font style="vertical-align: inherit;">调试模块</font><b><font style="vertical-align: inherit;">为例</font></b><font style="vertical-align: inherit;">来考虑</font><b><font style="vertical-align: inherit;">BLE</font></b><font style="vertical-align: inherit;">网络</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">外围部分</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">
在这里，我想描述一下我从几乎完全不了解</font><b><font style="vertical-align: inherit;">BLE</font></b><font style="vertical-align: inherit;">到批量生产的</font><font style="vertical-align: inherit;">开发路线</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这些文章开始</font><font style="vertical-align: inherit;">
了对</font><b><font style="vertical-align: inherit;">K66BLEZ1</font></b><font style="vertical-align: inherit;">模块的熟悉</font><font style="vertical-align: inherit;">：</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<blockquote><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">     .  </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">     .  FatFs</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">     .  </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
模块</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">K66BLEZ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为收发</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用途芯片</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MKW40Z160</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">48兆赫的Cortex-M0 +，160 KB闪存，RAM 20 KB</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）生产挖</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NXP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。该芯片的有趣之处在于，它与BLE一起还可以用作标准</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">802.15.4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的信号收发器</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">众所周知，</font><font style="vertical-align: inherit;">标准</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">802.15.4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ZigBee</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">技术的载体</font><font style="vertical-align: inherit;">。直接栈</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的ZigBee</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MKW40Z</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">没有公布，但已经提供firmvare其中</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">802.15.4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与同时工作</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
带有BLE芯片的模块的一部分的示意图如下所示。</font></font><br>
<a href=""><img align="left" width="1010" src="https://habrastorage.org/getpro/geektimes/post_images/b5d/0c0/158/b5d0c01586e8bc42182a764c0b7e8716.png"><br clear="left">
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（点击放大）</font></font></em></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
代替芯片的</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MKW40</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已经有芯片</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MKW41</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有128 KB的RAM容量，512 KB的闪存容量，支持所有流行的协议：</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> BLE 4.2，BLE网格中，ZigBee，线程A，IPv6的6LoBLE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。新芯片上尚无公开文档，但它有望与MKW40引脚兼容。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
模块上的MKW40 BLE芯片通过SPI和I2C接口连接到MK66主微控制器。 I2C接口还将芯片连接到充电器芯片。主通信通道在SPI接口上以6 Mbit / s的比特率实现。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可以使用JTAG适配器通过SWD接口执行MKW40芯片中程序的调试，还可以通过调试接口UART0将其输出到X4调试器连接器。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
恩智浦为MKW40芯片上的各种应用提供了两个以上的示例，包括：压力，葡萄糖，温度，接近传感器，心率表等。</font><font style="vertical-align: inherit;">有无线UART和无线引导程序的应用程序。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我对这些芯片进行了NXP框架的深层重构，并在Windows PC上使用演示程序创建了新的配置文件，这些演示程序在PC端不需要单独的适配器。</font><font style="vertical-align: inherit;">但是稍后会更多。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
蓝牙LE很难学习。</font><font style="vertical-align: inherit;">原因是制造商的文档中有大量的规范和大量简短的表述，这些术语立即以不同寻常的术语开始。</font><font style="vertical-align: inherit;">因此，让我们开始吧。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">术语和缩写的解码和翻译，语。</font></font></h1><br>
<ul>
<li><b><font color="#C00000">Pairing</font> </b> —  ().    BLE           .      ,     PIN .</li>
<li><b><font color="#C00000">Bonding</font> </b> — ().             BLE .</li>
<li><b><font color="#C00000">Device </font><font color="#C00000">authentication</font> </b> — ()   ,       .</li>
<li><b><font color="#C00000">Advertising</font> </b> —    BLE   ().         ,   ,  ,    .</li>
<li><b><font color="#C00000">Scanning</font> </b> —       BLE    .           ,    .</li>
<li><b><font color="#C00000">Profile</font> </b> — .   , ,         .</li>
<li><b><font color="#C00000">UUID</font> </b> — universally unique identifier. 128-    .</li>
<li><b><font color="#C00000">BLE </font><font color="#C00000">Host</font> </b> — .     BLE    ,             .   GAP, GATT,   GATT, L2CA.</li>
<li><b><font color="#C00000">BLE </font><font color="#C00000">Controller</font> </b> — .     BLE   - Bluetooth.</li>
<li><b><font color="#C00000">HCI</font> </b> — Host Controller Interface.   API        BLE   BLE .</li>
<li><b><font color="#C00000">GAP</font> </b> — Generic Access Profile,   .      layer ().       .       ,          BLE .</li>
<li><b><font color="#C00000">GATT</font> </b> — Generic Attribute Profile,   .          .  —      (, , ...)         , ,   ..   ,     UUID.</li>
<li><b><font color="#C00000">L2CA</font> </b> — Logical Link Control and Adaptation Layer.             .   ,  ,  ,  ,      .   BLE .</li>
<li><b><font color="#C00000">SMP</font> </b> — Security Manager Protocol.    .      L2CA.</li>
<li><b><font color="#C00000">LTK</font> </b> — Long-Term Key.      BLE .</li>
<li><b><font color="#C00000">IRK</font> </b> — Identity Resolving Key.         .</li>
<li><b><font color="#C00000">CSRK</font> </b> — Connection Signature Resolving Key.    .</li>
<li><b><font color="#C00000">RAND</font> </b> — 64-   ,    LTK</li>
<li><b><font color="#C00000">EDIV</font> </b> — 16-   ,    LTK</li>
<li><b><font color="#C00000">MITM</font> </b> — man-in-the-middle.                  .</li>
<li><b><font color="#C00000">Message </font><font color="#C00000">integrity </font></b> —    .</li>
<li><b><font color="#C00000"></font> </b> —         ,              .     BSP (board support package), HAL (hardware abstraction layer), OSA (OS abstraction layer),    (middleware)  :  ,  ,     .</li>
</ul><br>
<h1>  </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在为BLE选择芯片时，我对最著名的制造商的报价进行了小幅分析。</font><font style="vertical-align: inherit;">最重要的是，我对为ARM核心下的项目所建议的软件，框架和编译-组装-调试工具的组成感兴趣。</font><font style="vertical-align: inherit;">一个重要因素是IAR环境和</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RTOS MQX</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">框架的连续性，</font><font style="vertical-align: inherit;">这是在模块的主处理器上开发应用程序时使用的。</font></font><br>
<br>
<h2><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">北欧半导体</font></font></a></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它为芯片提供一个SDK </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nRF51822</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内核</font></font><font color="#C00000"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在Cortex</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><font color="#C00000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M0的</font></font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。在IAR，KEIL，GCC中进行编译。 BLE堆栈由没有源代码的整体库表示，该源代码称为</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SoftDevice</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其中所有API均已实现：GAP，GATT，L2CA，HCI。围绕该库构建了带有驱动程序的框架。该框架带有两个RTOS：</font><font style="vertical-align: inherit;">Keil的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RL-ARM RTX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FreeRTOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。该框架使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protobuf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">序列化</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">技术</font></a><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Segger RTT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调试</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此外，</font><b><font style="vertical-align: inherit;">还</font></b><font style="vertical-align: inherit;">提供了</font><b><font style="vertical-align: inherit;">nrf5 IoT SDK</font></b><font style="vertical-align: inherit;">。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它包括MQTT，COAP，TLS协议（取自MBED项目），cJSON，lwip（免费的TCP / IPv4 / IPv6协议栈），套接字接口，IPv6适配器的源代码。</font><font style="vertical-align: inherit;">还有</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6LoWPAN</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但没有源代码。</font></font><br>
<br>
<h2><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">德州仪器</font></font></a></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在ARM上，它仅制造2核BLE芯片</font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CC2640</font></font></a> </b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cortex-M3和Cortex-M0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），但相应的规格为</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bluetooth 4.2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。要下载，它提供了SDK </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleLink蓝牙低功耗软件堆栈2.2.0。</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它也是由Code Composer Studio自己的开发环境编译的在IAR环境中。它带有自己的RTOS </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TI-RTOS 2.16</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和围绕BLE堆栈库开发的框架。作为其中一种方案的SDK涉及使用外部应用程序处理器-简单应用程序处理器（SAP）。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CC2640</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">芯片</font><b><font style="vertical-align: inherit;">本身</font></b><font style="vertical-align: inherit;">称为简单网络处理器（SNP）。它们之间的通信是根据称为</font><b><font style="vertical-align: inherit;">统一网络处理器接口</font></b><font style="vertical-align: inherit;">的协议建立的</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（NPI）。</font><font style="vertical-align: inherit;">在CC2640端，必须使用TI-RTOS；在SAP处理器端，您可以自行决定使用RTOS。</font><font style="vertical-align: inherit;">NPI协议的源代码随SDK一起提供给SAP端和SNP端。</font><font style="vertical-align: inherit;">这是</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SimpleLink</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">技术</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BLE堆栈本身分为3个没有源的预编译库：主机，控制器，HCI。</font><font style="vertical-align: inherit;">所有这三个库仅在Cortex-M3处理器上工作，该处理器是CC2640芯片的一部分。</font><font style="vertical-align: inherit;">除了研究TI-RTOS，用户还需要研究一种特殊的软件机制或协议，以与称为iCall的BLE堆栈进行交互。</font></font><br>
<br>
<h2><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microchip Atmel</font></font></a></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font><b><font style="vertical-align: inherit;">Cortex-M0内核</font></b><font style="vertical-align: inherit;">上</font><font style="vertical-align: inherit;">制造</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ATBTLC1000</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蓝牙LE芯片</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">整个芯片堆栈都写入ROM。</font><font style="vertical-align: inherit;">在Atmel网站上找不到用于对这些芯片进行编程的开放工具。</font><font style="vertical-align: inherit;">相反，Atmel建议使用外部微控制器与ATBTLC1000进行交互。</font><font style="vertical-align: inherit;">Atmel软件框架中提供了用于外部微控制器的软件和示例。</font><font style="vertical-align: inherit;">在</font><b><font style="vertical-align: inherit;">Atmel Studio</font></b><font style="vertical-align: inherit;">（GCC的外壳）或IAR中进行编译。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<h2><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赛普拉斯半导体公司</font></font></a> </h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">产生在芯家族的可编程芯片BLE </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了Cortex-M0的</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对PSoC 4：</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对PSoC 4XX8</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的PRoC CYBL1XX7X</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持的说明书</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蓝牙4.2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。芯片项目是在特殊的IDE </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSoC Creator中创建的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">赛普拉斯的芯片的不同之处在于，没有现成的外设配置（UART，SPI，I2S，PWM等），必须通过电路编辑器中的库元素并添加软件库来创建它。</font><font style="vertical-align: inherit;">旨在提供一些灵活性。</font><font style="vertical-align: inherit;">尽管它为开发人员增加了很多工作。</font><font style="vertical-align: inherit;">可以通过以下工具链之一来编译已配置的项目：GCC，IAR，Keil。</font><font style="vertical-align: inherit;">BLE有一个库。</font><font style="vertical-align: inherit;">BLE堆栈作为预编译的整体库提供，而没有将BLE主机，BLE控制器和HCI结合在一起的源代码。</font><font style="vertical-align: inherit;">但是，该公司发布了使用BLE的Android和iOS应用程序的源代码。</font></font><br>
<br>
<h2><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">硅实验室</font></font></a></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基于</font><font style="vertical-align: inherit;">支持</font><b><font style="vertical-align: inherit;">蓝牙4.2</font></b><font style="vertical-align: inherit;">规范</font><font style="vertical-align: inherit;">的ARM </font><b><font style="vertical-align: inherit;">Cortex-M4内核</font></b><font style="vertical-align: inherit;">生产</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EFR32 Blue Gecko蓝牙智能SoC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">EFR32BG1P332F256GMxx</font></a><font style="vertical-align: inherit;">类型的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">芯片</font></a><font style="vertical-align: inherit;">可</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">提供</font></a><font style="vertical-align: inherit;">高达</font><b><font style="vertical-align: inherit;">19.5 dBm的</font></b><font style="vertical-align: inherit;">功率，</font><font style="vertical-align: inherit;">并结合了独立的868 MHz无线电信道，功率高达20 dBm，灵敏度为-121.4 dBm。 Silicon Labs芯片是多种可选的引脚功能以及一种称为</font><b><font style="vertical-align: inherit;">外围反射系统的系统</font></b></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（PRS）。尽管不能像赛普拉斯芯片那样创建外设，但是其与引脚的连接几乎是任意的，但是PRS的存在使得无需处理器就可以相互交互。 Silicon Labs BLE堆栈能够接受</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Bluetooth Developer Studio的</font></a><font style="vertical-align: inherit;">配置文件生成结果</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将在下面讨论。</font><font style="vertical-align: inherit;">Silicon Labs提供了两个蓝牙堆栈。</font><font style="vertical-align: inherit;">其中之一专为Bluegiga模块设计，除BLE外，还支持常规蓝牙。</font><font style="vertical-align: inherit;">第二个堆栈符合规范4.2，仅符合LE。</font><font style="vertical-align: inherit;">BLE堆栈作为无源的整体预编译库提供。</font><font style="vertical-align: inherit;">对于带有外部微控制器的选件，源中提供了串行协议和API。</font><font style="vertical-align: inherit;">GCC，IAR和Keil都可以编译。</font><font style="vertical-align: inherit;">一切都在一个开发环境</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simplicity Studio V4中完成</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">RTOS不支持随附的堆栈框架。</font><font style="vertical-align: inherit;">但是在Simplicity Studio的源代码中，您可以找到诸如8 kbps的Speex之类的珍珠，适合通过BLE传输语音以及来自Segger的强大的窗口GUI。</font></font><br>
 <br>
<h2><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">意法半导体</font></font></a></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据</font><b><font style="vertical-align: inherit;">蓝牙4.1</font></b><font style="vertical-align: inherit;">规范，</font><font style="vertical-align: inherit;">制造</font><font style="vertical-align: inherit;">包含BLE堆栈的</font><font style="vertical-align: inherit;">基于</font><b><font style="vertical-align: inherit;">Cortex-M0</font></b><font style="vertical-align: inherit;">的</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BlueNRG</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网络控制器芯片</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">
这些芯片本身不是可编程的，但是具有串行应用命令接口（ACI），外部微控制器必须通过该接口与它们进行通信。</font><font style="vertical-align: inherit;">已经为ACI开发了一个框架，该框架可以作为ST专有开发环境STM32Cube的一部分包含在内。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h2><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSR PLC</font></font></a></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并未在ARM Cortex上制造BLE芯片，但对在</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蓝牙</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模块</font><b><font style="vertical-align: inherit;">上</font></b><font style="vertical-align: inherit;">实现</font><b><font style="vertical-align: inherit;">MESH网络</font></b><font style="vertical-align: inherit;">感兴趣</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">视频在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这里</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">列出了适用于Android和iOS的各种BLE应用程序的源代码。</font><font style="vertical-align: inherit;">有一个SDK。</font></font><br>
 <br>
<h2><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">瑞萨</font></font></a></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在其16位</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RL78</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内核上制造BLE芯片</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">BLE堆栈仅颁发给高级用户。</font><font style="vertical-align: inherit;">各自拥有-编译器，RTOS，主机微控制器。</font><font style="vertical-align: inherit;">但是有一个用于</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Bluetooth Developer Studio</font></a><font style="vertical-align: inherit;">的插件</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><br>
<br>
<h2><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对话半导体</font></font></a></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他们声称提供</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了最小的BLE芯片</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。但是，不能将带有闪存</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DA14583</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（其余仅用于ROM）</font><font style="vertical-align: inherit;">的芯片</font><font style="vertical-align: inherit;">称为最小</font><font style="vertical-align: inherit;">芯片</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b><font style="vertical-align: inherit;">-5x5</font></b></a><font style="vertical-align: inherit;"> mm。的核心</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了Cortex-M0的</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。最大功率</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 dBm</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。支持</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蓝牙4.1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">规范</font><b><font style="vertical-align: inherit;">。</font></b><font style="vertical-align: inherit;">要从公司获得SDK，您需要注册并通过测试。但是有了这样的芯片参数，我什至没有尝试获得一个SDK。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，MQTT，COAP，TLS，SPEEX，LwIP等的来源。那些使用不同SDK的开发人员对我们没什么兴趣，可以在Github上免费找到它们，而无需绑定到特定框架。由于无法在PC上使用蓝牙4.2规范，因此对其的支持很少。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
像TI-RTOS这样的小众RTOS或特殊的调度程序将使我们难以掌握，我们试图避免此类决定。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我很高兴在Kinetis上选择了解决方案。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kinetis系列的NXP蓝牙LE堆栈有趣的是什么。</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与其他版本一样，Kinetis的BLE堆栈采用预编译库的形式。在这些库的周围，建立了一个多任务框架，该框架在源代码中包括驱动程序和一层硬件抽象，而与操作系统无关。可以将框架配置为在没有操作系统的情况下工作，或者可以使用它。立即交付，该框架适用于FreeRTOS。但是它通过一组辅助功能与FreeRTOS交互，这些辅助功能被称为操作系统的抽象层（OS抽象，OSA）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
借助OSA，您可以替代支持消息队列，抢占，标志和计时器的任何其他操作系统，而不是FreeRTOS。例如，RTOS MQX。奇怪的是，堆栈仅在IAR环境中编译。幸运的是，就我而言，这不是问题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
更有意思的是，堆栈分为两个库-BLE主机和BLE控制器。</font><font style="vertical-align: inherit;">BLE主机库可以在其他芯片上工作。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这种情况下，库通过HCI协议相互交互。</font><font style="vertical-align: inherit;">即 </font><font style="vertical-align: inherit;">在其他制造商提出另一种通信协议的情况下，恩智浦提供了标准解决方案，该协议用于将外部微控制器上的应用与BLE堆栈进行交互（请记住SimpleLink）。</font><font style="vertical-align: inherit;">最重要的是，通过这种方法，将BLE主机移至功能更强大的外部微控制器，我们大大提高了GATT数据库和服务的功能。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">简要介绍BLE</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
的蓝牙规范版本4.2版本的开放可</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在这里</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。较低的BLE级别（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">控制器</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">级别</font><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">的描述</font><font style="vertical-align: inherit;">作为</font><font style="vertical-align: inherit;">第2544页的</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第6 </font><b><font style="vertical-align: inherit;">卷核心系统软件包[低能耗控制器容量]”</font></b><font style="vertical-align: inherit;">包括在内。</font><font style="vertical-align: inherit;">具有ATT协议和GATT配置文件</font><font style="vertical-align: inherit;">的较高级别（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主机</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">级别</font><font style="vertical-align: inherit;">）位于</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ vol.3”中</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第1693页</font><b><font style="vertical-align: inherit;">上的</font></b><font style="vertical-align: inherit;">文档的</font><b><font style="vertical-align: inherit;">“核心系统软件包[主机卷]”</font></b><font style="vertical-align: inherit;">。使用的</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
频率范围</font></font><br>
<a href=""><img align="left" width="1010" src="https://habrastorage.org/getpro/geektimes/post_images/3fb/e8a/e0e/3fbe8ae0e3e35ab16e27593cef024fff.png"><br clear="left">
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（单击放大）</font></font></em></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当在设备之间建立逻辑通信通道时，将三个频率（在上图中由通道号37.38.39表示）分配给广播无地址包裹，其余三个频率分配给包传输。蓝牙的一个众所周知的特征是，在传输数据包时，每个后续数据包都以不同的频率传输，该频率是从允许的数据包列表中伪随机选择的。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BLE数据包中的所有数据都可以加密和认证。也使用设备地址的动态随机生成及其使用散列的标识，即空中截取了设备的地址后，我们将无法使用它超过15分钟的时间，因为在此期间，地址会根据我们未知的算法进行更改。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BLE模块可以用作单向发送器，即无需建立双向连接，只需以广告包的形式广播一些数据，例如温度。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">广告</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包中指定为“ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制造商特定数据</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”的数据类型可用于此目的</font><font style="vertical-align: inherit;">。一台计算机或平板电脑可以从数百个这样的发射机中接收数据，而无需进行不必要的搜索，建立连接，输入PIN码等预备步骤。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
无需安装通信通道即可传输数据的另一种可能性是在请求-响应模式下进行传输（请求是</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ScanRequest</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包</font><font style="vertical-align: inherit;">，模块的响应是</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ScanResponce</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包</font><font style="vertical-align: inherit;">）。此</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与</font><b><font style="vertical-align: inherit;">Wi-Fi</font></b><font style="vertical-align: inherit;">明显不同</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，即使对于最简单的温度计，也必须建立占用路由器资源的连接。 </font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE协议栈</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
下图显示了</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE，</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">就像微控制器程序员所看到的那样。 BLE堆栈由两个软件部分组成：</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Host</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controller</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主机</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">软件</font><font style="vertical-align: inherit;">处理组织和管理数据，连接的高级功能，而</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controller</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">管理收发器的物理外围设备，使用秘密密钥并处理其他低级功能。命名的部件通过</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HCI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主机控制器接口</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">软件接口连接</font><font style="vertical-align: inherit;">。在PC实现中，</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主机</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分</font><font style="vertical-align: inherit;">在计算机上运行，​​而</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">控制器</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分</font><font style="vertical-align: inherit;">在硬件收发器上运行</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蓝牙</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HCI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">协议</font><font style="vertical-align: inherit;">最常通过</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USB传输</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。在微控制器上的实现中，两个部分都在同一芯片上运行，并且</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HCI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接口</font><font style="vertical-align: inherit;">直接变成了从主机任务（软件模块）到控制器任务（软件模块）的直接数据传输，反之亦然。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实际上，程序员会看到几组在</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主机</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">级别上工作的API </font><font style="vertical-align: inherit;">：称为</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GATT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GAP，L2CA，SMP，HCI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。使用</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GAP API</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以设置设备的操作模式- </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中央，外围设备，观察者，广播者，</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并在必要时建立连接。并使用</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GATT API</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进行有用数据的直接发送和接收及其分析。</font></font><br>
<a href=""><img align="left" width="691" src="https://habrastorage.org/getpro/geektimes/post_images/4df/ce8/06a/4dfce806ac92c29f99024ede56bba3d6.png"><br clear="left">
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（单击放大）</font></font></em></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
尽管存在4.2版，但大多数现有设备当前都支持BLE 4.1。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
版本4.2与先前版本的所有差异都特别涉及BLE部分的改进：速度提高，传输IP协议和HTTP流量的能力，增强的密码保护和外部观察者无法识别的能力。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与Wi-Fi相比，BLE的一个重要功能不仅是通信通道的规范，还包括使用它的应用程序本身的规范。这称为配置文件和服务。具有服务的配置文件描述了设备的角色，数据的用途，数据的组成和格式，数据保护，交换的顺序，类型和事件，而不仅仅是数据的传输方式。这样，在开发体温传感器或脉搏计时，您就不必根据协议重新发明轮子。已经给出了规格，仅在设备侧保留用于发送测量结果的必填字段。以智能手机，平板电脑，PC或厨房电器等形式的此类设备的客户将自动识别此数据并显示或相应地使用它们。非常感谢所有制造商都遵循相同的BLE规范，有关如何显示温度或心率数据以及如何使用它们。但是，由于配置文件具有扩展功能的机制，因此开发人员仍然可以发挥想象力。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下是BLE设备中的属性的粗略层次结构。</font></font><br>
<a href=""><img align="left" width="609" src="https://habrastorage.org/getpro/geektimes/post_images/7df/ca0/0fe/7dfca00fe6427b57e47b1ba1e10c4767.png"><br clear="left">
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（单击放大）</font></font></em></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
下面是稍微更详细的典型属性树。这不是一棵完整的树；大多数树都被省略了，因为它会占用太多空间。颜色突出显示树级别，每个属性都有一个唯一的编号-UUID。记录标准编号减少为16位。在此图中，所有数字均为标准数字。 GAP和GATT配置文件也以其标准功能作为服务提供。每个服务可以具有其自己的安全模型和授权。设备中的整个树都存储为称为GATT数据库的数据库，通常以带有交叉引用的简单表的形式存储。</font></font><br>
<br>
<a href=""><img align="left" width="1010" src="https://habrastorage.org/getpro/geektimes/post_images/3b1/d8c/5e7/3b1d8c5e7718f9e8e334af7de0a694b7.png"><br clear="left">
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（点击放大）</font></font></em></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
服务特征具有许多特征，如下所示。</font><font style="vertical-align: inherit;">在这里，您必须为重言而道歉，但是在BLE中，确实存在某种术语危机。</font><font style="vertical-align: inherit;">总之，属于它的服务的特性可以指定读取，写入，通知，确认，签名等的需要。</font></font><br>
<br>
<a href=""><img align="left" width="752" src="https://habrastorage.org/getpro/geektimes/post_images/c7b/dd6/c8c/c7bdd6c8cc8b066c8390a00634a7927f.png"><br clear="left">
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（点击放大）</font></font></em></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
BLE是一项严肃的技术，为了确保安全性和最大程度的形式化已做了很多工作，这反过来又有助于实现兼容性。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BLE设备之间的数据交换是通过写入和读取特性值来进行的。</font><font style="vertical-align: inherit;">TCP或UART等流通道不在这里。</font><font style="vertical-align: inherit;">如果设备具有它们，则它们将由更高级别的软件附件进行组织。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开发工具</font></font></h1><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与特殊利益集团的建议网站开发工具是蓝牙（蓝牙SIG的）</font></font></b> <font color="#BA5555"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.bluetooth.com/develop-with-bluetooth/developer-resources-tools</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
该网站的标准化的主要组织- </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蓝牙SIG将</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供有用的工具：</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蓝牙开发者工作室</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bluetooth Developer Studio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是一种工具，可让您正确地将配置文件，服务，特征和描述符形成并将其插入</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设备</font><font style="vertical-align: inherit;">的实现中</font><font style="vertical-align: inherit;">，即创建一个数据库。如果您</font><font style="vertical-align: inherit;">以99美元的价格</font><font style="vertical-align: inherit;">购买额外的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">硬件蓝牙适配器</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则该</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">程序允许您拦截</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，解密和显示蓝牙协议数据包。该程序还具有调试和测试创建的服务的能力。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因为在</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE中</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会详细描述已批准的配置文件，甚至包括格式，编号，可访问性等方面的小错误。这些配置文件中的内容将导致兼容性问题。但是对于非标准配置文件，如果没有一种工具来准确地构建符合所有规范的服务，特征，描述符树的工具，这将非常困难。服务名称，特征，描述符及其多字节唯一编号</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-UUID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">容易引起混淆</font><font style="vertical-align: inherit;">。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该工具的结果尤其是生成的</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XML</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件描述了用户项目中的配置文件，服务，特征和描述符。这些XML文件由Silicon Labs Simplicity IDE直接使用，以集成到其芯片的嵌入式项目中。</font></font><br>
<br>
<a href=""><img align="left" width="1010" src="https://habrastorage.org/getpro/geektimes/post_images/a38/1de/850/a381de850e5724e57c5e607d78568eff.png"><br clear="left">
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（点击放大）</font></font></em></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该工具的另一个结果可能是使用</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库的设备的源代码</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">但是为此，用户需要使用</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JavaScript</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编写其插件</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该方案还通过特殊的提供了插件的用户访问数据库</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的JavaScript</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">许多现成的插件</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以生成各种源文本文件，这些文件适合在第三方环境和软件框架中进行编译。</font><font style="vertical-align: inherit;">尚无</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
基于</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">恩智浦Kinetis KW40Z连接软件</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">框架的解决方案</font><font style="vertical-align: inherit;">插件。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应用加速器</font></font></h2><br>
 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应用程序加速器2.1-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一组演示项目，带有用于不同</font></font><font color="#C00000"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android </font></font></b><font color="#C00000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></font><font style="vertical-align: inherit;"></font><font color="#C00000"><font style="vertical-align: inherit;"></font></font><font style="vertical-align: inherit;"></font><font color="#C00000"><font style="vertical-align: inherit;"></font></font><font style="vertical-align: inherit;"></font><font color="#C00000"><font style="vertical-align: inherit;"></font></font><font color="#C00000"><font style="vertical-align: inherit;"></font></font><font style="vertical-align: inherit;"></font><font color="#C00000"><font style="vertical-align: inherit;"></font></font><font color="#C00000"><font style="vertical-align: inherit;"></font></font><font style="vertical-align: inherit;"></font><font color="#C00000"><font style="vertical-align: inherit;"></font></font><font color="#C00000"><font style="vertical-align: inherit;"></font></font><font color="#C00000"><font style="vertical-align: inherit;"></font></font><font color="#C00000"><font style="vertical-align: inherit;"></font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作系统的源文本</font><font color="#C00000"><font style="vertical-align: inherit;">。</font></font><font color="#C00000"><font color="#C00000"><font style="vertical-align: inherit;">0</font></font></font><font color="#C00000"><font style="vertical-align: inherit;">，</font></font><font color="#C00000"><font color="#C00000"><font style="vertical-align: inherit;">Blackberry</font></font></font><font color="#C00000"><font style="vertical-align: inherit;">，</font></font><font color="#C00000"><font color="#C00000"><font style="vertical-align: inherit;">iOS </font></font></font><font color="#C00000"><font color="#C00000"><font style="vertical-align: inherit;">9</font></font></font><font color="#C00000"><font style="vertical-align: inherit;">，</font></font><font color="#C00000"><font color="#C00000"><font style="vertical-align: inherit;">Tizen </font></font></font><font color="#C00000"><font color="#C00000"><font style="vertical-align: inherit;">2</font></font></font><font color="#C00000"><font style="vertical-align: inherit;">。</font></font><font color="#C00000"><font color="#C00000"><font style="vertical-align: inherit;">4 </font></font></font><font color="#C00000"><font color="#C00000"><font style="vertical-align: inherit;">和</font></font></font><font color="#C00000"><font color="#C00000"><font style="vertical-align: inherit;">Windows </font></font></font><font color="#C00000"><font color="#C00000"><font style="vertical-align: inherit;">10</font></font></font><font style="vertical-align: inherit;">。对于</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows 10，</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">项目仅适用于</font><b><font style="vertical-align: inherit;">通用Windows平台（UWP）</font></b><font style="vertical-align: inherit;">体系结构</font><font style="vertical-align: inherit;">的</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visual Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开发环境</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">即这些项目不能在</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows窗体</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WPF</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> c </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.NET框架</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下进行编译</font><font style="vertical-align: inherit;">。以及将常规Windows应用程序转换为</font><b><font style="vertical-align: inherit;">UWP的</font></b><font style="vertical-align: inherit;">桥梁</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">刚刚被创建。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
应该注意的是，</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UWP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使得可以将应用程序放置在</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows应用商店中</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，但是它没有创建简单的可执行</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件，您可以简单地复制并运行该文件。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UWP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应用程序的首次启动</font><font style="vertical-align: inherit;">总是伴随着安装。</font><font style="vertical-align: inherit;">所有这些给开发人员带来了困难。</font><font style="vertical-align: inherit;">演示项目的功能还有很多不足之处。</font></font><br>
<br>
<a href=""><div style="text-align:center;"><img width="376" src="https://habrastorage.org/getpro/geektimes/post_images/fd8/213/747/fd82137474453134c3bd6744473908a8.png"></div><br clear="left">
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（单击放大）</font></font></em></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
上面是</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的唯一演示应用程序的屏幕截图</font><b><font style="vertical-align: inherit;"> -BLEServiceBrowser</font></b><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网关智能Smart刀套件</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网关智能入门套件</font></font></a> <font color="#BA5555"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></font><font style="vertical-align: inherit;"><font color="#000F00"><font color="#000F00"><font style="vertical-align: inherit;">到</font></font></font><font color="#000F00"><font color="#000F00"><font style="vertical-align: inherit;">WEB </font></font></font><font color="#000F00"><font color="#000F00"><font style="vertical-align: inherit;">服务器</font></font></font><font color="#000F00"><font color="#000F00"><font style="vertical-align: inherit;">的</font></font></font><font color="#000F00"><font color="#000F00"><font style="vertical-align: inherit;">BLE </font></font></font><font color="#000F00"><font color="#000F00"><font style="vertical-align: inherit;">设备</font></font></font><font color="#000F00"><font color="#000F00"><font style="vertical-align: inherit;">网关</font></font></font></font><font color="#000F00"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的项目，</font></font></b><font style="vertical-align: inherit;"><font color="#000F00"><font style="vertical-align: inherit;">以及</font></font></font><font color="#000F00"><font style="vertical-align: inherit;"></font></font><font color="#000F00"><font style="vertical-align: inherit;"></font></font><font color="#000F00"><font style="vertical-align: inherit;"></font></font><font color="#000F00"><font style="vertical-align: inherit;"></font></font><font color="#000F00"><font style="vertical-align: inherit;"></font></font><font color="#000F00"><font style="vertical-align: inherit;"></font></font><font color="#000F00"><font style="vertical-align: inherit;"></font></font><font color="#000F00"><font style="vertical-align: inherit;"></font></font><font color="#000F00"><font style="vertical-align: inherit;"></font></font><font color="#000F00"><font style="vertical-align: inherit;"></font></font> </font><font color="#000F00"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现</font></font></font><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">BLE</font></b><font style="vertical-align: inherit;">设备</font><font style="vertical-align: inherit;">网络</font></font><font color="#000F00"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户</font></font></font><font color="#000F00"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">界面</font></font></font><font style="vertical-align: inherit;"><font color="#000F00"><font color="#000F00"><font style="vertical-align: inherit;">的</font></font></font><font color="#000F00"><font color="#000F00"><font style="vertical-align: inherit;">WEB </font></font></font><font color="#000F00"><font color="#000F00"><font style="vertical-align: inherit;">服务器本身</font></font></font><font color="#000F00"><font style="vertical-align: inherit;">的项目</font></font><font style="vertical-align: inherit;">。一切都在Node.js中实现。建议在</font><font style="vertical-align: inherit;">具有</font><b><font style="vertical-align: inherit;">Raspbian Jessie</font></b><font style="vertical-align: inherit;">操作系统</font><font style="vertical-align: inherit;">的</font><b><font style="vertical-align: inherit;">Raspberry Pi 2 B型</font></b><font style="vertical-align: inherit;">微型计算机上进行</font><b><font style="vertical-align: inherit;">部署</font></b><font style="vertical-align: inherit;">。将</font><b><font style="vertical-align: inherit;">Raspberry Pi</font></b><font style="vertical-align: inherit;">直接连接</font><font style="vertical-align: inherit;">到</font><b><font style="vertical-align: inherit;">BLE</font></b><font style="vertical-align: inherit;">设备</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">套接字</font><font style="vertical-align: inherit;">的</font><b><font style="vertical-align: inherit;">Bluetooth HCI</font></b><font style="vertical-align: inherit;">接口到</font><b><font style="vertical-align: inherit;">L2CAP</font></b><font style="vertical-align: inherit;">级别</font><font style="vertical-align: inherit;">和</font><b><font style="vertical-align: inherit;">USB HCI</font></b></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适配器。</font><font style="vertical-align: inherit;">要在</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下运行</font><b><font style="vertical-align: inherit;">，</font></b><font style="vertical-align: inherit;">您需要为标准的</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蓝牙HCI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">驱动程序安装特殊的替代品</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">由于有限的HCI驱动程序，该解决方案只能在非常有限的几种类型的硬件适配器上运行。</font></font><br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/156/371/75e/15637175e9313970bef4ee048bc18b56.png"> <br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">佩里顿</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在商业工具中，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perytons的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个有趣的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">BLE流量分析器是</font></a><font style="vertical-align: inherit;">分析器程序，该分析器可在</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows PC</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上运行，</font><font style="vertical-align: inherit;">从版本7开始。</font><font style="vertical-align: inherit;">这一点很重要，因为Windows的本地BLE驱动程序仅从版本8开始工作。</font><font style="vertical-align: inherit;">该分析仪仅可使用有限</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的硬件BLE适配器列表</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用适配器时，由于BLE中的流量加密而导致的分析限制也很有限。</font></font><br>
<br>
<a href=""><img align="left" width="1010" src="https://habrastorage.org/getpro/geektimes/post_images/1e3/c09/488/1e3c094883e576474a719aff13a0b422.png"><br clear="left">
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（点击放大）</font></font></em></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，即使从该程序的试用版中，您也可以获得很多好处。</font><font style="vertical-align: inherit;">该程序随附了交换真实设备的拦截的示范记录。</font><font style="vertical-align: inherit;">这些记录在加载到程序中后，会给出整个BLE协议栈操作的详细信息。</font><font style="vertical-align: inherit;">查看一个这样的拦截将替代探索整个蓝牙规范。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">巴士猎犬</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您只需要监控计算机与BLE设备之间的活动，而无需对协议进行详细分析，则可以执行众所周知的Windows驱动程序流量拦截器</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bus Hound</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在下面的屏幕截图中，您可以看到收到的广告包的流。</font><font style="vertical-align: inherit;">分组接收时间间隔的不均匀性清晰可见。</font><font style="vertical-align: inherit;">这表明大量的数据包丢失。</font><font style="vertical-align: inherit;">BLE设备的超时间隔设置为20 ms。</font></font><br>
<br>
<a href=""><img align="left" width="784" src="https://habrastorage.org/getpro/geektimes/post_images/302/242/408/30224240815c37125998cb7eabbb7184.png"><br clear="left">
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（单击放大）</font></font></em></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
下面</font><a href=""><em><font style="vertical-align: inherit;">的</font></em></a><font style="vertical-align: inherit;">屏幕快照显示了与PC配对后的“总线猎犬”窗口中BLE设备的图示。</font><font style="vertical-align: inherit;">对于每个设备服务，在对等之后，会出现一个逻辑通信通道。</font><font style="vertical-align: inherit;">在这里，您可以看到设备和服务的UUID。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/0ac/28d/99d/0ac28d99d49e38dea38c2da5caa46658.png"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE流量分析器（嗅探器）USB-KW40Z</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是Kinetis开发支持工具包中的工具。因此，我将更详细地介绍它。</font><font style="vertical-align: inherit;">恩智浦</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嗅探器页面</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/ef1/108/1c9/ef11081c9b38097c1b2fdcd91cb01094.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该嗅探器由NXP（或更确切地说是以前的飞思卡尔）开发，可以在流行的在线无线电组件商店中廉价购买：Mouser，Digi-Key，Farnell ... NXP提供它作为监视BLE设备发送的无线电数据包的工具。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用此设备，您可以研究数据包的结构，将其记录在日志中，并分析流量密度。嗅探器电路尚待研究，但微控制器程序以二进制文件形式提供。嗅探器允许您按地址值过滤数据包。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
下载PC软件嗅探器在下面的搜索查询在线</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.nxp.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kinetis_Protocol_Analyzer_Adapter.exe</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
因为嗅探器除了主要的功能可以更和调试平台的各种应用，附在其上的二进制文件基础固件与您可以在实验后还原嗅探器功能。这些文件都与包</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KW40Z连接软件</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这是从网站上下载</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.nxp.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索查询KW40Z_Connectivity_Software。这些文件将被称为</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sniffer_processing_core_usbkw40z_k22f.bin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（用于嗅探板上的MK22FN512微控制器）和</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sniffer_radio_core_usbkw40z_kw40z.bin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（用于嗅探板上的MKW40Z微控制器）。使用SWD调试器对文件进行编程：JLink，STLink，OpenSDA ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在PC端，根据规范，该设备被视为具有一个COM端口和一个调试端口的复合USB设备，带有CMSIS-DAP固件的OpenSDA。因此，在IAR环境中，您可以使用其他MK22FN512芯片作为调试适配器功能的载体，对MKW40Z嗅探器芯片进行自由编程和调试。但是板上的两个芯片都具有用于外部调试适配器的标准SWD连接器。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
嗅探器不能保证接收到所有在空中传输的数据包。泛洪很容易，然后它停止接受任何数据包，因此建议启用按地址过滤，以便仅从感兴趣的节点接收流量非常少的数据包。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下窗口显示了软件包分析器程序。该窗口包括在所有三个通道上的拦截：（</font></font><br>
<br>
<a href=""><img align="left" width="746" src="https://habrastorage.org/getpro/geektimes/post_images/900/756/ae8/900756ae87aa2a06256d83774460fbd5.png"><br clear="left">
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单击放大）</font></font></em></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
在PC上安装分析仪软件时，它将创建一个虚拟以太网适配器，该适配器将通过虚拟嗅探器COM端口拍摄的数据包转换为以太网数据包。就我而言，这样的虚拟适配器会自动收到一个简单的名称-以太网。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要查看数据包，您还需要安装Wireshark以太网数据包嗅探器程序。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
监视流量时，Wireshark程序主窗口的视图。</font><font style="vertical-align: inherit;">Wireshark详细描述了链路层（LE LL）协议数据包的所有位字段，但是，在设备之间建立连接并启动L2CAP协议后，由于已加密传输数据包内容，因此无法识别该数据包内容。</font></font><br>
<br>
<a href=""><img align="left" width="736" src="https://habrastorage.org/getpro/geektimes/post_images/762/d12/cde/762d12cdec62b23d94b1f5e254d19c4f.png"><br clear="left">
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（点击放大）</font></font></em></a><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wireshark窗口视图，带有广告包的解码</font></font></b><div class="spoiler_text"><a href=""><img align="left" width="745" src="https://habrastorage.org/getpro/geektimes/post_images/37a/bbd/8ba/37abbd8ba6306e22b6c2dbd50e92f3c2.png"><br clear="left">
<em>(  )</em></a><br>
<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">扫描请求包装内容</font></font></b><div class="spoiler_text"><a href=""><img align="left" width="740" src="https://habrastorage.org/getpro/geektimes/post_images/5d7/4fb/fd5/5d74fbfd589f42c9ebaed86c0bef7f3a.png"><br clear="left">
<em>(  )</em></a><br>
<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">扫描响应包内容</font></font></b><div class="spoiler_text"><a href=""><img align="left" width="741" src="https://habrastorage.org/getpro/geektimes/post_images/012/627/201/012627201de64dfc530926aa9241c20c.png"><br clear="left">
<em>(  )</em></a><br>
<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接请求数据包的内容，其参数确定通信通道的速度</font></font></b><div class="spoiler_text"><a href=""><img align="left" width="755" src="https://habrastorage.org/getpro/geektimes/post_images/7a8/032/eeb/7a8032eeb21f6834f6f9bfc19d6bfd8e.png"><br clear="left">
<em>(  )</em></a><br>
<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接数据包序列</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/getpro/geektimes/post_images/7e7/baf/5c9/7e7baf5c91ecdc461aa878c8148a6d48.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
欢迎对本文中的信息进行评论，添加，更正和反对。</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN394757/">https://habr.com/ru/post/zh-CN394757/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN394747/index.html">AlphaGo将与中国冠军柯洁一起比赛</a></li>
<li><a href="../zh-CN394749/index.html">蜂窝网络核心中的关键漏洞</a></li>
<li><a href="../zh-CN394751/index.html">柱罩制造：材料概述</a></li>
<li><a href="../zh-CN394753/index.html">程序员游戏</a></li>
<li><a href="../zh-CN394755/index.html">物理知识有助于击败轮盘赌赌场</a></li>
<li><a href="../zh-CN394759/index.html">美国国防部如何保护士兵的耳朵</a></li>
<li><a href="../zh-CN394761/index.html">信用卡大小的“ Morecard”无线适配器将使iPhone同时保留在两个运营商的网络中</a></li>
<li><a href="../zh-CN394767/index.html">信使“吞噬”电信运营商，他们正在准备报复性罢工</a></li>
<li><a href="../zh-CN394769/index.html">人工系统的光合作用效率超过天然叶片</a></li>
<li><a href="../zh-CN394771/index.html">地球上的ISS模型</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>