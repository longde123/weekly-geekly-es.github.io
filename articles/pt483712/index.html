<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ ğŸ‘¨ğŸ½â€ğŸ« ğŸŒ¿ HighLoad ++, Yuri Nasretdinov (VK): como o VK insere dados no ClickHouse de dezenas de milhares de servidores ğŸ¦‚ ğŸ§‘ğŸ¾â€ğŸ¤â€ğŸ§‘ğŸ½ ğŸ‘ğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="HighLoad ++ Moscow 2018, sala de congressos. 9 de novembro, 15:00 

 Resumos e apresentaÃ§Ã£o: http://www.highload.ru/moscow/2018/abstracts/4066 

 Yuri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>HighLoad ++, Yuri Nasretdinov (VK): como o VK insere dados no ClickHouse de dezenas de milhares de servidores</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/483712/">  HighLoad ++ Moscow 2018, sala de congressos.  9 de novembro, 15:00 <br><br>  Resumos e apresentaÃ§Ã£o: <a href="http://www.highload.ru/moscow/2018/abstracts/4066">http://www.highload.ru/moscow/2018/abstracts/4066</a> <br><br>  Yuri Nasretdinov (VKontakte): o relatÃ³rio abordarÃ¡ a experiÃªncia de implementaÃ§Ã£o do ClickHouse em nossa empresa - por que precisamos disso, quantos dados armazenamos, como escrevemos e assim por diante. <br><br><img src="https://habrastorage.org/webt/82/hn/hb/82hnhbxzvzseq8_viregjypt_ms.jpeg"><br><br>  Recursos adicionais: <a href="https://habr.com/ru/company/ua-hosting/blog/483112/">Usando o Clickhouse como um substituto para ELK, Big Query e TimescaleDB</a> <a name="habracut"></a><br><br>  <b>Yuri Nasretdinov:</b> - OlÃ¡ pessoal!  Meu nome Ã© Yuri Nasretdinov, como eles jÃ¡ me apresentaram.  Eu trabalho na VKontakte.  Vou falar sobre como inserimos dados no â€œClickHouseâ€ da nossa frota de servidores (dezenas de milhares). <br><br><h3>  O que sÃ£o logs e por que coletÃ¡-los? </h3><br>  Sobre o que falaremos: o que fizemos, por que precisÃ¡vamos do â€œClickHouseâ€, respectivamente - por que o escolhemos, que tipo de desempenho vocÃª pode obter aproximadamente sem configurar nada especificamente.  Vou falar mais sobre tabelas de buffer, sobre os problemas que tivemos com elas e sobre nossas soluÃ§Ãµes que desenvolvemos de cÃ³digo aberto - KittenHouse e Lighthouse. <br><br><img src="https://habrastorage.org/webt/j8/gj/qv/j8gjqvhcihgkbedpsmonpxznjto.jpeg"><br><br>  Por que precisamos fazer alguma coisa (no VKontakte tudo estÃ¡ sempre bem, certo?).  QuerÃ­amos coletar logs de depuraÃ§Ã£o (e havia centenas de terabytes de dados lÃ¡), talvez, de alguma forma, seja mais conveniente ler as estatÃ­sticas;  e temos dezenas de milhares de servidores a partir dos quais tudo isso precisa ser feito. <br><br><img src="https://habrastorage.org/webt/pc/og/3w/pcog3wkh42pnfsdpwshhnu-1xqa.jpeg"><br><br>  Por que decidimos?  Provavelmente tÃ­nhamos soluÃ§Ãµes para armazenar logs.  Aqui - existe um pÃºblico "Backend VK".  Eu recomendo assinar. <br><br><img src="https://habrastorage.org/webt/15/xd/b3/15xdb3ma4wv43trpduxyujyo1w0.jpeg"><br><br>  O que sÃ£o logs?  Este Ã© um mecanismo que retorna matrizes vazias.  Motores em "VK" sÃ£o o que outros chamam de microsserviÃ§os.  E esse adesivo estÃ¡ sorrindo (muitas curtidas).  Como assim?  Bem, ouÃ§a! <br><br><img src="https://habrastorage.org/webt/xm/xr/rf/xmxrrfccutg7p6ylcy9-zoyi8ba.jpeg"><br><br>  O que pode ser usado para armazenar logs em geral?  Ã‰ impossÃ­vel nÃ£o mencionar o Khadup.  Em seguida, por exemplo, Rsyslog (armazenamento nos arquivos desses logs).  LSD  Quem sabe o que Ã© LSD?  NÃ£o, esse LSD nÃ£o.  Os arquivos tambÃ©m sÃ£o armazenados, respectivamente.  Bem, ClickHouse Ã© uma versÃ£o estranha de algum tipo. <br><br><h3>  Clickhouse e concorrentes: requisitos e oportunidades </h3><br>  O que nÃ³s queremos?  Queremos que nÃ£o precisemos tomar um banho de vapor especial com a operaÃ§Ã£o, para que ele funcione imediatamente da caixa, com configuraÃ§Ã£o mÃ­nima.  Queremos escrever muito e escrever rÃ¡pido.  E queremos mantÃª-lo todos os meses, anos, ou seja, por um longo tempo.  Podemos querer resolver algum tipo de problema que eles vieram atÃ© nÃ³s, eles disseram: "Algo nÃ£o funciona aqui para nÃ³s", mas isso foi hÃ¡ 3 meses) e queremos ser capazes de vÃª-lo hÃ¡ trÃªs meses "  CompactaÃ§Ã£o de dados - Ã© compreensÃ­vel por que serÃ¡ uma vantagem - porque a quantidade de espaÃ§o ocupado Ã© reduzida. <br><br><img src="https://habrastorage.org/webt/ho/f7/bs/hof7bsmyf40jzgxireygut6jpks.jpeg"><br><br>  E temos um requisito tÃ£o interessante: Ã s vezes escrevemos a saÃ­da de alguns comandos (por exemplo, logs), que podem ter mais de 4 kilobytes com bastante calma.  E se isso funcionar no UDP, nÃ£o serÃ¡ necessÃ¡rio gastar ... nÃ£o haverÃ¡ "sobrecarga" para a conexÃ£o e, para um grande nÃºmero de servidores, isso serÃ¡ uma vantagem. <br><br><img src="https://habrastorage.org/webt/jh/pj/3i/jhpj3iedzogld0galjmia2npwe4.jpeg"><br><br>  Vamos ver o que o cÃ³digo aberto oferece para nÃ³s.  Em primeiro lugar, temos um mecanismo de logs - este Ã© o nosso mecanismo;  ele basicamente sabe tudo, atÃ© longas filas podem escrever.  Bem, ele nÃ£o comprime os dados de forma transparente - podemos comprimir grandes colunas se quisermos ... Ã© claro que nÃ£o queremos (se possÃ­vel).  O Ãºnico problema Ã© que ele sÃ³ pode doar o que Ã© colocado em sua memÃ³ria;  o resto, para ler, vocÃª precisa obter o binlog desse mecanismo e, consequentemente, leva um bom tempo. <br><br><img src="https://habrastorage.org/webt/ps/uk/f5/psukf5cng6yokwi5cbtvvrfry30.jpeg"><br><br>  Quais sÃ£o as outras opÃ§Ãµes?  Por exemplo, Khadup.  Facilidade de uso ... Quem acredita que o Hadoup Ã© fÃ¡cil de configurar?  Com a gravaÃ§Ã£o, Ã© claro, nÃ£o hÃ¡ problemas.  Com a leitura, Ã s vezes surgem perguntas.  Em princÃ­pio, eu diria que provavelmente nÃ£o, especialmente para os logs.  Armazenamento de longo prazo - Ã© claro, sim, compactaÃ§Ã£o de dados - sim, longas filas - Ã© claro que vocÃª pode escrever.  Mas para gravar de um grande nÃºmero de servidores ... De qualquer forma, precisamos fazer algo sozinhos! <br><br>  Rsyslog.  Na verdade, nÃ³s o usamos como um substituto, para que fosse possÃ­vel ler um binlog sem despejo, mas nÃ£o conseguia gravar em linhas longas; em princÃ­pio, nÃ£o conseguia escrever mais de 4 kilobytes.  A compactaÃ§Ã£o de dados deve ser feita da mesma maneira.  A leitura irÃ¡ dos arquivos. <br><br><img src="https://habrastorage.org/webt/nt/xo/k3/ntxok3kz6sqyggmdlctpxrokprs.jpeg"><br><br>  Depois, hÃ¡ o desenvolvimento "ruim" do LSD.  O mesmo Ã© essencialmente o mesmo que o â€œRsyslogâ€: ele suporta linhas longas, mas nÃ£o sabe como usar o UDP e, de fato, por causa disso, infelizmente, hÃ¡ muitas coisas para reescrever lÃ¡.  O LSD precisa ser refeito para que vocÃª possa gravar a partir de dezenas de milhares de servidores. <br><br><img src="https://habrastorage.org/webt/2s/xr/fw/2sxrfwyzgj72wfqblvhlu8fphf0.jpeg"><br><br>  Ah aqui!  Uma opÃ§Ã£o divertida Ã© o ElasticSearch.  Bem, como dizer?  EstÃ¡ tudo bem com a leitura, ou seja, ele lÃª rapidamente, mas nÃ£o muito bem com a escrita.  Em primeiro lugar, se comprimir os dados, Ã© muito fraco.  Provavelmente, uma pesquisa completa requer mais estruturas de dados volumosas que o volume original.  Ã‰ difÃ­cil de explorar, muitas vezes surgem problemas com ela.  E, novamente, uma entrada no "ElÃ¡stico" - todos nÃ³s devemos fazer isso sozinhos. <br><br><img src="https://habrastorage.org/webt/wb/uv/ik/wbuvikg6tm42r0pjhkrtdrcye08.jpeg"><br><br>  Aqui ClickHouse - a opÃ§Ã£o ideal, Ã© claro.  A Ãºnica coisa Ã© que gravar de dezenas de milhares de servidores Ã© um problema.  Mas ela Ã© pelo menos uma, podemos tentar resolver de alguma forma.  E o restante do relatÃ³rio Ã© sobre esse problema.  Qual o desempenho geral do ClickHouse que vocÃª pode esperar? <br><br><h3>  Como vamos incorporar?  MergeTree </h3><br>  Quantos de vocÃªs nÃ£o ouviram falar do ClickHouse, nÃ£o sabem?  Precisa dizer, nÃ£o Ã© necessÃ¡rio?  Muito rapido  A inserÃ§Ã£o de 1-2 gigabits por segundo, rajadas de atÃ© 10 gigabits por segundo podem realmente suportar essa configuraÃ§Ã£o - existem dois Xeons de 6 nÃºcleos (isto Ã©, nem os mais poderosos), 256 gigabytes de RAM, 20 terabytes por RAID (ninguÃ©m configurado, configuraÃ§Ãµes padrÃ£o).  Alexey Milovidov, desenvolvedor do ClickHouse, provavelmente chorando, que nÃ£o configuramos nada (tudo funcionou assim para nÃ³s).  Consequentemente, uma velocidade de varredura de, por exemplo, cerca de 6 bilhÃµes de linhas por segundo pode ser obtida se os dados estiverem bem compactados.  Se vocÃª gosta de% em uma linha de texto, 100 milhÃµes de linhas por segundo, isto Ã©, parece muito rapidamente. <br><br><img src="https://habrastorage.org/webt/mu/m0/ih/mum0ihdgejlxldsd9id8ijjytx8.jpeg"><br><br>  Como vamos incorporar?  Bem, vocÃª sabe disso em "VK" - em PHP.  NÃ³s, de cada trabalhador PHP, colaremos o HTTP no "ClickHouse", na placa MergeTree para cada entrada.  Quem vÃª o problema neste circuito?  Por alguma razÃ£o, nem todos levantaram as mÃ£os.  Vamos te contar. <br><br>  Em primeiro lugar, existem muitos servidores - consequentemente, haverÃ¡ muitas conexÃµes (ruins).  EntÃ£o, no MergeTree, Ã© melhor inserir dados nÃ£o mais que uma vez por segundo.  E quem sabe o porquÃª?  Ok, bom.  Vou falar um pouco mais sobre isso.  Outra questÃ£o interessante Ã© que nÃ³s, por assim dizer, nÃ£o estamos fazendo anÃ¡lises, nÃ£o precisamos enriquecer os dados, nÃ£o precisamos de servidores intermediÃ¡rios, queremos incorporar diretamente no "ClickHouse" (de preferÃªncia - quanto mais reto, melhor). <br><br><img src="https://habrastorage.org/webt/2r/im/hz/2rimhzqo0cxkonc8paf7pi2qae0.jpeg"><br><br>  Assim, como a inserÃ§Ã£o Ã© implementada no MergeTree?  Por que Ã© melhor inseri-lo nÃ£o mais que uma vez por segundo ou menos?  O fato Ã© que "ClickHouse" Ã© um banco de dados colunar e classifica os dados em ordem crescente da chave primÃ¡ria e, quando vocÃª insere, o nÃºmero de arquivos Ã© criado por pelo menos o nÃºmero de colunas nas quais os dados sÃ£o classificados em ordem crescente da chave primÃ¡ria (um diretÃ³rio separado Ã© criado, um conjunto de arquivos em disco para cada inserÃ§Ã£o).  Em seguida, a prÃ³xima inserÃ§Ã£o serÃ¡ inserida e, em segundo plano, eles se fundirÃ£o em uma "partiÃ§Ã£o" maior.  Como os dados sÃ£o classificados, vocÃª pode "manipular" dois arquivos classificados sem consumir muito memÃ³ria. <br><br>  Mas, como vocÃª pode imaginar, se vocÃª escrever 10 arquivos para cada inserÃ§Ã£o, o â€œClickHouseâ€ terminarÃ¡ rapidamente (ou seu servidor); portanto, Ã© recomendÃ¡vel inserir em pacotes grandes.  Consequentemente, nunca lanÃ§amos o primeiro esquema em produÃ§Ã£o.  LanÃ§amos imediatamente um nÃºmero 2 aqui: <br><br><img src="https://habrastorage.org/webt/7z/0d/yt/7z0dytuytercg92yrt1nu3tpczw.jpeg"><br><br>  Imagine aqui que existem cerca de mil servidores nos quais lanÃ§amos, hÃ¡ apenas PHP.  E em cada servidor existe o nosso agente local, que chamamos de â€œKittenhouseâ€, que mantÃ©m uma conexÃ£o com o â€œClickHouseâ€ e insere dados a cada poucos segundos.  Ele nÃ£o insere dados no MergeTree, mas na tabela de spooler, que serve para nÃ£o inserir diretamente no MergeTree imediatamente. <br><br><img src="https://habrastorage.org/webt/zu/ok/g1/zuokg1unbbwdege3mpsckf8npme.jpeg"><br><br><h3>  Trabalhar com tabelas de buffer </h3><br>  O que Ã© isso  As tabelas de buffer sÃ£o uma parte da memÃ³ria embaralhada (ou seja, Ã© possÃ­vel inseri-las frequentemente).  Eles consistem em vÃ¡rias partes, e cada uma delas funciona como um buffer independente e liberadas independentemente (se vocÃª tiver muitas partes no buffer, haverÃ¡ muitas inserÃ§Ãµes por segundo).  VocÃª pode ler nessas tabelas - depois vocÃª lÃª a uniÃ£o do conteÃºdo do buffer e da tabela pai, mas nesse momento o registro Ã© bloqueado, portanto, Ã© melhor nÃ£o ler a partir daÃ­.  E um QPS muito bom Ã© mostrado pelas tabelas de buffer, ou seja, atÃ© 3 mil QPS, vocÃª nÃ£o terÃ¡ nenhum problema com a inserÃ§Ã£o.  Ã‰ claro que, se a energia foi perdida no servidor, os dados podem ser perdidos, porque eles foram armazenados apenas na memÃ³ria. <br><br><img src="https://habrastorage.org/webt/4p/rg/l1/4prgl1wcijnrxs6zcgz2gmybvec.jpeg"><br><br>  Ao mesmo tempo, o esquema com o buffer Ã© complicado por ALTER, porque vocÃª primeiro precisa descartar a tabela de buffer antiga com o esquema antigo (os dados nÃ£o serÃ£o perdidos ao mesmo tempo, porque serÃ£o liberados antes da exclusÃ£o da tabela).  Em seguida, vocÃª "altera" a tabela necessÃ¡ria e cria a tabela de buffer novamente.  Assim, enquanto nÃ£o hÃ¡ tabela de buffer, seus dados nÃ£o fluem em lugar algum, mas vocÃª pode atÃ© localmente no disco. <br><br><img src="https://habrastorage.org/webt/nv/vx/ek/nvvxekkpy2bcezjpuylifhcworq.jpeg"><br><br><h3>  O que Ã© o Kittenhouse e como ele funciona? </h3><br>  O que Ã© o KittenHouse?  Este Ã© um proxy.  Adivinha qual idioma?  Eu coletei os tÃ³picos com mais hype no meu relatÃ³rio - este Ã© "Clickhouse", VÃ¡, talvez eu me lembre de outra coisa.  Sim, estÃ¡ escrito em Go, porque eu realmente nÃ£o sei escrever em C, nÃ£o quero. <br><br><img src="https://habrastorage.org/webt/6r/1w/th/6r1wthqhe4flw_7t7ww01s5arug.jpeg"><br><br>  Por conseguinte, mantÃ©m uma conexÃ£o com cada servidor, pode gravar na memÃ³ria.  Por exemplo, se escrevermos logs de erro em â€œClickhouseâ€, se â€œClickhouseâ€ nÃ£o tiver tempo para inserir dados (afinal, se muitos forem gravados), nÃ£o incharemos de memÃ³ria - simplesmente jogamos fora o resto.  Porque, se escrevermos vÃ¡rios gigabits por segundo de erros, provavelmente poderemos lanÃ§ar alguns.  Kittenhouse sabe como.  AlÃ©m disso, ele sabe como entregar de maneira confiÃ¡vel, ou seja, grava em um disco na mÃ¡quina local e de vez em quando (lÃ¡, uma vez em alguns segundos) tenta entregar dados desse arquivo.  E, a princÃ­pio, usamos o formato normal de valores - nÃ£o algum formato binÃ¡rio, formato de texto (como no SQL regular). <br><br><img src="https://habrastorage.org/webt/rj/2q/z3/rj2qz3hcwcur_lvha_tc2mxjpwq.jpeg"><br><br>  Mas entÃ£o isso aconteceu.  Usamos entrega confiÃ¡vel, escrevemos logs e decidimos (era um cluster de teste condicional) ... Por vÃ¡rias horas, eles a lanÃ§aram e levantaram de volta, e houve uma inserÃ§Ã£o de milhares de servidores - descobriu-se que o Clickhouse ainda tinha um â€œThread on conexÃ£o â€- consequentemente, em mil conexÃµes, a inserÃ§Ã£o ativa leva a uma carga mÃ©dia no servidor de cerca de mil e meia.  Surpreendentemente, o servidor aceitou solicitaÃ§Ãµes, mas esses dados foram inseridos apÃ³s algum tempo;  mas foi muito difÃ­cil para o servidor atendÃª-lo ... <br><br><h3>  Adicionar nginx </h3><br>  Essa soluÃ§Ã£o para o modelo Thread por conexÃ£o Ã© nginx.  Colocamos o nginx na frente da Clickhouse, ao mesmo tempo, definimos o balanceamento para duas rÃ©plicas (aumentamos a velocidade de inserÃ§Ã£o em 2 vezes, embora nÃ£o seja o fato de que deveria ser assim) e limitamos o nÃºmero de conexÃµes Ã  Clickhouse, Ã  montante e, consequentemente, mais do que em 50 compostos, parece nÃ£o fazer sentido inserir. <br><br><img src="https://habrastorage.org/webt/7i/ib/9b/7iib9bduvmhr6taouopwj20zzsu.jpeg"><br><br>  EntÃ£o percebemos que, em geral, esse esquema tem desvantagens, porque temos um nginx aqui.  Portanto, se esse nginx estabelecer, apesar da presenÃ§a de rÃ©plicas, perdemos dados ou, pelo menos, nÃ£o escrevemos em lugar algum.  Portanto, fizemos nosso balanceamento de carga.  TambÃ©m entendemos que o â€œClickhouseâ€ ainda Ã© adequado para logs, e o â€œdemÃ´nioâ€ tambÃ©m comeÃ§ou a escrever seus prÃ³prios logs no â€œClickhouseâ€ tambÃ©m - muito conveniente, para ser honesto.  Ainda o usamos para outros "demÃ´nios". <br><br><img src="https://habrastorage.org/webt/px/o4/v3/pxo4v3tnrrxwye_tjavgb2p3kgu.jpeg"><br><br>  Eles descobriram um problema tÃ£o interessante: se vocÃª usar uma maneira nÃ£o muito padrÃ£o de inserir no modo SQL, um analisador completo baseado em SQL AST serÃ¡ forÃ§ado, o que Ã© bastante lento.  Assim, adicionamos configuraÃ§Ãµes para que isso nunca aconteÃ§a.  Fizemos balanceamento de carga, verificaÃ§Ãµes de integridade, para que, se alguÃ©m morrer, ainda deixemos os dados.  Temos tabelas suficientes para que possamos ter diferentes clusters de "Clickhouse".  E comeÃ§amos a pensar em outros usos - por exemplo, querÃ­amos gravar logs dos mÃ³dulos nginx e eles nÃ£o podem se comunicar usando nosso RPC.  Bem, eu gostaria de ensinÃ¡-los de alguma forma a enviar - por exemplo, via UDP para receber eventos no host local e enviÃ¡-los para o â€œClickhouseâ€. <br><br><h3>  Um passo da decisÃ£o </h3><br>  O esquema final comeÃ§ou a ter esta aparÃªncia (a quarta versÃ£o deste esquema): em cada servidor na frente da Clickhouse, hÃ¡ nginx (no mesmo servidor, alÃ©m disso) e simplesmente proxies solicitaÃ§Ãµes ao host local com um limite no nÃºmero de conexÃµes de 50 peÃ§as.  E agora esse esquema jÃ¡ estava funcionando, era muito bom com ele. <br><br><img src="https://habrastorage.org/webt/co/ea/sw/coeaswk1ttzg--hk_nz-exq19l0.jpeg"><br><br>  Vivemos assim por cerca de um mÃªs.  Todo mundo estava feliz, adicionando tabelas, adicionando, adicionando ... Em geral, descobriu-se que a maneira como adicionamos tabelas de buffer nÃ£o era muito Ã³tima (digamos assim).  Fizemos 16 peÃ§as em cada mesa e um intervalo de flash por alguns segundos;  tÃ­nhamos 20 tabelas e 8 inserÃ§Ãµes por segundo foram para cada tabela - e nesse momento o â€œClickhouseâ€ comeÃ§ou ... os registros comeÃ§aram a ficar em branco.  Eles nem foram aprovados ... O Nginx tinha uma coisa tÃ£o interessante por padrÃ£o que, se as conexÃµes terminassem no upstream, isso forneceria "502" para todas as novas solicitaÃ§Ãµes. <br><br><img src="https://habrastorage.org/webt/wd/b-/ih/wdb-ihhsype-ykkjymstxzlq27q.jpeg"><br><br>  E aqui em nÃ³s (eu apenas olhei para os logs na prÃ³pria "Clickhouse" que eu olhei) em algum lugar em torno de meio por cento das solicitaÃ§Ãµes falha.  Consequentemente, a utilizaÃ§Ã£o do disco foi alta, houve muitas mesclagens.  Bem, o que eu fiz?  Naturalmente, nÃ£o comecei a entender por que a conexÃ£o e a montante estÃ£o terminando. <br><br><h3>  Substituindo nginx por proxy reverso </h3><br>  Decidi que precisamos gerenciar isso sozinhos, nÃ£o o damos ao nginx - o nginx nÃ£o sabe quais sÃ£o as tabelas no "Clickhouse" e substituÃ­ o nginx por um proxy reverso, que tambÃ©m escrevi. <br><br><img src="https://habrastorage.org/webt/7u/pv/ve/7upvvezqfizgs73uazcnuqz8edm.jpeg"><br><br>  O que ele esta fazendo?  Ele funciona com base na biblioteca fasthttp "goosh", ou seja, rÃ¡pido, quase tÃ£o rÃ¡pido quanto o nginx.  Desculpe, Igor, se vocÃª estÃ¡ aqui (nota: Igor Sysoev Ã© um programador russo que criou o servidor da web nginx).  Ele pode entender que tipo de consultas sÃ£o - INSERT ou SELECT - respectivamente, ele mantÃ©m diferentes pools de conexÃµes para diferentes tipos de consultas. <br><br><img src="https://habrastorage.org/webt/ub/q1/43/ubq143ugu8fsrxicwobmwn8veni.jpeg"><br><br>  Assim, mesmo se nÃ£o tivermos tempo para concluir as solicitaÃ§Ãµes, os "selecionadores" serÃ£o aprovados e vice-versa.  E agrupa os dados em tabelas de buffer - com um buffer pequeno: se houver erros, erros de sintaxe etc. - para que eles influenciem levemente o restante dos dados, porque quando inserimos simplesmente nas tabelas de buffer, tivemos pequenos " bachi â€e todos os erros de sintaxe afetaram apenas este pequeno pedaÃ§o;  e aqui eles jÃ¡ afetarÃ£o o buffer grande.  Pequeno Ã© 1 megabyte, ou seja, nÃ£o Ã© tÃ£o pequeno. <br><br><img src="https://habrastorage.org/webt/16/zx/hh/16zxhh_8qun8kzdyjd3i3ysnxzs.jpeg"><br><br>  Inserir um sÃ­ncrono e essencialmente substituir o nginx faz essencialmente o mesmo que o nginx antes - o Kittenhouse nÃ£o precisa ser alterado localmente para isso.  E como usa fasthttp, Ã© muito rÃ¡pido - vocÃª pode fazer mais de 100 mil solicitaÃ§Ãµes por segundo de inserÃ§Ãµes Ãºnicas por meio de proxies reversos.  Teoricamente, vocÃª pode inserir uma linha em um proxy reverso kittenhouse, mas certamente nÃ£o o fazemos. <br><br><img src="https://habrastorage.org/webt/dv/u5/w8/dvu5w8totg6sa3wexahrky4xcsu.jpeg"><br><br>  O esquema comeÃ§ou a ter a seguinte aparÃªncia: o Kittenhouse, um proxy reverso agrupa muitas solicitaÃ§Ãµes em tabelas e, por sua vez, as tabelas de buffer as inserem nas principais. <br><br><h3>  Killer - soluÃ§Ã£o temporÃ¡ria, Kitten - permanente </h3><br>  Houve um problema tÃ£o interessante ... Algum de vocÃªs jÃ¡ usou o fasthttp?  Quem usou fasthttp com solicitaÃ§Ãµes POST?  Provavelmente, nÃ£o valia a pena fazer isso de fato, porque ele armazena em buffer o corpo da solicitaÃ§Ã£o por padrÃ£o e definimos o tamanho do buffer de 16 megabytes.  A inserÃ§Ã£o deixou de chegar a tempo em algum momento e, de todas as dezenas de milhares de servidores, comeÃ§aram a aparecer blocos de 16 megabytes, e todos estavam armazenados em buffer na memÃ³ria antes de serem entregues ao Clickhouse.  Assim, a memÃ³ria acabou, o Killer Out-Of-Memory Killer veio, matou o proxy reverso (ou "Clickhouse", que teoricamente poderia "comer" mais do que o proxy reverso).  O ciclo foi repetido.  NÃ£o Ã© um problema muito agradÃ¡vel.  Embora tenhamos descoberto isso apenas apÃ³s alguns meses de operaÃ§Ã£o. <br><br>  O que eu fiz?  Novamente, eu realmente nÃ£o gosto de entender o que exatamente aconteceu.  Parece-me bastante Ã³bvio que nÃ£o hÃ¡ necessidade de armazenar em buffer a memÃ³ria.  NÃ£o consegui corrigir o fasthttp, embora tenha tentado.  Mas eu encontrei uma maneira de fazÃª-lo para que nÃ£o houvesse necessidade de consertar nada, e criei meu prÃ³prio mÃ©todo no HTTP - chamado KITTEN.  Bem, Ã© lÃ³gico - "VK", "Kitten" ... Como mais? <br><br><img src="https://habrastorage.org/webt/o9/r5/cu/o9r5cugeck0dm4gc_macqqzymgg.jpeg"><br><br>  Se uma solicitaÃ§Ã£o chegar ao servidor com o mÃ©todo Kitten, o servidor deverÃ¡ responder "miar" - logicamente.  Se ele responder, acredita-se que ele entenda esse protocolo, e entÃ£o eu intercepto a conexÃ£o (existe um mÃ©todo desse tipo no fasthttp), e a conexÃ£o entra no modo "bruto".  Por que eu preciso disso?  Quero controlar como ocorre a leitura das conexÃµes TCP.  O TCP possui uma propriedade maravilhosa: se ninguÃ©m lÃª desse lado, o registro comeÃ§a a esperar e a memÃ³ria nÃ£o Ã© especialmente gasta nisso. <br><br>  E entÃ£o eu li em algum lugar entre 50 clientes por vez (de cinquenta porque cinquenta certamente deve ser suficiente, mesmo se vier de outro controlador de domÃ­nio) ... O consumo diminuiu com essa abordagem pelo menos 20 vezes, mas sinceramente , NÃ£o pude medir quanto exatamente, porque jÃ¡ nÃ£o faz sentido (jÃ¡ se tornou no nÃ­vel do erro).  O protocolo Ã© binÃ¡rio, ou seja, existe um nome de tabela e dados;  nÃ£o hÃ¡ cabeÃ§alhos http, entÃ£o nÃ£o usei um soquete da web (nÃ£o preciso me comunicar com os navegadores - criei um protocolo que atenda Ã s nossas necessidades).  E com ele estava tudo bem. <br><br><h3>  A tabela de buffer estÃ¡ triste </h3><br>  Recentemente, encontramos outro recurso interessante das tabelas de buffer.  E esse problema jÃ¡ Ã© muito mais doloroso que o resto.    :      Â«Â»,     Â«Â»,      ,     (,  60 );       Alter   â€¦   Â«Â»,    Â«Â»,     , Â«Â»   â€“ , -  ,   Â«Â»   .     ?  ? <br><br><img src="https://habrastorage.org/webt/8w/zp/su/8wzpsufzkqmzafrt9vom83joq2i.jpeg"><br><br>  , ,          ,       .  , , ,   Â«Â»  (      â€“   ,   , ), â€¦     ,    Â«Â» ( -  Â«Â» ) â€“  ,  -   :      (   ,     ),  Â«Â» , - ,         .    ,    Â«Â»,          â€“   . <br><br><img src="https://habrastorage.org/webt/po/om/z0/poomz0as89k3aqxh3pa9xpvrr-4.jpeg"><br><br>     (,   ) â€“     Â«Â» query_thread_log.  ,  -   .    840      (100 ).    ,    (, , ,   ) Â«Â» (inserts).    ,   Â«Â»  â€“     Â«Â»    . ,    â€“     ,       .  Porque      ,    !   . <br><br><img src="https://habrastorage.org/webt/vg/gm/fl/vggmfl00f3pku7iix3k7dfj_-am.jpeg"><br><br>   ,     ?    Â«Â».  . <br><br><h3>   Â«KitttenHouseÂ» </h3><br>    , ?               .   !    :  ,   ,  -      .          ,       . <br><br><img src="https://habrastorage.org/webt/pd/e0/rd/pde0rdcd8h4mquk684qhfkvmpvq.jpeg"><br><br> ,   Â«Â»,      â€“       ,      (, - )     ,   ,  â€“ . <br><br><img src="https://habrastorage.org/webt/k_/f3/ev/k_f3ev78dpgabrqjogevuzmykvw.jpeg"><br><br>     ?    .   , ,    10  ,    â€“         -,      ,  .  ,    , ,    ,        â€“ ,     Â«Â»,    100         - â€“        ,   ,          ,     .          ,   .     ,    . <br><br>  ,       ,    .    :    ,    - ,  , ,    read only    .   ?   .         â€“  -  , -      â€¦ (   , Â«Â»,  ClickHouse)  ? ?   ,    .       .   :      ,        .        ,      .  . <br><br><h3>    </h3><br>      .      .  ,   -   ?..    Â«Â»? -    â€¦     Â«Â»?  ,   ,        .     ,        .    ,  . <br><br><img src="https://habrastorage.org/webt/qy/ko/ud/qykoudjbl76cbexrko1zcmr_wmy.jpeg"><br><br>    â€“     .     ,   .    ,   : ,     ,     (   ),      â€“ ,   . <br><br><img src="https://habrastorage.org/webt/gp/xa/1f/gpxa1fqutqdl4zr_ngqko2yjpom.jpeg"><br><br>       Sequel Pro,      Â«Â»,   .  : Â«,     -?Â»  ? 2018-?  ,       Â«Â» (MySQL)        ,      Â«Â»,    !       Â«Â»,     â€“  ,  . <br><br><img src="https://habrastorage.org/webt/bj/ei/vf/bjeivfj1rem72hvgi50jemwlwkc.jpeg"><br><br> ,    ,   ,  ,  ,   ,  ,    , affected rows (  ),       .  . <br><br><img src="https://habrastorage.org/webt/gu/qb/d7/guqbd74jb1bppis3vv_nbokkiaq.jpeg"><br><br>   .        Â«Â»,   .  - -  .     . <br><br><h3> Â«Â»    </h3><br>    ,  Â«Â»,     ,     . ,  ,    â€“         .          ,      â€¦ ,    ,     . <br><br><img src="https://habrastorage.org/webt/ty/tn/97/tytn97odgbvky_khyj7abanlhqg.jpeg"><br><br> TCP? ,  Â«Â»   UDP.     TCPâ€¦ , ,   : Â«,   ! ,  UDPÂ». ,  TCP     . ,       ,     â€“  -   ;  ,   . <br><br> Â«Â»  Â«Â»     HighLoad Siberia,       Â« Â»â€¦  ,   â€¦    , ,       .  -  , -   ,    â€“ ,  (     ,   , ).   <a href="https://vk.com/vkbackend">   </a> .  Muito obrigado!<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nosso github </font></font><a href="https://github.com/VKCOM/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estÃ¡ aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Com "Clickhouse", seu cabelo ficarÃ¡ macio e sedoso. </font></font><br><br><img src="https://habrastorage.org/webt/ai/nd/eu/aindeupigrlmumartzyvealbyj4.jpeg"><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apresentador:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Amigos, e agora perguntas. </font><font style="vertical-align: inherit;">Imediatamente apÃ³s apresentarmos uma carta de agradecimento e seu relatÃ³rio sobre VHS. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yuri Nasretdinov (a seguir denominada ONU):</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - E como vocÃª poderia registrar meu relatÃ³rio sobre o VHS, se este acabou? </font></font><br><br><img src="https://habrastorage.org/webt/w0/b6/zx/w0b6zxe9lcu_9gtaoimopvg8eyy.jpeg"><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AnfitriÃ£o:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€œVocÃª tambÃ©m nÃ£o pode determinar completamente como oâ€œ Clickhouse â€funcionarÃ¡ ou nÃ£o! </font><font style="vertical-align: inherit;">Amigos, 5 minutos para perguntas!</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Perguntas </font></font></h3><br>  <b>Pergunta da platÃ©ia (a seguir - H):</b> - Boa tarde.  Muito obrigado pelo relatÃ³rio.  Eu tenho duas perguntas  Vou comeÃ§ar com um frÃ­volo: o nÃºmero de letras t no nome â€œKittenhouseâ€ nos esquemas (3, 4, 7 ...) afeta a satisfaÃ§Ã£o dos gatos? <br><br>  <b>ONU:</b> - A quantidade de quÃª? <br><br>  <b>Z:</b> - As letras t.  Existem trÃªs t, em algum lugar trÃªs t. <br><br>  <b>ONU:</b> - Eu realmente corrigi isso?  Bem, Ã© claro que sim!  Estes sÃ£o produtos diferentes - eu menti para vocÃª esse tempo todo.  Ok, estou brincando - nÃ£o.  Ah aqui!  NÃ£o, Ã© a mesma coisa, estou selado. <br><br><img src="https://habrastorage.org/webt/fm/4c/ju/fm4cju6vnwwqvpm2o0exqllhsra.jpeg"><br><br>  <b>Z:</b> - obrigado.  A segunda pergunta Ã© sÃ©ria.  Tanto quanto eu entendo, em "Clickhouse", as tabelas de buffer vivem exclusivamente na memÃ³ria, nÃ£o sÃ£o armazenadas em buffer no disco e, portanto, nÃ£o sÃ£o persistentes. <br><br>  <b>ONU:</b> - Sim. <br><br>  <b>Z:</b> - E, ao mesmo tempo, no seu cliente Ã© realizado o buffer no disco, o que implica alguma garantia de entrega desses mesmos logs.  Mas na Clickhouse, isso nÃ£o Ã© garantido.  Explique como Ã© realizada a garantia, devido a quÃª? .. Esse mecanismo Ã© mais detalhado <br><br>  <b>ONU:</b> - Sim, teoricamente nÃ£o hÃ¡ contradiÃ§Ãµes, porque vocÃª pode detectar um milhÃ£o de maneiras diferentes quando o "Clickhouse" cai.  Se o â€œClickhouseâ€ travar (se nÃ£o for concluÃ­do corretamente), vocÃª poderÃ¡, grosso modo, rebobinar o seu registro que anotou um pouco e comeÃ§ar a partir do momento em que tudo estava bem.  Vamos retroceder um minuto atrÃ¡s, ou seja, acredita-se que exibiu tudo em um minuto. <br><br>  <b>Z:</b> - Ou seja, o Kittenhouse mantÃ©m a janela mais longa e, em caso de queda, pode reconhecÃª-la e desenrolÃ¡-la? <br><br>  <b>ONU:</b> - Mas isso Ã© em teoria.  Na prÃ¡tica, nÃ£o fazemos isso, e a entrega confiÃ¡vel Ã© de zero a infinito.  Mas em mÃ©dia um.  Estamos satisfeitos que, se o "Clickhouse" travar por algum motivo ou os servidores "reiniciarem", perderemos um pouco.  Em todos os outros casos, nada acontecerÃ¡. <br><br>  <b>Z:</b> - OlÃ¡.  Desde o inÃ­cio, pareceu-me que vocÃª realmente usaria o UDP desde o inÃ­cio do relatÃ³rio.  VocÃª tem http, tudo isso ... E a maioria dos problemas que vocÃª descreveu, pelo que entendi, foram causados â€‹â€‹por essa soluÃ§Ã£o especÃ­fica ... <br><br>  <b>ONU:</b> - O que usamos TCP? <br><br>  <b>Z:</b> - De fato, sim. <br><br>  <b>ONU:</b> - NÃ£o. <br><br>  <b>Z:</b> - Foi com o fasthttp que vocÃª teve problemas, com a conexÃ£o vocÃª teve problemas.  Se vocÃª apenas usasse o UDP, economizaria tempo.  Bem, haveria problemas com mensagens longas ou outra coisa ... <br><br>  <b>ONU:</b> - Com o quÃª? <br><br><img src="https://habrastorage.org/webt/zl/pe/qj/zlpeqjirfmjnmnfkz-tmzmpnbia.jpeg"><br><br>  <b>Z:</b> - Com mensagens longas, uma vez que pode nÃ£o caber no MTU, outra coisa ... Bem, aÃ­ podem surgir seus problemas.  A questÃ£o Ã©: por que nÃ£o Ã© UDP? <br><br>  <b>ONU:</b> - Acredito que os autores que desenvolveram o TCP / IP sÃ£o muito mais espertos do que eu e sabem como serializar pacotes melhor (assim vÃ£o), ao mesmo tempo, ajustam a janela de envio, nÃ£o sobrecarregam a rede e dÃ£o feedback sobre o que lÃª, sem contar do outro lado ... Todos esses problemas, na minha opiniÃ£o, tambÃ©m estariam no UDP, apenas eu teria que escrever ainda mais cÃ³digo do que jÃ¡ escrevi para implementar a mesma coisa e provavelmente seria ruim.  Eu nem gosto de escrever em C, nÃ£o gosto daqui ... <br><br>  <b>Z:</b> - Apenas conveniente!  Enviado ok e nÃ£o espere nada - vocÃª tem absolutamente de forma assÃ­ncrona.  Voltou um aviso de que estÃ¡ tudo bem - isso significa que chegou;  nÃ£o veio - isso significa ruim. <br><br>  <b>ONU:</b> - Preciso disso e de outro - Preciso poder enviar ambos com garantia de entrega e sem garantia de entrega.  Esses sÃ£o dois cenÃ¡rios diferentes.  Alguns logs eu nÃ£o preciso perder ou nÃ£o perder dentro do razoÃ¡vel. <br><br>  <b>Z:</b> - NÃ£o vou demorar.  Isso deve ser discutido por mais tempo.  Obrigada <br><br>  <b>Apresentador:</b> - Quem tem perguntas - canetas no cÃ©u! <br><br><img src="https://habrastorage.org/webt/ip/mz/l7/ipmzl72i77pluuukxeyuxpqeob0.jpeg"><br><br>  <b>Z:</b> - Oi, eu sou Sasha.  Em algum lugar no meio do relatÃ³rio, havia a sensaÃ§Ã£o de que era possÃ­vel, alÃ©m do TCP, usar uma soluÃ§Ã£o pronta - algum tipo de "Kafka". <br><br>  <b>ONU:</b> â€œBem ... eu disse que nÃ£o quero usar servidores intermediÃ¡rios, porque ... para Kafka - acontece que temos dez mil hosts;  de fato, temos mais - dezenas de milhares de hosts.  Com Kafka, sem proxies, tambÃ©m pode doer.  AlÃ©m disso, o mais importante Ã© que ainda fornece "latÃªncia", fornece os hosts extras que vocÃª precisa ter.  E eu nÃ£o quero tÃª-los - eu quero ... <br><br>  <b>Z:</b> - Mas no final acabou assim mesmo. <br><br>  <b>ONU:</b> - NÃ£o, nÃ£o hÃ¡ anfitriÃµes!  Tudo funciona nos hosts Clickhouse. <br><br>  <b>Z:</b> - Mas e o Kittenhouse, cujo reverso Ã© - onde ele mora? <br><br><img src="https://habrastorage.org/webt/bn/ew/lk/bnewlk0ozew0rhhlgtdwhkhjfcu.jpeg"><br><br>  <b>ONU:</b> - No host de Klickhouse, ele nÃ£o escreve nada no disco. <br><br>  <b>Z:</b> - Bem, digamos. <br><br>  <b>Apresentador:</b> - Satisfaz vocÃª?  Podemos dar um salÃ¡rio? <br><br>  <b>Z:</b> - Sim sim.  De fato, existem muitas muletas para obter a mesma coisa e agora - a resposta anterior sobre o tÃ³pico do TCP contradiz, na minha opiniÃ£o, essa situaÃ§Ã£o.  Parece que vocÃª pode fazer tudo em seu joelho em muito menos tempo. <br><br>  <b>ONU:</b> - E por que eu nÃ£o quis usar o "Kafka", porque houve muitas reclamaÃ§Ãµes no telegrama "Clickhouse" no Telegram de que, por exemplo, as mensagens de "Kafka" foram perdidas.  NÃ£o da prÃ³pria Kafka, mas na integraÃ§Ã£o da Kafka e Klikhaus;  ou algo nÃ£o se conectou lÃ¡.  Grosso modo, seria necessÃ¡rio que o cliente Kafka escrevesse entÃ£o.  Eu nÃ£o acho que uma soluÃ§Ã£o mais simples e confiÃ¡vel seria obtida. <br><br>  <b>Z:</b> - Diga-me, por que vocÃª nÃ£o experimentou algumas linhas ou um Ã´nibus tÃ£o comum?  Como vocÃª diz que foi possÃ­vel com vocÃª assincronamente dirigir pela fila os prÃ³prios logs e tambÃ©m obter assincronamente pela fila em resposta? <br><br><img src="https://habrastorage.org/webt/pn/4q/sz/pn4qszihp9ejs5aoua8swthjrqk.jpeg"><br><br>  <b>ONU:</b> - Por favor, sugira quais filas podem ser usadas? <br><br>  <b>Z:</b> - Qualquer, mesmo sem garantia de que eles estÃ£o indo em ordem.  Qualquer Redis, RMQ ... <br><br>  <b>ONU:</b> - Sinto que o Redis provavelmente nÃ£o conseguirÃ¡ extrair esse volume de inserÃ§Ã£o nem em um host (no sentido de vÃ¡rios servidores) que retire o Clickhouse.  NÃ£o posso confirmar isso com nenhuma evidÃªncia (nÃ£o a fiz como referÃªncia), mas me parece que o Redis nÃ£o Ã© a melhor soluÃ§Ã£o aqui.  Em princÃ­pio, vocÃª pode considerar esse sistema como uma fila de mensagens improvisadas, mas que Ã© apenas para "Clickhouse" <br><br>  <b>Apresentador:</b> - Yuri, muito obrigado.  Proponho terminar as perguntas e respostas sobre isso e dizer qual das pessoas que fizeram a pergunta nos darÃ¡ um livro. <br><br>  <b>ONU:</b> - Gostaria de dar um livro para a primeira pessoa que fez uma pergunta. <br><br>  <b>Apresentador:</b> - Ã“timo!  Ã“timo!  Ã“timo!  Muito obrigado! <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/pbbcMcrQoXw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  Um pouco de publicidade :) </h3><br>  Obrigado por ficar conosco.  VocÃª gosta dos nossos artigos?  Deseja ver materiais mais interessantes?  Ajude-nos fazendo um pedido ou recomendando aos seus amigos o <a href="https://ua-hosting.company/cloudvps/nl">VPS baseado em nuvem para desenvolvedores a partir de US $ 4,99</a> , um <b>analÃ³gico exclusivo de servidores</b> <a href="https://habr.com/company/ua-hosting/blog/347386/">bÃ¡sicos</a> <b>que foi inventado por nÃ³s para vocÃª:</b> <a href="https://habr.com/company/ua-hosting/blog/347386/">Toda a verdade sobre o VPS (KVM) E5-2697 v3 (6 nÃºcleos) 10 GB DDR4 480 GB SSD 1 Gbps de US $ 19 ou como dividir o servidor?</a>  (as opÃ§Ãµes estÃ£o disponÃ­veis com RAID1 e RAID10, atÃ© 24 nÃºcleos e atÃ© 40GB DDR4). <br><br>  <b>Dell R730xd 2 vezes mais barato no data center Equinix Tier IV em AmsterdÃ£?</b>  Somente temos <b><a href="https://ua-hosting.company/serversnl">2 TVs Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV a partir de US $ 199</a> na Holanda!</b>  <b><b>Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - a partir de US $ 99!</b></b>  Leia sobre <a href="https://habr.com/company/ua-hosting/blog/329618/">Como criar um prÃ©dio de infraestrutura.</a>  <a href="https://habr.com/company/ua-hosting/blog/329618/">classe usando servidores Dell R730xd E5-2650 v4 custando 9.000 euros por um centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt483712/">https://habr.com/ru/post/pt483712/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt483688/index.html">Sobre o aumento de simultaneidade 30x no Node.js</a></li>
<li><a href="../pt483700/index.html">Resultados FÃ­sicos do Ano - 2019</a></li>
<li><a href="../pt483704/index.html">Eventos digitais em Moscou de 13 a 19 de janeiro</a></li>
<li><a href="../pt483706/index.html">Ideias de aplicativos para gerar receita para startups em 2019 e alÃ©m</a></li>
<li><a href="../pt483708/index.html">Efeito Doppler, ou a questÃ£o da precisÃ£o da determinaÃ§Ã£o da velocidade pelos radares da polÃ­cia de trÃ¢nsito</a></li>
<li><a href="../pt483714/index.html">PrÃªmios e concursos para projetos inovadores. ExperiÃªncia de fornecedores mundiais</a></li>
<li><a href="../pt483716/index.html">Usando o scanner de vulnerabilidades nas bibliotecas de verificaÃ§Ã£o de dependÃªncia usadas no GitlabCI</a></li>
<li><a href="../pt483718/index.html">Como a VDI estÃ¡ transformando o ambiente do escritÃ³rio</a></li>
<li><a href="../pt483722/index.html">GeoanalÃ­tica de varejo, parte 1: automatizamos o processo de escolha de um local para uma empresa. 2GIS + MS Azure + ML</a></li>
<li><a href="../pt483724/index.html">Trabalhar com o complexo de pneus personalizados Redd</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>