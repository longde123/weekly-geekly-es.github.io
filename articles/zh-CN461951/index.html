<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚅 🧑🏿‍🤝‍🧑🏻 🚧 Veeam插件，用于备份和恢复SAP HANA数据库 🉑 👨🏽‍🏫 🌌</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="这个季节，Veeam开发人员推出了用于备份和恢复SAP HANA服务器和数据库的解决方案。 我们博客的读者对这种新产品表现出了兴趣-我的同事Clemens Zerbe的一篇有用的文章就在这里。 今天，我将与您分享一些内容。 所以欢迎猫。 



 从图片中可以看到，SAP HANA的完整解决方案包括...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Veeam插件，用于备份和恢复SAP HANA数据库</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/veeam/blog/461951/"> 这个季节，Veeam开发人员推出了用于备份和恢复SAP HANA服务器和数据库的解决方案。 我们博客的读者对这种新产品表现出了兴趣-我的同事Clemens Zerbe的一篇有用的文章就在这里。 今天，我将与您分享一些内容。 所以欢迎猫。 <br><br><img src="https://habrastorage.org/webt/1i/mf/et/1imfet6plcc-gu7pbqwpop203l0.png"><br><a name="habracut"></a><br> 从图片中可以看到，SAP HANA的完整解决方案包括： <br><br><ul><li>  <b>Veeam备份和复制</b> -用于在映像或文件级别备份SAP HANA服务器，并支持恢复。 <br><br> 如果您的服务器是虚拟化的，那么最好的备份建议使用Veeam备份和复制。 对于物理服务器，有适用于Linux的Veeam代理。 两者都有相当详细的文档，以及我们博客上的文章。 </li><li>  <b>Veeam插件</b> -用于根据事务备份和恢复SAP HANA数据库。 <br><br> 该插件可以使用SAP Backint（本机API）备份数据库和事务日志，并将备份保存到Veeam存储库（包括可伸缩存储库-SOBR）。 我今天将讨论这个插件。 </li></ul><br><h1> 我们认为插件更近 </h1><br> 如上所述，该插件使用SAP Backint API直接与SAP HANA数据库一起使用。  HANA通过自定义保留策略和创建间隔来维护自己的备份目录。 因此，仅保留Veeam备份和复制，这些数据从数据管道中获取数据并将其放入存储库中。 <br> 在恢复期间，SAP HANA告诉Veeam Backup＆Replication恢复哪些数据，然后Veeam将其从存储库中取出。 <br><br> 使用<i>Veeam Transport Agent</i>组件（传输代理）执行数据传输操作，在规划部署时应牢记这一点。 <br><br> 如果您绘制有关组件交互的图片，那么它将看起来像这样： <br><br><img src="https://habrastorage.org/webt/mr/rj/-x/mrrj-xocbcjapxt6s02k06pjh4m.png"><br><br><ol><li> 当您启动数据库备份过程时，SAP HANA Backint会立即启动Veeam插件服务。 </li><li> Veeam插件连接到Veeam备份和复制服务器，并在其中创建<i>备份作业对象</i> ，这使SAP HANA备份对Veeam备份管理员可见。 </li><li> 然后，Veeam插件在SAP HANA服务器和存储库上运行<i>Veeam传输代理</i> 。 这些代理中的每一个都为备份数据流创建一个单独的通道。 </li><li>  Veeam传输代理将数据传输到存储库。 </li></ol><br>  <i>注意：</i>必须记住，SAP HANA Backint仅与数据库一起使用，执行不同类型的备份-完整，差异，增量和日志。 他（Backint）也用于恢复。 除了数据本身之外，还有SAP HANA安装和配置文件，所有这些文件都在Red Hat或SUSE操作系统上运行。 这也不能忘记。 因此，如果您需要服务器本身或文件的备份，那么您将需要另一个工具箱。 <br><br> 是的，该插件本身包含在<i>Enterprise Plus</i>版本的<b>Veeam Backup＆Replication 9.5 Update 4</b> （或<b>4a</b> ）中。 <br><br><h1> 开始安装 </h1><br> 首先，我们当然要检查是否符合系统要求。 支持的操作系统： <br><br><ul><li> 适用于SAP应用程序的SUSE Linux Enterprise Server 12 SP1 / SP2 / SP3 / SP4（x86_64） </li><li> 适用于SAP应用程序的SUSE Linux Enterprise Server 15（x86_64） </li><li> 适用于SAP应用程序的Red Hat Enterprise Linux 7.2 / 7.3 / 7.4 / 7.5（x86_64） </li></ul><br> 支持SAP HANA 2.0 SPS 02 / SPS 03 / SPS 04，不支持<i>Express Edition</i> 。 <br><br> 要执行插件的测试安装，备份和还原数据库，您将需要： <br><br><ul><li> 配置的Veeam备份存储库（不加密！）以及对它的必要访问权限。 </li><li> 对于Veeam存储库和您的HANA系统，必须支持DNS解析（正向和反向）。 </li><li> 在x86上运行的HANA系统版本2.0 SPS02或更高版本。 </li><li> 支持朋友-如果您是Veeam管理员，建议有一位具有SAP Basis工作经验的同事，反之亦然。 </li></ul><br> 安装文件存储在Veeam Backup＆Replication ISO的<i>/ Plugins / SAP HANA / x64</i>目录中。 <br><br><ol><li> 挂载ISO，转到<i>/ Plugins / SAP HANA / x64</i>目录。 将所需的文件（ <i>.rpm</i>或<i>tar.gz</i> ）复制到SAP HANA服务器。 </li><li>我们在此服务器上启动相应的命令，例如： <br><br> <code>sudo rpm -i VeeamPluginforSAPHANA-XXXXXXX.x86_64.rpm</code> <br> <br>  <i>注意：</i>您可以使用Putty或任何其他ssh客户端连接到系统。 要安装，您将需要一个具有<i>sudo</i>权限的帐户。 <br></li><li> 我们正在等待安装完成，并等待启动<b>SapBackintConfigTool --wizard</b>配置向导的邀请。 </li></ol><br>  <i>有用的：</i>实际上，安装过程非常愉快，但是以防万一，对于速度更快的爱好者（拥有Veeam Backup＆Replication 9.5 Update 4a）， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">HANA提供</a>了一个专门的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">性能补丁</a> 。 <br><br><h1> 让我们继续进行设置 </h1><br>  <i>重要！</i> 要配置Veeam插件，您需要在该服务器的所有SAP HANA实例上具有数据库管理员权限的用户帐户。 不支持<i>SAP HANA高级别隔离</i> 。 <br><br><ol><li> 具有root特权，运行<b>SapBackintConfigTool --wizard</b> 。 <br><br><img src="https://habrastorage.org/webt/qf/1x/jd/qf1xjd_zfkqn3ft_fsqyplnmsja.png"><br></li><li> 在这里我们需要指出： <br><br><ul><li>  Veeam备份服务器名称或IP地址 </li><li> 与该服务器通信的端口-默认为<b>10006</b> </li><li> 用于访问同一服务器的用户名和密码-帐户和访问权限应由负责Veeam Backup＆Replication的管理员来组织 </li><li> 用来保存备份的存储库-如果一切都顺着权限进行，将显示所有可用存储库的列表。 他们将被重新编号，您必须输入所需的号码。 在此示例中，选择了列表中编号为2的存储库（名称为<b>SOBR1</b> ）。 </li></ul></li><li> 该向导将自动执行其余操作，即，将设置保存到文件<i>/opt/veeam/VeeamPluginforSAPHANA/veeam_config.xml中，</i>并通过软链接激活SAP <i>Backint</i> 。 </li></ol><br>  <i>注意：</i>如果已经预先配置了SAP Backint，您将看到一条消息，需要额外执行哪些步骤，以及在什么时候重新启动此向导。 <br><br><h1> 我们进行第一次备份 </h1><br> 最简单的方法是为此使用SAP HANA Studio，但您也可以使用任何其他工具，例如SAP HANA Cockpit，DBA刨床或某些外部Sheduler。 <br><br><ol><li> 启动SAP HANA Studio，并在<b>多个容器→系统数据库</b>模式下连接到所需的SAP HANA实例。  （在这里，您有权依靠SAP Basis管理员的友好帮助-他将指示主机名和实例。） <br></li><li> 我们使用用户帐户选择身份验证- <b>数据库用户身份验证</b> 。 我们输入SAP HANA的用户名和密码（在我们的示例中，这是<i>系统</i> -但这不是必需的，您可以创建一个专门用于具有备份和目录权限的备份和还原操作的帐户。这写在HANA文档中）。 <br><br><img src="https://habrastorage.org/webt/xs/pn/dn/xspndnv2b03sdfbw7wqjkqer5qw.png"><br></li><li> 如果设置一切正常，那么在完成向导后，您将在控制台窗口中看到以下内容： <br><br><img src="https://habrastorage.org/webt/nt/n7/fa/ntn7fa76ym8_kryzj2u5xidyeny.png"><br><br> 如果单击<b>SYSTEMDB @ SID（SYSTEM）</b>节点，则将打开一个包含详细属性的窗口。 </li><li> 然后，右键单击此节点，然后选择“ <b>备份和恢复”→“打开备份控制台”</b>菜单项： <br><br><img src="https://habrastorage.org/webt/gh/ig/lp/ghiglpvughpb4igagggyxyeevny.png"><br></li><li> 转到“ <b>配置”</b>选项卡，然后单击“ <b>Backint设置”</b> 。 如果在<i>Backint</i> <b>Agent</b>字段中看到<i>/ opt / Veeam / VeeamPluginforSAPHANA / hdbbackint</i> ，则意味着所有设置都是根据需要进行的。 <br></li></ol><br> 请注意设置中的几点： <br><br><ul><li> 由于Veeam不使用<b>Backint参数文件</b> ，因此相应的字段必须为空。 如果其中有任何东西，请清洁它们。 </li><li>  <b>日志</b>备份设置可以将日志存储在文件系统上（“ <b>文件”</b>选项），也可以使用Backint将日志发送到Veeam Backup＆Replication。 第二个选项（ <b>Backint</b>选项）是更可取的，但只有在SAP Basis管理员确认后才能使用。 </li><li> 如果您更改了任何设置，请不要忘记保存它们。 </li></ul><br> 最后，检查所有内容，开始备份。 <br><br><ol><li> 右键单击<b>SYSTEMDB @ DEV</b>数据库的节点，然后选择“ <b>备份和恢复”→“备份系统数据库”</b>命令（然后还将有“ <b>备份租户数据库”</b> ）。 <br></li><li> 选择我们计划创建的备份类型。 作为<b>目标类型，</b>选择<b>Backint</b> ，然后单击<b>下一步</b> 。 <br><br><img src="https://habrastorage.org/webt/2h/ig/17/2hig17pmqlwpsfl0latjxeev1mi.png"><br></li><li> 我们再次浏览所有参数，然后单击<b>Finish</b> 。 </li><li> 我们观察过程的进展。 <br></li><li> 一切结束后，检查日志是否到位-在“ <b>备份执行摘要”中，</b>单击“ <b>打开日志文件”</b>链接。 <br><br><img src="https://habrastorage.org/webt/db/s0/le/dbs0leiby1t-sfmlglrxe-ofhjy.png"><br></li><li> 我们返回“ <b>备份系统数据库”</b>对话框，然后打开“ <b>备份目录”备份</b>目录。 应该对您刚刚创建的备份进行详细描述，例如： <br><br><img src="https://habrastorage.org/webt/5c/db/vv/5cdbvvmhmuhcpwq5qcsfqwa2e9a.png"><br></li><li> 我们对租户重复相同的过程：启动数据库的备份，检查日志，查看目录中的内容。 </li></ol><br> 如果现在打开Veeam Backup＆Replication控制台，则将在其中看到以下内容： <br><br><ul><li> 在<b>Jobs</b>节点下出现了一个新任务，名称为<i>“主机名SAP backint备份（存储库名称）”</i> <br></li><li> 一个新的<b>Plug-ins</b>文件夹出现在<b>History</b>节点下（对于Sap HANA和Oracle RMAN）。 <br><br><img src="https://habrastorage.org/webt/j5/wa/hl/j5wahlm4aynw_h7ev7huebrxilg.png"></li></ul><br> 奏效了！ 我向您表示祝贺，现在我们开始康复。 <br><br><h1> 恢复基础 </h1><br>  <i>重要！</i> 所有测试过程（例如以下所述的测试过程）都只能在测试基础结构中并且在您的同事SAP Basis-admin旁边执行。 切勿在生产中执行测试和培训程序！  （您的队长证据：） <br><br> 在此示例中，我们会将租户基础还原到当前状态（通常，系统数据库仅在出现任何严重问题时才需要还原，对于这种还原，您可能需要咨询SAP技术支持）。 <br><br><ol><li> 单击我们的<b>SYSTEMDB @ DEV</b>节点，然后选择“ <b>备份和恢复-恢复租户数据库”</b>菜单命令。 <br><br><img src="https://habrastorage.org/webt/qz/mv/3m/qzmv3miz1fhda3xbu6ukg0oxuoq.png"><br></li><li> 选择租户，单击<b>下一步</b> 。 </li><li> 我们选择选项<b>将数据库恢复到其最新状态</b> （将数据库恢复到最新状态）。 还有一个选项和一个选定的时间点恢复。 </li><li> 如果备份到Backint（即通过Backint到存储库），请选择在相应目录中搜索备份的选项： <b>仅在Backint中搜索备份目录</b> 。 如果是文件系统，则<b>仅在文件系统中搜索备份目录</b> 。 <br><br><img src="https://habrastorage.org/webt/pp/jz/m-/ppjzm-wx1spqgf5xxrxgbz59v9a.png"><br><br>  <i>注意！</i> 恢复数据库时，将执行关机！ </li><li> 从备份列表中，选择所需的一种。 如果您需要确保可用，请点击<b>检查可用性</b> 。 <br><br><img src="https://habrastorage.org/webt/al/zi/cm/alzicmfrii8roc2dhzxoiwyixre.png"><br></li><li> 然后（在我们的备份旁边的绿色可用性检查指示灯亮起之后），转到“ <b>查找日志备份”步骤</b> ，然后再次单击“ <b>下一步”</b> 。 <br></li><li> 接下来，在“ <b>其他设置”</b>步骤中，指定您需要从我们通过Backint保存日志的地方获取日志。  （通常，此步骤中的所有设置都需要使用SAP Basis-admin进行检查。） <br><br><img src="https://habrastorage.org/webt/tj/pb/l4/tjpbl4kyuh3k9tzenypqznhwhpo.png"><br></li><li> 单击“ <b>下一步”</b> ，再次查看所有设置的描述，然后单击“ <b>完成”</b> 。 <br></li></ol><br> 这个过程已经开始！ 完成后，您将看到以下对话框： <br><br><img src="https://habrastorage.org/webt/ws/cf/p5/wscfp52ocibqder4e73iylkfogs.png"><br><br> 至此，备份和还原已完成。  <b>用于SAP HANA的Veeam插件</b> （顺便说一下，它已通过SAP认证）乍一看不起眼，但在这些过程中发挥了重要作用。 待续！ <br><br><h1> 网站连结 </h1><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">用户手册（英文）</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">解决方案页（俄语）</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">网络研讨会录音（俄语）</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN461951/">https://habr.com/ru/post/zh-CN461951/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN461937/index.html">帕金森定律以及如何破解</a></li>
<li><a href="../zh-CN461939/index.html">石墨烯-Python历险年</a></li>
<li><a href="../zh-CN461941/index.html">按摩一下</a></li>
<li><a href="../zh-CN461945/index.html">2019年8月IT领域HR专业人员的事件摘要</a></li>
<li><a href="../zh-CN461949/index.html">AppCode 2019.2：Swift 5.1，通过测试分析代码覆盖率，显示反汇编代码等</a></li>
<li><a href="../zh-CN461955/index.html">交换代币或如何在2019年加强加密货币投资组合</a></li>
<li><a href="../zh-CN461963/index.html">类模板参数推导</a></li>
<li><a href="../zh-CN461965/index.html">没有框架和servlet的Web MVC应用程序</a></li>
<li><a href="../zh-CN461967/index.html">上古：功能性录音机</a></li>
<li><a href="../zh-CN461971/index.html">Oracle SQL的力量</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>