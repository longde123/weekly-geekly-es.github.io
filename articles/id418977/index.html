<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“– ğŸ¤¸ğŸ½ ğŸ‘¨ğŸ½â€âœˆï¸ Server World of Tanks Keandalan ğŸšª ğŸ’ ğŸš§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Topik hari ini - keandalan World of Tanks Server - agak licin. Keandalan dari permainan ini saling menguntungkan, oleh karena itu segala sesuatu harus...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Server World of Tanks Keandalan</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/418977/"><p>  Topik hari ini - keandalan World of Tanks Server - agak licin.  Keandalan dari permainan ini saling menguntungkan, oleh karena itu segala sesuatu harus dilakukan dengan cepat dan cepat dalam pengembangan game.  Beban pada server besar, dan pengguna cenderung merusak sesuatu hanya karena ketertarikan.  <strong>Levon Avakyan</strong> di RIT ++ mengatakan apa yang dilakukan Wargaming untuk memastikan keandalan. </p><br><p>  Biasanya, ketika mereka berbicara tentang keandalan, pemantauan, pengujian stres dan sebagainya disebutkan setiap saat.  Tidak ada yang supernatural dalam hal ini, dan laporan itu dikhususkan untuk momen-momen khusus Tank. </p><br><img src="https://habrastorage.org/webt/x6/id/gr/x6idgr4r-xse32m9p4kqkps8ndi.jpeg"><br><br><p>  <strong>Tentang pembicara:</strong> Levon Avakyan bekerja untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Wargaming</a> sebagai Kepala Layanan dan Keandalan Game WoT dan menangani masalah keandalan server tank. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/x-Uk5xBsstA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br>  Hari ini saya akan berbicara tentang bagaimana kami melakukan ini, termasuk apa yang dimaksud dengan server World Of Tanks, terdiri dari apa, apa itu dibangun, sehingga Anda memahami subjek pembicaraan.  Selanjutnya kita akan mempertimbangkan apa yang bisa salah di dalam server itu sendiri dan sekitarnya, karena permainannya sudah lebih dari server.  Dan kami juga akan berbicara sedikit tentang prosesnya, karena banyak yang lupa bahwa proses produksi yang mapan adalah bagian dari keberhasilan tidak hanya dalam hal penghematan sumber daya (banyak praktik berasal dari produksi nyata), tetapi juga memengaruhi kualitas dan keandalan solusi. <br><br><img src="https://habrastorage.org/webt/qa/oj/17/qaoj17globztvoj2lxan-yry9-a.jpeg"><br>  Biasanya, ketika mereka berbicara tentang keandalan, pemantauan, pengujian stres, dan sebagainya disebutkan setiap saat.  Saya tidak memasukkannya di sini karena saya pikir itu membosankan.  Kami belum menemukan sesuatu yang supranatural dalam hal ini.  Ya, kami juga memiliki sistem pemantauan, kami melakukan stress testing dengan stress test untuk meningkatkan keandalan sistem dan tahu di mana itu bisa jatuh.  Tapi hari ini saya akan berbicara tentang apa yang lebih spesifik untuk tank. <br><br>
<h2>  Teknologi BigWorld <br></h2><br>  Ini adalah mesin backend, serta toolkit untuk membuat MMO. <br><br>  Mesin BigWorld Server yang cukup lama ini (berasal dari akhir 90-an - awal 2000-an) adalah serangkaian proses berbeda yang mendukung permainan.  Proses diluncurkan pada sebuah cluster, yang saling terhubung dalam jaringan mesin.  Berinteraksi satu sama lain, proses menunjukkan kepada pengguna semacam mekanisme permainan. <br><br>  Mesin itu disebut BigWorld, karena sangat bagus untuk membuat game di atasnya, di mana ada lapangan besar (ruang), di mana operasi militer (pertempuran) berlangsung.  Untuk Tank, ini sangat cocok. <br><br>  Dalam hal keandalan, fitur-fitur utama berikut diinvestasikan di BigWorld: <br><br><ul><li>  <strong>Load balancing.</strong>  Mesin mengalokasikan sumber daya, berusaha mencapai dua tujuan: <br><ol><li>  gunakan sesedikit mungkin mesin; </li><li>  pada saat yang sama, jangan memuat aplikasi Anda sehingga bebannya melebihi batas tertentu. </li></ol></li><li>  <strong>Skalabilitas.</strong>  Kami menambahkan mobil ke cluster, meluncurkan proses di atasnya - yang berarti Anda dapat menghitung lebih banyak pertempuran dan menerima pemain. <br></li><li>  <strong>Ketersediaan tinggi.</strong>  Jika, misalnya, satu mobil jatuh atau ada yang salah dengan salah satu proses permainan yang melayani permainan itu sendiri, tidak ada yang perlu dikhawatirkan - permainan tidak akan melihat, akan dipulihkan di tempat lain dan akan berfungsi. </li><li>  <strong>Pertahankan integritas dan konsistensi data.</strong>  Ini adalah level kedua dari toleransi kesalahan.  Jika ada beberapa cluster, seperti di Tanks, dan ada semacam bencana di pusat data atau di saluran utama, ini tidak berarti bahwa kami akan benar-benar kehilangan data permainan yang telah dimainkan orang tersebut.  Kami akan pulih, konsistensi akan. </li></ul><br>  <strong>Proses-proses yang ada di sistem kami dan fungsinya</strong> <br><br><ul><li>  <strong>CellApp</strong> adalah proses yang bertanggung jawab untuk memproses ruang permainan atau bagian darinya. <br></li></ul>  Seperti yang saya katakan, BigWorld bekerja dengan ruang-ruang tertentu yang kita bagi menjadi sel.  Setiap sel khusus ruang permainan kami dihitung oleh aplikasi tertentu. <br><br><ul><li>  <strong>CellAppMgr</strong> - proses yang mengoordinasikan kerja CellApp, memuat keseimbangan. <br></li></ul>  CellApp bisa banyak, karenanya, harus ada proses yang mengendalikan mereka. <br><br><ul><li>  <strong>BaseApp</strong> mengelola entitas, mengisolasi klien dari bekerja dengan CellApp. </li></ul>  Salah satu hal mendasar dalam BigWorld adalah konsep entitas - misalnya, akun pemain.  Segala sesuatu yang kita lakukan di medan perang, kita lakukan dengan entitas ini.  CellApps menghitung fisika dan mekanika game, seperti menembak.  BaseApp bekerja dengan entitas.  Ini melayani akun, tangki, dll. <br><br><ul><li>  <strong>ServiceApp</strong> adalah BaseApp khusus yang mengimplementasikan beberapa jenis layanan. </li></ul>  Ini adalah versi sederhana dari BaseApp, sebuah proses yang melakukan berbagai hal layanan.  Misalnya, seseorang harus dapat membaca dari RabbitMQ.  Ini bukan tentang entitas game, tetapi juga diperlukan. <br><br><ul><li>  <strong>BaseAppMgr</strong> mengelola BaseApp dan ServiceApp, karena ada banyak juga. </li><li>  <strong>LoginApp</strong> membuat koneksi baru dari klien, dan juga proksi pengguna di BaseApp. </li><li>  <strong>DBApp</strong> mengimplementasikan antarmuka akses penyimpanan (database).  Kami bekerja dengan Percona, tapi mungkin itu database lain. </li><li>  <strong>DBAppMgr</strong> mengoordinasikan pekerjaan DBApp. </li><li>  <strong>InterClusterMgr</strong> mengelola komunikasi antarkluster. </li><li>  <strong>Reviewer</strong> adalah inspektur proses yang dapat memulai kembali proses. </li><li>  <strong>Diperbaiki</strong> <strong>&nbsp;</strong>  - daemon yang berjalan pada setiap mesin di cluster untuk mengoordinasikan pekerjaannya.  Ini memungkinkan semua manajer BaseApp untuk saling berkomunikasi. </li></ul><br><img src="https://habrastorage.org/webt/z9/dq/he/z9dqhes39d5hjaah6aq4igy6kzg.jpeg"><br><br>  Beginilah tampilan Tank dari dalam, jika sangat singkat: <br><br><ul><li>  Klien terhubung melalui Internet, dapatkan di LoginApp. </li><li>  LoginApp mengizinkan mereka menggunakan DBApp dan mengeluarkan alamat dari BaseApp. </li><li>  Pelanggan lebih lanjut memainkannya. </li></ul><br>  Semua ini tersebar di banyak mesin, masing-masing memiliki BWMachineD, yang dapat mengelola semua ini, mengatur, dll. <br><br><h2>  World of Tanks Ecosystem <br></h2><br>  Apa yang ada di sekitar?  Tampaknya ada server permainan dan pemain - memilih tank, pergi bermain.  Namun, sayangnya (atau dengan gembira), gim ini berkembang, dan mekanisme gim "hanya menembak" tidak lagi cukup.  Dengan demikian, server permainan mulai ditumbuhi berbagai layanan, beberapa di antaranya secara umum tidak mungkin dilakukan di dalam server, sementara kami mulai mengeluarkan yang lain secara khusus untuk meningkatkan kecepatan pengiriman konten ke pemain.  Yaitu, lebih cepat untuk menulis layanan kecil dengan Python yang melakukan semacam permainan mekanik daripada melakukannya di dalam server pada semua BaseAPPs, mendukung cluster, dll. <br><br>  Beberapa hal, misalnya, sistem pembayaran pada awalnya dikeluarkan.  Kami menahan orang lain, karena Wargaming mengembangkan lebih dari satu permainan.  Ini adalah trilogi: Tank, Pesawat, Kapal, dan ada Blitz dan rencana untuk permainan baru.  Jika mereka berada di dalam BigWorld, maka mereka tidak dapat dengan mudah digunakan dalam produk lain. <br><br>  Semuanya berjalan cukup cepat dan kacau, yang menghasilkan beberapa teknologi kebun binatang yang digunakan dalam ekosistem tangki kami. <br><br>  Teknologi dan protokol utama: <br><br>  1. Python 2.7, 3.5; <br><br>  2. Erlang; <br><br>  3. Scala; <br><br>  4. JavaScript; <br><br>  Kerangka kerja <br><br>  5. Django; <br><br>  6. Falcon; <br><br>  7. asyncio; <br><br>  Penyimpanan: <br><br>  8. Postgres; <br><br>  9. Percona. <br><br>  10. Memcached dan Redis untuk caching. <br><br>  Secara keseluruhan untuk pemain ini adalah server tangki: <br><br><ul><li>  Satu titik otorisasi; </li><li>  Obrolan </li><li>  Klan; </li><li>  Sistem pembayaran; </li><li>  Sistem turnamen; </li><li>  Game met (Peta global, area yang diperkuat); </li><li>  Portal Tank, Portal Klan; </li><li>  Manajemen konten, dll. </li></ul><br>  Tetapi jika Anda melihat, ini adalah hal-hal yang sedikit berbeda yang ditulis pada teknologi yang berbeda.  Ini menyebabkan beberapa masalah keandalan. <br><br><img src="https://habrastorage.org/webt/oi/-o/ax/oi-oaxdx4eek4e5omtpwlyp5ism.jpeg"><br><br>  Diagram menunjukkan server tangki kami beserta ekosistemnya.  Ada server permainan, layanan web (internal dan eksternal), termasuk layanan sepenuhnya khusus yang terletak di jaringan backend dan melakukan fungsi layanan, dan layanan kepada mereka, yang benar-benar mengimplementasikan antarmuka.  Misalnya, ada layanan klan dengan portal klannya sendiri, yang memungkinkan Anda mengelola klan ini, ada portal gamenya sendiri, dll. <br><br>  Pemisahan ini memungkinkan kita untuk tidak terlalu khawatir tentang keamanan, karena tidak ada yang memiliki akses ke jaringan internal - lebih sedikit masalah.  Tetapi ini mengarah pada upaya tambahan, karena kita membutuhkan proxy yang akan memberikan akses jika kita perlu mendorongnya keluar. <br><br>  Saya sudah mengatakan bahwa kami membuat keputusan untuk menghapus beberapa logika permainan dan hal-hal lain dari server.  Ada tugas untuk memasukkan segala sesuatu ke dalam klien.  Kami memiliki Gateway Klien yang luar biasa yang memungkinkan klien tank untuk secara langsung mengakses server dari beberapa API Layanan Internal ini - klan atau API yang sama dari meta-game kami. <br><br>  Plus, kami mendorong Chromium Embedded Framework (CEF) di dalam klien tangki.  Kami sekarang memiliki browser yang sama.  Pemain tidak membedakannya dari jendela permainan.  Ini memungkinkan Anda untuk bekerja dengan seluruh infrastruktur, melewati pekerjaan dengan server game. <br><br>  Kami memiliki banyak kluster - hal itu terjadi - saya akan memberi tahu Anda alasannya.  Inilah yang terlihat seperti wilayah CIS. <br><br><img src="https://habrastorage.org/webt/rc/w4/ri/rcw4rignlicjgsjz8oeepp9cipa.jpeg"><br><br>  Semuanya tersebar di sekitar pusat data.  Pemain, tergantung di mana ping lebih baik, sambungkan ke lokasi.  Tetapi seluruh ekosistem tidak berskala seperti ini, terutama di Eropa dan Moskow, yang juga menambah beberapa masalah dengan keandalan - latensi ekstra dan penerusan. <br><br>  Seperti itulah ekosistem World of Tanks. <br><br>  Apa yang salah dengan semua ekonomi ini?  Apapun yang kamu mau!  Dan pergi J. Tapi mari kita pisahkan. <br><br><h2>  Poin kunci kegagalan dalam sebuah cluster <br></h2><br><h4>  Kegagalan satu mesin atau proses <br></h4><br>  Opsi paling sederhana yang dapat kami prediksi adalah kegagalan satu mesin atau proses dalam sebuah cluster.  Kami memiliki kelompok dari 10 hingga 100 mobil - sesuatu dapat terbang keluar.  Seperti yang saya katakan, BigWorld sendiri menyediakan mekanisme di luar kotak yang memungkinkan kita menjadi lebih andal. <br><br><img src="https://habrastorage.org/webt/-3/tl/-q/-3tl-qfzv-9slfdcdbymwl--s3a.jpeg"><br><br>  Skema standar: ada BaseApps yang tersebar di berbagai mesin.  Pada BaseApp ini ada entitas yang mengandung entitas negara.  Setiap BaseApp mencadangkan dirinya sendiri dengan Round Robin pada yang lain. <br><br>  Misalkan kita punya file dan beberapa BaseApp mati, atau seluruh mesin mati - tidak apa-apa!  BaseApps yang tersisa meninggalkan entitas ini, mereka akan dipulihkan, dan gameplay untuk pemain tidak akan menderita. <br><br><img src="https://habrastorage.org/webt/mm/ix/tp/mmixtp-1r1cmzro9zznc1o76a2g.jpeg"><br><br>  CellAPPs melakukan hal yang persis sama, satu-satunya hal adalah mereka menyimpan status mereka pada BaseApps juga, dan bukan pada CellAPP lain. <br><br>  Tampaknya menjadi mekanisme yang dapat diandalkan, tetapi ... <br><br><h5>  Anda harus membayar semuanya <br></h5><br>  Seiring waktu, kami mulai mengamati yang berikut ini. <br><br>  â€¢ Membuat salinan cadangan entitas mulai mengambil semakin banyak sumber daya sistem dan lalu lintas jaringan. <br><br>  Bahkan, proses pencadangan itu sendiri mulai mempengaruhi stabilitas sistem ketika di dalam klaster sebagian besar jaringan sibuk mengirimkan salinan ke Round Robins. <br><br>  â€¢ Ukuran entitas bertambah seiring berjalannya waktu, ketika atribut baru dan mekanisme permainan ditambahkan. <br><br>  Tetapi hal yang paling tidak menyenangkan adalah bahwa ukuran entitas ini tumbuh seperti longsoran salju.  Misalnya, seorang pemain melakukan beberapa aksi (membeli properti game), dan operasi ini mulai melambat.  Kami belum menyelesaikannya, tetapi telah menyimpan perubahan pada atribut ini.  Artinya, sistemnya sangat buruk, dan kami masih mulai meningkatkan ukuran cadangan yang perlu dilakukan.  Ada efek bola salju. <br><br>  â€¢ Stabilitas sistem secara keseluruhan menurun <br><br>  Karena kenyataan bahwa kami mencoba untuk melarikan diri dari jatuhnya satu mesin atau proses, kami menjatuhkan stabilitas seluruh sistem. <br><br>  <strong>Apa yang telah kami lakukan untuk mengatasi ini</strong> ?  Kami memutuskan untuk setiap entitas untuk menyoroti apa yang benar-benar perlu dicadangkan.  Kami membagi atribut menjadi bisa berubah dan tidak dapat diubah, dan kami menyalin bukan seluruh entitas, tetapi kami hanya mencadangkan atribut yang dapat berubah.  Dengan cara ini, kami hanya mengurangi jumlah informasi yang benar-benar perlu dijaga.  Sekarang, ketika menambahkan atribut baru, orang yang melakukan ini harus lebih jelas melihat di mana atribut itu.  Tetapi secara umum, ini menyelamatkan kita dari situasinya. <br><br>  Sejujurnya, mekanisme ini ditetapkan di BigWorld, tetapi di Tanks pada titik tertentu tidak lagi didukung sampai akhir, dan tidak setiap entitas dapat pulih dari cadangannya.  Di Kapal, misalnya, para pria mendukung ini.  Di sana Anda dapat dengan aman mematikan mesin - informasi hanya akan dipulihkan pada mesin lain, dan klien tidak akan melihat apa pun.  Sayangnya, ini tidak selalu terjadi di Tanks, tetapi kami akan mencapai pengembalian semua fungsi ini sehingga berfungsi sebagaimana mestinya. <br><br><h4>  Kegagalan pusat data.  Multi-cluster <br></h4><br>  Jika tiba-tiba bukan 1-2 mobil jatuh, dan kami mulai kehilangan seluruh pusat data, yaitu cluster sepenuhnya, properti apa yang harus dimiliki sistem agar permainan tidak jatuh dalam situasi seperti itu? <br><br><ul><li>  Setiap cluster harus independen, yaitu: <br><ol><li>  harus memiliki database sendiri; </li><li>  cluster hanya memproses ruangnya (arena pertempuran). </li></ol>  Jadi, jika beberapa arena menabrak, yang lain masih bekerja. </li><li>  Cluster harus berkomunikasi satu sama lain sehingga orang dapat mengatakan yang kedua: "Aku jatuh!"  Ketika naik, data akan dikembalikan dari salinan yang disimpan. </li><li>  Anda juga dapat memindahkan pengguna dari satu cluster ke cluster lainnya. </li></ul><br>  Saat ini, skema multi-cluster kami terlihat seperti ini. <br><br><img src="https://habrastorage.org/webt/ov/qd/2u/ovqd2ufkauofi1ybo1wduomewtu.jpeg"><br><br>  Kami memiliki cluster pusat dan apa yang kami sebut peripheral tempat pertempuran sebenarnya sedang berlangsung.  CellApp tidak berjalan di cluster pusat, jika tidak persis sama dengan orang lain.  Ini adalah titik pusat pemrosesan akun: mereka naik ke sana, dikirim ke pinggiran, dan di pinggiran sudah ada yang bermain.  Artinya, kegagalan dari salah satu cluster tidak menyebabkan hilangnya operabilitas seluruh permainan.  Bahkan kegagalan dari cluster pusat tidak memungkinkan pemain baru untuk masuk, tetapi mereka yang sudah bermain di pinggiran dapat melanjutkan permainan. <br><br>  Fakta bahwa semuanya bekerja untuk kita melalui cluster pusat telah berubah karena pada umumnya teknologi BigWorld sendiri mengasumsikan bahwa ada proses pengelolaan khusus antar manajer klaster.  Faktanya, manajer antar-klaster semacam itu dapat dibesarkan. <br><br>  Secara historis, Tanks membutuhkan multi-cluster, karena mulai longsoran online.  Ketika kami mencapai puncak 200 ribu pemain, lalu lintas masuk dari mereka berhenti ditempatkan di pusat data melalui jaringan.  Kami harus benar-benar berlutut semacam solusi sehingga pemain dapat diluncurkan ke beberapa pusat data. <br><br>  Faktanya, kami hanya menang, karena kami sekarang memiliki multi-cluster.  Ini juga menjadi berguna bagi pemain, karena ping, yaitu aksesibilitas melalui jaringan, sangat memengaruhi permainan.  Jika keterlambatan lebih dari 50-70 ms, ini sudah mulai mempengaruhi kualitas permainan itu sendiri, karena di Tanks semuanya benar-benar dihitung pada server.  Tidak ada perhitungan pada klien.  Karena itu, perlu diingat bahwa praktis tidak ada yang bisa dilakukan.  Tentu saja, beberapa mod dibuat di sana, tetapi mereka tidak memengaruhi proses itu sendiri.  Anda dapat mencoba menebak apa yang akan terjadi, tetapi untuk memengaruhi mekanik game itu sendiri - tidak. <br><br>  Karena pendekatan ini, <strong>kluster pusat</strong> kami <strong>telah menjadi titik kegagalan</strong> .  Semuanya tertutup baginya.  Kami memutuskan - karena mesin ini dan basis permainan besar berdiri di sana, biarkan periferal kami berurusan secara eksklusif dengan pertempuran.  Maka benar-benar tidak perlu menyimpan informasi dalam jumlah besar - pertempuran sedang dimainkan dan dimainkan - mari kita kunci semua yang ada di sana. <br><br>  Untuk benar-benar menulis ulang semuanya untuk menjauh dari konsep cluster pusat, sekarang tidak ada waktu, tidak ada keinginan khusus.  Tetapi kami memutuskan, pertama, untuk mengajarkan kluster periferal untuk berkomunikasi satu sama lain.  Kemudian kami menggergaji mereka sehingga memungkinkan untuk mempengaruhi mereka menggunakan layanan pihak ketiga. <br><br>  Sebagai contoh, untuk menciptakan pertempuran sebelumnya, perlu untuk memberitahu kelompok pusat bahwa perlu membuat pertempuran di beberapa pinggiran.  Selanjutnya, dengan mekanisme internal, entitas bergerak, esensi arena diciptakan, dll. <br><br>  <strong>Sekarang dimungkinkan untuk secara langsung menghubungi pinggiran, melewati cluster pusat.</strong>  Jadi kami menghapus pekerjaan ekstra darinya.  Tetapi sejauh ini tidak ada keinginan untuk sepenuhnya beralih ke skema di mana semua cluster hampir peer-to-peer, dan semua ini dikendalikan oleh beberapa proses, tetapi tidak pada cluster. <br><br>  Saya mengingatkan Anda bahwa selain cluster game dengan BaseApps, CellApps, dan lainnya, kami memiliki ekosistem. <br><br><img src="https://habrastorage.org/webt/oi/-o/ax/oi-oaxdx4eek4e5omtpwlyp5ism.jpeg"><br><br>  Kami mencoba memastikan bahwa kinerja ekosistem tidak memengaruhi permainan.  Dalam kasus terburuk, misalnya, sistem turnamen tidak berfungsi, tetapi Anda dapat bermain secara acak - toh, kebanyakan orang bermain secara acak.  Ya, kami menurunkan kualitas, tetapi secara umum, Anda dapat bertahan beberapa jam tanpa turnamen. <br><br>  Ini tidak selalu terjadi.  Pertama, sudah ada layanan web yang tertanam dalam game.  Misalnya, satu titik otorisasi adalah layanan yang memungkinkan Anda untuk masuk di web atau di suatu tempat di satu tempat, dan benar-benar masuk ke seluruh semesta Wargaming. <br><br>  Contoh kedua adalah layanan yang melayani pembelian dan transaksi game.  Itu juga harus dimasukkan ke dalam permainan hanya karena kami membutuhkan jejak pembelian pemain.  Faktanya adalah bahwa di beberapa wilayah kami diwajibkan untuk menampilkan informasi kepada klien tentang apa properti game yang dibeli dengan uang sungguhan dan yang mana untuk uang game.  Sistem awalnya tidak menganggap ini, tidak ada yang meletakkannya 5 tahun yang lalu, tetapi <strong>hukumnya keras: Anda perlu melakukannya - lakukanlah</strong> . <br><br><h2>  Poin kegagalan ekosistem World of Tanks <br></h2><br><h3>  Masalah nomor 1. Peningkatan beban <br></h3><br>  Kami memiliki multi-cluster di mana 10 cluster dengan sejumlah besar mesin.  Pemain memainkannya, dan web kecil.  Tidak ada yang membeli lima mesin lagi di setiap pusat data.  Tetapi pada saat yang sama, kami menyediakan semua fungsi yang sama dan semua yang dibutuhkan tepat di dalam klien.  Ini adalah masalah utama. <br><br><blockquote>  Interaktivitas dan reaktivitas antarmuka adalah sumber utama dari peningkatan beban ekosistem. <br></blockquote><br>  Saya akan memberikan dua contoh dari layanan klan: <br><br><ol><li>  Anda ingin mengundang pemain lain ke klan.  Tentu saja, saya ingin undangan segera menerima pemberitahuan, dan dia akan dapat bergabung dengan Anda.  Untuk mengimplementasikan ini, perlu untuk membuat layanan klan entah bagaimana memberi tahu klien, atau membiarkan klien bertanya layanan web dari waktu ke waktu: â€œApakah ada yang berubah?  Apakah saya punya undangan baru? "  Ini adalah opsi pertama dari mana beban tambahan dapat berasal. </li><li>  Tank memiliki rezim yang dibentengi.  Misalkan itu dimainkan bukan oleh satu orang, tetapi beberapa.  Semua pemain memiliki jendela terbuka dengan area yang dibentengi.  Komandan membangun gedung itu.  Dianjurkan agar semua orang yang memiliki jendela ini terbuka, bangunan segera muncul. </li></ol><br>  Keputusan di dahi dengan survei tidak terlalu baik.  Faktanya, ini berfungsi, hanya saja Anda perlu mengalokasikan begitu banyak kapasitas untuk ini sehingga fitur ini tidak akan mendatangkan untung bagi perusahaan.  Dan jika fitur tersebut tidak mendatangkan untung, maka Anda tidak perlu melakukannya. <br><br><blockquote>  Saran pribadi saya tentang cara menangani ini: cara terbaik untuk membuat sistem lebih dapat diandalkan di bawah beban adalah untuk secara umum mengurangi beban entah bagaimana secara logis. </blockquote><br>  Anda seharusnya tidak dibaringkan dengan besi, menghasilkan sistem yang ketinggalan jaman baru, mengoptimalkan sesuatu - lagi pula, semakin besar bebannya, semakin banyak artefak akan muncul yang tidak dapat Anda hindari.  Selain itu, artefak akan terjadi bahkan pada tingkat abstraksi yang lebih rendah dan lebih rendah - pertama dengan aplikasi, kemudian dengan layanan web yang berbeda, maka Anda akan sampai ke jaringan (cisco, dll.).  Pada tingkat tertentu, Anda tidak bisa menyelesaikan masalah. <br><br>  Jika Anda berpikir dengan hati-hati, itu bisa dihindari. <br><br>  Hal pertama yang kami lakukan adalah <strong>mempelajari cara memberi tahu klien melalui server game</strong> menggunakan infrastrukturnya.  Misalnya, ketika undangan datang ke klan, kami memberi tahu server: "Kami mengundang orang-orang ini dan itu," dan kemudian kluster itu sendiri menemukan orang yang kepadanya pemberitahuan harus dikirim, terutama karena mereka memiliki koneksi.  Artinya, kami mendorong dari layanan, dan tidak ada yang terus-menerus menuangkan kami.    ,          ,       .   ,   ,    . <br><br>  â€”  <strong>Web-sockets (nginx-pushstream)</strong> . ,      Web-sockets.   ,      Chromium Embedded Framework â€”  ,   , Web-sockets   Nginx.   pushstream,     Web-sockets       . <br><br><h3>  â„– 2.    <br></h3><br>  ,    ,   ,  <strong> â€”  </strong> .    ,    ,    â€”    . <strong>    ,    </strong> ,   . <br><br>   ?  : -  , - ,             ,    .   - , , .    . <br><br>        . <br><br><img src="https://habrastorage.org/webt/ul/8f/6m/ul8f6mjlivwkgkswzl-cwtxlx-o.jpeg"><br><br>  ,      <strong>120      </strong> <strong>Game Play</strong> .    .         ,     ,      .      ,          .    . <br><br> <strong> </strong> <br><br>  3  ,   : <br><br><ol><li> HTTP API; </li><li> RabbitMQ â€”  ; </li><li> Apache Kafka     . </li></ol><br>     ,    ,  ,  ,      ,    .     ,  -  â€” ,    .          ,      . <br><br> <strong> </strong> <br><br> <strong>1. HTTP</strong> <br><br>    â€”  HTTP.   ,  ,   -,      .      : <br><br><ul><li>      (  ,     ). <br></li></ul><br> ,    ,       .    ,   , ,  Django,    100  200 ,    API,  .    ,   ,   - 30-40 ,     ,   .   ,   â€”     . <br><br><ul><li>      . <br></li></ul><br>  ,    ,   HTTP, â€”       .      .   â€”  â€”  .   , <strong> ,  , ,  </strong> . <br><br><ul><li>     . <br></li></ul><br>     .   .  - ,   - API â€”    API,        . <br><br>      â€”      ,      . ,   ,      . ,      10 ,  -     100    500. ,    HTTP     .    nginx'   ,       â€”  . <br><br>  ,    HTTP  ,         . <br><br> <strong>2. RabbitMQ</strong> <br><br>    RabbitMQ     BigWord     . <br><br><ul><li>     . <br></li></ul><br>         â€” -  ,   ,  , . <br><br><ul><li>   Â«Â»,    ,        . <br></li></ul><br>    :      .    ,     API: Â«      N    â€”    Â».    ,      , , ,  â€”          .      ,      . <br><br>  Â«Â»,   Â«Â»,    â€”       . <br><br><ul><li>     . <br></li></ul><br> RabbitMQ  ,      , ,      ,      ,   ,      ,   . <br><br><blockquote>   â€”    RabbitMQ     . </blockquote><br> <strong>3. Kafka</strong> <br><br>     ,    ,     â€”   Kafka.   ,   RabbitMQ   -     . <br><br><ul><li>     . <br></li></ul><br>     ,       ,    ,    .  ,  ,        .      .   Kafka. ,    â€”    ,    . <br><br><ul><li>     . <br></li></ul><br>    ,     .        ,    ,     -  â€”     . <br><br>  Kafka   ,    ,        ,    -   ,       .      . <br><br><h2>    <br></h2><br>      â€”    . <br><br><img src="https://habrastorage.org/webt/ke/ty/oc/ketyocondz4qhsiguntwchhmonq.jpeg"><br><br> : <br><br><ul><li>   <strong> </strong> .         ,   - ,   .. </li><li>   <strong> </strong> â€”  , , , . </li><li>      â€” <strong>      </strong> ,    .       ,    ,   . </li></ul><br>     .     , , ,   entity.   .    ,     ,       . <br><br><h2> DLC <br></h2><br>    ,   DLC (Development Lifecycle) â€” ,  ,   . <br><br><img src="https://habrastorage.org/webt/3c/5t/c2/3c5tc2hlxbrgpdtjts88yxrcp3e.jpeg"><br><br>     ,  ,   . DLC   ,        ,          .       ,  . ,      ,       ,     . <br><br>           DLC,       .     ,        ,    ,  . <br><br>     DLC,   ,    : <br><br> â€¢ <strong>   (      ).</strong> <br><br>     ,    ,    Â«- ,   Â»,   .     ,       , ,    ,    . <br><br> â€¢        :   SRE. <br><br>    ,  solution-, technical-owner, reability- â€”       ,   -  ,    game-    .    , ,     ,       .   - ,      ,    ,      ,   .    ,     . <br><br> â€¢ <strong>SRE    .</strong> <br><br>        â€”  -   .          ,        .    ,  SRE     -.    SRE  ,     : Â«    ,       ,    ,     â€”   !Â»      ,   . <br><br>        QA ,    , -  , ,    â€”    . <br><br><h2>  <br></h2><br> BigWorld Technology  Â«Â»       .      ,  .         .  Â« Â»,    . <br><br>  Â«  Â»     ,     ,    .   â€” Â«Â» (, ) â€”     .      ,        . , -  . <br><br> <i>:         ++.    ,    40        ,    .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">  </a>  ,      .</i> <br><br><blockquote>  RootConf   â€”   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">DevOpsConf Russia</a> .        DevOps <b>1  2   </b> ,  .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a> ,       . ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">  </a>    â€”    ! <br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id418977/">https://habr.com/ru/post/id418977/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id418963/index.html">Ulasan robot desktop DoBot Magician</a></li>
<li><a href="../id418969/index.html">Bagaimana hari-hari terakhir perlombaan menjadi $ 1 triliun? (UPD.: Apple menang)</a></li>
<li><a href="../id418971/index.html">Peta radiasi Jupiter adalah kunci untuk eksplorasi baru di Eropa</a></li>
<li><a href="../id418973/index.html">Temui DevOpsConf Rusia</a></li>
<li><a href="../id418975/index.html">Bagaimana mengukur kesuksesan. Memantau strategi dan hubungannya dengan masalah bisnis</a></li>
<li><a href="../id418979/index.html">Ketika saya terbang di seluruh negeri, mengimplementasikan proyek untuk beberapa ribu pekerjaan</a></li>
<li><a href="../id418981/index.html">Metode numerik untuk menyelesaikan persamaan elips</a></li>
<li><a href="../id418985/index.html">Analisis dan desain secara keseluruhan</a></li>
<li><a href="../id418987/index.html">Firefox dengan mudah melewati perlindungan di antarmuka Gmail baru</a></li>
<li><a href="../id418991/index.html">Mikrofilm akan ada selama setengah milenium</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>