<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛏️ 💆🏾 🧜🏾 Rust 1.37.0版本：配置文件引导的优化，未命名的常量和货物供应商 🙄 👲🏻 👨‍👩‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="敬请关注的Rust编程语言新版本的出版物翻译。 
 引言 


 Rust开发团队很高兴地宣布发布新版本1.37.0。 Rust是一种编程语言，它使每个人都可以创建可靠而高效的软件。 


 如果您使用rustup安装了旧版本的Rust，那么要升级到1.37.0版，您只需要运行以下命令： 


$ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rust 1.37.0版本：配置文件引导的优化，未命名的常量和货物供应商</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463823/"><p> 敬请关注的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Rust</a>编程语言新版本的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">出版物</a>翻译。 </p><br><h1 id="vvedenie"> 引言 </h1><br><p>  Rust开发团队很高兴地宣布发布新版本1.37.0。  Rust是一种编程语言，它使每个人都可以创建可靠而高效的软件。 </p><br><p> 如果您使用rustup安装了旧版本的Rust，那么要升级到1.37.0版，您只需要运行以下命令： </p><br><pre><code class="bash hljs">$ rustup update stable</code> </pre> <br><p> 如果尚未安装<code>rustup</code> ，则可以从我们网站的相应页面进行<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">安装</a> ，以及在GitHub上查看<a href="">详细的发行说明</a> 。 </p><a name="habracut"></a><br><h1 id="chto-voshlo-v-stabilnuyu-versiyu"> 稳定版包含哪些内容？ </h1><br><p>  Rust 1.37.0的主要创新包括通过类型别名，内置<code>cargo vendor</code> ，未命名常量，配置文件引导的优化，货物项目的<code>default-run</code>键和<code>#[repr(align(N))]</code> 。 有关更多信息，请参见<a href="">详细的发行说明</a> 。 </p><br><h1 id="ssylki-na-varianty-perechisleniya-enum-cherez-psevdonimy-tipov-type"> 通过类型别名链接到<code>enum</code>选项 </h1><br><p> 从Rust 1.37.0开始，通过类型别名可以引用<code>enum</code>选项： </p><br><pre> <code class="rust hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ByteOption</span></span></span></span> = <span class="hljs-built_in"><span class="hljs-built_in">Option</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">u8</span></span>&gt;; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">increment_or_zero</span></span></span></span>(x: ByteOption) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">u8</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> x { ByteOption::<span class="hljs-literal"><span class="hljs-literal">Some</span></span>(y) =&gt; y + <span class="hljs-number"><span class="hljs-number">1</span></span>, ByteOption::<span class="hljs-literal"><span class="hljs-literal">None</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>, } }</code> </pre> <br><p> 在<code>impl</code>块中， <code>Self</code>充当类型的别名，因此在Rust 1.37.0中，可以使用<code>Self::Variant</code>语法引用枚举选项： </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">impl</span></span> Coin { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">value_in_cents</span></span></span></span>(&amp;<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">u8</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> { Self::Penny =&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>, Self::Nickel =&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>, Self::Dime =&gt; <span class="hljs-number"><span class="hljs-number">10</span></span>, Self::Quarter =&gt; <span class="hljs-number"><span class="hljs-number">25</span></span>, } } }</code> </pre> <br><p> 更具体地说，现在Rust允许您通过<em>“相对类型的分辨率”</em> <code>&lt;MyType&lt;..&gt;&gt;::Variant</code>引用枚举选项。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">稳定性报告中</a>提供了更详细的说明。 </p><br><h1 id="vstroennaya-podderzhka-cargo-dlya-zavisimostey-postavschika"> 供应商依赖性的本地货运支持 </h1><br><p> 作为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">独立包装</a>存在数年之后， <code>cargo vendor</code>团队现已整合到Cargo中。 此命令将项目的所有依赖关系提取到<code>vendor/</code>目录中，并显示在组装期间使用供应商代码所需的配置片段。 </p><br><p>  <code>cargo vendor</code>已经在实际项目中使用： <code>rustc</code>编译器使用它来发送其所有依赖项以发布tarball，而具有单一存储库的项目使用它来修复版本控制中的依赖项代码。 </p><br><h1 id="ispolzovanie-neimenovannyh-konstant-const-v-makrosah"> 在宏中使用未命名的常量 </h1><br><p> 现在，您可以通过用下划线（ <code>_</code> ）替换其标识符来创建<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code> (unnamed)  (const</code></a> ）。 例如，在<code>rustc</code>编译器中<code>rustc</code>我们找到了以下代码： </p><br><pre> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">///   ,    ///  ,   -  . #[macro_export] macro_rules! static_assert_size { ($ty:ty, $size:expr) =&gt; { const _: [(); $size] = [(); ::std::mem::size_of::&lt;$ty&gt;()]; // ^    . } } static_assert_size!(Option&lt;Box&lt;String&gt;&gt;, 8); // 1. static_assert_size!(usize, 8); // 2.</span></span></code> </pre> <br><p> 注意第二个<code>static_assert_size!(..)</code> ：由于使用了未命名的常量，因此在声明新元素时可以防止名称冲突。 之前，您需要编写<code>static_assert_size!(MY_DUMMY_IDENTIFIER, usize, 8);</code>  。 通过引入未命名的常量，可以更轻松地创建符合人体工程学的可重复使用的声明性和过程宏，以进行静态分析。 </p><br><h1 id="profile-guided-optimization"> 配置文件引导的优化 </h1><br><p> 现在， <code>rustc</code>编译器中提供了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Profile-Guided Optimization（PGO）</a> ，可以通过<code>-C profile-generate</code>和<code>-C profile-use</code>编译器标志启用它。 </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Profile-Guided Optimization</a>是一种编译器软件优化技术，用于分析测试运行而不是源代码。 它通过在两个阶段编译优化程序来工作： </p><br><ol><li> 首先，使用内置在编译器中的工具创建程序。 这可以通过传递<code>rustc</code>标志<code>-C profile-generate</code> 。 然后，应在数据样本上运行该工具程序，随后它将把概要分析数据写入文件。 </li><li> 然后，程序<em>再次</em> <code>rustc</code> ，这一次使用<code>-C profile-use</code>标志将收集的概要分析数据传递回<code>rustc</code> 。 该程序集将使用收集的数据来允许编译器对代码放置，嵌入和其他优化做出更好的决策。 </li></ol><br><p> 有关Profile-Guided Optimization的更多信息，请参见<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">rustc编译器手册中</a>的相应章节。 </p><br><h1 id="vybor-ispolnyaemogo-fayla-v-cargo-proektah"> 在Cargo项目中选择可执行文件 </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>cargo run</code></a>是用于快速测试控制台应用程序的非常方便的工具。 当一个软件包中存在多个可执行文件时，必须使用<code>--bin</code>标志显式声明要运行的可执行文件的名称。 这使得<code>cargo run</code>不像我们希望的那样符合人体工程学，尤其是当某个特定的可执行文件比其他可执行文件被更频繁地调用时。 </p><br><p>  Rust 1.37.0通过向Cargo.toml添加一个新的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>default-run</code></a>键（ <code>[package]</code>部分）来解决此问题。 因此，如果未<code>--bin</code>标志，则Cargo将启动配置中声明的二进制文件。 </p><br><h1 id="repralignn-dlya-perechisleniy">  <code>#[repr(align(N))]</code>进行枚举 </h1><br><p> 从Rust 1.37.0开始，属性<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>#[repr(align(N))]</code></a>可用于确定内存<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">中</a>枚举的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">对齐方式</a> （以前该属性仅适用于结构（ <code>struct</code> ）和并集（ <code>union</code> ））。 例如，如预期的那样， <code>Align16</code>枚举将具有<code>16</code>个字节的对齐方式，而没有<code>#[repr(align(16))]</code>自然对齐方式将为<code>4</code> ： </p><br><pre> <code class="rust hljs"><span class="hljs-meta"><span class="hljs-meta">#[repr(align(16))]</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Align16</span></span></span></span> { Foo { foo: <span class="hljs-built_in"><span class="hljs-built_in">u32</span></span> }, Bar { bar: <span class="hljs-built_in"><span class="hljs-built_in">u32</span></span> }, }</code> </pre> <br><p> 使用<code>#[repr(align(N))</code>进行枚举的<code>AlignN&lt;T&gt;</code>与为此对齐方式定义<code>AlignN&lt;T&gt;</code>结构的包装器，然后使用<code>AlignN&lt;MyEnum&gt;</code> ： </p><br><pre> <code class="rust hljs"><span class="hljs-meta"><span class="hljs-meta">#[repr(align(N))]</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AlignN</span></span></span></span>&lt;T&gt;(T);</code> </pre> <br><h1 id="izmeneniya-v-standartnoy-biblioteke"> 对标准库的更改 </h1><br><p>  Rust 1.37.0稳定了标准库的以下组件： </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>BufReader::buffer</code></a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>BufWriter::buffer</code></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>Cell::from_mut</code></a> </li> <li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>Cell::as_slice_of_cells</code></a> </li> <li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>DoubleEndedIterator::nth_back</code></a> </li> <li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>Option::xor</code></a> </li> <li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>{i,u}{8,16,64,128,size}::reverse_bits</code></a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>Wrapping::reverse_bits</code></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>slice::copy_within</code></a> </li> </ul><br><h1 id="drugie-izmeneniya"> 其他变化 </h1><br><p>  <a href="">语法</a> ， <a href="">货物包裹管理器</a>和<a href="">Clippy分析器</a>也进行了一些更改。 </p><br><h1 id="uchastniki-1370"> 成员1.37.0 </h1><br><p> 许多人一起创建了Rust 1.37.0。 没有你们大家，我们不可能做到这一点， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">谢谢！</a> </p><br><h1 id="novye-sponsory-infrastruktury-rust"> 新的Rust基础设施赞助商 </h1><br><p> 我们要感谢两个新的Rust基础设施赞助商，他们提供了构建Rust 1.37.0所需的资源：Amazon Web Services（AWS）和Microsoft Azure： </p><br><ul><li>  AWS为发布工件（编译器，库，工具和源代码）提供了托管，通过CloudFront向用户授予了对这些工件的访问权限，防止了Crater的EC2退化，并管理了AWS上托管的另一个与Rust相关的基础架构。 </li><li> 为了对rust-lang / rust存储库进行极其苛刻的测试，Microsoft Azure提供了构建器。 </li></ul><br><h1 id="ot-perevodchikov"> 来自翻译 </h1><br><p> 如果您对Rust语言有任何疑问，他们将可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">俄语电报聊天</a>或<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">对新手</a>进行的类似<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">聊天中为</a>您提供帮助。 </p><br><p> 本文由<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">andreevlex</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">ozkriff</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">funkill</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">Gymmasssorla</a>共同翻译。 <br></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN463823/">https://habr.com/ru/post/zh-CN463823/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN463813/index.html">Mikrotik RouterOS上的多厢货车和路由</a></li>
<li><a href="../zh-CN463815/index.html">为什么外国银行对您的资金来源感兴趣？</a></li>
<li><a href="../zh-CN463817/index.html">20位产品经理和所有最多的多维矩阵结构。 与Skyeng的对话</a></li>
<li><a href="../zh-CN463819/index.html">PostgreSQL锁：2.字符串锁</a></li>
<li><a href="../zh-CN463821/index.html">AMO，Bitrix，1C等：如何选择从哪里开始？</a></li>
<li><a href="../zh-CN463825/index.html">Google表格项目管理工具</a></li>
<li><a href="../zh-CN463829/index.html">FreePBX 配置Asterisk，以通过电子邮件通知队列中未接来电</a></li>
<li><a href="../zh-CN463831/index.html">俄罗斯的IT教育有什么问题</a></li>
<li><a href="../zh-CN463833/index.html">关于阻滞剂的小型调查</a></li>
<li><a href="../zh-CN463835/index.html">危险的物联网：业务威胁和解决方案</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>