<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∞üèø üë©üèΩ‚Äç‚úàÔ∏è ‚õπüèø Python como el √∫ltimo caso de C ++. Parte 2/2 üë®üèø‚Äçüíº üë®üèø‚Äç‚öñÔ∏è üë®‚Äçüîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuar√° Comenzando en Python como el √∫ltimo caso de C ++. Parte 1/2 ". 
 Variables y tipos de datos 


 Ahora que finalmente hemos descubierto las ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Python como el √∫ltimo caso de C ++. Parte 2/2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464405/"><p>  Continuar√°  Comenzando en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Python como el √∫ltimo caso de C ++.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1/2</a> ". </p><br><h1>  Variables y tipos de datos </h1><br><p>  Ahora que finalmente hemos descubierto las matem√°ticas, decidamos qu√© variables deben significar en nuestro idioma. </p><br><p>  En C ++, un programador tiene una opci√≥n: usar variables autom√°ticas ubicadas en la pila o mantener los valores en la memoria de datos del programa, colocando solo punteros a estos valores en la pila.  ¬øQu√© sucede si elegimos solo una de estas opciones para Python? </p><br><p>  Por supuesto, no siempre podemos usar solo los valores de las variables, ya que las grandes estructuras de datos no caben en la pila, o su movimiento constante en la pila crear√° problemas de rendimiento.  Por lo tanto, solo utilizaremos punteros en Python.  Esto simplificar√° conceptualmente el lenguaje. </p><a name="habracut"></a><br><p>  Entonces la expresi√≥n </p><br><pre><code class="python hljs">a = <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br><p>  significar√° que creamos un objeto "3" en la memoria de datos del programa (el llamado "mont√≥n") e hicimos referencia al nombre "a".  Y la expresi√≥n </p><br><pre> <code class="python hljs">b = a</code> </pre> <br><p>  en este caso, significar√° que forzamos a la variable "b" a referirse al mismo objeto en la memoria que "a" se refiere, en otras palabras, copiamos el puntero. </p><br><p>  Si todo es un puntero, ¬øcu√°ntos tipos de lista necesitamos implementar en nuestro idioma?  ¬°Por supuesto, solo uno es una lista de punteros!  Puede usarlo para almacenar enteros, cadenas, otras listas, lo que sea, despu√©s de todo, estos son punteros. </p><br><p>  ¬øCu√°ntos tipos de tablas hash necesitamos implementar?  (En Python, este tipo se llama "diccionario" - <code>dict</code> .) ¬°Uno!  Deje que asocie punteros a claves con punteros a valores. </p><br><p>  Por lo tanto, no necesitamos implementar en nuestro lenguaje una gran parte de la especificaci√≥n de C ++: plantillas, ya que realizamos todas las operaciones en objetos, y los objetos siempre son accesibles por puntero.  Por supuesto, los programas escritos en Python no tienen que limitarse a trabajar con punteros: hay bibliotecas como NumPy que ayudan a los cient√≠ficos a trabajar con matrices de datos en la memoria, como lo har√≠an en Fortran.  Pero la base del lenguaje, expresiones como "a = 3", siempre funciona con punteros. </p><br><p>  El concepto de "todo es un puntero" tambi√©n simplifica la composici√≥n de los tipos hasta el l√≠mite.  ¬øQuieres una lista de diccionarios?  ¬°Simplemente cree una lista y ponga diccionarios all√≠!  No necesita pedir permiso a Python, no necesita declarar tipos adicionales, todo funciona de forma inmediata. </p><br><p>  Pero, ¬øqu√© pasa si queremos usar objetos compuestos como claves?  La clave en el diccionario debe tener un valor inmutable, de lo contrario, ¬øc√≥mo buscar valores por √©l?  Las listas est√°n sujetas a cambios, por lo tanto, no se pueden usar en esta capacidad.  Para tales situaciones, Python tiene un tipo de datos que, como una lista, es una secuencia de objetos, pero, a diferencia de una lista, esta secuencia no cambia.  Este tipo se llama tupla o <code>tuple</code> (se pronuncia "tupla" o "tupla"). </p><br><p>  Las tuplas en Python resuelven un problema de lenguaje de secuencias de comandos de larga data.  Si no est√° impresionado con esta funci√≥n, probablemente nunca haya intentado usar lenguajes de secuencias de comandos para un trabajo serio con datos, en el que puede usar solo cadenas o solo tipos primitivos como clave en las tablas hash. </p><br><p>  Otra posibilidad que nos dan las tuplas es devolver varios valores de una funci√≥n sin tener que declarar tipos de datos adicionales para esto, como debe hacer en C y C ++.  Adem√°s, para facilitar el uso de esta funci√≥n, el operador de asignaci√≥n estaba dotado de la capacidad de desempaquetar autom√°ticamente las tuplas en variables separadas. </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_address</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> host, port host, port = get_address()</code> </pre> <br><p>  Desempacar tiene varios efectos secundarios √∫tiles, por ejemplo, el intercambio de valores variables se puede escribir de la siguiente manera: </p><br><pre> <code class="python hljs">x, y = y, x</code> </pre> <br><p>  Todo es un puntero, lo que significa que las funciones y los tipos de datos se pueden usar como datos.  Si est√° familiarizado con el libro "Patrones de dise√±o" de "The Gang of Four", debe recordar qu√© m√©todos complejos y confusos ofrece para parametrizar la elecci√≥n del tipo de objeto creado por su programa en tiempo de ejecuci√≥n.  De hecho, en muchos lenguajes de programaci√≥n esto es dif√≠cil de hacer.  En Python, todas estas dificultades desaparecen, porque sabemos que una funci√≥n puede devolver un tipo de datos, que tanto las funciones como los tipos de datos son solo enlaces, y los enlaces se pueden almacenar, por ejemplo, en diccionarios.  Esto simplifica la tarea hasta el l√≠mite. </p><br><p>  David Wheeler dijo: "Todos los problemas de programaci√≥n se resuelven creando un nivel adicional de indirecci√≥n".  El uso de enlaces en Python es el nivel de indirecci√≥n que tradicionalmente se ha utilizado para resolver muchos problemas en muchos lenguajes, incluido C ++.  Pero si se usa expl√≠citamente all√≠, y esto complica los programas, entonces en Python se usa impl√≠citamente, de manera uniforme con respecto a datos de todo tipo, y es f√°cil de usar. </p><br><p>  Pero si todo es un enlace, ¬øa qu√© se refieren estos enlaces?  Lenguajes como C ++ tienen muchos tipos.  Dejemos en Python solo un tipo de datos: ¬°un objeto!  Los especialistas en el campo de la teor√≠a de tipos sacuden la cabeza con desaprobaci√≥n, pero creo que un tipo de datos fuente, del que se derivan todos los otros tipos en el idioma, es una buena idea que garantiza la uniformidad del lenguaje y su facilidad de uso. </p><br><p>  Para contenidos de memoria espec√≠ficos, varias implementaciones de Python (PyPy, Jython o MicroPython) pueden administrar la memoria de diferentes maneras.  Pero para comprender mejor c√≥mo se implementa la simplicidad y uniformidad de Python, para formar el modelo mental correcto, es mejor recurrir a la implementaci√≥n de referencia de Python en C llamada CPython, que podemos descargar en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">python.org</a> . </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typeobject</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ob_type</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-comment"><span class="hljs-comment">/* followed by object's data */</span></span> }</code> </pre> <br><p>  Lo que veremos en el c√≥digo fuente de CPython es una estructura que consiste en un puntero a la informaci√≥n sobre el tipo de una variable dada y una carga √∫til que define el valor espec√≠fico de la variable. </p><br><p>  ¬øC√≥mo funciona la informaci√≥n de tipo?  Vamos a profundizar en el c√≥digo fuente de CPython nuevamente. </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typeobject</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> getattrfunc tp_getattr; setattrfunc tp_setattr; <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> newfunc tp_new; freefunc tp_free; <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> binaryfunc nb_add; binaryfunc nb_subtract; <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> richcmpfunc tp_richcompare; <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> }</code> </pre> <br><p>  Vemos punteros a funciones que proporcionan todas las operaciones que son posibles para un tipo dado: suma, resta, comparaci√≥n, acceso a atributos, indexaci√≥n, segmentaci√≥n, etc. Estas operaciones saben c√≥mo trabajar con la carga √∫til que se encuentra en la memoria debajo de un puntero para escribir informaci√≥n, ya sea un entero, una cadena o un objeto de un tipo creado por el usuario. </p><br><p>  Esto es radicalmente diferente de C y C ++, en el que la informaci√≥n de tipo est√° asociada con nombres, no con valores de variables.  En Python, todos los nombres est√°n asociados con enlaces.  El valor por referencia, a su vez, es de tipo.  Esta es la esencia de los lenguajes din√°micos. </p><br><p>  Para comprender todas las caracter√≠sticas del lenguaje, es suficiente para nosotros definir dos operaciones en los enlaces.  Una de las m√°s obvias es la copia.  Cuando asignamos un valor a una variable, un espacio en un diccionario o un atributo de un objeto, copiamos los enlaces.  Esta es una operaci√≥n simple, r√°pida y completamente segura: copiar enlaces no cambia el contenido del objeto. </p><br><p>  La segunda operaci√≥n es una llamada a una funci√≥n o m√©todo.  Como mostramos anteriormente, un programa Python puede interactuar con la memoria solo a trav√©s de m√©todos implementados en objetos incorporados.  Por lo tanto, no puede causar un error relacionado con el acceso a la memoria. </p><br><p>  Puede tener una pregunta: si todas las variables contienen referencias, ¬øc√≥mo puedo proteger el valor de una variable de los cambios pas√°ndolo a la funci√≥n como par√°metro? </p><br><pre> <code class="python hljs">n = <span class="hljs-number"><span class="hljs-number">3</span></span> some_function(n) <span class="hljs-comment"><span class="hljs-comment"># Q: I just passed a pointer! # Could some_function() have changed ‚Äú3‚Äù?</span></span></code> </pre> <br><p>  La respuesta es que los tipos simples en Python son inmutables: simplemente no implementan el m√©todo responsable de cambiar su valor.  El inmutable (inmutable) <code>int</code> , <code>float</code> , <code>tuple</code> o <code>str</code> proporciona en lenguajes como "todo es un puntero" el mismo efecto sem√°ntico que las variables autom√°ticas proporcionan en C. </p><br><p>  Los tipos y m√©todos unificados simplifican el uso de la programaci√≥n generalizada, o gen√©ricos, tanto como sea posible.  Las funciones <code>min()</code> , <code>max()</code> , <code>sum()</code> y similares est√°n integradas, no es necesario importarlas.  Y funcionan con cualquier tipo de datos en el que se implementan operaciones de comparaci√≥n para <code>min()</code> y <code>max()</code> , adiciones para <code>sum()</code> , etc. </p><br><h1>  Crear objetos </h1><br><p>  Descubrimos en t√©rminos generales c√≥mo deben comportarse los objetos.  Ahora determinaremos c√≥mo los crearemos.  Esta es una cuesti√≥n de sintaxis del lenguaje.  C ++ admite al menos tres formas de crear un objeto: </p><br><ol><li>  Autom√°tico, al declarar una variable de esta clase: <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">my_class </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">c</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(arg)</span></span></span></span>;</code> </pre> </li><li>  Usando el <code>new</code> operador: <br><pre> <code class="cpp hljs">my_class *c = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> my_class(arg);</code> </pre> </li><li>  Factory, llamando a una funci√≥n arbitraria que devuelve un puntero: <br><pre> <code class="cpp hljs">my_class *c = my_factory(arg);</code> </pre> </li></ol><br><p>  Como ya habr√°s adivinado, habiendo estudiado la forma de pensar de los creadores de Python en los ejemplos anteriores, ahora debemos elegir uno de ellos. </p><br><p>  Del mismo libro, The Gangs of Four, aprendimos que una f√°brica es la forma m√°s flexible y universal de crear objetos.  Por lo tanto, solo este m√©todo se implementa en Python. </p><br><p>  Adem√°s de la universalidad, este m√©todo es bueno porque no necesita sobrecargarse con una sintaxis innecesaria para garantizarlo: una llamada a la funci√≥n ya est√° implementada en nuestro idioma, y ‚Äã‚Äãuna f√°brica no es m√°s que una funci√≥n. </p><br><p>  Otra regla para crear objetos en Python es esta: cualquier tipo de datos es su propia f√°brica.  Por supuesto, puede escribir cualquier cantidad de f√°bricas personalizadas adicionales (que ser√°n funciones o m√©todos ordinarios, por supuesto), pero la regla general seguir√° siendo v√°lida: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Let's make type objects # their own type's factories! c = MyClass() i = int('7') f = float(length) s = str(bytes)</span></span></code> </pre> <br><p>  Todos los tipos se denominan objetos, y todos devuelven valores de su tipo, determinados por los argumentos pasados ‚Äã‚Äãen la llamada. </p><br><p>  Por lo tanto, utilizando solo la sintaxis b√°sica del lenguaje, cualquier manipulaci√≥n al crear objetos, como los patrones "Arena" o "Adaptativos", puede encapsularse, ya que otra gran idea tomada de C ++ es que el tipo en s√≠ mismo determina c√≥mo sucede. engendrando sus objetos, c√≥mo el <code>new</code> operador trabaja para √©l. </p><br><h1>  ¬øQu√© tal NULL? </h1><br><p>  El manejo de un puntero nulo agrega complejidad al programa, por lo que prohibimos NULL.  La sintaxis de Python hace que sea imposible crear un puntero nulo.  Dos operaciones elementales sobre punteros, de las que hablamos anteriormente, se definen de tal manera que cualquier variable apunta a alg√∫n objeto. </p><br><p>  Como resultado de esto, el usuario no puede usar Python para crear un error relacionado con el acceso a la memoria, como un error de segmentaci√≥n o fuera de los l√≠mites del b√∫fer.  En otras palabras, los programas Python no se ven afectados por los dos tipos de vulnerabilidades m√°s peligrosos que amenazan la seguridad de Internet en los √∫ltimos 20 a√±os. </p><br><p>  Puede preguntar: "Si la estructura de operaciones en los objetos no ha cambiado, como vimos anteriormente, entonces, ¬øc√≥mo crear√°n los usuarios sus propias clases, con m√©todos y atributos que no figuran en esta estructura?" </p><br><p>  La magia radica en el hecho de que para las clases personalizadas Python tiene una "preparaci√≥n" muy simple con una peque√±a cantidad de m√©todos implementados.  Aqu√≠ est√°n los m√°s importantes: </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typeobject</span></span></span><span class="hljs-class"> {</span></span> getattrfunc tr_getattr; setattrfunc tr_setattr; <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> newfunc tp_new; <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> }</code> </pre> <br><p>  <code>tp_new()</code> crea una tabla hash para la clase de usuario, igual que para el tipo <code>dict</code> .  <code>tp_getattr()</code> extrae algo de esta tabla hash, y <code>tp_setattr()</code> , por el contrario, pone algo all√≠.  Por lo tanto, la capacidad de las clases arbitrarias para almacenar cualquier m√©todo y atributo no se proporciona a nivel de estructuras de lenguaje C, sino a un nivel superior: una tabla hash.  (Por supuesto, con la excepci√≥n de algunos casos relacionados con la optimizaci√≥n del rendimiento). </p><br><h1>  Modificadores de acceso </h1><br><p>  ¬øQu√© hacemos con todas esas reglas y conceptos que se construyen alrededor de palabras clave de C ++ <code>private</code> y <code>protected</code> ?  Python, siendo un lenguaje de script, no los necesita.  Ya tenemos partes "protegidas" del lenguaje: estos son datos de tipos incorporados.  ¬°En ning√∫n caso Python permitir√° que un programa, por ejemplo, manipule los bits de un n√∫mero de coma flotante!  Este nivel de encapsulaci√≥n es suficiente para mantener la integridad del lenguaje en s√≠.  Nosotros, los creadores de Python, creemos que la integridad del lenguaje es el √∫nico buen pretexto para ocultar informaci√≥n.  Todas las dem√°s estructuras y los datos del programa de usuario se consideran p√∫blicos. </p><br><p>  Puede escribir un gui√≥n bajo ( <code>_</code> ) al comienzo del nombre de un atributo de clase para advertir a un colega: no debe confiar en este atributo.  Pero el resto de Python aprendi√≥ las lecciones de principios de los 90: muchos creyeron que la raz√≥n principal por la que escribimos programas hinchados, ilegibles y con errores es la falta de variables privadas.  Creo que los pr√≥ximos 20 a√±os han convencido a todos en la industria de la programaci√≥n: las variables privadas no son las √∫nicas y est√°n lejos de ser el remedio m√°s efectivo para los programas hinchados y con errores.  Por lo tanto, los creadores de Python decidieron ni siquiera preocuparse por las variables privadas y, como pueden ver, no fallaron. </p><br><h1>  Gesti√≥n de la memoria </h1><br><p>  ¬øQu√© les sucede a nuestros objetos, n√∫meros y cadenas en un nivel inferior?  ¬øC√≥mo se almacenan exactamente en la memoria, c√≥mo CPython les proporciona acceso compartido, cu√°ndo y en qu√© condiciones se destruyen? </p><br><p>  Y en este caso, elegimos la forma m√°s general, predecible y productiva de trabajar con la memoria: desde el lado del programa C, todos nuestros objetos son <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">punteros compartidos</a> . </p><br><p>  Con este conocimiento en mente, las estructuras de datos que examinamos anteriormente en la secci√≥n "Variables y tipos de datos" deben complementarse de la siguiente manera: </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> Py_ssize_t ob_refcnt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typeobject</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ob_type</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-comment"><span class="hljs-comment">/* followed by object's data */</span></span> } }</code> </pre> <br><p>  Entonces, cada objeto en Python (nos referimos a la implementaci√≥n de CPython, por supuesto) tiene su propio contador de referencia.  Una vez que se convierte en cero, el objeto se puede eliminar. </p><br><p>  El mecanismo de conteo de enlaces no se basa en c√°lculos adicionales o procesos en segundo plano: un objeto puede destruirse instant√°neamente.  Adem√°s, proporciona una alta localidad de datos: a menudo, la memoria comienza a usarse nuevamente inmediatamente despu√©s de liberarse.  El objeto reci√©n destruido probablemente se us√≥ recientemente, lo que significa que estaba en la memoria cach√© del procesador.  Por lo tanto, el objeto reci√©n creado permanecer√° en la memoria cach√©.  Estos dos factores, la simplicidad y la localidad, hacen que el conteo de enlaces sea una forma muy productiva de recolecci√≥n de basura. </p><br><p>  (Debido al hecho de que los objetos en los programas reales a menudo se refieren entre s√≠, el contador de referencia en ciertos casos no puede caer a cero incluso cuando los objetos ya no se usan en el programa. Por lo tanto, CPython tambi√©n tiene un segundo mecanismo de recolecci√≥n de basura, uno de fondo, basado en en generaciones de objetos - <em>aprox. transl.</em> ) </p><br><h1>  Errores de desarrollador de Python </h1><br><p>  Intentamos desarrollar un lenguaje que fuera lo suficientemente simple para los principiantes, pero tambi√©n lo suficientemente atractivo para los profesionales.  Al mismo tiempo, no pudimos evitar errores en la comprensi√≥n y el uso de las herramientas que nosotros mismos creamos. </p><br><p>  Python 2, debido a la inercia del pensamiento asociado con los lenguajes de secuencias de comandos, intent√≥ convertir los tipos de cadenas, como lo har√≠a un lenguaje con escritura d√©bil.  Si intenta combinar una cadena de bytes con una cadena en Unicode, el int√©rprete convierte impl√≠citamente la cadena de bytes en Unicode utilizando la tabla de c√≥digos que est√° disponible en el sistema y presenta el resultado en Unicode: </p><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-string"><span class="hljs-string">'byte string '</span></span> + <span class="hljs-string"><span class="hljs-string">u'unicode string'</span></span> <span class="hljs-string"><span class="hljs-string">u'byte string unicode string'</span></span></code> </pre> <br><p>  Como resultado, algunos sitios web funcionaron bien mientras sus usuarios usaban el ingl√©s, pero produjeron errores cr√≠pticos al usar caracteres de otros alfabetos. </p><br><p>  Este error de dise√±o del lenguaje se ha corregido en Python 3: </p><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-string"><span class="hljs-string">b'byte string '</span></span> + <span class="hljs-string"><span class="hljs-string">u'unicode string'</span></span> TypeError: can<span class="hljs-string"><span class="hljs-string">'t concat bytes to str</span></span></code> </pre> <br><p>  Un error similar en Python 2 se relacion√≥ con la clasificaci√≥n "ingenua" de listas que constan de elementos incomparables: </p><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>sorted([<span class="hljs-string"><span class="hljs-string">'b'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>]) [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>]</code> </pre> <br><p>  Python 3 en este caso deja en claro al usuario que est√° tratando de hacer algo no muy significativo: </p><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>sorted([<span class="hljs-string"><span class="hljs-string">'b'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>]) TypeError: unorderable types: int() &lt; str()</code> </pre> <br><h1>  Abusos </h1><br><p>  Los usuarios de vez en cuando abusan de la naturaleza din√°mica del lenguaje Python, y luego, en los a√±os 90, cuando las mejores pr√°cticas a√∫n no se conoc√≠an ampliamente, esto sucedi√≥ especialmente a menudo: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Address</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, host, port)</span></span></span><span class="hljs-function">:</span></span> self.host = host self.port = port</code> </pre> <br><p>  "¬°Pero esto no es √≥ptimo!"  - Algunos dijeron, - ‚Äú¬øQu√© pasa si el puerto no difiere del valor predeterminado?  ¬°De todos modos, gastamos un atributo de clase entera en su almacenamiento! ‚Äù  Y el resultado es algo como </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Address</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, host, port=None)</span></span></span><span class="hljs-function">:</span></span> self.host = host <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> port <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: <span class="hljs-comment"><span class="hljs-comment"># so terrible self.port = port</span></span></code> </pre> <br><p>  Por lo tanto, los objetos del mismo tipo aparecen en el programa, que, sin embargo, no se pueden operar de manera uniforme, ya que algunos tienen un atributo determinado, mientras que otros no.  Y no podemos tocar este atributo sin verificar su presencia de antemano: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># code was forced to use introspection # (terrible!) if hasattr(addr, 'port'): print(addr.port)</span></span></code> </pre> <br><p>  Actualmente, la abundancia de <code>hasattr()</code> , <code>isinstance()</code> y otras introspecciones es un signo seguro de c√≥digo incorrecto, y se considera la mejor pr√°ctica para hacer que los atributos siempre <code>isinstance()</code> presentes en el objeto.  Esto proporciona una sintaxis m√°s simple al acceder a ella: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># today's best practice: # every atribute always present if addr.port is not None: print(addr.port)</span></span></code> </pre> <br><p>  Entonces, los primeros experimentos con atributos agregados y eliminados din√°micamente terminaron, y ahora miramos las clases en Python de la misma manera que en C ++. </p><br><p>  Otro mal h√°bito de Python temprano era el uso de funciones en las que un argumento puede tener tipos completamente diferentes.  Por ejemplo, puede pensar que puede ser demasiado dif√≠cil para el usuario crear una lista de nombres de columna cada vez, y debe permitirle pasarlos tambi√©n como una sola l√≠nea, donde los nombres de columnas individuales est√°n separados por, por ejemplo, una coma: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Dataframe</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, columns)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> isinstance(columns, str): columns = columns.split(<span class="hljs-string"><span class="hljs-string">','</span></span>) self.columns = columns</code> </pre> <br><p>  Pero este enfoque puede dar lugar a sus problemas.  Por ejemplo, ¬øqu√© sucede si un usuario accidentalmente nos da una fila que no est√° destinada a usarse como una lista de nombres de columna?  ¬øO si el nombre de la columna debe contener una coma? </p><br><p>  Adem√°s, dicho c√≥digo es m√°s dif√≠cil de mantener, depurar y especialmente probar: en las pruebas, solo se puede verificar uno de los dos tipos admitidos por nosotros, pero la cobertura seguir√° siendo del 100% y no probaremos el otro tipo. </p><br><p>  Como resultado, llegamos a la conclusi√≥n de que Python permite al usuario pasar argumentos de cualquier tipo a funciones, pero la mayor√≠a de ellos en la mayor√≠a de las situaciones usar√°n una funci√≥n de la misma manera que lo har√≠an en C: pasarle un argumento del mismo tipo. </p><br><p>  La necesidad de usar <code>eval()</code> en un programa se considera un error de c√°lculo arquitect√≥nico expl√≠cito.  Lo m√°s probable es que no hayas descubierto c√≥mo hacer lo mismo de una manera normal.     ‚àí ,      Jupyter notebook  -       ‚àí  <code>eval()</code>  ,      Python   ! ,     C++    . </p><br><p>     ,  ( <code>getattr()</code> , <code>hasattr()</code> , <code>isinstance()</code> )          .   ,   ,   ,      ,       : , ,  , ! </p><br><h1>   </h1><br><p>      :     ,           . 20             ,   C++  Python.   ,     ,    .         . </p><br><p>        ,    <code>shared_ptr</code>  TensorFlow   2016  2018 . </p><br><p> TensorFlow ‚àí       C++-,         Python- ( C++ ‚àí     TensorFlow, ). </p><br><p><img src="https://habrastorage.org/webt/dm/1g/zo/dm1gzovjtl2qbda7muz5wjzzjhq.png" alt="imagen"></p><br><p>         TensorFlow,  <code>shared_ptr</code> ,     .     ,     . </p><br><p>      C++?       .    ,   ?     ,     ,  C++  Python! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/464405/">https://habr.com/ru/post/464405/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../464391/index.html">10 informes interesantes de conferencias de hackers</a></li>
<li><a href="../464393/index.html">C√≥mo encontrar cursos de programaci√≥n y cu√°les son las garant√≠as de empleo.</a></li>
<li><a href="../464395/index.html">Blockchain basado en RSA al azar</a></li>
<li><a href="../464399/index.html">Web scraping en R, Parte 2. Acelerando el proceso con computaci√≥n paralela y usando el paquete Rcrawler</a></li>
<li><a href="../464403/index.html">C√≥mo ejecutar un proyecto java en un corredor de shell cuando se empuja a un repositorio de GitLab</a></li>
<li><a href="../464407/index.html">C√≥mo funcionan los sistemas de videovigilancia m√°s grandes del mundo</a></li>
<li><a href="../464409/index.html">C√≥mo la pol√≠tica del siglo XIX afect√≥ las ubicaciones de los centros de datos hoy</a></li>
<li><a href="../464411/index.html">PVS-Studio: motor de progreso</a></li>
<li><a href="../464413/index.html">PVS-Studio - motor de progreso</a></li>
<li><a href="../464415/index.html">Nuevo servicio de sugerencias para buscar hh.ru</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>