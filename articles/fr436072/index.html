<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÉ ‚úçüèº üçæ Nettoyer, marquer: comment nous avons appris √† chatbot √† distinguer les probl√®mes des clients üîú üöü üåà</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Anton Chaynikov, d√©veloppeur de Data Science, Redmadrobot 
 Bonjour, Habr! Aujourd'hui, je vais parler des √©pines sur le chemin du chatbot, ce qui fac...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nettoyer, marquer: comment nous avons appris √† chatbot √† distinguer les probl√®mes des clients</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redmadrobot/blog/436072/"><p><img src="https://habrastorage.org/webt/k4/rl/pc/k4rlpcs5lwl2dsvt97pez6qhfgw.png"></p><br><p><img src="https://habrastorage.org/webt/mp/4c/kh/mp4ckhvyt2k9kydafhv3vxa0its.png" align="left">  <strong>Anton Chaynikov, d√©veloppeur de Data Science, Redmadrobot</strong> <br>  <em>Bonjour, Habr!</em>  <em>Aujourd'hui, je vais parler des √©pines sur le chemin du chatbot, ce qui facilite le travail des op√©rateurs de chat de la compagnie d'assurance.</em>  <em>Plus pr√©cis√©ment, comment nous avons appris au bot √† distinguer les demandes les unes des autres √† l'aide de l'apprentissage automatique.</em>  <em>Quels mod√®les ont √©t√© exp√©riment√©s et lesquels ont obtenu les r√©sultats.</em>  <em>Comment quatre approches pour nettoyer et enrichir les donn√©es de qualit√© d√©cente et cinq tentatives pour nettoyer les donn√©es de qualit√© "ind√©cente".</em> <a name="habracut"></a></p><br><h3 id="zadacha">  D√©fi </h3><br><p>  Le chat de la compagnie d'assurance re√ßoit + 100 500 appels clients par jour.  La plupart des questions sont simples et r√©p√©titives, mais les op√©rateurs ne sont pas plus ais√©s et les clients doivent encore attendre cinq √† dix minutes.  Comment am√©liorer la qualit√© de service et optimiser les co√ªts de main-d'≈ìuvre pour que les op√©rateurs aient moins de routine et que les utilisateurs aient des sensations plus agr√©ables √† r√©soudre rapidement leurs probl√®mes? </p><br><p>  Et nous ferons un chatbot.  Laissez-le lire les messages des utilisateurs, donner des instructions pour les cas simples et poser des questions standard pour les cas complexes afin d'obtenir les informations dont l'op√©rateur a besoin.  Un op√©rateur en direct a une arborescence de scripts - un script (ou un organigramme) qui dit quelles questions les utilisateurs peuvent poser et comment y r√©pondre.  Nous prendrions ce sch√©ma et le placerions dans un chatbot, mais c'est une malchance - le chatbot ne comprend pas humainement et ne sait pas comment relier la question de l'utilisateur √† la branche de script. </p><br><p>  Donc, nous allons lui apprendre √† l'aide du bon vieux machine learning.  Mais vous ne pouvez pas simplement prendre un morceau de donn√©es g√©n√©r√© par les utilisateurs et lui apprendre un mod√®le de qualit√© d√©cent.  Pour ce faire, vous devez exp√©rimenter l'architecture du mod√®le, les donn√©es - pour les nettoyer et parfois les collecter √† nouveau. </p><br><p>  <strong>Comment enseigner √† un bot:</strong> </p><br><ul><li>  Examinons les options des mod√®les: comment la taille de l'ensemble de donn√©es, les d√©tails de la vectorisation des textes, l'abaissement de la dimension, le classificateur et la pr√©cision finale sont combin√©s. </li><li>  Nettoyons les donn√©es d√©centes: nous trouverons des classes qui peuvent √™tre jet√©es en toute s√©curit√©;  nous d√©couvrirons pourquoi les six derniers mois de majoration sont meilleurs que les trois pr√©c√©dents;  d√©terminer o√π se trouve le mod√®le et o√π le balisage;  D√©couvrez comment les fautes de frappe peuvent √™tre utiles. </li><li>  Nous allons nettoyer les donn√©es ¬´ind√©centes¬ª: nous d√©couvrirons quand le clustering est utile et inutile, car les utilisateurs et les op√©rateurs parlent quand il est temps d'arr√™ter de souffrir et d'aller collecter le balisage. </li></ul><br><h3 id="faktura">  La texture </h3><br><p>  Nous avions deux clients - des compagnies d'assurance avec des chats en ligne - et des projets de formation de chatbot (nous ne les appellerons pas, ce n'est pas important), avec une qualit√© de donn√©es tr√®s diff√©rente.  Eh bien, si la moiti√© des probl√®mes du deuxi√®me projet pouvaient √™tre r√©solus par des manipulations du premier.  Les d√©tails sont ci-dessous. </p><br><p>  D'un point de vue technique, notre t√¢che est de classer les textes.  Cela se fait en deux √©tapes: d'abord les textes sont vectoris√©s (√† l'aide de tf-idf, doc2vec, etc.), puis le mod√®le de classification est form√© sur les vecteurs (et classes) obtenus - for√™t al√©atoire, SVM, r√©seau de neurones, etc.  et ainsi de suite. </p><br><p>  D'o√π proviennent les donn√©es: </p><br><ul><li> Historique de chat Sql-upload.  Champs de t√©l√©chargement pertinents: texte du message;  auteur (client ou op√©rateur);  regrouper les messages dans des dialogues;  horodatage;  cat√©gorie de contact client (questions sur l'assurance responsabilit√© civile automobile obligatoire, l'assurance coque, l'assurance m√©dicale volontaire; questions sur le site; questions sur les programmes de fid√©lisation; questions sur l'√©volution des conditions d'assurance, etc.). </li><li>  Un arbre de scripts, ou des s√©quences de questions et r√©ponses des op√©rateurs aux clients avec diff√©rentes demandes. </li></ul><br><p>  Sans validation, bien s√ªr, nulle part.  Tous les mod√®les ont √©t√© form√©s sur 70% des donn√©es et √©valu√©s en fonction des r√©sultats sur les 30% restants. </p><br><p>  Mesures de qualit√© pour les mod√®les que nous avons utilis√©s: </p><br><ul><li>  En formation: logloss, pour la diff√©renciabilit√©; </li><li>  Lors de la r√©daction des rapports: pr√©cision de classification sur un √©chantillon de test, pour plus de simplicit√© et de clart√© (y compris pour le client); </li><li>  Lors du choix de la direction pour d'autres actions: l'intuition d'un data scientist qui regarde attentivement les r√©sultats. </li></ul><br><h3 id="eksperimenty-s-modelyami">  Exp√©riences de mod√®le </h3><br><p>  Il est rare que la t√¢che indique imm√©diatement quel mod√®le donnera les meilleurs r√©sultats.  Alors ici: sans exp√©rimentation, nulle part. </p><br><p>  Nous allons essayer des options de vectorisation: </p><br><ul><li>  tf-idf en un seul mot; </li><li>  tf-idf sur des triplets de caract√®res (ci-apr√®s: 3 grammes); </li><li>  tf-idf sur 2, 3, 4, 5 grammes s√©par√©ment; </li><li>  tf-idf sur 2, 3, 4, 5 grammes pris ensemble; </li><li>  Tout ce qui pr√©c√®de + r√©duction des mots dans le texte source sous forme de dictionnaire; </li><li>  Tout ce qui pr√©c√®de + diminution de dimension par la m√©thode SVD tronqu√©e; </li><li>  Avec le nombre de mesures: 10, 30, 100, 300; </li><li>  doc2vec, form√© sur le corps des textes de la t√¢che. </li></ul><br><p>  Les options de classification dans ce contexte semblent plut√¥t m√©diocres: SVM, XGBoost, LSTM, for√™ts al√©atoires, bay√©s na√Øves, for√™ts al√©atoires au-dessus des pr√©dictions SVM et XGB. </p><br><p>  Et bien que nous ayons v√©rifi√© la reproductibilit√© des r√©sultats sur trois ensembles de donn√©es assembl√©s ind√©pendamment et leurs fragments, nous ne pouvons que garantir leur large applicabilit√©. </p><br><p>  <strong>Les r√©sultats des exp√©riences:</strong> </p><br><ul><li>  Dans la cha√Æne ¬´pr√©-traitement-vectorisation-abaissement dimension-classification¬ª, l'effet du choix √† chaque √©tape est presque ind√©pendant des autres √©tapes.  Ce qui est tr√®s pratique, vous ne pouvez pas parcourir une douzaine d'options avec chaque nouvelle id√©e et utiliser l'option la plus connue √† chaque √©tape. </li><li>  tf-idf en mots perd √† 3 grammes (pr√©cision 0,72 vs 0,78).  2, 4, 5 grammes perdent √† 3 grammes (0,75-0,76 vs 0,78).  {2; 5} -grammes tous ensemble surpassent un peu les 3 grammes.  Compte tenu de la forte augmentation de la m√©moire requise, nous avons d√©cid√© de n√©gliger la formation avec un gain de pr√©cision de 0,4%. </li><li>  Compar√© √† tf-idf de toutes les vari√©t√©s, doc2vec √©tait impuissant (pr√©cision 0,4 et inf√©rieure).  Il vaudrait la peine d'essayer de l'entra√Æner non pas sur le corps de la t√¢che (~ 250 000 textes), mais sur une t√¢che beaucoup plus importante (2,5 √† 25 millions de textes), mais jusqu'√† pr√©sent, h√©las, vos mains ne sont pas parvenues. </li><li>  SVD tronqu√© n'a pas aid√©.  La pr√©cision augmente de fa√ßon monotone avec l'augmentation de la mesure, ce qui permet d'atteindre une pr√©cision sans TSVD. </li><li>  Parmi les classificateurs, XGBoost gagne par une marge notable (+ 5‚Äì10%).  Les concurrents les plus proches sont SVM et les for√™ts al√©atoires.  Naive Bayes n'est pas un concurrent m√™me pour les for√™ts al√©atoires. </li><li>  Le succ√®s de LSTM d√©pend fortement de la taille de l'ensemble de donn√©es: sur un √©chantillon de 100 000 objets, il est capable de rivaliser avec XGB.  Sur un √©chantillon de 6000 - dans le retard avec Bayes. </li><li>  Une for√™t al√©atoire au-dessus de SVM et XGB est toujours d'accord avec XGB, ou se trompe davantage.  C'est tr√®s triste, nous esp√©rions que SVM trouverait dans les donn√©es au moins quelques sch√©mas qui ne sont pas disponibles pour XGB, mais h√©las. </li><li>  XGBoost est compliqu√© de stabilit√©.  Par exemple, sa mise √† niveau de la version 0,72 √† 0,80 a inexplicablement r√©duit la pr√©cision des mod√®les entra√Æn√©s de 5 √† 10%.  Et encore une chose: XGBoost prend en charge la modification des param√®tres de formation pendant la formation et la compatibilit√© avec l'API scikit-learn standard, mais strictement s√©par√©ment.  Vous ne pouvez pas faire les deux ensemble.  J'ai d√ª le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">r√©parer.</a> </li><li>  Si vous apportez des mots dans un dictionnaire, cela am√©liore un peu la qualit√©, en combinaison avec tf-idf dans les mots, mais cela est inutile dans tous les autres cas.  Au final, nous l'avons d√©sactiv√© pour gagner du temps. </li></ul><br><h3 id="opyt-1-chistka-dannyh-ili-chto-delat-s-razmetkoy">  Exp√©rience 1. Nettoyage des donn√©es ou quoi faire avec le balisage </h3><br><p>  Les op√©rateurs de chat ne sont que des personnes.  Lors de la d√©finition des cat√©gories de requ√™tes utilisateur, elles se trompent souvent et ont des interpr√©tations diff√©rentes des limites entre les cat√©gories.  Par cons√©quent, les donn√©es source doivent √™tre impitoyablement et intensivement nettoy√©es. </p><br><p>  Nos donn√©es sur la formation des mod√®les sur le premier projet: </p><br><ul><li>  Un historique des messages de chat en ligne sur plusieurs ann√©es.  Il s'agit de 250 000 messages dans 60 000 conversations.  √Ä la fin du dialogue, l'op√©rateur a s√©lectionn√© la cat√©gorie √† laquelle appartient l'appel de l'utilisateur.  Il y a environ 50 cat√©gories dans cet ensemble de donn√©es. </li><li>  Arbre de script.  Dans notre cas, les op√©rateurs n'avaient pas de scripts de travail. </li></ul><br><p>  Quelle est exactement la mauvaise donn√©e, nous avons formul√© des hypoth√®ses, puis v√©rifi√© et, si possible, corrig√©.  Voici ce qui s'est pass√©: </p><br><p>  <strong>La premi√®re approche.</strong>  De la grande liste compl√®te des classes, vous pouvez en toute s√©curit√© laisser 5-10. <br>  Nous √©cartons les petites classes (&lt;1% de l'√©chantillon): peu de donn√©es + petit impact.  Nous r√©unissons des classes difficiles √† distinguer, auxquelles les op√©rateurs r√©agissent toujours de la m√™me mani√®re.  Par exemple: <br>  'dms' + 'comment prendre rendez-vous avec un m√©decin' + 'question sur comment remplir le programme' <br>  ¬´annulation¬ª + ¬´statut d'annulation¬ª + ¬´annulation de la politique pay√©e¬ª <br>  'question de renouvellement' + 'comment renouveler la politique?' </p><br><p>  Ensuite, nous jetons des classes comme ¬´autre¬ª, ¬´autre¬ª et similaires: pour un chatbot, elles sont inutiles (redirig√©es de toute fa√ßon vers l'op√©rateur), et en m√™me temps, elles nuisent consid√©rablement √† la pr√©cision, puisque 20% des demandes (30, 50, 90) sont class√©es par les op√©rateurs et ici.  Maintenant, nous jetons la classe avec laquelle le chatbot ne peut pas (encore) travailler. </p><br><p>  R√©sultat: dans un cas, croissance d'une pr√©cision de 0,40 √† 0,69, dans un autre, de 0,66 √† 0,77. </p><br><p>  <strong>La deuxi√®me approche.</strong>  Au d√©but du chat, les op√©rateurs eux-m√™mes comprennent mal comment choisir une classe √† contacter par l'utilisateur, il y a donc beaucoup de ¬´bruit¬ª et d'erreurs dans les donn√©es. </p><br><p>  Exp√©rience: nous ne prenons que les deux (trois, six, ...) derniers mois de dialogues et formons le mod√®le <br>  eux. </p><br><p>  R√©sultat: dans un cas remarquable, la pr√©cision est pass√©e de 0,40 √† 0,60, dans un autre - de 0,69 √† 0,78. </p><br><p>  <strong>La troisi√®me approche.</strong>  Parfois, une pr√©cision de 0,70 ne signifie pas ¬´le mod√®le se trompe dans 30% des cas¬ª, mais ¬´dans 30% des cas, le balisage est faux et le mod√®le le corrige tr√®s raisonnablement¬ª. </p><br><p>  Par des mesures telles que la pr√©cision ou la perte de journal, cette hypoth√®se ne peut pas √™tre v√©rifi√©e.  Aux fins de l'exp√©rience, nous nous sommes limit√©s au regard d'un data scientist, mais dans le cas id√©al, vous devez r√©organiser qualitativement l'ensemble de donn√©es, sans oublier la validation crois√©e. </p><br><p>  Pour travailler avec de tels √©chantillons, nous avons imagin√© le processus de "l'enrichissement it√©ratif": </p><br><ol><li>  Divisez l'ensemble de donn√©es en 3-4 fragments. </li><li>  Former le mod√®le sur le premier fragment. </li><li>  Pr√©disez les classes de la seconde par le mod√®le entra√Æn√©. </li><li>  Examinez attentivement les classes pr√©vues et le degr√© de confiance du mod√®le, choisissez la valeur limite de confiance. </li><li>  Supprimez les textes (objets) pr√©dits avec confiance en dessous de la limite du deuxi√®me fragment, entra√Ænez le mod√®le √† ce sujet. </li><li>  R√©p√©tez jusqu'√† ce que les fragments se fatiguent ou s'√©puisent. </li></ol><br><p>  D'une part, les r√©sultats sont excellents: le premier mod√®le d'it√©ration a une pr√©cision de 70%, le second - 95%, le troisi√®me - 99 +%.  Un examen attentif des r√©sultats des pr√©dictions confirme pleinement cette pr√©cision. </p><br><p>  D'un autre c√¥t√©, comment v√©rifier syst√©matiquement dans ce processus que les mod√®les suivants n'apprennent pas les erreurs des pr√©c√©dents?  Il existe une id√©e pour tester le processus sur un ensemble de donn√©es manuellement ¬´bruyant¬ª avec un balisage initial de haute qualit√©, tel que MNIST.  Mais, h√©las, il n'y avait pas assez de temps pour cela.  Et sans v√©rification, nous n'avons pas os√© lancer l'enrichissement it√©ratif et les mod√®les r√©sultants en production. </p><br><p>  <strong>La quatri√®me approche.</strong>  L'ensemble de donn√©es peut √™tre √©tendu - et ainsi augmenter la pr√©cision et r√©duire le recyclage, en ajoutant de nombreuses fautes de frappe aux textes existants. <br>  Les fautes de frappe sont des fautes de frappe - doubler une lettre, sauter une lettre, r√©organiser les lettres voisines par endroits, remplacer une lettre par une lettre adjacente sur le clavier. </p><br><p>  Exp√©rience: La proportion de p lettres dans lesquelles une faute de frappe se produira: 2%, 4%, 6%, 8%, 10%, 12%.  Augmentation de l'ensemble de donn√©es: g√©n√©ralement jusqu'√† 60 000 r√©pliques.  Selon la taille initiale (apr√®s les filtres), cela signifiait une augmentation de 3 √† 30 fois. </p><br><p>  R√©sultat: d√©pend de l'ensemble de donn√©es.  Sur un petit ensemble de donn√©es (~ 300 r√©pliques), 4 √† 6% des fautes de frappe donnent une augmentation stable et significative de la pr√©cision (0,40 ‚Üí 0,60).  Sur les grands ensembles de donn√©es, tout est pire.  Avec une proportion de fautes de frappe de 8% ou plus, les textes deviennent insens√©s et la pr√©cision diminue.  Avec un taux d'erreur de 2 √† 8%, la pr√©cision varie de quelques pour cent, d√©passe tr√®s rarement la pr√©cision sans fautes de frappe et, comme il semble, il n'est pas n√©cessaire d'augmenter le temps d'entra√Ænement plusieurs fois. </p><br><p>  En cons√©quence, nous obtenons un mod√®le qui distingue 5 classes d'appels avec une pr√©cision de 0,86.  Nous coordonnons avec le client les textes des questions et r√©ponses pour chacune des cinq fourchettes, attachons les textes au chatbot, les envoyons au QA. </p><br><h3 id="opyt-2-po-koleno-v-dannyh-ili-chto-delat-bez-razmetki">  Exp√©rience 2. Jusqu'au genou dans les donn√©es, ou quoi faire sans balisage </h3><br><p>  Ayant obtenu de bons r√©sultats sur le premier projet, nous avons abord√© le second en toute confiance.  Mais heureusement, nous n'avons pas oubli√© comment √™tre surpris. </p><br><p>  Ce que nous avons rencontr√©: </p><br><ul><li>  Un arbre de script √† cinq branches convenu avec le client il y a environ un an. </li><li>  Un √©chantillon balis√© de 500 messages et 11 classes d'origine inconnue. </li><li>  Tagg√© par les op√©rateurs de chat √† partir de 220 000 messages, 21 000 conversations et 50 autres classes. </li><li>  Le mod√®le SVM, form√© sur le premier √©chantillon, avec une pr√©cision de 0,69, qui a √©t√© h√©rit√© de la pr√©c√©dente √©quipe de scientifiques des donn√©es.  Pourquoi SVM, l'histoire est silencieuse. </li></ul><br><p>  Tout d'abord, nous regardons les classes: dans l'arborescence des scripts, dans l'exemple du mod√®le SVM, dans l'exemple principal.  Et voici ce que nous voyons: </p><br><ul><li>  Les classes du mod√®le SVM correspondent grosso modo aux branches des scripts, mais ne correspondent en aucun cas aux classes d'un large √©chantillon. </li><li>  L'arbre de script a √©t√© √©crit sur les processus m√©tier il y a un an et est obsol√®te presque inutile.  Le mod√®le SVM en est d√©pr√©ci√©. </li><li>  Les deux classes les plus importantes du grand √©chantillon sont les ventes (50%) et les autres (45%). </li><li>  Sur les cinq classes suivantes, trois sont aussi g√©n√©rales que les ventes. </li><li>  Les 45 classes restantes contiennent chacune moins de 30 dialogues.  C'est-√†-dire  nous n'avons pas d'arborescence de script, il n'y a pas de liste de classes et pas de balisage. </li></ul><br><p>  Que faire dans de tels cas?  Nous avons retrouss√© nos manches et sommes partis nous-m√™mes pour obtenir des cours et du balisage √† partir des donn√©es. </p><br><p>  <strong>La premi√®re tentative.</strong>  Essayons de regrouper les questions des utilisateurs, c'est-√†-dire  Les premiers messages du dialogue, √† l'exception des salutations. </p><br><p>  Nous v√©rifions.  Nous vectorisons des r√©pliques en comptant 3 grammes.  Nous abaissons la dimension aux dix premi√®res mesures de TSVD.  Nous nous regroupons par regroupement agglom√©r√© avec la distance euclidienne et la fonction Ward cible.  Baissez √† nouveau la dimension √† l'aide de t-SNE (jusqu'√† deux mesures pour que vous puissiez regarder les r√©sultats avec vos yeux).  Nous dessinons des r√©pliques de points sur le plan, en peignant aux couleurs des grappes. </p><br><p>  R√©sultat: peur et horreur.  Grappes saines, on peut supposer qu'il n'y a pas: </p><br><img src="https://habrastorage.org/webt/cl/rm/-s/clrm-sda0crxfeyq8ynskurotkk.png"><br><p>  Presque pas - il y en a un, orange √† gauche, car tous les messages contiennent le ¬´@¬ª de 3 grammes.  Ce 3 grammes est un artefact de pr√©traitement.  Quelque part dans le processus de filtrage des signes de ponctuation, ¬´@¬ª √©tait non seulement non filtr√©, mais aussi envahi par des espaces.  Mais l'artefact est utile.  Ce cluster comprend les utilisateurs qui √©crivent d'abord leur e-mail.  Malheureusement, ce n'est que par la disponibilit√© du courrier que la demande de l'utilisateur n'est pas claire.  Nous continuons. </p><br><p>  <strong>La deuxi√®me tentative.</strong>  Et si les op√©rateurs r√©pondent souvent avec des liaisons plus ou moins standard? <br>  Nous v√©rifions.  Nous extrayons des sous-cha√Ænes de type lien √† partir des messages de l'op√©rateur, modifions l√©g√®rement les liens, d'orthographe diff√©rente, mais de m√™me signification (http / https, / search? City =% city%), consid√©rons les fr√©quences des liens. </p><br><p>  R√©sultat: peu prometteur.  Premi√®rement, les op√©rateurs ne r√©pondent qu'√† une petite fraction des demandes (&lt;10%) avec des liens.  Deuxi√®mement, m√™me apr√®s le nettoyage et le filtrage manuels des liens qui se sont produits une fois, il y en a plus de trente.  Troisi√®mement, dans le comportement des utilisateurs qui terminent le dialogue par un lien, il n'y a pas de similitude particuli√®re. </p><br><p>  <strong>La troisi√®me tentative.</strong>  Cherchons les r√©ponses standard des op√©rateurs - que se passe-t-il s'ils seront des indicateurs de toute classification des messages? </p><br><p>  Nous v√©rifions.  Dans chaque dialogue, nous prenons la derni√®re r√©plique de l'op√©rateur (√† part les adieux: ¬´Je peux aider autre chose¬ª, etc.) et consid√©rons la fr√©quence des r√©pliques uniques. </p><br><p>  R√©sultat: prometteur, mais peu pratique.  50% des r√©ponses des op√©rateurs sont uniques, 10 √† 20% suppl√©mentaires sont trouv√©es deux fois, les 30 √† 40% restants sont couverts par un nombre relativement restreint de mod√®les populaires.  Relativement petit - environ trois cents.  Un examen attentif de ces mod√®les r√©v√®le que beaucoup d'entre eux sont des variantes de la m√™me r√©ponse en termes de signification - ils diff√®rent o√π par une lettre, o√π par un mot, o√π par un paragraphe.  Je voudrais regrouper ces r√©ponses qui ont un sens proche. </p><br><p>  <strong>La quatri√®me tentative.</strong>  Regroupement des derni√®res r√©pliques de d√©clarations.  Celles-ci sont bien mieux regroup√©es: </p><br><img src="https://habrastorage.org/webt/cb/to/xh/cbtoxhphxhmfo-94bpelgw1dalq.png"><br><p>  Vous pouvez d√©j√† travailler avec cela. </p><br><p>  Nous regroupons et dessinons des r√©pliques sur le plan, comme lors de la premi√®re tentative, d√©terminons manuellement les clusters les plus clairement s√©par√©s, les supprimons de l'ensemble de donn√©es et clusters √† nouveau.  Apr√®s avoir s√©par√© environ la moiti√© de l'ensemble de donn√©es, les clusters clairs se terminent et nous commen√ßons √† r√©fl√©chir aux classes √† leur affecter.  Nous dispersons les grappes selon les cinq classes d'origine - l'√©chantillon est ¬´asym√©trique¬ª, et trois des cinq classes d'origine ne re√ßoivent pas une seule grappe.  Dommage.  Nous r√©partissons les grappes en cinq classes, que nous d√©signons au hasard, sur: ¬´appeler¬ª, ¬´venir¬ª, ¬´attendre un jour une r√©ponse¬ª, ¬´probl√®mes avec captcha¬ª, ¬´autre¬ª.  L'inclinaison est moindre, mais la pr√©cision n'est que de 0,4 √† 0,5.  Encore mal.  Attribuez √† chacun des 30+ clusters sa propre classe.  L'√©chantillon est de nouveau biais√© et la pr√©cision est de nouveau de 0,5, bien qu'environ cinq classes s√©lectionn√©es aient une pr√©cision et une exhaustivit√© d√©centes (0,8 et plus).  Mais le r√©sultat n'est toujours pas impressionnant. </p><br><p>  <strong>La cinqui√®me tentative.</strong>  Nous avons besoin de tous les tenants et aboutissants du clustering.  Nous r√©cup√©rons le dendrogramme de clustering complet au lieu des trente premiers clusters.  Nous l'enregistrons dans un format accessible aux analystes clients et les aidons √† faire du balisage - nous esquissons la liste des classes. </p><br><p>  Pour chaque message, nous calculons une cha√Æne de clusters, qui inclut chaque message, √† partir de la racine.  Nous construisons une table avec des colonnes: texte, id du premier cluster de la cha√Æne, id du deuxi√®me cluster de la cha√Æne, ..., id du cluster correspondant au texte.  Nous enregistrons la table en csv / xls.  De plus, vous pouvez travailler avec des outils de bureau. </p><br><p>  Nous donnons les donn√©es et un croquis de la liste des classes √† baliser au client.  Les analystes clients ont re-marqu√© ~ 10 000 premiers messages d'utilisateurs.  Nous, d√©j√† enseign√©s par l'exp√©rience, avons demand√© de marquer chaque message au moins deux fois.  Et pas en vain - 4 000 de ces 10 000 doivent √™tre jet√©s, car les deux analystes ont marqu√© diff√©remment.  Sur les 6 000 restants, nous avons assez rapidement r√©p√©t√© les succ√®s du premier projet: </p><br><ul><li>  R√©f√©rence: pas de filtrage du tout - pr√©cision 0,66. </li><li>  Nous combinons les classes qui sont les m√™mes du point de vue de l'op√©rateur.  Nous obtenons une pr√©cision de 0,73. </li><li>  Nous supprimons la classe ¬´Autre¬ª - la pr√©cision augmente √† 0,79. </li></ul><br><p>  Le mod√®le est pr√™t, vous devez maintenant dessiner une arborescence de scripts.  Pour des raisons que nous ne pouvons pas expliquer, nous n'avions pas acc√®s aux scripts pour les r√©ponses des op√©rateurs.  Nous n'avons pas √©t√© surpris, nous avons fait semblant d'√™tre des utilisateurs et pendant quelques heures sur le terrain, nous avons collect√© des mod√®les de r√©ponse et clarifi√© les questions des op√©rateurs pour toutes les occasions.  Ils les ont d√©cor√©s dans un arbre, les ont emball√©s dans un bot et sont all√©s tester.  Approuv√© par le client. </p><br><h3 id="vyvody-ili-chto-pokazal-opyt">  Conclusions ou quelle exp√©rience a montr√©: </h3><br><ul><li>  Vous pouvez exp√©rimenter avec des parties du mod√®le (pr√©traitement, vectorisation, classification, etc.) individuellement. </li><li>  XGBoost gouverne toujours la balle, bien que si vous avez besoin de quelque chose d'inhabituel, vous avez des probl√®mes. </li><li>  L'utilisateur est un p√©riph√©rique d'entr√©e chaotique, vous devez donc nettoyer les donn√©es utilisateur. </li><li>  L'enrichissement it√©ratif est cool, bien que dangereux. </li><li>  Parfois, il vaut la peine de rendre les donn√©es au client pour le balisage.  Mais n'oubliez pas de l'aider √† obtenir un r√©sultat de qualit√©. </li></ul><br><p>  √Ä conclure. <cut></cut></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr436072/">https://habr.com/ru/post/fr436072/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr436062/index.html">Syst√®me d'arbitrage pour d√©butants, partie 1</a></li>
<li><a href="../fr436064/index.html">L'intelligence artificielle pour tous</a></li>
<li><a href="../fr436066/index.html">Math√©matiques de l'apocalypse: th√©orie des jeux et crise nucl√©aire des Cara√Øbes</a></li>
<li><a href="../fr436068/index.html">Conf√©rence C ++ Russie 2019</a></li>
<li><a href="../fr436070/index.html">Comment g√©rer les tests floconneux dans la communaut√© opensource</a></li>
<li><a href="../fr436076/index.html">Analyse des attaques de Cowrie Hanipot</a></li>
<li><a href="../fr436080/index.html">Semaine de la s√©curit√© 03: 2019 - Ann√©e de la confidentialit√©</a></li>
<li><a href="../fr436082/index.html">Comment l'UEBA contribue √† am√©liorer la cybers√©curit√©</a></li>
<li><a href="../fr436086/index.html">Pr√©sentation de la mise √† jour 4 pour Veeam Cloud Connect</a></li>
<li><a href="../fr436088/index.html">L'√©diteur graphique GANpaint dessine des objets et montre les capacit√©s GAN</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>