<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéº üç∂ üèáüèΩ Antipatterns en React o Bad Tips para principiantes ‚õ∑Ô∏è üôç üë©üèæ‚Äçüéì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola Habr 

 Ha pasado exactamente un a√±o desde que comenc√© a estudiar React. Durante este tiempo, logr√© lanzar varias peque√±as aplicaciones m√≥viles e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Antipatterns en React o Bad Tips para principiantes</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468799/"> Hola Habr <br><br>  Ha pasado exactamente un a√±o desde que comenc√© a estudiar React.  Durante este tiempo, logr√© lanzar varias peque√±as aplicaciones m√≥viles escritas en React Native y participar en el desarrollo de una aplicaci√≥n web usando ReactJS.  Resumiendo y mirando hacia atr√°s a todos los rastrillos que pude pisar, tuve la idea de expresar mi experiencia en forma de art√≠culo.  Har√© una reserva de que antes de comenzar el estudio de la reacci√≥n, ten√≠a 3 a√±os de experiencia en desarrollo en c ++, python, as√≠ como la opini√≥n de que no hay nada complicado en el desarrollo front-end y que no ser√° dif√≠cil entenderlo todo.  Por lo tanto, en los primeros meses dej√© de leer la literatura educativa y, b√°sicamente, solo ejemplos de c√≥digos listos para Google.  En consecuencia, un desarrollador ejemplar que estudie la documentaci√≥n en primer lugar, muy probablemente, no encontrar√° nada nuevo para √©l aqu√≠, pero sigo pensando que algunas personas cuando estudian nuevas tecnolog√≠as prefieren el camino de la pr√°ctica a la teor√≠a.  Entonces, si este art√≠culo salva a alguien de un rastrillo, entonces intent√© no en vano. <br><a name="habracut"></a><br><h3>  Consejo 1. Trabajando con formularios </h3><br>  La situaci√≥n cl√°sica: hay un formulario con varios campos en los que el usuario ingresa datos, luego hace clic en el bot√≥n y los datos ingresados ‚Äã‚Äãse env√≠an a una API externa / se guardan en estado / se muestran en la pantalla - subraye lo necesario. <br><br><h4>  Opci√≥n 1. C√≥mo no hacer </h4><br>  En React, puede crear un enlace a un nodo DOM o componente React. <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.myRef = React.createRef();</code> </pre> <br>  Usando el atributo ref, el enlace creado se puede adjuntar al componente / nodo requerido. <br><br><pre> <code class="javascript hljs">&lt;input id=<span class="hljs-string"><span class="hljs-string">"data"</span></span> type=<span class="hljs-string"><span class="hljs-string">"text"</span></span> ref={<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.myRef} /&gt;</code> </pre> <br>  Por lo tanto, el problema anterior se puede resolver creando una referencia para cada campo del formulario, y en el cuerpo de la funci√≥n llamada cuando se hace clic en el bot√≥n, obtenga datos del formulario contactando los enlaces necesarios. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BadForm</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.myRef = React.createRef(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onClickHandler = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onClickHandler.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } onClickHandler() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> data = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.myRef.current.value; alert(data); } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;&gt; &lt;form&gt; &lt;label htmlFor="data"&gt;Bad form:&lt;/label&gt; &lt;input id="data" type="text" ref={this.myRef} /&gt; &lt;input type="button" value="OK" onClick={this.onClickHandler} /&gt; &lt;/form&gt; &lt;/&gt; ); } }</code> </pre> <br>  <b>C√≥mo el mono interno puede tratar de justificar esta decisi√≥n:</b> <br><br><ol><li>  Lo principal que funciona es que a√∫n tienes 100500 tareas y <s>no</s> se miran <s>programas de TV; los</s> boletos no est√°n cerrados.  D√©jalo as√≠, luego cambia </li><li>  Vea qu√© poco c√≥digo se necesita para procesar el formulario.  Ref declarado y acceder a los datos donde quieras. </li><li>  Si almacena el valor en estado, cada vez que cambie los datos de entrada, se volver√° a procesar toda la aplicaci√≥n y solo necesitar√° los datos finales.  Entonces, este m√©todo tambi√©n resulta bueno para la optimizaci√≥n, solo d√©jalo as√≠. </li></ol><br>  <b>Por qu√© el mono est√° equivocado:</b> <br><br>  El ejemplo anterior es el antipatr√≥n cl√°sico en React, que viola el concepto de un flujo de datos unidireccional.  En este caso, su aplicaci√≥n no podr√° responder a los cambios de datos durante la entrada, ya que no est√°n almacenados en estado. <br><br><h4>  Opci√≥n 2. Soluci√≥n cl√°sica. </h4><br>  Para cada campo de formulario, se crea una variable en un estado en el que se almacenar√° el resultado de entrada.  Al atributo de valor se le asigna esta variable.  Al atributo onhange se le asigna una funci√≥n en la que el valor de la variable en estado se cambia a trav√©s de setState ().  Por lo tanto, todos los datos se toman del estado, y cuando los datos cambian, el estado cambia y la aplicaci√≥n se procesa nuevamente. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GoodForm</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">data</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onChangeData = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onChangeData.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onClickHandler = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onClickHandler.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } onChangeData(event) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: event.target.value }); } onClickHandler(event) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { data } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state; alert(data); } render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { data } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;&gt; &lt;form&gt; &lt;label htmlFor="data"&gt;Good form:&lt;/label&gt; &lt;input id="data" type="text" value={data} onChange={this.onChangeData} /&gt; &lt;input type="button" value="OK" onClick={this.onClickHandler} /&gt; &lt;/form&gt; &lt;/&gt; ); } }</code> </pre> <br><h4>  Opci√≥n 3. Avanzado.  Cuando las formas se vuelven muchas </h4><br>  La segunda opci√≥n tiene una serie de inconvenientes: una gran cantidad de c√≥digo est√°ndar, para cada campo es necesario declarar el m√©todo onhange y agregar una variable al estado.  Cuando se trata de validar los datos ingresados ‚Äã‚Äãy mostrar mensajes de error, la cantidad de c√≥digo aumenta a√∫n m√°s.  Para facilitar el trabajo con formularios, existe una excelente biblioteca de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Formik</a> que se ocupa de los problemas relacionados con el mantenimiento de formularios y tambi√©n facilita la adici√≥n de un esquema de validaci√≥n. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Formik } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'formik'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Yup <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'yup'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SigninSchema = Yup.object().shape({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: Yup.string() .min(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'Too Short!'</span></span>) .max(<span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-string"><span class="hljs-string">'Too Long!'</span></span>) .required(<span class="hljs-string"><span class="hljs-string">'Data required'</span></span>), }); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> () =&gt; <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;div&gt; &lt;Formik initialValues={{ data: </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params"> }} validationSchema={SigninSchema} onSubmit={(values</span></span></span><span class="hljs-function">) =&gt;</span></span> { alert(values.data); }} render={(props) =&gt; ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onSubmit</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{props.handleSubmit}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">label</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Formik form:</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">label</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">input</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{props.handleChange}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onBlur</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{props.handleBlur}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{props.values.data}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"data"</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> {props.errors.data &amp;&amp; props.touched.data ? ( </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">{props.errors.data}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ) : null} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Ok</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> )} /&gt; </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> );</code> </pre> <br><h3>  Consejo 2. Evita la mutaci√≥n </h3><br>  Considere una simple aplicaci√≥n de lista de tareas.  En el constructor, definimos en estado la variable en la que se almacenar√° la lista de tareas.  En el m√©todo render (), muestre el formulario a trav√©s del cual agregaremos casos a la lista.  Ahora considere c√≥mo podemos cambiar de estado. <br><br>  <b>Opci√≥n incorrecta que conduce a la mutaci√≥n de la matriz:</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.data.push(item);</code> </pre> <br>  En este caso, la matriz realmente ha cambiado, pero React no sabe nada al respecto, lo que significa que no se llamar√° al m√©todo render () y nuestros cambios no se mostrar√°n.  El hecho es que en JavaScript, al crear una nueva matriz u objeto, el enlace se guarda en la variable y no en el objeto en s√≠.  Por lo tanto, al agregar un nuevo elemento a la matriz de datos, cambiamos la matriz en s√≠, pero no el enlace, lo que significa que el valor de los datos almacenados en el estado no cambiar√°. <br><br>  Las mutaciones en JavaScript se pueden encontrar en todo momento.  Para evitar mutaciones de datos, use el operador de propagaci√≥n para las matrices, los m√©todos filter () y map (), y para los objetos, use el operador de propagaci√≥n o el m√©todo asignar (). <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> newData = [...data, item]; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> copy = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign({}, obj);</code> </pre> <br>  Volviendo a nuestra aplicaci√≥n, vale la pena decir que la opci√≥n correcta para cambiar el estado es usar el m√©todo setState ().  No intente cambiar el estado directamente en otro lugar que no sea el constructor, ya que esto contradice la ideolog√≠a React. <br><br>  <b>¬°No hagas eso!</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.data = [...data, item];</code> </pre> <br>  Tambi√©n evite la mutaci√≥n estatal.  Incluso si usa setState (), las mutaciones pueden provocar errores al intentar optimizar.  Por ejemplo, si pasa un objeto mutado a trav√©s de accesorios a un elemento secundario puro, este componente no podr√° comprender que los accesorios recibidos han cambiado y no se volver√°n a renderizar. <br><br>  <b>¬°No hagas eso!</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.data.push(item); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.data });</code> </pre> <br>  <b>La opci√≥n correcta:</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { data } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> newData = [...data, item]; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: newData });</code> </pre> <br>  Pero incluso la opci√≥n anterior puede provocar errores sutiles.  El hecho es que nadie garantiza que durante el tiempo transcurrido entre la recepci√≥n de la variable de datos del estado y la escritura de su nuevo valor en el estado, el estado en s√≠ no cambiar√°.  Por lo tanto, corre el riesgo de perder algunos de los cambios realizados.  Por lo tanto, en el caso de que necesite actualizar el valor de una variable en estado utilizando su valor anterior, h√°galo de la siguiente manera: <br><br>  <b>La opci√≥n correcta, si la siguiente condici√≥n depende de la corriente:</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">data</span></span>: [...state.data, item]}; });</code> </pre> <br><h3>  Consejo 3. Emular una aplicaci√≥n de varias p√°ginas </h3><br>  Su aplicaci√≥n se est√° desarrollando y, en alg√∫n momento, se da cuenta de que necesita varias p√°ginas.  ¬øPero qu√© hacer, porque React es una aplicaci√≥n de una sola p√°gina?  En este punto, la siguiente idea loca puede venir a su mente.  Decide que mantendr√° el identificador de la p√°gina actual en el estado global de su aplicaci√≥n, por ejemplo, utilizando la tienda redux.  Para mostrar la p√°gina deseada, utilizar√° la representaci√≥n condicional y cambiar√° de p√°gina, llamando a la acci√≥n con la carga √∫til deseada, cambiando as√≠ los valores en la tienda redux. <br><br>  <b>App.js</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { connect } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'./App.css'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Page1 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./Page1'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Page2 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./Page2'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mapStateToProps = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">page</span></span>: state.page }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AppCon</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (props.page === <span class="hljs-string"><span class="hljs-string">'Page1'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"App"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Page1</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"App"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Page2</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> App = connect(mapStateToProps)(AppCon); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> App;</code> </pre> <br>  <b>P√°gina1.js</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { connect } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { setPage } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./redux/actions'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mapDispatchToProps</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dispatch</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">setPageHandle</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">page</span></span></span><span class="hljs-function">) =&gt;</span></span> dispatch(setPage(page)), }; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Page1Con</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;&gt; &lt;h3&gt; Page </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/h3&gt; &lt;input type="button" value="Go to page2" onClick={() =&gt; props.setPageHandle('Page2')} /</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; &lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/&gt; ); } const Page1 = connect(null, mapDispatchToProps)(Page1Con); export default Page1;</span></span></span></span></span></span></code> </pre> <br>  ¬øPor qu√© es esto malo? <br><br><ol><li>  Esta soluci√≥n es un ejemplo de una bicicleta primitiva.  Si sabe c√≥mo fabricar una bicicleta de este tipo de manera competente y entiende lo que est√° buscando, entonces no es mi responsabilidad aconsejarle.  De lo contrario, su c√≥digo ser√° impl√≠cito, confuso y demasiado complejo. </li><li>  No podr√° utilizar el bot√≥n Atr√°s en el navegador, ya que no se guardar√° el historial de visitas. </li></ol><br>  ¬øC√≥mo resolver esto? <br><br>  Solo usa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">react-router</a> .  Este es un gran paquete que puede convertir f√°cilmente su aplicaci√≥n en una de varias p√°ginas. <br><br><h3>  Consejo 4. D√≥nde colocar solicitudes de API </h3><br>  En alg√∫n momento, necesitaba agregar una solicitud a una API externa en su aplicaci√≥n.  Y aqu√≠ se pregunta: ¬øen qu√© parte de su aplicaci√≥n necesita ejecutar la solicitud? <br>  En este momento, al montar un componente React, su ciclo de vida es el siguiente: <br><br><ul><li>  constructor () </li><li>  getDerivedStateFromProps () est√°tico </li><li>  render () </li><li>  componentDidMount () </li></ul><br>  Analicemos todas las opciones en orden. <br><br>  En el m√©todo constructor (), la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n</a> no recomienda hacer otra cosa que: <br><br><ul><li>  Inicializando el estado interno a trav√©s de la asignaci√≥n del objeto this.state. </li><li>  Enlaces de controladores de eventos a una instancia. </li></ul><br>  Las llamadas a la API no est√°n incluidas en esta lista, as√≠ que continuemos. <br><br>  El m√©todo getDerivedStateFromProps () de acuerdo con la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n</a> existe para situaciones raras cuando el estado depende de cambios en los accesorios.  De nuevo, no es nuestro caso. <br><br>  El error m√°s com√∫n es la ubicaci√≥n del c√≥digo que ejecuta las solicitudes de API en el m√©todo render ().  Esto lleva al hecho de que tan pronto como su solicitud se ejecute con √©xito, lo m√°s probable es que guarde el resultado en el estado del componente, y esto conducir√° a una nueva llamada al m√©todo render (), en el que su solicitud a la API se ejecutar√° nuevamente.  Por lo tanto, su componente terminar√° en una representaci√≥n interminable, y esto claramente no es lo que necesita. <br><br>  Por lo tanto, el m√©todo componentDidMount () es el lugar ideal para acceder a la API externa. <br><br><h3>  Conclusi√≥n </h3><br>  Se pueden encontrar ejemplos de c√≥digo en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">github</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/468799/">https://habr.com/ru/post/468799/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../468785/index.html">Intel Stratix 10 DX completa la l√≠nea Stratix 10 FPGA</a></li>
<li><a href="../468789/index.html">2. Casos de uso t√≠picos para Check Point Maestro</a></li>
<li><a href="../468791/index.html">Dos experimentos curiosos del cerebro humano que vale la pena conocer</a></li>
<li><a href="../468793/index.html">Nos ocupamos de la criptomoneda Libra. Detalles</a></li>
<li><a href="../468797/index.html">Longitud focal del ojo. ¬øQu√© es? (Actualizado)</a></li>
<li><a href="../468803/index.html">C√≥mo hicimos nuestro motor de flujo de trabajo</a></li>
<li><a href="../468805/index.html">System.Console, Mono y NCurses</a></li>
<li><a href="../468813/index.html">Geolocalizaci√≥n y fotograf√≠a: megaherramienta</a></li>
<li><a href="../468819/index.html">Telegram Number Disclosure v.2 - Ingenier√≠a social</a></li>
<li><a href="../468821/index.html">¬øC√≥mo escribir un contrato inteligente con Python en ontolog√≠a? Parte 1: Blockchain y Block API</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>