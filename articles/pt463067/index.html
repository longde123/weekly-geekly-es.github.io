<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëàüèº üçó üà∂ Primeiro a frente e depois as costas (algum dia) üëåüèº üíáüèª üë©üèº‚Äçüè≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Antes de come√ßar a implementar um novo recurso, voc√™ precisa quebrar a cabe√ßa de maneira justa. 


 O desenvolvimento de funcionalidades complexas req...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Primeiro a frente e depois as costas (algum dia)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463067/"><p>  Antes de come√ßar a implementar um novo recurso, voc√™ precisa quebrar a cabe√ßa de maneira justa. </p><br><p>  O desenvolvimento de funcionalidades complexas requer uma boa coordena√ß√£o dos esfor√ßos de uma equipe de engenheiros. </p><br><p>  E um dos pontos mais importantes √© a quest√£o das tarefas paralelas. </p><br><p>  √â poss√≠vel evitar que os soldados da linha de frente tenham que esperar por uma implementa√ß√£o de back-end?  Existe uma maneira de paralelizar o desenvolvimento de fragmentos individuais da interface do usu√°rio? </p><br><p>  O t√≥pico da paraleliza√ß√£o de tarefas no desenvolvimento da Web ser√° discutido neste artigo. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/72d/93d/13b/72d93d13b21e705a101b21c359c3a565.png"></p><a name="habracut"></a><br><h3 id="problema">  O problema </h3><br><p> Ent√£o, vamos come√ßar identificando o problema.  Imagine que voc√™ tenha um produto experiente (servi√ßo de Internet), no qual s√£o coletados v√°rios microsservi√ßos diferentes.  Cada microsservi√ßo em seu sistema √© um tipo de miniaplicativo integrado √† arquitetura geral e resolve algum problema espec√≠fico do usu√°rio do servi√ßo.  Imagine que nesta manh√£ (o √∫ltimo dia do sprint), o Product Owner chamado Vasily se dirigiu a voc√™ e anunciou: "No pr√≥ximo sprint, come√ßamos a analisar a importa√ß√£o de dados, o que tornar√° os usu√°rios do servi√ßo ainda mais felizes. Isso permitir√° que o usu√°rio preencha o servi√ßo imediatamente para suas posi√ß√µes duvidosas de 1C denso! ". </p><br><p>  Imagine que voc√™ √© um gerente ou l√≠der de equipe e n√£o est√° ouvindo todas essas descri√ß√µes entusi√°sticas de usu√°rios felizes do ponto de vista comercial.  Voc√™ estima quanto trabalho tudo isso exigir√°.  Como um bom gerente, voc√™ faz todos os esfor√ßos para reduzir o apetite de Vasily pelas tarefas de pontua√ß√£o para MVP (doravante, Produto M√≠nimo Vi√°vel).  Ao mesmo tempo, os dois principais requisitos do MVP - a capacidade do sistema de importa√ß√£o de suportar uma grande carga e trabalhar em segundo plano, n√£o podem ser descartados. </p><br><p>  Voc√™ entende que a abordagem tradicional, quando todos os dados s√£o processados ‚Äã‚Äãna mesma solicita√ß√£o do usu√°rio, n√£o funcionar√°.  Aqui voc√™ tem que cercar o jardim de qualquer trabalhador em segundo plano.  Voc√™ precisar√° vincular o barramento de eventos, pensar em como o balanceador de carga, o banco de dados distribu√≠do etc. funciona.  Em geral, todas as del√≠cias da arquitetura de microsservi√ßo.  Como resultado, voc√™ conclui que o desenvolvimento do back-end para esse recurso se arrastar√°, n√£o v√° para vendedores de sorte. </p><br><p>  A pergunta surge automaticamente: "O que os soldados da linha de frente far√£o todo esse tempo enquanto n√£o houver API?". </p><br><p>  Al√©m disso, verifica-se que os dados n√£o devem ser importados imediatamente.  Voc√™ deve primeiro valid√°-los e permitir que o usu√°rio corrija todos os erros encontrados.  Acontece tamb√©m um fluxo de trabalho astuto no front-end.  E √© necess√°rio cortar o recurso, como de costume, "ontem".  Conseq√ºentemente, os veteranos de guerra devem ser de alguma forma coordenados para que n√£o batam em um nabo, n√£o criem conflitos e vejam calmamente cada peda√ßo dele (veja KDPV no in√≠cio do artigo). </p><br><p>  Em uma situa√ß√£o diferente, poder√≠amos come√ßar a serrar de tr√°s para a frente.  Primeiro, implemente o back-end e verifique se ele est√° segurando a carga e, em seguida, pendure calmamente o front-end nele.  Mas o problema √© que as especifica√ß√µes descrevem um novo recurso em termos gerais, t√™m lacunas e pontos controversos em termos de usabilidade.  Mas e se, no final da implementa√ß√£o frontal, acontecer que, nesse formato, o recurso n√£o satisfar√° o usu√°rio?  Altera√ß√µes de usabilidade podem exigir altera√ß√µes no modelo de dados.  Teremos que refazer a frente e a traseira, o que ser√° muito caro. </p><br><h3 id="agile-pytaetsya-nam-pomoch">  O Agile est√° tentando nos ajudar. </h3><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b07/30c/c25/b0730cc25193b2363dbefb3b550d6f39.png"></p><br><p>  Metodologias flex√≠veis fornecem conselhos s√°bios.  "Comece com o skate e mostre ao usu√°rio. De repente, ele vai gostar. Se voc√™ gosta, continue na mesma linha, aperte as fichas novas." <br>  Mas e se o usu√°rio precisar imediatamente de pelo menos uma motocicleta e em duas a tr√™s semanas?  E se, para come√ßar a trabalhar na fachada da motocicleta, voc√™ precisa pelo menos decidir sobre as dimens√µes do motor e o tamanho do chassi? </p><br><p>  Como garantir que a implementa√ß√£o da fachada n√£o seja adiada at√© que haja certeza com as outras camadas do aplicativo? </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ba2/5bc/5ad/ba25bc5ad7a863e7623f651f11eb12da.png"></p><br><p>  Em nossa situa√ß√£o, √© melhor usar uma abordagem diferente.  √â melhor come√ßar imediatamente a fazer uma fachada (frente) para garantir que a ideia inicial do MVP esteja correta.  Por um lado, deslizar uma fachada decorativa para o Dono do produto Vasily, atr√°s do qual n√£o h√° nada, parece estar enganando, uma fraude.  Por outro lado, obtemos feedback muito rapidamente dessa maneira sobre a parte da funcionalidade que o usu√°rio encontrar√° em primeiro lugar.  Voc√™ pode ter uma arquitetura incrivelmente interessante, mas se n√£o houver usabilidade, todo o aplicativo ser√° lan√ßado na borda do aplicativo, sem entender os detalhes.  Portanto, parece-me mais importante fornecer a interface do usu√°rio mais funcional o mais r√°pido poss√≠vel, em vez de sincronizar o progresso da frente com o back-end.  N√£o faz sentido emitir uma interface do usu√°rio inacabada e fazer backup para testes, cuja funcionalidade n√£o atende aos principais requisitos.  Ao mesmo tempo, emitir 80% da funcionalidade necess√°ria da interface do usu√°rio, mas sem um back-end funcional, pode se tornar lucrativo. </p><br><h3 id="nemnogo-tehnicheskih-detaley">  Alguns detalhes t√©cnicos </h3><br><p>  Ent√£o, eu j√° descrevi brevemente que recurso vamos implementar.  Adicione alguns detalhes t√©cnicos. </p><br><p>  O usu√°rio deve poder fazer upload de um arquivo de dados grande para o servi√ßo.  O conte√∫do desse arquivo deve estar em um formato espec√≠fico (por exemplo, CSV).  O arquivo deve ter uma certa estrutura de dados e existem campos obrigat√≥rios que n√£o devem estar vazios.  Em outras palavras, ap√≥s o descarregamento no back-end, voc√™ precisar√° validar os dados.  A valida√ß√£o pode durar um tempo consider√°vel.  Voc√™ n√£o pode manter a conex√£o com o back-end aberta (ela ser√° interrompida por tempo limite).  Portanto, devemos aceitar rapidamente o arquivo e iniciar o processamento em segundo plano.  No final da valida√ß√£o, devemos informar ao usu√°rio que ele pode come√ßar a editar os dados.  O usu√°rio deve corrigir os erros detectados durante a valida√ß√£o. </p><br><p>  Ap√≥s a corre√ß√£o de todos os erros, o usu√°rio clica no bot√£o Importar.  Os dados corrigidos s√£o enviados de volta ao back-end.  para concluir o procedimento de importa√ß√£o.  Devemos informar o front-end sobre o progresso de todas as etapas da importa√ß√£o. </p><br><p>  A maneira mais eficaz de alertar √© o WebSockets.  De frente, atrav√©s do Websocket com um determinado per√≠odo, as solicita√ß√µes ser√£o enviadas para obter o status atual do processamento de dados em segundo plano.  Para o processamento de dados em segundo plano, precisamos de manipuladores em segundo plano, uma fila de comandos distribu√≠dos, barramento de eventos, etc. </p><br><p>  O fluxo de dados √© visto da seguinte forma (para refer√™ncia): </p><br><ol><li>  Por meio da API do navegador de arquivos, solicitamos que o usu√°rio selecione o arquivo desejado no disco. </li><li>  Atrav√©s do AJAX, enviamos o arquivo para o back-end. </li><li>  Estamos aguardando a valida√ß√£o e an√°lise do arquivo de dados para concluir (pesquisamos o status da opera√ß√£o em segundo plano via Websocket). </li><li>  Ap√≥s a conclus√£o da valida√ß√£o, carregaremos os dados preparados para importa√ß√£o e os renderizaremos na tabela na p√°gina de importa√ß√£o. </li><li>  O usu√°rio edita dados, corrige erros.  Ao clicar no bot√£o na parte inferior da p√°gina, enviamos os dados corrigidos para o back-end. </li><li>  Novamente no lado do cliente, realizamos uma pesquisa peri√≥dica do status da opera√ß√£o em segundo plano. </li><li>  At√© o final da importa√ß√£o atual, o usu√°rio n√£o poder√° iniciar uma nova importa√ß√£o (mesmo na janela do navegador vizinho ou no computador vizinho). </li></ol><br><h3 id="plan-razrabotki">  Plano de desenvolvimento </h3><br><h4 id="mokap-ui-vs-prototip-ui">  UI do Mocap vs.  Interface do usu√°rio do prot√≥tipo </h4><br><p><img src="https://habrastorage.org/getpro/habr/post_images/908/3bc/f90/9083bcf90698b20014ec29e4580d3f08.jpg"></p><br><p>  Vamos destacar imediatamente a diferen√ßa entre Wireframe, Maquete e Prot√≥tipo. </p><br><p>  A imagem acima mostra o Wireframe.  Este √© apenas um desenho (em n√∫meros ou em papel - isso n√£o importa).  Os outros dois conceitos s√£o mais complicados. </p><br><p>  Mocap √© uma forma de apresenta√ß√£o da interface futura que √© usada apenas como apresenta√ß√£o e ser√° posteriormente substitu√≠da completamente.  Este formul√°rio ser√° arquivado como uma amostra no futuro.  A interface real ser√° feita usando outras ferramentas.  Um mocap pode ser feito em um editor de vetores com detalhes de design suficientes, mas os desenvolvedores de front-end simplesmente o colocam de lado e o espiam como modelo.  O Mocap pode ser fabricado mesmo em construtores de navegadores especializados e vem com interatividade limitada.  Mas seu destino √© inalterado.  Ele se tornar√° um modelo no √°lbum do Design Guide. </p><br><p>  O prot√≥tipo √© criado usando as mesmas ferramentas da futura interface do usu√°rio (por exemplo, React).  O c√≥digo do prot√≥tipo est√° hospedado no reposit√≥rio de aplicativos geral.  N√£o ser√° substitu√≠do, como √© o caso do mocap.  Primeiro, √© usado para testar o conceito (Prova de conceito, PoC).  Ent√£o, se passar no teste, eles come√ßar√£o a desenvolv√™-lo, transformando-o gradualmente em uma interface de usu√°rio completa. </p><br><p>  Agora mais perto do ponto ... </p><br><p>  Imagine que os colegas do workshop de design nos apresentaram artefatos de seu processo criativo: modelos da interface futura.  Nossa tarefa √© planejar o trabalho para que, o mais r√°pido poss√≠vel, torne poss√≠vel o trabalho paralelo de veteranos. </p><br><p>  √Ä medida que a compila√ß√£o do algoritmo come√ßa com um fluxograma, iniciamos a cria√ß√£o de um prot√≥tipo com um Wireframe minimalista (veja a figura acima).  Nesse Wireframe, dividimos a funcionalidade futura em grandes blocos.  O principal princ√≠pio aqui √© focar a responsabilidade.  Voc√™ n√£o deve dividir uma parte da funcionalidade em blocos diferentes.  Moscas v√£o para um bloco e costeletas para outro. </p><br><p>  Em seguida, voc√™ precisa criar uma p√°gina em branco (fict√≠cia) o mais r√°pido poss√≠vel, configurar o roteamento e colocar um link para esta p√°gina no menu.  Ent√£o voc√™ precisa criar espa√ßos em branco para os componentes b√°sicos (um para cada bloco no prot√≥tipo Wireframe).  E alimentar essa estrutura peculiar no ramo de desenvolvimento de um novo recurso. </p><br><p>  Temos a seguinte hierarquia de ramifica√ß√µes no git: </p><br><pre><code class="plaintext hljs">master ---------------------- &gt; ‚îî feature/import-dev ------ &gt;</code> </pre> <br><p>  O ramo "import-dev" desempenhar√° o papel de brunch de desenvolvimento para todo o recurso.  √â aconselh√°vel consertar uma pessoa respons√°vel (mantenedor) nesse ramo que esteja mantendo altera√ß√µes at√¥micas de todos os colegas que trabalham no recurso em paralelo.  Tamb√©m √© aconselh√°vel n√£o fazer confirma√ß√µes diretas neste ramo, a fim de reduzir a chance de conflitos e mudan√ßas inesperadas quando houver fus√µes nesse ramo de solicita√ß√µes de recebimento at√¥mico. </p><br><p>  Porque  Neste momento, j√° criamos componentes para os blocos principais da p√°gina, ent√£o voc√™ pode criar imediatamente ramifica√ß√µes separadas para cada bloco da interface do usu√°rio.  A hierarquia final pode ser assim: </p><br><pre> <code class="plaintext hljs">master ----------------------- &gt; ‚îî feature/import-dev ------- &gt; ‚îú feature/import-head ---- &gt; ‚îú feature/import-filter -- &gt; ‚îú feature/import-table --- &gt; ‚îú feature/import-pager --- &gt; ‚îî feature/import-footer -- &gt;</code> </pre> <br><p>  <strong>Nota:</strong> <em>n√£o importa em que ponto criar esses brunches at√¥micos e a conven√ß√£o de nomenclatura apresentada acima n√£o √© a √∫nica adequada.</em>  <em>O brunch pode ser criado imediatamente antes de iniciar o trabalho.</em>  <em>E os nomes dos brunches devem ser claros para todos os participantes do desenvolvimento.</em>  <em>O nome deve ser o mais curto poss√≠vel e, ao mesmo tempo, indicar explicitamente por qual parte da funcionalidade a filial √© respons√°vel.</em> </p><br><p>  Pela abordagem descrita acima, garantimos a opera√ß√£o sem conflitos de v√°rios desenvolvedores da interface do usu√°rio.  Cada fragmento da interface do usu√°rio tem seu pr√≥prio diret√≥rio na hierarquia do projeto.  O cat√°logo de fragmentos cont√©m o componente principal, seu conjunto de estilos e seu pr√≥prio conjunto de componentes filhos.  Cada fragmento tamb√©m pode ter seu pr√≥prio gerente de estado (partes MobX, Redux, VueX).  Talvez os componentes do fragmento usem alguns estilos globais.  No entanto, a altera√ß√£o de estilos globais ao desenvolver um fragmento de uma nova p√°gina √© proibida.  Alterar o comportamento e o estilo padr√£o do √°tomo geral do design tamb√©m n√£o vale a pena. </p><br><p>  <strong>Nota:</strong> <em>‚Äú√°tomo de projeto‚Äù significa um elemento do conjunto de componentes padr√£o de nosso servi√ßo - consulte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Projeto at√¥mico</a> ;</em>  <em>no nosso caso, sup√µe-se que o sistema Atomic Design j√° tenha sido implementado.</em> </p><br><p>  Ent√£o, separamos fisicamente os soldados da linha de frente um do outro.  Agora, cada um deles pode trabalhar em sil√™ncio, sem medo de conflitos com a fus√£o.  Al√©m disso, qualquer pessoa pode, a qualquer momento, criar uma solicita√ß√£o pull de sua ramifica√ß√£o no <strong>recurso / import-dev</strong> .  Agora j√° √© poss√≠vel lan√ßar com calma conte√∫do est√°tico e at√© formar interativo em um armazenamento de estado. </p><br><p>  Mas como garantimos que os fragmentos da interface do usu√°rio possam interagir entre si? </p><br><p>  Precisamos implementar o link entre os fragmentos.  O servi√ßo JS, atuando como um gateway para troca de dados com o suporte, √© adequado para a fun√ß√£o de um link entre fragmentos.  Atrav√©s do mesmo servi√ßo, voc√™ pode implementar a notifica√ß√£o de eventos.  Ao assinar certos eventos, os fragmentos incluir√£o implicitamente o ciclo de vida geral do microsservi√ßo.  Altera√ß√µes nos dados em um fragmento tornar√£o necess√°rio atualizar o estado de outro fragmento.  Em outras palavras, fizemos a integra√ß√£o de fragmentos por meio de dados e um modelo de evento. </p><br><p>  Para criar este servi√ßo, precisamos de mais uma ramifica√ß√£o no git: </p><br><pre> <code class="plaintext hljs">master --------------------------- &gt; ‚îî feature/import-dev ----------- &gt; ‚îú feature/import-js-service -- &gt; ‚îú feature/import-head -------- &gt; ‚îú feature/import-filter ------ &gt; ‚îú feature/import-table ------- &gt; ‚îú feature/import-pager ------- &gt; ‚îî feature/import-footer ------ &gt;</code> </pre> <br><p>  <strong>Nota:</strong> <em>n√£o tenha medo do n√∫mero de galhos e n√£o hesite em produzir galhos.</em>  <em>O Git permite que voc√™ trabalhe eficientemente com um grande n√∫mero de ramifica√ß√µes.</em>  <em>Quando um h√°bito se desenvolve, fica f√°cil ramificar:</em> </p><br><pre> <code class="plaintext hljs">$/&gt; git checkout -b feature/import-service $/&gt; git commit . $/&gt; git push origin HEAD $/&gt; git checkout feature/import-dev $/&gt; git merge feature/import-service</code> </pre> <br><p>  <em>Isso parecer√° tenso para alguns, mas o lucro de minimizar conflitos √© mais significativo.</em>  <em>Al√©m disso, enquanto voc√™ √© o propriet√°rio exclusivo da filial, voc√™ pode <strong>pressionar -f</strong> com seguran√ßa sem arriscar danos ao hist√≥rico local de confirma√ß√µes de algu√©m.</em> </p><br><h4 id="feykovye-dannye">  Dados falsos </h4><br><p>  Portanto, no est√°gio anterior, preparamos o servi√ßo JS de integra√ß√£o (importService) e preparamos os fragmentos da interface do usu√°rio.  Mas sem dados, nosso prot√≥tipo n√£o funcionar√°.  Nada √© desenhado, exceto decora√ß√µes est√°ticas. </p><br><p>  Agora precisamos decidir sobre um modelo de dados aproximado e criar esses dados na forma de arquivos JSON ou JS (a escolha a favor de um ou outro depende das configura√ß√µes de importa√ß√£o em seu projeto; o json-loader est√° configurado).  Nosso importService, bem como seus testes (pensaremos mais adiante), importam desses arquivos os dados necess√°rios para simular respostas de um back-end real (ele ainda n√£o foi implementado).  Onde colocar esses dados n√£o √© importante.  O principal √© que eles podem ser facilmente importados para o importService e s√£o testados em nosso microsservi√ßo. </p><br><p>  √â recomend√°vel discutir o formato dos dados, a conven√ß√£o de nomenclatura de campo com os desenvolvedores das costas imediatamente.  Voc√™ pode, por exemplo, concordar em usar um formato que esteja em conformidade com a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Especifica√ß√£o OpenAPI</a> .  Quaisquer que sejam as especifica√ß√µes do formato de suporte, criamos dados falsos exatamente de acordo com o formato dos dados de suporte. </p><br><p>  <strong>Nota:</strong> <em>n√£o tenha medo de cometer um erro com o modelo de dados falsos;</em>  <em>Sua tarefa √© fazer uma vers√£o preliminar do contrato de dados, que ainda ser√° acordado com os desenvolvedores de back-end.</em> </p><br><h4 id="kontrakty">  Contratos </h4><br><p>  Dados falsos podem servir como um bom come√ßo para come√ßar a trabalhar na especifica√ß√£o da futura API no back-end.  E aqui n√£o importa quem e como a alta qualidade implementa o modelo de rascunho.  Crucial √© a discuss√£o e coordena√ß√£o conjuntas com a participa√ß√£o de desenvolvedores da frente e de tr√°s. </p><br><p>  Voc√™ pode usar ferramentas especializadas para descrever contratos (especifica√ß√µes da API).  Por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OpenAPI / Swagger</a> .  De uma maneira boa, ao descrever uma API com essa ferramenta, n√£o √© necess√°rio que todos os desenvolvedores estejam presentes.  Isso pode ser feito por um desenvolvedor (editor de especifica√ß√µes).  O resultado de uma discuss√£o coletiva da nova API seria alguns artefatos como MFU (Meeting Follow Up), segundo o qual o editor de especifica√ß√£o cria uma refer√™ncia para a futura API. </p><br><p>  No final do rascunho da especifica√ß√£o, n√£o deve demorar muito para verificar a corre√ß√£o.  Cada participante da discuss√£o coletiva poder√°, independentemente dos outros, fazer uma inspe√ß√£o superficial para verificar se sua opini√£o foi levada em considera√ß√£o.  Se algo parecer incorreto, ser√° poss√≠vel esclarecer atrav√©s das especifica√ß√µes do editor (comunica√ß√µes normais de trabalho).  Se todos estiverem satisfeitos com a especifica√ß√£o, ela poder√° ser publicada e usada como documenta√ß√£o para o servi√ßo. </p><br><h4 id="yunit-testirovanie">  Teste de Unidade </h4><br><p>  <strong>Nota:</strong> <em>Para mim, o valor dos testes de unidade √© bastante baixo.</em>  <em>Aqui eu concordo com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">David Heinemeier Hansson @ RailsConf</a> .</em>  <em>"Os testes de unidade s√£o uma √≥tima maneira de garantir que seu programa fa√ßa o que voc√™ pode fazer ... conforme o esperado."</em>  <em>Mas admito casos especiais em que os testes de unidade trazem muitos benef√≠cios.</em> </p><br><p>  Agora que decidimos os dados falsos, podemos come√ßar a testar a funcionalidade b√°sica.  Para testar componentes front-end, voc√™ pode usar ferramentas como karma, gracejo, mocha, chai, jasmim.  Geralmente, o arquivo com o mesmo nome com o postfix "spec" ou "test" √© colocado ao lado do recurso JS em teste: </p><br><pre> <code class="plaintext hljs">importService ‚îú importService.js ‚îî importService.test.js</code> </pre> <br><p>  O valor espec√≠fico do postfix depende das configura√ß√µes do coletor de pacotes JS em seu projeto. </p><br><p>  Obviamente, em uma situa√ß√£o em que as costas est√£o em um estado "contraceptivo", √© muito dif√≠cil cobrir todos os casos poss√≠veis com testes de unidade.  Mas o objetivo dos testes de unidade √© um pouco diferente.  Eles s√£o projetados para testar o funcionamento de partes individuais da l√≥gica. </p><br><p>  Por exemplo, √© bom cobrir v√°rios tipos de auxiliares com testes de unidade, por meio dos quais partes da l√≥gica ou certos algoritmos s√£o compartilhados entre componentes e servi√ßos JS.  Al√©m disso, esses testes podem cobrir o comportamento nos componentes e lojas do MobX, Redux, VueX em resposta a altera√ß√µes de dados do usu√°rio. </p><br><h4 id="integracionnoe-i-e2e-testirovanie">  Integra√ß√£o e teste E2E </h4><br><p>  Testes de integra√ß√£o significam verificar o comportamento do sistema quanto √† conformidade com a especifica√ß√£o.  I.e.  verifica-se que o usu√°rio ver√° exatamente o comportamento descrito nas especifica√ß√µes.  Este √© um n√≠vel mais alto de teste comparado aos testes de unidade. </p><br><p>  Por exemplo, um teste que verifica se h√° um erro no campo obrigat√≥rio quando o usu√°rio apagou todo o texto.  Ou um teste que verifica se um erro √© gerado ao tentar salvar dados inv√°lidos. </p><br><p>  Os testes E2E (ponta a ponta) funcionam em um n√≠vel ainda mais alto.  Eles verificam se o comportamento da interface do usu√°rio est√° correto.  Por exemplo, verificando se, ap√≥s enviar o arquivo de dados para o servi√ßo, √© mostrado ao usu√°rio um toque que sinaliza um processo ass√≠ncrono cont√≠nuo.  Ou verifique se a visualiza√ß√£o dos componentes padr√£o do servi√ßo corresponde aos guias dos projetistas. </p><br><p>  Esse tipo de teste funciona com alguma estrutura de automa√ß√£o da interface do usu√°rio.  Por exemplo, poderia ser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sel√™nio</a> .  Esses testes, juntamente com o Selenium WebDriver, s√£o executados em alguns navegadores (geralmente o Chrome no "modo sem cabe√ßa").  Eles trabalham por um longo tempo, mas reduzem a carga dos especialistas em controle de qualidade, fazendo um teste de fuma√ßa para eles. </p><br><p>  Escrever esses tipos de testes consome bastante tempo.  Quanto mais cedo come√ßarmos a escrev√™-los, melhor.  Apesar de n√£o termos um backup completo, j√° podemos come√ßar a descrever os testes de integra√ß√£o.  J√° temos uma especifica√ß√£o. </p><br><p>  Com uma descri√ß√£o do E2E, h√° ainda menos testes de obst√°culos.  J√° esbo√ßamos os componentes padr√£o da biblioteca de √°tomos de design.  Implementou partes espec√≠ficas da interface do usu√°rio.  Fez alguns interativos sobre dados falsos e API no importService.  Nada impede que voc√™ inicie a automa√ß√£o da interface do usu√°rio, pelo menos em casos b√°sicos. </p><br><p>  Ao escrever esses testes, voc√™ pode novamente desconcertar desenvolvedores individuais se n√£o houver pessoas desconcertadas.  E tamb√©m para descrever os testes, voc√™ pode criar uma ramifica√ß√£o separada (como descrito acima).  Nas ramifica√ß√µes para testes, ser√° necess√°rio atualizar periodicamente as atualiza√ß√µes da ramifica√ß√£o " <strong>feature / import-dev</strong> ". </p><br><p>  A sequ√™ncia geral de mesclagens ser√° a seguinte: </p><br><ol><li>  Por exemplo, um desenvolvedor da filial " <strong>feature / import-filter</strong> " criou um PR.  Esse PR √© visualizado e o mantenedor da ramifica√ß√£o " <strong>feature / import-dev</strong> " injeta esse PR. </li><li>  O mantenedor anuncia que a atualiza√ß√£o foi derramada. </li><li>  O desenvolvedor na ramifica√ß√£o " <strong>feature / import-tests-e2e</strong> " <strong>obt√©m</strong> altera√ß√µes extremas com a mesclagem da ramifica√ß√£o "-dev. </li></ol><br><h4 id="ci-i-avtomatizaciya-testirovaniya">  CI e automa√ß√£o de teste </h4><br><p>  Os testes de front-end s√£o implementados usando ferramentas que funcionam atrav√©s da CLI.  No package.json, os comandos s√£o escritos para executar diferentes tipos de testes.  Esses comandos n√£o s√£o usados ‚Äã‚Äãapenas pelos desenvolvedores no ambiente local.  Eles tamb√©m s√£o necess√°rios para executar testes no ambiente de CI (Continuous Integration). </p><br><p>  Se agora executarmos a compila√ß√£o no IC e n√£o houver erros, nosso prot√≥tipo aguardado ser√° entregue ao ambiente de teste (80% da funcionalidade na frente com um back-end ainda n√£o implementado).  Podemos mostrar a Vasily o comportamento aproximado do futuro microsservi√ßo.  Vasiliy chuta esse prot√≥tipo e, talvez, fa√ßa algumas observa√ß√µes (talvez at√© s√©rias).  Nesta fase, fazer ajustes n√£o √© caro.  No nosso caso, o apoio requer s√©rias mudan√ßas arquiteturais; portanto, o trabalho nele pode ser mais lento do que na frente.  Enquanto o apoio n√£o for finalizado, as altera√ß√µes no plano de desenvolvimento n√£o levar√£o a conseq√º√™ncias desastrosas.  Se necess√°rio, altere alguma coisa nesta fase, solicitaremos que voc√™ fa√ßa ajustes na especifica√ß√£o da API (em excesso).  Depois disso, as etapas descritas acima s√£o repetidas.  Os funcion√°rios da linha de frente ainda n√£o dependem de back-end.  Os especialistas individuais em front-end s√£o independentes um do outro. </p><br><h4 id="bekenda-kontrollery-zaglushki">  Backend.  Controladores de stub </h4><br><p>  O ponto de partida para o desenvolvimento da API no backend √© a especifica√ß√£o da API aprovada ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OpenAPI / Swagger</a> ).  Se houver uma especifica√ß√£o, o apoio tamb√©m ficar√° mais f√°cil de paralelizar.  A an√°lise da especifica√ß√£o deve levar os desenvolvedores a pensar sobre os elementos b√°sicos da arquitetura.  Quais componentes / servi√ßos comuns voc√™ precisa criar antes de prosseguir com a implementa√ß√£o de chamadas de API individuais.  E aqui novamente, voc√™ pode aplicar a abordagem como nos espa√ßos em branco da interface do usu√°rio. </p><br><p>  Podemos come√ßar de cima, ou seja,  da camada externa de nossas costas (dos controladores).  Nesta fase, come√ßamos com roteamento, espa√ßos em branco do controlador e dados falsos.  A camada de servi√ßos (BL) e acesso a dados (DAL) ainda n√£o fazemos.  Simplesmente transferimos os dados do JS para o back-end e programamos os controladores para que eles implementem as respostas esperadas para os casos b√°sicos, distribuindo partes dos dados falsos. </p><br><p>  Ap√≥s a conclus√£o desse est√°gio, os soldados da linha de frente devem ter um back-end de trabalho com dados de teste est√°ticos.  Al√©m disso, s√£o precisamente os dados nos quais os soldados da linha de frente escrevem testes de integra√ß√£o.  Em princ√≠pio, neste momento n√£o deve ser dif√≠cil alternar o gateway JS (importService) para usar espa√ßos em branco do controlador nas costas. </p><br><p>  A parte de resposta para solicita√ß√µes por meio do Websocket n√£o √© conceitualmente diferente dos controladores de API da Web.  Tamb√©m fazemos essa "resposta" nos dados de teste e conectamos importService a esta prepara√ß√£o. </p><br><p>  Por fim, todas as JS devem ser transferidas para trabalhar com um servidor real. </p><br><h4 id="bekend-finalizaciya-kontrollerov-zaglushki-v-dao">  Backend.  Finaliza√ß√£o de controladores.  Stubs DAO </h4><br><p>  Agora √© a vez de finalizar a camada de apoio externo.  Para controladores, os servi√ßos s√£o implementados um a um no BL.  Agora os servi√ßos funcionar√£o com dados falsos.  A adi√ß√£o nesse est√°gio √© que, nos servi√ßos, j√° implementamos uma l√≥gica de neg√≥cios real.  Nesse est√°gio, √© aconselh√°vel come√ßar a adicionar novos testes de acordo com a l√≥gica comercial das especifica√ß√µes.  √â importante que nenhum teste de integra√ß√£o caia. </p><br><p>  <strong>Nota:</strong> ainda n√£o dependemos se o esquema de dados est√° implementado no banco de dados. </p><br><h4 id="bekend-finalizaciya-dao-realnaya-bd">  Backend.  Finalize o DAO.  Db real </h4><br><p>  Depois que o esquema de dados √© implementado no banco de dados, podemos transferir os dados de teste das etapas anteriores para ele e mudar nosso DAL rudimentar para trabalhar com o servidor de banco de dados real.  Porque  Se transferirmos os dados iniciais criados para a frente do banco de dados, todos os testes devem permanecer relevantes.  Se algum dos testes cair, algo deu errado e voc√™ precisa entender. </p><br><p>  <strong>Nota:</strong> <em>em geral, com uma probabilidade muito alta de trabalhar com o esquema de dados no banco de dados, haver√° pouco para um novo recurso;</em>  <em>talvez altera√ß√µes no banco de dados sejam feitas simultaneamente com a implementa√ß√£o de servi√ßos no BL.</em> </p><br><p>  No final deste est√°gio, obtemos uma vers√£o alfa do microsservi√ßo completo.  Esta vers√£o j√° pode ser exibida para usu√°rios internos (Dono do produto, um tecn√≥logo do produto ou outra pessoa) para avalia√ß√£o como MVP. </p><br><p>  As itera√ß√µes padr√£o do Agile sobre o trabalho de corre√ß√£o de bugs, implementa√ß√£o de chips adicionais e polimento final continuar√£o. </p><br><h4 id="zaklyuchenie">  Conclus√£o </h4><br><p>  Eu acho que voc√™ n√£o deve usar o acima cegamente como um guia de a√ß√£o.  Primeiro voc√™ precisa experimentar e se adaptar ao seu projeto.  A abordagem descrita acima √© capaz de desatar desenvolvedores individuais um do outro e permitir que eles trabalhem em paralelo sob certas condi√ß√µes.  Todos os gestos com brunching e transfer√™ncia de dados, a implementa√ß√£o de espa√ßos em branco em dados falsos parecem uma sobrecarga significativa.  O lucro nessa sobrecarga aparece devido ao aumento da simultaneidade.  Se a equipe de desenvolvimento consiste <del>  um escavador e meio </del>  duas stacks completas ou um freotovik com um back-end, provavelmente haver√° muito lucro com essa abordagem.  Embora nessa situa√ß√£o, alguns pontos possam aumentar a efic√°cia do desenvolvimento. </p><br><p>  O lucro dessa abordagem aparece quando, no in√≠cio, implementamos rapidamente as pe√ßas o mais pr√≥ximo poss√≠vel de uma futura implementa√ß√£o real e separamos fisicamente o trabalho em diferentes partes no n√≠vel da estrutura de arquivos no projeto e no sistema de gerenciamento de c√≥digo (git). </p><br><p>  Espero que voc√™ tenha achado este artigo √∫til. </p><br><p>  Obrigado pela aten√ß√£o! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt463067/">https://habr.com/ru/post/pt463067/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt463055/index.html">Sobre administradores, devops, confus√£o sem fim e transforma√ß√£o de DevOps na empresa</a></li>
<li><a href="../pt463057/index.html">Direitos personalizados da estrutura 2 do Yii</a></li>
<li><a href="../pt463059/index.html">Tr√™s vidas em TI e n√£o apenas</a></li>
<li><a href="../pt463061/index.html">Regras para preparar layouts em Figma</a></li>
<li><a href="../pt463063/index.html">Lidamos com interfaces no Go</a></li>
<li><a href="../pt463069/index.html">Guia animado b√°sico de React</a></li>
<li><a href="../pt463071/index.html">Qual o impacto das interrup√ß√µes na Internet?</a></li>
<li><a href="../pt463073/index.html">QUIC em a√ß√£o: como o Uber o implementou para otimizar o desempenho</a></li>
<li><a href="../pt463075/index.html">Novas licen√ßas de c√≥digo aberto</a></li>
<li><a href="../pt463083/index.html">Protegendo backups do iPhone</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>