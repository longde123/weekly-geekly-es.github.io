<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍🤝‍👨🏽 👵🏽 👨‍💼 Curso MIT "Segurança de sistemas de computadores". Palestra 16: “Ataques de Canal Lateral”, Parte 3 🚶🏼 👲 🐓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Instituto de Tecnologia de Massachusetts. Curso de Aula nº 6.858. "Segurança de sistemas de computador". Nikolai Zeldovich, James Mickens. 2014 ano 
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Curso MIT "Segurança de sistemas de computadores". Palestra 16: “Ataques de Canal Lateral”, Parte 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/429394/"><h3>  Instituto de Tecnologia de Massachusetts.  Curso de Aula nº 6.858.  "Segurança de sistemas de computador".  Nikolai Zeldovich, James Mickens.  2014 ano </h3><br>  Computer Systems Security é um curso sobre o desenvolvimento e implementação de sistemas de computador seguros.  As palestras abrangem modelos de ameaças, ataques que comprometem a segurança e técnicas de segurança baseadas em trabalhos científicos recentes.  Os tópicos incluem segurança do sistema operacional (SO), recursos, gerenciamento de fluxo de informações, segurança de idiomas, protocolos de rede, segurança de hardware e segurança de aplicativos da web. <br><br>  Palestra 1: “Introdução: modelos de ameaças” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 2: “Controle de ataques de hackers” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 3: “Estouros de Buffer: Explorações e Proteção” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 4: “Separação de Privilégios” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 5: “De onde vêm os sistemas de segurança?” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> <br>  Palestra 6: “Oportunidades” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 7: “Sandbox do Cliente Nativo” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 8: “Modelo de Segurança de Rede” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 9: “Segurança de aplicativos da Web” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 10: “Execução Simbólica” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 11: “Linguagem de Programação Ur / Web” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 12: Segurança de rede <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Aula 13: “Protocolos de Rede” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 14: “SSL e HTTPS” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 15: “Software Médico” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <br>  Palestra 16: “Ataques de Canal Lateral” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3</a> <a name="habracut"></a><br><br>  <b>Público:</b> Você usa o método Karatsuba? <br><br>  <b>Professor:</b> Sim, este é um método de multiplicação inteligente que não requer quatro estágios de computação.  O método Karatsuba é ensinado no curso .601, ou como é designado hoje? <br><br>  <b>Audiência:</b> 042. <br><br>  <b>Professor:</b> 042, excelente.  Sim, este é um método muito bom.  Quase todas as bibliotecas criptográficas a utilizam.  Para aqueles que não são graduados em nosso instituto - digo isso porque temos estudantes aqui - escreverei sobre o método Karatsuba no quadro.  Aqui você precisa calcular três valores: <br><br>  a <sub>1</sub> b <sub>1</sub> <br>  (a <sub>1</sub> - a <sub>0</sub> ) (b <sub>1</sub> - b <sub>0</sub> ) <br>  a <sub>0</sub> b <sub>0</sub> <br><br>  Assim, você faz 3 multiplicações em vez de quatro, e pode restaurar esse valor a <sub>1</sub> b <sub>0</sub> + a <sub>0</sub> b <sub>1 a</sub> partir desses três resultados de multiplicação. <br><br><img src="https://habrastorage.org/webt/sg/_m/od/sg_modaezv2yehkmftzlhpybti0.jpeg"><br><br>  A maneira especial de fazer isso é isso ... deixe-me colocar de uma forma diferente. <br><br>  Então, teremos: <br><br>  (2 <sup>64</sup> + 2 <sup>32</sup> ) (a <sub>1</sub> b <sub>1</sub> ) + <br>  (2 <sup>32</sup> ) (- (a <sub>1</sub> - a <sub>0</sub> ) (b <sub>1</sub> - b <sub>0</sub> ) <br>  (2 <sup>32</sup> + 1) (a <sub>0</sub> b <sub>0</sub> ) <br><br>  Isso não está muito claro, mas se você descobrir os detalhes, acabe se convencendo de que esse valor nessas três linhas é equivalente ao valor de ab, mas ao mesmo tempo reduz o cálculo em uma multiplicação.  E a maneira como aplicamos isso a multiplicações mais volumosas é que você recursivamente continua diminuindo.  Portanto, se você tiver valores de 512 bits, poderá dividi-los na multiplicação de 256 bits.  Você faz três multiplicações de 256 bits, cada vez recursivamente, usando o método Karatsuba.  No final, seus cálculos se resumem ao tamanho da máquina e podem ser processados ​​por uma única instrução da máquina. <br><br><img src="https://habrastorage.org/webt/gv/7s/ae/gv7saezq-q5xj52fvxnjxenikgo.jpeg"><br><br>  Então, onde está o ataque de tempo?  Como esses caras usam a multiplicação de Karatsuba?  Acontece que o OpenSSL está preocupado com dois tipos de multiplicação que você pode precisar fazer. <br>  O primeiro é a multiplicação de dois grandes números aproximadamente do mesmo tamanho.  Isso acontece muitas vezes quando executamos uma exponenciação modular, porque todos os valores que multiplicaremos terão um tamanho de aproximadamente 512 bits.  Portanto, quando multiplicamos c por y ou quadrado, multiplicamos duas coisas aproximadamente do mesmo tamanho.  Nesse caso, o método Karatsuba faz muito sentido, porque reduz o tamanho dos números ao quadrado em cerca de 1,58 vezes, o que acelera bastante o processo de cálculo. <br>  O segundo tipo de multiplicação ocorre quando o OpenSSL multiplica dois números cujo tamanho difere significativamente um do outro: um é muito grande e o outro é muito pequeno.  Nesse caso, você também pode usar o método Karatsuba, mas ele funcionará mais lentamente que a multiplicação primitiva.  Suponha que você multiplique um número de 512 bits por um número de 64 bits, você precisará aumentar cada bit do primeiro número para uma potência de 64, resultando em uma desaceleração do processo 2n em vez da aceleração n / 1,58.  Portanto, esses caras que usam o OpenSSL tentaram ser mais inteligentes, e foi aqui que os problemas começaram. <br><br>  Eles decidiram que alternariam dinamicamente entre o método eficaz de Karatsuba e o método de multiplicação da escola primária.  A heurística deles era a seguinte.  Se os dois números multiplicados consistirem no mesmo número de palavras-máquina, ou pelo menos tiverem o mesmo número de bits que as unidades de 32 bits, será utilizado o método Karatsuba.  Se dois números diferem muito em tamanho um do outro, quadrado ou direto direto, é realizada a multiplicação normal. <br><br>  Nesse caso, você pode acompanhar como ocorre a mudança para outro método de multiplicação.  Como o momento da troca não passa sem deixar vestígios, será perceptível se agora exige muito mais tempo para multiplicação ou muito menos do que antes.  Os pesquisadores aproveitaram essa circunstância para organizar um ataque usando o método de temporização. <br><br>  Acho que terminei de lhe contar todos os truques estranhos que as pessoas usam ao implementar o RSA na prática.  Agora vamos tentar reuni-los e usá-los em relação a todo o servidor da Web para descobrir como você pode "extrair" os bits de interesse do pacote de rede de entrada. <br><br>  Se você se lembra da palestra sobre HTTPS, o servidor da Web possui uma chave secreta.  Ele usa essa chave secreta para provar que é o proprietário correto de todos os certificados através de HTTPS ou TLS.  Isso ocorre porque os clientes enviam alguns bits selecionados aleatoriamente, esses bits são criptografados usando a chave pública do servidor e o servidor descriptografa essa mensagem usando o protocolo TLS.  E se a mensagem estiver marcada, esses bits aleatórios serão usados ​​para estabelecer uma sessão de comunicação. <br><br>  Mas, no nosso caso, essa mensagem não será verificada, porque será criada de uma maneira especial e, quando os bits extras não corresponderem, o servidor retornará um erro assim que terminar de descriptografar a nossa mensagem. <br><br>  Aqui está o que vamos fazer aqui.  O servidor - você pode assumir que é o Apache com SSL aberto - receberá uma mensagem do cliente que considera como texto criptografado ou com algum texto criptografado hipotético criado pelo cliente.  A primeira coisa que fazemos com o texto cifrado c é descriptografá-lo usando a fórmula com → (c <sup>d</sup> mod n) = m. <br><br>  Se você se lembrar da primeira otimização, aplicaremos o teorema do restante chinês e dividiremos o texto em duas partes: uma para calcular pelo mod p, a outra pelo mod q, e depois combinar os resultados.  Primeiro, pegue c e represente-o em duas quantidades: a primeira é chamada c <sub>0</sub> , será igual a mod q, e a segunda é c <sub>1</sub> , e será igual a c mod p.  Então, faremos o mesmo para calcular c para d mod p ec para d mod q. <br><br><img src="https://habrastorage.org/webt/re/sp/qo/respqor_rehsunlfqjtc9lbmeok.jpeg"><br><br>  Em seguida, vamos mudar para a visualização Montgomery, porque isso tornará nossas multiplicações muito rápidas.  Então, a próxima coisa que o SSL fará com o seu número é calcular c <sub>0</sub> ', que será igual a c <sub>0</sub> R mod q e faça o mesmo aqui abaixo para o valor c1, não anotarei porque parece o mesmo . <br><br>  Agora que mudamos para a forma de Montgomery, podemos finalmente realizar nossas multiplicações e aqui usaremos a técnica de "janela deslizante".  Assim que obtemos c <sub>0</sub> ', tornamos este simples aumento de c <sub>0</sub> ' à potência de d no mod q.  E aqui, como calculamos esse valor para d, usaremos “janelas deslizantes” para bits do expoente d, e também usaremos o método Karatsuba ou a multiplicação usual, dependendo do tamanho de nossos operandos. <br><br><img src="https://habrastorage.org/webt/ah/oa/um/ahoaumcorgtkbkeuj6uxli1yv9i.jpeg"><br><br>  Portanto, se esse valor c <sub>0</sub> 'e o resultado quadrático obtido anteriormente tiverem o mesmo tamanho, usaremos o método Karatsuba.  Se c <sub>0</sub> 'for muito pequeno, e o resultado anterior da multiplicação for grande, então nós quadrilharemos e multiplicaremos da maneira usual.  Aqui usamos "janelas deslizantes" e o método Karatsuba em vez da multiplicação normal. <br><br><img src="https://habrastorage.org/webt/pk/xc/wl/pkxcwlnkl3fndnsc-nx3rqk1auo.jpeg"><br><br>  Também nesta fase, reduções adicionais aparecem.  Porque a cada multiplicação, reduções adicionais serão proporcionais ao que elevarmos à potência do mod q, ou seja, o valor de (c <sub>0</sub> ') <sup>d</sup> .  Aqui, com uma conexão simples da fórmula, a probabilidade de reduções adicionais será proporcional ao valor c <sub>0</sub> 'mod q dividido por 2R.  É neste local que um pouco aparece que afeta o tempo. <br><br>  De fato, existem dois efeitos possíveis: usar o método Karatsuba em vez da multiplicação normal e o aparecimento de abreviações adicionais que você fará. <br><br>  Em um segundo, você verá como ele pode ser usado.  Agora, quando você obtiver esse resultado para o mod q e obter um resultado semelhante para o mod p, finalmente poderá recombinar essas duas partes na parte superior e inferior e usar o CRT, o teorema chinês restante. <br><br>  E o que você obtém do CRT como resultado ... desculpe, acho que precisamos converter isso de volta do formulário Montgomery primeiro.  Portanto, antes da recombinação, convertemos a parte superior na expressão (c <sub>0</sub> ') <sup>d</sup> / R mod q e retornamos nosso valor cd mod q.  Na parte inferior, obtemos o cd mod p. <br><br>  Agora você pode usar o CRT para obter o valor de c <sup>d</sup> mod n.  Desculpe pela fonte pequena, eu não tinha quadro-negro suficiente.  Sobre a mesma coisa que chegamos aqui abaixo com <sub>1</sub> , e finalmente podemos obter nosso resultado, ou seja, a mensagem m. <br><br><img src="https://habrastorage.org/webt/vw/md/4x/vwmd4xcq0kjbfpsvw29dyqtglnk.jpeg"><br><br>  Assim, o servidor pega um pacote recebido, o executa por todo esse pipeline, executa duas partes desse pipeline e termina com uma mensagem descriptografada m igual a cd mod m.  Em seguida, ele verificará o preenchimento de preenchimento deste post.  No caso de nosso ataque específico, criamos de tal maneira que, de fato, essa adição não corresponde.  Escolhemos o valor c para heurísticas que não criptografam a mensagem real com a adição correta de preenchimento. <br><br>  Portanto, o complemento não passa no teste, o servidor precisará registrar um erro, enviar uma mensagem de erro ao cliente e desconectar.  Portanto, mediremos o tempo que o servidor levará para passar nossa mensagem por esse pipeline.  Você tem perguntas sobre o processo de processar uma mensagem pelo servidor e combinar todas essas otimizações? <br><br>  <b>Público:</b> na minha opinião, há um erro com um índice de magnitude c. <br><br>  <b>Professor:</b> sim, você está certo, estou adicionando o índice 0, aqui deve estar c <sub>0</sub> <sup>d</sup> mod q. <br><br><img src="https://habrastorage.org/webt/zf/c8/eb/zfc8ebgspz9g347khmvzs1n-9hc.jpeg"><br><br>  <b>Público:</b> quando você divide por R mod q, não há suposições sobre quanto q você deve adicionar para reduzir ainda mais os bits baixos em zeros? <br><br>  <b>Professor:</b> sim, você está certo, nesta fase final (c <sub>0</sub> ') <sup>d</sup> / R mod q pode haver reduções adicionais.  Portanto, devemos fazer essa divisão por R da maneira correta, e provavelmente devemos fazer a mesma coisa que fazer a redução de Montgomery aqui, quando dividimos por R, para converter o valor de volta.  Como no início dos cálculos não está claro exatamente quanto q devemos adicionar, usamos o método de seleção, destruímos os zeros baixos e, novamente, fazemos o mod q e, possivelmente, uma redução adicional.  Você está absolutamente correto, neste caso, é exatamente a mesma divisão por R mod q que para cada etapa da multiplicação de Montgomery. <br><br>  Então, como você tira proveito disso?  Como um invasor pode resolver a chave secreta de um servidor medindo o tempo necessário para concluir as operações?  Esses caras têm um plano baseado em adivinhar um bit de chave privada por vez.  Podemos assumir que a chave secreta é o expoente criptografado d, porque você sabe e e sabe n, essa é a chave pública.  A única coisa que você não sabe é d. <br><br><img src="https://habrastorage.org/webt/qw/pv/cg/qwpvcgujkfsub1kworr1vy2bmea.jpeg"><br><br>  De fato, nesse ataque, eles não adivinham diretamente o valor de d, pois é bastante complicado.  Em vez disso, eles consideram q ou p, independentemente de qual dessas duas quantidades.  Depois de adivinhar o que p ou q importa, você pode calcular n = pq.  Então, se você conhece os valores de p e q, pode calcular a função φ sobre a qual falamos anteriormente.  Isso permitirá que você obtenha o valor de d a partir do valor de e.  Portanto, essa fatoração do valor de n é extremamente importante; deve ser mantida em segredo para garantir a segurança da RSA. <br><br>  Na verdade, esses caras pretendiam adivinhar o valor q analisando os tempos desse pipeline.  O que eles estão fazendo para isso?  Eles selecionam cuidadosamente o valor inicial do valor de c e medem o tempo de sua passagem pelo pipeline do servidor. <br><br>  Em particular, há duas partes nesse ataque e você deve executar algumas etapas iniciais para adivinhar os primeiros bits.  Então, assim que você tiver os primeiros bits, poderá adivinhar o próximo.  Portanto, não permita que eu diga detalhadamente como eles adivinham o primeiro par de bits, porque na verdade é muito mais interessante considerar como eles adivinham o próximo bit.  Se tivermos tempo, voltaremos a como a adivinhação de vários bits iniciais é descrita em um artigo de aula. <br><br>  Então, suponha que você tenha suposição g sobre quais bits estão no valor desse q.  Deixe esse valor consistir em tais bits: g = g <sub>0</sub> g <sub>1</sub> g <sub>2</sub> ... e assim por diante.  Em vez disso, nem sequer é g, mas os bits reais de q, então deixe-me reescrevê-lo assim: g = q <sub>0</sub> q <sub>1</sub> q <sub>2</sub> ....  Acreditamos que esses q são bits altos, e estamos tentando adivinhar os bits cada vez mais baixos.  Suponha que sabemos o valor de q até o bit qj e, em seguida, todos os zeros seguem.  Você não tem idéia do que são os outros bits. <br><br><img src="https://habrastorage.org/webt/8c/ca/df/8ccadfhe0orkn4jalptuhmm_c9a.jpeg"><br><br>  Esses caras tentaram injetar essa conjectura g neste local do nosso pipeline: (c0 ') d mod q.  Como esse é o local em que dois tipos de otimização são usados: o método Karatsub, em vez da multiplicação usual e um número diferente de abreviações adicionais, dependendo do valor de c <sub>0</sub> '.  Na verdade, eles tentaram introduzir duas suposições diferentes nesse local do pipeline: o primeiro, que se parece com g = q <sub>0</sub> q <sub>1</sub> q <sub>2</sub> ... qj 000 ... 0000, e o segundo, que eles chamaram de g <sub>high</sub> , que consiste nos mesmos bits altos, mas em vez disso de todos os zeros no final, há uma unidade que indica um bit alto, seguida por zeros novamente: <br><br>  g = q <sub>0</sub> q <sub>1</sub> q <sub>2</sub> ... qj 100 ... 0000. <br><br>  Como isso ajuda esses caras a entender o que está acontecendo?  Existem duas maneiras de fazer isso.  Suponha que nosso palpite g seja igual ao valor c <sub>0</sub> '.  Podemos assumir que esses g e g <sub>altos</sub> correspondem ao valor c <sub>0</sub> 'dado na placa esquerda.  Na verdade, é bem simples fazer isso porque c <sub>0</sub> 'é muito fácil de calcular a partir do valor de entrada criptografado c <sub>0</sub> , basta multiplicá-lo por R. <br><br><img src="https://habrastorage.org/webt/u9/5k/yp/u95kypmv569-dhhozaeqfpcwgjo.jpeg"><br><br>  Portanto, para adivinhar o valor (c <sub>0</sub> ') <sup>d</sup> , eles apenas precisam adivinhar, adivinhar g e primeiro dividi-lo por R, ou seja, dividir por 512 mod algo lá.  Em seguida, eles o apresentarão novamente, o servidor o multiplicará por R e continuará o processo descrito em nosso esquema de pipeline. <br><br>  Então, suponha que possamos colocar nosso valor inteiro selecionado específico no lugar certo.  Então, qual será o tempo de computação c <sub>0</sub> 'para d mod q? <br><br><img src="https://habrastorage.org/webt/zy/b5/ud/zyb5udmf96e2cvwliab80lhusum.jpeg"><br><br>  Existem duas opções possíveis em que q se encaixa nessa imagem.  Pode ser que q esteja entre esses dois valores de g e g <sub>altos</sub> , porque o próximo bit de q é 0. Portanto, esse valor - o primeiro 0 após qj - será menor que q, mas esse valor - 1 após q - será maior que q  Isso acontece se o próximo bit de q for 0, ou é possível que q esteja acima desses dois valores se o próximo bit de q for 1. <br><br><img src="https://habrastorage.org/webt/g5/uk/mn/g5ukmnfmvzp_rdlyhwtptj-8e4o.jpeg"><br><br>  Agora, podemos dizer qual será o tempo de descriptografia desses dois valores se q estiver entre eles ou se q estiver localizado acima de ambos. <br><br>  Vejamos a situação em que q está localizado acima.  Nesse caso, tudo é praticamente o mesmo.  Como esses dois valores são menores que q, o valor dessas coisas no mod q será aproximadamente o mesmo.  Eles são um pouco diferentes devido a esse bit extra, mas ainda mais ou menos do mesmo tamanho.  E o número de reduções adicionais, redução extra, provavelmente também não diferirá muito, porque é proporcional ao valor de c0 'mod q.  E para os valores <sub>altos de</sub> g e g menores que q, eles são todos iguais.  Nenhum deles excederá q e não causará um grande número de reduções adicionais, porque para q maior que essas duas suposições, o número de cálculos pelo método Karatsuba com relação ao número de cálculos comuns permanecerá o mesmo.  Em termos desse relacionamento, o servidor manipulará tanto g quanto g <sub>alto</sub> igualmente.  Portanto, o servidor está prestes a criar a mesma quantidade de abreviações adicionais para esses dois valores.  Portanto, se você perceber que o servidor está gastando o mesmo tempo respondendo a essas suposições, provavelmente deve assumir que existe realmente 1 no valor de g <sub>alto</sub> neste momento. <br><br><img src="https://habrastorage.org/webt/ui/d_/tg/uid_tglidwosbzxkquvonqfrzi0.jpeg"><br><br>  Por outro lado, se q estiver localizado entre esses dois valores, existem duas coisas possíveis que podem causar alterações de comutação e tempo.  Uma das coisas é que, como g <sub>alta é</sub> um pouco maior que q, o número de cortes adicionais será proporcional a c <sub>0</sub> 'mod q, que é muito pequeno porque c <sub>0</sub> ' é q mais alguns bits nessa sequência de bits extra de 100 ... 00  Assim, o número de reduções adicionais será mais perceptível e tudo começará a acontecer mais rapidamente. <br>    ,   ,  , , ,  : «,         !».  ,    g  c <sub>0</sub> '     ,   q,   ,  g <sub>high</sub>  q,  g <sub>high</sub> mod q     .      ,       .         –    ,       ,   . <br><br>     c <sub>0</sub> ' mod q.  c <sub>0</sub>     g <sub>high</sub> ,   q,    ,        g  q.       ,     .     ,     ,          . ,    32-        ,        . <br><br>   ,     32- , ,     ,   .  ,         .         32 ,   ,    -  .   ,     ,  32, , ,     ,      . <br><br> ,  ,     ,            .    ,     q  1,         ,     q  0,   ,    g <sub>high</sub>  q   ,      ,   . <br><br>          . ,      .          ,    .   ,     ,  1-2 .        , ,   Ethernet. <br>      ,   .      .   ,        7    . ,   , -,         ,        ? <br><br> <b>:</b>     ? <br><br> <b>:</b> ,        ,           ,               ,     ,   .   ,       . <br><br>        ,    ,           7 ,        ,            7 .     7   g,   7   g + 1,  g + 2   7      g + 400.      g,     g, , 7   400,    ? <br><br><img src="https://habrastorage.org/webt/oo/at/9h/ooat9hm2htm-wjoamvqlpfv1vac.jpeg"><br><br> <b>:</b> ,    ,   ? <br><br> : ,     ,   ,        — (c <sub>0</sub> ') <sup>d</sup> .      . ,  ,   ,     mod p.    ,           ,     .  ,         g,  1, 2, 3,  ,    . <br><br>       ,     ,          –    100…00.  ,        mod p,    ,      mod p       .       « »,     ,        (c <sub>0</sub> ') <sup>d</sup> ,    .  ? <br><br> <b>:</b>   ,     ? <br><br> <b>:</b>      -   ,       q. ,        q,   ,     ,     . <br><br> <b>:</b>    c <sub>0</sub> '? <br><br> <b>:</b>     c <sub>0</sub> ',     c,     c <sub>0</sub> '      R  mod n. <br><br><img src="https://habrastorage.org/webt/br/j9/xp/brj9xpzlbunothk8hhovxqsxcz8.jpeg"><br><br>      ,  «»  ,     c <sub>0</sub> =  mod q,       c <sub>0</sub> = ((c <sub>0</sub> ' R <sup>-1</sup> ) mod n) mod q.      R,     R.           c <sub>0</sub> ',     (c <sub>0</sub> ') <sup>d</sup> mod q.  ,     ,   ,  ,       R.   ,  R = 2 <sup>512</sup> .  ,    . <br><br> <b>:</b>            mod p    ? <br><br> <b>:</b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou seja, você não sabe o que é p, mas deseja defini-lo aleatoriamente? </font><font style="vertical-align: inherit;">Se você tiver sucesso, fará um ótimo trabalho! </font><font style="vertical-align: inherit;">Bem, na próxima semana começaremos a discutir outras questões.</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/3v5Von-oNUg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A versão completa do curso está disponível </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br>  Obrigado por ficar conosco.  Você gosta dos nossos artigos?  Deseja ver materiais mais interessantes?  Ajude-nos fazendo um pedido ou recomendando a seus amigos, um <b>desconto de 30% para os usuários da Habr em um análogo exclusivo de servidores básicos que inventamos para você:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Toda a verdade sobre o VPS (KVM) E5-2650 v4 (6 núcleos) 10GB DDR4 240GB SSD 1Gbps de US $ 20 ou como dividir o servidor?</a>  (as opções estão disponíveis com RAID1 e RAID10, até 24 núcleos e até 40GB DDR4). <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VPS (KVM) E5-2650 v4 (6 núcleos) 10 GB DDR4 240 GB SSD de 1 Gbps até dezembro de graça</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> quando pagar por um período de seis meses, você pode fazer o pedido </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br>  <b>Dell R730xd 2 vezes mais barato?</b>  Somente nós temos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2 TVs Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 a partir de US $ 249</a> na Holanda e nos EUA!</b>  Leia sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como criar um prédio de infraestrutura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">classe usando servidores Dell R730xd E5-2650 v4 custando 9.000 euros por um centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt429394/">https://habr.com/ru/post/pt429394/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt429384/index.html">Componentes elétricos da bicicleta: Motor</a></li>
<li><a href="../pt429386/index.html">Fornecedor da AT&T se torna o maior detentor de direitos autorais e começará a desconectar usuários acusados ​​de pirataria</a></li>
<li><a href="../pt429388/index.html">Como fazer um novo design do site e não causar problemas: 4 etapas importantes</a></li>
<li><a href="../pt429390/index.html">Curso MIT "Segurança de sistemas de computadores". Palestra 16: “Ataques de Canal Lateral”, Parte 1</a></li>
<li><a href="../pt429392/index.html">Curso MIT "Segurança de sistemas de computadores". Aula 16: Ataques pelo canal lateral, parte 2</a></li>
<li><a href="../pt429396/index.html">Como testar um aplicativo ao interagir com a API usando o SoapUI</a></li>
<li><a href="../pt429400/index.html">Seals vs neural network 2. Ou execute o SqueezeNet v.1.1 no Raspberry Zero em tempo real (quase)</a></li>
<li><a href="../pt429402/index.html">ML.NET 0.7 (Machine Learning .NET)</a></li>
<li><a href="../pt429404/index.html">8 seg ½ maneiras de priorizar a funcionalidade</a></li>
<li><a href="../pt429406/index.html">"Monstros em jogos ou como criar medo"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>