<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍⚕️ ➰ ✴️ Bagaimana Android Gustuff Trojan menghapus krim (fiat dan crypto) dari akun Anda 🚯 ✴️ 👳</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Beberapa hari yang lalu, Group-IB melaporkan aktivitas Trojan Android Gustuff. Ia bekerja secara eksklusif di pasar internasional, menyerang pelanggan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana Android Gustuff Trojan menghapus krim (fiat dan crypto) dari akun Anda</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/446948/"><img src="https://habrastorage.org/webt/b9/hn/wr/b9hnwrlclblkmurq29bkezeanui.png"><br><br>  Beberapa hari yang lalu, Group-IB <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">melaporkan</a> aktivitas Trojan Android Gustuff.  Ia bekerja secara eksklusif di pasar internasional, menyerang pelanggan dari 100 bank asing terbesar, pengguna 32 dompet kripto seluler, serta sumber daya e-commerce yang besar.  Tetapi pengembang Gustuff adalah penjahat cyber berbahasa Rusia dengan julukan Bestoffer.  Sampai baru-baru ini, ia memuji trojannya sebagai "produk serius bagi orang-orang dengan pengetahuan dan pengalaman." <br><br>  <b>Ivan Pisarev, seorang</b> spesialis dalam menganalisis kode berbahaya Grup-IB, dalam penelitiannya menceritakan secara rinci tentang cara kerja Gustuff dan apa bahayanya. <a name="habracut"></a><br><br><h2>  Untuk siapa Gustuff berburu? </h2><br>  Gustuff adalah generasi baru malware dengan fitur yang sepenuhnya otomatis.  Menurut pengembangnya, trojan telah menjadi versi baru yang diperbaiki dari malware AndyBot, yang sejak November 2017 telah menyerang ponsel Android dan mencuri uang melalui formulir web phising yang menyamar sebagai aplikasi mobile dari bank internasional terkenal dan sistem pembayaran.  Bestoffer melaporkan bahwa harga sewa Gustuff Bot adalah $ 800 per bulan. <br><br>  Analisis sampel Gustuff menunjukkan bahwa Trojan berpotensi ditujukan pada pelanggan yang menggunakan aplikasi mobile bank terbesar, seperti Bank of America, Bank of Scotland, JPMorgan, Wells Fargo, Capital One, Bank TD, Bank PNC, serta Dompet Bitcoin, dompet kripto BitPay , Cryptopay, Coinbase, dll. <br><br>  Awalnya diciptakan sebagai trojan perbankan klasik, versi Gustuff saat ini telah secara signifikan memperluas daftar target potensial untuk diserang.  Selain aplikasi Android dari bank, perusahaan fintech, dan layanan crypto, Gustuff ditujukan untuk pengguna aplikasi pasar, toko online, sistem pembayaran, dan pesan instan.  Secara khusus, PayPal, Western Union, eBay, Walmart, Skype, WhatsApp, Gett Taxi, Revolut, dan lainnya. <br><br><h2>  Titik masuk: perhitungan untuk infeksi massa </h2><br>  Gustuff ditandai oleh vektor "klasik" penetrasi ke dalam smartphone Android melalui pengiriman SMS dengan tautan ke APK.  Jika perangkat Android terinfeksi trojan atas perintah server, Gustuff dapat menyebar lebih jauh melalui basis data kontak telepon yang terinfeksi atau melalui basis data server.  Fungsionalitas Gustuff dirancang untuk infeksi besar dan kapitalisasi maksimum dari bisnis operatornya - ini memiliki fungsi unik "pengisian otomatis" ke dalam aplikasi mobile banking yang sah dan dompet crypto, yang memungkinkan Anda untuk mempercepat dan skala pencurian uang. <br><br>  Studi tentang Trojan menunjukkan bahwa fungsi pengisian otomatis diimplementasikan di dalamnya menggunakan Layanan Aksesibilitas - layanan untuk para penyandang cacat.  Gustuff bukan trojan pertama yang berhasil melewati perlindungan terhadap interaksi dengan elemen jendela aplikasi lain yang menggunakan layanan Android ini.  Namun, penggunaan Layanan Aksesibilitas bersamaan dengan pemuatan otomatis masih sangat jarang. <br><br>  Setelah mengunduh korban ke telepon, Gustuff, menggunakan Layanan Aksesibilitas, mendapat kesempatan untuk berinteraksi dengan elemen jendela aplikasi lain (perbankan, cryptocurrency, serta aplikasi untuk belanja online, pengiriman pesan, dll.), Melakukan tindakan yang diperlukan untuk penyerang.  Misalnya, atas perintah server, trojan dapat mengklik tombol dan mengubah nilai bidang teks dalam aplikasi perbankan.  Menggunakan mekanisme Layanan Aksesibilitas memungkinkan trojan untuk melewati mekanisme perlindungan yang digunakan oleh bank untuk melawan Trojan seluler dari generasi sebelumnya, serta perubahan dalam kebijakan keamanan yang diperkenalkan oleh Google dalam versi baru dari OS Android.  Jadi, Gustuff "tahu caranya" untuk menonaktifkan perlindungan Google Protect: menurut penulis, fungsi ini bekerja di 70% kasus. <br><br><img src="https://habrastorage.org/webt/ih/x4/1k/ihx41k2p4hqubcaaisklwvdyoy8.png"><br><br>  Gustuff juga dapat menampilkan pemberitahuan PUSH palsu dengan ikon aplikasi seluler yang sah.  Pengguna mengklik pemberitahuan PUSH dan melihat jendela phishing yang diunduh dari server, di mana ia sendiri memasukkan data yang diminta dari kartu bank atau dompet crypto.  Dalam skenario Gustuff lain, aplikasi terbuka atas nama yang pemberitahuan PUSH ditampilkan.  Dalam hal ini, program jahat, atas perintah server melalui Layanan Aksesibilitas, dapat mengisi bidang formulir aplikasi perbankan untuk transaksi penipuan. <br><br>  Fungsi Gustuff juga termasuk mengirim informasi tentang perangkat yang terinfeksi ke server, kemampuan membaca / mengirim pesan SMS, mengirim permintaan USSD, meluncurkan SOCKS5 Proxy, mengikuti tautan, mengirim file (termasuk pemindaian dokumen dokumen, screenshot, foto) ke server atur ulang perangkat ke pengaturan pabrik. <br><br><h2>  Analisis malware </h2><br>  Sebelum memasang aplikasi jahat, OS Android menampilkan jendela yang berisi daftar hak yang diminta oleh Gustuff kepada pengguna: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ku/th/ac/kuthacuzh0webqtrwhgktysougi.png" alt="alt gambar"></div><br>  Pemasangan aplikasi hanya akan terjadi setelah mendapat persetujuan pengguna.  Setelah meluncurkan aplikasi, trojan akan menampilkan jendela kepada pengguna: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hj/uq/xa/hjuqxaw2ezubek_xmd3clywhpsw.png" alt="alt gambar"></div><br>  Maka itu akan menghapus ikonnya. <br><br>  Gustuff dikemas, menurut penulis, oleh pengemas FTT.  Setelah memulai, aplikasi secara berkala mengakses server CnC untuk menerima perintah.  Dalam beberapa file yang kami teliti, alamat IP <b>88.99.171 [.] 105</b> digunakan sebagai server kontrol (pada bagian berikut kami akan menyebutnya sebagai <b>&lt;% CnC%&gt;</b> ). <br><br>  Setelah memulai, program mulai mengirim pesan ke server <b>http: // &lt;% CnC%&gt; /api/v1/get.php</b> . <br><br>  Sebagai jawaban, JSON diharapkan dalam format berikut: <br><br><pre><code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"results"</span></span> : <span class="hljs-string"><span class="hljs-string">"OK"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;%id%&gt;"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:<span class="hljs-string"><span class="hljs-string">"&lt;%command%&gt;"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"timestamp"</span></span>:<span class="hljs-string"><span class="hljs-string">"&lt;%Server Timestamp%&gt;"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"params"</span></span>:{ &lt;%Command parameters as JSON%&gt; }, }, }</code> </pre> <br>  Setiap kali aplikasi mengirim informasi tentang perangkat yang terinfeksi.  Format pesan disajikan di bawah ini.  Perlu dicatat bahwa bidang <b>aplikasi</b> dan <b>izin</b> <b>lengkap</b> , <b>ekstra</b> , adalah opsional dan hanya akan dikirim jika ada perintah permintaan dari CnC. <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"info"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"info"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"cell"</span></span>:&lt;%Sim operator name%&gt;, <span class="hljs-attr"><span class="hljs-attr">"country"</span></span>:&lt;%Country ISO%&gt;, <span class="hljs-attr"><span class="hljs-attr">"imei"</span></span>:&lt;%IMEI%&gt;, <span class="hljs-attr"><span class="hljs-attr">"number"</span></span>:&lt;%Phone number%&gt;, <span class="hljs-attr"><span class="hljs-attr">"line1Number"</span></span>:&lt;%Phone number%&gt;, <span class="hljs-attr"><span class="hljs-attr">"advertisementId"</span></span>:&lt;%ID%&gt; }, <span class="hljs-attr"><span class="hljs-attr">"state"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"admin"</span></span>:&lt;%Has admin rights%&gt;, <span class="hljs-attr"><span class="hljs-attr">"source"</span></span>:&lt;%String%&gt;, <span class="hljs-attr"><span class="hljs-attr">"needPermissions"</span></span>:&lt;%Application needs permissions%&gt;, <span class="hljs-attr"><span class="hljs-attr">"accesByName"</span></span>:&lt;%Boolean%&gt;, <span class="hljs-attr"><span class="hljs-attr">"accesByService"</span></span>:&lt;%Boolean%&gt;, <span class="hljs-attr"><span class="hljs-attr">"safetyNet"</span></span>:&lt;%String%&gt;, <span class="hljs-attr"><span class="hljs-attr">"defaultSmsApp"</span></span>:&lt;%Default Sms Application%&gt;, <span class="hljs-attr"><span class="hljs-attr">"isDefaultSmsApp"</span></span>:&lt;%Current application is Default Sms Application%&gt;, <span class="hljs-attr"><span class="hljs-attr">"dateTime"</span></span>:&lt;%Current date time%&gt;, <span class="hljs-attr"><span class="hljs-attr">"batteryLevel"</span></span>:&lt;%Battery level%&gt; }, <span class="hljs-attr"><span class="hljs-attr">"socks"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%Proxy module ID%&gt;, <span class="hljs-attr"><span class="hljs-attr">"enabled"</span></span>:&lt;%Is enabled%&gt;, <span class="hljs-attr"><span class="hljs-attr">"active"</span></span>:&lt;%Is active%&gt; }, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"versionName"</span></span>:&lt;%Package Version Name%&gt;, <span class="hljs-attr"><span class="hljs-attr">"versionCode"</span></span>:&lt;%Package Version Code%&gt;, <span class="hljs-attr"><span class="hljs-attr">"lastUpdateTime"</span></span>:&lt;%Package Last Update Time%&gt;, <span class="hljs-attr"><span class="hljs-attr">"tag"</span></span>:&lt;%Tag, default value: <span class="hljs-string"><span class="hljs-string">"TAG"</span></span>%&gt;, <span class="hljs-attr"><span class="hljs-attr">"targetSdkVersion"</span></span>:&lt;%Target Sdk Version%&gt;, <span class="hljs-attr"><span class="hljs-attr">"buildConfigTimestamp"</span></span>:<span class="hljs-number"><span class="hljs-number">1541309066721</span></span> }, }, <span class="hljs-attr"><span class="hljs-attr">"full"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"model"</span></span>:&lt;%Device Model%&gt;, <span class="hljs-attr"><span class="hljs-attr">"localeCountry"</span></span>:&lt;%Country%&gt;, <span class="hljs-attr"><span class="hljs-attr">"localeLang"</span></span>:&lt;%Locale language%&gt;, <span class="hljs-attr"><span class="hljs-attr">"accounts"</span></span>:&lt;%JSON array, contains from <span class="hljs-attr"><span class="hljs-attr">"name"</span></span> and <span class="hljs-attr"><span class="hljs-attr">"type"</span></span> of accounts%&gt;, <span class="hljs-attr"><span class="hljs-attr">"lockType"</span></span>:&lt;%Type of lockscreen password%&gt; }, <span class="hljs-attr"><span class="hljs-attr">"extra"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"serial"</span></span>:&lt;%Build serial number%&gt;, <span class="hljs-attr"><span class="hljs-attr">"board"</span></span>:&lt;%Build Board%&gt;, <span class="hljs-attr"><span class="hljs-attr">"brand"</span></span>:&lt;%Build Brand%&gt;, <span class="hljs-attr"><span class="hljs-attr">"user"</span></span>:&lt;%Build User%&gt;, <span class="hljs-attr"><span class="hljs-attr">"device"</span></span>:&lt;%Build Device%&gt;, <span class="hljs-attr"><span class="hljs-attr">"display"</span></span>:&lt;%Build Display%&gt;, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%Build ID%&gt;, <span class="hljs-attr"><span class="hljs-attr">"manufacturer"</span></span>:&lt;%Build manufacturer%&gt;, <span class="hljs-attr"><span class="hljs-attr">"model"</span></span>:&lt;%Build model%&gt;, <span class="hljs-attr"><span class="hljs-attr">"product"</span></span>:&lt;%Build product%&gt;, <span class="hljs-attr"><span class="hljs-attr">"tags"</span></span>:&lt;%Build tags%&gt;, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>:&lt;%Build type%&gt;, <span class="hljs-attr"><span class="hljs-attr">"imei"</span></span>:&lt;%imei%&gt;, <span class="hljs-attr"><span class="hljs-attr">"imsi"</span></span>:&lt;%imsi%&gt;, <span class="hljs-attr"><span class="hljs-attr">"line1number"</span></span>:&lt;%phonenumber%&gt;, <span class="hljs-attr"><span class="hljs-attr">"iccid"</span></span>:&lt;%Sim serial number%&gt;, <span class="hljs-attr"><span class="hljs-attr">"mcc"</span></span>:&lt;%Mobile country code of operator%&gt;, <span class="hljs-attr"><span class="hljs-attr">"mnc"</span></span>:&lt;%Mobile network codeof operator%&gt;, <span class="hljs-attr"><span class="hljs-attr">"cellid"</span></span>:&lt;%GSM-data%&gt;, <span class="hljs-attr"><span class="hljs-attr">"lac"</span></span>:&lt;%GSM-data%&gt;, <span class="hljs-attr"><span class="hljs-attr">"androidid"</span></span>:&lt;%Android Id%&gt;, <span class="hljs-attr"><span class="hljs-attr">"ssid"</span></span>:&lt;%Wi-Fi SSID%&gt; }, <span class="hljs-attr"><span class="hljs-attr">"apps"</span></span>:{&lt;%List of installed applications%&gt;}, <span class="hljs-attr"><span class="hljs-attr">"permission"</span></span>:&lt;%List of granted permissions%&gt; }</code> </pre> <br><h3>  Penyimpanan Data Konfigurasi </h3><br>  Gustuff menyimpan informasi pekerjaan penting dalam file preferensi.  Nama file, serta nama parameter di dalamnya, adalah hasil dari penghitungan jumlah MD5 dari baris <b>15413090667214.6.1 &lt;% name%&gt;</b> , di mana <b>&lt;% name%&gt;</b> adalah nilai-nama asli.  Interpretasi python dari fungsi pembuatan nama: <br><br><pre> <code class="json hljs"> nameGenerator(input): output = md<span class="hljs-number"><span class="hljs-number">5</span></span>(<span class="hljs-string"><span class="hljs-string">"15413090667214.6.1"</span></span> + input)</code> </pre> <br>  Dalam apa yang berikut, kami akan menyatakannya sebagai <b>nameGenerator (input)</b> . <br><br>  Dengan demikian, nama file pertama adalah: <b>nameGenerator ("API_SERVER_LIST")</b> , itu berisi nilai-nilai dengan nama-nama berikut: <br><br><table><tbody><tr><th width="400">  <b>Nama variabel</b> </th><th>  <b>Nilai</b> </th></tr><tr><td>  <b>nameGenerator ("API_SERVER_LIST")</b> </td><td>  Berisi daftar alamat CnC sebagai array. </td></tr><tr><td>  <b>nameGenerator ("API_SERVER_URL")</b> </td><td>  Berisi alamat CnC. </td></tr><tr><td>  <b>nameGenerator ("SMS_UPLOAD")</b> </td><td>  Bendera diatur secara default.  Jika bendera diatur - mengirim pesan SMS ke CnC. </td></tr><tr><td>  <b>nameGenerator ("SMS_ROOT_NUMBER")</b> </td><td>  Nomor telepon tujuan pengiriman pesan SMS oleh perangkat yang terinfeksi.  Standarnya adalah nol. </td></tr><tr><td>  <b>nameGenerator ("SMS_ROOT_NUMBER_RESEND")</b> </td><td>  Bendera dihapus secara default.  Jika diinstal, ketika perangkat yang terinfeksi menerima SMS, itu akan dikirim ke nomor root. </td></tr><tr><td>  <b>nameGenerator ("DEFAULT_APP_SMS")</b> </td><td>  Bendera dihapus secara default.  Jika flag ini disetel, aplikasi akan memproses pesan SMS yang masuk. </td></tr><tr><td>  <b>nameGenerator ("DEFAULT_ADMIN")</b> </td><td>  Bendera dihapus secara default.  Jika flag diatur, aplikasi memiliki hak administrator. </td></tr><tr><td>  <b>nameGenerator ("DEFAULT_ACCESSIBILITY")</b> </td><td>  Bendera dihapus secara default.  Jika bendera diatur, layanan menggunakan Layanan Aksesibilitas dimulai. </td></tr><tr><td>  <b>nameGenerator ("APPS_CONFIG")</b> </td><td>  Objek JSON berisi daftar tindakan yang harus dilakukan ketika acara Aksesibilitas yang terkait dengan aplikasi tertentu dipicu. </td></tr><tr><td>  <b>nameGenerator ("APPS_INSTALLED")</b> </td><td>  Menyimpan daftar aplikasi yang diinstal pada perangkat. </td></tr><tr><td>  <b>nameGenerator ("IS_FIST_RUN")</b> </td><td>  Bendera di-reset pada awal pertama. </td></tr><tr><td>  <b>nameGenerator ("UNIQUE_ID")</b> </td><td>  Berisi pengidentifikasi unik.  Ini dihasilkan pada peluncuran pertama bot. </td></tr></tbody></table><br><h3>  Modul pemrosesan perintah server </h3><br>  Aplikasi menyimpan alamat server CnC sebagai array string yang disandikan <b>Base85</b> .  Daftar server CnC dapat diubah setelah menerima perintah yang sesuai, dalam hal ini alamat akan disimpan dalam file preferensi. <br><br>  Menanggapi permintaan tersebut, server mengirimkan perintah ke aplikasi.  Perlu dicatat bahwa perintah dan parameter disajikan dalam format JSON.  Aplikasi dapat memproses perintah berikut: <br><table><tbody><tr><th width="150">  <b>Tim</b> </th><th>  <b>Deskripsi</b> </th></tr><tr><td>  <b>forwardStart</b> </td><td>  Mulai mengirim pesan SMS yang diterima oleh perangkat yang terinfeksi ke server CnC. </td></tr><tr><td>  <b>forwardStop</b> </td><td>  Berhenti mengirim pesan SMS yang diterima oleh perangkat yang terinfeksi ke server CnC. </td></tr><tr><td>  <b>ussdRun</b> </td><td>  Jalankan permintaan USSD.  Nomor yang Anda inginkan untuk membuat permintaan USSD ada di kolom "nomor" JSON. </td></tr><tr><td>  <b>sendSms</b> </td><td>  Kirim satu SMS-pesan (jika perlu, pesan "dibagi" menjadi beberapa bagian).  Sebagai parameter, perintah mengambil objek JSON yang berisi bidang "ke" - nomor tujuan dan "tubuh" - badan pesan. </td></tr><tr><td>  <b>sendSmsAb</b> </td><td>  Kirim pesan SMS (jika perlu, pesan itu "dibagi" menjadi beberapa bagian) untuk semua orang dari daftar kontak perangkat yang terinfeksi.  Interval antara pengiriman pesan adalah 10 detik.  Isi pesan ada di kolom JSON "badan" </td></tr><tr><td>  <b>sendSmsMass</b> </td><td>  Kirim pesan SMS (jika perlu, pesan itu "dibagi" menjadi beberapa bagian) ke kontak yang ditentukan dalam parameter perintah.  Interval antara pengiriman pesan adalah 10 detik.  Sebagai parameter, perintah menerima array JSON (bidang "sms"), elemen yang berisi bidang "ke" - nomor tujuan dan "tubuh" - badan pesan. </td></tr><tr><td>  <b>ubahServer</b> </td><td>  Perintah ini sebagai parameter dapat mengambil nilai dengan kunci "url" - maka bot akan mengubah nilai nameGenerator ("SERVER_URL"), atau "array" - maka bot akan menulis array ke nameGenerator ("API_SERVER_LIST") Jadi, aplikasi mengubah alamat server CnC. </td></tr><tr><td>  <b>adminNumber</b> </td><td>  Perintah ini dirancang untuk bekerja dengan nomor root.  Perintah menerima objek JSON dengan parameter berikut: "number" - ubah nameGenerator ("ROOT_NUMBER") menjadi nilai yang diterima, "kirim ulang" - ubah nameGenerator ("SMS_ROOT_NUMBER_RESEND"), "sendId" - kirim ke namaGenerator ("ROOT_NUMBER") unikID. </td></tr><tr><td>  <b>perbarui info</b> </td><td>  Kirim informasi tentang perangkat yang terinfeksi ke server. </td></tr><tr><td>  <b>wipeData</b> </td><td>  Perintah ini dirancang untuk menghapus data pengguna.  Bergantung pada nama aplikasi yang diluncurkan, salah satu data dihapus sepenuhnya dengan reboot perangkat (pengguna utama), atau hanya data pengguna yang dihapus (pengguna sekunder). </td></tr><tr><td>  <b>socksStart</b> </td><td>  Luncurkan modul proxy.  Pengoperasian modul dijelaskan dalam bagian terpisah. </td></tr><tr><td>  <b>berhenti kaus kaki</b> </td><td>  Hentikan modul proxy. </td></tr><tr><td>  <b>openLink</b> </td><td>  Ikuti tautannya.  Tautan ini terletak di parameter JSON dengan kunci "url".  Untuk membuka tautan, gunakan "android.intent.action.VIEW". </td></tr><tr><td>  <b>unggah semuanya</b> </td><td>  Kirim ke server semua pesan SMS yang diterima oleh perangkat. </td></tr><tr><td>  <b>unggahFoto</b> </td><td>  Kirim gambar dari perangkat yang terinfeksi ke URL.  URL datang sebagai parameter. </td></tr><tr><td>  <b>unggahFile</b> </td><td>  Kirim file ke URL dari perangkat yang terinfeksi.  URL datang sebagai parameter. </td></tr><tr><td>  <b>unggahNomor telepon</b> </td><td>  Kirim nomor telepon dari daftar kontak ke server.  Jika objek JSON dengan tombol "ab" datang sebagai parameter, aplikasi menerima daftar kontak dari buku telepon.  Jika objek JSON dengan kunci "sms" datang sebagai parameter, aplikasi membaca daftar kontak dari pengirim pesan SMS. </td></tr><tr><td>  <b>ubahArsipkan</b> </td><td>  Aplikasi mengunduh file dari alamat, yang datang sebagai parameter dengan kunci "url".  File yang diunduh disimpan dengan nama "archive.zip".  Setelah itu, aplikasi akan membuka ritsleting file, jika perlu, menggunakan kata sandi untuk arsip "b5jXh37gxgHBrZhQ4j3D".  File yang tidak di-zip disimpan di direktori [penyimpanan eksternal] / hgps.  Dalam direktori ini, aplikasi menyimpan palsu web (dijelaskan nanti). </td></tr><tr><td>  <b>tindakan</b> </td><td>  Perintah ini dirancang untuk bekerja dengan Layanan Tindakan, yang dijelaskan di bagian terpisah. </td></tr><tr><td>  <b>tes</b> </td><td>  Tidak melakukan apa-apa. </td></tr><tr><td>  <b>unduh</b> </td><td>  Perintah ini dirancang untuk mengunduh file dari server jauh dan menyimpannya ke direktori Unduhan.  URL dan nama file datang sebagai parameter, bidang dalam parameter objek JSON, masing-masing: "url" dan "fileName". </td></tr><tr><td>  <b>hapus</b> </td><td>  Menghapus file dari direktori Unduhan.  Nama file datang dalam parameter JSON dengan kunci "nama file".  Nama file default adalah "tmp.apk". </td></tr><tr><td>  <b>pemberitahuan</b> </td><td>  Tampilkan pemberitahuan dengan teks deskripsi dan judul yang ditentukan oleh server manajemen. </td></tr></tbody></table><br>  Format perintah <b>notifikasi</b> adalah: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"results"</span></span> : <span class="hljs-string"><span class="hljs-string">"OK"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: &lt;%id%&gt;, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:<span class="hljs-string"><span class="hljs-string">"notification"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"timestamp"</span></span>:&lt;%Server Timestamp%&gt;, <span class="hljs-attr"><span class="hljs-attr">"params"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"openApp"</span></span>:&lt;%Open original app or not%&gt;, <span class="hljs-attr"><span class="hljs-attr">"array"</span></span>:[ {<span class="hljs-attr"><span class="hljs-attr">"title"</span></span>:&lt;%Title text%&gt;, <span class="hljs-attr"><span class="hljs-attr">"desc"</span></span>:&lt;%Description text%&gt;, <span class="hljs-attr"><span class="hljs-attr">"app"</span></span>:&lt;%Application name%&gt;} ] }, }, }</code> </pre> <br>  Notifikasi yang dihasilkan oleh file yang diselidiki terlihat identik dengan notifikasi yang dibuat oleh aplikasi yang ditentukan dalam bidang <b>aplikasi</b> .  Jika nilai bidang <b>openApp</b> Benar, ketika pemberitahuan dibuka, aplikasi yang ditentukan dalam bidang <b>aplikasi</b> diluncurkan.  Jika nilai bidang <b>openApp</b> salah, maka: <br><br><ul><li>  jendela phishing terbuka, yang isinya diunduh dari direktori <b>&lt;% penyimpanan eksternal%&gt; / hgps / &lt;% nama file%&gt;</b> </li><li>  jendela phishing terbuka, yang isinya diunduh dari server <b>&lt;% url%&gt;? id = &lt;% Bot id%&gt; &amp; app = &lt;% Nama aplikasi%&gt;</b> </li><li>  Jendela phishing yang disamarkan saat Google Play Card terbuka, dengan kemampuan untuk memasukkan informasi kartu. </li></ul><br>  Aplikasi mengirimkan hasil pelaksanaan perintah apa pun ke <b>&lt;% CnC%&gt; \ set_state.php</b> sebagai objek JSON dengan format berikut: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>:&lt;%command%&gt;, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%command_id%&gt;, <span class="hljs-attr"><span class="hljs-attr">"state"</span></span>:&lt;%command_state%&gt; } <span class="hljs-string"><span class="hljs-string">"id"</span></span>:&lt;%bot_id%&gt; }</code> </pre> <br>  <b>Layanan Tindakan</b> <br><br>  Daftar perintah yang proses aplikasi menyertakan <b>tindakan</b> .  Setelah menerima perintah, modul pemrosesan perintah mengakses layanan ini untuk menjalankan perintah yang diperluas.  Layanan menerima objek JSON sebagai parameter.  Suatu layanan dapat menjalankan perintah berikut: <br><br>  <b>1.</b> <b>PARAMS_ACTION</b> - setelah menerima perintah seperti itu, layanan pertama-tama menerima dari parameter JSON nilai dengan kunci Type, itu mungkin sebagai berikut: <br><br><ul><li>  <b>serviceInfo</b> - <b>subcommand</b> menerima dari parameter JSON nilai kunci <b>includeNotImportant</b> .  Jika flag itu Benar, aplikasi menyetel flag <b>FLAG_ISOLATED_PROCESS</b> ke layanan yang menggunakan Layanan Aksesibilitas.  Dengan demikian, layanan akan diluncurkan dalam proses terpisah. </li><li>  <b>root</b> - dapatkan dan kirim ke informasi server tentang jendela, yang sekarang dalam fokus.  Aplikasi mengambil informasi menggunakan kelas AccessibilityNodeInfo. </li><li>  <b>admin</b> - meminta hak administrator. </li><li>  <b>delay</b> - menunda ActionsService untuk jumlah milidetik yang ditentukan dalam parameter dengan kunci "data". </li><li>  <b>windows</b> - kirim daftar windows yang terlihat oleh pengguna. </li><li>  <b>instal</b> - instal aplikasi pada perangkat yang terinfeksi.  Nama paket - arsip ada di kunci "nama file".  Arsip itu sendiri terletak di direktori Unduhan. </li><li>  <b>global</b> - subkomand dirancang untuk transisi dari jendela saat ini: <br><ul><li>  pada menu Pengaturan Cepat </li><li>  kembali </li><li>  rumah </li><li>  pemberitahuan </li><li>  ke jendela aplikasi yang baru dibuka </li></ul><br></li><li>  <b>luncurkan</b> - luncurkan aplikasi.  Nama aplikasi datang sebagai parameter oleh kunci <b>data</b> . </li><li>  <b>suara</b> - ubah mode suara menjadi hening. </li><li>  <b>membuka kunci</b> - menyalakan lampu latar layar dan keyboard dengan kecerahan penuh.  Aplikasi melakukan tindakan ini menggunakan WakeLock, string [Application lable]: INFO </li><li>  <b>permitOverlay</b> - fungsi tidak diterapkan (respons terhadap eksekusi perintah adalah {"message": "Not support"} atau {"message": "low sdk"}) </li><li>  <b>gesture</b> - fungsi tidak diimplementasikan (respons terhadap eksekusi perintah adalah {"message": "Not support"} atau {"message": "Low API"}) </li><li>  <b>izin</b> - perintah ini diperlukan untuk meminta izin untuk aplikasi.  Namun, fungsi kueri tidak diterapkan, jadi perintahnya tidak masuk akal.  Daftar hak yang diminta datang sebagai array JSON dengan kunci "izin".  Daftar standar: <br><br><ul><li>  android.permission.READ_PHONE_STATE </li><li>  android.permission.READ_CONTACTS </li><li>  android.permission.CALL_PHONE </li><li>  android.permission.RECEIVE_SMS </li><li>  android.permission.SEND_SMS </li><li>  android.permission.READ_SMS </li><li>  android.permission.READ_EXTERNAL_STORAGE </li><li>  android.permission.WRITE_EXTERNAL_STORAGE </li></ul><br></li><li>  <b>buka</b> - tampilkan jendela phishing.  Bergantung pada parameter yang berasal dari server, aplikasi dapat menampilkan jendela phishing berikut: <br><br><ul><li>  Tampilkan jendela phishing, yang isinya ditulis dalam file di direktori <b>&lt;% direktori eksternal%&gt; / hgps / &lt;% param_filename%&gt;</b> .  Hasil interaksi pengguna dengan jendela akan dikirim ke <b>&lt;% CnC%&gt; / records.php</b> </li><li>  Tampilkan jendela phishing yang isinya dimuat dari alamat <b>&lt;% url_param%&gt;? Id = &lt;% bot_id%&gt; &amp; app = &lt;% nama paket%&gt;</b> .  Hasil interaksi pengguna dengan jendela akan dikirim ke <b>&lt;% CnC%&gt; / records.php</b> </li><li>  Tampilkan jendela phishing yang disamarkan sebagai Google Play Card. </li></ul></li><li>  <b>interaktif</b> - perintah ini dirancang untuk berinteraksi dengan elemen jendela aplikasi lain menggunakan AcessibilityService.  Untuk interaksi, layanan khusus diterapkan dalam program.  Aplikasi yang sedang dipelajari dapat berinteraksi dengan windows: <br><ul><li>  Aktif saat ini.  Dalam hal ini, parameter berisi id atau teks (nama) dari objek yang diperlukan untuk berinteraksi. </li><li>  Terlihat oleh pengguna pada saat perintah dieksekusi.  Aplikasi memilih windows dengan id. </li></ul><br>  Setelah menerima objek <b>AccessibilityNodeInfo</b> untuk elemen jendela yang menarik, aplikasi, tergantung pada parameter, dapat melakukan tindakan: <br><ul><li>  fokus - atur fokus ke objek. </li><li>  klik - klik pada suatu objek. </li><li>  actionId - melakukan tindakan dengan ID. </li><li>  setText - mengubah teks objek.  Anda dapat mengubah teks dalam dua cara: melakukan tindakan <b>ACTION_SET_TEXT</b> (jika versi Android perangkat yang terinfeksi lebih muda atau sama dengan <b>LOLLIPOP</b> ), atau dengan menempatkan garis di clipboard dan menempelkannya ke objek (untuk versi yang lebih lama).  Perintah ini dapat digunakan untuk mengubah data dalam aplikasi perbankan. </li></ul></li></ul><br>  <b>2.</b> <b>PARAMS_ACTIONS</b> - sama seperti <b>PARAMS_ACTION</b> , hanya array perintah JSON yang datang. <br><br>  Tampaknya banyak yang akan tertarik dengan apa fungsi berinteraksi dengan elemen jendela aplikasi lain.  Beginilah fungsi ini diimplementasikan di Gustuff: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">interactiveAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List aiList, JSONObject action, JsonObject res)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count = action.optInt(<span class="hljs-string"><span class="hljs-string">"repeat"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); Iterator aiListIterator = ((Iterable)aiList).iterator(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(aiListIterator.hasNext()) { Object ani = aiListIterator.next(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;= count) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(index = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; ++index) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(action.has(<span class="hljs-string"><span class="hljs-string">"focus"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(((AccessibilityNodeInfo)ani).performAction(<span class="hljs-number"><span class="hljs-number">1</span></span>)) { ++count; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(action.has(<span class="hljs-string"><span class="hljs-string">"click"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(((AccessibilityNodeInfo)ani).performAction(<span class="hljs-number"><span class="hljs-number">16</span></span>)) { ++count; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(action.has(<span class="hljs-string"><span class="hljs-string">"actionId"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(((AccessibilityNodeInfo)ani).performAction(action.optInt(<span class="hljs-string"><span class="hljs-string">"actionId"</span></span>))) { ++count; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(action.has(<span class="hljs-string"><span class="hljs-string">"setText"</span></span>)) { customHeader ch = CustomAccessibilityService.a; Context context = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getApplicationContext(); String text = action.optString(<span class="hljs-string"><span class="hljs-string">"setText"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(performSetTextAction(ch, context, ((AccessibilityNodeInfo)ani), text)) { ++count; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(index == count) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } ((AccessibilityNodeInfo)ani).recycle(); } res.addPropertyNumber(<span class="hljs-string"><span class="hljs-string">"res"</span></span>, Integer.valueOf(count)); }</code> </pre> <br>  Fungsi Penggantian Teks: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">performSetTextAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context, AccessibilityNodeInfo ani, String text)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> result; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Build$VERSION.SDK_INT &gt;= <span class="hljs-number"><span class="hljs-number">21</span></span>) { Bundle b = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bundle(); b.putCharSequence(<span class="hljs-string"><span class="hljs-string">"ACTION_ARGUMENT_SET_TEXT_CHARSEQUENCE"</span></span>, ((CharSequence)text)); result = ani.performAction(<span class="hljs-number"><span class="hljs-number">0x200000</span></span>, b); <span class="hljs-comment"><span class="hljs-comment">// ACTION_SET_TEXT } else { Object clipboard = context.getSystemService("clipboard"); if(clipboard != null) { ((ClipboardManager)clipboard).setPrimaryClip(ClipData.newPlainText("autofill_pm", ((CharSequence)text))); result = ani.performAction(0x8000); // ACTION_PASTE } else { result = false; } } return result; }</span></span></code> </pre> <br>  Dengan demikian, jika server kontrol dikonfigurasi dengan benar, Gustuff dapat mengisi kolom teks dalam aplikasi perbankan dan mengklik tombol-tombol yang diperlukan untuk transaksi.  Trojan bahkan tidak perlu diotorisasi dalam aplikasi - cukup kirim perintah untuk menunjukkan notifikasi PUSH, diikuti dengan membuka aplikasi perbankan yang sebelumnya diinstal.  Pengguna akan melalui otorisasi, setelah itu Gustuff akan dapat mengisi otomatis. <br><br><h3>  Modul pemrosesan SMS </h3><br>  Aplikasi mengatur pengendali acara untuk menerima pesan SMS oleh perangkat yang terinfeksi.  Aplikasi yang sedang dipelajari dapat menerima perintah dari operator yang ada di badan pesan SMS.  Perintah datang dalam format: <br><br>  <b>7! 5 = &lt;% Perintah disandikan Base64%&gt;</b> <br><br>  Aplikasi mencari di semua pesan SMS yang masuk untuk string <b>7! 5 =</b> , jika mendeteksi string, ia menerjemahkan string Base64 pada offset 4 dan menjalankan perintah.  Perintah mirip dengan perintah dengan CnC.  Hasil eksekusi dikirim ke nomor yang sama dari mana perintah itu berasal.  Format jawaban: <br><br>  <b>7 * 5 = &lt;% Base64 menyandikan "result_code command"%&gt;</b> <br><br>  Secara opsional, aplikasi dapat mengirim semua pesan yang diterima ke nomor Root.  Untuk melakukan ini, nomor Root harus ditentukan dalam file preferensi dan bendera pengalihan pesan diatur.  Pesan SMS dikirim ke nomor penyerang dalam format: <br><br>  <b>&lt;% Dari angka%&gt; - &lt;% Waktu, format: dd / MM / yyyy HH: mm: ss%&gt; &lt;% Badan SMS%&gt;</b> <br><br>  Selain itu, aplikasi dapat mengirim pesan ke CnC.  Pesan SMS dikirim ke server dalam format JSON: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%BotID%&gt;, <span class="hljs-attr"><span class="hljs-attr">"sms"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>:&lt;%SMS body%&gt;, <span class="hljs-attr"><span class="hljs-attr">"number"</span></span>:&lt;%From number%&gt;, <span class="hljs-attr"><span class="hljs-attr">"date"</span></span>:&lt;%Timestamp%&gt; } }</code> </pre> <br>  Jika flag <b>nameGenerator ("DEFAULT_APP_SMS")</b> diatur, aplikasi berhenti memproses pesan SMS dan menghapus daftar pesan yang masuk. <br><br><h3>  Modul proksi </h3><br>  Dalam aplikasi yang sedang dipelajari, ada modul Proxy Backconnect (selanjutnya disebut sebagai modul Proxy), yang memiliki kelas terpisah yang mencakup bidang statis dengan konfigurasi.  Data konfigurasi disimpan dalam sampel dalam bentuk terbuka: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g-/4f/mi/g-4fmidam6alfsjuhw1ltmcodhy.png" alt="alt gambar"></div><br><br>  Semua tindakan yang dilakukan oleh Proxy-module dicatat ke file.  Untuk melakukan ini, aplikasi di Penyimpanan Eksternal membuat direktori yang disebut "log" (bidang ProxyConfigClass.logsDir dalam kelas konfigurasi), di mana file log disimpan.  Logging terjadi pada file dengan nama: <br><br><ol><li>  <b>main.txt</b> - kelas ini <b>mencatat</b> operasi kelas dengan nama CommandServer.  Di masa mendatang, pencatatan string str ke file ini akan dilambangkan sebagai mainLog (str). </li><li>  <b>session - &lt;% id%&gt;. txt</b> - data log yang terkait dengan sesi proksi tertentu disimpan ke file ini.  Log lebih lanjut dari str str ke file ini akan disebut sebagai sessionLog (str). </li><li>  <b>server.txt</b> - data ini mencatat semua data yang ditulis ke file di atas. </li></ol><br>  Format Data Log: <br><br>  &lt;% Tanggal%&gt; [Utas [&lt;% utas%%]], id []]: log-string <br><br>  Pengecualian yang terjadi selama pengoperasian modul Proxy juga dicatat ke file.  Untuk ini, aplikasi menghasilkan objek format JSON: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"uncaughtException"</span></span>:&lt;%short description of throwable%&gt; <span class="hljs-string"><span class="hljs-string">"thread"</span></span>:&lt;%thread%&gt; <span class="hljs-string"><span class="hljs-string">"message"</span></span>:&lt;%detail message of throwable%&gt; <span class="hljs-string"><span class="hljs-string">"trace"</span></span>: //Stack trace info [ { <span class="hljs-attr"><span class="hljs-attr">"ClassName"</span></span>: <span class="hljs-string"><span class="hljs-string">"FileName"</span></span>: <span class="hljs-string"><span class="hljs-string">"LineNumber"</span></span>: <span class="hljs-string"><span class="hljs-string">"MethodName"</span></span>: }, { <span class="hljs-attr"><span class="hljs-attr">"ClassName"</span></span>: <span class="hljs-string"><span class="hljs-string">"FileName"</span></span>: <span class="hljs-string"><span class="hljs-string">"LineNumber"</span></span>: <span class="hljs-string"><span class="hljs-string">"MethodName"</span></span>: } ] }</code> </pre> <br>  Kemudian ia mengubahnya menjadi representasi string dan log. <br><br>  Modul proksi diluncurkan setelah penerimaan tim yang sesuai.  Ketika sebuah perintah tiba untuk memulai modul Proxy, aplikasi memulai layanan yang disebut <b>MainService</b> , yang bertanggung jawab untuk mengontrol operasi modul Proxy - mulai dan berhenti. <br><br>  Tahapan memulai layanan: <br><br>  <b>1.</b> Mulai penghitung waktu yang bekerja satu menit sekali dan periksa aktivitas modul proxy.  Jika modul tidak aktif, ia memulainya. <br>  Juga, ketika acara <b>android.net.conn.CONNECTIVITY_CHANGE</b> dipicu, modul Proxy dimulai. <br><br>  <b>2.</b> Aplikasi membuat kunci bangun dengan parameter <b>PARTIAL_WAKE_LOCK</b> dan menangkapnya.  Karena itu, itu tidak memungkinkan CPU perangkat untuk memasuki mode tidur. <br><br>  <b>3.</b> Menjalankan kelas pemrosesan perintah modul proxy dengan masuk ke jalur mainLog <b>("start server")</b> dan <br><br>  <b>Server :: start () host [&lt;% proxy_cnc%&gt;], commandPort [&lt;% command_port%&gt;], proxyPort [&lt;% proxy_port%&gt;]</b> <br><br>  di mana <b>proxy_cnc, command_port dan proxy_port</b> adalah parameter yang diperoleh dari konfigurasi server proxy. <br><br>  Kelas pemrosesan perintah disebut <b>CommandConnection</b> .  Segera setelah diluncurkan, ia melakukan tindakan berikut: <br><br>  <b>4.</b> Menghubungkan ke <b>ProxyConfigClass.host</b> : <b>ProxyConfigClass.commandPort</b> dan mengirimkan data tentang perangkat yang terinfeksi dalam format JSON ke sana: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%id%&gt;, <span class="hljs-attr"><span class="hljs-attr">"imei"</span></span>:&lt;%imei%&gt;, <span class="hljs-attr"><span class="hljs-attr">"imsi"</span></span>:&lt;%imsi%&gt;, <span class="hljs-attr"><span class="hljs-attr">"model"</span></span>:&lt;%model%&gt;, <span class="hljs-attr"><span class="hljs-attr">"manufacturer"</span></span>:&lt;%manufacturer%&gt;, <span class="hljs-attr"><span class="hljs-attr">"androidVersion"</span></span>:&lt;%androidVersion%&gt;, <span class="hljs-attr"><span class="hljs-attr">"country"</span></span>:&lt;%country%&gt;, <span class="hljs-attr"><span class="hljs-attr">"partnerId"</span></span>:&lt;%partnerId%&gt;, <span class="hljs-attr"><span class="hljs-attr">"packageName"</span></span>:&lt;%packageName%&gt;, <span class="hljs-attr"><span class="hljs-attr">"networkType"</span></span>:&lt;%networkType%&gt;, <span class="hljs-attr"><span class="hljs-attr">"hasGsmSupport"</span></span>:&lt;%hasGsmSupport%&gt;, <span class="hljs-attr"><span class="hljs-attr">"simReady"</span></span>:&lt;%simReady%&gt;, <span class="hljs-attr"><span class="hljs-attr">"simCountry"</span></span>:&lt;%simCountry%&gt;, <span class="hljs-attr"><span class="hljs-attr">"networkOperator"</span></span>:&lt;%networkOperator%&gt;, <span class="hljs-attr"><span class="hljs-attr">"simOperator"</span></span>:&lt;%simOperator%&gt;, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>:&lt;%version%&gt; }</code> </pre> <br>  Dimana: <br><br><ul><li>  pengidentifikasi id, berusaha mendapatkan nilai dengan bidang "id" dari file Preferensi Bersama dengan nama "x".  Jika nilai ini tidak dapat diperoleh, itu menghasilkan yang baru.  , Proxy-  ̆ , ̆   Bot ID. </li><li> imei — IMEI ̆.        —         . </li><li> imsi — International Mobile Subscriber Identity ̆.        —         . </li><li> model — The end-user-visible name for the end product. </li><li> manufacturer — The manufacturer of the product/hardware (Build.MANUFACTURER). </li><li> androidVersion —    "&lt;%release_version%&gt; (&lt;%os_version%&gt;),&lt;%sdk_version%&gt;" </li><li> country —   ̆. </li><li> partnerId –  . </li><li> packageName – package name. </li><li> networkType —     (: «WIFI», «MOBILE»).     null. </li><li> hasGsmSupport – true –    GSM,  false. </li><li> simReady –  SIM-. </li><li> simCountry — ISO-  (  ̆ -). </li><li> networkOperator —  .        —         . </li><li> simOperator — The Service Provider Name (SPN).        —         . </li><li> version —     -,   ̆     «1.6». </li></ul><br> <b>5.</b>       .      : <br><br><ul><li> 0 offset – command </li><li> 1 offset – sessionId </li><li> 2 offset – length </li><li> 4 offset — data </li></ul><br>     : <br><br> <b>mainLog(«Header { sessionId&lt;%id%&gt;], type[&lt;%command%&gt;], length[&lt;%length%&gt;] }»)</b> <br><br>     : <br><br><table><tbody><tr><th> Name </th><th> Command </th><th> Data </th><th> Description </th></tr><tr><td> <b>connectionId</b> </td><td>  0 </td><td> Connection ID </td><td>    </td></tr><tr><td> <b>SLEEP</b> </td><td>  3 </td><td>  Waktu </td><td>   Proxy- </td></tr><tr><td> <b>PING_PONG</b> </td><td>  4 </td><td>  - </td><td>  PONG- </td></tr></tbody></table><br> PONG-   4     : <b>0x04000000</b> . <br><br>    connectionId (   ) <b>CommandConnection</b>    <b>ProxyConnection</b> . <br><br><ul><li>      : <b>ProxyConnection</b>  <b>end</b> .    <b>ProxyConnection</b>     <b>ProxyConfigClass.host</b> : <b>ProxyConfigClass.proxyPort</b>   JSON-: </li></ul><br><pre> <code class="json hljs"> { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:&lt;%connectionId%&gt; }</code> </pre> <br>     SOCKS5-,     ,     . ̆       <b>end</b> .       : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hz/ed/y7/hzedy7sapdijp20ayiacbiwarc8.png" alt="alt gambar"></div><br><h2>  ̆ </h2><br>       ̆  CnC-        SSL.             JSON-.       : <br><br><ul><li> <b>http://&lt;%CnC%&gt;/api/v1/set_state.php</b> —   . </li><li> <b>http://&lt;%CnC%&gt;/api/v1/get.php</b> —  . </li><li> <b>http://&lt;%CnC%&gt;/api/v1/load_sms.php</b> —  SMS-̆   ̆. </li><li> <b>http://&lt;%CnC%&gt;/api/v1/load_ab.php</b> —      ̆. </li><li> <b>http://&lt;%CnC%&gt;/api/v1/aevents.php</b> –     ,   preference-̆. </li><li> <b>http://&lt;%CnC%&gt;/api/v1/set_card.php</b> —  ,    -,   Google Play Market. </li><li> <b>http://&lt;%CnC%&gt;/api/v1/logs.php</b> –  -. </li><li> <b>http://&lt;%CnC%&gt;/api/v1/records.php</b> –  ,     . </li><li> <b>http://&lt;%CnC%&gt;/api/v1/set_error.php</b> –   ̆ . </li></ul><br><h2>  </h2><br>              ,          ,     . <br><br>              ,    .               ,   ,             . <br><br>    –   - ,      ,      -,    , ,     ,       ,     . <br><br><h3>    : </h3><br><ul><li>         Android  - ,  Google Play; </li><li>     <b> </b>    ; </li><li>     Android; </li><li>      ; </li><li>    ; </li><li>    ,   SMS-. </li></ul><br>   <b> </b> ,          Group-IB. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id446948/">https://habr.com/ru/post/id446948/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id446932/index.html">TDMS Fairway dan BIM</a></li>
<li><a href="../id446938/index.html">Sistem partikel dalam Core Animation. Cerita natal</a></li>
<li><a href="../id446940/index.html">QA pada prod. Kenapa itu keren?</a></li>
<li><a href="../id446942/index.html">Server, bisakah kau mendengarku? Serangan BROP pada contoh tugas NeoQUEST-2019</a></li>
<li><a href="../id446944/index.html">Mengapa berinvestasi di perusahaan yang tidak menguntungkan?</a></li>
<li><a href="../id446950/index.html">76% produsen tidak memiliki pengalaman menerapkan aditif - mengapa itu baik</a></li>
<li><a href="../id446952/index.html">Buat histogram animasi menggunakan R</a></li>
<li><a href="../id446956/index.html">Berbahaya bagi cahaya, atau bagaimana menjaga baterai mobil tetap kosong</a></li>
<li><a href="../id446958/index.html">Tine Perl rumit</a></li>
<li><a href="../id446960/index.html">Rumah yang dibangun Jack</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>