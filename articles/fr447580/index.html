<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛹🏾 🧜🏽 👧 Chasse aux menaces ou comment se défendre contre 5% des menaces 👩🏽‍🎤 👩🏼‍💻 🈂️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="95% des menaces à la sécurité des informations sont connues et vous pouvez vous en protéger par des moyens traditionnels tels que les antivirus, les p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Chasse aux menaces ou comment se défendre contre 5% des menaces</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lanit/blog/447580/"> 95% des menaces à la sécurité des informations sont connues et vous pouvez vous en protéger par des moyens traditionnels tels que les antivirus, les pare-feu, les IDS, les WAF.  Les 5% restants des menaces sont inconnus et les plus dangereux.  Ils représentent 70% du risque pour l'entreprise du fait qu'il est très difficile de les détecter et encore plus de s'en protéger.  Des exemples de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">«cygnes noirs»</a> sont les épidémies de ransomware WannaCry, NotPetya / ExPetr, les cryptomères, les cyberarmes Stuxnet (qui ont frappé les installations nucléaires de l'Iran), et beaucoup (qui d'autre se souvient de Kido / Conficker?) D'autres attaques qui ne sont pas très efficaces pour se défendre contre le classique moyens de protection.  Nous voulons parler de la façon de contrer ces 5% de menaces en utilisant la technologie de chasse aux menaces. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6f0/6a1/19e/6f06a119e1279e1bbbe9f3774f831f53.png"></div><a name="habracut"></a><br>  Le développement continu des cyberattaques nécessite une détection et une contre-action constantes, ce qui nous conduit finalement à l'idée d'une course aux armements sans fin entre attaquants et défenseurs.  Les systèmes de protection classiques ne sont plus en mesure de fournir un niveau de sécurité acceptable auquel le niveau de risque n'affecte pas les indicateurs clés de l'entreprise (économique, politique, réputation) sans les finaliser pour une infrastructure spécifique, mais en général ils couvrent certains des risques.  Déjà en cours de mise en œuvre et de configuration, les systèmes de protection modernes deviennent des rattrapages et doivent répondre aux défis des temps modernes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a8f/a31/386/a8fa31386ee92fe03e60d4bb004c2ce0.png"></div>  <a href="">Source</a> <br><br>  L'une des réponses aux défis de notre temps pour un spécialiste de la sécurité de l'information peut être la technologie de la chasse aux menaces.  Le terme Chasse aux menaces (ci-après dénommé TH) est apparu il y a plusieurs années.  La technologie elle-même est assez intéressante, mais n'a pas encore de normes et de règles généralement acceptées.  L'hétérogénéité des sources d'information et le petit nombre de sources d'information en russe sur ce sujet compliquent également la question.  À cet égard, chez LANIT-Integration, nous avons décidé d'écrire une revue de cette technologie. <br><br><h2>  Pertinence </h2><br>  La technologie TH repose sur des processus de surveillance des infrastructures.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Il existe deux principaux scénarios de surveillance interne: l'alerte et la chasse</a> .  L'alerte (par type de service MSSP) est une méthode traditionnelle, qui recherche les signatures et les signes d'attaques développés plus tôt et y réagit.  Les fonctionnalités de sécurité de signature traditionnelles complètent avec succès ce scénario.  La chasse (un service de type MDR) est une méthode de suivi qui répond à la question «D'où viennent les signatures et les règles?»  Il s'agit du processus de création de règles de corrélation en analysant les indicateurs cachés ou inconnus et les signes d'une attaque.  C'est à ce type de surveillance qu'appartient la chasse aux menaces. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df0/6ba/ffb/df06baffb0742e44018b15b5ae804de5.png"></div><br>  Ce n'est qu'en combinant les deux types de surveillance que nous obtenons une protection proche de l'idéal, mais il reste toujours un certain niveau de risque résiduel. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6c6/820/fd3/6c6820fd3eca0e338e9f530bfb43ccc4.png"></div>  <i>Protection à l'aide de deux types de surveillance</i> <br><br>  Et voici pourquoi TH (et toute la chasse!) Sera de plus en plus pertinent: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ba/a47/d96/6baa47d96a13bafd8b10d2c11b4e1f79.png"></div>  <i>Menaces, remèdes, risques.</i>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Source</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">95% de toutes les menaces sont déjà bien comprises</a> .  Il s'agit notamment d'espèces telles que le spam, les DDoS, les virus, les rootkits et autres logiciels malveillants classiques.  Vous pouvez vous protéger de ces menaces avec les mêmes défenses classiques. <br><br>  Pendant l'exécution de tout projet, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">80% du travail prend 20% du temps</a> et les 20% restants du travail 80% du temps.  De même, dans l'ensemble du paysage des menaces, 5% du nouveau type de menace constituera 70% du risque pour l'entreprise.  Dans une entreprise où les processus de gestion de la sécurité de l'information sont organisés, nous pouvons gérer 30% du risque de menaces connues d'une manière ou d'une autre en évitant (abandonner les réseaux sans fil en principe), en acceptant (en introduisant les mesures de sécurité nécessaires) ou en déplaçant (par exemple, sur les épaules d'un intégrateur) ce risque.  Se protéger des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vulnérabilités zero-day</a> , des attaques APT, du phishing, des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">attaques via la chaîne d'approvisionnement</a> , des cyber-logiciels espions et des opérations nationales, ainsi que d'un grand nombre d'autres attaques, est déjà beaucoup plus difficile.  Les conséquences de ces 5% de menaces seront beaucoup plus graves (le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">montant moyen des pertes de la banque du groupe buhtrap est de 143 millions</a> ) que les conséquences du spam ou des virus dont les logiciels antivirus sont sauvés. <br><br>  Presque tout le monde doit faire face à 5% des menaces.  Récemment, nous avons dû installer une solution open-source qui utilise une application du référentiel PEAR (PHP Extension and Application Repository).  Une tentative d'installation de cette application via l'installation de pear a échoué, car le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">site</a> n'était pas disponible (il y a maintenant un talon), j'ai dû l'installer depuis GitHub.  Et tout récemment, il est devenu clair que PEAR a été victime d'une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">attaque à travers la chaîne d'approvisionnement</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gv/kp/ja/gvkpjav5nqtvhmubvsavkm6n1vg.png"></div><br><br>  Vous pouvez également vous souvenir de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">attaque en utilisant CCleaner</a> , une épidémie du rançongiciel NePetya via le module de mise à jour du programme de déclaration fiscale <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MEDoc</a> .  Les menaces deviennent de plus en plus sophistiquées, et la question logique se pose - "Comment résistez-vous encore à ces 5% de menaces?" <br><br><h2>  Définition de la chasse aux menaces </h2><br>  Ainsi, la chasse aux menaces est un processus de recherche proactive et itérative et de détection des menaces avancées qui ne peuvent pas être détectées par des moyens de protection traditionnels.  Les menaces avancées comprennent, par exemple, les attaques telles que APT, les attaques sur les vulnérabilités 0 jours, Living off the Land, etc. <br><br>  On peut également reformuler que TH est un processus de test d'hypothèse.  Il s'agit principalement d'un processus manuel avec des éléments d'automatisation, dans lequel l'analyste, s'appuyant sur ses connaissances et ses qualifications, passe au crible de grandes quantités d'informations à la recherche de signes de compromis qui correspondent à l'hypothèse initialement définie de la présence d'une certaine menace.  Un trait distinctif est la variété des sources d'information. <br><br>  Il convient de noter que la chasse aux menaces n'est pas une sorte de produit logiciel ou matériel.  Ce ne sont pas des alertes qui peuvent être vues dans n'importe quelle solution.  Ce n'est pas un processus de recherche d'IOC (identificateurs de compromis).  Et ce n'est pas une sorte d'activité passive qui va sans la participation d'analystes de la sécurité de l'information.  La chasse aux menaces est avant tout un processus. <br><br><h2>  Composants de chasse aux menaces </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/528/6af/453/5286af453a0cac4b426159d8e123f8c4.png"></div><br>  Trois composantes principales de la chasse aux menaces: données, technologie, personnes. <br><br>  <b>Données (quoi?)</b> , Y compris Big Data.  Toutes sortes de flux de trafic, informations sur les APT précédemment menées, analyses, données d'activité des utilisateurs, données de réseau, informations des employés, informations sur le darknet et bien plus encore. <br><br>  <b>Technologies (comment?) Pour le</b> traitement de ces données, toutes les manières possibles de traiter ces données, y compris le Machine Learning. <br><br>  <b>Personnes (qui?) Sont</b> celles qui ont une vaste expérience dans l'analyse d'une variété d'attaques, une intuition développée et la capacité de détecter une attaque.  Ce sont généralement des analystes de la sécurité de l'information qui doivent avoir la capacité de générer des hypothèses et d'en trouver des preuves.  Ils sont le maillon principal du processus. <br><br><h2>  Modèle PARIS </h2><br>  Adam Bateman <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">décrit</a> le modèle PARIS pour le processus TH idéal.  Le nom tel qu'il fait allusion au célèbre monument de France.  Ce modèle peut être envisagé dans deux directions - au-dessus et en dessous. <br><br>  Dans le processus de recherche de menaces, en descendant dans le modèle, nous traiterons de nombreuses preuves d'activité malveillante.  Chaque preuve a une mesure de confiance - une caractéristique qui reflète le poids de cette preuve.  Il existe du «fer», preuve directe d'une activité malveillante, qui nous permet d'atteindre immédiatement le sommet de la pyramide et de créer une véritable notification d'une infection connue.  Et il y a des preuves indirectes, dont la somme peut également nous conduire au sommet de la pyramide.  Comme toujours, il y a beaucoup plus de preuves indirectes que de preuves directes, ce qui signifie qu'elles doivent être triées et analysées, des recherches supplémentaires doivent être effectuées et il est souhaitable de les automatiser. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/40c/e5d/f57/40ce5df5731f6024e785dd678c251d48.png"></div>  <i>Modèle PARIS.</i>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Source</a> <br><br>  La partie supérieure du modèle (1 et 2) est basée sur des technologies d'automatisation et diverses analyses, et la partie inférieure (3 et 4) est basée sur des personnes possédant certaines qualifications qui contrôlent le processus.  Vous pouvez considérer le modèle, se déplaçant de haut en bas, où, dans la partie supérieure du bleu, nous avons des notifications des moyens de protection traditionnels (antivirus, EDR, pare-feu, signatures) avec un degré élevé de confiance et de confiance, et ci-dessous sont des indicateurs (IOC, URL, MD5 et autres), qui ont moins confiance et nécessitent une étude plus approfondie.  Et le niveau le plus bas et le plus épais (4) est la génération d'hypothèses, la création de nouveaux scénarios du travail des remèdes traditionnels.  Ce niveau n'est pas limité aux sources d'hypothèses indiquées.  Plus le niveau est bas, plus la qualification de l'analyste est exigée. <br><br>  Il est très important que les analystes ne testent pas seulement un ensemble fini d'hypothèses prédéfinies, mais travaillent constamment à générer de nouvelles hypothèses et options pour les tester. <br><br><h2>  TH utilise le modèle de maturité </h2><br>  Dans un monde idéal, TH est un processus continu.  Mais, comme il n'y a pas de monde idéal, nous analyserons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le modèle de maturité</a> et les méthodes dans le contexte des personnes, des processus et des technologies utilisées.  Considérons un modèle de TH sphérique idéal.  Il existe 5 niveaux d'utilisation de cette technologie.  Considérez-les sur l'exemple de l'évolution d'une seule équipe d'analystes. <br><table><tbody><tr><td width="170">  <b>Niveaux de maturité</b> </td><td>  <b>Les gens</b> </td><td>  <b>Les processus</b> </td><td>  <b>La technologie</b> </td></tr><tr><td>  <b>Niveau 0</b> </td><td>  Analystes SOC </td><td>  24/7 </td><td>  Instruments traditionnels: </td></tr><tr><td>  Traditionnel </td><td>  Ensemble d'alerte </td><td>  Surveillance passive </td><td>  IDS, AV, Sandboxing, </td></tr><tr><td>  <i>Sans TH</i> </td><td>  Travailler avec des alertes </td><td></td><td>  outils d'analyse de signature, données Threat Intelligence. </td></tr><tr><td>  <b>Niveau 1</b> </td><td>  Analystes SOC </td><td>  TH unique </td><td>  EDR </td></tr><tr><td>  Expérimental </td><td>  Connaissances de base en médecine légale </td><td>  Recherche du CIO </td><td>  Couverture partielle des données des périphériques réseau </td></tr><tr><td>  <i>Expériences avec TH</i> </td><td>  Bonne connaissance des réseaux et des applications </td><td></td><td>  Application partielle </td></tr><tr><td>  <b>Niveau 2</b> </td><td>  Occupation temporaire </td><td>  Sprints </td><td>  EDR </td></tr><tr><td>  Périodique </td><td>  La connaissance moyenne de la médecine légale </td><td>  Semaine par mois </td><td>  Application complète </td></tr><tr><td>  <i>TH temporaire</i> </td><td>  Excellente connaissance des réseaux et des applications </td><td>  Th régulier </td><td>  Automatisation complète de l'utilisation des données EDR </td></tr><tr><td></td><td></td><td></td><td>  Utilisation partielle des fonctionnalités EDR avancées </td></tr><tr><td>  <b>Niveau 3</b> </td><td>  Équipe TH dédiée </td><td>  24/7 </td><td>  Capacité partielle de tester des hypothèses TH </td></tr><tr><td>  Proactif </td><td>  Excellente connaissance de la criminalistique et des logiciels malveillants </td><td>  Proactive TH </td><td>  Utilisation complète des fonctionnalités EDR avancées </td></tr><tr><td>  <i>Cas particuliers TH</i> </td><td>  Excellente connaissance de l'attaquant </td><td>  Cas particuliers TH </td><td>  Couverture complète des données des périphériques réseau </td></tr><tr><td></td><td></td><td></td><td>  Configuration personnalisée </td></tr><tr><td>  <b>Niveau 4</b> </td><td>  Équipe TH dédiée </td><td>  24/7 </td><td>  Capacité totale de tester les hypothèses TH </td></tr><tr><td>  Leader </td><td>  Excellente connaissance de la criminalistique et des logiciels malveillants </td><td>  Proactive TH </td><td>  Niveau 3, plus: </td></tr><tr><td>  <i>Utilisation de TH</i> </td><td>  Excellente connaissance de l'attaquant </td><td>  Test, automatisation et vérification des hypothèses TH </td><td>  intégration étroite des sources de données; </td></tr><tr><td></td><td>  Capacité de recherche </td><td></td><td>  développement personnalisé et utilisation d'API personnalisée. </td></tr></tbody></table>  <i>Niveaux de maturité TH par les personnes, les processus et la technologie</i> <br><br>  <b>Niveau 0:</b> traditionnel, sans utiliser TH.  Les analystes conventionnels travaillent avec un ensemble standard d'alertes en mode de surveillance passive à l'aide d'outils et de technologies standard: IDS, AV, bacs à sable, outils d'analyse de signature. <br><br>  <b>Niveau 1:</b> expérimental utilisant TH.  Les mêmes analystes possédant des connaissances de base en criminalistique et une bonne connaissance des réseaux et de l'application peuvent mettre en œuvre une chasse aux menaces ponctuelle en recherchant des indicateurs de compromis.  Des EDR avec une couverture partielle des données des périphériques réseau sont ajoutés aux outils.  Les outils sont partiellement appliqués. <br><br>  <b>Niveau 2:</b> TH intermittent, temporaire.  Les mêmes analystes qui ont déjà pompé leurs connaissances de la criminalistique, des réseaux et de la partie application sont chargés de s'engager régulièrement dans la chasse aux menaces (sprint), disons, une semaine par mois.  Les outils sont complétés par une étude complète des données des périphériques réseau, l'automatisation de l'analyse des données de l'EDR et l'utilisation partielle des fonctionnalités avancées de l'EDR. <br><br>  <b>Niveau 3: cas</b> préventifs et fréquents de TH.  Nos analystes se sont organisés en une équipe dédiée, ont commencé à avoir une excellente connaissance de la criminalistique et des logiciels malveillants, ainsi qu'une connaissance des méthodes et tactiques de la partie attaquante.  Le processus est déjà en cours 24/7.  L'équipe est en mesure de tester partiellement les hypothèses TH, en utilisant pleinement les capacités avancées d'EDR avec une couverture complète des données des périphériques réseau.  De plus, les analystes peuvent configurer des outils pour répondre à leurs besoins. <br><br>  <b>Niveau 4:</b> haut de gamme, utilisant TH.  La même équipe a acquis la capacité de recherche, la capacité de générer et d'automatiser le processus de test des hypothèses TH.  Désormais, une intégration étroite des sources de données, un développement logiciel pour les besoins et une utilisation non standard des API ont été ajoutés aux outils. <br><br><h2>  Techniques de chasse aux menaces </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/394/fbc/cf6/394fbccf6628d64624578ec61db29dda.png"></div>  <i>Techniques de base de chasse aux menaces</i> <br><br>  Les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">techniques</a> TH par ordre de maturité de la technologie utilisée comprennent: la recherche de base, l'analyse statistique, les techniques de visualisation, les agrégations simples, l'apprentissage automatique et les méthodes bayésiennes. <br><br>  La méthode la plus simple est une recherche de base, qui est utilisée pour restreindre la portée de la recherche à l'aide de requêtes spécifiques.  L'analyse statistique est utilisée, par exemple, pour créer une activité utilisateur ou réseau typique sous la forme d'un modèle statistique.  Les techniques de visualisation sont utilisées pour visualiser et simplifier l'analyse des données sous la forme de graphiques et de tableaux, ce qui facilite beaucoup la capture des modèles dans l'échantillon.  La technique d'agrégation simple pour les champs clés est utilisée pour optimiser la recherche et l'analyse.  Plus le niveau de maturité d'une organisation est atteint par le processus TH, plus l'utilisation des algorithmes d'apprentissage automatique est pertinente.  Ils sont également largement utilisés, notamment pour filtrer le spam, détecter le trafic malveillant et détecter les activités frauduleuses.  Un type plus avancé d'algorithmes d'apprentissage automatique est les méthodes bayésiennes qui permettent la classification, la réduction de la taille de l'échantillon et la modélisation thématique. <br><br><h2>  Modèle de diamant et stratégie TH </h2><br>  Sergio Caltagiron, Andrew Pendegast et Christopher Betz dans leur travail « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le modèle de diamant de l'analyse d'intrusion</a> » a montré les principaux composants clés de toute activité malveillante et la connexion de base entre eux. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/304/cde/02b/304cde02ba7997ff249797d93d2423f3.png"></div>  <i>Modèle Diamond pour les activités malveillantes</i> <br><br>  Conformément à ce modèle, il existe 4 stratégies de chasse aux menaces qui reposent sur des éléments clés pertinents. <br><br>  1. Une stratégie axée sur les victimes.  Nous supposons que la victime a des adversaires, et ils fourniront des «opportunités» par e-mail.  Nous recherchons des données ennemies par courrier.  Recherchez des liens, des pièces jointes, etc.  Nous recherchons la confirmation de cette hypothèse pour une certaine période (mois, deux semaines), si elle n'est pas trouvée, alors l'hypothèse n'a pas joué. <br><br>  2. Stratégie axée sur l'infrastructure.  Il existe plusieurs façons d'utiliser cette stratégie.  Selon l'accès et la visibilité, certains sont plus faciles que d'autres.  Par exemple, nous surveillons les serveurs de noms de domaine connus pour héberger des domaines malveillants.  Ou nous menons un processus de suivi de tous les nouveaux enregistrements de noms de domaine pour un modèle connu utilisé par l'adversaire. <br><br>  3. Stratégie orientée vers les opportunités.  En plus de la stratégie axée sur les victimes utilisée par la plupart des défenseurs du réseau, il existe une stratégie axée sur les opportunités.  Il est le deuxième plus populaire et se concentre sur la détection des capacités de l'adversaire, à savoir les «logiciels malveillants» et la capacité de l'adversaire à utiliser des outils légitimes tels que psexec, powershell, certutil et autres. <br><br>  4. Stratégie axée sur l'adversaire.  L'approche axée sur l'ennemi se concentre sur l'ennemi.  Cela comprend l'utilisation d'informations ouvertes de sources publiques (OSINT), la collecte de données sur l'ennemi, ses techniques et méthodes (TTP), l'analyse des incidents passés, les données de renseignement sur les menaces, etc. <br><br><h2>  Sources d'informations et hypothèses en TH </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/001/c47/173/001c47173ac8a4e5affead0e47869f1e.png"></div>  <i>Quelques sources d'information pour la chasse aux menaces</i> <br><br>  Il peut y avoir de nombreuses sources d'information.  L'analyste idéal devrait être capable d'extraire des informations de tout ce qui se trouve autour.  Les sources typiques dans presque toutes les infrastructures seront les données des fonctions de sécurité: DLP, SIEM, IDS / IPS, WAF / FW, EDR.  En outre, les indicateurs types d'informations seront tous les types d'indicateurs de compromis, les services Threat Intelligence, les données CERT et OSINT.  De plus, vous pouvez utiliser des informations du darknet (par exemple, soudainement, il y a un ordre de pirater la boîte aux lettres du chef de l'organisation, ou le candidat au poste d'ingénieur réseau est apparu sur son activité), des informations reçues des RH (retour d'informations sur le candidat de son emploi précédent), des informations du service de sécurité ( par exemple, les résultats de la vérification de la contrepartie). <br><br>  Mais avant d'utiliser toutes les sources disponibles, vous devez avoir au moins une hypothèse. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aea/d70/c0d/aead70c0d9eee2ac44caa2b1cc12f4e0.png"></div>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Source</a> <br><br>  Pour tester des hypothèses, elles doivent d'abord être avancées.  Et pour proposer de nombreuses hypothèses qualitatives, il est nécessaire d'appliquer une approche systématique.  Le processus de génération d'hypothèse est décrit plus en détail dans l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> ; il est très pratique de prendre ce schéma comme base pour le processus d'hypothèse. <br><br>  La principale source d'hypothèses sera la <b>matrice ATT &amp; CK</b> (Adversarial Tactics, Techniques and Common Knowledge).  Il s'agit en fait d'une base de connaissances et d'un modèle pour évaluer le comportement des attaquants réalisant leurs activités dans les dernières étapes d'une attaque, généralement décrit en utilisant le concept de Kill Chain.  C'est-à-dire, aux étapes après que l'intrus a pénétré le réseau interne de l'entreprise ou vers un appareil mobile.  Initialement, la base de connaissances comprenait une description de 121 tactiques et techniques utilisées dans l'attaque, chacune étant décrite en détail au format Wiki.  Une variété d'analyses de Threat Intelligence est bien adaptée comme source pour générer des hypothèses.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il convient de noter en particulier les résultats de l'analyse des infrastructures et des tests de pénétration - ce sont les données les plus précieuses que les hypothèses de fer peuvent nous fournir, car elles reposent sur une infrastructure spécifique avec ses lacunes spécifiques. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Processus de test d'hypothèse </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sergey Soldatov a donné un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bon diagramme</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec une description détaillée du processus; il illustre le processus de test des hypothèses TH dans un seul système. </font><font style="vertical-align: inherit;">J'indiquerai les principales étapes avec une brève description.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/431/46f/6a3/43146f6a3d7066bfc614fea87086e95b.png"></div>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Source</a> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Étape 1: TI Farm</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> À ce stade, vous devez sélectionner des </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">objets</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (en les analysant avec toutes les données sur les menaces) en leur attribuant des étiquettes de leurs caractéristiques. Il s'agit d'un fichier, URL, MD5, processus, utilitaire, événement. Leur passage dans les systèmes Threat Intelligence doit être balisé. Autrement dit, ce site a été repéré au CNC en telle ou telle année, ce MD5 a été associé à tel ou tel malware, ce MD5 a été téléchargé depuis le site Internet qui distribuait les malvars. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Étape 2: cas</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dans la deuxième étape, nous examinons l'interaction entre ces objets et identifions les relations entre tous ces objets. Nous obtenons des systèmes étiquetés qui font quelque chose de mal. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Étape 3: Analyste</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">À la troisième étape, l'affaire est transférée à un analyste expérimenté qui possède une vaste expérience en analyse, et il rend un verdict. Il analyse en octets ce que, où, comment, pourquoi et pourquoi ce code fait. Ce corps était un malware, cet ordinateur était infecté. Divulgue les connexions entre les objets, vérifie les résultats d'une exécution dans le bac à sable. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les résultats des travaux de l’analyste sont transmis. Digital Forensics examine les images, Malware Analysis examine les «corps» trouvés et l'équipe de réponse aux incidents peut se rendre sur le site et explorer quelque chose qui s'y trouve déjà. Le résultat du travail sera une hypothèse confirmée, une attaque identifiée et des moyens de la contrer.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5d1/dd8/c93/5d1dd8c937bacb4805a67795317a0b49.png"></div>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Source</a> <br><br><h2>  Résumé </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La chasse aux menaces est une technologie assez récente capable de résister efficacement aux menaces personnalisées, nouvelles et non standard, qui a de grandes perspectives compte tenu du nombre croissant de ces menaces et de la complexité de l'infrastructure de l'entreprise. Il a besoin de trois composants - données, outils et analyses. Les avantages de la chasse aux menaces ne se limitent pas à la mise en œuvre proactive des menaces. N'oubliez pas que dans le processus de recherche, nous plongeons dans notre infrastructure et ses faiblesses à travers les yeux d'un analyste de la sécurité et nous pouvons encore renforcer ces lieux. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les premières étapes qui, à notre avis, doivent être prises pour lancer le processus TH dans votre organisation.</font></font><br><br><ol><li>        .    (NetFlow)   (firewall, IDS, IPS, DLP)     .          . </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MITRE ATT&amp;CK</a> . </li><li>        ,   ,         . </li><li>   Threat Intelligence     (, MISP, Yeti)       . </li><li>      (IRP): R-Vision IRP, The Hive,      (FortiSandbox, Cuckoo). </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Automatisez les processus de routine. </font><font style="vertical-align: inherit;">L'analyse des journaux, la gestion des incidents, l'information du personnel est un immense domaine d'automatisation.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Apprenez à interagir efficacement avec les ingénieurs, les développeurs et le support technique pour collaborer sur les incidents. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Documenter l'ensemble du processus, les points clés, les résultats obtenus, pour y revenir plus tard ou partager ces données avec des collègues; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> N'oubliez pas le côté social: soyez conscient de ce qui se passe avec vos employés, que vous embauchez et qui donne accès aux ressources d'information de l'organisation. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Restez au courant des tendances dans le domaine des nouvelles menaces et méthodes de protection, augmentez votre niveau de connaissances techniques (y compris le travail des services informatiques et des sous-systèmes), assistez à des conférences et communiquez avec vos collègues. </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Prêt à discuter de l'organisation du processus TH dans les commentaires. </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ou venez nous voir pour travailler!</font></font></b> <div class="spoiler_text"><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consultant principal en sécurité</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Architecte de systèmes de sécurité de l'information</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ingénieur principal de la sécurité des réseaux</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ingénieur principal de la sécurité de l'information (SIEM)</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Architecte SI (appliqué)</font></font></a> </li></ul></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sources et matériel d'étude</font></font></b> <div class="spoiler_text"><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">threathunter.guru</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attack.mitre.org</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">digital-forensics.sans.org</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">resources.infosecinstitute.com</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.redcanary.com</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.cybereason.com</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.anti-malware.ru</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.anti-malware.ru</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reply-to-all.blogspot.com</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lukatsky.blogspot.com</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">whitepapers.theregister.co.uk</font></font></a> </li></ul></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr447580/">https://habr.com/ru/post/fr447580/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr447570/index.html">GoLand 2019.1: analyse des performances du code, Smart Step Into, refactoring Extract Interface, Nilness Analyzer et plus</a></li>
<li><a href="../fr447572/index.html">Énergie, chaleur et eau: deuxième partie</a></li>
<li><a href="../fr447574/index.html">Notes du pigiste: Développement de la première application native React</a></li>
<li><a href="../fr447576/index.html">Développement JavaScript responsable Partie 1</a></li>
<li><a href="../fr447578/index.html">Accélération de JavaScript à l'aide de la définition du type de données</a></li>
<li><a href="../fr447582/index.html">Rusatom: impression 3D de métaux en Russie</a></li>
<li><a href="../fr447584/index.html">Anatomie du "Space Data Center". Serveur céleste: regardez sous le capot</a></li>
<li><a href="../fr447586/index.html">Interpolation de chaînes avancée dans Swift 5.0</a></li>
<li><a href="../fr447588/index.html">Comment rendre l'application plus stable avec 2 types de tests unitaires</a></li>
<li><a href="../fr447592/index.html">WhatsApp dans la paume de votre main: où et comment pouvez-vous détecter les artefacts médico-légaux?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>