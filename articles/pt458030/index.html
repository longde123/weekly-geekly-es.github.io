<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî∂ üõÉ üë©üèΩ‚Äçüè≠ JavaScript funcional: cinco maneiras de encontrar a m√©dia aritm√©tica dos elementos da matriz e o m√©todo .reduce () üë®üèæ‚ÄçüöÄ „äóÔ∏è ‚òùüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Os m√©todos de itera√ß√£o de matriz s√£o semelhantes a ‚Äúiniciar drogas‚Äù (√© claro, eles n√£o s√£o drogas; e eu n√£o estou dizendo que drogas s√£o boas; s√£o ape...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>JavaScript funcional: cinco maneiras de encontrar a m√©dia aritm√©tica dos elementos da matriz e o m√©todo .reduce ()</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/458030/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Os m√©todos de itera√ß√£o de matriz s√£o</a> semelhantes a ‚Äúiniciar drogas‚Äù (√© claro, eles n√£o s√£o drogas; e eu n√£o estou dizendo que drogas s√£o boas; s√£o apenas uma figura de linguagem).  Por causa deles, muitos "se sentam" em programa√ß√£o funcional.  O fato √© que eles s√£o incrivelmente convenientes.  Al√©m disso, a maioria desses m√©todos √© muito f√°cil de entender.  M√©todos como <code>.map()</code> e <code>.filter()</code> aceitam apenas um argumento de retorno de chamada e permitem resolver problemas simples.  Mas h√° um sentimento de que o m√©todo <code>.reduce()</code> causa algumas dificuldades para muitos.  Entender isso √© um pouco mais dif√≠cil. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/zd/ig/jp/zdigjpelbgmyf4qdprvkrxo5bu4.png"></a> <br><a name="habracut"></a><br>  Eu j√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">escrevi</a> sobre por que acho que <code>.reduce()</code> cria muitos problemas.  Isso se deve em parte ao fato de muitos manuais demonstrarem o uso de <code>.reduce()</code> apenas ao manusear n√∫meros.  Portanto, escrevi sobre quantas tarefas que n√£o implicam opera√ß√µes aritm√©ticas podem ser resolvidas usando <code>.reduce()</code> .  Mas e se voc√™ absolutamente precisar trabalhar com n√∫meros? <br><br>  Um uso t√≠pico de <code>.reduce()</code> parece com um c√°lculo da m√©dia aritm√©tica dos elementos de uma matriz.  √Ä primeira vista, parece que n√£o h√° nada de especial nessa tarefa.  Mas ela n√£o √© t√£o simples.  O fato √© que, antes de calcular a m√©dia, voc√™ precisa encontrar os seguintes indicadores: <br><br><ol><li>  A quantidade total de valores do elemento da matriz. </li><li>  O comprimento da matriz. </li></ol><br>  Descobrir tudo isso √© bem simples.  E o c√°lculo dos valores m√©dios para matrizes num√©ricas tamb√©m n√£o √© uma opera√ß√£o dif√≠cil.  Aqui est√° um exemplo elementar: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">average</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">nums</span></span></span><span class="hljs-function">) </span></span>{    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> nums.reduce(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">) =&gt;</span></span> (a + b)) / nums.length; }</code> </pre> <br>  Como voc√™ pode ver, n√£o h√° incompreens√µes especiais aqui.  Mas a tarefa se torna mais dif√≠cil se voc√™ precisar trabalhar com estruturas de dados mais complexas.  E se tivermos uma matriz de objetos?  E se alguns objetos dessa matriz precisarem ser filtrados?  O que fazer se voc√™ precisar extrair certos valores num√©ricos dos objetos?  Nessa situa√ß√£o, calcular o valor m√©dio dos elementos da matriz j√° √© uma tarefa um pouco mais complicada. <br><br>  Para lidar com isso, resolveremos o problema de treinamento (√© baseado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nesta</a> tarefa com o FreeCodeCamp).  Vamos resolv√™-lo de cinco maneiras diferentes.  Cada um deles tem suas pr√≥prias vantagens e desvantagens.  Uma an√°lise dessas cinco abordagens para resolver esse problema mostra como o JavaScript pode ser flex√≠vel.  E espero que a an√°lise das solu√ß√µes d√™ a voc√™ um pensamento sobre como usar <code>.reduce()</code> em projetos reais. <br><br><h2>  <font color="#3AC1EF">Vis√£o geral da tarefa</font> </h2><br>  Suponha que tenhamos uma s√©rie de objetos que descrevem express√µes de g√≠rias vitorianas.  Voc√™ precisa filtrar as express√µes que n√£o s√£o encontradas no Google Livros (a propriedade <code>found</code> dos objetos correspondentes √© <code>false</code> ) e encontrar uma classifica√ß√£o m√©dia para a popularidade das express√µes.  Veja como esses dados podem ser (extra√≠dos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">daqui</a> ): <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> victorianSlang = [           term: <span class="hljs-string"><span class="hljs-string">'doing the bear'</span></span>,        <span class="hljs-attr"><span class="hljs-attr">found</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>,        <span class="hljs-attr"><span class="hljs-attr">popularity</span></span>: <span class="hljs-number"><span class="hljs-number">108</span></span>,    },           <span class="hljs-attr"><span class="hljs-attr">term</span></span>: <span class="hljs-string"><span class="hljs-string">'katterzem'</span></span>,        <span class="hljs-attr"><span class="hljs-attr">found</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>,        <span class="hljs-attr"><span class="hljs-attr">popularity</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>,    },           <span class="hljs-attr"><span class="hljs-attr">term</span></span>: <span class="hljs-string"><span class="hljs-string">'bone shaker'</span></span>,        <span class="hljs-attr"><span class="hljs-attr">found</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>,        <span class="hljs-attr"><span class="hljs-attr">popularity</span></span>: <span class="hljs-number"><span class="hljs-number">609</span></span>,    },           <span class="hljs-attr"><span class="hljs-attr">term</span></span>: <span class="hljs-string"><span class="hljs-string">'smothering a parrot'</span></span>,        <span class="hljs-attr"><span class="hljs-attr">found</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>,        <span class="hljs-attr"><span class="hljs-attr">popularity</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>,    },           <span class="hljs-attr"><span class="hljs-attr">term</span></span>: <span class="hljs-string"><span class="hljs-string">'damfino'</span></span>,        <span class="hljs-attr"><span class="hljs-attr">found</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>,        <span class="hljs-attr"><span class="hljs-attr">popularity</span></span>: <span class="hljs-number"><span class="hljs-number">232</span></span>,    },           <span class="hljs-attr"><span class="hljs-attr">term</span></span>: <span class="hljs-string"><span class="hljs-string">'rain napper'</span></span>,        <span class="hljs-attr"><span class="hljs-attr">found</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>,        <span class="hljs-attr"><span class="hljs-attr">popularity</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>,    },           <span class="hljs-attr"><span class="hljs-attr">term</span></span>: <span class="hljs-string"><span class="hljs-string">'donkey'</span></span>s breakfast<span class="hljs-string"><span class="hljs-string">',        found: true,        popularity: 787,    },           term: '</span></span>rational costume<span class="hljs-string"><span class="hljs-string">',        found: true,        popularity: 513,    },           term: '</span></span>mind the grease<span class="hljs-string"><span class="hljs-string">',        found: true,        popularity: 154,    }, ];</span></span></code> </pre> <br>  Considere 5 maneiras de encontrar o valor m√©dio da avalia√ß√£o da popularidade das express√µes dessa matriz. <br><br><h2>  <font color="#3AC1EF">1. Resolvendo um problema sem usar .reduce () (loop imperativo)</font> </h2><br>  Em nossa primeira abordagem para resolver o problema, o m√©todo <code>.reduce()</code> n√£o ser√° usado.  Se voc√™ nunca encontrou m√©todos para iterar matrizes antes, espero que a an√°lise deste exemplo esclare√ßa um pouco a situa√ß√£o. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> popularitySum = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> itemsFound = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> len = victorianSlang.length; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> item = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; len; i++) {    item = victorianSlang[i];    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item.found) {        popularitySum = item.popularity + popularitySum;        itemsFound = itemsFound + <span class="hljs-number"><span class="hljs-number">1</span></span>;   } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> averagePopularity = popularitySum / itemsFound; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"Average popularity:"</span></span>, averagePopularity);</code> </pre> <br>  Se voc√™ estiver familiarizado com JavaScript, entender√° facilmente este exemplo.  De fato, acontece o seguinte aqui: <br><br><ol><li>  Inicializamos as vari√°veis <code>popularitySum</code> e <code>itemsFound</code> .  A primeira vari√°vel, <code>popularitySum</code> , armazena a classifica√ß√£o geral da popularidade das express√µes.  E a segunda vari√°vel, <code>itemsFound</code> , (isso √© uma surpresa) armazena o n√∫mero de express√µes encontradas. </li><li>  Em seguida, inicializamos a constante <code>len</code> e o <code>item</code> vari√°vel, que s√£o √∫teis para n√≥s ao atravessar a matriz. </li><li>  Em um loop <code>for</code> , o contador <code>i</code> incrementado at√© que seu valor atinja o valor de √≠ndice do √∫ltimo elemento da matriz. </li><li>  Dentro do loop, pegamos o elemento da matriz que queremos explorar.  Acessamos o elemento usando a constru√ß√£o <code>victorianSlang[i]</code> . </li><li>  Ent√£o descobrimos se essa express√£o √© encontrada na cole√ß√£o de livros. </li><li>  Se uma express√£o ocorrer nos livros, pegamos o valor da sua classifica√ß√£o de popularidade e adicionamos ao valor da vari√°vel <code>popularitySum</code> . </li><li>  Ao mesmo tempo, tamb√©m aumentamos o contador das express√µes encontradas - <code>itemsFound</code> . </li><li>  E, finalmente, encontramos a m√©dia dividindo a <code>popularitySum</code> por <code>itemsFound</code> . </li></ol><br>  Ent√£o, lidamos com a tarefa.  Talvez nossa decis√£o n√£o tenha sido particularmente bonita, mas faz seu trabalho.  O uso de m√©todos para percorrer matrizes o tornar√° um pouco mais limpo.  Vamos ver se conseguimos, e a verdade √©, "limpar" essa decis√£o. <br><br><h2>  <font color="#3AC1EF">2. Solu√ß√£o simples n¬∫ 1: .filter (), .map () e localize a quantidade usando .reduce ()</font> </h2><br>  Vamos, antes da primeira tentativa de usar os m√©todos de matrizes para resolver o problema, dividimos em partes pequenas.  Ou seja, aqui est√° o que precisamos fazer: <br><br><ol><li>  Selecione objetos que representam express√µes que est√£o na cole√ß√£o do Google Livros.  Aqui voc√™ pode usar o m√©todo <code>.filter()</code> . </li><li>  Extraia dos objetos a avalia√ß√£o da popularidade das express√µes.  Para resolver essa subtarefa, o m√©todo <code>.map()</code> √© adequado. </li><li>  Calcule a soma das classifica√ß√µes.  Aqui podemos recorrer √† ajuda de nosso velho amigo <code>.reduce()</code> . </li><li>  E, finalmente, encontre o valor m√©dio das estimativas. </li></ol><br>  Aqui est√° o que parece no c√≥digo: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   // ---------------------------------------------------------------------------- function isFound(item) {    return item.found; }; function getPopularity(item) {    return item.popularity; } function addScores(runningTotal, popularity) {    return runningTotal + popularity; } //  // ---------------------------------------------------------------------------- //  ,      . const foundSlangTerms = victorianSlang.filter(isFound); //   ,   . const popularityScores = foundSlangTerms.map(getPopularity); //     .    ,    //   ,  reduce     ,  0. const scoresTotal = popularityScores.reduce(addScores, 0); //       . const averagePopularity = scoresTotal / popularityScores.length; console.log("Average popularity:", averagePopularity);</span></span></code> </pre> <br>  <code>addScore</code> olhada na fun√ß√£o <code>addScore</code> e na linha onde <code>.reduce()</code> chamado.  Observe que o <code>addScore</code> aceita dois par√¢metros.  O primeiro, <code>runningTotal</code> , √© conhecido como bateria.  Ele armazena a soma dos valores.  Seu valor muda sempre que iteramos sobre a matriz e executamos a <code>return</code> .  O segundo par√¢metro, <code>popularity</code> , √© um elemento separado da matriz que estamos processando.  No in√≠cio da <code>addScore</code> sobre a matriz, a <code>return</code> <code>addScore</code> no <code>addScore</code> nunca foi executada.  Isso significa que <code>runningTotal</code> n√£o foi definido automaticamente.  Portanto, chamando <code>.reduce()</code> , passamos para esse m√©todo o valor que precisa ser gravado em <code>runningTotal</code> no in√≠cio.  Este √© o segundo par√¢metro passado para <code>.reduce()</code> . <br><br>  Portanto, aplicamos os m√©todos de itera√ß√£o de matrizes para resolver o problema.  A nova vers√£o da solu√ß√£o acabou sendo muito mais limpa que a anterior.  Em outras palavras, a decis√£o acabou sendo mais declarativa.  N√£o informamos ao JavaScript exatamente como executar o loop; n√£o seguimos os √≠ndices dos elementos das matrizes.  Em vez disso, declaramos fun√ß√µes auxiliares simples de tamanho pequeno e as combinamos.  Todo o trabalho duro √© feito para n√≥s pelos m√©todos de matriz <code>.filter()</code> , <code>.map()</code> e <code>.reduce()</code> .  Essa abordagem para resolver esses problemas √© mais expressiva.  Esses m√©todos de matriz s√£o muito mais completos do que o loop pode fazer, eles nos informam sobre a inten√ß√£o estabelecida no c√≥digo. <br><br><h2>  <font color="#3AC1EF">3. Solu√ß√£o f√°cil # 2: Usando v√°rias baterias</font> </h2><br>  Na vers√£o anterior da solu√ß√£o, criamos um monte de vari√°veis ‚Äã‚Äãintermedi√°rias.  Por exemplo, <code>foundSlangTerms</code> e <code>popularityScores</code> .  No nosso caso, essa solu√ß√£o √© bastante aceit√°vel.  Mas e se nos definirmos uma meta mais complexa em rela√ß√£o ao design de c√≥digo?  Seria bom se pud√©ssemos usar o padr√£o de design de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">interface fluente</a> no programa.  Com essa abordagem, poder√≠amos encadear as chamadas de todas as fun√ß√µes e podermos fazer sem vari√°veis ‚Äã‚Äãintermedi√°rias.  No entanto, um problema nos espera aqui.  Observe que precisamos obter o valor de <code>popularityScores.length</code> .  Se vamos encadear tudo, precisamos de outra maneira de encontrar o n√∫mero de elementos na matriz.  O n√∫mero de elementos na matriz desempenha o papel de um divisor no c√°lculo do valor m√©dio.  Vamos ver se podemos mudar a abordagem para resolver o problema para que tudo possa ser feito combinando chamadas de m√©todo em uma cadeia.  Faremos isso rastreando dois valores ao iterar sobre os elementos da matriz, ou seja, usando a "bateria dupla". <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   // --------------------------------------------------------------------------------- function isFound(item) {    return item.found; }; function getPopularity(item) {    return item.popularity; } //    ,  return,   . function addScores({totalPopularity, itemCount}, popularity) {    return {        totalPopularity: totalPopularity + popularity,        itemCount:    itemCount + 1,    }; } //  // --------------------------------------------------------------------------------- const initialInfo  = {totalPopularity: 0, itemCount: 0}; const popularityInfo = victorianSlang.filter(isFound)    .map(getPopularity)    .reduce(addScores, initialInfo); //       . const {totalPopularity, itemCount} = popularityInfo; const averagePopularity = totalPopularity / itemCount; console.log("Average popularity:", averagePopularity);</span></span></code> </pre> <br>  Aqui, para trabalhar com dois valores, usamos o objeto na fun√ß√£o redutora.  Cada passagem pela matriz realizada usando <code>addScrores</code> , atualizamos o valor total da classifica√ß√£o de popularidade e o n√∫mero de elementos.  √â importante observar que esses dois valores s√£o representados como um √∫nico objeto.  Com essa abordagem, podemos "enganar" o sistema e armazenar duas entidades dentro do mesmo valor de retorno. <br><br>  A fun√ß√£o <code>addScrores</code> sendo um pouco mais complicada do que a fun√ß√£o com o mesmo nome no exemplo anterior.  Agora, por√©m, podemos usar uma √∫nica cadeia de chamadas de m√©todo para executar todas as opera√ß√µes com a matriz.  Como resultado do processamento da matriz, obtemos o objeto <code>popularityInfo</code> , que armazena tudo o que voc√™ precisa para encontrar a m√©dia.  Isso torna a cadeia de chamadas organizada e simples. <br><br>  Se voc√™ deseja melhorar esse c√≥digo, pode experimentar.  Por exemplo - voc√™ pode refaz√™-lo para se livrar de muitas vari√°veis ‚Äã‚Äãintermedi√°rias.  Voc√™ pode at√© tentar colocar esse c√≥digo em uma linha. <br><br><h2>  <font color="#3AC1EF">4. Composi√ß√£o de fun√ß√µes sem usar nota√ß√£o de ponto</font> </h2><br>  Se voc√™ n√£o conhece a programa√ß√£o funcional ou se parece que a programa√ß√£o funcional √© muito complicada, pode pular esta se√ß√£o.  Analis√°-lo o beneficiar√° se voc√™ j√° estiver familiarizado com <code>curry()</code> e <code>compose()</code> .  Se voc√™ quiser se aprofundar neste t√≥pico, d√™ uma olhada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">neste</a> material sobre programa√ß√£o funcional em JavaScript e, em particular, na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">terceira</a> parte da s√©rie em que est√° inclu√≠do. <br><br>  Somos programadores que adotam uma abordagem funcional.  Isso significa que nos esfor√ßamos para criar fun√ß√µes complexas a partir de outras fun√ß√µes - pequenas e simples.  At√© o momento, ao considerar v√°rias op√ß√µes para resolver o problema, reduzimos o n√∫mero de vari√°veis ‚Äã‚Äãintermedi√°rias.  Como resultado, o c√≥digo da solu√ß√£o tornou-se mais simples e f√°cil.  Mas e se essa id√©ia for levada ao extremo?  E se voc√™ tentar se livrar de todas as vari√°veis ‚Äã‚Äãintermedi√°rias?  E at√© tentar fugir de alguns par√¢metros? <br><br>  Voc√™ pode criar uma fun√ß√£o para calcular a m√©dia usando a fun√ß√£o <code>compose()</code> sozinha, sem usar vari√°veis.  Chamamos isso de ‚Äúprograma√ß√£o sem o uso de nota√ß√£o refinada‚Äù ou ‚Äúprograma√ß√£o impl√≠cita‚Äù.  Para escrever esses programas, voc√™ precisar√° de muitas fun√ß√µes auxiliares. <br><br>  √Äs vezes, esse c√≥digo choca as pessoas.  Isso se deve ao fato de que tal abordagem √© muito diferente da geralmente aceita.  Mas descobri que escrever c√≥digo no estilo de programa√ß√£o impl√≠cita √© uma das maneiras mais r√°pidas de entender a ess√™ncia da programa√ß√£o funcional.  Portanto, posso aconselh√°-lo a tentar esta t√©cnica em algum projeto pessoal.  Mas quero dizer que talvez voc√™ n√£o deva escrever no estilo de programa√ß√£o impl√≠cita o c√≥digo que outras pessoas precisam ler. <br><br>  Ent√£o, voltando √† nossa tarefa de construir um sistema para calcular m√©dias.  Por uma quest√£o de economia de espa√ßo, passaremos aqui para o uso das fun√ß√µes de seta.  Geralmente, como regra, √© melhor usar fun√ß√µes nomeadas.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui est√° um</a> bom artigo sobre este t√≥pico.  Isso permite que voc√™ obtenha melhores resultados de rastreamento de pilha em caso de erros. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   // ---------------------------------------------------------------------------- const filter = p =&gt; a =&gt; a.filter(p); const map   = f =&gt; a =&gt; a.map(f); const prop  = k =&gt; x =&gt; x[k]; const reduce = r =&gt; i =&gt; a =&gt; a.reduce(r, i); const compose = (...fns) =&gt; (arg) =&gt; fns.reduceRight((arg, fn) =&gt; fn(arg), arg); //  -   "blackbird combinator". //     : https://jrsinclair.com/articles/2019/compose-js-functions-multiple-parameters/ const B1 = f =&gt; g =&gt; h =&gt; x =&gt; f(g(x))(h(x)); //  // ---------------------------------------------------------------------------- //   sum,    . const sum = reduce((a, i) =&gt; a + i)(0); //     . const length = a =&gt; a.length; //       . const div = a =&gt; b =&gt; a / b; //   compose()        . //    compose()     . const calcPopularity = compose(    B1(div)(sum)(length),    map(prop('popularity')),    filter(prop('found')), ); const averagePopularity = calcPopularity(victorianSlang); console.log("Average popularity:", averagePopularity);</span></span></code> </pre> <br>  Se todo esse c√≥digo lhe parecer absurdo - n√£o se preocupe.  Inclu√≠ aqui como um exerc√≠cio intelectual, e n√£o para incomod√°-lo. <br><br>  Nesse caso, o trabalho principal est√° na fun√ß√£o <code>compose()</code> .  Se voc√™ ler o conte√∫do de baixo para cima, os c√°lculos come√ßam filtrando a matriz pela propriedade de seus elementos <code>found</code> .  Em seguida, recuperamos a propriedade do elemento <code>popularity</code> usando <code>map()</code> .  Depois disso, usamos o chamado ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">combinador de melro</a> ‚Äù.  Essa entidade √© representada como uma fun√ß√£o <code>B1</code> , que √© usada para executar duas passagens de c√°lculos em um conjunto de dados de entrada.  Para entender melhor isso, d√™ uma olhada nestes exemplos: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   ,  , : const avg1 = B1(div)(sum)(length); const avg2 = arr =&gt; div(sum(arr))(length(arr)); const avg3 = arr =&gt; ( sum(arr) / length(arr) ); const avg4 = arr =&gt; arr.reduce((a, x) =&gt; a + x, 0) / arr.length;</span></span></code> </pre> <br>  Novamente, se voc√™ n√£o entender nada de novo - n√£o se preocupe.  Esta √© apenas uma demonstra√ß√£o de que o JavaScript pode ser escrito de maneiras muito diferentes.  Dessas caracter√≠sticas, essa √© a beleza desse idioma. <br><br><h2>  <font color="#3AC1EF">5. Resolvendo o problema de uma s√≥ vez com o c√°lculo do valor m√©dio acumulado</font> </h2><br>  Todas as constru√ß√µes de software acima fazem um bom trabalho para resolver nosso problema (incluindo o ciclo imperativo).  Aqueles que usam o m√©todo <code>.reduce()</code> t√™m algo em comum.  Eles s√£o baseados em dividir o problema em pequenos fragmentos.  Esses fragmentos s√£o ent√£o montados de v√°rias maneiras.  Ao analisar essas solu√ß√µes, voc√™ pode perceber que nelas contornamos o array tr√™s vezes.  H√° um sentimento de que √© ineficaz.  Seria bom se houvesse uma maneira de processar a matriz e retornar o resultado em uma √∫nica passagem.  Este m√©todo existe, mas sua aplica√ß√£o exigir√° o recurso √† matem√°tica. <br><br>  Para calcular o valor m√©dio dos elementos da matriz em uma passagem, precisamos de um novo m√©todo.  Voc√™ precisa encontrar uma maneira de calcular a m√©dia usando a m√©dia calculada anteriormente e o novo valor.  Procuramos esse m√©todo usando √°lgebra. <br><br>  O valor m√©dio de <code>n</code> n√∫meros pode ser encontrado usando esta f√≥rmula: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ea8/922/a8a/ea8922a8ad59e55aa604bf01c72b55e4.png"></div><br>  Para descobrir os n√∫meros <code>n + 1</code> m√©dios, a mesma f√≥rmula serve, mas em uma entrada diferente: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/77c/ee8/a1f/77cee8a1fe717b88a55b2f2af6f222e2.png"></div><br>  Esta f√≥rmula √© a mesma que esta: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/651/b3a/0ca/651b3a0caa501b140e23cbce68a96720.png"></div><br>  E a mesma coisa que isso: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f7b/e1b/da4/f7be1bda4b12343eee3dde51d80f95c0.png"></div><br>  Se voc√™ converter um pouco, obter√° o seguinte: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/038/165/1b5/0381651b520c5136458129c1882a44af.png"></div><br>  Se voc√™ n√£o v√™ o ponto disso tudo, tudo bem.  O resultado de todas essas transforma√ß√µes √© que, com a ajuda da √∫ltima f√≥rmula, podemos calcular o valor m√©dio durante uma √∫nica travessia da matriz.  Para isso, √© necess√°rio conhecer o valor do elemento atual, o valor m√©dio calculado na etapa anterior e o n√∫mero de elementos.  Al√©m disso, a maioria dos c√°lculos pode ser realizada na fun√ß√£o redutora: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//      // ---------------------------------------------------------------------------- function averageScores({avg, n}, slangTermInfo) {    if (!slangTermInfo.found) {        return {avg, n};       return {        avg: (slangTermInfo.popularity + n * avg) / (n + 1),        n:  n + 1,    }; } //  // ---------------------------------------------------------------------------- //       . const initialVals    = {avg: 0, n: 0}; const averagePopularity = victorianSlang.reduce(averageScores, initialVals).avg; console.log("Average popularity:", averagePopularity);</span></span></code> </pre> <br>  Gra√ßas a essa abordagem, o valor necess√°rio pode ser encontrado ignorando a matriz apenas uma vez.  Outras abordagens usam uma passagem para filtrar a matriz, outra para extrair os dados necess√°rios e outra para encontrar a soma dos valores dos elementos.  Aqui, tudo se encaixa em uma passagem pela matriz. <br><br>  Observe que isso n√£o necessariamente torna os c√°lculos mais eficientes.  Com essa abordagem, mais c√°lculos precisam ser feitos.  Quando cada novo valor chega, realizamos as opera√ß√µes de multiplica√ß√£o e divis√£o, fazendo isso para manter o valor m√©dio atual no estado atual.  Em outras solu√ß√µes para esse problema, dividimos um n√∫mero em outro apenas uma vez - no final do programa.  Mas essa abordagem √© muito mais eficiente em termos de uso de mem√≥ria.  Matrizes intermedi√°rias n√£o s√£o usadas aqui, como resultado, temos que armazenar na mem√≥ria apenas um objeto com dois valores. <br><br>         .        .     ,     .   .  ,   ,      . <br><br><h2> <font color="#3AC1EF"> ?</font> </h2><br>              ?   ,     . ,    -  . , ,      ,       .         ,       .       ,           .          ,      ,       . <br><br> ,  -     ,           .       ,         ?   .      .  ‚Äî   . <br><br><h2> <font color="#3AC1EF"></font> </h2><br>         : <br><br><ol><li>   <code>.reduce()</code> . </li><li>    <code>.filter()</code>  <code>.map()</code> ,   ‚Äî  <code>.reduce()</code>       . </li><li>   ,      . </li><li>     . </li><li>         . </li></ol><br>  , -,     ?    ‚Äî  .      -  ‚Äî     ,          : <br><br><ol><li>    ,     .      ‚Äî   . </li><li>    ,    ,    ‚Äî     . </li><li> , ,        ‚Äî   ,     . </li></ol><br> <b> !</b>        JavaScript-? <br><br><div style="text-align:center;"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/a09/9e4/5a8/a099e45a81c9dafd3a3673edd5ea415b.jpg"></a> </div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt458030/">https://habr.com/ru/post/pt458030/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt458014/index.html">Rob√¥ FEDOR - treinando com a nova equipe da ISS e as primeiras tarefas espaciais</a></li>
<li><a href="../pt458018/index.html">compositor vs npm: desenvolvimento de m√∫ltiplos m√≥dulos</a></li>
<li><a href="../pt458020/index.html">Resumo dos eventos de TI de julho</a></li>
<li><a href="../pt458022/index.html">Impress√£o digital atrav√©s de banners? Agora isso √© comum</a></li>
<li><a href="../pt458026/index.html">Compara√ß√£o de formatos de serializa√ß√£o</a></li>
<li><a href="../pt458040/index.html">De Moscou para Tomsk. A hist√≥ria de um movimento</a></li>
<li><a href="../pt458042/index.html">Como organizei o treinamento de aprendizado de m√°quina na NSU</a></li>
<li><a href="../pt458044/index.html">Seguran√ßa provincial da informa√ß√£o - estagna√ß√£o ou desenvolvimento?</a></li>
<li><a href="../pt458046/index.html">Folha de dicas de Gradle</a></li>
<li><a href="../pt458048/index.html">Delega√ß√£o como ferramenta de gerente</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>