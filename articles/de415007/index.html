<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí• üëÇüèª üë©üèΩ‚Äçü§ù‚Äçüë®üèø So richten Sie Bluetooth unter Linux auf komplizierte Weise ein üà∏ üêä üòÅ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In Vorbereitung auf das j√§hrliche IT-Forum kam die Idee auf, einen einfachen Manipulator zu entwickeln, der von einem drahtlosen Gamepad gesteuert wir...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So richten Sie Bluetooth unter Linux auf komplizierte Weise ein</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415007/"><p><img src="https://habrastorage.org/webt/wq/9u/sv/wq9usvb7w6-8_c5p_dhrrkom_qa.jpeg"></p><br><p> In Vorbereitung auf das j√§hrliche IT-Forum kam die Idee auf, einen einfachen Manipulator zu entwickeln, der von einem drahtlosen Gamepad gesteuert wird, um die Funktionen von Mikrocontrollern und Single-Board-Computern zu demonstrieren.  Zur Hand waren ein TRIC-Controller, mehrere Servomotoren, ein Eisenkonstrukteur und ein Monat vor dem Start des Forums. </p><br><p>  ‚ÄûAlles l√§uft nach Plan‚Äú, aber in diesem Fall nicht. </p><a name="habracut"></a><br><h1 id="etap-1-podgotovka">  Stufe 1. Vorbereitung </h1><br><p>  TRIC an Bord von Linux war eine Pleite f√ºr einen solchen Manipulator, aber "die Sache ist banale Benutzerfreundlichkeit und Wartung" ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">ClusterM-</a> Zitat √ºber Linux in einer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">intelligenten Gegensprechanlage</a> ). </p><br><p>  Nach dem Lesen der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Spezifikation</a> wurde festgestellt, dass es Bluetooth hat.  Wenn Sie mit diesem Controller gearbeitet haben, wissen Sie, dass die √úbertragung von Programmen √ºber WLAN erfolgt und es keine anderen bequemen M√∂glichkeiten gibt, mit ihm zu kommunizieren.  Bluetooth wird im Men√º nicht erw√§hnt.  Aber wie so? </p><br><p>  Mit SSH, einem Schraubenzieher und Neugierde bewaffnet, begann ich nach Bluetooth zu suchen.  Das System umfasste hcitool, hciconfig und den Bluetoothd-Daemon.  Alle sagten, er sei nicht da. </p><br><pre><code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hcitool dev Devices:</span></span></code> </pre> <br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hciconfig hci0 Can't get device info: No such device</span></span></code> </pre> <br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># bluetoothd -n &amp; [1] 5449 root@trik-7dda93:~# bluetoothd[5449]: Bluetooth daemon 4.101 bluetoothd[5449]: Starting SDP server bluetoothd[5449]: Bluetooth Management interface initialized</span></span></code> </pre> <br><p>  Ich rief Freunde auf der Suche nach einem externen USB-Modul an und suchte weiter. </p><br><p>  Nach dem Zerlegen des Controllers wurde das Modul Jorjin WG7311-0A gefunden.  Die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Spezifikation</a> besagt, dass es wirklich Wi-Fi, Bluetooth und sogar ein FM-Radio gibt.  Die Schnittstelle f√ºr die Kommunikation mit Bluetooth ist UART und wird √ºber BT_EN eingeschaltet. </p><br><p><img src="https://habrastorage.org/webt/de/5d/qh/de5dqhz_nocaef_cwt0fh_d5umc.jpeg"></p><br><p>  Nachdem ich gelesen hatte, wie das Bluetooth-Modul √ºber UART √ºber hcitool verbunden ist, versuchte ich mein Gl√ºck und nichts.  Zwei der drei freien UART-Ports waren stumm. </p><br><p>  Aber wir haben Kontakt BT_EN!  M√∂glicherweise wird das Modul einfach ausgeschaltet und reagiert nicht auf Anfragen.  Nach der Untersuchung des Linux-Kernelger√§ts auf ARM-Ger√§te wurde eine Datei gefunden, in der alle von SoC verwendeten Kontakte registriert sind.  Durch √ñffnen von <code>arch/arm/mach-davinci/board-da850-trik.c</code> im Kernel-Quellcode wurde tats√§chlich ein GPIO-Kontakt f√ºr Bluetooth gefunden.  Sieg!  Dachte ich. </p><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> da850_trik_bluetooth_pins[] __initconst = { DA850_GPIO6_11, <span class="hljs-comment"><span class="hljs-comment">/*BT_EN_33 */</span></span> DA850_GPIO6_10, <span class="hljs-comment"><span class="hljs-comment">/*BT_WU_33*/</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span> };</code> </pre> <br><h1 id="etap-2-nastuplenie">  Stufe 2. Offensive </h1><br><p>  Um einen Kontakt √ºber GPIO zu aktivieren, m√ºssen Sie die End-to-End-Seriennummer ermitteln.  Wir finden die folgende Zeile im Kernel-Code mit der Aufforderung, den BT_EN_33-Kontakt in <code>arch/arm/mach-davinci/board-da850-trik.c</code> : </p><br><pre> <code class="hljs lisp">ret = gpio_request_one(<span class="hljs-name"><span class="hljs-name">GPIO_TO_PIN</span></span>(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>), GPIOF_OUT_INIT_LOW, <span class="hljs-string"><span class="hljs-string">"BT_EN_33"</span></span>)<span class="hljs-comment"><span class="hljs-comment">;</span></span></code> </pre> <br><p>  Es verwendet das Makro GPIO_TO_PIN.  Siehe die <code>arch/arm/mach-davinci/include/mach/gpio-davinci.h</code> in <code>arch/arm/mach-davinci/include/mach/gpio-davinci.h</code> : </p><br><pre> <code class="hljs cs"><span class="hljs-comment"><span class="hljs-comment">/* Convert GPIO signal to GPIO pin number */</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GPIO_TO_PIN(bank, gpio) (16 * (bank) + (gpio))</span></span></code> </pre> <br><p>  Mit ihm finden Sie die End-to-End-Kontaktnummer.  Wir erhalten diese 16 * 6 + 11 = 107. Nun wenden wir uns der Einbeziehung des Kontakts zu. </p><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> 1 &gt;&gt; /sys/devices/virtual/gpio/gpio107/value</code> </pre> <br><p>  0 oder 1 im Echo-Befehl ist der Status des Kontakts. </p><br><p>  F√ºhren Sie den Befehl zum Verbinden und ... </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hciattach /dev/ttyS0 texas Found a Texas Instruments' chip! Firmware file : /lib/firmware/TIInit_7.6.15.bts can't open firmware file: No such file or directory Warning: cannot find BTS file: /lib/firmware/TIInit_7.6.15.bts Device setup complete</span></span></code> </pre> <br><p>  f√ºr uns (im Moment) unverst√§ndliche Fehlermeldungen.  Wir versuchen das Ger√§t √ºber hcitool zu konfigurieren: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hcitool dev Devices:</span></span></code> </pre> <br><p>  Es gibt keine Ger√§te, obwohl die Initialisierung angeblich bestanden hat.  Wir versuchen ein zweites Mal eine Verbindung herzustellen, jedoch mit einem anderen Adaptertyp: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hciattach /dev/ttyS0 texasalt Texas module LMP version : 0x06 Texas module LMP sub-version : 0x1f0f internal version freeze: 15 software version: 6 chip: wl1271 (7) Opening firmware file: /etc/firmware/wl1271.bin Could not open firmware file /etc/firmware/wl1271.bin: No such file or directory (2). Device setup complete</span></span></code> </pre> <br><p>  Und wieder nichts.  Kehren wir zum ersten Fehler zur√ºck und wenden die Englischkenntnisse an: </p><br><pre> <code class="bash hljs">Warning: cannot find BTS file: /lib/firmware/TIInit_7.6.15.bts</code> </pre> <br><p>  Wir √∂ffnen den Ordner / lib / firmware mit Firmware und finden die ben√∂tigte Datei nicht.  Nach einer langen Suche im Internet finden wir die gew√ºnschte Datei <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">im TI-Repository</a> und laden sie herunter.  Andere Versionen derselben Datei haben sich geweigert zu funktionieren. </p><br><pre> <code class="bash hljs">curl -k https://git.ti.com/wilink8-bt/ti-bt-firmware/blobs/raw/45897a170bc30afb841b1491642e774f0c89b584/TIInit_7.6.15.bts &gt; TIInit_7.6.15.bts cp TIInit_7.6.15.bts /lib/firmware/TIInit_7.6.15.bts</code> </pre> <br><p>  Wir starten den Controller neu und stellen die Verbindung wieder her: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># echo 1 &gt;&gt; /sys/devices/virtual/gpio/gpio107/value root@trik-7dda93:~# hciattach /dev/ttyS0 texas Found a Texas Instruments' chip! Firmware file : /lib/firmware/TIInit_7.6.15.bts Loaded BTS script version 1 Device setup complete</span></span></code> </pre> <br><p>  Hurra!  Die Firmware wurde gestartet.  √úberpr√ºfen von hciconfig: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hciconfig hci0: Type: BR/EDR Bus: UART BD Address: 78:**:**:**:**:B3 ACL MTU: 1021:4 SCO MTU: 180:4 DOWN RX bytes:509 acl:0 sco:0 events:21 errors:0 TX bytes:388 acl:0 sco:0 commands:21 errors:0</span></span></code> </pre> <br><p>  Wir starten den Bluetooth-Dienst, suchen nach Ger√§ten und erkennen unser Modul: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># bluetoothd -n &amp; [1] 4689 bluetoothd[4689]: Bluetooth daemon 4.101 bluetoothd[4689]: Starting SDP server bluetoothd[4689]: Bluetooth Management interface initialized bluetoothd[4689]: Parsing /etc/bluetooth/serial.conf failed: No such file or directory bluetoothd[4689]: Could not get the contents of DMI chassis type bluetoothd[4689]: Adapter /org/bluez/4689/hci0 has been enabled root@trik-7dda93:~# hciconfig hci0 piscan</span></span></code> </pre> <br><p>  Eine Computersuche findet ein Ger√§t: </p><br><p><img src="https://habrastorage.org/webt/vs/bz/mb/vsbzmb32vz8tbechhhpuroku9qs.png"></p><br><p>  Um Bluetooth zu aktivieren, k√∂nnen Sie ein Skript erstellen: </p><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash case "$1" in start) echo 1 &gt;&gt; /sys/devices/virtual/gpio/gpio107/value bluetoothd -n &amp; hciattach /dev/ttyS0 texas hciconfig hci0 piscan ;; stop) ;; restart) ;; status) ;; *) ;;</span></span></code> </pre> <br><p>  Und f√ºge es zu autorun hinzu: </p><br><pre> <code class="bash hljs">cp init-bluetooth /etc/init.d/init-bluetooth update-rc.d init-bluetooth <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> 99</code> </pre> <br><p>  Das Neustarten und Herunterfahren des Moduls verh√§lt sich unvorhersehbar, daher haben die Stopp- und Neustartoptionen keine Befehle. </p><br><h1 id="etap-3-proverka-svyazi">  Stufe 3. Kommunikationspr√ºfung </h1><br><p>  Der einfachste Weg, die Kommunikation in beide Richtungen zu √ºberpr√ºfen, ist der COM-Port-Dienst.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schalten Sie</a> es mit ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">paar Befehlen ein</a> : </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># sdptool add --channel=3 SP Serial Port service registered root@trik-7dda93:~# mknod -m 666 /dev/rfcomm0 c 216 0 root@trik-7dda93:~# rfcomm watch /dev/rfcomm0 3 /sbin/getty rfcomm0 115200 linux Waiting for connection on channel 3</span></span></code> </pre> <br><p>  Wir verbinden uns √ºber das Telefon und sehen eine Einladung zum Betreten des Systems: </p><br><p><img src="https://habrastorage.org/webt/0i/lw/p9/0ilwp9kassasp_xfmvc3xhcwvl8.png"></p><br><p>  Keines der getesteten Terminals durfte ein leeres Benutzerkennwort eingeben, daher musste ich in einer SSH-Sitzung Anmeldeinformationen mithilfe der Thread-Umleitung senden. </p><br><h1 id="etap-4-configure--make">  Stufe 4. ./configure &amp;&amp; make </h1><br><p>  Wenn Sie den Anweisungen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zum Anschlie√üen eines Gamepads an Linux</a> folgen, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">treten</a> die folgenden Probleme auf: </p><br><ul><li>  BlueZ in der Distribution ist veraltet und versteht die Befehle des Sixad-Daemons nicht, wodurch eine Verbindung zum Gamepad hergestellt wird </li><li>  Die neue BlueZ-Version aus dem Quellcode kann aufgrund vieler Abh√§ngigkeiten nicht kompiliert werden </li><li>  F√ºr BlueZ von Fresh Debian sind udev und systemd erforderlich, die in der aktuellen Distribution fehlen </li></ul><br><p>  Die einzige Abh√§ngigkeit, die erf√ºllt werden konnte, war das uinput-Kernelmodul. </p><br><p>  Daf√ºr: </p><br><ul><li>  Rufen Sie die Konfiguration des aktuellen Kernels auf dem Ger√§t ab </li></ul><br><pre> <code class="bash hljs">cp /proc/config.gz config.gz gunzip config.gz</code> </pre> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kernel-Code</a> herunterladen </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Toolchain</a> herunterladen und installieren </li><li>  Kopieren Sie die Kernelkonfiguration in den Ordner mit dem Kernelcode </li><li>  F√ºgen Sie das uinput-Modul zur Konfiguration hinzu </li></ul><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"CONFIG_INPUT_UINPUT=m"</span></span> &gt;&gt; config</code> </pre> <br><ul><li>  Starten Sie die Montage, indem Sie zuerst die Toolchain einschalten </li></ul><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">source</span></span> /opt/trik-sdk/environment-setup-arm926ejste-oe-linux-gnueabi make</code> </pre> <br><ul><li>  Kopieren Sie die Kernelmodule auf die Speicherkarte </li></ul><br><pre> <code class="bash hljs">make INSTALL_MOD_PATH=/mnt/trik-sd modules_install</code> </pre> <br><ul><li>  Erstellen Sie das uBoot-Image und kopieren Sie es nach / boot </li></ul><br><pre> <code class="bash hljs">make uImage cp arch/arm/boot/uImage /mnt/trik-sd/boot/uImage-3.6.7</code> </pre> <br><p>  Jetzt schw√∂rt das Programm nicht auf das Fehlen eines Kernelmoduls, aber dann k√∂nnen wir nichts tun.  Anweisungen f√ºr das Gamepad werden sp√§ter n√ºtzlich sein. </p><br><h1 id="etap-5-varim-kashu-iz-topora">  Stufe 5. Brei aus der Axt kochen </h1><br><p>  Kommen zum Plan "Tyap-Blooper".  Da es keine bequeme M√∂glichkeit gibt, die erforderlichen Programme in die urspr√ºngliche Distribution aufzunehmen, werden wir etwas Popul√§res einf√ºgen.  Der Prozessor verf√ºgt √ºber eine ARMv5TE-Architektur, dh es gibt Verteilungen daf√ºr. </p><br><p>  Wir versuchen, Universal Arch Linux f√ºr ARM zu entpacken und auszuf√ºhren. Beim Laden in die Konsole stellen wir fest, dass systemd eine neuere Kernelversion ben√∂tigt, die wir nicht haben.  Versuche, den 4.16-Kernel zu √ºbertragen, waren erfolglos und es dauerte zu lange. </p><br><p>  Wir gehen zu einer anderen Option √ºber - Debian.  Ein Disk-Image mit einem installierten System f√ºr ARM ist vorhanden. Es ist jedoch besser, ein sauberes System mit den f√ºr uns erforderlichen Paketen und Einstellungen zu erstellen. </p><br><h2 id="ustanovka-v-qemu">  Installation in QEMU </h2><br><p>  Laden Sie das Installationsimage (Link zu <a href="">.iso</a> ) herunter und installieren Sie QEMU. <br>  Wir ben√∂tigen auch den Kernel und das initrd-Image, um die Installation zu starten, die hier heruntergeladen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werden kann</a> . </p><br><p>  Erstellen Sie ein Image einer Speicherkarte mit der Gr√∂√üe einer echten Speicherkarte (in diesem Fall 4 GB): </p><br><pre> <code class="bash hljs">qemu-img create -f raw debian.img 4G</code> </pre> <br><p>  Wir starten die Installation: </p><br><pre> <code class="bash hljs">qemu-system-arm -M versatilepb -kernel vmlinuz-3.2.0-4-versatile -initrd initrd.gz -hda debian.img -cdrom debian-7.11.0-armel-CD-1.iso</code> </pre> <br><p>  Wenn Sie ein Festplattenlayout f√ºr eine nicht standardm√§√üige relative Originaldistribution erstellen m√∂chten, lassen Sie zuerst die Root-Partition, andernfalls m√ºssen Sie die Kernel-Boot-Parameter in uBoot √§ndern.  Es gibt die Nummer der Partition, auf der sich das Root-Dateisystem befindet. </p><br><p>  Standard-Markup enth√§lt: </p><br><ol><li>  EXT4-Partition f√ºr ‚âà 1,3 GB Root-Dateisystem </li><li>  FAT32-Partition zum Speichern von Benutzerdaten ‚âà 500 MB gro√ü </li></ol><br><p>  Die fdisk-Ausgabe f√ºr das Image der Originaldistribution: </p><br><pre> <code class="hljs powershell">Disk: trik<span class="hljs-literal"><span class="hljs-literal">-distro</span></span>.img geometry: <span class="hljs-number"><span class="hljs-number">893</span></span>/<span class="hljs-number"><span class="hljs-number">64</span></span>/<span class="hljs-number"><span class="hljs-number">63</span></span> [<span class="hljs-number"><span class="hljs-number">3604478</span></span> <span class="hljs-type"><span class="hljs-type">sectors</span></span>] Signature: <span class="hljs-number"><span class="hljs-number">0</span></span>xAA55 Starting Ending <span class="hljs-comment"><span class="hljs-comment">#: id cyl hd sec - cyl hd sec [ start - size] ------------------------------------------------------------------------ 1: 83 1023 3 32 - 1023 3 32 [ 1040382 - 2564096] Linux files* 2: 0C 64 0 1 - 1023 3 32 [ 8192 - 1032190] Win95 FAT32L 3: 00 0 0 0 - 0 0 0 [ 0 - 0] unused 4: 00 0 0 0 - 0 0 0 [ 0 - 0] unused</span></span></code> </pre><br><p>  Nachdem wir die Parameter eingestellt haben, lassen wir ein paar Tassen Tee trinken, weil  Der Emulator ist nicht viel schneller als ein echter ARM-Prozessor. </p><br><p>  Um das installierte System zu starten, ben√∂tigen Sie ein weiteres initrd-Image, das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">von hier aus aufgenommen werden kann</a> . </p><br><p>  Wir starten das System: </p><br><pre> <code class="bash hljs">qemu-system-arm -M versatilepb -kernel vmlinuz-3.2.0-4-versatile -initrd initrd.img-3.2.0-4-versatile -hda debian.img -append <span class="hljs-string"><span class="hljs-string">"root=/dev/sda1"</span></span></code> </pre> <br><h2 id="nastroyka-sistemy">  Systemeinrichtung </h2><br><p>  Nach dem Start rufen wir den Superuser auf, √ºberpr√ºfen die Verbindung zum Internet, aktualisieren die Repositorys und das System und geben die Mindestanzahl an Programmen ein: </p><br><pre> <code class="bash hljs">apt-get update apt-get upgrade apt-get install curl git mc htop joystick</code> </pre> <br><h3 id="terminaly">  Terminals </h3><br><p>  Wir bearbeiten <code>/etc/inittab</code> , entfernen unn√∂tige Terminals, schalten den f√ºr uns ben√∂tigten UART ein und f√ºgen automatische Eingaben f√ºr den richtigen Benutzer hinzu (verwenden Sie root nur beim Debuggen).  Die automatische Eingabe ist n√ºtzlich, wenn Sie die Shell zur Steuerung auf dem Controller ausf√ºhren m√∂chten. </p><br><pre> <code class="hljs ruby"><span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">2345</span></span><span class="hljs-symbol"><span class="hljs-symbol">:respawn</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/sbin/getty</span></span> <span class="hljs-number"><span class="hljs-number">38400</span></span> tty1 --autologin root <span class="hljs-comment"><span class="hljs-comment">#2:23:respawn:/sbin/getty 38400 tty2 #3:23:respawn:/sbin/getty 38400 tty3 #4:23:respawn:/sbin/getty 38400 tty4 #5:23:respawn:/sbin/getty 38400 tty5 #6:23:respawn:/sbin/getty 38400 tty6 uart:12345:respawn:/sbin/getty -L 115200 ttyS1</span></span></code> </pre> <br><h3 id="bluetooth-i-wi-fi">  Bluetooth und WiFi </h3><br><p>  Installieren Sie bluez-utils und wpasupplicant, um auf Wi-Fi und Bluetooth zuzugreifen. </p><br><pre> <code class="bash hljs">apt-get install bluez-utils wpasupplicant</code> </pre> <br><p>  Wir deaktivieren die eth0-Schnittstelle und konfigurieren die wlan1-Schnittstelle in <code>/etc/network/interfaces</code> : </p><br><pre> <code class="hljs kotlin"># /etc/network/interfaces -- configuration file <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ifup(<span class="hljs-number"><span class="hljs-number">8</span></span>), ifdown(<span class="hljs-number"><span class="hljs-number">8</span></span>) # The loopback <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">auto</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lo</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">iface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lo</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">inet</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loopback</span></span></span><span class="hljs-class"> # </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Wireless</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">interfaces</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">auto</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wlan1</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">iface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wlan1</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">inet</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dhcp</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wireless_mode</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">managed</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wireless_essid</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">any</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wpa</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">driver</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wext</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wpa</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conf</span></span></span><span class="hljs-class"> /</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">etc</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wpa_supplicant</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conf</span></span></span></span></code> </pre> <br><p>  F√ºgen Sie das Netzwerk im Voraus zu <code>/etc/wpa_supplicant.conf</code> , weil  Dies auf dem Controller selbst zu tun ist nicht so bequem: </p><br><pre> <code class="bash hljs">wpa_passphrase ssid password &gt;&gt; /etc/wpa_supplicant.conf</code> </pre> <br><p>  Wenn Sie keinen Wi-Fi-Zugang haben, k√∂nnen Sie UART f√ºr die weitere Konfiguration verwenden. Beachten Sie jedoch, dass der Kernel standardm√§√üig alle Fehler f√ºr dieses Terminal anzeigt.  Daher kann Sie w√§hrend des Betriebs eine pl√∂tzliche Nachricht vom Kernel oder Dienst unterbrechen. </p><br><p>  F√ºgen Sie ein Skript hinzu, um Bluetooth zu aktivieren.  √Ñndern <code>/etc/init.d/bluetooth</code> diesmal <code>/etc/init.d/bluetooth</code> : </p><br><pre> <code class="bash hljs"> 139: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-variable"><span class="hljs-variable">$1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> start) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> 1 &gt;&gt; /sys/devices/virtual/gpio/gpio107/value  168: hciattach /dev/ttyS0 texas log_end_msg 0 ;;</code> </pre><br><p>  Daher f√ºhren alle Dienste, f√ºr die der Bluetooth-Dienst erforderlich ist, die zum Initialisieren erforderlichen Befehle aus. </p><br><h3 id="vzmah-vlevo-vzmah-vpravo">  Wischen Sie nach links, wischen Sie nach rechts </h3><br><p>  Wir entfernen unn√∂tige Programme und Dienste, die mit htop angezeigt werden k√∂nnen, da sie einen wertvollen Platz im RAM einnehmen: </p><br><p><img src="https://habrastorage.org/webt/4e/rg/av/4ergavw2trhiiyvvlnmdtc1luhk.png"></p><br><p>  In diesem Fall verf√ºgt der ConsoleKit-Dienst √ºber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">viele Prozesse</a> .  Verschieben Sie die Datei dieses Dienstes im Falle einer Wiederherstellung in den Stammordner: </p><br><pre> <code class="bash hljs">mv /usr/share/dbus-1/system-services/org.freedesktop.ConsoleKit.service /root/</code> </pre> <br><p>  Vor dem Herunterfahren des Dienstes betrug der RAM-Verbrauch 19 MB und nach - 16 MB. </p><br><h3 id="razdely-sistemy">  Systemabschnitte </h3><br><p>  Obwohl uBoot das Ger√§t, auf dem sich die Root-Partition befindet, an den Kernel √ºbertr√§gt, lohnt es sich aus <code>/etc/fstab</code> Zuverl√§ssigkeit, es in <code>/etc/fstab</code> zu schreiben.  Wir √§ndern die erste Zeile, die f√ºr den Stammabschnitt verantwortlich ist: </p><br><pre> <code class="hljs mel">/dev/mmcblk0p1 / auto defaults <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> <span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> defaults <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> devpts /dev/pts devpts mode=<span class="hljs-number"><span class="hljs-number">0620</span></span>,gid=<span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> usbdevfs /<span class="hljs-keyword"><span class="hljs-keyword">proc</span></span>/bus/usb usbdevfs noauto <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> tmpfs /run tmpfs mode=<span class="hljs-number"><span class="hljs-number">0755</span></span>,nodev,nosuid,strictatime <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> tmpfs /var/volatile tmpfs defaults <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br><p>  Wenn Sie die Root-Partition nicht zur ersten gemacht haben, vergessen Sie nicht, die gew√ºnschte Partitionsnummer anzugeben. </p><br><p>  Wenn Sie die zweite FAT-Partition f√ºr Benutzerdaten verlassen haben, m√ºssen Sie einen Ordner erstellen, um die Partition darin bereitzustellen </p><br><pre> <code class="bash hljs">mkdir /usr/share/trik</code> </pre> <br><p>  und schreibe den Abschnitt in <code>/etc/fstab</code> : </p><br><pre> <code class="bash hljs">/dev/mmcblk0p2 /usr/share/trik vfat defaults 0 0</code> </pre> <br><h1 id="etap-6-probuem-nashu-kashu">  Stufe 6. Wir probieren unseren Brei </h1><br><p>  Nachdem Sie das System-Image konfiguriert haben, m√ºssen Sie es bereitstellen, um die Kernelmodule und den Kernel selbst zu installieren: </p><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># ,     (start) fdisk -l debian.img mount -o loop,offset=NNNN debian.img /mnt/debian</span></span></code> </pre> <br><p>  Dabei ist NNNN = Sektorgr√∂√üe * Abschnittsanfang.  Die Standardsektorgr√∂√üe betr√§gt 512 Byte. </p><br><p>  Wir montieren auch die urspr√ºngliche Distribution: </p><br><pre> <code class="bash hljs">fdisk -l trik-distro.img mount -o loop,offset=NNNN trik-distro.img /mnt/trik-clean</code> </pre> <br><p>  Wir entfernen den Kernel f√ºr QEMU und seine Module als  Sie sind nicht f√ºr unsere Plattform bestimmt.  Wir kopieren den neuen Kernel und die neuen Module, genau wie bei der urspr√ºnglichen Distribution. </p><br><pre> <code class="hljs powershell">rm <span class="hljs-literal"><span class="hljs-literal">-rf</span></span> /mnt/debian/boot/ rm <span class="hljs-literal"><span class="hljs-literal">-rf</span></span> /mnt/debian/lib/modules/<span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-literal"><span class="hljs-literal">-4</span></span><span class="hljs-literal"><span class="hljs-literal">-versatile</span></span> rm <span class="hljs-literal"><span class="hljs-literal">-rf</span></span> /mnt/debian/lib/modules/<span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-literal"><span class="hljs-literal">-5</span></span><span class="hljs-literal"><span class="hljs-literal">-versatile</span></span> mkdir /mnt/debian/boot/ cp arch/arm/boot/uImage /mnt/debian/boot/ make INSTALL_MOD_PATH=/mnt/debian modules_install</code> </pre> <br><p>  Wir ben√∂tigen Firmware f√ºr das Wi-Fi-Modul, das sich in der urspr√ºnglichen Distribution im Ordner / lib / firmware befindet, sowie die Bluetooth-Firmware, die wir zuvor gefunden haben. </p><br><pre> <code class="hljs ruby">cp /mnt/trik-clean/lib/firmware/* <span class="hljs-regexp"><span class="hljs-regexp">/mnt/debian</span></span><span class="hljs-regexp"><span class="hljs-regexp">/lib/firmware</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ cp TIInit_7.6.15.bts /mnt</span></span><span class="hljs-regexp"><span class="hljs-regexp">/debian/lib</span></span><span class="hljs-regexp"><span class="hljs-regexp">/firmware/</span></span></code> </pre> <br><p>  Trennen Sie die Datentr√§gerabbilder: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">umount</span></span> /mnt/trik-clean umount /mnt/debian</code> </pre> <br><p>  Kopieren Sie das Bild mit dd auf die Speicherkarte: </p><br><pre> <code class="hljs cs"><span class="hljs-meta"><span class="hljs-meta">#    ( ) lsblk dd </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta">=debian.img of=/dev/sdX bs=4M</span></span></code> </pre> <br><h1 id="etap-7-finishnaya-pryamaya">  Stufe 7. Die Ziellinie </h1><br><p>  Wir kompilieren die Programme zum Verbinden des Gamepads auf dem neuen System und installieren den Sixad-Daemon. </p><br><p>  Wir verbinden das Gamepad √ºber USB mit dem Controller und f√ºhren das Programm aus, um ein Paar zu erstellen: </p><br><pre> <code class="bash hljs">root@trik:~/bt<span class="hljs-comment"><span class="hljs-comment"># ./sixpair Current Bluetooth master: 78:**:**:**:**:b9 Setting master bd_addr to 78:**:**:**:**:b9</span></span></code> </pre> <br><p>  Wenn das Gamepad angeschlossen ist, passiert nichts und der Sixad-Dienst ist stumm: </p><br><pre> <code class="bash hljs">sixad-bin[2675]: started sixad-bin[2675]: sixad started, press the PS button now sixad-bin[2675]: unable to connect to sdp session</code> </pre> <br><p>  Aber die Raspberry Pi-Community hat bereits eine ‚ÄûKr√ºcke‚Äú gebaut, um die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Verbindung</a> zu reparieren. </p><br><p>  Wir bauen das Programm neu auf und freuen uns. </p><br><pre> <code class="hljs powershell">sixad<span class="hljs-literal"><span class="hljs-literal">-bin</span></span>[<span class="hljs-number"><span class="hljs-number">2833</span></span>]: started sixad<span class="hljs-literal"><span class="hljs-literal">-bin</span></span>[<span class="hljs-number"><span class="hljs-number">2833</span></span>]: sixad started, press the PS button now sixad<span class="hljs-literal"><span class="hljs-literal">-bin</span></span>[<span class="hljs-number"><span class="hljs-number">2833</span></span>]: unable to connect to sdp session sixad<span class="hljs-literal"><span class="hljs-literal">-sixaxis</span></span>[<span class="hljs-number"><span class="hljs-number">2836</span></span>]: started sixad<span class="hljs-literal"><span class="hljs-literal">-sixaxis</span></span>[<span class="hljs-number"><span class="hljs-number">2836</span></span>]: Connected <span class="hljs-string"><span class="hljs-string">'PLAYSTATION(R)3 Controller (00:**:**:**:**:09)'</span></span> [<span class="hljs-type"><span class="hljs-type">Battery</span></span> <span class="hljs-number"><span class="hljs-number">02</span></span>]</code> </pre> <br><p>  Jetzt steht das Gamepad dem System als Eingabeger√§t zur Verf√ºgung und das Programm jstest zeigt den Status aller Tasten und analogen Sensoren an: </p><br><pre> <code class="hljs apache"><span class="hljs-attribute"><span class="hljs-attribute">root</span></span>@trik:~# ls /dev/input/ by-path event0 event1 event2 event3 js0 js1 js2 mice root@trik:~# jstest --normal /dev/input/jsX Driver version is 2.1.0. Joystick (PLAYSTATION(R)3 Controller (00:**:**:**:**:09)) has 29 axes (X, Y, Z, Rx, Ry, Rz, Throttle, Rudder, Wheel, Gas, Brake, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, (null), (null), (null), (null), (null), (null), (null), (null)) and 17 buttons (Trigger, ThumbBtn, ThumbBtn2, TopBtn, TopBtn2, PinkieBtn, BaseBtn, BaseBtn2, BaseBtn3, BaseBtn4, BaseBtn5, BaseBtn6, BtnDead, BtnA, BtnB, BtnC, BtnX). Testing ... (interrupt to exit) Axes: 0: 0 1: 0 2: 0 3: 0 4: -7150 5: -7746 6:-32767 7: 0 8: 0 9: 0 10: 0 11: 0 12: 0 13: 0 14: 0 15: 0 16: 0 17: 0 18: 0 19: 0 20: 0 21: 0 22: 0 23: 0 24: 0 25: 0 26: 0 27: 0 28: 0 Buttons: 0:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 1:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 2:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 3:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 4:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 5:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 6:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 7:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 8:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 9:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 10:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 11:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 12:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 13:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 14:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 15:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 16:<span class="hljs-literal"><span class="hljs-literal">off</span></span></code> </pre> <br><p>  Dabei ist X standardm√§√üig die Ger√§tenummer im System - 2. Die Anzahl der Tasten und Achsen kann hier angezeigt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werden</a> . </p><br><h1 id="ispolzuem-na-praktike">  In der Praxis anwenden </h1><br><p>  Video zeigt das Gamepad auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">YouTube</a> . </p><br><div class="spoiler">  <b class="spoiler_title">Fotos der Distribution</b> <div class="spoiler_text"><p>  Laden des Kernels: <br><img src="https://habrastorage.org/webt/aj/mx/xt/ajmxxtarcapbe4hwfefj5-v83ws.jpeg"><br>  Terminal l√§uft auf X11: <br><img src="https://habrastorage.org/webt/bi/gn/vk/bignvkyajckcuobz8rzgyf5priw.jpeg"></p><br><p><img src="https://habrastorage.org/webt/cp/6k/pu/cp6kpumd7uxcxnlyc3jg7mpmn2m.jpeg"><br>  Und nach der Tradition: <br><img src="https://habrastorage.org/webt/9f/et/xk/9fetxkfu74mdacfatuwnaodrmj8.jpeg"></p><br><p><img src="https://habrastorage.org/webt/qw/mi/1h/qwmi1hncq77acchz8dfjfpzs334.jpeg"></p></div></div><br><h3 id="poleznye-ssylki">  N√ºtzliche Links </h3><br><p>  Programme zum Anschlie√üen des Dualshock 3-Gamepads - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sixpair</a> und <a href="">Sixad</a> . </p><br><p>  F√ºr Gamepads und andere Eingabeger√§te gibt es eine leichte C-Bibliothek - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">libenjoy</a> . </p><br><p>  Der Quellcode des Programms zur Steuerung von Servomotoren und Motoren ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das GitHub-Repository</a> . </p><br><p>  Alle Konfigurationsdateien aus dem Artikel f√ºr ein provisorisches Distributionskit sind <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das GitHub-Repository</a> . </p><br><p>  Die Kernelquelle ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das GitHub-Repository</a> . </p><br><h1 id="interesnye-fakty-o-kontrollere">  Interessante Fakten zum Controller </h1><br><ul><li>  Die Spezifikation besagt, dass RAM 256 MB betr√§gt.  Wenn Sie jedoch htop ausf√ºhren, werden Sie feststellen, dass nur 128 MB verf√ºgbar sind.  Dies wird durch die Kerneloptionen eingeschr√§nkt, die in der uBoot-Konsole angezeigt werden k√∂nnen: </li></ul><br><pre> <code class="bash hljs">mem=128M console=ttyS1,115200n8 rw noinitrd rootwait root=/dev/mmcblk0p1 vt.global_cursor_default=0 consoleblank=0</code> </pre> <br><p>  Der Speicherchip ist mit 3PC22 D9MTD von Micron gekennzeichnet.  Es war nicht m√∂glich, Informationen √ºber das aktuelle Volumen zu finden. </p><br><ul><li>  uBoot wird im SPI-Flash-Speicher gespeichert, in dem auch der Kernel verkabelt ist, und wird nicht verwendet.  Sie k√∂nnen versuchen, diesen Ort f√ºr Ihre Aufgaben zu verwenden oder einen neuen Kernel zu kopieren und uBoot so zu konfigurieren, dass er verwendet wird. </li></ul><br><p>  Adressen von Bildern aus dmesg: </p><br><pre> <code class="bash hljs">[ 11.598170] 0x000000000000-0x000000040000 : <span class="hljs-string"><span class="hljs-string">"uboot"</span></span> [ 11.642985] 0x000000040000-0x000000080000 : <span class="hljs-string"><span class="hljs-string">"uboot-env1"</span></span> [ 11.706256] 0x000000080000-0x0000000c0000 : <span class="hljs-string"><span class="hljs-string">"uboot-env2"</span></span> [ 11.761827] 0x0000000c0000-0x000000100000 : <span class="hljs-string"><span class="hljs-string">"config-periph"</span></span> [ 11.805129] 0x000000100000-0x000000400000 : <span class="hljs-string"><span class="hljs-string">"kernel"</span></span> [ 11.861864] 0x000000400000-0x000001000000 : <span class="hljs-string"><span class="hljs-string">"RootFS"</span></span></code> </pre> <br><ul><li>  Der Bildschirm des Controllers ist zwar klein, verf√ºgt jedoch √ºber einen Widerstandssensor.  Ob der Sensor selbst angeschlossen ist, ist unbekannt. </li><li>  Dualshock 3 verf√ºgt √ºber LEDs am USB-Anschluss, die die Nummer des Gamepads / Joysticks anzeigen.  Es gibt ein Gamepad im Video, aber seine Nummer ist 3. Dies ist kein Fehler, weil  Es gibt zwei weitere ‚ÄûJoysticks‚Äú im System: einen Beschleunigungsmesser und ein Gyroskop. </li></ul><br><h1 id="problemy-voznikshie-pri-ispolzovanii">  Probleme bei der Verwendung </h1><br><ul><li>  Der Roboter h√§ngt manchmal fest, ohne die Servomotoren auszuschalten, wodurch sie ihre Position aufgrund von Rauschen auf der Datenleitung √§ndern k√∂nnen.  Dies wurde sogar bei einer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Standardverteilung beobachtet</a> . </li><li>  Die Einbeziehung von PWM-Controllern unterscheidet sich von den Angaben in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> .  Zumindest in reinem C hat dies nicht funktioniert. </li><li>  USB funktioniert manchmal nicht mehr unter Debian. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de415007/">https://habr.com/ru/post/de415007/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de414997/index.html">ML-Blitz: Analyse der Aufgaben der ersten Qualifikationsrunde</a></li>
<li><a href="../de414999/index.html">3D Watchman und Thermistor Tester</a></li>
<li><a href="../de415001/index.html">Der Fahrer des Uber-Roboterautos, der einen Radfahrer abgeschossen hatte, sah sich zum Zeitpunkt der Kollision die Voice-Show an</a></li>
<li><a href="../de415003/index.html">Uneingeschr√§nkter Datei-Upload bei Apple.com</a></li>
<li><a href="../de415005/index.html">Sonnenkollektoren, Sprachbefehle und Offroad-Rennen: Gegenwart und Zukunft von Elektrofahrr√§dern</a></li>
<li><a href="../de415009/index.html">Wer ist das in Nordamerika? Rekrutierung - Teil 1</a></li>
<li><a href="../de415011/index.html">Bericht des Club of Rome 2018, Kapitel 3.10: ‚ÄûSteuer auf Beats‚Äú</a></li>
<li><a href="../de415015/index.html">Bewertung von IT-Arbeitgebern in Nischni Nowgorod: eine Studie √ºber die Pr√§ferenzen von Studenten technischer Fachrichtungen</a></li>
<li><a href="../de415017/index.html">.NET-Produkt, das Leben rettet</a></li>
<li><a href="../de415019/index.html">Marketing. Fast kompliziert</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>