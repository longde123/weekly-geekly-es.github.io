<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤾🏾 🥃 🤶🏿 Arduino-Entwicklungs-Toolchain für Befehlszeilen-Kenner: PlatformIO oder wie Sie die Verwendung der Arduino-IDE beenden können 👨🏽‍🤝‍👨🏻 🎺 🤗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Im letzten Jahr habe ich ziemlich viel Code für Arduino geschrieben und gleichzeitig mehrere Entwicklungstools geändert. Der Artikel erwähnt die Optio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Arduino-Entwicklungs-Toolchain für Befehlszeilen-Kenner: PlatformIO oder wie Sie die Verwendung der Arduino-IDE beenden können</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/392639/"><img align="left" src="https://habrastorage.org/files/609/41e/ed9/60941eed96084f9d81a6a47cc169ec67.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im letzten Jahr habe ich ziemlich viel Code für Arduino geschrieben und gleichzeitig mehrere Entwicklungstools geändert. </font><font style="vertical-align: inherit;">Der Artikel erwähnt die Optionen, die ich ausprobiert habe, und detaillierter, worüber ich angehalten habe. </font><font style="vertical-align: inherit;">Es geht um eine Reihe von Tools für den Fall, dass&gt; 10 Projekte für verschiedene Boards und ein wenig um die Entwicklung und Installation von Bibliotheken.</font></font><a name="habracut"></a><br>
<br clear="all">
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entwicklungsumgebung</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist das Problem?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wahrscheinlich, weil Arduino sich nicht auf professionelle Entwickler konzentriert, zeichnet sich das Ökosystem um die Standard-IDE durch das Fehlen der für mich üblichen Tools aus:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nur in neueren Versionen wurde eine Art Bibliotheksverwaltung eingeführt, während ohne die Ähnlichkeit von Gemfile / require.txt / package.json für das Projekt nicht angegeben werden kann, welche Versionen verwendet werden</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keine Integration mit Git oder anderen VCS</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Texteditor ist nicht mit </font><em><font style="vertical-align: inherit;">meinem bevorzugten Texteditor zu</font></em><font style="vertical-align: inherit;"> vergleichen</font></font><em><font style="vertical-align: inherit;"></font></em></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gibt keine Möglichkeit, die Board-Auswahl im Projekt zu speichern</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unbequeme Ausgabe von Kompilierungsfehlern</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Arduino-Website enthält eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liste alternativer Entwicklungswerkzeuge</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In dieser Liste gibt es Optionen, die ich aus verschiedenen Gründen nicht ausprobiert habe. </font><font style="vertical-align: inherit;">Beispielsweise haben Atmel Studio und Visual Studio CE dies nicht berücksichtigt. </font><font style="vertical-align: inherit;">Ich wollte ein Tool finden, das die Arbeit über die Befehlszeile unterstützt.</font></font><br>
<br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was versucht</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ino</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ein Projekt der russischen Firma Amperka, einem Befehlszeilenprogramm für die Arduino-Firmware. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Projekt war sehr beliebt,&gt; 200 Gabeln. </font><font style="vertical-align: inherit;">Das letzte Commit war im April 2014, daher funktioniert es nicht mit den neuesten Versionen der IDE (es scheint seit 1.5). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt eine lebende Gabel von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arturo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ich habe sie ein wenig benutzt, aber in einigen exotischen Fällen gab es Probleme.</font></font><br>
<br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino-Makefile</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino-Makefile</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - kompilieren und herunterladen mit make. </font><font style="vertical-align: inherit;">Arduino Due, Zero und andere 32-Bit-Karten werden nicht unterstützt. </font><font style="vertical-align: inherit;">Der Unterschied zur Standard-IDE besteht darin, dass die Methoden vor der Verwendung deklariert werden müssen. Wenn Sie also fertige Projekte übertragen, müssen Sie möglicherweise die Quelle bearbeiten. </font><font style="vertical-align: inherit;">Wenn ich mich richtig erinnere, konnte ich mich mit Arduino-Makefile und SparkFun Pro Micro nicht anfreunden.</font></font><br>
<br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ich benutze</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PlatformIO</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PlatformIO</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist ein hervorragendes Projekt, das von Entwicklern aus der Ukraine erstellt wurde. </font><font style="vertical-align: inherit;">Es enthält ein Befehlszeilenprogramm, mit dem Sie Programme kompilieren und in mehrere Mikrocontrollerfamilien herunterladen können (Atmel AVR, Atmel SAM, ST STM32, TI MSP430 und andere). </font><font style="vertical-align: inherit;">Gleichzeitig werden verschiedene Bibliotheksgruppen unterstützt (auf der PlatformIO-Website werden sie als Frameworks bezeichnet): Arduino, Energia, mbed sowie nativer Code für Atmel AVR, espressif, MSP430. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PlatformIO war ursprünglich darauf ausgerichtet, über die Befehlszeile zu arbeiten. Es gibt auch Plugins für die Integration in Texteditoren und IDEs: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atom, CLion, Eclipse, Emacs, NetBeans, Qt Creator, Sublime Text, Vim und Visual Studio.</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PlatformIO eignet sich besonders für:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ein Projekt für mehrere Boards, d.h. </font><font style="vertical-align: inherit;">Der gleiche Code sollte für verschiedene Karten kompiliert werden</font></font></li>
<li>    , ..     ,      </li>
<li>    ssh,   PlatformIO   Raspberry Pi</li>
<li>   </li>
</ul><br>
<img src="http://docs.platformio.org/en/latest/_images/platformio-demo-wiring.gif" alt="Bild"><br>
<br>
<br>
<h5>  Arduino</h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde die Dokumentation nicht nacherzählen. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hier finden Sie die Installationsanweisungen.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Weitere Informationen finden Sie im </font><font style="vertical-align: inherit;">Abschnitt </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schnellstart</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Ordnerstruktur des Projekts für PlatformIO unterscheidet sich vom Arduino IDE-Projekt. Jedes Projekt enthält eine platformio.ini-Datei, in der angegeben ist, welche Boards verwendet werden. </font><font style="vertical-align: inherit;">Sie müssen also nicht jedes Mal das richtige Board auswählen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde Ihnen ein Beispiel geben, wie ich PlatformIO beim Entwickeln einer Bibliothek für Arduino verwende. </font><font style="vertical-align: inherit;">Die Bibliothek verfügt über zwei Beispiele, von denen jedes ein Projekt im PlatformIO-Format ist. </font><font style="vertical-align: inherit;">In der Projekteinstellungsdatei platformio.ini sind alle Karten aufgeführt, auf denen die Bibliothek ausgeführt werden soll:</font></font><br>
<pre><code class="hljs powershell">[<span class="hljs-type"><span class="hljs-type">env</span></span>:<span class="hljs-type"><span class="hljs-type">nanoatmega328</span></span>]<font></font>
platform = atmelavr<font></font>
framework = arduino<font></font>
board = nanoatmega328<font></font>
<font></font>
[<span class="hljs-type"><span class="hljs-type">env</span></span>:<span class="hljs-type"><span class="hljs-type">sparkfun_promicro16</span></span>]<font></font>
platform = atmelavr<font></font>
framework = arduino<font></font>
board = sparkfun_promicro16<font></font>
<font></font>
[<span class="hljs-type"><span class="hljs-type">env</span></span>:<span class="hljs-type"><span class="hljs-type">due</span></span>]<font></font>
platform = atmelsam<font></font>
framework = arduino<font></font>
board = due<font></font>
<font></font>
[<span class="hljs-type"><span class="hljs-type">env</span></span>:<span class="hljs-type"><span class="hljs-type">teensy31</span></span>]<font></font>
platform = teensy<font></font>
framework = arduino<font></font>
board = teensy31<font></font>
<font></font>
[<span class="hljs-type"><span class="hljs-type">env</span></span>:<span class="hljs-type"><span class="hljs-type">nodemcu</span></span>]<font></font>
platform = espressif<font></font>
framework = arduino<font></font>
board = nodemcu<font></font>
<font></font>
[<span class="hljs-type"><span class="hljs-type">env</span></span>:<span class="hljs-type"><span class="hljs-type">uno</span></span>]<font></font>
platform = atmelavr<font></font>
framework = arduino<font></font>
board = uno<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dem Befehl können Sie ein Beispiel für alle Karten kompilieren:</font></font><br>
<pre><code class="bash hljs">platformio run</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können nur für uno wie folgt kompilieren:</font></font><br>
<pre><code class="bash hljs">platformio run -e uno</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laden Sie die Firmware auf uno herunter:</font></font><br>
<pre><code class="bash hljs">platformio run --target upload -e uno</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Starten Sie den Monitor für die serielle Schnittstelle:</font></font><br>
<pre><code class="bash hljs">platformio serialports monitor</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aliase zu .zshrc hinzugefügt, um die Befehle zu verkürzen:</font></font><br>
<pre><code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">alias</span></span> compile=<span class="hljs-string"><span class="hljs-string">"platformio run"</span></span>
<span class="hljs-built_in"><span class="hljs-built_in">alias</span></span> upload=<span class="hljs-string"><span class="hljs-string">"platformio run --target upload"</span></span>
<span class="hljs-built_in"><span class="hljs-built_in">alias</span></span> serial=<span class="hljs-string"><span class="hljs-string">"platformio serialports monitor"</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit ihnen die gleiche Abfolge von Aktionen:</font></font><br>
<pre><code class="bash hljs">compile         <span class="hljs-comment"><span class="hljs-comment">#    </span></span>
compile -e uno  <span class="hljs-comment"><span class="hljs-comment">#   uno</span></span>
upload  -e uno  <span class="hljs-comment"><span class="hljs-comment">#  uno</span></span>
serial          <span class="hljs-comment"><span class="hljs-comment">#   </span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt auch eine Integration mit Travis CI und anderen CI-Tools. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Weitere Details finden Sie hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eigentlich hat die Arduino IDE </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eine Befehlszeilenschnittstelle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , aber sie ist alles andere als perfekt.</font></font><br>
<br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PlatformIO Nuances</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PlatformIO beschleunigt die Arbeit, ist im Vergleich zur Arduino IDE flexibler und erleichtert die Automatisierung von Routineaufgaben. </font><font style="vertical-align: inherit;">Es sind mehrere Punkte zu beachten:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Kompilieren in PlatformIO entspricht nicht immer dem Kompilieren in Arduino IDE. Was in PlatformIO kompiliert wurde, wird möglicherweise nicht in Arduino IDE kompiliert und umgekehrt</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Struktur des Projektordners stimmt nicht mit der Struktur für Arduino IDE überein</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nicht alle Bibliotheken können über </font><em><font style="vertical-align: inherit;">platformio lib</font></em><font style="vertical-align: inherit;"> installiert </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">werden</font></font></em></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serial.print ("Könnte besser sein");</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist das Problem?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Standard Serial.print () ist etwas unpraktisch, wenn Sie den </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namen und den Wert der Variablen </font><font style="vertical-align: inherit;">drucken müssen </font><font style="vertical-align: inherit;">, um beispielsweise "pin_2 = &lt;state pin 2&gt;, pin_3 = &lt;state pin 3&gt;" anzuzeigen. Dazu müssen Sie Folgendes tun:</font></font><br>
<pre><code class="cpp hljs">Serial.print(<span class="hljs-string"><span class="hljs-string">"pin_2 = "</span></span>);<font></font>
Serial.print(digitalRead(<span class="hljs-number"><span class="hljs-number">2</span></span>));<font></font>
<font></font>
Serial.print(<span class="hljs-string"><span class="hljs-string">", pin_3 = "</span></span>);<font></font>
Serial.println(digitalRead(<span class="hljs-number"><span class="hljs-number">3</span></span>));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trotzdem möchte ich manchmal die Ausgabe für die Serie teilweise oder vollständig deaktivieren, zum Beispiel, wenn sie nur zum Debuggen verwendet wird. </font><font style="vertical-align: inherit;">Natürlich können Sie dazu Aufrufe von Serial.print () kommentieren, aber ich hätte gerne eine elegantere Option.</font></font><br>
<br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was versucht</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arduinoLogging</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Bibliothek verwendet eine printf-ähnliche Syntax zum Drucken und ermöglicht es Ihnen, LOGLEVEL festzulegen und somit die Ausgabe einiger oder aller Nachrichten zu deaktivieren. </font><font style="vertical-align: inherit;">Nachrichten werden mit den Methoden Error, Info, Debug und Verbose angezeigt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Beispiel:</font></font><br>
<pre><code class="cpp hljs">  <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Logging.h"</span></span></span></span><font></font>
<font></font>
  <span class="hljs-comment"><span class="hljs-comment">// LOGLEVEL   LOG_LEVEL_X,  X ∈ { NOOUTPUT, ERRORS, INFOS, DEBUG, VERBOSE }</span></span>
  <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> LOGLEVEL LOG_LEVEL_INFOS</span></span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
    Serial.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);<font></font>
    Log.Init(LOGLEVEL, &amp;Serial);<font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
    Log.Info(<span class="hljs-string"><span class="hljs-string">"pin_2 = %d, pin_3 = %d"</span></span>CR, digitalRead(<span class="hljs-number"><span class="hljs-number">2</span></span>), digitalRead(<span class="hljs-number"><span class="hljs-number">3</span></span>));<font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
    Log.Debug(<span class="hljs-string"><span class="hljs-string">"   ,   LOGLEVEL = LOG_LEVEL_INFOS"</span></span>);<font></font>
  }</code></pre><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verfügbare Modifikatoren</font></font></h5><br>
<table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Platzhalter</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kommentar</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% s</font></font></td>
<td>replace with an string (char*)</td>
<td>Log.Info("String %s", myString);</td>
</tr>
<tr>
<td>%c</td>
<td>replace with an character</td>
<td>Log.Info("use %c as input", myChar)</td>
</tr>
<tr>
<td>%d</td>
<td>replace with an integer value</td>
<td>Log.Info("current value %d",myValue);</td>
</tr>
<tr>
<td>%l</td>
<td>replace with an long value</td>
<td>Log.Info("current long %l", myLong);</td>
</tr>
<tr>
<td>%x</td>
<td>replace and convert integer value into hex</td>
<td>Log.Info ("as hex %x), myValue);</td>
</tr>
<tr>
<td>%X</td>
<td>like %x but combine with 0x123AB</td>
<td>Log.Info ("as hex %X), myValue);</td>
</tr>
<tr>
<td>%b</td>
<td>replace and convert integer value into binary</td>
<td>Log.Info ("as bin %b), myValue);</td>
</tr>
<tr>
<td>%B</td>
<td>like %x but combine with 0b10100011</td>
<td>Log.Info ("as bin %B), myValue);</td>
</tr>
<tr>
<td>%t</td>
<td>replace and convert boolean value into "t" or "f"</td>
<td>Log.Info ("is it true? %t), myBool);</td>
</tr>
<tr>
<td>%T</td>
<td>like %t but convert into "true" or "false"</td>
<td>Log.Info ("is it true? %T), myBool);</td>
</tr>
</tbody>
</table><br>
<h3> </h3><br>
<h4>advancedSerial</h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Namen der Nachrichtenebenen Fehler, Info, Debug und Ausführlich in arduinoLogging sind nicht neutral. Ein Fehler führt nicht unbedingt zu einem Fehler, sondern ist nur eine Meldung, die auf einer beliebigen LOGLEVEL angezeigt wird (außer NOOUTPUT). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angesichts der Unannehmlichkeiten von printf habe ich meine eigene Version, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">advancedSerial, geschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AdvancedSerial besteht eigentlich aus zwei Dingen: der Möglichkeit, print () und println () in der Ketten- und Nachrichtenebene aufzurufen.</font></font><br>
<pre><code class="cpp hljs">  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a = <span class="hljs-number"><span class="hljs-number">1</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b = <span class="hljs-number"><span class="hljs-number">2</span></span>;<font></font>
<font></font>
  aSerial.print(<span class="hljs-string"><span class="hljs-string">"a = "</span></span>).print(a).print(<span class="hljs-string"><span class="hljs-string">"b = "</span></span>).println(b);<font></font>
<font></font>
  <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
  aSerial.p(<span class="hljs-string"><span class="hljs-string">"a = "</span></span>).p(a).p(<span class="hljs-string"><span class="hljs-string">"b = "</span></span>).pln(b);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vollständiges Beispiel für </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Basic.ino</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Da die Namen der Methoden mit den Namen der Standardmethoden Serial.print () und Serial.println () übereinstimmen, können Sie Serial in den Quellen optional durch aSerial ersetzen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für den Namen der Nachrichtenebenen habe ich v, vv, vvv, vvvv gewählt, eine ziemlich übliche Methode, um die Detailebenen der angezeigten Nachrichten anzugeben, die normalerweise als Flags -v, -vv usw. zu finden sind. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit diesen Namen ist es einfacher, eine Ebene in eine andere zu bearbeiten. Beispielsweise ist vv -&gt; vvv einfacher als Info -&gt; Debug.</font></font><br>
<pre><code class="cpp hljs">  <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"advancedSerial.h"</span></span></span></span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
    Serial.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);<font></font>
<font></font>
    aSerial.setPrinter(Serial);    <span class="hljs-comment"><span class="hljs-comment">//      </span></span><font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">//  ,      v  vv,  vvv  vvvv   </span></span><font></font>
    aSerial.setFilter(Level::vv);<font></font>
  }<font></font>
<font></font>
   <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
     aSerial.l(Level::vv).pln(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
     aSerial.l(Level::vvv).pln(<span class="hljs-string"><span class="hljs-string">"  "</span></span>);<font></font>
<font></font>
     delay(<span class="hljs-number"><span class="hljs-number">3000</span></span>);<font></font>
   }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vollständiges Beispiel für </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Advanced.ino</font></font></a><br>
<br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speicherplatz sparen</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie die Zeichenfolge in das Makro F () einschließen, wird sie nicht in den Speicher (SRAM) geladen. Verwenden Sie daher F (), um Speicher zu sparen:</font></font><br>
<pre><code class="cpp hljs">  aSerial.print(F(<span class="hljs-string"><span class="hljs-string">" 16 "</span></span>));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Natürlich hat die Verwendung von advancedSerial im Vergleich zur Standard-Seriennummer zu einem gewissen Overhead geführt. Ich habe versucht, grob abzuschätzen, welche. </font><font style="vertical-align: inherit;">Im Folgenden präsentiere ich die Kompilierungsergebnisse für Arduino Uno, da es 2 KB Speicher hat und dies das Minimum unter den Boards ist, die ich normalerweise benutze. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Normale Serien ohne Bibliotheken:</font></font></strong><br>
<pre><code class="cpp hljs">  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
   Serial.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
    Serial.print(<span class="hljs-string"><span class="hljs-string">"test"</span></span>);<font></font>
    Serial.println(<span class="hljs-string"><span class="hljs-string">"test"</span></span>);<font></font>
  }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Speicherplatz: 5% </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dynamischer Speicher: 9% </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AdvancedSerial:</font></font></strong><br>
<pre><code class="cpp hljs">  <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;advancedSerial.h&gt;</span></span></span></span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
   Serial.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);<font></font>
<font></font>
   aSerial.setPrinter(Serial);<font></font>
   aSerial.setFilter(Level::vv);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
    aSerial.print(<span class="hljs-string"><span class="hljs-string">"test"</span></span>).println(<span class="hljs-string"><span class="hljs-string">"test"</span></span>);<font></font>
  }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Speicherplatz: 5% </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dynamischer Speicher: 10% </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiele / Advanced.ino-</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Speicherplatz: 9% </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dynamischer Speicher: 26% </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiele / Advanced.ino unter Verwendung des Makrospeicherplatzes F ()</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
: 9% </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dynamischer Speicher: 10% </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellt sich heraus, dass der Speicher belegt ist steigt leicht an. </font><font style="vertical-align: inherit;">AdvancedSerial ist jedoch keine optimale Lösung in Bezug auf Ressourcen. Es gibt alternative Implementierungen, z. B. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debug</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bibliotheksinstallation</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist das Problem?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Standardmäßig installiert die Arduino IDE Bibliotheken global und in der Skizze wird nicht genau aufgezeichnet, welche Bibliotheken verwendet werden (mit Ausnahme der Direktiven #include natürlich) und welche Versionen. </font><font style="vertical-align: inherit;">Aus diesem Grund müssen Sie zum Kompilieren der Skizze auf einem anderen Computer wissen, wo die erforderlichen Bibliotheken heruntergeladen werden müssen. Auch hier müssen die Bibliotheksversionen angegeben werden. </font><font style="vertical-align: inherit;">Um solche Probleme zu vermeiden, installiere ich Bibliotheken nur lokal im Skizzenordner. </font><font style="vertical-align: inherit;">Im Folgenden finden Sie zwei Möglichkeiten, Bibliotheken für die Arduino IDE und PlatformIO lokal zu installieren.</font></font><br>
<br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino IDE</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich benutze selten die Arduino IDE, vielleicht gibt es einen besseren Weg. </font><font style="vertical-align: inherit;">Die Methode lautet wie folgt: Installieren Sie Bibliotheken in einem Unterordner Ihres Projekts und platzieren Sie Symlinks (Verknüpfungen?) Für jede Bibliothek im Bibliotheksordner (in dem Ordner, in dem die Arduino IDE-Bibliotheken installiert sind). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Übrigens, wenn ich mich richtig erinnere, kompiliert die Arduino IDE beim Kompilieren einer Skizze alle Bibliotheken aus dem Bibliotheksordner, sodass sich die Kompilierungszeit erhöht, wenn sich viele Bibliotheken in Bibliotheken befinden. </font><font style="vertical-align: inherit;">Ein weiterer Grund, die Arduino IDE nicht zu verwenden.</font></font><br>
<br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PlatformIO</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jedes PlatformIO-Projekt verfügt über einen lib-Unterordner, in den Bibliotheken eingefügt werden können. </font><font style="vertical-align: inherit;">Dies ist bei der manuellen Installation von Bibliotheken der Fall. </font><font style="vertical-align: inherit;">PlatformIO verfügt auch über einen separaten Befehl zum Installieren der platformio lib-Bibliotheken. Leider werden Bibliotheken standardmäßig global installiert, sodass die Bibliotheken lokal im lib-Unterordner installiert werden. Sie müssen sie im Projekt platformio.ini hinzufügen:</font></font><br>
<pre><code class="hljs powershell">[<span class="hljs-type"><span class="hljs-type">platformio</span></span>]<font></font>
lib_dir = ./lib</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Weitere Informationen zu platformio lib finden Sie in der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><cut></cut></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de392639/">https://habr.com/ru/post/de392639/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de392629/index.html">Atme tiefer durch: Astronomen haben einen weißen Zwerg mit einer reinen Sauerstoffatmosphäre gefunden</a></li>
<li><a href="../de392631/index.html">Swipebuster bietet Tinder User Tracking Services an</a></li>
<li><a href="../de392633/index.html">День космонавтики-2016: мероприятия по городам</a></li>
<li><a href="../de392635/index.html">Alles Gute zum Geburtstag Laptop! 35 Jahre alter erster kommerziell erfolgreicher Laptop</a></li>
<li><a href="../de392637/index.html">Alle IKEA LED-Lampen</a></li>
<li><a href="../de392641/index.html">Ein Gerät in Kühlschrankgröße kann auf Anfrage Medikamente drucken</a></li>
<li><a href="../de392645/index.html">Übersetzungsschwierigkeiten und appleID</a></li>
<li><a href="../de392647/index.html">Funktioniert gut, wenn nicht stören. Lightbridge Dji Phantom 3</a></li>
<li><a href="../de392649/index.html">Astronomen haben den ersten Exoplaneten im Dreifachsternsystem gefunden</a></li>
<li><a href="../de392651/index.html">Der Computer malte 347 Jahre nach dem Tod des Künstlers ein neues Gemälde von Rembrandt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>