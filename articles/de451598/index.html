<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê¶ üíö üôéüèº Unit Fairy Magic Fairy: DSL in C # üö£üèª ü§ûüèº üëåüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wie oft ist es passiert, dass Sie beim Schreiben eines Arbeitseinheitentests dessen Code √ºberpr√ºfen und ist es ... schlecht? Und du denkst so: "Dies i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Unit Fairy Magic Fairy: DSL in C #</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dodopizzadev/blog/451598/">  Wie oft ist es passiert, dass Sie beim Schreiben eines Arbeitseinheitentests dessen Code √ºberpr√ºfen und ist es ... schlecht?  Und du denkst so: "Dies ist ein Test, lass es so ...".  Nein,% Benutzername%, also lass es nicht.  Tests sind ein wichtiger Teil des Systems, der Codeunterst√ºtzung bietet, und es ist sehr wichtig, dass dieser Teil auch unterst√ºtzt wird.  Leider haben wir nicht viele M√∂glichkeiten, dies sicherzustellen (wir werden keine Tests f√ºr Tests schreiben), aber es gibt immer noch ein paar. <br><br><img src="https://habrastorage.org/webt/9_/cb/xb/9_cbxb0psq2mvlfwzkxf0uvpwru.png"><a name="habracut"></a><br>  In unserer Dodo DevSchool-Entwicklerschule heben wir unter anderem die folgenden Kriterien f√ºr einen guten Test hervor: <br><br><ul><li>  Reproduzierbarkeit: Das Ausf√ºhren von Tests mit demselben Code und derselben Eingabe f√ºhrt immer zum gleichen Ergebnis. </li><li>  Fokus: Es sollte nur einen Grund geben, warum der Test f√§llt. </li><li>  Verst√§ndlichkeit: Nun, hier ist es klar.  :) :) </li></ul><br>  Wie gef√§llt Ihnen ein solcher Test in Bezug auf diese Kriterien? <br><br><pre><code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Fact</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AcceptOrder_Successful</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ingredient1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Ingredient(<span class="hljs-string"><span class="hljs-string">"Ingredient1"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ingredient2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Ingredient(<span class="hljs-string"><span class="hljs-string">"Ingredient2"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ingredient3 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Ingredient(<span class="hljs-string"><span class="hljs-string">"Ingredient3"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> order = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Order(DateTime.Now); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> product1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Product(<span class="hljs-string"><span class="hljs-string">"Pizza1"</span></span>); product1.AddIngredient(ingredient1); product1.AddIngredient(ingredient2); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> orderLine1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrderLine(product1, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span>); order.AddLine(orderLine1); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> product2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Product(<span class="hljs-string"><span class="hljs-string">"Pizza2"</span></span>); product2.AddIngredient(ingredient1); product2.AddIngredient(ingredient3); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> orderLine2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrderLine(product2, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">650</span></span>); order.AddLine(orderLine2); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> orderRepositoryMock = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mock&lt;IOrderRepository&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ingredientsRepositoryMock = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mock&lt;IIngredientRepository&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> service = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PizzeriaService(orderRepositoryMock.Object, ingredientsRepositoryMock.Object); service.AcceptOrder(order); orderRepositoryMock.Verify(r =&gt; r.Add(order), Times.Once); ingredientsRepositoryMock.Verify(r =&gt; r.ReserveIngredients(order), Times.Once); }</code> </pre> <br>  F√ºr mich - sehr schlecht. <br><br>  Es ist unverst√§ndlich: Ich kann beispielsweise nicht einmal Arrangier-, Act- und Assert-Bl√∂cke zuweisen. <br><br>  Nicht spielbar: Die DateTime.Now-Eigenschaft wird verwendet.  Und schlie√ülich ist es nicht fokussiert, weil  hat zwei Gr√ºnde f√ºr den R√ºckgang: Aufrufe von Methoden von zwei Repositorys werden √ºberpr√ºft. <br><br>  Obwohl die Benennung von Tests den Rahmen dieses Artikels sprengt, achte ich dennoch auf den Namen: Bei solch einer Reihe negativer Eigenschaften ist es schwierig, ihn so zu formulieren, dass eine externe Person beim Betrachten des Testnamens sofort versteht, warum dieser Test im Allgemeinen im Projekt ist. <br><blockquote>  Wenn Sie den Test nicht pr√§zise benennen k√∂nnen, stimmt etwas mit dem Test nicht. </blockquote>  Da der Test unverst√§ndlich ist, sagen wir Ihnen, was darin passiert: <br><br><ol><li>  Die Zutaten werden erstellt. </li><li>  Aus den Zutaten werden Produkte (Pizzen) hergestellt. </li><li>  Aus den Produkten wird eine Bestellung erstellt. </li><li>  Es wird ein Dienst erstellt, f√ºr den die Repositorys nass sind. </li><li>  Die Bestellung wird an die AcceptOrder-Methode des Dienstes √ºbergeben. </li><li>  Es wird √ºberpr√ºft, ob die Methoden Add und ReserveIngredients der jeweiligen Repositorys aufgerufen wurden. </li></ol><br>  Wie k√∂nnen wir diesen Test verbessern?  Sie m√ºssen versuchen, nur das zu belassen, was wirklich wichtig ist.  Und daf√ºr haben kluge Leute wie Martin Fowler und Rebecca Parsons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DSL (Domain Specific Language) entwickelt</a> .  Hier werde ich √ºber die DSL-Muster sprechen, die wir bei Dodo verwenden, um sicherzustellen, dass unsere Unit-Tests weich und seidig sind und die Entwickler sich jeden Tag sicher f√ºhlen. <br><br>  Der Plan lautet wie folgt: Zuerst werden wir diesen Test verst√§ndlich machen, dann werden wir an der Reproduzierbarkeit arbeiten und ihn schlie√ülich fokussieren.  Wir fuhren ... <br><br><h2>  Entsorgung von Inhaltsstoffen (vordefinierte Dom√§nenobjekte) </h2><br>  Beginnen wir mit dem Auftragserstellungsblock.  Die Bestellung ist eine der zentralen Dom√§nenentit√§ten.  Es w√§re cool, wenn wir die Reihenfolge so beschreiben k√∂nnten, dass selbst Leute, die nicht wissen, wie man Code schreibt, aber die Dom√§nenlogik verstehen, verstehen k√∂nnen, welche Art von Reihenfolge wir erstellen.  Dazu m√ºssen wir zun√§chst auf die Verwendung der abstrakten "Ingredient1" und "Pizza1" verzichten und diese durch echte Zutaten, Pizzen und andere Dom√§nenobjekte ersetzen. <br><br>  Der erste Kandidat f√ºr die Optimierung sind die Zutaten.  Bei ihnen ist alles einfach: Sie ben√∂tigen keine Anpassung, nur einen Aufruf des Konstruktors.  Es reicht aus, sie in einen separaten Container zu packen und zu benennen, damit Domain-Experten klar sind: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Ingredients</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> Ingredient Dough = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Ingredient(<span class="hljs-string"><span class="hljs-string">"Dough"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> Ingredient Pepperoni = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Ingredient(<span class="hljs-string"><span class="hljs-string">"Pepperoni"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> Ingredient Mozzarella = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Ingredient(<span class="hljs-string"><span class="hljs-string">"Mozzarella"</span></span>); }</code> </pre><br>  Anstelle der v√∂llig verr√ºckten Zutaten1, Zutaten2 und Zutaten3 haben wir Teig, Pepperoni und Mozzarella bekommen. <br><blockquote>  Verwenden Sie vordefinierte Dom√§nenobjekte f√ºr h√§ufig verwendete Dom√§nenentit√§ten. </blockquote><br><h2>  Builder f√ºr Produkte </h2><br>  Die n√§chste Dom√§nenentit√§t sind Produkte.  Bei ihnen ist alles etwas komplizierter: Jedes Produkt besteht aus mehreren Zutaten, die wir vor der Verwendung dem Produkt hinzuf√ºgen m√ºssen. <br><br>  Hier ist das gute alte Builder-Muster n√ºtzlich.  Hier ist meine Build-Version f√ºr das Produkt: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ProductBuilder</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Product _product; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProductBuilder</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name</span></span></span><span class="hljs-function">)</span></span> { _product = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Product(name); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ProductBuilder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Containing</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Ingredient ingredient</span></span></span><span class="hljs-function">)</span></span> { _product.AddIngredient(ingredient); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Product </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Please</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _product; } }</code> </pre><br>  Es besteht aus einem parametrisierten Konstruktor, einer benutzerdefinierten <code>Containing</code> Methode und einer Terminal- <code>Please</code> Methode.  Wenn Sie mit dem Code nicht freundlich sein m√∂chten, k√∂nnen Sie <code>Please</code> durch <code>Now</code> ersetzen.  Der Builder verbirgt komplexe Konstruktoren und Methodenaufrufe, die das Objekt konfigurieren.  Der Code wird sauberer und verst√§ndlicher.  In guter Weise sollte der Builder die Erstellung des Objekts vereinfachen, damit der Code f√ºr den Dom√§nenexperten klar ist.  Es lohnt sich insbesondere, einen Builder f√ºr Objekte zu verwenden, die vor Arbeitsbeginn konfiguriert werden m√ºssen. <br><br>  Mit dem Product Builder k√∂nnen Sie Designs erstellen wie: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pepperoni = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductBuilder(<span class="hljs-string"><span class="hljs-string">"Pepperoni"</span></span>) .Containing(Ingredients.Dough) .Containing(Ingredients.Pepperoni) .Please();</code> </pre><br><blockquote>  Mit Builds k√∂nnen Sie Objekte erstellen, die angepasst werden m√ºssen.  Ziehen Sie in Betracht, einen Builder zu erstellen, auch wenn die Konfiguration aus einer Zeile besteht. </blockquote><br><h2>  ObjectMother </h2><br>  Trotz der Tatsache, dass die Entwicklung des Produkts viel anst√§ndiger geworden ist, sieht der Designer des <code>new ProductBuilder</code> immer noch ziemlich h√§sslich aus.  Korrigieren Sie es mit dem ObjectMother (Vater) -Muster. <br><br>  Das Muster ist einfach wie 5 Kopeken: Wir erstellen eine statische Klasse und sammeln alle Builder darin. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Create</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> ProductBuilder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Product</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name</span></span></span><span class="hljs-function">)</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductBuilder(name); }</code> </pre><br>  Jetzt k√∂nnen Sie so schreiben: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pepperoni = Create.Product(<span class="hljs-string"><span class="hljs-string">"Pepperoni"</span></span>) .Containing(Ingredients.Dough) .Containing(Ingredients.Pepperoni) .Please();</code> </pre><br>  ObjectMother wurde f√ºr die deklarative Erstellung von Objekten erfunden.  Dar√ºber hinaus hilft es, neue Entwickler in die Domain einzuf√ºhren, als  Wenn Sie das Wort "IDE <code>Create</code> selbst schreiben, <code>Create</code> Sie, was Sie in dieser Dom√§ne erstellen k√∂nnen. <br><br>  In unserem Code wird ObjectMother manchmal als Nicht <code>Create</code> , sondern angegeben bezeichnet.  Ich mag beide Optionen.  Wenn Sie weitere Ideen haben, teilen Sie diese in den Kommentaren mit. <br><blockquote>  Verwenden Sie ObjectMother, um Objekte deklarativ zu erstellen.  Der Code wird sauberer und es wird f√ºr neue Entwickler einfacher, in die Dom√§ne einzutauchen. </blockquote><br><h2>  Produktentfernung </h2><br>  Es ist viel besser geworden, aber die Produkte haben noch Raum zum Wachsen.  Wir haben eine begrenzte Anzahl von Produkten und diese k√∂nnen wie Zutaten in einer separaten Klasse gesammelt und nicht f√ºr jeden Test initialisiert werden: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Pizza</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Product Pepperoni =&gt; Create.Product(<span class="hljs-string"><span class="hljs-string">"Pepperoni"</span></span>) .Containing(Ingredients.Dough) .Containing(Ingredients.Pepperoni) .Please(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Product Margarita =&gt; Create.Product(<span class="hljs-string"><span class="hljs-string">"Margarita"</span></span>) .Containing(Ingredients.Dough) .Containing(Ingredients.Mozzarella) .Please(); }</code> </pre><br>  Hier nannte ich den Container nicht <code>Products</code> , sondern <code>Pizza</code> .  Dieser Name hilft beim Lesen des Tests.  Zum Beispiel hilft es, Fragen wie ‚ÄûIst Pepperoni eine Pizza oder eine Wurst?‚Äú Zu entfernen. <br><blockquote>  Versuchen Sie, echte Dom√§nenobjekte zu verwenden, keine Ersatzobjekte wie Product1. </blockquote><br><h2>  Der Builder f√ºr die Bestellung (Beispiel von hinten) </h2><br>  Jetzt wenden wir die beschriebenen Muster an, um einen Order Builder zu erstellen, aber jetzt gehen wir nicht vom Builder aus, sondern von dem, was wir erhalten m√∂chten.  So m√∂chte ich eine Bestellung erstellen: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> order = Create.Order .Dated(DateTime.Now) .With(Pizza.Pepperoni.CountOf(<span class="hljs-number"><span class="hljs-number">1</span></span>).For(<span class="hljs-number"><span class="hljs-number">500</span></span>)) .With(Pizza.Margarita.CountOf(<span class="hljs-number"><span class="hljs-number">1</span></span>).For(<span class="hljs-number"><span class="hljs-number">650</span></span>)) .Please();</code> </pre><br>  Wie k√∂nnen wir das erreichen?  Wir brauchen nat√ºrlich Bauherren f√ºr die Bestellung und die Bestellposition.  Mit dem Bauherrn f√ºr die Bestellung ist alles kristallklar.  Da ist er: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">OrderBuilder</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DateTime _date; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> List&lt;OrderLine&gt; _lines = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;OrderLine&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> OrderBuilder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dated</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DateTime date</span></span></span><span class="hljs-function">)</span></span> { _date = date; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> OrderBuilder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">With</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">OrderLine orderLine</span></span></span><span class="hljs-function">)</span></span> { _lines.Add(orderLine); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Order </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Please</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> order = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Order(_date); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> _lines) { order.AddLine(line); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> order; } }</code> </pre><br>  Bei <code>OrderLine</code> Situation jedoch interessanter: Erstens wird die Terminal Please-Methode hier nicht aufgerufen, und zweitens wird der Zugriff auf den Builder nicht durch das statische <code>Create</code> und nicht durch den Konstruktor des Builders selbst bereitgestellt.  Wir werden das erste Problem mit dem <code>implicit operator</code> l√∂sen und unser Builder sieht folgenderma√üen aus: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">OrderLineBuilder</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Product _product; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">decimal</span></span> _count; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">decimal</span></span> _price; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> OrderLineBuilder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Of</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">decimal</span></span></span></span><span class="hljs-function"><span class="hljs-params"> count, Product product</span></span></span><span class="hljs-function">)</span></span> { _product = product; _count = count; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> OrderLineBuilder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">For</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">decimal</span></span></span></span><span class="hljs-function"><span class="hljs-params"> price</span></span></span><span class="hljs-function">)</span></span> { _price = price; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">implicit</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">operator</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OrderLine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">OrderLineBuilder b</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrderLine(b._product, b._count, b._price); } }</code> </pre><br>  Die zweite Methode hilft uns, die Erweiterungsmethode f√ºr die <code>Product</code> verstehen: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ProductExtensions</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> OrderLineBuilder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CountOf</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Product product, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">decimal</span></span></span></span><span class="hljs-function"><span class="hljs-params"> count</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Create.OrderLine.Of(count, product) } }</code> </pre> <br>  Im Allgemeinen sind Erweiterungsmethoden gute Freunde von DSL.  Sie k√∂nnen aus einer v√∂llig h√∂llischen Logik eine deklarative, verst√§ndliche Beschreibung machen. <br><blockquote>  Verwenden Sie Erweiterungsmethoden.  Benutze sie einfach.  :) :) </blockquote>  Nachdem wir alle diese Aktionen ausgef√ºhrt haben, haben wir den folgenden Testcode erhalten: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Fact</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AcceptOrder_Successful</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> order = Create.Order .Dated(DateTime.Now) .With(Pizza.Pepperoni.CountOf(<span class="hljs-number"><span class="hljs-number">1</span></span>).For(<span class="hljs-number"><span class="hljs-number">500</span></span>)) .With(Pizza.Margarita.CountOf(<span class="hljs-number"><span class="hljs-number">1</span></span>).For(<span class="hljs-number"><span class="hljs-number">650</span></span>)) .Please(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> orderRepositoryMock = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mock&lt;IOrderRepository&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ingredientsRepositoryMock = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mock&lt;IIngredientRepository&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> service = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PizzeriaService(orderRepositoryMock.Object, ingredientsRepositoryMock.Object); service.AcceptOrder(order); orderRepositoryMock.Verify(r =&gt; r.Add(order), Times.Once); ingredientsRepositoryMock.Verify(r =&gt; r.ReserveIngredients(order), Times.Once); }</code> </pre><br>  Hier haben wir den Ansatz gew√§hlt, den wir "Fairy Fairy" nennen.  In diesem Fall schreiben Sie zuerst Leerlaufcode, wie Sie ihn sehen m√∂chten, und versuchen dann, das, was Sie in DSL geschrieben haben, zu verpacken.  Dies ist sehr n√ºtzlich, um zu handeln - manchmal k√∂nnen Sie sich selbst nicht vorstellen, wozu C # in der Lage ist. <br><blockquote>  Stellen Sie sich vor, eine magische Fee ist eingetroffen und hat Ihnen erlaubt, Code nach Ihren W√ºnschen zu schreiben, und dann zu versuchen, alles in DSL zu schreiben. </blockquote><br><h2>  Erstellen eines Dienstes (Testbares Muster) </h2><br>  Mit der Bestellung ist jetzt alles mehr oder weniger nicht schlecht.  Es ist an der Zeit, sich mit den Mokas der Repositories zu befassen.  Es ist erw√§hnenswert, dass der Test selbst, den wir betrachten, ein Test f√ºr das Verhalten ist.  Verhaltenstests sind stark mit der Implementierung von Methoden verbunden. Wenn es m√∂glich ist, solche Tests nicht zu schreiben, ist es besser, dies nicht zu tun.  Manchmal sind sie jedoch n√ºtzlich, und manchmal k√∂nnen Sie √ºberhaupt nicht auf sie verzichten.  Die folgende Technik hilft dabei, Verhaltenstests genau zu schreiben. Wenn Sie pl√∂tzlich feststellen, dass Sie sie verwenden m√∂chten, √ºberlegen Sie zun√§chst, ob Sie die Tests so umschreiben k√∂nnen, dass sie den Status und nicht das Verhalten √ºberpr√ºfen. <br><br>  Ich m√∂chte also sicherstellen, dass es in meiner Testmethode keinen einzigen Mok gibt.  Dazu erstelle ich einen Wrapper f√ºr <code>PizzeriaService</code> in dem ich die gesamte Logik kapsle, die Methodenaufrufe √ºberpr√ºft: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PizzeriaServiceTestable</span></span> : <span class="hljs-title"><span class="hljs-title">PizzeriaService</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> Mock&lt;IOrderRepository&gt; _orderRepositoryMock; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> Mock&lt;IIngredientRepository&gt; _ingredientRepositoryMock; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PizzeriaServiceTestable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Mock&lt;IOrderRepository&gt; orderRepositoryMock, Mock&lt;IIngredientRepository&gt; ingredientRepositoryMock</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">orderRepositoryMock.Object, ingredientRepositoryMock.Object</span></span></span><span class="hljs-function">)</span></span> { _orderRepositoryMock = orderRepositoryMock; _ingredientRepositoryMock = ingredientRepositoryMock; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VerifyAddWasCalledWith</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Order order</span></span></span><span class="hljs-function">)</span></span> { _orderRepositoryMock.Verify(r =&gt; r.Add(order), Times.Once); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VerifyReserveIngredientsWasCalledWith</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Order order</span></span></span><span class="hljs-function">)</span></span> { _ingredientRepositoryMock.Verify(r =&gt; r.ReserveIngredients(order), Times.Once); } }</code> </pre><br>  Diese Klasse erm√∂glicht es uns, Methodenaufrufe zu √ºberpr√ºfen, aber wir m√ºssen sie trotzdem irgendwie erstellen.  Dazu verwenden wir den bereits bekannten Builder: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PizzeriaServiceBuilder</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> PizzeriaServiceTestable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Please</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> orderRepositoryMock = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mock&lt;IOrderRepository&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ingredientsRepositoryMock = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mock&lt;IIngredientRepository&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PizzeriaServiceTestable(orderRepositoryMock, ingredientsRepositoryMock); } }</code> </pre><br>  Im Moment sieht unsere Testmethode folgenderma√üen aus: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Fact</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AcceptOrder_Successful</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> order = Create.Order .Dated(DateTime.Now) .With(Pizza.Pepperoni.CountOf(<span class="hljs-number"><span class="hljs-number">1</span></span>).For(<span class="hljs-number"><span class="hljs-number">500</span></span>)) .With(Pizza.Margarita.CountOf(<span class="hljs-number"><span class="hljs-number">1</span></span>).For(<span class="hljs-number"><span class="hljs-number">650</span></span>)) .Please(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> service = Create.PizzeriaService.Please(); service.AcceptOrder(order); service.VerifyAddWasCalledWith(order); service.VerifyReserveIngredientsWasCalledWith(order); }</code> </pre><br>  Das Aufrufen von Testmethoden ist nicht der einzige Grund, warum die Testable-Klasse verwendet werden kann.  Hier zum Beispiel verwendet unser Dima Pavlov es f√ºr das komplexe Refactoring eines Legacy-Codes. <br><blockquote>  Testable kann die Situation in den schwierigsten F√§llen retten.  F√ºr Verhaltenstests hilft es, h√§ssliche Anrufpr√ºfungen in sch√∂ne Methoden zu packen. </blockquote>  In diesem bedeutsamen Moment haben wir die Verst√§ndlichkeit des Tests verstanden.  Es bleibt, um es reproduzierbar und fokussiert zu machen. <br><br><h2>  Reproduzierbarkeit (w√∂rtliche Erweiterung) </h2><br>  Das w√∂rtliche Erweiterungsmuster steht nicht in direktem Zusammenhang mit der Reproduzierbarkeit, aber es wird uns dabei helfen.  Unser aktuelles Problem ist, dass wir das <code>DateTime.Now</code> Datum als <code>DateTime.Now</code> verwenden.  Wenn sich die Logik der Auftragsannahme pl√∂tzlich ab einem bestimmten Datum √§ndert, m√ºssen wir in unserer Gesch√§ftslogik zumindest f√ºr einige Zeit 2 Logik der Auftragsannahme unterst√ºtzen und sie trennen, indem wir pr√ºfen, <code>if (order.Date &gt; edgeDate)</code> .  In diesem Fall kann unser Test fallen, wenn das Systemdatum die Grenze √ºberschreitet.  Ja, wir werden dies schnell beheben und sogar zwei von einem Test durchf√ºhren: Einer √ºberpr√ºft die Logik vor dem Grenzdatum und der andere danach.  Trotzdem ist es besser, solche Situationen zu vermeiden und alle Eingabedaten sofort konstant zu machen. <br><br>  "Und wo ist das DSL?"  - Du fragst.  Tatsache ist, dass es bequem ist, Daten in Tests √ºber Erweiterungsmethoden <code>3.May(2019)</code> , z. B. <code>3.May(2019)</code> .  Diese Form der Aufzeichnung ist nicht nur f√ºr Entwickler, sondern auch f√ºr Unternehmen verst√§ndlich.  Erstellen Sie dazu einfach eine solche statische Klasse <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DateConstructionExtensions</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> DateTime </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">May</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> day, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> year</span></span></span><span class="hljs-function">)</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DateTime(year, <span class="hljs-number"><span class="hljs-number">5</span></span>, day); }</code> </pre><br>  Nat√ºrlich sind Daten nicht die einzigen Dinge, f√ºr die dieses Muster verwendet wird.  Wenn wir zum Beispiel die Menge der Zutaten in die Zusammensetzung der Produkte einf√ºhren, k√∂nnten wir ungef√§hr <code>42.Grams("flour")</code> schreiben. <br><blockquote>  Quantitative Objekte und Daten werden bequem mit den bekannten Erweiterungsmethoden erstellt. </blockquote><br><h2>  Fokus </h2><br>  Warum ist es wichtig, die Tests fokussiert zu halten?  Tatsache ist, dass fokussierte Tests einfacher zu warten sind, aber dennoch unterst√ºtzt werden m√ºssen.  Zum Beispiel m√ºssen sie beim √Ñndern des Codes ge√§ndert und beim Herauss√§gen alter Funktionen gel√∂scht werden.  Wenn die Tests nicht fokussiert sind, m√ºssen Sie beim √Ñndern der Logik die gro√üen Tests verstehen und Teile der getesteten Funktionalit√§t aus ihnen herausschneiden.  Wenn die Tests fokussiert sind und ihre Namen klar sind, m√ºssen Sie nur die veralteten Tests entfernen und neue schreiben.  Wenn die Tests ein gutes DSL haben, ist dies √ºberhaupt kein Problem. <br><br>  Nachdem wir mit dem Schreiben von DSL fertig waren, hatten wir die M√∂glichkeit, diesen Test fokussiert zu machen, indem wir ihn in zwei Tests aufteilten: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Fact</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WhenAcceptOrder_AddIsCalled</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> order = Create.Order .Dated(<span class="hljs-number"><span class="hljs-number">3.</span></span>May(<span class="hljs-number"><span class="hljs-number">2019</span></span>)) .With(Pizza.Pepperoni.CountOf(<span class="hljs-number"><span class="hljs-number">1</span></span>).For(<span class="hljs-number"><span class="hljs-number">500</span></span>)) .With(Pizza.Margarita.CountOf(<span class="hljs-number"><span class="hljs-number">1</span></span>).For(<span class="hljs-number"><span class="hljs-number">650</span></span>)) .Please(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> service = Create.PizzeriaService.Please(); service.AcceptOrder(order); service.VerifyAddWasCalledWith(order); } [Fact] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WhenAcceptOrder_ReserveIngredientsIsCalled</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> order = Create.Order .Dated(<span class="hljs-number"><span class="hljs-number">3.</span></span>May(<span class="hljs-number"><span class="hljs-number">2019</span></span>)) .With(Pizza.Pepperoni.CountOf(<span class="hljs-number"><span class="hljs-number">1</span></span>).For(<span class="hljs-number"><span class="hljs-number">500</span></span>)) .With(Pizza.Margarita.CountOf(<span class="hljs-number"><span class="hljs-number">1</span></span>).For(<span class="hljs-number"><span class="hljs-number">650</span></span>)) .Please(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> service = Create.PizzeriaService.Please(); service.AcceptOrder(order); service.VerifyReserveIngredientsWasCalledWith(order); }</code> </pre><br>  Beide Tests erwiesen sich als kurz, klar, reproduzierbar und konzentriert. <br><br>  Bitte beachten Sie, dass jetzt die Namen der Tests den Zweck widerspiegeln, f√ºr den sie geschrieben wurden, und jetzt jeder Entwickler, der in mein Projekt kam, versteht, warum jeder der Tests geschrieben wurde und was in diesem Test passiert. <br><blockquote>  Der Fokus der Tests macht sie unterst√ºtzt.  Ein guter Test muss fokussiert sein. </blockquote>  Und jetzt kann ich dich schon zu mir rufen h√∂ren: ‚ÄûYura, was zum Teufel bist du?  Wir haben eine Million Code geschrieben, um ein paar Tests h√ºbsch zu machen? ‚Äú  Ja, das ist so.  Obwohl wir nur ein paar Tests haben, ist es sinnvoll, in DSL zu investieren und diese Tests verst√§ndlich zu machen.  Sobald Sie DSL schreiben, erhalten Sie eine Reihe von Extras: <br><br><ul><li>  Es wird einfach, neue Tests zu schreiben.  Sie m√ºssen sich nicht 2 Stunden lang f√ºr Unit-Tests einrichten. Nehmen Sie einfach und schreiben Sie. </li><li>  Tests werden verst√§ndlich und lesbar.  Jeder Entwickler, der sich den Test ansieht, versteht, warum er geschrieben wurde und was er √ºberpr√ºft. </li><li>  Der Schwellenwert f√ºr die Teilnahme an Tests (und m√∂glicherweise in der Dom√§ne) f√ºr neue Entwickler wurde verringert.  Mit ObjectMother k√∂nnen Sie beispielsweise leicht herausfinden, welche Objekte in der Dom√§ne erstellt werden k√∂nnen. </li><li>  Und schlie√ülich ist es einfach sch√∂n, mit Tests zu arbeiten, und dadurch wird der Code besser unterst√ºtzt. </li></ul><br>  Beispielquellcode und Tests finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de451598/">https://habr.com/ru/post/de451598/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de451588/index.html">Hinweis zum Integrationstest Verwenden von Jenkins unter Kubernetes</a></li>
<li><a href="../de451590/index.html">100 Dinge bei I / O Nr. 19 angek√ºndigt</a></li>
<li><a href="../de451592/index.html">Aufzeichnungen von Berichten des zweiten QA-Mitap Redmadrobot</a></li>
<li><a href="../de451594/index.html">PHP Russia 2019 Report Guide</a></li>
<li><a href="../de451596/index.html">Grauer Kardinal .NET - John Galloway</a></li>
<li><a href="../de451600/index.html">So schreiben Sie ein Anschreiben bei der Arbeitssuche in den USA: 7 Tipps</a></li>
<li><a href="../de451602/index.html">Wir studieren MITRE ATT & CK. Mobile Matrizen: Ger√§tezugriff. Teil 1</a></li>
<li><a href="../de451604/index.html">Dieser Artikel hat zu viel Wasser.</a></li>
<li><a href="../de451606/index.html">Internet-Geschichte: Zerfall, Teil 2</a></li>
<li><a href="../de451610/index.html">Sicherheitswoche 20: Deaktivieren von Firefox-Erweiterungen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>