<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⬅️ 🕒 🖐🏾 Lazy Initialisierung in Spring Boot 2.2 🐕 🉐 👨🏼‍🌾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Von einem Übersetzer: Da das Spring Framework eines der wichtigsten Frameworks ist, auf denen wir CUBA aufbauen, bleiben Nachrichten über neue Spring-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lazy Initialisierung in Spring Boot 2.2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/haulmont/blog/445592/"><p><img src="https://habrastorage.org/webt/k4/wp/kw/k4wpkwqnpuvxqqd3xyidbxkmgvo.png"></p><br><p>  <em>Von einem Übersetzer: Da das Spring Framework eines der wichtigsten Frameworks ist, auf denen wir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CUBA</a> aufbauen, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bleiben</a> Nachrichten über neue Spring-Funktionen für uns nicht unbemerkt.</em>  <em>Eine verzögerte Initialisierung ist eine Möglichkeit, die erste Startzeit der Anwendung zu verkürzen, was in unserer Zeit der weit verbreiteten Verwendung von Microservices eine wichtige Messgröße ist.</em>  <em>Für diejenigen, die lieber Videos lesen möchten, gibt es eine 10-minütige <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Präsentation von</a> Josh Long zum Thema des Artikels.</em> </p><br><p>  Die kürzlich angekündigte erste Meilensteinversion von Spring Boot 2.2 bietet Unterstützung für die verzögerte Initialisierung.  In diesem Artikel werden wir uns neue Funktionen ansehen und erklären, wie sie aktiviert werden. </p><a name="habracut"></a><br><h2 id="chto-eto-znachit---byt-lenivym">  Was bedeutet es, faul zu sein? </h2><br><p>  Das Spring Framework unterstützt die verzögerte Initialisierung, seit sein Quellcode vor elf Jahren auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Git</a> umgestellt wurde.  Wenn der Anwendungskontext aktualisiert wird, wird standardmäßig jede Bean neu erstellt und ihre Abhängigkeiten implementiert.  Wenn ein Bin dagegen für die verzögerte Initialisierung konfiguriert ist, wird er nicht erstellt und seine Abhängigkeiten werden erst dann gelöscht, wenn dies erforderlich ist. </p><br><h2 id="vklyuchenie-lenivoy-inicializacii">  Aktivieren der verzögerten Initialisierung </h2><br><p> In jeder Version von Spring Boot ist es möglich, die verzögerte Initialisierung zu aktivieren, wenn es Ihnen nichts ausmacht, sich mit <code>BeanFactoryPostProcessor</code> die Hände schmutzig zu <code>BeanFactoryPostProcessor</code> .  Spring Boot 2.2 vereinfacht diesen Prozess einfach durch die Einführung einer neuen Eigenschaft - <code>spring.main.lazy-initialization</code> (es gibt auch äquivalente Methoden in <code>SpringApplication</code> und <code>SpringApplicationBuilder</code> ).  Wenn diese Eigenschaft auf <code>true</code> , werden Application Beans für die verzögerte Initialisierung konfiguriert. </p><br><h2 id="preimuschestva-lenivoy-inicializacii">  Die Vorteile einer verzögerten Initialisierung </h2><br><p>  Eine verzögerte Initialisierung kann die Startzeit Ihrer Anwendung erheblich verkürzen, da zu diesem Zeitpunkt weniger Klassen geladen und weniger Bins erstellt werden.  Beispielsweise startet eine kleine Webanwendung, die Actuator und Spring Security verwendet, normalerweise 2,5 Sekunden.  Bei verzögerter Initialisierung dauert dieser Vorgang 2 Sekunden.  Die genauen Beschleunigungswerte variieren von Anwendung zu Anwendung, abhängig von der Struktur des Abhängigkeitsgraphen des Behälters. </p><br><p>  <em>Anmerkung des Übersetzers: Ich habe dieses <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiel ausgeführt</a> und Spring Boot 2.2 in den Abhängigkeiten geschrieben. Die Startzeit mit verzögerter Initialisierung betrug 3 Sekunden und ohne diese 4. Ich denke, dass bei schwerwiegenderen Anwendungen die Startzeit aufgrund der Verwendung der verzögerten Initialisierung erheblich verlängert wird wir werden nicht sehen.</em>  <em><u>Aktualisieren:</u> Auf Anraten von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">alek_sys wurde</a> die Validierung und Aktualisierung des Datenbankschemas deaktiviert und die verzögerte JPA-Initialisierung für beide Fälle <code>Started WebApplication in...</code> Es stellte sich heraus, dass 2,7 und 3,7 Sekunden vor der <code>Started WebApplication in...</code></em> </p><br><h2 id="a-chto-tam-naschet-devtools">  Was ist mit DevTools? </h2><br><p>  Spring Boot DevTools bietet eine erhebliche Entwicklungsbeschleunigung.  Anstatt die JVM und die Anwendung jedes Mal neu zu starten, wenn Sie etwas ändern, führen DevTools einen „Hot-Neustart“ der Anwendung in derselben JVM durch.  Ein wesentlicher Vorteil eines solchen Neustarts besteht darin, dass JIT die Möglichkeit hat, den Code zu optimieren, der beim Start der Anwendung ausgeführt wird.  Nach mehreren Neustarts verringert sich die Anfangszeit von 2,5 Sekunden um fast 80% auf 500 ms.  Mit der verzögerten Initialisierung sind die Dinge noch besser.  Durch Festlegen der Eigenschaft <code>spring.main.lazy-initialization</code> wird die Neustartzeit direkt in der IDE gleich 400 ms <code>spring.main.lazy-initialization</code> . </p><br><h2 id="obratnaya-storona-lenivoy-inicializacii">  Die Kehrseite der faulen Initialisierung </h2><br><p>  Wie oben gezeigt, kann die Einbeziehung der verzögerten Initialisierung die Startzeit der Anwendung erheblich verkürzen.  Und vielleicht haben Sie den unwiderstehlichen Wunsch, dies ständig zu verwenden, oder Sie werden sich zumindest fragen, warum die verzögerte Initialisierung nicht standardmäßig aktiviert ist.  Es gibt mehrere mögliche negative Auswirkungen, die am besten sofort geklärt werden können. </p><br><p>  Die Tatsache, dass Klassen nicht geladen und Bins erst erstellt werden, wenn sie benötigt werden, kann Probleme maskieren, die möglicherweise bereits beim Start der Anwendung erkannt wurden.  Dies kann beispielsweise das Fehlen der erforderlichen Klasse, ein Speicherüberlauf oder ein Fehler sein, der mit der falschen Konfiguration verbunden ist. </p><br><p>  In Webanwendungen können verzögerte Konfigurationen die Latenz von HTTP-Anforderungen erhöhen, die eine Bin-Initialisierung verursachen.  Dies ist normalerweise die erste Anforderung, es können jedoch zusätzliche unerwünschte Auswirkungen auf den Lastausgleich oder die automatische Skalierung auftreten. </p><br><h2 id="eta-shtuka-vklyuchena">  Ist das Ding enthalten? </h2><br><p>  Wenn Sie nicht sicher sind, wie genau sich die verzögerte Initialisierung auf Ihre Anwendung auswirkt, oder wenn Sie überprüfen möchten, ob andere Aspekte des Frameworks für Sie geeignet sind und das tun, was Sie benötigen, ist es hilfreich, einen Debugger zu verwenden.  Durch Festlegen eines Haltepunkts im Bin-Konstruktor können Sie sehen, zu welchem ​​genauen Zeitpunkt der Bin initialisiert wird.  In einer in Spring Boot geschriebenen Webanwendung mit aktivierter verzögerter Initialisierung können Sie beispielsweise sehen, dass mit <code>@Controller</code> Annotation gekennzeichnete <code>@Controller</code> erst bei der ersten Anforderung an <code>DispatcerServlet</code> Spring MVC oder an <code>DispatchHandler</code> Spring WebFlux erstellt werden. </p><br><h2 id="kogda-vklyuchat-lenivuyu-inicializaciyu">  Wann muss die verzögerte Initialisierung aktiviert werden? </h2><br><p>  Wie wir oben gesehen haben, bietet die verzögerte Initialisierung beim Start der Anwendung bemerkenswerte Verbesserungen, es gibt jedoch auch Nachteile. Daher müssen Sie diese Funktion sehr sorgfältig verwenden. </p><br><p>  Ein Bereich, in dem sich eine verzögerte Initialisierung auszahlen kann (fast ohne Overhead), ist der Anwendungsentwicklungsprozess.  Während Sie eine Anwendung schreiben, können Sie durch die reduzierte Neustartzeit, die durch die verzögerte Initialisierung in Kombination mit DevTools bereitgestellt wird, viel Zeit sparen. </p><br><p>  Wo sonst können Sie die Vorteile der verzögerten Initialisierung nutzen - dies erfolgt in Integrationstests.  Möglicherweise verwenden Sie bereits <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Slicing" -Tests</a> , um die Ausführungszeit zu verkürzen, indem Sie die Anzahl der initialisierten Beans in einigen Testtypen begrenzen.  Die verzögerte Initialisierung bietet eine alternative Möglichkeit, das gleiche Ergebnis zu erzielen.  Wenn Sie in der falschen Position sind, um die Struktur der Anwendung für "Slicing" -Tests zu ändern, oder wenn es für Ihre spezifischen Tests kein geeignetes "Slicing" gibt, wird durch die Einbeziehung der verzögerten Initialisierung die Anzahl der Bins auf diejenigen begrenzt, die nur in Ihrem Test verwendet werden.  Dies reduziert die Testausführungszeit, insbesondere wenn sie während der Entwicklung in einer isolierten Umgebung ausgeführt werden. </p><br><p>  Aktivieren Sie zuletzt die verzögerte Initialisierung auf dem Produkt.  Und wenn Sie sich dazu entschließen, tun Sie dies mit Vorsicht.  Bei Webanwendungen kann sich der Containermanager auf den Einstiegspunkt <code>/health</code> , der normalerweise relativ schnell reagiert. Beachten Sie jedoch, dass die ersten Aufrufe möglicherweise länger als gewöhnlich dauern können.  Sie müssen sich auch die der JVM zugewiesene Speichergröße merken, damit bei der Initialisierung aller Komponenten kein Überlauf auftritt. <br></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de445592/">https://habr.com/ru/post/de445592/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de445582/index.html">CRM-Systeme: Schutz oder Bedrohung?</a></li>
<li><a href="../de445584/index.html">OS1: Ein primitiver Kernel auf Rust für x86. Teil 2. VGA, GDT, IDT</a></li>
<li><a href="../de445586/index.html">Android Academy in Moskau - sprechen Sie darüber, wie es war, und teilen Sie Kursmaterialien</a></li>
<li><a href="../de445588/index.html">In der Ausstellung wird das 3D-Scannen einer Person in 30 Sekunden gezeigt</a></li>
<li><a href="../de445590/index.html">Englische Grammatik. Wer vs. Wen - wie man versteht, welches Wort man benutzt</a></li>
<li><a href="../de445594/index.html">Tools zum Erstellen einer reaktionsfähigen Site ohne Zugriff auf die Site</a></li>
<li><a href="../de445596/index.html">Tipps und Tricks von Kubernetes: Personalisierte Fehlerseiten in NGINX Ingress</a></li>
<li><a href="../de445600/index.html">[Umfrage und böse] Hostings, seien sie falsch</a></li>
<li><a href="../de445602/index.html">PHP Russland 2019: sein "Stadion" für die Sprache der ersten Liga</a></li>
<li><a href="../de445608/index.html">Spielende: Analysten berichten von einem Anstieg der Anzahl von DDoS-Angriffen auf das Spielesegment</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>