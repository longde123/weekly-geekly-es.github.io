<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏾‍🤝‍🧑🏽 🎅🏼 🤚🏽 PVS-Studio voulait, mais n'a pas pu trouver de bogues dans robots.txt ⛹🏽 👨🏼‍💻 🕸️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'autre jour, Google a publié le code source de l'analyseur robots.txt. Pourquoi ne pas exécuter le projet déjà testé de haut en bas par PVS-Studio et...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PVS-Studio voulait, mais n'a pas pu trouver de bogues dans robots.txt</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/459662/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6a4/303/c49/6a4303c496535ce7c7fc9ff84f2608ee.png" alt="Image 1"></div><br>  L'autre jour, Google a publié le code source de l'analyseur robots.txt.  Pourquoi ne pas exécuter le projet déjà testé de haut en bas par PVS-Studio et éventuellement trouver une erreur.  Aussitôt dit, aussitôt fait.  Il est dommage que rien de significatif n'ait pu être trouvé.  Eh bien, que ce soit juste une excuse pour féliciter les développeurs de Google. <br><br>  robots.txt - un fichier d'index qui contient les règles pour les robots de recherche.  Il est valide pour les protocoles https, http et ftp.  Google a mis son analyseur de fichiers robots.txt à la disposition de tous.  En savoir plus sur ces nouvelles ici: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Google ouvre le code source de l'analyseur robots.txt</a> <br><a name="habracut"></a><br>  Je pense que la plupart des lecteurs de nos articles savent ce que fait PVS-Studio.  Mais si vous êtes nouveau sur notre blog, nous vous donnerons une brève référence.  PVS-Studio est un analyseur de code statique qui vous permet de trouver diverses erreurs, vulnérabilités et lacunes dans des projets écrits en C, C ++, C # et Java.  En d'autres termes, PVS-Studio est une solution <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SAST</a> et peut fonctionner à la fois sur des machines utilisateur ou des serveurs de construction, et dans le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cloud</a> .  Et l'équipe de PVS-Studio aime écrire des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">articles</a> sur la vérification de divers projets.  Passons donc aux choses sérieuses et essayons de trouver des erreurs dans le code source de l'analyseur de Google. <br><br>  À notre grand regret et pour le plus grand plaisir de tous, aucune erreur n'a été trouvée.  Seuls quelques défauts mineurs ont été découverts, dont nous parlerons.  Vous devez écrire au moins quelque chose :).  L'absence d'erreurs s'explique par le faible volume du projet et la haute qualité du code lui-même.  Cela ne signifie pas que certaines erreurs ne s'y cachent pas, mais l'analyse statique s'est avérée impuissante pour le moment. <br><br>  En général, cet article s'est révélé dans l'esprit de notre autre publication, " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">L'article le plus court sur la vérification de nginx</a> ". <br><br>  Il y avait une possibilité de petite optimisation: <br><br>  Performances <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">réduites du V805</a> .  Il est inefficace d'identifier une chaîne vide en utilisant la construction 'strlen (str)&gt; 0'.  Un moyen plus efficace consiste à vérifier: str [0]! = '\ 0'.  robots.cc 354 <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> RobotsTxtParser::GetKeyAndValueFrom(<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **key, ....) { .... *key = line; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(*key) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br>  Appeler la fonction <i>strlen</i> pour savoir si une chaîne n'est pas vide est un moyen inefficace.  Une telle vérification peut être rendue beaucoup plus simple: <i>if (* key [0]! = '\ 0')</i> , et vous n'aurez pas besoin de parcourir tous les éléments de la chaîne si elle n'est pas vide. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">L'objet V808</a> 'path' de type 'basic_string' a été créé mais n'a pas été utilisé.  robots.cc 123 <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPathParamsQuery</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> path; .... }</code> </pre> <br>  La chaîne de <i>chemin d'accès</i> est déclarée, mais n'est pas utilisée plus loin.  Dans certains cas, les variables inutilisées peuvent indiquer une erreur.  Mais ici, il semble qu'auparavant, cette variable ait été utilisée d'une manière ou d'une autre, mais après avoir effectué les modifications, elle n'était plus nécessaire.  Ainsi, l'analyseur aide souvent à rendre le code plus propre et à éviter les erreurs en supprimant simplement les conditions préalables à leur apparence. <br><br>  Dans le cas suivant, l'analyseur, en substance, fait une recommandation pour ajouter un <i>retour</i> par défaut après que tous les <i>principaux ont</i> été traités.  Il pourrait être utile d'ajouter un <i>retour</i> à la toute fin pour que vous puissiez comprendre que tout a vraiment fonctionné.  Cependant, si ce comportement était prévu et que rien n'avait besoin d'être changé, et je ne voudrais pas voir le message de l'analyseur, alors dans le cas de PVS-Studio, vous pouvez supprimer cet avertissement et ne plus le revoir :). <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V591</a> La fonction 'main' ne renvoie pas de valeur, ce qui équivaut à 'return 0'.  Il est possible que ce comportement soit involontaire.  robots_main.cc 99 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">** argv)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (filename == <span class="hljs-string"><span class="hljs-string">"-h"</span></span> || filename == <span class="hljs-string"><span class="hljs-string">"-help"</span></span> || filename == <span class="hljs-string"><span class="hljs-string">"--help"</span></span>) { ShowHelp(argc, argv); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (argc != <span class="hljs-number"><span class="hljs-number">4</span></span>) { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"...."</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } }</code> </pre> <br>  Il a également été constaté que les deux fonctions ci-dessous, avec des noms différents, ont la même implémentation.  C'est peut-être le résultat du fait qu'avant ces fonctions avaient une logique différente, mais arrivaient au même.  Ou il se peut qu'une faute de frappe se soit glissée quelque part, ces avertissements doivent donc être soigneusement vérifiés. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V524</a> Il est étrange que le corps de la fonction 'MatchDisallow' soit entièrement équivalent au corps de la fonction 'MatchAllow'.  robots.cc 645 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MatchAllow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(absl::string_view path, absl::string_view pattern)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Matches(path, pattern) ? pattern.length() : <span class="hljs-number"><span class="hljs-number">-1</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MatchDisallow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(absl::string_view path, absl::string_view pattern)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Matches(path, pattern) ? pattern.length() : <span class="hljs-number"><span class="hljs-number">-1</span></span>; }</code> </pre> <br>  C'est le seul endroit qui me rend méfiant.  Il doit être vérifié par les auteurs du projet. <br><br>  Ainsi, la vérification de l'analyseur robots.txt de Google a montré que le projet, qui est si activement utilisé et probablement testé à plusieurs reprises pour détecter les erreurs, possède un code de haute qualité.  Et les lacunes constatées ne peuvent pas du tout gâcher l'impression de quels codeurs sympas de Google ont été impliqués dans ce projet :). <br><br>  Nous vous proposons de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">télécharger et d'essayer PVS-Studio</a> sur le projet qui vous intéresse. <br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/c78/30f/70c/c7830f70c5577c3d6704f254d7cad6a3.png" align="left"></a> </p><br><br>  Si vous souhaitez partager cet article avec un public anglophone, veuillez utiliser le lien vers la traduction: Victoria Khanieva.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PVS-Studio voulait mais n'a pas pu trouver de bugs dans robots.txt</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr459662/">https://habr.com/ru/post/fr459662/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr459648/index.html">Tout devrait bien se passer dans l'analyseur: à la fois fonctionnalité et interface ... Nous explorons la nouvelle interface Solar appScreener 3.1</a></li>
<li><a href="../fr459650/index.html">Comment ne pas perdre d'argent dans la boîte noire: méthodes de test de facturation</a></li>
<li><a href="../fr459652/index.html">Approche de test de régression automatisée</a></li>
<li><a href="../fr459656/index.html">Service OData sans écrire de code</a></li>
<li><a href="../fr459658/index.html">PVS-Studio voulait mais n'a pas pu trouver de bugs dans robots.txt</a></li>
<li><a href="../fr459668/index.html">Comment reconnaître le texte d'une photo: nouvelles fonctionnalités du cadre Vision</a></li>
<li><a href="../fr459670/index.html">Aller à Amsterdam</a></li>
<li><a href="../fr459672/index.html">Souligner en Python</a></li>
<li><a href="../fr459674/index.html">Threat Intelligence Epic Saga</a></li>
<li><a href="../fr459680/index.html">Suite à Highload ++ Siberia 2019 - 8 tâches Oracle</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>